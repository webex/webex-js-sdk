import {assert} from 'chai';

describe('sample-browser-multi-party-call', () => {
  before('reload browser', () => browser.refresh());

  describe('saved values', () => {
    it('stores form values across page loads', () => {
      browser.select('browserSpock').url('/browser-multi-party-call');
      browser.select('browserSpock').waitUntil(() => !browser.select('browserSpock').getTitle().match(/localhost/));
      assert.equal(browser.select('browserSpock').getTitle(), 'Sample: Multi Party Calling');

      browser.select('browserSpock').setValue('#access-token', 1);
      browser.select('browserSpock').setValue('#room', 2);

      // need to deselect the #invitee input to fire the change event
      browser.select('browserSpock').click('body');

      browser.select('browserSpock').url('/browser-multi-party-call');

      browser.select('browserSpock').waitUntil(() => !browser.select('browserSpock').getTitle().match(/localhost/));
      assert.equal(browser.select('browserSpock').getTitle(), 'Sample: Multi Party Calling');

      browser.select('browserSpock').waitUntil(() => browser.select('browserSpock').getTitle() === 'Sample: Multi Party Calling');

      assert.equal(browser.select('browserSpock').getValue('#access-token'), 1);
      assert.equal(browser.select('browserSpock').getValue('#room'), 2);
    });
  });
});
