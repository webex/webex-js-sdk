/*! Cisco Spark SDK v1.50.13 */
var CiscoSpark=function(){"use strict";var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function r(e,t){return e(t={exports:{}},t.exports),t.exports}var n=r(function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)}),i={}.hasOwnProperty,o=function(e,t){return i.call(e,t)},a=function(e){try{return!!e()}catch(e){return!0}},u=!a(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),s=r(function(e){var t=e.exports={version:"2.6.5"};"number"==typeof __e&&(__e=t)}),c=(s.version,function(e){return"object"==typeof e?null!==e:"function"==typeof e}),l=function(e){if(!c(e))throw TypeError(e+" is not an object!");return e},f=n.document,d=c(f)&&c(f.createElement),p=function(e){return d?f.createElement(e):{}},h=!u&&!a(function(){return 7!=Object.defineProperty(p("div"),"a",{get:function(){return 7}}).a}),v=function(e,t){if(!c(e))return e;var r,n;if(t&&"function"==typeof(r=e.toString)&&!c(n=r.call(e)))return n;if("function"==typeof(r=e.valueOf)&&!c(n=r.call(e)))return n;if(!t&&"function"==typeof(r=e.toString)&&!c(n=r.call(e)))return n;throw TypeError("Can't convert object to primitive value")},g=Object.defineProperty,y={f:u?Object.defineProperty:function(e,t,r){if(l(e),t=v(t,!0),l(r),h)try{return g(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},m=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},b=u?function(e,t,r){return y.f(e,t,m(1,r))}:function(e,t,r){return e[t]=r,e},_=0,w=Math.random(),S=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++_+w).toString(36))},k=r(function(e){var t=n["__core-js_shared__"]||(n["__core-js_shared__"]={});(e.exports=function(e,r){return t[e]||(t[e]=void 0!==r?r:{})})("versions",[]).push({version:s.version,mode:"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})}),E=k("native-function-to-string",Function.toString),P=r(function(e){var t=S("src"),r=(""+E).split("toString");s.inspectSource=function(e){return E.call(e)},(e.exports=function(e,i,a,u){var s="function"==typeof a;s&&(o(a,"name")||b(a,"name",i)),e[i]!==a&&(s&&(o(a,t)||b(a,t,e[i]?""+e[i]:r.join(String(i)))),e===n?e[i]=a:u?e[i]?e[i]=a:b(e,i,a):(delete e[i],b(e,i,a)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[t]||E.call(this)})}),T=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e},O=function(e,t,r){if(T(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}},C=function(e,t,r){var i,o,a,u,c=e&C.F,l=e&C.G,f=e&C.S,d=e&C.P,p=e&C.B,h=l?n:f?n[t]||(n[t]={}):(n[t]||{}).prototype,v=l?s:s[t]||(s[t]={}),g=v.prototype||(v.prototype={});for(i in l&&(r=t),r)a=((o=!c&&h&&void 0!==h[i])?h:r)[i],u=p&&o?O(a,n):d&&"function"==typeof a?O(Function.call,a):a,h&&P(h,i,a,e&C.U),v[i]!=a&&b(v,i,u),d&&g[i]!=a&&(g[i]=a)};n.core=s,C.F=1,C.G=2,C.S=4,C.P=8,C.B=16,C.W=32,C.U=64,C.R=128;var M=C,x=r(function(e){var t=S("meta"),r=y.f,n=0,i=Object.isExtensible||function(){return!0},u=!a(function(){return i(Object.preventExtensions({}))}),s=function(e){r(e,t,{value:{i:"O"+ ++n,w:{}}})},l=e.exports={KEY:t,NEED:!1,fastKey:function(e,r){if(!c(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,t)){if(!i(e))return"F";if(!r)return"E";s(e)}return e[t].i},getWeak:function(e,r){if(!o(e,t)){if(!i(e))return!0;if(!r)return!1;s(e)}return e[t].w},onFreeze:function(e){return u&&l.NEED&&i(e)&&!o(e,t)&&s(e),e}}}),j=(x.KEY,x.NEED,x.fastKey,x.getWeak,x.onFreeze,r(function(e){var t=k("wks"),r=n.Symbol,i="function"==typeof r;(e.exports=function(e){return t[e]||(t[e]=i&&r[e]||(i?r:S)("Symbol."+e))}).store=t})),R=y.f,A=j("toStringTag"),I=function(e,t,r){e&&!o(e=r?e:e.prototype,A)&&R(e,A,{configurable:!0,value:t})},D={f:j},L=y.f,F=function(e){var t=s.Symbol||(s.Symbol=n.Symbol||{});"_"==e.charAt(0)||e in t||L(t,e,{value:D.f(e)})},N={}.toString,U=function(e){return N.call(e).slice(8,-1)},z=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==U(e)?e.split(""):Object(e)},q=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},B=function(e){return z(q(e))},W=Math.ceil,V=Math.floor,G=function(e){return isNaN(e=+e)?0:(e>0?V:W)(e)},H=Math.min,$=function(e){return e>0?H(G(e),9007199254740991):0},J=Math.max,Y=Math.min,K=function(e,t){return(e=G(e))<0?J(e+t,0):Y(e,t)},X=function(e){return function(t,r,n){var i,o=B(t),a=$(o.length),u=K(n,a);if(e&&r!=r){for(;a>u;)if((i=o[u++])!=i)return!0}else for(;a>u;u++)if((e||u in o)&&o[u]===r)return e||u||0;return!e&&-1}},Z=k("keys"),Q=function(e){return Z[e]||(Z[e]=S(e))},ee=X(!1),te=Q("IE_PROTO"),re=function(e,t){var r,n=B(e),i=0,a=[];for(r in n)r!=te&&o(n,r)&&a.push(r);for(;t.length>i;)o(n,r=t[i++])&&(~ee(a,r)||a.push(r));return a},ne="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),ie=Object.keys||function(e){return re(e,ne)},oe={f:Object.getOwnPropertySymbols},ae={f:{}.propertyIsEnumerable},ue=Array.isArray||function(e){return"Array"==U(e)},se=u?Object.defineProperties:function(e,t){l(e);for(var r,n=ie(t),i=n.length,o=0;i>o;)y.f(e,r=n[o++],t[r]);return e},ce=n.document,le=ce&&ce.documentElement,fe=Q("IE_PROTO"),de=function(){},pe=function(){var e,t=p("iframe"),r=ne.length;for(t.style.display="none",le.appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),pe=e.F;r--;)delete pe.prototype[ne[r]];return pe()},he=Object.create||function(e,t){var r;return null!==e?(de.prototype=l(e),r=new de,de.prototype=null,r[fe]=e):r=pe(),void 0===t?r:se(r,t)},ve=ne.concat("length","prototype"),ge={f:Object.getOwnPropertyNames||function(e){return re(e,ve)}},ye=ge.f,me={}.toString,be="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],_e={f:function(e){return be&&"[object Window]"==me.call(e)?function(e){try{return ye(e)}catch(e){return be.slice()}}(e):ye(B(e))}},we=Object.getOwnPropertyDescriptor,Se={f:u?we:function(e,t){if(e=B(e),t=v(t,!0),h)try{return we(e,t)}catch(e){}if(o(e,t))return m(!ae.f.call(e,t),e[t])}},ke=x.KEY,Ee=Se.f,Pe=y.f,Te=_e.f,Oe=n.Symbol,Ce=n.JSON,Me=Ce&&Ce.stringify,xe=j("_hidden"),je=j("toPrimitive"),Re={}.propertyIsEnumerable,Ae=k("symbol-registry"),Ie=k("symbols"),De=k("op-symbols"),Le=Object.prototype,Fe="function"==typeof Oe,Ne=n.QObject,Ue=!Ne||!Ne.prototype||!Ne.prototype.findChild,ze=u&&a(function(){return 7!=he(Pe({},"a",{get:function(){return Pe(this,"a",{value:7}).a}})).a})?function(e,t,r){var n=Ee(Le,t);n&&delete Le[t],Pe(e,t,r),n&&e!==Le&&Pe(Le,t,n)}:Pe,qe=function(e){var t=Ie[e]=he(Oe.prototype);return t._k=e,t},Be=Fe&&"symbol"==typeof Oe.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof Oe},We=function(e,t,r){return e===Le&&We(De,t,r),l(e),t=v(t,!0),l(r),o(Ie,t)?(r.enumerable?(o(e,xe)&&e[xe][t]&&(e[xe][t]=!1),r=he(r,{enumerable:m(0,!1)})):(o(e,xe)||Pe(e,xe,m(1,{})),e[xe][t]=!0),ze(e,t,r)):Pe(e,t,r)},Ve=function(e,t){l(e);for(var r,n=function(e){var t=ie(e),r=oe.f;if(r)for(var n,i=r(e),o=ae.f,a=0;i.length>a;)o.call(e,n=i[a++])&&t.push(n);return t}(t=B(t)),i=0,o=n.length;o>i;)We(e,r=n[i++],t[r]);return e},Ge=function(e){var t=Re.call(this,e=v(e,!0));return!(this===Le&&o(Ie,e)&&!o(De,e))&&(!(t||!o(this,e)||!o(Ie,e)||o(this,xe)&&this[xe][e])||t)},He=function(e,t){if(e=B(e),t=v(t,!0),e!==Le||!o(Ie,t)||o(De,t)){var r=Ee(e,t);return!r||!o(Ie,t)||o(e,xe)&&e[xe][t]||(r.enumerable=!0),r}},$e=function(e){for(var t,r=Te(B(e)),n=[],i=0;r.length>i;)o(Ie,t=r[i++])||t==xe||t==ke||n.push(t);return n},Je=function(e){for(var t,r=e===Le,n=Te(r?De:B(e)),i=[],a=0;n.length>a;)!o(Ie,t=n[a++])||r&&!o(Le,t)||i.push(Ie[t]);return i};Fe||(P((Oe=function(){if(this instanceof Oe)throw TypeError("Symbol is not a constructor!");var e=S(arguments.length>0?arguments[0]:void 0),t=function(r){this===Le&&t.call(De,r),o(this,xe)&&o(this[xe],e)&&(this[xe][e]=!1),ze(this,e,m(1,r))};return u&&Ue&&ze(Le,e,{configurable:!0,set:t}),qe(e)}).prototype,"toString",function(){return this._k}),Se.f=He,y.f=We,ge.f=_e.f=$e,ae.f=Ge,oe.f=Je,u&&P(Le,"propertyIsEnumerable",Ge,!0),D.f=function(e){return qe(j(e))}),M(M.G+M.W+M.F*!Fe,{Symbol:Oe});for(var Ye="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Ke=0;Ye.length>Ke;)j(Ye[Ke++]);for(var Xe=ie(j.store),Ze=0;Xe.length>Ze;)F(Xe[Ze++]);M(M.S+M.F*!Fe,"Symbol",{for:function(e){return o(Ae,e+="")?Ae[e]:Ae[e]=Oe(e)},keyFor:function(e){if(!Be(e))throw TypeError(e+" is not a symbol!");for(var t in Ae)if(Ae[t]===e)return t},useSetter:function(){Ue=!0},useSimple:function(){Ue=!1}}),M(M.S+M.F*!Fe,"Object",{create:function(e,t){return void 0===t?he(e):Ve(he(e),t)},defineProperty:We,defineProperties:Ve,getOwnPropertyDescriptor:He,getOwnPropertyNames:$e,getOwnPropertySymbols:Je}),Ce&&M(M.S+M.F*(!Fe||a(function(){var e=Oe();return"[null]"!=Me([e])||"{}"!=Me({a:e})||"{}"!=Me(Object(e))})),"JSON",{stringify:function(e){for(var t,r,n=[e],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=t=n[1],(c(t)||void 0!==e)&&!Be(e))return ue(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!Be(t))return t}),n[1]=t,Me.apply(Ce,n)}}),Oe.prototype[je]||b(Oe.prototype,je,Oe.prototype.valueOf),I(Oe,"Symbol"),I(Math,"Math",!0),I(n.JSON,"JSON",!0),M(M.S,"Object",{create:he}),M(M.S+M.F*!u,"Object",{defineProperty:y.f}),M(M.S+M.F*!u,"Object",{defineProperties:se});var Qe=function(e,t){var r=(s.Object||{})[e]||Object[e],n={};n[e]=t(r),M(M.S+M.F*a(function(){r(1)}),"Object",n)},et=Se.f;Qe("getOwnPropertyDescriptor",function(){return function(e,t){return et(B(e),t)}});var tt=function(e){return Object(q(e))},rt=Q("IE_PROTO"),nt=Object.prototype,it=Object.getPrototypeOf||function(e){return e=tt(e),o(e,rt)?e[rt]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?nt:null};Qe("getPrototypeOf",function(){return function(e){return it(tt(e))}}),Qe("keys",function(){return function(e){return ie(tt(e))}}),Qe("getOwnPropertyNames",function(){return _e.f});var ot=x.onFreeze;Qe("freeze",function(e){return function(t){return e&&c(t)?e(ot(t)):t}});var at=x.onFreeze;Qe("seal",function(e){return function(t){return e&&c(t)?e(at(t)):t}});var ut=x.onFreeze;Qe("preventExtensions",function(e){return function(t){return e&&c(t)?e(ut(t)):t}}),Qe("isFrozen",function(e){return function(t){return!c(t)||!!e&&e(t)}}),Qe("isSealed",function(e){return function(t){return!c(t)||!!e&&e(t)}}),Qe("isExtensible",function(e){return function(t){return!!c(t)&&(!e||e(t))}});var st=Object.assign,ct=!st||a(function(){var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(e){t[e]=e}),7!=st({},e)[r]||Object.keys(st({},t)).join("")!=n})?function(e,t){for(var r=tt(e),n=arguments.length,i=1,o=oe.f,a=ae.f;n>i;)for(var u,s=z(arguments[i++]),c=o?ie(s).concat(o(s)):ie(s),l=c.length,f=0;l>f;)a.call(s,u=c[f++])&&(r[u]=s[u]);return r}:st;M(M.S+M.F,"Object",{assign:ct});var lt=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t};M(M.S,"Object",{is:lt});var ft=function(e,t){if(l(e),!c(t)&&null!==t)throw TypeError(t+": can't set as prototype!")},dt={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=O(Function.call,Se.f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return ft(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:ft};M(M.S,"Object",{setPrototypeOf:dt.set});var pt=j("toStringTag"),ht="Arguments"==U(function(){return arguments}()),vt=function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),pt))?r:ht?U(t):"Object"==(n=U(t))&&"function"==typeof t.callee?"Arguments":n},gt={};gt[j("toStringTag")]="z",gt+""!="[object z]"&&P(Object.prototype,"toString",function(){return"[object "+vt(this)+"]"},!0);var yt=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)},mt=[].slice,bt={},_t=Function.bind||function(e){var t=T(this),r=mt.call(arguments,1),n=function(){var i=r.concat(mt.call(arguments));return this instanceof n?function(e,t,r){if(!(t in bt)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";bt[t]=Function("F,a","return new F("+n.join(",")+")")}return bt[t](e,r)}(t,i.length,i):yt(t,i,e)};return c(t.prototype)&&(n.prototype=t.prototype),n};M(M.P,"Function",{bind:_t});var wt=y.f,St=Function.prototype,kt=/^\s*function ([^ (]*)/;"name"in St||u&&wt(St,"name",{configurable:!0,get:function(){try{return(""+this).match(kt)[1]}catch(e){return""}}});var Et=j("hasInstance"),Pt=Function.prototype;Et in Pt||y.f(Pt,Et,{value:function(e){if("function"!=typeof this||!c(e))return!1;if(!c(this.prototype))return e instanceof this;for(;e=it(e);)if(this.prototype===e)return!0;return!1}});var Tt="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff",Ot="["+Tt+"]",Ct=RegExp("^"+Ot+Ot+"*"),Mt=RegExp(Ot+Ot+"*$"),xt=function(e,t,r){var n={},i=a(function(){return!!Tt[e]()||"​"!="​"[e]()}),o=n[e]=i?t(jt):Tt[e];r&&(n[r]=o),M(M.P+M.F*i,"String",n)},jt=xt.trim=function(e,t){return e=String(q(e)),1&t&&(e=e.replace(Ct,"")),2&t&&(e=e.replace(Mt,"")),e},Rt=xt,At=n.parseInt,It=Rt.trim,Dt=/^[-+]?0[xX]/,Lt=8!==At(Tt+"08")||22!==At(Tt+"0x16")?function(e,t){var r=It(String(e),3);return At(r,t>>>0||(Dt.test(r)?16:10))}:At;M(M.G+M.F*(parseInt!=Lt),{parseInt:Lt});var Ft=n.parseFloat,Nt=Rt.trim,Ut=1/Ft(Tt+"-0")!=-1/0?function(e){var t=Nt(String(e),3),r=Ft(t);return 0===r&&"-"==t.charAt(0)?-0:r}:Ft;M(M.G+M.F*(parseFloat!=Ut),{parseFloat:Ut});var zt=dt.set,qt=function(e,t,r){var n,i=t.constructor;return i!==r&&"function"==typeof i&&(n=i.prototype)!==r.prototype&&c(n)&&zt&&zt(e,n),e},Bt=ge.f,Wt=Se.f,Vt=y.f,Gt=Rt.trim,Ht=n.Number,$t=Ht,Jt=Ht.prototype,Yt="Number"==U(he(Jt)),Kt="trim"in String.prototype,Xt=function(e){var t=v(e,!1);if("string"==typeof t&&t.length>2){var r,n,i,o=(t=Kt?t.trim():Gt(t,3)).charCodeAt(0);if(43===o||45===o){if(88===(r=t.charCodeAt(2))||120===r)return NaN}else if(48===o){switch(t.charCodeAt(1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+t}for(var a,u=t.slice(2),s=0,c=u.length;s<c;s++)if((a=u.charCodeAt(s))<48||a>i)return NaN;return parseInt(u,n)}}return+t};if(!Ht(" 0o1")||!Ht("0b1")||Ht("+0x1")){Ht=function(e){var t=arguments.length<1?0:e,r=this;return r instanceof Ht&&(Yt?a(function(){Jt.valueOf.call(r)}):"Number"!=U(r))?qt(new $t(Xt(t)),r,Ht):Xt(t)};for(var Zt,Qt=u?Bt($t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),er=0;Qt.length>er;er++)o($t,Zt=Qt[er])&&!o(Ht,Zt)&&Vt(Ht,Zt,Wt($t,Zt));Ht.prototype=Jt,Jt.constructor=Ht,P(n,"Number",Ht)}var tr=function(e,t){if("number"!=typeof e&&"Number"!=U(e))throw TypeError(t);return+e},rr=function(e){var t=String(q(this)),r="",n=G(e);if(n<0||n==1/0)throw RangeError("Count can't be negative");for(;n>0;(n>>>=1)&&(t+=t))1&n&&(r+=t);return r},nr=1..toFixed,ir=Math.floor,or=[0,0,0,0,0,0],ar="Number.toFixed: incorrect invocation!",ur=function(e,t){for(var r=-1,n=t;++r<6;)n+=e*or[r],or[r]=n%1e7,n=ir(n/1e7)},sr=function(e){for(var t=6,r=0;--t>=0;)r+=or[t],or[t]=ir(r/e),r=r%e*1e7},cr=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==or[e]){var r=String(or[e]);t=""===t?r:t+rr.call("0",7-r.length)+r}return t},lr=function(e,t,r){return 0===t?r:t%2==1?lr(e,t-1,r*e):lr(e*e,t/2,r)};M(M.P+M.F*(!!nr&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!a(function(){nr.call({})})),"Number",{toFixed:function(e){var t,r,n,i,o=tr(this,ar),a=G(e),u="",s="0";if(a<0||a>20)throw RangeError(ar);if(o!=o)return"NaN";if(o<=-1e21||o>=1e21)return String(o);if(o<0&&(u="-",o=-o),o>1e-21)if(r=(t=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t}(o*lr(2,69,1))-69)<0?o*lr(2,-t,1):o/lr(2,t,1),r*=4503599627370496,(t=52-t)>0){for(ur(0,r),n=a;n>=7;)ur(1e7,0),n-=7;for(ur(lr(10,n,1),0),n=t-1;n>=23;)sr(1<<23),n-=23;sr(1<<n),ur(1,1),sr(2),s=cr()}else ur(0,r),ur(1<<-t,0),s=cr()+rr.call("0",a);return s=a>0?u+((i=s.length)<=a?"0."+rr.call("0",a-i)+s:s.slice(0,i-a)+"."+s.slice(i-a)):u+s}});var fr=1..toPrecision;M(M.P+M.F*(a(function(){return"1"!==fr.call(1,void 0)})||!a(function(){fr.call({})})),"Number",{toPrecision:function(e){var t=tr(this,"Number#toPrecision: incorrect invocation!");return void 0===e?fr.call(t):fr.call(t,e)}}),M(M.S,"Number",{EPSILON:Math.pow(2,-52)});var dr=n.isFinite;M(M.S,"Number",{isFinite:function(e){return"number"==typeof e&&dr(e)}});var pr=Math.floor,hr=function(e){return!c(e)&&isFinite(e)&&pr(e)===e};M(M.S,"Number",{isInteger:hr}),M(M.S,"Number",{isNaN:function(e){return e!=e}});var vr=Math.abs;M(M.S,"Number",{isSafeInteger:function(e){return hr(e)&&vr(e)<=9007199254740991}}),M(M.S,"Number",{MAX_SAFE_INTEGER:9007199254740991}),M(M.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991}),M(M.S+M.F*(Number.parseFloat!=Ut),"Number",{parseFloat:Ut}),M(M.S+M.F*(Number.parseInt!=Lt),"Number",{parseInt:Lt});var gr=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)},yr=Math.sqrt,mr=Math.acosh;M(M.S+M.F*!(mr&&710==Math.floor(mr(Number.MAX_VALUE))&&mr(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?Math.log(e)+Math.LN2:gr(e-1+yr(e-1)*yr(e+1))}});var br=Math.asinh;M(M.S+M.F*!(br&&1/br(0)>0),"Math",{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}});var _r=Math.atanh;M(M.S+M.F*!(_r&&1/_r(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}});var wr=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1};M(M.S,"Math",{cbrt:function(e){return wr(e=+e)*Math.pow(Math.abs(e),1/3)}}),M(M.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}});var Sr=Math.exp;M(M.S,"Math",{cosh:function(e){return(Sr(e=+e)+Sr(-e))/2}});var kr=Math.expm1,Er=!kr||kr(10)>22025.465794806718||kr(10)<22025.465794806718||-2e-17!=kr(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:Math.exp(e)-1}:kr;M(M.S+M.F*(Er!=Math.expm1),"Math",{expm1:Er});var Pr=Math.pow,Tr=Pr(2,-52),Or=Pr(2,-23),Cr=Pr(2,127)*(2-Or),Mr=Pr(2,-126),xr=Math.fround||function(e){var t,r,n=Math.abs(e),i=wr(e);return n<Mr?i*(n/Mr/Or+1/Tr-1/Tr)*Mr*Or:(r=(t=(1+Or/Tr)*n)-(t-n))>Cr||r!=r?i*(1/0):i*r};M(M.S,"Math",{fround:xr});var jr=Math.abs;M(M.S,"Math",{hypot:function(e,t){for(var r,n,i=0,o=0,a=arguments.length,u=0;o<a;)u<(r=jr(arguments[o++]))?(i=i*(n=u/r)*n+1,u=r):i+=r>0?(n=r/u)*n:r;return u===1/0?1/0:u*Math.sqrt(i)}});var Rr=Math.imul;M(M.S+M.F*a(function(){return-5!=Rr(4294967295,5)||2!=Rr.length}),"Math",{imul:function(e,t){var r=+e,n=+t,i=65535&r,o=65535&n;return 0|i*o+((65535&r>>>16)*o+i*(65535&n>>>16)<<16>>>0)}}),M(M.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}}),M(M.S,"Math",{log1p:gr}),M(M.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}}),M(M.S,"Math",{sign:wr});var Ar=Math.exp;M(M.S+M.F*a(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(Er(e)-Er(-e))/2:(Ar(e-1)-Ar(-e-1))*(Math.E/2)}});var Ir=Math.exp;M(M.S,"Math",{tanh:function(e){var t=Er(e=+e),r=Er(-e);return t==1/0?1:r==1/0?-1:(t-r)/(Ir(e)+Ir(-e))}}),M(M.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}});var Dr=String.fromCharCode,Lr=String.fromCodePoint;M(M.S+M.F*(!!Lr&&1!=Lr.length),"String",{fromCodePoint:function(e){for(var t,r=[],n=arguments.length,i=0;n>i;){if(t=+arguments[i++],K(t,1114111)!==t)throw RangeError(t+" is not a valid code point");r.push(t<65536?Dr(t):Dr(55296+((t-=65536)>>10),t%1024+56320))}return r.join("")}}),M(M.S,"String",{raw:function(e){for(var t=B(e.raw),r=$(t.length),n=arguments.length,i=[],o=0;r>o;)i.push(String(t[o++])),o<n&&i.push(String(arguments[o]));return i.join("")}}),Rt("trim",function(e){return function(){return e(this,3)}});var Fr=function(e){return function(t,r){var n,i,o=String(q(t)),a=G(r),u=o.length;return a<0||a>=u?e?"":void 0:(n=o.charCodeAt(a))<55296||n>56319||a+1===u||(i=o.charCodeAt(a+1))<56320||i>57343?e?o.charAt(a):n:e?o.slice(a,a+2):i-56320+(n-55296<<10)+65536}},Nr={},Ur={};b(Ur,j("iterator"),function(){return this});var zr=function(e,t,r){e.prototype=he(Ur,{next:m(1,r)}),I(e,t+" Iterator")},qr=j("iterator"),Br=!([].keys&&"next"in[].keys()),Wr=function(){return this},Vr=function(e,t,r,n,i,o,a){zr(r,t,n);var u,s,c,l=function(e){if(!Br&&e in h)return h[e];switch(e){case"keys":case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},f=t+" Iterator",d="values"==i,p=!1,h=e.prototype,v=h[qr]||h["@@iterator"]||i&&h[i],g=v||l(i),y=i?d?l("entries"):g:void 0,m="Array"==t&&h.entries||v;if(m&&(c=it(m.call(new e)))!==Object.prototype&&c.next&&(I(c,f,!0),"function"!=typeof c[qr]&&b(c,qr,Wr)),d&&v&&"values"!==v.name&&(p=!0,g=function(){return v.call(this)}),(Br||p||!h[qr])&&b(h,qr,g),Nr[t]=g,Nr[f]=Wr,i)if(u={values:d?g:l("values"),keys:o?g:l("keys"),entries:y},a)for(s in u)s in h||P(h,s,u[s]);else M(M.P+M.F*(Br||p),t,u);return u},Gr=Fr(!0);Vr(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=Gr(t,r),this._i+=e.length,{value:e,done:!1})});var Hr=Fr(!1);M(M.P,"String",{codePointAt:function(e){return Hr(this,e)}});var $r=j("match"),Jr=function(e){var t;return c(e)&&(void 0!==(t=e[$r])?!!t:"RegExp"==U(e))},Yr=function(e,t,r){if(Jr(t))throw TypeError("String#"+r+" doesn't accept regex!");return String(q(e))},Kr=j("match"),Xr=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[Kr]=!1,!"/./"[e](t)}catch(e){}}return!0},Zr="".endsWith;M(M.P+M.F*Xr("endsWith"),"String",{endsWith:function(e){var t=Yr(this,e,"endsWith"),r=arguments.length>1?arguments[1]:void 0,n=$(t.length),i=void 0===r?n:Math.min($(r),n),o=String(e);return Zr?Zr.call(t,o,i):t.slice(i-o.length,i)===o}});M(M.P+M.F*Xr("includes"),"String",{includes:function(e){return!!~Yr(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}}),M(M.P,"String",{repeat:rr});var Qr="".startsWith;M(M.P+M.F*Xr("startsWith"),"String",{startsWith:function(e){var t=Yr(this,e,"startsWith"),r=$(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),n=String(e);return Qr?Qr.call(t,n,r):t.slice(r,r+n.length)===n}});var en=/"/g,tn=function(e,t,r,n){var i=String(q(e)),o="<"+t;return""!==r&&(o+=" "+r+'="'+String(n).replace(en,"&quot;")+'"'),o+">"+i+"</"+t+">"},rn=function(e,t){var r={};r[e]=t(tn),M(M.P+M.F*a(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}),"String",r)};rn("anchor",function(e){return function(t){return e(this,"a","name",t)}}),rn("big",function(e){return function(){return e(this,"big","","")}}),rn("blink",function(e){return function(){return e(this,"blink","","")}}),rn("bold",function(e){return function(){return e(this,"b","","")}}),rn("fixed",function(e){return function(){return e(this,"tt","","")}}),rn("fontcolor",function(e){return function(t){return e(this,"font","color",t)}}),rn("fontsize",function(e){return function(t){return e(this,"font","size",t)}}),rn("italics",function(e){return function(){return e(this,"i","","")}}),rn("link",function(e){return function(t){return e(this,"a","href",t)}}),rn("small",function(e){return function(){return e(this,"small","","")}}),rn("strike",function(e){return function(){return e(this,"strike","","")}}),rn("sub",function(e){return function(){return e(this,"sub","","")}}),rn("sup",function(e){return function(){return e(this,"sup","","")}}),M(M.S,"Date",{now:function(){return(new Date).getTime()}}),M(M.P+M.F*a(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(e){var t=tt(this),r=v(t);return"number"!=typeof r||isFinite(r)?t.toISOString():null}});var nn=Date.prototype.getTime,on=Date.prototype.toISOString,an=function(e){return e>9?e:"0"+e},un=a(function(){return"0385-07-25T07:06:39.999Z"!=on.call(new Date(-5e13-1))})||!a(function(){on.call(new Date(NaN))})?function(){if(!isFinite(nn.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),r=e.getUTCMilliseconds(),n=t<0?"-":t>9999?"+":"";return n+("00000"+Math.abs(t)).slice(n?-6:-4)+"-"+an(e.getUTCMonth()+1)+"-"+an(e.getUTCDate())+"T"+an(e.getUTCHours())+":"+an(e.getUTCMinutes())+":"+an(e.getUTCSeconds())+"."+(r>99?r:"0"+an(r))+"Z"}:on;M(M.P+M.F*(Date.prototype.toISOString!==un),"Date",{toISOString:un});var sn=Date.prototype,cn=sn.toString,ln=sn.getTime;new Date(NaN)+""!="Invalid Date"&&P(sn,"toString",function(){var e=ln.call(this);return e==e?cn.call(this):"Invalid Date"});var fn=j("toPrimitive"),dn=Date.prototype;fn in dn||b(dn,fn,function(e){if("string"!==e&&"number"!==e&&"default"!==e)throw TypeError("Incorrect hint");return v(l(this),"number"!=e)}),M(M.S,"Array",{isArray:ue});var pn=function(e,t,r,n){try{return n?t(l(r)[0],r[1]):t(r)}catch(t){var i=e.return;throw void 0!==i&&l(i.call(e)),t}},hn=j("iterator"),vn=Array.prototype,gn=function(e){return void 0!==e&&(Nr.Array===e||vn[hn]===e)},yn=function(e,t,r){t in e?y.f(e,t,m(0,r)):e[t]=r},mn=j("iterator"),bn=s.getIteratorMethod=function(e){if(null!=e)return e[mn]||e["@@iterator"]||Nr[vt(e)]},_n=j("iterator"),wn=!1;try{[7][_n]().return=function(){wn=!0}}catch(e){}var Sn=function(e,t){if(!t&&!wn)return!1;var r=!1;try{var n=[7],i=n[_n]();i.next=function(){return{done:r=!0}},n[_n]=function(){return i},e(n)}catch(e){}return r};M(M.S+M.F*!Sn(function(e){}),"Array",{from:function(e){var t,r,n,i,o=tt(e),a="function"==typeof this?this:Array,u=arguments.length,s=u>1?arguments[1]:void 0,c=void 0!==s,l=0,f=bn(o);if(c&&(s=O(s,u>2?arguments[2]:void 0,2)),null==f||a==Array&&gn(f))for(r=new a(t=$(o.length));t>l;l++)yn(r,l,c?s(o[l],l):o[l]);else for(i=f.call(o),r=new a;!(n=i.next()).done;l++)yn(r,l,c?pn(i,s,[n.value,l],!0):n.value);return r.length=l,r}}),M(M.S+M.F*a(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function(){for(var e=0,t=arguments.length,r=new("function"==typeof this?this:Array)(t);t>e;)yn(r,e,arguments[e++]);return r.length=t,r}});var kn=function(e,t){return!!e&&a(function(){t?e.call(null,function(){},1):e.call(null)})},En=[].join;M(M.P+M.F*(z!=Object||!kn(En)),"Array",{join:function(e){return En.call(B(this),void 0===e?",":e)}});var Pn=[].slice;M(M.P+M.F*a(function(){le&&Pn.call(le)}),"Array",{slice:function(e,t){var r=$(this.length),n=U(this);if(t=void 0===t?r:t,"Array"==n)return Pn.call(this,e,t);for(var i=K(e,r),o=K(t,r),a=$(o-i),u=new Array(a),s=0;s<a;s++)u[s]="String"==n?this.charAt(i+s):this[i+s];return u}});var Tn=[].sort,On=[1,2,3];M(M.P+M.F*(a(function(){On.sort(void 0)})||!a(function(){On.sort(null)})||!kn(Tn)),"Array",{sort:function(e){return void 0===e?Tn.call(tt(this)):Tn.call(tt(this),T(e))}});var Cn=j("species"),Mn=function(e,t){return new(function(e){var t;return ue(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!ue(t.prototype)||(t=void 0),c(t)&&null===(t=t[Cn])&&(t=void 0)),void 0===t?Array:t}(e))(t)},xn=function(e,t){var r=1==e,n=2==e,i=3==e,o=4==e,a=6==e,u=5==e||a,s=t||Mn;return function(t,c,l){for(var f,d,p=tt(t),h=z(p),v=O(c,l,3),g=$(h.length),y=0,m=r?s(t,g):n?s(t,0):void 0;g>y;y++)if((u||y in h)&&(d=v(f=h[y],y,p),e))if(r)m[y]=d;else if(d)switch(e){case 3:return!0;case 5:return f;case 6:return y;case 2:m.push(f)}else if(o)return!1;return a?-1:i||o?o:m}},jn=xn(0),Rn=kn([].forEach,!0);M(M.P+M.F*!Rn,"Array",{forEach:function(e){return jn(this,e,arguments[1])}});var An=xn(1);M(M.P+M.F*!kn([].map,!0),"Array",{map:function(e){return An(this,e,arguments[1])}});var In=xn(2);M(M.P+M.F*!kn([].filter,!0),"Array",{filter:function(e){return In(this,e,arguments[1])}});var Dn=xn(3);M(M.P+M.F*!kn([].some,!0),"Array",{some:function(e){return Dn(this,e,arguments[1])}});var Ln=xn(4);M(M.P+M.F*!kn([].every,!0),"Array",{every:function(e){return Ln(this,e,arguments[1])}});var Fn=function(e,t,r,n,i){T(t);var o=tt(e),a=z(o),u=$(o.length),s=i?u-1:0,c=i?-1:1;if(r<2)for(;;){if(s in a){n=a[s],s+=c;break}if(s+=c,i?s<0:u<=s)throw TypeError("Reduce of empty array with no initial value")}for(;i?s>=0:u>s;s+=c)s in a&&(n=t(n,a[s],s,o));return n};M(M.P+M.F*!kn([].reduce,!0),"Array",{reduce:function(e){return Fn(this,e,arguments.length,arguments[1],!1)}}),M(M.P+M.F*!kn([].reduceRight,!0),"Array",{reduceRight:function(e){return Fn(this,e,arguments.length,arguments[1],!0)}});var Nn=X(!1),Un=[].indexOf,zn=!!Un&&1/[1].indexOf(1,-0)<0;M(M.P+M.F*(zn||!kn(Un)),"Array",{indexOf:function(e){return zn?Un.apply(this,arguments)||0:Nn(this,e,arguments[1])}});var qn=[].lastIndexOf,Bn=!!qn&&1/[1].lastIndexOf(1,-0)<0;M(M.P+M.F*(Bn||!kn(qn)),"Array",{lastIndexOf:function(e){if(Bn)return qn.apply(this,arguments)||0;var t=B(this),r=$(t.length),n=r-1;for(arguments.length>1&&(n=Math.min(n,G(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in t&&t[n]===e)return n||0;return-1}});var Wn=[].copyWithin||function(e,t){var r=tt(this),n=$(r.length),i=K(e,n),o=K(t,n),a=arguments.length>2?arguments[2]:void 0,u=Math.min((void 0===a?n:K(a,n))-o,n-i),s=1;for(o<i&&i<o+u&&(s=-1,o+=u-1,i+=u-1);u-- >0;)o in r?r[i]=r[o]:delete r[i],i+=s,o+=s;return r},Vn=j("unscopables"),Gn=Array.prototype;null==Gn[Vn]&&b(Gn,Vn,{});var Hn=function(e){Gn[Vn][e]=!0};M(M.P,"Array",{copyWithin:Wn}),Hn("copyWithin");var $n=function(e){for(var t=tt(this),r=$(t.length),n=arguments.length,i=K(n>1?arguments[1]:void 0,r),o=n>2?arguments[2]:void 0,a=void 0===o?r:K(o,r);a>i;)t[i++]=e;return t};M(M.P,"Array",{fill:$n}),Hn("fill");var Jn=xn(5),Yn=!0;"find"in[]&&Array(1).find(function(){Yn=!1}),M(M.P+M.F*Yn,"Array",{find:function(e){return Jn(this,e,arguments.length>1?arguments[1]:void 0)}}),Hn("find");var Kn=xn(6),Xn=!0;"findIndex"in[]&&Array(1).findIndex(function(){Xn=!1}),M(M.P+M.F*Xn,"Array",{findIndex:function(e){return Kn(this,e,arguments.length>1?arguments[1]:void 0)}}),Hn("findIndex");var Zn=j("species"),Qn=function(e){var t=n[e];u&&t&&!t[Zn]&&y.f(t,Zn,{configurable:!0,get:function(){return this}})};Qn("Array");var ei=function(e,t){return{value:t,done:!!e}},ti=Vr(Array,"Array",function(e,t){this._t=B(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,ei(1)):ei(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])},"values");Nr.Arguments=Nr.Array,Hn("keys"),Hn("values"),Hn("entries");var ri=function(){var e=l(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},ni=y.f,ii=ge.f,oi=n.RegExp,ai=oi,ui=oi.prototype,si=/a/g,ci=/a/g,li=new oi(si)!==si;if(u&&(!li||a(function(){return ci[j("match")]=!1,oi(si)!=si||oi(ci)==ci||"/a/i"!=oi(si,"i")}))){oi=function(e,t){var r=this instanceof oi,n=Jr(e),i=void 0===t;return!r&&n&&e.constructor===oi&&i?e:qt(li?new ai(n&&!i?e.source:e,t):ai((n=e instanceof oi)?e.source:e,n&&i?ri.call(e):t),r?this:ui,oi)};for(var fi=function(e){e in oi||ni(oi,e,{configurable:!0,get:function(){return ai[e]},set:function(t){ai[e]=t}})},di=ii(ai),pi=0;di.length>pi;)fi(di[pi++]);ui.constructor=oi,oi.prototype=ui,P(n,"RegExp",oi)}Qn("RegExp");var hi=RegExp.prototype.exec,vi=String.prototype.replace,gi=hi,yi=function(){var e=/a/,t=/b*/g;return hi.call(e,"a"),hi.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),mi=void 0!==/()??/.exec("")[1];(yi||mi)&&(gi=function(e){var t,r,n,i,o=this;return mi&&(r=new RegExp("^"+o.source+"$(?!\\s)",ri.call(o))),yi&&(t=o.lastIndex),n=hi.call(o,e),yi&&n&&(o.lastIndex=o.global?n.index+n[0].length:t),mi&&n&&n.length>1&&vi.call(n[0],r,function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(n[i]=void 0)}),n});var bi=gi;M({target:"RegExp",proto:!0,forced:bi!==/./.exec},{exec:bi}),u&&"g"!=/./g.flags&&y.f(RegExp.prototype,"flags",{configurable:!0,get:ri});var _i=/./.toString,wi=function(e){P(RegExp.prototype,"toString",e,!0)};a(function(){return"/a/b"!=_i.call({source:"a",flags:"b"})})?wi(function(){var e=l(this);return"/".concat(e.source,"/","flags"in e?e.flags:!u&&e instanceof RegExp?ri.call(e):void 0)}):"toString"!=_i.name&&wi(function(){return _i.call(this)});var Si=Fr(!0),ki=function(e,t,r){return t+(r?Si(e,t).length:1)},Ei=RegExp.prototype.exec,Pi=function(e,t){var r=e.exec;if("function"==typeof r){var n=r.call(e,t);if("object"!=typeof n)throw new TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==vt(e))throw new TypeError("RegExp#exec called on incompatible receiver");return Ei.call(e,t)},Ti=j("species"),Oi=!a(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}),Ci=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2===r.length&&"a"===r[0]&&"b"===r[1]}(),Mi=function(e,t,r){var n=j(e),i=!a(function(){var t={};return t[n]=function(){return 7},7!=""[e](t)}),o=i?!a(function(){var t=!1,r=/a/;return r.exec=function(){return t=!0,null},"split"===e&&(r.constructor={},r.constructor[Ti]=function(){return r}),r[n](""),!t}):void 0;if(!i||!o||"replace"===e&&!Oi||"split"===e&&!Ci){var u=/./[n],s=r(q,n,""[e],function(e,t,r,n,o){return t.exec===bi?i&&!o?{done:!0,value:u.call(t,r,n)}:{done:!0,value:e.call(r,t,n)}:{done:!1}}),c=s[0],l=s[1];P(String.prototype,e,c),b(RegExp.prototype,n,2==t?function(e,t){return l.call(e,this,t)}:function(e){return l.call(e,this)})}};Mi("match",1,function(e,t,r,n){return[function(r){var n=e(this),i=null==r?void 0:r[t];return void 0!==i?i.call(r,n):new RegExp(r)[t](String(n))},function(e){var t=n(r,e,this);if(t.done)return t.value;var i=l(e),o=String(this);if(!i.global)return Pi(i,o);var a=i.unicode;i.lastIndex=0;for(var u,s=[],c=0;null!==(u=Pi(i,o));){var f=String(u[0]);s[c]=f,""===f&&(i.lastIndex=ki(o,$(i.lastIndex),a)),c++}return 0===c?null:s}]});var xi=Math.max,ji=Math.min,Ri=Math.floor,Ai=/\$([$&`']|\d\d?|<[^>]*>)/g,Ii=/\$([$&`']|\d\d?)/g;Mi("replace",2,function(e,t,r,n){return[function(n,i){var o=e(this),a=null==n?void 0:n[t];return void 0!==a?a.call(n,o,i):r.call(String(o),n,i)},function(e,t){var o=n(r,e,this,t);if(o.done)return o.value;var a=l(e),u=String(this),s="function"==typeof t;s||(t=String(t));var c=a.global;if(c){var f=a.unicode;a.lastIndex=0}for(var d=[];;){var p=Pi(a,u);if(null===p)break;if(d.push(p),!c)break;""===String(p[0])&&(a.lastIndex=ki(u,$(a.lastIndex),f))}for(var h,v="",g=0,y=0;y<d.length;y++){p=d[y];for(var m=String(p[0]),b=xi(ji(G(p.index),u.length),0),_=[],w=1;w<p.length;w++)_.push(void 0===(h=p[w])?h:String(h));var S=p.groups;if(s){var k=[m].concat(_,b,u);void 0!==S&&k.push(S);var E=String(t.apply(void 0,k))}else E=i(m,u,b,_,S,t);b>=g&&(v+=u.slice(g,b)+E,g=b+m.length)}return v+u.slice(g)}];function i(e,t,n,i,o,a){var u=n+e.length,s=i.length,c=Ii;return void 0!==o&&(o=tt(o),c=Ai),r.call(a,c,function(r,a){var c;switch(a.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,n);case"'":return t.slice(u);case"<":c=o[a.slice(1,-1)];break;default:var l=+a;if(0===l)return r;if(l>s){var f=Ri(l/10);return 0===f?r:f<=s?void 0===i[f-1]?a.charAt(1):i[f-1]+a.charAt(1):r}c=i[l-1]}return void 0===c?"":c})}}),Mi("search",1,function(e,t,r,n){return[function(r){var n=e(this),i=null==r?void 0:r[t];return void 0!==i?i.call(r,n):new RegExp(r)[t](String(n))},function(e){var t=n(r,e,this);if(t.done)return t.value;var i=l(e),o=String(this),a=i.lastIndex;lt(a,0)||(i.lastIndex=0);var u=Pi(i,o);return lt(i.lastIndex,a)||(i.lastIndex=a),null===u?-1:u.index}]});var Di=j("species"),Li=function(e,t){var r,n=l(e).constructor;return void 0===n||null==(r=l(n)[Di])?t:T(r)},Fi=Math.min,Ni=[].push,Ui=!a(function(){});Mi("split",2,function(e,t,r,n){var i;return i="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,t){var n=String(this);if(void 0===e&&0===t)return[];if(!Jr(e))return r.call(n,e,t);for(var i,o,a,u=[],s=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),c=0,l=void 0===t?4294967295:t>>>0,f=new RegExp(e.source,s+"g");(i=bi.call(f,n))&&!((o=f.lastIndex)>c&&(u.push(n.slice(c,i.index)),i.length>1&&i.index<n.length&&Ni.apply(u,i.slice(1)),a=i[0].length,c=o,u.length>=l));)f.lastIndex===i.index&&f.lastIndex++;return c===n.length?!a&&f.test("")||u.push(""):u.push(n.slice(c)),u.length>l?u.slice(0,l):u}:"0".split(void 0,0).length?function(e,t){return void 0===e&&0===t?[]:r.call(this,e,t)}:r,[function(r,n){var o=e(this),a=null==r?void 0:r[t];return void 0!==a?a.call(r,o,n):i.call(String(o),r,n)},function(e,t){var o=n(i,e,this,t,i!==r);if(o.done)return o.value;var a=l(e),u=String(this),s=Li(a,RegExp),c=a.unicode,f=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(Ui?"y":"g"),d=new s(Ui?a:"^(?:"+a.source+")",f),p=void 0===t?4294967295:t>>>0;if(0===p)return[];if(0===u.length)return null===Pi(d,u)?[u]:[];for(var h=0,v=0,g=[];v<u.length;){d.lastIndex=Ui?v:0;var y,m=Pi(d,Ui?u:u.slice(v));if(null===m||(y=Fi($(d.lastIndex+(Ui?0:v)),u.length))===h)v=ki(u,v,c);else{if(g.push(u.slice(h,v)),g.length===p)return g;for(var b=1;b<=m.length-1;b++)if(g.push(m[b]),g.length===p)return g;v=h=y}}return g.push(u.slice(h)),g}]});var zi,qi,Bi,Wi=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e},Vi=r(function(e){var t={},r={},n=e.exports=function(e,n,i,o,a){var u,s,c,f,d=a?function(){return e}:bn(e),p=O(i,o,n?2:1),h=0;if("function"!=typeof d)throw TypeError(e+" is not iterable!");if(gn(d)){for(u=$(e.length);u>h;h++)if((f=n?p(l(s=e[h])[0],s[1]):p(e[h]))===t||f===r)return f}else for(c=d.call(e);!(s=c.next()).done;)if((f=pn(c,p,s.value,n))===t||f===r)return f};n.BREAK=t,n.RETURN=r}),Gi=n.process,Hi=n.setImmediate,$i=n.clearImmediate,Ji=n.MessageChannel,Yi=n.Dispatch,Ki=0,Xi={},Zi=function(){var e=+this;if(Xi.hasOwnProperty(e)){var t=Xi[e];delete Xi[e],t()}},Qi=function(e){Zi.call(e.data)};Hi&&$i||(Hi=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return Xi[++Ki]=function(){yt("function"==typeof e?e:Function(e),t)},zi(Ki),Ki},$i=function(e){delete Xi[e]},"process"==U(Gi)?zi=function(e){Gi.nextTick(O(Zi,e,1))}:Yi&&Yi.now?zi=function(e){Yi.now(O(Zi,e,1))}:Ji?(Bi=(qi=new Ji).port2,qi.port1.onmessage=Qi,zi=O(Bi.postMessage,Bi,1)):n.addEventListener&&"function"==typeof postMessage&&!n.importScripts?(zi=function(e){n.postMessage(e+"","*")},n.addEventListener("message",Qi,!1)):zi="onreadystatechange"in p("script")?function(e){le.appendChild(p("script")).onreadystatechange=function(){le.removeChild(this),Zi.call(e)}}:function(e){setTimeout(O(Zi,e,1),0)});var eo={set:Hi,clear:$i},to=eo.set,ro=n.MutationObserver||n.WebKitMutationObserver,no=n.process,io=n.Promise,oo="process"==U(no),ao=function(){var e,t,r,i=function(){var n,i;for(oo&&(n=no.domain)&&n.exit();e;){i=e.fn,e=e.next;try{i()}catch(n){throw e?r():t=void 0,n}}t=void 0,n&&n.enter()};if(oo)r=function(){no.nextTick(i)};else if(!ro||n.navigator&&n.navigator.standalone)if(io&&io.resolve){var o=io.resolve(void 0);r=function(){o.then(i)}}else r=function(){to.call(n,i)};else{var a=!0,u=document.createTextNode("");new ro(i).observe(u,{characterData:!0}),r=function(){u.data=a=!a}}return function(n){var i={fn:n,next:void 0};t&&(t.next=i),e||(e=i,r()),t=i}};function uo(e){var t,r;this.promise=new e(function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n}),this.resolve=T(t),this.reject=T(r)}var so,co,lo,fo,po={f:function(e){return new uo(e)}},ho=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}},vo=n.navigator,go=vo&&vo.userAgent||"",yo=function(e,t){if(l(e),c(t)&&t.constructor===e)return t;var r=po.f(e);return(0,r.resolve)(t),r.promise},mo=function(e,t,r){for(var n in t)P(e,n,t[n],r);return e},bo=eo.set,_o=ao(),wo=n.TypeError,So=n.process,ko=So&&So.versions,Eo=ko&&ko.v8||"",Po=n.Promise,To="process"==vt(So),Oo=function(){},Co=co=po.f,Mo=!!function(){try{var e=Po.resolve(1),t=(e.constructor={})[j("species")]=function(e){e(Oo,Oo)};return(To||"function"==typeof PromiseRejectionEvent)&&e.then(Oo)instanceof t&&0!==Eo.indexOf("6.6")&&-1===go.indexOf("Chrome/66")}catch(e){}}(),xo=function(e){var t;return!(!c(e)||"function"!=typeof(t=e.then))&&t},jo=function(e,t){if(!e._n){e._n=!0;var r=e._c;_o(function(){for(var n=e._v,i=1==e._s,o=0,a=function(t){var r,o,a,u=i?t.ok:t.fail,s=t.resolve,c=t.reject,l=t.domain;try{u?(i||(2==e._h&&Io(e),e._h=1),!0===u?r=n:(l&&l.enter(),r=u(n),l&&(l.exit(),a=!0)),r===t.promise?c(wo("Promise-chain cycle")):(o=xo(r))?o.call(r,s,c):s(r)):c(n)}catch(e){l&&!a&&l.exit(),c(e)}};r.length>o;)a(r[o++]);e._c=[],e._n=!1,t&&!e._h&&Ro(e)})}},Ro=function(e){bo.call(n,function(){var t,r,i,o=e._v,a=Ao(e);if(a&&(t=ho(function(){To?So.emit("unhandledRejection",o,e):(r=n.onunhandledrejection)?r({promise:e,reason:o}):(i=n.console)&&i.error&&i.error("Unhandled promise rejection",o)}),e._h=To||Ao(e)?2:1),e._a=void 0,a&&t.e)throw t.v})},Ao=function(e){return 1!==e._h&&0===(e._a||e._c).length},Io=function(e){bo.call(n,function(){var t;To?So.emit("rejectionHandled",e):(t=n.onrejectionhandled)&&t({promise:e,reason:e._v})})},Do=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),jo(t,!0))},Lo=function(e){var t,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw wo("Promise can't be resolved itself");(t=xo(e))?_o(function(){var n={_w:r,_d:!1};try{t.call(e,O(Lo,n,1),O(Do,n,1))}catch(e){Do.call(n,e)}}):(r._v=e,r._s=1,jo(r,!1))}catch(e){Do.call({_w:r,_d:!1},e)}}};Mo||(Po=function(e){Wi(this,Po,"Promise","_h"),T(e),so.call(this);try{e(O(Lo,this,1),O(Do,this,1))}catch(e){Do.call(this,e)}},(so=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=mo(Po.prototype,{then:function(e,t){var r=Co(Li(this,Po));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=To?So.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&jo(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),lo=function(){var e=new so;this.promise=e,this.resolve=O(Lo,e,1),this.reject=O(Do,e,1)},po.f=Co=function(e){return e===Po||e===fo?new lo(e):co(e)}),M(M.G+M.W+M.F*!Mo,{Promise:Po}),I(Po,"Promise"),Qn("Promise"),fo=s.Promise,M(M.S+M.F*!Mo,"Promise",{reject:function(e){var t=Co(this);return(0,t.reject)(e),t.promise}}),M(M.S+M.F*!Mo,"Promise",{resolve:function(e){return yo(this,e)}}),M(M.S+M.F*!(Mo&&Sn(function(e){Po.all(e).catch(Oo)})),"Promise",{all:function(e){var t=this,r=Co(t),n=r.resolve,i=r.reject,o=ho(function(){var r=[],o=0,a=1;Vi(e,!1,function(e){var u=o++,s=!1;r.push(void 0),a++,t.resolve(e).then(function(e){s||(s=!0,r[u]=e,--a||n(r))},i)}),--a||n(r)});return o.e&&i(o.v),r.promise},race:function(e){var t=this,r=Co(t),n=r.reject,i=ho(function(){Vi(e,!1,function(e){t.resolve(e).then(r.resolve,n)})});return i.e&&n(i.v),r.promise}});var Fo=function(e,t){if(!c(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e},No=y.f,Uo=x.fastKey,zo=u?"_s":"size",qo=function(e,t){var r,n=Uo(t);if("F"!==n)return e._i[n];for(r=e._f;r;r=r.n)if(r.k==t)return r},Bo={getConstructor:function(e,t,r,n){var i=e(function(e,o){Wi(e,i,t,"_i"),e._t=t,e._i=he(null),e._f=void 0,e._l=void 0,e[zo]=0,null!=o&&Vi(o,r,e[n],e)});return mo(i.prototype,{clear:function(){for(var e=Fo(this,t),r=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];e._f=e._l=void 0,e[zo]=0},delete:function(e){var r=Fo(this,t),n=qo(r,e);if(n){var i=n.n,o=n.p;delete r._i[n.i],n.r=!0,o&&(o.n=i),i&&(i.p=o),r._f==n&&(r._f=i),r._l==n&&(r._l=o),r[zo]--}return!!n},forEach:function(e){Fo(this,t);for(var r,n=O(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!qo(Fo(this,t),e)}}),u&&No(i.prototype,"size",{get:function(){return Fo(this,t)[zo]}}),i},def:function(e,t,r){var n,i,o=qo(e,t);return o?o.v=r:(e._l=o={i:i=Uo(t,!0),k:t,v:r,p:n=e._l,n:void 0,r:!1},e._f||(e._f=o),n&&(n.n=o),e[zo]++,"F"!==i&&(e._i[i]=o)),e},getEntry:qo,setStrong:function(e,t,r){Vr(e,t,function(e,r){this._t=Fo(e,t),this._k=r,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?ei(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,ei(1))},r?"entries":"values",!r,!0),Qn(t)}},Wo=function(e,t,r,i,o,u){var s=n[e],l=s,f=o?"set":"add",d=l&&l.prototype,p={},h=function(e){var t=d[e];P(d,e,"delete"==e?function(e){return!(u&&!c(e))&&t.call(this,0===e?0:e)}:"has"==e?function(e){return!(u&&!c(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return u&&!c(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,r){return t.call(this,0===e?0:e,r),this})};if("function"==typeof l&&(u||d.forEach&&!a(function(){(new l).entries().next()}))){var v=new l,g=v[f](u?{}:-0,1)!=v,y=a(function(){v.has(1)}),m=Sn(function(e){new l(e)}),b=!u&&a(function(){for(var e=new l,t=5;t--;)e[f](t,t);return!e.has(-0)});m||((l=t(function(t,r){Wi(t,l,e);var n=qt(new s,t,l);return null!=r&&Vi(r,o,n[f],n),n})).prototype=d,d.constructor=l),(y||b)&&(h("delete"),h("has"),o&&h("get")),(b||g)&&h(f),u&&d.clear&&delete d.clear}else l=i.getConstructor(t,e,o,f),mo(l.prototype,r),x.NEED=!0;return I(l,e),p[e]=l,M(M.G+M.W+M.F*(l!=s),p),u||i.setStrong(l,e,o),l},Vo=Wo("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=Bo.getEntry(Fo(this,"Map"),e);return t&&t.v},set:function(e,t){return Bo.def(Fo(this,"Map"),0===e?0:e,t)}},Bo,!0),Go=Wo("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return Bo.def(Fo(this,"Set"),e=0===e?0:e,e)}},Bo),Ho=x.getWeak,$o=xn(5),Jo=xn(6),Yo=0,Ko=function(e){return e._l||(e._l=new Xo)},Xo=function(){this.a=[]},Zo=function(e,t){return $o(e.a,function(e){return e[0]===t})};Xo.prototype={get:function(e){var t=Zo(this,e);if(t)return t[1]},has:function(e){return!!Zo(this,e)},set:function(e,t){var r=Zo(this,e);r?r[1]=t:this.a.push([e,t])},delete:function(e){var t=Jo(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}};var Qo={getConstructor:function(e,t,r,n){var i=e(function(e,o){Wi(e,i,t,"_i"),e._t=t,e._i=Yo++,e._l=void 0,null!=o&&Vi(o,r,e[n],e)});return mo(i.prototype,{delete:function(e){if(!c(e))return!1;var r=Ho(e);return!0===r?Ko(Fo(this,t)).delete(e):r&&o(r,this._i)&&delete r[this._i]},has:function(e){if(!c(e))return!1;var r=Ho(e);return!0===r?Ko(Fo(this,t)).has(e):r&&o(r,this._i)}}),i},def:function(e,t,r){var n=Ho(l(t),!0);return!0===n?Ko(e).set(t,r):n[e._i]=r,e},ufstore:Ko},ea=r(function(e){var t,r=xn(0),i=Fo,o=!n.ActiveXObject&&"ActiveXObject"in n,a=x.getWeak,u=Object.isExtensible,s=Qo.ufstore,l=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},f={get:function(e){if(c(e)){var t=a(e);return!0===t?s(Fo(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return Qo.def(Fo(this,"WeakMap"),e,t)}},d=e.exports=Wo("WeakMap",l,f,Qo,!0,!0);i&&o&&(t=Qo.getConstructor(l,"WeakMap"),ct(t.prototype,f),x.NEED=!0,r(["delete","has","get","set"],function(e){var r=d.prototype,n=r[e];P(r,e,function(r,i){if(c(r)&&!u(r)){this._f||(this._f=new t);var o=this._f[e](r,i);return"set"==e?this:o}return n.call(this,r,i)})}))});Wo("WeakSet",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return Qo.def(Fo(this,"WeakSet"),e,!0)}},Qo,!1,!0);for(var ta,ra=S("typed_array"),na=S("view"),ia=!(!n.ArrayBuffer||!n.DataView),oa=ia,aa=0,ua="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");aa<9;)(ta=n[ua[aa++]])?(b(ta.prototype,ra,!0),b(ta.prototype,na,!0)):oa=!1;var sa={ABV:ia,CONSTR:oa,TYPED:ra,VIEW:na},ca=function(e){if(void 0===e)return 0;var t=G(e),r=$(t);if(t!==r)throw RangeError("Wrong length!");return r},la=r(function(e,t){var r=ge.f,i=y.f,o="prototype",s="Wrong index!",c=n.ArrayBuffer,l=n.DataView,f=n.Math,d=n.RangeError,p=n.Infinity,h=c,v=f.abs,g=f.pow,m=f.floor,_=f.log,w=f.LN2,S=u?"_b":"buffer",k=u?"_l":"byteLength",E=u?"_o":"byteOffset";function P(e,t,r){var n,i,o,a=new Array(r),u=8*r-t-1,s=(1<<u)-1,c=s>>1,l=23===t?g(2,-24)-g(2,-77):0,f=0,d=e<0||0===e&&1/e<0?1:0;for((e=v(e))!=e||e===p?(i=e!=e?1:0,n=s):(n=m(_(e)/w),e*(o=g(2,-n))<1&&(n--,o*=2),(e+=n+c>=1?l/o:l*g(2,1-c))*o>=2&&(n++,o/=2),n+c>=s?(i=0,n=s):n+c>=1?(i=(e*o-1)*g(2,t),n+=c):(i=e*g(2,c-1)*g(2,t),n=0));t>=8;a[f++]=255&i,i/=256,t-=8);for(n=n<<t|i,u+=t;u>0;a[f++]=255&n,n/=256,u-=8);return a[--f]|=128*d,a}function T(e,t,r){var n,i=8*r-t-1,o=(1<<i)-1,a=o>>1,u=i-7,s=r-1,c=e[s--],l=127&c;for(c>>=7;u>0;l=256*l+e[s],s--,u-=8);for(n=l&(1<<-u)-1,l>>=-u,u+=t;u>0;n=256*n+e[s],s--,u-=8);if(0===l)l=1-a;else{if(l===o)return n?NaN:c?-p:p;n+=g(2,t),l-=a}return(c?-1:1)*n*g(2,l-t)}function O(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function C(e){return[255&e]}function M(e){return[255&e,e>>8&255]}function x(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function j(e){return P(e,52,8)}function R(e){return P(e,23,4)}function A(e,t,r){i(e[o],t,{get:function(){return this[r]}})}function D(e,t,r,n){var i=ca(+r);if(i+t>e[k])throw d(s);var o=e[S]._b,a=i+e[E],u=o.slice(a,a+t);return n?u:u.reverse()}function L(e,t,r,n,i,o){var a=ca(+r);if(a+t>e[k])throw d(s);for(var u=e[S]._b,c=a+e[E],l=n(+i),f=0;f<t;f++)u[c+f]=l[o?f:t-f-1]}if(sa.ABV){if(!a(function(){c(1)})||!a(function(){new c(-1)})||a(function(){return new c,new c(1.5),new c(NaN),"ArrayBuffer"!=c.name})){for(var F,N=(c=function(e){return Wi(this,c),new h(ca(e))})[o]=h[o],U=r(h),z=0;U.length>z;)(F=U[z++])in c||b(c,F,h[F]);N.constructor=c}var q=new l(new c(2)),B=l[o].setInt8;q.setInt8(0,2147483648),q.setInt8(1,2147483649),!q.getInt8(0)&&q.getInt8(1)||mo(l[o],{setInt8:function(e,t){B.call(this,e,t<<24>>24)},setUint8:function(e,t){B.call(this,e,t<<24>>24)}},!0)}else c=function(e){Wi(this,c,"ArrayBuffer");var t=ca(e);this._b=$n.call(new Array(t),0),this[k]=t},l=function(e,t,r){Wi(this,l,"DataView"),Wi(e,c,"DataView");var n=e[k],i=G(t);if(i<0||i>n)throw d("Wrong offset!");if(i+(r=void 0===r?n-i:$(r))>n)throw d("Wrong length!");this[S]=e,this[E]=i,this[k]=r},u&&(A(c,"byteLength","_l"),A(l,"buffer","_b"),A(l,"byteLength","_l"),A(l,"byteOffset","_o")),mo(l[o],{getInt8:function(e){return D(this,1,e)[0]<<24>>24},getUint8:function(e){return D(this,1,e)[0]},getInt16:function(e){var t=D(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=D(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return O(D(this,4,e,arguments[1]))},getUint32:function(e){return O(D(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return T(D(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return T(D(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){L(this,1,e,C,t)},setUint8:function(e,t){L(this,1,e,C,t)},setInt16:function(e,t){L(this,2,e,M,t,arguments[2])},setUint16:function(e,t){L(this,2,e,M,t,arguments[2])},setInt32:function(e,t){L(this,4,e,x,t,arguments[2])},setUint32:function(e,t){L(this,4,e,x,t,arguments[2])},setFloat32:function(e,t){L(this,4,e,R,t,arguments[2])},setFloat64:function(e,t){L(this,8,e,j,t,arguments[2])}});I(c,"ArrayBuffer"),I(l,"DataView"),b(l[o],sa.VIEW,!0),t.ArrayBuffer=c,t.DataView=l}),fa=n.ArrayBuffer,da=la.ArrayBuffer,pa=la.DataView,ha=sa.ABV&&fa.isView,va=da.prototype.slice,ga=sa.VIEW;M(M.G+M.W+M.F*(fa!==da),{ArrayBuffer:da}),M(M.S+M.F*!sa.CONSTR,"ArrayBuffer",{isView:function(e){return ha&&ha(e)||c(e)&&ga in e}}),M(M.P+M.U+M.F*a(function(){return!new da(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(e,t){if(void 0!==va&&void 0===t)return va.call(l(this),e);for(var r=l(this).byteLength,n=K(e,r),i=K(void 0===t?r:t,r),o=new(Li(this,da))($(i-n)),a=new pa(this),u=new pa(o),s=0;n<i;)u.setUint8(s++,a.getUint8(n++));return o}}),Qn("ArrayBuffer"),M(M.G+M.W+M.F*!sa.ABV,{DataView:la.DataView});var ya=r(function(e){if(u){var t=n,r=a,i=M,s=sa,l=la,f=O,d=Wi,p=m,h=b,g=mo,_=G,w=$,k=ca,E=K,P=v,T=o,C=vt,x=c,R=tt,A=gn,I=he,D=it,L=ge.f,F=bn,N=S,U=j,z=xn,q=X,B=Li,W=ti,V=Nr,H=Sn,J=Qn,Y=$n,Z=Wn,Q=y,ee=Se,te=Q.f,re=ee.f,ne=t.RangeError,ie=t.TypeError,oe=t.Uint8Array,ae=Array.prototype,ue=l.ArrayBuffer,se=l.DataView,ce=z(0),le=z(2),fe=z(3),de=z(4),pe=z(5),ve=z(6),ye=q(!0),me=q(!1),be=W.values,_e=W.keys,we=W.entries,ke=ae.lastIndexOf,Ee=ae.reduce,Pe=ae.reduceRight,Te=ae.join,Oe=ae.sort,Ce=ae.slice,Me=ae.toString,xe=ae.toLocaleString,je=U("iterator"),Re=U("toStringTag"),Ae=N("typed_constructor"),Ie=N("def_constructor"),De=s.CONSTR,Le=s.TYPED,Fe=s.VIEW,Ne=z(1,function(e,t){return We(B(e,e[Ie]),t)}),Ue=r(function(){return 1===new oe(new Uint16Array([1]).buffer)[0]}),ze=!!oe&&!!oe.prototype.set&&r(function(){new oe(1).set({})}),qe=function(e,t){var r=_(e);if(r<0||r%t)throw ne("Wrong offset!");return r},Be=function(e){if(x(e)&&Le in e)return e;throw ie(e+" is not a typed array!")},We=function(e,t){if(!(x(e)&&Ae in e))throw ie("It is not a typed array constructor!");return new e(t)},Ve=function(e,t){return Ge(B(e,e[Ie]),t)},Ge=function(e,t){for(var r=0,n=t.length,i=We(e,n);n>r;)i[r]=t[r++];return i},He=function(e,t,r){te(e,t,{get:function(){return this._d[r]}})},$e=function(e){var t,r,n,i,o,a,u=R(e),s=arguments.length,c=s>1?arguments[1]:void 0,l=void 0!==c,d=F(u);if(null!=d&&!A(d)){for(a=d.call(u),n=[],t=0;!(o=a.next()).done;t++)n.push(o.value);u=n}for(l&&s>2&&(c=f(c,arguments[2],2)),t=0,r=w(u.length),i=We(this,r);r>t;t++)i[t]=l?c(u[t],t):u[t];return i},Je=function(){for(var e=0,t=arguments.length,r=We(this,t);t>e;)r[e]=arguments[e++];return r},Ye=!!oe&&r(function(){xe.call(new oe(1))}),Ke=function(){return xe.apply(Ye?Ce.call(Be(this)):Be(this),arguments)},Xe={copyWithin:function(e,t){return Z.call(Be(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return de(Be(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return Y.apply(Be(this),arguments)},filter:function(e){return Ve(this,le(Be(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return pe(Be(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return ve(Be(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){ce(Be(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return me(Be(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return ye(Be(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return Te.apply(Be(this),arguments)},lastIndexOf:function(e){return ke.apply(Be(this),arguments)},map:function(e){return Ne(Be(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return Ee.apply(Be(this),arguments)},reduceRight:function(e){return Pe.apply(Be(this),arguments)},reverse:function(){for(var e,t=Be(this).length,r=Math.floor(t/2),n=0;n<r;)e=this[n],this[n++]=this[--t],this[t]=e;return this},some:function(e){return fe(Be(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return Oe.call(Be(this),e)},subarray:function(e,t){var r=Be(this),n=r.length,i=E(e,n);return new(B(r,r[Ie]))(r.buffer,r.byteOffset+i*r.BYTES_PER_ELEMENT,w((void 0===t?n:E(t,n))-i))}},Ze=function(e,t){return Ve(this,Ce.call(Be(this),e,t))},Qe=function(e){Be(this);var t=qe(arguments[1],1),r=this.length,n=R(e),i=w(n.length),o=0;if(i+t>r)throw ne("Wrong length!");for(;o<i;)this[t+o]=n[o++]},et={entries:function(){return we.call(Be(this))},keys:function(){return _e.call(Be(this))},values:function(){return be.call(Be(this))}},rt=function(e,t){return x(e)&&e[Le]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},nt=function(e,t){return rt(e,t=P(t,!0))?p(2,e[t]):re(e,t)},ot=function(e,t,r){return!(rt(e,t=P(t,!0))&&x(r)&&T(r,"value"))||T(r,"get")||T(r,"set")||r.configurable||T(r,"writable")&&!r.writable||T(r,"enumerable")&&!r.enumerable?te(e,t,r):(e[t]=r.value,e)};De||(ee.f=nt,Q.f=ot),i(i.S+i.F*!De,"Object",{getOwnPropertyDescriptor:nt,defineProperty:ot}),r(function(){Me.call({})})&&(Me=xe=function(){return Te.call(this)});var at=g({},Xe);g(at,et),h(at,je,et.values),g(at,{slice:Ze,set:Qe,constructor:function(){},toString:Me,toLocaleString:Ke}),He(at,"buffer","b"),He(at,"byteOffset","o"),He(at,"byteLength","l"),He(at,"length","e"),te(at,Re,{get:function(){return this[Le]}}),e.exports=function(e,n,o,a){var u=e+((a=!!a)?"Clamped":"")+"Array",c="get"+e,l="set"+e,f=t[u],p=f||{},v=f&&D(f),g=!f||!s.ABV,y={},m=f&&f.prototype,b=function(e,t){te(e,t,{get:function(){return function(e,t){var r=e._d;return r.v[c](t*n+r.o,Ue)}(this,t)},set:function(e){return function(e,t,r){var i=e._d;a&&(r=(r=Math.round(r))<0?0:r>255?255:255&r),i.v[l](t*n+i.o,r,Ue)}(this,t,e)},enumerable:!0})};g?(f=o(function(e,t,r,i){d(e,f,u,"_d");var o,a,s,c,l=0,p=0;if(x(t)){if(!(t instanceof ue||"ArrayBuffer"==(c=C(t))||"SharedArrayBuffer"==c))return Le in t?Ge(f,t):$e.call(f,t);o=t,p=qe(r,n);var v=t.byteLength;if(void 0===i){if(v%n)throw ne("Wrong length!");if((a=v-p)<0)throw ne("Wrong length!")}else if((a=w(i)*n)+p>v)throw ne("Wrong length!");s=a/n}else s=k(t),o=new ue(a=s*n);for(h(e,"_d",{b:o,o:p,l:a,e:s,v:new se(o)});l<s;)b(e,l++)}),m=f.prototype=I(at),h(m,"constructor",f)):r(function(){f(1)})&&r(function(){new f(-1)})&&H(function(e){new f,new f(null),new f(1.5),new f(e)},!0)||(f=o(function(e,t,r,i){var o;return d(e,f,u),x(t)?t instanceof ue||"ArrayBuffer"==(o=C(t))||"SharedArrayBuffer"==o?void 0!==i?new p(t,qe(r,n),i):void 0!==r?new p(t,qe(r,n)):new p(t):Le in t?Ge(f,t):$e.call(f,t):new p(k(t))}),ce(v!==Function.prototype?L(p).concat(L(v)):L(p),function(e){e in f||h(f,e,p[e])}),f.prototype=m,m.constructor=f);var _=m[je],S=!!_&&("values"==_.name||null==_.name),E=et.values;h(f,Ae,!0),h(m,Le,u),h(m,Fe,!0),h(m,Ie,f),(a?new f(1)[Re]==u:Re in m)||te(m,Re,{get:function(){return u}}),y[u]=f,i(i.G+i.W+i.F*(f!=p),y),i(i.S,u,{BYTES_PER_ELEMENT:n}),i(i.S+i.F*r(function(){p.of.call(f,1)}),u,{from:$e,of:Je}),"BYTES_PER_ELEMENT"in m||h(m,"BYTES_PER_ELEMENT",n),i(i.P,u,Xe),J(u),i(i.P+i.F*ze,u,{set:Qe}),i(i.P+i.F*!S,u,et),m.toString!=Me&&(m.toString=Me),i(i.P+i.F*r(function(){new f(1).slice()}),u,{slice:Ze}),i(i.P+i.F*(r(function(){return[1,2].toLocaleString()!=new f([1,2]).toLocaleString()})||!r(function(){m.toLocaleString.call([1,2])})),u,{toLocaleString:Ke}),V[u]=S?_:E,S||h(m,je,E)}}else e.exports=function(){}});ya("Int8",1,function(e){return function(t,r,n){return e(this,t,r,n)}}),ya("Uint8",1,function(e){return function(t,r,n){return e(this,t,r,n)}}),ya("Uint8",1,function(e){return function(t,r,n){return e(this,t,r,n)}},!0),ya("Int16",2,function(e){return function(t,r,n){return e(this,t,r,n)}}),ya("Uint16",2,function(e){return function(t,r,n){return e(this,t,r,n)}}),ya("Int32",4,function(e){return function(t,r,n){return e(this,t,r,n)}}),ya("Uint32",4,function(e){return function(t,r,n){return e(this,t,r,n)}}),ya("Float32",4,function(e){return function(t,r,n){return e(this,t,r,n)}}),ya("Float64",8,function(e){return function(t,r,n){return e(this,t,r,n)}});var ma=(n.Reflect||{}).apply,ba=Function.apply;M(M.S+M.F*!a(function(){ma(function(){})}),"Reflect",{apply:function(e,t,r){var n=T(e),i=l(r);return ma?ma(n,t,i):ba.call(n,t,i)}});var _a=(n.Reflect||{}).construct,wa=a(function(){function e(){}return!(_a(function(){},[],e)instanceof e)}),Sa=!a(function(){_a(function(){})});M(M.S+M.F*(wa||Sa),"Reflect",{construct:function(e,t){T(e),l(t);var r=arguments.length<3?e:T(arguments[2]);if(Sa&&!wa)return _a(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(_t.apply(e,n))}var i=r.prototype,o=he(c(i)?i:Object.prototype),a=Function.apply.call(e,o,t);return c(a)?a:o}}),M(M.S+M.F*a(function(){Reflect.defineProperty(y.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(e,t,r){l(e),t=v(t,!0),l(r);try{return y.f(e,t,r),!0}catch(e){return!1}}});var ka=Se.f;M(M.S,"Reflect",{deleteProperty:function(e,t){var r=ka(l(e),t);return!(r&&!r.configurable)&&delete e[t]}});var Ea=function(e){this._t=l(e),this._i=0;var t,r=this._k=[];for(t in e)r.push(t)};zr(Ea,"Object",function(){var e,t=this._k;do{if(this._i>=t.length)return{value:void 0,done:!0}}while(!((e=t[this._i++])in this._t));return{value:e,done:!1}}),M(M.S,"Reflect",{enumerate:function(e){return new Ea(e)}}),M(M.S,"Reflect",{get:function e(t,r){var n,i,a=arguments.length<3?t:arguments[2];return l(t)===a?t[r]:(n=Se.f(t,r))?o(n,"value")?n.value:void 0!==n.get?n.get.call(a):void 0:c(i=it(t))?e(i,r,a):void 0}}),M(M.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return Se.f(l(e),t)}}),M(M.S,"Reflect",{getPrototypeOf:function(e){return it(l(e))}}),M(M.S,"Reflect",{has:function(e,t){return t in e}});var Pa=Object.isExtensible;M(M.S,"Reflect",{isExtensible:function(e){return l(e),!Pa||Pa(e)}});var Ta=n.Reflect,Oa=Ta&&Ta.ownKeys||function(e){var t=ge.f(l(e)),r=oe.f;return r?t.concat(r(e)):t};M(M.S,"Reflect",{ownKeys:Oa});var Ca=Object.preventExtensions;M(M.S,"Reflect",{preventExtensions:function(e){l(e);try{return Ca&&Ca(e),!0}catch(e){return!1}}}),M(M.S,"Reflect",{set:function e(t,r,n){var i,a,u=arguments.length<4?t:arguments[3],s=Se.f(l(t),r);if(!s){if(c(a=it(t)))return e(a,r,n,u);s=m(0)}if(o(s,"value")){if(!1===s.writable||!c(u))return!1;if(i=Se.f(u,r)){if(i.get||i.set||!1===i.writable)return!1;i.value=n,y.f(u,r,i)}else y.f(u,r,m(0,n));return!0}return void 0!==s.set&&(s.set.call(u,n),!0)}}),dt&&M(M.S,"Reflect",{setPrototypeOf:function(e,t){dt.check(e,t);try{return dt.set(e,t),!0}catch(e){return!1}}});var Ma=X(!0);M(M.P,"Array",{includes:function(e){return Ma(this,e,arguments.length>1?arguments[1]:void 0)}}),Hn("includes");var xa=j("isConcatSpreadable");var ja=function e(t,r,n,i,o,a,u,s){for(var l,f,d=o,p=0,h=!!u&&O(u,s,3);p<i;){if(p in n){if(l=h?h(n[p],p,r):n[p],f=!1,c(l)&&(f=void 0!==(f=l[xa])?!!f:ue(l)),f&&a>0)d=e(t,r,l,$(l.length),d,a-1)-1;else{if(d>=9007199254740991)throw TypeError();t[d]=l}d++}p++}return d};M(M.P,"Array",{flatMap:function(e){var t,r,n=tt(this);return T(e),t=$(n.length),r=Mn(n,0),ja(r,n,n,t,0,1,e,arguments[1]),r}}),Hn("flatMap"),M(M.P,"Array",{flatten:function(){var e=arguments[0],t=tt(this),r=$(t.length),n=Mn(t,0);return ja(n,t,t,r,0,void 0===e?1:G(e)),n}}),Hn("flatten");var Ra=Fr(!0);M(M.P,"String",{at:function(e){return Ra(this,e)}});var Aa=function(e,t,r,n){var i=String(q(e)),o=i.length,a=void 0===r?" ":String(r),u=$(t);if(u<=o||""==a)return i;var s=u-o,c=rr.call(a,Math.ceil(s/a.length));return c.length>s&&(c=c.slice(0,s)),n?c+i:i+c},Ia=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(go);M(M.P+M.F*Ia,"String",{padStart:function(e){return Aa(this,e,arguments.length>1?arguments[1]:void 0,!0)}});var Da=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(go);M(M.P+M.F*Da,"String",{padEnd:function(e){return Aa(this,e,arguments.length>1?arguments[1]:void 0,!1)}}),Rt("trimLeft",function(e){return function(){return e(this,1)}},"trimStart"),Rt("trimRight",function(e){return function(){return e(this,2)}},"trimEnd");var La=RegExp.prototype,Fa=function(e,t){this._r=e,this._s=t};zr(Fa,"RegExp String",function(){var e=this._r.exec(this._s);return{value:e,done:null===e}}),M(M.P,"String",{matchAll:function(e){if(q(this),!Jr(e))throw TypeError(e+" is not a regexp!");var t=String(this),r="flags"in La?String(e.flags):ri.call(e),n=new RegExp(e.source,~r.indexOf("g")?r:"g"+r);return n.lastIndex=$(e.lastIndex),new Fa(n,t)}}),F("asyncIterator"),F("observable"),M(M.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,r,n=B(e),i=Se.f,o=Oa(n),a={},u=0;o.length>u;)void 0!==(r=i(n,t=o[u++]))&&yn(a,t,r);return a}});var Na=ae.f,Ua=function(e){return function(t){for(var r,n=B(t),i=ie(n),o=i.length,a=0,u=[];o>a;)Na.call(n,r=i[a++])&&u.push(e?[r,n[r]]:n[r]);return u}},za=Ua(!1);M(M.S,"Object",{values:function(e){return za(e)}});var qa=Ua(!0);M(M.S,"Object",{entries:function(e){return qa(e)}});var Ba=!a(function(){var e=Math.random();__defineSetter__.call(null,e,function(){}),delete n[e]});u&&M(M.P+Ba,"Object",{__defineGetter__:function(e,t){y.f(tt(this),e,{get:T(t),enumerable:!0,configurable:!0})}}),u&&M(M.P+Ba,"Object",{__defineSetter__:function(e,t){y.f(tt(this),e,{set:T(t),enumerable:!0,configurable:!0})}});var Wa=Se.f;u&&M(M.P+Ba,"Object",{__lookupGetter__:function(e){var t,r=tt(this),n=v(e,!0);do{if(t=Wa(r,n))return t.get}while(r=it(r))}});var Va=Se.f;u&&M(M.P+Ba,"Object",{__lookupSetter__:function(e){var t,r=tt(this),n=v(e,!0);do{if(t=Va(r,n))return t.set}while(r=it(r))}});var Ga=function(e,t){var r=[];return Vi(e,!1,r.push,r,t),r},Ha=function(e){return function(){if(vt(this)!=e)throw TypeError(e+"#toJSON isn't generic");return Ga(this)}};M(M.P+M.R,"Map",{toJSON:Ha("Map")}),M(M.P+M.R,"Set",{toJSON:Ha("Set")});var $a=function(e){M(M.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})};$a("Map"),$a("Set"),$a("WeakMap"),$a("WeakSet");var Ja=function(e){M(M.S,e,{from:function(e){var t,r,n,i,o=arguments[1];return T(this),(t=void 0!==o)&&T(o),null==e?new this:(r=[],t?(n=0,i=O(o,arguments[2],2),Vi(e,!1,function(e){r.push(i(e,n++))})):Vi(e,!1,r.push,r),new this(r))}})};Ja("Map"),Ja("Set"),Ja("WeakMap"),Ja("WeakSet"),M(M.G,{global:n}),M(M.S,"System",{global:n}),M(M.S,"Error",{isError:function(e){return"Error"===U(e)}}),M(M.S,"Math",{clamp:function(e,t,r){return Math.min(r,Math.max(t,e))}}),M(M.S,"Math",{DEG_PER_RAD:Math.PI/180});var Ya=180/Math.PI;M(M.S,"Math",{degrees:function(e){return e*Ya}});var Ka=Math.scale||function(e,t,r,n,i){return 0===arguments.length||e!=e||t!=t||r!=r||n!=n||i!=i?NaN:e===1/0||e===-1/0?e:(e-t)*(i-n)/(r-t)+n};M(M.S,"Math",{fscale:function(e,t,r,n,i){return xr(Ka(e,t,r,n,i))}}),M(M.S,"Math",{iaddh:function(e,t,r,n){var i=e>>>0,o=r>>>0;return(t>>>0)+(n>>>0)+((i&o|(i|o)&~(i+o>>>0))>>>31)|0}}),M(M.S,"Math",{isubh:function(e,t,r,n){var i=e>>>0,o=r>>>0;return(t>>>0)-(n>>>0)-((~i&o|~(i^o)&i-o>>>0)>>>31)|0}}),M(M.S,"Math",{imulh:function(e,t){var r=+e,n=+t,i=65535&r,o=65535&n,a=r>>16,u=n>>16,s=(a*o>>>0)+(i*o>>>16);return a*u+(s>>16)+((i*u>>>0)+(65535&s)>>16)}}),M(M.S,"Math",{RAD_PER_DEG:180/Math.PI});var Xa=Math.PI/180;M(M.S,"Math",{radians:function(e){return e*Xa}}),M(M.S,"Math",{scale:Ka}),M(M.S,"Math",{umulh:function(e,t){var r=+e,n=+t,i=65535&r,o=65535&n,a=r>>>16,u=n>>>16,s=(a*o>>>0)+(i*o>>>16);return a*u+(s>>>16)+((i*u>>>0)+(65535&s)>>>16)}}),M(M.S,"Math",{signbit:function(e){return(e=+e)!=e?e:0==e?1/e==1/0:e>0}}),M(M.P+M.R,"Promise",{finally:function(e){var t=Li(this,s.Promise||n.Promise),r="function"==typeof e;return this.then(r?function(r){return yo(t,e()).then(function(){return r})}:e,r?function(r){return yo(t,e()).then(function(){throw r})}:e)}}),M(M.S,"Promise",{try:function(e){var t=po.f(this),r=ho(e);return(r.e?t.reject:t.resolve)(r.v),t.promise}});var Za=k("metadata"),Qa=Za.store||(Za.store=new ea),eu=function(e,t,r){var n=Qa.get(e);if(!n){if(!r)return;Qa.set(e,n=new Vo)}var i=n.get(t);if(!i){if(!r)return;n.set(t,i=new Vo)}return i},tu={store:Qa,map:eu,has:function(e,t,r){var n=eu(t,r,!1);return void 0!==n&&n.has(e)},get:function(e,t,r){var n=eu(t,r,!1);return void 0===n?void 0:n.get(e)},set:function(e,t,r,n){eu(r,n,!0).set(e,t)},keys:function(e,t){var r=eu(e,t,!1),n=[];return r&&r.forEach(function(e,t){n.push(t)}),n},key:function(e){return void 0===e||"symbol"==typeof e?e:String(e)},exp:function(e){M(M.S,"Reflect",e)}},ru=tu.key,nu=tu.set;tu.exp({defineMetadata:function(e,t,r,n){nu(e,t,l(r),ru(n))}});var iu=tu.key,ou=tu.map,au=tu.store;tu.exp({deleteMetadata:function(e,t){var r=arguments.length<3?void 0:iu(arguments[2]),n=ou(l(t),r,!1);if(void 0===n||!n.delete(e))return!1;if(n.size)return!0;var i=au.get(t);return i.delete(r),!!i.size||au.delete(t)}});var uu=tu.has,su=tu.get,cu=tu.key,lu=function(e,t,r){if(uu(e,t,r))return su(e,t,r);var n=it(t);return null!==n?lu(e,n,r):void 0};tu.exp({getMetadata:function(e,t){return lu(e,l(t),arguments.length<3?void 0:cu(arguments[2]))}});var fu=tu.keys,du=tu.key,pu=function(e,t){var r=fu(e,t),n=it(e);if(null===n)return r;var i=pu(n,t);return i.length?r.length?Ga(new Go(r.concat(i))):i:r};tu.exp({getMetadataKeys:function(e){return pu(l(e),arguments.length<2?void 0:du(arguments[1]))}});var hu=tu.get,vu=tu.key;tu.exp({getOwnMetadata:function(e,t){return hu(e,l(t),arguments.length<3?void 0:vu(arguments[2]))}});var gu=tu.keys,yu=tu.key;tu.exp({getOwnMetadataKeys:function(e){return gu(l(e),arguments.length<2?void 0:yu(arguments[1]))}});var mu=tu.has,bu=tu.key,_u=function(e,t,r){if(mu(e,t,r))return!0;var n=it(t);return null!==n&&_u(e,n,r)};tu.exp({hasMetadata:function(e,t){return _u(e,l(t),arguments.length<3?void 0:bu(arguments[2]))}});var wu=tu.has,Su=tu.key;tu.exp({hasOwnMetadata:function(e,t){return wu(e,l(t),arguments.length<3?void 0:Su(arguments[2]))}});var ku=tu.key,Eu=tu.set;tu.exp({metadata:function(e,t){return function(r,n){Eu(e,t,(void 0!==n?l:T)(r),ku(n))}}});var Pu=ao(),Tu=n.process,Ou="process"==U(Tu);M(M.G,{asap:function(e){var t=Ou&&Tu.domain;Pu(t?t.bind(e):e)}});var Cu=ao(),Mu=j("observable"),xu=Vi.RETURN,ju=function(e){return null==e?void 0:T(e)},Ru=function(e){var t=e._c;t&&(e._c=void 0,t())},Au=function(e){return void 0===e._o},Iu=function(e){Au(e)||(e._o=void 0,Ru(e))},Du=function(e,t){l(e),this._c=void 0,this._o=e,e=new Lu(this);try{var r=t(e),n=r;null!=r&&("function"==typeof r.unsubscribe?r=function(){n.unsubscribe()}:T(r),this._c=r)}catch(t){return void e.error(t)}Au(this)&&Ru(this)};Du.prototype=mo({},{unsubscribe:function(){Iu(this)}});var Lu=function(e){this._s=e};Lu.prototype=mo({},{next:function(e){var t=this._s;if(!Au(t)){var r=t._o;try{var n=ju(r.next);if(n)return n.call(r,e)}catch(e){try{Iu(t)}finally{throw e}}}},error:function(e){var t=this._s;if(Au(t))throw e;var r=t._o;t._o=void 0;try{var n=ju(r.error);if(!n)throw e;e=n.call(r,e)}catch(e){try{Ru(t)}finally{throw e}}return Ru(t),e},complete:function(e){var t=this._s;if(!Au(t)){var r=t._o;t._o=void 0;try{var n=ju(r.complete);e=n?n.call(r,e):void 0}catch(e){try{Ru(t)}finally{throw e}}return Ru(t),e}}});var Fu=function(e){Wi(this,Fu,"Observable","_f")._f=T(e)};mo(Fu.prototype,{subscribe:function(e){return new Du(e,this._f)},forEach:function(e){var t=this;return new(s.Promise||n.Promise)(function(r,n){T(e);var i=t.subscribe({next:function(t){try{return e(t)}catch(e){n(e),i.unsubscribe()}},error:n,complete:r})})}}),mo(Fu,{from:function(e){var t="function"==typeof this?this:Fu,r=ju(l(e)[Mu]);if(r){var n=l(r.call(e));return n.constructor===t?n:new t(function(e){return n.subscribe(e)})}return new t(function(t){var r=!1;return Cu(function(){if(!r){try{if(Vi(e,!1,function(e){if(t.next(e),r)return xu})===xu)return}catch(e){if(r)throw e;return void t.error(e)}t.complete()}}),function(){r=!0}})},of:function(){for(var e=0,t=arguments.length,r=new Array(t);e<t;)r[e]=arguments[e++];return new("function"==typeof this?this:Fu)(function(e){var t=!1;return Cu(function(){if(!t){for(var n=0;n<r.length;++n)if(e.next(r[n]),t)return;e.complete()}}),function(){t=!0}})}}),b(Fu.prototype,Mu,function(){return this}),M(M.G,{Observable:Fu}),Qn("Observable");var Nu=[].slice,Uu=/MSIE .\./.test(go),zu=function(e){return function(t,r){var n=arguments.length>2,i=!!n&&Nu.call(arguments,2);return e(n?function(){("function"==typeof t?t:Function(t)).apply(this,i)}:t,r)}};M(M.G+M.B+M.F*Uu,{setTimeout:zu(n.setTimeout),setInterval:zu(n.setInterval)}),M(M.G+M.B,{setImmediate:eo.set,clearImmediate:eo.clear});for(var qu=j("iterator"),Bu=j("toStringTag"),Wu=Nr.Array,Vu={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},Gu=ie(Vu),Hu=0;Hu<Gu.length;Hu++){var $u,Ju=Gu[Hu],Yu=Vu[Ju],Ku=n[Ju],Xu=Ku&&Ku.prototype;if(Xu&&(Xu[qu]||b(Xu,qu,Wu),Xu[Bu]||b(Xu,Bu,Ju),Nr[Ju]=Wu,Yu))for($u in ti)Xu[$u]||P(Xu,$u,ti[$u],!0)}r(function(t){!function(e){var r,n=Object.prototype,i=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag",c=e.regeneratorRuntime;if(c)t.exports=c;else{(c=e.regeneratorRuntime=t.exports).wrap=b;var l="suspendedStart",f="suspendedYield",d="executing",p="completed",h={},v={};v[a]=function(){return this};var g=Object.getPrototypeOf,y=g&&g(g(x([])));y&&y!==n&&i.call(y,a)&&(v=y);var m=k.prototype=w.prototype=Object.create(v);S.prototype=m.constructor=k,k.constructor=S,k[s]=S.displayName="GeneratorFunction",c.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===S||"GeneratorFunction"===(t.displayName||t.name))},c.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,k):(e.__proto__=k,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(m),e},c.awrap=function(e){return{__await:e}},E(P.prototype),P.prototype[u]=function(){return this},c.AsyncIterator=P,c.async=function(e,t,r,n){var i=new P(b(e,t,r,n));return c.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},E(m),m[s]="Generator",m[a]=function(){return this},m.toString=function(){return"[object Generator]"},c.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},c.values=x,M.prototype={constructor:M,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=r)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,i){return u.type="throw",u.arg=e,t.next=n,i&&(t.method="next",t.arg=r),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;C(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:x(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=r),h}}}function b(e,t,r,n){var i=t&&t.prototype instanceof w?t:w,o=Object.create(i.prototype),a=new M(n||[]);return o._invoke=function(e,t,r){var n=l;return function(i,o){if(n===d)throw new Error("Generator is already running");if(n===p){if("throw"===i)throw o;return j()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var u=T(a,r);if(u){if(u===h)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===l)throw n=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=d;var s=_(e,t,r);if("normal"===s.type){if(n=r.done?p:f,s.arg===h)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n=p,r.method="throw",r.arg=s.arg)}}}(e,r,a),o}function _(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}function w(){}function S(){}function k(){}function E(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function P(t){function r(e,n,o,a){var u=_(t[e],t,n);if("throw"!==u.type){var s=u.arg,c=s.value;return c&&"object"==typeof c&&i.call(c,"__await")?Promise.resolve(c.__await).then(function(e){r("next",e,o,a)},function(e){r("throw",e,o,a)}):Promise.resolve(c).then(function(e){s.value=e,o(s)},a)}a(u.arg)}var n;"object"==typeof e.process&&e.process.domain&&(r=e.process.domain.bind(r)),this._invoke=function(e,t){function i(){return new Promise(function(n,i){r(e,t,n,i)})}return n=n?n.then(i,i):i()}}function T(e,t){var n=e.iterator[t.method];if(n===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=r,T(e,t),"throw"===t.method))return h;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var i=_(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,h;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=r),t.delegate=null,h):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function x(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=r,t.done=!0,t};return o.next=o}}return{next:j}}function j(){return{value:r,done:!0}}}("object"==typeof e?e:"object"==typeof window?window:"object"==typeof self?self:e)});var Zu=function(e,t){var r=t===Object(t)?function(e){return t[e]}:t;return function(t){return String(t).replace(e,r)}}(/[\\^$*+?.()|[\]{}]/g,"\\$&");M(M.S,"RegExp",{escape:function(e){return Zu(e)}});s.RegExp.escape;if(e._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");e._babelPolyfill=!0;var Qu="defineProperty";function es(e,t,r){e[t]||Object[Qu](e,t,{writable:!0,configurable:!0,value:r})}es(String.prototype,"padLeft","".padStart),es(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(e){[][e]&&es(Array,e,Function.call.bind([][e]))});var ts="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function rs(){throw new Error("setTimeout has not been defined")}function ns(){throw new Error("clearTimeout has not been defined")}var is=rs,os=ns;function as(e){if(is===setTimeout)return setTimeout(e,0);if((is===rs||!is)&&setTimeout)return is=setTimeout,setTimeout(e,0);try{return is(e,0)}catch(t){try{return is.call(null,e,0)}catch(t){return is.call(this,e,0)}}}"function"==typeof ts.setTimeout&&(is=setTimeout),"function"==typeof ts.clearTimeout&&(os=clearTimeout);var us,ss=[],cs=!1,ls=-1;function fs(){cs&&us&&(cs=!1,us.length?ss=us.concat(ss):ls=-1,ss.length&&ds())}function ds(){if(!cs){var e=as(fs);cs=!0;for(var t=ss.length;t;){for(us=ss,ss=[];++ls<t;)us&&us[ls].run();ls=-1,t=ss.length}us=null,cs=!1,function(e){if(os===clearTimeout)return clearTimeout(e);if((os===ns||!os)&&clearTimeout)return os=clearTimeout,clearTimeout(e);try{os(e)}catch(t){try{return os.call(null,e)}catch(t){return os.call(this,e)}}}(e)}}function ps(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];ss.push(new hs(e,t)),1!==ss.length||cs||as(ds)}function hs(e,t){this.fun=e,this.array=t}hs.prototype.run=function(){this.fun.apply(null,this.array)};function vs(){}var gs=vs,ys=vs,ms=vs,bs=vs,_s=vs,ws=vs,Ss=vs;var ks=ts.performance||{},Es=ks.now||ks.mozNow||ks.msNow||ks.oNow||ks.webkitNow||function(){return(new Date).getTime()};var Ps=new Date;var Ts={nextTick:ps,title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:gs,addListener:ys,once:ms,off:bs,removeListener:_s,removeAllListeners:ws,emit:Ss,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*Es.call(ks),r=Math.floor(t),n=Math.floor(t%1*1e9);return e&&(r-=e[0],(n-=e[1])<0&&(r--,n+=1e9)),[r,n]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-Ps)/1e3}},Os={}.toString,Cs=function(e){return Os.call(e).slice(8,-1)},Ms=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==Cs(e)?e.split(""):Object(e)},xs=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},js=function(e){return Ms(xs(e))},Rs={f:{}.propertyIsEnumerable},As=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},Is=function(e){return"object"==typeof e?null!==e:"function"==typeof e},Ds=function(e,t){if(!Is(e))return e;var r,n;if(t&&"function"==typeof(r=e.toString)&&!Is(n=r.call(e)))return n;if("function"==typeof(r=e.valueOf)&&!Is(n=r.call(e)))return n;if(!t&&"function"==typeof(r=e.toString)&&!Is(n=r.call(e)))return n;throw TypeError("Can't convert object to primitive value")},Ls={}.hasOwnProperty,Fs=function(e,t){return Ls.call(e,t)},Ns=function(e){try{return!!e()}catch(e){return!0}},Us=!Ns(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),zs=r(function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)}),qs=zs.document,Bs=Is(qs)&&Is(qs.createElement),Ws=function(e){return Bs?qs.createElement(e):{}},Vs=!Us&&!Ns(function(){return 7!=Object.defineProperty(Ws("div"),"a",{get:function(){return 7}}).a}),Gs=Object.getOwnPropertyDescriptor,Hs={f:Us?Gs:function(e,t){if(e=js(e),t=Ds(t,!0),Vs)try{return Gs(e,t)}catch(e){}if(Fs(e,t))return As(!Rs.f.call(e,t),e[t])}},$s=r(function(e){var t=e.exports={version:"2.6.5"};"number"==typeof __e&&(__e=t)}),Js=($s.version,function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}),Ys=function(e,t,r){if(Js(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}},Ks=function(e){if(!Is(e))throw TypeError(e+" is not an object!");return e},Xs=Object.defineProperty,Zs={f:Us?Object.defineProperty:function(e,t,r){if(Ks(e),t=Ds(t,!0),Ks(r),Vs)try{return Xs(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},Qs=Us?function(e,t,r){return Zs.f(e,t,As(1,r))}:function(e,t,r){return e[t]=r,e},ec=function(e,t,r){var n,i,o,a=e&ec.F,u=e&ec.G,s=e&ec.S,c=e&ec.P,l=e&ec.B,f=e&ec.W,d=u?$s:$s[t]||($s[t]={}),p=d.prototype,h=u?zs:s?zs[t]:(zs[t]||{}).prototype;for(n in u&&(r=t),r)(i=!a&&h&&void 0!==h[n])&&Fs(d,n)||(o=i?h[n]:r[n],d[n]=u&&"function"!=typeof h[n]?r[n]:l&&i?Ys(o,zs):f&&h[n]==o?function(e){var t=function(t,r,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,n)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(o):c&&"function"==typeof o?Ys(Function.call,o):o,c&&((d.virtual||(d.virtual={}))[n]=o,e&ec.R&&p&&!p[n]&&Qs(p,n,o)))};ec.F=1,ec.G=2,ec.S=4,ec.P=8,ec.B=16,ec.W=32,ec.U=64,ec.R=128;var tc=ec,rc=function(e,t){var r=($s.Object||{})[e]||Object[e],n={};n[e]=t(r),tc(tc.S+tc.F*Ns(function(){r(1)}),"Object",n)},nc=Hs.f;rc("getOwnPropertyDescriptor",function(){return function(e,t){return nc(js(e),t)}});var ic=$s.Object,oc=function(e,t){return ic.getOwnPropertyDescriptor(e,t)},ac=r(function(e){e.exports={default:oc,__esModule:!0}});t(ac);var uc=Hs.f;tc(tc.S,"Reflect",{deleteProperty:function(e,t){var r=uc(Ks(e),t);return!(r&&!r.configurable)&&delete e[t]}});var sc=$s.Reflect.deleteProperty,cc=r(function(e){e.exports={default:sc,__esModule:!0}});t(cc);var lc,fc=Math.ceil,dc=Math.floor,pc=function(e){return isNaN(e=+e)?0:(e>0?dc:fc)(e)},hc=Qs,vc={},gc=Math.min,yc=function(e){return e>0?gc(pc(e),9007199254740991):0},mc=Math.max,bc=Math.min,_c=r(function(e){var t=zs["__core-js_shared__"]||(zs["__core-js_shared__"]={});(e.exports=function(e,r){return t[e]||(t[e]=void 0!==r?r:{})})("versions",[]).push({version:$s.version,mode:"pure",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})}),wc=0,Sc=Math.random(),kc=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++wc+Sc).toString(36))},Ec=_c("keys"),Pc=function(e){return Ec[e]||(Ec[e]=kc(e))},Tc=(lc=!1,function(e,t,r){var n,i=js(e),o=yc(i.length),a=function(e,t){return(e=pc(e))<0?mc(e+t,0):bc(e,t)}(r,o);if(lc&&t!=t){for(;o>a;)if((n=i[a++])!=n)return!0}else for(;o>a;a++)if((lc||a in i)&&i[a]===t)return lc||a||0;return!lc&&-1}),Oc=Pc("IE_PROTO"),Cc=function(e,t){var r,n=js(e),i=0,o=[];for(r in n)r!=Oc&&Fs(n,r)&&o.push(r);for(;t.length>i;)Fs(n,r=t[i++])&&(~Tc(o,r)||o.push(r));return o},Mc="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),xc=Object.keys||function(e){return Cc(e,Mc)},jc=Us?Object.defineProperties:function(e,t){Ks(e);for(var r,n=xc(t),i=n.length,o=0;i>o;)Zs.f(e,r=n[o++],t[r]);return e},Rc=zs.document,Ac=Rc&&Rc.documentElement,Ic=Pc("IE_PROTO"),Dc=function(){},Lc=function(){var e,t=Ws("iframe"),r=Mc.length;for(t.style.display="none",Ac.appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),Lc=e.F;r--;)delete Lc.prototype[Mc[r]];return Lc()},Fc=Object.create||function(e,t){var r;return null!==e?(Dc.prototype=Ks(e),r=new Dc,Dc.prototype=null,r[Ic]=e):r=Lc(),void 0===t?r:jc(r,t)},Nc=r(function(e){var t=_c("wks"),r=zs.Symbol,n="function"==typeof r;(e.exports=function(e){return t[e]||(t[e]=n&&r[e]||(n?r:kc)("Symbol."+e))}).store=t}),Uc=Zs.f,zc=Nc("toStringTag"),qc=function(e,t,r){e&&!Fs(e=r?e:e.prototype,zc)&&Uc(e,zc,{configurable:!0,value:t})},Bc={};Qs(Bc,Nc("iterator"),function(){return this});var Wc=function(e){return Object(xs(e))},Vc=Pc("IE_PROTO"),Gc=Object.prototype,Hc=Object.getPrototypeOf||function(e){return e=Wc(e),Fs(e,Vc)?e[Vc]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?Gc:null},$c=Nc("iterator"),Jc=!([].keys&&"next"in[].keys()),Yc=function(){return this},Kc=function(e,t,r,n,i,o,a){!function(e,t,r){e.prototype=Fc(Bc,{next:As(1,r)}),qc(e,t+" Iterator")}(r,t,n);var u,s,c,l=function(e){if(!Jc&&e in h)return h[e];switch(e){case"keys":case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},f=t+" Iterator",d="values"==i,p=!1,h=e.prototype,v=h[$c]||h["@@iterator"]||i&&h[i],g=v||l(i),y=i?d?l("entries"):g:void 0,m="Array"==t&&h.entries||v;if(m&&(c=Hc(m.call(new e)))!==Object.prototype&&c.next&&qc(c,f,!0),d&&v&&"values"!==v.name&&(p=!0,g=function(){return v.call(this)}),a&&(Jc||p||!h[$c])&&Qs(h,$c,g),vc[t]=g,vc[f]=Yc,i)if(u={values:d?g:l("values"),keys:o?g:l("keys"),entries:y},a)for(s in u)s in h||hc(h,s,u[s]);else tc(tc.P+tc.F*(Jc||p),t,u);return u},Xc=function(e){return function(t,r){var n,i,o=String(xs(t)),a=pc(r),u=o.length;return a<0||a>=u?e?"":void 0:(n=o.charCodeAt(a))<55296||n>56319||a+1===u||(i=o.charCodeAt(a+1))<56320||i>57343?e?o.charAt(a):n:e?o.slice(a,a+2):i-56320+(n-55296<<10)+65536}}(!0);Kc(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=Xc(t,r),this._i+=e.length,{value:e,done:!1})});var Zc=function(e,t){return{value:t,done:!!e}};Kc(Array,"Array",function(e,t){this._t=js(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,Zc(1)):Zc(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])},"values");vc.Arguments=vc.Array;for(var Qc=Nc("toStringTag"),el="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),tl=0;tl<el.length;tl++){var rl=el[tl],nl=zs[rl],il=nl&&nl.prototype;il&&!il[Qc]&&Qs(il,Qc,rl),vc[rl]=vc.Array}var ol,al,ul,sl=Nc("toStringTag"),cl="Arguments"==Cs(function(){return arguments}()),ll=function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),sl))?r:cl?Cs(t):"Object"==(n=Cs(t))&&"function"==typeof t.callee?"Arguments":n},fl=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e},dl=function(e,t,r,n){try{return n?t(Ks(r)[0],r[1]):t(r)}catch(t){var i=e.return;throw void 0!==i&&Ks(i.call(e)),t}},pl=Nc("iterator"),hl=Array.prototype,vl=function(e){return void 0!==e&&(vc.Array===e||hl[pl]===e)},gl=Nc("iterator"),yl=$s.getIteratorMethod=function(e){if(null!=e)return e[gl]||e["@@iterator"]||vc[ll(e)]},ml=r(function(e){var t={},r={},n=e.exports=function(e,n,i,o,a){var u,s,c,l,f=a?function(){return e}:yl(e),d=Ys(i,o,n?2:1),p=0;if("function"!=typeof f)throw TypeError(e+" is not iterable!");if(vl(f)){for(u=yc(e.length);u>p;p++)if((l=n?d(Ks(s=e[p])[0],s[1]):d(e[p]))===t||l===r)return l}else for(c=f.call(e);!(s=c.next()).done;)if((l=dl(c,d,s.value,n))===t||l===r)return l};n.BREAK=t,n.RETURN=r}),bl=Nc("species"),_l=function(e,t){var r,n=Ks(e).constructor;return void 0===n||null==(r=Ks(n)[bl])?t:Js(r)},wl=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)},Sl=zs.process,kl=zs.setImmediate,El=zs.clearImmediate,Pl=zs.MessageChannel,Tl=zs.Dispatch,Ol=0,Cl={},Ml=function(){var e=+this;if(Cl.hasOwnProperty(e)){var t=Cl[e];delete Cl[e],t()}},xl=function(e){Ml.call(e.data)};kl&&El||(kl=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return Cl[++Ol]=function(){wl("function"==typeof e?e:Function(e),t)},ol(Ol),Ol},El=function(e){delete Cl[e]},"process"==Cs(Sl)?ol=function(e){Sl.nextTick(Ys(Ml,e,1))}:Tl&&Tl.now?ol=function(e){Tl.now(Ys(Ml,e,1))}:Pl?(ul=(al=new Pl).port2,al.port1.onmessage=xl,ol=Ys(ul.postMessage,ul,1)):zs.addEventListener&&"function"==typeof postMessage&&!zs.importScripts?(ol=function(e){zs.postMessage(e+"","*")},zs.addEventListener("message",xl,!1)):ol="onreadystatechange"in Ws("script")?function(e){Ac.appendChild(Ws("script")).onreadystatechange=function(){Ac.removeChild(this),Ml.call(e)}}:function(e){setTimeout(Ys(Ml,e,1),0)});var jl={set:kl,clear:El},Rl=jl.set,Al=zs.MutationObserver||zs.WebKitMutationObserver,Il=zs.process,Dl=zs.Promise,Ll="process"==Cs(Il);function Fl(e){var t,r;this.promise=new e(function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n}),this.resolve=Js(t),this.reject=Js(r)}var Nl={f:function(e){return new Fl(e)}},Ul=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}},zl=zs.navigator,ql=zl&&zl.userAgent||"",Bl=function(e,t){if(Ks(e),Is(t)&&t.constructor===e)return t;var r=Nl.f(e);return(0,r.resolve)(t),r.promise},Wl=function(e,t,r){for(var n in t)r&&e[n]?e[n]=t[n]:Qs(e,n,t[n]);return e},Vl=Nc("species"),Gl=function(e){var t="function"==typeof $s[e]?$s[e]:zs[e];Us&&t&&!t[Vl]&&Zs.f(t,Vl,{configurable:!0,get:function(){return this}})},Hl=Nc("iterator"),$l=!1;try{[7][Hl]().return=function(){$l=!0}}catch(e){}var Jl,Yl,Kl,Xl,Zl=function(e,t){if(!t&&!$l)return!1;var r=!1;try{var n=[7],i=n[Hl]();i.next=function(){return{done:r=!0}},n[Hl]=function(){return i},e(n)}catch(e){}return r},Ql=jl.set,ef=function(){var e,t,r,n=function(){var n,i;for(Ll&&(n=Il.domain)&&n.exit();e;){i=e.fn,e=e.next;try{i()}catch(n){throw e?r():t=void 0,n}}t=void 0,n&&n.enter()};if(Ll)r=function(){Il.nextTick(n)};else if(!Al||zs.navigator&&zs.navigator.standalone)if(Dl&&Dl.resolve){var i=Dl.resolve(void 0);r=function(){i.then(n)}}else r=function(){Rl.call(zs,n)};else{var o=!0,a=document.createTextNode("");new Al(n).observe(a,{characterData:!0}),r=function(){a.data=o=!o}}return function(n){var i={fn:n,next:void 0};t&&(t.next=i),e||(e=i,r()),t=i}}(),tf=zs.TypeError,rf=zs.process,nf=rf&&rf.versions,of=nf&&nf.v8||"",af=zs.Promise,uf="process"==ll(rf),sf=function(){},cf=Yl=Nl.f,lf=!!function(){try{var e=af.resolve(1),t=(e.constructor={})[Nc("species")]=function(e){e(sf,sf)};return(uf||"function"==typeof PromiseRejectionEvent)&&e.then(sf)instanceof t&&0!==of.indexOf("6.6")&&-1===ql.indexOf("Chrome/66")}catch(e){}}(),ff=function(e){var t;return!(!Is(e)||"function"!=typeof(t=e.then))&&t},df=function(e,t){if(!e._n){e._n=!0;var r=e._c;ef(function(){for(var n=e._v,i=1==e._s,o=0,a=function(t){var r,o,a,u=i?t.ok:t.fail,s=t.resolve,c=t.reject,l=t.domain;try{u?(i||(2==e._h&&vf(e),e._h=1),!0===u?r=n:(l&&l.enter(),r=u(n),l&&(l.exit(),a=!0)),r===t.promise?c(tf("Promise-chain cycle")):(o=ff(r))?o.call(r,s,c):s(r)):c(n)}catch(e){l&&!a&&l.exit(),c(e)}};r.length>o;)a(r[o++]);e._c=[],e._n=!1,t&&!e._h&&pf(e)})}},pf=function(e){Ql.call(zs,function(){var t,r,n,i=e._v,o=hf(e);if(o&&(t=Ul(function(){uf?rf.emit("unhandledRejection",i,e):(r=zs.onunhandledrejection)?r({promise:e,reason:i}):(n=zs.console)&&n.error&&n.error("Unhandled promise rejection",i)}),e._h=uf||hf(e)?2:1),e._a=void 0,o&&t.e)throw t.v})},hf=function(e){return 1!==e._h&&0===(e._a||e._c).length},vf=function(e){Ql.call(zs,function(){var t;uf?rf.emit("rejectionHandled",e):(t=zs.onrejectionhandled)&&t({promise:e,reason:e._v})})},gf=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),df(t,!0))},yf=function(e){var t,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw tf("Promise can't be resolved itself");(t=ff(e))?ef(function(){var n={_w:r,_d:!1};try{t.call(e,Ys(yf,n,1),Ys(gf,n,1))}catch(e){gf.call(n,e)}}):(r._v=e,r._s=1,df(r,!1))}catch(e){gf.call({_w:r,_d:!1},e)}}};lf||(af=function(e){fl(this,af,"Promise","_h"),Js(e),Jl.call(this);try{e(Ys(yf,this,1),Ys(gf,this,1))}catch(e){gf.call(this,e)}},(Jl=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=Wl(af.prototype,{then:function(e,t){var r=cf(_l(this,af));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=uf?rf.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&df(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),Kl=function(){var e=new Jl;this.promise=e,this.resolve=Ys(yf,e,1),this.reject=Ys(gf,e,1)},Nl.f=cf=function(e){return e===af||e===Xl?new Kl(e):Yl(e)}),tc(tc.G+tc.W+tc.F*!lf,{Promise:af}),qc(af,"Promise"),Gl("Promise"),Xl=$s.Promise,tc(tc.S+tc.F*!lf,"Promise",{reject:function(e){var t=cf(this);return(0,t.reject)(e),t.promise}}),tc(tc.S+!0*tc.F,"Promise",{resolve:function(e){return Bl(this===Xl?af:this,e)}}),tc(tc.S+tc.F*!(lf&&Zl(function(e){af.all(e).catch(sf)})),"Promise",{all:function(e){var t=this,r=cf(t),n=r.resolve,i=r.reject,o=Ul(function(){var r=[],o=0,a=1;ml(e,!1,function(e){var u=o++,s=!1;r.push(void 0),a++,t.resolve(e).then(function(e){s||(s=!0,r[u]=e,--a||n(r))},i)}),--a||n(r)});return o.e&&i(o.v),r.promise},race:function(e){var t=this,r=cf(t),n=r.reject,i=Ul(function(){ml(e,!1,function(e){t.resolve(e).then(r.resolve,n)})});return i.e&&n(i.v),r.promise}}),tc(tc.P+tc.R,"Promise",{finally:function(e){var t=_l(this,$s.Promise||zs.Promise),r="function"==typeof e;return this.then(r?function(r){return Bl(t,e()).then(function(){return r})}:e,r?function(r){return Bl(t,e()).then(function(){throw r})}:e)}}),tc(tc.S,"Promise",{try:function(e){var t=Nl.f(this),r=Ul(e);return(r.e?t.reject:t.resolve)(r.v),t.promise}});var mf=$s.Promise,bf=r(function(e){e.exports={default:mf,__esModule:!0}});t(bf);var _f={f:Object.getOwnPropertySymbols},wf=Object.assign,Sf=!wf||Ns(function(){var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(e){t[e]=e}),7!=wf({},e)[r]||Object.keys(wf({},t)).join("")!=n})?function(e,t){for(var r=Wc(e),n=arguments.length,i=1,o=_f.f,a=Rs.f;n>i;)for(var u,s=Ms(arguments[i++]),c=o?xc(s).concat(o(s)):xc(s),l=c.length,f=0;l>f;)a.call(s,u=c[f++])&&(r[u]=s[u]);return r}:wf;tc(tc.S+tc.F,"Object",{assign:Sf});var kf=$s.Object.assign,Ef=r(function(e){e.exports={default:kf,__esModule:!0}});t(Ef);var Pf=(zs.Reflect||{}).apply,Tf=Function.apply;tc(tc.S+tc.F*!Ns(function(){Pf(function(){})}),"Reflect",{apply:function(e,t,r){var n=Js(e),i=Ks(r);return Pf?Pf(n,t,i):Tf.call(n,t,i)}});var Of=$s.Reflect.apply,Cf=r(function(e){e.exports={default:Of,__esModule:!0}});t(Cf);var Mf=$s.JSON||($s.JSON={stringify:JSON.stringify}),xf=function(e){return Mf.stringify.apply(Mf,arguments)},jf=r(function(e){e.exports={default:xf,__esModule:!0}});t(jf);var Rf=function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i};var Af=function(){this.__data__=[],this.size=0};var If=function(e,t){return e===t||e!=e&&t!=t};var Df=function(e,t){for(var r=e.length;r--;)if(If(e[r][0],t))return r;return-1},Lf=Array.prototype.splice;var Ff=function(e){var t=this.__data__,r=Df(t,e);return!(r<0||(r==t.length-1?t.pop():Lf.call(t,r,1),--this.size,0))};var Nf=function(e){var t=this.__data__,r=Df(t,e);return r<0?void 0:t[r][1]};var Uf=function(e){return Df(this.__data__,e)>-1};var zf=function(e,t){var r=this.__data__,n=Df(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function qf(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}qf.prototype.clear=Af,qf.prototype.delete=Ff,qf.prototype.get=Nf,qf.prototype.has=Uf,qf.prototype.set=zf;var Bf=qf;var Wf=function(){this.__data__=new Bf,this.size=0};var Vf=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r};var Gf=function(e){return this.__data__.get(e)};var Hf=function(e){return this.__data__.has(e)},$f="object"==typeof e&&e&&e.Object===Object&&e,Jf="object"==typeof self&&self&&self.Object===Object&&self,Yf=$f||Jf||Function("return this")(),Kf=Yf.Symbol,Xf=Object.prototype,Zf=Xf.hasOwnProperty,Qf=Xf.toString,ed=Kf?Kf.toStringTag:void 0;var td=function(e){var t=Zf.call(e,ed),r=e[ed];try{e[ed]=void 0;var n=!0}catch(e){}var i=Qf.call(e);return n&&(t?e[ed]=r:delete e[ed]),i},rd=Object.prototype.toString;var nd=function(e){return rd.call(e)},id="[object Null]",od="[object Undefined]",ad=Kf?Kf.toStringTag:void 0;var ud=function(e){return null==e?void 0===e?od:id:ad&&ad in Object(e)?td(e):nd(e)};var sd=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},cd="[object AsyncFunction]",ld="[object Function]",fd="[object GeneratorFunction]",dd="[object Proxy]";var pd,hd=function(e){if(!sd(e))return!1;var t=ud(e);return t==ld||t==fd||t==cd||t==dd},vd=Yf["__core-js_shared__"],gd=(pd=/[^.]+$/.exec(vd&&vd.keys&&vd.keys.IE_PROTO||""))?"Symbol(src)_1."+pd:"";var yd=function(e){return!!gd&&gd in e},md=Function.prototype.toString;var bd=function(e){if(null!=e){try{return md.call(e)}catch(e){}try{return e+""}catch(e){}}return""},_d=/^\[object .+?Constructor\]$/,wd=Function.prototype,Sd=Object.prototype,kd=wd.toString,Ed=Sd.hasOwnProperty,Pd=RegExp("^"+kd.call(Ed).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Td=function(e){return!(!sd(e)||yd(e))&&(hd(e)?Pd:_d).test(bd(e))};var Od=function(e,t){return null==e?void 0:e[t]};var Cd=function(e,t){var r=Od(e,t);return Td(r)?r:void 0},Md=Cd(Yf,"Map"),xd=Cd(Object,"create");var jd=function(){this.__data__=xd?xd(null):{},this.size=0};var Rd=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Ad="__lodash_hash_undefined__",Id=Object.prototype.hasOwnProperty;var Dd=function(e){var t=this.__data__;if(xd){var r=t[e];return r===Ad?void 0:r}return Id.call(t,e)?t[e]:void 0},Ld=Object.prototype.hasOwnProperty;var Fd=function(e){var t=this.__data__;return xd?void 0!==t[e]:Ld.call(t,e)},Nd="__lodash_hash_undefined__";var Ud=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=xd&&void 0===t?Nd:t,this};function zd(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}zd.prototype.clear=jd,zd.prototype.delete=Rd,zd.prototype.get=Dd,zd.prototype.has=Fd,zd.prototype.set=Ud;var qd=zd;var Bd=function(){this.size=0,this.__data__={hash:new qd,map:new(Md||Bf),string:new qd}};var Wd=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var Vd=function(e,t){var r=e.__data__;return Wd(t)?r["string"==typeof t?"string":"hash"]:r.map};var Gd=function(e){var t=Vd(this,e).delete(e);return this.size-=t?1:0,t};var Hd=function(e){return Vd(this,e).get(e)};var $d=function(e){return Vd(this,e).has(e)};var Jd=function(e,t){var r=Vd(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function Yd(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Yd.prototype.clear=Bd,Yd.prototype.delete=Gd,Yd.prototype.get=Hd,Yd.prototype.has=$d,Yd.prototype.set=Jd;var Kd=Yd,Xd=200;var Zd=function(e,t){var r=this.__data__;if(r instanceof Bf){var n=r.__data__;if(!Md||n.length<Xd-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Kd(n)}return r.set(e,t),this.size=r.size,this};function Qd(e){var t=this.__data__=new Bf(e);this.size=t.size}Qd.prototype.clear=Wf,Qd.prototype.delete=Vf,Qd.prototype.get=Gf,Qd.prototype.has=Hf,Qd.prototype.set=Zd;var ep=Qd;var tp=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e},rp=function(){try{var e=Cd(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var np=function(e,t,r){"__proto__"==t&&rp?rp(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r},ip=Object.prototype.hasOwnProperty;var op=function(e,t,r){var n=e[t];ip.call(e,t)&&If(n,r)&&(void 0!==r||t in e)||np(e,t,r)};var ap=function(e,t,r,n){var i=!r;r||(r={});for(var o=-1,a=t.length;++o<a;){var u=t[o],s=n?n(r[u],e[u],u,r,e):void 0;void 0===s&&(s=e[u]),i?np(r,u,s):op(r,u,s)}return r};var up=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n};var sp=function(e){return null!=e&&"object"==typeof e},cp="[object Arguments]";var lp=function(e){return sp(e)&&ud(e)==cp},fp=Object.prototype,dp=fp.hasOwnProperty,pp=fp.propertyIsEnumerable,hp=lp(function(){return arguments}())?lp:function(e){return sp(e)&&dp.call(e,"callee")&&!pp.call(e,"callee")},vp=Array.isArray;var gp=function(){return!1},yp=r(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,i=n&&n.exports===r?Yf.Buffer:void 0,o=(i?i.isBuffer:void 0)||gp;e.exports=o}),mp=9007199254740991,bp=/^(?:0|[1-9]\d*)$/;var _p=function(e,t){var r=typeof e;return!!(t=null==t?mp:t)&&("number"==r||"symbol"!=r&&bp.test(e))&&e>-1&&e%1==0&&e<t},wp=9007199254740991;var Sp=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=wp},kp={};kp["[object Float32Array]"]=kp["[object Float64Array]"]=kp["[object Int8Array]"]=kp["[object Int16Array]"]=kp["[object Int32Array]"]=kp["[object Uint8Array]"]=kp["[object Uint8ClampedArray]"]=kp["[object Uint16Array]"]=kp["[object Uint32Array]"]=!0,kp["[object Arguments]"]=kp["[object Array]"]=kp["[object ArrayBuffer]"]=kp["[object Boolean]"]=kp["[object DataView]"]=kp["[object Date]"]=kp["[object Error]"]=kp["[object Function]"]=kp["[object Map]"]=kp["[object Number]"]=kp["[object Object]"]=kp["[object RegExp]"]=kp["[object Set]"]=kp["[object String]"]=kp["[object WeakMap]"]=!1;var Ep=function(e){return sp(e)&&Sp(e.length)&&!!kp[ud(e)]};var Pp=function(e){return function(t){return e(t)}},Tp=r(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,i=n&&n.exports===r&&$f.process,o=function(){try{var e=n&&n.require&&n.require("util").types;return e||i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=o}),Op=Tp&&Tp.isTypedArray,Cp=Op?Pp(Op):Ep,Mp=Object.prototype.hasOwnProperty;var xp=function(e,t){var r=vp(e),n=!r&&hp(e),i=!r&&!n&&yp(e),o=!r&&!n&&!i&&Cp(e),a=r||n||i||o,u=a?up(e.length,String):[],s=u.length;for(var c in e)!t&&!Mp.call(e,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||_p(c,s))||u.push(c);return u},jp=Object.prototype;var Rp=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||jp)};var Ap=function(e,t){return function(r){return e(t(r))}},Ip=Ap(Object.keys,Object),Dp=Object.prototype.hasOwnProperty;var Lp=function(e){if(!Rp(e))return Ip(e);var t=[];for(var r in Object(e))Dp.call(e,r)&&"constructor"!=r&&t.push(r);return t};var Fp=function(e){return null!=e&&Sp(e.length)&&!hd(e)};var Np=function(e){return Fp(e)?xp(e):Lp(e)};var Up=function(e,t){return e&&ap(t,Np(t),e)};var zp=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t},qp=Object.prototype.hasOwnProperty;var Bp=function(e){if(!sd(e))return zp(e);var t=Rp(e),r=[];for(var n in e)("constructor"!=n||!t&&qp.call(e,n))&&r.push(n);return r};var Wp=function(e){return Fp(e)?xp(e,!0):Bp(e)};var Vp=function(e,t){return e&&ap(t,Wp(t),e)},Gp=r(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,i=n&&n.exports===r?Yf.Buffer:void 0,o=i?i.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=o?o(r):new e.constructor(r);return e.copy(n),n}});var Hp=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t};var $p=function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var a=e[r];t(a,r,e)&&(o[i++]=a)}return o};var Jp=function(){return[]},Yp=Object.prototype.propertyIsEnumerable,Kp=Object.getOwnPropertySymbols,Xp=Kp?function(e){return null==e?[]:(e=Object(e),$p(Kp(e),function(t){return Yp.call(e,t)}))}:Jp;var Zp=function(e,t){return ap(e,Xp(e),t)};var Qp=function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e},eh=Ap(Object.getPrototypeOf,Object),th=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Qp(t,Xp(e)),e=eh(e);return t}:Jp;var rh=function(e,t){return ap(e,th(e),t)};var nh=function(e,t,r){var n=t(e);return vp(e)?n:Qp(n,r(e))};var ih=function(e){return nh(e,Np,Xp)};var oh=function(e){return nh(e,Wp,th)},ah=Cd(Yf,"DataView"),uh=Cd(Yf,"Promise"),sh=Cd(Yf,"Set"),ch=Cd(Yf,"WeakMap"),lh=bd(ah),fh=bd(Md),dh=bd(uh),ph=bd(sh),hh=bd(ch),vh=ud;(ah&&"[object DataView]"!=vh(new ah(new ArrayBuffer(1)))||Md&&"[object Map]"!=vh(new Md)||uh&&"[object Promise]"!=vh(uh.resolve())||sh&&"[object Set]"!=vh(new sh)||ch&&"[object WeakMap]"!=vh(new ch))&&(vh=function(e){var t=ud(e),r="[object Object]"==t?e.constructor:void 0,n=r?bd(r):"";if(n)switch(n){case lh:return"[object DataView]";case fh:return"[object Map]";case dh:return"[object Promise]";case ph:return"[object Set]";case hh:return"[object WeakMap]"}return t});var gh=vh,yh=Object.prototype.hasOwnProperty;var mh=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&yh.call(e,"index")&&(r.index=e.index,r.input=e.input),r},bh=Yf.Uint8Array;var _h=function(e){var t=new e.constructor(e.byteLength);return new bh(t).set(new bh(e)),t};var wh=function(e,t){var r=t?_h(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)},Sh=/\w*$/;var kh=function(e){var t=new e.constructor(e.source,Sh.exec(e));return t.lastIndex=e.lastIndex,t},Eh=Kf?Kf.prototype:void 0,Ph=Eh?Eh.valueOf:void 0;var Th=function(e){return Ph?Object(Ph.call(e)):{}};var Oh=function(e,t){var r=t?_h(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)},Ch="[object Boolean]",Mh="[object Date]",xh="[object Map]",jh="[object Number]",Rh="[object RegExp]",Ah="[object Set]",Ih="[object String]",Dh="[object Symbol]",Lh="[object ArrayBuffer]",Fh="[object DataView]",Nh="[object Float32Array]",Uh="[object Float64Array]",zh="[object Int8Array]",qh="[object Int16Array]",Bh="[object Int32Array]",Wh="[object Uint8Array]",Vh="[object Uint8ClampedArray]",Gh="[object Uint16Array]",Hh="[object Uint32Array]";var $h=function(e,t,r){var n=e.constructor;switch(t){case Lh:return _h(e);case Ch:case Mh:return new n(+e);case Fh:return wh(e,r);case Nh:case Uh:case zh:case qh:case Bh:case Wh:case Vh:case Gh:case Hh:return Oh(e,r);case xh:return new n;case jh:case Ih:return new n(e);case Rh:return kh(e);case Ah:return new n;case Dh:return Th(e)}},Jh=Object.create,Yh=function(){function e(){}return function(t){if(!sd(t))return{};if(Jh)return Jh(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();var Kh=function(e){return"function"!=typeof e.constructor||Rp(e)?{}:Yh(eh(e))},Xh="[object Map]";var Zh=function(e){return sp(e)&&gh(e)==Xh},Qh=Tp&&Tp.isMap,ev=Qh?Pp(Qh):Zh,tv="[object Set]";var rv=function(e){return sp(e)&&gh(e)==tv},nv=Tp&&Tp.isSet,iv=nv?Pp(nv):rv,ov=1,av=2,uv=4,sv="[object Arguments]",cv="[object Function]",lv="[object GeneratorFunction]",fv="[object Object]",dv={};dv[sv]=dv["[object Array]"]=dv["[object ArrayBuffer]"]=dv["[object DataView]"]=dv["[object Boolean]"]=dv["[object Date]"]=dv["[object Float32Array]"]=dv["[object Float64Array]"]=dv["[object Int8Array]"]=dv["[object Int16Array]"]=dv["[object Int32Array]"]=dv["[object Map]"]=dv["[object Number]"]=dv[fv]=dv["[object RegExp]"]=dv["[object Set]"]=dv["[object String]"]=dv["[object Symbol]"]=dv["[object Uint8Array]"]=dv["[object Uint8ClampedArray]"]=dv["[object Uint16Array]"]=dv["[object Uint32Array]"]=!0,dv["[object Error]"]=dv[cv]=dv["[object WeakMap]"]=!1;var pv=function e(t,r,n,i,o,a){var u,s=r&ov,c=r&av,l=r&uv;if(n&&(u=o?n(t,i,o,a):n(t)),void 0!==u)return u;if(!sd(t))return t;var f=vp(t);if(f){if(u=mh(t),!s)return Hp(t,u)}else{var d=gh(t),p=d==cv||d==lv;if(yp(t))return Gp(t,s);if(d==fv||d==sv||p&&!o){if(u=c||p?{}:Kh(t),!s)return c?rh(t,Vp(u,t)):Zp(t,Up(u,t))}else{if(!dv[d])return o?t:{};u=$h(t,d,s)}}a||(a=new ep);var h=a.get(t);if(h)return h;if(a.set(t,u),iv(t))return t.forEach(function(i){u.add(e(i,r,n,i,t,a))}),u;if(ev(t))return t.forEach(function(i,o){u.set(o,e(i,r,n,o,t,a))}),u;var v=l?c?oh:ih:c?keysIn:Np,g=f?void 0:v(t);return tp(g||t,function(i,o){g&&(i=t[o=i]),op(u,o,e(i,r,n,o,t,a))}),u},hv="[object Symbol]";var vv=function(e){return"symbol"==typeof e||sp(e)&&ud(e)==hv},gv=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,yv=/^\w*$/;var mv=function(e,t){if(vp(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!vv(e))||yv.test(e)||!gv.test(e)||null!=t&&e in Object(t)},bv="Expected a function";function _v(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(bv);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var a=e.apply(this,n);return r.cache=o.set(i,a)||o,a};return r.cache=new(_v.Cache||Kd),r}_v.Cache=Kd;var wv=_v,Sv=500;var kv=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ev=/\\(\\)?/g,Pv=function(e){var t=wv(e,function(e){return r.size===Sv&&r.clear(),e}),r=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(kv,function(e,r,n,i){t.push(n?i.replace(Ev,"$1"):r||e)}),t}),Tv=1/0,Ov=Kf?Kf.prototype:void 0,Cv=Ov?Ov.toString:void 0;var Mv=function e(t){if("string"==typeof t)return t;if(vp(t))return Rf(t,e)+"";if(vv(t))return Cv?Cv.call(t):"";var r=t+"";return"0"==r&&1/t==-Tv?"-0":r};var xv=function(e){return null==e?"":Mv(e)};var jv=function(e,t){return vp(e)?e:mv(e,t)?[e]:Pv(xv(e))};var Rv=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0},Av=1/0;var Iv=function(e){if("string"==typeof e||vv(e))return e;var t=e+"";return"0"==t&&1/e==-Av?"-0":t};var Dv=function(e,t){for(var r=0,n=(t=jv(t,e)).length;null!=e&&r<n;)e=e[Iv(t[r++])];return r&&r==n?e:void 0};var Lv=function(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(i);++n<i;)o[n]=e[n+t];return o};var Fv=function(e,t){return t.length<2?e:Dv(e,Lv(t,0,-1))};var Nv=function(e,t){return t=jv(t,e),null==(e=Fv(e,t))||delete e[Iv(Rv(t))]},Uv="[object Object]",zv=Function.prototype,qv=Object.prototype,Bv=zv.toString,Wv=qv.hasOwnProperty,Vv=Bv.call(Object);var Gv=function(e){if(!sp(e)||ud(e)!=Uv)return!1;var t=eh(e);if(null===t)return!0;var r=Wv.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&Bv.call(r)==Vv};var Hv=function(e){return Gv(e)?void 0:e},$v=Kf?Kf.isConcatSpreadable:void 0;var Jv=function(e){return vp(e)||hp(e)||!!($v&&e&&e[$v])};var Yv=function e(t,r,n,i,o){var a=-1,u=t.length;for(n||(n=Jv),o||(o=[]);++a<u;){var s=t[a];r>0&&n(s)?r>1?e(s,r-1,n,i,o):Qp(o,s):i||(o[o.length]=s)}return o};var Kv=function(e){return null!=e&&e.length?Yv(e,1):[]};var Xv=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)},Zv=Math.max;var Qv=function(e,t,r){return t=Zv(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,o=Zv(n.length-t,0),a=Array(o);++i<o;)a[i]=n[t+i];i=-1;for(var u=Array(t+1);++i<t;)u[i]=n[i];return u[t]=r(a),Xv(e,this,u)}};var eg=function(e){return function(){return e}};var tg=function(e){return e},rg=rp?function(e,t){return rp(e,"toString",{configurable:!0,enumerable:!1,value:eg(t),writable:!0})}:tg,ng=800,ig=16,og=Date.now;var ag=function(e){var t=0,r=0;return function(){var n=og(),i=ig-(n-r);if(r=n,i>0){if(++t>=ng)return arguments[0]}else t=0;return e.apply(void 0,arguments)}},ug=ag(rg);var sg=function(e){return ug(Qv(e,void 0,Kv),e+"")},cg=sg(function(e,t){var r={};if(null==e)return r;var n=!1;t=Rf(t,function(t){return t=jv(t,e),n||(n=t.length>1),t}),ap(e,oh(e),r),n&&(r=pv(r,7,Hv));for(var i=t.length;i--;)Nv(r,t[i]);return r}),lg="[object Map]",fg="[object Set]",dg=Object.prototype.hasOwnProperty;var pg=function(e){if(null==e)return!0;if(Fp(e)&&(vp(e)||"string"==typeof e||"function"==typeof e.splice||yp(e)||Cp(e)||hp(e)))return!e.length;var t=gh(e);if(t==lg||t==fg)return!e.size;if(Rp(e))return!Lp(e).length;for(var r in e)if(dg.call(e,r))return!1;return!0},hg=1,vg=4;var gg=function(e){return pv(e,hg|vg)};function yg(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var mg=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function bg(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}}function _g(e,t,r,n){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?wg(Sg(e),function(n){var i=encodeURIComponent(bg(n))+r;return mg(e[n])?wg(e[n],function(e){return i+encodeURIComponent(bg(e))}).join(t):i+encodeURIComponent(bg(e[n]))}).join(t):n?encodeURIComponent(bg(n))+r+encodeURIComponent(bg(e)):""}function wg(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var Sg=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t};function kg(e,t,r,n){t=t||"&",r=r||"=";var i={};if("string"!=typeof e||0===e.length)return i;var o=/\+/g;e=e.split(t);var a=1e3;n&&"number"==typeof n.maxKeys&&(a=n.maxKeys);var u=e.length;a>0&&u>a&&(u=a);for(var s=0;s<u;++s){var c,l,f,d,p=e[s].replace(o,"%20"),h=p.indexOf(r);h>=0?(c=p.substr(0,h),l=p.substr(h+1)):(c=p,l=""),f=decodeURIComponent(c),d=decodeURIComponent(l),yg(i,f)?mg(i[f])?i[f].push(d):i[f]=[i[f],d]:i[f]=d}return i}var Eg={encode:_g,stringify:_g,decode:kg,parse:kg},Pg=2147483647,Tg=36,Og=1,Cg=26,Mg=38,xg=700,jg=72,Rg=128,Ag="-",Ig=/[^\x20-\x7E]/,Dg=/[\x2E\u3002\uFF0E\uFF61]/g,Lg={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Fg=Tg-Og,Ng=Math.floor,Ug=String.fromCharCode;function zg(e){throw new RangeError(Lg[e])}function qg(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function Bg(e,t,r){var n=0;for(e=r?Ng(e/xg):e>>1,e+=Ng(e/t);e>Fg*Cg>>1;n+=Tg)e=Ng(e/Fg);return Ng(n+(Fg+1)*e/(e+Mg))}function Wg(e){return function(e,t){var r=e.split("@"),n="";r.length>1&&(n=r[0]+"@",e=r[1]);var i=function(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}((e=e.replace(Dg,".")).split("."),t).join(".");return n+i}(e,function(e){return Ig.test(e)?"xn--"+function(e){var t,r,n,i,o,a,u,s,c,l,f,d,p,h,v,g=[];for(d=(e=function(e){for(var t,r,n=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}(e)).length,t=Rg,r=0,o=jg,a=0;a<d;++a)(f=e[a])<128&&g.push(Ug(f));for(n=i=g.length,i&&g.push(Ag);n<d;){for(u=Pg,a=0;a<d;++a)(f=e[a])>=t&&f<u&&(u=f);for(u-t>Ng((Pg-r)/(p=n+1))&&zg("overflow"),r+=(u-t)*p,t=u,a=0;a<d;++a)if((f=e[a])<t&&++r>Pg&&zg("overflow"),f==t){for(s=r,c=Tg;!(s<(l=c<=o?Og:c>=o+Cg?Cg:c-o));c+=Tg)v=s-l,h=Tg-l,g.push(Ug(qg(l+v%h,0))),s=Ng(v/h);g.push(Ug(qg(s,0))),o=Bg(r,p,n==i),r=0,++n}++r,++t}return g.join("")}(e):e})}var Vg=[],Gg=[],Hg="undefined"!=typeof Uint8Array?Uint8Array:Array,$g=!1;function Jg(){$g=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,r=e.length;t<r;++t)Vg[t]=e[t],Gg[e.charCodeAt(t)]=t;Gg["-".charCodeAt(0)]=62,Gg["_".charCodeAt(0)]=63}function Yg(e,t,r){for(var n,i,o=[],a=t;a<r;a+=3)n=(e[a]<<16)+(e[a+1]<<8)+e[a+2],o.push(Vg[(i=n)>>18&63]+Vg[i>>12&63]+Vg[i>>6&63]+Vg[63&i]);return o.join("")}function Kg(e){var t;$g||Jg();for(var r=e.length,n=r%3,i="",o=[],a=0,u=r-n;a<u;a+=16383)o.push(Yg(e,a,a+16383>u?u:a+16383));return 1===n?(t=e[r-1],i+=Vg[t>>2],i+=Vg[t<<4&63],i+="=="):2===n&&(t=(e[r-2]<<8)+e[r-1],i+=Vg[t>>10],i+=Vg[t>>4&63],i+=Vg[t<<2&63],i+="="),o.push(i),o.join("")}function Xg(e,t,r,n,i){var o,a,u=8*i-n-1,s=(1<<u)-1,c=s>>1,l=-7,f=r?i-1:0,d=r?-1:1,p=e[t+f];for(f+=d,o=p&(1<<-l)-1,p>>=-l,l+=u;l>0;o=256*o+e[t+f],f+=d,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=n;l>0;a=256*a+e[t+f],f+=d,l-=8);if(0===o)o=1-c;else{if(o===s)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),o-=c}return(p?-1:1)*a*Math.pow(2,o-n)}function Zg(e,t,r,n,i,o){var a,u,s,c=8*o-i-1,l=(1<<c)-1,f=l>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,h=n?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-a))<1&&(a--,s*=2),(t+=a+f>=1?d/s:d*Math.pow(2,1-f))*s>=2&&(a++,s/=2),a+f>=l?(u=0,a=l):a+f>=1?(u=(t*s-1)*Math.pow(2,i),a+=f):(u=t*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;e[r+p]=255&u,p+=h,u/=256,i-=8);for(a=a<<i|u,c+=i;c>0;e[r+p]=255&a,p+=h,a/=256,c-=8);e[r+p-h]|=128*v}var Qg={}.toString,ey=Array.isArray||function(e){return"[object Array]"==Qg.call(e)};function ty(){return ny.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function ry(e,t){if(ty()<t)throw new RangeError("Invalid typed array length");return ny.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=ny.prototype:(null===e&&(e=new ny(t)),e.length=t),e}function ny(e,t,r){if(!(ny.TYPED_ARRAY_SUPPORT||this instanceof ny))return new ny(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return ay(this,e)}return iy(this,e,t,r)}function iy(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);ny.TYPED_ARRAY_SUPPORT?(e=t).__proto__=ny.prototype:e=uy(e,t);return e}(e,t,r,n):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!ny.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|ly(t,r),i=(e=ry(e,n)).write(t,r);i!==n&&(e=e.slice(0,i));return e}(e,t,r):function(e,t){if(cy(t)){var r=0|sy(t.length);return 0===(e=ry(e,r)).length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(n=t.length)!=n?ry(e,0):uy(e,t);if("Buffer"===t.type&&ey(t.data))return uy(e,t.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function oy(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function ay(e,t){if(oy(t),e=ry(e,t<0?0:0|sy(t)),!ny.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function uy(e,t){var r=t.length<0?0:0|sy(t.length);e=ry(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function sy(e){if(e>=ty())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ty().toString(16)+" bytes");return 0|e}function cy(e){return!(null==e||!e._isBuffer)}function ly(e,t){if(cy(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return Ly(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Fy(e).length;default:if(n)return Ly(e).length;t=(""+t).toLowerCase(),n=!0}}function fy(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function dy(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=ny.from(t,n)),cy(t))return 0===t.length?-1:py(e,t,r,n,i);if("number"==typeof t)return t&=255,ny.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):py(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function py(e,t,r,n,i){var o,a=1,u=e.length,s=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,u/=2,s/=2,r/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var l=-1;for(o=r;o<u;o++)if(c(e,o)===c(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===s)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(r+s>u&&(r=u-s),o=r;o>=0;o--){for(var f=!0,d=0;d<s;d++)if(c(e,o+d)!==c(t,d)){f=!1;break}if(f)return o}return-1}function hy(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var a=0;a<n;++a){var u=parseInt(t.substr(2*a,2),16);if(isNaN(u))return a;e[r+a]=u}return a}function vy(e,t,r,n){return Ny(Ly(t,e.length-r),e,r,n)}function gy(e,t,r,n){return Ny(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function yy(e,t,r,n){return gy(e,t,r,n)}function my(e,t,r,n){return Ny(Fy(t),e,r,n)}function by(e,t,r,n){return Ny(function(e,t){for(var r,n,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function _y(e,t,r){return 0===t&&r===e.length?Kg(e):Kg(e.slice(t,r))}function wy(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,a,u,s,c=e[i],l=null,f=c>239?4:c>223?3:c>191?2:1;if(i+f<=r)switch(f){case 1:c<128&&(l=c);break;case 2:128==(192&(o=e[i+1]))&&(s=(31&c)<<6|63&o)>127&&(l=s);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(s=(15&c)<<12|(63&o)<<6|63&a)>2047&&(s<55296||s>57343)&&(l=s);break;case 4:o=e[i+1],a=e[i+2],u=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&u)&&(s=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&u)>65535&&s<1114112&&(l=s)}null===l?(l=65533,f=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),i+=f}return function(e){var t=e.length;if(t<=Sy)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=Sy));return r}(n)}ny.TYPED_ARRAY_SUPPORT=void 0===ts.TYPED_ARRAY_SUPPORT||ts.TYPED_ARRAY_SUPPORT,ny.poolSize=8192,ny._augment=function(e){return e.__proto__=ny.prototype,e},ny.from=function(e,t,r){return iy(null,e,t,r)},ny.TYPED_ARRAY_SUPPORT&&(ny.prototype.__proto__=Uint8Array.prototype,ny.__proto__=Uint8Array),ny.alloc=function(e,t,r){return function(e,t,r,n){return oy(t),t<=0?ry(e,t):void 0!==r?"string"==typeof n?ry(e,t).fill(r,n):ry(e,t).fill(r):ry(e,t)}(null,e,t,r)},ny.allocUnsafe=function(e){return ay(null,e)},ny.allocUnsafeSlow=function(e){return ay(null,e)},ny.isBuffer=Uy,ny.compare=function(e,t){if(!cy(e)||!cy(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},ny.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},ny.concat=function(e,t){if(!ey(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return ny.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=ny.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var o=e[r];if(!cy(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},ny.byteLength=ly,ny.prototype._isBuffer=!0,ny.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)fy(this,t,t+1);return this},ny.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)fy(this,t,t+3),fy(this,t+1,t+2);return this},ny.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)fy(this,t,t+7),fy(this,t+1,t+6),fy(this,t+2,t+5),fy(this,t+3,t+4);return this},ny.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?wy(this,0,e):function(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return Py(this,t,r);case"utf8":case"utf-8":return wy(this,t,r);case"ascii":return ky(this,t,r);case"latin1":case"binary":return Ey(this,t,r);case"base64":return _y(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ty(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}.apply(this,arguments)},ny.prototype.equals=function(e){if(!cy(e))throw new TypeError("Argument must be a Buffer");return this===e||0===ny.compare(this,e)},ny.prototype.inspect=function(){var e="";return this.length>0&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(e+=" ... ")),"<Buffer "+e+">"},ny.prototype.compare=function(e,t,r,n,i){if(!cy(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0),u=Math.min(o,a),s=this.slice(n,i),c=e.slice(t,r),l=0;l<u;++l)if(s[l]!==c[l]){o=s[l],a=c[l];break}return o<a?-1:a<o?1:0},ny.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},ny.prototype.indexOf=function(e,t,r){return dy(this,e,t,r,!0)},ny.prototype.lastIndexOf=function(e,t,r){return dy(this,e,t,r,!1)},ny.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return hy(this,e,t,r);case"utf8":case"utf-8":return vy(this,e,t,r);case"ascii":return gy(this,e,t,r);case"latin1":case"binary":return yy(this,e,t,r);case"base64":return my(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return by(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},ny.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Sy=4096;function ky(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function Ey(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function Py(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=Dy(e[o]);return i}function Ty(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function Oy(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function Cy(e,t,r,n,i,o){if(!cy(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function My(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function xy(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function jy(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function Ry(e,t,r,n,i){return i||jy(e,0,r,4),Zg(e,t,r,n,23,4),r+4}function Ay(e,t,r,n,i){return i||jy(e,0,r,8),Zg(e,t,r,n,52,8),r+8}ny.prototype.slice=function(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),ny.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=ny.prototype;else{var i=t-e;r=new ny(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+e]}return r},ny.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||Oy(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},ny.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||Oy(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},ny.prototype.readUInt8=function(e,t){return t||Oy(e,1,this.length),this[e]},ny.prototype.readUInt16LE=function(e,t){return t||Oy(e,2,this.length),this[e]|this[e+1]<<8},ny.prototype.readUInt16BE=function(e,t){return t||Oy(e,2,this.length),this[e]<<8|this[e+1]},ny.prototype.readUInt32LE=function(e,t){return t||Oy(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},ny.prototype.readUInt32BE=function(e,t){return t||Oy(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},ny.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||Oy(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},ny.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||Oy(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},ny.prototype.readInt8=function(e,t){return t||Oy(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},ny.prototype.readInt16LE=function(e,t){t||Oy(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},ny.prototype.readInt16BE=function(e,t){t||Oy(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},ny.prototype.readInt32LE=function(e,t){return t||Oy(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},ny.prototype.readInt32BE=function(e,t){return t||Oy(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},ny.prototype.readFloatLE=function(e,t){return t||Oy(e,4,this.length),Xg(this,e,!0,23,4)},ny.prototype.readFloatBE=function(e,t){return t||Oy(e,4,this.length),Xg(this,e,!1,23,4)},ny.prototype.readDoubleLE=function(e,t){return t||Oy(e,8,this.length),Xg(this,e,!0,52,8)},ny.prototype.readDoubleBE=function(e,t){return t||Oy(e,8,this.length),Xg(this,e,!1,52,8)},ny.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||Cy(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},ny.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||Cy(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},ny.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||Cy(this,e,t,1,255,0),ny.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},ny.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||Cy(this,e,t,2,65535,0),ny.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):My(this,e,t,!0),t+2},ny.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||Cy(this,e,t,2,65535,0),ny.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):My(this,e,t,!1),t+2},ny.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||Cy(this,e,t,4,4294967295,0),ny.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):xy(this,e,t,!0),t+4},ny.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||Cy(this,e,t,4,4294967295,0),ny.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):xy(this,e,t,!1),t+4},ny.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);Cy(this,e,t,r,i-1,-i)}var o=0,a=1,u=0;for(this[t]=255&e;++o<r&&(a*=256);)e<0&&0===u&&0!==this[t+o-1]&&(u=1),this[t+o]=(e/a>>0)-u&255;return t+r},ny.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);Cy(this,e,t,r,i-1,-i)}var o=r-1,a=1,u=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===u&&0!==this[t+o+1]&&(u=1),this[t+o]=(e/a>>0)-u&255;return t+r},ny.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||Cy(this,e,t,1,127,-128),ny.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},ny.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||Cy(this,e,t,2,32767,-32768),ny.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):My(this,e,t,!0),t+2},ny.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||Cy(this,e,t,2,32767,-32768),ny.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):My(this,e,t,!1),t+2},ny.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||Cy(this,e,t,4,2147483647,-2147483648),ny.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):xy(this,e,t,!0),t+4},ny.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||Cy(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),ny.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):xy(this,e,t,!1),t+4},ny.prototype.writeFloatLE=function(e,t,r){return Ry(this,e,t,!0,r)},ny.prototype.writeFloatBE=function(e,t,r){return Ry(this,e,t,!1,r)},ny.prototype.writeDoubleLE=function(e,t,r){return Ay(this,e,t,!0,r)},ny.prototype.writeDoubleBE=function(e,t,r){return Ay(this,e,t,!1,r)},ny.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,o=n-r;if(this===e&&r<t&&t<n)for(i=o-1;i>=0;--i)e[i+t]=this[i+r];else if(o<1e3||!ny.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},ny.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!ny.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var a=cy(e)?e:Ly(new ny(e,n).toString()),u=a.length;for(o=0;o<r-t;++o)this[o+t]=a[o%u]}return this};var Iy=/[^+\/0-9A-Za-z-_]/g;function Dy(e){return e<16?"0"+e.toString(16):e.toString(16)}function Ly(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function Fy(e){return function(e){var t,r,n,i,o,a;$g||Jg();var u=e.length;if(u%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o="="===e[u-2]?2:"="===e[u-1]?1:0,a=new Hg(3*u/4-o),n=o>0?u-4:u;var s=0;for(t=0,r=0;t<n;t+=4,r+=3)i=Gg[e.charCodeAt(t)]<<18|Gg[e.charCodeAt(t+1)]<<12|Gg[e.charCodeAt(t+2)]<<6|Gg[e.charCodeAt(t+3)],a[s++]=i>>16&255,a[s++]=i>>8&255,a[s++]=255&i;return 2===o?(i=Gg[e.charCodeAt(t)]<<2|Gg[e.charCodeAt(t+1)]>>4,a[s++]=255&i):1===o&&(i=Gg[e.charCodeAt(t)]<<10|Gg[e.charCodeAt(t+1)]<<4|Gg[e.charCodeAt(t+2)]>>2,a[s++]=i>>8&255,a[s++]=255&i),a}(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(Iy,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function Ny(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function Uy(e){return null!=e&&(!!e._isBuffer||zy(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&zy(e.slice(0,0))}(e))}function zy(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}var qy="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e},By=/%[sdj%]/g;function Wy(e){if(!om(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(Jy(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,i=n.length,o=String(e).replace(By,function(e){if("%%"===e)return"%";if(r>=i)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}}),a=n[r];r<i;a=n[++r])rm(a)||!sm(a)?o+=" "+a:o+=" "+Jy(a);return o}function Vy(e,t){if(am(ts.process))return function(){return Vy(e,t).apply(this,arguments)};var r=!1;return function(){return r||(console.error(t),r=!0),e.apply(this,arguments)}}var Gy,Hy={};function $y(e){if(am(Gy)&&(Gy=""),e=e.toUpperCase(),!Hy[e])if(new RegExp("\\b"+e+"\\b","i").test(Gy)){Hy[e]=function(){var t=Wy.apply(null,arguments);console.error("%s %d: %s",e,0,t)}}else Hy[e]=function(){};return Hy[e]}function Jy(e,t){var r={seen:[],stylize:Ky};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),tm(t)?r.showHidden=t:t&&vm(r,t),am(r.showHidden)&&(r.showHidden=!1),am(r.depth)&&(r.depth=2),am(r.colors)&&(r.colors=!1),am(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=Yy),Xy(r,e,r.depth)}function Yy(e,t){var r=Jy.styles[t];return r?"["+Jy.colors[r][0]+"m"+e+"["+Jy.colors[r][1]+"m":e}function Ky(e,t){return e}function Xy(e,t,r){if(e.customInspect&&t&&fm(t.inspect)&&t.inspect!==Jy&&(!t.constructor||t.constructor.prototype!==t)){var n=t.inspect(r,e);return om(n)||(n=Xy(e,n,r)),n}var i=function(e,t){if(am(t))return e.stylize("undefined","undefined");if(om(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(im(t))return e.stylize(""+t,"number");if(tm(t))return e.stylize(""+t,"boolean");if(rm(t))return e.stylize("null","null")}(e,t);if(i)return i;var o=Object.keys(t),a=function(e){var t={};return e.forEach(function(e,r){t[e]=!0}),t}(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(t)),lm(t)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return Zy(t);if(0===o.length){if(fm(t)){var u=t.name?": "+t.name:"";return e.stylize("[Function"+u+"]","special")}if(um(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(cm(t))return e.stylize(Date.prototype.toString.call(t),"date");if(lm(t))return Zy(t)}var s,c="",l=!1,f=["{","}"];(em(t)&&(l=!0,f=["[","]"]),fm(t))&&(c=" [Function"+(t.name?": "+t.name:"")+"]");return um(t)&&(c=" "+RegExp.prototype.toString.call(t)),cm(t)&&(c=" "+Date.prototype.toUTCString.call(t)),lm(t)&&(c=" "+Zy(t)),0!==o.length||l&&0!=t.length?r<0?um(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),s=l?function(e,t,r,n,i){for(var o=[],a=0,u=t.length;a<u;++a)gm(t,String(a))?o.push(Qy(e,t,r,n,String(a),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(Qy(e,t,r,n,i,!0))}),o}(e,t,r,a,o):o.map(function(n){return Qy(e,t,r,a,n,l)}),e.seen.pop(),function(e,t,r){if(e.reduce(function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(s,c,f)):f[0]+c+f[1]}function Zy(e){return"["+Error.prototype.toString.call(e)+"]"}function Qy(e,t,r,n,i,o){var a,u,s;if((s=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?u=s.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):s.set&&(u=e.stylize("[Setter]","special")),gm(n,i)||(a="["+i+"]"),u||(e.seen.indexOf(s.value)<0?(u=rm(r)?Xy(e,s.value,null):Xy(e,s.value,r-1)).indexOf("\n")>-1&&(u=o?u.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+u.split("\n").map(function(e){return"   "+e}).join("\n")):u=e.stylize("[Circular]","special")),am(a)){if(o&&i.match(/^\d+$/))return u;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+u}function em(e){return Array.isArray(e)}function tm(e){return"boolean"==typeof e}function rm(e){return null===e}function nm(e){return null==e}function im(e){return"number"==typeof e}function om(e){return"string"==typeof e}function am(e){return void 0===e}function um(e){return sm(e)&&"[object RegExp]"===dm(e)}function sm(e){return"object"==typeof e&&null!==e}function cm(e){return sm(e)&&"[object Date]"===dm(e)}function lm(e){return sm(e)&&("[object Error]"===dm(e)||e instanceof Error)}function fm(e){return"function"==typeof e}function dm(e){return Object.prototype.toString.call(e)}function pm(e){return e<10?"0"+e.toString(10):e.toString(10)}Jy.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},Jy.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};var hm=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function vm(e,t){if(!t||!sm(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}function gm(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var ym={inherits:qy,_extend:vm,log:function(){var e,t;console.log("%s - %s",(e=new Date,t=[pm(e.getHours()),pm(e.getMinutes()),pm(e.getSeconds())].join(":"),[e.getDate(),hm[e.getMonth()],t].join(" ")),Wy.apply(null,arguments))},isBuffer:function(e){return Uy(e)},isPrimitive:function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},isFunction:fm,isError:lm,isDate:cm,isObject:sm,isRegExp:um,isUndefined:am,isSymbol:function(e){return"symbol"==typeof e},isString:om,isNumber:im,isNullOrUndefined:nm,isNull:rm,isBoolean:tm,isArray:em,inspect:Jy,deprecate:Vy,format:Wy,debuglog:$y},mm={parse:Am,resolve:function(e,t){return Am(e,!1,!0).resolve(t)},resolveObject:function(e,t){return e?Am(e,!1,!0).resolveObject(t):t},format:function(e){om(e)&&(e=Im({},e));return Dm(e)},Url:bm};function bm(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var _m=/^([a-z0-9.+-]+:)/i,wm=/:[0-9]*$/,Sm=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,km=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),Em=["'"].concat(km),Pm=["%","/","?",";","#"].concat(Em),Tm=["/","?","#"],Om=255,Cm=/^[+a-z0-9A-Z_-]{0,63}$/,Mm=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,xm={javascript:!0,"javascript:":!0},jm={javascript:!0,"javascript:":!0},Rm={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function Am(e,t,r){if(e&&sm(e)&&e instanceof bm)return e;var n=new bm;return n.parse(e,t,r),n}function Im(e,t,r,n){if(!om(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var i=t.indexOf("?"),o=-1!==i&&i<t.indexOf("#")?"?":"#",a=t.split(o);a[0]=a[0].replace(/\\/g,"/");var u=t=a.join(o);if(u=u.trim(),!n&&1===t.split("#").length){var s=Sm.exec(u);if(s)return e.path=u,e.href=u,e.pathname=s[1],s[2]?(e.search=s[2],e.query=r?kg(e.search.substr(1)):e.search.substr(1)):r&&(e.search="",e.query={}),e}var c,l,f,d,p=_m.exec(u);if(p){var h=(p=p[0]).toLowerCase();e.protocol=h,u=u.substr(p.length)}if(n||p||u.match(/^\/\/[^@\/]+@[^@\/]+/)){var v="//"===u.substr(0,2);!v||p&&jm[p]||(u=u.substr(2),e.slashes=!0)}if(!jm[p]&&(v||p&&!Rm[p])){var g,y,m=-1;for(c=0;c<Tm.length;c++)-1!==(l=u.indexOf(Tm[c]))&&(-1===m||l<m)&&(m=l);for(-1!==(y=-1===m?u.lastIndexOf("@"):u.lastIndexOf("@",m))&&(g=u.slice(0,y),u=u.slice(y+1),e.auth=decodeURIComponent(g)),m=-1,c=0;c<Pm.length;c++)-1!==(l=u.indexOf(Pm[c]))&&(-1===m||l<m)&&(m=l);-1===m&&(m=u.length),e.host=u.slice(0,m),u=u.slice(m),Lm(e),e.hostname=e.hostname||"";var b="["===e.hostname[0]&&"]"===e.hostname[e.hostname.length-1];if(!b){var _=e.hostname.split(/\./);for(c=0,f=_.length;c<f;c++){var w=_[c];if(w&&!w.match(Cm)){for(var S="",k=0,E=w.length;k<E;k++)w.charCodeAt(k)>127?S+="x":S+=w[k];if(!S.match(Cm)){var P=_.slice(0,c),T=_.slice(c+1),O=w.match(Mm);O&&(P.push(O[1]),T.unshift(O[2])),T.length&&(u="/"+T.join(".")+u),e.hostname=P.join(".");break}}}}e.hostname.length>Om?e.hostname="":e.hostname=e.hostname.toLowerCase(),b||(e.hostname=Wg(e.hostname)),d=e.port?":"+e.port:"";var C=e.hostname||"";e.host=C+d,e.href+=e.host,b&&(e.hostname=e.hostname.substr(1,e.hostname.length-2),"/"!==u[0]&&(u="/"+u))}if(!xm[h])for(c=0,f=Em.length;c<f;c++){var M=Em[c];if(-1!==u.indexOf(M)){var x=encodeURIComponent(M);x===M&&(x=escape(M)),u=u.split(M).join(x)}}var j=u.indexOf("#");-1!==j&&(e.hash=u.substr(j),u=u.slice(0,j));var R=u.indexOf("?");if(-1!==R?(e.search=u.substr(R),e.query=u.substr(R+1),r&&(e.query=kg(e.query)),u=u.slice(0,R)):r&&(e.search="",e.query={}),u&&(e.pathname=u),Rm[h]&&e.hostname&&!e.pathname&&(e.pathname="/"),e.pathname||e.search){d=e.pathname||"";var A=e.search||"";e.path=d+A}return e.href=Dm(e),e}function Dm(e){var t=e.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var r=e.protocol||"",n=e.pathname||"",i=e.hash||"",o=!1,a="";e.host?o=t+e.host:e.hostname&&(o=t+(-1===e.hostname.indexOf(":")?e.hostname:"["+this.hostname+"]"),e.port&&(o+=":"+e.port)),e.query&&sm(e.query)&&Object.keys(e.query).length&&(a=_g(e.query));var u=e.search||a&&"?"+a||"";return r&&":"!==r.substr(-1)&&(r+=":"),e.slashes||(!r||Rm[r])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),i&&"#"!==i.charAt(0)&&(i="#"+i),u&&"?"!==u.charAt(0)&&(u="?"+u),r+o+(n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(u=u.replace("#","%23"))+i}function Lm(e){var t=e.host,r=wm.exec(t);r&&(":"!==(r=r[0])&&(e.port=r.substr(1)),t=t.substr(0,t.length-r.length)),t&&(e.hostname=t)}bm.prototype.parse=function(e,t,r){return Im(this,e,t,r)},bm.prototype.format=function(){return Dm(this)},bm.prototype.resolve=function(e){return this.resolveObject(Am(e,!1,!0)).format()},bm.prototype.resolveObject=function(e){if(om(e)){var t=new bm;t.parse(e,!1,!0),e=t}for(var r,n=new bm,i=Object.keys(this),o=0;o<i.length;o++){var a=i[o];n[a]=this[a]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var u=Object.keys(e),s=0;s<u.length;s++){var c=u[s];"protocol"!==c&&(n[c]=e[c])}return Rm[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!Rm[e.protocol]){for(var l=Object.keys(e),f=0;f<l.length;f++){var d=l[f];n[d]=e[d]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||jm[e.protocol])n.pathname=e.pathname;else{for(r=(e.pathname||"").split("/");r.length&&!(e.host=r.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==r[0]&&r.unshift(""),r.length<2&&r.unshift(""),n.pathname=r.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var p=n.pathname||"",h=n.search||"";n.path=p+h}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var v,g=n.pathname&&"/"===n.pathname.charAt(0),y=e.host||e.pathname&&"/"===e.pathname.charAt(0),m=y||g||n.host&&e.pathname,b=m,_=n.pathname&&n.pathname.split("/")||[],w=n.protocol&&!Rm[n.protocol];if(r=e.pathname&&e.pathname.split("/")||[],w&&(n.hostname="",n.port=null,n.host&&(""===_[0]?_[0]=n.host:_.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===r[0]?r[0]=e.host:r.unshift(e.host)),e.host=null),m=m&&(""===r[0]||""===_[0])),y)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,_=r;else if(r.length)_||(_=[]),_.pop(),_=_.concat(r),n.search=e.search,n.query=e.query;else if(!nm(e.search))return w&&(n.hostname=n.host=_.shift(),(v=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=v.shift(),n.host=n.hostname=v.shift())),n.search=e.search,n.query=e.query,rm(n.pathname)&&rm(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n;if(!_.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var S=_.slice(-1)[0],k=(n.host||e.host||_.length>1)&&("."===S||".."===S)||""===S,E=0,P=_.length;P>=0;P--)"."===(S=_[P])?_.splice(P,1):".."===S?(_.splice(P,1),E++):E&&(_.splice(P,1),E--);if(!m&&!b)for(;E--;E)_.unshift("..");!m||""===_[0]||_[0]&&"/"===_[0].charAt(0)||_.unshift(""),k&&"/"!==_.join("/").substr(-1)&&_.push("");var T=""===_[0]||_[0]&&"/"===_[0].charAt(0);return w&&(n.hostname=n.host=T?"":_.length?_.shift():"",(v=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=v.shift(),n.host=n.hostname=v.shift())),(m=m||n.host&&_.length)&&!T&&_.unshift(""),_.length?n.pathname=_.join("/"):(n.pathname=null,n.path=null),rm(n.pathname)&&rm(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},bm.prototype.parseHost=function(){return Lm(this)};var Fm={version:"1.0.0",encode:function(e){return e.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")},decode:function(e){return new ny(e=(e+=Array(5-e.length%4).join("=")).replace(/\-/g,"+").replace(/\_/g,"/"),"base64")},validate:function(e){return/^[A-Za-z0-9\-_]+$/.test(e)}},Nm=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.fromBase64url=i,t.toBase64Url=o,t.encode=a,t.decode=u,t.validate=s;var r,n=(r=Fm)&&r.__esModule?r:{default:r};function i(e){return n.default.decode(e).toString()}function o(e){var t=e;return Uy(t)||(t=ny.from(t)),n.default.encode(t)}function a(e){return o(e)}function u(e){return i(e)}function s(e){return n.default.validate(e)}t.default={fromBase64url:i,toBase64Url:o,encode:a,decode:u,validate:s}});t(Nm);Nm.fromBase64url,Nm.toBase64Url,Nm.encode,Nm.decode,Nm.validate;var Um=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=Cf)&&r.__esModule?r:{default:r};t.default=function(e,t,r){if(!e)throw new Error("`fn` must be a function");if(!t)throw new Error("`wait` is required");if(!(r=r||{}).maxWait)throw new Error("`options.maxWait` is required");if(!r.maxCalls)throw new Error("`options.maxCalls` is required");var i=r,o=i.maxCalls,a=i.maxWait,u=0,s=void 0,c=void 0;return function(){u+=1,clearTimeout(c),c=setTimeout(function(){return l()},t),s||(s=setTimeout(function(){return l()},a)),u>=o&&(0,n.default)(l,this,[])};function l(){clearTimeout(c),c=null,clearTimeout(s),s=null,u=0,(0,n.default)(e,this,[])}}});t(Um);var zm=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.forEach(function(e){if(!t[e])throw new Error("missing required property "+e+" from "+t)})}});t(zm);var qm=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=bf)&&r.__esModule?r:{default:r};t.default=function(){var e=this;this.promise=new n.default(function(t,r){e.resolve=t,e.reject=r})}});t(qm);var Bm=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(!e||!t)throw new Error("missing parameter for makeStateDataType");return{dataType:{set:function(r){return r instanceof e?(r.parent=this,{val:r,type:t}):{val:r?new e(r,{parent:this}):void 0,type:t}},compare:function(e,t){return e===t},onChange:function(e,t,r){t&&this.stopListening(t,"all",this._getCachedEventBubblingHandler(r)),e&&this.listenTo(e,"all",this._getCachedEventBubblingHandler(r))}},prop:{test:function(e){return!!e&&(e.parent=this,!1)},type:t}}}});t(Bm);var Wm=r(function(e,t){t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}});t(Wm),tc(tc.S+tc.F*!Us,"Object",{defineProperty:Zs.f});var Vm=$s.Object,Gm=function(e,t,r){return Vm.defineProperty(e,t,r)},Hm=r(function(e){e.exports={default:Gm,__esModule:!0}});t(Hm);var $m=r(function(e,t){t.__esModule=!0;var r,n=(r=Hm)&&r.__esModule?r:{default:r};t.default=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,n.default)(e,i.key,i)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}()});t($m);var Jm=Array.isArray||function(e){return"Array"==Cs(e)},Ym=Nc("species"),Km=function(e,t){return new(function(e){var t;return Jm(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!Jm(t.prototype)||(t=void 0),Is(t)&&null===(t=t[Ym])&&(t=void 0)),void 0===t?Array:t}(e))(t)},Xm=function(e,t){var r=1==e,n=2==e,i=3==e,o=4==e,a=6==e,u=5==e||a,s=t||Km;return function(t,c,l){for(var f,d,p=Wc(t),h=Ms(p),v=Ys(c,l,3),g=yc(h.length),y=0,m=r?s(t,g):n?s(t,0):void 0;g>y;y++)if((u||y in h)&&(d=v(f=h[y],y,p),e))if(r)m[y]=d;else if(d)switch(e){case 3:return!0;case 5:return f;case 6:return y;case 2:m.push(f)}else if(o)return!1;return a?-1:i||o?o:m}},Zm=r(function(e){var t=kc("meta"),r=Zs.f,n=0,i=Object.isExtensible||function(){return!0},o=!Ns(function(){return i(Object.preventExtensions({}))}),a=function(e){r(e,t,{value:{i:"O"+ ++n,w:{}}})},u=e.exports={KEY:t,NEED:!1,fastKey:function(e,r){if(!Is(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!Fs(e,t)){if(!i(e))return"F";if(!r)return"E";a(e)}return e[t].i},getWeak:function(e,r){if(!Fs(e,t)){if(!i(e))return!0;if(!r)return!1;a(e)}return e[t].w},onFreeze:function(e){return o&&u.NEED&&i(e)&&!Fs(e,t)&&a(e),e}}}),Qm=(Zm.KEY,Zm.NEED,Zm.fastKey,Zm.getWeak,Zm.onFreeze,function(e,t){if(!Is(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}),eb=Zm.getWeak,tb=Xm(5),rb=Xm(6),nb=0,ib=function(e){return e._l||(e._l=new ob)},ob=function(){this.a=[]},ab=function(e,t){return tb(e.a,function(e){return e[0]===t})};ob.prototype={get:function(e){var t=ab(this,e);if(t)return t[1]},has:function(e){return!!ab(this,e)},set:function(e,t){var r=ab(this,e);r?r[1]=t:this.a.push([e,t])},delete:function(e){var t=rb(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}};var ub={getConstructor:function(e,t,r,n){var i=e(function(e,o){fl(e,i,t,"_i"),e._t=t,e._i=nb++,e._l=void 0,null!=o&&ml(o,r,e[n],e)});return Wl(i.prototype,{delete:function(e){if(!Is(e))return!1;var r=eb(e);return!0===r?ib(Qm(this,t)).delete(e):r&&Fs(r,this._i)&&delete r[this._i]},has:function(e){if(!Is(e))return!1;var r=eb(e);return!0===r?ib(Qm(this,t)).has(e):r&&Fs(r,this._i)}}),i},def:function(e,t,r){var n=eb(Ks(t),!0);return!0===n?ib(e).set(t,r):n[e._i]=r,e},ufstore:ib},sb=Zs.f,cb=Xm(0),lb=function(e,t,r,n,i,o){var a=zs[e],u=a,s=i?"set":"add",c=u&&u.prototype,l={};return Us&&"function"==typeof u&&(o||c.forEach&&!Ns(function(){(new u).entries().next()}))?(u=t(function(t,r){fl(t,u,e,"_c"),t._c=new a,null!=r&&ml(r,i,t[s],t)}),cb("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in c&&(!o||"clear"!=e)&&Qs(u.prototype,e,function(r,n){if(fl(this,u,e),!t&&o&&!Is(r))return"get"==e&&void 0;var i=this._c[e](0===r?0:r,n);return t?this:i})}),o||sb(u.prototype,"size",{get:function(){return this._c.size}})):(u=n.getConstructor(t,e,i,s),Wl(u.prototype,r),Zm.NEED=!0),qc(u,e),l[e]=u,tc(tc.G+tc.W+tc.F,l),o||n.setStrong(u,e,i),u},fb=(r(function(e){var t,r=Xm(0),n=Qm,i=!zs.ActiveXObject&&"ActiveXObject"in zs,o=Zm.getWeak,a=Object.isExtensible,u=ub.ufstore,s=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},c={get:function(e){if(Is(e)){var t=o(e);return!0===t?u(Qm(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return ub.def(Qm(this,"WeakMap"),e,t)}},l=e.exports=lb("WeakMap",s,c,ub,!0,!0);n&&i&&(t=ub.getConstructor(s,"WeakMap"),Sf(t.prototype,c),Zm.NEED=!0,r(["delete","has","get","set"],function(e){var r=l.prototype,n=r[e];hc(r,e,function(r,i){if(Is(r)&&!a(r)){this._f||(this._f=new t);var o=this._f[e](r,i);return"set"==e?this:o}return n.call(this,r,i)})}))}),function(e){tc(tc.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})});fb("WeakMap");var db=function(e){tc(tc.S,e,{from:function(e){var t,r,n,i,o=arguments[1];return Js(this),(t=void 0!==o)&&Js(o),null==e?new this:(r=[],t?(n=0,i=Ys(o,arguments[2],2),ml(e,!1,function(e){r.push(i(e,n++))})):ml(e,!1,r.push,r),new this(r))}})};db("WeakMap");var pb=$s.WeakMap,hb=r(function(e){e.exports={default:pb,__esModule:!0}});t(hb);var vb=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(Wm),n=a($m),i=a(hb),o=a(ym);function a(e){return e&&e.__esModule?e:{default:e}}function u(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(e.add)e.add.apply(e,r);else if(e.set)e.set.apply(e,r);else{if(!e.push)throw new TypeError("Could not determine how to insert into the specified container");e.push.apply(e,r)}}t.default=function e(){for(var t=arguments.length,a=Array(t),s=0;s<t;s++)a[s]=arguments[s];var c=a.shift(),l=new i.default,f=new i.default,d=a.length>1?e.apply(void 0,a):a[0],p="("+[c.name].concat(a.map(function(e){return e.name})).join(", ")+")";return function(){function e(){(0,r.default)(this,e);for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];l.set(this,new(Function.prototype.bind.apply(c,[null].concat(n)))),f.set(this,0)}return(0,n.default)(e,[{key:"add",value:function(){return this.set.apply(this,arguments)}},{key:"clear",value:function(){var e=l.get(this).clear();return f.set(this,0),e}},{key:"delete",value:function(e){for(var t=l.get(this),r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];if(!n.length)return t.delete(e);var o=t.get(e);if(!o)return!1;var a=o.delete.apply(o,n);return a&&f.set(this,f.get(this)-1),0===o.size&&t.delete(e),a}},{key:"get",value:function(e){var t=l.get(this);if(!t.get)return t;for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];if(!n.length)return t.get(e);var o=t.get(e);return o?o.get?o.get.apply(o,n):o:void 0}},{key:"has",value:function(){return void 0!==this.get.apply(this,arguments)}},{key:"set",value:function(){for(var e=!1,t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];this.has.apply(this,r)&&(e=!0);var i=l.get(this),o=r.shift();if(!i.get)return u.apply(void 0,[i,o].concat(r)),this;var a=i.get(o);if(!a){if(!d)return u.apply(void 0,[i,o].concat(r)),this;u(i,o,a=new d)}return u.apply(void 0,[a].concat(r)),e||f.set(this,f.get(this)+1),this}},{key:"inspect",value:function(){return"Container"+p+" {\n  "+o.default.inspect(l.get(this),{depth:null})+"\n}"}},{key:"size",get:function(){return f.get(this)}}]),e}()}});t(vb);var gb={f:Nc},yb=gb.f("iterator"),mb=r(function(e){e.exports={default:yb,__esModule:!0}});t(mb);var bb=Zs.f,_b=function(e){var t=$s.Symbol||($s.Symbol={});"_"==e.charAt(0)||e in t||bb(t,e,{value:gb.f(e)})},wb=Mc.concat("length","prototype"),Sb={f:Object.getOwnPropertyNames||function(e){return Cc(e,wb)}},kb=Sb.f,Eb={}.toString,Pb="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Tb={f:function(e){return Pb&&"[object Window]"==Eb.call(e)?function(e){try{return kb(e)}catch(e){return Pb.slice()}}(e):kb(js(e))}},Ob=Zm.KEY,Cb=Hs.f,Mb=Zs.f,xb=Tb.f,jb=zs.Symbol,Rb=zs.JSON,Ab=Rb&&Rb.stringify,Ib=Nc("_hidden"),Db=Nc("toPrimitive"),Lb={}.propertyIsEnumerable,Fb=_c("symbol-registry"),Nb=_c("symbols"),Ub=_c("op-symbols"),zb=Object.prototype,qb="function"==typeof jb,Bb=zs.QObject,Wb=!Bb||!Bb.prototype||!Bb.prototype.findChild,Vb=Us&&Ns(function(){return 7!=Fc(Mb({},"a",{get:function(){return Mb(this,"a",{value:7}).a}})).a})?function(e,t,r){var n=Cb(zb,t);n&&delete zb[t],Mb(e,t,r),n&&e!==zb&&Mb(zb,t,n)}:Mb,Gb=function(e){var t=Nb[e]=Fc(jb.prototype);return t._k=e,t},Hb=qb&&"symbol"==typeof jb.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof jb},$b=function(e,t,r){return e===zb&&$b(Ub,t,r),Ks(e),t=Ds(t,!0),Ks(r),Fs(Nb,t)?(r.enumerable?(Fs(e,Ib)&&e[Ib][t]&&(e[Ib][t]=!1),r=Fc(r,{enumerable:As(0,!1)})):(Fs(e,Ib)||Mb(e,Ib,As(1,{})),e[Ib][t]=!0),Vb(e,t,r)):Mb(e,t,r)},Jb=function(e,t){Ks(e);for(var r,n=function(e){var t=xc(e),r=_f.f;if(r)for(var n,i=r(e),o=Rs.f,a=0;i.length>a;)o.call(e,n=i[a++])&&t.push(n);return t}(t=js(t)),i=0,o=n.length;o>i;)$b(e,r=n[i++],t[r]);return e},Yb=function(e){var t=Lb.call(this,e=Ds(e,!0));return!(this===zb&&Fs(Nb,e)&&!Fs(Ub,e))&&(!(t||!Fs(this,e)||!Fs(Nb,e)||Fs(this,Ib)&&this[Ib][e])||t)},Kb=function(e,t){if(e=js(e),t=Ds(t,!0),e!==zb||!Fs(Nb,t)||Fs(Ub,t)){var r=Cb(e,t);return!r||!Fs(Nb,t)||Fs(e,Ib)&&e[Ib][t]||(r.enumerable=!0),r}},Xb=function(e){for(var t,r=xb(js(e)),n=[],i=0;r.length>i;)Fs(Nb,t=r[i++])||t==Ib||t==Ob||n.push(t);return n},Zb=function(e){for(var t,r=e===zb,n=xb(r?Ub:js(e)),i=[],o=0;n.length>o;)!Fs(Nb,t=n[o++])||r&&!Fs(zb,t)||i.push(Nb[t]);return i};qb||(hc((jb=function(){if(this instanceof jb)throw TypeError("Symbol is not a constructor!");var e=kc(arguments.length>0?arguments[0]:void 0),t=function(r){this===zb&&t.call(Ub,r),Fs(this,Ib)&&Fs(this[Ib],e)&&(this[Ib][e]=!1),Vb(this,e,As(1,r))};return Us&&Wb&&Vb(zb,e,{configurable:!0,set:t}),Gb(e)}).prototype,"toString",function(){return this._k}),Hs.f=Kb,Zs.f=$b,Sb.f=Tb.f=Xb,Rs.f=Yb,_f.f=Zb,gb.f=function(e){return Gb(Nc(e))}),tc(tc.G+tc.W+tc.F*!qb,{Symbol:jb});for(var Qb="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),e_=0;Qb.length>e_;)Nc(Qb[e_++]);for(var t_=xc(Nc.store),r_=0;t_.length>r_;)_b(t_[r_++]);tc(tc.S+tc.F*!qb,"Symbol",{for:function(e){return Fs(Fb,e+="")?Fb[e]:Fb[e]=jb(e)},keyFor:function(e){if(!Hb(e))throw TypeError(e+" is not a symbol!");for(var t in Fb)if(Fb[t]===e)return t},useSetter:function(){Wb=!0},useSimple:function(){Wb=!1}}),tc(tc.S+tc.F*!qb,"Object",{create:function(e,t){return void 0===t?Fc(e):Jb(Fc(e),t)},defineProperty:$b,defineProperties:Jb,getOwnPropertyDescriptor:Kb,getOwnPropertyNames:Xb,getOwnPropertySymbols:Zb}),Rb&&tc(tc.S+tc.F*(!qb||Ns(function(){var e=jb();return"[null]"!=Ab([e])||"{}"!=Ab({a:e})||"{}"!=Ab(Object(e))})),"JSON",{stringify:function(e){for(var t,r,n=[e],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=t=n[1],(Is(t)||void 0!==e)&&!Hb(e))return Jm(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!Hb(t))return t}),n[1]=t,Ab.apply(Rb,n)}}),jb.prototype[Db]||Qs(jb.prototype,Db,jb.prototype.valueOf),qc(jb,"Symbol"),qc(Math,"Math",!0),qc(zs.JSON,"JSON",!0),_b("asyncIterator"),_b("observable");var n_=$s.Symbol,i_=r(function(e){e.exports={default:n_,__esModule:!0}});t(i_);var o_=r(function(e,t){t.__esModule=!0;var r=o(mb),n=o(i_),i="function"==typeof n.default&&"symbol"==typeof r.default?function(e){return typeof e}:function(e){return e&&"function"==typeof n.default&&e.constructor===n.default&&e!==n.default.prototype?"symbol":typeof e};function o(e){return e&&e.__esModule?e:{default:e}}t.default="function"==typeof n.default&&"symbol"===i(r.default)?function(e){return void 0===e?"undefined":i(e)}:function(e){return e&&"function"==typeof n.default&&e.constructor===n.default&&e!==n.default.prototype?"symbol":void 0===e?"undefined":i(e)}});t(o_);var a_=Zs.f,u_=Zm.fastKey,s_=Us?"_s":"size",c_=function(e,t){var r,n=u_(t);if("F"!==n)return e._i[n];for(r=e._f;r;r=r.n)if(r.k==t)return r},l_={getConstructor:function(e,t,r,n){var i=e(function(e,o){fl(e,i,t,"_i"),e._t=t,e._i=Fc(null),e._f=void 0,e._l=void 0,e[s_]=0,null!=o&&ml(o,r,e[n],e)});return Wl(i.prototype,{clear:function(){for(var e=Qm(this,t),r=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];e._f=e._l=void 0,e[s_]=0},delete:function(e){var r=Qm(this,t),n=c_(r,e);if(n){var i=n.n,o=n.p;delete r._i[n.i],n.r=!0,o&&(o.n=i),i&&(i.p=o),r._f==n&&(r._f=i),r._l==n&&(r._l=o),r[s_]--}return!!n},forEach:function(e){Qm(this,t);for(var r,n=Ys(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!c_(Qm(this,t),e)}}),Us&&a_(i.prototype,"size",{get:function(){return Qm(this,t)[s_]}}),i},def:function(e,t,r){var n,i,o=c_(e,t);return o?o.v=r:(e._l=o={i:i=u_(t,!0),k:t,v:r,p:n=e._l,n:void 0,r:!1},e._f||(e._f=o),n&&(n.n=o),e[s_]++,"F"!==i&&(e._i[i]=o)),e},getEntry:c_,setStrong:function(e,t,r){Kc(e,t,function(e,r){this._t=Qm(e,t),this._k=r,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?Zc(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,Zc(1))},r?"entries":"values",!r,!0),Gl(t)}},f_=(lb("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=l_.getEntry(Qm(this,"Map"),e);return t&&t.v},set:function(e,t){return l_.def(Qm(this,"Map"),0===e?0:e,t)}},l_,!0),function(e){return function(){if(ll(this)!=e)throw TypeError(e+"#toJSON isn't generic");return ml(this,!1,(r=[]).push,r,t),r;var t,r}});tc(tc.P+tc.R,"Map",{toJSON:f_("Map")}),fb("Map"),db("Map");var d_=$s.Map,p_=r(function(e){e.exports={default:d_,__esModule:!0}});t(p_);var h_=function(e){return"function"==typeof e?e:tg};var v_=function(e,t){return ug(Qv(e,t,tg),e+"")},g_=ch&&new ch,y_=g_?function(e,t){return g_.set(e,t),e}:tg;var m_=function(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=Yh(e.prototype),n=e.apply(r,t);return sd(n)?n:r}},b_=1;var __=function(e,t,r){var n=t&b_,i=m_(e);return function t(){return(this&&this!==Yf&&this instanceof t?i:e).apply(n?r:this,arguments)}},w_=Math.max;var S_=function(e,t,r,n){for(var i=-1,o=e.length,a=r.length,u=-1,s=t.length,c=w_(o-a,0),l=Array(s+c),f=!n;++u<s;)l[u]=t[u];for(;++i<a;)(f||i<o)&&(l[r[i]]=e[i]);for(;c--;)l[u++]=e[i++];return l},k_=Math.max;var E_=function(e,t,r,n){for(var i=-1,o=e.length,a=-1,u=r.length,s=-1,c=t.length,l=k_(o-u,0),f=Array(l+c),d=!n;++i<l;)f[i]=e[i];for(var p=i;++s<c;)f[p+s]=t[s];for(;++a<u;)(d||i<o)&&(f[p+r[a]]=e[i++]);return f};var P_=function(e,t){for(var r=e.length,n=0;r--;)e[r]===t&&++n;return n};var T_=function(){},O_=4294967295;function C_(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=O_,this.__views__=[]}C_.prototype=Yh(T_.prototype),C_.prototype.constructor=C_;var M_=C_;var x_=function(){},j_=g_?function(e){return g_.get(e)}:x_,R_={},A_=Object.prototype.hasOwnProperty;var I_=function(e){for(var t=e.name+"",r=R_[t],n=A_.call(R_,t)?r.length:0;n--;){var i=r[n],o=i.func;if(null==o||o==e)return i.name}return t};function D_(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}D_.prototype=Yh(T_.prototype),D_.prototype.constructor=D_;var L_=D_;var F_=function(e){if(e instanceof M_)return e.clone();var t=new L_(e.__wrapped__,e.__chain__);return t.__actions__=Hp(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t},N_=Object.prototype.hasOwnProperty;function U_(e){if(sp(e)&&!vp(e)&&!(e instanceof M_)){if(e instanceof L_)return e;if(N_.call(e,"__wrapped__"))return F_(e)}return new L_(e)}U_.prototype=T_.prototype,U_.prototype.constructor=U_;var z_=U_;var q_=function(e){var t=I_(e),r=z_[t];if("function"!=typeof r||!(t in M_.prototype))return!1;if(e===r)return!0;var n=j_(r);return!!n&&e===n[0]},B_=ag(y_),W_=/\{\n\/\* \[wrapped with (.+)\] \*/,V_=/,? & /;var G_=function(e){var t=e.match(W_);return t?t[1].split(V_):[]},H_=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;var $_=function(e,t){var r=t.length;if(!r)return e;var n=r-1;return t[n]=(r>1?"& ":"")+t[n],t=t.join(r>2?", ":" "),e.replace(H_,"{\n/* [wrapped with "+t+"] */\n")};var J_=function(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1};var Y_=function(e){return e!=e};var K_=function(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1};var X_=function(e,t,r){return t==t?K_(e,t,r):J_(e,Y_,r)};var Z_=function(e,t){return!(null==e||!e.length)&&X_(e,t,0)>-1},Q_=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];var ew=function(e,t){return tp(Q_,function(r){var n="_."+r[0];t&r[1]&&!Z_(e,n)&&e.push(n)}),e.sort()};var tw=function(e,t,r){var n=t+"";return ug(e,$_(n,ew(G_(n),r)))},rw=1,nw=2,iw=4,ow=8,aw=32,uw=64;var sw=function(e,t,r,n,i,o,a,u,s,c){var l=t&ow;t|=l?aw:uw,(t&=~(l?uw:aw))&iw||(t&=~(rw|nw));var f=[e,t,i,l?o:void 0,l?a:void 0,l?void 0:o,l?void 0:a,u,s,c],d=r.apply(void 0,f);return q_(e)&&B_(d,f),d.placeholder=n,tw(d,e,t)};var cw=function(e){return e.placeholder},lw=Math.min;var fw=function(e,t){for(var r=e.length,n=lw(t.length,r),i=Hp(e);n--;){var o=t[n];e[n]=_p(o,r)?i[o]:void 0}return e},dw="__lodash_placeholder__";var pw=function(e,t){for(var r=-1,n=e.length,i=0,o=[];++r<n;){var a=e[r];a!==t&&a!==dw||(e[r]=dw,o[i++]=r)}return o},hw=1,vw=2,gw=8,yw=16,mw=128,bw=512;var _w=function e(t,r,n,i,o,a,u,s,c,l){var f=r&mw,d=r&hw,p=r&vw,h=r&(gw|yw),v=r&bw,g=p?void 0:m_(t);return function y(){for(var m=arguments.length,b=Array(m),_=m;_--;)b[_]=arguments[_];if(h)var w=cw(y),S=P_(b,w);if(i&&(b=S_(b,i,o,h)),a&&(b=E_(b,a,u,h)),m-=S,h&&m<l){var k=pw(b,w);return sw(t,r,e,y.placeholder,n,b,k,s,c,l-m)}var E=d?n:this,P=p?E[t]:t;return m=b.length,s?b=fw(b,s):v&&m>1&&b.reverse(),f&&c<m&&(b.length=c),this&&this!==Yf&&this instanceof y&&(P=g||m_(P)),P.apply(E,b)}};var ww=function(e,t,r){var n=m_(e);return function i(){for(var o=arguments.length,a=Array(o),u=o,s=cw(i);u--;)a[u]=arguments[u];var c=o<3&&a[0]!==s&&a[o-1]!==s?[]:pw(a,s);return(o-=c.length)<r?sw(e,t,_w,i.placeholder,void 0,a,c,void 0,void 0,r-o):Xv(this&&this!==Yf&&this instanceof i?n:e,this,a)}},Sw=1;var kw=function(e,t,r,n){var i=t&Sw,o=m_(e);return function t(){for(var a=-1,u=arguments.length,s=-1,c=n.length,l=Array(c+u),f=this&&this!==Yf&&this instanceof t?o:e;++s<c;)l[s]=n[s];for(;u--;)l[s++]=arguments[++a];return Xv(f,i?r:this,l)}},Ew="__lodash_placeholder__",Pw=1,Tw=2,Ow=4,Cw=8,Mw=128,xw=256,jw=Math.min;var Rw=function(e,t){var r=e[1],n=t[1],i=r|n,o=i<(Pw|Tw|Mw),a=n==Mw&&r==Cw||n==Mw&&r==xw&&e[7].length<=t[8]||n==(Mw|xw)&&t[7].length<=t[8]&&r==Cw;if(!o&&!a)return e;n&Pw&&(e[2]=t[2],i|=r&Pw?0:Ow);var u=t[3];if(u){var s=e[3];e[3]=s?S_(s,u,t[4]):u,e[4]=s?pw(e[3],Ew):t[4]}return(u=t[5])&&(s=e[5],e[5]=s?E_(s,u,t[6]):u,e[6]=s?pw(e[5],Ew):t[6]),(u=t[7])&&(e[7]=u),n&Mw&&(e[8]=null==e[8]?t[8]:jw(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i,e},Aw=NaN,Iw=/^\s+|\s+$/g,Dw=/^[-+]0x[0-9a-f]+$/i,Lw=/^0b[01]+$/i,Fw=/^0o[0-7]+$/i,Nw=parseInt;var Uw=function(e){if("number"==typeof e)return e;if(vv(e))return Aw;if(sd(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=sd(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Iw,"");var r=Lw.test(e);return r||Fw.test(e)?Nw(e.slice(2),r?2:8):Dw.test(e)?Aw:+e},zw=1/0,qw=1.7976931348623157e308;var Bw=function(e){return e?(e=Uw(e))===zw||e===-zw?(e<0?-1:1)*qw:e==e?e:0:0===e?e:0};var Ww=function(e){var t=Bw(e),r=t%1;return t==t?r?t-r:t:0},Vw="Expected a function",Gw=1,Hw=2,$w=8,Jw=16,Yw=32,Kw=64,Xw=Math.max;var Zw=function(e,t,r,n,i,o,a,u){var s=t&Hw;if(!s&&"function"!=typeof e)throw new TypeError(Vw);var c=n?n.length:0;if(c||(t&=~(Yw|Kw),n=i=void 0),a=void 0===a?a:Xw(Ww(a),0),u=void 0===u?u:Ww(u),c-=i?i.length:0,t&Kw){var l=n,f=i;n=i=void 0}var d=s?void 0:j_(e),p=[e,t,r,n,i,l,f,o,a,u];if(d&&Rw(p,d),e=p[0],t=p[1],r=p[2],n=p[3],i=p[4],!(u=p[9]=void 0===p[9]?s?0:e.length:Xw(p[9]-c,0))&&t&($w|Jw)&&(t&=~($w|Jw)),t&&t!=Gw)h=t==$w||t==Jw?ww(e,t,u):t!=Yw&&t!=(Gw|Yw)||i.length?_w.apply(void 0,p):kw(e,t,r,n);else var h=__(e,t,r);return tw((d?y_:B_)(h,p),e,t)},Qw=v_(function(e,t){var r=pw(t,cw(Qw));return Zw(e,32,void 0,t,r)});Qw.placeholder={};var eS=Qw;var tS=function(e,t){return eS(h_(t),e)},rS=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=c(o_),n=c(bf),i=c(Cf),o=c(p_),a=c(hb),u=c(tS);t.default=function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];if(3===t.length)return(0,i.default)(f,null,t);var a=t[0]||{},s=a.cacheFailures,c=a.cacheSuccesses,l=a.keyFactory;return f;function f(e,t,o){var a=t;return o.value=(0,u.default)(o.value,function(t){for(var r=this,o=a,u=arguments.length,f=Array(u>1?u-1:0),p=1;p<u;p++)f[p-1]=arguments[p];l&&(o=o+"_"+l.apply(void 0,f));var h=d.get(this,e,o);return h||(h=(0,i.default)(t,this,f),!s&&h&&h.catch&&(h=h.catch(function(t){return d.delete(r,e,o),n.default.reject(t)})),!c&&h&&h.then&&(h=h.then(function(t){return d.delete(r,e,o),t})),d.set(this,e,o,h),h)}),"object"!==(void 0===e?"undefined":(0,r.default)(e))||e.prototype||(e[t]=o.value),o}};var s=c(vb);function c(e){return e&&e.__esModule?e:{default:e}}var l=a.default,f=o.default,d=new((0,s.default)(l,f,f))});t(rS);var nS=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={email:/^[^\s]+?@[^\s]+?$/,uuid:/^[a-f\d]{8}(?:-[a-f\d]{4}){3}-[a-f\d]{12}$/,execEmail:/[^\s]+?@[^\s]+?/,execUuid:/[a-f\d]{8}(?:-[a-f\d]{4}){3}-[a-f\d]{12}/}});t(nS);var iS=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(Cf),n=i(vp);function i(e){return e&&e.__esModule?e:{default:e}}t.proxyEvents=function(e,t){return["on","once"].forEach(function(r){t[r]=function(){return e[r].apply(e,arguments),t}}),e},t.transferEvents=function(e,t,i){(e=(0,n.default)(e)?e:[e]).forEach(function(e){t.on&&t.on(e,function(){for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return function(e){var t=e.trigger||e.emit;if(!t)throw new Error("count not determine emit method");for(var n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return(0,r.default)(t,e,i)}.apply(void 0,[i,e].concat(n))})})}});t(iS);iS.proxyEvents,iS.transferEvents;var oS=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=bf)&&r.__esModule?r:{default:r};t.default=function(e){return function(){return n.default.resolve(e)}}});t(oS);var aS=function(e,t,r){if(!sd(r))return!1;var n=typeof t;return!!("number"==n?Fp(r)&&_p(t,r.length):"string"==n&&t in r)&&If(r[t],e)},uS=Object.prototype,sS=uS.hasOwnProperty,cS=v_(function(e,t){e=Object(e);var r=-1,n=t.length,i=n>2?t[2]:void 0;for(i&&aS(t[0],t[1],i)&&(n=1);++r<n;)for(var o=t[r],a=Wp(o),u=-1,s=a.length;++u<s;){var c=a[u],l=e[c];(void 0===l||If(l,uS[c])&&!sS.call(e,c))&&(e[c]=o[c])}return e});function lS(){}function fS(){fS.init.call(this)}function dS(e){return void 0===e._maxListeners?fS.defaultMaxListeners:e._maxListeners}function pS(e,t,r,n){var i,o,a,u;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),a=o[t]):(o=e._events=new lS,e._eventsCount=0),a){if("function"==typeof a?a=o[t]=n?[r,a]:[a,r]:n?a.unshift(r):a.push(r),!a.warned&&(i=dS(e))&&i>0&&a.length>i){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=a.length,u=s,"function"==typeof console.warn?console.warn(u):console.log(u)}}else a=o[t]=r,++e._eventsCount;return e}function hS(e,t,r){var n=!1;function i(){e.removeListener(t,i),n||(n=!0,r.apply(e,arguments))}return i.listener=r,i}function vS(e){var t=this._events;if(t){var r=t[e];if("function"==typeof r)return 1;if(r)return r.length}return 0}function gS(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function yS(e){Error.call(this,e),this.message=e}function mS(e){Error.call(this,e),this.message=e}lS.prototype=Object.create(null),fS.EventEmitter=fS,fS.usingDomains=!1,fS.prototype.domain=void 0,fS.prototype._events=void 0,fS.prototype._maxListeners=void 0,fS.defaultMaxListeners=10,fS.init=function(){this.domain=null,fS.usingDomains&&(void 0).active&&(void 0).Domain,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new lS,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},fS.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},fS.prototype.getMaxListeners=function(){return dS(this)},fS.prototype.emit=function(e){var t,r,n,i,o,a,u,s="error"===e;if(a=this._events)s=s&&null==a.error;else if(!s)return!1;if(u=this.domain,s){if(t=arguments[1],!u){if(t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=u,t.domainThrown=!1,u.emit("error",t),!1}if(!(r=a[e]))return!1;var l="function"==typeof r;switch(n=arguments.length){case 1:!function(e,t,r){if(t)e.call(r);else for(var n=e.length,i=gS(e,n),o=0;o<n;++o)i[o].call(r)}(r,l,this);break;case 2:!function(e,t,r,n){if(t)e.call(r,n);else for(var i=e.length,o=gS(e,i),a=0;a<i;++a)o[a].call(r,n)}(r,l,this,arguments[1]);break;case 3:!function(e,t,r,n,i){if(t)e.call(r,n,i);else for(var o=e.length,a=gS(e,o),u=0;u<o;++u)a[u].call(r,n,i)}(r,l,this,arguments[1],arguments[2]);break;case 4:!function(e,t,r,n,i,o){if(t)e.call(r,n,i,o);else for(var a=e.length,u=gS(e,a),s=0;s<a;++s)u[s].call(r,n,i,o)}(r,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(n-1),o=1;o<n;o++)i[o-1]=arguments[o];!function(e,t,r,n){if(t)e.apply(r,n);else for(var i=e.length,o=gS(e,i),a=0;a<i;++a)o[a].apply(r,n)}(r,l,this,i)}return!0},fS.prototype.addListener=function(e,t){return pS(this,e,t,!1)},fS.prototype.on=fS.prototype.addListener,fS.prototype.prependListener=function(e,t){return pS(this,e,t,!0)},fS.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,hS(this,e,t)),this},fS.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,hS(this,e,t)),this},fS.prototype.removeListener=function(e,t){var r,n,i,o,a;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(n=this._events))return this;if(!(r=n[e]))return this;if(r===t||r.listener&&r.listener===t)0==--this._eventsCount?this._events=new lS:(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length;o-- >0;)if(r[o]===t||r[o].listener&&r[o].listener===t){a=r[o].listener,i=o;break}if(i<0)return this;if(1===r.length){if(r[0]=void 0,0==--this._eventsCount)return this._events=new lS,this;delete n[e]}else!function(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}(r,i);n.removeListener&&this.emit("removeListener",e,a||t)}return this},fS.prototype.removeAllListeners=function(e){var t,r;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=new lS,this._eventsCount=0):r[e]&&(0==--this._eventsCount?this._events=new lS:delete r[e]),this;if(0===arguments.length){for(var n,i=Object.keys(r),o=0;o<i.length;++o)"removeListener"!==(n=i[o])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=new lS,this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},fS.prototype.listeners=function(e){var t,r=this._events;return r&&(t=r[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(t):[]},fS.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):vS.call(e,t)},fS.prototype.listenerCount=vS,fS.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]},ym.inherits(yS,Error),yS.prototype.name="IllegalArgumentError",ym.inherits(mS,Error),mS.prototype.name="IllegalStateError";var bS={IllegalStateError:mS,IllegalArgumentError:yS},_S=r(function(e){var t=e.exports=bS;function r(e,t,r,n){r=r||"";var i=new e(ym.format.apply(this,[r].concat(n)));throw Error.captureStackTrace(i,t),i}function n(e,n,i){r(t.IllegalArgumentError,e,n,i)}function i(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array"}return t}function o(e){return function(t,r){var o=i(t);if(o==e)return t;n(arguments.callee,r||'Expected "'+e+'" but got "'+o+'".',Array.prototype.slice.call(arguments,2))}}e.exports.checkArgument=function(e,t){e||n(arguments.callee,t,Array.prototype.slice.call(arguments,2))},e.exports.checkState=function(e,n){e||function(e,n,i){r(t.IllegalStateError,e,n,i)}(arguments.callee,n,Array.prototype.slice.call(arguments,2))},e.exports.checkIsDef=function(e,t){if(void 0!==e)return e;n(arguments.callee,t||"Expected value to be defined but was undefined.",Array.prototype.slice.call(arguments,2))},e.exports.checkIsDefAndNotNull=function(e,t){if(null!=e)return e;n(arguments.callee,t||'Expected value to be defined and not null but got "'+i(e)+'".',Array.prototype.slice.call(arguments,2))},e.exports.checkIsString=o("string"),e.exports.checkIsArray=o("array"),e.exports.checkIsNumber=o("number"),e.exports.checkIsBoolean=o("boolean"),e.exports.checkIsFunction=o("function"),e.exports.checkIsObject=o("object")}),wS=(_S.checkArgument,_S.checkState,_S.checkIsDef,_S.checkIsDefAndNotNull,_S.checkIsString,_S.checkIsArray,_S.checkIsNumber,_S.checkIsBoolean,_S.checkIsFunction,_S.checkIsObject,_S);function SS(e){fS.EventEmitter.call(this),this.backoffStrategy_=e,this.maxNumberOfRetry_=-1,this.backoffNumber_=0,this.backoffDelay_=0,this.timeoutID_=-1,this.handlers={backoff:this.onBackoff_.bind(this)}}ym.inherits(SS,fS.EventEmitter),SS.prototype.failAfter=function(e){wS.checkArgument(e>0,"Expected a maximum number of retry greater than 0 but got %s.",e),this.maxNumberOfRetry_=e},SS.prototype.backoff=function(e){wS.checkState(-1===this.timeoutID_,"Backoff in progress."),this.backoffNumber_===this.maxNumberOfRetry_?(this.emit("fail",e),this.reset()):(this.backoffDelay_=this.backoffStrategy_.next(),this.timeoutID_=setTimeout(this.handlers.backoff,this.backoffDelay_),this.emit("backoff",this.backoffNumber_,this.backoffDelay_,e))},SS.prototype.onBackoff_=function(){this.timeoutID_=-1,this.emit("ready",this.backoffNumber_,this.backoffDelay_),this.backoffNumber_++},SS.prototype.reset=function(){this.backoffNumber_=0,this.backoffStrategy_.reset(),clearTimeout(this.timeoutID_),this.timeoutID_=-1};var kS=SS;function ES(e){return null!=e}function PS(e){if(ES((e=e||{}).initialDelay)&&e.initialDelay<1)throw new Error("The initial timeout must be greater than 0.");if(ES(e.maxDelay)&&e.maxDelay<1)throw new Error("The maximal timeout must be greater than 0.");if(this.initialDelay_=e.initialDelay||100,this.maxDelay_=e.maxDelay||1e4,this.maxDelay_<=this.initialDelay_)throw new Error("The maximal backoff delay must be greater than the initial backoff delay.");if(ES(e.randomisationFactor)&&(e.randomisationFactor<0||e.randomisationFactor>1))throw new Error("The randomisation factor must be between 0 and 1.");this.randomisationFactor_=e.randomisationFactor||0}PS.prototype.getMaxDelay=function(){return this.maxDelay_},PS.prototype.getInitialDelay=function(){return this.initialDelay_},PS.prototype.next=function(){var e=this.next_(),t=1+Math.random()*this.randomisationFactor_;return Math.round(e*t)},PS.prototype.next_=function(){throw new Error("BackoffStrategy.next_() unimplemented.")},PS.prototype.reset=function(){this.reset_()},PS.prototype.reset_=function(){throw new Error("BackoffStrategy.reset_() unimplemented.")};var TS=PS;function OS(e){TS.call(this,e),this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay(),this.factor_=OS.DEFAULT_FACTOR,e&&void 0!==e.factor&&(wS.checkArgument(e.factor>1,"Exponential factor should be greater than 1 but got %s.",e.factor),this.factor_=e.factor)}ym.inherits(OS,TS),OS.DEFAULT_FACTOR=2,OS.prototype.next_=function(){return this.backoffDelay_=Math.min(this.nextBackoffDelay_,this.getMaxDelay()),this.nextBackoffDelay_=this.backoffDelay_*this.factor_,this.backoffDelay_},OS.prototype.reset_=function(){this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay()};var CS=OS;function MS(e){TS.call(this,e),this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay()}ym.inherits(MS,TS),MS.prototype.next_=function(){var e=Math.min(this.nextBackoffDelay_,this.getMaxDelay());return this.nextBackoffDelay_+=this.backoffDelay_,this.backoffDelay_=e,e},MS.prototype.reset_=function(){this.nextBackoffDelay_=this.getInitialDelay(),this.backoffDelay_=0};var xS=MS;function jS(e,t,r){fS.EventEmitter.call(this),wS.checkIsFunction(e,"Expected fn to be a function."),wS.checkIsArray(t,"Expected args to be an array."),wS.checkIsFunction(r,"Expected callback to be a function."),this.function_=e,this.arguments_=t,this.callback_=r,this.lastResult_=[],this.numRetries_=0,this.backoff_=null,this.strategy_=null,this.failAfter_=-1,this.retryPredicate_=jS.DEFAULT_RETRY_PREDICATE_,this.state_=jS.State_.PENDING}ym.inherits(jS,fS.EventEmitter),jS.State_={PENDING:0,RUNNING:1,COMPLETED:2,ABORTED:3},jS.DEFAULT_RETRY_PREDICATE_=function(e){return!0},jS.prototype.isPending=function(){return this.state_==jS.State_.PENDING},jS.prototype.isRunning=function(){return this.state_==jS.State_.RUNNING},jS.prototype.isCompleted=function(){return this.state_==jS.State_.COMPLETED},jS.prototype.isAborted=function(){return this.state_==jS.State_.ABORTED},jS.prototype.setStrategy=function(e){return wS.checkState(this.isPending(),"FunctionCall in progress."),this.strategy_=e,this},jS.prototype.retryIf=function(e){return wS.checkState(this.isPending(),"FunctionCall in progress."),this.retryPredicate_=e,this},jS.prototype.getLastResult=function(){return this.lastResult_.concat()},jS.prototype.getNumRetries=function(){return this.numRetries_},jS.prototype.failAfter=function(e){return wS.checkState(this.isPending(),"FunctionCall in progress."),this.failAfter_=e,this},jS.prototype.abort=function(){this.isCompleted()||this.isAborted()||(this.isRunning()&&this.backoff_.reset(),this.state_=jS.State_.ABORTED,this.lastResult_=[new Error("Backoff aborted.")],this.emit("abort"),this.doCallback_())},jS.prototype.start=function(e){wS.checkState(!this.isAborted(),"FunctionCall is aborted."),wS.checkState(this.isPending(),"FunctionCall already started.");var t=this.strategy_||new xS;this.backoff_=e?e(t):new kS(t),this.backoff_.on("ready",this.doCall_.bind(this,!0)),this.backoff_.on("fail",this.doCallback_.bind(this)),this.backoff_.on("backoff",this.handleBackoff_.bind(this)),this.failAfter_>0&&this.backoff_.failAfter(this.failAfter_),this.state_=jS.State_.RUNNING,this.doCall_(!1)},jS.prototype.doCall_=function(e){e&&this.numRetries_++;var t=["call"].concat(this.arguments_);fS.EventEmitter.prototype.emit.apply(this,t);var r=this.handleFunctionCallback_.bind(this);this.function_.apply(null,this.arguments_.concat(r))},jS.prototype.doCallback_=function(){this.callback_.apply(null,this.lastResult_)},jS.prototype.handleFunctionCallback_=function(){if(!this.isAborted()){var e=Array.prototype.slice.call(arguments);this.lastResult_=e,fS.EventEmitter.prototype.emit.apply(this,["callback"].concat(e));var t=e[0];t&&this.retryPredicate_(t)?this.backoff_.backoff(t):(this.state_=jS.State_.COMPLETED,this.doCallback_())}},jS.prototype.handleBackoff_=function(e,t,r){this.emit("backoff",e,t,r)};var RS=jS,AS={Backoff:kS,FunctionCall:RS,FibonacciStrategy:xS,ExponentialStrategy:CS,fibonacci:function(e){return new kS(new xS(e))},exponential:function(e){return new kS(new CS(e))},call:function(e,t,r){var n=Array.prototype.slice.call(arguments);return e=n[0],t=n.slice(1,n.length-1),r=n[n.length-1],new RS(e,t,r)}},IS=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=l(o_),n=l(bf),i=l(Cf),o=l(Ef),a=l(tS),u=l(hd),s=l(cS);t.default=function(){for(var e=arguments.length,t=Array(e),l=0;l<e;l++)t[l]=arguments[l];var f=t[0]||{};f=(0,o.default)({},f),(0,s.default)(f,{backoff:!0,delay:1,maxAttempts:3});var d=void 0;d=f.backoff?{initialDelay:f.delay,maxDelay:f.maxDelay}:{initialDelay:1,maxDelay:1};if(3===t.length)return(0,i.default)(p,null,t);return p;function p(e,t,o){return o.value=(0,a.default)(o.value,function(e){for(var t=this,r=arguments.length,o=Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];var s=new fS.EventEmitter,l=new n.default(function(r,n){var a=c.default.call(function(r){var n=(0,i.default)(e,t,o);return(0,u.default)(n.on)&&(n.on("progress",s.emit.bind(s,"progress")),n.on("upload-progress",s.emit.bind(s,"upload-progress")),n.on("download-progress",s.emit.bind(s,"download-progress"))),n.then(function(e){r(null,e)}).catch(function(e){e||(e=new Error("retryable method failed without providing an error object")),r(e)})},function(e,t){return e?n(e):r(t)});a.setStrategy(new c.default.ExponentialStrategy(d)),f.maxAttempts&&a.failAfter(f.maxAttempts-1),a.start()});return l.on=function(e,t){return s.on(e,t),l},l}),"object"!==(void 0===e?"undefined":(0,r.default)(e))||e.prototype||(e[t]=o.value),o}};var c=l(AS);function l(e){return e&&e.__esModule?e:{default:e}}});t(IS);var DS=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=bf)&&r.__esModule?r:{default:r};t.default=function(e){return function(t){return new n.default(function(r){r(e(t))}).then(function(){return t}).catch(function(){return t})}}});t(DS);var LS=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=a(Cf),n=a(bf),i=a(tS);t.default=function(e){return function(t,a,u){u.value=(0,i.default)(u.value,function(t){for(var i=this,a=arguments.length,u=Array(a>1?a-1:0),s=1;s<a;s++)u[s-1]=arguments[s];return new n.default(function(a){i[e]=!0,a((0,r.default)(t,i,u).then((0,o.default)(function(){i[e]=!1})).catch(function(t){return i[e]=!1,n.default.reject(t)}))})})}};var o=a(DS);function a(e){return e&&e.__esModule?e:{default:e}}});t(LS),tc(tc.S,"Object",{create:Fc});var FS=$s.Object,NS=function(e,t){return FS.create(e,t)},US=r(function(e){e.exports={default:NS,__esModule:!0}});t(US);var zS=function(e,t){if(Ks(e),!Is(t)&&null!==t)throw TypeError(t+": can't set as prototype!")},qS={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=Ys(Function.call,Hs.f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return zS(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:zS};tc(tc.S,"Object",{setPrototypeOf:qS.set});var BS=$s.Object.setPrototypeOf,WS=r(function(e){e.exports={default:BS,__esModule:!0}});t(WS);var VS=function(e,t,r){t in e?Zs.f(e,t,As(0,r)):e[t]=r};tc(tc.S+tc.F*!Zl(function(e){}),"Array",{from:function(e){var t,r,n,i,o=Wc(e),a="function"==typeof this?this:Array,u=arguments.length,s=u>1?arguments[1]:void 0,c=void 0!==s,l=0,f=yl(o);if(c&&(s=Ys(s,u>2?arguments[2]:void 0,2)),null==f||a==Array&&vl(f))for(r=new a(t=yc(o.length));t>l;l++)VS(r,l,c?s(o[l],l):o[l]);else for(i=f.call(o),r=new a;!(n=i.next()).done;l++)VS(r,l,c?dl(i,s,[n.value,l],!0):n.value);return r.length=l,r}});var GS=$s.Array.from,HS=r(function(e){e.exports={default:GS,__esModule:!0}});t(HS);var $S=[].slice,JS={},YS=Function.bind||function(e){var t=Js(this),r=$S.call(arguments,1),n=function(){var i=r.concat($S.call(arguments));return this instanceof n?function(e,t,r){if(!(t in JS)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";JS[t]=Function("F,a","return new F("+n.join(",")+")")}return JS[t](e,r)}(t,i.length,i):wl(t,i,e)};return Is(t.prototype)&&(n.prototype=t.prototype),n},KS=(zs.Reflect||{}).construct,XS=Ns(function(){function e(){}return!(KS(function(){},[],e)instanceof e)}),ZS=!Ns(function(){KS(function(){})});tc(tc.S+tc.F*(XS||ZS),"Reflect",{construct:function(e,t){Js(e),Ks(t);var r=arguments.length<3?e:Js(arguments[2]);if(ZS&&!XS)return KS(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(YS.apply(e,n))}var i=r.prototype,o=Fc(Is(i)?i:Object.prototype),a=Function.apply.call(e,o,t);return Is(a)?a:o}});var QS=$s.Reflect.construct,ek=r(function(e){e.exports={default:QS,__esModule:!0}});t(ek),rc("getPrototypeOf",function(){return function(e){return Hc(Wc(e))}});var tk=$s.Object.getPrototypeOf,rk=r(function(e){e.exports={default:tk,__esModule:!0}});t(rk);var nk=r(function(e,t){t.__esModule=!0;var r,n=(r=o_)&&r.__esModule?r:{default:r};t.default=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,n.default)(t))&&"function"!=typeof t?e:t}});t(nk);var ik=r(function(e,t){t.__esModule=!0;var r=o(WS),n=o(US),i=o(o_);function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,i.default)(t)));e.prototype=(0,n.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(r.default?(0,r.default)(e,t):e.__proto__=t)}});t(ik);var ok=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,n,i=p(US),o=p(WS),a=p(HS),u=p(ek),s=p(rk),c=p(Wm),l=p($m),f=p(nk),d=p(ik);function p(e){return e&&e.__esModule?e:{default:e}}var h=(n=r=function(e){function t(){var e;(0,c.default)(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];var o=(0,f.default)(this,(e=t.__proto__||(0,s.default)(t)).call.apply(e,[this].concat(n))),a=void 0;if(o.parse)a=o.parse.apply(o,n);else if(o.constructor.parse){var u;a=(u=o.constructor).parse.apply(u,n)}return a||(a=o.constructor.defaultMessage),o.name=o.constructor.name,o.message=a,o}return(0,d.default)(t,e),(0,l.default)(t,null,[{key:"parse",value:function(){return arguments.length<=0?void 0:arguments[0]}}]),t}(function(e){function t(){var t=(0,u.default)(e,(0,a.default)(arguments));return(0,o.default)(t,(0,s.default)(this)),t}return t.prototype=(0,i.default)(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),o.default?(0,o.default)(t,e):t.__proto__=e,t}(Error)),r.defaultMessage="An error occurred",n);t.default=h});t(ok);var ak=Object.defineProperty;function uk(e,t,r){var n=r.configurable,i=r.enumerable,o=r.initializer,a=r.value;return{configurable:n,enumerable:i,get:function(){if(this!==e){var r=o?o.call(this):a;return ak(this,t,{configurable:n,enumerable:i,writable:!0,value:r}),r}},set:Mk(t)}}function sk(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return kk(uk,t)}var ck,lk,fk,dk,pk,hk,vk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function gk(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function yk(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}function mk(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var bk=Object.defineProperty,_k=Object.getOwnPropertyDescriptor,wk=Object.getOwnPropertyNames,Sk=Object.getOwnPropertySymbols;function kk(e,t){return function(e){if(!e||!e.hasOwnProperty)return!1;for(var t=["value","initializer","get","set"],r=0,n=t.length;r<n;r++)if(e.hasOwnProperty(t[r]))return!0;return!1}(t[t.length-1])?e.apply(void 0,mk(t).concat([[]])):function(){return e.apply(void 0,mk(Array.prototype.slice.call(arguments)).concat([t]))}}var Ek=(lk=yk((ck=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),gk(this,"debounceTimeoutIds",lk,this),gk(this,"throttleTimeoutIds",fk,this),gk(this,"throttlePreviousTimestamps",dk,this),gk(this,"throttleTrailingArgs",pk,this),gk(this,"profileLastRan",hk,this)}).prototype,"debounceTimeoutIds",[sk],{enumerable:!0,initializer:function(){return{}}}),fk=yk(ck.prototype,"throttleTimeoutIds",[sk],{enumerable:!0,initializer:function(){return{}}}),dk=yk(ck.prototype,"throttlePreviousTimestamps",[sk],{enumerable:!0,initializer:function(){return{}}}),pk=yk(ck.prototype,"throttleTrailingArgs",[sk],{enumerable:!0,initializer:function(){return null}}),hk=yk(ck.prototype,"profileLastRan",[sk],{enumerable:!0,initializer:function(){return null}}),ck),Pk="function"==typeof Symbol?Symbol("__core_decorators__"):"__core_decorators__";function Tk(e){return!1===e.hasOwnProperty(Pk)&&bk(e,Pk,{value:new Ek}),e[Pk]}var Ok=Sk?function(e){return wk(e).concat(Sk(e))}:wk;function Ck(e){var t={};return Ok(e).forEach(function(r){return t[r]=_k(e,r)}),t}function Mk(e){return function(t){return Object.defineProperty(this,e,{configurable:!0,writable:!0,enumerable:!0,value:t}),t}}function xk(e,t){return e.bind?e.bind(t):function(){return e.apply(t,arguments)}}var jk="object"===("undefined"==typeof console?"undefined":vk(console))&&console&&"function"==typeof console.warn?xk(console.warn,console):function(){},Rk={};function Ak(e){!0!==Rk[e]&&(Rk[e]=!0,jk("DEPRECATION: "+e))}var Ik="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dk=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var Lk=/^function ([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?(\([^\)]*\))[\s\S]+$/,Fk=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parentKlass=t,this.childKlass=r,this.parentDescriptor=n,this.childDescriptor=i}return Dk(e,[{key:"_getTopic",value:function(e){return void 0===e?null:"value"in e?e.value:"get"in e?e.get:"set"in e?e.set:void 0}},{key:"_extractTopicSignature",value:function(e){switch(void 0===e?"undefined":Ik(e)){case"function":return this._extractFunctionSignature(e);default:return this.key}}},{key:"_extractFunctionSignature",value:function(e){var t=this;return e.toString().replace(Lk,function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.key)+arguments[2]})}},{key:"key",get:function(){return this.childDescriptor.key}},{key:"parentNotation",get:function(){return this.parentKlass.constructor.name+"#"+this.parentPropertySignature}},{key:"childNotation",get:function(){return this.childKlass.constructor.name+"#"+this.childPropertySignature}},{key:"parentTopic",get:function(){return this._getTopic(this.parentDescriptor)}},{key:"childTopic",get:function(){return this._getTopic(this.childDescriptor)}},{key:"parentPropertySignature",get:function(){return this._extractTopicSignature(this.parentTopic)}},{key:"childPropertySignature",get:function(){return this._extractTopicSignature(this.childTopic)}}]),Dk(e,[{key:"assert",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!0!==e&&this.error("{child} does not properly override {parent}"+t)}},{key:"error",value:function(e){var t=this;throw e=e.replace("{parent}",function(e){return t.parentNotation}).replace("{child}",function(e){return t.childNotation}),new SyntaxError(e)}}]),e}();function Nk(e){return e.hasOwnProperty("value")?"data":e.hasOwnProperty("get")||e.hasOwnProperty("set")?"accessor":"data"}function Uk(e,t,r){r.assert(e.length===t.length)}function zk(e,t,r){var n=Nk(e),i=Nk(t);switch(n!==i&&r.error('descriptor types do not match. {parent} is "'+n+'", {child} is "'+i+'"'),i){case"data":!function(e,t,r){var n=Ik(e.value),i=Ik(t.value);switch("undefined"===n&&"undefined"===i&&r.error("descriptor values are both undefined. (class properties are are not currently supported)'"),n!==i&&("function"===i&&void 0===n||void 0!==n)&&r.error('value types do not match. {parent} is "'+n+'", {child} is "'+i+'"'),i){case"function":Uk(e.value,t.value,r);break;default:r.error('Unexpected error. Please file a bug with: {parent} is "'+n+'", {child} is "'+i+'"')}}(e,t,r);break;case"accessor":!function(e,t,r){var n="function"==typeof e.get,i="function"==typeof t.get,o="function"==typeof e.set,a="function"==typeof t.set;(n||i)&&(!n&&o&&r.error("{parent} is setter but {child} is getter"),!i&&a&&r.error("{parent} is getter but {child} is setter"),Uk(e.get,t.get,r)),(o||a)&&(!o&&n&&r.error("{parent} is getter but {child} is setter"),!a&&i&&r.error("{parent} is setter but {child} is getter"),Uk(e.set,t.set,r))}(e,t,r)}}var qk=[function(e){return e.toLowerCase()},function(e){return e.toUpperCase()},function(e){return e+"s"},function(e){return e.slice(0,-1)},function(e){return e.slice(1,e.length)}];function Bk(e,t,r){r.key=t;var n=Object.getPrototypeOf(e),i=Object.getOwnPropertyDescriptor(n,t),o=new Fk(n,e,i,r);if(void 0===i){var a=function(e,t){for(var r=0,n=qk.length;r<n;r++){var i=(0,qk[r])(t);if(i in e)return i}return null}(n,t),u=a?'\n\n  Did you mean "'+a+'"?':"";o.error("No descriptor matching {child} was found on the prototype chain."+u)}return zk(i,r,o),r}var Wk=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vk=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&u.return&&u.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Gk="This function will be removed in future versions.";function Hk(e,t,r,n){var i=Vk(n,2),o=i[0],a=void 0===o?Gk:o,u=i[1],s=void 0===u?{}:u;if("function"!=typeof r.value)throw new SyntaxError("Only functions can be marked as deprecated");var c=e.constructor.name+"#"+t;return s.url&&(a+="\n\n    See "+s.url+" for more details.\n\n"),Wk({},r,{value:function(){return jk("DEPRECATION "+c+": "+a),r.value.apply(this,arguments)}})}function $k(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return kk(Hk,t)}var Jk=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function Kk(){}function Xk(e,t,r){return Jk({},r,{value:function(){return function(e,t,r){if("object"===("undefined"==typeof console?"undefined":Yk(console))){var n=console.warn;console.warn=Kk;var i=t.apply(e,r);return console.warn=n,i}return t.apply(e,r)}(this,r.value,arguments)}})}var Zk=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function Qk(e,t,r){var n=function(e){var t=void 0,r=void 0;return e.value?(t=e.value,r="value"):e.get?(t=e.get,r="get"):e.set&&(t=e.set,r="set"),{fn:t,wrapKey:r}}(r),i=n.fn,o=n.wrapKey,a=new WeakMap,u=Object.create(null),s=Object.create(null),c=0;return Zk({},r,function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},o,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n,o,l="0",f=0,d=t.length;f<d;f++){var p=t[f],h=(n=s,(o=p)===Object(o)?o:n[o]||(n[o]={})),v=a.get(h);void 0===v&&(v=++c,a.set(h,v)),l+=v}return u[l]||function(e,t,r,n,i){var o=t.apply(e,r);return n[i]=o,o}(this,i,arguments,u,l)}))}function eE(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var tE=Object.defineProperty,rE=Object.getPrototypeOf,nE=void 0;function iE(e,t,r){var n=r.value,i=r.configurable,o=r.enumerable;if("function"!=typeof n)throw new SyntaxError("@autobind can only be used on functions, not: "+n);var a=e.constructor;return{configurable:i,enumerable:o,get:function(){if(this===e)return n;if(this.constructor!==a&&rE(this).constructor===a)return n;if(this.constructor!==a&&t in this.constructor.prototype)return function(e,t){if("undefined"==typeof WeakMap)throw new Error("Using @autobind on "+t.name+"() requires WeakMap support due to its use of super."+t.name+"()\n      See https://github.com/jayphelps/core-decorators.js/issues/20");nE||(nE=new WeakMap),!1===nE.has(e)&&nE.set(e,new WeakMap);var r=nE.get(e);return!1===r.has(t)&&r.set(t,xk(t,e)),r.get(t)}(this,n);var r=xk(n,this);return tE(this,t,{configurable:!0,writable:!0,enumerable:!1,value:r}),r},set:Mk(t)}}function oE(e){return 1===e.length?function(e){for(var t=Ck(e.prototype),r=Ok(t),n=0,i=r.length;n<i;n++){var o=r[n],a=t[o];"function"==typeof a.value&&"constructor"!==o&&tE(e.prototype,o,iE(e.prototype,o,a))}}.apply(void 0,eE(e)):iE.apply(void 0,eE(e))}function aE(e,t,r){return r.writable=!1,r}function uE(e,t,r){return r.enumerable=!0,r}function sE(e,t,r){return r.enumerable=!1,r}function cE(e,t,r){return r.configurable=!1,r}var lE=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fE=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&u.return&&u.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),dE=300;function pE(e,t,r,n){var i=fE(n,2),o=i[0],a=void 0===o?dE:o,u=i[1],s=void 0!==u&&u,c=r.value;if("function"!=typeof c)throw new SyntaxError("Only functions can be debounced");return lE({},r,{value:function(){var e=this,r=Tk(this).debounceTimeoutIds,n=r[t],i=s&&!n,o=arguments;clearTimeout(n),r[t]=setTimeout(function(){delete r[t],s||c.apply(e,o)},a),i&&c.apply(this,o)}})}var hE=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vE=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&u.return&&u.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),gE=300;function yE(e,t,r,n){var i=vE(n,2),o=i[0],a=void 0===o?gE:o,u=i[1],s=void 0===u?{}:u,c=r.value;if("function"!=typeof c)throw new SyntaxError("Only functions can be throttled");return!1!==s.leading&&(s.leading=!0),!1!==s.trailing&&(s.trailing=!0),hE({},r,{value:function(){var e=this,r=Tk(this),n=r.throttleTimeoutIds,i=r.throttlePreviousTimestamps,o=n[t],u=i[t]||0,l=Date.now();s.trailing&&(r.throttleTrailingArgs=arguments),u||!1!==s.leading||(u=l);var f=a-(l-u);f<=0?(clearTimeout(o),delete n[t],i[t]=l,c.apply(this,arguments)):!o&&s.trailing&&(n[t]=setTimeout(function(){i[t]=!1===s.leading?0:Date.now(),delete n[t],c.apply(e,r.throttleTrailingArgs),r.throttleTrailingArgs=null},f))}})}var mE=Object.defineProperty;function bE(e,t,r,n){var i,o=(i=n,Array.isArray(i)?i:Array.from(i)),a=o[0],u=o.slice(1),s=r.configurable,c=r.enumerable,l=r.writable,f=r.get,d=r.set,p=r.value,h=!!f;return{configurable:s,enumerable:c,get:function(){var e=h?f.call(this):p,r=a.call.apply(a,[this,e].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(u)));if(h)return r;var n={configurable:s,enumerable:c};return n.value=r,n.writable=l,mE(this,t,n),r},set:h?d:Mk()}}var _E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wE=Object.defineProperty,SE=Object.getPrototypeOf;function kE(e,t){if(r=e,"[object Symbol]"===Object.prototype.toString.call(r)&&"object"===(void 0===r?"undefined":_E(r))){do{if(t===Object.prototype)return void 0!==t[e];if(t.hasOwnProperty(e))return!0}while(t=SE(t));return!1}return e in t;var r}function EE(e,t){if(!t.length)throw new SyntaxError("@mixin() class "+e.name+" requires at least one mixin as an argument");for(var r=0,n=t.length;r<n;r++)for(var i=Ck(t[r]),o=Ok(i),a=0,u=o.length;a<u;a++){var s=o[a];kE(s,e.prototype)||wE(e.prototype,s,i[s])}}function PE(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return Ak("@mixin is deprecated and will be removed shortly. Use @mixin from lodash-decorators.\n\n  https://www.npmjs.com/package/lodash-decorators"),"function"==typeof t[0]?EE(t[0],[]):function(e){return EE(e,t)}}var TE=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},OE=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&u.return&&u.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),CE={},ME={time:console.time?console.time.bind(console):function(e){CE[e]=new Date},timeEnd:console.timeEnd?console.timeEnd.bind(console):function(e){var t=new Date-CE[e];delete CE[e],console.log(e+": "+t+"ms")}},xE=0;function jE(e,t,r,n){var i=OE(n,2),o=i[0],a=void 0===o?null:o,u=i[1],s=void 0===u?ME:u,c=r.value;if(null===a&&(a=e.constructor.name+"."+t),"function"!=typeof c)throw new SyntaxError("@time can only be used on functions, not: "+c);return TE({},r,{value:function(){var e=a+"-"+xE;xE++,s.time(e);try{return c.apply(this,arguments)}finally{s.timeEnd(e)}}})}var RE=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},AE=Object.getPrototypeOf,IE=Object.getOwnPropertyDescriptor;function DE(e,t,r){var n=AE(e),i=IE(n,t);return RE({},i,{value:r.value,initializer:r.initializer,get:r.get||i.get,set:r.set||i.set})}var LE=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},FE=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&u.return&&u.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),NE={profile:console.profile?xk(console.profile,console):function(){},profileEnd:console.profileEnd?xk(console.profileEnd,console):function(){},warn:jk};function UE(e,t,r,n){var i=FE(n,3),o=i[0],a=void 0===o?null:o,u=i[1],s=void 0!==u&&u,c=i[2],l=void 0===c?NE:c;if(!zE.__enabled)return zE.__warned||(l.warn("console.profile is not supported. All @profile decorators are disabled."),zE.__warned=!0),r;var f=r.value;if(null===a&&(a=e.constructor.name+"."+t),"function"!=typeof f)throw new SyntaxError("@profile can only be used on functions, not: "+f);return LE({},r,{value:function(){var e=Date.now(),t=Tk(this);(!0===s&&!t.profileLastRan||!1===s||"number"==typeof s&&e-t.profileLastRan>s||"function"==typeof s&&s.apply(this,arguments))&&(l.profile(a),t.profileLastRan=e);try{return f.apply(this,arguments)}finally{l.profileEnd(a)}}})}function zE(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return kk(UE,t)}zE.__enabled=!!console.profile,zE.__warned=!1;var qE=Object.defineProperty,BE=Object.getOwnPropertyDescriptor;var WE=Object.freeze({override:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return kk(Bk,t)},deprecate:$k,deprecated:$k,suppressWarnings:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return kk(Xk,t)},memoize:function(){Ak("@memoize is deprecated and will be removed shortly. Use @memoize from lodash-decorators.\n\n  https://www.npmjs.com/package/lodash-decorators");for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return kk(Qk,t)},autobind:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(){return oE(arguments)}:oE(t)},readonly:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return kk(aE,t)},enumerable:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return kk(uE,t)},nonenumerable:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return kk(sE,t)},nonconfigurable:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return kk(cE,t)},debounce:function(){Ak("@debounce is deprecated and will be removed shortly. Use @debounce from lodash-decorators.\n\n  https://www.npmjs.com/package/lodash-decorators");for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return kk(pE,t)},throttle:function(){Ak("@throttle is deprecated and will be removed shortly. Use @throttle from lodash-decorators.\n\n  https://www.npmjs.com/package/lodash-decorators");for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return kk(yE,t)},decorate:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return kk(bE,t)},mixin:PE,mixins:PE,lazyInitialize:sk,time:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return kk(jE,t)},extendDescriptor:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return kk(DE,t)},profile:zE,applyDecorators:function(e,t){var r=e.prototype;for(var n in t)for(var i=t[n],o=0,a=i.length;o<a;o++){var u=i[o];qE(r,n,u(r,n,BE(r,n)))}return e}}),VE=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=WE.deprecated;t.default=r});t(VE);var GE=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=!0});t(GE);var HE=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return(e=GE,e&&e.__esModule?e:{default:e}).default;var e}})});t(HE);var $E=r(function(e,t){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"base64",{enumerable:!0,get:function(){return r(Nm).default}}),Object.defineProperty(t,"cappedDebounce",{enumerable:!0,get:function(){return r(Um).default}}),Object.defineProperty(t,"checkRequired",{enumerable:!0,get:function(){return r(zm).default}}),Object.defineProperty(t,"Defer",{enumerable:!0,get:function(){return r(qm).default}}),Object.defineProperty(t,"makeStateDataType",{enumerable:!0,get:function(){return r(Bm).default}}),Object.defineProperty(t,"make",{enumerable:!0,get:function(){return r(vb).default}}),Object.defineProperty(t,"oneFlight",{enumerable:!0,get:function(){return r(rS).default}}),Object.defineProperty(t,"patterns",{enumerable:!0,get:function(){return r(nS).default}}),Object.defineProperty(t,"proxyEvents",{enumerable:!0,get:function(){return iS.proxyEvents}}),Object.defineProperty(t,"transferEvents",{enumerable:!0,get:function(){return iS.transferEvents}}),Object.defineProperty(t,"resolveWith",{enumerable:!0,get:function(){return r(oS).default}}),Object.defineProperty(t,"retry",{enumerable:!0,get:function(){return r(IS).default}}),Object.defineProperty(t,"tap",{enumerable:!0,get:function(){return r(DS).default}}),Object.defineProperty(t,"whileInFlight",{enumerable:!0,get:function(){return r(LS).default}}),Object.defineProperty(t,"Exception",{enumerable:!0,get:function(){return r(ok).default}}),Object.defineProperty(t,"deprecated",{enumerable:!0,get:function(){return r(VE).default}}),Object.defineProperty(t,"inBrowser",{enumerable:!0,get:function(){return r(HE).default}})});t($E),rc("keys",function(){return function(e){return xc(Wc(e))}});var JE=$s.Object.keys,YE=r(function(e){e.exports={default:JE,__esModule:!0}});t(YE);var KE=4;var XE=function(e){return pv(e,KE)},ZE=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.safeSetTimeout=function(){var e=setTimeout.apply(void 0,arguments);e.unref&&e.unref();return e},t.safeSetInterval=function(){var e=setInterval.apply(void 0,arguments);e.unref&&e.unref();return e}});t(ZE);ZE.safeSetTimeout,ZE.safeSetInterval;var QE=0;var eP=function(e){var t=++QE;return xv(e)+t};var tP=function(e){return v_(function(t,r){var n=-1,i=r.length,o=i>1?r[i-1]:void 0,a=i>2?r[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,a&&aS(r[0],r[1],a)&&(o=i<3?void 0:o,i=1),t=Object(t);++n<i;){var u=r[n];u&&e(t,u,n,o)}return t})},rP=Object.prototype.hasOwnProperty,nP=tP(function(e,t){if(Rp(t)||Fp(t))ap(t,Np(t),e);else for(var r in t)rP.call(t,r)&&op(e,r,t[r])});var iP=function(e){return function(t){return null==e?void 0:e[t]}},oP=iP({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),aP=/[&<>"']/g,uP=RegExp(aP.source);var sP=function(e){return(e=xv(e))&&uP.test(e)?e.replace(aP,oP):e};var cP=function(e){return function(t,r,n){for(var i=-1,o=Object(t),a=n(t),u=a.length;u--;){var s=a[e?u:++i];if(!1===r(o[s],s,o))break}return t}},lP=cP();var fP=function(e,t){return e&&lP(e,t,Np)};var dP=function(e,t){return e&&fP(e,h_(t))},pP="[object String]";var hP=function(e){return"string"==typeof e||!vp(e)&&sp(e)&&ud(e)==pP};var vP=function(e,t){return Rf(t,function(t){return e[t]})};var gP=function(e){return null==e?[]:vP(e,Np(e))},yP=Math.max;var mP=function(e,t,r,n){e=Fp(e)?e:gP(e),r=r&&!n?Ww(r):0;var i=e.length;return r<0&&(r=yP(i+r,0)),hP(e)?r<=i&&e.indexOf(t,r)>-1:!!i&&X_(e,t,r)>-1},bP="[object Date]";var _P=function(e){return sp(e)&&ud(e)==bP},wP=Tp&&Tp.isDate,SP=wP?Pp(wP):_P,kP="__lodash_hash_undefined__";var EP=function(e){return this.__data__.set(e,kP),this};var PP=function(e){return this.__data__.has(e)};function TP(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Kd;++t<r;)this.add(e[t])}TP.prototype.add=TP.prototype.push=EP,TP.prototype.has=PP;var OP=TP;var CP=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1};var MP=function(e,t){return e.has(t)},xP=1,jP=2;var RP=function(e,t,r,n,i,o){var a=r&xP,u=e.length,s=t.length;if(u!=s&&!(a&&s>u))return!1;var c=o.get(e);if(c&&o.get(t))return c==t;var l=-1,f=!0,d=r&jP?new OP:void 0;for(o.set(e,t),o.set(t,e);++l<u;){var p=e[l],h=t[l];if(n)var v=a?n(h,p,l,t,e,o):n(p,h,l,e,t,o);if(void 0!==v){if(v)continue;f=!1;break}if(d){if(!CP(t,function(e,t){if(!MP(d,t)&&(p===e||i(p,e,r,n,o)))return d.push(t)})){f=!1;break}}else if(p!==h&&!i(p,h,r,n,o)){f=!1;break}}return o.delete(e),o.delete(t),f};var AP=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r};var IP=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r},DP=1,LP=2,FP="[object Boolean]",NP="[object Date]",UP="[object Error]",zP="[object Map]",qP="[object Number]",BP="[object RegExp]",WP="[object Set]",VP="[object String]",GP="[object Symbol]",HP="[object ArrayBuffer]",$P="[object DataView]",JP=Kf?Kf.prototype:void 0,YP=JP?JP.valueOf:void 0;var KP=function(e,t,r,n,i,o,a){switch(r){case $P:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case HP:return!(e.byteLength!=t.byteLength||!o(new bh(e),new bh(t)));case FP:case NP:case qP:return If(+e,+t);case UP:return e.name==t.name&&e.message==t.message;case BP:case VP:return e==t+"";case zP:var u=AP;case WP:var s=n&DP;if(u||(u=IP),e.size!=t.size&&!s)return!1;var c=a.get(e);if(c)return c==t;n|=LP,a.set(e,t);var l=RP(u(e),u(t),n,i,o,a);return a.delete(e),l;case GP:if(YP)return YP.call(e)==YP.call(t)}return!1},XP=1,ZP=Object.prototype.hasOwnProperty;var QP=function(e,t,r,n,i,o){var a=r&XP,u=ih(e),s=u.length;if(s!=ih(t).length&&!a)return!1;for(var c=s;c--;){var l=u[c];if(!(a?l in t:ZP.call(t,l)))return!1}var f=o.get(e);if(f&&o.get(t))return f==t;var d=!0;o.set(e,t),o.set(t,e);for(var p=a;++c<s;){var h=e[l=u[c]],v=t[l];if(n)var g=a?n(v,h,l,t,e,o):n(h,v,l,e,t,o);if(!(void 0===g?h===v||i(h,v,r,n,o):g)){d=!1;break}p||(p="constructor"==l)}if(d&&!p){var y=e.constructor,m=t.constructor;y!=m&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof m&&m instanceof m)&&(d=!1)}return o.delete(e),o.delete(t),d},eT=1,tT="[object Arguments]",rT="[object Array]",nT="[object Object]",iT=Object.prototype.hasOwnProperty;var oT=function(e,t,r,n,i,o){var a=vp(e),u=vp(t),s=a?rT:gh(e),c=u?rT:gh(t),l=(s=s==tT?nT:s)==nT,f=(c=c==tT?nT:c)==nT,d=s==c;if(d&&yp(e)){if(!yp(t))return!1;a=!0,l=!1}if(d&&!l)return o||(o=new ep),a||Cp(e)?RP(e,t,r,n,i,o):KP(e,t,s,r,n,i,o);if(!(r&eT)){var p=l&&iT.call(e,"__wrapped__"),h=f&&iT.call(t,"__wrapped__");if(p||h){var v=p?e.value():e,g=h?t.value():t;return o||(o=new ep),i(v,g,r,n,o)}}return!!d&&(o||(o=new ep),QP(e,t,r,n,i,o))};var aT=function e(t,r,n,i,o){return t===r||(null==t||null==r||!sp(t)&&!sp(r)?t!=t&&r!=r:oT(t,r,n,i,e,o))};var uT=function(e,t){return aT(e,t)},sT=Object.prototype.hasOwnProperty;var cT=function(e,t){return null!=e&&sT.call(e,t)};var lT=function(e,t,r){for(var n=-1,i=(t=jv(t,e)).length,o=!1;++n<i;){var a=Iv(t[n]);if(!(o=null!=e&&r(e,a)))break;e=e[a]}return o||++n!=i?o:!!(i=null==e?0:e.length)&&Sp(i)&&_p(a,i)&&(vp(e)||hp(e))};var fT=function(e,t){return null!=e&&lT(e,t,cT)};var dT=function(e,t,r){var n=-1,i=(t=jv(t,e)).length;for(i||(i=1,e=void 0);++n<i;){var o=null==e?void 0:e[Iv(t[n])];void 0===o&&(n=i,o=r),e=hd(o)?o.call(e):o}return e};var pT=function(e,t,r){for(var n=-1,i=null==e?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1},hT=sh&&1/IP(new sh([,-0]))[1]==1/0?function(e){return new sh(e)}:x_,vT=200;var gT=function(e,t,r){var n=-1,i=Z_,o=e.length,a=!0,u=[],s=u;if(r)a=!1,i=pT;else if(o>=vT){var c=t?null:hT(e);if(c)return IP(c);a=!1,i=MP,s=new OP}else s=t?[]:u;e:for(;++n<o;){var l=e[n],f=t?t(l):l;if(l=r||0!==l?l:0,a&&f==f){for(var d=s.length;d--;)if(s[d]===f)continue e;t&&s.push(f),u.push(l)}else i(s,f,r)||(s!==u&&s.push(f),u.push(l))}return u};var yT=function(e){return sp(e)&&Fp(e)},mT=v_(function(e){return gT(Yv(e,1,yT,!0))}),bT="Expected a function";var _T=function(e,t){var r;if("function"!=typeof t)throw new TypeError(bT);return e=Ww(e),function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=void 0),r}};var wT=function(e){return _T(2,e)};var ST=function(e,t){return function(r,n){if(null==r)return r;if(!Fp(r))return e(r,n);for(var i=r.length,o=t?i:-1,a=Object(r);(t?o--:++o<i)&&!1!==n(a[o],o,a););return r}},kT=ST(fP);var ET=function(e,t){return(vp(e)?tp:kT)(e,h_(t))},PT=/\s+/,TT=function(e,t){var r,n=-1,i=e.length,o=t[0],a=t[1],u=t[2];switch(t.length){case 0:for(;++n<i;)(r=e[n]).callback.call(r.ctx);return;case 1:for(;++n<i;)(r=e[n]).callback.call(r.ctx,o);return;case 2:for(;++n<i;)(r=e[n]).callback.call(r.ctx,o,a);return;case 3:for(;++n<i;)(r=e[n]).callback.call(r.ctx,o,a,u);return;default:for(;++n<i;)(r=e[n]).callback.apply(r.ctx,t);return}},OT=function(e,t,r,n){if(!r)return!0;if("object"==typeof r){for(var i in r)e[t].apply(e,[i,r[i]].concat(n));return!1}if(PT.test(r)){for(var o=r.split(PT),a=0,u=o.length;a<u;a++)e[t].apply(e,[o[a]].concat(n));return!1}return!0},CT=function(e){return function(t,r,n){if(!t)throw new Error("Trying to listenTo event: '"+r+"' but the target object is undefined");if((this._listeningTo||(this._listeningTo={}))[t._listenId||(t._listenId=eP("l"))]=t,n||"object"!=typeof r||(n=this),"function"!=typeof t[e])throw new Error("Trying to listenTo event: '"+r+"' on object: "+t.toString()+" but it does not have an 'on' method so is unbindable");return t[e](r,n,this),this}},MT=Array.prototype.slice,xT={on:function(e,t,r){return OT(this,"on",e,[t,r])&&t?(this._events||(this._events={}),(this._events[e]||(this._events[e]=[])).push({callback:t,context:r,ctx:r||this}),this):this},once:function(e,t,r){if(!OT(this,"once",e,[t,r])||!t)return this;var n=this,i=wT(function(){n.off(e,i),t.apply(this,arguments)});return i._callback=t,this.on(e,i,r)},off:function(e,t,r){var n,i,o,a,u,s,c,l;if(!this._events||!OT(this,"off",e,[t,r]))return this;if(!e&&!t&&!r)return this._events=void 0,this;for(u=0,s=(a=e?[e]:Np(this._events)).length;u<s;u++)if(e=a[u],o=this._events[e]){if(this._events[e]=n=[],t||r)for(c=0,l=o.length;c<l;c++)i=o[c],(t&&t!==i.callback&&t!==i.callback._callback||r&&r!==i.context)&&n.push(i);n.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=MT.call(arguments,1);if(!OT(this,"trigger",e,t))return this;var r=this._events[e],n=this._events.all;return r&&TT(r,t),n&&TT(n,arguments),this},stopListening:function(e,t,r){var n=this._listeningTo;if(!n)return this;var i=!t&&!r;r||"object"!=typeof t||(r=this),e&&((n={})[e._listenId]=e);var o=this;return ET(n,function(e,n){e.off(t,r,o),(i||pg(e._events))&&delete o._listeningTo[n]}),this},createEmitter:function(e){return nP(e||{},xT)},listenTo:CT("on"),listenToOnce:CT("once"),listenToAndRun:function(e,t,r){return this.listenTo.apply(this,arguments),r||"object"!=typeof t||(r=this),r.apply(this),this}};xT.bind=xT.on,xT.unbind=xT.off,xT.removeListener=xT.off,xT.removeAllListeners=xT.off,xT.emit=xT.trigger;var jT=xT,RT=Array.prototype.slice;function AT(e){if("object"!=typeof(e=e||{}))throw new TypeError("Options must be an object");this.storage={},this.separator=e.separator||"."}AT.prototype.add=function(e,t){(this.storage[e]||(this.storage[e]=[])).push(t)},AT.prototype.remove=function(e){var t,r;for(t in this.storage)(r=this.storage[t]).some(function(t,n){if(t===e)return r.splice(n,1),!0})},AT.prototype.get=function(e){var t,r=[];for(t in this.storage)e&&e!==t&&0!==t.indexOf(e+this.separator)||(r=r.concat(this.storage[t]));return r},AT.prototype.getGrouped=function(e){var t,r={};for(t in this.storage)e&&e!==t&&0!==t.indexOf(e+this.separator)||(r[t]=RT.call(this.storage[t]));return r},AT.prototype.getAll=function(e){var t,r={};for(t in this.storage)e!==t&&0!==t.indexOf(e+this.separator)||(r[t]=RT.call(this.storage[t]));return r},AT.prototype.run=function(e,t){var r=RT.call(arguments,2);this.get(e).forEach(function(e){e.apply(t||this,r)})};var IT=AT,DT=function(e){return nP({},e)},LT=/^change:/,FT=function(){};function NT(e,t){t||(t={}),this.cid||(this.cid=eP("state")),this._events={},this._values={},this._eventBubblingHandlerCache={},this._definition=Object.create(this._definition),t.parse&&(e=this.parse(e,t)),this.parent=t.parent,this.collection=t.collection,this._keyTree=new IT,this._initCollections(),this._initChildren(),this._cache={},this._previousAttributes={},e&&this.set(e,nP({silent:!0,initial:!0},t)),this._changed={},this._derived&&this._initDerived(),!1!==t.init&&this.initialize.apply(this,arguments)}function UT(e,t,r,n){var i,o,a=e._definition[t]={};if(hP(r))(i=e._ensureValidType(r))&&(a.type=i);else{if(Array.isArray(r)&&(r={type:(o=r)[0],required:o[1],default:o[2]}),(i=e._ensureValidType(r.type))&&(a.type=i),r.required&&(a.required=!0),r.default&&"object"==typeof r.default)throw new TypeError("The default value for "+t+" cannot be an object/array, must be a value or a function which returns a value/object/array");a.default=r.default,a.allowNull=!!r.allowNull&&r.allowNull,r.setOnce&&(a.setOnce=!0),a.required&&void 0===a.default&&!a.setOnce&&(a.default=e._getDefaultForType(i)),a.test=r.test,a.values=r.values}return n&&(a.session=!0),i||(i=hP(r)?r:r.type,console.warn("Invalid data type of `"+i+"` for `"+t+"` property. Use one of the default types or define your own")),Object.defineProperty(e,t,{set:function(e){this.set(t,e)},get:function(){if(!this._values)throw Error('You may be trying to `extend` a state object with "'+t+'" which has been defined in `props` on the object being extended');var e=this._values[t],r=this._dataTypes[a.type];if(void 0!==e)return r&&r.get&&(e=r.get(e)),e;var n=dT(a,"default");(this._values[t]=n,void 0!==n)&&this._getOnChangeForType(a.type)(n,e,t);return n}}),a}function zT(e,t,r){(e._derived[t]={fn:hd(r)?r:r.fn,cache:!1!==r.cache,depList:r.deps||[]}).depList.forEach(function(r){e._deps[r]=mT(e._deps[r]||[],[t])}),Object.defineProperty(e,t,{get:function(){return this._getDerivedProperty(t)},set:function(){throw new TypeError("`"+t+"` is a derived property, it can't be set directly.")}})}nP(NT.prototype,jT,{extraProperties:"ignore",idAttribute:"id",namespaceAttribute:"namespace",typeAttribute:"modelType",initialize:function(){return this},getId:function(){return this[this.idAttribute]},getNamespace:function(){return this[this.namespaceAttribute]},getType:function(){return this[this.typeAttribute]},isNew:function(){return null==this.getId()},escape:function(e){return sP(this.get(e))},isValid:function(e){return this._validate({},nP(e||{},{validate:!0}))},parse:function(e,t){return e},serialize:function(e){var t=nP({props:!0},e),r=this.getAttributes(t,!0),n=function(e,t){r[t]=this[t].serialize()}.bind(this);return dP(this._children,n),dP(this._collections,n),r},set:function(e,t,r){var n,i,o,a,u,s,c,l,f,d,p,h,v,g,y,m,b,_=this,w=this.extraProperties;if(sd(e)||null===e?(f=e,r=t):(f={})[e]=t,r=r||{},!this._validate(f,r))return!1;h=r.unset,p=r.silent,g=r.initial,n=this._changing,this._changing=!0,i=[],g?this._previousAttributes={}:n||(this._previousAttributes=this.attributes,this._changed={});for(var S=0,k=Object.keys(f),E=k.length;S<E;S++){if(o=typeof(a=f[l=k[S]]),v=this._values[l],!(u=this._definition[l])){if(this._children[l]||this._collections[l]){sd(a)||(a={}),this[l].set(a,r);continue}if("ignore"===w)continue;if("reject"===w)throw new TypeError('No "'+l+'" property defined on '+(this.type||"this")+' model and extraProperties not set to "ignore" or "allow"');if("allow"===w)u=this._createPropertyDefinition(l,"any");else if(w)throw new TypeError('Invalid value for extraProperties: "'+w+'"')}if(m=this._getCompareForType(u.type),b=this._getOnChangeForType(u.type),(d=this._dataTypes[u.type])&&d.set&&(a=(s=d.set(a)).val,o=s.type),u.test&&(c=u.test.call(this,a,o)))throw new TypeError("Property '"+l+"' failed validation with error: "+c);if(void 0===a&&u.required)throw new TypeError("Required property '"+l+"' must be of type "+u.type+". Tried to set "+a);if(null===a&&u.required&&!u.allowNull)throw new TypeError("Property '"+l+"' must be of type "+u.type+" (cannot be null). Tried to set "+a);if(u.type&&"any"!==u.type&&u.type!==o&&null!=a)throw new TypeError("Property '"+l+"' must be of type "+u.type+". Tried to set "+a);if(u.values&&!mP(u.values,a)){var P=dT(u,"default");if(h&&void 0!==P)a=P;else if(!h||h&&void 0!==a)throw new TypeError("Property '"+l+"' must be one of values: "+u.values.join(", ")+". Tried to set "+a)}if(y=g||!m(v,a,l),u.setOnce&&void 0!==v&&y)throw new TypeError("Property '"+l+"' can only be set once.");y?(b(a,v,l),g||(this._changed[l]=a,this._previousAttributes[l]=v,h&&delete this._values[l],p||i.push({prev:v,val:a,key:l})),h||(this._values[l]=a)):delete this._changed[l]}if(i.length&&(this._pending=!0),i.forEach(function(e){_.trigger("change:"+e.key,_,e.val,r)}),n)return this;for(;this._pending;)this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},get:function(e){return this[e]},toggle:function(e){var t,r,n,i,o=this._definition[e];if("boolean"===o.type)this[e]=!this[e];else{if(!o||!o.values)throw new TypeError("Can only toggle properties that are type `boolean` or have `values` array.");this[e]=(t=o.values,r=this[e],n=t.length,(i=t.indexOf(r)+1)>n-1&&(i=0),t[i])}return this},previousAttributes:function(){return DT(this._previousAttributes)},hasChanged:function(e){return null==e?!!Object.keys(this._changed).length:fT(this._derived,e)?this._derived[e].depList.some(function(e){return this.hasChanged(e)},this):fT(this._changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&DT(this._changed);var t,r,n=!1,i=this._changing?this._previousAttributes:this.attributes;for(var o in e)(r=this._definition[o])&&(this._getCompareForType(r.type)(i[o],t=e[o])||((n||(n={}))[o]=t));return n},toJSON:function(){return this.serialize()},unset:function(e,t){var r=this;(e=Array.isArray(e)?e:[e]).forEach(function(e){var n,i=r._definition[e];if(i)return i.required?(n=dT(i,"default"),r.set(e,n,t)):r.set(e,n,nP({},t,{unset:!0}))})},clear:function(e){var t=this;return Object.keys(this.attributes).forEach(function(r){t.unset(r,e)}),this},previous:function(e){return null!=e&&Object.keys(this._previousAttributes).length?this._previousAttributes[e]:null},_getDefaultForType:function(e){var t=this._dataTypes[e];return t&&t.default},_getCompareForType:function(e){var t=this._dataTypes[e];return t&&t.compare?t.compare.bind(this):uT},_getOnChangeForType:function(e){var t=this._dataTypes[e];return t&&t.onChange?t.onChange.bind(this):FT},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=nP({},this.attributes,e);var r=this.validationError=this.validate(e,t)||null;return!r||(this.trigger("invalid",this,r,nP(t||{},{validationError:r})),!1)},_createPropertyDefinition:function(e,t,r){return UT(this,e,t,r)},_ensureValidType:function(e){return mP(["string","number","boolean","array","object","date","state","any"].concat(Object.keys(this._dataTypes)),e)?e:void 0},getAttributes:function(e,t){e=nP({session:!1,props:!1,derived:!1},e||{});var r,n,i={};for(var o in this._definition)n=this._definition[o],(e.session&&n.session||e.props&&!n.session)&&(r=t?this._values[o]:this[o],t&&r&&hd(r.serialize)&&(r=r.serialize()),void 0===r&&(r=dT(n,"default")),void 0!==r&&(i[o]=r));if(e.derived)for(var a in this._derived)i[a]=this[a];return i},_initDerived:function(){var e=this;dP(this._derived,function(t,r){var n=e._derived[r];n.deps=n.depList;var i=function(){var t=n.fn.call(e);e._cache[r]===t&&n.cache||(n.cache&&(e._previousAttributes[r]=e._cache[r]),e._cache[r]=t,e.trigger("change:"+r,e,e._cache[r]))};n.deps.forEach(function(t){e._keyTree.add(t,i)})}),this.on("all",function(t){LT.test(t)&&e._keyTree.get(t.split(":")[1]).forEach(function(e){e()})},this)},_getDerivedProperty:function(e,t){return this._derived[e].cache?(!t&&this._cache.hasOwnProperty(e)||(this._cache[e]=this._derived[e].fn.apply(this)),this._cache[e]):this._derived[e].fn.apply(this)},_initCollections:function(){var e;if(this._collections)for(e in this._collections)this._safeSet(e,new this._collections[e](null,{parent:this}))},_initChildren:function(){var e;if(this._children)for(e in this._children)this._safeSet(e,new this._children[e]({},{parent:this})),this.listenTo(this[e],"all",this._getCachedEventBubblingHandler(e))},_getCachedEventBubblingHandler:function(e){return this._eventBubblingHandlerCache[e]||(this._eventBubblingHandlerCache[e]=function(t,r,n){LT.test(t)?this.trigger("change:"+e+"."+t.split(":")[1],r,n):"change"===t&&this.trigger("change",this)}.bind(this)),this._eventBubblingHandlerCache[e]},_verifyRequired:function(){var e=this.attributes;for(var t in this._definition)if(this._definition[t].required&&void 0===e[t])return!1;return!0},_safeSet:function(e,t){if(e in this)throw new Error("Encountered namespace collision while setting instance property `"+e+"`");return this[e]=t,this}}),Object.defineProperties(NT.prototype,{attributes:{get:function(){return this.getAttributes({props:!0,session:!0})}},all:{get:function(){return this.getAttributes({session:!0,props:!0,derived:!0})}},isState:{get:function(){return!0},set:function(){}}});var qT={string:{default:function(){return""}},date:{set:function(e){var t;if(null==e)t="object";else if(SP(e))t="date",e=e.valueOf();else{var r=null,n=new Date(e).valueOf();isNaN(n)&&(n=new Date(parseInt(e,10)).valueOf(),isNaN(n)&&(r=!0)),e=n,t="date",r&&(t=typeof e)}return{val:e,type:t}},get:function(e){return null==e?e:new Date(e)},default:function(){return new Date}},array:{set:function(e){return{val:e,type:Array.isArray(e)?"array":typeof e}},default:function(){return[]}},object:{set:function(e){var t=typeof e;return"object"!==t&&void 0===e&&(e=null,t="object"),{val:e,type:t}},default:function(){return{}}},state:{set:function(e){return e instanceof NT||e&&e.isState?{val:e,type:"state"}:{val:e,type:typeof e}},compare:function(e,t){return e===t},onChange:function(e,t,r){t&&this.stopListening(t,"all",this._getCachedEventBubblingHandler(r)),null!=e&&this.listenTo(e,"all",this._getCachedEventBubblingHandler(r))}}};NT.extend=function(e){var t,r=this;t=e&&e.hasOwnProperty("constructor")?e.constructor:function(){return r.apply(this,arguments)},nP(t,r);var n=function(){this.constructor=t};if(n.prototype=r.prototype,t.prototype=new n,t.prototype._derived=nP({},r.prototype._derived),t.prototype._deps=nP({},r.prototype._deps),t.prototype._definition=nP({},r.prototype._definition),t.prototype._collections=nP({},r.prototype._collections),t.prototype._children=nP({},r.prototype._children),t.prototype._dataTypes=nP({},r.prototype._dataTypes||qT),e)for(var i=["dataTypes","props","session","derived","collections","children"],o=0;o<arguments.length;o++){var a=arguments[o];a.dataTypes&&dP(a.dataTypes,function(e,r){t.prototype._dataTypes[r]=e}),a.props&&dP(a.props,function(e,r){UT(t.prototype,r,e)}),a.session&&dP(a.session,function(e,r){UT(t.prototype,r,e,!0)}),a.derived&&dP(a.derived,function(e,r){zT(t.prototype,r,e)}),a.collections&&dP(a.collections,function(e,r){t.prototype._collections[r]=e}),a.children&&dP(a.children,function(e,r){t.prototype._children[r]=e}),nP(t.prototype,cg(a,i))}return t.__super__=r.prototype,t};var BT=NT,WT=r(function(e,t){t.__esModule=!0;var r,n=(r=Hm)&&r.__esModule?r:{default:r};t.default=function(e,t,r){return t in e?(0,n.default)(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}});t(WT);var VT=r(function(e,t){t.__esModule=!0;var r,n=(r=HS)&&r.__esModule?r:{default:r};t.default=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return(0,n.default)(e)}});t(VT);lb("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return l_.def(Qm(this,"Set"),e=0===e?0:e,e)}},l_);tc(tc.P+tc.R,"Set",{toJSON:f_("Set")}),fb("Set"),db("Set");var GT=$s.Set,HT=r(function(e){e.exports={default:GT,__esModule:!0}});t(HT);var $T=function(){return Yf.Date.now()},JT="Expected a function",YT=Math.max,KT=Math.min;var XT=function(e,t,r){var n,i,o,a,u,s,c=0,l=!1,f=!1,d=!0;if("function"!=typeof e)throw new TypeError(JT);function p(t){var r=n,o=i;return n=i=void 0,c=t,a=e.apply(o,r)}function h(e){var r=e-s;return void 0===s||r>=t||r<0||f&&e-c>=o}function v(){var e=$T();if(h(e))return g(e);u=setTimeout(v,function(e){var r=t-(e-s);return f?KT(r,o-(e-c)):r}(e))}function g(e){return u=void 0,d&&n?p(e):(n=i=void 0,a)}function y(){var e=$T(),r=h(e);if(n=arguments,i=this,s=e,r){if(void 0===u)return function(e){return c=e,u=setTimeout(v,t),l?p(e):a}(s);if(f)return u=setTimeout(v,t),p(s)}return void 0===u&&(u=setTimeout(v,t)),a}return t=Uw(t)||0,sd(r)&&(l=!!r.leading,o=(f="maxWait"in r)?YT(Uw(r.maxWait)||0,t):o,d="trailing"in r?!!r.trailing:d),y.cancel=function(){void 0!==u&&clearTimeout(u),c=0,n=s=i=u=void 0},y.flush=function(){return void 0===u?a:g($T())},y},ZT=8;function QT(e,t,r){var n=Zw(e,ZT,void 0,void 0,void 0,void 0,void 0,t=r?void 0:t);return n.placeholder=QT.placeholder,n}QT.placeholder={};var eO=QT,tO=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.NotFoundError=t.StorageError=void 0;var r=a(rk),n=a(Wm),i=a(nk),o=a(ik);function a(e){return e&&e.__esModule?e:{default:e}}var u=t.StorageError=function(e){function t(){return(0,n.default)(this,t),(0,i.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,o.default)(t,e),t}($E.Exception);t.NotFoundError=function(e){function t(){return(0,n.default)(this,t),(0,i.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,o.default)(t,e),t}(u)});t(tO);tO.NotFoundError,tO.StorageError;var rO=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=h(WT),n=h(o_),i=h(VT),o=h(HT),a=h(p_),u=h(bf),s=h(Cf),c=h(tS),l=h(dT),f=h(tg),d=h(XT),p=h(eO);function h(e){return e&&e.__esModule?e:{default:e}}t.persist=function e(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];if(3===r.length)return e("@").apply(void 0,r);var i=r[0],o=r[1];return function(e,t,r){if("initialize"!==t)throw new TypeError("@persist can only currently be applied to AmpersandState objects or their derivatives and must be applied to the initialize method");r.value=(0,c.default)(r.value,function(e){for(var t=this,r=arguments.length,n=Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];var c=(0,s.default)(e,this,n),l="@"===i?"change":"change:"+i;return this.on(l,(0,d.default)(function(){var e=!o||s.default.apply(Reflect,[o,t].concat(n));return e?"@"===i?t.boundedStorage.put(i,t):t.boundedStorage.put(i,t[i]):u.default.resolve()},0)),c}),_(e,t)}},t.waitForValue=function(e){if(!e)throw new Error("`key` is required");return function(t,r,o){return y.add(t,r,e),o.value=(0,c.default)(o.value,function(e){for(var n=this,o=arguments.length,a=Array(o>1?o-1:0),c=1;c<o;c++)a[c-1]=arguments[c];var l=y.get(t,r);return u.default.all([].concat((0,i.default)(l)).map(function(e){return n.boundedStorage.waitFor(e)})).then(function(){return(0,s.default)(e,n,a)})}),"object"!==(void 0===t?"undefined":(0,n.default)(t))||t.prototype||(t[r]=o.value),_(t,r),o}};var v=a.default,g=o.default,y=new((0,$E.make)(v,v,g));var m=new o.default;var b=new o.default;function _(e,t){var n=function(e){return e.namespace?e.namespace:e}(e);if(!m.has(n)){if(m.add(n),e.initialize)return void(e.initialize=(0,c.default)(e.initialize,function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=(0,s.default)(e,this,r);return(0,s.default)(i,this,r),o}));e.initialize=i}function i(){var n=this,i=this.getNamespace();this.spark.initialize=(0,c.default)(this.spark.initialize||f.default,function(o){var a=this;b.add(i);for(var c=arguments.length,f=Array(c>1?c-1:0),d=1;d<c;d++)f[d-1]=arguments[d];(0,s.default)(o,this,f);var h=(0,p.default)(function(e,t){a.logger.debug("storage:("+i+"): got `"+e+"` for first time"),"@"===e?n.parent.set((0,r.default)({},i.toLowerCase(),t)):(0,l.default)(n[e],"isState")?n[e].set(t):n.set(e,t),a.logger.debug("storage:("+i+"): set `"+e+"` for first time")}),v=(0,p.default)(function(e,t){return t instanceof tO.NotFoundError||t.toString().includes("MockNotFoundError")?(a.logger.debug("storage("+i+"): no data for `"+e+"`, continuing"),u.default.resolve()):(a.logger.error("storage("+i+"): failed to init `"+e+"`",t),u.default.reject(t))}),g=y.get(e,t),m=[];g.forEach(function(e){m.push(a.boundedStorage.get(i,e).then(h(e)).catch(v(e)))}),u.default.all(m).then(function(){b.delete(i),0===b.size&&(a.loaded=!0)})})}}});t(rO);rO.persist,rO.waitForValue;var nO=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=l(Ef),n=l(ac),i=l(bf),o=l(p_),a=l(Wm),u=l($m),s=l(hb);t.default=function(e,t){var s,l,d=(s=(0,$E.oneFlight)({keyFactory:function(e){return e}}),function(e,t,r,n,i){var o={};Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0);o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0);void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null)}((l=function(){function r(){(0,a.default)(this,r),t.logger.debug("spark-store: constructing "+e+"Storage"),f.set(this,new o.default)}return(0,u.default)(r,[{key:"clear",value:function(){var e=[];return this.bindings.forEach(function(t){e.push(t.clear())}),i.default.all(e)}},{key:"del",value:function(e,r){return t.logger.debug("spark-store: removing "+e+":"+r),this._getBinding(e).then(function(e){return e.del(r)})}},{key:"get",value:function(e,r){return t.logger.debug("spark-store: retrieving "+e+":"+r),this._getBinding(e).then(function(e){return e.get(r)})}},{key:"put",value:function(e,r,n){return void 0===n?this.del(e,r):(t.logger.debug("spark-store: setting "+e+":"+r),this._getBinding(e).then(function(e){return e.put(r,n.serialize?n.serialize():n)}).then(function(){return n}))}},{key:"_getBinding",value:function(e){var r=this;return new i.default(function(n){t.logger.debug("storage: getting binding for `"+e+"`");var i=r.bindings.get(e);return i?(t.logger.debug("storage: found binding for `"+e+"`"),n(i)):n(r.adapter.bind(e,{logger:t.logger}).then(function(n){return t.logger.debug("storage: made binding for `"+e+"`"),r.bindings.set(e,n),n}))})}},{key:"adapter",get:function(){return t.config.storage[e+"Adapter"]}},{key:"bindings",get:function(){return f.get(this)}}]),r}()).prototype,"_getBinding",[s],(0,n.default)(l.prototype,"_getBinding"),l.prototype),l);return(0,r.default)(d.prototype,c.default),new d};var c=l(jT);function l(e){return e&&e.__esModule?e:{default:e}}var f=new s.default});t(nO);var iO=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=f(ac),n=f(p_),i=f(Wm),o=f($m),a=f(YE),u=f(hb),s=f(dT),c=f(sd),l=f(vp);function f(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){var a,u;return new(a=(0,$E.oneFlight)({keyFactory:function(e){return"initValue-"+e}}),function(e,t,r,n,i){var o={};Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0);o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0);void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null)}((u=function(){function r(){(0,i.default)(this,r),d.set(this,new n.default)}return(0,o.default)(r,[{key:"clear",value:function(){return t.spark[e+"Storage"].del(t.getNamespace())}},{key:"del",value:function(){for(var r,n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];return(r=t.spark[e+"Storage"]).del.apply(r,[t.getNamespace()].concat(i))}},{key:"get",value:function(r){var n=d.get(this).get(r);return n||(n=new $E.Defer,d.get(this).set(r,n)),t.spark[e+"Storage"].get(t.getNamespace(),r).then(function(e){return n.resolve(),e})}},{key:"put",value:function(r,n){return t.spark[e+"Storage"].put(t.getNamespace(),r,p(n))}},{key:"waitFor",value:function(e){t.logger.debug("plugin-storage("+t.getNamespace()+"): waiting to init key `"+e+"`");var r=d.get(this).get(e);return r?(t.logger.debug("plugin-storage("+t.getNamespace()+"): already inited `"+e+"`"),r.promise):(t.logger.debug("plugin-storage("+t.getNamespace()+"): initing `"+e+"`"),this.initValue(e))}},{key:"initValue",value:function(r){var n=new $E.Defer;return d.get(this).set(r,n),t.spark[e+"Storage"].get(t.getNamespace(),r).then(function(e){t.logger.debug("plugin-storage("+t.getNamespace()+"): got `"+r+"` for first time"),"@"===r?t.parent.set(e):(0,s.default)(t[r],"isState")?t[r].set(e):t.set(r,e),t.logger.debug("plugin-storage("+t.getNamespace()+"): set `"+r+"` for first time"),n.resolve(),t.logger.debug("plugin-storage("+t.getNamespace()+"): inited `"+r+"`")}).catch(function(e){return e instanceof tO.NotFoundError||e.toString().includes("MockNotFoundError")?(t.logger.debug("plugin-storage("+t.getNamespace()+"): no data for `"+r+"`, continuing"),n.resolve()):(t.logger.warn("plugin-storage("+t.getNamespace()+"): failed to init `"+r+"`",e),n.reject(e))}),n.promise}}]),r}()).prototype,"initValue",[a],(0,r.default)(u.prototype,"initValue"),u.prototype),u)};var d=new u.default;function p(e){if(!(0,c.default)(e))return e;var t=e.serialize?e.serialize():e;return(0,a.default)(t).forEach(function(e){var r=t[e];(0,l.default)(r)?0===r.length?t[e]=void 0:t[e]=r.map(p):(0,c.default)(r)&&(0,a.default)(r).forEach(function(e){r[e]=p(r[e])})}),(0,a.default)(t).reduce(function(e,r){return e&&!t[r]},!0)?void 0:t}});t(iO);var oO=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(YE),n=o(p_),i=o(bf);function o(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t=t||{},!e)return i.default.reject(new Error("`namespace` is required"));if(!t.logger)return i.default.reject(new Error("`options.logger` is required"));var o=t.logger,a=new n.default;return t.data&&(0,r.default)(t.data).forEach(function(e){a.set(e,t.data[e])}),o.debug("memory-store-adapter: returning binding"),i.default.resolve({clear:function(){return o.debug("memory-store-adapter: clearing the binding"),i.default.resolve(a.clear())},del:function(e){return o.debug("memory-store-adapter: deleting `"+e+"`"),i.default.resolve(a.delete(e))},get:function(e){o.debug("memory-store-adapter: reading `"+e+"`");var t=a.get(e);return void 0===t?i.default.reject(new tO.NotFoundError):i.default.resolve(t)},put:function(e,t){return o.debug("memory-store-adapter: writing `"+e+"`"),i.default.resolve(a.set(e,t))}})}t.default={bind:a,preload:function(e){return{bind:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e[t]&&(r.data=e[t]),a(t,r)}}}}});t(oO);var aO=r(function(e,t){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"persist",{enumerable:!0,get:function(){return rO.persist}}),Object.defineProperty(t,"waitForValue",{enumerable:!0,get:function(){return rO.waitForValue}}),Object.defineProperty(t,"makeSparkStore",{enumerable:!0,get:function(){return r(nO).default}}),Object.defineProperty(t,"makeSparkPluginStore",{enumerable:!0,get:function(){return r(iO).default}}),Object.defineProperty(t,"MemoryStoreAdapter",{enumerable:!0,get:function(){return r(oO).default}}),Object.defineProperty(t,"StorageError",{enumerable:!0,get:function(){return tO.StorageError}}),Object.defineProperty(t,"NotFoundError",{enumerable:!0,get:function(){return tO.NotFoundError}})});t(aO);var uO=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=l(bf),n=l(Cf),i=l(YE),o=l(cg),a=l(sd),u=l(gg),s=l(ym),c=l(BT);function l(e){return e&&e.__esModule?e:{default:e}}var f=c.default.extend({derived:{boundedStorage:{deps:[],fn:function(){return(0,aO.makeSparkPluginStore)("bounded",this)}},unboundedStorage:{deps:[],fn:function(){return(0,aO.makeSparkPluginStore)("unbounded",this)}},config:{cache:!1,deps:["spark","spark.config"],fn:function(){if(this.spark&&this.spark.config){var e=this.getNamespace();return e?this.spark.config[e.toLowerCase()]:this.spark.config}return{}}},logger:{deps:["spark","spark.logger"],fn:function(){return this.spark.logger||console}},spark:{deps:["parent"],fn:function(){if(!this.parent&&!this.collection)throw new Error("Cannot determine `this.spark` without `this.parent` or `this.collection`. Please initialize `this` via `children` or `collection` or set `this.parent` manually");for(var e=this;e.parent||e.collection;)e=e.parent||e.collection;return e}}},session:{parent:{type:"any"},ready:{default:!0,type:"boolean"}},clear:function(e){var t=this;return(0,i.default)(this.attributes).forEach(function(r){"parent"!==r&&t.unset(r,e)}),(0,i.default)(this._children).forEach(function(e){t[e].clear()}),(0,i.default)(this._collections).forEach(function(e){t[e].reset()}),this},initialize:function(){for(var e=this,t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];(0,n.default)(c.default.prototype.initialize,this,r),this._dataTypes=(0,u.default)(this._dataTypes),(0,i.default)(this._dataTypes).forEach(function(t){e._dataTypes[t].set&&(e._dataTypes[t].set=e._dataTypes[t].set.bind(e))}),this.on("change",function(t,r){e.parent&&e.parent.trigger("change:"+e.getNamespace().toLowerCase(),e.parent,e,r)})},inspect:function(e){return s.default.inspect((0,o.default)(this.serialize({props:!0,session:!0,derived:!0}),"boundedStorage","unboundedStorage","config","logger","spark","parent"),{depth:e})},request:function(){var e;return(e=this.spark).request.apply(e,arguments)},upload:function(){var e;return(e=this.spark).upload.apply(e,arguments)},when:function(e){for(var t=this,n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];if(i&&i.length>0)throw new Error("#when() does not accept a callback, you must attach to its promise");return new r.default(function(r){t.once(e,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r(t)})})},_filterSetParameters:function(e,t,r){var n=void 0;return(0,a.default)(e)||null===e?(n=e,r=t):(n={})[e]=t,[n,r=r||{}]}});t.default=f});t(uO),tc(tc.S+tc.F*!Us,"Object",{defineProperties:jc});var sO=$s.Object,cO=function(e,t){return sO.defineProperties(e,t)},lO=r(function(e){e.exports={default:cO,__esModule:!0}});t(lO);var fO=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.OAuthError=void 0;var r=s(lO),n=s(rk),i=s(Wm),o=s($m),a=s(nk),u=s(ik);function s(e){return e&&e.__esModule?e:{default:e}}var c=t.OAuthError=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,o.default)(t,[{key:"parse",value:function(e){var t=e.body||e;return(0,r.default)(this,{error:{enumerable:!0,value:t.error},errorDescription:{enumerable:!0,value:t.error_description},errorUri:{enumerable:!0,value:t.error_uri},res:{enumerable:!1,value:e}}),this.errorDescription}}]),t}($E.Exception),l=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),t}(c),f=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),t}(c),d=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),t}(c),p=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),t}(c),h=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),t}(c),v=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),t}(c),g={OAuthError:c,InvalidRequestError:l,InvalidClientError:f,InvalidGrantError:d,UnauthorizedClientError:p,UnsupportGrantTypeError:h,InvalidScopeError:v,invalid_request:l,invalid_client:f,invalid_grant:d,unauthorized_client:p,unsupported_grant_type:h,invalid_scope:v,select:function(e){return g[e]||c}};t.default=g});t(fO);fO.OAuthError;var dO=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.sortScope=function(e){if(!e)return"";return e.split(" ").sort().join(" ")},t.filterScope=function(e,t){if(!t)return"";return t.split(" ").filter(function(t){return t!==e}).sort().join(" ")}});t(dO);dO.sortScope,dO.filterScope;var pO=Nc("iterator"),hO=$s.isIterable=function(e){var t=Object(e);return void 0!==t[pO]||"@@iterator"in t||vc.hasOwnProperty(ll(t))},vO=r(function(e){e.exports={default:hO,__esModule:!0}});t(vO);var gO=$s.getIterator=function(e){var t=yl(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return Ks(t.call(e))},yO=r(function(e){e.exports={default:gO,__esModule:!0}});t(yO);var mO=r(function(e,t){t.__esModule=!0;var r=i(vO),n=i(yO);function i(e){return e&&e.__esModule?e:{default:e}}t.default=function(){return function(e,t){if(Array.isArray(e))return e;if((0,r.default)(Object(e)))return function(e,t){var r=[],i=!0,o=!1,a=void 0;try{for(var u,s=(0,n.default)(e);!(i=(u=s.next()).done)&&(r.push(u.value),!t||r.length!==t);i=!0);}catch(e){o=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw a}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()});t(mO);var bO=function(e,t,r,n){if(!sd(e))return e;for(var i=-1,o=(t=jv(t,e)).length,a=o-1,u=e;null!=u&&++i<o;){var s=Iv(t[i]),c=r;if(i!=a){var l=u[s];void 0===(c=n?n(l,s,u):void 0)&&(c=sd(l)?l:_p(t[i+1])?[]:{})}op(u,s,c),u=u[s]}return e};var _O=function(e,t,r){for(var n=-1,i=t.length,o={};++n<i;){var a=t[n],u=Dv(e,a);r(u,a)&&bO(o,jv(a,e),u)}return o};var wO=function(e,t){return null!=e&&t in Object(e)};var SO=function(e,t){return null!=e&&lT(e,t,wO)};var kO=function(e,t){return _O(e,t,function(t,r){return SO(e,r)})},EO=sg(function(e,t){return null==e?{}:kO(e,t)});tc(tc.S+tc.F*Ns(function(){Reflect.defineProperty(Zs.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(e,t,r){Ks(e),t=Ds(t,!0),Ks(r);try{return Zs.f(e,t,r),!0}catch(e){return!1}}});var PO=$s.Reflect.defineProperty,TO=r(function(e){e.exports={default:PO,__esModule:!0}});t(TO),tc(tc.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return Hs.f(Ks(e),t)}});var OO=$s.Reflect.getOwnPropertyDescriptor,CO=r(function(e){e.exports={default:OO,__esModule:!0}});t(CO),tc(tc.S,"Number",{isNaN:function(e){return e!=e}});var MO=$s.Number.isNaN,xO=r(function(e){e.exports={default:MO,__esModule:!0}});t(xO);var jO="[object Number]";var RO=function(e){return"number"==typeof e||sp(e)&&ud(e)==jO},AO=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(xO),n=o(lO),i=o(RO);function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){(0,n.default)(this,{loaded:{enumerable:!0,value:e,writable:!1},total:{enumerable:!0,value:t,writable:!1},lengthComputable:{enumerable:!0,value:(0,i.default)(e)&&!(0,r.default)(e)&&(0,i.default)(t)&&!(0,r.default)(t)&&t>0,writable:!1}})}});t(AO);var IO=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(bf),n=u(TO),i=u(YE),o=u(Wm),a=u($m);function u(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){var r=this;(0,o.default)(this,e),t&&(0,i.default)(t).forEach(function(e){var i=t[e];(0,n.default)(r,e,{enumerable:!0,value:i})})}return(0,a.default)(e,[{key:"onRequest",value:function(e){return r.default.resolve(e)}},{key:"onRequestError",value:function(e,t){return r.default.reject(t)}},{key:"onResponse",value:function(e,t){return r.default.resolve(t)}},{key:"onResponseError",value:function(e,t){return r.default.reject(t)}}],[{key:"create",value:function(){throw new Error("`Interceptor.create()` must be defined")}}]),e}();t.default=s});t(IO);var DO=Rs.f,LO=function(e){return function(t){for(var r,n=js(t),i=xc(n),o=i.length,a=0,u=[];o>a;)DO.call(n,r=i[a++])&&u.push(e?[r,n[r]]:n[r]);return u}},FO=LO(!1);tc(tc.S,"Object",{values:function(e){return FO(e)}});var NO=$s.Object.values,UO=r(function(e){e.exports={default:NO,__esModule:!0}});t(UO);var zO=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=u(Ef),n=u(rk),i=u(Wm),o=u(nk),a=u(ik);function u(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(e),u=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(e),s=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(u),c=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(u),l=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(u),f=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(u),d=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(u),p=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(u),h=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(u),v=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(u),g=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(u),y=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(u),m=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(u),b=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(u),_=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(u),w=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(u),S=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(u),k=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(u),E=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(u),P=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(u),T=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(e),O=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(T),C=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(T),M=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(T),x=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(T),j=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(T);(0,r.default)(e,{0:t,NetworkOrCORSError:t,400:u,BadRequest:u,401:s,Unauthorized:s,402:c,PaymentRequired:c,403:l,Forbidden:l,404:f,NotFound:f,405:d,MethodNotAllowed:d,406:p,NotAcceptable:p,407:h,ProxyAuthenticationRequired:h,408:v,RequestTimeout:v,409:g,Conflict:g,410:y,Gone:y,411:m,LengthRequired:m,412:b,PreconditionFailed:b,413:_,RequestEntityTooLarge:_,414:w,RequestUriTooLong:w,415:S,UnsupportedMediaType:S,416:k,RequestRangeNotSatisfiable:k,417:E,ExpectationFailed:E,429:P,TooManyRequests:P,500:T,InternalServerError:T,501:O,NotImplemented:O,502:C,BadGateway:C,503:M,ServiceUnavailable:M,504:x,GatewayTimeout:x,505:j,HttpVersionNotSupported:j,select:function(t){if(null==t)return e;t=t.statusCode||t;var r=e[t];return r||(t=t.toString().split("").shift()+"00",t=parseInt(t,10),e[t]||e)}})}});t(zO);var qO=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,n,i=v(jf),o=v(UO),a=v(lO),u=v(o_),s=v(rk),c=v(Wm),l=v($m),f=v(nk),d=v(ik),p=v(EO),h=v(zO);function v(e){return e&&e.__esModule?e:{default:e}}var g=(n=r=function(e){function t(){return(0,c.default)(this,t),(0,f.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,d.default)(t,e),(0,l.default)(t,[{key:"parse",value:function(e){var t=e.body,r=void 0;switch(void 0===t?"undefined":(0,u.default)(t)){case"string":try{t=JSON.parse(t),r=this.parseObject(t)}catch(e){r=t}break;case"object":r=this.parseObject(t)}return r||(r=this.defaultMessage),(0,a.default)(this,{body:{enumerable:!1,value:t},httpVersion:{enumerable:!1,value:e.httpVersion},headers:{enumerable:!1,value:e.headers||{}},rawHeaders:{enumerable:!1,value:e.rawHeaders||[]},trailers:{enumerable:!1,value:e.trailers||{}},rawTrailers:{enumerable:!1,value:e.rawTrailers||[]},method:{enumerable:!1,value:e.method},url:{enumerable:!1,value:e.url},statusCode:{enumerable:!1,value:e.statusCode},statusMessage:{enumerable:!1,value:e.statusMessage},socket:{enumerable:!1,value:e.socket},_res:{enumerable:!1,value:e}}),r}},{key:"parseObject",value:function(e){var r=(0,o.default)((0,p.default)(e,t.errorKeys));if(0===r.length)return(0,i.default)(e,null,2);var n=r[0];return"object"===(void 0===n?"undefined":(0,u.default)(n))?this.parseObject(n):n}}]),t}($E.Exception),r.errorKeys=["error","errorString","response","errorResponse","message","msg"],r.defaultMessage="An error was received while trying to fulfill the request",n);t.default=g,(0,h.default)(g),g.makeSubTypes=h.default});t(qO);var BO=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=f(bf),n=f(lO),i=f(rk),o=f(Wm),a=f($m),u=f(nk),s=f(ik),c=f(qO),l=f(IO);function f(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e,r){(0,o.default)(this,t);var a=(0,u.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e)),s=r&&(r.error||r.ErrorConstructor)||c.default;return(0,n.default)(a,{ErrorConstructor:{value:s}}),a}return(0,s.default)(t,e),(0,a.default)(t,[{key:"onResponse",value:function(e,t){if(t.statusCode){if(t.statusCode<400)return r.default.resolve(t);if(404===t.statusCode&&t.body&&2000002===t.body.errorCode)return r.default.resolve(t)}return r.default.reject(new(this.ErrorConstructor.select(t.statusCode))(t))}}],[{key:"create",value:function(e){return new t(this,e)}}]),t}(l.default);t.default=d});t(BO);var WO=function(e){return e&&e.length>1?255===e[0]&&216===e[1]&&255===e[2]?{ext:"jpg",mime:"image/jpeg"}:137===e[0]&&80===e[1]&&78===e[2]&&71===e[3]?{ext:"png",mime:"image/png"}:71===e[0]&&73===e[1]&&70===e[2]?{ext:"gif",mime:"image/gif"}:87===e[8]&&69===e[9]&&66===e[10]&&80===e[11]?{ext:"webp",mime:"image/webp"}:70===e[0]&&76===e[1]&&73===e[2]&&70===e[3]?{ext:"flif",mime:"image/flif"}:(73===e[0]&&73===e[1]&&42===e[2]&&0===e[3]||77===e[0]&&77===e[1]&&0===e[2]&&42===e[3])&&67===e[8]&&82===e[9]?{ext:"cr2",mime:"image/x-canon-cr2"}:73===e[0]&&73===e[1]&&42===e[2]&&0===e[3]||77===e[0]&&77===e[1]&&0===e[2]&&42===e[3]?{ext:"tif",mime:"image/tiff"}:66===e[0]&&77===e[1]?{ext:"bmp",mime:"image/bmp"}:73===e[0]&&73===e[1]&&188===e[2]?{ext:"jxr",mime:"image/vnd.ms-photo"}:56===e[0]&&66===e[1]&&80===e[2]&&83===e[3]?{ext:"psd",mime:"image/vnd.adobe.photoshop"}:80===e[0]&&75===e[1]&&3===e[2]&&4===e[3]&&109===e[30]&&105===e[31]&&109===e[32]&&101===e[33]&&116===e[34]&&121===e[35]&&112===e[36]&&101===e[37]&&97===e[38]&&112===e[39]&&112===e[40]&&108===e[41]&&105===e[42]&&99===e[43]&&97===e[44]&&116===e[45]&&105===e[46]&&111===e[47]&&110===e[48]&&47===e[49]&&101===e[50]&&112===e[51]&&117===e[52]&&98===e[53]&&43===e[54]&&122===e[55]&&105===e[56]&&112===e[57]?{ext:"epub",mime:"application/epub+zip"}:80===e[0]&&75===e[1]&&3===e[2]&&4===e[3]&&77===e[30]&&69===e[31]&&84===e[32]&&65===e[33]&&45===e[34]&&73===e[35]&&78===e[36]&&70===e[37]&&47===e[38]&&109===e[39]&&111===e[40]&&122===e[41]&&105===e[42]&&108===e[43]&&108===e[44]&&97===e[45]&&46===e[46]&&114===e[47]&&115===e[48]&&97===e[49]?{ext:"xpi",mime:"application/x-xpinstall"}:80!==e[0]||75!==e[1]||3!==e[2]&&5!==e[2]&&7!==e[2]||4!==e[3]&&6!==e[3]&&8!==e[3]?117===e[257]&&115===e[258]&&116===e[259]&&97===e[260]&&114===e[261]?{ext:"tar",mime:"application/x-tar"}:82!==e[0]||97!==e[1]||114!==e[2]||33!==e[3]||26!==e[4]||7!==e[5]||0!==e[6]&&1!==e[6]?31===e[0]&&139===e[1]&&8===e[2]?{ext:"gz",mime:"application/gzip"}:66===e[0]&&90===e[1]&&104===e[2]?{ext:"bz2",mime:"application/x-bzip2"}:55===e[0]&&122===e[1]&&188===e[2]&&175===e[3]&&39===e[4]&&28===e[5]?{ext:"7z",mime:"application/x-7z-compressed"}:120===e[0]&&1===e[1]?{ext:"dmg",mime:"application/x-apple-diskimage"}:0===e[0]&&0===e[1]&&0===e[2]&&(24===e[3]||32===e[3])&&102===e[4]&&116===e[5]&&121===e[6]&&112===e[7]||51===e[0]&&103===e[1]&&112===e[2]&&53===e[3]||0===e[0]&&0===e[1]&&0===e[2]&&28===e[3]&&102===e[4]&&116===e[5]&&121===e[6]&&112===e[7]&&109===e[8]&&112===e[9]&&52===e[10]&&50===e[11]&&109===e[16]&&112===e[17]&&52===e[18]&&49===e[19]&&109===e[20]&&112===e[21]&&52===e[22]&&50===e[23]&&105===e[24]&&115===e[25]&&111===e[26]&&109===e[27]||0===e[0]&&0===e[1]&&0===e[2]&&28===e[3]&&102===e[4]&&116===e[5]&&121===e[6]&&112===e[7]&&105===e[8]&&115===e[9]&&111===e[10]&&109===e[11]||0===e[0]&&0===e[1]&&0===e[2]&&28===e[3]&&102===e[4]&&116===e[5]&&121===e[6]&&112===e[7]&&109===e[8]&&112===e[9]&&52===e[10]&&50===e[11]&&0===e[12]&&0===e[13]&&0===e[14]&&0===e[15]?{ext:"mp4",mime:"video/mp4"}:0===e[0]&&0===e[1]&&0===e[2]&&28===e[3]&&102===e[4]&&116===e[5]&&121===e[6]&&112===e[7]&&77===e[8]&&52===e[9]&&86===e[10]?{ext:"m4v",mime:"video/x-m4v"}:77===e[0]&&84===e[1]&&104===e[2]&&100===e[3]?{ext:"mid",mime:"audio/midi"}:109===e[31]&&97===e[32]&&116===e[33]&&114===e[34]&&111===e[35]&&115===e[36]&&107===e[37]&&97===e[38]?{ext:"mkv",mime:"video/x-matroska"}:26===e[0]&&69===e[1]&&223===e[2]&&163===e[3]?{ext:"webm",mime:"video/webm"}:0===e[0]&&0===e[1]&&0===e[2]&&20===e[3]&&102===e[4]&&116===e[5]&&121===e[6]&&112===e[7]?{ext:"mov",mime:"video/quicktime"}:82===e[0]&&73===e[1]&&70===e[2]&&70===e[3]&&65===e[8]&&86===e[9]&&73===e[10]?{ext:"avi",mime:"video/x-msvideo"}:48===e[0]&&38===e[1]&&178===e[2]&&117===e[3]&&142===e[4]&&102===e[5]&&207===e[6]&&17===e[7]&&166===e[8]&&217===e[9]?{ext:"wmv",mime:"video/x-ms-wmv"}:0===e[0]&&0===e[1]&&1===e[2]&&"b"===e[3].toString(16)[0]?{ext:"mpg",mime:"video/mpeg"}:73===e[0]&&68===e[1]&&51===e[2]||255===e[0]&&251===e[1]?{ext:"mp3",mime:"audio/mpeg"}:102===e[4]&&116===e[5]&&121===e[6]&&112===e[7]&&77===e[8]&&52===e[9]&&65===e[10]||77===e[0]&&52===e[1]&&65===e[2]&&32===e[3]?{ext:"m4a",mime:"audio/m4a"}:79===e[28]&&112===e[29]&&117===e[30]&&115===e[31]&&72===e[32]&&101===e[33]&&97===e[34]&&100===e[35]?{ext:"opus",mime:"audio/opus"}:79===e[0]&&103===e[1]&&103===e[2]&&83===e[3]?{ext:"ogg",mime:"audio/ogg"}:102===e[0]&&76===e[1]&&97===e[2]&&67===e[3]?{ext:"flac",mime:"audio/x-flac"}:82===e[0]&&73===e[1]&&70===e[2]&&70===e[3]&&87===e[8]&&65===e[9]&&86===e[10]&&69===e[11]?{ext:"wav",mime:"audio/x-wav"}:35===e[0]&&33===e[1]&&65===e[2]&&77===e[3]&&82===e[4]&&10===e[5]?{ext:"amr",mime:"audio/amr"}:37===e[0]&&80===e[1]&&68===e[2]&&70===e[3]?{ext:"pdf",mime:"application/pdf"}:77===e[0]&&90===e[1]?{ext:"exe",mime:"application/x-msdownload"}:67!==e[0]&&70!==e[0]||87!==e[1]||83!==e[2]?123===e[0]&&92===e[1]&&114===e[2]&&116===e[3]&&102===e[4]?{ext:"rtf",mime:"application/rtf"}:119===e[0]&&79===e[1]&&70===e[2]&&70===e[3]&&(0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]||79===e[4]&&84===e[5]&&84===e[6]&&79===e[7])?{ext:"woff",mime:"application/font-woff"}:119===e[0]&&79===e[1]&&70===e[2]&&50===e[3]&&(0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]||79===e[4]&&84===e[5]&&84===e[6]&&79===e[7])?{ext:"woff2",mime:"application/font-woff"}:76===e[34]&&80===e[35]&&(0===e[8]&&0===e[9]&&1===e[10]||1===e[8]&&0===e[9]&&2===e[10]||2===e[8]&&0===e[9]&&2===e[10])?{ext:"eot",mime:"application/octet-stream"}:0===e[0]&&1===e[1]&&0===e[2]&&0===e[3]&&0===e[4]?{ext:"ttf",mime:"application/font-sfnt"}:79===e[0]&&84===e[1]&&84===e[2]&&79===e[3]&&0===e[4]?{ext:"otf",mime:"application/font-sfnt"}:0===e[0]&&0===e[1]&&1===e[2]&&0===e[3]?{ext:"ico",mime:"image/x-icon"}:70===e[0]&&76===e[1]&&86===e[2]&&1===e[3]?{ext:"flv",mime:"video/x-flv"}:37===e[0]&&33===e[1]?{ext:"ps",mime:"application/postscript"}:253===e[0]&&55===e[1]&&122===e[2]&&88===e[3]&&90===e[4]&&0===e[5]?{ext:"xz",mime:"application/x-xz"}:83===e[0]&&81===e[1]&&76===e[2]&&105===e[3]?{ext:"sqlite",mime:"application/x-sqlite3"}:78===e[0]&&69===e[1]&&83===e[2]&&26===e[3]?{ext:"nes",mime:"application/x-nintendo-nes-rom"}:67===e[0]&&114===e[1]&&50===e[2]&&52===e[3]?{ext:"crx",mime:"application/x-google-chrome-extension"}:77===e[0]&&83===e[1]&&67===e[2]&&70===e[3]||73===e[0]&&83===e[1]&&99===e[2]&&40===e[3]?{ext:"cab",mime:"application/vnd.ms-cab-compressed"}:33===e[0]&&60===e[1]&&97===e[2]&&114===e[3]&&99===e[4]&&104===e[5]&&62===e[6]&&10===e[7]&&100===e[8]&&101===e[9]&&98===e[10]&&105===e[11]&&97===e[12]&&110===e[13]&&45===e[14]&&98===e[15]&&105===e[16]&&110===e[17]&&97===e[18]&&114===e[19]&&121===e[20]?{ext:"deb",mime:"application/x-deb"}:33===e[0]&&60===e[1]&&97===e[2]&&114===e[3]&&99===e[4]&&104===e[5]&&62===e[6]?{ext:"ar",mime:"application/x-unix-archive"}:237===e[0]&&171===e[1]&&238===e[2]&&219===e[3]?{ext:"rpm",mime:"application/x-rpm"}:31===e[0]&&160===e[1]||31===e[0]&&157===e[1]?{ext:"Z",mime:"application/x-compress"}:76===e[0]&&90===e[1]&&73===e[2]&&80===e[3]?{ext:"lz",mime:"application/x-lzip"}:208===e[0]&&207===e[1]&&17===e[2]&&224===e[3]&&161===e[4]&&177===e[5]&&26===e[6]&&225===e[7]?{ext:"msi",mime:"application/x-msi"}:null:{ext:"swf",mime:"application/x-shockwave-flash"}:{ext:"rar",mime:"application/x-rar-compressed"}:{ext:"zip",mime:"application/zip"}:null},VO=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.detect=void 0;var r=i(bf);t.default=o,t.detectSync=a;var n=i(WO);function i(e){return e&&e.__esModule?e:{default:e}}function o(e){return new r.default(function(t){t(a(e))})}function a(e){var t=e;if($E.inBrowser){if(e instanceof Blob)return e.type;if(e instanceof ArrayBuffer)t=new Uint8Array(e);else if(!(e instanceof Uint8Array))throw new Error("`detect` requires a buffer of type Blob, ArrayBuffer, or Uint8Array")}var r=(0,n.default)(t);return r?r.mime:"application/octet-stream"}t.detect=o});t(VO);VO.detect,VO.detectSync;var GO=Object.prototype.hasOwnProperty,HO=Array.isArray,$O=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),JO=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)void 0!==e[n]&&(r[n]=e[n]);return r},YO={arrayToObject:JO,assign:function(e,t){return Object.keys(t).reduce(function(e,r){return e[r]=t[r],e},e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],n=0;n<t.length;++n)for(var i=t[n],o=i.obj[i.prop],a=Object.keys(o),u=0;u<a.length;++u){var s=a[u],c=o[s];"object"==typeof c&&null!==c&&-1===r.indexOf(c)&&(t.push({obj:o,prop:s}),r.push(c))}return function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(HO(r)){for(var n=[],i=0;i<r.length;++i)void 0!==r[i]&&n.push(r[i]);t.obj[t.prop]=n}}}(t),e},decode:function(e,t,r){var n=e.replace(/\+/g," ");if("iso-8859-1"===r)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(e){return n}},encode:function(e,t,r){if(0===e.length)return e;var n="string"==typeof e?e:String(e);if("iso-8859-1"===r)return escape(n).replace(/%u[0-9a-f]{4}/gi,function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"});for(var i="",o=0;o<n.length;++o){var a=n.charCodeAt(o);45===a||46===a||95===a||126===a||a>=48&&a<=57||a>=65&&a<=90||a>=97&&a<=122?i+=n.charAt(o):a<128?i+=$O[a]:a<2048?i+=$O[192|a>>6]+$O[128|63&a]:a<55296||a>=57344?i+=$O[224|a>>12]+$O[128|a>>6&63]+$O[128|63&a]:(o+=1,a=65536+((1023&a)<<10|1023&n.charCodeAt(o)),i+=$O[240|a>>18]+$O[128|a>>12&63]+$O[128|a>>6&63]+$O[128|63&a])}return i},isBuffer:function(e){return!(!e||"object"!=typeof e||!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e)))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},merge:function e(t,r,n){if(!r)return t;if("object"!=typeof r){if(HO(t))t.push(r);else{if(!t||"object"!=typeof t)return[t,r];(n&&(n.plainObjects||n.allowPrototypes)||!GO.call(Object.prototype,r))&&(t[r]=!0)}return t}if(!t||"object"!=typeof t)return[t].concat(r);var i=t;return HO(t)&&!HO(r)&&(i=JO(t,n)),HO(t)&&HO(r)?(r.forEach(function(r,i){if(GO.call(t,i)){var o=t[i];o&&"object"==typeof o&&r&&"object"==typeof r?t[i]=e(o,r,n):t.push(r)}else t[i]=r}),t):Object.keys(r).reduce(function(t,i){var o=r[i];return GO.call(t,i)?t[i]=e(t[i],o,n):t[i]=o,t},i)}},KO=String.prototype.replace,XO=/%20/g,ZO={default:"RFC3986",formatters:{RFC1738:function(e){return KO.call(e,XO,"+")},RFC3986:function(e){return e}},RFC1738:"RFC1738",RFC3986:"RFC3986"},QO=Object.prototype.hasOwnProperty,eC={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},tC=Array.isArray,rC=Array.prototype.push,nC=function(e,t){rC.apply(e,tC(t)?t:[t])},iC=Date.prototype.toISOString,oC={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:YO.encode,encodeValuesOnly:!1,formatter:ZO.formatters[ZO.default],indices:!1,serializeDate:function(e){return iC.call(e)},skipNulls:!1,strictNullHandling:!1},aC=function e(t,r,n,i,o,a,u,s,c,l,f,d,p){var h=t;if("function"==typeof u?h=u(r,h):h instanceof Date?h=l(h):"comma"===n&&tC(h)&&(h=h.join(",")),null===h){if(i)return a&&!d?a(r,oC.encoder,p):r;h=""}if("string"==typeof h||"number"==typeof h||"boolean"==typeof h||YO.isBuffer(h))return a?[f(d?r:a(r,oC.encoder,p))+"="+f(a(h,oC.encoder,p))]:[f(r)+"="+f(String(h))];var v,g=[];if(void 0===h)return g;if(tC(u))v=u;else{var y=Object.keys(h);v=s?y.sort(s):y}for(var m=0;m<v.length;++m){var b=v[m];o&&null===h[b]||(tC(h)?nC(g,e(h[b],"function"==typeof n?n(r,b):r,n,i,o,a,u,s,c,l,f,d,p)):nC(g,e(h[b],r+(c?"."+b:"["+b+"]"),n,i,o,a,u,s,c,l,f,d,p)))}return g},uC=Object.prototype.hasOwnProperty,sC={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:YO.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},cC=function(e){return e.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},lC=function(e,t,r){if(e){var n=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,i=/(\[[^[\]]*])/g,o=/(\[[^[\]]*])/.exec(n),a=o?n.slice(0,o.index):n,u=[];if(a){if(!r.plainObjects&&uC.call(Object.prototype,a)&&!r.allowPrototypes)return;u.push(a)}for(var s=0;null!==(o=i.exec(n))&&s<r.depth;){if(s+=1,!r.plainObjects&&uC.call(Object.prototype,o[1].slice(1,-1))&&!r.allowPrototypes)return;u.push(o[1])}return o&&u.push("["+n.slice(o.index)+"]"),function(e,t,r){for(var n=t,i=e.length-1;i>=0;--i){var o,a=e[i];if("[]"===a&&r.parseArrays)o=[].concat(n);else{o=r.plainObjects?Object.create(null):{};var u="["===a.charAt(0)&&"]"===a.charAt(a.length-1)?a.slice(1,-1):a,s=parseInt(u,10);r.parseArrays||""!==u?!isNaN(s)&&a!==u&&String(s)===u&&s>=0&&r.parseArrays&&s<=r.arrayLimit?(o=[])[s]=n:o[u]=n:o={0:n}}n=o}return n}(u,t,r)}},fC={formats:ZO,parse:function(e,t){var r=function(e){if(!e)return sC;if(null!==e.decoder&&void 0!==e.decoder&&"function"!=typeof e.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new Error("The charset option must be either utf-8, iso-8859-1, or undefined");var t=void 0===e.charset?sC.charset:e.charset;return{allowDots:void 0===e.allowDots?sC.allowDots:!!e.allowDots,allowPrototypes:"boolean"==typeof e.allowPrototypes?e.allowPrototypes:sC.allowPrototypes,arrayLimit:"number"==typeof e.arrayLimit?e.arrayLimit:sC.arrayLimit,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:sC.charsetSentinel,comma:"boolean"==typeof e.comma?e.comma:sC.comma,decoder:"function"==typeof e.decoder?e.decoder:sC.decoder,delimiter:"string"==typeof e.delimiter||YO.isRegExp(e.delimiter)?e.delimiter:sC.delimiter,depth:"number"==typeof e.depth?e.depth:sC.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof e.interpretNumericEntities?e.interpretNumericEntities:sC.interpretNumericEntities,parameterLimit:"number"==typeof e.parameterLimit?e.parameterLimit:sC.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"==typeof e.plainObjects?e.plainObjects:sC.plainObjects,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:sC.strictNullHandling}}(t);if(""===e||null==e)return r.plainObjects?Object.create(null):{};for(var n="string"==typeof e?function(e,t){var r,n={},i=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,o=t.parameterLimit===1/0?void 0:t.parameterLimit,a=i.split(t.delimiter,o),u=-1,s=t.charset;if(t.charsetSentinel)for(r=0;r<a.length;++r)0===a[r].indexOf("utf8=")&&("utf8=%E2%9C%93"===a[r]?s="utf-8":"utf8=%26%2310003%3B"===a[r]&&(s="iso-8859-1"),u=r,r=a.length);for(r=0;r<a.length;++r)if(r!==u){var c,l,f=a[r],d=f.indexOf("]="),p=-1===d?f.indexOf("="):d+1;-1===p?(c=t.decoder(f,sC.decoder,s),l=t.strictNullHandling?null:""):(c=t.decoder(f.slice(0,p),sC.decoder,s),l=t.decoder(f.slice(p+1),sC.decoder,s)),l&&t.interpretNumericEntities&&"iso-8859-1"===s&&(l=cC(l)),l&&t.comma&&l.indexOf(",")>-1&&(l=l.split(",")),uC.call(n,c)?n[c]=YO.combine(n[c],l):n[c]=l}return n}(e,r):e,i=r.plainObjects?Object.create(null):{},o=Object.keys(n),a=0;a<o.length;++a){var u=o[a],s=lC(u,n[u],r);i=YO.merge(i,s,r)}return YO.compact(i)},stringify:function(e,t){var r,n=e,i=function(e){if(!e)return oC;if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||oC.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=ZO.default;if(void 0!==e.format){if(!QO.call(ZO.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var n=ZO.formatters[r],i=oC.filter;return("function"==typeof e.filter||tC(e.filter))&&(i=e.filter),{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:oC.addQueryPrefix,allowDots:void 0===e.allowDots?oC.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:oC.charsetSentinel,delimiter:void 0===e.delimiter?oC.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:oC.encode,encoder:"function"==typeof e.encoder?e.encoder:oC.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:oC.encodeValuesOnly,filter:i,formatter:n,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:oC.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:oC.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:oC.strictNullHandling}}(t);"function"==typeof i.filter?n=(0,i.filter)("",n):tC(i.filter)&&(r=i.filter);var o,a=[];if("object"!=typeof n||null===n)return"";o=t&&t.arrayFormat in eC?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices";var u=eC[o];r||(r=Object.keys(n)),i.sort&&r.sort(i.sort);for(var s=0;s<r.length;++s){var c=r[s];i.skipNulls&&null===n[c]||nC(a,aC(n[c],c,u,i.strictNullHandling,i.skipNulls,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.formatter,i.encodeValuesOnly,i.charset))}var l=a.join(i.delimiter),f=!0===i.addQueryPrefix?"?":"";return i.charsetSentinel&&("iso-8859-1"===i.charset?f+="utf8=%26%2310003%3B&":f+="utf8=%E2%9C%93&"),l.length>0?f+l:""}},dC="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},pC=function(e){var t=hC.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)},hC=Object.prototype.toString;var vC,gC=Array.prototype.slice,yC=Object.prototype.toString,mC=Function.prototype.bind||function(e){var t=this;if("function"!=typeof t||"[object Function]"!==yC.call(t))throw new TypeError("Function.prototype.bind called on incompatible "+t);for(var r,n=gC.call(arguments,1),i=Math.max(0,t.length-n.length),o=[],a=0;a<i;a++)o.push("$"+a);if(r=Function("binder","return function ("+o.join(",")+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof r){var i=t.apply(this,n.concat(gC.call(arguments)));return Object(i)===i?i:this}return t.apply(e,n.concat(gC.call(arguments)))}),t.prototype){var u=function(){};u.prototype=t.prototype,r.prototype=new u,u.prototype=null}return r},bC=Object.prototype.toString,_C=function(e){var t=bC.call(e),r="[object Arguments]"===t;return r||(r="[object Array]"!==t&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===bC.call(e.callee)),r};if(!Object.keys){var wC=Object.prototype.hasOwnProperty,SC=Object.prototype.toString,kC=_C,EC=Object.prototype.propertyIsEnumerable,PC=!EC.call({toString:null},"toString"),TC=EC.call(function(){},"prototype"),OC=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],CC=function(e){var t=e.constructor;return t&&t.prototype===e},MC={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},xC=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!MC["$"+e]&&wC.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{CC(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();vC=function(e){var t=null!==e&&"object"==typeof e,r="[object Function]"===SC.call(e),n=kC(e),i=t&&"[object String]"===SC.call(e),o=[];if(!t&&!r&&!n)throw new TypeError("Object.keys called on a non-object");var a=TC&&r;if(i&&e.length>0&&!wC.call(e,0))for(var u=0;u<e.length;++u)o.push(String(u));if(n&&e.length>0)for(var s=0;s<e.length;++s)o.push(String(s));else for(var c in e)a&&"prototype"===c||!wC.call(e,c)||o.push(String(c));if(PC)for(var l=function(e){if("undefined"==typeof window||!xC)return CC(e);try{return CC(e)}catch(e){return!1}}(e),f=0;f<OC.length;++f)l&&"constructor"===OC[f]||!wC.call(e,OC[f])||o.push(OC[f]);return o}}var jC=vC,RC=Array.prototype.slice,AC=Object.keys,IC=AC?function(e){return AC(e)}:jC,DC=Object.keys;IC.shim=function(){Object.keys?function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2)||(Object.keys=function(e){return _C(e)?DC(RC.call(e)):DC(e)}):Object.keys=IC;return Object.keys||IC};var LC=IC,FC="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),NC=Object.prototype.toString,UC=Array.prototype.concat,zC=Object.defineProperty,qC=zC&&function(){var e={};try{for(var t in zC(e,"x",{enumerable:!1,value:e}),e)return!1;return e.x===e}catch(e){return!1}}(),BC=function(e,t,r,n){var i;t in e&&("function"!=typeof(i=n)||"[object Function]"!==NC.call(i)||!n())||(qC?zC(e,t,{configurable:!0,enumerable:!1,value:r,writable:!0}):e[t]=r)},WC=function(e,t){var r=arguments.length>2?arguments[2]:{},n=LC(t);FC&&(n=UC.call(n,Object.getOwnPropertySymbols(t)));for(var i=0;i<n.length;i+=1)BC(e,n[i],t[n[i]],r[n[i]])};WC.supportsDescriptors=!!qC;var VC=WC,GC=Object.getOwnPropertyDescriptor?function(){return Object.getOwnPropertyDescriptor(arguments,"callee").get}():function(){throw new TypeError},HC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator,$C=Object.getPrototypeOf||function(e){return e.__proto__},JC="undefined"==typeof Uint8Array?void 0:$C(Uint8Array),YC={"$ %Array%":Array,"$ %ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"$ %ArrayBufferPrototype%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer.prototype,"$ %ArrayIteratorPrototype%":HC?$C([][Symbol.iterator]()):void 0,"$ %ArrayPrototype%":Array.prototype,"$ %ArrayProto_entries%":Array.prototype.entries,"$ %ArrayProto_forEach%":Array.prototype.forEach,"$ %ArrayProto_keys%":Array.prototype.keys,"$ %ArrayProto_values%":Array.prototype.values,"$ %AsyncFromSyncIteratorPrototype%":void 0,"$ %AsyncFunction%":void 0,"$ %AsyncFunctionPrototype%":void 0,"$ %AsyncGenerator%":void 0,"$ %AsyncGeneratorFunction%":void 0,"$ %AsyncGeneratorPrototype%":void 0,"$ %AsyncIteratorPrototype%":void 0,"$ %Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"$ %Boolean%":Boolean,"$ %BooleanPrototype%":Boolean.prototype,"$ %DataView%":"undefined"==typeof DataView?void 0:DataView,"$ %DataViewPrototype%":"undefined"==typeof DataView?void 0:DataView.prototype,"$ %Date%":Date,"$ %DatePrototype%":Date.prototype,"$ %decodeURI%":decodeURI,"$ %decodeURIComponent%":decodeURIComponent,"$ %encodeURI%":encodeURI,"$ %encodeURIComponent%":encodeURIComponent,"$ %Error%":Error,"$ %ErrorPrototype%":Error.prototype,"$ %eval%":eval,"$ %EvalError%":EvalError,"$ %EvalErrorPrototype%":EvalError.prototype,"$ %Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"$ %Float32ArrayPrototype%":"undefined"==typeof Float32Array?void 0:Float32Array.prototype,"$ %Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"$ %Float64ArrayPrototype%":"undefined"==typeof Float64Array?void 0:Float64Array.prototype,"$ %Function%":Function,"$ %FunctionPrototype%":Function.prototype,"$ %Generator%":void 0,"$ %GeneratorFunction%":void 0,"$ %GeneratorPrototype%":void 0,"$ %Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"$ %Int8ArrayPrototype%":"undefined"==typeof Int8Array?void 0:Int8Array.prototype,"$ %Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"$ %Int16ArrayPrototype%":"undefined"==typeof Int16Array?void 0:Int8Array.prototype,"$ %Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"$ %Int32ArrayPrototype%":"undefined"==typeof Int32Array?void 0:Int32Array.prototype,"$ %isFinite%":isFinite,"$ %isNaN%":isNaN,"$ %IteratorPrototype%":HC?$C($C([][Symbol.iterator]())):void 0,"$ %JSON%":JSON,"$ %JSONParse%":JSON.parse,"$ %Map%":"undefined"==typeof Map?void 0:Map,"$ %MapIteratorPrototype%":"undefined"!=typeof Map&&HC?$C((new Map)[Symbol.iterator]()):void 0,"$ %MapPrototype%":"undefined"==typeof Map?void 0:Map.prototype,"$ %Math%":Math,"$ %Number%":Number,"$ %NumberPrototype%":Number.prototype,"$ %Object%":Object,"$ %ObjectPrototype%":Object.prototype,"$ %ObjProto_toString%":Object.prototype.toString,"$ %ObjProto_valueOf%":Object.prototype.valueOf,"$ %parseFloat%":parseFloat,"$ %parseInt%":parseInt,"$ %Promise%":"undefined"==typeof Promise?void 0:Promise,"$ %PromisePrototype%":"undefined"==typeof Promise?void 0:Promise.prototype,"$ %PromiseProto_then%":"undefined"==typeof Promise?void 0:Promise.prototype.then,"$ %Promise_all%":"undefined"==typeof Promise?void 0:Promise.all,"$ %Promise_reject%":"undefined"==typeof Promise?void 0:Promise.reject,"$ %Promise_resolve%":"undefined"==typeof Promise?void 0:Promise.resolve,"$ %Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"$ %RangeError%":RangeError,"$ %RangeErrorPrototype%":RangeError.prototype,"$ %ReferenceError%":ReferenceError,"$ %ReferenceErrorPrototype%":ReferenceError.prototype,"$ %Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"$ %RegExp%":RegExp,"$ %RegExpPrototype%":RegExp.prototype,"$ %Set%":"undefined"==typeof Set?void 0:Set,"$ %SetIteratorPrototype%":"undefined"!=typeof Set&&HC?$C((new Set)[Symbol.iterator]()):void 0,"$ %SetPrototype%":"undefined"==typeof Set?void 0:Set.prototype,"$ %SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"$ %SharedArrayBufferPrototype%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer.prototype,"$ %String%":String,"$ %StringIteratorPrototype%":HC?$C(""[Symbol.iterator]()):void 0,"$ %StringPrototype%":String.prototype,"$ %Symbol%":HC?Symbol:void 0,"$ %SymbolPrototype%":HC?Symbol.prototype:void 0,"$ %SyntaxError%":SyntaxError,"$ %SyntaxErrorPrototype%":SyntaxError.prototype,"$ %ThrowTypeError%":GC,"$ %TypedArray%":JC,"$ %TypedArrayPrototype%":JC?JC.prototype:void 0,"$ %TypeError%":TypeError,"$ %TypeErrorPrototype%":TypeError.prototype,"$ %Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"$ %Uint8ArrayPrototype%":"undefined"==typeof Uint8Array?void 0:Uint8Array.prototype,"$ %Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"$ %Uint8ClampedArrayPrototype%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray.prototype,"$ %Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"$ %Uint16ArrayPrototype%":"undefined"==typeof Uint16Array?void 0:Uint16Array.prototype,"$ %Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"$ %Uint32ArrayPrototype%":"undefined"==typeof Uint32Array?void 0:Uint32Array.prototype,"$ %URIError%":URIError,"$ %URIErrorPrototype%":URIError.prototype,"$ %WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"$ %WeakMapPrototype%":"undefined"==typeof WeakMap?void 0:WeakMap.prototype,"$ %WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet,"$ %WeakSetPrototype%":"undefined"==typeof WeakSet?void 0:WeakSet.prototype},KC=function(e,t){if(arguments.length>1&&"boolean"!=typeof t)throw new TypeError('"allowMissing" argument must be a boolean');var r="$ "+e;if(!(r in YC))throw new SyntaxError("intrinsic "+e+" does not exist!");if(void 0===YC[r]&&!t)throw new TypeError("intrinsic "+e+" exists, but is not available. Please file an issue!");return YC[r]},XC=mC.call(Function.call,Object.prototype.hasOwnProperty),ZC=KC("%TypeError%"),QC=KC("%SyntaxError%"),eM={"Property Descriptor":function(e,t){if("Object"!==e.Type(t))return!1;var r={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var n in t)if(XC(t,n)&&!r[n])return!1;var i=XC(t,"[[Value]]"),o=XC(t,"[[Get]]")||XC(t,"[[Set]]");if(i&&o)throw new ZC("Property Descriptors may not be both accessor and data descriptors");return!0}},tM=function(e,t,r,n){var i=eM[t];if("function"!=typeof i)throw new QC("unknown record type: "+t);if(!i(e,n))throw new ZC(r+" must be a "+t);console.log(i(e,n),n)},rM=Number.isNaN||function(e){return e!=e},nM=Number.isNaN||function(e){return e!=e},iM=Number.isFinite||function(e){return"number"==typeof e&&!nM(e)&&e!==1/0&&e!==-1/0},oM=function(e){return e>=0?1:-1},aM=Function.prototype.toString,uM=/^\s*class\b/,sM=function(e){try{var t=aM.call(e);return uM.test(t)}catch(e){return!1}},cM=Object.prototype.toString,lM="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,fM=function(e){if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;if(lM)return function(e){try{return!sM(e)&&(aM.call(e),!0)}catch(e){return!1}}(e);if(sM(e))return!1;var t=cM.call(e);return"[object Function]"===t||"[object GeneratorFunction]"===t},dM=function(e){return null===e||"function"!=typeof e&&"object"!=typeof e},pM=Object.prototype.toString,hM=function(e){var t;if((t=arguments.length>1?arguments[1]:"[object Date]"===pM.call(e)?String:Number)===String||t===Number){var r,n,i=t===String?["toString","valueOf"]:["valueOf","toString"];for(n=0;n<i.length;++n)if(fM(e[i[n]])&&(r=e[i[n]](),dM(r)))return r;throw new TypeError("No default value")}throw new TypeError("invalid [[DefaultValue]] hint supplied")},vM=KC("%Object%"),gM=KC("%TypeError%"),yM=KC("%String%"),mM={ToPrimitive:function(e){return dM(e)?e:arguments.length>1?hM(e,arguments[1]):hM(e)},ToBoolean:function(e){return!!e},ToNumber:function(e){return+e},ToInteger:function(e){var t=this.ToNumber(e);return rM(t)?0:0!==t&&iM(t)?oM(t)*Math.floor(Math.abs(t)):t},ToInt32:function(e){return this.ToNumber(e)>>0},ToUint32:function(e){return this.ToNumber(e)>>>0},ToUint16:function(e){var t=this.ToNumber(e);return rM(t)||0===t||!iM(t)?0:function(e,t){var r=e%t;return Math.floor(r>=0?r:r+t)}(oM(t)*Math.floor(Math.abs(t)),65536)},ToString:function(e){return yM(e)},ToObject:function(e){return this.CheckObjectCoercible(e),vM(e)},CheckObjectCoercible:function(e,t){if(null==e)throw new gM(t||"Cannot call method on "+e);return e},IsCallable:fM,SameValue:function(e,t){return e===t?0!==e||1/e==1/t:rM(e)&&rM(t)},Type:function(e){return null===e?"Null":void 0===e?"Undefined":"function"==typeof e||"object"==typeof e?"Object":"number"==typeof e?"Number":"boolean"==typeof e?"Boolean":"string"==typeof e?"String":void 0},IsPropertyDescriptor:function(e){if("Object"!==this.Type(e))return!1;var t={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var r in e)if(XC(e,r)&&!t[r])return!1;var n=XC(e,"[[Value]]"),i=XC(e,"[[Get]]")||XC(e,"[[Set]]");if(n&&i)throw new gM("Property Descriptors may not be both accessor and data descriptors");return!0},IsAccessorDescriptor:function(e){return void 0!==e&&(tM(this,"Property Descriptor","Desc",e),!(!XC(e,"[[Get]]")&&!XC(e,"[[Set]]")))},IsDataDescriptor:function(e){return void 0!==e&&(tM(this,"Property Descriptor","Desc",e),!(!XC(e,"[[Value]]")&&!XC(e,"[[Writable]]")))},IsGenericDescriptor:function(e){return void 0!==e&&(tM(this,"Property Descriptor","Desc",e),!this.IsAccessorDescriptor(e)&&!this.IsDataDescriptor(e))},FromPropertyDescriptor:function(e){if(void 0===e)return e;if(tM(this,"Property Descriptor","Desc",e),this.IsDataDescriptor(e))return{value:e["[[Value]]"],writable:!!e["[[Writable]]"],enumerable:!!e["[[Enumerable]]"],configurable:!!e["[[Configurable]]"]};if(this.IsAccessorDescriptor(e))return{get:e["[[Get]]"],set:e["[[Set]]"],enumerable:!!e["[[Enumerable]]"],configurable:!!e["[[Configurable]]"]};throw new gM("FromPropertyDescriptor must be called with a fully populated Property Descriptor")},ToPropertyDescriptor:function(e){if("Object"!==this.Type(e))throw new gM("ToPropertyDescriptor requires an object");var t={};if(XC(e,"enumerable")&&(t["[[Enumerable]]"]=this.ToBoolean(e.enumerable)),XC(e,"configurable")&&(t["[[Configurable]]"]=this.ToBoolean(e.configurable)),XC(e,"value")&&(t["[[Value]]"]=e.value),XC(e,"writable")&&(t["[[Writable]]"]=this.ToBoolean(e.writable)),XC(e,"get")){var r=e.get;if(void 0!==r&&!this.IsCallable(r))throw new TypeError("getter must be a function");t["[[Get]]"]=r}if(XC(e,"set")){var n=e.set;if(void 0!==n&&!this.IsCallable(n))throw new gM("setter must be a function");t["[[Set]]"]=n}if((XC(t,"[[Get]]")||XC(t,"[[Set]]"))&&(XC(t,"[[Value]]")||XC(t,"[[Writable]]")))throw new gM("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return t}},bM=mC.call(Function.call,String.prototype.replace),_M=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,wM=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/,SM=function(){var e=mM.ToString(mM.CheckObjectCoercible(this));return bM(bM(e,_M,""),wM,"")},kM=function(){return String.prototype.trim&&"​"==="​".trim()?String.prototype.trim:SM},EM=mC.call(Function.call,kM());VC(EM,{getPolyfill:kM,implementation:SM,shim:function(){var e=kM();return VC(String.prototype,{trim:e},{trim:function(){return String.prototype.trim!==e}}),e}});var PM=EM,TM=Object.prototype.toString,OM=Object.prototype.hasOwnProperty,CM=function(e,t,r){if(!fM(t))throw new TypeError("iterator must be a function");var n;arguments.length>=3&&(n=r),"[object Array]"===TM.call(e)?function(e,t,r){for(var n=0,i=e.length;n<i;n++)OM.call(e,n)&&(null==r?t(e[n],n,e):t.call(r,e[n],n,e))}(e,t,n):"string"==typeof e?function(e,t,r){for(var n=0,i=e.length;n<i;n++)null==r?t(e.charAt(n),n,e):t.call(r,e.charAt(n),n,e)}(e,t,n):function(e,t,r){for(var n in e)OM.call(e,n)&&(null==r?t(e[n],n,e):t.call(r,e[n],n,e))}(e,t,n)},MM=function(e){if(!e)return{};var t={};return CM(PM(e).split("\n"),function(e){var r,n=e.indexOf(":"),i=PM(e.slice(0,n)).toLowerCase(),o=PM(e.slice(n+1));void 0===t[i]?t[i]=o:(r=t[i],"[object Array]"===Object.prototype.toString.call(r)?t[i].push(o):t[i]=[t[i],o])}),t},xM=function(){for(var e={},t=0;t<arguments.length;t++){var r=arguments[t];for(var n in r)jM.call(r,n)&&(e[n]=r[n])}return e},jM=Object.prototype.hasOwnProperty;var RM=r(function(e){var t,r=(t=jf)&&t.__esModule?t:{default:t};function n(e,t,r){var n=e;return pC(t)?(r=t,"string"==typeof e&&(n={uri:e})):n=xM(t,{uri:e}),n.callback=r,n}function i(e,t,r){return o(t=n(e,t,r))}function o(e){if(void 0===e.callback)throw new Error("callback argument missing");var t=!1,n=function(r,n,i){t||(t=!0,e.callback(r,n,i))};function o(){var e=void 0;if(e=l.response?l.response:l.responseText||function(e){if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;if(""===e.responseType&&!t)return e.responseXML;return null}(l),y)try{e=JSON.parse(e)}catch(e){}return e}function a(e){return clearTimeout(f),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,n(e,m)}function u(){if(!c){var t;clearTimeout(f),t=e.useXDR&&void 0===l.status?200:1223===l.status?204:l.status;var r=m,i=null;return 0!==t?(r={body:o(),statusCode:t,method:p,headers:{},url:d,rawRequest:l},l.getAllResponseHeaders&&(r.headers=MM(l.getAllResponseHeaders()))):i=new Error("Internal XMLHttpRequest Error"),n(i,r,r.body)}}var s,c,l=e.xhr||null;l||(l=e.cors||e.useXDR?new i.XDomainRequest:new i.XMLHttpRequest);var f,d=e.uri||e.url,p=e.method||"GET",h=e.body||e.data,v=e.headers||{},g=!!e.sync,y=!1,m={body:void 0,headers:{},statusCode:0,method:p,url:d,rawRequest:l};if("json"in e&&!1!==e.json&&(y=!0,v.accept||v.Accept||(v.Accept="application/json"),"GET"!==p&&"HEAD"!==p&&(v["content-type"]||v["Content-Type"]||(v["Content-Type"]="application/json"),h=(0,r.default)(!0===e.json?h:e.json))),l.onreadystatechange=function(){4===l.readyState&&setTimeout(u,0)},l.onload=u,l.onerror=a,l.onprogress=function(){},l.onabort=function(){c=!0},l.ontimeout=a,l.open(p,d,!g,e.username,e.password),g||(l.withCredentials=!!e.withCredentials),!g&&e.timeout>0&&(f=setTimeout(function(){if(!c){c=!0,l.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",a(e)}},e.timeout)),l.setRequestHeader)for(s in v)v.hasOwnProperty(s)&&l.setRequestHeader(s,v[s]);else if(e.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(l.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(l),l.send(h||null),l}e.exports=i,i.XMLHttpRequest=dC.XMLHttpRequest||function(){},i.XDomainRequest="withCredentials"in new i.XMLHttpRequest?i.XMLHttpRequest:dC.XDomainRequest,function(e,t){for(var r=0;r<e.length;r+=1)t(e[r])}(["get","put","post","patch","head","delete"],function(e){i["delete"===e?"del":e]=function(t,r,i){return(r=n(t,r,i)).method=e.toUpperCase(),o(r)}})});t(RM);var AM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=d(o_),n=d(cc),i=d(yO),o=d(YE),a=d(bf),u=d(EO),s=d(vp),c=d(cS);t.default=function(e){return new a.default(function(t){var a=(0,u.default)(e,"method","uri","withCredentials","headers","timeout","responseType");a.response=!0,function(e,t){e.method&&["PATCH","POST","PUT"].includes(e.method.toUpperCase())&&(e.xhr=new XMLHttpRequest,e.xhr.upload.onprogress=t.upload.emit.bind(t.upload,"progress"))}(a,e),function(e,t){if(t.auth)if(t.auth.bearer)e.headers.authorization="Bearer "+t.auth.bearer;else{var r=t.auth.user||t.auth.username,n=t.auth.pass||t.auth.password,i=btoa(r+":"+n);e.headers.authorization="Basic "+i}}(a,e),function(e,t){t.jar&&(e.withCredentials=!0)}(a,e),function(e,t){var r={cors:!0,withCredentials:!1,timeout:0};(0,c.default)(e,(0,u.default)(t,(0,o.default)(r)),r)}(a,e),function(e,t){"buffer"===t.responseType&&(e.responseType="arraybuffer")}(a,e),function(e,t){(t.body instanceof Blob||t.body instanceof ArrayBuffer)&&(t.json=e.json=!1,e.headers["content-type"]=e.headers["content-type"]||(0,VO.detectSync)(t.body))}(a,e),function(e,t){"json"in t&&!0!==t.json||!t.body?t.form?(e.headers["Content-Type"]="application/x-www-form-urlencoded",e.body=l.default.stringify(t.form),(0,n.default)(e,"json")):t.formData?e.body=(0,o.default)(t.formData).reduce(function(e,r){var n=t.formData[r];return function e(t,r,n){if((0,s.default)(n)){var o=!0,a=!1,u=void 0;try{for(var c,l=(0,i.default)(n);!(o=(c=l.next()).done);o=!0){var f=c.value;e(t,r,f)}}catch(e){a=!0,u=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw u}}return}n=function(e){if(e instanceof ArrayBuffer){var t=e.type?new Blob([e],{type:e.type}):new Blob([e]);return t.filename=e.filename||e.name||"untitled",t}return e}(n);n.name?(n.filename=n.name,t.append(r,n,n.name)):t.append(r,n)}(e,r,n),e},new FormData):(e.body=t.body,(0,n.default)(e,"json")):e.json=t.body}(a,e),function(e,t){t.qs&&(e.uri+="?"+l.default.stringify(t.qs))}(a,e);var d=(0,f.default)(a,function(n,i){n&&e.logger.warn(n),i?(i.options=e,function(e,t){if(!t.json&&"object"!==(0,r.default)(e.body))try{e.body=JSON.parse(e.body)}catch(e){}}(i,a),t(i)):t({statusCode:0,options:e,headers:e.headers,method:e.method,url:e.uri,body:n})});d.onprogress=e.download.emit.bind(e.download,"progress")}).catch(function(t){return{statusCode:0,options:e,headers:e.headers,method:e.method,url:e.uri,body:t}})};var l=d(fC),f=d(RM);function d(e){return e&&e.__esModule?e:{default:e}}});t(AM);var IM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(bf);t.default=function(e){e.url&&(e.uri=e.url,e.url=null);e.headers=e.headers||{},$E.inBrowser||e.headers["user-agent"]||(e.headers["user-agent"]="@ciscospark/http-core");return e.download=new fS.EventEmitter,e.upload=new fS.EventEmitter,t(e.interceptors,"Request").then(function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];return n.default.apply(void 0,[e].concat(r))}).then(function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return t.apply(void 0,[e.interceptors.slice().reverse(),"Response"].concat(n))});function t(t,n,i){var o="on"+n,a="on"+n+"Error";return t.reduce(function(t,n){return t.then(function(t){return n[o]?n[o](e,t):r.default.resolve(t)},function(t){return n[a]?n[a](e,t):r.default.reject(t)})},r.default.resolve(i))}};var n=i(AM);function i(e){return e&&e.__esModule?e:{default:e}}});t(IM);var DM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.detectSync=t.detect=t.HttpStatusInterceptor=t.HttpError=t.Interceptor=t.ProgressEvent=t.request=t.defaults=void 0;var r=f(cc),n=f(TO),i=f(CO),o=f(hP),a=f(cS),u=f(eO),s=f(nP);Object.defineProperty(t,"ProgressEvent",{enumerable:!0,get:function(){return f(AO).default}}),Object.defineProperty(t,"Interceptor",{enumerable:!0,get:function(){return f(IO).default}}),Object.defineProperty(t,"HttpError",{enumerable:!0,get:function(){return f(qO).default}}),Object.defineProperty(t,"HttpStatusInterceptor",{enumerable:!0,get:function(){return f(BO).default}}),Object.defineProperty(t,"detect",{enumerable:!0,get:function(){return VO.detect}}),Object.defineProperty(t,"detectSync",{enumerable:!0,get:function(){return VO.detectSync}});var c=f(BO),l=f(IM);function f(e){return e&&e.__esModule?e:{default:e}}var d=(0,u.default)(function(e,t){if((0,o.default)(t)){var u=t;(t=arguments[2]||{}).uri=u}return["download","interceptors","logger","upload"].forEach(function(e){var r=(0,i.default)(t,e);r=(0,s.default)({},r,{enumerable:!1,writable:!0}),(0,n.default)(t,e,r)}),(0,a.default)(t,e),t.json||(0,r.default)(t,"json"),t.logger=t.logger||console,(0,l.default)(t)}),p={json:!0,interceptors:[c.default.create()]};t.defaults=d,t.request=d(p)});t(DM);DM.detectSync,DM.detect,DM.HttpStatusInterceptor,DM.HttpError,DM.Interceptor,DM.ProgressEvent,DM.request,DM.defaults;var LM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(TO),n=c(Cf),i=c(rk),o=c(Wm),a=c($m),u=c(nk),s=c(ik);function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return(0,o.default)(this,t),(0,u.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,a.default)(t,[{key:"parse",value:function(e){var t=(0,n.default)(DM.HttpError.prototype.parse,this,[e]);return(0,r.default)(this,"options",{enumerable:!1,value:e.options}),this.options.url?t+="\n"+this.options.method+" "+this.options.url:this.options.uri?t+="\n"+this.options.method+" "+this.options.uri:t+="\n"+this.options.method+" "+this.options.service.toUpperCase()+"/"+this.options.resource,t+="\nWEBEX_TRACKING_ID: "+this.options.headers.trackingid,this.options.headers&&this.options.headers["x-trans-id"]&&(t+="\nX-Trans-Id: "+this.options.headers["x-trans-id"]),this.headers["retry-after"]&&((0,r.default)(this,"retryAfter",{enumerable:!0,value:this.headers["retry-after"],writeable:!1}),t+="\nRETRY-AFTER: "+this.retryAfter),t+="\n"}}]),t}(DM.HttpError);t.default=l,DM.HttpError.makeSubTypes(l);var f=function(e){function t(){return(0,o.default)(this,t),(0,u.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),t}(DM.HttpError.BadRequest);DM.HttpError[429]=f,DM.HttpError.TooManyRequests=f});t(LM);var FM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=d(ac),i=d(mO),o=d(Cf),a=d(Ef),u=d(bf),s=d(EO),c=d(LM),l=d(uO),f=d(fO);function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}function h(e){if(400!==e.statusCode)return u.default.reject(e);var t=f.default.select(e.body.error);return t===fO.OAuthError&&e instanceof c.default?u.default.reject(e):t?u.default.reject(new t(e._res||e)):u.default.reject(e)}var v=l.default.extend((p(r={derived:{canAuthorize:{deps:["access_token","isExpired"],fn:function(){return!!this.access_token&&!this.isExpired}},canDownscope:{deps:["canAuthorize"],fn:function(){return this.canAuthorize&&!!this.config.client_id}},canRefresh:{deps:["refresh_token"],fn:function(){return $E.inBrowser?!!this.refresh_token&&!!this.config.refreshCallback:!!this.refresh_token&&!!this.config.client_secret}},isExpired:{deps:["expires","_isExpired"],fn:function(){return!!this.expires&&this._isExpired}},_string:{deps:["access_token","token_type"],fn:function(){return this.access_token&&this.token_type?this.token_type+" "+this.access_token:""}}},namespace:"Credentials",props:{scope:"string",access_token:"string",expires:"number",expires_in:"number",refresh_token:"string",refresh_token_expires:"number",refresh_token_expires_in:"number",token_type:{default:"Bearer",type:"string"}},session:{_isExpired:{default:!1,type:"boolean"},previousToken:{type:"state"}},downscope:function(e){var t=this;return this.logger.info("token: downscoping token to "+e),this.isExpired?(this.logger.info("token: request received to downscope expired access_token"),u.default.reject(new Error("cannot downscope expired access token"))):this.canDownscope?(e&&(e=(0,dO.sortScope)(e)),e===(0,dO.sortScope)(this.config.scope)?u.default.reject(new Error("token: scope reduction requires a reduced scope")):this.spark.request({method:"POST",uri:this.config.tokenUrl,addAuthHeader:!1,form:{grant_type:"urn:cisco:oauth:grant-type:scope-reduction",token:this.access_token,scope:e,client_id:this.config.client_id}}).then(function(r){return t.logger.info("token: downscoped token to "+e),new v((0,a.default)(r.body,{scope:e}),{parent:t.parent})})):(this.config.client_id?this.logger.info("token: request received to downscope invalid access_token"):this.logger.warn("token: cannot downscope without client_id"),u.default.reject(new Error("cannot downscope access token")))},initialize:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,o.default)(l.default.prototype.initialize,this,[t,r]),"string"==typeof t&&(this.access_token=t),!this.access_token)throw new Error("`access_token` is required");this.expires&&(this.expires<Date.now()?this._isExpired=!0:(0,ZE.safeSetTimeout)(function(){e._isExpired=!0},this.expires-Date.now()))},refresh:function(){var e=this;if(!this.canRefresh)throw new Error("Not enough information available to refresh this access token");var t=void 0;if($E.inBrowser){if(!this.config.refreshCallback)throw new Error("Cannot refresh access token without refreshCallback");t=u.default.resolve(this.config.refreshCallback(this.spark,this))}return(t||this.spark.request({method:"POST",uri:this.config.tokenUrl,form:{grant_type:"refresh_token",redirect_uri:this.config.redirect_uri,refresh_token:this.refresh_token},auth:{user:this.config.client_id,pass:this.config.client_secret,sendImmediately:!0},shouldRefreshAccessToken:!1}).then(function(e){return e.body})).then(function(t){if(!t)throw new Error("token: refreshCallback() did not produce an object");return t.refresh_token||(0,a.default)(t,(0,s.default)(e,"refresh_token","refresh_token_expires","refresh_token_expires_in")),e.access_token===t.access_token?(e.logger.error("token: new token matches current token"),e.logger.error("token: current token:",e.access_token),e.logger.error("token: new token:",t.access_token),u.default.reject(new Error("new token matches current token"))):(e.previousToken&&(e.previousToken.revoke(),e.unset("previousToken")),t.previousToken=e,t.scope=e.scope,new v(t,{parent:e.parent}))}).catch(h)},revoke:function(){var e=this;return this.isExpired?(this.logger.info("token: already expired, not making making revocation request"),u.default.resolve()):this.canAuthorize?this.config.client_secret?(this.logger.info("token: revoking access token"),this.spark.request({method:"POST",uri:this.config.revokeUrl,form:{token:this.access_token,token_type_hint:"access_token"},auth:{user:this.config.client_id,pass:this.config.client_secret,sendImmediately:!0},shouldRefreshAccessToken:!1}).then(function(){e.unset(["access_token","expires","expires_in","token_type"]),e.logger.info("token: access token revoked")}).catch(h)):(this.logger.info("token: no client secret available, not making revocation request"),u.default.resolve()):(this.logger.info("token: no longer valid, not making revocation request"),u.default.resolve())},set:function(){var e=this._filterSetParameters.apply(this,arguments),t=(0,i.default)(e,2),r=t[0],n=t[1];if(!r.token_type&&r.access_token&&r.access_token.includes(" ")){var u=r.access_token.split(" "),s=(0,i.default)(u,2),c=s[0],f=s[1];r=(0,a.default)({},r,{access_token:f,token_type:c})}var d=Date.now();return!r.expires&&r.expires_in&&(r.expires=d+1e3*r.expires_in),!r.refresh_token_expires&&r.refresh_token_expires_in&&(r.refresh_token_expires=d+1e3*r.refresh_token_expires_in),r.scope&&(r.scope=(0,dO.sortScope)(r.scope)),(0,o.default)(l.default.prototype.set,this,[r,n])},toString:function(){if(!this._string)throw new Error("cannot stringify Token");return this._string},validate:function(){var e=this;return this.spark.request({method:"POST",service:"conversation",resource:"users/validateAuthToken",body:{token:this.access_token}}).catch(function(t){if("statusCode"in t)return u.default.reject(t);e.logger.info("REMINDER: If you're investigating a network error here, it's normal");return e.spark.request({method:"POST",uri:"https://conv-a.wbx2.com/conversation/api/v1/users/validateAuthToken",body:{token:e.access_token},headers:{authorization:"Bearer "+e.access_token}})}).then(function(e){return e.body})},version:"1.50.12"},"downscope",[(0,$E.oneFlight)({keyFactory:function(e){return e}})],(0,n.default)(r,"downscope"),r),p(r,"refresh",[$E.oneFlight],(0,n.default)(r,"refresh"),r),p(r,"revoke",[$E.oneFlight],(0,n.default)(r,"revoke"),r),r));t.default=v});t(FM);var NM=function(e){var t,r=this,n=[].slice.call(arguments);t=e&&e.hasOwnProperty("constructor")?e.constructor:function(){return r.apply(this,arguments)},nP(t,r);var i=function(){this.constructor=t};return i.prototype=r.prototype,t.prototype=new i,e&&(n.unshift(t.prototype),nP.apply(null,n)),t.__super__=r.prototype,t},UM=v_(function(e,t,r){var n=1;if(r.length){var i=pw(r,cw(UM));n|=32}return Zw(e,n,t,r,i)});UM.placeholder={};var zM=UM,qM=[].slice;function BM(e,t){if(t||(t={}),t.model&&(this.model=t.model),t.comparator&&(this.comparator=t.comparator),t.parent&&(this.parent=t.parent),!this.mainIndex){var r=this.model&&this.model.prototype&&this.model.prototype.idAttribute;this.mainIndex=r||"id"}this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,nP({silent:!0},t))}nP(BM.prototype,jT,{initialize:function(){},isModel:function(e){return this.model&&e instanceof this.model},add:function(e,t){return this.set(e,nP({merge:!1,add:!0,remove:!1},t))},parse:function(e,t){return e},serialize:function(){return this.map(function(e){if(e.serialize)return e.serialize();var t={};return nP(t,e),delete t.collection,t})},toJSON:function(){return this.serialize()},set:function(e,t){(t=nP({add:!0,remove:!0,merge:!0},t)).parse&&(e=this.parse(e,t));var r,n,i,o,a,u,s,c=!vp(e);e=c?e?[e]:[]:e.slice();var l=t.at,f=this.comparator&&null==l&&!1!==t.sort,d="string"==typeof this.comparator?this.comparator:null,p=[],h=[],v={},g=t.add,y=t.merge,m=t.remove,b=!(f||!g||!m)&&[],_=this.model&&this.model.prototype||Object.prototype;for(u=0,s=e.length;u<s;u++){if(i=e[u]||{},this.isModel(i)?r=n=i:_.generateId?r=_.generateId(i):void 0===(r=i[this.mainIndex])&&this._isDerivedIndex(_)&&(r=_._derived[this.mainIndex].fn.call(i)),o=this.get(r))m&&(v[o.cid||o[this.mainIndex]]=!0),y&&(i=i===n?n.attributes:i,t.parse&&(i=o.parse(i,t)),o.set?(o.set(i,t),f&&!a&&o.hasChanged(d)&&(a=!0)):nP(o,i)),e[u]=o;else if(g){if(!(n=e[u]=this._prepareModel(i,t)))continue;p.push(n),this._addReference(n,t)}(n=o||n)&&(b&&(n.isNew&&n.isNew()||!n[this.mainIndex]||!v[n.cid||n[this.mainIndex]])&&b.push(n),v[n[this.mainIndex]]=!0)}if(m){for(u=0,s=this.length;u<s;u++)v[(n=this.models[u]).cid||n[this.mainIndex]]||h.push(n);for(h.length&&this.remove(h,t),u=0,s=p.length;u<s;u++)this._index(p[u])}if(p.length||b&&b.length)if(f&&(a=!0),null!=l)for(u=0,s=p.length;u<s;u++)this.models.splice(l+u,0,p[u]);else{var w=b||p;for(u=0,s=w.length;u<s;u++)this.models.push(w[u])}if(a&&this.sort({silent:!0}),!t.silent){for(u=0,s=p.length;u<s;u++)(n=p[u]).trigger?n.trigger("add",n,this,t):this.trigger("add",n,this,t);(a||b&&b.length)&&this.trigger("sort",this,t)}return c?e[0]:e},get:function(e,t){if(null!=e){var r=this.mainIndex,n=this._indexes[t||r];return n&&(n[e]||void 0!==e[r]&&n[e[r]])||this._indexes.cid[e]||this._indexes.cid[e.cid]}},at:function(e){return this.models[e]},remove:function(e,t){var r,n,i,o,a=!vp(e);for(t||(t={}),r=0,n=(e=a?[e]:qM.call(e)).length;r<n;r++)(i=e[r]=this.get(e[r]))&&(this._deIndex(i),o=this.models.indexOf(i),this.models.splice(o,1),t.silent||(t.index=o,i.trigger?i.trigger("remove",i,this,t):this.trigger("remove",i,this,t)),this._removeReference(i,t));return a?e[0]:e},reset:function(e,t){t||(t={});for(var r=0,n=this.models.length;r<n;r++)this._removeReference(this.models[r],t);return t.previousModels=this.models,this._reset(),e=this.add(e,nP({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},sort:function(e){var t=this;if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),"string"==typeof this.comparator?this.models.sort(function(e,r){return e.get?(e=e.get(t.comparator),r=r.get(t.comparator)):(e=e[t.comparator],r=r[t.comparator]),e>r||void 0===e?1:e<r||void 0===r?-1:0}):1===this.comparator.length?this.models.sort(function(e,r){return(e=t.comparator(e))>(r=t.comparator(r))||void 0===e?1:e<r||void 0===r?-1:0}):this.models.sort(zM(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},_reset:function(){var e=qM.call(this.indexes||[]),t=0;e.push(this.mainIndex),e.push("cid");var r=e.length;for(this.models=[],this._indexes={};t<r;t++)this._indexes[e[t]]={}},_prepareModel:function(e,t){if(!this.model)return e;if(this.isModel(e))return e.collection||(e.collection=this),e;(t=t?nP({},t):{}).collection=this;var r=new this.model(e,t);return r.validationError?(this.trigger("invalid",this,r.validationError,t),!1):r},_deIndex:function(e,t,r){var n;if(void 0===t)for(var i in this._indexes)n=e.hasOwnProperty(i)?e[i]:e.get&&e.get(i),delete this._indexes[i][n];else{if(void 0===this._indexes[t])throw new Error("Given attribute is not an index");delete this._indexes[t][r]}},_index:function(e,t){var r;if(void 0===t)for(var n in this._indexes)null!=(r=e.hasOwnProperty(n)?e[n]:e.get&&e.get(n))&&(this._indexes[n][r]=e);else{if(void 0===this._indexes[t])throw new Error("Given attribute is not an index");(r=e[t]||e.get&&e.get(t))&&(this._indexes[t][r]=e)}},_isDerivedIndex:function(e){return!(!e||"object"!=typeof e._derived)&&Object.keys(e._derived).indexOf(this.mainIndex)>=0},_addReference:function(e,t){this._index(e),e.collection||(e.collection=this),e.on&&e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){this===e.collection&&delete e.collection,this._deIndex(e),e.off&&e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,r,n){var i=e.split(":")[0],o=e.split(":")[1];("add"!==i&&"remove"!==i||r===this)&&("destroy"===i&&this.remove(t,n),t&&"change"===i&&o&&this._indexes[o]&&(this._deIndex(t,o,t.previousAttributes()[o]),this._index(t,o)),this.trigger.apply(this,arguments))}}),Object.defineProperties(BM.prototype,{length:{get:function(){return this.models.length}},isCollection:{get:function(){return!0}}});["indexOf","lastIndexOf","every","some","forEach","map","filter","reduce","reduceRight"].forEach(function(e){BM.prototype[e]=function(){return this.models[e].apply(this.models,arguments)}}),BM.prototype.each=BM.prototype.forEach,BM.extend=NM;var WM=BM,VM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(WM),n=i(FM);function i(e){return e&&e.__esModule?e:{default:e}}var o=r.default.extend({mainIndex:"scope",model:n.default,namespace:"Credentials"});t.default=o});t(VM);var GM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n,i,o,a,u,s,c=T(ac),l=T(bf),f=T(Cf),d=T(YE),p=T(Ef),h=T(jf),v=T(cc),g=T(pg),y=T(sd),m=T(gg),b=T(XE),_=T(Eg),w=T(mm),S=T(uO),k=T(fO),E=T(FM),P=T(VM);function T(e){return e&&e.__esModule?e:{default:e}}function O(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var C=S.default.extend((r=(0,$E.oneFlight)({keyFactory:function(e){return e}}),n=(0,rO.waitForValue)("@"),i=(0,rO.persist)("@"),o=(0,rO.waitForValue)("@"),a=(0,$E.whileInFlight)("isRefreshing"),u=(0,rO.waitForValue)("@"),O(s={collections:{userTokens:P.default},dataTypes:{token:(0,$E.makeStateDataType)(E.default,"token").dataType},derived:{canAuthorize:{deps:["supertoken","supertoken.canAuthorize","canRefresh"],fn:function(){return Boolean(this.supertoken&&this.supertoken.canAuthorize||this.canRefresh)}},canRefresh:{deps:["supertoken","supertoken.canRefresh"],fn:function(){return!!this.config.jwtRefreshCallback||Boolean(this.supertoken&&this.supertoken.canRefresh)}}},props:{supertoken:(0,$E.makeStateDataType)(E.default,"token").prop},namespace:"Credentials",session:{isRefreshing:{default:!1,type:"boolean"},ready:{default:!1,type:"boolean"},refreshTimer:{default:void 0,type:"any"}},buildLoginUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clientType:"public"};if(e.state&&!(0,y.default)(e.state))throw new Error("if specified, `options.state` must be an object");return e.client_id=this.config.client_id,e.redirect_uri=this.config.redirect_uri,e.scope=this.config.scope,(e=(0,m.default)(e)).response_type||(e.response_type="public"===e.clientType?"token":"code"),(0,v.default)(e,"clientType"),e.state&&((0,g.default)(e.state)?delete e.state:e.state=$E.base64.toBase64Url((0,h.default)(e.state))),this.config.authorizeUrl+"?"+_.default.stringify(e)},buildLogoutUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.config.logoutUrl+"?"+_.default.stringify((0,p.default)({cisService:this.config.service,goto:this.config.redirect_uri},e))},calcRefreshTimeout:function(e){return Math.floor((Math.floor(4*Math.random())+6)/10*e)},constructor:function(){var e=this;this._dataTypes=(0,m.default)(this._dataTypes),(0,d.default)(this._dataTypes).forEach(function(t){e._dataTypes[t].set&&(e._dataTypes[t].set=e._dataTypes[t].set.bind(e))});for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];(0,f.default)(S.default,this,r)},downscope:function(e){var t=this;return this.supertoken.downscope(e).catch(function(r){return t.logger.error("credentials: failed to downscope supertoken to "+e,r),t.logger.error("credentials: falling back to supertoken for "+e),l.default.resolve(new E.default((0,p.default)({scope:e},t.supertoken.serialize())),{parent:t})})},getClientToken:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.logger.info("credentials: requesting client credentials grant"),(t=t||{}).scope=t.scope||"webexsquare:admin",this.spark.request({method:"POST",uri:this.config.tokenUrl,form:{grant_type:"client_credentials",scope:t.scope,self_contained_token:!0},auth:{user:this.config.client_id,pass:this.config.client_secret,sendImmediately:!0},shouldRefreshAccessToken:!1}).then(function(t){return new E.default(t.body,{parent:e})}).catch(function(e){if(400!==e.statusCode)return l.default.reject(e);var t=k.default.select(e.body.error);return l.default.reject(new t(e._res||e))})},getUserToken:function(e){var t=this;return l.default.resolve(!this.isRefreshing||new l.default(function(e){t.logger.info("credentials: token refresh inflight; delaying getUserToken until refresh completes"),t.once("change:isRefreshing",function(){t.logger.info("credentials: token refresh complete; reinvoking getUserToken"),e()})})).then(function(){if(!t.canAuthorize)return t.logger.info("credentials: cannot produce an access token from current state"),l.default.reject(new Error("Current state cannot produce an access token"));if(e||(e=(0,dO.filterScope)("spark:kms",t.config.scope)),(e=(0,dO.sortScope)(e))===(0,dO.sortScope)(t.config.scope))return l.default.resolve(t.supertoken);var r=t.userTokens.get(e);return r&&r.access_token?l.default.resolve(r):t.downscope(e).then((0,$E.tap)(function(e){return t.userTokens.add(e)}))})},initialize:function(e,t){var r=this;e&&("string"==typeof e&&(this.supertoken=e),e.access_token&&(this.supertoken=e),e.authorization&&(e.authorization.supertoken?this.supertoken=e.authorization.supertoken:this.supertoken=e.authorization),this.supertoken&&this.supertoken.expires&&this.scheduleRefresh(this.supertoken.expires)),(0,f.default)(S.default.prototype.initialize,this,[e,t]),this.listenToOnce(this.parent,"change:config",function(){if(r.config.authorizationString){var e=w.default.parse(r.config.authorizationString,!0);r.config.client_id=e.query.client_id,r.config.redirect_uri=e.query.redirect_uri,r.config.scope=e.query.scope,r.config.authorizeUrl=e.href.substr(0,e.href.indexOf("?"))}}),this.spark.once("loaded",function(){r.ready=!0})},invalidate:function(){this.logger.info("credentials: invalidating tokens"),this.refreshTimer&&(clearTimeout(this.refreshTimer),this.unset("refreshTimer"));try{this.unset("supertoken")}catch(e){this.logger.warn("credentials: failed to clear supertoken",e)}for(;this.userTokens.models.length;)try{this.userTokens.remove(this.userTokens.models[0])}catch(e){this.logger.warn("credentials: failed to remove user token",e)}return this.logger.info("credentials: finished removing tokens"),l.default.resolve()},refresh:function(){var e=this;this.logger.info("credentials: refresh requested");var t=this.supertoken,r=(0,b.default)(this.userTokens.models);return this.config.jwtRefreshCallback?this.config.jwtRefreshCallback(this.spark).then(function(t){return e.spark.authorization.requestAccessTokenFromJwt({jwt:t})}):t.refresh().then(function(t){return e.refreshTimer&&(clearTimeout(e.refreshTimer),e.unset("refreshTimer")),e.supertoken=t,l.default.all(r.map(function(t){return e.downscope(t.scope).then(function(r){return e.logger.info("credentials: revoking token for "+t.scope),t.revoke().catch(function(t){e.logger.warn("credentials: failed to revoke user token",t)}).then(function(){e.userTokens.remove(t.scope),e.userTokens.add(r)})})}))}).then(function(){e.scheduleRefresh(e.supertoken.expires)}).catch(function(t){if(t instanceof k.default.InvalidRequestError){for(e.unset("supertoken");e.userTokens.models.length;)try{e.userTokens.remove(e.userTokens.models[0])}catch(t){e.logger.warn("credentials: failed to remove user token",t)}e.spark.trigger("client:InvalidRequestError")}return l.default.reject(t)})},scheduleRefresh:function(e){var t=this,r=e-Date.now();if(r>0){var n=this.calcRefreshTimeout(r);this.refreshTimer=(0,ZE.safeSetTimeout)(function(){return t.refresh()},n)}else this.refresh()},version:"1.50.12"},"getUserToken",[r,n],(0,c.default)(s,"getUserToken"),s),O(s,"initialize",[i],(0,c.default)(s,"initialize"),s),O(s,"invalidate",[$E.oneFlight,o],(0,c.default)(s,"invalidate"),s),O(s,"refresh",[$E.oneFlight,a,u],(0,c.default)(s,"refresh"),s),s));t.default=C});t(GM);var HM=function(e,t){return null==e||Nv(e,t)};var $M=function(e,t,r){return null==e?e:bO(e,t,r)};var JM=function(e,t,r){(void 0===r||If(e[t],r))&&(void 0!==r||t in e)||np(e,t,r)};var YM=function(e,t){if("__proto__"!=t)return e[t]};var KM=function(e){return ap(e,Wp(e))};var XM=function(e,t,r,n,i,o,a){var u=YM(e,r),s=YM(t,r),c=a.get(s);if(c)JM(e,r,c);else{var l=o?o(u,s,r+"",e,t,a):void 0,f=void 0===l;if(f){var d=vp(s),p=!d&&yp(s),h=!d&&!p&&Cp(s);l=s,d||p||h?vp(u)?l=u:yT(u)?l=Hp(u):p?(f=!1,l=Gp(s,!0)):h?(f=!1,l=Oh(s,!0)):l=[]:Gv(s)||hp(s)?(l=u,hp(u)?l=KM(u):sd(u)&&!hd(u)||(l=Kh(s))):f=!1}f&&(a.set(s,l),i(l,s,n,o,a),a.delete(s)),JM(e,r,l)}};var ZM=function e(t,r,n,i,o){t!==r&&lP(r,function(a,u){if(sd(a))o||(o=new ep),XM(t,r,u,n,e,i,o);else{var s=i?i(YM(t,u),a,u+"",t,r,o):void 0;void 0===s&&(s=a),JM(t,u,s)}},Wp)},QM=tP(function(e,t,r){ZM(e,t,r)});for(var ex=function(e,t,r){var n=null==e?void 0:Dv(e,t);return void 0===n?r:n},tx=r(function(e){var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var r=new Uint8Array(16);e.exports=function(){return t(r),r}}else{var n=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n}}}),rx=[],nx=0;nx<256;++nx)rx[nx]=(nx+256).toString(16).substr(1);var ix,ox,ax=function(e,t){var r=t||0,n=rx;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join("")},ux=0,sx=0;var cx=function(e,t,r){var n=t&&r||0,i=t||[],o=(e=e||{}).node||ix,a=void 0!==e.clockseq?e.clockseq:ox;if(null==o||null==a){var u=tx();null==o&&(o=ix=[1|u[0],u[1],u[2],u[3],u[4],u[5]]),null==a&&(a=ox=16383&(u[6]<<8|u[7]))}var s=void 0!==e.msecs?e.msecs:(new Date).getTime(),c=void 0!==e.nsecs?e.nsecs:sx+1,l=s-ux+(c-sx)/1e4;if(l<0&&void 0===e.clockseq&&(a=a+1&16383),(l<0||s>ux)&&void 0===e.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");ux=s,sx=c,ox=a;var f=(1e4*(268435455&(s+=122192928e5))+c)%4294967296;i[n++]=f>>>24&255,i[n++]=f>>>16&255,i[n++]=f>>>8&255,i[n++]=255&f;var d=s/4294967296*1e4&268435455;i[n++]=d>>>8&255,i[n++]=255&d,i[n++]=d>>>24&15|16,i[n++]=d>>>16&255,i[n++]=a>>>8|128,i[n++]=255&a;for(var p=0;p<6;++p)i[n+p]=o[p];return t||ax(i)};var lx=function(e,t,r){var n=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||tx)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var o=0;o<16;++o)t[n+o]=i[o];return t||ax(i)},fx=lx;fx.v1=cx,fx.v4=lx;var dx=fx,px=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(bf),n=c(cc),i=c(rk),o=c(Wm),a=c($m),u=c(nk),s=c(ik);function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return(0,o.default)(this,t),(0,u.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,a.default)(t,[{key:"onRequest",value:function(e){var t=this;return e.headers=e.headers||{},"authorization"in e.headers||"auth"in e?(e.headers.authorization||(0,n.default)(e.headers,"authorization"),r.default.resolve(e)):this.requiresCredentials(e).then(function(r){return r?t.spark.credentials.getUserToken().then(function(t){return e.headers.authorization=t.toString(),e}):e})}},{key:"requiresCredentials",value:function(e){var t=this;return e.uri&&(e.uri.includes(this.spark.config.device.preDiscoveryServices.hydra)||e.uri.includes(this.spark.config.device.preDiscoveryServices.hydraServiceUrl))?r.default.resolve(!0):this.spark.internal.device?this.spark.internal.device.isSpecificService("hydra",e.uri).then(function(n){return!!n||(e.service?t.spark.internal.device.isService(e.service):!!e.uri&&t.spark.internal.device.isServiceUrl(e.uri).then(function(n){if(n)return!0;if((void 0===e.addAuthHeader&&t.spark.config.device.validateDomains&&(e.addAuthHeader=!0),e.addAuthHeader)&&t.spark.config.device.whitelistedServiceDomains.filter(function(t){return e.uri.includes(t)}).length)return r.default.resolve(!0);return!1}))}):r.default.resolve(!1)}},{key:"onResponseError",value:function(e,t){var i=this;return this.shouldAttemptReauth(t,e).then(function(o){return o&&(i.spark.logger.info("auth: received 401, attempting to reauthenticate"),t.options.headers&&(0,n.default)(t.options.headers,"authorization"),i.spark.credentials.canRefresh)?i.spark.credentials.refresh().then(function(){return i.replay(e)}):r.default.reject(t)})}},{key:"replay",value:function(e){return e.replayCount?e.replayCount+=1:e.replayCount=1,e.replayCount>this.spark.config.maxAuthenticationReplays?(this.spark.logger.error("auth: failed after "+this.spark.config.maxAuthenticationReplays+" replay attempts"),r.default.reject(new Error("Failed after "+this.spark.config.maxAuthenticationReplays+" replay attempts"))):(this.spark.logger.info("auth: replaying request "+e.replayCount+" time"),this.spark.request(e))}},{key:"shouldAttemptReauth",value:function(e,t){return t&&!1===t.shouldRefreshAccessToken?r.default.resolve(!1):401===e.statusCode?r.default.resolve(!0):r.default.resolve(!1)}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(DM.Interceptor);t.default=l});t(px);var hx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(bf),n=s(rk),i=s(Wm),o=s($m),a=s(nk),u=s(ik);function s(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,o.default)(t,[{key:"onRequest",value:function(e){return e.$timings=e.$timings||{},e.$timings.networkStart=Date.now(),e}},{key:"onResponse",value:function(e,t){return e.$timings.networkEnd=Date.now(),t}},{key:"onResponseError",value:function(e,t){return e.$timings.networkEnd=Date.now(),r.default.reject(t)}}],[{key:"create",value:function(e){return new t(this,e)}}]),t}(DM.Interceptor);t.default=c});t(hx);var vx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(bf),n=s(rk),i=s(Wm),o=s($m),a=s(nk),u=s(ik);function s(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,o.default)(t,[{key:"onRequest",value:function(e){return e.noTransform?e:this.spark.transform("outbound",e)}},{key:"onResponse",value:function(e,t){return this.spark.transform("inbound",t)}},{key:"onResponseError",value:function(e,t){return this.spark.transform("inbound",t).then(function(e){return r.default.reject(e||t)})}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(DM.Interceptor);t.default=c});t(vx);var gx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(bf),n=l(cc),i=l(rk),o=l(Wm),a=l($m),u=l(nk),s=l(ik),c=l(XE);function l(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){return(0,o.default)(this,t),(0,u.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,a.default)(t,[{key:"onRequest",value:function(e){return e.uri.includes(this.spark.config.credentials.samlUrl)||e.uri.includes(this.spark.config.credentials.tokenUrl)||e.uri.includes(this.spark.config.credentials.authorizeUrl)?e:"cisco-no-http-redirect"in e.headers?(e.headers["cisco-no-http-redirect"]||(0,n.default)(e.headers,"cisco-no-http-redirect"),e):(e.headers["cisco-no-http-redirect"]=!0,e.$redirectCount=e.$redirectCount||0,e)}},{key:"onResponse",value:function(e,t){if(t.headers&&t.headers["cisco-location"])return(e=(0,c.default)(e)).uri=t.headers["cisco-location"],e.$redirectCount+=1,e.$redirectCount>this.spark.config.maxAppLevelRedirects?r.default.reject(new Error("Maximum redirects exceeded")):this.spark.request(e);if(t.headers&&t.body&&2000002===t.body.errorCode&&t.body.location){if(e=(0,c.default)(e),t.options&&t.options.qs){var n=t.body.location.split("?");e.uri=n[0]}else e.uri=t.body.location;return e.$redirectCount+=1,e.$redirectCount>this.spark.config.maxLocusRedirects?r.default.reject(new Error("Maximum redirects exceeded")):this.spark.request(e)}return t}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(DM.Interceptor);t.default=f});t(gx);var yx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(bf),n=c(rk),i=c(Wm),o=c($m),a=c(nk),u=c(ik),s=c(ex);function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,o.default)(t,[{key:"onRequest",value:function(e){var t=(0,s.default)(this,"spark.logger",console);try{this.spark.trigger("request:start",e)}catch(e){t.warn("event handler for request:start failed ",e)}return r.default.resolve(e)}},{key:"onRequestError",value:function(e,t){var n=(0,s.default)(this,"spark.logger",console);try{this.spark.trigger("request:end",e,t),this.spark.trigger("request:failure",e,t)}catch(e){n.warn("event handler for request:end failed ",e)}return r.default.reject(t)}},{key:"onResponse",value:function(e,t){var n=(0,s.default)(this,"spark.logger",console);try{this.spark.trigger("request:success",t.options,t)}catch(e){n.warn("event handler for request:success failed ",e)}return r.default.resolve(t)}},{key:"onResponseError",value:function(e,t){var n=(0,s.default)(this,"spark.logger",console);try{this.spark.trigger("request:end",e,t),this.spark.trigger("request:failure",e,t)}catch(e){n.warn("event handler for request:failure failed ",e)}return r.default.reject(t)}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(DM.Interceptor);t.default=l});t(yx);var mx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(bf),n=l(rk),i=l(Wm),o=l($m),a=l(nk),u=l(ik),s=(l(cg),l(hP),l(vp),l(fT)),c=l(ex);l(ym);function l(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,o.default)(t,[{key:"onRequest",value:function(e){var t=(0,c.default)(this,"spark.logger",console);return t.info("/**********************************************************************\\ "),t.info("Request:",e.method||"GET",e.uri),t.info("WEBEX_TRACKINGID: ",(0,c.default)(e,"headers.trackingid")),(0,s.default)(e,"headers.x-trans-id")&&t.info("X-Trans-ID: ",(0,c.default)(e,"headers.x-trans-id")),(0,s.default)(this,"spark.internal.device.userId")&&t.info("User ID:",(0,c.default)(this,"spark.internal.device.userId")),r.default.resolve(e)}},{key:"onRequestError",value:function(e,t){this.onRequest(e);var n=(0,c.default)(this,"spark.logger",console);return n.error("Request Failed: ",t.stack),n.info("\\**********************************************************************/"),r.default.reject(t)}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(DM.Interceptor);t.default=f});t(mx);var bx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(bf),n=s(rk),i=s(Wm),o=s($m),a=s(nk),u=s(ik);function s(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,o.default)(t,[{key:"onRequest",value:function(e){return e.$timings=e.$timings||{},e.$timings.requestStart=Date.now(),e}},{key:"onRequestError",value:function(e){return e.$timings.requestEnd=e.$timings.requestFail=Date.now(),r.default.reject(e)}},{key:"onResponse",value:function(e,t){return e.$timings.requestEnd=Date.now(),r.default.resolve(t)}},{key:"onResponseError",value:function(e,t){return e.$timings.requestEnd=e.$timings.requestFail=Date.now(),r.default.reject(t)}}],[{key:"create",value:function(e){return new t(this,e)}}]),t}(DM.Interceptor);t.default=c});t(bx);var _x=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(bf),n=(c(o_),c(rk)),i=c(Wm),o=c($m),a=c(nk),u=c(ik),s=(c(cg),c(ex));c(ym);function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,o.default)(t,[{key:"onResponse",value:function(e,t){return this.printResponseHeader(e,t),(0,s.default)(this,"spark.logger",console).info("\\**********************************************************************/"),t}},{key:"onResponseError",value:function(e,t){return this.printResponseHeader(e,t),(0,s.default)(this,"spark.logger",console).info("\\**********************************************************************/"),r.default.reject(t)}},{key:"printResponseHeader",value:function(e,t){var r=(0,s.default)(this,"spark.logger",console);r.info("Status Code:",t.statusCode),r.info("WEBEX_TRACKINGID:",(0,s.default)(e,"headers.trackingid")||(0,s.default)(t,"headers.trackingid")),r.info("Network duration:",e.$timings.networkEnd-e.$timings.networkStart),r.info("Processing duration:",e.$timings.requestEnd-e.$timings.requestStart)}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(DM.Interceptor);t.default=l});t(_x);var wx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(cc),n=s(rk),i=s(Wm),o=s($m),a=s(nk),u=s(ik);function s(e){return e&&e.__esModule?e:{default:e}}var c=new(s(hb).default),l=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,o.default)(t,[{key:"onRequest",value:function(e){if(e.headers=e.headers||{},"trackingid"in e.headers)return e.headers.trackingid||(0,r.default)(e.headers,"trackingid"),e;if(this.requiresTrackingId(e)&&(e.headers.trackingid=this.spark.sessionId+"_"+this.sequence),e.headers.trackingid&&e.replayCount){var t=e.headers.trackingid.split("+");t[1]=e.replayCount,e.headers.trackingid=t.join("+")}return e}},{key:"requiresTrackingId",value:function(e){return!e.headers.trackingid}},{key:"sequence",get:function(){var e=c.get(this)||0;return e+=1,c.set(this,e),e}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(DM.Interceptor);t.default=l});t(wx);var Sx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(cc),n=l(rk),i=l(Wm),o=l($m),a=l(nk),u=l(ik),s=l(hb),c=l(ex);function l(e){return e&&e.__esModule?e:{default:e}}var f=new s.default,d=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.default)(this,t);var r=(0,c.default)(e,"spark.config.appName"),o=(0,c.default)(e,"spark.config.appVersion"),u=(0,c.default)(e,"spark.ciscospark",!1)?"ciscospark":"spark-js-sdk",s=(0,c.default)(e,"spark.version","development"),l=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return r&&o?f.set(l,r+"/"+o+" ("+($E.inBrowser?"web":"node")+") "+u+"/"+s):f.set(l,u+"/"+s+" ("+($E.inBrowser?"web":"node")+")"),l}return(0,u.default)(t,e),(0,o.default)(t,[{key:"onRequest",value:function(e){return e.headers=e.headers||{},e.uri&&(e.uri.includes(this.spark.config.credentials.samlUrl)||e.uri.includes(this.spark.config.credentials.tokenUrl)||e.uri.includes(this.spark.config.credentials.authorizeUrl))?e:"spark-user-agent"in e.headers?(e.headers["spark-user-agent"]||(0,r.default)(e.headers,"spark-user-agent"),e):(e.headers["spark-user-agent"]=f.get(this),e)}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(DM.Interceptor);t.default=d});t(Sx);var kx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(bf),n=c(p_),i=c(rk),o=c(Wm),a=c(nk),u=c($m),s=c(ik);function c(e){return e&&e.__esModule?e:{default:e}}var l=new(c(hb).default),f=/.*(idbroker|identity)(bts)?.webex.com\/([^\/]+)/,d=function(e){function t(){var e;(0,o.default)(this,t);for(var r=arguments.length,u=Array(r),s=0;s<r;s++)u[s]=arguments[s];var c=(0,a.default)(this,(e=t.__proto__||(0,i.default)(t)).call.apply(e,[this].concat(u)));return l.set(c,new n.default),c}return(0,s.default)(t,e),(0,u.default)(t,null,[{key:"create",value:function(){return new t({spark:this})}}]),(0,u.default)(t,[{key:"onRequest",value:function(e){return this.isRateLimited(e.uri)?r.default.reject(new Error("API rate limited "+e.uri)):r.default.resolve(e)}},{key:"onResponseError",value:function(e,t){return 429===t.statusCode&&(e.uri.includes("idbroker")||e.uri.includes("identity"))&&this.setRateLimitExpiry(e.uri,this.extractRetryAfterTime(e)),r.default.reject(t)}},{key:"extractRetryAfterTime",value:function(e){var t=e.headers["retry-after"]||null;return null===t||t<=0?6e4:t>3600?36e5:1e3*t}},{key:"setRateLimitExpiry",value:function(e,t){var r=this.getApiName(e);if(!r)return!1;var n=(new Date).getTime()+t;return l.get(this).set(r,n)}},{key:"getRateLimitStatus",value:function(e){var t=this.getApiName(e);if(!t)return!1;var r=(new Date).getTime(),n=l.get(this);return void 0!==n.get(t)&&r<n.get(t)}},{key:"getApiName",value:function(e){if(!e)return null;var t=e.match(f);return t?t[2]:null}},{key:"isRateLimited",value:function(e){return!(!e||!e.includes("idbroker")&&!e.includes("identity"))&&this.getRateLimitStatus(e)}}]),t}(DM.Interceptor);t.default=d});t(kx);var Ex=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=BT)&&r.__esModule?r:{default:r};var i=n.default.extend({props:{url:["string",!1,"https://idbroker.webex.com"],defaultUrl:["string",!1,"https://idbroker.webex.com"]}}),o=n.default.extend({props:{url:["string",!1,Ts.env.IDENTITY_BASE_URL],defaultUrl:["string",!1,Ts.env.IDENTITY_BASE_URL]}}),a=n.default.extend({extraProperties:"allow",children:{idbroker:i,identity:o},props:{authorizationString:["string",!1,Ts.env.AUTHORIZATION_STRING],client_id:["string",!1,Ts.env.CLIENT_ID],client_secret:["string",!1,Ts.env.CLIENT_SECRET],redirect_uri:["string",!1,Ts.env.REDIRECT_URI],scope:["string",!1,Ts.env.SCOPE],cisService:["string",!1,"spark"]},derived:{activationUrl:{deps:["idbroker.url"],fn:function(){return(this.idbroker.url||"https://idbroker.webex.com")+"/idb/token/v1/actions/UserActivation/invoke"}},authorizeUrl:{deps:["idbroker.url"],fn:function(){return this.idbroker.url+"/idb/oauth2/v1/authorize"}},tokenUrl:{deps:["idbroker.url"],fn:function(){return this.idbroker.url+"/idb/oauth2/v1/access_token"}},revokeUrl:{deps:["idbroker.url"],fn:function(){return this.idbroker.url+"/idb/oauth2/v1/revoke"}},logoutUrl:{deps:["idbroker.url"],fn:function(){return this.idbroker.url+"/idb/oauth2/v1/logout"}},setPasswordUrl:{deps:["identity.url"],fn:function(){return(this.identity.url||"https://identity.webex.com")+"/identity/scim/v1/Users"}}}});t.default=a});t(Ex);var Px=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=Ex)&&r.__esModule?r:{default:r};t.default={maxAppLevelRedirects:10,maxLocusRedirects:5,maxAuthenticationReplays:1,maxReconnectAttempts:1,onBeforeLogout:[],trackingIdPrefix:"spark-js-sdk",trackingIdSuffix:"",AlternateLogger:void 0,credentials:new n.default,device:{preDiscoveryServices:{hydra:"https://api.ciscospark.com/v1",hydraServiceUrl:"https://api.ciscospark.com/v1"},validateDomains:!1,whitelistedServiceDomains:["webexkubed.com","wbx3.com","wbx2.com","ciscospark.com","webex.com"]},payloadTransformer:{predicates:[],transforms:[]},storage:{boundedAdapter:aO.MemoryStoreAdapter,unboundedAdapter:aO.MemoryStoreAdapter}}});t(Px);var Tx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=l(TO),n=l(YE),i=l(mT),o=l(QM),a=l(hd),u=l(vp),s=l(fT),c=l(ex);function l(e){return e&&e.__esModule?e:{default:e}}function f(e,t,n){(e._derived[t]={fn:(0,a.default)(n)?n:n.fn,cache:!1!==n.cache,depList:n.deps||[]}).depList.forEach(function(r){e._deps[r]=(0,i.default)(e._deps[r]||[],[t])}),(0,r.default)(e,t,{get:function(){return this._getDerivedProperty(t)},set:function(){throw new TypeError("`"+t+"` is a derived property, it can't be set directly.")}})}t.default=function(e,t,r){return e.registerPlugin=function(i,a){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if((!e.prototype._children[i]||l.replace)&&(e.prototype._children[i]=a,l.proxies&&l.proxies.forEach(function(t){f(e.prototype,t,{deps:[i+"."+t],fn:function(){return this[i][t]}})}),l.interceptors&&(0,n.default)(l.interceptors).forEach(function(e){r[e]=l.interceptors[e]}),l.config&&(0,o.default)(t,l.config),(0,s.default)(l,"payloadTransformer.predicates")&&(t.payloadTransformer.predicates=t.payloadTransformer.predicates.concat((0,c.default)(l,"payloadTransformer.predicates"))),(0,s.default)(l,"payloadTransformer.transforms")&&(t.payloadTransformer.transforms=t.payloadTransformer.transforms.concat((0,c.default)(l,"payloadTransformer.transforms"))),l.onBeforeLogout&&(t.onBeforeLogout=t.onBeforeLogout||[],((0,u.default)(l.onBeforeLogout)?l.onBeforeLogout:[l.onBeforeLogout]).forEach(function(e){return t.onBeforeLogout.push({plugin:i,fn:e})})),a.prototype._definition&&a.prototype._definition.ready)){var d=e.prototype._derived.ready,p=d.fn,h={deps:d.depList.concat(i+".ready"),fn:p};f(e.prototype,"ready",h)}},e}});t(Tx);var Ox=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=l(TO),n=l(YE),i=l(mT),o=l(QM),a=l(hd),u=l(vp),s=l(fT),c=l(ex);function l(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,l){return e.registerPlugin=function(f,d){var p=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.prototype._children[f]||p.replace){if(e.prototype._children[f]=d,p.proxies)throw new Error("Proxies are not currently supported for private plugins");if(p.interceptors&&(0,n.default)(p.interceptors).forEach(function(e){l[e]=p.interceptors[e]}),p.config&&(0,o.default)(t,p.config),(0,s.default)(p,"payloadTransformer.predicates")&&(t.payloadTransformer.predicates=t.payloadTransformer.predicates.concat((0,c.default)(p,"payloadTransformer.predicates"))),(0,s.default)(p,"payloadTransformer.transforms")&&(t.payloadTransformer.transforms=t.payloadTransformer.transforms.concat((0,c.default)(p,"payloadTransformer.transforms"))),p.onBeforeLogout&&(t.onBeforeLogout=t.onBeforeLogout||[],((0,u.default)(p.onBeforeLogout)?p.onBeforeLogout:[p.onBeforeLogout]).forEach(function(e){return t.onBeforeLogout.push({plugin:f,fn:e})})),d.prototype._definition&&d.prototype._definition.ready){var h=e.prototype._derived.ready,v=h.fn,g={deps:h.depList.concat(f+".ready"),fn:v};!function(e,t,n){(e._derived[t]={fn:(0,a.default)(n)?n:n.fn,cache:!1!==n.cache,depList:n.deps||[]}).depList.forEach(function(r){e._deps[r]=(0,i.default)(e._deps[r]||[],[t])}),(0,r.default)(e,t,{get:function(){return this._getDerivedProperty(t)},set:function(){throw new TypeError("`"+t+"` is a derived property, it can't be set directly.")}})}(e.prototype,"ready",g)}}},e}});t(Ox);var Cx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(YE),n=o(BT),i=o(ym);function o(e){return e&&e.__esModule?e:{default:e}}var a=n.default.extend({derived:{ready:{deps:[],fn:function(){var e=this;return(0,r.default)(this._children).reduce(function(t,r){return t&&e[r]&&!1!==e[r].ready},!0)}}},inspect:function(e){return i.default.inspect(this.serialize({props:!0,session:!0,derived:!0}),{depth:e})}});t.default=a});t(Cx);var Mx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=F(ac),i=F(cc),o=F(Ef),a=F(VT),u=F(bf),s=F(YE),c=F(Cf),l=F(HM),f=F($M),d=F(cg),p=F(QM),h=F(Rv),v=F(hP),g=F(hd),y=F(fT),m=F(ex),b=F(cS);t.registerPlugin=function(e,t,r){$.registerPlugin(e,t,r)},t.registerInternalPlugin=function(e,t,r){L.default.registerPlugin(e,t,r)};var _=F(ym),w=F(BT),S=F(dx),k=F(px),E=F(hx),P=F(vx),T=F(gx),O=F(yx),C=(F(mx),F(bx)),M=(F(_x),F(LM)),x=F(wx),j=F(Sx),R=F(kx),A=F(Px),I=F(Tx),D=F(Ox),L=F(Cx);function F(e){return e&&e.__esModule?e:{default:e}}var N,U,z,q,B,W,V={SparkTrackingIdInterceptor:x.default.create,RequestEventInterceptor:O.default.create,RateLimitInterceptor:R.default.create,RequestLoggerInterceptor:void 0,ResponseLoggerInterceptor:void 0,RequestTimingInterceptor:C.default.create,UrlInterceptor:void 0,SparkUserAgentInterceptor:j.default.create,AuthInterceptor:k.default.create,KmsDryErrorInterceptor:void 0,PayloadTransformerInterceptor:P.default.create,ConversationInterceptor:void 0,RedirectInterceptor:T.default.create,HttpStatusInterceptor:function(){return DM.HttpStatusInterceptor.create({error:M.default})},NetworkTimingInterceptor:E.default.create},G=["ResponseLoggerInterceptor","RequestTimingInterceptor","RequestEventInterceptor","SparkTrackingIdInterceptor","RateLimitInterceptor"],H=["HttpStatusInterceptor","NetworkTimingInterceptor","RequestLoggerInterceptor","RateLimitInterceptor"],$=w.default.extend((r={version:"1.50.12",children:{internal:L.default},constructor:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];return"string"==typeof e?e={credentials:{supertoken:{access_token:e}}}:(["credentials.authorization","authorization","credentials.supertoken.supertoken","supertoken","access_token","credentials.authorization.supertoken"].forEach(function(t){var r=(0,m.default)(e,t);r&&((0,l.default)(e,t),(0,f.default)(e,"credentials.supertoken",r))}),["credentials","credentials.authorization"].forEach(function(t){var r=(0,m.default)(e,t);"string"==typeof r&&((0,l.default)(e,t),(0,f.default)(e,"credentials.supertoken",r))}),"string"==typeof(0,m.default)(e,"credentials.access_token")&&((0,f.default)(e,"credentials.access_token",this.bearerValidator((0,m.default)(e,"credentials.access_token").trim())),(0,f.default)(e,"credentials.supertoken",e.credentials))),(0,c.default)(w.default,this,[e,t])},derived:{boundedStorage:{deps:[],fn:function(){return(0,aO.makeSparkStore)("bounded",this)}},unboundedStorage:{deps:[],fn:function(){return(0,aO.makeSparkStore)("unbounded",this)}},ready:{deps:["loaded","internal.ready"],fn:function(){var e=this;return this.loaded&&(0,s.default)(this._children).reduce(function(t,r){return t&&e[r]&&!1!==e[r].ready},!0)}}},session:{config:{type:"object"},loaded:{default:!1,type:"boolean"},request:{setOnce:!0,type:"any"},sessionId:{setOnce:!0,type:"string"}},refresh:function(){var e;return(e=this.credentials).refresh.apply(e,arguments)},transform:function(e,t){var r=this,n=this.config.payloadTransformer.predicates.filter(function(t){return!t.direction||t.direction===e}),i={spark:this};return u.default.all(n.map(function(e){return e.test(i,t).then(function(r){if(r)return e.extract(t).then(function(t){return{name:e.name,target:t}})})})).then(function(t){return t.filter(function(e){return Boolean(e)}).reduce(function(t,n){var i=n.name,o=n.target,a=n.alias;return t.then(function(){return a?r.applyNamedTransform(e,a,o):r.applyNamedTransform(e,i,o)})},u.default.resolve())}).then(function(){return t})},applyNamedTransform:function(e,t,r){for(var n=arguments.length,i=Array(n>3?n-3:0),o=3;o<n;o++)i[o-3]=arguments[o];var s=this;return(0,v.default)(t)&&(i.unshift(r),r=t,t={spark:this,transform:function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return s.applyNamedTransform.apply(s,[e,t].concat(n))}}),t.spark.config.payloadTransformer.transforms.filter(function(t){return t.name===r&&(!t.direction||t.direction===e)}).reduce(function(e,r){return e.then(function(){var e;return r.alias?(e=t).transform.apply(e,[r.alias].concat((0,a.default)(i))):u.default.resolve(r.fn.apply(r,[t].concat((0,a.default)(i))))})},u.default.resolve()).then(function(){return(0,h.default)(i)})},getWindow:function(){return window},initialize:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};delete A.default.credentials.federation,this.config=(0,p.default)({},A.default,t.config),this.trigger("change:config");var r=function t(){e.loaded&&(e.trigger("loaded"),e.stopListening(e,"change:loaded",t))};ps(function(){e.listenToAndRun(e,"change:loaded",r)});var n=function t(){e.ready&&(e.trigger("ready"),e.stopListening(e,"change:ready",t))};ps(function(){e.listenToAndRun(e,"change:ready",n)}),(0,s.default)(this.constructor.prototype._children).forEach(function(t){e.listenTo(e[t],"change",function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];n.unshift("change:"+t),e.trigger.apply(e,n)})});var i=function(t,r){var n=V[r];return(0,g.default)(n)?(t.push((0,c.default)(n,e,[])),t):t},o=[];o=G.reduce(i,o),o=(0,s.default)(V).filter(function(e){return!(G.includes(e)||H.includes(e))}).reduce(i,o),o=H.reduce(i,o),this.request=(0,DM.defaults)({json:!0,interceptors:o});var a=(0,m.default)(this,"config.trackingIdPrefix","spark-js-sdk")+"_"+(0,m.default)(this,"config.trackingIdBase",S.default.v4());(0,y.default)(this,"config.trackingIdPrefix")&&(a+="_"+(0,m.default)(this,"config.trackingIdPrefix")),this.sessionId=a},setConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=(0,p.default)({},this.config,e)},bearerValidator:function(e){return e.includes("Bearer")&&e.split(" ").length-1==0?(console.warn("Your access token does not have a space between 'Bearer' and the token, please add a space to it or replace it with this already fixed version:\n\n"+e.replace("Bearer","Bearer ").replace(/\s+/g," ")),console.info("Tip: You don't need to add 'Bearer' to the access_token field. The token by itself is fine"),e.replace("Bearer","Bearer ").replace(/\s+/g," ")):e.split(" ").length-1>1?(console.warn("Your access token has "+(e.split(" ").length-2)+" too many spaces, please use this format:\n\n"+e.replace(/\s+/g," ")),console.info("Tip: You don't need to add 'Bearer' to the access_token field, the token by itself is fine"),e.replace(/\s+/g," ")):e.replace(/\s+/g," ")},inspect:function(e){return _.default.inspect((0,d.default)(this.serialize({props:!0,session:!0,derived:!0}),"boundedStorage","unboundedStorage","request","config"),{depth:e})},logout:function(e){for(var t=this,r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var s=this.credentials.supertoken&&(this.credentials.supertoken.refresh_token||this.credentials.supertoken.access_token);return e=(0,o.default)({token:s},e),this.config.onBeforeLogout.reverse().reduce(function(r,i){var o=i.plugin,s=i.fn;return r.then(function(){return u.default.resolve((0,c.default)(s,t[o]||t.internal[o],[e].concat((0,a.default)(n)))).catch(function(e){t.logger.warn("onBeforeLogout from plugin "+o+": failed",e)})})},u.default.resolve()).then(function(){return u.default.all([t.boundedStorage.clear(),t.unboundedStorage.clear()])}).then(function(){var e;return(e=t.credentials).invalidate.apply(e,(0,a.default)(n))}).then(function(){var r;return t.authorization&&t.authorization.logout&&(r=t.authorization).logout.apply(r,[e].concat((0,a.default)(n)))}).then(function(){return t.trigger("client:logout")})},measure:function(){var e;return this.metrics?(e=this.metrics).sendUnstructured.apply(e,arguments):u.default.resolve()},upload:function(e){var t=this;if(!e.file)return u.default.reject(new Error("`options.file` is required"));e.phases=e.phases||{},e.phases.initialize=e.phases.initialize||{},e.phases.upload=e.phases.upload||{},e.phases.finalize=e.phases.finalize||{},(0,b.default)(e.phases.initialize,{method:"POST"},(0,d.default)(e,"file","phases")),(0,b.default)(e.phases.upload,{method:"PUT",json:!1,withCredentials:!1,body:e.file,headers:{"x-trans-id":S.default.v4(),authorization:void 0}}),(0,b.default)(e.phases.finalize,{method:"POST"},(0,d.default)(e,"file","phases"));var r=new fS.EventEmitter,n=this._uploadPhaseInitialize(e).then(function(){var n=t._uploadPhaseUpload(e);return(0,$E.transferEvents)("progress",n,r),n}).then(function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return t._uploadPhaseFinalize.apply(t,[e].concat(n))}).then(function(e){return e.body});return(0,$E.proxyEvents)(r,n),n},_uploadPhaseInitialize:function(e){var t=this;return this.logger.debug("client: initiating upload session"),this.request(e.phases.initialize).then(function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return t._uploadApplySession.apply(t,[e].concat(n))}).then(function(e){return t.logger.debug("client: initiated upload session"),e})},_uploadApplySession:function(e,t){var r=t.body;["upload","finalize"].reduce(function(e,t){return e[t]=(0,s.default)(e[t]).reduce(function(e,t){return t.startsWith("$")&&(e[t.substr(1)]=e[t](r),(0,i.default)(e,t)),e},e[t]),e},e.phases)},_uploadPhaseUpload:function(e){var t=this;this.logger.debug("client: uploading file");var r=this.request(e.phases.upload).then(function(e){return t.logger.debug("client: uploaded file"),e});return(0,$E.proxyEvents)(e.phases.upload.upload,r),r},_uploadPhaseFinalize:function(e){var t=this;return this.logger.debug("client: finalizing upload session"),this.request(e.phases.finalize).then(function(e){return t.logger.debug("client: finalized upload session"),e})}},N=r,U="_uploadPhaseUpload",z=[$E.retry],q=(0,n.default)(r,"_uploadPhaseUpload"),B=r,W={},Object.keys(q).forEach(function(e){W[e]=q[e]}),W.enumerable=!!W.enumerable,W.configurable=!!W.configurable,("value"in W||W.initializer)&&(W.writable=!0),W=z.slice().reverse().reduce(function(e,t){return t(N,U,e)||e},W),B&&void 0!==W.initializer&&(W.value=W.initializer?W.initializer.call(B):void 0,W.initializer=void 0),void 0===W.initializer&&(Object.defineProperty(N,U,W),W=null),r));$.version="1.50.12",(0,D.default)(L.default,A.default,V),(0,I.default)($,A.default,V),t.default=$});t(Mx);Mx.registerPlugin,Mx.registerInternalPlugin;var xx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.grantErrors=t.Token=t.sortScope=t.filterScope=t.Credentials=void 0,Object.defineProperty(t,"Credentials",{enumerable:!0,get:function(){return n(GM).default}}),Object.defineProperty(t,"filterScope",{enumerable:!0,get:function(){return dO.filterScope}}),Object.defineProperty(t,"sortScope",{enumerable:!0,get:function(){return dO.sortScope}}),Object.defineProperty(t,"Token",{enumerable:!0,get:function(){return n(FM).default}}),Object.defineProperty(t,"grantErrors",{enumerable:!0,get:function(){return n(fO).default}});var r=n(GM);function n(e){return e&&e.__esModule?e:{default:e}}(0,Mx.registerPlugin)("credentials",r.default,{proxies:["canAuthorize","canRefresh"]})});t(xx);xx.grantErrors,xx.Token,xx.sortScope,xx.filterScope,xx.Credentials;var jx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,n,i=l(Ef),o=l(Hm),a=l(Wm),u=l($m),s=l(hb),c=l(jT);function l(e){return e&&e.__esModule?e:{default:e}}var f,d,p,h,v,g,y=new s.default,m=(r=function(){function e(){var t,r,i,u,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,a.default)(this,e),t=this,r="ready",u=this,(i=n)&&(0,o.default)(t,r,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(u):void 0});var l=s.spark||c.parent;if(!l)throw new Error("One of `attrs.spark` or `options.parent` must be supplied when initializing a StatelessSparkPlugin");for(;l.parent||l.collection;)l=l.parent||l.collection;y.set(this,l)}return(0,u.default)(e,[{key:"config",get:function(){var e=this.getNamespace?this.getNamespace():this.namespace;return e?(e=e.toLowerCase(),this.spark.config[e]):this.spark.config}},{key:"logger",get:function(){return this.spark.logger}},{key:"spark",get:function(){return y.get(this)}}]),(0,u.default)(e,[{key:"request",value:function(){var e;return(e=this.spark).request.apply(e,arguments)}},{key:"upload",value:function(){var e;return(e=this.spark).upload.apply(e,arguments)}}]),e}(),f=r.prototype,d="ready",p=[WE.readonly],h={enumerable:!0,initializer:function(){return!0}},g={},Object.keys(h).forEach(function(e){g[e]=h[e]}),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=p.slice().reverse().reduce(function(e,t){return t(f,d,e)||e},g),v&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(v):void 0,g.initializer=void 0),void 0===g.initializer&&(Object.defineProperty(f,d,g),g=null),n=g,r);t.default=m,(0,i.default)(m.prototype,c.default)});t(jx);var Rx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=u(bf),n=u(p_),i=u(fT),o=u(uO),a=u(LM);function u(e){return e&&e.__esModule?e:{default:e}}var s=o.default.extend({session:{deferreds:{type:"object",default:function(){return new n.default}},queue:{type:"array",default:function(){return[]}}},derived:{bounce:{fn:function(){var e=this;return(0,$E.cappedDebounce)(function(){return e.executeQueue.apply(e,arguments)},this.config.batcherWait,{maxCalls:this.config.batcherMaxCalls,maxWait:this.config.batcherMaxWait})}}},request:function(e){var t=this,n=new $E.Defer;return this.fingerprintRequest(e).then(function(i){t.deferreds.has(i)?n.resolve(t.deferreds.get(i).promise):(t.deferreds.set(i,n),t.prepareItem(e).then(function(e){n.promise=n.promise.then((0,$E.tap)(function(){return t.deferreds.delete(i)})).catch(function(e){return t.deferreds.delete(i),r.default.reject(e)}),t.enqueue(e).then(function(){return t.bounce()}).catch(function(e){return n.reject(e)})}).catch(function(e){return n.reject(e)}))}).catch(function(e){return n.reject(e)}),n.promise},enqueue:function(e){return this.queue.push(e),r.default.resolve()},prepareItem:function(e){return r.default.resolve(e)},executeQueue:function(){var e=this,t=this.queue.splice(0,this.config.batcherMaxCalls);return new r.default(function(n){n(e.prepareRequest(t).then(function(t){return e.submitHttpRequest(t).then(function(t){return e.handleHttpSuccess(t)})}).catch(function(n){return n instanceof a.default?e.handleHttpError(n):r.default.all(t.map(function(t){return e.getDeferredForRequest(t).then(function(e){e.reject(n)})}))}))}).catch(function(t){return e.logger.error(t.stack),r.default.reject(t)})},prepareRequest:function(e){return r.default.resolve(e)},submitHttpRequest:function(e){throw new Error("request() must be implemented")},handleHttpSuccess:function(e){var t=this;return r.default.all((e.body&&e.body.items||e.body).map(function(e){return t.acceptItem(e)}))},handleHttpError:function(e){var t=this;return e instanceof a.default&&(0,i.default)(e,"options.body.map")?r.default.all(e.options.body.map(function(r){return t.getDeferredForRequest(r).then(function(t){t.reject(e)})})):(this.logger.error("http error handler called without a SparkHttpError object",e),r.default.reject(e))},acceptItem:function(e){var t=this;return this.didItemFail(e).then(function(r){return r?t.handleItemFailure(e):t.handleItemSuccess(e)})},didItemFail:function(e){return r.default.resolve(!1)},handleItemFailure:function(e){return this.getDeferredForResponse(e).then(function(t){t.reject(e)})},handleItemSuccess:function(e){return this.getDeferredForResponse(e).then(function(t){t.resolve(e)})},getDeferredForRequest:function(e){var t=this;return this.fingerprintRequest(e).then(function(e){var r=t.deferreds.get(e);if(!r)throw new Error("Could not find pending request for received response");return r})},getDeferredForResponse:function(e){var t=this;return this.fingerprintResponse(e).then(function(e){var r=t.deferreds.get(e);if(!r)throw new Error("Could not find pending request for received response");return r})},fingerprintRequest:function(e){throw new Error("fingerprintRequest() must be implemented")},fingerprintResponse:function(e){throw new Error("fingerprintResponse() must be implemented")},version:"1.50.12"});t.default=s});t(Rx);var Ax=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(mb),n=a(Wm),i=a($m),o=a(hb);function a(e){return e&&e.__esModule?e:{default:e}}var u=new o.default,s=new o.default,c=new o.default,l=function(){function e(t,r){return(0,n.default)(this,e),u.set(this,t.body.items),s.set(this,e.parseLinkHeaders(t.headers.link)),c.set(this,r),this}return(0,i.default)(e,[{key:"items",get:function(){return u.get(this)}},{key:"length",get:function(){return this.items.length}},{key:"links",get:function(){return s.get(this)}},{key:"spark",get:function(){return c.get(this)}}]),(0,i.default)(e,[{key:"next",value:function(){return this.getLink("next")}},{key:"hasNext",value:function(){return this.hasLink("next")}},{key:"previous",value:function(){return this.getLink("previous")}},{key:"hasPrevious",value:function(){return this.hasLink("previous")}},{key:"getLink",value:function(t){var r=this;return this.spark.request({uri:this.links[t]}).then(function(t){return new e(t,r.spark)})}},{key:"hasLink",value:function(e){return Boolean(this.links[e])}},{key:r.default,value:function(){var e=this,t=-1;return{next:function(){return(t+=1)<e.length?{value:e.items[t]}:{done:!0}}}}}],[{key:"parseLinkHeaders",value:function(e){return e?(e=Array.isArray(e)?e:[e]).reduce(function(e,t){var r=(t=t.split(";"))[0].replace("<","").replace(">","");return e[t[1].split("=")[1].replace(/"/g,"")]=r,e},{}):{}}}]),e}();t.default=l});t(Ax),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={error:["log"],warn:["error","log"],info:["log"],debug:["info","log"],trace:["debug","info","log"]};function n(e){var t=r[e];if(t)for(t=t.slice();!console[e];)e=t.pop();return function(){for(var t,r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=console)[e].apply(t,n)}}var i=Ix.SparkPlugin.extend({namespace:"Logger",error:n("error"),warn:n("warn"),log:n("log"),info:n("info"),debug:n("debug"),trace:n("trace"),version:"1.50.12"});(0,Ix.registerPlugin)("logger",i),t.default=i}));var Ix=r(function(e,t){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.config=t.Page=t.Batcher=t.RateLimitInterceptor=t.SparkUserAgentInterceptor=t.SparkTrackingIdInterceptor=t.RequestTimingInterceptor=t.RequestLoggerInterceptor=t.RequestEventInterceptor=t.ResponseLoggerInterceptor=t.RedirectInterceptor=t.PayloadTransformerInterceptor=t.NetworkTimingInterceptor=t.AuthInterceptor=t.SparkPlugin=t.StatelessSparkPlugin=t.SparkHttpError=t.registerInternalPlugin=t.registerPlugin=t.default=t.children=t.waitForValue=t.StorageError=t.persist=t.NotFoundError=t.MemoryStoreAdapter=t.makeSparkPluginStore=t.makeSparkStore=t.Token=t.sortScope=t.grantErrors=t.filterScope=t.Credentials=void 0,Object.defineProperty(t,"Credentials",{enumerable:!0,get:function(){return xx.Credentials}}),Object.defineProperty(t,"filterScope",{enumerable:!0,get:function(){return xx.filterScope}}),Object.defineProperty(t,"grantErrors",{enumerable:!0,get:function(){return xx.grantErrors}}),Object.defineProperty(t,"sortScope",{enumerable:!0,get:function(){return xx.sortScope}}),Object.defineProperty(t,"Token",{enumerable:!0,get:function(){return xx.Token}}),Object.defineProperty(t,"makeSparkStore",{enumerable:!0,get:function(){return aO.makeSparkStore}}),Object.defineProperty(t,"makeSparkPluginStore",{enumerable:!0,get:function(){return aO.makeSparkPluginStore}}),Object.defineProperty(t,"MemoryStoreAdapter",{enumerable:!0,get:function(){return aO.MemoryStoreAdapter}}),Object.defineProperty(t,"NotFoundError",{enumerable:!0,get:function(){return aO.NotFoundError}}),Object.defineProperty(t,"persist",{enumerable:!0,get:function(){return aO.persist}}),Object.defineProperty(t,"StorageError",{enumerable:!0,get:function(){return aO.StorageError}}),Object.defineProperty(t,"waitForValue",{enumerable:!0,get:function(){return aO.waitForValue}}),Object.defineProperty(t,"children",{enumerable:!0,get:function(){return Mx.children}}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(Mx).default}}),Object.defineProperty(t,"registerPlugin",{enumerable:!0,get:function(){return Mx.registerPlugin}}),Object.defineProperty(t,"registerInternalPlugin",{enumerable:!0,get:function(){return Mx.registerInternalPlugin}}),Object.defineProperty(t,"SparkHttpError",{enumerable:!0,get:function(){return r(LM).default}}),Object.defineProperty(t,"StatelessSparkPlugin",{enumerable:!0,get:function(){return r(jx).default}}),Object.defineProperty(t,"SparkPlugin",{enumerable:!0,get:function(){return r(uO).default}}),Object.defineProperty(t,"AuthInterceptor",{enumerable:!0,get:function(){return r(px).default}}),Object.defineProperty(t,"NetworkTimingInterceptor",{enumerable:!0,get:function(){return r(hx).default}}),Object.defineProperty(t,"PayloadTransformerInterceptor",{enumerable:!0,get:function(){return r(vx).default}}),Object.defineProperty(t,"RedirectInterceptor",{enumerable:!0,get:function(){return r(gx).default}}),Object.defineProperty(t,"ResponseLoggerInterceptor",{enumerable:!0,get:function(){return r(_x).default}}),Object.defineProperty(t,"RequestEventInterceptor",{enumerable:!0,get:function(){return r(yx).default}}),Object.defineProperty(t,"RequestLoggerInterceptor",{enumerable:!0,get:function(){return r(mx).default}}),Object.defineProperty(t,"RequestTimingInterceptor",{enumerable:!0,get:function(){return r(bx).default}}),Object.defineProperty(t,"SparkTrackingIdInterceptor",{enumerable:!0,get:function(){return r(wx).default}}),Object.defineProperty(t,"SparkUserAgentInterceptor",{enumerable:!0,get:function(){return r(Sx).default}}),Object.defineProperty(t,"RateLimitInterceptor",{enumerable:!0,get:function(){return r(kx).default}}),Object.defineProperty(t,"Batcher",{enumerable:!0,get:function(){return r(Rx).default}}),Object.defineProperty(t,"Page",{enumerable:!0,get:function(){return r(Ax).default}}),Object.defineProperty(t,"config",{enumerable:!0,get:function(){return r(Px).default}})});t(Ix);Ix.config,Ix.Page,Ix.Batcher,Ix.RateLimitInterceptor,Ix.SparkUserAgentInterceptor,Ix.SparkTrackingIdInterceptor,Ix.RequestTimingInterceptor,Ix.RequestLoggerInterceptor,Ix.RequestEventInterceptor,Ix.ResponseLoggerInterceptor,Ix.RedirectInterceptor,Ix.PayloadTransformerInterceptor,Ix.NetworkTimingInterceptor,Ix.AuthInterceptor,Ix.SparkPlugin,Ix.StatelessSparkPlugin,Ix.SparkHttpError,Ix.registerInternalPlugin,Ix.registerPlugin,Ix.children,Ix.waitForValue,Ix.StorageError,Ix.persist,Ix.NotFoundError,Ix.MemoryStoreAdapter,Ix.makeSparkPluginStore,Ix.makeSparkStore,Ix.Token,Ix.sortScope,Ix.grantErrors,Ix.filterScope,Ix.Credentials;var Dx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n,i,o=y(ac),a=y(cc),u=y(bf),s=y(Ef),c=y(Cf),l=y(jf),f=y(cg),d=y(pg),p=y(gg),h=y(Eg),v=y(mm),g=y(dx);function y(e){return e&&e.__esModule?e:{default:e}}function m(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var b=$E.base64.encode((0,l.default)({})),_=Ix.SparkPlugin.extend((r=(0,$E.whileInFlight)("isAuthorizing"),n=(0,$E.whileInFlight)("isAuthorizing"),m(i={derived:{isAuthenticating:{deps:["isAuthorizing"],fn:function(){return this.isAuthorizing}}},session:{isAuthorizing:{default:!1,type:"boolean"},ready:{default:!1,type:"boolean"}},namespace:"Credentials",initialize:function(e,t){var r=this,n=(0,c.default)(Ix.SparkPlugin.prototype.initialize,this,[e,t]);if(!1===e.parse)return this.ready=!0,n;var i=v.default.parse(this.spark.getWindow().location.href,!0);this._checkForErrors(i);var o=i.hash;if(!o)return this.ready=!0,n;o.includes("#")&&(o=o.substr(1)),i.hash=h.default.parse(o),i.hash.state&&(i.hash.state=JSON.parse($E.base64.decode(i.hash.state)));var a=this._parseHash(i);return a?(this._cleanUrl(i),ps(function(){r.spark.credentials.set({supertoken:a}),r.ready=!0}),n):n},initiateLogin:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.state=e.state||{},e.state.csrf_token=this._generateSecurityToken(),"confidential"===this.config.clientType?this.initiateAuthorizationCodeGrant(e):this.initiateImplicitGrant(e)},initiateImplicitGrant:function(e){return this.logger.info("authorization: initiating implicit grant flow"),this.spark.getWindow().location=this.spark.credentials.buildLoginUrl((0,s.default)({response_type:"token"},e)),u.default.resolve()},initiateAuthorizationCodeGrant:function(e){return this.logger.info("authorization: initiating authorization code grant flow"),this.spark.getWindow().location=this.spark.credentials.buildLoginUrl((0,s.default)({response_type:"code"},e)),u.default.resolve()},requestAccessTokenFromJwt:function(e){var t=this,r=e.jwt;return this.spark.request({method:"POST",service:"hydra",resource:"jwt/login",headers:{authorization:r}}).then(function(e){var t=e.body;return{access_token:t.token,token_type:"Bearer",expires_in:t.expiresIn}}).then(function(e){t.spark.credentials.set({supertoken:e})})},logout:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.noRedirect||(this.spark.getWindow().location=this.spark.credentials.buildLogoutUrl(e))},_checkForErrors:function(e){var t=e.query;if(t&&t.error)throw new(Ix.grantErrors.select(t.error))(t)},_cleanUrl:function(e){e=(0,p.default)(e),this.spark.getWindow().history&&this.spark.getWindow().history.replaceState&&(["access_token","token_type","expires_in","refresh_token","refresh_token_expires_in"].forEach(function(t){return(0,a.default)(e.hash,t)}),(0,d.default)(e.hash.state)?(0,a.default)(e.hash,"state"):(e.hash.state=$E.base64.encode((0,l.default)((0,f.default)(e.hash.state,"csrf_token"))),e.hash.state===b&&(0,a.default)(e.hash,"state")),e.hash=h.default.stringify(e.hash),this.spark.getWindow().history.replaceState({},null,v.default.format(e)))},_generateSecurityToken:function(){this.logger.info("authorization: generating csrf token");var e=g.default.v4();return this.spark.getWindow().sessionStorage.setItem("oauth2-csrf-token",e),e},_parseHash:function(e){var t=(0,p.default)(e.hash);if(t&&this._verifySecurityToken(t),t.access_token)return t.expires_in&&(t.expires_in=parseInt(t.expires_in,10)),t.refresh_token_expires_in&&(t.refresh_token_expires_in=parseInt(t.refresh_token_expires_in,10)),t;this.ready=!0},_verifySecurityToken:function(e){var t=this.spark.getWindow().sessionStorage.getItem("oauth2-csrf-token");if(this.spark.getWindow().sessionStorage.removeItem("oauth2-csrf-token"),t){if(!e.state)throw new Error("Expected CSRF token "+t+", but not found in redirect hash");if(!e.state.csrf_token)throw new Error("Expected CSRF token "+t+", but not found in redirect hash");var r=e.state.csrf_token;if(r!==t)throw new Error("CSRF token "+r+" does not match stored token "+t)}},version:"1.50.12"},"initiateImplicitGrant",[r],(0,o.default)(i,"initiateImplicitGrant"),i),m(i,"initiateAuthorizationCodeGrant",[n],(0,o.default)(i,"initiateAuthorizationCodeGrant"),i),m(i,"requestAccessTokenFromJwt",[$E.oneFlight],(0,o.default)(i,"requestAccessTokenFromJwt"),i),i));t.default=_});t(Dx);var Lx=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={credentials:{clientType:"public"}}});t(Lx);var Fx=1,Nx=2;var Ux=function(e,t,r,n){var i=r.length,o=i,a=!n;if(null==e)return!o;for(e=Object(e);i--;){var u=r[i];if(a&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++i<o;){var s=(u=r[i])[0],c=e[s],l=u[1];if(a&&u[2]){if(void 0===c&&!(s in e))return!1}else{var f=new ep;if(n)var d=n(c,l,s,e,t,f);if(!(void 0===d?aT(l,c,Fx|Nx,n,f):d))return!1}}return!0};var zx=function(e){return e==e&&!sd(e)};var qx=function(e){for(var t=Np(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,zx(i)]}return t};var Bx=function(e,t){return function(r){return null!=r&&r[e]===t&&(void 0!==t||e in Object(r))}};var Wx=function(e){var t=qx(e);return 1==t.length&&t[0][2]?Bx(t[0][0],t[0][1]):function(r){return r===e||Ux(r,e,t)}},Vx=1,Gx=2;var Hx=function(e,t){return mv(e)&&zx(t)?Bx(Iv(e),t):function(r){var n=ex(r,e);return void 0===n&&n===t?SO(r,e):aT(t,n,Vx|Gx)}};var $x=function(e){return function(t){return null==t?void 0:t[e]}};var Jx=function(e){return function(t){return Dv(t,e)}};var Yx=function(e){return mv(e)?$x(Iv(e)):Jx(e)};var Kx=function(e){return"function"==typeof e?e:null==e?tg:"object"==typeof e?vp(e)?Hx(e[0],e[1]):Wx(e):Yx(e)};var Xx=function(e){return function(t,r,n){var i=Object(t);if(!Fp(t)){var o=Kx(r,3);t=Np(t),r=function(e){return o(i[e],e,i)}}var a=e(t,r,n);return a>-1?i[o?t[a]:a]:void 0}},Zx=Math.max;var Qx=Xx(function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=null==r?0:Ww(r);return i<0&&(i=Zx(n+i,0)),J_(e,Kx(t,3),i)}),ej=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=u(xO),n=u(Cf),i=u(sd),o=u(cS),a=u(BT);function u(e){return e&&e.__esModule?e:{default:e}}var s=a.default.extend({props:{key:"string",lastModified:"date",mutable:"boolean",type:"string",val:"string",value:"any"},constructor:function(e,t){return t=t||{},(0,o.default)(t,{parse:!0}),(0,n.default)(a.default.prototype.constructor,this,[e,t])},idAttribute:"key",parse:function(e){if(!e)return{};var t=Number(e.val);return e.val&&!(0,r.default)(t)?(e.value=t,e.type="number"):"true"===e.val?(e.value=!0,e.type="boolean"):"false"===e.val?(e.value=!1,e.type="boolean"):(e.value=e.val,e.type="string"),e},serialize:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=(0,n.default)(a.default.prototype.serialize,this,t);return i.lastModified&&(i.lastModified=new Date(i.lastModified).toISOString()),i},set:function(e,t,r){var o=void 0;return(0,i.default)(e)||null===e?(o=e,r=t):(o={})[e]=t,o=this.parse(o,r),(0,n.default)(a.default.prototype.set,this,[o,r])}});t.default=s});t(ej);var tj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(WM),n=i(ej);function i(e){return e&&e.__esModule?e:{default:e}}var o=r.default.extend({mainIndex:"key",model:n.default});t.default=o});t(tj);var rj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(YE),n=o(BT),i=o(tj);function o(e){return e&&e.__esModule?e:{default:e}}var a=n.default.extend({collections:{developer:i.default,entitlement:i.default,user:i.default},clear:function(e){var t=this;return(0,r.default)(this.attributes).forEach(function(r){t.unset(r,e)}),(0,r.default)(this._children).forEach(function(e){t[e].clear()}),(0,r.default)(this._collections).forEach(function(e){t[e].reset()}),this},initialize:function(){var e=this;["change:value","add","remove"].forEach(function(t){["developer","entitlement","user"].forEach(function(r){e[r].on(t,function(t,n){e.trigger("change:"+r,e,e[r],n)})})})}});t.default=a});t(rj);var nj=function(e,t){var r;return kT(e,function(e,n,i){return!(r=t(e,n,i))}),!!r};var ij=function(e,t,r){var n=vp(e)?CP:nj;return r&&aS(e,t,r)&&(t=void 0),n(e,Kx(t,3))},oj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=l(bf),n=l(Cf),i=l(Qx),o=l(ij),a=l(sd),u=l(cS),s=l(BT),c=l(mm);function l(e){return e&&e.__esModule?e:{default:e}}var f=s.default.extend({props:{service:"string",defaultUrl:"string",availableHosts:{type:"array",default:function(){return[]}}},session:{currentHostIndex:{type:"number",default:0}},derived:{url:{deps:["defaultUrl","availableHosts","currentHostIndex"],fn:function(){if(0===this.availableHosts.length)return this.defaultUrl;var e=void 0;return e=this.currentHostIndex>=this.availableHosts.length?this.availableHosts[this.availableHosts.length-1]:this.availableHosts[this.currentHostIndex],this._changeUrlHost(this.defaultUrl,e.host)}}},constructor:function(e,t){return t=t||{},(0,u.default)(t,{parse:!0}),(0,n.default)(s.default.prototype.constructor,this,[e,t])},idAttribute:"service",serialize:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=(0,n.default)(s.default.prototype.serialize,this,t);return i.url=this.url,i},parse:function(e){return e?(e.availableHosts&&e.availableHosts.sort(function(e,t){return e.priority-t.priority}),e):{}},set:function(e,t,r){var i=void 0;return(0,a.default)(e)||null===e?(i=e,r=t):(i={})[e]=t,i=this.parse(i,r),(0,n.default)(s.default.prototype.set,this,[i,r])},markHostFailed:function(e){var t=this.getCurrentHost();if(e){var r=c.default.parse(e);t=(0,i.default)(this.availableHosts,function(e){return e.host===r.host})}t&&(t.failed=!0)},cycleNextHost:function(){for(var e=0;e<this.availableHosts.length;e+=1){var t=this.availableHosts[e];if(!t.failed&&this.currentHostIndex!==e)return this.currentHostIndex=e,r.default.resolve(t)}return this.currentHostIndex=0,r.default.reject(new Error("All hosts have failed for "+this.service))},doesUrlBelongToService:function(e){var t=c.default.parse(e),r=this.availableHosts.map(function(e){return e.host});return r.push(c.default.parse(this.defaultUrl).host),(0,o.default)(r,function(e){return e===t.host})},getCurrentHost:function(){return this.availableHosts[this.currentHostIndex]},resetAllHosts:function(){this.availableHosts.forEach(function(e){e.failed=!1})},replaceUrlWithCurrentHost:function(e){return this._changeUrlHost(e,this.getCurrentHost().host)},_changeUrlHost:function(e,t){var r=c.default.parse(e);return r.host=t,c.default.format(r)}});t.default=f});t(oj);var aj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(bf),n=o(WM),i=o(oj);function o(e){return e&&e.__esModule?e:{default:e}}var a=n.default.extend({mainIndex:"service",model:i.default,markFailedAndCycleUrl:function(e){return e?this.inferServiceFromUrl(e).then(function(t){return t.markHostFailed(e),t.cycleNextHost().then(function(){return t.url})}):r.default.reject(new Error("`uri` is a required parameter"))},resetAllAndRetry:function(e){return e?this.inferServiceFromUrl(e).then(function(e){return e.resetAllHosts(),e.url}):r.default.reject(new Error("`uri` is a required parameter"))},inferServiceFromUrl:function(e){var t=this.filter(function(t){return t.doesUrlBelongToService(e)});return t.length>=1?r.default.resolve(t[0]):r.default.reject(new Error("Unable to infer service for this url "+e))},inferServiceNameFromUrl:function(e){return this.inferServiceFromUrl(e).then(function(e){return e.service})}});t.default=a});t(aj);var uj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n,i,o,a,u,s,c,l,f,d=E(ac),p=E(UO),h=E(Cf),v=E(bf),g=E(YE),y=E(yO),m=E(Qx),b=E(cg),_=E(ym),w=E(rj),S=E(aj),k=E(mm);function E(e){return e&&e.__esModule?e:{default:e}}function P(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var T=Ix.SparkPlugin.extend((r=(0,Ix.waitForValue)("@"),n=(0,Ix.waitForValue)("@"),i=(0,Ix.persist)("@",function(){return!this.config.ephemeral}),o=(0,Ix.waitForValue)("@"),a=(0,Ix.waitForValue)("@"),u=(0,Ix.waitForValue)("@"),s=(0,Ix.waitForValue)("@"),c=(0,Ix.waitForValue)("@"),l=(0,Ix.waitForValue)("@"),P(f={children:{features:w.default},collections:{serviceCatalog:S.default},idAttribute:"url",namespace:"Device",props:{clientMessagingGiphy:"string",customerCompanyName:"string",customerLogoUrl:"string",deviceType:"string",helpUrl:"string",intranetInactivityDuration:"number",intranetInactivityCheckUrl:"string",ecmEnabledForAllUsers:{type:"boolean",default:function(){return!1}},ecmSupportedStorageProviders:{type:"array",default:function(){return[]}},modificationTime:"string",partnerCompanyName:"string",partnerLogoUrl:"string",reportingSiteDesc:"string",reportingSiteUrl:"string",searchEncryptionKeyUrl:"string",services:{default:function(){return{}},type:"object"},serviceHostMap:{default:function(){return{serviceLinks:{},hostCatalog:{}}},type:"object"},showSupportText:"boolean",supportProviderCompanyName:"string",supportProviderLogoUrl:"string",url:"string",userId:"string",webFileShareControl:"string",webSocketUrl:"string",whiteboardFileShareControl:"string"},derived:{registered:{deps:["url"],fn:function(){return Boolean(this.url)}}},session:{logoutTimer:"any",lastUserActivityDate:"number"},determineService:function(e){var t=this.features.developer.get("web-ha-messaging");if(t&&t.value){var r=!0,n=!1,i=void 0;try{for(var o,a=(0,y.default)((0,g.default)(this.serviceHostMap.serviceLinks));!(r=(o=a.next()).done);r=!0){var u=o.value,s=this.serviceHostMap.serviceLinks[u];if(e.startsWith(s))return v.default.resolve(u)}}catch(e){n=!0,i=e}finally{try{!r&&a.return&&a.return()}finally{if(n)throw i}}}else{var c=!0,l=!1,f=void 0;try{for(var d,p=(0,y.default)((0,g.default)(this.services));!(c=(d=p.next()).done);c=!0){var h=d.value,m=this.services[h];if(e.startsWith(m))return v.default.resolve(h.substr(0,h.length-10))}}catch(e){l=!0,f=e}finally{try{!c&&p.return&&p.return()}finally{if(l)throw f}}}return v.default.reject(new Error(e+" does not reflect a known service"))},getServiceUrl:function(e){var t=this,r=this.features.developer.get("web-ha-messaging");return r&&r.value?this._getServiceUrl(this.serviceHostMap.serviceLinks,e).then(function(r){return r||t.getPreDiscoveryServiceUrl(e)}):this._getServiceUrl(this.services,e).then(function(r){return r||t.getPreDiscoveryServiceUrl(e)})},getPreDiscoveryServiceUrl:function(e){return v.default.resolve(this._getServiceUrl(this.config.preDiscoveryServices,e))},getWebSocketUrl:function(){return this.useServiceCatalogUrl(this.webSocketUrl)},useServiceCatalogUrl:function(e){return this.serviceCatalog.inferServiceFromUrl(e).then(function(t){return t.replaceUrlWithCurrentHost(e)})},markUrlFailedAndGetNew:function(e){var t=this;return e?(this.logger.info("device: marking "+e+" as failed"),this.serviceCatalog.markFailedAndCycleUrl(e).then(function(r){return t.spark.internal.metrics.submitClientMetrics("web-ha",{tags:{action:"replace_url",failedUrl:e,newUrl:r}}),r}).catch(function(){return t._resetAllAndRetry(e)})):v.default.reject(new Error("`url` is a required parameter"))},_resetAllAndRetry:function(e){return e?(this.logger.info("device: reset available hosts and retry "+e),this.serviceCatalog.resetAllAndRetry(e)):v.default.reject(new Error("`url` is a required parameter"))},fetchNewUrls:function(e){var t=this;return new v.default(function(r){return t.serviceCatalog.inferServiceFromUrl(e).then(function(e){t.logger.info("device: refresh to "+e.service+" get new urls"),t.refresh(),t.on("serviceCatalogUpdated",function(){return r(e.url)})})})},initialize:function(){for(var e=this,t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];(0,h.default)(Ix.SparkPlugin.prototype.initialize,this,r),["developer","entitlement","user"].forEach(function(t){e.features.on("change:"+t,function(t,r,n){e.trigger("change",e,n),e.trigger("change:features",e,e.features,n)})}),this.on("change:serviceHostMap",this._updateServiceCatalog),this.listenToAndRun(this,"change:intranetInactivityCheckUrl",function(){return e._resetLogoutTimer()}),this.listenToAndRun(this,"change:intranetInactivityDuration",function(){return e._resetLogoutTimer()}),this.listenTo(this.spark,"user-activity",function(){e.lastUserActivityDate=Date.now()})},inspect:function(e){return _.default.inspect((0,b.default)(this.serialize(),"features"),{depth:e})},isPreDiscoveryService:function(e){return v.default.resolve(this._isService(this.config.preDiscoveryServices,e))},isPreDiscoveryServiceUrl:function(e){return e?v.default.resolve(this._isServiceUrl(this.config.preDiscoveryServices,e)):v.default.reject(new Error("`uri` is a required parameter"))},isService:function(e){var t=this;if("idbroker"===e)return v.default.resolve(!1);var r=this.features.developer.get("web-ha-messaging");return r&&r.value?this._isService(this.serviceHostMap.serviceLinks,e).then(function(r){return r||t.isPreDiscoveryService(e)}):this._isService(this.services,e).then(function(r){return r||t.isPreDiscoveryService(e)})},isServiceUrl:function(e){if(!e)return v.default.reject(new Error("`uri` is a required parameter"));var t=this.features.developer.get("web-ha-messaging");return t&&t.value?this._isServiceUrl(this.serviceHostMap.serviceLinks,e)||this._isServiceUrlFromCatalog(this.serviceHostMap.hostCatalog,e)?v.default.resolve(!0):v.default.resolve(!1):v.default.resolve(this._isServiceUrl(this.services,e))},isSpecificService:function(e,t){return t===e?v.default.resolve(!0):this.getServiceUrl(e).then(function(e){return t.includes(e)})},_getServiceUrl:function(e,t){if(!t)return v.default.reject(new Error("`service` is a required parameter"));var r=this.features.developer.get("web-ha-messaging");if(r&&r.value){var n=this.serviceCatalog.get(t);if(n)return v.default.resolve(n.url)}return e?v.default.resolve(e[t+"ServiceUrl"]):v.default.reject(new Error("`target` is a required parameter"))},_isService:function(e,t){return this._getServiceUrl(e,t).then(function(e){return Boolean(e)})},_isServiceUrl:function(e,t){var r=this.features.developer.get("web-ha-messaging");if(r&&r.value){var n=!0,i=!1,o=void 0;try{for(var a,u=(0,y.default)((0,g.default)(e));!(n=(a=u.next()).done);n=!0){var s=a.value,c=e[s];if("idbroker"!==s&&t.startsWith(c))return!0}}catch(e){i=!0,o=e}finally{try{!n&&u.return&&u.return()}finally{if(i)throw o}}}else{var l=!0,f=!1,d=void 0;try{for(var h,m=(0,y.default)((0,p.default)(e));!(l=(h=m.next()).done);l=!0){var b=h.value;if(b&&t.startsWith(b))return v.default.resolve(!0)}}catch(e){f=!0,d=e}finally{try{!l&&m.return&&m.return()}finally{if(f)throw d}}}return!1},_isServiceUrlFromCatalog:function(e,t){var r=k.default.parse(t).hostname;return!(!r||r.includes("idbroker")||!(0,m.default)(e,function(e){return(0,m.default)(e,function(e){return e.host===r})}))},refresh:function(){var e=this;if(this.logger.info("device: refreshing"),!this.registered)return this.logger.info("device: device not registered, registering"),this.register();var t=(0,b.default)(this.serialize(),"features","mediaClusters");return this.config.ephemeral&&(t.ttl=this.config.ephemeralDeviceTTL),this.request({method:"PUT",uri:this.url,body:t}).then(function(t){return e._processRegistrationSuccess(t)}).catch(function(t){return 404===t.statusCode?(e.logger.info("device: refresh failed with 404, attempting to register new device"),e.clear(),e.register()):v.default.reject(t)})},register:function(){var e=this;if(this.logger.info("device: registering"),this.registered)return this.logger.info("device: device already registered, refreshing"),this.refresh();var t=this.config.defaults;return this.config.ephemeral&&(t.ttl=this.config.ephemeralDeviceTTL),this.request({method:"POST",service:"wdm",resource:"devices",body:t}).then(function(t){return e._processRegistrationSuccess(t)})},unregister:function(){var e=this;return this.logger.info("device: unregistering"),this.url?this.request({uri:this.url,method:"DELETE"}).then(function(){return e.clear()}):(this.logger.warn("device: not registered"),v.default.resolve())},clear:function(){clearTimeout(this.refreshTimer);for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];(0,h.default)(Ix.SparkPlugin.prototype.clear,this,t)},_processRegistrationSuccess:function(e){var t=this;if(this.logger.info("device: received registration payload"),this.set(e.body),this.config.ephemeral){this.logger.info("device: enqueing device refresh");var r=1e3*(this.config.ephemeralDeviceTTL/2+60);this.refreshTimer=(0,ZE.safeSetTimeout)(function(){return t.refresh()},r)}},_updateServiceCatalog:function(e){var t=this,r=this.features.developer.get("web-ha-messaging");r&&r.value&&(e.serviceHostMap&&e.serviceHostMap.serviceLinks&&e.serviceHostMap.hostCatalog?((0,g.default)(e.serviceHostMap.serviceLinks).forEach(function(r){var n=k.default.parse(e.serviceHostMap.serviceLinks[r]).hostname,i=e.serviceHostMap.hostCatalog[n];t.serviceCatalog.set({service:r,defaultUrl:e.serviceHostMap.serviceLinks[r],availableHosts:i||[]},{remove:!1})}),this.trigger("serviceCatalogUpdated")):this.refresh())},_resetLogoutTimer:function(){var e=this;if(clearTimeout(this.logoutTimer),this.off("change:lastUserActivityDate"),this.unset("logoutTimer"),this.config.enableInactivityEnforcement&&this.intranetInactivityCheckUrl&&this.intranetInactivityDuration){this.on("change:lastUserActivityDate",function(){return e._resetLogoutTimer()});var t=(0,ZE.safeSetTimeout)(function(){e.spark.request({headers:{"cisco-no-http-redirect":null,"spark-user-agent":null,trackingid:null},method:"GET",uri:e.intranetInactivityCheckUrl}).catch(function(){return e.logger.info("device: did not reach internal ping endpoint; logging out after inactivity on a public network"),e.spark.logout()}).catch(function(t){e.logger.warn("device: logout failed",t)})},1e3*this.intranetInactivityDuration);this.logoutTimer=t}},version:"1.50.12"},"determineService",[r],(0,d.default)(f,"determineService"),f),P(f,"getServiceUrl",[n],(0,d.default)(f,"getServiceUrl"),f),P(f,"initialize",[i],(0,d.default)(f,"initialize"),f),P(f,"isService",[o],(0,d.default)(f,"isService"),f),P(f,"isServiceUrl",[a],(0,d.default)(f,"isServiceUrl"),f),P(f,"isSpecificService",[u],(0,d.default)(f,"isSpecificService"),f),P(f,"refresh",[$E.oneFlight,s],(0,d.default)(f,"refresh"),f),P(f,"register",[$E.oneFlight,c],(0,d.default)(f,"register"),f),P(f,"unregister",[$E.oneFlight,l],(0,d.default)(f,"unregister"),f),f));t.default=T});t(uj);var sj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return(e=uj,e&&e.__esModule?e:{default:e}).default;var e}})});t(sj);var cj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(bf),n=s(rk),i=s(Wm),o=s($m),a=s(nk),u=s(ik);function s(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,o.default)(t,[{key:"onResponseError",value:function(e,t){return 451===t.statusCode&&(this.spark.internal.device.clear(),this.spark.credentials.clear(),this.spark.logger.info("Received `HTTP 451 Unavailable For Legal Reasons`, discarding credentials and device registration")),r.default.reject(t)}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(DM.Interceptor);t.default=c});t(cj);var lj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(cc),n=l(Ef),i=l(bf),o=l(rk),a=l(Wm),u=l($m),s=l(nk),c=l(ik);function l(e){return e&&e.__esModule?e:{default:e}}var f=/(?:^\/)|(?:\/$)/,d=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,(t.__proto__||(0,o.default)(t)).apply(this,arguments))}return(0,c.default)(t,e),(0,u.default)(t,[{key:"onRequest",value:function(e){return e.uri?e:(this.checkOptions(e),this.normalizeOptions(e),this.spark.internal.device.getServiceUrl(e.service).then(function(t){return t?(e.resource&&(t=t.replace(f,"")+"/"+e.resource.replace(f,"")),e.uri=t,e):i.default.reject(new Error("`"+e.service+"` is not a known service"))}))}},{key:"checkOptions",value:function(e){if(!e.api&&!e.service)throw new Error("A `service` or `uri` parameter is required");if(!e.resource)throw new Error("A `resource` parameter is required")}},{key:"normalizeOptions",value:function(e){e.service||((0,n.default)(e,{service:e.service||e.api}),(0,r.default)(e,"api"))}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(DM.Interceptor);t.default=d});t(lj);var fj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(bf),n=c(rk),i=c(Wm),o=c($m),a=c(nk),u=c(ik),s=c($M);function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,o.default)(t,[{key:"onRequest",value:function(e){var t=this;return!this.spark.internal.device.url||e.headers&&"cisco-device-url"in e.headers&&!e.headers["cisco-device-url"]?r.default.resolve(e):r.default.resolve(e.service||this.spark.internal.device.determineService(e.uri)).then(function(r){return r&&"oauth"!==r&&"saml"!==r&&"idbroker"!==r&&(0,s.default)(e,"headers['cisco-device-url']",t.spark.internal.device.url),e}).catch(function(t){if(t.message.match(/does not reflect a known service/))return e;throw t})}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(DM.Interceptor);t.default=l});t(fj);var dj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(bf),n=s(rk),i=s(Wm),o=s($m),a=s(nk),u=s(ik);function s(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,o.default)(t,[{key:"onResponseError",value:function(e,t){if(t instanceof Ix.SparkHttpError.InternalServerError&&e.uri){var n=this.spark.internal.device.features.developer.get("web-ha-messaging");if(n&&n.value)return this.spark.internal.metrics.submitClientMetrics("web-ha",{fields:{success:!1},tags:{action:"failed",error:t.message,url:e.uri}}),this.spark.internal.device.markUrlFailedAndGetNew(e.uri).then(function(){return r.default.reject(t)})}return r.default.reject(t)}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(DM.Interceptor);t.default=c});t(dj);var pj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={device:{preDiscoveryServices:{wdmServiceUrl:"https://wdm-a.wbx2.com/wdm/api/v1",hydraServiceUrl:"https://api.ciscospark.com/v1",wdm:"https://wdm-a.wbx2.com/wdm/api/v1",hydra:"https://api.ciscospark.com/v1"},defaults:{name:Ts.title||$E.inBrowser&&"browser",deviceType:"WEB",model:"web-js-sdk",localizedModel:"webex-js-sdk",systemName:"WEBEX_JS_SDK",systemVersion:"1.0.0"},enableInactivityEnforcement:!1,ephemeral:!1,ephemeralDeviceTTL:1800}}});t(pj);var hj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.config=t.ServerErrorInterceptor=t.DeviceUrlInterceptor=t.UrlInterceptor=t.EmbargoInterceptor=t.ServiceModel=t.ServiceCollection=t.FeatureModel=t.FeatureCollection=t.FeaturesModel=t.Device=t.default=void 0,Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s(sj).default}}),Object.defineProperty(t,"Device",{enumerable:!0,get:function(){return s(sj).default}}),Object.defineProperty(t,"FeaturesModel",{enumerable:!0,get:function(){return s(rj).default}}),Object.defineProperty(t,"FeatureCollection",{enumerable:!0,get:function(){return s(tj).default}}),Object.defineProperty(t,"FeatureModel",{enumerable:!0,get:function(){return s(ej).default}}),Object.defineProperty(t,"ServiceCollection",{enumerable:!0,get:function(){return s(aj).default}}),Object.defineProperty(t,"ServiceModel",{enumerable:!0,get:function(){return s(oj).default}}),Object.defineProperty(t,"EmbargoInterceptor",{enumerable:!0,get:function(){return s(cj).default}}),Object.defineProperty(t,"UrlInterceptor",{enumerable:!0,get:function(){return s(lj).default}}),Object.defineProperty(t,"DeviceUrlInterceptor",{enumerable:!0,get:function(){return s(fj).default}}),Object.defineProperty(t,"ServerErrorInterceptor",{enumerable:!0,get:function(){return s(dj).default}}),Object.defineProperty(t,"config",{enumerable:!0,get:function(){return s(pj).default}});var r=s(sj),n=s(pj),i=s(lj),o=s(fj),a=s(cj),u=s(dj);function s(e){return e&&e.__esModule?e:{default:e}}(0,Ix.registerInternalPlugin)("device",r.default,{interceptors:{UrlInterceptor:i.default.create,DeviceUrlInterceptor:o.default.create,EmbargoInterceptor:a.default.create,ServerErrorInterceptor:u.default.create},config:n.default,onBeforeLogout:function(){return this.unregister()}})});t(hj);hj.config,hj.ServerErrorInterceptor,hj.DeviceUrlInterceptor,hj.UrlInterceptor,hj.EmbargoInterceptor,hj.ServiceModel,hj.ServiceCollection,hj.FeatureModel,hj.FeatureCollection,hj.FeaturesModel,hj.Device;var vj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.config=t.default=void 0,Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i(Dx).default}}),Object.defineProperty(t,"config",{enumerable:!0,get:function(){return i(Lx).default}});var r=i(Dx),n=i(Lx);function i(e){return e&&e.__esModule?e:{default:e}}(0,Ix.registerPlugin)("authorization",r.default,{config:n.default,proxies:["isAuthorizing","isAuthenticating"]})});t(vj);vj.config;t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return(e=vj,e&&e.__esModule?e:{default:e}).default;var e}}),Object.defineProperty(t,"config",{enumerable:!0,get:function(){return vj.config}})}));var gj=LO(!0);tc(tc.S,"Object",{entries:function(e){return gj(e)}});var yj=$s.Object.entries,mj=r(function(e){e.exports={default:yj,__esModule:!0}});t(mj);var bj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.levels=void 0;var r=d(VT),n=d(cc),i=d(mj),o=d(yO),a=d(mO),u=d(YE),s=d(hP),c=d(sd),l=d(vp),f=(d(fT),d(gg));function d(e){return e&&e.__esModule?e:{default:e}}var p={silent:0,error:1,warn:2,log:3,info:4,debug:5,trace:6},h=t.levels=(0,u.default)(p).filter(function(e){return"silent"!==e}),v={error:["log"],warn:["error","log"],info:["log"],debug:["info","log"],trace:["debug","info","log"]},g=/[Aa]uthorization/;function y(e){if((0,l.default)(e))return e.map(y);if(!(0,c.default)(e))return(0,s.default)(e)&&$E.patterns.email.test(e)?"-- REDACTED --":e;var t=!0,r=!1,u=void 0;try{for(var f,d=(0,o.default)((0,i.default)(e));!(t=(f=d.next()).done);t=!0){var p=f.value,h=(0,a.default)(p,2),v=h[0],m=h[1];g.test(v)?(0,n.default)(e,v):e[v]=y(m)}}catch(e){r=!0,u=e}finally{try{!t&&d.return&&d.return()}finally{if(r)throw u}}return e}var m=Ix.SparkPlugin.extend({namespace:"Logger",derived:{level:{cache:!1,fn:function(){return this.getCurrentLevel()}}},session:{buffer:{type:"array",default:function(){return[]}}},filter:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.map(function(e){return e instanceof Error?e:y(e=(0,f.default)(e))})},shouldPrint:function(e){return p[e]<=p[this.getCurrentLevel()]},shouldBuffer:function(e){return p[e]<=p.info},getCurrentLevel:function(){if(this.config.level)return this.config.level;if(h.includes(Ts.env.CISCOSPARK_LOG_LEVEL))return Ts.env.CISCOSPARK_LOG_LEVEL;var e=this.spark.internal.device&&this.spark.internal.device.features.developer.get("log-level");return e&&h.includes(e)?e:"error"},version:"1.50.12"});h.forEach(function(e){var t=v[e],n=e;if(t)for(t=t.slice();!console[n];)n=t.pop();m.prototype[e]=function(){try{var t=this.shouldPrint(e),i=this.shouldBuffer(e);if(!i&&!t)return;var o=this.filter.apply(this,arguments),a=o.map(function(e){return e instanceof Ix.SparkHttpError?e.toString():e});if(t){var u,s=$E.inBrowser?a:o;(u=console)[n].apply(u,(0,r.default)(s))}i&&(a.unshift(Date.now()),this.buffer.push(a),this.buffer.length>this.config.historyLength&&this.buffer.shift())}catch(t){console.warn("failed to execute Logger#"+e,t)}}}),t.default=m});t(bj);bj.levels;var _j=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={logger:{level:Ts.env.LOGGER_LEVEL,historyLength:1e3}}});t(_j);var wj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.levels=t.default=void 0,Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i(bj).default}}),Object.defineProperty(t,"levels",{enumerable:!0,get:function(){return bj.levels}});var r=i(bj),n=i(_j);function i(e){return e&&e.__esModule?e:{default:e}}(0,Ix.registerPlugin)("logger",r.default,{config:n.default,replace:!0})});t(wj);wj.levels;var Sj=r(function(t){var r,n;r=e,n=function(){var e=!0;function t(t){function r(e){var r=t.match(e);return r&&r.length>1&&r[1]||""}function n(e){var r=t.match(e);return r&&r.length>1&&r[2]||""}var i,a=r(/(ipod|iphone|ipad)/i).toLowerCase(),u=!/like android/i.test(t)&&/android/i.test(t),s=/nexus\s*[0-6]\s*/i.test(t),c=!s&&/nexus\s*[0-9]+/i.test(t),l=/CrOS/.test(t),f=/silk/i.test(t),d=/sailfish/i.test(t),p=/tizen/i.test(t),h=/(web|hpw)(o|0)s/i.test(t),v=/windows phone/i.test(t),g=(/SamsungBrowser/i.test(t),!v&&/windows/i.test(t)),y=!a&&!f&&/macintosh/i.test(t),m=!u&&!d&&!p&&!h&&/linux/i.test(t),b=n(/edg([ea]|ios)\/(\d+(\.\d+)?)/i),_=r(/version\/(\d+(\.\d+)?)/i),w=/tablet/i.test(t)&&!/tablet pc/i.test(t),S=!w&&/[^-]mobi/i.test(t),k=/xbox/i.test(t);/opera/i.test(t)?i={name:"Opera",opera:e,version:_||r(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr\/|opios/i.test(t)?i={name:"Opera",opera:e,version:r(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||_}:/SamsungBrowser/i.test(t)?i={name:"Samsung Internet for Android",samsungBrowser:e,version:_||r(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/Whale/i.test(t)?i={name:"NAVER Whale browser",whale:e,version:r(/(?:whale)[\s\/](\d+(?:\.\d+)+)/i)}:/MZBrowser/i.test(t)?i={name:"MZ Browser",mzbrowser:e,version:r(/(?:MZBrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/coast/i.test(t)?i={name:"Opera Coast",coast:e,version:_||r(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}:/focus/i.test(t)?i={name:"Focus",focus:e,version:r(/(?:focus)[\s\/](\d+(?:\.\d+)+)/i)}:/yabrowser/i.test(t)?i={name:"Yandex Browser",yandexbrowser:e,version:_||r(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(t)?i={name:"UC Browser",ucbrowser:e,version:r(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/mxios/i.test(t)?i={name:"Maxthon",maxthon:e,version:r(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}:/epiphany/i.test(t)?i={name:"Epiphany",epiphany:e,version:r(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(t)?i={name:"Puffin",puffin:e,version:r(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(t)?i={name:"Sleipnir",sleipnir:e,version:r(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}:/k-meleon/i.test(t)?i={name:"K-Meleon",kMeleon:e,version:r(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:v?(i={name:"Windows Phone",osname:"Windows Phone",windowsphone:e},b?(i.msedge=e,i.version=b):(i.msie=e,i.version=r(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(t)?i={name:"Internet Explorer",msie:e,version:r(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:l?i={name:"Chrome",osname:"Chrome OS",chromeos:e,chromeBook:e,chrome:e,version:r(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/edg([ea]|ios)/i.test(t)?i={name:"Microsoft Edge",msedge:e,version:b}:/vivaldi/i.test(t)?i={name:"Vivaldi",vivaldi:e,version:r(/vivaldi\/(\d+(\.\d+)?)/i)||_}:d?i={name:"Sailfish",osname:"Sailfish OS",sailfish:e,version:r(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(t)?i={name:"SeaMonkey",seamonkey:e,version:r(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(t)?(i={name:"Firefox",firefox:e,version:r(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(t)&&(i.firefoxos=e,i.osname="Firefox OS")):f?i={name:"Amazon Silk",silk:e,version:r(/silk\/(\d+(\.\d+)?)/i)}:/phantom/i.test(t)?i={name:"PhantomJS",phantom:e,version:r(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(t)?i={name:"SlimerJS",slimer:e,version:r(/slimerjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(t)||/rim\stablet/i.test(t)?i={name:"BlackBerry",osname:"BlackBerry OS",blackberry:e,version:_||r(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:h?(i={name:"WebOS",osname:"WebOS",webos:e,version:_||r(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(t)&&(i.touchpad=e)):/bada/i.test(t)?i={name:"Bada",osname:"Bada",bada:e,version:r(/dolfin\/(\d+(\.\d+)?)/i)}:p?i={name:"Tizen",osname:"Tizen",tizen:e,version:r(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||_}:/qupzilla/i.test(t)?i={name:"QupZilla",qupzilla:e,version:r(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||_}:/chromium/i.test(t)?i={name:"Chromium",chromium:e,version:r(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||_}:/chrome|crios|crmo/i.test(t)?i={name:"Chrome",chrome:e,version:r(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:u?i={name:"Android",version:_}:/safari|applewebkit/i.test(t)?(i={name:"Safari",safari:e},_&&(i.version=_)):a?(i={name:"iphone"==a?"iPhone":"ipad"==a?"iPad":"iPod"},_&&(i.version=_)):i=/googlebot/i.test(t)?{name:"Googlebot",googlebot:e,version:r(/googlebot\/(\d+(\.\d+))/i)||_}:{name:r(/^(.*)\/(.*) /),version:n(/^(.*)\/(.*) /)},!i.msedge&&/(apple)?webkit/i.test(t)?(/(apple)?webkit\/537\.36/i.test(t)?(i.name=i.name||"Blink",i.blink=e):(i.name=i.name||"Webkit",i.webkit=e),!i.version&&_&&(i.version=_)):!i.opera&&/gecko\//i.test(t)&&(i.name=i.name||"Gecko",i.gecko=e,i.version=i.version||r(/gecko\/(\d+(\.\d+)?)/i)),i.windowsphone||!u&&!i.silk?!i.windowsphone&&a?(i[a]=e,i.ios=e,i.osname="iOS"):y?(i.mac=e,i.osname="macOS"):k?(i.xbox=e,i.osname="Xbox"):g?(i.windows=e,i.osname="Windows"):m&&(i.linux=e,i.osname="Linux"):(i.android=e,i.osname="Android");var E="";i.windows?E=function(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}(r(/Windows ((NT|XP)( \d\d?.\d)?)/i)):i.windowsphone?E=r(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):i.mac?E=(E=r(/Mac OS X (\d+([_\.\s]\d+)*)/i)).replace(/[_\s]/g,"."):a?E=(E=r(/os (\d+([_\s]\d+)*) like mac os x/i)).replace(/[_\s]/g,"."):u?E=r(/android[ \/-](\d+(\.\d+)*)/i):i.webos?E=r(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):i.blackberry?E=r(/rim\stablet\sos\s(\d+(\.\d+)*)/i):i.bada?E=r(/bada\/(\d+(\.\d+)*)/i):i.tizen&&(E=r(/tizen[\/\s](\d+(\.\d+)*)/i)),E&&(i.osversion=E);var P=!i.windows&&E.split(".")[0];return w||c||"ipad"==a||u&&(3==P||P>=4&&!S)||i.silk?i.tablet=e:(S||"iphone"==a||"ipod"==a||u||s||i.blackberry||i.webos||i.bada)&&(i.mobile=e),i.msedge||i.msie&&i.version>=10||i.yandexbrowser&&i.version>=15||i.vivaldi&&i.version>=1||i.chrome&&i.version>=20||i.samsungBrowser&&i.version>=4||i.whale&&1===o([i.version,"1.0"])||i.mzbrowser&&1===o([i.version,"6.0"])||i.focus&&1===o([i.version,"1.0"])||i.firefox&&i.version>=20||i.safari&&i.version>=6||i.opera&&i.version>=10||i.ios&&i.osversion&&i.osversion.split(".")[0]>=6||i.blackberry&&i.version>=10.1||i.chromium&&i.version>=20?i.a=e:i.msie&&i.version<10||i.chrome&&i.version<20||i.firefox&&i.version<20||i.safari&&i.version<6||i.opera&&i.version<10||i.ios&&i.osversion&&i.osversion.split(".")[0]<6||i.chromium&&i.version<20?i.c=e:i.x=e,i}var r=t("undefined"!=typeof navigator&&navigator.userAgent||"");function n(e){return e.split(".").length}function i(e,t){var r,n=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(r=0;r<e.length;r++)n.push(t(e[r]));return n}function o(e){for(var t=Math.max(n(e[0]),n(e[1])),r=i(e,function(e){var r=t-n(e);return i((e+=new Array(r+1).join(".0")).split("."),function(e){return new Array(20-e.length).join("0")+e}).reverse()});--t>=0;){if(r[0][t]>r[1][t])return 1;if(r[0][t]!==r[1][t])return-1;if(0===t)return 0}}function a(e,n,i){var a=r;"string"==typeof n&&(i=n,n=void 0),void 0===n&&(n=!1),i&&(a=t(i));var u=""+a.version;for(var s in e)if(e.hasOwnProperty(s)&&a[s]){if("string"!=typeof e[s])throw new Error("Browser version in the minVersion map should be a string: "+s+": "+String(e));return o([u,e[s]])<0}return n}return r.test=function(e){for(var t=0;t<e.length;++t){var n=e[t];if("string"==typeof n&&n in r)return!0}return!1},r.isUnsupportedBrowser=a,r.compareVersions=o,r.check=function(e,t,r){return!a(e,t,r)},r._detect=t,r.detect=t,r},t.exports?t.exports=n():r.bowser=n()}),kj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,r){void 0===r&&(r={}),this.execute=e,this.applicator=t,this.options=r}return Object.defineProperty(e.prototype,"bound",{get:function(){return null!=this.options.bound&&this.options.bound},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"setter",{get:function(){return null!=this.options.setter&&this.options.setter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getter",{get:function(){return null!=this.options.getter&&this.options.getter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"property",{get:function(){return null!=this.options.property&&this.options.property},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"method",{get:function(){return null==this.options.method||this.options.method},enumerable:!0,configurable:!0}),e}();t.DecoratorConfig=r});t(kj);kj.DecoratorConfig;var Ej=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.log=function(e){return void 0===e&&(e=""),"lodash-decorators -> "+e}});t(Ej);Ej.log;var Pj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.resolveFunction=function(e,t,r,n){if(void 0===n&&(n=!0),hd(e))return e;if(hP(e)){if(t&&hd(t[e]))return t[e];if(r&&hd(r[e]))return r[e]}if(n)throw new ReferenceError(Ej.log("Can not resolve method "+e+" on any target Objects"))}});t(Pj);Pj.resolveFunction;var Tj=function(e){return void 0===e},Oj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._weakMap=new WeakMap}return e.prototype.set=function(e,t){for(var r=this._weakMap,n=0,i=e.length-1;n<i;n++){var o=e[n],a=r.get(o);a||(a=new Map,r.set(o,a)),r=a}r.set(e[e.length-1],t)},e.prototype.get=function(e){for(var t=this._weakMap,r=0,n=e.length;r<n&&(t=t.get(e[r]),!Tj(t));r++);return t},e.prototype.has=function(e){return!Tj(this.get(e))},e}();t.CompositeKeyWeakMap=r});t(Oj);Oj.CompositeKeyWeakMap;var Cj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.returnAtIndex=function(e,t){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return e.call.apply(e,[this].concat(r)),r[t]}}});t(Cj);Cj.returnAtIndex;var Mj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.copyMetadata=function(e,t){return dP(t,function(t,r){return e[r]=t}),e}});t(Mj);Mj.copyMetadata;var xj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.bind=function(e,t){return Mj.copyMetadata(e.bind(t),e)}});t(xj);xj.bind;var jj=200;var Rj=function(e,t,r,n){var i=-1,o=Z_,a=!0,u=e.length,s=[],c=t.length;if(!u)return s;r&&(t=Rf(t,Pp(r))),n?(o=pT,a=!1):t.length>=jj&&(o=MP,a=!1,t=new OP(t));e:for(;++i<u;){var l=e[i],f=null==r?l:r(l);if(l=n||0!==l?l:0,a&&f==f){for(var d=c;d--;)if(t[d]===f)continue e;s.push(l)}else o(t,f,n)||s.push(l)}return s},Aj=v_(function(e,t){return yT(e)?Rj(e,t):[]}),Ij="[object DOMException]",Dj="[object Error]";var Lj=function(e){if(!sp(e))return!1;var t=ud(e);return t==Dj||t==Ij||"string"==typeof e.message&&"string"==typeof e.name&&!Gv(e)},Fj=v_(function(e,t){try{return Xv(e,void 0,t)}catch(e){return Lj(e)?e:new Error(e)}}),Nj=r(function(e,t){function r(e,t,r){var n=Object.getOwnPropertyDescriptor(e,r);if(!n||n.configurable){var i=Object.getOwnPropertyDescriptor(t,r);sd(i)?Object.defineProperty(e,r,i):e[r]=t[r]}}Object.defineProperty(t,"__esModule",{value:!0}),t.assignAll=function(e,t,n){void 0===n&&(n=[]);for(var i=0,o=Aj.apply(void 0,[Object.getOwnPropertyNames(t)].concat(n));i<o.length;i++){var a=o[i];Fj(r,e,t,a)}return e},t.assignProperty=r});t(Nj);Nj.assignAll,Nj.assignProperty;var Uj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=["length","name","arguments","called","prototype"];t.wrapConstructor=function(e,t){function n(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return t.call.apply(t,[this,e].concat(r))}return n.prototype=e.prototype,Object.defineProperty(n,"name",{configurable:!0,enumerable:!1,value:e.name,writable:!1}),Nj.assignAll(n,e,r)}});t(Uj);Uj.wrapConstructor;var zj=r(function(e,t){function r(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),r(Ej),r(Pj),r(Oj),r(Cj),r(Mj),r(xj),r(Uj),r(Nj)});t(zj);var qj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.InstanceChainMap=new zj.CompositeKeyWeakMap});t(qj);qj.InstanceChainMap;var Bj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.createDecorator=function(e){var t=this,r=e.applicator;return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return function(i,o,a){var u=t._resolveDescriptor(i,o,a),s=u.value,c=u.get,l=u.set;return qj.InstanceChainMap.has([i,o])||(hd(s)?u.value=zj.copyMetadata(r.apply({config:e,target:i,value:s,args:n}),s):hd(c)&&e.getter?u.get=zj.copyMetadata(r.apply({config:e,target:i,value:c,args:n}),c):hd(l)&&e.setter&&(u.set=zj.copyMetadata(r.apply({config:e,target:i,value:l,args:n}),c))),u}}},e.prototype.createInstanceDecorator=function(e){var t=this,r=e.applicator,n=e.bound;return function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return function(o,a,u){var s=t._resolveDescriptor(o,a,u),c=s.value,l=s.writable,f=s.enumerable,d=s.configurable,p=s.get,h=s.set,v=!qj.InstanceChainMap.has([o,a]),g=qj.InstanceChainMap.get([o,a])||{fns:[],properties:[]},y=v&&hd(p),m=v&&hd(h),b=v&&hd(c),_=v&&!y&&!m&&!b;if(g.properties.push(a),g.fns.push(function(a,u,s){return t._isApplicable(s,e)?(n&&(a=zj.bind(a,u)),zj.copyMetadata(r.apply({args:i,target:o,instance:u,value:a,config:e}),a)):a}),qj.InstanceChainMap.set([o,a],g),!v)return s;g.isSetter=m,g.isGetter=y,g.isMethod=b,g.isProperty=_;var w=function(e,t,r){return g.fns.reduce(function(e,n){return n(e,r,t)},e)},S=function(e){var t=p||void 0,r=h||void 0;if(y||m)y&&(t=w(p,{value:p,getter:!0},e)),m&&(r=w(h,{value:h,setter:!0},e)),Object.defineProperty(e,a,{enumerable:f,configurable:d,get:t,set:r});else if(b||_){var n=w(c,b?{value:c,method:!0}:{value:c,property:!0},e);Object.defineProperty(e,a,{writable:l,enumerable:f,configurable:d,value:n})}};return(b||_)&&(delete s.value,delete s.writable),s.get=function(){S(this);var e=Object.getOwnPropertyDescriptor(this,a);return e.get?e.get.call(this):e.value},s.set=function(e){S(this);var t=Object.getOwnPropertyDescriptor(this,a);t.set?t.set.call(this,e):(_||b)&&(this[a]=e)},s}}},e.prototype._isApplicable=function(e,t){return!Boolean(e.getter&&!t.getter||e.setter&&!t.setter||e.method&&!t.method||e.property&&!t.property)},e.prototype._resolveDescriptor=function(e,t,r){return r||(Object.getOwnPropertyDescriptor(e,t)||{})},e}();t.InternalDecoratorFactory=r,t.DecoratorFactory=new r});t(Bj);Bj.InternalDecoratorFactory,Bj.DecoratorFactory;var Wj=r(function(e,t){function r(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),r(kj),r(Bj),r(qj)});t(Wj);var Vj="Expected a function";var Gj=function(e,t){if("function"!=typeof t)throw new TypeError(Vj);return e=Ww(e),function(){if(--e<1)return t.apply(this,arguments)}},Hj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(){}}();t.Applicator=r});t(Hj);Hj.Applicator;var $j=function(e,t){return($j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};var Jj=function(){return(Jj=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function Yj(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function Kj(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}function Xj(e){return this instanceof Xj?(this.v=e,this):new Xj(e)}var Zj=Object.freeze({__extends:function(e,t){function r(){this.constructor=e}$j(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},get __assign(){return Jj},__rest:function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&(r[n[i]]=e[n[i]])}return r},__decorate:function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},__param:function(e,t){return function(r,n){t(r,n,e)}},__metadata:function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter:function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{s(n.next(e))}catch(e){o(e)}}function u(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(a,u)}s((n=n.apply(e,t||[])).next())})},__generator:function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},__exportStar:function(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])},__values:Yj,__read:Kj,__spread:function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Kj(arguments[t]));return e},__await:Xj,__asyncGenerator:function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){i[e]&&(n[e]=function(t){return new Promise(function(r,n){o.push([e,t,r,n])>1||u(e,t)})})}function u(e,t){try{(r=i[e](t)).value instanceof Xj?Promise.resolve(r.value.v).then(s,c):l(o[0][2],r)}catch(e){l(o[0][3],e)}var r}function s(e){u("next",e)}function c(e){u("throw",e)}function l(e,t){e(t),o.shift(),o.length&&u(o[0][0],o[0][1])}},__asyncDelegator:function(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:Xj(e[n](t)),done:"return"===n}:i?i(t):t}:i}},__asyncValues:function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=Yj(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){!function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)}(n,i,(t=e[r](t)).done,t.value)})}}},__makeTemplateObject:function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},__importStar:function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},__importDefault:function(e){return e&&e.__esModule?e:{default:e}}}),Qj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){void 0===t&&(t={});var r=e.call(this)||this;return r._config=t,r}return Zj.__extends(t,e),Object.defineProperty(t.prototype,"post",{get:function(){return!0===this._config.post},enumerable:!0,configurable:!0}),t.prototype.apply=function(e){var t=e.config.execute,r=e.value,n=void 0===r?tg:r,i=e.args,o=e.target,a=this;return function(){for(var e=this,r=[],u=0;u<arguments.length;u++)r[u]=arguments[u];var s=i.map(function(t){return zj.resolveFunction(t,e,o)}).slice();return a.post?s.push(n):s.unshift(n),t.apply(void 0,s).apply(this,r)}},t}(Hj.Applicator);t.ComposeApplicator=r});t(Qj);Qj.ComposeApplicator;var eR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zj.__extends(t,e),t.prototype.apply=function(e){var t=e.args,r=e.target,n=e.config.execute;return function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return n.apply(void 0,[zj.resolveFunction(t[0],this,r)].concat(t.slice(1))).apply(this,e)}},t}(Hj.Applicator);t.PartialApplicator=r});t(eR);eR.PartialApplicator;var tR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zj.__extends(t,e),t.prototype.apply=function(e){var t=e.config.execute,r=e.value,n=e.args;return eS.apply(void 0,[t,r].concat(n))},t}(Hj.Applicator);t.PartialedApplicator=r});t(tR);tR.PartialedApplicator;var rR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zj.__extends(t,e),t.prototype.apply=function(e){var t=e.args,r=e.target,n=e.value,i=e.config.execute;return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var a=n,u=0;return hd(a)||(a=zj.resolveFunction(t[0],this,r),u=1),i.apply(void 0,[a].concat(t.slice(u))).apply(this,e)}},t}(Hj.Applicator);t.PartialValueApplicator=r});t(rR);rR.PartialValueApplicator;var nR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zj.__extends(t,e),t.prototype.apply=function(e){var t=e.config,r=t.execute,n=(t.bound,e.args),i=e.value;return r.apply(void 0,n.concat([i]))},t}(Hj.Applicator);t.PostValueApplicator=r});t(nR);nR.PostValueApplicator;var iR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zj.__extends(t,e),t.prototype.apply=function(e){var t=e.value,r=e.config.execute,n=e.args;return r.apply(void 0,[t].concat(n))},t}(Hj.Applicator);t.PreValueApplicator=r});t(iR);iR.PreValueApplicator;var oR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zj.__extends(t,e),t.prototype.apply=function(e){var t=e.args,r=e.config.execute,n=e.target,i=e.value;return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return r(zj.resolveFunction(t[0],this,n),i).apply(this,e)}},t}(Hj.Applicator);t.WrapApplicator=r});t(oR);oR.WrapApplicator;var aR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zj.__extends(t,e),t.prototype.apply=function(e){var t=e.value,r=e.config.execute,n=e.args,i=e.instance;e.target;return i?r.apply(void 0,[t,i].concat(n)):t},t}(Hj.Applicator);t.BindApplicator=r});t(aR);aR.BindApplicator;var uR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zj.__extends(t,e),t.prototype.apply=function(e){var t=e.args,r=(e.target,e.config.execute),n=e.value;return function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return r.apply(void 0,[n.bind(this)].concat(e,t))}},t}(Hj.Applicator);t.InvokeApplicator=r});t(uR);uR.InvokeApplicator;var sR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zj.__extends(t,e),t.prototype.apply=function(e){var t=e.value,r=e.instance,n=e.config.execute,i=e.args,o=e.target,a=zj.resolveFunction(hd(i[0])?i[0]:sd(i[0])?i[0].resolver:i[0],r,o,!1);a&&r&&(a=a.bind(r));var u=a?n(t,a):n(t);if(sd(i[0])){var s=i[0],c=s.cache,l=s.type;c?u.cache=c:hd(l)&&(u.cache=new l)}return u},t}(Hj.Applicator);t.MemoizeApplicator=r});t(sR);sR.MemoizeApplicator;var cR=r(function(e,t){function r(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),r(Hj),r(Qj),r(eR),r(tR),r(rR),r(nR),r(iR),r(oR),r(aR),r(uR),r(sR)});t(cR);var lR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createInstanceDecorator(new Wj.DecoratorConfig(Gj,new cR.PostValueApplicator,{setter:!0}));function n(e){return r(e)}t.After=n,t.after=n,t.default=r});t(lR);lR.After,lR.after;var fR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createDecorator(new Wj.DecoratorConfig(Gj,new cR.PostValueApplicator,{setter:!0}));function n(e){return r(e)}t.AfterAll=n,t.afterAll=n,t.default=r});t(fR);fR.AfterAll,fR.afterAll;var dR=128;var pR=function(e,t,r){return t=r?void 0:t,t=e&&null==t?e.length:t,Zw(e,dR,void 0,void 0,void 0,void 0,t)},hR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createDecorator(new Wj.DecoratorConfig(pR,new cR.PreValueApplicator));function n(e){return r(e)}t.Ary=n,t.ary=n,t.default=r});t(hR);hR.Ary,hR.ary;var vR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createDecorator(new Wj.DecoratorConfig(function(e){return eS(Fj,e)},new cR.PreValueApplicator));function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e)}t.Attempt=n,t.attempt=n,t.default=r});t(vR);vR.Attempt,vR.attempt;var gR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createInstanceDecorator(new Wj.DecoratorConfig(_T,new cR.PostValueApplicator,{setter:!0}));function n(e){return r(e)}t.Before=n,t.before=n,t.default=r});t(gR);gR.Before,gR.before;var yR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createDecorator(new Wj.DecoratorConfig(_T,new cR.PostValueApplicator,{setter:!0}));function n(e){return r(e)}t.BeforeAll=n,t.beforeAll=n,t.default=r});t(yR);yR.BeforeAll,yR.beforeAll;var mR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createInstanceDecorator(new Wj.DecoratorConfig(zM,new cR.BindApplicator));function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e)}t.Bind=n,t.bind=n,t.default=r});t(mR);mR.Bind,mR.bind;var bR=r(function(e,t){function r(e){return void 0===e&&(e=[]),function(t){return zj.wrapConstructor(t,function(r){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];!function(e,t,r){void 0===r&&(r=[]);var n=e.prototype;for(;n&&n!==Object.prototype;){for(var i=0,o=Object.getOwnPropertyNames(n);i<o.length;i++){var a=o[i],u=!r.length||-1!==r.indexOf(a),s=Object.getOwnPropertyDescriptor(n,a);if(u&&"constructor"!==a&&!t.hasOwnProperty(a)){if(s.get){var c=Wj.InstanceChainMap.get([n,a]);if(!c||!c.isMethod)continue}var l=t[a];hd(l)&&Object.defineProperty(t,a,{configurable:!0,enumerable:s.enumerable,value:zj.copyMetadata(l.bind(t),l),writable:s.writable})}}n=Object.getPrototypeOf(n)}}(t,this,e),r.apply(this,n)})}}Object.defineProperty(t,"__esModule",{value:!0}),t.BindAll=r,t.bindAll=r,t.default=r});t(bR);bR.BindAll,bR.bindAll;var _R=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createInstanceDecorator(new Wj.DecoratorConfig(eO,new cR.PreValueApplicator,{bound:!0}));function n(e){return r(e)}t.Curry=n,t.curry=n,t.default=r});t(_R);_R.Curry,_R.curry;var wR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createDecorator(new Wj.DecoratorConfig(eO,new cR.PreValueApplicator));function n(e){return r(e)}t.CurryAll=n,t.curryAll=n,t.default=r});t(wR);wR.CurryAll,wR.curryAll;var SR=16;function kR(e,t,r){var n=Zw(e,SR,void 0,void 0,void 0,void 0,void 0,t=r?void 0:t);return n.placeholder=kR.placeholder,n}kR.placeholder={};var ER=kR,PR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createInstanceDecorator(new Wj.DecoratorConfig(ER,new cR.PreValueApplicator,{bound:!0}));function n(e){return r(e)}t.CurryRight=n,t.curryRight=n,t.default=r});t(PR);PR.CurryRight,PR.curryRight;var TR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createDecorator(new Wj.DecoratorConfig(ER,new cR.PreValueApplicator));function n(e){return r(e)}t.CurryRightAll=n,t.curryRightAll=n,t.default=r});t(TR);TR.CurryRightAll,TR.curryRightAll;var OR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createInstanceDecorator(new Wj.DecoratorConfig(XT,new cR.PreValueApplicator,{setter:!0}));function n(e,t){return r(e,t)}t.Debounce=n,t.debounce=n,t.default=r});t(OR);OR.Debounce,OR.debounce;var CR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createDecorator(new Wj.DecoratorConfig(XT,new cR.PreValueApplicator));function n(e,t){return r(e,t)}t.DebounceAll=n,t.debounceAll=n,t.default=r});t(CR);CR.DebounceAll,CR.debounceAll;var MR="Expected a function";var xR=function(e,t,r){if("function"!=typeof e)throw new TypeError(MR);return setTimeout(function(){e.apply(void 0,r)},t)},jR=v_(function(e,t){return xR(e,1,t)}),RR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createDecorator(new Wj.DecoratorConfig(jR,new cR.InvokeApplicator,{setter:!0}));function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e)}t.Defer=n,t.defer=n,t.default=r});t(RR);RR.Defer,RR.defer;var AR=v_(function(e,t,r){return xR(e,Uw(t)||0,r)}),IR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createDecorator(new Wj.DecoratorConfig(function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return AR.apply(void 0,[e.bind(this),t].concat(n,r))}},new cR.PreValueApplicator,{setter:!0}));function n(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return r.apply(void 0,[e].concat(t))}t.Delay=n,t.delay=n,t.default=r});t(IR);IR.Delay,IR.delay;var DR=512;var LR=function(e){return Zw(e,DR)},FR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createInstanceDecorator(new Wj.DecoratorConfig(LR,new cR.PartialValueApplicator,{property:!0}));function n(e){return r(e)}t.Flip=n,t.flip=n,t.default=r});t(FR);FR.Flip,FR.flip;var NR="Expected a function",UR=8,zR=32,qR=128,BR=256;var WR=function(e){return sg(function(t){var r=t.length,n=r,i=L_.prototype.thru;for(e&&t.reverse();n--;){var o=t[n];if("function"!=typeof o)throw new TypeError(NR);if(i&&!a&&"wrapper"==I_(o))var a=new L_([],!0)}for(n=a?n:r;++n<r;){o=t[n];var u=I_(o),s="wrapper"==u?j_(o):void 0;a=s&&q_(s[0])&&s[1]==(qR|UR|zR|BR)&&!s[4].length&&1==s[9]?a[I_(s[0])].apply(a,s[3]):1==o.length&&q_(o)?a[u]():a.thru(o)}return function(){var e=arguments,n=e[0];if(a&&1==e.length&&vp(n))return a.plant(n).value();for(var i=0,o=r?t[i].apply(this,e):n;++i<r;)o=t[i].call(this,o);return o}})},VR=WR(),GR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createInstanceDecorator(new Wj.DecoratorConfig(VR,new cR.ComposeApplicator({post:!0}),{property:!0}));function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e)}t.Flow=n,t.flow=n,t.default=r});t(GR);GR.Flow,GR.flow;var HR=WR(!0),$R=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createInstanceDecorator(new Wj.DecoratorConfig(HR,new cR.ComposeApplicator({post:!1}),{property:!0}));function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e)}t.FlowRight=n,t.flowRight=n,t.default=r});t($R);$R.FlowRight,$R.flowRight;var JR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createInstanceDecorator(new Wj.DecoratorConfig(wv,new cR.MemoizeApplicator));function n(e){return r(e)}t.Memoize=n,t.memoize=n,t.default=r});t(JR);JR.Memoize,JR.memoize;var YR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createDecorator(new Wj.DecoratorConfig(wv,new cR.MemoizeApplicator));function n(e){return r(e)}t.MemoizeAll=n,t.memoizeAll=n,t.default=r});t(YR);YR.MemoizeAll,YR.memoizeAll;var KR=r(function(e,t){function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return nP.apply(void 0,[t.prototype].concat(e)),t}}Object.defineProperty(t,"__esModule",{value:!0}),t.Mixin=r,t.mixin=r,t.default=r});t(KR);KR.Mixin,KR.mixin;var XR="Expected a function";var ZR=function(e){if("function"!=typeof e)throw new TypeError(XR);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}},QR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createInstanceDecorator(new Wj.DecoratorConfig(ZR,new cR.PartialValueApplicator,{property:!0}));function n(e){return r(e)}t.Negate=n,t.negate=n,t.default=r});t(QR);QR.Negate,QR.negate;var eA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createInstanceDecorator(new Wj.DecoratorConfig(wT,new cR.PreValueApplicator,{setter:!0}));function n(){return r()}t.Once=n,t.once=n,t.default=r});t(eA);eA.Once,eA.once;var tA=v_,rA=Math.min,nA=tA(function(e,t){var r=(t=1==t.length&&vp(t[0])?Rf(t[0],Pp(Kx)):Rf(Yv(t,1),Pp(Kx))).length;return v_(function(n){for(var i=-1,o=rA(n.length,r);++i<o;)n[i]=t[i].call(this,n[i]);return Xv(e,this,n)})}),iA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createDecorator(new Wj.DecoratorConfig(nA,new cR.PreValueApplicator,{setter:!0}));function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e)}t.OverArgs=n,t.overArgs=n,t.default=r});t(iA);iA.OverArgs,iA.overArgs;var oA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createInstanceDecorator(new Wj.DecoratorConfig(eS,new cR.PartialApplicator,{property:!0,method:!1}));function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e)}t.Partial=n,t.partial=n,t.default=r});t(oA);oA.Partial,oA.partial;var aA=v_(function(e,t){var r=pw(t,cw(aA));return Zw(e,64,void 0,t,r)});aA.placeholder={};var uA=aA,sA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createInstanceDecorator(new Wj.DecoratorConfig(uA,new cR.PartialApplicator,{property:!0,method:!1}));function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e)}t.PartialRight=n,t.partialRight=n,t.default=r});t(sA);sA.PartialRight,sA.partialRight;var cA=sg(function(e,t){return Zw(e,256,void 0,void 0,void 0,t)}),lA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createInstanceDecorator(new Wj.DecoratorConfig(cA,new cR.PartialValueApplicator,{property:!0}));function n(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return r.apply(void 0,[e].concat(t))}t.Rearg=n,t.rearg=n,t.default=r});t(lA);lA.Rearg,lA.rearg;var fA="Expected a function";var dA=function(e,t){if("function"!=typeof e)throw new TypeError(fA);return t=void 0===t?t:Ww(t),v_(e,t)},pA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createDecorator(new Wj.DecoratorConfig(dA,new cR.PreValueApplicator));function n(e){return r(e)}t.Rest=n,t.rest=n,t.default=r});t(pA);pA.Rest,pA.rest;var hA=function(e,t,r){var n=e.length;return r=void 0===r?n:r,!t&&r>=n?e:Lv(e,t,r)},vA="Expected a function",gA=Math.max;var yA=function(e,t){if("function"!=typeof e)throw new TypeError(vA);return t=null==t?0:gA(Ww(t),0),v_(function(r){var n=r[t],i=hA(r,0,t);return n&&Qp(i,n),Xv(e,this,i)})},mA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createDecorator(new Wj.DecoratorConfig(yA,new cR.PreValueApplicator));function n(e){return r(e)}t.Spread=n,t.spread=n,t.default=r});t(mA);mA.Spread,mA.spread;var bA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createDecorator(new Wj.DecoratorConfig(function(e){return zj.returnAtIndex(e,0)},new cR.PreValueApplicator));function n(){return r()}t.Tap=n,t.tap=n,t.default=r});t(bA);bA.Tap,bA.tap;var _A="Expected a function";var wA=function(e,t,r){var n=!0,i=!0;if("function"!=typeof e)throw new TypeError(_A);return sd(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),XT(e,t,{leading:n,maxWait:t,trailing:i})},SA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createInstanceDecorator(new Wj.DecoratorConfig(wA,new cR.PreValueApplicator,{setter:!0,getter:!0})),n=Wj.DecoratorFactory.createInstanceDecorator(new Wj.DecoratorConfig(wA,new cR.PreValueApplicator,{getter:!0})),i=Wj.DecoratorFactory.createInstanceDecorator(new Wj.DecoratorConfig(wA,new cR.PreValueApplicator,{setter:!0}));function o(e,t){return r(e,t)}function a(e,t){return n(e,t)}function u(e,t){return i(e,t)}t.Throttle=o,t.throttle=o,t.ThrottleGetter=a,t.throttleGetter=a,t.ThrottleSetter=u,t.throttleSetter=u,t.default=r});t(SA);SA.Throttle,SA.throttle,SA.ThrottleGetter,SA.throttleGetter,SA.ThrottleSetter,SA.throttleSetter;var kA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createDecorator(new Wj.DecoratorConfig(wA,new cR.PreValueApplicator,{setter:!0}));function n(e,t){return r(e,t)}t.ThrottleAll=n,t.throttleAll=n,t.default=r});t(kA);kA.ThrottleAll,kA.throttleAll;var EA=function(e){return pR(e,1)},PA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createDecorator(new Wj.DecoratorConfig(EA,new cR.PreValueApplicator));function n(){return r()}t.Unary=n,t.unary=n,t.default=r});t(PA);PA.Unary,PA.unary;var TA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Wj.DecoratorFactory.createDecorator(new Wj.DecoratorConfig(tS,new cR.WrapApplicator));function n(e){return r(e)}t.Wrap=n,t.wrap=n,t.default=r});t(TA);TA.Wrap,TA.wrap;var OA=r(function(e,t){function r(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),r(Wj),r(lR),r(fR),r(hR),r(vR),r(gR),r(yR),r(mR),r(bR),r(_R),r(wR),r(PR),r(TR),r(OR),r(CR),r(RR),r(IR),r(FR),r(GR),r($R),r(JR),r(YR),r(KR),r(QR),r(eA),r(iA),r(oA),r(sA),r(lA),r(pA),r(mA),r(bA),r(SA),r(kA),r(PA),r(TA)});t(OA);var CA=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(cc),n=o(p_),i=o(hb);function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,n){var i=n.initializer&&n.initializer();(0,r.default)(n,"value"),(0,r.default)(n,"initializer"),(0,r.default)(n,"writable"),n.get=function(){var e=a.get(this,t);return void 0!==e?e:i},n.set=function(e){var r=this[t];r!==e&&(a.set(this,t,e),this.trigger("change:"+t,e,r),this.trigger("change"))}};var a=new((0,$E.make)(i.default,n.default))});t(CA);var MA=r(function(e){var t=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-\.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))? (\S*)(?: (\S*))?/,names:["value","direction","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+" %s"+(e.config?" %s":"")}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"invalid",names:["value"]}]};Object.keys(t).forEach(function(e){t[e].forEach(function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")})})}),xA=(MA.v,MA.o,MA.s,MA.i,MA.u,MA.e,MA.p,MA.z,MA.r,MA.t,MA.c,MA.b,MA.m,MA.a,r(function(e,t){var r=function(e){return String(Number(e))===e?Number(e):e},n=function(e,t,n){var i=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:i&&!t[e.name]&&(t[e.name]={});var o=e.push?{}:i?t[e.name]:t;!function(e,t,n,i){if(i&&!n)t[i]=r(e[1]);else for(var o=0;o<n.length;o+=1)null!=e[o+1]&&(t[n[o]]=r(e[o+1]))}(n.match(e.reg),o,e.names,e.name),e.push&&t[e.push].push(o)},i=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},r=[],o=t;return e.split(/(\r\n|\r|\n)/).filter(i).forEach(function(e){var t=e[0],i=e.slice(2);"m"===t&&(r.push({rtp:[],fmtp:[]}),o=r[r.length-1]);for(var a=0;a<(MA[t]||[]).length;a+=1){var u=MA[t][a];if(u.reg.test(i))return n(u,o,i)}}),t.media=r,t};var o=function(e,t){var n=t.split(/=(.+)/,2);return 2===n.length?e[n[0]]=r(n[1]):1===n.length&&t.length>1&&(e[n[0]]=void 0),e};t.parseParams=function(e){return e.split(/\;\s?/).reduce(o,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],n=e.split(" ").map(r),i=0;i<n.length;i+=3)t.push({component:n[i],ip:n[i+1],port:n[i+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map(function(e){return e.substring(1,e.length-1).split(",").reduce(o,{})})},t.parseSimulcastStreamList=function(e){return e.split(";").map(function(e){return e.split(",").map(function(e){var t,n=!1;return"~"!==e[0]?t=r(e):(t=r(e.substring(1,e.length)),n=!0),{scid:t,paused:n}})})}})),jA=(xA.parse,xA.parseParams,xA.parseFmtpConfig,xA.parsePayloads,xA.parseRemoteCandidates,xA.parseImageAttributes,xA.parseSimulcastStreamList,/%[sdv%]/g),RA=function(e,t,r){var n=[e+"="+(t.format instanceof Function?t.format(t.push?r:r[t.name]):t.format)];if(t.names)for(var i=0;i<t.names.length;i+=1){var o=t.names[i];t.name?n.push(r[t.name][o]):n.push(r[t.names[i]])}else n.push(r[t.name]);return function(e){var t=1,r=arguments,n=r.length;return e.replace(jA,function(e){if(t>=n)return e;var i=r[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}})}.apply(null,n)},AA=["v","o","s","i","u","e","p","c","b","t","r","z","a"],IA=["i","c","b","a"],DA={write:function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach(function(e){null==e.payloads&&(e.payloads="")});var r=t.outerOrder||AA,n=t.innerOrder||IA,i=[];return r.forEach(function(t){MA[t].forEach(function(r){r.name in e&&null!=e[r.name]?i.push(RA(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach(function(e){i.push(RA(t,r,e))})})}),e.media.forEach(function(e){i.push(RA("m",MA.m[0],e)),n.forEach(function(t){MA[t].forEach(function(r){r.name in e&&null!=e[r.name]?i.push(RA(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach(function(e){i.push(RA(t,r,e))})})})}),i.join("\r\n")+"\r\n"},parse:xA.parse,parseFmtpConfig:xA.parseFmtpConfig,parseParams:xA.parseParams,parsePayloads:xA.parsePayloads,parseRemoteCandidates:xA.parseRemoteCandidates,parseImageAttributes:xA.parseImageAttributes,parseSimulcastStreamList:xA.parseSimulcastStreamList};var LA=function(e,t){var r=[];return kT(e,function(e,n,i){t(e,n,i)&&r.push(e)}),r};var FA=function(e,t){return(vp(e)?$p:LA)(e,Kx(t,3))},NA=!0,UA=!0;function zA(e,t,r){var n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}var qA={extractVersion:zA,wrapPeerConnectionEvent:function(e,t,r){if(e.RTCPeerConnection){var n=e.RTCPeerConnection.prototype,i=n.addEventListener;n.addEventListener=function(e,n){if(e!==t)return i.apply(this,arguments);var o=function(e){var t=r(e);t&&n(t)};return this._eventMap=this._eventMap||{},this._eventMap[n]=o,i.apply(this,[e,o])};var o=n.removeEventListener;n.removeEventListener=function(e,r){if(e!==t||!this._eventMap||!this._eventMap[r])return o.apply(this,arguments);var n=this._eventMap[r];return delete this._eventMap[r],o.apply(this,[e,n])},Object.defineProperty(n,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}},disableLog:function(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(NA=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},disableWarnings:function(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(UA=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},log:function(){if("object"==typeof window){if(NA)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},deprecated:function(e,t){UA&&console.warn(e+" is deprecated, please use "+t+" instead.")},detectBrowser:function(e){var t=e&&e.navigator,r={browser:null,version:null};if(void 0===e||!e.navigator)return r.browser="Not a browser.",r;if(t.mozGetUserMedia)r.browser="firefox",r.version=zA(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia)r.browser="chrome",r.version=zA(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))r.browser="edge",r.version=zA(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return r.browser="Not a supported browser.",r;r.browser="safari",r.version=zA(t.userAgent,/AppleWebKit\/(\d+)\./,1)}return r}},BA=qA.log,WA=qA.log;function VA(e,t,r){var n=r?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;var o=[];return e.forEach(function(e){"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)}),o.forEach(function(t){e.forEach(function(r){r.type===n&&r.trackId===t.id&&function e(t,r,n){r&&!n.has(r.id)&&(n.set(r.id,r),Object.keys(r).forEach(function(i){i.endsWith("Id")?e(t,t.get(r[i]),n):i.endsWith("Ids")&&r[i].forEach(function(r){e(t,t.get(r),n)})}))}(e,r,i)})}),i}var GA={shimGetUserMedia:function(e){var t=qA.detectBrowser(e),r=e&&e.navigator,n=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach(function(r){if("require"!==r&&"advanced"!==r&&"mediaSource"!==r){var n="object"==typeof e[r]?e[r]:{ideal:e[r]};void 0!==n.exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==n.ideal){t.optional=t.optional||[];var o={};"number"==typeof n.ideal?(o[i("min",r)]=n.ideal,t.optional.push(o),(o={})[i("max",r)]=n.ideal,t.optional.push(o)):(o[i("",r)]=n.ideal,t.optional.push(o))}void 0!==n.exact&&"number"!=typeof n.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",r)]=n.exact):["min","max"].forEach(function(e){void 0!==n[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,r)]=n[e])})}}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},i=function(e,i){if(t.version>=61)return i(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){var o=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])};o((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),o(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=n(e.audio)}if(e&&"object"==typeof e.video){var a=e.video.facingMode;a=a&&("object"==typeof a?a:{ideal:a});var u,s=t.version<66;if(a&&("user"===a.exact||"environment"===a.exact||"user"===a.ideal||"environment"===a.ideal)&&(!r.mediaDevices.getSupportedConstraints||!r.mediaDevices.getSupportedConstraints().facingMode||s)&&(delete e.video.facingMode,"environment"===a.exact||"environment"===a.ideal?u=["back","rear"]:"user"!==a.exact&&"user"!==a.ideal||(u=["front"]),u))return r.mediaDevices.enumerateDevices().then(function(t){var r=(t=t.filter(function(e){return"videoinput"===e.kind})).find(function(e){return u.some(function(t){return-1!==e.label.toLowerCase().indexOf(t)})});return!r&&t.length&&-1!==u.indexOf("back")&&(r=t[t.length-1]),r&&(e.video.deviceId=a.exact?{exact:r.deviceId}:{ideal:r.deviceId}),e.video=n(e.video),BA("chrome: "+JSON.stringify(e)),i(e)});e.video=n(e.video)}return BA("chrome: "+JSON.stringify(e)),i(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};r.getUserMedia=function(e,t,n){i(e,function(e){r.webkitGetUserMedia(e,t,function(e){n&&n(o(e))})})};var a=function(e){return new Promise(function(t,n){r.getUserMedia(e,t,n)})};if(r.mediaDevices||(r.mediaDevices={getUserMedia:a,enumerateDevices:function(){return new Promise(function(t){var r={audio:"audioinput",video:"videoinput"};return e.MediaStreamTrack.getSources(function(e){t(e.map(function(e){return{label:e.label,kind:r[e.kind],deviceId:e.id,groupId:""}}))})})},getSupportedConstraints:function(){return{deviceId:!0,echoCancellation:!0,facingMode:!0,frameRate:!0,height:!0,width:!0}}}),r.mediaDevices.getUserMedia){var u=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(e){return i(e,function(e){return u(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return t},function(e){return Promise.reject(o(e))})})}}else r.mediaDevices.getUserMedia=function(e){return a(e)};void 0===r.mediaDevices.addEventListener&&(r.mediaDevices.addEventListener=function(){BA("Dummy mediaDevices.addEventListener called.")}),void 0===r.mediaDevices.removeEventListener&&(r.mediaDevices.removeEventListener=function(){BA("Dummy mediaDevices.removeEventListener called.")})},shimMediaStream:function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},shimOnTrack:function(e){if("object"!=typeof e||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype)qA.wrapPeerConnectionEvent(e,"track",function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e});else{Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var r=this;return r._ontrackpoly||(r._ontrackpoly=function(t){t.stream.addEventListener("addtrack",function(n){var i;i=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find(function(e){return e.track&&e.track.id===n.track.id}):{track:n.track};var o=new Event("track");o.track=n.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],r.dispatchEvent(o)}),t.stream.getTracks().forEach(function(n){var i;i=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find(function(e){return e.track&&e.track.id===n.id}):{track:n};var o=new Event("track");o.track=n,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],r.dispatchEvent(o)})},r.addEventListener("addstream",r._ontrackpoly)),t.apply(r,arguments)}}},shimGetSendersWithDtmf:function(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){var i=r.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){n.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;r._senders=r._senders||[],i.apply(r,[e]),e.getTracks().forEach(function(e){r._senders.push(t(r,e))})};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;t._senders=t._senders||[],o.apply(t,[e]),e.getTracks().forEach(function(e){var r=t._senders.find(function(t){return t.track===e});r&&t._senders.splice(t._senders.indexOf(r),1)})}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=a.apply(e,[]);return t.forEach(function(t){t._pc=e}),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},shimSenderReceiverGetStats:function(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(e,[]);return r.forEach(function(t){t._pc=e}),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then(function(t){return VA(t,e.track,!0)})}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var n=e.RTCPeerConnection.prototype.getReceivers;n&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=n.apply(e,[]);return t.forEach(function(t){t._pc=e}),t}),qA.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then(function(t){return VA(t,e.track,!1)})}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t,r,n,o=arguments[0];return this.getSenders().forEach(function(e){e.track===o&&(t?n=!0:t=e)}),this.getReceivers().forEach(function(e){return e.track===o&&(r?n=!0:r=e),e.track===o}),n||t&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return i.apply(this,arguments)}}}},shimSourceObject:function(e){var t=e&&e.URL;"object"==typeof e&&(!e.HTMLMediaElement||"srcObject"in e.HTMLMediaElement.prototype||Object.defineProperty(e.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(e){var r=this;this._srcObject=e,this.src&&t.revokeObjectURL(this.src),e?(this.src=t.createObjectURL(e),e.addEventListener("addtrack",function(){r.src&&t.revokeObjectURL(r.src),r.src=t.createObjectURL(e)}),e.addEventListener("removetrack",function(){r.src&&t.revokeObjectURL(r.src),r.src=t.createObjectURL(e)})):this.src=""}}))},shimAddTrackRemoveTrackWithNative:function(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(t){return e._shimmedLocalStreams[t][0]})};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var n=t.apply(this,arguments);return this._shimmedLocalStreams[r.id]?-1===this._shimmedLocalStreams[r.id].indexOf(n)&&this._shimmedLocalStreams[r.id].push(n):this._shimmedLocalStreams[r.id]=[r,n],n};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(function(e){if(t.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError")});var n=t.getSenders();r.apply(this,arguments);var i=t.getSenders().filter(function(e){return-1===n.indexOf(e)});this._shimmedLocalStreams[e.id]=[e].concat(i)};var n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],n.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach(function(r){var n=t._shimmedLocalStreams[r].indexOf(e);-1!==n&&t._shimmedLocalStreams[r].splice(n,1),1===t._shimmedLocalStreams[r].length&&delete t._shimmedLocalStreams[r]}),i.apply(this,arguments)}},shimAddTrackRemoveTrack:function(e){if(e.RTCPeerConnection){var t=qA.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return this.shimAddTrackRemoveTrackWithNative(e);var r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=r.apply(this);return e._reverseStreams=e._reverseStreams||{},t.map(function(t){return e._reverseStreams[t.id]})};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var r=this;if(r._streams=r._streams||{},r._reverseStreams=r._reverseStreams||{},t.getTracks().forEach(function(e){if(r.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError")}),!r._reverseStreams[t.id]){var i=new e.MediaStream(t.getTracks());r._streams[t.id]=i,r._reverseStreams[i.id]=t,t=i}n.apply(r,[t])};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;t._streams=t._streams||{},t._reverseStreams=t._reverseStreams||{},i.apply(t,[t._streams[e.id]||e]),delete t._reverseStreams[t._streams[e.id]?t._streams[e.id].id:e.id],delete t._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,r){var n=this;if("closed"===n.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find(function(e){return e===t}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(n.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError");n._streams=n._streams||{},n._reverseStreams=n._reverseStreams||{};var o=n._streams[r.id];if(o)o.addTrack(t),Promise.resolve().then(function(){n.dispatchEvent(new Event("negotiationneeded"))});else{var a=new e.MediaStream([t]);n._streams[r.id]=a,n._reverseStreams[a.id]=r,n.addStream(a)}return n.getSenders().find(function(e){return e.track===t})},["createOffer","createAnswer"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=this,t=arguments;return arguments.length&&"function"==typeof arguments[0]?r.apply(e,[function(r){var n=u(e,r);t[0].apply(null,[n])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):r.apply(e,arguments).then(function(t){return u(e,t)})}});var o=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(function(t){var n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(n.id,"g"),i.id)}),new RTCSessionDescription({type:t.type,sdp:r})}(this,arguments[0]),o.apply(this,arguments)):o.apply(this,arguments)};var a=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=a.get.apply(this);return""===e.type?e:u(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,r=this;if("closed"===r.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===r))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");r._streams=r._streams||{},Object.keys(r._streams).forEach(function(n){r._streams[n].getTracks().find(function(t){return e.track===t})&&(t=r._streams[n])}),t&&(1===t.getTracks().length?r.removeStream(r._reverseStreams[t.id]):t.removeTrack(e.track),r.dispatchEvent(new Event("negotiationneeded")))}}function u(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(function(t){var n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(i.id,"g"),n.id)}),new RTCSessionDescription({type:t.type,sdp:r})}},shimPeerConnection:function(e){var t=qA.detectBrowser(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=function(t,r){return WA("PeerConnection"),t&&t.iceTransportPolicy&&(t.iceTransports=t.iceTransportPolicy),new e.webkitRTCPeerConnection(t,r)},e.RTCPeerConnection.prototype=e.webkitRTCPeerConnection.prototype,e.webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return e.webkitRTCPeerConnection.generateCertificate}})),e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,t,n){var i=this,o=arguments;if(arguments.length>0&&"function"==typeof e)return r.apply(this,arguments);if(0===r.length&&(0===arguments.length||"function"!=typeof arguments[0]))return r.apply(this,[]);var a=function(e){var t={};return e.result().forEach(function(e){var r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(function(t){r[t]=e.stat(t)}),t[r.id]=r}),t},u=function(e){return new Map(Object.keys(e).map(function(t){return[t,e[t]]}))};if(arguments.length>=2){return r.apply(this,[function(e){o[1](u(a(e)))},arguments[0]])}return new Promise(function(e,t){r.apply(i,[function(t){e(u(a(t)))},t])}).then(t,n)},t.version<51&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=arguments,t=this,n=new Promise(function(n,i){r.apply(t,[e[0],n,i])});return e.length<2?n:n.then(function(){e[1].apply(null,[])},function(t){e.length>=3&&e[2].apply(null,[t])})}}),t.version<52&&["createOffer","createAnswer"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=this;if(arguments.length<1||1===arguments.length&&"object"==typeof arguments[0]){var t=1===arguments.length?arguments[0]:void 0;return new Promise(function(n,i){r.apply(e,[n,i,t])})}return r.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}});var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},fixNegotiationNeeded:function(e){qA.wrapPeerConnectionEvent(e,"negotiationneeded",function(e){if("stable"===e.target.signalingState)return e})},shimGetDisplayMedia:function(e,t){!e.navigator||!e.navigator.mediaDevices||"getDisplayMedia"in e.navigator.mediaDevices||("function"==typeof t?(e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then(function(t){var n=r.video&&r.video.width,i=r.video&&r.video.height,o=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},n&&(r.video.mandatory.maxWidth=n),i&&(r.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(r)})},e.navigator.getDisplayMedia=function(t){return qA.deprecated("navigator.getDisplayMedia","navigator.mediaDevices.getDisplayMedia"),e.navigator.mediaDevices.getDisplayMedia(t)}):console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}},HA=r(function(e){var t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},t.splitSections=function(e){return e.split("\nm=").map(function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"})},t.getDescription=function(e){var r=t.splitSections(e);return r&&r[0]},t.getMediaSections=function(e){var r=t.splitSections(e);return r.shift(),r},t.matchPrefix=function(e,r){return t.splitLines(e).filter(function(e){return 0===e.indexOf(r)})},t.parseCandidate=function(e){for(var t,r={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},n=8;n<t.length;n+=2)switch(t[n]){case"raddr":r.relatedAddress=t[n+1];break;case"rport":r.relatedPort=parseInt(t[n+1],10);break;case"tcptype":r.tcpType=t[n+1];break;case"ufrag":r.ufrag=t[n+1],r.usernameFragment=t[n+1];break;default:r[t[n]]=t[n+1]}return r},t.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){var t=e.substr(9).split(" "),r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.channels=3===t.length?parseInt(t[2],10):1,r.numChannels=r.channels,r},t.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},t.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){for(var t,r={},n=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<n.length;i++)r[(t=n[i].trim().split("="))[0].trim()]=t[1];return r},t.writeFmtp=function(e){var t="",r=e.payloadType;if(void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var n=[];Object.keys(e.parameters).forEach(function(t){e.parameters[t]?n.push(t+"="+e.parameters[t]):n.push(t)}),t+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){var t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},t.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:parseInt(e.substr(7,t-7),10)},n=e.indexOf(":",t);return n>-1?(r.attribute=e.substr(t+1,n-t-1),r.value=e.substr(n+1)):r.attribute=e.substr(t+1),r},t.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map(function(e){return parseInt(e,10)})}},t.getMid=function(e){var r=t.matchPrefix(e,"a=mid:")[0];if(r)return r.substr(6)},t.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},t.getDtlsParameters=function(e,r){return{role:"auto",fingerprints:t.matchPrefix(e+r,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),r},t.getIceParameters=function(e,r){var n=t.splitLines(e);return{usernameFragment:(n=n.concat(t.splitLines(r))).filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:n.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)}},t.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},t.parseRtpParameters=function(e){for(var r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=t.splitLines(e)[0].split(" "),i=3;i<n.length;i++){var o=n[i],a=t.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){var u=t.parseRtpMap(a),s=t.matchPrefix(e,"a=fmtp:"+o+" ");switch(u.parameters=s.length?t.parseFmtp(s[0]):{},u.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(t.parseRtcpFb),r.codecs.push(u),u.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(u.name.toUpperCase())}}}return t.matchPrefix(e,"a=extmap:").forEach(function(e){r.headerExtensions.push(t.parseExtmap(e))}),r},t.writeRtpDescription=function(e,r){var n="";n+="m="+e+" ",n+=r.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=r.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",r.codecs.forEach(function(e){n+=t.writeRtpMap(e),n+=t.writeFmtp(e),n+=t.writeRtcpFb(e)});var i=0;return r.codecs.forEach(function(e){e.maxptime>i&&(i=e.maxptime)}),i>0&&(n+="a=maxptime:"+i+"\r\n"),n+="a=rtcp-mux\r\n",r.headerExtensions&&r.headerExtensions.forEach(function(e){n+=t.writeExtmap(e)}),n},t.parseRtpEncodingParameters=function(e){var r,n=[],i=t.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),a=-1!==i.fecMechanisms.indexOf("ULPFEC"),u=t.matchPrefix(e,"a=ssrc:").map(function(e){return t.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),s=u.length>0&&u[0].ssrc,c=t.matchPrefix(e,"a=ssrc-group:FID").map(function(e){return e.substr(17).split(" ").map(function(e){return parseInt(e,10)})});c.length>0&&c[0].length>1&&c[0][0]===s&&(r=c[0][1]),i.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)};s&&r&&(t.rtx={ssrc:r}),n.push(t),o&&((t=JSON.parse(JSON.stringify(t))).fec={ssrc:s,mechanism:a?"red+ulpfec":"red"},n.push(t))}}),0===n.length&&s&&n.push({ssrc:s});var l=t.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,n.forEach(function(e){e.maxBitrate=l})),n},t.parseRtcpParameters=function(e){var r={},n=t.matchPrefix(e,"a=ssrc:").map(function(e){return t.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];n&&(r.cname=n.value,r.ssrc=n.ssrc);var i=t.matchPrefix(e,"a=rtcp-rsize");r.reducedSize=i.length>0,r.compound=0===i.length;var o=t.matchPrefix(e,"a=rtcp-mux");return r.mux=o.length>0,r},t.parseMsid=function(e){var r,n=t.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(r=n[0].substr(7).split(" "))[0],track:r[1]};var i=t.matchPrefix(e,"a=ssrc:").map(function(e){return t.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});return i.length>0?{stream:(r=i[0].value.split(" "))[0],track:r[1]}:void 0},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,r,n){var i=void 0!==r?r:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||t.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.writeMediaSection=function(e,r,n,i){var o=t.writeRtpDescription(e.kind,r);if(o+=t.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=t.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var a="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+t.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+t.localCName+"\r\n"),o},t.getDirection=function(e,r){for(var n=t.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return r?t.getDirection(r):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){var r=t.splitLines(e)[0].substr(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}},t.parseOLine=function(e){var r=t.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var r=t.splitLines(e),n=0;n<r.length;n++)if(r[n].length<2||"="!==r[n].charAt(1))return!1;return!0},e.exports=t});function $A(e,t,r,n,i){var o=HA.writeRtpDescription(e.kind,t);if(o+=HA.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=HA.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":i||"active"),o+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var a=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=a;var u="msid:"+(n?n.id:"-")+" "+a+"\r\n";o+="a="+u,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+u,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+u,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+HA.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+HA.localCName+"\r\n"),o}function JA(e,t){var r={codecs:[],headerExtensions:[],fecMechanisms:[]},n=function(e,t){e=parseInt(e,10);for(var r=0;r<t.length;r++)if(t[r].payloadType===e||t[r].preferredPayloadType===e)return t[r]},i=function(e,t,r,i){var o=n(e.parameters.apt,r),a=n(t.parameters.apt,i);return o&&a&&o.name.toLowerCase()===a.name.toLowerCase()};return e.codecs.forEach(function(n){for(var o=0;o<t.codecs.length;o++){var a=t.codecs[o];if(n.name.toLowerCase()===a.name.toLowerCase()&&n.clockRate===a.clockRate){if("rtx"===n.name.toLowerCase()&&n.parameters&&a.parameters.apt&&!i(n,a,e.codecs,t.codecs))continue;(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(n.numChannels,a.numChannels),r.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter(function(e){for(var t=0;t<n.rtcpFeedback.length;t++)if(n.rtcpFeedback[t].type===e.type&&n.rtcpFeedback[t].parameter===e.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(e){for(var n=0;n<t.headerExtensions.length;n++){var i=t.headerExtensions[n];if(e.uri===i.uri){r.headerExtensions.push(i);break}}}),r}function YA(e,t,r){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)}function KA(e,t){var r=e.getRemoteCandidates().find(function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type});return r||e.addRemoteCandidate(t),!r}function XA(e,t){var r=new Error(t);return r.name=e,r.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],r}var ZA=function(e,t){function r(t,r){r.addTrack(t),r.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function n(t,r,n,i){var o=new Event("track");o.track=r,o.receiver=n,o.transceiver={receiver:n},o.streams=i,e.setTimeout(function(){t._dispatchEvent("track",o)})}var i=function(r){var n=this,i=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){n[e]=i[e].bind(i)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",r=JSON.parse(JSON.stringify(r||{})),this.usingBundle="max-bundle"===r.bundlePolicy,"negotiate"===r.rtcpMuxPolicy)throw XA("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(r.rtcpMuxPolicy||(r.rtcpMuxPolicy="require"),r.iceTransportPolicy){case"all":case"relay":break;default:r.iceTransportPolicy="all"}switch(r.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:r.bundlePolicy="balanced"}if(r.iceServers=function(e,t){var r=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var n=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof n;return i&&(n=[n]),n=n.filter(function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||r?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(r=!0,!0)}),delete e.url,e.urls=i?n[0]:n,!!n.length}})}(r.iceServers||[],t),this._iceGatherers=[],r.iceCandidatePoolSize)for(var o=r.iceCandidatePoolSize;o>0;o--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:r.iceServers,gatherPolicy:r.iceTransportPolicy}));else r.iceCandidatePoolSize=0;this._config=r,this.transceivers=[],this._sdpSessionId=HA.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(i.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(i.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),i.prototype.onicecandidate=null,i.prototype.onaddstream=null,i.prototype.ontrack=null,i.prototype.onremovestream=null,i.prototype.onsignalingstatechange=null,i.prototype.oniceconnectionstatechange=null,i.prototype.onconnectionstatechange=null,i.prototype.onicegatheringstatechange=null,i.prototype.onnegotiationneeded=null,i.prototype.ondatachannel=null,i.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},i.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},i.prototype.getConfiguration=function(){return this._config},i.prototype.getLocalStreams=function(){return this.localStreams},i.prototype.getRemoteStreams=function(){return this.remoteStreams},i.prototype._createTransceiver=function(e,t){var r=this.transceivers.length>0,n={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&r)n.iceTransport=this.transceivers[0].iceTransport,n.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();n.iceTransport=i.iceTransport,n.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(n),n},i.prototype.addTrack=function(t,r){if(this._isClosed)throw XA("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var n;if(this.transceivers.find(function(e){return e.track===t}))throw XA("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(n=this.transceivers[i]);return n||(n=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(r)&&this.localStreams.push(r),n.track=t,n.stream=r,n.rtpSender=new e.RTCRtpSender(t,n.dtlsTransport),n.rtpSender},i.prototype.addStream=function(e){var r=this;if(t>=15025)e.getTracks().forEach(function(t){r.addTrack(t,e)});else{var n=e.clone();e.getTracks().forEach(function(e,t){var r=n.getTracks()[t];e.addEventListener("enabled",function(e){r.enabled=e.enabled})}),n.getTracks().forEach(function(e){r.addTrack(e,n)})}},i.prototype.removeTrack=function(t){if(this._isClosed)throw XA("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var r=this.transceivers.find(function(e){return e.rtpSender===t});if(!r)throw XA("InvalidAccessError","Sender was not created by this connection.");var n=r.stream;r.rtpSender.stop(),r.rtpSender=null,r.track=null,r.stream=null,-1===this.transceivers.map(function(e){return e.stream}).indexOf(n)&&this.localStreams.indexOf(n)>-1&&this.localStreams.splice(this.localStreams.indexOf(n),1),this._maybeFireNegotiationNeeded()},i.prototype.removeStream=function(e){var t=this;e.getTracks().forEach(function(e){var r=t.getSenders().find(function(t){return t.track===e});r&&t.removeTrack(r)})},i.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},i.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},i.prototype._createIceGatherer=function(t,r){var n=this;if(r&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var r=!e.candidate||0===Object.keys(e.candidate).length;i.state=r?"completed":"gathering",null!==n.transceivers[t].bufferedCandidateEvents&&n.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},i.prototype._gather=function(t,r){var n=this,i=this.transceivers[r].iceGatherer;if(!i.onlocalcandidate){var o=this.transceivers[r].bufferedCandidateEvents;this.transceivers[r].bufferedCandidateEvents=null,i.removeEventListener("localcandidate",this.transceivers[r].bufferCandidates),i.onlocalcandidate=function(e){if(!(n.usingBundle&&r>0)){var o=new Event("icecandidate");o.candidate={sdpMid:t,sdpMLineIndex:r};var a=e.candidate,u=!a||0===Object.keys(a).length;if(u)"new"!==i.state&&"gathering"!==i.state||(i.state="completed");else{"new"===i.state&&(i.state="gathering"),a.component=1,a.ufrag=i.getLocalParameters().usernameFragment;var s=HA.writeCandidate(a);o.candidate=Object.assign(o.candidate,HA.parseCandidate(s)),o.candidate.candidate=s,o.candidate.toJSON=function(){return{candidate:o.candidate.candidate,sdpMid:o.candidate.sdpMid,sdpMLineIndex:o.candidate.sdpMLineIndex,usernameFragment:o.candidate.usernameFragment}}}var c=HA.getMediaSections(n._localDescription.sdp);c[o.candidate.sdpMLineIndex]+=u?"a=end-of-candidates\r\n":"a="+o.candidate.candidate+"\r\n",n._localDescription.sdp=HA.getDescription(n._localDescription.sdp)+c.join("");var l=n.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});"gathering"!==n.iceGatheringState&&(n.iceGatheringState="gathering",n._emitGatheringStateChange()),u||n._dispatchEvent("icecandidate",o),l&&(n._dispatchEvent("icecandidate",new Event("icecandidate")),n.iceGatheringState="complete",n._emitGatheringStateChange())}},e.setTimeout(function(){o.forEach(function(e){i.onlocalcandidate(e)})},0)}},i.prototype._createIceAndDtlsTransports=function(){var t=this,r=new e.RTCIceTransport(null);r.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var n=new e.RTCDtlsTransport(r);return n.ondtlsstatechange=function(){t._updateConnectionState()},n.onerror=function(){Object.defineProperty(n,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:r,dtlsTransport:n}},i.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var r=this.transceivers[e].iceTransport;r&&(delete r.onicestatechange,delete this.transceivers[e].iceTransport);var n=this.transceivers[e].dtlsTransport;n&&(delete n.ondtlsstatechange,delete n.onerror,delete this.transceivers[e].dtlsTransport)},i.prototype._transceive=function(e,r,n){var i=JA(e.localCapabilities,e.remoteCapabilities);r&&e.rtpSender&&(i.encodings=e.sendEncodingParameters,i.rtcp={cname:HA.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(i.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(i)),n&&e.rtpReceiver&&i.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach(function(e){delete e.rtx}),e.recvEncodingParameters.length?i.encodings=e.recvEncodingParameters:i.encodings=[{}],i.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(i.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(i.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(i))},i.prototype.setLocalDescription=function(e){var t,r,n=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(XA("TypeError",'Unsupported type "'+e.type+'"'));if(!YA("setLocalDescription",e.type,n.signalingState)||n._isClosed)return Promise.reject(XA("InvalidStateError","Can not set local "+e.type+" in state "+n.signalingState));if("offer"===e.type)t=HA.splitSections(e.sdp),r=t.shift(),t.forEach(function(e,t){var r=HA.parseRtpParameters(e);n.transceivers[t].localCapabilities=r}),n.transceivers.forEach(function(e,t){n._gather(e.mid,t)});else if("answer"===e.type){t=HA.splitSections(n._remoteDescription.sdp),r=t.shift();var i=HA.matchPrefix(r,"a=ice-lite").length>0;t.forEach(function(e,t){var o=n.transceivers[t],a=o.iceGatherer,u=o.iceTransport,s=o.dtlsTransport,c=o.localCapabilities,l=o.remoteCapabilities;if(!(HA.isRejected(e)&&0===HA.matchPrefix(e,"a=bundle-only").length)&&!o.rejected){var f=HA.getIceParameters(e,r),d=HA.getDtlsParameters(e,r);i&&(d.role="server"),n.usingBundle&&0!==t||(n._gather(o.mid,t),"new"===u.state&&u.start(a,f,i?"controlling":"controlled"),"new"===s.state&&s.start(d));var p=JA(c,l);n._transceive(o,p.codecs.length>0,!1)}})}return n._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?n._updateSignalingState("have-local-offer"):n._updateSignalingState("stable"),Promise.resolve()},i.prototype.setRemoteDescription=function(i){var o=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(XA("TypeError",'Unsupported type "'+i.type+'"'));if(!YA("setRemoteDescription",i.type,o.signalingState)||o._isClosed)return Promise.reject(XA("InvalidStateError","Can not set remote "+i.type+" in state "+o.signalingState));var a={};o.remoteStreams.forEach(function(e){a[e.id]=e});var u=[],s=HA.splitSections(i.sdp),c=s.shift(),l=HA.matchPrefix(c,"a=ice-lite").length>0,f=HA.matchPrefix(c,"a=group:BUNDLE ").length>0;o.usingBundle=f;var d=HA.matchPrefix(c,"a=ice-options:")[0];return o.canTrickleIceCandidates=!!d&&d.substr(14).split(" ").indexOf("trickle")>=0,s.forEach(function(n,s){var d=HA.splitLines(n),p=HA.getKind(n),h=HA.isRejected(n)&&0===HA.matchPrefix(n,"a=bundle-only").length,v=d[0].substr(2).split(" ")[2],g=HA.getDirection(n,c),y=HA.parseMsid(n),m=HA.getMid(n)||HA.generateIdentifier();if(h||"application"===p&&("DTLS/SCTP"===v||"UDP/DTLS/SCTP"===v))o.transceivers[s]={mid:m,kind:p,protocol:v,rejected:!0};else{var b,_,w,S,k,E,P,T,O;!h&&o.transceivers[s]&&o.transceivers[s].rejected&&(o.transceivers[s]=o._createTransceiver(p,!0));var C,M,x=HA.parseRtpParameters(n);h||(C=HA.getIceParameters(n,c),(M=HA.getDtlsParameters(n,c)).role="client"),P=HA.parseRtpEncodingParameters(n);var j=HA.parseRtcpParameters(n),R=HA.matchPrefix(n,"a=end-of-candidates",c).length>0,A=HA.matchPrefix(n,"a=candidate:").map(function(e){return HA.parseCandidate(e)}).filter(function(e){return 1===e.component});if(("offer"===i.type||"answer"===i.type)&&!h&&f&&s>0&&o.transceivers[s]&&(o._disposeIceAndDtlsTransports(s),o.transceivers[s].iceGatherer=o.transceivers[0].iceGatherer,o.transceivers[s].iceTransport=o.transceivers[0].iceTransport,o.transceivers[s].dtlsTransport=o.transceivers[0].dtlsTransport,o.transceivers[s].rtpSender&&o.transceivers[s].rtpSender.setTransport(o.transceivers[0].dtlsTransport),o.transceivers[s].rtpReceiver&&o.transceivers[s].rtpReceiver.setTransport(o.transceivers[0].dtlsTransport)),"offer"!==i.type||h){if("answer"===i.type&&!h){_=(b=o.transceivers[s]).iceGatherer,w=b.iceTransport,S=b.dtlsTransport,k=b.rtpReceiver,E=b.sendEncodingParameters,T=b.localCapabilities,o.transceivers[s].recvEncodingParameters=P,o.transceivers[s].remoteCapabilities=x,o.transceivers[s].rtcpParameters=j,A.length&&"new"===w.state&&(!l&&!R||f&&0!==s?A.forEach(function(e){KA(b.iceTransport,e)}):w.setRemoteCandidates(A)),f&&0!==s||("new"===w.state&&w.start(_,C,"controlling"),"new"===S.state&&S.start(M)),!JA(b.localCapabilities,b.remoteCapabilities).codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&b.sendEncodingParameters[0].rtx&&delete b.sendEncodingParameters[0].rtx,o._transceive(b,"sendrecv"===g||"recvonly"===g,"sendrecv"===g||"sendonly"===g),!k||"sendrecv"!==g&&"sendonly"!==g?delete b.rtpReceiver:(O=k.track,y?(a[y.stream]||(a[y.stream]=new e.MediaStream),r(O,a[y.stream]),u.push([O,k,a[y.stream]])):(a.default||(a.default=new e.MediaStream),r(O,a.default),u.push([O,k,a.default])))}}else{(b=o.transceivers[s]||o._createTransceiver(p)).mid=m,b.iceGatherer||(b.iceGatherer=o._createIceGatherer(s,f)),A.length&&"new"===b.iceTransport.state&&(!R||f&&0!==s?A.forEach(function(e){KA(b.iceTransport,e)}):b.iceTransport.setRemoteCandidates(A)),T=e.RTCRtpReceiver.getCapabilities(p),t<15019&&(T.codecs=T.codecs.filter(function(e){return"rtx"!==e.name})),E=b.sendEncodingParameters||[{ssrc:1001*(2*s+2)}];var I,D=!1;if("sendrecv"===g||"sendonly"===g){if(D=!b.rtpReceiver,k=b.rtpReceiver||new e.RTCRtpReceiver(b.dtlsTransport,p),D)O=k.track,y&&"-"===y.stream||(y?(a[y.stream]||(a[y.stream]=new e.MediaStream,Object.defineProperty(a[y.stream],"id",{get:function(){return y.stream}})),Object.defineProperty(O,"id",{get:function(){return y.track}}),I=a[y.stream]):(a.default||(a.default=new e.MediaStream),I=a.default)),I&&(r(O,I),b.associatedRemoteMediaStreams.push(I)),u.push([O,k,I])}else b.rtpReceiver&&b.rtpReceiver.track&&(b.associatedRemoteMediaStreams.forEach(function(t){var r,n,i=t.getTracks().find(function(e){return e.id===b.rtpReceiver.track.id});i&&(r=i,(n=t).removeTrack(r),n.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:r})))}),b.associatedRemoteMediaStreams=[]);b.localCapabilities=T,b.remoteCapabilities=x,b.rtpReceiver=k,b.rtcpParameters=j,b.sendEncodingParameters=E,b.recvEncodingParameters=P,o._transceive(o.transceivers[s],!1,D)}}}),void 0===o._dtlsRole&&(o._dtlsRole="offer"===i.type?"active":"passive"),o._remoteDescription={type:i.type,sdp:i.sdp},"offer"===i.type?o._updateSignalingState("have-remote-offer"):o._updateSignalingState("stable"),Object.keys(a).forEach(function(t){var r=a[t];if(r.getTracks().length){if(-1===o.remoteStreams.indexOf(r)){o.remoteStreams.push(r);var i=new Event("addstream");i.stream=r,e.setTimeout(function(){o._dispatchEvent("addstream",i)})}u.forEach(function(e){var t=e[0],i=e[1];r.id===e[2].id&&n(o,t,i,[r])})}}),u.forEach(function(e){e[2]||n(o,e[0],e[1],[])}),e.setTimeout(function(){o&&o.transceivers&&o.transceivers.forEach(function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},i.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},i.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},i.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout(function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}},0))},i.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++}),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",r)}},i.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)}),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var r=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",r)}},i.prototype.createOffer=function(){var r=this;if(r._isClosed)return Promise.reject(XA("InvalidStateError","Can not call createOffer after close"));var n=r.transceivers.filter(function(e){return"audio"===e.kind}).length,i=r.transceivers.filter(function(e){return"video"===e.kind}).length,o=arguments[0];if(o){if(o.mandatory||o.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==o.offerToReceiveAudio&&(n=!0===o.offerToReceiveAudio?1:!1===o.offerToReceiveAudio?0:o.offerToReceiveAudio),void 0!==o.offerToReceiveVideo&&(i=!0===o.offerToReceiveVideo?1:!1===o.offerToReceiveVideo?0:o.offerToReceiveVideo)}for(r.transceivers.forEach(function(e){"audio"===e.kind?--n<0&&(e.wantReceive=!1):"video"===e.kind&&--i<0&&(e.wantReceive=!1)});n>0||i>0;)n>0&&(r._createTransceiver("audio"),n--),i>0&&(r._createTransceiver("video"),i--);var a=HA.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.transceivers.forEach(function(n,i){var o=n.track,a=n.kind,u=n.mid||HA.generateIdentifier();n.mid=u,n.iceGatherer||(n.iceGatherer=r._createIceGatherer(i,r.usingBundle));var s=e.RTCRtpSender.getCapabilities(a);t<15019&&(s.codecs=s.codecs.filter(function(e){return"rtx"!==e.name})),s.codecs.forEach(function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),n.remoteCapabilities&&n.remoteCapabilities.codecs&&n.remoteCapabilities.codecs.forEach(function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)})}),s.headerExtensions.forEach(function(e){(n.remoteCapabilities&&n.remoteCapabilities.headerExtensions||[]).forEach(function(t){e.uri===t.uri&&(e.id=t.id)})});var c=n.sendEncodingParameters||[{ssrc:1001*(2*i+1)}];o&&t>=15019&&"video"===a&&!c[0].rtx&&(c[0].rtx={ssrc:c[0].ssrc+1}),n.wantReceive&&(n.rtpReceiver=new e.RTCRtpReceiver(n.dtlsTransport,a)),n.localCapabilities=s,n.sendEncodingParameters=c}),"max-compat"!==r._config.bundlePolicy&&(a+="a=group:BUNDLE "+r.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),a+="a=ice-options:trickle\r\n",r.transceivers.forEach(function(e,t){a+=$A(e,e.localCapabilities,"offer",e.stream,r._dtlsRole),a+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===r.iceGatheringState||0!==t&&r.usingBundle||(e.iceGatherer.getLocalCandidates().forEach(function(e){e.component=1,a+="a="+HA.writeCandidate(e)+"\r\n"}),"completed"===e.iceGatherer.state&&(a+="a=end-of-candidates\r\n"))});var u=new e.RTCSessionDescription({type:"offer",sdp:a});return Promise.resolve(u)},i.prototype.createAnswer=function(){var r=this;if(r._isClosed)return Promise.reject(XA("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==r.signalingState&&"have-local-pranswer"!==r.signalingState)return Promise.reject(XA("InvalidStateError","Can not call createAnswer in signalingState "+r.signalingState));var n=HA.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.usingBundle&&(n+="a=group:BUNDLE "+r.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),n+="a=ice-options:trickle\r\n";var i=HA.getMediaSections(r._remoteDescription.sdp).length;r.transceivers.forEach(function(e,o){if(!(o+1>i)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?n+="m=application 0 DTLS/SCTP 5000\r\n":n+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?n+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(n+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(n+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var a;if(e.stream)"audio"===e.kind?a=e.stream.getAudioTracks()[0]:"video"===e.kind&&(a=e.stream.getVideoTracks()[0]),a&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1});var u=JA(e.localCapabilities,e.remoteCapabilities);!u.codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,n+=$A(e,u,"answer",e.stream,r._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(n+="a=rtcp-rsize\r\n")}});var o=new e.RTCSessionDescription({type:"answer",sdp:n});return Promise.resolve(o)},i.prototype.addIceCandidate=function(e){var t,r=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(n,i){if(!r._remoteDescription)return i(XA("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var o=e.sdpMLineIndex;if(e.sdpMid)for(var a=0;a<r.transceivers.length;a++)if(r.transceivers[a].mid===e.sdpMid){o=a;break}var u=r.transceivers[o];if(!u)return i(XA("OperationError","Can not add ICE candidate"));if(u.rejected)return n();var s=Object.keys(e.candidate).length>0?HA.parseCandidate(e.candidate):{};if("tcp"===s.protocol&&(0===s.port||9===s.port))return n();if(s.component&&1!==s.component)return n();if((0===o||o>0&&u.iceTransport!==r.transceivers[0].iceTransport)&&!KA(u.iceTransport,s))return i(XA("OperationError","Can not add ICE candidate"));var c=e.candidate.trim();0===c.indexOf("a=")&&(c=c.substr(2)),(t=HA.getMediaSections(r._remoteDescription.sdp))[o]+="a="+(s.type?c:"end-of-candidates")+"\r\n",r._remoteDescription.sdp=HA.getDescription(r._remoteDescription.sdp)+t.join("")}else for(var l=0;l<r.transceivers.length&&(r.transceivers[l].rejected||(r.transceivers[l].iceTransport.addRemoteCandidate({}),(t=HA.getMediaSections(r._remoteDescription.sdp))[l]+="a=end-of-candidates\r\n",r._remoteDescription.sdp=HA.getDescription(r._remoteDescription.sdp)+t.join(""),!r.usingBundle));l++);n()})},i.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var r=null;if(this.transceivers.forEach(function(e){e.rtpSender&&e.rtpSender.track===t?r=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(r=e.rtpReceiver)}),!r)throw XA("InvalidAccessError","Invalid selector.");return r.getStats()}var n=[];return this.transceivers.forEach(function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(t){e[t]&&n.push(e[t].getStats())})}),Promise.all(n).then(function(e){var t=new Map;return e.forEach(function(e){e.forEach(function(e){t.set(e.id,e)})}),t})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(t){var r=e[t];if(r&&r.prototype&&r.prototype.getStats){var n=r.prototype.getStats;r.prototype.getStats=function(){return n.apply(this).then(function(e){var t=new Map;return Object.keys(e).forEach(function(r){var n;e[r].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(n=e[r]).type]||n.type,t.set(r,e[r])}),t})}}});var o=["createOffer","createAnswer"];return o.forEach(function(e){var t=i.prototype[e];i.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then(function(t){"function"==typeof e[0]&&e[0].apply(null,[t])},function(t){"function"==typeof e[1]&&e[1].apply(null,[t])}):t.apply(this,arguments)}}),(o=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(e){var t=i.prototype[e];i.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)},function(t){"function"==typeof e[2]&&e[2].apply(null,[t])}):t.apply(this,arguments)}}),["getStats"].forEach(function(e){var t=i.prototype[e];i.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)}):t.apply(this,arguments)}}),i},QA={shimGetUserMedia:function(e){var t=e&&e.navigator,r=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return r(e).catch(function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))})}},shimPeerConnection:function(e){var t=qA.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var r=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){r.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var n=ZA(e,t.version);e.RTCPeerConnection=function(e){var t,r,i;return e&&e.iceServers&&(e.iceServers=(t=e.iceServers,i=!1,(t=JSON.parse(JSON.stringify(t))).filter(function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&qA.deprecated("RTCIceServer.url","RTCIceServer.urls");var n="string"==typeof t;return n&&(t=[t]),t=t.filter(function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||i?0===e.indexOf("stun:")&&r>=14393&&-1===e.indexOf("?transport=udp"):(i=!0,!0)}),delete e.url,e.urls=n?t[0]:t,!!t.length}}))),new n(e)},e.RTCPeerConnection.prototype=n.prototype},shimReplaceTrack:function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)},shimGetDisplayMedia:function(e,t){if("getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&!("getDisplayMedia"in e.navigator.mediaDevices)){var r=e.navigator.getDisplayMedia;e.navigator.mediaDevices.getDisplayMedia=function(t){return r.call(e.navigator,t)},e.navigator.getDisplayMedia=function(t){return qA.deprecated("navigator.getDisplayMedia","navigator.mediaDevices.getDisplayMedia"),r.call(e.navigator,t)}}}},eI=qA.log,tI={shimGetUserMedia:function(e){var t=qA.detectBrowser(e),r=e&&e.navigator,n=e&&e.MediaStreamTrack,i=function(e){return{name:{InternalError:"NotReadableError",NotSupportedError:"TypeError",PermissionDeniedError:"NotAllowedError",SecurityError:"NotAllowedError"}[e.name]||e.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[e.message]||e.message,constraint:e.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},o=function(e,n,o){var a=function(e){if("object"!=typeof e||e.require)return e;var t=[];return Object.keys(e).forEach(function(r){if("require"!==r&&"advanced"!==r&&"mediaSource"!==r){var n=e[r]="object"==typeof e[r]?e[r]:{ideal:e[r]};if(void 0===n.min&&void 0===n.max&&void 0===n.exact||t.push(r),void 0!==n.exact&&("number"==typeof n.exact?n.min=n.max=n.exact:e[r]=n.exact,delete n.exact),void 0!==n.ideal){e.advanced=e.advanced||[];var i={};"number"==typeof n.ideal?i[r]={min:n.ideal,max:n.ideal}:i[r]=n.ideal,e.advanced.push(i),delete n.ideal,Object.keys(n).length||delete e[r]}}}),t.length&&(e.require=t),e};return e=JSON.parse(JSON.stringify(e)),t.version<38&&(eI("spec: "+JSON.stringify(e)),e.audio&&(e.audio=a(e.audio)),e.video&&(e.video=a(e.video)),eI("ff37: "+JSON.stringify(e))),r.mozGetUserMedia(e,n,function(e){o(i(e))})};if(r.mediaDevices||(r.mediaDevices={getUserMedia:function(e){return new Promise(function(t,r){o(e,t,r)})},addEventListener:function(){},removeEventListener:function(){}}),r.mediaDevices.enumerateDevices=r.mediaDevices.enumerateDevices||function(){return new Promise(function(e){e([{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}])})},t.version<41){var a=r.mediaDevices.enumerateDevices.bind(r.mediaDevices);r.mediaDevices.enumerateDevices=function(){return a().then(void 0,function(e){if("NotFoundError"===e.name)return[];throw e})}}if(t.version<49){var u=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(e){return u(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(function(e){e.stop()}),new DOMException("The object can not be found here.","NotFoundError");return t},function(e){return Promise.reject(i(e))})}}if(!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){var s=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])},c=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(e){return"object"==typeof e&&"object"==typeof e.audio&&(e=JSON.parse(JSON.stringify(e)),s(e.audio,"autoGainControl","mozAutoGainControl"),s(e.audio,"noiseSuppression","mozNoiseSuppression")),c(e)},n&&n.prototype.getSettings){var l=n.prototype.getSettings;n.prototype.getSettings=function(){var e=l.apply(this,arguments);return s(e,"mozAutoGainControl","autoGainControl"),s(e,"mozNoiseSuppression","noiseSuppression"),e}}if(n&&n.prototype.applyConstraints){var f=n.prototype.applyConstraints;n.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"==typeof e&&(e=JSON.parse(JSON.stringify(e)),s(e,"autoGainControl","mozAutoGainControl"),s(e,"noiseSuppression","mozNoiseSuppression")),f.apply(this,[e])}}}r.getUserMedia=function(e,n,i){if(t.version<44)return o(e,n,i);qA.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(e).then(n,i)}},shimOnTrack:function(e){"object"!=typeof e||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.getTracks().forEach(function(t){var r=new Event("track");r.track=t,r.receiver={track:t},r.transceiver={receiver:r.receiver},r.streams=[e.stream],this.dispatchEvent(r)}.bind(this))}.bind(this))},enumerable:!0,configurable:!0}),"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimSourceObject:function(e){"object"==typeof e&&(!e.HTMLMediaElement||"srcObject"in e.HTMLMediaElement.prototype||Object.defineProperty(e.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(e){this.mozSrcObject=e}}))},shimPeerConnection:function(e){var t=qA.detectBrowser(e);if("object"==typeof e&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){e.RTCPeerConnection||(e.RTCPeerConnection=function(r,n){if(t.version<38&&r&&r.iceServers){for(var i=[],o=0;o<r.iceServers.length;o++){var a=r.iceServers[o];if(a.hasOwnProperty("urls"))for(var u=0;u<a.urls.length;u++){var s={url:a.urls[u]};0===a.urls[u].indexOf("turn")&&(s.username=a.username,s.credential=a.credential),i.push(s)}else i.push(r.iceServers[o])}r.iceServers=i}return new e.mozRTCPeerConnection(r,n)},e.RTCPeerConnection.prototype=e.mozRTCPeerConnection.prototype,e.mozRTCPeerConnection.generateCertificate&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return e.mozRTCPeerConnection.generateCertificate}}),e.RTCSessionDescription=e.mozRTCSessionDescription,e.RTCIceCandidate=e.mozRTCIceCandidate),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}});var r=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,r,o){return i.apply(this,[e||null]).then(function(e){if(t.version<48&&(e=function(e){var t=new Map;return Object.keys(e).forEach(function(r){t.set(r,e[r]),t[r]=e[r]}),t}(e)),t.version<53&&!r)try{e.forEach(function(e){e.type=n[e.type]||e.type})}catch(t){if("TypeError"!==t.name)throw t;e.forEach(function(t,r){e.set(r,Object.assign({},t,{type:n[t.type]||t.type}))})}return e}).then(r,o)}}},shimSenderGetStats:function(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(e,[]);return r.forEach(function(t){t._pc=e}),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},shimReceiverGetStats:function(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,r=t.apply(e,[]);return r.forEach(function(t){t._pc=e}),r}),qA.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},shimRemoveStream:function(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;qA.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(r){r.track&&-1!==e.getTracks().indexOf(r.track)&&t.removeTrack(r)})})},shimRTCDataChannel:function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},shimGetDisplayMedia:function(e,t){!e.navigator||!e.navigator.mediaDevices||"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){var n=new DOMException("getDisplayMedia without video constraints is undefined");return n.name="NotFoundError",n.code=8,Promise.reject(n)}return!0===r.video?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)},e.navigator.getDisplayMedia=function(t){return qA.deprecated("navigator.getDisplayMedia","navigator.mediaDevices.getDisplayMedia"),e.navigator.mediaDevices.getDisplayMedia(t)})}},rI={shimLocalStreamsAPI:function(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),"getStreamById"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getStreamById=function(e){var t=null;return this._localStreams&&this._localStreams.forEach(function(r){r.id===e&&(t=r)}),this._remoteStreams&&this._remoteStreams.forEach(function(r){r.id===e&&(t=r)}),t}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),-1===this._localStreams.indexOf(e)&&this._localStreams.push(e);var r=this;e.getTracks().forEach(function(n){t.call(r,n,e)})},e.RTCPeerConnection.prototype.addTrack=function(e,r){return r&&(this._localStreams?-1===this._localStreams.indexOf(r)&&this._localStreams.push(r):this._localStreams=[r]),t.call(this,e,r)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);var t=this._localStreams.indexOf(e);if(-1!==t){this._localStreams.splice(t,1);var r=this,n=e.getTracks();this.getSenders().forEach(function(e){-1!==n.indexOf(e.track)&&r.removeTrack(e)})}})}},shimRemoteStreamsAPI:function(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){this._onaddstream&&this.removeEventListener("addstream",this._onaddstream),this.addEventListener("addstream",this._onaddstream=e)}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach(function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var r=new Event("addstream");r.stream=t,e.dispatchEvent(r)}})}),t.apply(e,arguments)}}},shimCallbacksAPI:function(e){if("object"==typeof e&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,r=t.createOffer,n=t.createAnswer,i=t.setLocalDescription,o=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i};var u=function(e,t,r){var n=i.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n};t.setLocalDescription=u,u=function(e,t,r){var n=o.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.setRemoteDescription=u,u=function(e,t,r){var n=a.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.addIceCandidate=u}},shimGetUserMedia:function(e){var t=e&&e.navigator;t.getUserMedia||(t.webkitGetUserMedia?t.getUserMedia=t.webkitGetUserMedia.bind(t):t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,r,n){t.mediaDevices.getUserMedia(e).then(r,n)}.bind(t)))},shimRTCIceServerUrls:function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,r){if(e&&e.iceServers){for(var n=[],i=0;i<e.iceServers.length;i++){var o=e.iceServers[i];!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")?(qA.deprecated("RTCIceServer.url","RTCIceServer.urls"),(o=JSON.parse(JSON.stringify(o))).urls=o.url,delete o.url,n.push(o)):n.push(e.iceServers[i])}e.iceServers=n}return new t(e,r)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},shimTrackEventTransceiver:function(e){"object"==typeof e&&e.RTCPeerConnection&&"receiver"in e.RTCTrackEvent.prototype&&!e.RTCTransceiver&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimCreateOfferLegacy:function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){var r=this;if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var n=r.getTransceivers().find(function(e){return e.sender.track&&"audio"===e.sender.track.kind});!1===e.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveAudio||n||r.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var i=r.getTransceivers().find(function(e){return e.sender.track&&"video"===e.sender.track.kind});!1===e.offerToReceiveVideo&&i?"sendrecv"===i.direction?i.setDirection("sendonly"):"recvonly"===i.direction&&i.setDirection("inactive"):!0!==e.offerToReceiveVideo||i||r.addTransceiver("video")}return t.apply(r,arguments)}}},nI={shimRTCIceCandidate:function(e){if(e.RTCIceCandidate&&!(e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var r=new t(e),n=HA.parseCandidate(e.candidate),i=Object.assign(r,n);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,qA.wrapPeerConnectionEvent(e,"icecandidate",function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t})}},shimCreateObjectURL:function(e){var t=e&&e.URL;if("object"==typeof e&&e.HTMLMediaElement&&"srcObject"in e.HTMLMediaElement.prototype&&t.createObjectURL&&t.revokeObjectURL){var r=t.createObjectURL.bind(t),n=t.revokeObjectURL.bind(t),i=new Map,o=0;t.createObjectURL=function(e){if("getTracks"in e){var t="polyblob:"+ ++o;return i.set(t,e),qA.deprecated("URL.createObjectURL(stream)","elem.srcObject = stream"),t}return r(e)},t.revokeObjectURL=function(e){n(e),i.delete(e)};var a=Object.getOwnPropertyDescriptor(e.HTMLMediaElement.prototype,"src");Object.defineProperty(e.HTMLMediaElement.prototype,"src",{get:function(){return a.get.apply(this)},set:function(e){return this.srcObject=i.get(e)||null,a.set.apply(this,[e])}});var u=e.HTMLMediaElement.prototype.setAttribute;e.HTMLMediaElement.prototype.setAttribute=function(){return 2===arguments.length&&"src"===(""+arguments[0]).toLowerCase()&&(this.srcObject=i.get(arguments[1])||null),u.apply(this,arguments)}}},shimMaxMessageSize:function(e){if(!e.RTCSctpTransport&&e.RTCPeerConnection){var t=qA.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e,n,i,o;if(this._sctp=null,i=arguments[0],(o=HA.splitSections(i.sdp)).shift(),o.some(function(e){var t=HA.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})){var a,u=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var r=parseInt(t[1],10);return r!=r?-1:r}(arguments[0]),s=(e=u,n=65536,"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n),c=function(e,r){var n=65536;"firefox"===t.browser&&57===t.version&&(n=65535);var i=HA.matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?n=parseInt(i[0].substr(19),10):"firefox"===t.browser&&-1!==r&&(n=2147483637),n}(arguments[0],u);a=0===s&&0===c?Number.POSITIVE_INFINITY:0===s||0===c?Math.max(s,c):Math.min(s,c);var l={};Object.defineProperty(l,"maxMessageSize",{get:function(){return a}}),this._sctp=l}return r.apply(this,arguments)}}},shimSendThrowTypeError:function(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return r(e,this),e},qA.wrapPeerConnectionEvent(e,"datachannel",function(e){return r(e.channel,e.target),e})}function r(e,t){var r=e.send;e.send=function(){var n=arguments[0],i=n.length||n.size||n.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return r.apply(e,arguments)}}}},iI=(function(e,t){var r=e&&e.window,n={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};for(var i in t)hasOwnProperty.call(t,i)&&(n[i]=t[i]);var o=qA.log,a=qA.detectBrowser(r),u=GA||null,s=QA||null,c=tI||null,l=rI||null,f=nI||null,d={browserDetails:a,commonShim:f,extractVersion:qA.extractVersion,disableLog:qA.disableLog,disableWarnings:qA.disableWarnings};switch(a.browser){case"chrome":if(!u||!u.shimPeerConnection||!n.shimChrome)return o("Chrome shim is not included in this adapter release."),d;o("adapter.js shimming chrome."),d.browserShim=u,f.shimCreateObjectURL(r),u.shimGetUserMedia(r),u.shimMediaStream(r),u.shimSourceObject(r),u.shimPeerConnection(r),u.shimOnTrack(r),u.shimAddTrackRemoveTrack(r),u.shimGetSendersWithDtmf(r),u.shimSenderReceiverGetStats(r),u.fixNegotiationNeeded(r),f.shimRTCIceCandidate(r),f.shimMaxMessageSize(r),f.shimSendThrowTypeError(r);break;case"firefox":if(!c||!c.shimPeerConnection||!n.shimFirefox)return o("Firefox shim is not included in this adapter release."),d;o("adapter.js shimming firefox."),d.browserShim=c,f.shimCreateObjectURL(r),c.shimGetUserMedia(r),c.shimSourceObject(r),c.shimPeerConnection(r),c.shimOnTrack(r),c.shimRemoveStream(r),c.shimSenderGetStats(r),c.shimReceiverGetStats(r),c.shimRTCDataChannel(r),f.shimRTCIceCandidate(r),f.shimMaxMessageSize(r),f.shimSendThrowTypeError(r);break;case"edge":if(!s||!s.shimPeerConnection||!n.shimEdge)return o("MS edge shim is not included in this adapter release."),d;o("adapter.js shimming edge."),d.browserShim=s,f.shimCreateObjectURL(r),s.shimGetUserMedia(r),s.shimPeerConnection(r),s.shimReplaceTrack(r),s.shimGetDisplayMedia(r),f.shimMaxMessageSize(r),f.shimSendThrowTypeError(r);break;case"safari":if(!l||!n.shimSafari)return o("Safari shim is not included in this adapter release."),d;o("adapter.js shimming safari."),d.browserShim=l,f.shimCreateObjectURL(r),l.shimRTCIceServerUrls(r),l.shimCreateOfferLegacy(r),l.shimCallbacksAPI(r),l.shimLocalStreamsAPI(r),l.shimRemoteStreamsAPI(r),l.shimTrackEventTransceiver(r),l.shimGetUserMedia(r),f.shimRTCIceCandidate(r),f.shimMaxMessageSize(r),f.shimSendThrowTypeError(r);break;default:o("Unsupported browser!")}}({window:e.window}),r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ensureH264=void 0;var r=o(FA),n=o(Qx),i=o(eO);function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var r="screen"===e?{content:"slides",type:"video"}:{type:e},i=(0,n.default)((0,DA.parse)(t).media,r);return i?i.direction:"inactive"}function u(e){switch(e){case"inactive":case"sendrecv":return e;case"sendonly":return"recvonly";case"recvonly":return"sendonly";default:throw new Error('direction "'+e+'" is not valid')}}t.getMediaDirectionFromSDP=a,t.getMediaFromSDP=function(e,t,n){var i="screen"===e?{content:"slides",type:"video"}:{type:e},o=(0,r.default)((0,DA.parse)(t).media,i),a={};n&&("sendrecv"===n?(o.forEach(function(e){a[e.direction]=e}),!a.sendrecv||a.recvonly||a.sendonly?!a.sendrecv&&a.recvonly&&a.sendonly&&(o=[a.recvonly,a.sendonly]):o=a.sendrecv):o=o.filter(function(e){return e.direction===n}));return o},t.reverseMediaDirection=u,t.limitBandwith=function(e,t){var r=e.audioBandwidthLimit,n=e.videoBandwidthLimit;return t.split("\r\n").reduce(function(e,t){return e.push(t),t.startsWith("m=")&&e.push("b=TIAS:"+(t.includes("audio")?r:n)),e},[]).join("\r\n")},t.kindToPropertyFragment=function(e){return"audio"===e?"Audio":"Video"},t.getMediaDirectionFromSDPForAnswer=function(e,t){return u(a(e,t))},t.boolToDirection=s,t.getMediaDirectionFromTracks=function(e,t){if("closed"===t.signalingState)return"inactive";var r=t.getSenders().filter(function(t){return t.track&&t.track.kind===e}),n=r.length>0&&r.reduce(function(e,t){return e||t.track.enabled},!1),i=t.getReceivers().filter(function(t){return t.track&&t.track.kind===e}),o=i.length>0&&i.reduce(function(e,t){return e||t.track.enabled},!1);return s(n,o)},t.removeExtmap=function(e){return e.replace(/a=extmap.*\r\n/g,"")};t.ensureH264=(0,i.default)(function(e,t){if(e){if(!t.includes("m=video"))throw new Error("No video section found in offer");if(!/[hH]264/.test(t))throw new Error("Offer does not include h264 codec")}return t});function s(e,t){return e&&t?"sendrecv":e?"sendonly":t?"recvonly":"inactive"}}));t(iI);iI.ensureH264,iI.getMediaDirectionFromSDP,iI.getMediaFromSDP,iI.reverseMediaDirection,iI.limitBandwith,iI.kindToPropertyFragment,iI.getMediaDirectionFromSDPForAnswer,iI.boolToDirection,iI.getMediaDirectionFromTracks,iI.removeExtmap;var oI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,n,i,o,a,u,s,c,l,f,d,p,h,v,g,y,m=A(Ef),b=A(Hm),_=A(ac),w=A(mO),S=A(cc),k=A(bf),E=A(Wm),P=A($m),T=A(p_),O=A(hb),C=A(cS),M=A(Sj),x=A(CA),j=A(jT),R=A(MA);function A(e){return e&&e.__esModule?e:{default:e}}function I(e,t,r,n){r&&(0,b.default)(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function D(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}R.default.a.find(function(e){return"content"===e.name})||R.default.a.unshift({name:"content",reg:/^content:(slides)/});var L=new((0,$E.make)(O.default,T.default)),F={audio:"Audio",video:"Video"};function N(e,t){return L.get(e,t)||"inactive"}var U=(r=(0,$E.whileInFlight)("gumming"),n=(0,OA.debounce)(500),i=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,E.default)(this,e),this.logger=console,I(this,"localMediaStream",o,this),I(this,"remoteMediaStream",a,this),I(this,"localScreenShare",u,this),this.pc=new RTCPeerConnection({iceServers:[],bundlePolicy:"max-compat",sdpSemantics:"plan-b"}),I(this,"offerSdp",s,this),I(this,"answerSdp",c,this),I(this,"sendingAudio",l,this),I(this,"sendingVideo",f,this),I(this,"receivingAudio",d,this),I(this,"receivingVideo",p,this),I(this,"ended",h,this),this.negotiationNeeded=!1,this.bandwidthLimit={audioBandwidthLimit:6e4,videoBandwidthLimit:1e6},I(this,"constraints",v,this),I(this,"offerOptions",g,this),I(this,"gumming",y,this),n.parent?ps(function(){n.parent.logger&&(t.logger=n.parent.logger)}):r.logger&&(this.logger=r.logger),this.pc.onnegotiationneeded=function(){t.logger.info("peer connection emitted negotiationneeded"),t.answerSdp&&!t.negotiationNeeded&&(t.negotiationNeeded=!0,t.triggerNegotiationNeeded())},this.pc.ontrack=function(e){t.logger.info("peerConnection ontrack fired, updating remoteMediaStream"),t.trigger("track");var r=t.remoteMediaStream||new MediaStream;e.streams[0].getTracks().forEach(function(e){t.logger.info("adding "+e.kind+" track to remoteMediaStream"),r&&!r.getTracks().includes(e)&&r.addTrack(e),e.onended=function(){t.logger.info("remote "+e.kind+" has ended, removing track from remoteMediaStream"),r.removeTrack(e),e.onended=void 0;try{t["receiving"+F[e.kind]]=(0,iI.getMediaDirectionFromTracks)(e.kind,t.pc).includes("recv")}catch(r){t["receiving"+F[e.kind]]=!1}},t["receiving"+F[e.kind]]=(0,iI.getMediaDirectionFromTracks)(e.kind,t.pc).includes("recv")}),t.remoteMediaStream=r,t.trigger("internalTrackUpdate")}}return(0,P.default)(e,[{key:"audioDirection",get:function(){return(0,iI.getMediaDirectionFromTracks)("audio",this.pc)}},{key:"videoDirection",get:function(){return(0,iI.getMediaDirectionFromTracks)("video",this.pc)}},{key:"screenDirection",get:function(){return this.localScreenShare&&0!==this.localScreenShare.getTracks().length?"sendonly":"inactive"}},{key:"senderTracks",get:function(){return this.pc.getSenders().reduce(function(e,t){return t.track&&e.push(t.track),e},[])}},{key:"receiverTracks",get:function(){return this.pc.getReceivers().reduce(function(e,t){return t.track&&e.push(t.track),e},[])}}],[{key:"getUserMedia",value:function(e){var t=(0,C.default)({},e,{fake:"test"===Ts.env.NODE_ENV});return navigator.mediaDevices.getUserMedia(t)}}]),(0,P.default)(e,[{key:"_prepareIceGatherer",value:function(){var e=this,t=!1;if("new"===this.pc.iceGatheringState)this.logger.info('ice gathering is in state "new", definitely need to block for ice gathering'),t=!0;else{var r=(0,DA.parse)(this.pc.localDescription.sdp);["audio","video","screen"].forEach(function(n){var i=n+"Direction";("inactive"!==e[i]||N(e,n)!==e[i]&&"inactive"!==N(e,n))&&(r.media.find(function(e){return e.type===n})?e.logger.info(n+" candidates already gathered"):(e.logger.info("transitioning "+n+" from inactive, ice needed"),t=!0))})}var n=void 0;return t&&(n=new k.default(function(t){e.logger.info("configuring ice gathering"),e.pc.onicecandidate=function(r){if(!r.candidate)return e.logger.info("ice gathering complete"),e.pc.onicecandidate=void 0,void t();e.logger.info("got ice candidate")}})),n}},{key:"createOffer",value:function(){var e=this;this.logger.info("beginning negotiation");var t=N(this,"video"),r=t.includes("send")||t.includes("recv"),n=this._prepareIceGatherer();return new k.default(function(t){if(e.gumming)return e.logger.info("gum in flight, waiting until it completes"),void t(e._getUserMedia().then((0,$E.tap)(function(){return e.logger.info("gum completed")})));t()}).then((0,$E.tap)(function(){return e.logger.info("starting create offer",e.offerOptions)})).then(function(){return e.offerOptions.offerToReceiveAudio=!!e.offerOptions.offerToReceiveAudio,e.offerOptions.offerToReceiveVideo=!!e.offerOptions.offerToReceiveVideo,e.logger.info("creating REAL offer",e.offerOptions),e.logger.info("createOffer audioDirection: "+e.audioDirection),e.logger.info("createOffer videoDirection: "+e.videoDirection),e.logger.info("createOffer screenDirection: "+e.screenDirection),e.updateLocalMediaToTargetDirection(),e.pc.createOffer(e.offerOptions)}).then((0,$E.tap)(function(t){t.sdp=(0,iI.limitBandwith)(e.bandwidthLimit,t.sdp),t.sdp=(0,iI.removeExtmap)(t.sdp)})).then((0,$E.tap)(function(){return e.logger.info("setting local description")})).then(function(t){return e.pc.setLocalDescription(t)}).then((0,$E.tap)(function(){return n&&e.logger.info("blocking for ice gathering")})).then(function(){return n}).then((0,$E.tap)(function(){return e.logger.info("limiting bandwith")})).then(function(){return(0,iI.limitBandwith)(e.bandwidthLimit,e.pc.localDescription.sdp)}).then((0,$E.tap)(function(){return r&&e.logger.info("confirm h264 in offer")})).then((0,iI.ensureH264)(r)).then(function(t){if(e.localScreenShare){var r=e.localScreenShare.id,n=e.localScreenShare.getVideoTracks()[0];if(n){var i=r+" "+n.id,o=t.split(i);if(o[1])return o[1]="\r\na=content:slides"+o[1],t=o.join(i)}t+="a=content:slides\r\n"}return t}).then((0,$E.tap)(function(t){e.offerSdp=t}))}},{key:"acceptAnswer",value:function(e){var t=this;this.logger.info("accepting answer"),this.logger.debug("new answer sdp:",e);var r=e.replace(/max-mbps=27600;max-fs=920/g,"max-mbps=27600;max-fs=8160");return r=r.replace(/m=video 0(.*?\r\n)/,"m=video 0$1a=inactive\r\n"),r=(0,iI.removeExtmap)(r),this.logger.debug("cleaned answer sdp:",r),"have-local-offer"===this.pc.signalingState?this.pc.setRemoteDescription(new RTCSessionDescription({sdp:r,type:"answer"})).then(function(){t.logger.info("answer accepted"),t.answerSdp=r,t.sendingAudio=(0,iI.getMediaDirectionFromTracks)("audio",t.pc).includes("send"),t.sendingVideo=(0,iI.getMediaDirectionFromTracks)("video",t.pc).includes("send"),t.updateLocalMediaToTargetDirection(),t.trigger("answeraccepted"),t.negotiationNeeded=!1}):k.default.resolve()}},{key:"_setNewMediaDirection",value:function(e,t){var r=this;this.logger.info("setting "+e+" direction to "+t);var n=t.includes("send");if(this.constraints[e]=n,!n)return this.logger.info("muting "+e+" local tracks"),this.localMediaStream?this.localMediaStream.getTracks().filter(function(t){return t.kind===e}).forEach(function(t){r.logger.info("muting existing "+e+" track from localMediaStream");var i=r.pc.getSenders().find(function(e){return e.track===t});M.default.firefox||r.localMediaStream.removeTrack(t),i&&(r.logger.info("muting existing "+e+" track on sender"),i.track.enabled=!1,t.enabled=!1,M.default.firefox||r.pc.removeTrack(i)),r.logger.info("setting sending"+F[e]+" to "+n),r["sending"+F[e]]=n}):k.default.resolve();var i=this.pc.getSenders().filter(function(t){return t.track&&t.track.kind===e});if(i.length>0){this.logger.info("enabling existing "+e+" sender track");var o=this.localMediaStream.getTracks().filter(function(t){return t.kind===e});return i.forEach(function(e){e.track.enabled=o.includes(e.track)}),this["sending"+F[e]]=n,k.default.resolve()}return this[e+"Direction"].includes("send")?k.default.resolve():this._setNewMediaConstraint(e,n)}},{key:"_setNewMediaTrack",value:function(e,t){return this.logger.info("setting new "+e+" track"),this.constraints[e]=!1,this.addOrReplaceTrack(t)}},{key:"_setNewMediaConstraint",value:function(e,t){return this.logger.info("setting "+e+" with new constraint"),this.constraints[e]=t,this._getUserMedia()}},{key:"_setScreenShare",value:function(e,t){var r=this;if(this.logger.info("calling _setScreenShare"),L.set(this,"screen",e),e.includes("send")){var n=(0,C.default)({},t,{mediaSource:"application",width:{min:"160",max:"1920"},height:{min:"90",max:"1080"},frameRate:{min:"1",max:"30"}});this._setNewMediaConstraint("screen",n)}else this.logger.info("removing existing screenshare tracks from peer connection and localScreenShare stream"),this.pc.getSenders().filter(function(e){return e.track&&r.localScreenShare.getTracks().includes(e.track)}).forEach(function(e){r.logger.info("removing screenshare track "+e.track.id+" from peer connection and localScreenShare stream");var t=e.track;e.track.enabled=!1,r.localScreenShare.removeTrack(t),r.pc.removeTrack(e),t.stop(),r.logger.info("removed screenshare track "+t.id+" from peer connection and localScreenShare stream")}),this.localScreenShare=!1}},{key:"setMedia",value:function(e,t,r){var n=this;return this.logger.info("setMedia"),"screen"===e?(this.logger.info("setMedia: setting new screen direction"),this._setScreenShare(t,r),k.default.resolve()):new k.default(function(i){if(r){if(!t.includes("send"))throw new Error("Cannot set new "+e+" track or constraint if direction does not include send");if(r instanceof MediaStreamTrack){if(r.kind!==e)throw new Error("track is not a valid "+e+" media stream track");i(n._setNewMediaTrack(e,r))}else i(n._setNewMediaConstraint(e,r))}else t===N(n,e)&&(n.logger.info("setMedia: "+e+" already transitioning to "+t+", not making changes"),i()),t===n[e+"Direction"]&&(n.logger.info("setMedia: "+e+" already set to "+t+", not making changes"),i()),i(n._setNewMediaDirection(e,t))}).then(function(){var r=t.includes("recv");n.logger.info("setMedia: set targetMediaDirection for "+e+" to "+t),L.set(n,e,t),n.logger.info("setMedia: set offerToReceive"+(0,iI.kindToPropertyFragment)(e)+" to "+r),n.offerOptions["offerToReceive"+(0,iI.kindToPropertyFragment)(e)]=r;var i=n.pc.getReceivers().filter(function(t){return t.track&&t.track.kind===e});r?i.length>0?(n.logger.info("setMedia: unpause existing receiving "+e+" track"),n.unpauseReceivingMedia(e)):!i.length&&n.answerSdp&&(n.logger.info("setMedia: no receiving "+e+" track exists, trigger negotiation"),n.triggerNegotiationNeeded()):i.length>0&&(n.logger.info("setMedia: pausing existing receiving "+e+" track"),n.pauseReceivingMedia(e))})}},{key:"_getUserMedia",value:function(){var t=this;return this.logger.info("enqueing request to get user media"),new k.default(function(e){return ps(e)}).then(function(){!0===t.constraints.audio&&t.pc.getSenders().find(function(e){return e.track&&"audio"===e.track.kind})&&(t.logger.info("already have a local audio track, removing constraint for a second one"),(0,S.default)(t.constraints,"audio")),!0===t.constraints.video&&t.pc.getSenders().find(function(e){return e.track&&"video"===e.track.kind})&&(t.logger.info("already have a local video track, removing constraint for a second one"),(0,S.default)(t.constraints,"video"));var r=t.constraints,n=r.audio,i=r.video,o=r.screen;return t.logger.info("getting user media with "+(n?"1":"0")+" audio track, "+(i?"1":"0")+" video track, and "+(o?"1":"0")+" screenshare track."),k.default.all([(n||i)&&e.getUserMedia({audio:n,video:i}),o&&e.getUserMedia({video:o})])}).then(function(e){var r=(0,w.default)(e,2),n=r[0],i=r[1],o=[];if(n&&(t.logger.info("got local media stream with "+n.getAudioTracks().length+" audio tracks and "+n.getVideoTracks().length+" video tracks"),n.getTracks().forEach(function(e){return o.push(t.addOrReplaceTrack(e))})),i){if(t.localScreenShare){var a=t.pc.getSenders().find(function(e){return t.localScreenShare.getTracks().includes(e.track)});a&&(t.logger.info("removing existing screenshare track from localScreenShare stream"),t.localScreenShare.removeTrack(a.track),t.logger.info("disabling existing screenshare track on sender"),a.track.enabled=!1),i.getTracks().forEach(function(e){a?(t.logger.info("replacing existing screenshare track on sender"),o.push(a.replaceTrack(e))):(t.logger.info("adding new screen track to peerConnection"),t.pc.addTrack(e,i))})}else t.logger.info("adding localScreenShare for the first time"),t.logger.info("adding new screenshare track to peer connection"),i.getVideoTracks().forEach(function(e){return t.pc.addTrack(e,i)});t.localScreenShare=i}return t.constraints={},k.default.all(o)}).catch(function(e){return t.trigger("error",e),k.default.reject(e)})}},{key:"addOrReplaceTrack",value:function(e){var t=this,r=[];this.localMediaStream||(this.localMediaStream=new MediaStream);var n=this.pc.getSenders().find(function(t){return t.track&&t.track.kind===e.kind}),i=this.localMediaStream.getTracks().find(function(t){return t.kind===e.kind});return i!==e&&(i&&(this.logger.info("removing previous "+i.kind+" track from localMediaStream"),this.localMediaStream.removeTrack(i)),this.logger.info("adding new "+e.kind+" track to localMediaStream"),this.localMediaStream.addTrack(e)),n?n.track===e?(this.logger.info("new track is the same as existing track, renabling "+e.kind+" track on sender"),n.track.enabled=!0):(this.logger.info("replacing new "+e.kind+" on existing sender"),r.push(n.replaceTrack(e).then(function(){t.logger.info("successfully replace "+e.kind+" on existing sender")}).catch(function(r){t.logger.warn(r),t.logger.warn("was not able to replace "+e.kind+" track on sender"),t.logger.info("adding as new "+e.kind+" track to peerConnection"),t.pc.removeTrack(n),t.pc.addTrack(e,t.localMediaStream)}))):(this.logger.info("adding new "+e.kind+" track to peerConnection"),this.pc.addTrack(e,this.localMediaStream)),this.logger.info("setting sending"+F[e.kind]+" to true"),this["sending"+F[e.kind]]=!0,k.default.all(r)}},{key:"pauseSendingMedia",value:function(e){var t=this;if(!e)throw new Error("kind is required");var r=this.pc.getSenders().filter(function(t){return t.track&&t.track.kind===e});if(0===r.length)throw new Error("No "+e+" media senders to pause");r.forEach(function(r){t.logger.info("pausing "+e+" sender"),r.track.enabled=!1}),this.logger.info("setting sending"+F[e]+" to false"),this["sending"+F[e]]=!1}},{key:"updateLocalMediaToTargetDirection",value:function(){var e=this;["audio","video"].forEach(function(t){var r=N(e,t),n=e[t+"Direction"];if(n!==r){var i=r.includes("send");n.includes("send")!==i&&e.pc.getSenders().forEach(function(e){e.track&&e.track.kind===t&&(e.track.enabled=i)});var o=r.includes("recv");n.includes("send")!==o&&e.pc.getReceivers().forEach(function(e){e.track&&e.track.kind===t&&(e.track.enabled=o)})}})}},{key:"unpauseSendingMedia",value:function(e){var t=this;if(!e)throw new Error("kind is required");var r=this.pc.getSenders().filter(function(t){return t.track&&t.track.kind===e});if(0===r.length)throw new Error("No "+e+" media senders to unpause");r.forEach(function(r){t.logger.info("unpausing "+e+" sender"),r.track.enabled=!0}),this.logger.info("setting sending"+F[e]+" to true"),this["sending"+F[e]]=!0}},{key:"pauseReceivingMedia",value:function(e){var t=this;if(!e)throw new Error("kind is required");var r=this.pc.getReceivers().filter(function(t){return t.track&&t.track.kind===e});if(0===r.length)throw new Error("No "+e+" receiver media tracks to pause");r.forEach(function(r){t.logger.info("pausing remote "+e+" track"),r.track.enabled=!1}),this.logger.info("setting receiving"+F[e]+" to false"),this["receiving"+F[e]]=!1}},{key:"unpauseReceivingMedia",value:function(e){var t=this;if(!e)throw new Error("kind is required");var r=this.pc.getReceivers().filter(function(t){return t.track&&t.track.kind===e});if(0===r.length)throw new Error("No "+e+" receiver media tracks to pause");r.forEach(function(r){t.logger.info("unpausing "+e+" receiver track"),r.track.enabled=!0}),this.logger.info("setting receiving"+F[e]+" to true from "+this["receiving"+F[e]]),this["receiving"+F[e]]=!0}},{key:"stop",value:function(){"closed"!==this.pc.signalingState&&(this.pc.getSenders().forEach(function(e){return e.track&&e.track.stop()}),this.pc.close()),this.pc.onnegotiationneeded=void 0,this.pc.ontrack=void 0,this.pc.onicecandidate=void 0,this.ended=!0,this.off()}},{key:"triggerNegotiationNeeded",value:function(){this.trigger("negotiationneeded")}},{key:"serialize",value:function(){return"WebRTCMediaEngine"}}]),e}(),o=D(i.prototype,"localMediaStream",[x.default],{enumerable:!0,initializer:null}),a=D(i.prototype,"remoteMediaStream",[x.default],{enumerable:!0,initializer:null}),u=D(i.prototype,"localScreenShare",[x.default],{enumerable:!0,initializer:null}),s=D(i.prototype,"offerSdp",[x.default],{enumerable:!0,initializer:function(){return""}}),c=D(i.prototype,"answerSdp",[x.default],{enumerable:!0,initializer:function(){return""}}),l=D(i.prototype,"sendingAudio",[x.default],{enumerable:!0,initializer:function(){return!1}}),f=D(i.prototype,"sendingVideo",[x.default],{enumerable:!0,initializer:function(){return!1}}),d=D(i.prototype,"receivingAudio",[x.default],{enumerable:!0,initializer:function(){return!1}}),p=D(i.prototype,"receivingVideo",[x.default],{enumerable:!0,initializer:function(){return!1}}),h=D(i.prototype,"ended",[x.default],{enumerable:!0,initializer:function(){return!1}}),v=D(i.prototype,"constraints",[WE.nonenumerable],{enumerable:!0,initializer:function(){return{}}}),g=D(i.prototype,"offerOptions",[WE.nonenumerable],{enumerable:!0,initializer:function(){return{}}}),y=D(i.prototype,"gumming",[WE.nonenumerable,x.default],{enumerable:!0,initializer:function(){return!1}}),D(i.prototype,"_getUserMedia",[r,$E.oneFlight],(0,_.default)(i.prototype,"_getUserMedia"),i.prototype),D(i.prototype,"triggerNegotiationNeeded",[n],(0,_.default)(i.prototype,"triggerNegotiationNeeded"),i.prototype),i);t.default=U,(0,m.default)(U.prototype,j.default)});t(oI);var aI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.webrtcHelpers=t.WebRTCMediaEngine=t.default=void 0,Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n(oI).default}}),Object.defineProperty(t,"WebRTCMediaEngine",{enumerable:!0,get:function(){return n(oI).default}});var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(iI);function n(e){return e&&e.__esModule?e:{default:e}}t.webrtcHelpers=r});t(aI);aI.webrtcHelpers,aI.WebRTCMediaEngine;var uI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=t.locusEventKeys=["locus.summary","locus.self_changed","locus.participant_joined","locus.participant_left","locus.participant_declined","locus.participant_alerted","locus.participant_updated","locus.participant_roles_updated","locus.participant_audio_muted","locus.participant_audio_unmuted","locus.participant_video_muted","locus.participant_video_unmuted","locus.floor_granted","locus.floor_released","locus.space_users_modified","locus.controls_updated","locus.participant_controls_updated"];t.default=r});t(uI);uI.locusEventKeys;var sI=function(e){return e&&e.length?e[0]:void 0},cI=v_(function(e,t){return yT(e)?Rj(e,Yv(t,1,yT,!0)):[]}),lI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DESYNC=t.LESS_THAN=t.GREATER_THAN=t.FETCH=t.EQUAL=t.USE_CURRENT=t.USE_INCOMING=void 0;var r=v(UO),n=v(p_),i=v(HT),o=v(YE),a=v(bf),u=v(jf),s=v(yO),c=v(wv),l=v(Rv),f=v(sI),d=v(cI),p=v(gg),h=v(dx);function v(e){return e&&e.__esModule?e:{default:e}}var g=t.USE_INCOMING="USE_INCOMING",y=t.USE_CURRENT="USE_CURRENT",m=t.EQUAL="EQUAL",b=t.FETCH="FETCH",_=t.GREATER_THAN="GREATER_THAN",w=t.LESS_THAN="LESS_THAN",S=t.DESYNC="DESYNC";function k(e){switch(e){case m:case _:return y;case w:return g;case S:return b;default:throw new Error(e+" is not a recognized sequence comparison result")}}var E=Ix.SparkPlugin.extend({namespace:"Locus",alert:function(e){return this.request({method:"PUT",uri:e.url+"/participant/alert",body:{deviceUrl:this.spark.internal.device.url,sequence:e.sequence}}).then(function(e){return e.body})},compare:function(e,t){function r(e){var t=e.sequence;return!(t.entries&&t.entries.length||0!==t.rangeStart||0!==t.rangeEnd)}return r(e)||r(t)?g:t.baseSequence?this.compareDelta(e,t):k(this.compareSequence(e.sequence,t.sequence))},compareDelta:function(e,t){var r=this.compareSequence(e.sequence,t.sequence);if(r!==w)return k(r);switch(r=this.compareSequence(e.sequence,t.baseSequence)){case _:case m:return g;default:return b}},compareSequence:function(e,t){if(!e)throw new Error("`current` is required");if(!t)throw new Error("`incoming` is required");var r=(0,c.default)(function(e){return 0===e.entries.length?0:(0,f.default)(e.entries)}),n=(0,c.default)(function(e){return 0===e.entries.length?0:(0,l.default)(e.entries)}),i=(0,c.default)(function(e){return e.rangeStart||r(e)}),o=(0,c.default)(function(e){return n(e)||e.rangeEnd});function a(e,t){return e>=t.rangeStart&&e<=t.rangeEnd}if(i(e)>o(t))return _;if(o(e)<i(t))return w;var u=(0,d.default)(e.entries,t.entries),p=(0,d.default)(t.entries,e.entries),h=[],v=[],g=!0,y=!1,b=void 0;try{for(var k,E=(0,s.default)(u);!(g=(k=E.next()).done);g=!0){var P=k.value;a(P,t)||h.push(P)}}catch(e){y=!0,b=e}finally{try{!g&&E.return&&E.return()}finally{if(y)throw b}}var T=!0,O=!1,C=void 0;try{for(var M,x=(0,s.default)(p);!(T=(M=x.next()).done);T=!0){var j=M.value;a(j,e)||v.push(j)}}catch(e){O=!0,C=e}finally{try{!T&&x.return&&x.return()}finally{if(O)throw C}}if(!h.length&&!v.length)return e.rangeEnd-i(e)>t.rangeEnd-i(t)?_:e.rangeEnd-i(e)<t.rangeEnd-i(t)?w:m;if(h.length&&!v.length)return _;if(!h.length&&v.length)return w;if(!(e.rangeStart||e.rangeEnd||t.rangeStart||t.rangeEnd))return S;var R=!0,A=!1,I=void 0;try{for(var D,L=(0,s.default)(h);!(R=(D=L.next()).done);R=!0){var F=D.value;if(i(t)<F&&F<o(t))return S}}catch(e){A=!0,I=e}finally{try{!R&&L.return&&L.return()}finally{if(A)throw I}}var N=!0,U=!1,z=void 0;try{for(var q,B=(0,s.default)(v);!(N=(q=B.next()).done);N=!0){var W=q.value;if(i(e)<W&&W<o(e))return S}}catch(e){U=!0,z=e}finally{try{!N&&B.return&&B.return()}finally{if(U)throw z}}return h[0]>v[0]?_:w},create:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.correlationId;if(!r)throw new Error("options.correlationId is required");return this.request({method:"POST",service:"locus",resource:"loci/call",body:{correlationId:r,deviceUrl:this.spark.internal.device.url,invitee:{invitee:e},localMedias:[{localSdp:(0,u.default)({type:"SDP",sdp:t.localSdp})}],sequence:{entries:[],rangeStart:0,rangeEnd:0}}}).then(function(e){return e.body.locus})},createOrJoin:function(e,t){return e.url?this.join(e,t):this.create(e,t)},decline:function(e){var t=this;return this.request({method:"PUT",uri:e.url+"/participant/decline",body:{deviceUrl:this.spark.internal.device.url,sequence:e.sequence}}).then(function(e){return e.body}).catch(function(r){return r instanceof Ix.SparkHttpError.Conflict?t.get(e):a.default.reject(r)})},get:function(e){return this.request({method:"GET",uri:""+e.url}).then(function(e){return e.body})},getCallHistory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new Date(e.from||Date.now()).toISOString();return this.request({method:"GET",service:"janus",resource:"history/userSessions",qs:{from:t}}).then(function(e){return e.body})},join:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.correlationId||t.correlationId;if(!r)throw new Error("locus.correlationId or options.correlationId is required");return this.request({method:"POST",uri:e.url+"/participant",body:{correlationId:r,deviceUrl:this.spark.internal.device.url,localMedias:[{localSdp:(0,u.default)({type:"SDP",sdp:t.localSdp})}],sequence:e.sequence||{entries:[],rangeStart:0,rangeEnd:0}}}).then(function(e){return e.body.locus})},leave:function(e){var t=this;return this.request({method:"PUT",uri:e.self.url+"/leave",body:{deviceUrl:this.spark.internal.device.url,sequence:e.sequence}}).then(function(e){return e.body.locus}).catch(function(r){return r instanceof Ix.SparkHttpError.Conflict?t.get(e):a.default.reject(r)})},list:function(){return this.request({method:"GET",service:"locus",resource:"loci"}).then(function(e){return e.body.loci})},merge:function(e,t){if(!t.baseSequence)return t;var a=(0,p.default)(e);if((0,o.default)(t).forEach(function(e){"baseSequence"!==e&&"participants"!==e&&(a[e]=t[e]||a[e])}),t.participants||t.participants.length){var u=new i.default,s=new n.default;t.participants.forEach(function(e){e.removed?u.add(e.url):s.set(e.url,e)});var c=a.participants.reduce(function(e,t){return u.has(t.url)||(e[t.url]=t),e},{});s.forEach(function(e,t){c[t]=e}),a.participants=(0,r.default)(c)}return a},releaseFloorGrant:function(e,t){return this.spark.request({uri:t.url,method:"PUT",body:{floor:{disposition:"RELEASED"}}}).then(function(e){return e.body})},requestFloorGrant:function(e,t){return this.spark.request({uri:t.url,method:"PUT",body:{floor:{beneficiary:{url:e.self.url,devices:[{url:this.spark.internal.device.url}]},disposition:"GRANTED"}}}).then(function(e){return e.body})},sendDtmf:function(e,t){return this.request({method:"POST",uri:e.self.url+"/sendDtmf",body:{deviceUrl:this.spark.internal.device.url,dtmf:{correlationId:h.default.v4(),tones:t}}})},sync:function(e){return this.request({method:"GET",uri:e.syncUrl}).then(function(e){return e.body||{}})},updateMedia:function(e,t){var r=t.sdp,n=t.audioMuted,i=t.videoMuted,o=t.mediaId,a={audioMuted:n,videoMuted:i};return r&&(a.type="SDP",a.sdp=r),this.request({method:"PUT",uri:e.self.url+"/media",body:{deviceUrl:this.spark.internal.device.url,localMedias:[{localSdp:(0,u.default)(a),mediaId:o}],sequence:e.sequence}}).then(function(e){return e.body.locus})},version:"1.50.12"});t.default=E});t(lI);lI.DESYNC,lI.LESS_THAN,lI.GREATER_THAN,lI.FETCH,lI.EQUAL,lI.USE_CURRENT,lI.USE_INCOMING;var fI=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var dI=function(e){return fI.test(e)};var pI=function(e){return e.split("")},hI="[\\ud800-\\udfff]",vI="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",gI="\\ud83c[\\udffb-\\udfff]",yI="[^\\ud800-\\udfff]",mI="(?:\\ud83c[\\udde6-\\uddff]){2}",bI="[\\ud800-\\udbff][\\udc00-\\udfff]",_I="(?:"+vI+"|"+gI+")"+"?",wI="[\\ufe0e\\ufe0f]?"+_I+("(?:\\u200d(?:"+[yI,mI,bI].join("|")+")[\\ufe0e\\ufe0f]?"+_I+")*"),SI="(?:"+[yI+vI+"?",vI,mI,bI,hI].join("|")+")",kI=RegExp(gI+"(?="+gI+")|"+SI+wI,"g");var EI=function(e){return e.match(kI)||[]};var PI=function(e){return dI(e)?EI(e):pI(e)};var TI=function(e){return function(t){t=xv(t);var r=dI(t)?PI(t):void 0,n=r?r[0]:t.charAt(0),i=r?hA(r,1).join(""):t.slice(1);return n[e]()+i}}("toUpperCase");var OI=function(e){return TI(xv(e).toLowerCase())};var CI=function(e,t,r,n){var i=-1,o=null==e?0:e.length;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r},MI=iP({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),xI=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,jI=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");var RI=function(e){return(e=xv(e))&&e.replace(xI,MI).replace(jI,"")},AI=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var II=function(e){return e.match(AI)||[]},DI=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var LI=function(e){return DI.test(e)},FI="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",NI="["+FI+"]",UI="\\d+",zI="[\\u2700-\\u27bf]",qI="[a-z\\xdf-\\xf6\\xf8-\\xff]",BI="[^\\ud800-\\udfff"+FI+UI+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",WI="(?:\\ud83c[\\udde6-\\uddff]){2}",VI="[\\ud800-\\udbff][\\udc00-\\udfff]",GI="[A-Z\\xc0-\\xd6\\xd8-\\xde]",HI="(?:"+qI+"|"+BI+")",$I="(?:"+GI+"|"+BI+")",JI="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",YI="[\\ufe0e\\ufe0f]?"+JI+("(?:\\u200d(?:"+["[^\\ud800-\\udfff]",WI,VI].join("|")+")[\\ufe0e\\ufe0f]?"+JI+")*"),KI="(?:"+[zI,WI,VI].join("|")+")"+YI,XI=RegExp([GI+"?"+qI+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[NI,GI,"$"].join("|")+")",$I+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[NI,GI+HI,"$"].join("|")+")",GI+"?"+HI+"+(?:['’](?:d|ll|m|re|s|t|ve))?",GI+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",UI,KI].join("|"),"g");var ZI=function(e){return e.match(XI)||[]};var QI=function(e,t,r){return e=xv(e),void 0===(t=r?void 0:t)?LI(e)?ZI(e):II(e):e.match(t)||[]},eD=RegExp("['’]","g");var tD=function(e){return function(t){return CI(QI(RI(t).replace(eD,"")),e,"")}}(function(e,t,r){return t=t.toLowerCase(),e+(r?OI(t):t)}),rD=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Forbidden=t.NotAuthorized=t.BadRequest=t.UnknownResponse=t.ConnectionError=void 0;var r,n,i,o,a,u,s,c,l,f,d=m(lO),p=m(rk),h=m(Wm),v=m($m),g=m(nk),y=m(ik);function m(e){return e&&e.__esModule?e:{default:e}}var b=t.ConnectionError=(n=r=function(e){function t(){return(0,h.default)(this,t),(0,g.default)(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,v.default)(t,[{key:"parse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,d.default)(this,{code:{value:e.code},reason:{value:e.reason}}),e.reason}}]),t}($E.Exception),r.defaultMessage="Failed to connect to socket",n);t.UnknownResponse=(o=i=function(e){function t(){return(0,h.default)(this,t),(0,g.default)(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),t}(b),i.defaultMessage="UnknownResponse is produced by IE when we receive a 4XXX. You probably want to treat this like a NotFound",o),t.BadRequest=(u=a=function(e){function t(){return(0,h.default)(this,t),(0,g.default)(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),t}(b),a.defaultMessage="BadRequest usually implies an attempt to use service account credentials",u),t.NotAuthorized=(c=s=function(e){function t(){return(0,h.default)(this,t),(0,g.default)(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),t}(b),s.defaultMessage="Please refresh your access token",c),t.Forbidden=(f=l=function(e){function t(){return(0,h.default)(this,t),(0,g.default)(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),t}(b),l.defaultMessage="Forbidden usually implies these credentials are not entitled for Spark",f)});t(rD);rD.Forbidden,rD.NotAuthorized,rD.BadRequest,rD.UnknownResponse,rD.ConnectionError;var nD=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=g(jf),n=g(TO),i=g(YE),o=g(bf),a=g(rk),u=g(Wm),s=g($m),c=g(nk),l=g(ik),f=g(hb),d=g(sd),p=g(fT),h=g(cS),v=g(dx);function g(e){return e&&e.__esModule?e:{default:e}}var y=new f.default,m=function(e){function t(){(0,u.default)(this,t);var e=(0,c.default)(this,(t.__proto__||(0,a.default)(t)).call(this));return e.onmessage=e.onmessage.bind(e),e.onclose=e.onclose.bind(e),e}return(0,l.default)(t,e),(0,s.default)(t,[{key:"close",value:function(e){var t=this;return new o.default(function(r,n){t.logger.info("socket: closing");var i=y.get(t);if(2===i.readyState||3===i.readyState)return t.logger.info("socket: already closed"),void r();if((e=e||{}).code&&1e3!==e.code&&(e.code<3e3||e.code>4999))n(new Error("`options.code` must be 1000 or between 3000 and 4999 (inclusive)"));else{e=(0,h.default)(e,{code:1e3,reason:"Done"});var o=(0,ZE.safeSetTimeout)(function(){try{t.logger.info("socket: no close event received, forcing closure"),r(t.onclose({code:1e3,reason:"Done (forced)"}))}catch(e){t.logger.warn("socket: force-close failed",e)}},t.forceCloseDelay);i.onclose=function(e){t.logger.info("socket: close event fired",e.code,e.reason),clearTimeout(o),t.onclose(e),r(e)},i.close(e.code,e.reason)}})}},{key:"open",value:function(e,r){var a=this;return new o.default(function(o,u){if(e)if(y.get(a))u(new Error("Socket#open() can only be called once per instance"));else{r=r||{},(0,$E.checkRequired)(["forceCloseDelay","pingInterval","pongTimeout","token","trackingId","logger"],r),(0,i.default)(r).forEach(function(e){(0,n.default)(a,e,{enumerable:!1,value:r[e]})});var s=t.getWebSocketConstructor();a.logger.info("socket: creating WebSocket");var c=new s(e);c.binaryType="arraybuffer",c.onmessage=a.onmessage,c.onclose=function(e){switch((e=a._fixCloseCode(e)).code){case 1005:return u(new rD.UnknownResponse(e));case 4400:return u(new rD.BadRequest(e));case 4401:return u(new rD.NotAuthorized(e));case 4403:return u(new rD.Forbidden(e));default:return u(new rD.ConnectionError(e))}},c.onopen=function(){a.logger.info("socket: connected"),a._authorize().then(function(){a.logger.info("socket: authorized"),c.onclose=a.onclose,o()}).catch(u)},c.onerror=function(e){a.logger.warn("socket: error event fired",e)},y.set(a,c),a.logger.info("socket: waiting for server")}else u(new Error("`url` is required"))})}},{key:"onclose",value:function(e){this.logger.info("socket: closed",e.code,e.reason),clearTimeout(this.pongTimer),clearTimeout(this.pingTimer),e=this._fixCloseCode(e),this.emit("close",e),this.removeAllListeners()}},{key:"onmessage",value:function(e){try{var t=JSON.parse(e.data),r=parseInt(t.sequenceNumber,10);this.logger.debug("socket: sequence number: ",r),this.expectedSequenceNumber&&r!==this.expectedSequenceNumber&&(this.logger.debug("socket: sequence number mismatch indicates lost mercury message. expected: "+this.expectedSequenceNumber+", actual: "+r),this.emit("sequence-mismatch",r,this.expectedSequenceNumber)),this.expectedSequenceNumber=r+1;var n={data:t};this._acknowledge(n),"pong"===t.type?this.emit("pong",n):this.emit("message",n)}catch(e){this.logger.warn("socket: error while receiving WebSocket message",e)}}},{key:"send",value:function(e){var t=this;return new o.default(function(n,i){return 1!==t.readyState?i(new Error("INVALID_STATE_ERROR")):((0,d.default)(e)&&(e=(0,r.default)(e)),y.get(t).send(e),n())})}},{key:"_acknowledge",value:function(e){return e?(0,p.default)(e,"data.id")?this.send({messageId:e.data.id,type:"ack"}):o.default.reject(new Error("`event.data.id` is required")):o.default.reject(new Error("`event` is required"))}},{key:"_authorize",value:function(){var e=this;return new o.default(function(t){e.logger.info("socket: authorizing"),e.send({id:v.default.v4(),type:"authorization",data:{token:e.token},trackingId:e.trackingId,logLevelToken:e.logLevelToken});e.once("message",function r(n){n.data.type||"mercury.buffer_state"!==n.data.data.eventType&&"mercury.registration_status"!==n.data.data.eventType||(e.removeListener("message",r),e._ping(),t())})})}},{key:"_fixCloseCode",value:function(e){if(1005===e.code&&e.reason)switch(e.reason.toLowerCase()){case"replaced":this.logger.info("socket: fixing CloseEvent code for reason: ",e.reason),e.code=4e3;break;case"authentication failed":case"authentication did not happen within the timeout window of 30000 seconds.":this.logger.info("socket: fixing CloseEvent code for reason: ",e.reason),e.code=1008}return e}},{key:"_ping",value:function(e){var t=this;return e=e||v.default.v4(),this.pongTimer=(0,ZE.safeSetTimeout)(function(){try{t.logger.info("socket: pong not receive in expected period, closing socket"),t.close({code:1e3,reason:"Pong not received"}).catch(function(e){t.logger.warn("socket: failed to close socket after missed pong",e)})}catch(e){t.logger.error("socket: error occurred in onPongNotReceived",e)}},this.pongTimeout),this.once("pong",function(){try{clearTimeout(t.pongTimer),t.pingTimer=(0,ZE.safeSetTimeout)(function(){return t._ping()},t.pingInterval)}catch(e){t.logger.error("socket: error occurred in scheduleNextPingAndCancelPongTimer",e)}}),this.once("pong",function(r){try{t.logger.debug("socket: pong",r.data.id),r.data&&r.data.id!==e&&(t.logger.info("socket: received pong for wrong ping id, closing socket"),t.logger.debug("socket: expected",e,"received",r.data.id),t.close({code:1e3,reason:"Pong mismatch"}))}catch(e){t.logger.error("socket: error occurred in confirmPongId",e)}}),this.logger.debug("socket: ping "+e),this.send({id:e,type:"ping"})}},{key:"binaryType",get:function(){return y.get(this).binaryType}},{key:"bufferedAmount",get:function(){return y.get(this).bufferedAmount}},{key:"extensions",get:function(){return y.get(this).extensions}},{key:"protocol",get:function(){return y.get(this).protocol}},{key:"readyState",get:function(){return y.get(this).readyState}},{key:"url",get:function(){return y.get(this).url}}],[{key:"getWebSocketConstructor",value:function(){throw new Error("Socket.getWebSocketConstructor() must be implemented in an environmentally appropriate way")}}]),t}(fS.EventEmitter);t.default=m});t(nD);var iD=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=nD)&&r.__esModule?r:{default:r};n.default.getWebSocketConstructor=function(){return WebSocket},t.default=n.default});t(iD);var oD=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return(e=iD,e&&e.__esModule?e:{default:e}).default;var e}})});t(oD);var aD=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n,i,o=y(ac),a=y(mO),u=y(cc),s=y(Ef),c=y(YE),l=y(bf),f=y($M),d=y(ex),p=y(tD),h=y(AS),v=y(oD),g=y(mm);function y(e){return e&&e.__esModule?e:{default:e}}function m(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var b=["idle","done (forced)","pong not received","pong mismatch"],_=Ix.SparkPlugin.extend((r=(0,$E.deprecated)("Mercury#listen(): Use Mercury#connect() instead"),n=(0,$E.deprecated)("Mercury#stopListening(): Use Mercury#disconnect() instead"),m(i={namespace:"Mercury",session:{connected:{default:!1,type:"boolean"},connecting:{default:!1,type:"boolean"},socket:"object",localClusterServiceUrls:"object"},derived:{listening:{deps:["connected"],fn:function(){return this.connected}}},connect:function(e){var t=this;return this.connected?(this.logger.info("mercury: already connected, will not connect again"),l.default.resolve()):(this.connecting=!0,l.default.resolve(this.spark.internal.device.registered||this.spark.internal.device.register()).then(function(){return t.logger.info("mercury: connecting"),t._connectWithBackoff(e)}))},disconnect:function(){var e=this;return new l.default(function(t){if(e.backoffCall&&(e.logger.info("mercury: aborting connection"),e.backoffCall.abort()),e.socket)return e.socket.removeAllListeners("message"),e.once("offline",t),void e.socket.close();t()})},listen:function(){return this.connect()},stopListening:function(){return this.disconnect()},processRegistrationStatusEvent:function(e){this.localClusterServiceUrls=e.localClusterServiceUrls},_applyOverrides:function(e){e.headers&&(0,c.default)(e.headers).forEach(function(t){(0,f.default)(e,t,e.headers[t])})},_prepareUrl:function(e){var t=this;return e||(e=this.spark.internal.device.webSocketUrl),this.spark.internal.feature.getFeature("developer","web-ha-messaging").then(function(r){return r?t.spark.internal.device.useServiceCatalogUrl(e):e}).then(function(t){e=t}).then(function(){return t.spark.internal.feature.getFeature("developer","web-shared-mercury")}).then(function(r){return e=g.default.parse(e,!0),(0,s.default)(e.query,{outboundWireFormat:"text",bufferStates:!0,aliasHttpStatus:!0}),r&&((0,s.default)(e.query,{mercuryRegistrationStatus:!0,isRegistrationRefreshEnabled:!0}),(0,u.default)(e.query,"bufferStates")),(0,d.default)(t,"spark.config.device.ephemeral",!1)&&(e.query.multipleConnections=!0),g.default.format(e)})},_attemptConnection:function(e,t){var r=this,n=new v.default,i=void 0;n.on("close",function(){return r._onclose.apply(r,arguments)}),n.on("message",function(){return r._onmessage.apply(r,arguments)}),n.on("sequence-mismatch",function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r._emit.apply(r,["sequence-mismatch"].concat(t))}),l.default.all([this._prepareUrl(e),this.spark.credentials.getUserToken()]).then(function(e){var t=(0,a.default)(e,2),o=t[0],u=t[1];return i=o,n.open(o,{forceCloseDelay:r.config.forceCloseDelay,pingInterval:r.config.pingInterval,pongTimeout:r.config.pongTimeout,token:u.toString(),trackingId:r.spark.sessionId+"_"+Date.now(),logger:r.logger})}).then(function(){return r.socket=n,r.spark.internal.metrics.submitClientMetrics("web-ha-mercury",{fields:{success:!0},tags:{action:"connected",url:i}}),t(),r.spark.internal.feature.getFeature("developer","web-ha-messaging").then(function(e){return e?r.spark.internal.device.fetchNewUrls(i):l.default.resolve()})}).catch(function(e){return 1006!==e.code&&r.backoffCall&&r.backoffCall.getNumRetries()>0&&r._emit("connection_failed",e,{retries:r.backoffCall.getNumRetries()}),r.logger.info("mercury: connection attempt failed",e),e instanceof rD.UnknownResponse?(r.logger.info("mercury: received unknown response code, refreshing device registration"),r.spark.internal.device.refresh().then(function(){return t(e)})):e instanceof rD.NotAuthorized?(r.logger.info("mercury: received authorization error, reauthorizing"),r.spark.credentials.refresh({force:!0}).then(function(){return t(e)})):e instanceof rD.BadRequest||e instanceof rD.Forbidden?(r.logger.warn("mercury: received unrecoverable response from mercury"),r.backoffCall.abort(),t(e)):e instanceof rD.ConnectionError?r.spark.internal.feature.getFeature("developer","web-ha-messaging").then(function(t){return t?(r.logger.info("mercury: received a generic connection error, will try to connect to another datacenter"),r.spark.internal.metrics.submitClientMetrics("web-ha-mercury",{fields:{success:!1},tags:{action:"failed",error:e.message,url:i}}),r.spark.internal.device.markUrlFailedAndGetNew(i)):null}).then(function(){return t(e)}):t(e)}).catch(function(e){r.logger.error("mercury: failed to handle connection failure",e),t(e)})},_connectWithBackoff:function(e){var t=this;return new l.default(function(r,n){var i=void 0;(i=h.default.call(function(r){t.logger.info("mercury: executing connection attempt "+i.getNumRetries()),t._attemptConnection(e,r)},function(e){return t.connecting=!1,t.backoffCall=void 0,e?(t.logger.info("mercury: failed to connect after "+i.getNumRetries()+" retries; log statement about next retry was inaccurate"),n(e)):(t.connected=!0,t._emit("online"),r())})).setStrategy(new h.default.ExponentialStrategy({initialDelay:t.config.backoffTimeReset,maxDelay:t.config.backoffTimeMax})),t.config.maxRetries&&i.failAfter(t.config.maxRetries),i.on("abort",function(){t.logger.info("mercury: connection aborted"),n()}),i.on("callback",function(e){if(e){var r=i.getNumRetries(),n=Math.min(i.strategy_.nextBackoffDelay_,t.config.backoffTimeMax);t.logger.info("mercury: failed to connect; attempting retry "+(r+1)+" in "+n+" ms")}else t.logger.info("mercury: connected")}),i.start(),t.backoffCall=i})},_emit:function(){try{this.trigger.apply(this,arguments)}catch(e){this.logger.error("mercury: error occurred in event handler",e)}},_getEventHandlers:function(e){var t=e.split("."),r=(0,a.default)(t,2),n=r[0],i=r[1],o=[];if(!this.spark[n]&&!this.spark.internal[n])return o;var u=(0,p.default)("process_"+i+"_event");return(this.spark[n]||this.spark.internal[n])[u]&&o.push({name:u,namespace:n}),o},_onclose:function(e){try{var t=e.reason&&e.reason.toLowerCase(),r=this.socket.url;switch(this.socket.removeAllListeners(),this.unset("socket"),this.connected=!1,this._emit("offline",e),e.code){case 1003:this.logger.info("mercury: Mercury service rejected last message; will not reconnect: "+e.reason),this._emit("offline.permanent",e);break;case 4e3:this.logger.info("mercury: socket replaced; will not reconnect"),this._emit("offline.replaced",e);break;case 1001:case 1005:case 1006:case 1011:this.logger.info("mercury: socket disconnected; reconnecting"),this._emit("offline.transient",e),this._reconnect(r);break;case 1e3:b.includes(t)?(this.logger.info("mercury: socket disconnected; reconnecting"),this._emit("offline.transient",e),this._reconnect(r)):(this.logger.info("mercury: socket disconnected; will not reconnect"),this._emit("offline.permanent",e));break;default:this.logger.info("mercury: socket disconnected unexpectedly; will not reconnect"),this._emit("offline.permanent",e)}}catch(e){this.logger.error("mercury: error occurred in close handler",e)}},_onmessage:function(e){var t=this,r=e.data,n=r.data;return this._applyOverrides(n),this._getEventHandlers(n.eventType).reduce(function(e,r){return e.then(function(){var e=r.namespace,i=r.name;return new l.default(function(r){return r((t.spark[e]||t.spark.internal[e])[i](n))}).catch(function(e){return t.logger.error("mercury: error occurred in autowired event handler for "+n.eventType,e)})})},l.default.resolve()).then(function(){t._emit("event",e.data);var i=n.eventType.split("."),o=(0,a.default)(i,1)[0];t._emit("event:"+o,r),t._emit("event:"+n.eventType,r)}).catch(function(e){t.logger.error("mercury: error occurred processing socket message",e)})},_reconnect:function(e){return this.logger.info("mercury: reconnecting"),this.connect(e)},version:"1.50.12"},"connect",[$E.oneFlight],(0,o.default)(i,"connect"),i),m(i,"disconnect",[$E.oneFlight],(0,o.default)(i,"disconnect"),i),m(i,"listen",[r],(0,o.default)(i,"listen"),i),m(i,"stopListening",[n],(0,o.default)(i,"stopListening"),i),i));t.default=_});t(aD);var uD=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={mercury:{pingInterval:15e3,pongTimeout:14e3,backoffTimeMax:32e3,backoffTimeReset:1e3,forceCloseDelay:2e3}}});t(uD);var sD=function(e,t,r,n){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(n,a,r(a),e)}return n};var cD=function(e,t,r,n){return kT(e,function(e,i,o){t(n,e,r(e),o)}),n};var lD=function(e,t){return function(r,n){var i=vp(r)?sD:cD,o=t?t():{};return i(r,e,Kx(n,2),o)}},fD=lD(function(e,t,r){e[r?0:1].push(t)},function(){return[[],[]]}),dD=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(Cf),n=o(bf),i=o(fD);function o(e){return e&&e.__esModule?e:{default:e}}var a=Ix.SparkPlugin.extend({namespace:"Feature",getFeature:function(e,t,r){if("developer"!==e&&"user"!==e&&"entitlement"!==e)return n.default.reject(new Error("Invalid feature keyType provided. Only `developer`, `user`, and `entitlement` feature toggles are permitted."));r=r||{};var i=this.spark.internal.device.features[e].get(t);return i?r.full?n.default.resolve(i.serialize()):n.default.resolve(i.value):n.default.resolve(null)},setFeature:function(e,t,r){var i=this;return"developer"!==e&&"user"!==e?n.default.reject(new Error("Only `developer` and `user` feature toggles can be set.")):this.request({method:"POST",api:"feature",resource:"features/users/"+this.spark.internal.device.userId+"/"+e,body:{key:t,mutable:!0,val:r}}).then(function(t){return i.spark.internal.device.features[e].add(t.body,{merge:!0})})},setBundledFeatures:function(e){var t=this;return e.forEach(function(e){e.mutable=e.mutable||"true","USER"!==e.type&&"DEV"!==e.type&&(e.type="USER")}),this.request({method:"POST",api:"feature",resource:"features/users/"+this.spark.internal.device.userId+"/toggles",body:e}).then(function(e){var r=(0,i.default)(e.body.featureToggles,{type:"USER"});t.spark.internal.device.features.user.add(r[0],{merge:!0}),t.spark.internal.device.features.developer.add(r[1],{merge:!0})})},initialize:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];(0,r.default)(Ix.SparkPlugin.prototype.initialize,this,t),this.listenToAndRun(this.spark,"change:internal.device.features.developer",this.trigger.bind(this,"change:developer")),this.listenToAndRun(this.spark,"change:internal.device.features.entitlement",this.trigger.bind(this,"change:entitlement")),this.listenToAndRun(this.spark,"change:internal.device.features.user",this.trigger.bind(this,"change:user"))},version:"1.50.12"});t.default=a});t(dD);var pD=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={feature:{}}});t(pD),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i(dD).default}});var r=i(dD),n=i(pD);function i(e){return e&&e.__esModule?e:{default:e}}(0,Ix.registerInternalPlugin)("feature",r.default,{config:n.default})}));var hD=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(mO),n=o(Cf),i=o(bf);function o(e){return e&&e.__esModule?e:{default:e}}var a=(0,o(i_).default)("metric id"),u=Ix.Batcher.extend({namespace:"Metrics",prepareItem:function(e){return e.appType=e.appType||this.config.appType,e.env=e.env||"TEST",e.time=e.time||Date.now(),e.version=e.version||this.spark.version,i.default.resolve(e)},prepareRequest:function(e){return i.default.resolve(e.map(function(e){return e.postTime=e.postTime||Date.now(),e}))},submitHttpRequest:function(e){return this.spark.request({method:"POST",service:"metrics",resource:"metrics",body:{metrics:e}})},handleHttpSuccess:function(e){var t=this;return i.default.all(e.options.body.metrics.map(function(e){return t.acceptItem(e)}))},handleHttpError:function(e){var t=this;return e instanceof Ix.SparkHttpError.NetworkOrCORSError?(this.logger.warn("metrics-batcher: received network error submitting metrics, reenqueuing payload"),i.default.all(e.options.body.metrics.map(function(e){return new i.default(function(r){var n=e[a].nextDelay;n<t.config.batcherRetryPlateau&&(e[a].nextDelay*=2),(0,ZE.safeSetTimeout)(function(){r(t.rerequest(e))},n)})}))):(0,n.default)(Ix.Batcher.prototype.handleHttpError,this,[e])},rerequest:function(e){var t=this;return i.default.all([this.getDeferredForRequest(e),this.prepareItem(e)]).then(function(e){var n=(0,r.default)(e,2),i=n[0],o=n[1];t.enqueue(o).then(function(){return t.bounce()}).catch(function(e){return i.reject(e)})})},fingerprintRequest:function(e){return e[a]=e[a]||{nextDelay:1e3},i.default.resolve(e[a])},fingerprintResponse:function(e){return i.default.resolve(e[a])}});t.default=u});t(hD);var vD=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=n(bf);function n(e){return e&&e.__esModule?e:{default:e}}var i=n(hD).default.extend({namespace:"Metrics",prepareItem:function(e){return r.default.resolve(e)},prepareRequest:function(e){return r.default.resolve(e)},submitHttpRequest:function(e){return this.spark.request({method:"POST",service:"metrics",resource:"clientmetrics",body:{metrics:e}})}});t.default=i});t(vD);var gD=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(bf),n=i(Ef);function i(e){return e&&e.__esModule?e:{default:e}}var o=i(hD).default.extend({namespace:"Metrics",prepareItem:function(e){return e.eventPayload.origin=(0,n.default)({buildType:"test",networkType:"unknown"},e.eventPayload.origin),r.default.resolve(e)},prepareRequest:function(e){return e.forEach(function(e){e.eventPayload.originTime.sent=(new Date).toISOString()}),r.default.resolve(e)},submitHttpRequest:function(e){return this.spark.request({method:"POST",service:"metrics",resource:"clientmetrics",body:{metrics:e}})}});t.default=o});t(gD);var yD=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n,i=c(ac),o=c(Ef),a=c(hD),u=c(vD),s=c(gD);function c(e){return e&&e.__esModule?e:{default:e}}var l,f,d,p,h,v,g=Ix.SparkPlugin.extend((r=(0,$E.deprecated)("Metrics#sendUnstructured() is deprecated; please use Metrics#submit()"),n={children:{batcher:a.default,clientMetricsBatcher:u.default,callDiagnosticEventsBatcher:s.default},namespace:"Metrics",sendUnstructured:function(e,t){return this.submit(e,t)},submit:function(e,t){return this.batcher.request((0,o.default)({key:e},t))},submitClientMetrics:function(e,t,r){var n={metricName:e};if(t.tags&&(n.tags=t.tags),t.fields&&(n.fields=t.fields),t.type&&(n.type=t.type),t.context&&(n.context=t.context),n.timestamp=Date.now(),r){var i={metrics:[n]};return this.postPreLoginMetric(i,r)}return this.clientMetricsBatcher.request(n)},aliasUser:function(e){return this.request({method:"POST",api:"metrics",resource:"clientmetrics",headers:{"x-prelogin-userid":e},body:{},qs:{alias:!0}})},postPreLoginMetric:function(e,t){var r=this;return this.spark.credentials.getClientToken().then(function(n){return r.request({method:"POST",api:"metrics",resource:"clientmetrics-prelogin",headers:{authorization:n.toString(),"x-prelogin-userid":t},body:e})})},submitCallDiagnosticEvents:function(e){var t={type:"diagnostic-event",eventPayload:e};return this.callDiagnosticEventsBatcher.request(t)},version:"1.50.12"},l=n,f="sendUnstructured",d=[r],p=(0,i.default)(n,"sendUnstructured"),h=n,v={},Object.keys(p).forEach(function(e){v[e]=p[e]}),v.enumerable=!!v.enumerable,v.configurable=!!v.configurable,("value"in v||v.initializer)&&(v.writable=!0),v=d.slice().reverse().reduce(function(e,t){return t(l,f,e)||e},v),h&&void 0!==v.initializer&&(v.value=v.initializer?v.initializer.call(h):void 0,v.initializer=void 0),void 0===v.initializer&&(Object.defineProperty(l,f,v),v=null),n));t.default=g});t(yD);var mD=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={device:{preDiscoveryServices:{metricsServiceUrl:"https://metrics-a.wbx2.com/metrics/api/v1",metrics:"https://metrics-a.wbx2.com/metrics/api/v1"}},metrics:{appType:$E.inBrowser?"browser":"nodejs",batcherWait:500,batcherMaxCalls:50,batcherMaxWait:1500,batcherRetryPlateau:32e3}}});t(mD);var bD=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.config=t.default=void 0,Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i(yD).default}});var r=i(yD),n=i(mD);function i(e){return e&&e.__esModule?e:{default:e}}(0,Ix.registerInternalPlugin)("metrics",r.default,{config:n.default}),t.config=n.default});t(bD);bD.config;var _D=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.UnknownResponse=t.NotAuthorized=t.Forbidden=t.ConnectionError=t.BadRequest=t.config=t.Socket=t.Mercury=t.default=void 0,Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i(aD).default}}),Object.defineProperty(t,"Mercury",{enumerable:!0,get:function(){return i(aD).default}}),Object.defineProperty(t,"Socket",{enumerable:!0,get:function(){return i(oD).default}}),Object.defineProperty(t,"config",{enumerable:!0,get:function(){return i(uD).default}}),Object.defineProperty(t,"BadRequest",{enumerable:!0,get:function(){return rD.BadRequest}}),Object.defineProperty(t,"ConnectionError",{enumerable:!0,get:function(){return rD.ConnectionError}}),Object.defineProperty(t,"Forbidden",{enumerable:!0,get:function(){return rD.Forbidden}}),Object.defineProperty(t,"NotAuthorized",{enumerable:!0,get:function(){return rD.NotAuthorized}}),Object.defineProperty(t,"UnknownResponse",{enumerable:!0,get:function(){return rD.UnknownResponse}});var r=i(aD),n=i(uD);function i(e){return e&&e.__esModule?e:{default:e}}(0,Ix.registerInternalPlugin)("mercury",r.default,{config:n.default,onBeforeLogout:function(){return this.disconnect()}})});t(_D);_D.UnknownResponse,_D.NotAuthorized,_D.Forbidden,_D.ConnectionError,_D.BadRequest,_D.config,_D.Socket,_D.Mercury;var wD=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DESYNC=t.LESS_THAN=t.GREATER_THAN=t.FETCH=t.EQUAL=t.USE_CURRENT=t.USE_INCOMING=t.eventKeys=void 0,Object.defineProperty(t,"eventKeys",{enumerable:!0,get:function(){return uI.locusEventKeys}}),Object.defineProperty(t,"USE_INCOMING",{enumerable:!0,get:function(){return lI.USE_INCOMING}}),Object.defineProperty(t,"USE_CURRENT",{enumerable:!0,get:function(){return lI.USE_CURRENT}}),Object.defineProperty(t,"EQUAL",{enumerable:!0,get:function(){return lI.EQUAL}}),Object.defineProperty(t,"FETCH",{enumerable:!0,get:function(){return lI.FETCH}}),Object.defineProperty(t,"GREATER_THAN",{enumerable:!0,get:function(){return lI.GREATER_THAN}}),Object.defineProperty(t,"LESS_THAN",{enumerable:!0,get:function(){return lI.LESS_THAN}}),Object.defineProperty(t,"DESYNC",{enumerable:!0,get:function(){return lI.DESYNC}});var r,n=(r=lI)&&r.__esModule?r:{default:r};(0,Ix.registerInternalPlugin)("locus",n.default),t.default=n.default});t(wD);wD.DESYNC,wD.LESS_THAN,wD.GREATER_THAN,wD.FETCH,wD.EQUAL,wD.USE_CURRENT,wD.USE_INCOMING,wD.eventKeys;var SD=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=u(yO),n=u(p_),i=u(bf),o=u(ex),a=u(FA);function u(e){return e&&e.__esModule?e:{default:e}}function s(e){return Boolean(e.self&&d(e.self))}function c(e,t){return s(t)&&t.self.devices.some(function(t){return e.internal.device.url===t.url&&"JOINED"===t.state})}function l(e,t,r){var n=void 0,i=void 0;return r.person.isExternal||(i=r.person.id,n=e.people.inferPersonIdFromUuid(r.person.id)),{_id:r.id,isSelf:t.self.url===r.url,isInitiator:r.isCreator||!1,personUuid:i,personId:n,state:f(r),audioMuted:v(r),videoMuted:g(r)}}function f(e){var t=e.state&&e.state.toLowerCase();switch(t){case"idle":return"notified";case"joined":return"connected";case"left":return"disconnected";default:return t}}function d(e){return e&&"JOINED"===e.state}function p(e){return h(e)[0]}function h(e){return e.participants.filter(function(t){return"USER"===t.type&&t.url!==e.self.url})}function v(e){return d(e)&&!e.status.audioStatus.includes("SEND")}function g(e){return d(e)&&!e.status.videoStatus.includes("SEND")}t.activeParticipants=function(e){return(0,a.default)(e.participants,{state:"JOINED"})},t.direction=function(e){if(!e||!e.self)return"unknown";return e.self.isCreator?"out":"in"},t.waitForMediaShare=function(e){return function(){var t=new i.default(function(t,r){!function n(){try{e.logger.info("checking for media share");var i=e.locus.mediaShares.find(function(e){return"content"===e.name});if(!i)return e.logger.info("did not find media share, waiting for next locus change"),void e.once("change:locus",n);e.logger.info("found media share"),t(i)}catch(t){e.logger.error("something unexpected happened"),e.logger.error(t),r(t)}}()});return i.default.race([t,new i.default(function(e,t){return setTimeout(t(new Error("Could not find media share after 10000ms")),1e4)})])}},t.isActive=function(e){return"ACTIVE"===e.fullState.state},t.isCall=function(e){return e&&e.fullState&&"CALL"===e.fullState.type},t.joined=s,t.joinedOnThisDevice=c,t.participantsToCallMemberships=function(e,t){var i=new n.default,a=new n.default,u=!0,s=!1,c=void 0;try{for(var f,d=(0,r.default)(t.participants);!(u=(f=d.next()).done);u=!0){var p=f.value;"USER"===p.type?i.set(p.url,p):"RESOURCE_ROOM"===p.type&&a.set(p.url,p)}}catch(e){s=!0,c=e}finally{try{!u&&d.return&&d.return()}finally{if(s)throw c}}var h=[];return i.forEach(function(n){var i=l(e,t,n);if(n.devices){var u=!0,s=!1,c=void 0;try{for(var f,d=(0,r.default)(n.devices);!(u=(f=d.next()).done);u=!0){var p=f.value;if("JOINED"===p.state&&"OBSERVE"===(0,o.default)(p,"intent.type")){var y=a.get(p.url);i.audioMuted=v(y),i.videoMuted=g(y)}a.delete(p.url)}}catch(e){s=!0,c=e}finally{try{!u&&d.return&&d.return()}finally{if(s)throw c}}}h.push(i)}),a.forEach(function(r){var n=l(e,t,r);h.push(n)}),h},t.participantToCallMembership=l,t.participantStateToCallMembershipState=f,t.makeInternalCallId=function(e){return e.url+"_"+e.fullState.lastActive},t.mediaDirection=function(e,t){if(!t)return"inactive";if(!t.status)return"inactive";return(t.status[e+"Status"]||"inactive").toLowerCase()},t.participantIsJoined=d,t.remoteParticipant=p,t.remoteParticipants=h,t.remoteAudioMuted=v,t.remoteVideoMuted=g,t.shouldRing=function(e){return"NONE"!==(0,o.default)(e,"self.alertType.action")},t.getState=function(e){return e&&e.fullState&&e.fullState.state.toLowerCase()},t.getStatus=function(e,t,n){if(t){var i=p(t);if(i){if(c(e,t)&&i&&d(i))return"connected";if(t.replaces){var a=!0,u=!1,s=void 0;try{for(var l,f=(0,r.default)(t.replaces);!(a=(l=f.next()).done);a=!0){var h=l.value;if(h.locusUrl===n.url&&h.lastActive===(0,o.default)(n,"fullState.lastActive"))return"replaced"}}catch(e){u=!0,s=e}finally{try{!a&&f.return&&f.return()}finally{if(u)throw s}}}var v=t.self;if("LEFT"===i.state||"LEFT"===v.state)return"disconnected";if("DECLINED"===i.state)return"disconnected";if("NOTIFIED"===i.state)return"ringing"}}return"initiated"},t.getThisDevice=function(e,t){return t&&t.self&&t.self.devices.find(function(t){return t.url===e.internal.device.url})}});t(SD);SD.activeParticipants,SD.direction,SD.waitForMediaShare,SD.isActive,SD.isCall,SD.joined,SD.joinedOnThisDevice,SD.participantsToCallMemberships,SD.participantToCallMembership,SD.participantStateToCallMembershipState,SD.makeInternalCallId,SD.mediaDirection,SD.participantIsJoined,SD.remoteParticipant,SD.remoteParticipants,SD.remoteAudioMuted,SD.remoteVideoMuted,SD.shouldRing,SD.getState,SD.getStatus,SD.getThisDevice;var kD=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e&&t)return"sendrecv";if(e&&!t)return"sendonly";if(!e&&t)return"recvonly";if(!e&&!t)return"inactive";throw new Error("If you see this error, your JavaScript engine has a major flaw")}});t(kD);var ED=Object.prototype.hasOwnProperty,PD=lD(function(e,t,r){ED.call(e,r)?++e[r]:np(e,r,1)});var TD=function(e,t,r){var n=null==e?0:e.length;return n?(t=r||void 0===t?1:Ww(t),Lv(e,t<0?0:t,n)):[]};var OD=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0};var CD=function(e,t){var r=!0;return kT(e,function(e,n,i){return r=!!t(e,n,i)}),r};var MD=function(e,t,r){var n=vp(e)?OD:CD;return r&&aS(e,t,r)&&(t=void 0),n(e,Kx(t,3))},xD=Object.prototype.hasOwnProperty,jD=lD(function(e,t,r){xD.call(e,r)?e[r].push(t):np(e,r,[t])}),RD=lD(function(e,t,r){np(e,r,t)}),AD=Math.max;var ID=function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=null==r?0:Ww(r);return i<0&&(i=AD(n+i,0)),X_(e,t,i)};var DD=function(e){return null!=e&&e.length?Lv(e,0,-1):[]};var LD=function(e,t,r){t=jv(t,e);var n=null==(e=Fv(e,t))?e:e[Iv(Rv(t))];return null==n?void 0:Xv(n,e,r)},FD=v_(LD),ND=v_(function(e,t,r){var n=-1,i="function"==typeof t,o=Fp(e)?Array(e.length):[];return kT(e,function(e){o[++n]=i?Xv(t,e,r):LD(e,t,r)}),o});var UD=function(e,t,r){for(var n=r+1;n--;)if(e[n]===t)return n;return n},zD=Math.max,qD=Math.min;var BD=function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=n;return void 0!==r&&(i=(i=Ww(r))<0?zD(n+i,0):qD(i,n-1)),t==t?UD(e,t,i):J_(e,Y_,i,!0)};var WD=function(e,t){var r=-1,n=Fp(e)?Array(e.length):[];return kT(e,function(e,i,o){n[++r]=t(e,i,o)}),n};var VD=function(e,t){return(vp(e)?Rf:WD)(e,Kx(t,3))};var GD=function(e,t,r){for(var n=-1,i=e.length;++n<i;){var o=e[n],a=t(o);if(null!=a&&(void 0===u?a==a&&!vv(a):r(a,u)))var u=a,s=o}return s};var HD=function(e,t){return e>t};var $D=function(e){return e&&e.length?GD(e,tg,HD):void 0};var JD=function(e,t){return e<t};var YD=function(e){return e&&e.length?GD(e,tg,JD):void 0};var KD=function(e,t,r,n,i){return i(e,function(e,i,o){r=n?(n=!1,e):t(r,e,i,o)}),r};var XD=function(e,t,r){var n=vp(e)?CI:KD,i=arguments.length<3;return n(e,Kx(t,4),r,i,kT)};var ZD=function(e,t,r,n){var i=null==e?0:e.length;for(n&&i&&(r=e[--i]);i--;)r=t(r,e[i],i,e);return r},QD=cP(!0);var eL=ST(function(e,t){return e&&QD(e,t,Np)},!0);var tL=function(e,t,r){var n=vp(e)?ZD:KD,i=arguments.length<3;return n(e,Kx(t,4),r,i,eL)};var rL=function(e,t){return(vp(e)?$p:LA)(e,ZR(Kx(t,3)))},nL=Math.floor,iL=Math.random;var oL=function(e,t){return e+nL(iL()*(t-e+1))};var aL=function(e){var t=e.length;return t?e[oL(0,t-1)]:void 0};var uL=function(e){return aL(gP(e))};var sL=function(e){return(vp(e)?aL:uL)(e)};var cL=function(e,t){var r=-1,n=e.length,i=n-1;for(t=void 0===t?n:t;++r<t;){var o=oL(r,i),a=e[o];e[o]=e[r],e[r]=a}return e.length=t,e};var lL=function(e){return cL(Hp(e))};var fL=function(e){return cL(gP(e))};var dL=function(e){return(vp(e)?lL:fL)(e)};var pL=function(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e};var hL=function(e,t){if(e!==t){var r=void 0!==e,n=null===e,i=e==e,o=vv(e),a=void 0!==t,u=null===t,s=t==t,c=vv(t);if(!u&&!c&&!o&&e>t||o&&a&&s&&!u&&!c||n&&a&&s||!r&&s||!i)return 1;if(!n&&!o&&!c&&e<t||c&&r&&i&&!n&&!o||u&&r&&i||!a&&i||!s)return-1}return 0};var vL=function(e,t,r){for(var n=-1,i=e.criteria,o=t.criteria,a=i.length,u=r.length;++n<a;){var s=hL(i[n],o[n]);if(s)return n>=u?s:s*("desc"==r[n]?-1:1)}return e.index-t.index};var gL=function(e,t,r){var n=-1;t=Rf(t.length?t:[tg],Pp(Kx));var i=WD(e,function(e,r,i){return{criteria:Rf(t,function(t){return t(e)}),index:++n,value:e}});return pL(i,function(e,t){return vL(e,t,r)})},yL=v_(function(e,t){if(null==e)return[];var r=t.length;return r>1&&aS(e,t[0],t[1])?t=[]:r>2&&aS(t[0],t[1],t[2])&&(t=[t[0]]),gL(e,Yv(t,1),[])});var mL={countBy:PD,difference:cI,drop:TD,each:ET,every:MD,filter:FA,find:Qx,forEach:ET,groupBy:jD,includes:mP,keyBy:RD,indexOf:ID,initial:DD,invoke:FD,invokeMap:ND,isEmpty:pg,lastIndexOf:BD,map:VD,max:$D,min:YD,partition:fD,reduce:XD,reduceRight:tL,reject:rL,sample:sL,shuffle:dL,some:ij,sortBy:yL,tail:function(e){var t=null==e?0:e.length;return t?Lv(e,1,t):[]},take:function(e,t,r){return e&&e.length?(t=r||void 0===t?1:Ww(t),Lv(e,0,t<0?0:t)):[]},without:Aj},bL=[].slice,_L={};mL.each(["forEach","each","map","reduce","reduceRight","find","filter","reject","every","some","includes","invoke","invokeMap","max","min","take","initial","tail","drop","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","sample","partition"],function(e){mL[e]&&(_L[e]=function(){var t=bL.call(arguments);return t.unshift(this.models),mL[e].apply(mL,t)})});mL.each(["groupBy","countBy","sortBy","keyBy"],function(e){mL[e]&&(_L[e]=function(t,r){var n=hd(t)?t:function(e){return e.get?e.get(t):e[t]};return mL[e](this.models,n,r)})}),_L.where=function(e,t){return mL.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){var r;for(var n in e)if(r=t.get?t.get(n):t[n],e[n]!==r)return!1;return!0})},_L.findWhere=function(e){return this.where(e,!0)},_L.pluck=function(e){return mL.invokeMap(this.models,"get",e)},_L.first=function(){return this.models[0]},_L.last=function(){return this.models[this.models.length-1]},_L.size=function(){return this.models.length};var wL=_L,SL=r(function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0});var n=((r=BT)&&r.__esModule?r:{default:r}).default.extend({idAttribute:"_id",props:{_id:{required:!0,type:"string"},isSelf:{default:!1,type:"boolean"},isInitiator:{default:!1,required:!0,type:"boolean"},personId:{type:"string"},personUuid:{require:!0,type:"string"},state:{required:!0,type:"string",values:["notified","connected","declined","disconnected","waiting"]},audioMuted:{default:!1,type:"boolean"},videoMuted:{default:!1,type:"boolean"}}});t.default=n});t(SL);var kL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(WM),n=o(wL),i=o(SL);function o(e){return e&&e.__esModule?e:{default:e}}var a=r.default.extend(n.default,{model:i.default,mainIndex:"_id"});t.default=a});function EL(){this.head=null,this.tail=null,this.length=0}t(kL),EL.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},EL.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},EL.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},EL.prototype.clear=function(){this.head=this.tail=null,this.length=0},EL.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},EL.prototype.concat=function(e){if(0===this.length)return ny.alloc(0);if(1===this.length)return this.head.data;for(var t=ny.allocUnsafe(e>>>0),r=this.head,n=0;r;)r.data.copy(t,n),n+=r.data.length,r=r.next;return t};var PL=ny.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function TL(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),function(e){if(e&&!PL(e))throw new Error("Unknown encoding: "+e)}(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=CL;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=ML;break;default:return void(this.write=OL)}this.charBuffer=new ny(6),this.charReceived=0,this.charLength=0}function OL(e){return e.toString(this.encoding)}function CL(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function ML(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}TL.prototype.write=function(e){for(var t="";this.charLength;){var r=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,r),this.charReceived+=r,this.charReceived<this.charLength)return"";if(e=e.slice(r,e.length),!((i=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&i<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var n=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,n),n-=this.charReceived);var i;n=(t+=e.toString(this.encoding,0,n)).length-1;if((i=t.charCodeAt(n))>=55296&&i<=56319){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),e.copy(this.charBuffer,0,0,o),t.substring(0,n)}return t},TL.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var r=e[e.length-t];if(1==t&&r>>5==6){this.charLength=2;break}if(t<=2&&r>>4==14){this.charLength=3;break}if(t<=3&&r>>3==30){this.charLength=4;break}}this.charReceived=t},TL.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var r=this.charReceived,n=this.charBuffer,i=this.encoding;t+=n.slice(0,r).toString(i)}return t},RL.ReadableState=jL;var xL=$y("stream");function jL(e,t){e=e||{},this.objectMode=!!e.objectMode,t instanceof aF&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var r=e.highWaterMark,n=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n,this.highWaterMark=~~this.highWaterMark,this.buffer=new EL,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(this.decoder=new TL(e.encoding),this.encoding=e.encoding)}function RL(e){if(!(this instanceof RL))return new RL(e);this._readableState=new jL(e,this),this.readable=!0,e&&"function"==typeof e.read&&(this._read=e.read),fS.call(this)}function AL(e,t,r,n,i){var o=function(e,t){var r=null;Uy(t)||"string"==typeof t||null==t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk"));return r}(t,r);if(o)e.emit("error",o);else if(null===r)t.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,LL(e)}(e,t);else if(t.objectMode||r&&r.length>0)if(t.ended&&!i){var a=new Error("stream.push() after EOF");e.emit("error",a)}else if(t.endEmitted&&i){var u=new Error("stream.unshift() after end event");e.emit("error",u)}else{var s;!t.decoder||i||n||(r=t.decoder.write(r),s=!t.objectMode&&0===r.length),i||(t.reading=!1),s||(t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,i?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&LL(e))),function(e,t){t.readingMore||(t.readingMore=!0,ps(NL,e,t))}(e,t)}else i||(t.reading=!1);return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(t)}qy(RL,fS),RL.prototype.push=function(e,t){var r=this._readableState;return r.objectMode||"string"!=typeof e||(t=t||r.defaultEncoding)!==r.encoding&&(e=ny.from(e,t),t=""),AL(this,r,e,t,!1)},RL.prototype.unshift=function(e){return AL(this,this._readableState,e,"",!0)},RL.prototype.isPaused=function(){return!1===this._readableState.flowing},RL.prototype.setEncoding=function(e){return this._readableState.decoder=new TL(e),this._readableState.encoding=e,this};var IL=8388608;function DL(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=IL?e=IL:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function LL(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(xL("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?ps(FL,e):FL(e))}function FL(e){xL("emit readable"),e.emit("readable"),qL(e)}function NL(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(xL("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function UL(e){xL("readable nexttick read 0"),e.read(0)}function zL(e,t){t.reading||(xL("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),qL(e),t.flowing&&!t.reading&&e.read(0)}function qL(e){var t=e._readableState;for(xL("flow",t.flowing);t.flowing&&null!==e.read(););}function BL(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=function(e,t,r){var n;e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?function(e,t){var r=t.head,n=1,i=r.data;e-=i.length;for(;r=r.next;){var o=r.data,a=e>o.length?o.length:e;if(a===o.length?i+=o:i+=o.slice(0,e),0===(e-=a)){a===o.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(a));break}++n}return t.length-=n,i}(e,t):function(e,t){var r=ny.allocUnsafe(e),n=t.head,i=1;n.data.copy(r),e-=n.data.length;for(;n=n.next;){var o=n.data,a=e>o.length?o.length:e;if(o.copy(r,r.length-e,0,a),0===(e-=a)){a===o.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(a));break}++i}return t.length-=i,r}(e,t);return n}(e,t.buffer,t.decoder),r);var r}function WL(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,ps(VL,t,e))}function VL(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function GL(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}function HL(){}function $L(e,t,r){this.chunk=e,this.encoding=t,this.callback=r,this.next=null}function JL(e,t){Object.defineProperty(this,"buffer",{get:Vy(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),e=e||{},this.objectMode=!!e.objectMode,t instanceof aF&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var r=e.highWaterMark,n=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var i=!1===e.decodeStrings;this.decodeStrings=!i,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,i=r.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,n,i){--t.pendingcb,r?ps(i,n):i(n);e._writableState.errorEmitted=!0,e.emit("error",n)}(e,r,n,t,i);else{var o=QL(r);o||r.corked||r.bufferProcessing||!r.bufferedRequest||ZL(e,r),n?ps(XL,e,r,o,i):XL(e,r,o,i)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new rF(this)}function YL(e){if(!(this instanceof YL||this instanceof aF))return new YL(e);this._writableState=new JL(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev)),fS.call(this)}function KL(e,t,r,n,i,o,a){t.writelen=n,t.writecb=a,t.writing=!0,t.sync=!0,r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function XL(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),tF(e,t)}function ZL(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,i=new Array(n),o=t.corkedRequestsFree;o.entry=r;for(var a=0;r;)i[a]=r,r=r.next,a+=1;KL(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new rF(t)}else{for(;r;){var u=r.chunk,s=r.encoding,c=r.callback;if(KL(e,t,!1,t.objectMode?1:u.length,u,s,c),r=r.next,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=r,t.bufferProcessing=!1}function QL(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function eF(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function tF(e,t){var r=QL(t);return r&&(0===t.pendingcb?(eF(e,t),t.finished=!0,e.emit("finish")):eF(e,t)),r}function rF(e){var t=this;this.next=null,this.entry=null,this.finish=function(r){var n=t.entry;for(t.entry=null;n;){var i=n.callback;e.pendingcb--,i(r),n=n.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}RL.prototype.read=function(e){xL("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return xL("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?WL(this):LL(this),null;if(0===(e=DL(e,t))&&t.ended)return 0===t.length&&WL(this),null;var n,i=t.needReadable;return xL("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&xL("length less than watermark",i=!0),t.ended||t.reading?xL("reading or ended",i=!1):i&&(xL("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=DL(r,t))),null===(n=e>0?BL(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&WL(this)),null!==n&&this.emit("data",n),n},RL.prototype._read=function(e){this.emit("error",new Error("not implemented"))},RL.prototype.pipe=function(e,t){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e)}n.pipesCount+=1,xL("pipe count=%d opts=%j",n.pipesCount,t);var i=!t||!1!==t.end?a:c;function o(e){xL("onunpipe"),e===r&&c()}function a(){xL("onend"),e.end()}n.endEmitted?ps(i):r.once("end",i),e.on("unpipe",o);var u=function(e){return function(){var t=e._readableState;xL("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&e.listeners("data").length&&(t.flowing=!0,qL(e))}}(r);e.on("drain",u);var s=!1;function c(){xL("cleanup"),e.removeListener("close",p),e.removeListener("finish",h),e.removeListener("drain",u),e.removeListener("error",d),e.removeListener("unpipe",o),r.removeListener("end",a),r.removeListener("end",c),r.removeListener("data",f),s=!0,!n.awaitDrain||e._writableState&&!e._writableState.needDrain||u()}var l=!1;function f(t){xL("ondata"),l=!1,!1!==e.write(t)||l||((1===n.pipesCount&&n.pipes===e||n.pipesCount>1&&-1!==GL(n.pipes,e))&&!s&&(xL("false write response, pause",r._readableState.awaitDrain),r._readableState.awaitDrain++,l=!0),r.pause())}function d(t){var r;xL("onerror",t),v(),e.removeListener("error",d),0===(r="error",e.listeners(r).length)&&e.emit("error",t)}function p(){e.removeListener("finish",h),v()}function h(){xL("onfinish"),e.removeListener("close",p),v()}function v(){xL("unpipe"),r.unpipe(e)}return r.on("data",f),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",d),e.once("close",p),e.once("finish",h),e.emit("pipe",r),n.flowing||(xL("pipe resume"),r.resume()),e},RL.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var r=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<n;i++)r[i].emit("unpipe",this);return this}var o=GL(t.pipes,e);return-1===o?this:(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},RL.prototype.on=function(e,t){var r=fS.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&LL(this):ps(UL,this))}return r},RL.prototype.addListener=RL.prototype.on,RL.prototype.resume=function(){var e=this._readableState;return e.flowing||(xL("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,ps(zL,e,t))}(this,e)),this},RL.prototype.pause=function(){return xL("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(xL("pause"),this._readableState.flowing=!1,this.emit("pause")),this},RL.prototype.wrap=function(e){var t=this._readableState,r=!1,n=this;for(var i in e.on("end",function(){if(xL("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&n.push(e)}n.push(null)}),e.on("data",function(i){(xL("wrapped data"),t.decoder&&(i=t.decoder.write(i)),t.objectMode&&null==i)||(t.objectMode||i&&i.length)&&(n.push(i)||(r=!0,e.pause()))}),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));return function(e,t){for(var r=0,n=e.length;r<n;r++)t(e[r],r)}(["error","close","destroy","pause","resume"],function(t){e.on(t,n.emit.bind(n,t))}),n._read=function(t){xL("wrapped _read",t),r&&(r=!1,e.resume())},n},RL._fromList=BL,YL.WritableState=JL,qy(YL,fS),JL.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},YL.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},YL.prototype.write=function(e,t,r){var n=this._writableState,i=!1;return"function"==typeof t&&(r=t,t=null),ny.isBuffer(e)?t="buffer":t||(t=n.defaultEncoding),"function"!=typeof r&&(r=HL),n.ended?function(e,t){var r=new Error("write after end");e.emit("error",r),ps(t,r)}(this,r):function(e,t,r,n){var i=!0,o=!1;return null===r?o=new TypeError("May not write null values to stream"):ny.isBuffer(r)||"string"==typeof r||void 0===r||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),ps(n,o),i=!1),i}(this,n,e,r)&&(n.pendingcb++,i=function(e,t,r,n,i){r=function(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=ny.from(t,r)),t}(t,r,n),ny.isBuffer(r)&&(n="buffer");var o=t.objectMode?1:r.length;t.length+=o;var a=t.length<t.highWaterMark;a||(t.needDrain=!0);if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest=new $L(r,n,i),u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else KL(e,t,!1,o,r,n,i);return a}(this,n,e,t,r)),i},YL.prototype.cork=function(){this._writableState.corked++},YL.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||ZL(this,e))},YL.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},YL.prototype._write=function(e,t,r){r(new Error("not implemented"))},YL.prototype._writev=null,YL.prototype.end=function(e,t,r){var n=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||function(e,t,r){t.ending=!0,tF(e,t),r&&(t.finished?ps(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,n,r)},qy(aF,RL);for(var nF=Object.keys(YL.prototype),iF=0;iF<nF.length;iF++){var oF=nF[iF];aF.prototype[oF]||(aF.prototype[oF]=YL.prototype[oF])}function aF(e){if(!(this instanceof aF))return new aF(e);RL.call(this,e),YL.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",uF)}function uF(){this.allowHalfOpen||this._writableState.ended||ps(sF,this)}function sF(e){e.end()}function cF(e){this.afterTransform=function(t,r){return function(e,t,r){var n=e._transformState;n.transforming=!1;var i=n.writecb;if(!i)return e.emit("error",new Error("no writecb in Transform class"));n.writechunk=null,n.writecb=null,null!=r&&e.push(r);i(t);var o=e._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&e._read(o.highWaterMark)}(e,t,r)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function lF(e){if(!(this instanceof lF))return new lF(e);aF.call(this,e),this._transformState=new cF(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(e){fF(t,e)}):fF(t)})}function fF(e,t){if(t)return e.emit("error",t);var r=e._writableState,n=e._transformState;if(r.length)throw new Error("Calling transform done when ws.length != 0");if(n.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}function dF(e){if(!(this instanceof dF))return new dF(e);lF.call(this,e)}function pF(){fS.call(this)}qy(lF,aF),lF.prototype.push=function(e,t){return this._transformState.needTransform=!1,aF.prototype.push.call(this,e,t)},lF.prototype._transform=function(e,t,r){throw new Error("Not implemented")},lF.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},lF.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},qy(dF,lF),dF.prototype._transform=function(e,t,r){r(null,e)},qy(pF,fS),pF.Readable=RL,pF.Writable=YL,pF.Duplex=aF,pF.Transform=lF,pF.PassThrough=dF,pF.Stream=pF,pF.prototype.pipe=function(e,t){var r=this;function n(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function i(){r.readable&&r.resume&&r.resume()}r.on("data",n),e.on("drain",i),e._isStdio||t&&!1===t.end||(r.on("end",a),r.on("close",u));var o=!1;function a(){o||(o=!0,e.end())}function u(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function s(e){if(c(),0===fS.listenerCount(this,"error"))throw e}function c(){r.removeListener("data",n),e.removeListener("drain",i),r.removeListener("end",a),r.removeListener("close",u),r.removeListener("error",s),e.removeListener("error",s),r.removeListener("end",c),r.removeListener("close",c),e.removeListener("close",c)}return r.on("error",s),e.on("error",s),r.on("end",c),r.on("close",c),e.on("close",c),e.emit("pipe",r),e};var hF=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(yO),n=s(rk),i=s(Wm),o=s($m),a=s(nk),u=s(ik);function s(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,{objectMode:!0}))}return(0,u.default)(t,e),(0,o.default)(t,[{key:"_transform",value:function(e,t,n){if(e){var i={local:null,remote:null},o={local:null,remote:null},a={local:null,remote:null},u={local:null,remote:null},s=!0,c=!1,l=void 0;try{for(var f,d=(0,r.default)(e.values());!(s=(f=d.next()).done);s=!0){var p=f.value;["outbound-rtp","outboundrtp"].includes(p.type)&&!p.isRemote&&("audio"===p.mediaType&&(a.local=p,a.remote=e.get(p.remoteId)),"video"===p.mediaType&&(u.local=p,u.remote=e.get(p.remoteId))),["inbound-rtp","inboundrtp"].includes(p.type)&&!p.isRemote&&("audio"===p.mediaType&&(i.local=p,i.remote=e.get(p.remoteId)),"video"===p.mediaType&&(o.local=p,o.remote=e.get(p.remoteId)))}}catch(e){c=!0,l=e}finally{try{!s&&d.return&&d.return()}finally{if(c)throw l}}this.push({incomingAudio:i,incomingVideo:o,outgoingAudio:a,outgoingVideo:u,report:e}),n()}else n()}}]),t}(pF.Transform);t.default=c});t(hF);var vF=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(rk),n=s(Wm),i=s($m),o=s(nk),a=s(ik),u=s(hb);function s(e){return e&&e.__esModule?e:{default:e}}var c=new u.default,l=new u.default,f=new u.default,d=new u.default;var p=function(e){function t(e){(0,n.default)(this,t);var i=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this,{objectMode:!0}));c.has(e)||c.set(e,new fS.EventEmitter);var a=c.get(e);return f.has(i)||f.set(i,a),l.has(a)||l.set(a,e),a.once("error",function(e){i.emit("error",e)}),i}return(0,a.default)(t,e),(0,i.default)(t,[{key:"_read",value:function(){var e=this,t=f.get(this);t.once("data",function(t){e.isPaused()||e.push(t)}),d.has(t)||function e(t){var r=(0,ZE.safeSetTimeout)(function(){var r=l.get(t);r.getStats().then(function(n){t.emit("data",n),"closed"!==r.signalingState&&"closed"!==r.connectionState&&e(t)}).catch(function(e){t.emit("error",e)})},1e3);d.set(t,r)}(t)}}]),t}(pF.Readable);t.default=p});t(vF);var gF=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n,i,o,a,u=S(ac),s=S(yO),c=S(Cf),l=S(Ef),f=S(bf),d=S(tS),p=S(ex),h=S(Qx),v=S(cS),g=S(dx),y=S(aI),m=S(kD),b=S(kL),_=S(hF),w=S(vF);function S(e){return e&&e.__esModule?e:{default:e}}function k(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var E=aI.webrtcHelpers.boolToDirection,P=["ringing","connected","disconnected","replaced"];function T(e,t){var r="string"==typeof t?(0,DA.parse)(t):t,n=void 0;return(n="screen"===e?r.media.find(function(e){return"video"===e.type&&e.content}):r.media.find(function(t){return t.type===e}))&&n.direction?n.direction:"inactive"}function O(e){switch(e){case"inactive":case"sendrecv":return e;case"sendonly":return"recvonly";case"recvonly":return"sendonly";default:throw new Error('direction "'+e+'" is not valid')}}var C={audio:"Audio",video:"Video"},M=Ix.SparkPlugin.extend((r=(0,$E.whileInFlight)("locusJoinInFlight"),n=(0,$E.deprecated)("Please use Call#reject()"),i=(0,$E.whileInFlight)("locusLeaveInFlight"),o=(0,OA.debounce)(),k(a={namespace:"Phone",children:{media:y.default},collections:{memberships:b.default},session:{activeParticipantsCount:{default:0,required:!0,type:"number"},remoteAudioMuted:{default:!1,required:!1,type:"boolean"},remoteVideoMuted:{default:!1,required:!1,type:"boolean"},correlationId:"string",facingMode:{type:"string",values:["user","environment"]},internalCallId:{setOnce:!0,type:"string"},locus:"object",localMediaStream:"object",locusJoinInFlight:{default:!1,type:"boolean"},locusLeaveInFlight:{default:!1,type:"boolean"},me:{type:"object"}},derived:{id:{deps:["locus"],fn:function(){return(0,p.default)(this,"locus.url")}},isActive:{deps:["locus"],fn:function(){return!(!this.locus||!(0,SD.isActive)(this.locus))}},joinedOnThisDevice:{deps:["locus"],default:!1,fn:function(){return!(!this.locus||!(0,SD.joinedOnThisDevice)(this.spark,this.locus))}},locusUrl:{deps:["locus"],fn:function(){return(0,p.default)(this,"locus.url")}},device:{deps:["locus"],fn:function(){return(0,SD.getThisDevice)(this.spark,this.locus)}},mediaConnection:{deps:["locus"],fn:function(){var e=(0,SD.getThisDevice)(this.spark,this.locus);return(0,p.default)(e,"mediaConnections[0]")}},mediaId:{deps:["locus"],fn:function(){var e=(0,SD.getThisDevice)(this.spark,this.locus);return(0,p.default)(e,"mediaConnections[0].mediaId")}},remoteMember:{deps:["memberships","locus"],fn:function(){if((0,SD.isCall)(this.locus))return this.memberships.find(function(e){return!e.isSelf})}},direction:{deps:["locus"],fn:function(){return this.locus?(0,SD.direction)(this.locus):"out"}},from:{deps:["memberships"],fn:function(){if(this.isCall)return this.memberships.find(function(e){return e.isInitiator})}},to:{deps:["memberships"],fn:function(){if(this.isCall)return this.memberships.find(function(e){return!e.isInitiator})}},state:{deps:["locus"],fn:function(){if(this.config.enableExperimentalGroupCallingSupport)return(0,SD.getState)(this.locus)}},status:{deps:["locus"],fn:function(){return(0,SD.getStatus)(this.spark,this.locus,this.previousAttributes().locus)}},host:{deps:["locus"],fn:function(){if(this.config.enableExperimentalGroupCallingSupport)return this.locus.host}},roomId:{deps:["locus"],fn:function(){if(this.config.enableExperimentalGroupCallingSupport&&this.locus.conversationUrl)return $E.base64.encode("ciscospark://us/ROOM/"+this.locus.conversationUrl.split("/").pop())}},remoteMediaStream:{deps:["media.remoteMediaStream"],fn:function(){return this.media.remoteMediaStream}},localScreenShare:{deps:["media.localScreenShare"],fn:function(){return this.media.localScreenShare}},receivingAudio:{deps:["media.receivingAudio"],fn:function(){return this.media.receivingAudio}},receivingVideo:{deps:["media.receivingVideo"],fn:function(){return this.media.receivingVideo}},sendingAudio:{deps:["media.sendingAudio"],fn:function(){return this.media.sendingAudio}},sendingVideo:{deps:["media.sendingVideo"],fn:function(){return this.media.sendingVideo}},isCall:{deps:["locus"],fn:function(){return(0,SD.isCall)(this.locus)}},supportsDtmf:{deps:["locus"],fn:function(){return(0,p.default)(this,"locus.self.enableDTMF")}}},acknowledge:function(){var e=this;return this.logger.info("call: acknowledging"),this.spark.internal.locus.alert(this.locus).then(function(t){return e.setLocus(t)}).then((0,$E.tap)(function(){return e.logger.info("call: acknowledged")}))},answer:function(e){var t=this;return this.logger.info("call: answering"),this.locus?this.joinedOnThisDevice&&this.media.pc.remoteDescription&&this.media.pc.remoteDescription.sdp?(this.logger.info("call: already joined on this device"),f.default.resolve()):this.createOrJoinLocus(this.locus,e).then((0,$E.tap)(function(){return t.logger.info("call: answered")})):(this.logger.info("call: no locus provided, answer() is a noop"),f.default.resolve())},changeReceivingMedia:function(e,t){var r=this;return new f.default(function(n){var i=(0,DA.parse)(r.media.offerSdp),o=(0,h.default)(i.media,{type:e});o&&o.direction.includes("recv")?(r.logger.info('changeReceivingMedia: expecting to renegotiate, waiting for call to emit "change:receiving'+C[e]+'"'),r.once("change:receiving"+C[e],function(){return n()})):(r.logger.info('changeReceivingMedia: expecting to renegotiate, waiting for media to emit "answeraccepted"'),r.media.once("answeraccepted",function(){return n()}));var a=(0,m.default)(r.media["sending"+C[e]],t);console.warn("starting to setMedia "+e+" to "+a),r.media.setMedia(e,a)})},changeSendingMedia:function(e,t){var r=this;if(this.logger.info('changeSendingMedia: changing sending "'+e+'" to "'+t+'"'),["audio","video"].includes(e)){var n=this.media.senderTracks.filter(function(t){return t.kind===e}),i=(0,m.default)(t,this.media["receiving"+C[e]]);return n.length>0?this.media.setMedia(e,i).then(function(){return r.updateMuteToggles(e,t)}):new f.default(function(t){r.once("mediaNegotiationCompleted",function(){return t()}),r.media.setMedia(e,i)})}return f.default.reject(new Error('kind must be one of "audio" or "video"'))},cleanup:function(){var e=this;return new f.default(function(t){ps(function(){e.media.stop(),e.stopListening(e.spark.internal.mercury),e.off(),t()})})},createOrJoinLocus:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(r.localMediaStream)this.localMediaStream=r.localMediaStream;else{r.constraints||(r.constraints={audio:!0,video:{facingMode:{ideal:this.spark.phone.defaultFacingMode}}});var n=(0,p.default)(r,"constraints.video.facingMode.ideal",(0,p.default)(r,"constraints.video.facingMode.exact"));"user"!==n&&"environment"!==n||(this.facingMode=n);var i=!r.constraints.audio&&!r.constraints.video;r.offerOptions=(0,v.default)(r.offerOptions,{offerToReceiveAudio:i||!!r.constraints.audio,offerToReceiveVideo:i||!!r.constraints.video}),r.constraints.fake&&(this.media.constraints.fake=!0),this.media.setMedia("audio",(0,m.default)(r.constraints.audio,r.offerOptions.offerToReceiveAudio),r.constraints.audio),"screen"===(0,p.default)(r,"constraints.video.mediaSource")||"application"===(0,p.default)(r,"constraints.video.mediaSource")?this.media.setMedia("screen","sendonly"):this.media.setMedia("video",(0,m.default)(r.constraints.video,r.offerOptions.offerToReceiveVideo),r.constraints.video)}return e.correlationId||(r.correlationId=g.default.v4(),this.correlationId=r.correlationId),this.correlationId||(this.correlationId=e.correlationId),this.media.bandwidthLimit={audioBandwidthLimit:this.config.audioBandwidthLimit,videoBandwidthLimit:this.config.videoBandwidthLimit},this.media.createOffer().then((0,$E.tap)(function(){return t.logger.info("created offer")})).then(function(){return t.spark.internal.locus.createOrJoin(e,(0,l.default)({localSdp:t.media.offerSdp,correlationId:t.correlationId},r))}).then((0,$E.tap)(function(){return t.logger.info("sent offer to locus")})).then((0,$E.tap)(function(){return t.logger.info("setting locus")})).then(function(e){return t.setLocus(e)}).then((0,$E.tap)(function(){return t.logger.info("successfully set locus")})).then(function(){var e=JSON.parse(t.mediaConnection.remoteSdp).sdp;return t.logger.info("accepting answer"),t.logger.info("peer state",t.media.pc&&t.media.pc.signalingState),t.media.ended?(t.logger.info("call: already ended, not accepting answer"),f.default.resolve()):t.media.acceptAnswer(e).then(function(){return t.logger.info("answer accepted")}).catch(function(e){return t.logger.error("failed to accept answer",e),f.default.reject(e)})})},decline:function(){return this.reject()},dial:function(e,t){var r=this;this.locusJoinInFlight=!0,this.logger.info("call: dialing");var n=e;if($E.base64.validate(e)){var i=$E.base64.decode(e).split("/"),o=i[3],a=i[4],u=this.spark.internal.feature.getFeature("developer","web-ha-messaging");if("PEOPLE"===o&&(n=a),"ROOM"===o){if(!(0,p.default)(this,"config.enableExperimentalGroupCallingSupport"))throw new Error("Group calling is not enabled. Please enable config.phone.enableExperimentalGroupCallingSupport");u&&u.value?this.spark.internal.device.getServiceUrl("conversation").then(function(e){return n={url:e+"/conversations/"+a+"/locus"}}):n={url:this.spark.internal.device.services.conversationServiceUrl+"/conversations/"+a+"/locus"}}}return this.spark.internal.mercury.connect().then(function(){return r.createOrJoinLocus(n,t)}).then((0,$E.tap)(function(){return r.logger.info("call: dialed")})).catch(function(e){r.trigger("error",e)}).then(function(){r.locusJoinInFlight=!1}),this},getRawStatsStream:function(){return new w.default(this.media.pc)},getStatsStream:function(){return this.getRawStatsStream().pipe(new _.default)},hangup:function(){var e=this;return"in"!==this.direction||this.joinedOnThisDevice?(this.logger.info("call: hanging up"),this.media.stop(),this.locusJoinInFlight?(this.logger.info("call: locus join in flight, waiting for rest call to complete before hanging up"),this.when("change:locusJoinInFlight").then(function(){return e.hangup()})):this.locus?this.leave():this.cleanup().then(function(){return e.logger.info("call: hang up complete, call never created")})):this.reject()},initialize:function(){for(var e=this,t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];(0,c.default)(Ix.SparkPlugin.prototype.initialize,this,r),this.on("change:activeParticipantsCount",function(){return e.onChangeActiveParticipantsCount.apply(e,arguments)}),this.on("change:isActive",function(){return e.onChangeIsActive.apply(e,arguments)}),this.on("change:localMediaStream",function(){return e.onChangeLocalMediaStream.apply(e,arguments)}),this.on("change:media.localMediaStream",function(){e.localMediaStream=e.media.localMediaStream}),this.on("change:remoteMember",function(){return e.onChangeRemoteMember.apply(e,arguments)}),["localMediaStream","remoteAudioMuted","remoteMediaStream","remoteVideoMuted","localScreenShare"].forEach(function(t){e.on("change:"+t,function(){return e.trigger(t+":change")})}),this.on("replaced",function(){return e.cleanup()}),this.listenTo(this.memberships,"add",function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.trigger.apply(e,["memberships:add"].concat(r))}),this.listenTo(this.memberships,"change",function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.trigger.apply(e,["membership:change"].concat(r))}),this.listenTo(this.memberships,"change:audioMuted",function(){return e.onMembershipsAudioMuted.apply(e,arguments)}),this.listenTo(this.memberships,"change:state",function(){return e.onMembershipsChangeState.apply(e,arguments)}),this.listenTo(this.memberships,"change:videoMuted",function(){return e.onMembershipsVideoMuted.apply(e,arguments)}),this.listenTo(this.memberships,"remove",function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.trigger.apply(e,["memberships:remove"].concat(r))}),this.listenTo(this.spark.internal.mercury,"event:locus",function(t){return e.onLocusEvent(t)}),this.listenTo(this.spark.internal.mercury,"event:locus.difference",function(t){return e.onLocusEvent(t)}),this.listenTo(this.media,"error",function(t){return e.trigger("error",t)}),this.listenTo(this.media,"internalTrackUpdate",function(){e.trigger("remoteMediaStream:change")}),this.listenTo(this.media,"negotiationneeded",function(){return e.onMediaNegotiationNeeded.apply(e,arguments)}),this.locus?this.internalCallId=(0,SD.makeInternalCallId)(this.locus):this.once("change:locus",function(){e.internalCallId=(0,SD.makeInternalCallId)(e.locus)}),this.memberships.listenToAndRun(this,"change:locus",function(){e.locus&&e.locus.participants&&(e.memberships.set((0,SD.participantsToCallMemberships)(e.spark,e.locus)),e.me=e.memberships.find(function(e){return e.isSelf}))}),this.config.enableExperimentalGroupCallingSupport?(this.on("inactive",function(){return e.hangup()}),this.on("inactive",function(){return e.cleanup()}),this.on("change:state",function(){ps(function(){return e.trigger(e.state)})}),this.on=(0,d.default)(this.on,function(t,r){for(var n=arguments.length,i=Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];if(P.includes(r))throw new Error('The "'+r+'" event is no longer valid with "enableExperimentalGroupCallingSupport===true"');return(0,c.default)(t,e,[r].concat(i))})):(this.on("disconnected",function(){return e.hangup()}),this.on("disconnected",function(){return e.cleanup()}),this.on("change:status",function(){ps(function(){return e.trigger(e.status)})}))},leave:function(){var e=this;this.logger.info("leave: attempting to leave locus");var t=(0,p.default)(this,this.config.enableExperimentalGroupCallingSupport?"me.state":"status");return"disconnected"===t?(this.logger.info("already hung up, not calling locus again"),f.default.resolve()):"declined"===t?(this.logger.info("call was declined, not leaving again"),f.default.resolve()):"connected"!==t?(this.logger.info("call is neither connected, disconnected, or declined, declining instead of leaving"),this.decline()):(this.logger.info("leave: leaving locus"),this.spark.internal.locus.leave(this.locus).catch(function(t){return e.logger.error("leave: locus leave error: ",t.stack||t.toString()),f.default.reject(t)}).then((0,$E.tap)(function(){return e.logger.info("leave "+e.locus.id+": finished leaving via locus")})).then((0,$E.tap)(function(){return e.logger.info("leave "+e.locus.id+": setting locus")})).then(function(t){return e.setLocus(t)}).then((0,$E.tap)(function(){return e.logger.info("leave "+e.locus.id+": finished setting locus")})).then((0,$E.tap)(function(){return e.logger.info("call: hung up")})))},onLocusEvent:function(e){var t=this,r=(0,p.default)(e,"data.locus.self.devices"),n=r&&(0,h.default)(r,function(e){return e.url===t.spark.internal.device.url});if(((this.locus&&(0,SD.makeInternalCallId)(e.data.locus))===this.internalCallId||n&&this.correlationId===n.correlationId)&&(this.logger.info("locus event: "+e.data.eventType),this.setLocus(e.data.locus)),e.data.locus.replaces){var i=!0,o=!1,a=void 0;try{for(var u,c=(0,s.default)(e.data.locus.replaces);!(i=(u=c.next()).done);i=!0){var l=u.value;if(l.locusUrl+"_"+l.lastActive===this.internalCallId)return this.setLocus(e.data.locus),void this.logger.info("locus replacement event: "+e.data.eventType,this.locusUrl,"->",e.data.locus.url)}}catch(e){o=!0,a=e}finally{try{!i&&c.return&&c.return()}finally{if(o)throw a}}}},onMembershipsAudioMuted:function(){this.logger.info("onMembershipsAudioMuted"),this.remoteMember&&(this.remoteAudioMuted=this.remoteMember.audioMuted)},onMembershipsVideoMuted:function(){this.logger.info("onMembershipsVideoMuted"),this.remoteMember&&(this.remoteVideoMuted=this.remoteMember.videoMuted)},onChangeRemoteMember:function(){this.remoteMember?(this.remoteAudioMuted=this.remoteMember.audioMuted,this.remoteVideoMuted=this.remoteMember.videoMuted):(this.remoteAudioMuted=void 0,this.remoteVideoMuted=void 0)},onMembershipsChangeState:function(e){this.activeParticipantsCount=this.memberships.filter(function(e){return"connected"===e.state}).length,this.trigger("membership:"+e.state,e)},onMediaNegotiationNeeded:function(){var e=this;this.logger.info("onMediaNegotiationNeeded"),this.media.createOffer().then(function(){var t=(0,DA.parse)(e.media.offerSdp),r=T("audio",t),n=!r.includes("send"),i=T("video",t),o=!i.includes("send"),a=T("screen",t);e.logger.info("onMediaNegotiationNeeded: audioOfferDir="+r+" videoOfferDir="+i+" screenOfferDir="+a),e.logger.info("onMediaNegotiationNeeded: audioMuted="+n+" videoMuted="+o);var u={sdp:e.media.offerSdp,mediaId:e.mediaId,audioMuted:n,videoMuted:o};return e.updateMedia(u)}).then(function(){return e.pollForExpectedLocusAndSdp()}).then(function(){var t=JSON.parse(e.mediaConnection.remoteSdp).sdp;return e.media.acceptAnswer(t)}).then(function(){return e.emit("mediaNegotiationCompleted")}).catch(function(t){return e.emit("error",t)})},onChangeLocalMediaStream:function(){var e=this;this.localMediaStream&&this.localMediaStream!==this.media.localMediaStream&&(["audio","video"].forEach(function(t){var r=e.localMediaStream.getTracks().find(function(e){return e.kind===t});r?e.media.setMedia(t,(0,m.default)(r.enabled,e["receiving"+C[t]]),r):e.media.setMedia(t,(0,m.default)(!1,e["receiving"+C[t]]))}),this.localMediaStream=this.media.localMediaStream)},onChangeIsActive:function(){this.isActive||this.joinedOnThisDevice&&(this.logger.info("call: hanging up due to locus going inactive"),this.hangup())},onChangeActiveParticipantsCount:function(){if(this.joinedOnThisDevice&&1===this.activeParticipantsCount&&(!this.isCall||this.config.hangupIfLastActive.call)&&(this.isCall||this.config.hangupIfLastActive.meeting)){var e=this.previousAttributes().locus;e&&(0,SD.activeParticipants)(e).length>1&&(this.logger.info("call: hanging up due to last participant in call"),this.hangup())}},pollForExpectedLocusAndSdp:function(){var e=this;return new f.default(function(t,r){var n=(0,DA.parse)(e.media.offerSdp),i=T("audio",n),o=T("video",n),a=T("screen",n),u=e,s=0;!function n(){s+=1;try{if(e.logger.info("iteration "+s+": checking if current locus sdp has the expected audio and video directions"),c=JSON.parse(e.mediaConnection.remoteSdp).sdp,l=(0,DA.parse)(c),f=T("audio",l),d=T("video",l),p=T("screen",l),h=O(i),v=O(o),g=O(a),u.logger.info("audio: "+i+", "+f+", "+h),u.logger.info("video: "+o+", "+d+", "+v),u.logger.info("screen: "+a+", "+p+", "+g),f===h&&d===v&&p===g){e.logger.info("iteration "+s+": the current locus sdp has the expected audio and video directions");try{return e.logger.info("iteration "+s+": checking if current locus has the expected audio and video directions"),e.validateLocusMediaState(e.locus),e.logger.info("iteration "+s+": the current locus has the expected audio and video directions; not syncing"),void t()}catch(t){e.logger.info("iteration "+s+": the current locus does not have the expected audio and video directions; syncing")}}else e.logger.info("iteration "+s+": the current locus sdp does not have the expected audio and video directions; syncing");if(s>4)return void r(new Error("After "+s+" attempts polling locus"));setTimeout(function(){return e.spark.internal.locus.sync(e.locus).then(function(t){return e.setLocus(t)}).then(n).catch(r)},1e3*Math.pow(2,s))}catch(e){r(e)}var c,l,f,d,p,h,v,g}()})},releaseFloor:function(){var e=this;return this.logger.info("call: releasing floor grant"),f.default.resolve().then((0,SD.waitForMediaShare)(this)).then(function(t){return e.spark.internal.locus.releaseFloorGrant(e.locus,t)})},reject:function(){var e=this;return"out"===this.direction?f.default.resolve():(this.logger.info("call: rejecting"),this.spark.internal.locus.decline(this.locus).then(function(t){return e.setLocus(t)}).then((0,$E.tap)(function(){return e.cleanup()})).then((0,$E.tap)(function(){return e.logger.info("call: rejected")})))},requestFloor:function(){var e=this;return this.logger.info("call: requesting floor grant"),f.default.resolve().then((0,SD.waitForMediaShare)(this)).then(function(t){return e.spark.internal.locus.requestFloorGrant(e.locus,t)})},setLocus:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.locus;if(!n)return this.locus=e,f.default.resolve();switch(this.spark.internal.locus.compare(n,e)){case wD.USE_INCOMING:this.locus=this.spark.internal.locus.merge(this.locus,e),this.device&&(this.correlationId=this.device.correlationId);break;case wD.FETCH:return r?(this.logger.info("call: fetching locus according to sequencing algorithm"),this.spark.internal.locus.get(n).then(function(e){return t.setLocus(e,!0)})):(this.logger.info("call: syncing locus according to sequencing algorithm"),this.spark.internal.locus.sync(n).then(function(e){return t.setLocus(e,!0)}))}return f.default.resolve()},sendDtmf:function(e){return this.supportsDtmf?this.spark.internal.locus.sendDtmf(this.locus,e):f.default.reject(new Error("this call does not support dtmf"))},sendFeedback:function(e){return this.spark.internal.metrics.submit("meetup_call_user_rating",e)},startApplicationShare:function(){var e=this;return this.logger.info("call: sharing application"),new f.default(function(t){e.media.once("answeraccepted",t),e.media.setMedia("screen","sendonly",{mediaSource:"application"})}).then(function(){return e.requestFloor()})},startScreenShare:function(){var e=this;return this.logger.info("call: sharing screen"),new f.default(function(t){e.media.once("answeraccepted",t),e.media.setMedia("screen","sendonly",{mediaSource:"screen"})}).then(function(){return e.requestFloor()})},startReceivingAudio:function(){return this.changeReceivingMedia("audio",!0)},startReceivingVideo:function(){return this.changeReceivingMedia("video",!0)},startSendingAudio:function(){return this.changeSendingMedia("audio",!0)},startSendingVideo:function(){return this.changeSendingMedia("video",!0)},stopScreenShare:function(){var e=this;return this.logger.info("call: stopping screen/application share"),this.releaseFloor().then(function(){return new f.default(function(t){e.media.once("answeraccepted",t),e.media.setMedia("screen","inactive")})})},stopReceivingAudio:function(){return this.changeReceivingMedia("audio",!1)},stopReceivingVideo:function(){return this.changeReceivingMedia("video",!1)},stopSendingAudio:function(){return this.changeSendingMedia("audio",!1)},stopSendingVideo:function(){return this.changeSendingMedia("video",!1)},toggleFacingMode:function(){var e=this;if(!this.sendingVideo)throw new Error("Cannot toggle facingMode if we're not sending video");if("user"!==this.facingMode&&"environment"!==this.facingMode)throw new Error("Cannot determine current facing mode; specify a new localMediaStream to change cameras");var t={facingMode:{ideal:"user"===this.facingMode?"environment":"user"}};return this.media.setMedia("video",(0,m.default)(this.sendingAudio,this.sendingVideo),t).then(function(){e.facingMode=t.facingMode.ideal})},toggleReceivingAudio:function(){return this.receivingAudio?this.stopReceivingAudio():this.startReceivingAudio()},toggleReceivingVideo:function(){return this.receivingVideo?this.stopReceivingVideo():this.startReceivingVideo()},toggleSendingAudio:function(){return this.sendingAudio?this.stopSendingAudio():this.startSendingAudio()},toggleSendingVideo:function(){return this.sendingVideo?this.stopSendingVideo():this.startSendingVideo()},updateMedia:function(e){var t=this;if(this.logger.info("updateMedia"),e.sdp&&!e.sdp.includes("b="))throw new Error("outbound sdp should always have a 'b=' line");return this.spark.internal.locus.updateMedia(this.locus,e).then(function(e){return t.setLocus(e)})},updateVideoMuteSdp:function(e,t){var r=E(!t,this.receivingVideo),n=E(t,this.receivingVideo);return e.replace(new RegExp("a=mid:video[^a]+a="+n,"gi"),"a=mid:video\na="+r)},updateMuteToggles:function(e,t){this.logger.info("updating mute toggles: "+e+"="+t);var r={mediaId:this.mediaId,audioMuted:!this.sendingAudio,videoMuted:!this.sendingVideo};return"audio"===e?r.audioMuted=!t:"video"===e&&(r.videoMuted=!t,r.sdp=this.updateVideoMuteSdp(this.media.offerSdp,!t)),this.updateMedia(r)},validateLocusMediaState:function(e){var t=e.self.status.audioStatus.toLowerCase(),r=this.media.audioDirection;if(t!==r)throw this.logger.warn("locus: expected audio "+t+" (locus) to equal "+r+" (local media)"),new Error("locus.self.status.audioStatus indicates the received DTO is out of date");var n=e.self.status.videoStatus.toLowerCase(),i=this.media.videoDirection;if(n!==i)throw this.logger.warn("locus: expected video "+n+" (locus) to equal "+i+" (local media)"),new Error("locus.self.status.videoStatus indicates the received DTO is out of date");return e},waitForExpectedLocus:function(){var e=this;return new f.default(function(t){var r=function r(){try{e.validateLocusMediaState(e.locus),e.off("change:locus",r),t()}catch(t){e.logger.warn("locus: current locus not in expected state; waiting for next locus")}};e.on("change:locus",r),r()})},version:"1.50.12"},"acknowledge",[$E.oneFlight],(0,u.default)(a,"acknowledge"),a),k(a,"answer",[$E.oneFlight,r],(0,u.default)(a,"answer"),a),k(a,"createOrJoinLocus",[$E.oneFlight],(0,u.default)(a,"createOrJoinLocus"),a),k(a,"decline",[n],(0,u.default)(a,"decline"),a),k(a,"dial",[$E.oneFlight],(0,u.default)(a,"dial"),a),k(a,"leave",[$E.oneFlight,i],(0,u.default)(a,"leave"),a),k(a,"onMediaNegotiationNeeded",[o],(0,u.default)(a,"onMediaNegotiationNeeded"),a),k(a,"pollForExpectedLocusAndSdp",[$E.retry],(0,u.default)(a,"pollForExpectedLocusAndSdp"),a),k(a,"reject",[$E.oneFlight],(0,u.default)(a,"reject"),a),k(a,"updateMuteToggles",[$E.oneFlight],(0,u.default)(a,"updateMuteToggles"),a),a));M.make=function(e,t){return new M(e,t)},t.default=M});t(gF);var yF=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=a(yO),n=a(Cf),i=a(WM),o=a(gF);function a(e){return e&&e.__esModule?e:{default:e}}var u=i.default.extend({model:o.default,mainIndex:"internalCallId",indexes:["correlationId"],initialize:function(){for(var e=this,t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];(0,n.default)(i.default.prototype.initialize,this,r),this.on("add",function(t){e.listenTo(t,"change:state",function(){t.config.enableExperimentalGroupCallingSupport?"inactive"===t.state&&e.remove(t):"disconnected"===t.status&&e.remove(t)})})},has:function(e){if(this.get(e.url+"_"+e.fullState.lastActive))return!0;if(e.replaces){var t=!0,n=!1,i=void 0;try{for(var o,a=(0,r.default)(e.replaces);!(t=(o=a.next()).done);t=!0){var u=o.value;if(this.get(u.locusUrl+"_"+u.lastActive))return!0}}catch(e){n=!0,i=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw i}}}return!1}});t.default=u});t(yF);var mF=r(function(t){!function(){var r,n="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";if(_="object"==typeof Ts&&"object"==typeof Ts.versions&&Ts.versions.node&&!1){var i=Ts.versions.node.toString().replace("v","");n="Nodejs/"+i+" (NodeOS) AppleWebKit/"+i+" (KHTML, like Gecko) Nodejs/"+i+" Nodejs/"+i}r=void 0!==e?e:window,"undefined"==typeof window&&("undefined"==typeof window&&void 0!==e&&(e.navigator={userAgent:n,getUserMedia:function(){}},r.window=e),"undefined"==typeof location&&(r.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(r.screen={width:0,height:0}));var o=window.navigator;void 0!==o?(void 0!==o.webkitGetUserMedia&&(o.getUserMedia=o.webkitGetUserMedia),void 0!==o.mozGetUserMedia&&(o.getUserMedia=o.mozGetUserMedia)):o={getUserMedia:function(){},userAgent:n};var a=!!/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(o.userAgent||""),u=!(-1===o.userAgent.indexOf("Edge")||!o.msSaveOrOpenBlob&&!o.msSaveBlob),s=!!window.opera||o.userAgent.indexOf(" OPR/")>=0,c=void 0!==window.InstallTrigger,l=/^((?!chrome|android).)*safari/i.test(o.userAgent),f=!!window.chrome&&!s,d="undefined"!=typeof document&&!!document.documentMode&&!u;function p(e,t){var r=0,n=!1,i=window.setInterval(function(){e()&&(window.clearInterval(i),t(n)),r++>50&&(window.clearInterval(i),t(n=!0))},10)}var h={Android:function(){return o.userAgent.match(/Android/i)},BlackBerry:function(){return o.userAgent.match(/BlackBerry|BB10/i)},iOS:function(){return o.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return o.userAgent.match(/Opera Mini/i)},Windows:function(){return o.userAgent.match(/IEMobile/i)},any:function(){return h.Android()||h.BlackBerry()||h.iOS()||h.Opera()||h.Windows()},getOsName:function(){var e="Unknown OS";return h.Android()&&(e="Android"),h.BlackBerry()&&(e="BlackBerry"),h.iOS()&&(e="iOS"),h.Opera()&&(e="Opera Mini"),h.Windows()&&(e="Windows"),e}};var v="Unknown OS",g="Unknown OS Version";var y,m,b=function(){for(var e,t=o.appVersion,r=o.userAgent,n="-",i=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}],a=0;e=i[a];a++)if(e.r.test(r)){n=e.s;break}var u="-";switch(/Windows/.test(n)&&(/Windows (.*)/.test(n)&&(u=/Windows (.*)/.exec(n)[1]),n="Windows"),n){case"Mac OS X":/Mac OS X (10[\.\_\d]+)/.test(r)&&(u=/Mac OS X (10[\.\_\d]+)/.exec(r)[1]);break;case"Android":/Android ([\.\_\d]+)/.test(r)&&(u=/Android ([\.\_\d]+)/.exec(r)[1]);break;case"iOS":/OS (\d+)_(\d+)_?(\d+)?/.test(r)&&(u=(u=/OS (\d+)_(\d+)_?(\d+)?/.exec(t))[1]+"."+u[2]+"."+(0|u[3]))}return{osName:n,osVersion:u}}();b&&b.osName&&"-"!=b.osName?(v=b.osName,g=b.osVersion):h.any()&&"Android"==(v=h.getOsName())&&(g=!!(m=(y=(y||o.userAgent).toLowerCase()).match(/android\s([0-9\.]*)/))&&m[1]);var _="object"==typeof Ts&&"object"==typeof Ts.versions&&Ts.versions.node;"Unknown OS"===v&&_&&(v="Nodejs",g=Ts.versions.node.toString().replace("v",""));var w=!1,S=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(e){"undefined"!=typeof document&&"function"==typeof document.createElement&&(!w&&e in document.createElement("canvas")&&(w=!0),!S&&e in document.createElement("video")&&(S=!0))});var k=/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/,E=/([0-9]{1,3}(\.[0-9]{1,3}){3})/,P=/[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7}/;var T=[],O=[],C=[],M=[];o.mediaDevices&&o.mediaDevices.enumerateDevices&&(o.enumerateDevices=function(e){var t=o.mediaDevices.enumerateDevices();t&&t.then?o.mediaDevices.enumerateDevices().then(e).catch(function(){e([])}):e([])});var x=!1;"undefined"!=typeof MediaStreamTrack&&"getSources"in MediaStreamTrack?x=!0:o.mediaDevices&&o.mediaDevices.enumerateDevices&&(x=!0);var j=!1,R=!1,A=!1,I=!1,D=!1;var L=window.DetectRTC||{};L.browser=function(){o.appVersion;var e,t,r,n=o.userAgent,i=o.appName,a=""+parseFloat(o.appVersion),p=parseInt(o.appVersion,10);if(l&&!f&&-1!==n.indexOf("CriOS")&&(l=!1,f=!0),s){i="Opera";try{p=(a=o.userAgent.split("OPR/")[1].split(" ")[0]).split(".")[0]}catch(e){a="0.0.0.0",p=0}}else d?((t=n.indexOf("rv:"))>0?a=n.substring(t+3):(t=n.indexOf("MSIE"),a=n.substring(t+5)),i="IE"):f?(t=n.indexOf("Chrome"),i="Chrome",a=n.substring(t+7)):l?(t=n.indexOf("Safari"),i="Safari",a=n.substring(t+7),-1!==(t=n.indexOf("Version"))&&(a=n.substring(t+8)),-1!==o.userAgent.indexOf("Version/")&&(a=o.userAgent.split("Version/")[1].split(" ")[0])):c?(t=n.indexOf("Firefox"),i="Firefox",a=n.substring(t+8)):(e=n.lastIndexOf(" ")+1)<(t=n.lastIndexOf("/"))&&(i=n.substring(e,t),a=n.substring(t+1),i.toLowerCase()===i.toUpperCase()&&(i=o.appName));return u&&(i="Edge",a=o.userAgent.split("Edge/")[1]),-1!==(r=a.search(/[; \)]/))&&(a=a.substring(0,r)),p=parseInt(""+a,10),isNaN(p)&&(a=""+parseFloat(o.appVersion),p=parseInt(o.appVersion,10)),{fullVersion:a,version:p,name:i,isPrivateBrowsing:!1}}(),function(e){var t;try{if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,function(){t=!1},function(e){t=!0});else if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){var r;try{(r=window.indexedDB.open("test")).onerror=function(){return!0}}catch(e){t=!0}void 0===t&&p(function(){return"done"===r.readyState},function(e){e||(t=!r.result)})}else if(function(e){var t=e.toLowerCase();if(0===t.indexOf("msie")&&0===t.indexOf("trident"))return!1;var r=/(?:msie|rv:)\s?([\d\.]+)/.exec(t);return!!(r&&parseInt(r[1],10)>=10)}(window.navigator.userAgent)){t=!1;try{window.indexedDB||(t=!0)}catch(e){t=!0}}else if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem("test",1)}catch(e){t=!0}void 0===t&&(t=!1,window.localStorage.removeItem("test"))}}catch(e){t=!1}p(function(){return void 0!==t},function(r){e(t)})}(function(e){L.browser.isPrivateBrowsing=!!e}),L.browser["is"+L.browser.name]=!0,L.osName=v,L.osVersion=g;var F=!1;["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach(function(e){F||e in window&&(F=!0)}),L.isWebRTCSupported=F,L.isORTCSupported="undefined"!=typeof RTCIceGatherer;var N=!1;(L.browser.isChrome&&L.browser.version>=35?N=!0:L.browser.isFirefox&&L.browser.version>=34?N=!0:L.browser.isEdge&&L.browser.version>=17?N=!0:"Android"===L.osName&&L.browser.isChrome&&(N=!0),/^(https:|chrome-extension:)$/g.test(location.protocol||""))||("undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(L.browser.isChrome||L.browser.isEdge||L.browser.isOpera)?N=!1:L.browser.isFirefox&&(N=!1));L.isScreenCapturingSupported=N;var U={isSupported:!1,isCreateMediaStreamSourceSupported:!1};["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"].forEach(function(e){U.isSupported||e in window&&(U.isSupported=!0,window[e]&&"createMediaStreamSource"in window[e].prototype&&(U.isCreateMediaStreamSourceSupported=!0))}),L.isAudioContextSupported=U.isSupported,L.isCreateMediaStreamSourceSupported=U.isCreateMediaStreamSourceSupported;var z=!1;L.browser.isChrome&&L.browser.version>31&&(z=!0),L.isRtpDataChannelsSupported=z;var q=!1;L.browser.isFirefox&&L.browser.version>28?q=!0:L.browser.isChrome&&L.browser.version>25?q=!0:L.browser.isOpera&&L.browser.version>=11&&(q=!0),L.isSctpDataChannelsSupported=q,L.isMobileDevice=a;var B=!1;o.getUserMedia?B=!0:o.mediaDevices&&o.mediaDevices.getUserMedia&&(B=!0),L.browser.isChrome&&L.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(B="Requires HTTPs"),"Nodejs"===L.osName&&(B=!1),L.isGetUserMediaSupported=B;var W,V,G,H="";screen.width&&(H+=(screen.width?screen.width:"")+" x "+(screen.height?screen.height:""));L.displayResolution=H,L.displayAspectRatio=(W=screen.width,V=screen.height,G=function e(t,r){return 0==r?t:e(r,t%r)}(W,V),W/G/(V/G)).toFixed(2),L.isCanvasSupportsStreamCapturing=w,L.isVideoSupportsStreamCapturing=S,"Chrome"==L.browser.name&&L.browser.version>=53&&(L.isCanvasSupportsStreamCapturing||(L.isCanvasSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features"),L.isVideoSupportsStreamCapturing||(L.isVideoSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features")),L.DetectLocalIPAddress=function(e,t){if(L.isWebRTCSupported){var r=!0,n=!0;!function(e,t){if("undefined"!=typeof document&&"function"==typeof document.getElementById){var r={},n=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;if(!n){var i=document.getElementById("iframe");if(!i)return;var o=i.contentWindow;n=o.RTCPeerConnection||o.mozRTCPeerConnection||o.webkitRTCPeerConnection}if(n){var a=null;"Chrome"===L.browser&&L.browser.version<58&&(a={optional:[{RtpDataChannels:!0}]});var u=new n({iceServers:[{urls:"stun:stun.l.google.com:19302"}]},a);if(t&&(u.addStream?u.addStream(t):u.addTrack&&t.getTracks()[0]&&u.addTrack(t.getTracks()[0],t)),u.onicecandidate=function(e){e.candidate&&e.candidate.candidate?s(e.candidate.candidate):s()},!t)try{u.createDataChannel("sctp",{})}catch(e){}L.isPromisesSupported?u.createOffer().then(function(e){u.setLocalDescription(e).then(c)}):u.createOffer(function(e){u.setLocalDescription(e,c,function(){})},function(){})}}function s(t){if(t){var n=E.exec(t);if(n){var i=n[1],o=t.match(k);void 0===r[i]&&e(i,o,!0),r[i]=!0}}else e()}function c(){var e=u.localDescription.sdp.split("\n");e.forEach(function(e){e&&0===e.indexOf("a=candidate:")&&s(e)})}}(function(t){t?t.match(k)?e("Local: "+t,r=!1,n):t.match(P)?e("Public: "+t,r,n=!1):e("Public: "+t,r,n):e()},t)}},L.isWebSocketsSupported="WebSocket"in window&&2===window.WebSocket.CLOSING,L.isWebSocketsBlocked=!L.isWebSocketsSupported,"Nodejs"===L.osName&&(L.isWebSocketsSupported=!0,L.isWebSocketsBlocked=!1),L.checkWebSocketsSupport=function(e){e=e||function(){};try{var t,r=new WebSocket("wss://echo.websocket.org:443/");r.onopen=function(){L.isWebSocketsBlocked=!1,t=(new Date).getTime(),r.send("ping")},r.onmessage=function(){L.WebsocketLatency=(new Date).getTime()-t+"ms",e(),r.close(),r=null},r.onerror=function(){L.isWebSocketsBlocked=!0,e()}}catch(t){L.isWebSocketsBlocked=!0,e()}},L.load=function(e){!function(e){if(x)if(!o.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(o.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!o.enumerateDevices&&o.enumerateDevices&&(o.enumerateDevices=o.enumerateDevices.bind(o)),o.enumerateDevices){T=[],O=[],C=[],M=[],j=!1,R=!1,A=!1,I=!1,D=!1;var t={};o.enumerateDevices(function(r){r.forEach(function(e){var r={};for(var n in e)try{"function"!=typeof e[n]&&(r[n]=e[n])}catch(e){}t[r.deviceId+r.label+r.kind]||("audio"===r.kind&&(r.kind="audioinput"),"video"===r.kind&&(r.kind="videoinput"),r.deviceId||(r.deviceId=r.id),r.id||(r.id=r.deviceId),r.label?("videoinput"!==r.kind||D||(D=!0),"audioinput"!==r.kind||I||(I=!0)):(r.isCustomLabel=!0,"videoinput"===r.kind?r.label="Camera "+(M.length+1):"audioinput"===r.kind?r.label="Microphone "+(O.length+1):"audiooutput"===r.kind?r.label="Speaker "+(C.length+1):r.label="Please invoke getUserMedia once.",void 0!==L&&L.browser.isChrome&&L.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(r.label="HTTPs is required to get label of this "+r.kind+" device.")),"audioinput"===r.kind&&(j=!0,-1===O.indexOf(r)&&O.push(r)),"audiooutput"===r.kind&&(R=!0,-1===C.indexOf(r)&&C.push(r)),"videoinput"===r.kind&&(A=!0,-1===M.indexOf(r)&&M.push(r)),T.push(r),t[r.deviceId+r.label+r.kind]=r)}),void 0!==L&&(L.MediaDevices=T,L.hasMicrophone=j,L.hasSpeakers=R,L.hasWebcam=A,L.isWebsiteHasWebcamPermissions=D,L.isWebsiteHasMicrophonePermissions=I,L.audioInputDevices=O,L.audioOutputDevices=C,L.videoInputDevices=M),e&&e()})}else e&&e();else e&&e()}(e=e||function(){})},L.MediaDevices=void 0!==T?T:[],L.hasMicrophone=j,L.hasSpeakers=R,L.hasWebcam=A,L.isWebsiteHasWebcamPermissions=D,L.isWebsiteHasMicrophonePermissions=I,L.audioInputDevices=O,L.audioOutputDevices=C,L.videoInputDevices=M;var $=!1;"undefined"!=typeof document&&"function"==typeof document.createElement&&"setSinkId"in document.createElement("video")&&($=!0),L.isSetSinkIdSupported=$;var J=!1;L.browser.isFirefox&&"undefined"!=typeof mozRTCPeerConnection?"getSenders"in mozRTCPeerConnection.prototype&&(J=!0):L.browser.isChrome&&"undefined"!=typeof webkitRTCPeerConnection&&"getSenders"in webkitRTCPeerConnection.prototype&&(J=!0),L.isRTPSenderReplaceTracksSupported=J;var Y=!1;L.browser.isFirefox&&L.browser.version>38&&(Y=!0),L.isRemoteStreamProcessingSupported=Y;var K=!1;"undefined"!=typeof MediaStreamTrack&&"applyConstraints"in MediaStreamTrack.prototype&&(K=!0),L.isApplyConstraintsSupported=K;var X=!1;L.browser.isFirefox&&L.browser.version>=43&&(X=!0),L.isMultiMonitorScreenCapturingSupported=X,L.isPromisesSupported=!!("Promise"in window),L.version="1.3.9",void 0===L&&(window.DetectRTC={});var Z=window.MediaStream;void 0===Z&&"undefined"!=typeof webkitMediaStream&&(Z=webkitMediaStream),L.MediaStream=void 0!==Z&&"function"==typeof Z&&Object.keys(Z.prototype),"undefined"!=typeof MediaStreamTrack?L.MediaStreamTrack=Object.keys(MediaStreamTrack.prototype):L.MediaStreamTrack=!1;var Q=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;L.RTCPeerConnection=void 0!==Q&&Object.keys(Q.prototype),window.DetectRTC=L,t.exports=L}()}),bF=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.events=void 0;var r=l(Cf),n=l(mO),i=l(bf),o=l(ex),a=l(cS),u=l(aI),s=l(gF),c=l(yF);function l(e){return e&&e.__esModule?e:{default:e}}var f=t.events={CALL_CREATED:"call:created",CALL_INCOMING:"call:incoming"},d=Ix.SparkPlugin.extend({collections:{emittedCalls:c.default},session:{connected:{default:!1,type:"boolean"},defaultFacingMode:{default:"user",type:"string",values:["user","environment"]},registered:{default:!1,type:"boolean"}},namespace:"phone",isCallingSupported:function(){return new i.default(function(e){e(mF.isWebRTCSupported)})},register:function(){var e=this;return this.spark.internal.device.refresh().then(function(){return e.connected?i.default.resolve():i.default.all([e.emittedCalls.reset(),e.spark.internal.mercury.when("event:mercury.buffer_state").then(function(t){return"UNKNOWN"===(0,n.default)(t,1)[0].data.bufferState.locus?e.listActiveCalls():i.default.resolve()}),e.spark.internal.mercury.connect()])})},deregister:function(){var e=this;return this.spark.internal.mercury.disconnect().then(function(){return e.spark.internal.device.unregister()})},createLocalMediaStream:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.constraints||e;return(0,a.default)(t,{audio:!0,video:!0}),u.default.getUserMedia(t)},listActiveCalls:function(){var e=this;return this.spark.internal.locus.list().then(function(t){var r=e.emittedCalls.map(function(e){return e});return t?(t.forEach(function(t){if(!e.emittedCalls.has(t)){var n=s.default.make({locus:t,parent:e.spark});r.push(n),e.emittedCalls.add(n),e._triggerCallEvents(n,t)}}),r):r})},initialize:function(){for(var e=this,t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];(0,r.default)(Ix.SparkPlugin.prototype.initialize,this,n),this.listenTo(this.spark.internal.mercury,"event:locus",function(t){return e.onLocusEvent(t)}),this.listenTo(this.spark.internal.mercury,"change:connected",function(){e.connected=e.spark.internal.mercury.connected,e.registered=!!e.spark.internal.device.url&&e.connected}),this.listenTo(this.spark.internal.device,"change:url",function(){e.registered=!!e.spark.internal.device.url&&e.connected})},onLocusEvent:function(e){var t=e.data.locus;if(!this.emittedCalls.has(t)&&"inactive"!==t.fullState.state.toLowerCase()){var r=s.default.make({locus:t},{parent:this.spark});this.emittedCalls.add(r),this._triggerCallEvents(r,e.data.locus)}},dial:function(e,t){var r=s.default.make({},{parent:this.spark});return r.dial(e,t),this.emittedCalls.add(r),r},_triggerCallEvents:function(e,t){this.trigger(f.CALL_CREATED,e),(0,SD.shouldRing)(t)&&((0,SD.isCall)(t)||!(0,SD.isCall)(t)&&(0,o.default)(this,"config.enableExperimentalGroupCallingSupport"))&&this.trigger(f.CALL_INCOMING,e)},version:"1.50.12"});t.default=d});t(bF);bF.events;var _F=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=bf)&&r.__esModule?r:{default:r};var i=Ix.Batcher.extend({namespace:"People",handleHttpSuccess:function(e){var t=this;return n.default.all(e.body.items.map(function(e){return t.handleItemSuccess(e.id,e)}))},handleItemFailure:function(e,t){return this.getDeferredForResponse(e).then(function(e){e.reject(t)})},handleItemSuccess:function(e,t){return this.getDeferredForResponse(e).then(function(e){e.resolve(t)})},fingerprintRequest:function(e){var t=this.spark.people.inferPersonIdFromUuid(e);return n.default.resolve(t)},fingerprintResponse:function(e){return n.default.resolve(e)},prepareRequest:function(e){return n.default.resolve(e.join())},submitHttpRequest:function(e){return this.spark.request({service:"hydra",resource:"people/?id="+e+"&showAllTypes="+this.config.showAllTypes})}});t.default=i});t(_F);var wF=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=a(ac),i=a(bf),o=a(_F);function a(e){return e&&e.__esModule?e:{default:e}}var u,s,c,l,f,d,p=Ix.SparkPlugin.extend((r={namespace:"People",children:{batcher:o.default},get:function(e){if(!e)return i.default.reject(new Error("A person with an id is required"));if("me"===e)return this._getMe();var t=e.personId||e.id||e;return this.batcher.request(t)},list:function(e){var t=this;if(Array.isArray(e)){var r=e;return i.default.all(r.map(function(e){return t.batcher.request(e)}))}return this.request({service:"hydra",resource:"people",qs:e}).then(function(e){return new Ix.Page(e,t.spark)})},inferPersonIdFromUuid:function(e){try{if($E.base64.decode(e).includes("ciscospark://"))return e}catch(e){}return $E.base64.encode("ciscospark://us/PEOPLE/"+e)},_getMe:function(){return this.spark.request({service:"hydra",resource:"people/me"}).then(function(e){return e.body})},version:"1.50.12"},u=r,s="_getMe",c=[$E.oneFlight],l=(0,n.default)(r,"_getMe"),f=r,d={},Object.keys(l).forEach(function(e){d[e]=l[e]}),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=c.slice().reverse().reduce(function(e,t){return t(u,s,e)||e},d),f&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(f):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(u,s,d),d=null),r));t.default=p});t(wF);var SF=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={people:{batcherWait:100,batcherMaxCalls:10,batcherMaxWait:1500,showAllTypes:!1}}});t(SF),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i(wF).default}});var r=i(wF),n=i(SF);function i(e){return e&&e.__esModule?e:{default:e}}(0,Ix.registerPlugin)("people",r.default,{config:n.default})}));var kF=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={phone:{audioBandwidthLimit:64e3,videoBandwidthLimit:1e6,enableExperimentalGroupCallingSupport:!1,hangupIfLastActive:{call:!0,meeting:!1}}}});t(kF);var EF=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.StatsStream=t.StatsFilter=t.remoteParticipant=t.boolToStatus=t.Call=t.phoneEvents=void 0,Object.defineProperty(t,"phoneEvents",{enumerable:!0,get:function(){return bF.events}}),Object.defineProperty(t,"Call",{enumerable:!0,get:function(){return i(gF).default}}),Object.defineProperty(t,"boolToStatus",{enumerable:!0,get:function(){return i(kD).default}}),Object.defineProperty(t,"remoteParticipant",{enumerable:!0,get:function(){return SD.remoteParticipant}}),Object.defineProperty(t,"StatsFilter",{enumerable:!0,get:function(){return i(hF).default}}),Object.defineProperty(t,"StatsStream",{enumerable:!0,get:function(){return i(vF).default}});var r=i(bF),n=i(kF);function i(e){return e&&e.__esModule?e:{default:e}}t.default=r.default,(0,Ix.registerPlugin)("phone",r.default,{config:n.default})});t(EF);EF.StatsStream,EF.StatsFilter,EF.remoteParticipant,EF.boolToStatus,EF.Call,EF.phoneEvents;var PF=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(WT),n=o(cc),i=o(vp);function o(e){return e&&e.__esModule?e:{default:e}}var a=Ix.SparkPlugin.extend({create:function(e){var t="body";e.file&&(this.logger.warn("Supplying a single `file` property is deprecated; please supply a `files` array"),e.files=[e.file],(0,n.default)(e,"file")),(0,i.default)(e.files)&&e.files.reduce(function(e,t){return e||"string"!=typeof t},!1)&&(t="formData");var o=(0,r.default)({method:"POST",service:"hydra",resource:"messages"},t,e);return this.request(o).then(function(e){return e.body})},get:function(e){var t=e.id||e;return this.request({service:"hydra",resource:"messages/"+t}).then(function(e){return e.body.items||e.body})},list:function(e){var t=this;return this.request({service:"hydra",resource:"messages",qs:e}).then(function(e){return new Ix.Page(e,t.spark)})},remove:function(e){var t=e.id||e;return this.request({method:"DELETE",service:"hydra",resource:"messages/"+t}).then(function(e){if(204!==e.statusCode)return e.body})},version:"1.50.12"});t.default=a});t(PF),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=PF)&&r.__esModule?r:{default:r};(0,Ix.registerPlugin)("messages",n.default),t.default=n.default}));var TF=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Ix.SparkPlugin.extend({create:function(e){return this.request({method:"POST",service:"hydra",resource:"memberships",body:e}).then(function(e){return e.body})},get:function(e){var t=e.id||e;return this.request({service:"hydra",resource:"memberships/"+t}).then(function(e){return e.body.items||e.body})},list:function(e){var t=this;return this.request({service:"hydra",resource:"memberships",qs:e}).then(function(e){return new Ix.Page(e,t.spark)})},remove:function(e){var t=e.id||e;return this.request({method:"DELETE",service:"hydra",resource:"memberships/"+t}).then(function(e){if(204!==e.statusCode)return e.body})},update:function(e){var t=e.id||e;return this.request({method:"PUT",service:"hydra",resource:"memberships/"+t,body:e}).then(function(e){return e.body})},version:"1.50.12"});t.default=r});t(TF),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=TF)&&r.__esModule?r:{default:r};(0,Ix.registerPlugin)("memberships",n.default),t.default=n.default}));var OF=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Ix.SparkPlugin.extend({create:function(e){return this.request({method:"POST",service:"hydra",resource:"rooms",body:e}).then(function(e){return e.body})},get:function(e,t){var r=e.id||e;return this.request({service:"hydra",resource:"rooms/"+r,qs:t}).then(function(e){return e.body.items||e.body})},list:function(e){var t=this;return this.request({service:"hydra",resource:"rooms/",qs:e}).then(function(e){return new Ix.Page(e,t.spark)})},remove:function(e){var t=e.id||e;return this.request({method:"DELETE",service:"hydra",resource:"rooms/"+t}).then(function(e){if(204!==e.statusCode)return e.body})},update:function(e){var t=e.id;return this.request({method:"PUT",service:"hydra",resource:"rooms/"+t,body:e}).then(function(e){return e.body})},version:"1.50.12"});t.default=r});t(OF),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=OF)&&r.__esModule?r:{default:r};(0,Ix.registerPlugin)("rooms",n.default),t.default=n.default}));var CF=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Ix.SparkPlugin.extend({create:function(e){return this.request({method:"POST",service:"hydra",resource:"teams",body:e}).then(function(e){return e.body})},get:function(e,t){var r=e.id||e;return this.request({service:"hydra",resource:"teams/"+r,qs:t}).then(function(e){return e.body.items||e.body})},list:function(e){var t=this;return this.request({service:"hydra",resource:"teams/",qs:e}).then(function(e){return new Ix.Page(e,t.spark)})},update:function(e){var t=e.id;return this.request({method:"PUT",service:"hydra",resource:"teams/"+t,body:e}).then(function(e){return e.body})},version:"1.50.12"});t.default=r});t(CF),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=CF)&&r.__esModule?r:{default:r};(0,Ix.registerPlugin)("teams",n.default),t.default=n.default}));var MF=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Ix.SparkPlugin.extend({create:function(e){return this.request({method:"POST",service:"hydra",resource:"team/memberships",body:e}).then(function(e){return e.body})},get:function(e){var t=e.id||e;return this.request({service:"hydra",resource:"team/memberships/"+t}).then(function(e){return e.body.items||e.body})},list:function(e){var t=this;return this.request({service:"hydra",resource:"team/memberships",qs:e}).then(function(e){return new Ix.Page(e,t.spark)})},remove:function(e){var t=e.id||e;return this.request({method:"DELETE",service:"hydra",resource:"team/memberships/"+t}).then(function(e){if(204!==e.statusCode)return e.body})},update:function(e){var t=e.id||e;return this.request({method:"PUT",service:"hydra",resource:"team/memberships/"+t,body:e}).then(function(e){return e.body})},version:"1.50.12"});t.default=r});t(MF),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=MF)&&r.__esModule?r:{default:r};(0,Ix.registerPlugin)("teamMemberships",n.default),t.default=n.default}));var xF=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Ix.SparkPlugin.extend({create:function(e){return this.request({method:"POST",service:"hydra",resource:"webhooks",body:e}).then(function(e){return e.body})},get:function(e){var t=e.id||e;return this.request({service:"hydra",resource:"webhooks/"+t}).then(function(e){return e.body.items||e.body})},list:function(e){var t=this;return this.request({service:"hydra",resource:"webhooks/",qs:e}).then(function(e){return new Ix.Page(e,t.spark)})},remove:function(e){var t=e.id||e;return this.request({method:"DELETE",service:"hydra",resource:"webhooks/"+t}).then(function(e){if(204!==e.statusCode)return e.body})},update:function(e){var t=e.id;return this.request({method:"PUT",service:"hydra",resource:"webhooks/"+t,body:e}).then(function(e){return e.body})},version:"1.50.12"});t.default=r});t(xF),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=xF)&&r.__esModule?r:{default:r};(0,Ix.registerPlugin)("webhooks",n.default),t.default=n.default}));var jF=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(cc),n=s(bf),i=s(jf),o=s(Wm),a=s($m),u=s(hb);function s(e){return e&&e.__esModule?e:{default:e}}var c=new u.default,l=new u.default,f=function(){function e(t){(0,o.default)(this,e),this.Bound=function(){function e(t,r){(0,o.default)(this,e),c.set(this,t),l.set(this,r.logger)}return(0,a.default)(e,[{key:"_getRawData",value:function(){var e=localStorage.getItem(t);return e?JSON.parse(e):{}}},{key:"_load",value:function(){return this._getRawData()[c.get(this)]||{}}},{key:"_save",value:function(e){var r=this._getRawData();r[c.get(this)]=e,localStorage.setItem(t,(0,i.default)(r))}},{key:"clear",value:function(){return l.get(this).info("local-storage-store-adapter: clearing localStorage"),n.default.resolve(localStorage.removeItem(t))}},{key:"del",value:function(e){var t=this;return new n.default(function(n){l.get(t).info("local-storage-store-adapter: deleting `"+e+"`");var i=t._load();(0,r.default)(i,e),t._save(i),n()})}},{key:"get",value:function(e){var t=this;return new n.default(function(r,n){l.get(t).info("local-storage-store-adapter: reading `"+e+"`");var i=t._load()[e];return void 0!==i?r(i):n(new Ix.NotFoundError("No value found for "+e))})}},{key:"put",value:function(e,t){var r=this;return new n.default(function(n){l.get(r).info("local-storage-store-adapter: writing `"+e+"`");var i=r._load();i[e]=t,r._save(i),n()})}}]),e}()}return(0,a.default)(e,[{key:"bind",value:function(e,t){return t=t||{},e?t.logger?(t.logger.info("local-storage-store-adapter: returning binding"),n.default.resolve(new this.Bound(e,t))):n.default.reject(new Error("`options.logger` is required")):n.default.reject(new Error("`namespace` is required"))}}]),e}();t.default=f});t(jF);var RF=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=jF)&&r.__esModule?r:{default:r};t.default={boundedAdapter:new n.default("ciscospark"),unboundedAdapter:Ix.MemoryStoreAdapter}});t(RF);var AF=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=RF)&&r.__esModule?r:{default:r};t.default={hydra:Ts.env.HYDRA_SERVICE_URL||"https://api.ciscospark.com/v1",hydraServiceUrl:Ts.env.HYDRA_SERVICE_URL||"https://api.ciscospark.com/v1",credentials:{clientType:"confidential"},device:{ephemeral:!0},storage:n.default}});t(AF);var IF=Ix.default.extend({ciscospark:!0,version:"1.50.12"});IF.version="1.50.12",IF.init=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.config=QM({},AF,e.config),new IF(e)};var DF=IF;e._babelPolyfill;var LF=DF;return window.ciscospark=LF}();
