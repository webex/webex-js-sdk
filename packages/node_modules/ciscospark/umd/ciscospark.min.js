/*! Cisco Spark SDK v1.50.8 */
var CiscoSpark=function(){"use strict";var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function r(e,t){return e(t={exports:{}},t.exports),t.exports}var n=r(function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)}),i={}.hasOwnProperty,o=function(e,t){return i.call(e,t)},a=function(e){try{return!!e()}catch(e){return!0}},s=!a(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),u=r(function(e){var t=e.exports={version:"2.6.5"};"number"==typeof __e&&(__e=t)}),c=(u.version,function(e){return"object"==typeof e?null!==e:"function"==typeof e}),l=function(e){if(!c(e))throw TypeError(e+" is not an object!");return e},f=n.document,d=c(f)&&c(f.createElement),p=function(e){return d?f.createElement(e):{}},h=!s&&!a(function(){return 7!=Object.defineProperty(p("div"),"a",{get:function(){return 7}}).a}),v=function(e,t){if(!c(e))return e;var r,n;if(t&&"function"==typeof(r=e.toString)&&!c(n=r.call(e)))return n;if("function"==typeof(r=e.valueOf)&&!c(n=r.call(e)))return n;if(!t&&"function"==typeof(r=e.toString)&&!c(n=r.call(e)))return n;throw TypeError("Can't convert object to primitive value")},g=Object.defineProperty,m={f:s?Object.defineProperty:function(e,t,r){if(l(e),t=v(t,!0),l(r),h)try{return g(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},y=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},_=s?function(e,t,r){return m.f(e,t,y(1,r))}:function(e,t,r){return e[t]=r,e},b=0,E=Math.random(),S=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++b+E).toString(36))},T=r(function(e){var t=n["__core-js_shared__"]||(n["__core-js_shared__"]={});(e.exports=function(e,r){return t[e]||(t[e]=void 0!==r?r:{})})("versions",[]).push({version:u.version,mode:"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})}),w=T("native-function-to-string",Function.toString),O=r(function(e){var t=S("src"),r=(""+w).split("toString");u.inspectSource=function(e){return w.call(e)},(e.exports=function(e,i,a,s){var u="function"==typeof a;u&&(o(a,"name")||_(a,"name",i)),e[i]!==a&&(u&&(o(a,t)||_(a,t,e[i]?""+e[i]:r.join(String(i)))),e===n?e[i]=a:s?e[i]?e[i]=a:_(e,i,a):(delete e[i],_(e,i,a)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[t]||w.call(this)})}),k=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e},R=function(e,t,r){if(k(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}},A=function(e,t,r){var i,o,a,s,c=e&A.F,l=e&A.G,f=e&A.S,d=e&A.P,p=e&A.B,h=l?n:f?n[t]||(n[t]={}):(n[t]||{}).prototype,v=l?u:u[t]||(u[t]={}),g=v.prototype||(v.prototype={});for(i in l&&(r=t),r)a=((o=!c&&h&&void 0!==h[i])?h:r)[i],s=p&&o?R(a,n):d&&"function"==typeof a?R(Function.call,a):a,h&&O(h,i,a,e&A.U),v[i]!=a&&_(v,i,s),d&&g[i]!=a&&(g[i]=a)};n.core=u,A.F=1,A.G=2,A.S=4,A.P=8,A.B=16,A.W=32,A.U=64,A.R=128;var I=A,P=r(function(e){var t=S("meta"),r=m.f,n=0,i=Object.isExtensible||function(){return!0},s=!a(function(){return i(Object.preventExtensions({}))}),u=function(e){r(e,t,{value:{i:"O"+ ++n,w:{}}})},l=e.exports={KEY:t,NEED:!1,fastKey:function(e,r){if(!c(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,t)){if(!i(e))return"F";if(!r)return"E";u(e)}return e[t].i},getWeak:function(e,r){if(!o(e,t)){if(!i(e))return!0;if(!r)return!1;u(e)}return e[t].w},onFreeze:function(e){return s&&l.NEED&&i(e)&&!o(e,t)&&u(e),e}}}),C=(P.KEY,P.NEED,P.fastKey,P.getWeak,P.onFreeze,r(function(e){var t=T("wks"),r=n.Symbol,i="function"==typeof r;(e.exports=function(e){return t[e]||(t[e]=i&&r[e]||(i?r:S)("Symbol."+e))}).store=t})),M=m.f,N=C("toStringTag"),D=function(e,t,r){e&&!o(e=r?e:e.prototype,N)&&M(e,N,{configurable:!0,value:t})},j={f:C},x=m.f,L=function(e){var t=u.Symbol||(u.Symbol=n.Symbol||{});"_"==e.charAt(0)||e in t||x(t,e,{value:j.f(e)})},U={}.toString,F=function(e){return U.call(e).slice(8,-1)},G=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==F(e)?e.split(""):Object(e)},q=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},V=function(e){return G(q(e))},B=Math.ceil,z=Math.floor,W=function(e){return isNaN(e=+e)?0:(e>0?z:B)(e)},H=Math.min,Y=function(e){return e>0?H(W(e),9007199254740991):0},$=Math.max,X=Math.min,J=function(e,t){return(e=W(e))<0?$(e+t,0):X(e,t)},K=function(e){return function(t,r,n){var i,o=V(t),a=Y(o.length),s=J(n,a);if(e&&r!=r){for(;a>s;)if((i=o[s++])!=i)return!0}else for(;a>s;s++)if((e||s in o)&&o[s]===r)return e||s||0;return!e&&-1}},Q=T("keys"),Z=function(e){return Q[e]||(Q[e]=S(e))},ee=K(!1),te=Z("IE_PROTO"),re=function(e,t){var r,n=V(e),i=0,a=[];for(r in n)r!=te&&o(n,r)&&a.push(r);for(;t.length>i;)o(n,r=t[i++])&&(~ee(a,r)||a.push(r));return a},ne="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),ie=Object.keys||function(e){return re(e,ne)},oe={f:Object.getOwnPropertySymbols},ae={f:{}.propertyIsEnumerable},se=Array.isArray||function(e){return"Array"==F(e)},ue=s?Object.defineProperties:function(e,t){l(e);for(var r,n=ie(t),i=n.length,o=0;i>o;)m.f(e,r=n[o++],t[r]);return e},ce=n.document,le=ce&&ce.documentElement,fe=Z("IE_PROTO"),de=function(){},pe=function(){var e,t=p("iframe"),r=ne.length;for(t.style.display="none",le.appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),pe=e.F;r--;)delete pe.prototype[ne[r]];return pe()},he=Object.create||function(e,t){var r;return null!==e?(de.prototype=l(e),r=new de,de.prototype=null,r[fe]=e):r=pe(),void 0===t?r:ue(r,t)},ve=ne.concat("length","prototype"),ge={f:Object.getOwnPropertyNames||function(e){return re(e,ve)}},me=ge.f,ye={}.toString,_e="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],be={f:function(e){return _e&&"[object Window]"==ye.call(e)?function(e){try{return me(e)}catch(e){return _e.slice()}}(e):me(V(e))}},Ee=Object.getOwnPropertyDescriptor,Se={f:s?Ee:function(e,t){if(e=V(e),t=v(t,!0),h)try{return Ee(e,t)}catch(e){}if(o(e,t))return y(!ae.f.call(e,t),e[t])}},Te=P.KEY,we=Se.f,Oe=m.f,ke=be.f,Re=n.Symbol,Ae=n.JSON,Ie=Ae&&Ae.stringify,Pe=C("_hidden"),Ce=C("toPrimitive"),Me={}.propertyIsEnumerable,Ne=T("symbol-registry"),De=T("symbols"),je=T("op-symbols"),xe=Object.prototype,Le="function"==typeof Re,Ue=n.QObject,Fe=!Ue||!Ue.prototype||!Ue.prototype.findChild,Ge=s&&a(function(){return 7!=he(Oe({},"a",{get:function(){return Oe(this,"a",{value:7}).a}})).a})?function(e,t,r){var n=we(xe,t);n&&delete xe[t],Oe(e,t,r),n&&e!==xe&&Oe(xe,t,n)}:Oe,qe=function(e){var t=De[e]=he(Re.prototype);return t._k=e,t},Ve=Le&&"symbol"==typeof Re.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof Re},Be=function(e,t,r){return e===xe&&Be(je,t,r),l(e),t=v(t,!0),l(r),o(De,t)?(r.enumerable?(o(e,Pe)&&e[Pe][t]&&(e[Pe][t]=!1),r=he(r,{enumerable:y(0,!1)})):(o(e,Pe)||Oe(e,Pe,y(1,{})),e[Pe][t]=!0),Ge(e,t,r)):Oe(e,t,r)},ze=function(e,t){l(e);for(var r,n=function(e){var t=ie(e),r=oe.f;if(r)for(var n,i=r(e),o=ae.f,a=0;i.length>a;)o.call(e,n=i[a++])&&t.push(n);return t}(t=V(t)),i=0,o=n.length;o>i;)Be(e,r=n[i++],t[r]);return e},We=function(e){var t=Me.call(this,e=v(e,!0));return!(this===xe&&o(De,e)&&!o(je,e))&&(!(t||!o(this,e)||!o(De,e)||o(this,Pe)&&this[Pe][e])||t)},He=function(e,t){if(e=V(e),t=v(t,!0),e!==xe||!o(De,t)||o(je,t)){var r=we(e,t);return!r||!o(De,t)||o(e,Pe)&&e[Pe][t]||(r.enumerable=!0),r}},Ye=function(e){for(var t,r=ke(V(e)),n=[],i=0;r.length>i;)o(De,t=r[i++])||t==Pe||t==Te||n.push(t);return n},$e=function(e){for(var t,r=e===xe,n=ke(r?je:V(e)),i=[],a=0;n.length>a;)!o(De,t=n[a++])||r&&!o(xe,t)||i.push(De[t]);return i};Le||(O((Re=function(){if(this instanceof Re)throw TypeError("Symbol is not a constructor!");var e=S(arguments.length>0?arguments[0]:void 0),t=function(r){this===xe&&t.call(je,r),o(this,Pe)&&o(this[Pe],e)&&(this[Pe][e]=!1),Ge(this,e,y(1,r))};return s&&Fe&&Ge(xe,e,{configurable:!0,set:t}),qe(e)}).prototype,"toString",function(){return this._k}),Se.f=He,m.f=Be,ge.f=be.f=Ye,ae.f=We,oe.f=$e,s&&O(xe,"propertyIsEnumerable",We,!0),j.f=function(e){return qe(C(e))}),I(I.G+I.W+I.F*!Le,{Symbol:Re});for(var Xe="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Je=0;Xe.length>Je;)C(Xe[Je++]);for(var Ke=ie(C.store),Qe=0;Ke.length>Qe;)L(Ke[Qe++]);I(I.S+I.F*!Le,"Symbol",{for:function(e){return o(Ne,e+="")?Ne[e]:Ne[e]=Re(e)},keyFor:function(e){if(!Ve(e))throw TypeError(e+" is not a symbol!");for(var t in Ne)if(Ne[t]===e)return t},useSetter:function(){Fe=!0},useSimple:function(){Fe=!1}}),I(I.S+I.F*!Le,"Object",{create:function(e,t){return void 0===t?he(e):ze(he(e),t)},defineProperty:Be,defineProperties:ze,getOwnPropertyDescriptor:He,getOwnPropertyNames:Ye,getOwnPropertySymbols:$e}),Ae&&I(I.S+I.F*(!Le||a(function(){var e=Re();return"[null]"!=Ie([e])||"{}"!=Ie({a:e})||"{}"!=Ie(Object(e))})),"JSON",{stringify:function(e){for(var t,r,n=[e],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=t=n[1],(c(t)||void 0!==e)&&!Ve(e))return se(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!Ve(t))return t}),n[1]=t,Ie.apply(Ae,n)}}),Re.prototype[Ce]||_(Re.prototype,Ce,Re.prototype.valueOf),D(Re,"Symbol"),D(Math,"Math",!0),D(n.JSON,"JSON",!0),I(I.S,"Object",{create:he}),I(I.S+I.F*!s,"Object",{defineProperty:m.f}),I(I.S+I.F*!s,"Object",{defineProperties:ue});var Ze=function(e,t){var r=(u.Object||{})[e]||Object[e],n={};n[e]=t(r),I(I.S+I.F*a(function(){r(1)}),"Object",n)},et=Se.f;Ze("getOwnPropertyDescriptor",function(){return function(e,t){return et(V(e),t)}});var tt=function(e){return Object(q(e))},rt=Z("IE_PROTO"),nt=Object.prototype,it=Object.getPrototypeOf||function(e){return e=tt(e),o(e,rt)?e[rt]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?nt:null};Ze("getPrototypeOf",function(){return function(e){return it(tt(e))}}),Ze("keys",function(){return function(e){return ie(tt(e))}}),Ze("getOwnPropertyNames",function(){return be.f});var ot=P.onFreeze;Ze("freeze",function(e){return function(t){return e&&c(t)?e(ot(t)):t}});var at=P.onFreeze;Ze("seal",function(e){return function(t){return e&&c(t)?e(at(t)):t}});var st=P.onFreeze;Ze("preventExtensions",function(e){return function(t){return e&&c(t)?e(st(t)):t}}),Ze("isFrozen",function(e){return function(t){return!c(t)||!!e&&e(t)}}),Ze("isSealed",function(e){return function(t){return!c(t)||!!e&&e(t)}}),Ze("isExtensible",function(e){return function(t){return!!c(t)&&(!e||e(t))}});var ut=Object.assign,ct=!ut||a(function(){var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(e){t[e]=e}),7!=ut({},e)[r]||Object.keys(ut({},t)).join("")!=n})?function(e,t){for(var r=tt(e),n=arguments.length,i=1,o=oe.f,a=ae.f;n>i;)for(var s,u=G(arguments[i++]),c=o?ie(u).concat(o(u)):ie(u),l=c.length,f=0;l>f;)a.call(u,s=c[f++])&&(r[s]=u[s]);return r}:ut;I(I.S+I.F,"Object",{assign:ct});var lt=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t};I(I.S,"Object",{is:lt});var ft=function(e,t){if(l(e),!c(t)&&null!==t)throw TypeError(t+": can't set as prototype!")},dt={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=R(Function.call,Se.f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return ft(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:ft};I(I.S,"Object",{setPrototypeOf:dt.set});var pt=C("toStringTag"),ht="Arguments"==F(function(){return arguments}()),vt=function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),pt))?r:ht?F(t):"Object"==(n=F(t))&&"function"==typeof t.callee?"Arguments":n},gt={};gt[C("toStringTag")]="z",gt+""!="[object z]"&&O(Object.prototype,"toString",function(){return"[object "+vt(this)+"]"},!0);var mt=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)},yt=[].slice,_t={},bt=Function.bind||function(e){var t=k(this),r=yt.call(arguments,1),n=function(){var i=r.concat(yt.call(arguments));return this instanceof n?function(e,t,r){if(!(t in _t)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";_t[t]=Function("F,a","return new F("+n.join(",")+")")}return _t[t](e,r)}(t,i.length,i):mt(t,i,e)};return c(t.prototype)&&(n.prototype=t.prototype),n};I(I.P,"Function",{bind:bt});var Et=m.f,St=Function.prototype,Tt=/^\s*function ([^ (]*)/;"name"in St||s&&Et(St,"name",{configurable:!0,get:function(){try{return(""+this).match(Tt)[1]}catch(e){return""}}});var wt=C("hasInstance"),Ot=Function.prototype;wt in Ot||m.f(Ot,wt,{value:function(e){if("function"!=typeof this||!c(e))return!1;if(!c(this.prototype))return e instanceof this;for(;e=it(e);)if(this.prototype===e)return!0;return!1}});var kt="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff",Rt="["+kt+"]",At=RegExp("^"+Rt+Rt+"*"),It=RegExp(Rt+Rt+"*$"),Pt=function(e,t,r){var n={},i=a(function(){return!!kt[e]()||"​"!="​"[e]()}),o=n[e]=i?t(Ct):kt[e];r&&(n[r]=o),I(I.P+I.F*i,"String",n)},Ct=Pt.trim=function(e,t){return e=String(q(e)),1&t&&(e=e.replace(At,"")),2&t&&(e=e.replace(It,"")),e},Mt=Pt,Nt=n.parseInt,Dt=Mt.trim,jt=/^[-+]?0[xX]/,xt=8!==Nt(kt+"08")||22!==Nt(kt+"0x16")?function(e,t){var r=Dt(String(e),3);return Nt(r,t>>>0||(jt.test(r)?16:10))}:Nt;I(I.G+I.F*(parseInt!=xt),{parseInt:xt});var Lt=n.parseFloat,Ut=Mt.trim,Ft=1/Lt(kt+"-0")!=-1/0?function(e){var t=Ut(String(e),3),r=Lt(t);return 0===r&&"-"==t.charAt(0)?-0:r}:Lt;I(I.G+I.F*(parseFloat!=Ft),{parseFloat:Ft});var Gt=dt.set,qt=function(e,t,r){var n,i=t.constructor;return i!==r&&"function"==typeof i&&(n=i.prototype)!==r.prototype&&c(n)&&Gt&&Gt(e,n),e},Vt=ge.f,Bt=Se.f,zt=m.f,Wt=Mt.trim,Ht=n.Number,Yt=Ht,$t=Ht.prototype,Xt="Number"==F(he($t)),Jt="trim"in String.prototype,Kt=function(e){var t=v(e,!1);if("string"==typeof t&&t.length>2){var r,n,i,o=(t=Jt?t.trim():Wt(t,3)).charCodeAt(0);if(43===o||45===o){if(88===(r=t.charCodeAt(2))||120===r)return NaN}else if(48===o){switch(t.charCodeAt(1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+t}for(var a,s=t.slice(2),u=0,c=s.length;u<c;u++)if((a=s.charCodeAt(u))<48||a>i)return NaN;return parseInt(s,n)}}return+t};if(!Ht(" 0o1")||!Ht("0b1")||Ht("+0x1")){Ht=function(e){var t=arguments.length<1?0:e,r=this;return r instanceof Ht&&(Xt?a(function(){$t.valueOf.call(r)}):"Number"!=F(r))?qt(new Yt(Kt(t)),r,Ht):Kt(t)};for(var Qt,Zt=s?Vt(Yt):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),er=0;Zt.length>er;er++)o(Yt,Qt=Zt[er])&&!o(Ht,Qt)&&zt(Ht,Qt,Bt(Yt,Qt));Ht.prototype=$t,$t.constructor=Ht,O(n,"Number",Ht)}var tr=function(e,t){if("number"!=typeof e&&"Number"!=F(e))throw TypeError(t);return+e},rr=function(e){var t=String(q(this)),r="",n=W(e);if(n<0||n==1/0)throw RangeError("Count can't be negative");for(;n>0;(n>>>=1)&&(t+=t))1&n&&(r+=t);return r},nr=1..toFixed,ir=Math.floor,or=[0,0,0,0,0,0],ar="Number.toFixed: incorrect invocation!",sr=function(e,t){for(var r=-1,n=t;++r<6;)n+=e*or[r],or[r]=n%1e7,n=ir(n/1e7)},ur=function(e){for(var t=6,r=0;--t>=0;)r+=or[t],or[t]=ir(r/e),r=r%e*1e7},cr=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==or[e]){var r=String(or[e]);t=""===t?r:t+rr.call("0",7-r.length)+r}return t},lr=function(e,t,r){return 0===t?r:t%2==1?lr(e,t-1,r*e):lr(e*e,t/2,r)};I(I.P+I.F*(!!nr&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!a(function(){nr.call({})})),"Number",{toFixed:function(e){var t,r,n,i,o=tr(this,ar),a=W(e),s="",u="0";if(a<0||a>20)throw RangeError(ar);if(o!=o)return"NaN";if(o<=-1e21||o>=1e21)return String(o);if(o<0&&(s="-",o=-o),o>1e-21)if(r=(t=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t}(o*lr(2,69,1))-69)<0?o*lr(2,-t,1):o/lr(2,t,1),r*=4503599627370496,(t=52-t)>0){for(sr(0,r),n=a;n>=7;)sr(1e7,0),n-=7;for(sr(lr(10,n,1),0),n=t-1;n>=23;)ur(1<<23),n-=23;ur(1<<n),sr(1,1),ur(2),u=cr()}else sr(0,r),sr(1<<-t,0),u=cr()+rr.call("0",a);return u=a>0?s+((i=u.length)<=a?"0."+rr.call("0",a-i)+u:u.slice(0,i-a)+"."+u.slice(i-a)):s+u}});var fr=1..toPrecision;I(I.P+I.F*(a(function(){return"1"!==fr.call(1,void 0)})||!a(function(){fr.call({})})),"Number",{toPrecision:function(e){var t=tr(this,"Number#toPrecision: incorrect invocation!");return void 0===e?fr.call(t):fr.call(t,e)}}),I(I.S,"Number",{EPSILON:Math.pow(2,-52)});var dr=n.isFinite;I(I.S,"Number",{isFinite:function(e){return"number"==typeof e&&dr(e)}});var pr=Math.floor,hr=function(e){return!c(e)&&isFinite(e)&&pr(e)===e};I(I.S,"Number",{isInteger:hr}),I(I.S,"Number",{isNaN:function(e){return e!=e}});var vr=Math.abs;I(I.S,"Number",{isSafeInteger:function(e){return hr(e)&&vr(e)<=9007199254740991}}),I(I.S,"Number",{MAX_SAFE_INTEGER:9007199254740991}),I(I.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991}),I(I.S+I.F*(Number.parseFloat!=Ft),"Number",{parseFloat:Ft}),I(I.S+I.F*(Number.parseInt!=xt),"Number",{parseInt:xt});var gr=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)},mr=Math.sqrt,yr=Math.acosh;I(I.S+I.F*!(yr&&710==Math.floor(yr(Number.MAX_VALUE))&&yr(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?Math.log(e)+Math.LN2:gr(e-1+mr(e-1)*mr(e+1))}});var _r=Math.asinh;I(I.S+I.F*!(_r&&1/_r(0)>0),"Math",{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}});var br=Math.atanh;I(I.S+I.F*!(br&&1/br(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}});var Er=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1};I(I.S,"Math",{cbrt:function(e){return Er(e=+e)*Math.pow(Math.abs(e),1/3)}}),I(I.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}});var Sr=Math.exp;I(I.S,"Math",{cosh:function(e){return(Sr(e=+e)+Sr(-e))/2}});var Tr=Math.expm1,wr=!Tr||Tr(10)>22025.465794806718||Tr(10)<22025.465794806718||-2e-17!=Tr(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:Math.exp(e)-1}:Tr;I(I.S+I.F*(wr!=Math.expm1),"Math",{expm1:wr});var Or=Math.pow,kr=Or(2,-52),Rr=Or(2,-23),Ar=Or(2,127)*(2-Rr),Ir=Or(2,-126),Pr=Math.fround||function(e){var t,r,n=Math.abs(e),i=Er(e);return n<Ir?i*(n/Ir/Rr+1/kr-1/kr)*Ir*Rr:(r=(t=(1+Rr/kr)*n)-(t-n))>Ar||r!=r?i*(1/0):i*r};I(I.S,"Math",{fround:Pr});var Cr=Math.abs;I(I.S,"Math",{hypot:function(e,t){for(var r,n,i=0,o=0,a=arguments.length,s=0;o<a;)s<(r=Cr(arguments[o++]))?(i=i*(n=s/r)*n+1,s=r):i+=r>0?(n=r/s)*n:r;return s===1/0?1/0:s*Math.sqrt(i)}});var Mr=Math.imul;I(I.S+I.F*a(function(){return-5!=Mr(4294967295,5)||2!=Mr.length}),"Math",{imul:function(e,t){var r=+e,n=+t,i=65535&r,o=65535&n;return 0|i*o+((65535&r>>>16)*o+i*(65535&n>>>16)<<16>>>0)}}),I(I.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}}),I(I.S,"Math",{log1p:gr}),I(I.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}}),I(I.S,"Math",{sign:Er});var Nr=Math.exp;I(I.S+I.F*a(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(wr(e)-wr(-e))/2:(Nr(e-1)-Nr(-e-1))*(Math.E/2)}});var Dr=Math.exp;I(I.S,"Math",{tanh:function(e){var t=wr(e=+e),r=wr(-e);return t==1/0?1:r==1/0?-1:(t-r)/(Dr(e)+Dr(-e))}}),I(I.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}});var jr=String.fromCharCode,xr=String.fromCodePoint;I(I.S+I.F*(!!xr&&1!=xr.length),"String",{fromCodePoint:function(e){for(var t,r=[],n=arguments.length,i=0;n>i;){if(t=+arguments[i++],J(t,1114111)!==t)throw RangeError(t+" is not a valid code point");r.push(t<65536?jr(t):jr(55296+((t-=65536)>>10),t%1024+56320))}return r.join("")}}),I(I.S,"String",{raw:function(e){for(var t=V(e.raw),r=Y(t.length),n=arguments.length,i=[],o=0;r>o;)i.push(String(t[o++])),o<n&&i.push(String(arguments[o]));return i.join("")}}),Mt("trim",function(e){return function(){return e(this,3)}});var Lr=function(e){return function(t,r){var n,i,o=String(q(t)),a=W(r),s=o.length;return a<0||a>=s?e?"":void 0:(n=o.charCodeAt(a))<55296||n>56319||a+1===s||(i=o.charCodeAt(a+1))<56320||i>57343?e?o.charAt(a):n:e?o.slice(a,a+2):i-56320+(n-55296<<10)+65536}},Ur={},Fr={};_(Fr,C("iterator"),function(){return this});var Gr=function(e,t,r){e.prototype=he(Fr,{next:y(1,r)}),D(e,t+" Iterator")},qr=C("iterator"),Vr=!([].keys&&"next"in[].keys()),Br=function(){return this},zr=function(e,t,r,n,i,o,a){Gr(r,t,n);var s,u,c,l=function(e){if(!Vr&&e in h)return h[e];switch(e){case"keys":case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},f=t+" Iterator",d="values"==i,p=!1,h=e.prototype,v=h[qr]||h["@@iterator"]||i&&h[i],g=v||l(i),m=i?d?l("entries"):g:void 0,y="Array"==t&&h.entries||v;if(y&&(c=it(y.call(new e)))!==Object.prototype&&c.next&&(D(c,f,!0),"function"!=typeof c[qr]&&_(c,qr,Br)),d&&v&&"values"!==v.name&&(p=!0,g=function(){return v.call(this)}),(Vr||p||!h[qr])&&_(h,qr,g),Ur[t]=g,Ur[f]=Br,i)if(s={values:d?g:l("values"),keys:o?g:l("keys"),entries:m},a)for(u in s)u in h||O(h,u,s[u]);else I(I.P+I.F*(Vr||p),t,s);return s},Wr=Lr(!0);zr(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=Wr(t,r),this._i+=e.length,{value:e,done:!1})});var Hr=Lr(!1);I(I.P,"String",{codePointAt:function(e){return Hr(this,e)}});var Yr=C("match"),$r=function(e){var t;return c(e)&&(void 0!==(t=e[Yr])?!!t:"RegExp"==F(e))},Xr=function(e,t,r){if($r(t))throw TypeError("String#"+r+" doesn't accept regex!");return String(q(e))},Jr=C("match"),Kr=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[Jr]=!1,!"/./"[e](t)}catch(e){}}return!0},Qr="".endsWith;I(I.P+I.F*Kr("endsWith"),"String",{endsWith:function(e){var t=Xr(this,e,"endsWith"),r=arguments.length>1?arguments[1]:void 0,n=Y(t.length),i=void 0===r?n:Math.min(Y(r),n),o=String(e);return Qr?Qr.call(t,o,i):t.slice(i-o.length,i)===o}});I(I.P+I.F*Kr("includes"),"String",{includes:function(e){return!!~Xr(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}}),I(I.P,"String",{repeat:rr});var Zr="".startsWith;I(I.P+I.F*Kr("startsWith"),"String",{startsWith:function(e){var t=Xr(this,e,"startsWith"),r=Y(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),n=String(e);return Zr?Zr.call(t,n,r):t.slice(r,r+n.length)===n}});var en=/"/g,tn=function(e,t,r,n){var i=String(q(e)),o="<"+t;return""!==r&&(o+=" "+r+'="'+String(n).replace(en,"&quot;")+'"'),o+">"+i+"</"+t+">"},rn=function(e,t){var r={};r[e]=t(tn),I(I.P+I.F*a(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}),"String",r)};rn("anchor",function(e){return function(t){return e(this,"a","name",t)}}),rn("big",function(e){return function(){return e(this,"big","","")}}),rn("blink",function(e){return function(){return e(this,"blink","","")}}),rn("bold",function(e){return function(){return e(this,"b","","")}}),rn("fixed",function(e){return function(){return e(this,"tt","","")}}),rn("fontcolor",function(e){return function(t){return e(this,"font","color",t)}}),rn("fontsize",function(e){return function(t){return e(this,"font","size",t)}}),rn("italics",function(e){return function(){return e(this,"i","","")}}),rn("link",function(e){return function(t){return e(this,"a","href",t)}}),rn("small",function(e){return function(){return e(this,"small","","")}}),rn("strike",function(e){return function(){return e(this,"strike","","")}}),rn("sub",function(e){return function(){return e(this,"sub","","")}}),rn("sup",function(e){return function(){return e(this,"sup","","")}}),I(I.S,"Date",{now:function(){return(new Date).getTime()}}),I(I.P+I.F*a(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(e){var t=tt(this),r=v(t);return"number"!=typeof r||isFinite(r)?t.toISOString():null}});var nn=Date.prototype.getTime,on=Date.prototype.toISOString,an=function(e){return e>9?e:"0"+e},sn=a(function(){return"0385-07-25T07:06:39.999Z"!=on.call(new Date(-5e13-1))})||!a(function(){on.call(new Date(NaN))})?function(){if(!isFinite(nn.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),r=e.getUTCMilliseconds(),n=t<0?"-":t>9999?"+":"";return n+("00000"+Math.abs(t)).slice(n?-6:-4)+"-"+an(e.getUTCMonth()+1)+"-"+an(e.getUTCDate())+"T"+an(e.getUTCHours())+":"+an(e.getUTCMinutes())+":"+an(e.getUTCSeconds())+"."+(r>99?r:"0"+an(r))+"Z"}:on;I(I.P+I.F*(Date.prototype.toISOString!==sn),"Date",{toISOString:sn});var un=Date.prototype,cn=un.toString,ln=un.getTime;new Date(NaN)+""!="Invalid Date"&&O(un,"toString",function(){var e=ln.call(this);return e==e?cn.call(this):"Invalid Date"});var fn=C("toPrimitive"),dn=Date.prototype;fn in dn||_(dn,fn,function(e){if("string"!==e&&"number"!==e&&"default"!==e)throw TypeError("Incorrect hint");return v(l(this),"number"!=e)}),I(I.S,"Array",{isArray:se});var pn=function(e,t,r,n){try{return n?t(l(r)[0],r[1]):t(r)}catch(t){var i=e.return;throw void 0!==i&&l(i.call(e)),t}},hn=C("iterator"),vn=Array.prototype,gn=function(e){return void 0!==e&&(Ur.Array===e||vn[hn]===e)},mn=function(e,t,r){t in e?m.f(e,t,y(0,r)):e[t]=r},yn=C("iterator"),_n=u.getIteratorMethod=function(e){if(null!=e)return e[yn]||e["@@iterator"]||Ur[vt(e)]},bn=C("iterator"),En=!1;try{[7][bn]().return=function(){En=!0}}catch(e){}var Sn=function(e,t){if(!t&&!En)return!1;var r=!1;try{var n=[7],i=n[bn]();i.next=function(){return{done:r=!0}},n[bn]=function(){return i},e(n)}catch(e){}return r};I(I.S+I.F*!Sn(function(e){}),"Array",{from:function(e){var t,r,n,i,o=tt(e),a="function"==typeof this?this:Array,s=arguments.length,u=s>1?arguments[1]:void 0,c=void 0!==u,l=0,f=_n(o);if(c&&(u=R(u,s>2?arguments[2]:void 0,2)),null==f||a==Array&&gn(f))for(r=new a(t=Y(o.length));t>l;l++)mn(r,l,c?u(o[l],l):o[l]);else for(i=f.call(o),r=new a;!(n=i.next()).done;l++)mn(r,l,c?pn(i,u,[n.value,l],!0):n.value);return r.length=l,r}}),I(I.S+I.F*a(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function(){for(var e=0,t=arguments.length,r=new("function"==typeof this?this:Array)(t);t>e;)mn(r,e,arguments[e++]);return r.length=t,r}});var Tn=function(e,t){return!!e&&a(function(){t?e.call(null,function(){},1):e.call(null)})},wn=[].join;I(I.P+I.F*(G!=Object||!Tn(wn)),"Array",{join:function(e){return wn.call(V(this),void 0===e?",":e)}});var On=[].slice;I(I.P+I.F*a(function(){le&&On.call(le)}),"Array",{slice:function(e,t){var r=Y(this.length),n=F(this);if(t=void 0===t?r:t,"Array"==n)return On.call(this,e,t);for(var i=J(e,r),o=J(t,r),a=Y(o-i),s=new Array(a),u=0;u<a;u++)s[u]="String"==n?this.charAt(i+u):this[i+u];return s}});var kn=[].sort,Rn=[1,2,3];I(I.P+I.F*(a(function(){Rn.sort(void 0)})||!a(function(){Rn.sort(null)})||!Tn(kn)),"Array",{sort:function(e){return void 0===e?kn.call(tt(this)):kn.call(tt(this),k(e))}});var An=C("species"),In=function(e,t){return new(function(e){var t;return se(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!se(t.prototype)||(t=void 0),c(t)&&null===(t=t[An])&&(t=void 0)),void 0===t?Array:t}(e))(t)},Pn=function(e,t){var r=1==e,n=2==e,i=3==e,o=4==e,a=6==e,s=5==e||a,u=t||In;return function(t,c,l){for(var f,d,p=tt(t),h=G(p),v=R(c,l,3),g=Y(h.length),m=0,y=r?u(t,g):n?u(t,0):void 0;g>m;m++)if((s||m in h)&&(d=v(f=h[m],m,p),e))if(r)y[m]=d;else if(d)switch(e){case 3:return!0;case 5:return f;case 6:return m;case 2:y.push(f)}else if(o)return!1;return a?-1:i||o?o:y}},Cn=Pn(0),Mn=Tn([].forEach,!0);I(I.P+I.F*!Mn,"Array",{forEach:function(e){return Cn(this,e,arguments[1])}});var Nn=Pn(1);I(I.P+I.F*!Tn([].map,!0),"Array",{map:function(e){return Nn(this,e,arguments[1])}});var Dn=Pn(2);I(I.P+I.F*!Tn([].filter,!0),"Array",{filter:function(e){return Dn(this,e,arguments[1])}});var jn=Pn(3);I(I.P+I.F*!Tn([].some,!0),"Array",{some:function(e){return jn(this,e,arguments[1])}});var xn=Pn(4);I(I.P+I.F*!Tn([].every,!0),"Array",{every:function(e){return xn(this,e,arguments[1])}});var Ln=function(e,t,r,n,i){k(t);var o=tt(e),a=G(o),s=Y(o.length),u=i?s-1:0,c=i?-1:1;if(r<2)for(;;){if(u in a){n=a[u],u+=c;break}if(u+=c,i?u<0:s<=u)throw TypeError("Reduce of empty array with no initial value")}for(;i?u>=0:s>u;u+=c)u in a&&(n=t(n,a[u],u,o));return n};I(I.P+I.F*!Tn([].reduce,!0),"Array",{reduce:function(e){return Ln(this,e,arguments.length,arguments[1],!1)}}),I(I.P+I.F*!Tn([].reduceRight,!0),"Array",{reduceRight:function(e){return Ln(this,e,arguments.length,arguments[1],!0)}});var Un=K(!1),Fn=[].indexOf,Gn=!!Fn&&1/[1].indexOf(1,-0)<0;I(I.P+I.F*(Gn||!Tn(Fn)),"Array",{indexOf:function(e){return Gn?Fn.apply(this,arguments)||0:Un(this,e,arguments[1])}});var qn=[].lastIndexOf,Vn=!!qn&&1/[1].lastIndexOf(1,-0)<0;I(I.P+I.F*(Vn||!Tn(qn)),"Array",{lastIndexOf:function(e){if(Vn)return qn.apply(this,arguments)||0;var t=V(this),r=Y(t.length),n=r-1;for(arguments.length>1&&(n=Math.min(n,W(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in t&&t[n]===e)return n||0;return-1}});var Bn=[].copyWithin||function(e,t){var r=tt(this),n=Y(r.length),i=J(e,n),o=J(t,n),a=arguments.length>2?arguments[2]:void 0,s=Math.min((void 0===a?n:J(a,n))-o,n-i),u=1;for(o<i&&i<o+s&&(u=-1,o+=s-1,i+=s-1);s-- >0;)o in r?r[i]=r[o]:delete r[i],i+=u,o+=u;return r},zn=C("unscopables"),Wn=Array.prototype;null==Wn[zn]&&_(Wn,zn,{});var Hn=function(e){Wn[zn][e]=!0};I(I.P,"Array",{copyWithin:Bn}),Hn("copyWithin");var Yn=function(e){for(var t=tt(this),r=Y(t.length),n=arguments.length,i=J(n>1?arguments[1]:void 0,r),o=n>2?arguments[2]:void 0,a=void 0===o?r:J(o,r);a>i;)t[i++]=e;return t};I(I.P,"Array",{fill:Yn}),Hn("fill");var $n=Pn(5),Xn=!0;"find"in[]&&Array(1).find(function(){Xn=!1}),I(I.P+I.F*Xn,"Array",{find:function(e){return $n(this,e,arguments.length>1?arguments[1]:void 0)}}),Hn("find");var Jn=Pn(6),Kn=!0;"findIndex"in[]&&Array(1).findIndex(function(){Kn=!1}),I(I.P+I.F*Kn,"Array",{findIndex:function(e){return Jn(this,e,arguments.length>1?arguments[1]:void 0)}}),Hn("findIndex");var Qn=C("species"),Zn=function(e){var t=n[e];s&&t&&!t[Qn]&&m.f(t,Qn,{configurable:!0,get:function(){return this}})};Zn("Array");var ei=function(e,t){return{value:t,done:!!e}},ti=zr(Array,"Array",function(e,t){this._t=V(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,ei(1)):ei(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])},"values");Ur.Arguments=Ur.Array,Hn("keys"),Hn("values"),Hn("entries");var ri=function(){var e=l(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},ni=m.f,ii=ge.f,oi=n.RegExp,ai=oi,si=oi.prototype,ui=/a/g,ci=/a/g,li=new oi(ui)!==ui;if(s&&(!li||a(function(){return ci[C("match")]=!1,oi(ui)!=ui||oi(ci)==ci||"/a/i"!=oi(ui,"i")}))){oi=function(e,t){var r=this instanceof oi,n=$r(e),i=void 0===t;return!r&&n&&e.constructor===oi&&i?e:qt(li?new ai(n&&!i?e.source:e,t):ai((n=e instanceof oi)?e.source:e,n&&i?ri.call(e):t),r?this:si,oi)};for(var fi=function(e){e in oi||ni(oi,e,{configurable:!0,get:function(){return ai[e]},set:function(t){ai[e]=t}})},di=ii(ai),pi=0;di.length>pi;)fi(di[pi++]);si.constructor=oi,oi.prototype=si,O(n,"RegExp",oi)}Zn("RegExp");var hi=RegExp.prototype.exec,vi=String.prototype.replace,gi=hi,mi=function(){var e=/a/,t=/b*/g;return hi.call(e,"a"),hi.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),yi=void 0!==/()??/.exec("")[1];(mi||yi)&&(gi=function(e){var t,r,n,i,o=this;return yi&&(r=new RegExp("^"+o.source+"$(?!\\s)",ri.call(o))),mi&&(t=o.lastIndex),n=hi.call(o,e),mi&&n&&(o.lastIndex=o.global?n.index+n[0].length:t),yi&&n&&n.length>1&&vi.call(n[0],r,function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(n[i]=void 0)}),n});var _i=gi;I({target:"RegExp",proto:!0,forced:_i!==/./.exec},{exec:_i}),s&&"g"!=/./g.flags&&m.f(RegExp.prototype,"flags",{configurable:!0,get:ri});var bi=/./.toString,Ei=function(e){O(RegExp.prototype,"toString",e,!0)};a(function(){return"/a/b"!=bi.call({source:"a",flags:"b"})})?Ei(function(){var e=l(this);return"/".concat(e.source,"/","flags"in e?e.flags:!s&&e instanceof RegExp?ri.call(e):void 0)}):"toString"!=bi.name&&Ei(function(){return bi.call(this)});var Si=Lr(!0),Ti=function(e,t,r){return t+(r?Si(e,t).length:1)},wi=RegExp.prototype.exec,Oi=function(e,t){var r=e.exec;if("function"==typeof r){var n=r.call(e,t);if("object"!=typeof n)throw new TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==vt(e))throw new TypeError("RegExp#exec called on incompatible receiver");return wi.call(e,t)},ki=C("species"),Ri=!a(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}),Ai=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2===r.length&&"a"===r[0]&&"b"===r[1]}(),Ii=function(e,t,r){var n=C(e),i=!a(function(){var t={};return t[n]=function(){return 7},7!=""[e](t)}),o=i?!a(function(){var t=!1,r=/a/;return r.exec=function(){return t=!0,null},"split"===e&&(r.constructor={},r.constructor[ki]=function(){return r}),r[n](""),!t}):void 0;if(!i||!o||"replace"===e&&!Ri||"split"===e&&!Ai){var s=/./[n],u=r(q,n,""[e],function(e,t,r,n,o){return t.exec===_i?i&&!o?{done:!0,value:s.call(t,r,n)}:{done:!0,value:e.call(r,t,n)}:{done:!1}}),c=u[0],l=u[1];O(String.prototype,e,c),_(RegExp.prototype,n,2==t?function(e,t){return l.call(e,this,t)}:function(e){return l.call(e,this)})}};Ii("match",1,function(e,t,r,n){return[function(r){var n=e(this),i=null==r?void 0:r[t];return void 0!==i?i.call(r,n):new RegExp(r)[t](String(n))},function(e){var t=n(r,e,this);if(t.done)return t.value;var i=l(e),o=String(this);if(!i.global)return Oi(i,o);var a=i.unicode;i.lastIndex=0;for(var s,u=[],c=0;null!==(s=Oi(i,o));){var f=String(s[0]);u[c]=f,""===f&&(i.lastIndex=Ti(o,Y(i.lastIndex),a)),c++}return 0===c?null:u}]});var Pi=Math.max,Ci=Math.min,Mi=Math.floor,Ni=/\$([$&`']|\d\d?|<[^>]*>)/g,Di=/\$([$&`']|\d\d?)/g;Ii("replace",2,function(e,t,r,n){return[function(n,i){var o=e(this),a=null==n?void 0:n[t];return void 0!==a?a.call(n,o,i):r.call(String(o),n,i)},function(e,t){var o=n(r,e,this,t);if(o.done)return o.value;var a=l(e),s=String(this),u="function"==typeof t;u||(t=String(t));var c=a.global;if(c){var f=a.unicode;a.lastIndex=0}for(var d=[];;){var p=Oi(a,s);if(null===p)break;if(d.push(p),!c)break;""===String(p[0])&&(a.lastIndex=Ti(s,Y(a.lastIndex),f))}for(var h,v="",g=0,m=0;m<d.length;m++){p=d[m];for(var y=String(p[0]),_=Pi(Ci(W(p.index),s.length),0),b=[],E=1;E<p.length;E++)b.push(void 0===(h=p[E])?h:String(h));var S=p.groups;if(u){var T=[y].concat(b,_,s);void 0!==S&&T.push(S);var w=String(t.apply(void 0,T))}else w=i(y,s,_,b,S,t);_>=g&&(v+=s.slice(g,_)+w,g=_+y.length)}return v+s.slice(g)}];function i(e,t,n,i,o,a){var s=n+e.length,u=i.length,c=Di;return void 0!==o&&(o=tt(o),c=Ni),r.call(a,c,function(r,a){var c;switch(a.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,n);case"'":return t.slice(s);case"<":c=o[a.slice(1,-1)];break;default:var l=+a;if(0===l)return r;if(l>u){var f=Mi(l/10);return 0===f?r:f<=u?void 0===i[f-1]?a.charAt(1):i[f-1]+a.charAt(1):r}c=i[l-1]}return void 0===c?"":c})}}),Ii("search",1,function(e,t,r,n){return[function(r){var n=e(this),i=null==r?void 0:r[t];return void 0!==i?i.call(r,n):new RegExp(r)[t](String(n))},function(e){var t=n(r,e,this);if(t.done)return t.value;var i=l(e),o=String(this),a=i.lastIndex;lt(a,0)||(i.lastIndex=0);var s=Oi(i,o);return lt(i.lastIndex,a)||(i.lastIndex=a),null===s?-1:s.index}]});var ji=C("species"),xi=function(e,t){var r,n=l(e).constructor;return void 0===n||null==(r=l(n)[ji])?t:k(r)},Li=Math.min,Ui=[].push,Fi=!a(function(){});Ii("split",2,function(e,t,r,n){var i;return i="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,t){var n=String(this);if(void 0===e&&0===t)return[];if(!$r(e))return r.call(n,e,t);for(var i,o,a,s=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),c=0,l=void 0===t?4294967295:t>>>0,f=new RegExp(e.source,u+"g");(i=_i.call(f,n))&&!((o=f.lastIndex)>c&&(s.push(n.slice(c,i.index)),i.length>1&&i.index<n.length&&Ui.apply(s,i.slice(1)),a=i[0].length,c=o,s.length>=l));)f.lastIndex===i.index&&f.lastIndex++;return c===n.length?!a&&f.test("")||s.push(""):s.push(n.slice(c)),s.length>l?s.slice(0,l):s}:"0".split(void 0,0).length?function(e,t){return void 0===e&&0===t?[]:r.call(this,e,t)}:r,[function(r,n){var o=e(this),a=null==r?void 0:r[t];return void 0!==a?a.call(r,o,n):i.call(String(o),r,n)},function(e,t){var o=n(i,e,this,t,i!==r);if(o.done)return o.value;var a=l(e),s=String(this),u=xi(a,RegExp),c=a.unicode,f=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(Fi?"y":"g"),d=new u(Fi?a:"^(?:"+a.source+")",f),p=void 0===t?4294967295:t>>>0;if(0===p)return[];if(0===s.length)return null===Oi(d,s)?[s]:[];for(var h=0,v=0,g=[];v<s.length;){d.lastIndex=Fi?v:0;var m,y=Oi(d,Fi?s:s.slice(v));if(null===y||(m=Li(Y(d.lastIndex+(Fi?0:v)),s.length))===h)v=Ti(s,v,c);else{if(g.push(s.slice(h,v)),g.length===p)return g;for(var _=1;_<=y.length-1;_++)if(g.push(y[_]),g.length===p)return g;v=h=m}}return g.push(s.slice(h)),g}]});var Gi,qi,Vi,Bi=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e},zi=r(function(e){var t={},r={},n=e.exports=function(e,n,i,o,a){var s,u,c,f,d=a?function(){return e}:_n(e),p=R(i,o,n?2:1),h=0;if("function"!=typeof d)throw TypeError(e+" is not iterable!");if(gn(d)){for(s=Y(e.length);s>h;h++)if((f=n?p(l(u=e[h])[0],u[1]):p(e[h]))===t||f===r)return f}else for(c=d.call(e);!(u=c.next()).done;)if((f=pn(c,p,u.value,n))===t||f===r)return f};n.BREAK=t,n.RETURN=r}),Wi=n.process,Hi=n.setImmediate,Yi=n.clearImmediate,$i=n.MessageChannel,Xi=n.Dispatch,Ji=0,Ki={},Qi=function(){var e=+this;if(Ki.hasOwnProperty(e)){var t=Ki[e];delete Ki[e],t()}},Zi=function(e){Qi.call(e.data)};Hi&&Yi||(Hi=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return Ki[++Ji]=function(){mt("function"==typeof e?e:Function(e),t)},Gi(Ji),Ji},Yi=function(e){delete Ki[e]},"process"==F(Wi)?Gi=function(e){Wi.nextTick(R(Qi,e,1))}:Xi&&Xi.now?Gi=function(e){Xi.now(R(Qi,e,1))}:$i?(Vi=(qi=new $i).port2,qi.port1.onmessage=Zi,Gi=R(Vi.postMessage,Vi,1)):n.addEventListener&&"function"==typeof postMessage&&!n.importScripts?(Gi=function(e){n.postMessage(e+"","*")},n.addEventListener("message",Zi,!1)):Gi="onreadystatechange"in p("script")?function(e){le.appendChild(p("script")).onreadystatechange=function(){le.removeChild(this),Qi.call(e)}}:function(e){setTimeout(R(Qi,e,1),0)});var eo={set:Hi,clear:Yi},to=eo.set,ro=n.MutationObserver||n.WebKitMutationObserver,no=n.process,io=n.Promise,oo="process"==F(no),ao=function(){var e,t,r,i=function(){var n,i;for(oo&&(n=no.domain)&&n.exit();e;){i=e.fn,e=e.next;try{i()}catch(n){throw e?r():t=void 0,n}}t=void 0,n&&n.enter()};if(oo)r=function(){no.nextTick(i)};else if(!ro||n.navigator&&n.navigator.standalone)if(io&&io.resolve){var o=io.resolve(void 0);r=function(){o.then(i)}}else r=function(){to.call(n,i)};else{var a=!0,s=document.createTextNode("");new ro(i).observe(s,{characterData:!0}),r=function(){s.data=a=!a}}return function(n){var i={fn:n,next:void 0};t&&(t.next=i),e||(e=i,r()),t=i}};function so(e){var t,r;this.promise=new e(function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n}),this.resolve=k(t),this.reject=k(r)}var uo,co,lo,fo,po={f:function(e){return new so(e)}},ho=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}},vo=n.navigator,go=vo&&vo.userAgent||"",mo=function(e,t){if(l(e),c(t)&&t.constructor===e)return t;var r=po.f(e);return(0,r.resolve)(t),r.promise},yo=function(e,t,r){for(var n in t)O(e,n,t[n],r);return e},_o=eo.set,bo=ao(),Eo=n.TypeError,So=n.process,To=So&&So.versions,wo=To&&To.v8||"",Oo=n.Promise,ko="process"==vt(So),Ro=function(){},Ao=co=po.f,Io=!!function(){try{var e=Oo.resolve(1),t=(e.constructor={})[C("species")]=function(e){e(Ro,Ro)};return(ko||"function"==typeof PromiseRejectionEvent)&&e.then(Ro)instanceof t&&0!==wo.indexOf("6.6")&&-1===go.indexOf("Chrome/66")}catch(e){}}(),Po=function(e){var t;return!(!c(e)||"function"!=typeof(t=e.then))&&t},Co=function(e,t){if(!e._n){e._n=!0;var r=e._c;bo(function(){for(var n=e._v,i=1==e._s,o=0,a=function(t){var r,o,a,s=i?t.ok:t.fail,u=t.resolve,c=t.reject,l=t.domain;try{s?(i||(2==e._h&&Do(e),e._h=1),!0===s?r=n:(l&&l.enter(),r=s(n),l&&(l.exit(),a=!0)),r===t.promise?c(Eo("Promise-chain cycle")):(o=Po(r))?o.call(r,u,c):u(r)):c(n)}catch(e){l&&!a&&l.exit(),c(e)}};r.length>o;)a(r[o++]);e._c=[],e._n=!1,t&&!e._h&&Mo(e)})}},Mo=function(e){_o.call(n,function(){var t,r,i,o=e._v,a=No(e);if(a&&(t=ho(function(){ko?So.emit("unhandledRejection",o,e):(r=n.onunhandledrejection)?r({promise:e,reason:o}):(i=n.console)&&i.error&&i.error("Unhandled promise rejection",o)}),e._h=ko||No(e)?2:1),e._a=void 0,a&&t.e)throw t.v})},No=function(e){return 1!==e._h&&0===(e._a||e._c).length},Do=function(e){_o.call(n,function(){var t;ko?So.emit("rejectionHandled",e):(t=n.onrejectionhandled)&&t({promise:e,reason:e._v})})},jo=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),Co(t,!0))},xo=function(e){var t,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw Eo("Promise can't be resolved itself");(t=Po(e))?bo(function(){var n={_w:r,_d:!1};try{t.call(e,R(xo,n,1),R(jo,n,1))}catch(e){jo.call(n,e)}}):(r._v=e,r._s=1,Co(r,!1))}catch(e){jo.call({_w:r,_d:!1},e)}}};Io||(Oo=function(e){Bi(this,Oo,"Promise","_h"),k(e),uo.call(this);try{e(R(xo,this,1),R(jo,this,1))}catch(e){jo.call(this,e)}},(uo=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=yo(Oo.prototype,{then:function(e,t){var r=Ao(xi(this,Oo));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=ko?So.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&Co(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),lo=function(){var e=new uo;this.promise=e,this.resolve=R(xo,e,1),this.reject=R(jo,e,1)},po.f=Ao=function(e){return e===Oo||e===fo?new lo(e):co(e)}),I(I.G+I.W+I.F*!Io,{Promise:Oo}),D(Oo,"Promise"),Zn("Promise"),fo=u.Promise,I(I.S+I.F*!Io,"Promise",{reject:function(e){var t=Ao(this);return(0,t.reject)(e),t.promise}}),I(I.S+I.F*!Io,"Promise",{resolve:function(e){return mo(this,e)}}),I(I.S+I.F*!(Io&&Sn(function(e){Oo.all(e).catch(Ro)})),"Promise",{all:function(e){var t=this,r=Ao(t),n=r.resolve,i=r.reject,o=ho(function(){var r=[],o=0,a=1;zi(e,!1,function(e){var s=o++,u=!1;r.push(void 0),a++,t.resolve(e).then(function(e){u||(u=!0,r[s]=e,--a||n(r))},i)}),--a||n(r)});return o.e&&i(o.v),r.promise},race:function(e){var t=this,r=Ao(t),n=r.reject,i=ho(function(){zi(e,!1,function(e){t.resolve(e).then(r.resolve,n)})});return i.e&&n(i.v),r.promise}});var Lo=function(e,t){if(!c(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e},Uo=m.f,Fo=P.fastKey,Go=s?"_s":"size",qo=function(e,t){var r,n=Fo(t);if("F"!==n)return e._i[n];for(r=e._f;r;r=r.n)if(r.k==t)return r},Vo={getConstructor:function(e,t,r,n){var i=e(function(e,o){Bi(e,i,t,"_i"),e._t=t,e._i=he(null),e._f=void 0,e._l=void 0,e[Go]=0,null!=o&&zi(o,r,e[n],e)});return yo(i.prototype,{clear:function(){for(var e=Lo(this,t),r=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];e._f=e._l=void 0,e[Go]=0},delete:function(e){var r=Lo(this,t),n=qo(r,e);if(n){var i=n.n,o=n.p;delete r._i[n.i],n.r=!0,o&&(o.n=i),i&&(i.p=o),r._f==n&&(r._f=i),r._l==n&&(r._l=o),r[Go]--}return!!n},forEach:function(e){Lo(this,t);for(var r,n=R(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!qo(Lo(this,t),e)}}),s&&Uo(i.prototype,"size",{get:function(){return Lo(this,t)[Go]}}),i},def:function(e,t,r){var n,i,o=qo(e,t);return o?o.v=r:(e._l=o={i:i=Fo(t,!0),k:t,v:r,p:n=e._l,n:void 0,r:!1},e._f||(e._f=o),n&&(n.n=o),e[Go]++,"F"!==i&&(e._i[i]=o)),e},getEntry:qo,setStrong:function(e,t,r){zr(e,t,function(e,r){this._t=Lo(e,t),this._k=r,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?ei(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,ei(1))},r?"entries":"values",!r,!0),Zn(t)}},Bo=function(e,t,r,i,o,s){var u=n[e],l=u,f=o?"set":"add",d=l&&l.prototype,p={},h=function(e){var t=d[e];O(d,e,"delete"==e?function(e){return!(s&&!c(e))&&t.call(this,0===e?0:e)}:"has"==e?function(e){return!(s&&!c(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return s&&!c(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,r){return t.call(this,0===e?0:e,r),this})};if("function"==typeof l&&(s||d.forEach&&!a(function(){(new l).entries().next()}))){var v=new l,g=v[f](s?{}:-0,1)!=v,m=a(function(){v.has(1)}),y=Sn(function(e){new l(e)}),_=!s&&a(function(){for(var e=new l,t=5;t--;)e[f](t,t);return!e.has(-0)});y||((l=t(function(t,r){Bi(t,l,e);var n=qt(new u,t,l);return null!=r&&zi(r,o,n[f],n),n})).prototype=d,d.constructor=l),(m||_)&&(h("delete"),h("has"),o&&h("get")),(_||g)&&h(f),s&&d.clear&&delete d.clear}else l=i.getConstructor(t,e,o,f),yo(l.prototype,r),P.NEED=!0;return D(l,e),p[e]=l,I(I.G+I.W+I.F*(l!=u),p),s||i.setStrong(l,e,o),l},zo=Bo("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=Vo.getEntry(Lo(this,"Map"),e);return t&&t.v},set:function(e,t){return Vo.def(Lo(this,"Map"),0===e?0:e,t)}},Vo,!0),Wo=Bo("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return Vo.def(Lo(this,"Set"),e=0===e?0:e,e)}},Vo),Ho=P.getWeak,Yo=Pn(5),$o=Pn(6),Xo=0,Jo=function(e){return e._l||(e._l=new Ko)},Ko=function(){this.a=[]},Qo=function(e,t){return Yo(e.a,function(e){return e[0]===t})};Ko.prototype={get:function(e){var t=Qo(this,e);if(t)return t[1]},has:function(e){return!!Qo(this,e)},set:function(e,t){var r=Qo(this,e);r?r[1]=t:this.a.push([e,t])},delete:function(e){var t=$o(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}};var Zo={getConstructor:function(e,t,r,n){var i=e(function(e,o){Bi(e,i,t,"_i"),e._t=t,e._i=Xo++,e._l=void 0,null!=o&&zi(o,r,e[n],e)});return yo(i.prototype,{delete:function(e){if(!c(e))return!1;var r=Ho(e);return!0===r?Jo(Lo(this,t)).delete(e):r&&o(r,this._i)&&delete r[this._i]},has:function(e){if(!c(e))return!1;var r=Ho(e);return!0===r?Jo(Lo(this,t)).has(e):r&&o(r,this._i)}}),i},def:function(e,t,r){var n=Ho(l(t),!0);return!0===n?Jo(e).set(t,r):n[e._i]=r,e},ufstore:Jo},ea=r(function(e){var t,r=Pn(0),i=Lo,o=!n.ActiveXObject&&"ActiveXObject"in n,a=P.getWeak,s=Object.isExtensible,u=Zo.ufstore,l=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},f={get:function(e){if(c(e)){var t=a(e);return!0===t?u(Lo(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return Zo.def(Lo(this,"WeakMap"),e,t)}},d=e.exports=Bo("WeakMap",l,f,Zo,!0,!0);i&&o&&(t=Zo.getConstructor(l,"WeakMap"),ct(t.prototype,f),P.NEED=!0,r(["delete","has","get","set"],function(e){var r=d.prototype,n=r[e];O(r,e,function(r,i){if(c(r)&&!s(r)){this._f||(this._f=new t);var o=this._f[e](r,i);return"set"==e?this:o}return n.call(this,r,i)})}))});Bo("WeakSet",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return Zo.def(Lo(this,"WeakSet"),e,!0)}},Zo,!1,!0);for(var ta,ra=S("typed_array"),na=S("view"),ia=!(!n.ArrayBuffer||!n.DataView),oa=ia,aa=0,sa="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");aa<9;)(ta=n[sa[aa++]])?(_(ta.prototype,ra,!0),_(ta.prototype,na,!0)):oa=!1;var ua={ABV:ia,CONSTR:oa,TYPED:ra,VIEW:na},ca=function(e){if(void 0===e)return 0;var t=W(e),r=Y(t);if(t!==r)throw RangeError("Wrong length!");return r},la=r(function(e,t){var r=ge.f,i=m.f,o="prototype",u="Wrong index!",c=n.ArrayBuffer,l=n.DataView,f=n.Math,d=n.RangeError,p=n.Infinity,h=c,v=f.abs,g=f.pow,y=f.floor,b=f.log,E=f.LN2,S=s?"_b":"buffer",T=s?"_l":"byteLength",w=s?"_o":"byteOffset";function O(e,t,r){var n,i,o,a=new Array(r),s=8*r-t-1,u=(1<<s)-1,c=u>>1,l=23===t?g(2,-24)-g(2,-77):0,f=0,d=e<0||0===e&&1/e<0?1:0;for((e=v(e))!=e||e===p?(i=e!=e?1:0,n=u):(n=y(b(e)/E),e*(o=g(2,-n))<1&&(n--,o*=2),(e+=n+c>=1?l/o:l*g(2,1-c))*o>=2&&(n++,o/=2),n+c>=u?(i=0,n=u):n+c>=1?(i=(e*o-1)*g(2,t),n+=c):(i=e*g(2,c-1)*g(2,t),n=0));t>=8;a[f++]=255&i,i/=256,t-=8);for(n=n<<t|i,s+=t;s>0;a[f++]=255&n,n/=256,s-=8);return a[--f]|=128*d,a}function k(e,t,r){var n,i=8*r-t-1,o=(1<<i)-1,a=o>>1,s=i-7,u=r-1,c=e[u--],l=127&c;for(c>>=7;s>0;l=256*l+e[u],u--,s-=8);for(n=l&(1<<-s)-1,l>>=-s,s+=t;s>0;n=256*n+e[u],u--,s-=8);if(0===l)l=1-a;else{if(l===o)return n?NaN:c?-p:p;n+=g(2,t),l-=a}return(c?-1:1)*n*g(2,l-t)}function R(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function A(e){return[255&e]}function I(e){return[255&e,e>>8&255]}function P(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function C(e){return O(e,52,8)}function M(e){return O(e,23,4)}function N(e,t,r){i(e[o],t,{get:function(){return this[r]}})}function j(e,t,r,n){var i=ca(+r);if(i+t>e[T])throw d(u);var o=e[S]._b,a=i+e[w],s=o.slice(a,a+t);return n?s:s.reverse()}function x(e,t,r,n,i,o){var a=ca(+r);if(a+t>e[T])throw d(u);for(var s=e[S]._b,c=a+e[w],l=n(+i),f=0;f<t;f++)s[c+f]=l[o?f:t-f-1]}if(ua.ABV){if(!a(function(){c(1)})||!a(function(){new c(-1)})||a(function(){return new c,new c(1.5),new c(NaN),"ArrayBuffer"!=c.name})){for(var L,U=(c=function(e){return Bi(this,c),new h(ca(e))})[o]=h[o],F=r(h),G=0;F.length>G;)(L=F[G++])in c||_(c,L,h[L]);U.constructor=c}var q=new l(new c(2)),V=l[o].setInt8;q.setInt8(0,2147483648),q.setInt8(1,2147483649),!q.getInt8(0)&&q.getInt8(1)||yo(l[o],{setInt8:function(e,t){V.call(this,e,t<<24>>24)},setUint8:function(e,t){V.call(this,e,t<<24>>24)}},!0)}else c=function(e){Bi(this,c,"ArrayBuffer");var t=ca(e);this._b=Yn.call(new Array(t),0),this[T]=t},l=function(e,t,r){Bi(this,l,"DataView"),Bi(e,c,"DataView");var n=e[T],i=W(t);if(i<0||i>n)throw d("Wrong offset!");if(i+(r=void 0===r?n-i:Y(r))>n)throw d("Wrong length!");this[S]=e,this[w]=i,this[T]=r},s&&(N(c,"byteLength","_l"),N(l,"buffer","_b"),N(l,"byteLength","_l"),N(l,"byteOffset","_o")),yo(l[o],{getInt8:function(e){return j(this,1,e)[0]<<24>>24},getUint8:function(e){return j(this,1,e)[0]},getInt16:function(e){var t=j(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=j(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return R(j(this,4,e,arguments[1]))},getUint32:function(e){return R(j(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return k(j(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return k(j(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){x(this,1,e,A,t)},setUint8:function(e,t){x(this,1,e,A,t)},setInt16:function(e,t){x(this,2,e,I,t,arguments[2])},setUint16:function(e,t){x(this,2,e,I,t,arguments[2])},setInt32:function(e,t){x(this,4,e,P,t,arguments[2])},setUint32:function(e,t){x(this,4,e,P,t,arguments[2])},setFloat32:function(e,t){x(this,4,e,M,t,arguments[2])},setFloat64:function(e,t){x(this,8,e,C,t,arguments[2])}});D(c,"ArrayBuffer"),D(l,"DataView"),_(l[o],ua.VIEW,!0),t.ArrayBuffer=c,t.DataView=l}),fa=n.ArrayBuffer,da=la.ArrayBuffer,pa=la.DataView,ha=ua.ABV&&fa.isView,va=da.prototype.slice,ga=ua.VIEW;I(I.G+I.W+I.F*(fa!==da),{ArrayBuffer:da}),I(I.S+I.F*!ua.CONSTR,"ArrayBuffer",{isView:function(e){return ha&&ha(e)||c(e)&&ga in e}}),I(I.P+I.U+I.F*a(function(){return!new da(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(e,t){if(void 0!==va&&void 0===t)return va.call(l(this),e);for(var r=l(this).byteLength,n=J(e,r),i=J(void 0===t?r:t,r),o=new(xi(this,da))(Y(i-n)),a=new pa(this),s=new pa(o),u=0;n<i;)s.setUint8(u++,a.getUint8(n++));return o}}),Zn("ArrayBuffer"),I(I.G+I.W+I.F*!ua.ABV,{DataView:la.DataView});var ma=r(function(e){if(s){var t=n,r=a,i=I,u=ua,l=la,f=R,d=Bi,p=y,h=_,g=yo,b=W,E=Y,T=ca,w=J,O=v,k=o,A=vt,P=c,M=tt,N=gn,D=he,j=it,x=ge.f,L=_n,U=S,F=C,G=Pn,q=K,V=xi,B=ti,z=Ur,H=Sn,$=Zn,X=Yn,Q=Bn,Z=m,ee=Se,te=Z.f,re=ee.f,ne=t.RangeError,ie=t.TypeError,oe=t.Uint8Array,ae=Array.prototype,se=l.ArrayBuffer,ue=l.DataView,ce=G(0),le=G(2),fe=G(3),de=G(4),pe=G(5),ve=G(6),me=q(!0),ye=q(!1),_e=B.values,be=B.keys,Ee=B.entries,Te=ae.lastIndexOf,we=ae.reduce,Oe=ae.reduceRight,ke=ae.join,Re=ae.sort,Ae=ae.slice,Ie=ae.toString,Pe=ae.toLocaleString,Ce=F("iterator"),Me=F("toStringTag"),Ne=U("typed_constructor"),De=U("def_constructor"),je=u.CONSTR,xe=u.TYPED,Le=u.VIEW,Ue=G(1,function(e,t){return Be(V(e,e[De]),t)}),Fe=r(function(){return 1===new oe(new Uint16Array([1]).buffer)[0]}),Ge=!!oe&&!!oe.prototype.set&&r(function(){new oe(1).set({})}),qe=function(e,t){var r=b(e);if(r<0||r%t)throw ne("Wrong offset!");return r},Ve=function(e){if(P(e)&&xe in e)return e;throw ie(e+" is not a typed array!")},Be=function(e,t){if(!(P(e)&&Ne in e))throw ie("It is not a typed array constructor!");return new e(t)},ze=function(e,t){return We(V(e,e[De]),t)},We=function(e,t){for(var r=0,n=t.length,i=Be(e,n);n>r;)i[r]=t[r++];return i},He=function(e,t,r){te(e,t,{get:function(){return this._d[r]}})},Ye=function(e){var t,r,n,i,o,a,s=M(e),u=arguments.length,c=u>1?arguments[1]:void 0,l=void 0!==c,d=L(s);if(null!=d&&!N(d)){for(a=d.call(s),n=[],t=0;!(o=a.next()).done;t++)n.push(o.value);s=n}for(l&&u>2&&(c=f(c,arguments[2],2)),t=0,r=E(s.length),i=Be(this,r);r>t;t++)i[t]=l?c(s[t],t):s[t];return i},$e=function(){for(var e=0,t=arguments.length,r=Be(this,t);t>e;)r[e]=arguments[e++];return r},Xe=!!oe&&r(function(){Pe.call(new oe(1))}),Je=function(){return Pe.apply(Xe?Ae.call(Ve(this)):Ve(this),arguments)},Ke={copyWithin:function(e,t){return Q.call(Ve(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return de(Ve(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return X.apply(Ve(this),arguments)},filter:function(e){return ze(this,le(Ve(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return pe(Ve(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return ve(Ve(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){ce(Ve(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return ye(Ve(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return me(Ve(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return ke.apply(Ve(this),arguments)},lastIndexOf:function(e){return Te.apply(Ve(this),arguments)},map:function(e){return Ue(Ve(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return we.apply(Ve(this),arguments)},reduceRight:function(e){return Oe.apply(Ve(this),arguments)},reverse:function(){for(var e,t=Ve(this).length,r=Math.floor(t/2),n=0;n<r;)e=this[n],this[n++]=this[--t],this[t]=e;return this},some:function(e){return fe(Ve(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return Re.call(Ve(this),e)},subarray:function(e,t){var r=Ve(this),n=r.length,i=w(e,n);return new(V(r,r[De]))(r.buffer,r.byteOffset+i*r.BYTES_PER_ELEMENT,E((void 0===t?n:w(t,n))-i))}},Qe=function(e,t){return ze(this,Ae.call(Ve(this),e,t))},Ze=function(e){Ve(this);var t=qe(arguments[1],1),r=this.length,n=M(e),i=E(n.length),o=0;if(i+t>r)throw ne("Wrong length!");for(;o<i;)this[t+o]=n[o++]},et={entries:function(){return Ee.call(Ve(this))},keys:function(){return be.call(Ve(this))},values:function(){return _e.call(Ve(this))}},rt=function(e,t){return P(e)&&e[xe]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},nt=function(e,t){return rt(e,t=O(t,!0))?p(2,e[t]):re(e,t)},ot=function(e,t,r){return!(rt(e,t=O(t,!0))&&P(r)&&k(r,"value"))||k(r,"get")||k(r,"set")||r.configurable||k(r,"writable")&&!r.writable||k(r,"enumerable")&&!r.enumerable?te(e,t,r):(e[t]=r.value,e)};je||(ee.f=nt,Z.f=ot),i(i.S+i.F*!je,"Object",{getOwnPropertyDescriptor:nt,defineProperty:ot}),r(function(){Ie.call({})})&&(Ie=Pe=function(){return ke.call(this)});var at=g({},Ke);g(at,et),h(at,Ce,et.values),g(at,{slice:Qe,set:Ze,constructor:function(){},toString:Ie,toLocaleString:Je}),He(at,"buffer","b"),He(at,"byteOffset","o"),He(at,"byteLength","l"),He(at,"length","e"),te(at,Me,{get:function(){return this[xe]}}),e.exports=function(e,n,o,a){var s=e+((a=!!a)?"Clamped":"")+"Array",c="get"+e,l="set"+e,f=t[s],p=f||{},v=f&&j(f),g=!f||!u.ABV,m={},y=f&&f.prototype,_=function(e,t){te(e,t,{get:function(){return function(e,t){var r=e._d;return r.v[c](t*n+r.o,Fe)}(this,t)},set:function(e){return function(e,t,r){var i=e._d;a&&(r=(r=Math.round(r))<0?0:r>255?255:255&r),i.v[l](t*n+i.o,r,Fe)}(this,t,e)},enumerable:!0})};g?(f=o(function(e,t,r,i){d(e,f,s,"_d");var o,a,u,c,l=0,p=0;if(P(t)){if(!(t instanceof se||"ArrayBuffer"==(c=A(t))||"SharedArrayBuffer"==c))return xe in t?We(f,t):Ye.call(f,t);o=t,p=qe(r,n);var v=t.byteLength;if(void 0===i){if(v%n)throw ne("Wrong length!");if((a=v-p)<0)throw ne("Wrong length!")}else if((a=E(i)*n)+p>v)throw ne("Wrong length!");u=a/n}else u=T(t),o=new se(a=u*n);for(h(e,"_d",{b:o,o:p,l:a,e:u,v:new ue(o)});l<u;)_(e,l++)}),y=f.prototype=D(at),h(y,"constructor",f)):r(function(){f(1)})&&r(function(){new f(-1)})&&H(function(e){new f,new f(null),new f(1.5),new f(e)},!0)||(f=o(function(e,t,r,i){var o;return d(e,f,s),P(t)?t instanceof se||"ArrayBuffer"==(o=A(t))||"SharedArrayBuffer"==o?void 0!==i?new p(t,qe(r,n),i):void 0!==r?new p(t,qe(r,n)):new p(t):xe in t?We(f,t):Ye.call(f,t):new p(T(t))}),ce(v!==Function.prototype?x(p).concat(x(v)):x(p),function(e){e in f||h(f,e,p[e])}),f.prototype=y,y.constructor=f);var b=y[Ce],S=!!b&&("values"==b.name||null==b.name),w=et.values;h(f,Ne,!0),h(y,xe,s),h(y,Le,!0),h(y,De,f),(a?new f(1)[Me]==s:Me in y)||te(y,Me,{get:function(){return s}}),m[s]=f,i(i.G+i.W+i.F*(f!=p),m),i(i.S,s,{BYTES_PER_ELEMENT:n}),i(i.S+i.F*r(function(){p.of.call(f,1)}),s,{from:Ye,of:$e}),"BYTES_PER_ELEMENT"in y||h(y,"BYTES_PER_ELEMENT",n),i(i.P,s,Ke),$(s),i(i.P+i.F*Ge,s,{set:Ze}),i(i.P+i.F*!S,s,et),y.toString!=Ie&&(y.toString=Ie),i(i.P+i.F*r(function(){new f(1).slice()}),s,{slice:Qe}),i(i.P+i.F*(r(function(){return[1,2].toLocaleString()!=new f([1,2]).toLocaleString()})||!r(function(){y.toLocaleString.call([1,2])})),s,{toLocaleString:Je}),z[s]=S?b:w,S||h(y,Ce,w)}}else e.exports=function(){}});ma("Int8",1,function(e){return function(t,r,n){return e(this,t,r,n)}}),ma("Uint8",1,function(e){return function(t,r,n){return e(this,t,r,n)}}),ma("Uint8",1,function(e){return function(t,r,n){return e(this,t,r,n)}},!0),ma("Int16",2,function(e){return function(t,r,n){return e(this,t,r,n)}}),ma("Uint16",2,function(e){return function(t,r,n){return e(this,t,r,n)}}),ma("Int32",4,function(e){return function(t,r,n){return e(this,t,r,n)}}),ma("Uint32",4,function(e){return function(t,r,n){return e(this,t,r,n)}}),ma("Float32",4,function(e){return function(t,r,n){return e(this,t,r,n)}}),ma("Float64",8,function(e){return function(t,r,n){return e(this,t,r,n)}});var ya=(n.Reflect||{}).apply,_a=Function.apply;I(I.S+I.F*!a(function(){ya(function(){})}),"Reflect",{apply:function(e,t,r){var n=k(e),i=l(r);return ya?ya(n,t,i):_a.call(n,t,i)}});var ba=(n.Reflect||{}).construct,Ea=a(function(){function e(){}return!(ba(function(){},[],e)instanceof e)}),Sa=!a(function(){ba(function(){})});I(I.S+I.F*(Ea||Sa),"Reflect",{construct:function(e,t){k(e),l(t);var r=arguments.length<3?e:k(arguments[2]);if(Sa&&!Ea)return ba(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(bt.apply(e,n))}var i=r.prototype,o=he(c(i)?i:Object.prototype),a=Function.apply.call(e,o,t);return c(a)?a:o}}),I(I.S+I.F*a(function(){Reflect.defineProperty(m.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(e,t,r){l(e),t=v(t,!0),l(r);try{return m.f(e,t,r),!0}catch(e){return!1}}});var Ta=Se.f;I(I.S,"Reflect",{deleteProperty:function(e,t){var r=Ta(l(e),t);return!(r&&!r.configurable)&&delete e[t]}});var wa=function(e){this._t=l(e),this._i=0;var t,r=this._k=[];for(t in e)r.push(t)};Gr(wa,"Object",function(){var e,t=this._k;do{if(this._i>=t.length)return{value:void 0,done:!0}}while(!((e=t[this._i++])in this._t));return{value:e,done:!1}}),I(I.S,"Reflect",{enumerate:function(e){return new wa(e)}}),I(I.S,"Reflect",{get:function e(t,r){var n,i,a=arguments.length<3?t:arguments[2];return l(t)===a?t[r]:(n=Se.f(t,r))?o(n,"value")?n.value:void 0!==n.get?n.get.call(a):void 0:c(i=it(t))?e(i,r,a):void 0}}),I(I.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return Se.f(l(e),t)}}),I(I.S,"Reflect",{getPrototypeOf:function(e){return it(l(e))}}),I(I.S,"Reflect",{has:function(e,t){return t in e}});var Oa=Object.isExtensible;I(I.S,"Reflect",{isExtensible:function(e){return l(e),!Oa||Oa(e)}});var ka=n.Reflect,Ra=ka&&ka.ownKeys||function(e){var t=ge.f(l(e)),r=oe.f;return r?t.concat(r(e)):t};I(I.S,"Reflect",{ownKeys:Ra});var Aa=Object.preventExtensions;I(I.S,"Reflect",{preventExtensions:function(e){l(e);try{return Aa&&Aa(e),!0}catch(e){return!1}}}),I(I.S,"Reflect",{set:function e(t,r,n){var i,a,s=arguments.length<4?t:arguments[3],u=Se.f(l(t),r);if(!u){if(c(a=it(t)))return e(a,r,n,s);u=y(0)}if(o(u,"value")){if(!1===u.writable||!c(s))return!1;if(i=Se.f(s,r)){if(i.get||i.set||!1===i.writable)return!1;i.value=n,m.f(s,r,i)}else m.f(s,r,y(0,n));return!0}return void 0!==u.set&&(u.set.call(s,n),!0)}}),dt&&I(I.S,"Reflect",{setPrototypeOf:function(e,t){dt.check(e,t);try{return dt.set(e,t),!0}catch(e){return!1}}});var Ia=K(!0);I(I.P,"Array",{includes:function(e){return Ia(this,e,arguments.length>1?arguments[1]:void 0)}}),Hn("includes");var Pa=C("isConcatSpreadable");var Ca=function e(t,r,n,i,o,a,s,u){for(var l,f,d=o,p=0,h=!!s&&R(s,u,3);p<i;){if(p in n){if(l=h?h(n[p],p,r):n[p],f=!1,c(l)&&(f=void 0!==(f=l[Pa])?!!f:se(l)),f&&a>0)d=e(t,r,l,Y(l.length),d,a-1)-1;else{if(d>=9007199254740991)throw TypeError();t[d]=l}d++}p++}return d};I(I.P,"Array",{flatMap:function(e){var t,r,n=tt(this);return k(e),t=Y(n.length),r=In(n,0),Ca(r,n,n,t,0,1,e,arguments[1]),r}}),Hn("flatMap"),I(I.P,"Array",{flatten:function(){var e=arguments[0],t=tt(this),r=Y(t.length),n=In(t,0);return Ca(n,t,t,r,0,void 0===e?1:W(e)),n}}),Hn("flatten");var Ma=Lr(!0);I(I.P,"String",{at:function(e){return Ma(this,e)}});var Na=function(e,t,r,n){var i=String(q(e)),o=i.length,a=void 0===r?" ":String(r),s=Y(t);if(s<=o||""==a)return i;var u=s-o,c=rr.call(a,Math.ceil(u/a.length));return c.length>u&&(c=c.slice(0,u)),n?c+i:i+c},Da=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(go);I(I.P+I.F*Da,"String",{padStart:function(e){return Na(this,e,arguments.length>1?arguments[1]:void 0,!0)}});var ja=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(go);I(I.P+I.F*ja,"String",{padEnd:function(e){return Na(this,e,arguments.length>1?arguments[1]:void 0,!1)}}),Mt("trimLeft",function(e){return function(){return e(this,1)}},"trimStart"),Mt("trimRight",function(e){return function(){return e(this,2)}},"trimEnd");var xa=RegExp.prototype,La=function(e,t){this._r=e,this._s=t};Gr(La,"RegExp String",function(){var e=this._r.exec(this._s);return{value:e,done:null===e}}),I(I.P,"String",{matchAll:function(e){if(q(this),!$r(e))throw TypeError(e+" is not a regexp!");var t=String(this),r="flags"in xa?String(e.flags):ri.call(e),n=new RegExp(e.source,~r.indexOf("g")?r:"g"+r);return n.lastIndex=Y(e.lastIndex),new La(n,t)}}),L("asyncIterator"),L("observable"),I(I.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,r,n=V(e),i=Se.f,o=Ra(n),a={},s=0;o.length>s;)void 0!==(r=i(n,t=o[s++]))&&mn(a,t,r);return a}});var Ua=ae.f,Fa=function(e){return function(t){for(var r,n=V(t),i=ie(n),o=i.length,a=0,s=[];o>a;)Ua.call(n,r=i[a++])&&s.push(e?[r,n[r]]:n[r]);return s}},Ga=Fa(!1);I(I.S,"Object",{values:function(e){return Ga(e)}});var qa=Fa(!0);I(I.S,"Object",{entries:function(e){return qa(e)}});var Va=!a(function(){var e=Math.random();__defineSetter__.call(null,e,function(){}),delete n[e]});s&&I(I.P+Va,"Object",{__defineGetter__:function(e,t){m.f(tt(this),e,{get:k(t),enumerable:!0,configurable:!0})}}),s&&I(I.P+Va,"Object",{__defineSetter__:function(e,t){m.f(tt(this),e,{set:k(t),enumerable:!0,configurable:!0})}});var Ba=Se.f;s&&I(I.P+Va,"Object",{__lookupGetter__:function(e){var t,r=tt(this),n=v(e,!0);do{if(t=Ba(r,n))return t.get}while(r=it(r))}});var za=Se.f;s&&I(I.P+Va,"Object",{__lookupSetter__:function(e){var t,r=tt(this),n=v(e,!0);do{if(t=za(r,n))return t.set}while(r=it(r))}});var Wa=function(e,t){var r=[];return zi(e,!1,r.push,r,t),r},Ha=function(e){return function(){if(vt(this)!=e)throw TypeError(e+"#toJSON isn't generic");return Wa(this)}};I(I.P+I.R,"Map",{toJSON:Ha("Map")}),I(I.P+I.R,"Set",{toJSON:Ha("Set")});var Ya=function(e){I(I.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})};Ya("Map"),Ya("Set"),Ya("WeakMap"),Ya("WeakSet");var $a=function(e){I(I.S,e,{from:function(e){var t,r,n,i,o=arguments[1];return k(this),(t=void 0!==o)&&k(o),null==e?new this:(r=[],t?(n=0,i=R(o,arguments[2],2),zi(e,!1,function(e){r.push(i(e,n++))})):zi(e,!1,r.push,r),new this(r))}})};$a("Map"),$a("Set"),$a("WeakMap"),$a("WeakSet"),I(I.G,{global:n}),I(I.S,"System",{global:n}),I(I.S,"Error",{isError:function(e){return"Error"===F(e)}}),I(I.S,"Math",{clamp:function(e,t,r){return Math.min(r,Math.max(t,e))}}),I(I.S,"Math",{DEG_PER_RAD:Math.PI/180});var Xa=180/Math.PI;I(I.S,"Math",{degrees:function(e){return e*Xa}});var Ja=Math.scale||function(e,t,r,n,i){return 0===arguments.length||e!=e||t!=t||r!=r||n!=n||i!=i?NaN:e===1/0||e===-1/0?e:(e-t)*(i-n)/(r-t)+n};I(I.S,"Math",{fscale:function(e,t,r,n,i){return Pr(Ja(e,t,r,n,i))}}),I(I.S,"Math",{iaddh:function(e,t,r,n){var i=e>>>0,o=r>>>0;return(t>>>0)+(n>>>0)+((i&o|(i|o)&~(i+o>>>0))>>>31)|0}}),I(I.S,"Math",{isubh:function(e,t,r,n){var i=e>>>0,o=r>>>0;return(t>>>0)-(n>>>0)-((~i&o|~(i^o)&i-o>>>0)>>>31)|0}}),I(I.S,"Math",{imulh:function(e,t){var r=+e,n=+t,i=65535&r,o=65535&n,a=r>>16,s=n>>16,u=(a*o>>>0)+(i*o>>>16);return a*s+(u>>16)+((i*s>>>0)+(65535&u)>>16)}}),I(I.S,"Math",{RAD_PER_DEG:180/Math.PI});var Ka=Math.PI/180;I(I.S,"Math",{radians:function(e){return e*Ka}}),I(I.S,"Math",{scale:Ja}),I(I.S,"Math",{umulh:function(e,t){var r=+e,n=+t,i=65535&r,o=65535&n,a=r>>>16,s=n>>>16,u=(a*o>>>0)+(i*o>>>16);return a*s+(u>>>16)+((i*s>>>0)+(65535&u)>>>16)}}),I(I.S,"Math",{signbit:function(e){return(e=+e)!=e?e:0==e?1/e==1/0:e>0}}),I(I.P+I.R,"Promise",{finally:function(e){var t=xi(this,u.Promise||n.Promise),r="function"==typeof e;return this.then(r?function(r){return mo(t,e()).then(function(){return r})}:e,r?function(r){return mo(t,e()).then(function(){throw r})}:e)}}),I(I.S,"Promise",{try:function(e){var t=po.f(this),r=ho(e);return(r.e?t.reject:t.resolve)(r.v),t.promise}});var Qa=T("metadata"),Za=Qa.store||(Qa.store=new ea),es=function(e,t,r){var n=Za.get(e);if(!n){if(!r)return;Za.set(e,n=new zo)}var i=n.get(t);if(!i){if(!r)return;n.set(t,i=new zo)}return i},ts={store:Za,map:es,has:function(e,t,r){var n=es(t,r,!1);return void 0!==n&&n.has(e)},get:function(e,t,r){var n=es(t,r,!1);return void 0===n?void 0:n.get(e)},set:function(e,t,r,n){es(r,n,!0).set(e,t)},keys:function(e,t){var r=es(e,t,!1),n=[];return r&&r.forEach(function(e,t){n.push(t)}),n},key:function(e){return void 0===e||"symbol"==typeof e?e:String(e)},exp:function(e){I(I.S,"Reflect",e)}},rs=ts.key,ns=ts.set;ts.exp({defineMetadata:function(e,t,r,n){ns(e,t,l(r),rs(n))}});var is=ts.key,os=ts.map,as=ts.store;ts.exp({deleteMetadata:function(e,t){var r=arguments.length<3?void 0:is(arguments[2]),n=os(l(t),r,!1);if(void 0===n||!n.delete(e))return!1;if(n.size)return!0;var i=as.get(t);return i.delete(r),!!i.size||as.delete(t)}});var ss=ts.has,us=ts.get,cs=ts.key,ls=function(e,t,r){if(ss(e,t,r))return us(e,t,r);var n=it(t);return null!==n?ls(e,n,r):void 0};ts.exp({getMetadata:function(e,t){return ls(e,l(t),arguments.length<3?void 0:cs(arguments[2]))}});var fs=ts.keys,ds=ts.key,ps=function(e,t){var r=fs(e,t),n=it(e);if(null===n)return r;var i=ps(n,t);return i.length?r.length?Wa(new Wo(r.concat(i))):i:r};ts.exp({getMetadataKeys:function(e){return ps(l(e),arguments.length<2?void 0:ds(arguments[1]))}});var hs=ts.get,vs=ts.key;ts.exp({getOwnMetadata:function(e,t){return hs(e,l(t),arguments.length<3?void 0:vs(arguments[2]))}});var gs=ts.keys,ms=ts.key;ts.exp({getOwnMetadataKeys:function(e){return gs(l(e),arguments.length<2?void 0:ms(arguments[1]))}});var ys=ts.has,_s=ts.key,bs=function(e,t,r){if(ys(e,t,r))return!0;var n=it(t);return null!==n&&bs(e,n,r)};ts.exp({hasMetadata:function(e,t){return bs(e,l(t),arguments.length<3?void 0:_s(arguments[2]))}});var Es=ts.has,Ss=ts.key;ts.exp({hasOwnMetadata:function(e,t){return Es(e,l(t),arguments.length<3?void 0:Ss(arguments[2]))}});var Ts=ts.key,ws=ts.set;ts.exp({metadata:function(e,t){return function(r,n){ws(e,t,(void 0!==n?l:k)(r),Ts(n))}}});var Os=ao(),ks=n.process,Rs="process"==F(ks);I(I.G,{asap:function(e){var t=Rs&&ks.domain;Os(t?t.bind(e):e)}});var As=ao(),Is=C("observable"),Ps=zi.RETURN,Cs=function(e){return null==e?void 0:k(e)},Ms=function(e){var t=e._c;t&&(e._c=void 0,t())},Ns=function(e){return void 0===e._o},Ds=function(e){Ns(e)||(e._o=void 0,Ms(e))},js=function(e,t){l(e),this._c=void 0,this._o=e,e=new xs(this);try{var r=t(e),n=r;null!=r&&("function"==typeof r.unsubscribe?r=function(){n.unsubscribe()}:k(r),this._c=r)}catch(t){return void e.error(t)}Ns(this)&&Ms(this)};js.prototype=yo({},{unsubscribe:function(){Ds(this)}});var xs=function(e){this._s=e};xs.prototype=yo({},{next:function(e){var t=this._s;if(!Ns(t)){var r=t._o;try{var n=Cs(r.next);if(n)return n.call(r,e)}catch(e){try{Ds(t)}finally{throw e}}}},error:function(e){var t=this._s;if(Ns(t))throw e;var r=t._o;t._o=void 0;try{var n=Cs(r.error);if(!n)throw e;e=n.call(r,e)}catch(e){try{Ms(t)}finally{throw e}}return Ms(t),e},complete:function(e){var t=this._s;if(!Ns(t)){var r=t._o;t._o=void 0;try{var n=Cs(r.complete);e=n?n.call(r,e):void 0}catch(e){try{Ms(t)}finally{throw e}}return Ms(t),e}}});var Ls=function(e){Bi(this,Ls,"Observable","_f")._f=k(e)};yo(Ls.prototype,{subscribe:function(e){return new js(e,this._f)},forEach:function(e){var t=this;return new(u.Promise||n.Promise)(function(r,n){k(e);var i=t.subscribe({next:function(t){try{return e(t)}catch(e){n(e),i.unsubscribe()}},error:n,complete:r})})}}),yo(Ls,{from:function(e){var t="function"==typeof this?this:Ls,r=Cs(l(e)[Is]);if(r){var n=l(r.call(e));return n.constructor===t?n:new t(function(e){return n.subscribe(e)})}return new t(function(t){var r=!1;return As(function(){if(!r){try{if(zi(e,!1,function(e){if(t.next(e),r)return Ps})===Ps)return}catch(e){if(r)throw e;return void t.error(e)}t.complete()}}),function(){r=!0}})},of:function(){for(var e=0,t=arguments.length,r=new Array(t);e<t;)r[e]=arguments[e++];return new("function"==typeof this?this:Ls)(function(e){var t=!1;return As(function(){if(!t){for(var n=0;n<r.length;++n)if(e.next(r[n]),t)return;e.complete()}}),function(){t=!0}})}}),_(Ls.prototype,Is,function(){return this}),I(I.G,{Observable:Ls}),Zn("Observable");var Us=[].slice,Fs=/MSIE .\./.test(go),Gs=function(e){return function(t,r){var n=arguments.length>2,i=!!n&&Us.call(arguments,2);return e(n?function(){("function"==typeof t?t:Function(t)).apply(this,i)}:t,r)}};I(I.G+I.B+I.F*Fs,{setTimeout:Gs(n.setTimeout),setInterval:Gs(n.setInterval)}),I(I.G+I.B,{setImmediate:eo.set,clearImmediate:eo.clear});for(var qs=C("iterator"),Vs=C("toStringTag"),Bs=Ur.Array,zs={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},Ws=ie(zs),Hs=0;Hs<Ws.length;Hs++){var Ys,$s=Ws[Hs],Xs=zs[$s],Js=n[$s],Ks=Js&&Js.prototype;if(Ks&&(Ks[qs]||_(Ks,qs,Bs),Ks[Vs]||_(Ks,Vs,$s),Ur[$s]=Bs,Xs))for(Ys in ti)Ks[Ys]||O(Ks,Ys,ti[Ys],!0)}r(function(t){!function(e){var r,n=Object.prototype,i=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag",c=e.regeneratorRuntime;if(c)t.exports=c;else{(c=e.regeneratorRuntime=t.exports).wrap=_;var l="suspendedStart",f="suspendedYield",d="executing",p="completed",h={},v={};v[a]=function(){return this};var g=Object.getPrototypeOf,m=g&&g(g(P([])));m&&m!==n&&i.call(m,a)&&(v=m);var y=T.prototype=E.prototype=Object.create(v);S.prototype=y.constructor=T,T.constructor=S,T[u]=S.displayName="GeneratorFunction",c.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===S||"GeneratorFunction"===(t.displayName||t.name))},c.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,T):(e.__proto__=T,u in e||(e[u]="GeneratorFunction")),e.prototype=Object.create(y),e},c.awrap=function(e){return{__await:e}},w(O.prototype),O.prototype[s]=function(){return this},c.AsyncIterator=O,c.async=function(e,t,r,n){var i=new O(_(e,t,r,n));return c.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},w(y),y[u]="Generator",y[a]=function(){return this},y.toString=function(){return"[object Generator]"},c.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},c.values=P,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=r)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,i){return s.type="throw",s.arg=e,t.next=n,i&&(t.method="next",t.arg=r),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var u=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),A(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;A(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=r),h}}}function _(e,t,r,n){var i=t&&t.prototype instanceof E?t:E,o=Object.create(i.prototype),a=new I(n||[]);return o._invoke=function(e,t,r){var n=l;return function(i,o){if(n===d)throw new Error("Generator is already running");if(n===p){if("throw"===i)throw o;return C()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=k(a,r);if(s){if(s===h)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===l)throw n=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=d;var u=b(e,t,r);if("normal"===u.type){if(n=r.done?p:f,u.arg===h)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n=p,r.method="throw",r.arg=u.arg)}}}(e,r,a),o}function b(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}function E(){}function S(){}function T(){}function w(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function O(t){function r(e,n,o,a){var s=b(t[e],t,n);if("throw"!==s.type){var u=s.arg,c=u.value;return c&&"object"==typeof c&&i.call(c,"__await")?Promise.resolve(c.__await).then(function(e){r("next",e,o,a)},function(e){r("throw",e,o,a)}):Promise.resolve(c).then(function(e){u.value=e,o(u)},a)}a(s.arg)}var n;"object"==typeof e.process&&e.process.domain&&(r=e.process.domain.bind(r)),this._invoke=function(e,t){function i(){return new Promise(function(n,i){r(e,t,n,i)})}return n=n?n.then(i,i):i()}}function k(e,t){var n=e.iterator[t.method];if(n===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=r,k(e,t),"throw"===t.method))return h;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var i=b(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,h;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=r),t.delegate=null,h):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function R(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(R,this),this.reset(!0)}function P(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=r,t.done=!0,t};return o.next=o}}return{next:C}}function C(){return{value:r,done:!0}}}("object"==typeof e?e:"object"==typeof window?window:"object"==typeof self?self:e)});var Qs=function(e,t){var r=t===Object(t)?function(e){return t[e]}:t;return function(t){return String(t).replace(e,r)}}(/[\\^$*+?.()|[\]{}]/g,"\\$&");I(I.S,"RegExp",{escape:function(e){return Qs(e)}});u.RegExp.escape;if(e._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");e._babelPolyfill=!0;var Zs="defineProperty";function eu(e,t,r){e[t]||Object[Zs](e,t,{writable:!0,configurable:!0,value:r})}eu(String.prototype,"padLeft","".padStart),eu(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(e){[][e]&&eu(Array,e,Function.call.bind([][e]))});var tu="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function ru(){throw new Error("setTimeout has not been defined")}function nu(){throw new Error("clearTimeout has not been defined")}var iu=ru,ou=nu;function au(e){if(iu===setTimeout)return setTimeout(e,0);if((iu===ru||!iu)&&setTimeout)return iu=setTimeout,setTimeout(e,0);try{return iu(e,0)}catch(t){try{return iu.call(null,e,0)}catch(t){return iu.call(this,e,0)}}}"function"==typeof tu.setTimeout&&(iu=setTimeout),"function"==typeof tu.clearTimeout&&(ou=clearTimeout);var su,uu=[],cu=!1,lu=-1;function fu(){cu&&su&&(cu=!1,su.length?uu=su.concat(uu):lu=-1,uu.length&&du())}function du(){if(!cu){var e=au(fu);cu=!0;for(var t=uu.length;t;){for(su=uu,uu=[];++lu<t;)su&&su[lu].run();lu=-1,t=uu.length}su=null,cu=!1,function(e){if(ou===clearTimeout)return clearTimeout(e);if((ou===nu||!ou)&&clearTimeout)return ou=clearTimeout,clearTimeout(e);try{ou(e)}catch(t){try{return ou.call(null,e)}catch(t){return ou.call(this,e)}}}(e)}}function pu(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];uu.push(new hu(e,t)),1!==uu.length||cu||au(du)}function hu(e,t){this.fun=e,this.array=t}hu.prototype.run=function(){this.fun.apply(null,this.array)};function vu(){}var gu=vu,mu=vu,yu=vu,_u=vu,bu=vu,Eu=vu,Su=vu;var Tu=tu.performance||{},wu=Tu.now||Tu.mozNow||Tu.msNow||Tu.oNow||Tu.webkitNow||function(){return(new Date).getTime()};var Ou=new Date;var ku={nextTick:pu,title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:gu,addListener:mu,once:yu,off:_u,removeListener:bu,removeAllListeners:Eu,emit:Su,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*wu.call(Tu),r=Math.floor(t),n=Math.floor(t%1*1e9);return e&&(r-=e[0],(n-=e[1])<0&&(r--,n+=1e9)),[r,n]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-Ou)/1e3}},Ru={}.toString,Au=function(e){return Ru.call(e).slice(8,-1)},Iu=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==Au(e)?e.split(""):Object(e)},Pu=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},Cu=function(e){return Iu(Pu(e))},Mu={f:{}.propertyIsEnumerable},Nu=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},Du=function(e){return"object"==typeof e?null!==e:"function"==typeof e},ju=function(e,t){if(!Du(e))return e;var r,n;if(t&&"function"==typeof(r=e.toString)&&!Du(n=r.call(e)))return n;if("function"==typeof(r=e.valueOf)&&!Du(n=r.call(e)))return n;if(!t&&"function"==typeof(r=e.toString)&&!Du(n=r.call(e)))return n;throw TypeError("Can't convert object to primitive value")},xu={}.hasOwnProperty,Lu=function(e,t){return xu.call(e,t)},Uu=function(e){try{return!!e()}catch(e){return!0}},Fu=!Uu(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),Gu=r(function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)}),qu=Gu.document,Vu=Du(qu)&&Du(qu.createElement),Bu=function(e){return Vu?qu.createElement(e):{}},zu=!Fu&&!Uu(function(){return 7!=Object.defineProperty(Bu("div"),"a",{get:function(){return 7}}).a}),Wu=Object.getOwnPropertyDescriptor,Hu={f:Fu?Wu:function(e,t){if(e=Cu(e),t=ju(t,!0),zu)try{return Wu(e,t)}catch(e){}if(Lu(e,t))return Nu(!Mu.f.call(e,t),e[t])}},Yu=r(function(e){var t=e.exports={version:"2.6.5"};"number"==typeof __e&&(__e=t)}),$u=(Yu.version,function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}),Xu=function(e,t,r){if($u(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}},Ju=function(e){if(!Du(e))throw TypeError(e+" is not an object!");return e},Ku=Object.defineProperty,Qu={f:Fu?Object.defineProperty:function(e,t,r){if(Ju(e),t=ju(t,!0),Ju(r),zu)try{return Ku(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},Zu=Fu?function(e,t,r){return Qu.f(e,t,Nu(1,r))}:function(e,t,r){return e[t]=r,e},ec=function(e,t,r){var n,i,o,a=e&ec.F,s=e&ec.G,u=e&ec.S,c=e&ec.P,l=e&ec.B,f=e&ec.W,d=s?Yu:Yu[t]||(Yu[t]={}),p=d.prototype,h=s?Gu:u?Gu[t]:(Gu[t]||{}).prototype;for(n in s&&(r=t),r)(i=!a&&h&&void 0!==h[n])&&Lu(d,n)||(o=i?h[n]:r[n],d[n]=s&&"function"!=typeof h[n]?r[n]:l&&i?Xu(o,Gu):f&&h[n]==o?function(e){var t=function(t,r,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,n)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(o):c&&"function"==typeof o?Xu(Function.call,o):o,c&&((d.virtual||(d.virtual={}))[n]=o,e&ec.R&&p&&!p[n]&&Zu(p,n,o)))};ec.F=1,ec.G=2,ec.S=4,ec.P=8,ec.B=16,ec.W=32,ec.U=64,ec.R=128;var tc=ec,rc=function(e,t){var r=(Yu.Object||{})[e]||Object[e],n={};n[e]=t(r),tc(tc.S+tc.F*Uu(function(){r(1)}),"Object",n)},nc=Hu.f;rc("getOwnPropertyDescriptor",function(){return function(e,t){return nc(Cu(e),t)}});var ic=Yu.Object,oc=function(e,t){return ic.getOwnPropertyDescriptor(e,t)},ac=r(function(e){e.exports={default:oc,__esModule:!0}});t(ac);var sc=Hu.f;tc(tc.S,"Reflect",{deleteProperty:function(e,t){var r=sc(Ju(e),t);return!(r&&!r.configurable)&&delete e[t]}});var uc=Yu.Reflect.deleteProperty,cc=r(function(e){e.exports={default:uc,__esModule:!0}});t(cc);var lc,fc=Math.ceil,dc=Math.floor,pc=function(e){return isNaN(e=+e)?0:(e>0?dc:fc)(e)},hc=Zu,vc={},gc=Math.min,mc=function(e){return e>0?gc(pc(e),9007199254740991):0},yc=Math.max,_c=Math.min,bc=r(function(e){var t=Gu["__core-js_shared__"]||(Gu["__core-js_shared__"]={});(e.exports=function(e,r){return t[e]||(t[e]=void 0!==r?r:{})})("versions",[]).push({version:Yu.version,mode:"pure",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})}),Ec=0,Sc=Math.random(),Tc=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++Ec+Sc).toString(36))},wc=bc("keys"),Oc=function(e){return wc[e]||(wc[e]=Tc(e))},kc=(lc=!1,function(e,t,r){var n,i=Cu(e),o=mc(i.length),a=function(e,t){return(e=pc(e))<0?yc(e+t,0):_c(e,t)}(r,o);if(lc&&t!=t){for(;o>a;)if((n=i[a++])!=n)return!0}else for(;o>a;a++)if((lc||a in i)&&i[a]===t)return lc||a||0;return!lc&&-1}),Rc=Oc("IE_PROTO"),Ac=function(e,t){var r,n=Cu(e),i=0,o=[];for(r in n)r!=Rc&&Lu(n,r)&&o.push(r);for(;t.length>i;)Lu(n,r=t[i++])&&(~kc(o,r)||o.push(r));return o},Ic="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),Pc=Object.keys||function(e){return Ac(e,Ic)},Cc=Fu?Object.defineProperties:function(e,t){Ju(e);for(var r,n=Pc(t),i=n.length,o=0;i>o;)Qu.f(e,r=n[o++],t[r]);return e},Mc=Gu.document,Nc=Mc&&Mc.documentElement,Dc=Oc("IE_PROTO"),jc=function(){},xc=function(){var e,t=Bu("iframe"),r=Ic.length;for(t.style.display="none",Nc.appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),xc=e.F;r--;)delete xc.prototype[Ic[r]];return xc()},Lc=Object.create||function(e,t){var r;return null!==e?(jc.prototype=Ju(e),r=new jc,jc.prototype=null,r[Dc]=e):r=xc(),void 0===t?r:Cc(r,t)},Uc=r(function(e){var t=bc("wks"),r=Gu.Symbol,n="function"==typeof r;(e.exports=function(e){return t[e]||(t[e]=n&&r[e]||(n?r:Tc)("Symbol."+e))}).store=t}),Fc=Qu.f,Gc=Uc("toStringTag"),qc=function(e,t,r){e&&!Lu(e=r?e:e.prototype,Gc)&&Fc(e,Gc,{configurable:!0,value:t})},Vc={};Zu(Vc,Uc("iterator"),function(){return this});var Bc=function(e){return Object(Pu(e))},zc=Oc("IE_PROTO"),Wc=Object.prototype,Hc=Object.getPrototypeOf||function(e){return e=Bc(e),Lu(e,zc)?e[zc]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?Wc:null},Yc=Uc("iterator"),$c=!([].keys&&"next"in[].keys()),Xc=function(){return this},Jc=function(e,t,r,n,i,o,a){!function(e,t,r){e.prototype=Lc(Vc,{next:Nu(1,r)}),qc(e,t+" Iterator")}(r,t,n);var s,u,c,l=function(e){if(!$c&&e in h)return h[e];switch(e){case"keys":case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},f=t+" Iterator",d="values"==i,p=!1,h=e.prototype,v=h[Yc]||h["@@iterator"]||i&&h[i],g=v||l(i),m=i?d?l("entries"):g:void 0,y="Array"==t&&h.entries||v;if(y&&(c=Hc(y.call(new e)))!==Object.prototype&&c.next&&qc(c,f,!0),d&&v&&"values"!==v.name&&(p=!0,g=function(){return v.call(this)}),a&&($c||p||!h[Yc])&&Zu(h,Yc,g),vc[t]=g,vc[f]=Xc,i)if(s={values:d?g:l("values"),keys:o?g:l("keys"),entries:m},a)for(u in s)u in h||hc(h,u,s[u]);else tc(tc.P+tc.F*($c||p),t,s);return s},Kc=function(e){return function(t,r){var n,i,o=String(Pu(t)),a=pc(r),s=o.length;return a<0||a>=s?e?"":void 0:(n=o.charCodeAt(a))<55296||n>56319||a+1===s||(i=o.charCodeAt(a+1))<56320||i>57343?e?o.charAt(a):n:e?o.slice(a,a+2):i-56320+(n-55296<<10)+65536}}(!0);Jc(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=Kc(t,r),this._i+=e.length,{value:e,done:!1})});var Qc=function(e,t){return{value:t,done:!!e}};Jc(Array,"Array",function(e,t){this._t=Cu(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,Qc(1)):Qc(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])},"values");vc.Arguments=vc.Array;for(var Zc=Uc("toStringTag"),el="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),tl=0;tl<el.length;tl++){var rl=el[tl],nl=Gu[rl],il=nl&&nl.prototype;il&&!il[Zc]&&Zu(il,Zc,rl),vc[rl]=vc.Array}var ol,al,sl,ul=Uc("toStringTag"),cl="Arguments"==Au(function(){return arguments}()),ll=function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),ul))?r:cl?Au(t):"Object"==(n=Au(t))&&"function"==typeof t.callee?"Arguments":n},fl=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e},dl=function(e,t,r,n){try{return n?t(Ju(r)[0],r[1]):t(r)}catch(t){var i=e.return;throw void 0!==i&&Ju(i.call(e)),t}},pl=Uc("iterator"),hl=Array.prototype,vl=function(e){return void 0!==e&&(vc.Array===e||hl[pl]===e)},gl=Uc("iterator"),ml=Yu.getIteratorMethod=function(e){if(null!=e)return e[gl]||e["@@iterator"]||vc[ll(e)]},yl=r(function(e){var t={},r={},n=e.exports=function(e,n,i,o,a){var s,u,c,l,f=a?function(){return e}:ml(e),d=Xu(i,o,n?2:1),p=0;if("function"!=typeof f)throw TypeError(e+" is not iterable!");if(vl(f)){for(s=mc(e.length);s>p;p++)if((l=n?d(Ju(u=e[p])[0],u[1]):d(e[p]))===t||l===r)return l}else for(c=f.call(e);!(u=c.next()).done;)if((l=dl(c,d,u.value,n))===t||l===r)return l};n.BREAK=t,n.RETURN=r}),_l=Uc("species"),bl=function(e,t){var r,n=Ju(e).constructor;return void 0===n||null==(r=Ju(n)[_l])?t:$u(r)},El=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)},Sl=Gu.process,Tl=Gu.setImmediate,wl=Gu.clearImmediate,Ol=Gu.MessageChannel,kl=Gu.Dispatch,Rl=0,Al={},Il=function(){var e=+this;if(Al.hasOwnProperty(e)){var t=Al[e];delete Al[e],t()}},Pl=function(e){Il.call(e.data)};Tl&&wl||(Tl=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return Al[++Rl]=function(){El("function"==typeof e?e:Function(e),t)},ol(Rl),Rl},wl=function(e){delete Al[e]},"process"==Au(Sl)?ol=function(e){Sl.nextTick(Xu(Il,e,1))}:kl&&kl.now?ol=function(e){kl.now(Xu(Il,e,1))}:Ol?(sl=(al=new Ol).port2,al.port1.onmessage=Pl,ol=Xu(sl.postMessage,sl,1)):Gu.addEventListener&&"function"==typeof postMessage&&!Gu.importScripts?(ol=function(e){Gu.postMessage(e+"","*")},Gu.addEventListener("message",Pl,!1)):ol="onreadystatechange"in Bu("script")?function(e){Nc.appendChild(Bu("script")).onreadystatechange=function(){Nc.removeChild(this),Il.call(e)}}:function(e){setTimeout(Xu(Il,e,1),0)});var Cl={set:Tl,clear:wl},Ml=Cl.set,Nl=Gu.MutationObserver||Gu.WebKitMutationObserver,Dl=Gu.process,jl=Gu.Promise,xl="process"==Au(Dl);function Ll(e){var t,r;this.promise=new e(function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n}),this.resolve=$u(t),this.reject=$u(r)}var Ul={f:function(e){return new Ll(e)}},Fl=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}},Gl=Gu.navigator,ql=Gl&&Gl.userAgent||"",Vl=function(e,t){if(Ju(e),Du(t)&&t.constructor===e)return t;var r=Ul.f(e);return(0,r.resolve)(t),r.promise},Bl=function(e,t,r){for(var n in t)r&&e[n]?e[n]=t[n]:Zu(e,n,t[n]);return e},zl=Uc("species"),Wl=function(e){var t="function"==typeof Yu[e]?Yu[e]:Gu[e];Fu&&t&&!t[zl]&&Qu.f(t,zl,{configurable:!0,get:function(){return this}})},Hl=Uc("iterator"),Yl=!1;try{[7][Hl]().return=function(){Yl=!0}}catch(e){}var $l,Xl,Jl,Kl,Ql=function(e,t){if(!t&&!Yl)return!1;var r=!1;try{var n=[7],i=n[Hl]();i.next=function(){return{done:r=!0}},n[Hl]=function(){return i},e(n)}catch(e){}return r},Zl=Cl.set,ef=function(){var e,t,r,n=function(){var n,i;for(xl&&(n=Dl.domain)&&n.exit();e;){i=e.fn,e=e.next;try{i()}catch(n){throw e?r():t=void 0,n}}t=void 0,n&&n.enter()};if(xl)r=function(){Dl.nextTick(n)};else if(!Nl||Gu.navigator&&Gu.navigator.standalone)if(jl&&jl.resolve){var i=jl.resolve(void 0);r=function(){i.then(n)}}else r=function(){Ml.call(Gu,n)};else{var o=!0,a=document.createTextNode("");new Nl(n).observe(a,{characterData:!0}),r=function(){a.data=o=!o}}return function(n){var i={fn:n,next:void 0};t&&(t.next=i),e||(e=i,r()),t=i}}(),tf=Gu.TypeError,rf=Gu.process,nf=rf&&rf.versions,of=nf&&nf.v8||"",af=Gu.Promise,sf="process"==ll(rf),uf=function(){},cf=Xl=Ul.f,lf=!!function(){try{var e=af.resolve(1),t=(e.constructor={})[Uc("species")]=function(e){e(uf,uf)};return(sf||"function"==typeof PromiseRejectionEvent)&&e.then(uf)instanceof t&&0!==of.indexOf("6.6")&&-1===ql.indexOf("Chrome/66")}catch(e){}}(),ff=function(e){var t;return!(!Du(e)||"function"!=typeof(t=e.then))&&t},df=function(e,t){if(!e._n){e._n=!0;var r=e._c;ef(function(){for(var n=e._v,i=1==e._s,o=0,a=function(t){var r,o,a,s=i?t.ok:t.fail,u=t.resolve,c=t.reject,l=t.domain;try{s?(i||(2==e._h&&vf(e),e._h=1),!0===s?r=n:(l&&l.enter(),r=s(n),l&&(l.exit(),a=!0)),r===t.promise?c(tf("Promise-chain cycle")):(o=ff(r))?o.call(r,u,c):u(r)):c(n)}catch(e){l&&!a&&l.exit(),c(e)}};r.length>o;)a(r[o++]);e._c=[],e._n=!1,t&&!e._h&&pf(e)})}},pf=function(e){Zl.call(Gu,function(){var t,r,n,i=e._v,o=hf(e);if(o&&(t=Fl(function(){sf?rf.emit("unhandledRejection",i,e):(r=Gu.onunhandledrejection)?r({promise:e,reason:i}):(n=Gu.console)&&n.error&&n.error("Unhandled promise rejection",i)}),e._h=sf||hf(e)?2:1),e._a=void 0,o&&t.e)throw t.v})},hf=function(e){return 1!==e._h&&0===(e._a||e._c).length},vf=function(e){Zl.call(Gu,function(){var t;sf?rf.emit("rejectionHandled",e):(t=Gu.onrejectionhandled)&&t({promise:e,reason:e._v})})},gf=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),df(t,!0))},mf=function(e){var t,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw tf("Promise can't be resolved itself");(t=ff(e))?ef(function(){var n={_w:r,_d:!1};try{t.call(e,Xu(mf,n,1),Xu(gf,n,1))}catch(e){gf.call(n,e)}}):(r._v=e,r._s=1,df(r,!1))}catch(e){gf.call({_w:r,_d:!1},e)}}};lf||(af=function(e){fl(this,af,"Promise","_h"),$u(e),$l.call(this);try{e(Xu(mf,this,1),Xu(gf,this,1))}catch(e){gf.call(this,e)}},($l=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=Bl(af.prototype,{then:function(e,t){var r=cf(bl(this,af));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=sf?rf.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&df(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),Jl=function(){var e=new $l;this.promise=e,this.resolve=Xu(mf,e,1),this.reject=Xu(gf,e,1)},Ul.f=cf=function(e){return e===af||e===Kl?new Jl(e):Xl(e)}),tc(tc.G+tc.W+tc.F*!lf,{Promise:af}),qc(af,"Promise"),Wl("Promise"),Kl=Yu.Promise,tc(tc.S+tc.F*!lf,"Promise",{reject:function(e){var t=cf(this);return(0,t.reject)(e),t.promise}}),tc(tc.S+!0*tc.F,"Promise",{resolve:function(e){return Vl(this===Kl?af:this,e)}}),tc(tc.S+tc.F*!(lf&&Ql(function(e){af.all(e).catch(uf)})),"Promise",{all:function(e){var t=this,r=cf(t),n=r.resolve,i=r.reject,o=Fl(function(){var r=[],o=0,a=1;yl(e,!1,function(e){var s=o++,u=!1;r.push(void 0),a++,t.resolve(e).then(function(e){u||(u=!0,r[s]=e,--a||n(r))},i)}),--a||n(r)});return o.e&&i(o.v),r.promise},race:function(e){var t=this,r=cf(t),n=r.reject,i=Fl(function(){yl(e,!1,function(e){t.resolve(e).then(r.resolve,n)})});return i.e&&n(i.v),r.promise}}),tc(tc.P+tc.R,"Promise",{finally:function(e){var t=bl(this,Yu.Promise||Gu.Promise),r="function"==typeof e;return this.then(r?function(r){return Vl(t,e()).then(function(){return r})}:e,r?function(r){return Vl(t,e()).then(function(){throw r})}:e)}}),tc(tc.S,"Promise",{try:function(e){var t=Ul.f(this),r=Fl(e);return(r.e?t.reject:t.resolve)(r.v),t.promise}});var yf=Yu.Promise,_f=r(function(e){e.exports={default:yf,__esModule:!0}});t(_f);var bf={f:Object.getOwnPropertySymbols},Ef=Object.assign,Sf=!Ef||Uu(function(){var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(e){t[e]=e}),7!=Ef({},e)[r]||Object.keys(Ef({},t)).join("")!=n})?function(e,t){for(var r=Bc(e),n=arguments.length,i=1,o=bf.f,a=Mu.f;n>i;)for(var s,u=Iu(arguments[i++]),c=o?Pc(u).concat(o(u)):Pc(u),l=c.length,f=0;l>f;)a.call(u,s=c[f++])&&(r[s]=u[s]);return r}:Ef;tc(tc.S+tc.F,"Object",{assign:Sf});var Tf=Yu.Object.assign,wf=r(function(e){e.exports={default:Tf,__esModule:!0}});t(wf);var Of=(Gu.Reflect||{}).apply,kf=Function.apply;tc(tc.S+tc.F*!Uu(function(){Of(function(){})}),"Reflect",{apply:function(e,t,r){var n=$u(e),i=Ju(r);return Of?Of(n,t,i):kf.call(n,t,i)}});var Rf=Yu.Reflect.apply,Af=r(function(e){e.exports={default:Rf,__esModule:!0}});t(Af);var If=Yu.JSON||(Yu.JSON={stringify:JSON.stringify}),Pf=function(e){return If.stringify.apply(If,arguments)},Cf=r(function(e){e.exports={default:Pf,__esModule:!0}});t(Cf);var Mf=function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i};var Nf=function(){this.__data__=[],this.size=0};var Df=function(e,t){return e===t||e!=e&&t!=t};var jf=function(e,t){for(var r=e.length;r--;)if(Df(e[r][0],t))return r;return-1},xf=Array.prototype.splice;var Lf=function(e){var t=this.__data__,r=jf(t,e);return!(r<0||(r==t.length-1?t.pop():xf.call(t,r,1),--this.size,0))};var Uf=function(e){var t=this.__data__,r=jf(t,e);return r<0?void 0:t[r][1]};var Ff=function(e){return jf(this.__data__,e)>-1};var Gf=function(e,t){var r=this.__data__,n=jf(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function qf(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}qf.prototype.clear=Nf,qf.prototype.delete=Lf,qf.prototype.get=Uf,qf.prototype.has=Ff,qf.prototype.set=Gf;var Vf=qf;var Bf=function(){this.__data__=new Vf,this.size=0};var zf=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r};var Wf=function(e){return this.__data__.get(e)};var Hf=function(e){return this.__data__.has(e)},Yf="object"==typeof e&&e&&e.Object===Object&&e,$f="object"==typeof self&&self&&self.Object===Object&&self,Xf=Yf||$f||Function("return this")(),Jf=Xf.Symbol,Kf=Object.prototype,Qf=Kf.hasOwnProperty,Zf=Kf.toString,ed=Jf?Jf.toStringTag:void 0;var td=function(e){var t=Qf.call(e,ed),r=e[ed];try{e[ed]=void 0;var n=!0}catch(e){}var i=Zf.call(e);return n&&(t?e[ed]=r:delete e[ed]),i},rd=Object.prototype.toString;var nd=function(e){return rd.call(e)},id="[object Null]",od="[object Undefined]",ad=Jf?Jf.toStringTag:void 0;var sd=function(e){return null==e?void 0===e?od:id:ad&&ad in Object(e)?td(e):nd(e)};var ud=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},cd="[object AsyncFunction]",ld="[object Function]",fd="[object GeneratorFunction]",dd="[object Proxy]";var pd,hd=function(e){if(!ud(e))return!1;var t=sd(e);return t==ld||t==fd||t==cd||t==dd},vd=Xf["__core-js_shared__"],gd=(pd=/[^.]+$/.exec(vd&&vd.keys&&vd.keys.IE_PROTO||""))?"Symbol(src)_1."+pd:"";var md=function(e){return!!gd&&gd in e},yd=Function.prototype.toString;var _d=function(e){if(null!=e){try{return yd.call(e)}catch(e){}try{return e+""}catch(e){}}return""},bd=/^\[object .+?Constructor\]$/,Ed=Function.prototype,Sd=Object.prototype,Td=Ed.toString,wd=Sd.hasOwnProperty,Od=RegExp("^"+Td.call(wd).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var kd=function(e){return!(!ud(e)||md(e))&&(hd(e)?Od:bd).test(_d(e))};var Rd=function(e,t){return null==e?void 0:e[t]};var Ad=function(e,t){var r=Rd(e,t);return kd(r)?r:void 0},Id=Ad(Xf,"Map"),Pd=Ad(Object,"create");var Cd=function(){this.__data__=Pd?Pd(null):{},this.size=0};var Md=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Nd="__lodash_hash_undefined__",Dd=Object.prototype.hasOwnProperty;var jd=function(e){var t=this.__data__;if(Pd){var r=t[e];return r===Nd?void 0:r}return Dd.call(t,e)?t[e]:void 0},xd=Object.prototype.hasOwnProperty;var Ld=function(e){var t=this.__data__;return Pd?void 0!==t[e]:xd.call(t,e)},Ud="__lodash_hash_undefined__";var Fd=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Pd&&void 0===t?Ud:t,this};function Gd(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Gd.prototype.clear=Cd,Gd.prototype.delete=Md,Gd.prototype.get=jd,Gd.prototype.has=Ld,Gd.prototype.set=Fd;var qd=Gd;var Vd=function(){this.size=0,this.__data__={hash:new qd,map:new(Id||Vf),string:new qd}};var Bd=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var zd=function(e,t){var r=e.__data__;return Bd(t)?r["string"==typeof t?"string":"hash"]:r.map};var Wd=function(e){var t=zd(this,e).delete(e);return this.size-=t?1:0,t};var Hd=function(e){return zd(this,e).get(e)};var Yd=function(e){return zd(this,e).has(e)};var $d=function(e,t){var r=zd(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function Xd(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Xd.prototype.clear=Vd,Xd.prototype.delete=Wd,Xd.prototype.get=Hd,Xd.prototype.has=Yd,Xd.prototype.set=$d;var Jd=Xd,Kd=200;var Qd=function(e,t){var r=this.__data__;if(r instanceof Vf){var n=r.__data__;if(!Id||n.length<Kd-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Jd(n)}return r.set(e,t),this.size=r.size,this};function Zd(e){var t=this.__data__=new Vf(e);this.size=t.size}Zd.prototype.clear=Bf,Zd.prototype.delete=zf,Zd.prototype.get=Wf,Zd.prototype.has=Hf,Zd.prototype.set=Qd;var ep=Zd;var tp=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e},rp=function(){try{var e=Ad(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var np=function(e,t,r){"__proto__"==t&&rp?rp(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r},ip=Object.prototype.hasOwnProperty;var op=function(e,t,r){var n=e[t];ip.call(e,t)&&Df(n,r)&&(void 0!==r||t in e)||np(e,t,r)};var ap=function(e,t,r,n){var i=!r;r||(r={});for(var o=-1,a=t.length;++o<a;){var s=t[o],u=n?n(r[s],e[s],s,r,e):void 0;void 0===u&&(u=e[s]),i?np(r,s,u):op(r,s,u)}return r};var sp=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n};var up=function(e){return null!=e&&"object"==typeof e},cp="[object Arguments]";var lp=function(e){return up(e)&&sd(e)==cp},fp=Object.prototype,dp=fp.hasOwnProperty,pp=fp.propertyIsEnumerable,hp=lp(function(){return arguments}())?lp:function(e){return up(e)&&dp.call(e,"callee")&&!pp.call(e,"callee")},vp=Array.isArray;var gp=function(){return!1},mp=r(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,i=n&&n.exports===r?Xf.Buffer:void 0,o=(i?i.isBuffer:void 0)||gp;e.exports=o}),yp=9007199254740991,_p=/^(?:0|[1-9]\d*)$/;var bp=function(e,t){var r=typeof e;return!!(t=null==t?yp:t)&&("number"==r||"symbol"!=r&&_p.test(e))&&e>-1&&e%1==0&&e<t},Ep=9007199254740991;var Sp=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Ep},Tp={};Tp["[object Float32Array]"]=Tp["[object Float64Array]"]=Tp["[object Int8Array]"]=Tp["[object Int16Array]"]=Tp["[object Int32Array]"]=Tp["[object Uint8Array]"]=Tp["[object Uint8ClampedArray]"]=Tp["[object Uint16Array]"]=Tp["[object Uint32Array]"]=!0,Tp["[object Arguments]"]=Tp["[object Array]"]=Tp["[object ArrayBuffer]"]=Tp["[object Boolean]"]=Tp["[object DataView]"]=Tp["[object Date]"]=Tp["[object Error]"]=Tp["[object Function]"]=Tp["[object Map]"]=Tp["[object Number]"]=Tp["[object Object]"]=Tp["[object RegExp]"]=Tp["[object Set]"]=Tp["[object String]"]=Tp["[object WeakMap]"]=!1;var wp=function(e){return up(e)&&Sp(e.length)&&!!Tp[sd(e)]};var Op=function(e){return function(t){return e(t)}},kp=r(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,i=n&&n.exports===r&&Yf.process,o=function(){try{var e=n&&n.require&&n.require("util").types;return e||i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=o}),Rp=kp&&kp.isTypedArray,Ap=Rp?Op(Rp):wp,Ip=Object.prototype.hasOwnProperty;var Pp=function(e,t){var r=vp(e),n=!r&&hp(e),i=!r&&!n&&mp(e),o=!r&&!n&&!i&&Ap(e),a=r||n||i||o,s=a?sp(e.length,String):[],u=s.length;for(var c in e)!t&&!Ip.call(e,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||bp(c,u))||s.push(c);return s},Cp=Object.prototype;var Mp=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Cp)};var Np=function(e,t){return function(r){return e(t(r))}},Dp=Np(Object.keys,Object),jp=Object.prototype.hasOwnProperty;var xp=function(e){if(!Mp(e))return Dp(e);var t=[];for(var r in Object(e))jp.call(e,r)&&"constructor"!=r&&t.push(r);return t};var Lp=function(e){return null!=e&&Sp(e.length)&&!hd(e)};var Up=function(e){return Lp(e)?Pp(e):xp(e)};var Fp=function(e,t){return e&&ap(t,Up(t),e)};var Gp=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t},qp=Object.prototype.hasOwnProperty;var Vp=function(e){if(!ud(e))return Gp(e);var t=Mp(e),r=[];for(var n in e)("constructor"!=n||!t&&qp.call(e,n))&&r.push(n);return r};var Bp=function(e){return Lp(e)?Pp(e,!0):Vp(e)};var zp=function(e,t){return e&&ap(t,Bp(t),e)},Wp=r(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,i=n&&n.exports===r?Xf.Buffer:void 0,o=i?i.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=o?o(r):new e.constructor(r);return e.copy(n),n}});var Hp=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t};var Yp=function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var a=e[r];t(a,r,e)&&(o[i++]=a)}return o};var $p=function(){return[]},Xp=Object.prototype.propertyIsEnumerable,Jp=Object.getOwnPropertySymbols,Kp=Jp?function(e){return null==e?[]:(e=Object(e),Yp(Jp(e),function(t){return Xp.call(e,t)}))}:$p;var Qp=function(e,t){return ap(e,Kp(e),t)};var Zp=function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e},eh=Np(Object.getPrototypeOf,Object),th=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Zp(t,Kp(e)),e=eh(e);return t}:$p;var rh=function(e,t){return ap(e,th(e),t)};var nh=function(e,t,r){var n=t(e);return vp(e)?n:Zp(n,r(e))};var ih=function(e){return nh(e,Up,Kp)};var oh=function(e){return nh(e,Bp,th)},ah=Ad(Xf,"DataView"),sh=Ad(Xf,"Promise"),uh=Ad(Xf,"Set"),ch=Ad(Xf,"WeakMap"),lh=_d(ah),fh=_d(Id),dh=_d(sh),ph=_d(uh),hh=_d(ch),vh=sd;(ah&&"[object DataView]"!=vh(new ah(new ArrayBuffer(1)))||Id&&"[object Map]"!=vh(new Id)||sh&&"[object Promise]"!=vh(sh.resolve())||uh&&"[object Set]"!=vh(new uh)||ch&&"[object WeakMap]"!=vh(new ch))&&(vh=function(e){var t=sd(e),r="[object Object]"==t?e.constructor:void 0,n=r?_d(r):"";if(n)switch(n){case lh:return"[object DataView]";case fh:return"[object Map]";case dh:return"[object Promise]";case ph:return"[object Set]";case hh:return"[object WeakMap]"}return t});var gh=vh,mh=Object.prototype.hasOwnProperty;var yh=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&mh.call(e,"index")&&(r.index=e.index,r.input=e.input),r},_h=Xf.Uint8Array;var bh=function(e){var t=new e.constructor(e.byteLength);return new _h(t).set(new _h(e)),t};var Eh=function(e,t){var r=t?bh(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)},Sh=/\w*$/;var Th=function(e){var t=new e.constructor(e.source,Sh.exec(e));return t.lastIndex=e.lastIndex,t},wh=Jf?Jf.prototype:void 0,Oh=wh?wh.valueOf:void 0;var kh=function(e){return Oh?Object(Oh.call(e)):{}};var Rh=function(e,t){var r=t?bh(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)},Ah="[object Boolean]",Ih="[object Date]",Ph="[object Map]",Ch="[object Number]",Mh="[object RegExp]",Nh="[object Set]",Dh="[object String]",jh="[object Symbol]",xh="[object ArrayBuffer]",Lh="[object DataView]",Uh="[object Float32Array]",Fh="[object Float64Array]",Gh="[object Int8Array]",qh="[object Int16Array]",Vh="[object Int32Array]",Bh="[object Uint8Array]",zh="[object Uint8ClampedArray]",Wh="[object Uint16Array]",Hh="[object Uint32Array]";var Yh=function(e,t,r){var n=e.constructor;switch(t){case xh:return bh(e);case Ah:case Ih:return new n(+e);case Lh:return Eh(e,r);case Uh:case Fh:case Gh:case qh:case Vh:case Bh:case zh:case Wh:case Hh:return Rh(e,r);case Ph:return new n;case Ch:case Dh:return new n(e);case Mh:return Th(e);case Nh:return new n;case jh:return kh(e)}},$h=Object.create,Xh=function(){function e(){}return function(t){if(!ud(t))return{};if($h)return $h(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();var Jh=function(e){return"function"!=typeof e.constructor||Mp(e)?{}:Xh(eh(e))},Kh="[object Map]";var Qh=function(e){return up(e)&&gh(e)==Kh},Zh=kp&&kp.isMap,ev=Zh?Op(Zh):Qh,tv="[object Set]";var rv=function(e){return up(e)&&gh(e)==tv},nv=kp&&kp.isSet,iv=nv?Op(nv):rv,ov=1,av=2,sv=4,uv="[object Arguments]",cv="[object Function]",lv="[object GeneratorFunction]",fv="[object Object]",dv={};dv[uv]=dv["[object Array]"]=dv["[object ArrayBuffer]"]=dv["[object DataView]"]=dv["[object Boolean]"]=dv["[object Date]"]=dv["[object Float32Array]"]=dv["[object Float64Array]"]=dv["[object Int8Array]"]=dv["[object Int16Array]"]=dv["[object Int32Array]"]=dv["[object Map]"]=dv["[object Number]"]=dv[fv]=dv["[object RegExp]"]=dv["[object Set]"]=dv["[object String]"]=dv["[object Symbol]"]=dv["[object Uint8Array]"]=dv["[object Uint8ClampedArray]"]=dv["[object Uint16Array]"]=dv["[object Uint32Array]"]=!0,dv["[object Error]"]=dv[cv]=dv["[object WeakMap]"]=!1;var pv=function e(t,r,n,i,o,a){var s,u=r&ov,c=r&av,l=r&sv;if(n&&(s=o?n(t,i,o,a):n(t)),void 0!==s)return s;if(!ud(t))return t;var f=vp(t);if(f){if(s=yh(t),!u)return Hp(t,s)}else{var d=gh(t),p=d==cv||d==lv;if(mp(t))return Wp(t,u);if(d==fv||d==uv||p&&!o){if(s=c||p?{}:Jh(t),!u)return c?rh(t,zp(s,t)):Qp(t,Fp(s,t))}else{if(!dv[d])return o?t:{};s=Yh(t,d,u)}}a||(a=new ep);var h=a.get(t);if(h)return h;if(a.set(t,s),iv(t))return t.forEach(function(i){s.add(e(i,r,n,i,t,a))}),s;if(ev(t))return t.forEach(function(i,o){s.set(o,e(i,r,n,o,t,a))}),s;var v=l?c?oh:ih:c?keysIn:Up,g=f?void 0:v(t);return tp(g||t,function(i,o){g&&(i=t[o=i]),op(s,o,e(i,r,n,o,t,a))}),s},hv="[object Symbol]";var vv=function(e){return"symbol"==typeof e||up(e)&&sd(e)==hv},gv=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,mv=/^\w*$/;var yv=function(e,t){if(vp(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!vv(e))||mv.test(e)||!gv.test(e)||null!=t&&e in Object(t)},_v="Expected a function";function bv(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(_v);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var a=e.apply(this,n);return r.cache=o.set(i,a)||o,a};return r.cache=new(bv.Cache||Jd),r}bv.Cache=Jd;var Ev=bv,Sv=500;var Tv=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,wv=/\\(\\)?/g,Ov=function(e){var t=Ev(e,function(e){return r.size===Sv&&r.clear(),e}),r=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Tv,function(e,r,n,i){t.push(n?i.replace(wv,"$1"):r||e)}),t}),kv=1/0,Rv=Jf?Jf.prototype:void 0,Av=Rv?Rv.toString:void 0;var Iv=function e(t){if("string"==typeof t)return t;if(vp(t))return Mf(t,e)+"";if(vv(t))return Av?Av.call(t):"";var r=t+"";return"0"==r&&1/t==-kv?"-0":r};var Pv=function(e){return null==e?"":Iv(e)};var Cv=function(e,t){return vp(e)?e:yv(e,t)?[e]:Ov(Pv(e))};var Mv=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0},Nv=1/0;var Dv=function(e){if("string"==typeof e||vv(e))return e;var t=e+"";return"0"==t&&1/e==-Nv?"-0":t};var jv=function(e,t){for(var r=0,n=(t=Cv(t,e)).length;null!=e&&r<n;)e=e[Dv(t[r++])];return r&&r==n?e:void 0};var xv=function(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(i);++n<i;)o[n]=e[n+t];return o};var Lv=function(e,t){return t.length<2?e:jv(e,xv(t,0,-1))};var Uv=function(e,t){return t=Cv(t,e),null==(e=Lv(e,t))||delete e[Dv(Mv(t))]},Fv="[object Object]",Gv=Function.prototype,qv=Object.prototype,Vv=Gv.toString,Bv=qv.hasOwnProperty,zv=Vv.call(Object);var Wv=function(e){if(!up(e)||sd(e)!=Fv)return!1;var t=eh(e);if(null===t)return!0;var r=Bv.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&Vv.call(r)==zv};var Hv=function(e){return Wv(e)?void 0:e},Yv=Jf?Jf.isConcatSpreadable:void 0;var $v=function(e){return vp(e)||hp(e)||!!(Yv&&e&&e[Yv])};var Xv=function e(t,r,n,i,o){var a=-1,s=t.length;for(n||(n=$v),o||(o=[]);++a<s;){var u=t[a];r>0&&n(u)?r>1?e(u,r-1,n,i,o):Zp(o,u):i||(o[o.length]=u)}return o};var Jv=function(e){return null!=e&&e.length?Xv(e,1):[]};var Kv=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)},Qv=Math.max;var Zv=function(e,t,r){return t=Qv(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,o=Qv(n.length-t,0),a=Array(o);++i<o;)a[i]=n[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=n[i];return s[t]=r(a),Kv(e,this,s)}};var eg=function(e){return function(){return e}};var tg=function(e){return e},rg=rp?function(e,t){return rp(e,"toString",{configurable:!0,enumerable:!1,value:eg(t),writable:!0})}:tg,ng=800,ig=16,og=Date.now;var ag=function(e){var t=0,r=0;return function(){var n=og(),i=ig-(n-r);if(r=n,i>0){if(++t>=ng)return arguments[0]}else t=0;return e.apply(void 0,arguments)}},sg=ag(rg);var ug=function(e){return sg(Zv(e,void 0,Jv),e+"")},cg=ug(function(e,t){var r={};if(null==e)return r;var n=!1;t=Mf(t,function(t){return t=Cv(t,e),n||(n=t.length>1),t}),ap(e,oh(e),r),n&&(r=pv(r,7,Hv));for(var i=t.length;i--;)Uv(r,t[i]);return r}),lg="[object Map]",fg="[object Set]",dg=Object.prototype.hasOwnProperty;var pg=function(e){if(null==e)return!0;if(Lp(e)&&(vp(e)||"string"==typeof e||"function"==typeof e.splice||mp(e)||Ap(e)||hp(e)))return!e.length;var t=gh(e);if(t==lg||t==fg)return!e.size;if(Mp(e))return!xp(e).length;for(var r in e)if(dg.call(e,r))return!1;return!0},hg=1,vg=4;var gg=function(e){return pv(e,hg|vg)};function mg(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var yg=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function _g(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}}function bg(e,t,r,n){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?Eg(Sg(e),function(n){var i=encodeURIComponent(_g(n))+r;return yg(e[n])?Eg(e[n],function(e){return i+encodeURIComponent(_g(e))}).join(t):i+encodeURIComponent(_g(e[n]))}).join(t):n?encodeURIComponent(_g(n))+r+encodeURIComponent(_g(e)):""}function Eg(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var Sg=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t};function Tg(e,t,r,n){t=t||"&",r=r||"=";var i={};if("string"!=typeof e||0===e.length)return i;var o=/\+/g;e=e.split(t);var a=1e3;n&&"number"==typeof n.maxKeys&&(a=n.maxKeys);var s=e.length;a>0&&s>a&&(s=a);for(var u=0;u<s;++u){var c,l,f,d,p=e[u].replace(o,"%20"),h=p.indexOf(r);h>=0?(c=p.substr(0,h),l=p.substr(h+1)):(c=p,l=""),f=decodeURIComponent(c),d=decodeURIComponent(l),mg(i,f)?yg(i[f])?i[f].push(d):i[f]=[i[f],d]:i[f]=d}return i}var wg={encode:bg,stringify:bg,decode:Tg,parse:Tg},Og=2147483647,kg=36,Rg=1,Ag=26,Ig=38,Pg=700,Cg=72,Mg=128,Ng="-",Dg=/[^\x20-\x7E]/,jg=/[\x2E\u3002\uFF0E\uFF61]/g,xg={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Lg=kg-Rg,Ug=Math.floor,Fg=String.fromCharCode;function Gg(e){throw new RangeError(xg[e])}function qg(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function Vg(e,t,r){var n=0;for(e=r?Ug(e/Pg):e>>1,e+=Ug(e/t);e>Lg*Ag>>1;n+=kg)e=Ug(e/Lg);return Ug(n+(Lg+1)*e/(e+Ig))}function Bg(e){return function(e,t){var r=e.split("@"),n="";r.length>1&&(n=r[0]+"@",e=r[1]);var i=function(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}((e=e.replace(jg,".")).split("."),t).join(".");return n+i}(e,function(e){return Dg.test(e)?"xn--"+function(e){var t,r,n,i,o,a,s,u,c,l,f,d,p,h,v,g=[];for(d=(e=function(e){for(var t,r,n=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}(e)).length,t=Mg,r=0,o=Cg,a=0;a<d;++a)(f=e[a])<128&&g.push(Fg(f));for(n=i=g.length,i&&g.push(Ng);n<d;){for(s=Og,a=0;a<d;++a)(f=e[a])>=t&&f<s&&(s=f);for(s-t>Ug((Og-r)/(p=n+1))&&Gg("overflow"),r+=(s-t)*p,t=s,a=0;a<d;++a)if((f=e[a])<t&&++r>Og&&Gg("overflow"),f==t){for(u=r,c=kg;!(u<(l=c<=o?Rg:c>=o+Ag?Ag:c-o));c+=kg)v=u-l,h=kg-l,g.push(Fg(qg(l+v%h,0))),u=Ug(v/h);g.push(Fg(qg(u,0))),o=Vg(r,p,n==i),r=0,++n}++r,++t}return g.join("")}(e):e})}var zg=[],Wg=[],Hg="undefined"!=typeof Uint8Array?Uint8Array:Array,Yg=!1;function $g(){Yg=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,r=e.length;t<r;++t)zg[t]=e[t],Wg[e.charCodeAt(t)]=t;Wg["-".charCodeAt(0)]=62,Wg["_".charCodeAt(0)]=63}function Xg(e,t,r){for(var n,i,o=[],a=t;a<r;a+=3)n=(e[a]<<16)+(e[a+1]<<8)+e[a+2],o.push(zg[(i=n)>>18&63]+zg[i>>12&63]+zg[i>>6&63]+zg[63&i]);return o.join("")}function Jg(e){var t;Yg||$g();for(var r=e.length,n=r%3,i="",o=[],a=0,s=r-n;a<s;a+=16383)o.push(Xg(e,a,a+16383>s?s:a+16383));return 1===n?(t=e[r-1],i+=zg[t>>2],i+=zg[t<<4&63],i+="=="):2===n&&(t=(e[r-2]<<8)+e[r-1],i+=zg[t>>10],i+=zg[t>>4&63],i+=zg[t<<2&63],i+="="),o.push(i),o.join("")}function Kg(e,t,r,n,i){var o,a,s=8*i-n-1,u=(1<<s)-1,c=u>>1,l=-7,f=r?i-1:0,d=r?-1:1,p=e[t+f];for(f+=d,o=p&(1<<-l)-1,p>>=-l,l+=s;l>0;o=256*o+e[t+f],f+=d,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=n;l>0;a=256*a+e[t+f],f+=d,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),o-=c}return(p?-1:1)*a*Math.pow(2,o-n)}function Qg(e,t,r,n,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,h=n?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+f>=1?d/u:d*Math.pow(2,1-f))*u>=2&&(a++,u/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(t*u-1)*Math.pow(2,i),a+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;e[r+p]=255&s,p+=h,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[r+p]=255&a,p+=h,a/=256,c-=8);e[r+p-h]|=128*v}var Zg={}.toString,em=Array.isArray||function(e){return"[object Array]"==Zg.call(e)};function tm(){return nm.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function rm(e,t){if(tm()<t)throw new RangeError("Invalid typed array length");return nm.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=nm.prototype:(null===e&&(e=new nm(t)),e.length=t),e}function nm(e,t,r){if(!(nm.TYPED_ARRAY_SUPPORT||this instanceof nm))return new nm(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return am(this,e)}return im(this,e,t,r)}function im(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);nm.TYPED_ARRAY_SUPPORT?(e=t).__proto__=nm.prototype:e=sm(e,t);return e}(e,t,r,n):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!nm.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|lm(t,r),i=(e=rm(e,n)).write(t,r);i!==n&&(e=e.slice(0,i));return e}(e,t,r):function(e,t){if(cm(t)){var r=0|um(t.length);return 0===(e=rm(e,r)).length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(n=t.length)!=n?rm(e,0):sm(e,t);if("Buffer"===t.type&&em(t.data))return sm(e,t.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function om(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function am(e,t){if(om(t),e=rm(e,t<0?0:0|um(t)),!nm.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function sm(e,t){var r=t.length<0?0:0|um(t.length);e=rm(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function um(e){if(e>=tm())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+tm().toString(16)+" bytes");return 0|e}function cm(e){return!(null==e||!e._isBuffer)}function lm(e,t){if(cm(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return xm(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Lm(e).length;default:if(n)return xm(e).length;t=(""+t).toLowerCase(),n=!0}}function fm(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function dm(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=nm.from(t,n)),cm(t))return 0===t.length?-1:pm(e,t,r,n,i);if("number"==typeof t)return t&=255,nm.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):pm(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function pm(e,t,r,n,i){var o,a=1,s=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,r/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var l=-1;for(o=r;o<s;o++)if(c(e,o)===c(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(r+u>s&&(r=s-u),o=r;o>=0;o--){for(var f=!0,d=0;d<u;d++)if(c(e,o+d)!==c(t,d)){f=!1;break}if(f)return o}return-1}function hm(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var a=0;a<n;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[r+a]=s}return a}function vm(e,t,r,n){return Um(xm(t,e.length-r),e,r,n)}function gm(e,t,r,n){return Um(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function mm(e,t,r,n){return gm(e,t,r,n)}function ym(e,t,r,n){return Um(Lm(t),e,r,n)}function _m(e,t,r,n){return Um(function(e,t){for(var r,n,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function bm(e,t,r){return 0===t&&r===e.length?Jg(e):Jg(e.slice(t,r))}function Em(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,a,s,u,c=e[i],l=null,f=c>239?4:c>223?3:c>191?2:1;if(i+f<=r)switch(f){case 1:c<128&&(l=c);break;case 2:128==(192&(o=e[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(u=(15&c)<<12|(63&o)<<6|63&a)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(u=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(l=u)}null===l?(l=65533,f=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),i+=f}return function(e){var t=e.length;if(t<=Sm)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=Sm));return r}(n)}nm.TYPED_ARRAY_SUPPORT=void 0===tu.TYPED_ARRAY_SUPPORT||tu.TYPED_ARRAY_SUPPORT,nm.poolSize=8192,nm._augment=function(e){return e.__proto__=nm.prototype,e},nm.from=function(e,t,r){return im(null,e,t,r)},nm.TYPED_ARRAY_SUPPORT&&(nm.prototype.__proto__=Uint8Array.prototype,nm.__proto__=Uint8Array),nm.alloc=function(e,t,r){return function(e,t,r,n){return om(t),t<=0?rm(e,t):void 0!==r?"string"==typeof n?rm(e,t).fill(r,n):rm(e,t).fill(r):rm(e,t)}(null,e,t,r)},nm.allocUnsafe=function(e){return am(null,e)},nm.allocUnsafeSlow=function(e){return am(null,e)},nm.isBuffer=Fm,nm.compare=function(e,t){if(!cm(e)||!cm(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},nm.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},nm.concat=function(e,t){if(!em(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return nm.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=nm.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var o=e[r];if(!cm(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},nm.byteLength=lm,nm.prototype._isBuffer=!0,nm.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)fm(this,t,t+1);return this},nm.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)fm(this,t,t+3),fm(this,t+1,t+2);return this},nm.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)fm(this,t,t+7),fm(this,t+1,t+6),fm(this,t+2,t+5),fm(this,t+3,t+4);return this},nm.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?Em(this,0,e):function(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return Om(this,t,r);case"utf8":case"utf-8":return Em(this,t,r);case"ascii":return Tm(this,t,r);case"latin1":case"binary":return wm(this,t,r);case"base64":return bm(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return km(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}.apply(this,arguments)},nm.prototype.equals=function(e){if(!cm(e))throw new TypeError("Argument must be a Buffer");return this===e||0===nm.compare(this,e)},nm.prototype.inspect=function(){var e="";return this.length>0&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(e+=" ... ")),"<Buffer "+e+">"},nm.prototype.compare=function(e,t,r,n,i){if(!cm(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0),s=Math.min(o,a),u=this.slice(n,i),c=e.slice(t,r),l=0;l<s;++l)if(u[l]!==c[l]){o=u[l],a=c[l];break}return o<a?-1:a<o?1:0},nm.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},nm.prototype.indexOf=function(e,t,r){return dm(this,e,t,r,!0)},nm.prototype.lastIndexOf=function(e,t,r){return dm(this,e,t,r,!1)},nm.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return hm(this,e,t,r);case"utf8":case"utf-8":return vm(this,e,t,r);case"ascii":return gm(this,e,t,r);case"latin1":case"binary":return mm(this,e,t,r);case"base64":return ym(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _m(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},nm.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Sm=4096;function Tm(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function wm(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function Om(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=jm(e[o]);return i}function km(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function Rm(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function Am(e,t,r,n,i,o){if(!cm(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function Im(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function Pm(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function Cm(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function Mm(e,t,r,n,i){return i||Cm(e,0,r,4),Qg(e,t,r,n,23,4),r+4}function Nm(e,t,r,n,i){return i||Cm(e,0,r,8),Qg(e,t,r,n,52,8),r+8}nm.prototype.slice=function(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),nm.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=nm.prototype;else{var i=t-e;r=new nm(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+e]}return r},nm.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||Rm(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},nm.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||Rm(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},nm.prototype.readUInt8=function(e,t){return t||Rm(e,1,this.length),this[e]},nm.prototype.readUInt16LE=function(e,t){return t||Rm(e,2,this.length),this[e]|this[e+1]<<8},nm.prototype.readUInt16BE=function(e,t){return t||Rm(e,2,this.length),this[e]<<8|this[e+1]},nm.prototype.readUInt32LE=function(e,t){return t||Rm(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},nm.prototype.readUInt32BE=function(e,t){return t||Rm(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},nm.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||Rm(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},nm.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||Rm(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},nm.prototype.readInt8=function(e,t){return t||Rm(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},nm.prototype.readInt16LE=function(e,t){t||Rm(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},nm.prototype.readInt16BE=function(e,t){t||Rm(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},nm.prototype.readInt32LE=function(e,t){return t||Rm(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},nm.prototype.readInt32BE=function(e,t){return t||Rm(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},nm.prototype.readFloatLE=function(e,t){return t||Rm(e,4,this.length),Kg(this,e,!0,23,4)},nm.prototype.readFloatBE=function(e,t){return t||Rm(e,4,this.length),Kg(this,e,!1,23,4)},nm.prototype.readDoubleLE=function(e,t){return t||Rm(e,8,this.length),Kg(this,e,!0,52,8)},nm.prototype.readDoubleBE=function(e,t){return t||Rm(e,8,this.length),Kg(this,e,!1,52,8)},nm.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||Am(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},nm.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||Am(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},nm.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||Am(this,e,t,1,255,0),nm.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},nm.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||Am(this,e,t,2,65535,0),nm.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):Im(this,e,t,!0),t+2},nm.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||Am(this,e,t,2,65535,0),nm.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):Im(this,e,t,!1),t+2},nm.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||Am(this,e,t,4,4294967295,0),nm.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):Pm(this,e,t,!0),t+4},nm.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||Am(this,e,t,4,4294967295,0),nm.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):Pm(this,e,t,!1),t+4},nm.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);Am(this,e,t,r,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<r&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},nm.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);Am(this,e,t,r,i-1,-i)}var o=r-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},nm.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||Am(this,e,t,1,127,-128),nm.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},nm.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||Am(this,e,t,2,32767,-32768),nm.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):Im(this,e,t,!0),t+2},nm.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||Am(this,e,t,2,32767,-32768),nm.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):Im(this,e,t,!1),t+2},nm.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||Am(this,e,t,4,2147483647,-2147483648),nm.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):Pm(this,e,t,!0),t+4},nm.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||Am(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),nm.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):Pm(this,e,t,!1),t+4},nm.prototype.writeFloatLE=function(e,t,r){return Mm(this,e,t,!0,r)},nm.prototype.writeFloatBE=function(e,t,r){return Mm(this,e,t,!1,r)},nm.prototype.writeDoubleLE=function(e,t,r){return Nm(this,e,t,!0,r)},nm.prototype.writeDoubleBE=function(e,t,r){return Nm(this,e,t,!1,r)},nm.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,o=n-r;if(this===e&&r<t&&t<n)for(i=o-1;i>=0;--i)e[i+t]=this[i+r];else if(o<1e3||!nm.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},nm.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!nm.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var a=cm(e)?e:xm(new nm(e,n).toString()),s=a.length;for(o=0;o<r-t;++o)this[o+t]=a[o%s]}return this};var Dm=/[^+\/0-9A-Za-z-_]/g;function jm(e){return e<16?"0"+e.toString(16):e.toString(16)}function xm(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function Lm(e){return function(e){var t,r,n,i,o,a;Yg||$g();var s=e.length;if(s%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o="="===e[s-2]?2:"="===e[s-1]?1:0,a=new Hg(3*s/4-o),n=o>0?s-4:s;var u=0;for(t=0,r=0;t<n;t+=4,r+=3)i=Wg[e.charCodeAt(t)]<<18|Wg[e.charCodeAt(t+1)]<<12|Wg[e.charCodeAt(t+2)]<<6|Wg[e.charCodeAt(t+3)],a[u++]=i>>16&255,a[u++]=i>>8&255,a[u++]=255&i;return 2===o?(i=Wg[e.charCodeAt(t)]<<2|Wg[e.charCodeAt(t+1)]>>4,a[u++]=255&i):1===o&&(i=Wg[e.charCodeAt(t)]<<10|Wg[e.charCodeAt(t+1)]<<4|Wg[e.charCodeAt(t+2)]>>2,a[u++]=i>>8&255,a[u++]=255&i),a}(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(Dm,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function Um(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function Fm(e){return null!=e&&(!!e._isBuffer||Gm(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&Gm(e.slice(0,0))}(e))}function Gm(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}var qm="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e},Vm=/%[sdj%]/g;function Bm(e){if(!oy(e)){for(var t=[],r=0;r<arguments.length;r++)t.push($m(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,i=n.length,o=String(e).replace(Vm,function(e){if("%%"===e)return"%";if(r>=i)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}}),a=n[r];r<i;a=n[++r])ry(a)||!uy(a)?o+=" "+a:o+=" "+$m(a);return o}function zm(e,t){if(ay(tu.process))return function(){return zm(e,t).apply(this,arguments)};var r=!1;return function(){return r||(console.error(t),r=!0),e.apply(this,arguments)}}var Wm,Hm={};function Ym(e){if(ay(Wm)&&(Wm=""),e=e.toUpperCase(),!Hm[e])if(new RegExp("\\b"+e+"\\b","i").test(Wm)){Hm[e]=function(){var t=Bm.apply(null,arguments);console.error("%s %d: %s",e,0,t)}}else Hm[e]=function(){};return Hm[e]}function $m(e,t){var r={seen:[],stylize:Jm};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),ty(t)?r.showHidden=t:t&&vy(r,t),ay(r.showHidden)&&(r.showHidden=!1),ay(r.depth)&&(r.depth=2),ay(r.colors)&&(r.colors=!1),ay(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=Xm),Km(r,e,r.depth)}function Xm(e,t){var r=$m.styles[t];return r?"["+$m.colors[r][0]+"m"+e+"["+$m.colors[r][1]+"m":e}function Jm(e,t){return e}function Km(e,t,r){if(e.customInspect&&t&&fy(t.inspect)&&t.inspect!==$m&&(!t.constructor||t.constructor.prototype!==t)){var n=t.inspect(r,e);return oy(n)||(n=Km(e,n,r)),n}var i=function(e,t){if(ay(t))return e.stylize("undefined","undefined");if(oy(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(iy(t))return e.stylize(""+t,"number");if(ty(t))return e.stylize(""+t,"boolean");if(ry(t))return e.stylize("null","null")}(e,t);if(i)return i;var o=Object.keys(t),a=function(e){var t={};return e.forEach(function(e,r){t[e]=!0}),t}(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(t)),ly(t)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return Qm(t);if(0===o.length){if(fy(t)){var s=t.name?": "+t.name:"";return e.stylize("[Function"+s+"]","special")}if(sy(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(cy(t))return e.stylize(Date.prototype.toString.call(t),"date");if(ly(t))return Qm(t)}var u,c="",l=!1,f=["{","}"];(ey(t)&&(l=!0,f=["[","]"]),fy(t))&&(c=" [Function"+(t.name?": "+t.name:"")+"]");return sy(t)&&(c=" "+RegExp.prototype.toString.call(t)),cy(t)&&(c=" "+Date.prototype.toUTCString.call(t)),ly(t)&&(c=" "+Qm(t)),0!==o.length||l&&0!=t.length?r<0?sy(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),u=l?function(e,t,r,n,i){for(var o=[],a=0,s=t.length;a<s;++a)gy(t,String(a))?o.push(Zm(e,t,r,n,String(a),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(Zm(e,t,r,n,i,!0))}),o}(e,t,r,a,o):o.map(function(n){return Zm(e,t,r,a,n,l)}),e.seen.pop(),function(e,t,r){if(e.reduce(function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(u,c,f)):f[0]+c+f[1]}function Qm(e){return"["+Error.prototype.toString.call(e)+"]"}function Zm(e,t,r,n,i,o){var a,s,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),gy(n,i)||(a="["+i+"]"),s||(e.seen.indexOf(u.value)<0?(s=ry(r)?Km(e,u.value,null):Km(e,u.value,r-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")):s=e.stylize("[Circular]","special")),ay(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function ey(e){return Array.isArray(e)}function ty(e){return"boolean"==typeof e}function ry(e){return null===e}function ny(e){return null==e}function iy(e){return"number"==typeof e}function oy(e){return"string"==typeof e}function ay(e){return void 0===e}function sy(e){return uy(e)&&"[object RegExp]"===dy(e)}function uy(e){return"object"==typeof e&&null!==e}function cy(e){return uy(e)&&"[object Date]"===dy(e)}function ly(e){return uy(e)&&("[object Error]"===dy(e)||e instanceof Error)}function fy(e){return"function"==typeof e}function dy(e){return Object.prototype.toString.call(e)}function py(e){return e<10?"0"+e.toString(10):e.toString(10)}$m.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},$m.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};var hy=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function vy(e,t){if(!t||!uy(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}function gy(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var my={inherits:qm,_extend:vy,log:function(){var e,t;console.log("%s - %s",(e=new Date,t=[py(e.getHours()),py(e.getMinutes()),py(e.getSeconds())].join(":"),[e.getDate(),hy[e.getMonth()],t].join(" ")),Bm.apply(null,arguments))},isBuffer:function(e){return Fm(e)},isPrimitive:function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},isFunction:fy,isError:ly,isDate:cy,isObject:uy,isRegExp:sy,isUndefined:ay,isSymbol:function(e){return"symbol"==typeof e},isString:oy,isNumber:iy,isNullOrUndefined:ny,isNull:ry,isBoolean:ty,isArray:ey,inspect:$m,deprecate:zm,format:Bm,debuglog:Ym},yy={parse:Ny,resolve:function(e,t){return Ny(e,!1,!0).resolve(t)},resolveObject:function(e,t){return e?Ny(e,!1,!0).resolveObject(t):t},format:function(e){oy(e)&&(e=Dy({},e));return jy(e)},Url:_y};function _y(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var by=/^([a-z0-9.+-]+:)/i,Ey=/:[0-9]*$/,Sy=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Ty=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),wy=["'"].concat(Ty),Oy=["%","/","?",";","#"].concat(wy),ky=["/","?","#"],Ry=255,Ay=/^[+a-z0-9A-Z_-]{0,63}$/,Iy=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Py={javascript:!0,"javascript:":!0},Cy={javascript:!0,"javascript:":!0},My={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function Ny(e,t,r){if(e&&uy(e)&&e instanceof _y)return e;var n=new _y;return n.parse(e,t,r),n}function Dy(e,t,r,n){if(!oy(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var i=t.indexOf("?"),o=-1!==i&&i<t.indexOf("#")?"?":"#",a=t.split(o);a[0]=a[0].replace(/\\/g,"/");var s=t=a.join(o);if(s=s.trim(),!n&&1===t.split("#").length){var u=Sy.exec(s);if(u)return e.path=s,e.href=s,e.pathname=u[1],u[2]?(e.search=u[2],e.query=r?Tg(e.search.substr(1)):e.search.substr(1)):r&&(e.search="",e.query={}),e}var c,l,f,d,p=by.exec(s);if(p){var h=(p=p[0]).toLowerCase();e.protocol=h,s=s.substr(p.length)}if(n||p||s.match(/^\/\/[^@\/]+@[^@\/]+/)){var v="//"===s.substr(0,2);!v||p&&Cy[p]||(s=s.substr(2),e.slashes=!0)}if(!Cy[p]&&(v||p&&!My[p])){var g,m,y=-1;for(c=0;c<ky.length;c++)-1!==(l=s.indexOf(ky[c]))&&(-1===y||l<y)&&(y=l);for(-1!==(m=-1===y?s.lastIndexOf("@"):s.lastIndexOf("@",y))&&(g=s.slice(0,m),s=s.slice(m+1),e.auth=decodeURIComponent(g)),y=-1,c=0;c<Oy.length;c++)-1!==(l=s.indexOf(Oy[c]))&&(-1===y||l<y)&&(y=l);-1===y&&(y=s.length),e.host=s.slice(0,y),s=s.slice(y),xy(e),e.hostname=e.hostname||"";var _="["===e.hostname[0]&&"]"===e.hostname[e.hostname.length-1];if(!_){var b=e.hostname.split(/\./);for(c=0,f=b.length;c<f;c++){var E=b[c];if(E&&!E.match(Ay)){for(var S="",T=0,w=E.length;T<w;T++)E.charCodeAt(T)>127?S+="x":S+=E[T];if(!S.match(Ay)){var O=b.slice(0,c),k=b.slice(c+1),R=E.match(Iy);R&&(O.push(R[1]),k.unshift(R[2])),k.length&&(s="/"+k.join(".")+s),e.hostname=O.join(".");break}}}}e.hostname.length>Ry?e.hostname="":e.hostname=e.hostname.toLowerCase(),_||(e.hostname=Bg(e.hostname)),d=e.port?":"+e.port:"";var A=e.hostname||"";e.host=A+d,e.href+=e.host,_&&(e.hostname=e.hostname.substr(1,e.hostname.length-2),"/"!==s[0]&&(s="/"+s))}if(!Py[h])for(c=0,f=wy.length;c<f;c++){var I=wy[c];if(-1!==s.indexOf(I)){var P=encodeURIComponent(I);P===I&&(P=escape(I)),s=s.split(I).join(P)}}var C=s.indexOf("#");-1!==C&&(e.hash=s.substr(C),s=s.slice(0,C));var M=s.indexOf("?");if(-1!==M?(e.search=s.substr(M),e.query=s.substr(M+1),r&&(e.query=Tg(e.query)),s=s.slice(0,M)):r&&(e.search="",e.query={}),s&&(e.pathname=s),My[h]&&e.hostname&&!e.pathname&&(e.pathname="/"),e.pathname||e.search){d=e.pathname||"";var N=e.search||"";e.path=d+N}return e.href=jy(e),e}function jy(e){var t=e.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var r=e.protocol||"",n=e.pathname||"",i=e.hash||"",o=!1,a="";e.host?o=t+e.host:e.hostname&&(o=t+(-1===e.hostname.indexOf(":")?e.hostname:"["+this.hostname+"]"),e.port&&(o+=":"+e.port)),e.query&&uy(e.query)&&Object.keys(e.query).length&&(a=bg(e.query));var s=e.search||a&&"?"+a||"";return r&&":"!==r.substr(-1)&&(r+=":"),e.slashes||(!r||My[r])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),i&&"#"!==i.charAt(0)&&(i="#"+i),s&&"?"!==s.charAt(0)&&(s="?"+s),r+o+(n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(s=s.replace("#","%23"))+i}function xy(e){var t=e.host,r=Ey.exec(t);r&&(":"!==(r=r[0])&&(e.port=r.substr(1)),t=t.substr(0,t.length-r.length)),t&&(e.hostname=t)}_y.prototype.parse=function(e,t,r){return Dy(this,e,t,r)},_y.prototype.format=function(){return jy(this)},_y.prototype.resolve=function(e){return this.resolveObject(Ny(e,!1,!0)).format()},_y.prototype.resolveObject=function(e){if(oy(e)){var t=new _y;t.parse(e,!1,!0),e=t}for(var r,n=new _y,i=Object.keys(this),o=0;o<i.length;o++){var a=i[o];n[a]=this[a]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),u=0;u<s.length;u++){var c=s[u];"protocol"!==c&&(n[c]=e[c])}return My[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!My[e.protocol]){for(var l=Object.keys(e),f=0;f<l.length;f++){var d=l[f];n[d]=e[d]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||Cy[e.protocol])n.pathname=e.pathname;else{for(r=(e.pathname||"").split("/");r.length&&!(e.host=r.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==r[0]&&r.unshift(""),r.length<2&&r.unshift(""),n.pathname=r.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var p=n.pathname||"",h=n.search||"";n.path=p+h}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var v,g=n.pathname&&"/"===n.pathname.charAt(0),m=e.host||e.pathname&&"/"===e.pathname.charAt(0),y=m||g||n.host&&e.pathname,_=y,b=n.pathname&&n.pathname.split("/")||[],E=n.protocol&&!My[n.protocol];if(r=e.pathname&&e.pathname.split("/")||[],E&&(n.hostname="",n.port=null,n.host&&(""===b[0]?b[0]=n.host:b.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===r[0]?r[0]=e.host:r.unshift(e.host)),e.host=null),y=y&&(""===r[0]||""===b[0])),m)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,b=r;else if(r.length)b||(b=[]),b.pop(),b=b.concat(r),n.search=e.search,n.query=e.query;else if(!ny(e.search))return E&&(n.hostname=n.host=b.shift(),(v=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=v.shift(),n.host=n.hostname=v.shift())),n.search=e.search,n.query=e.query,ry(n.pathname)&&ry(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n;if(!b.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var S=b.slice(-1)[0],T=(n.host||e.host||b.length>1)&&("."===S||".."===S)||""===S,w=0,O=b.length;O>=0;O--)"."===(S=b[O])?b.splice(O,1):".."===S?(b.splice(O,1),w++):w&&(b.splice(O,1),w--);if(!y&&!_)for(;w--;w)b.unshift("..");!y||""===b[0]||b[0]&&"/"===b[0].charAt(0)||b.unshift(""),T&&"/"!==b.join("/").substr(-1)&&b.push("");var k=""===b[0]||b[0]&&"/"===b[0].charAt(0);return E&&(n.hostname=n.host=k?"":b.length?b.shift():"",(v=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=v.shift(),n.host=n.hostname=v.shift())),(y=y||n.host&&b.length)&&!k&&b.unshift(""),b.length?n.pathname=b.join("/"):(n.pathname=null,n.path=null),ry(n.pathname)&&ry(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},_y.prototype.parseHost=function(){return xy(this)};var Ly={version:"1.0.0",encode:function(e){return e.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")},decode:function(e){return new nm(e=(e+=Array(5-e.length%4).join("=")).replace(/\-/g,"+").replace(/\_/g,"/"),"base64")},validate:function(e){return/^[A-Za-z0-9\-_]+$/.test(e)}},Uy=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.fromBase64url=i,t.toBase64Url=o,t.encode=a,t.decode=s,t.validate=u;var r,n=(r=Ly)&&r.__esModule?r:{default:r};function i(e){return n.default.decode(e).toString()}function o(e){var t=e;return Fm(t)||(t=nm.from(t)),n.default.encode(t)}function a(e){return o(e)}function s(e){return i(e)}function u(e){return n.default.validate(e)}t.default={fromBase64url:i,toBase64Url:o,encode:a,decode:s,validate:u}});t(Uy);Uy.fromBase64url,Uy.toBase64Url,Uy.encode,Uy.decode,Uy.validate;var Fy=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=Af)&&r.__esModule?r:{default:r};t.default=function(e,t,r){if(!e)throw new Error("`fn` must be a function");if(!t)throw new Error("`wait` is required");if(!(r=r||{}).maxWait)throw new Error("`options.maxWait` is required");if(!r.maxCalls)throw new Error("`options.maxCalls` is required");var i=r,o=i.maxCalls,a=i.maxWait,s=0,u=void 0,c=void 0;return function(){s+=1,clearTimeout(c),c=setTimeout(function(){return l()},t),u||(u=setTimeout(function(){return l()},a)),s>=o&&(0,n.default)(l,this,[])};function l(){clearTimeout(c),c=null,clearTimeout(u),u=null,s=0,(0,n.default)(e,this,[])}}});t(Fy);var Gy=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.forEach(function(e){if(!t[e])throw new Error("missing required property "+e+" from "+t)})}});t(Gy);var qy=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=_f)&&r.__esModule?r:{default:r};t.default=function(){var e=this;this.promise=new n.default(function(t,r){e.resolve=t,e.reject=r})}});t(qy);var Vy=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(!e||!t)throw new Error("missing parameter for makeStateDataType");return{dataType:{set:function(r){return r instanceof e?(r.parent=this,{val:r,type:t}):{val:r?new e(r,{parent:this}):void 0,type:t}},compare:function(e,t){return e===t},onChange:function(e,t,r){t&&this.stopListening(t,"all",this._getCachedEventBubblingHandler(r)),e&&this.listenTo(e,"all",this._getCachedEventBubblingHandler(r))}},prop:{test:function(e){return!!e&&(e.parent=this,!1)},type:t}}}});t(Vy);var By=r(function(e,t){t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}});t(By),tc(tc.S+tc.F*!Fu,"Object",{defineProperty:Qu.f});var zy=Yu.Object,Wy=function(e,t,r){return zy.defineProperty(e,t,r)},Hy=r(function(e){e.exports={default:Wy,__esModule:!0}});t(Hy);var Yy=r(function(e,t){t.__esModule=!0;var r,n=(r=Hy)&&r.__esModule?r:{default:r};t.default=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,n.default)(e,i.key,i)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}()});t(Yy);var $y=Array.isArray||function(e){return"Array"==Au(e)},Xy=Uc("species"),Jy=function(e,t){return new(function(e){var t;return $y(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!$y(t.prototype)||(t=void 0),Du(t)&&null===(t=t[Xy])&&(t=void 0)),void 0===t?Array:t}(e))(t)},Ky=function(e,t){var r=1==e,n=2==e,i=3==e,o=4==e,a=6==e,s=5==e||a,u=t||Jy;return function(t,c,l){for(var f,d,p=Bc(t),h=Iu(p),v=Xu(c,l,3),g=mc(h.length),m=0,y=r?u(t,g):n?u(t,0):void 0;g>m;m++)if((s||m in h)&&(d=v(f=h[m],m,p),e))if(r)y[m]=d;else if(d)switch(e){case 3:return!0;case 5:return f;case 6:return m;case 2:y.push(f)}else if(o)return!1;return a?-1:i||o?o:y}},Qy=r(function(e){var t=Tc("meta"),r=Qu.f,n=0,i=Object.isExtensible||function(){return!0},o=!Uu(function(){return i(Object.preventExtensions({}))}),a=function(e){r(e,t,{value:{i:"O"+ ++n,w:{}}})},s=e.exports={KEY:t,NEED:!1,fastKey:function(e,r){if(!Du(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!Lu(e,t)){if(!i(e))return"F";if(!r)return"E";a(e)}return e[t].i},getWeak:function(e,r){if(!Lu(e,t)){if(!i(e))return!0;if(!r)return!1;a(e)}return e[t].w},onFreeze:function(e){return o&&s.NEED&&i(e)&&!Lu(e,t)&&a(e),e}}}),Zy=(Qy.KEY,Qy.NEED,Qy.fastKey,Qy.getWeak,Qy.onFreeze,function(e,t){if(!Du(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}),e_=Qy.getWeak,t_=Ky(5),r_=Ky(6),n_=0,i_=function(e){return e._l||(e._l=new o_)},o_=function(){this.a=[]},a_=function(e,t){return t_(e.a,function(e){return e[0]===t})};o_.prototype={get:function(e){var t=a_(this,e);if(t)return t[1]},has:function(e){return!!a_(this,e)},set:function(e,t){var r=a_(this,e);r?r[1]=t:this.a.push([e,t])},delete:function(e){var t=r_(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}};var s_={getConstructor:function(e,t,r,n){var i=e(function(e,o){fl(e,i,t,"_i"),e._t=t,e._i=n_++,e._l=void 0,null!=o&&yl(o,r,e[n],e)});return Bl(i.prototype,{delete:function(e){if(!Du(e))return!1;var r=e_(e);return!0===r?i_(Zy(this,t)).delete(e):r&&Lu(r,this._i)&&delete r[this._i]},has:function(e){if(!Du(e))return!1;var r=e_(e);return!0===r?i_(Zy(this,t)).has(e):r&&Lu(r,this._i)}}),i},def:function(e,t,r){var n=e_(Ju(t),!0);return!0===n?i_(e).set(t,r):n[e._i]=r,e},ufstore:i_},u_=Qu.f,c_=Ky(0),l_=function(e,t,r,n,i,o){var a=Gu[e],s=a,u=i?"set":"add",c=s&&s.prototype,l={};return Fu&&"function"==typeof s&&(o||c.forEach&&!Uu(function(){(new s).entries().next()}))?(s=t(function(t,r){fl(t,s,e,"_c"),t._c=new a,null!=r&&yl(r,i,t[u],t)}),c_("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in c&&(!o||"clear"!=e)&&Zu(s.prototype,e,function(r,n){if(fl(this,s,e),!t&&o&&!Du(r))return"get"==e&&void 0;var i=this._c[e](0===r?0:r,n);return t?this:i})}),o||u_(s.prototype,"size",{get:function(){return this._c.size}})):(s=n.getConstructor(t,e,i,u),Bl(s.prototype,r),Qy.NEED=!0),qc(s,e),l[e]=s,tc(tc.G+tc.W+tc.F,l),o||n.setStrong(s,e,i),s},f_=(r(function(e){var t,r=Ky(0),n=Zy,i=!Gu.ActiveXObject&&"ActiveXObject"in Gu,o=Qy.getWeak,a=Object.isExtensible,s=s_.ufstore,u=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},c={get:function(e){if(Du(e)){var t=o(e);return!0===t?s(Zy(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return s_.def(Zy(this,"WeakMap"),e,t)}},l=e.exports=l_("WeakMap",u,c,s_,!0,!0);n&&i&&(t=s_.getConstructor(u,"WeakMap"),Sf(t.prototype,c),Qy.NEED=!0,r(["delete","has","get","set"],function(e){var r=l.prototype,n=r[e];hc(r,e,function(r,i){if(Du(r)&&!a(r)){this._f||(this._f=new t);var o=this._f[e](r,i);return"set"==e?this:o}return n.call(this,r,i)})}))}),function(e){tc(tc.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})});f_("WeakMap");var d_=function(e){tc(tc.S,e,{from:function(e){var t,r,n,i,o=arguments[1];return $u(this),(t=void 0!==o)&&$u(o),null==e?new this:(r=[],t?(n=0,i=Xu(o,arguments[2],2),yl(e,!1,function(e){r.push(i(e,n++))})):yl(e,!1,r.push,r),new this(r))}})};d_("WeakMap");var p_=Yu.WeakMap,h_=r(function(e){e.exports={default:p_,__esModule:!0}});t(h_);var v_=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(By),n=a(Yy),i=a(h_),o=a(my);function a(e){return e&&e.__esModule?e:{default:e}}function s(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(e.add)e.add.apply(e,r);else if(e.set)e.set.apply(e,r);else{if(!e.push)throw new TypeError("Could not determine how to insert into the specified container");e.push.apply(e,r)}}t.default=function e(){for(var t=arguments.length,a=Array(t),u=0;u<t;u++)a[u]=arguments[u];var c=a.shift(),l=new i.default,f=new i.default,d=a.length>1?e.apply(void 0,a):a[0],p="("+[c.name].concat(a.map(function(e){return e.name})).join(", ")+")";return function(){function e(){(0,r.default)(this,e);for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];l.set(this,new(Function.prototype.bind.apply(c,[null].concat(n)))),f.set(this,0)}return(0,n.default)(e,[{key:"add",value:function(){return this.set.apply(this,arguments)}},{key:"clear",value:function(){var e=l.get(this).clear();return f.set(this,0),e}},{key:"delete",value:function(e){for(var t=l.get(this),r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];if(!n.length)return t.delete(e);var o=t.get(e);if(!o)return!1;var a=o.delete.apply(o,n);return a&&f.set(this,f.get(this)-1),0===o.size&&t.delete(e),a}},{key:"get",value:function(e){var t=l.get(this);if(!t.get)return t;for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];if(!n.length)return t.get(e);var o=t.get(e);return o?o.get?o.get.apply(o,n):o:void 0}},{key:"has",value:function(){return void 0!==this.get.apply(this,arguments)}},{key:"set",value:function(){for(var e=!1,t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];this.has.apply(this,r)&&(e=!0);var i=l.get(this),o=r.shift();if(!i.get)return s.apply(void 0,[i,o].concat(r)),this;var a=i.get(o);if(!a){if(!d)return s.apply(void 0,[i,o].concat(r)),this;s(i,o,a=new d)}return s.apply(void 0,[a].concat(r)),e||f.set(this,f.get(this)+1),this}},{key:"inspect",value:function(){return"Container"+p+" {\n  "+o.default.inspect(l.get(this),{depth:null})+"\n}"}},{key:"size",get:function(){return f.get(this)}}]),e}()}});t(v_);var g_={f:Uc},m_=g_.f("iterator"),y_=r(function(e){e.exports={default:m_,__esModule:!0}});t(y_);var __=Qu.f,b_=function(e){var t=Yu.Symbol||(Yu.Symbol={});"_"==e.charAt(0)||e in t||__(t,e,{value:g_.f(e)})},E_=Ic.concat("length","prototype"),S_={f:Object.getOwnPropertyNames||function(e){return Ac(e,E_)}},T_=S_.f,w_={}.toString,O_="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],k_={f:function(e){return O_&&"[object Window]"==w_.call(e)?function(e){try{return T_(e)}catch(e){return O_.slice()}}(e):T_(Cu(e))}},R_=Qy.KEY,A_=Hu.f,I_=Qu.f,P_=k_.f,C_=Gu.Symbol,M_=Gu.JSON,N_=M_&&M_.stringify,D_=Uc("_hidden"),j_=Uc("toPrimitive"),x_={}.propertyIsEnumerable,L_=bc("symbol-registry"),U_=bc("symbols"),F_=bc("op-symbols"),G_=Object.prototype,q_="function"==typeof C_,V_=Gu.QObject,B_=!V_||!V_.prototype||!V_.prototype.findChild,z_=Fu&&Uu(function(){return 7!=Lc(I_({},"a",{get:function(){return I_(this,"a",{value:7}).a}})).a})?function(e,t,r){var n=A_(G_,t);n&&delete G_[t],I_(e,t,r),n&&e!==G_&&I_(G_,t,n)}:I_,W_=function(e){var t=U_[e]=Lc(C_.prototype);return t._k=e,t},H_=q_&&"symbol"==typeof C_.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof C_},Y_=function(e,t,r){return e===G_&&Y_(F_,t,r),Ju(e),t=ju(t,!0),Ju(r),Lu(U_,t)?(r.enumerable?(Lu(e,D_)&&e[D_][t]&&(e[D_][t]=!1),r=Lc(r,{enumerable:Nu(0,!1)})):(Lu(e,D_)||I_(e,D_,Nu(1,{})),e[D_][t]=!0),z_(e,t,r)):I_(e,t,r)},$_=function(e,t){Ju(e);for(var r,n=function(e){var t=Pc(e),r=bf.f;if(r)for(var n,i=r(e),o=Mu.f,a=0;i.length>a;)o.call(e,n=i[a++])&&t.push(n);return t}(t=Cu(t)),i=0,o=n.length;o>i;)Y_(e,r=n[i++],t[r]);return e},X_=function(e){var t=x_.call(this,e=ju(e,!0));return!(this===G_&&Lu(U_,e)&&!Lu(F_,e))&&(!(t||!Lu(this,e)||!Lu(U_,e)||Lu(this,D_)&&this[D_][e])||t)},J_=function(e,t){if(e=Cu(e),t=ju(t,!0),e!==G_||!Lu(U_,t)||Lu(F_,t)){var r=A_(e,t);return!r||!Lu(U_,t)||Lu(e,D_)&&e[D_][t]||(r.enumerable=!0),r}},K_=function(e){for(var t,r=P_(Cu(e)),n=[],i=0;r.length>i;)Lu(U_,t=r[i++])||t==D_||t==R_||n.push(t);return n},Q_=function(e){for(var t,r=e===G_,n=P_(r?F_:Cu(e)),i=[],o=0;n.length>o;)!Lu(U_,t=n[o++])||r&&!Lu(G_,t)||i.push(U_[t]);return i};q_||(hc((C_=function(){if(this instanceof C_)throw TypeError("Symbol is not a constructor!");var e=Tc(arguments.length>0?arguments[0]:void 0),t=function(r){this===G_&&t.call(F_,r),Lu(this,D_)&&Lu(this[D_],e)&&(this[D_][e]=!1),z_(this,e,Nu(1,r))};return Fu&&B_&&z_(G_,e,{configurable:!0,set:t}),W_(e)}).prototype,"toString",function(){return this._k}),Hu.f=J_,Qu.f=Y_,S_.f=k_.f=K_,Mu.f=X_,bf.f=Q_,g_.f=function(e){return W_(Uc(e))}),tc(tc.G+tc.W+tc.F*!q_,{Symbol:C_});for(var Z_="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),eb=0;Z_.length>eb;)Uc(Z_[eb++]);for(var tb=Pc(Uc.store),rb=0;tb.length>rb;)b_(tb[rb++]);tc(tc.S+tc.F*!q_,"Symbol",{for:function(e){return Lu(L_,e+="")?L_[e]:L_[e]=C_(e)},keyFor:function(e){if(!H_(e))throw TypeError(e+" is not a symbol!");for(var t in L_)if(L_[t]===e)return t},useSetter:function(){B_=!0},useSimple:function(){B_=!1}}),tc(tc.S+tc.F*!q_,"Object",{create:function(e,t){return void 0===t?Lc(e):$_(Lc(e),t)},defineProperty:Y_,defineProperties:$_,getOwnPropertyDescriptor:J_,getOwnPropertyNames:K_,getOwnPropertySymbols:Q_}),M_&&tc(tc.S+tc.F*(!q_||Uu(function(){var e=C_();return"[null]"!=N_([e])||"{}"!=N_({a:e})||"{}"!=N_(Object(e))})),"JSON",{stringify:function(e){for(var t,r,n=[e],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=t=n[1],(Du(t)||void 0!==e)&&!H_(e))return $y(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!H_(t))return t}),n[1]=t,N_.apply(M_,n)}}),C_.prototype[j_]||Zu(C_.prototype,j_,C_.prototype.valueOf),qc(C_,"Symbol"),qc(Math,"Math",!0),qc(Gu.JSON,"JSON",!0),b_("asyncIterator"),b_("observable");var nb=Yu.Symbol,ib=r(function(e){e.exports={default:nb,__esModule:!0}});t(ib);var ob=r(function(e,t){t.__esModule=!0;var r=o(y_),n=o(ib),i="function"==typeof n.default&&"symbol"==typeof r.default?function(e){return typeof e}:function(e){return e&&"function"==typeof n.default&&e.constructor===n.default&&e!==n.default.prototype?"symbol":typeof e};function o(e){return e&&e.__esModule?e:{default:e}}t.default="function"==typeof n.default&&"symbol"===i(r.default)?function(e){return void 0===e?"undefined":i(e)}:function(e){return e&&"function"==typeof n.default&&e.constructor===n.default&&e!==n.default.prototype?"symbol":void 0===e?"undefined":i(e)}});t(ob);var ab=Qu.f,sb=Qy.fastKey,ub=Fu?"_s":"size",cb=function(e,t){var r,n=sb(t);if("F"!==n)return e._i[n];for(r=e._f;r;r=r.n)if(r.k==t)return r},lb={getConstructor:function(e,t,r,n){var i=e(function(e,o){fl(e,i,t,"_i"),e._t=t,e._i=Lc(null),e._f=void 0,e._l=void 0,e[ub]=0,null!=o&&yl(o,r,e[n],e)});return Bl(i.prototype,{clear:function(){for(var e=Zy(this,t),r=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];e._f=e._l=void 0,e[ub]=0},delete:function(e){var r=Zy(this,t),n=cb(r,e);if(n){var i=n.n,o=n.p;delete r._i[n.i],n.r=!0,o&&(o.n=i),i&&(i.p=o),r._f==n&&(r._f=i),r._l==n&&(r._l=o),r[ub]--}return!!n},forEach:function(e){Zy(this,t);for(var r,n=Xu(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!cb(Zy(this,t),e)}}),Fu&&ab(i.prototype,"size",{get:function(){return Zy(this,t)[ub]}}),i},def:function(e,t,r){var n,i,o=cb(e,t);return o?o.v=r:(e._l=o={i:i=sb(t,!0),k:t,v:r,p:n=e._l,n:void 0,r:!1},e._f||(e._f=o),n&&(n.n=o),e[ub]++,"F"!==i&&(e._i[i]=o)),e},getEntry:cb,setStrong:function(e,t,r){Jc(e,t,function(e,r){this._t=Zy(e,t),this._k=r,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?Qc(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,Qc(1))},r?"entries":"values",!r,!0),Wl(t)}},fb=(l_("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=lb.getEntry(Zy(this,"Map"),e);return t&&t.v},set:function(e,t){return lb.def(Zy(this,"Map"),0===e?0:e,t)}},lb,!0),function(e){return function(){if(ll(this)!=e)throw TypeError(e+"#toJSON isn't generic");return yl(this,!1,(r=[]).push,r,t),r;var t,r}});tc(tc.P+tc.R,"Map",{toJSON:fb("Map")}),f_("Map"),d_("Map");var db=Yu.Map,pb=r(function(e){e.exports={default:db,__esModule:!0}});t(pb);var hb=function(e){return"function"==typeof e?e:tg};var vb=function(e,t){return sg(Zv(e,t,tg),e+"")},gb=ch&&new ch,mb=gb?function(e,t){return gb.set(e,t),e}:tg;var yb=function(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=Xh(e.prototype),n=e.apply(r,t);return ud(n)?n:r}},_b=1;var bb=function(e,t,r){var n=t&_b,i=yb(e);return function t(){return(this&&this!==Xf&&this instanceof t?i:e).apply(n?r:this,arguments)}},Eb=Math.max;var Sb=function(e,t,r,n){for(var i=-1,o=e.length,a=r.length,s=-1,u=t.length,c=Eb(o-a,0),l=Array(u+c),f=!n;++s<u;)l[s]=t[s];for(;++i<a;)(f||i<o)&&(l[r[i]]=e[i]);for(;c--;)l[s++]=e[i++];return l},Tb=Math.max;var wb=function(e,t,r,n){for(var i=-1,o=e.length,a=-1,s=r.length,u=-1,c=t.length,l=Tb(o-s,0),f=Array(l+c),d=!n;++i<l;)f[i]=e[i];for(var p=i;++u<c;)f[p+u]=t[u];for(;++a<s;)(d||i<o)&&(f[p+r[a]]=e[i++]);return f};var Ob=function(e,t){for(var r=e.length,n=0;r--;)e[r]===t&&++n;return n};var kb=function(){},Rb=4294967295;function Ab(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Rb,this.__views__=[]}Ab.prototype=Xh(kb.prototype),Ab.prototype.constructor=Ab;var Ib=Ab;var Pb=function(){},Cb=gb?function(e){return gb.get(e)}:Pb,Mb={},Nb=Object.prototype.hasOwnProperty;var Db=function(e){for(var t=e.name+"",r=Mb[t],n=Nb.call(Mb,t)?r.length:0;n--;){var i=r[n],o=i.func;if(null==o||o==e)return i.name}return t};function jb(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}jb.prototype=Xh(kb.prototype),jb.prototype.constructor=jb;var xb=jb;var Lb=function(e){if(e instanceof Ib)return e.clone();var t=new xb(e.__wrapped__,e.__chain__);return t.__actions__=Hp(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t},Ub=Object.prototype.hasOwnProperty;function Fb(e){if(up(e)&&!vp(e)&&!(e instanceof Ib)){if(e instanceof xb)return e;if(Ub.call(e,"__wrapped__"))return Lb(e)}return new xb(e)}Fb.prototype=kb.prototype,Fb.prototype.constructor=Fb;var Gb=Fb;var qb=function(e){var t=Db(e),r=Gb[t];if("function"!=typeof r||!(t in Ib.prototype))return!1;if(e===r)return!0;var n=Cb(r);return!!n&&e===n[0]},Vb=ag(mb),Bb=/\{\n\/\* \[wrapped with (.+)\] \*/,zb=/,? & /;var Wb=function(e){var t=e.match(Bb);return t?t[1].split(zb):[]},Hb=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;var Yb=function(e,t){var r=t.length;if(!r)return e;var n=r-1;return t[n]=(r>1?"& ":"")+t[n],t=t.join(r>2?", ":" "),e.replace(Hb,"{\n/* [wrapped with "+t+"] */\n")};var $b=function(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1};var Xb=function(e){return e!=e};var Jb=function(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1};var Kb=function(e,t,r){return t==t?Jb(e,t,r):$b(e,Xb,r)};var Qb=function(e,t){return!(null==e||!e.length)&&Kb(e,t,0)>-1},Zb=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];var eE=function(e,t){return tp(Zb,function(r){var n="_."+r[0];t&r[1]&&!Qb(e,n)&&e.push(n)}),e.sort()};var tE=function(e,t,r){var n=t+"";return sg(e,Yb(n,eE(Wb(n),r)))},rE=1,nE=2,iE=4,oE=8,aE=32,sE=64;var uE=function(e,t,r,n,i,o,a,s,u,c){var l=t&oE;t|=l?aE:sE,(t&=~(l?sE:aE))&iE||(t&=~(rE|nE));var f=[e,t,i,l?o:void 0,l?a:void 0,l?void 0:o,l?void 0:a,s,u,c],d=r.apply(void 0,f);return qb(e)&&Vb(d,f),d.placeholder=n,tE(d,e,t)};var cE=function(e){return e.placeholder},lE=Math.min;var fE=function(e,t){for(var r=e.length,n=lE(t.length,r),i=Hp(e);n--;){var o=t[n];e[n]=bp(o,r)?i[o]:void 0}return e},dE="__lodash_placeholder__";var pE=function(e,t){for(var r=-1,n=e.length,i=0,o=[];++r<n;){var a=e[r];a!==t&&a!==dE||(e[r]=dE,o[i++]=r)}return o},hE=1,vE=2,gE=8,mE=16,yE=128,_E=512;var bE=function e(t,r,n,i,o,a,s,u,c,l){var f=r&yE,d=r&hE,p=r&vE,h=r&(gE|mE),v=r&_E,g=p?void 0:yb(t);return function m(){for(var y=arguments.length,_=Array(y),b=y;b--;)_[b]=arguments[b];if(h)var E=cE(m),S=Ob(_,E);if(i&&(_=Sb(_,i,o,h)),a&&(_=wb(_,a,s,h)),y-=S,h&&y<l){var T=pE(_,E);return uE(t,r,e,m.placeholder,n,_,T,u,c,l-y)}var w=d?n:this,O=p?w[t]:t;return y=_.length,u?_=fE(_,u):v&&y>1&&_.reverse(),f&&c<y&&(_.length=c),this&&this!==Xf&&this instanceof m&&(O=g||yb(O)),O.apply(w,_)}};var EE=function(e,t,r){var n=yb(e);return function i(){for(var o=arguments.length,a=Array(o),s=o,u=cE(i);s--;)a[s]=arguments[s];var c=o<3&&a[0]!==u&&a[o-1]!==u?[]:pE(a,u);return(o-=c.length)<r?uE(e,t,bE,i.placeholder,void 0,a,c,void 0,void 0,r-o):Kv(this&&this!==Xf&&this instanceof i?n:e,this,a)}},SE=1;var TE=function(e,t,r,n){var i=t&SE,o=yb(e);return function t(){for(var a=-1,s=arguments.length,u=-1,c=n.length,l=Array(c+s),f=this&&this!==Xf&&this instanceof t?o:e;++u<c;)l[u]=n[u];for(;s--;)l[u++]=arguments[++a];return Kv(f,i?r:this,l)}},wE="__lodash_placeholder__",OE=1,kE=2,RE=4,AE=8,IE=128,PE=256,CE=Math.min;var ME=function(e,t){var r=e[1],n=t[1],i=r|n,o=i<(OE|kE|IE),a=n==IE&&r==AE||n==IE&&r==PE&&e[7].length<=t[8]||n==(IE|PE)&&t[7].length<=t[8]&&r==AE;if(!o&&!a)return e;n&OE&&(e[2]=t[2],i|=r&OE?0:RE);var s=t[3];if(s){var u=e[3];e[3]=u?Sb(u,s,t[4]):s,e[4]=u?pE(e[3],wE):t[4]}return(s=t[5])&&(u=e[5],e[5]=u?wb(u,s,t[6]):s,e[6]=u?pE(e[5],wE):t[6]),(s=t[7])&&(e[7]=s),n&IE&&(e[8]=null==e[8]?t[8]:CE(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i,e},NE=NaN,DE=/^\s+|\s+$/g,jE=/^[-+]0x[0-9a-f]+$/i,xE=/^0b[01]+$/i,LE=/^0o[0-7]+$/i,UE=parseInt;var FE=function(e){if("number"==typeof e)return e;if(vv(e))return NE;if(ud(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ud(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(DE,"");var r=xE.test(e);return r||LE.test(e)?UE(e.slice(2),r?2:8):jE.test(e)?NE:+e},GE=1/0,qE=1.7976931348623157e308;var VE=function(e){return e?(e=FE(e))===GE||e===-GE?(e<0?-1:1)*qE:e==e?e:0:0===e?e:0};var BE=function(e){var t=VE(e),r=t%1;return t==t?r?t-r:t:0},zE="Expected a function",WE=1,HE=2,YE=8,$E=16,XE=32,JE=64,KE=Math.max;var QE=function(e,t,r,n,i,o,a,s){var u=t&HE;if(!u&&"function"!=typeof e)throw new TypeError(zE);var c=n?n.length:0;if(c||(t&=~(XE|JE),n=i=void 0),a=void 0===a?a:KE(BE(a),0),s=void 0===s?s:BE(s),c-=i?i.length:0,t&JE){var l=n,f=i;n=i=void 0}var d=u?void 0:Cb(e),p=[e,t,r,n,i,l,f,o,a,s];if(d&&ME(p,d),e=p[0],t=p[1],r=p[2],n=p[3],i=p[4],!(s=p[9]=void 0===p[9]?u?0:e.length:KE(p[9]-c,0))&&t&(YE|$E)&&(t&=~(YE|$E)),t&&t!=WE)h=t==YE||t==$E?EE(e,t,s):t!=XE&&t!=(WE|XE)||i.length?bE.apply(void 0,p):TE(e,t,r,n);else var h=bb(e,t,r);return tE((d?mb:Vb)(h,p),e,t)},ZE=vb(function(e,t){var r=pE(t,cE(ZE));return QE(e,32,void 0,t,r)});ZE.placeholder={};var eS=ZE;var tS=function(e,t){return eS(hb(t),e)},rS=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=c(ob),n=c(_f),i=c(Af),o=c(pb),a=c(h_),s=c(tS);t.default=function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];if(3===t.length)return(0,i.default)(f,null,t);var a=t[0]||{},u=a.cacheFailures,c=a.cacheSuccesses,l=a.keyFactory;return f;function f(e,t,o){var a=t;return o.value=(0,s.default)(o.value,function(t){for(var r=this,o=a,s=arguments.length,f=Array(s>1?s-1:0),p=1;p<s;p++)f[p-1]=arguments[p];l&&(o=o+"_"+l.apply(void 0,f));var h=d.get(this,e,o);return h||(h=(0,i.default)(t,this,f),!u&&h&&h.catch&&(h=h.catch(function(t){return d.delete(r,e,o),n.default.reject(t)})),!c&&h&&h.then&&(h=h.then(function(t){return d.delete(r,e,o),t})),d.set(this,e,o,h),h)}),"object"!==(void 0===e?"undefined":(0,r.default)(e))||e.prototype||(e[t]=o.value),o}};var u=c(v_);function c(e){return e&&e.__esModule?e:{default:e}}var l=a.default,f=o.default,d=new((0,u.default)(l,f,f))});t(rS);var nS=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={email:/^[^\s]+?@[^\s]+?$/,uuid:/^[a-f\d]{8}(?:-[a-f\d]{4}){3}-[a-f\d]{12}$/,execEmail:/[^\s]+?@[^\s]+?/,execUuid:/[a-f\d]{8}(?:-[a-f\d]{4}){3}-[a-f\d]{12}/}});t(nS);var iS=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(Af),n=i(vp);function i(e){return e&&e.__esModule?e:{default:e}}t.proxyEvents=function(e,t){return["on","once"].forEach(function(r){t[r]=function(){return e[r].apply(e,arguments),t}}),e},t.transferEvents=function(e,t,i){(e=(0,n.default)(e)?e:[e]).forEach(function(e){t.on&&t.on(e,function(){for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return function(e){var t=e.trigger||e.emit;if(!t)throw new Error("count not determine emit method");for(var n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return(0,r.default)(t,e,i)}.apply(void 0,[i,e].concat(n))})})}});t(iS);iS.proxyEvents,iS.transferEvents;var oS=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=_f)&&r.__esModule?r:{default:r};t.default=function(e){return function(){return n.default.resolve(e)}}});t(oS);var aS=function(e,t,r){if(!ud(r))return!1;var n=typeof t;return!!("number"==n?Lp(r)&&bp(t,r.length):"string"==n&&t in r)&&Df(r[t],e)},sS=Object.prototype,uS=sS.hasOwnProperty,cS=vb(function(e,t){e=Object(e);var r=-1,n=t.length,i=n>2?t[2]:void 0;for(i&&aS(t[0],t[1],i)&&(n=1);++r<n;)for(var o=t[r],a=Bp(o),s=-1,u=a.length;++s<u;){var c=a[s],l=e[c];(void 0===l||Df(l,sS[c])&&!uS.call(e,c))&&(e[c]=o[c])}return e});function lS(){}function fS(){fS.init.call(this)}function dS(e){return void 0===e._maxListeners?fS.defaultMaxListeners:e._maxListeners}function pS(e,t,r,n){var i,o,a,s;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),a=o[t]):(o=e._events=new lS,e._eventsCount=0),a){if("function"==typeof a?a=o[t]=n?[r,a]:[a,r]:n?a.unshift(r):a.push(r),!a.warned&&(i=dS(e))&&i>0&&a.length>i){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=a.length,s=u,"function"==typeof console.warn?console.warn(s):console.log(s)}}else a=o[t]=r,++e._eventsCount;return e}function hS(e,t,r){var n=!1;function i(){e.removeListener(t,i),n||(n=!0,r.apply(e,arguments))}return i.listener=r,i}function vS(e){var t=this._events;if(t){var r=t[e];if("function"==typeof r)return 1;if(r)return r.length}return 0}function gS(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function mS(e){Error.call(this,e),this.message=e}function yS(e){Error.call(this,e),this.message=e}lS.prototype=Object.create(null),fS.EventEmitter=fS,fS.usingDomains=!1,fS.prototype.domain=void 0,fS.prototype._events=void 0,fS.prototype._maxListeners=void 0,fS.defaultMaxListeners=10,fS.init=function(){this.domain=null,fS.usingDomains&&(void 0).active&&(void 0).Domain,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new lS,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},fS.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},fS.prototype.getMaxListeners=function(){return dS(this)},fS.prototype.emit=function(e){var t,r,n,i,o,a,s,u="error"===e;if(a=this._events)u=u&&null==a.error;else if(!u)return!1;if(s=this.domain,u){if(t=arguments[1],!s){if(t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=s,t.domainThrown=!1,s.emit("error",t),!1}if(!(r=a[e]))return!1;var l="function"==typeof r;switch(n=arguments.length){case 1:!function(e,t,r){if(t)e.call(r);else for(var n=e.length,i=gS(e,n),o=0;o<n;++o)i[o].call(r)}(r,l,this);break;case 2:!function(e,t,r,n){if(t)e.call(r,n);else for(var i=e.length,o=gS(e,i),a=0;a<i;++a)o[a].call(r,n)}(r,l,this,arguments[1]);break;case 3:!function(e,t,r,n,i){if(t)e.call(r,n,i);else for(var o=e.length,a=gS(e,o),s=0;s<o;++s)a[s].call(r,n,i)}(r,l,this,arguments[1],arguments[2]);break;case 4:!function(e,t,r,n,i,o){if(t)e.call(r,n,i,o);else for(var a=e.length,s=gS(e,a),u=0;u<a;++u)s[u].call(r,n,i,o)}(r,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(n-1),o=1;o<n;o++)i[o-1]=arguments[o];!function(e,t,r,n){if(t)e.apply(r,n);else for(var i=e.length,o=gS(e,i),a=0;a<i;++a)o[a].apply(r,n)}(r,l,this,i)}return!0},fS.prototype.addListener=function(e,t){return pS(this,e,t,!1)},fS.prototype.on=fS.prototype.addListener,fS.prototype.prependListener=function(e,t){return pS(this,e,t,!0)},fS.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,hS(this,e,t)),this},fS.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,hS(this,e,t)),this},fS.prototype.removeListener=function(e,t){var r,n,i,o,a;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(n=this._events))return this;if(!(r=n[e]))return this;if(r===t||r.listener&&r.listener===t)0==--this._eventsCount?this._events=new lS:(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length;o-- >0;)if(r[o]===t||r[o].listener&&r[o].listener===t){a=r[o].listener,i=o;break}if(i<0)return this;if(1===r.length){if(r[0]=void 0,0==--this._eventsCount)return this._events=new lS,this;delete n[e]}else!function(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}(r,i);n.removeListener&&this.emit("removeListener",e,a||t)}return this},fS.prototype.removeAllListeners=function(e){var t,r;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=new lS,this._eventsCount=0):r[e]&&(0==--this._eventsCount?this._events=new lS:delete r[e]),this;if(0===arguments.length){for(var n,i=Object.keys(r),o=0;o<i.length;++o)"removeListener"!==(n=i[o])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=new lS,this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},fS.prototype.listeners=function(e){var t,r=this._events;return r&&(t=r[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(t):[]},fS.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):vS.call(e,t)},fS.prototype.listenerCount=vS,fS.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]},my.inherits(mS,Error),mS.prototype.name="IllegalArgumentError",my.inherits(yS,Error),yS.prototype.name="IllegalStateError";var _S={IllegalStateError:yS,IllegalArgumentError:mS},bS=r(function(e){var t=e.exports=_S;function r(e,t,r,n){r=r||"";var i=new e(my.format.apply(this,[r].concat(n)));throw Error.captureStackTrace(i,t),i}function n(e,n,i){r(t.IllegalArgumentError,e,n,i)}function i(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array"}return t}function o(e){return function(t,r){var o=i(t);if(o==e)return t;n(arguments.callee,r||'Expected "'+e+'" but got "'+o+'".',Array.prototype.slice.call(arguments,2))}}e.exports.checkArgument=function(e,t){e||n(arguments.callee,t,Array.prototype.slice.call(arguments,2))},e.exports.checkState=function(e,n){e||function(e,n,i){r(t.IllegalStateError,e,n,i)}(arguments.callee,n,Array.prototype.slice.call(arguments,2))},e.exports.checkIsDef=function(e,t){if(void 0!==e)return e;n(arguments.callee,t||"Expected value to be defined but was undefined.",Array.prototype.slice.call(arguments,2))},e.exports.checkIsDefAndNotNull=function(e,t){if(null!=e)return e;n(arguments.callee,t||'Expected value to be defined and not null but got "'+i(e)+'".',Array.prototype.slice.call(arguments,2))},e.exports.checkIsString=o("string"),e.exports.checkIsArray=o("array"),e.exports.checkIsNumber=o("number"),e.exports.checkIsBoolean=o("boolean"),e.exports.checkIsFunction=o("function"),e.exports.checkIsObject=o("object")}),ES=(bS.checkArgument,bS.checkState,bS.checkIsDef,bS.checkIsDefAndNotNull,bS.checkIsString,bS.checkIsArray,bS.checkIsNumber,bS.checkIsBoolean,bS.checkIsFunction,bS.checkIsObject,bS);function SS(e){fS.EventEmitter.call(this),this.backoffStrategy_=e,this.maxNumberOfRetry_=-1,this.backoffNumber_=0,this.backoffDelay_=0,this.timeoutID_=-1,this.handlers={backoff:this.onBackoff_.bind(this)}}my.inherits(SS,fS.EventEmitter),SS.prototype.failAfter=function(e){ES.checkArgument(e>0,"Expected a maximum number of retry greater than 0 but got %s.",e),this.maxNumberOfRetry_=e},SS.prototype.backoff=function(e){ES.checkState(-1===this.timeoutID_,"Backoff in progress."),this.backoffNumber_===this.maxNumberOfRetry_?(this.emit("fail",e),this.reset()):(this.backoffDelay_=this.backoffStrategy_.next(),this.timeoutID_=setTimeout(this.handlers.backoff,this.backoffDelay_),this.emit("backoff",this.backoffNumber_,this.backoffDelay_,e))},SS.prototype.onBackoff_=function(){this.timeoutID_=-1,this.emit("ready",this.backoffNumber_,this.backoffDelay_),this.backoffNumber_++},SS.prototype.reset=function(){this.backoffNumber_=0,this.backoffStrategy_.reset(),clearTimeout(this.timeoutID_),this.timeoutID_=-1};var TS=SS;function wS(e){return null!=e}function OS(e){if(wS((e=e||{}).initialDelay)&&e.initialDelay<1)throw new Error("The initial timeout must be greater than 0.");if(wS(e.maxDelay)&&e.maxDelay<1)throw new Error("The maximal timeout must be greater than 0.");if(this.initialDelay_=e.initialDelay||100,this.maxDelay_=e.maxDelay||1e4,this.maxDelay_<=this.initialDelay_)throw new Error("The maximal backoff delay must be greater than the initial backoff delay.");if(wS(e.randomisationFactor)&&(e.randomisationFactor<0||e.randomisationFactor>1))throw new Error("The randomisation factor must be between 0 and 1.");this.randomisationFactor_=e.randomisationFactor||0}OS.prototype.getMaxDelay=function(){return this.maxDelay_},OS.prototype.getInitialDelay=function(){return this.initialDelay_},OS.prototype.next=function(){var e=this.next_(),t=1+Math.random()*this.randomisationFactor_;return Math.round(e*t)},OS.prototype.next_=function(){throw new Error("BackoffStrategy.next_() unimplemented.")},OS.prototype.reset=function(){this.reset_()},OS.prototype.reset_=function(){throw new Error("BackoffStrategy.reset_() unimplemented.")};var kS=OS;function RS(e){kS.call(this,e),this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay(),this.factor_=RS.DEFAULT_FACTOR,e&&void 0!==e.factor&&(ES.checkArgument(e.factor>1,"Exponential factor should be greater than 1 but got %s.",e.factor),this.factor_=e.factor)}my.inherits(RS,kS),RS.DEFAULT_FACTOR=2,RS.prototype.next_=function(){return this.backoffDelay_=Math.min(this.nextBackoffDelay_,this.getMaxDelay()),this.nextBackoffDelay_=this.backoffDelay_*this.factor_,this.backoffDelay_},RS.prototype.reset_=function(){this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay()};var AS=RS;function IS(e){kS.call(this,e),this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay()}my.inherits(IS,kS),IS.prototype.next_=function(){var e=Math.min(this.nextBackoffDelay_,this.getMaxDelay());return this.nextBackoffDelay_+=this.backoffDelay_,this.backoffDelay_=e,e},IS.prototype.reset_=function(){this.nextBackoffDelay_=this.getInitialDelay(),this.backoffDelay_=0};var PS=IS;function CS(e,t,r){fS.EventEmitter.call(this),ES.checkIsFunction(e,"Expected fn to be a function."),ES.checkIsArray(t,"Expected args to be an array."),ES.checkIsFunction(r,"Expected callback to be a function."),this.function_=e,this.arguments_=t,this.callback_=r,this.lastResult_=[],this.numRetries_=0,this.backoff_=null,this.strategy_=null,this.failAfter_=-1,this.retryPredicate_=CS.DEFAULT_RETRY_PREDICATE_,this.state_=CS.State_.PENDING}my.inherits(CS,fS.EventEmitter),CS.State_={PENDING:0,RUNNING:1,COMPLETED:2,ABORTED:3},CS.DEFAULT_RETRY_PREDICATE_=function(e){return!0},CS.prototype.isPending=function(){return this.state_==CS.State_.PENDING},CS.prototype.isRunning=function(){return this.state_==CS.State_.RUNNING},CS.prototype.isCompleted=function(){return this.state_==CS.State_.COMPLETED},CS.prototype.isAborted=function(){return this.state_==CS.State_.ABORTED},CS.prototype.setStrategy=function(e){return ES.checkState(this.isPending(),"FunctionCall in progress."),this.strategy_=e,this},CS.prototype.retryIf=function(e){return ES.checkState(this.isPending(),"FunctionCall in progress."),this.retryPredicate_=e,this},CS.prototype.getLastResult=function(){return this.lastResult_.concat()},CS.prototype.getNumRetries=function(){return this.numRetries_},CS.prototype.failAfter=function(e){return ES.checkState(this.isPending(),"FunctionCall in progress."),this.failAfter_=e,this},CS.prototype.abort=function(){this.isCompleted()||this.isAborted()||(this.isRunning()&&this.backoff_.reset(),this.state_=CS.State_.ABORTED,this.lastResult_=[new Error("Backoff aborted.")],this.emit("abort"),this.doCallback_())},CS.prototype.start=function(e){ES.checkState(!this.isAborted(),"FunctionCall is aborted."),ES.checkState(this.isPending(),"FunctionCall already started.");var t=this.strategy_||new PS;this.backoff_=e?e(t):new TS(t),this.backoff_.on("ready",this.doCall_.bind(this,!0)),this.backoff_.on("fail",this.doCallback_.bind(this)),this.backoff_.on("backoff",this.handleBackoff_.bind(this)),this.failAfter_>0&&this.backoff_.failAfter(this.failAfter_),this.state_=CS.State_.RUNNING,this.doCall_(!1)},CS.prototype.doCall_=function(e){e&&this.numRetries_++;var t=["call"].concat(this.arguments_);fS.EventEmitter.prototype.emit.apply(this,t);var r=this.handleFunctionCallback_.bind(this);this.function_.apply(null,this.arguments_.concat(r))},CS.prototype.doCallback_=function(){this.callback_.apply(null,this.lastResult_)},CS.prototype.handleFunctionCallback_=function(){if(!this.isAborted()){var e=Array.prototype.slice.call(arguments);this.lastResult_=e,fS.EventEmitter.prototype.emit.apply(this,["callback"].concat(e));var t=e[0];t&&this.retryPredicate_(t)?this.backoff_.backoff(t):(this.state_=CS.State_.COMPLETED,this.doCallback_())}},CS.prototype.handleBackoff_=function(e,t,r){this.emit("backoff",e,t,r)};var MS=CS,NS={Backoff:TS,FunctionCall:MS,FibonacciStrategy:PS,ExponentialStrategy:AS,fibonacci:function(e){return new TS(new PS(e))},exponential:function(e){return new TS(new AS(e))},call:function(e,t,r){var n=Array.prototype.slice.call(arguments);return e=n[0],t=n.slice(1,n.length-1),r=n[n.length-1],new MS(e,t,r)}},DS=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=l(ob),n=l(_f),i=l(Af),o=l(wf),a=l(tS),s=l(hd),u=l(cS);t.default=function(){for(var e=arguments.length,t=Array(e),l=0;l<e;l++)t[l]=arguments[l];var f=t[0]||{};f=(0,o.default)({},f),(0,u.default)(f,{backoff:!0,delay:1,maxAttempts:3});var d=void 0;d=f.backoff?{initialDelay:f.delay,maxDelay:f.maxDelay}:{initialDelay:1,maxDelay:1};if(3===t.length)return(0,i.default)(p,null,t);return p;function p(e,t,o){return o.value=(0,a.default)(o.value,function(e){for(var t=this,r=arguments.length,o=Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];var u=new fS.EventEmitter,l=new n.default(function(r,n){var a=c.default.call(function(r){var n=(0,i.default)(e,t,o);return(0,s.default)(n.on)&&(n.on("progress",u.emit.bind(u,"progress")),n.on("upload-progress",u.emit.bind(u,"upload-progress")),n.on("download-progress",u.emit.bind(u,"download-progress"))),n.then(function(e){r(null,e)}).catch(function(e){e||(e=new Error("retryable method failed without providing an error object")),r(e)})},function(e,t){return e?n(e):r(t)});a.setStrategy(new c.default.ExponentialStrategy(d)),f.maxAttempts&&a.failAfter(f.maxAttempts-1),a.start()});return l.on=function(e,t){return u.on(e,t),l},l}),"object"!==(void 0===e?"undefined":(0,r.default)(e))||e.prototype||(e[t]=o.value),o}};var c=l(NS);function l(e){return e&&e.__esModule?e:{default:e}}});t(DS);var jS=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=_f)&&r.__esModule?r:{default:r};t.default=function(e){return function(t){return new n.default(function(r){r(e(t))}).then(function(){return t}).catch(function(){return t})}}});t(jS);var xS=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=a(Af),n=a(_f),i=a(tS);t.default=function(e){return function(t,a,s){s.value=(0,i.default)(s.value,function(t){for(var i=this,a=arguments.length,s=Array(a>1?a-1:0),u=1;u<a;u++)s[u-1]=arguments[u];return new n.default(function(a){i[e]=!0,a((0,r.default)(t,i,s).then((0,o.default)(function(){i[e]=!1})).catch(function(t){return i[e]=!1,n.default.reject(t)}))})})}};var o=a(jS);function a(e){return e&&e.__esModule?e:{default:e}}});t(xS),tc(tc.S,"Object",{create:Lc});var LS=Yu.Object,US=function(e,t){return LS.create(e,t)},FS=r(function(e){e.exports={default:US,__esModule:!0}});t(FS);var GS=function(e,t){if(Ju(e),!Du(t)&&null!==t)throw TypeError(t+": can't set as prototype!")},qS={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=Xu(Function.call,Hu.f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return GS(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:GS};tc(tc.S,"Object",{setPrototypeOf:qS.set});var VS=Yu.Object.setPrototypeOf,BS=r(function(e){e.exports={default:VS,__esModule:!0}});t(BS);var zS=function(e,t,r){t in e?Qu.f(e,t,Nu(0,r)):e[t]=r};tc(tc.S+tc.F*!Ql(function(e){}),"Array",{from:function(e){var t,r,n,i,o=Bc(e),a="function"==typeof this?this:Array,s=arguments.length,u=s>1?arguments[1]:void 0,c=void 0!==u,l=0,f=ml(o);if(c&&(u=Xu(u,s>2?arguments[2]:void 0,2)),null==f||a==Array&&vl(f))for(r=new a(t=mc(o.length));t>l;l++)zS(r,l,c?u(o[l],l):o[l]);else for(i=f.call(o),r=new a;!(n=i.next()).done;l++)zS(r,l,c?dl(i,u,[n.value,l],!0):n.value);return r.length=l,r}});var WS=Yu.Array.from,HS=r(function(e){e.exports={default:WS,__esModule:!0}});t(HS);var YS=[].slice,$S={},XS=Function.bind||function(e){var t=$u(this),r=YS.call(arguments,1),n=function(){var i=r.concat(YS.call(arguments));return this instanceof n?function(e,t,r){if(!(t in $S)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";$S[t]=Function("F,a","return new F("+n.join(",")+")")}return $S[t](e,r)}(t,i.length,i):El(t,i,e)};return Du(t.prototype)&&(n.prototype=t.prototype),n},JS=(Gu.Reflect||{}).construct,KS=Uu(function(){function e(){}return!(JS(function(){},[],e)instanceof e)}),QS=!Uu(function(){JS(function(){})});tc(tc.S+tc.F*(KS||QS),"Reflect",{construct:function(e,t){$u(e),Ju(t);var r=arguments.length<3?e:$u(arguments[2]);if(QS&&!KS)return JS(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(XS.apply(e,n))}var i=r.prototype,o=Lc(Du(i)?i:Object.prototype),a=Function.apply.call(e,o,t);return Du(a)?a:o}});var ZS=Yu.Reflect.construct,eT=r(function(e){e.exports={default:ZS,__esModule:!0}});t(eT),rc("getPrototypeOf",function(){return function(e){return Hc(Bc(e))}});var tT=Yu.Object.getPrototypeOf,rT=r(function(e){e.exports={default:tT,__esModule:!0}});t(rT);var nT=r(function(e,t){t.__esModule=!0;var r,n=(r=ob)&&r.__esModule?r:{default:r};t.default=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,n.default)(t))&&"function"!=typeof t?e:t}});t(nT);var iT=r(function(e,t){t.__esModule=!0;var r=o(BS),n=o(FS),i=o(ob);function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,i.default)(t)));e.prototype=(0,n.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(r.default?(0,r.default)(e,t):e.__proto__=t)}});t(iT);var oT=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,n,i=p(FS),o=p(BS),a=p(HS),s=p(eT),u=p(rT),c=p(By),l=p(Yy),f=p(nT),d=p(iT);function p(e){return e&&e.__esModule?e:{default:e}}var h=(n=r=function(e){function t(){var e;(0,c.default)(this,t);for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];var o=(0,f.default)(this,(e=t.__proto__||(0,u.default)(t)).call.apply(e,[this].concat(n))),a=void 0;if(o.parse)a=o.parse.apply(o,n);else if(o.constructor.parse){var s;a=(s=o.constructor).parse.apply(s,n)}return a||(a=o.constructor.defaultMessage),o.name=o.constructor.name,o.message=a,o}return(0,d.default)(t,e),(0,l.default)(t,null,[{key:"parse",value:function(){return arguments.length<=0?void 0:arguments[0]}}]),t}(function(e){function t(){var t=(0,s.default)(e,(0,a.default)(arguments));return(0,o.default)(t,(0,u.default)(this)),t}return t.prototype=(0,i.default)(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),o.default?(0,o.default)(t,e):t.__proto__=e,t}(Error)),r.defaultMessage="An error occurred",n);t.default=h});t(oT);var aT=Object.defineProperty;function sT(e,t,r){var n=r.configurable,i=r.enumerable,o=r.initializer,a=r.value;return{configurable:n,enumerable:i,get:function(){if(this!==e){var r=o?o.call(this):a;return aT(this,t,{configurable:n,enumerable:i,writable:!0,value:r}),r}},set:IT(t)}}function uT(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return TT(sT,t)}var cT,lT,fT,dT,pT,hT,vT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function gT(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function mT(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}function yT(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var _T=Object.defineProperty,bT=Object.getOwnPropertyDescriptor,ET=Object.getOwnPropertyNames,ST=Object.getOwnPropertySymbols;function TT(e,t){return function(e){if(!e||!e.hasOwnProperty)return!1;for(var t=["value","initializer","get","set"],r=0,n=t.length;r<n;r++)if(e.hasOwnProperty(t[r]))return!0;return!1}(t[t.length-1])?e.apply(void 0,yT(t).concat([[]])):function(){return e.apply(void 0,yT(Array.prototype.slice.call(arguments)).concat([t]))}}var wT=(lT=mT((cT=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),gT(this,"debounceTimeoutIds",lT,this),gT(this,"throttleTimeoutIds",fT,this),gT(this,"throttlePreviousTimestamps",dT,this),gT(this,"throttleTrailingArgs",pT,this),gT(this,"profileLastRan",hT,this)}).prototype,"debounceTimeoutIds",[uT],{enumerable:!0,initializer:function(){return{}}}),fT=mT(cT.prototype,"throttleTimeoutIds",[uT],{enumerable:!0,initializer:function(){return{}}}),dT=mT(cT.prototype,"throttlePreviousTimestamps",[uT],{enumerable:!0,initializer:function(){return{}}}),pT=mT(cT.prototype,"throttleTrailingArgs",[uT],{enumerable:!0,initializer:function(){return null}}),hT=mT(cT.prototype,"profileLastRan",[uT],{enumerable:!0,initializer:function(){return null}}),cT),OT="function"==typeof Symbol?Symbol("__core_decorators__"):"__core_decorators__";function kT(e){return!1===e.hasOwnProperty(OT)&&_T(e,OT,{value:new wT}),e[OT]}var RT=ST?function(e){return ET(e).concat(ST(e))}:ET;function AT(e){var t={};return RT(e).forEach(function(r){return t[r]=bT(e,r)}),t}function IT(e){return function(t){return Object.defineProperty(this,e,{configurable:!0,writable:!0,enumerable:!0,value:t}),t}}function PT(e,t){return e.bind?e.bind(t):function(){return e.apply(t,arguments)}}var CT="object"===("undefined"==typeof console?"undefined":vT(console))&&console&&"function"==typeof console.warn?PT(console.warn,console):function(){},MT={};function NT(e){!0!==MT[e]&&(MT[e]=!0,CT("DEPRECATION: "+e))}var DT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jT=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var xT=/^function ([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?(\([^\)]*\))[\s\S]+$/,LT=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parentKlass=t,this.childKlass=r,this.parentDescriptor=n,this.childDescriptor=i}return jT(e,[{key:"_getTopic",value:function(e){return void 0===e?null:"value"in e?e.value:"get"in e?e.get:"set"in e?e.set:void 0}},{key:"_extractTopicSignature",value:function(e){switch(void 0===e?"undefined":DT(e)){case"function":return this._extractFunctionSignature(e);default:return this.key}}},{key:"_extractFunctionSignature",value:function(e){var t=this;return e.toString().replace(xT,function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.key)+arguments[2]})}},{key:"key",get:function(){return this.childDescriptor.key}},{key:"parentNotation",get:function(){return this.parentKlass.constructor.name+"#"+this.parentPropertySignature}},{key:"childNotation",get:function(){return this.childKlass.constructor.name+"#"+this.childPropertySignature}},{key:"parentTopic",get:function(){return this._getTopic(this.parentDescriptor)}},{key:"childTopic",get:function(){return this._getTopic(this.childDescriptor)}},{key:"parentPropertySignature",get:function(){return this._extractTopicSignature(this.parentTopic)}},{key:"childPropertySignature",get:function(){return this._extractTopicSignature(this.childTopic)}}]),jT(e,[{key:"assert",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!0!==e&&this.error("{child} does not properly override {parent}"+t)}},{key:"error",value:function(e){var t=this;throw e=e.replace("{parent}",function(e){return t.parentNotation}).replace("{child}",function(e){return t.childNotation}),new SyntaxError(e)}}]),e}();function UT(e){return e.hasOwnProperty("value")?"data":e.hasOwnProperty("get")||e.hasOwnProperty("set")?"accessor":"data"}function FT(e,t,r){r.assert(e.length===t.length)}function GT(e,t,r){var n=UT(e),i=UT(t);switch(n!==i&&r.error('descriptor types do not match. {parent} is "'+n+'", {child} is "'+i+'"'),i){case"data":!function(e,t,r){var n=DT(e.value),i=DT(t.value);switch("undefined"===n&&"undefined"===i&&r.error("descriptor values are both undefined. (class properties are are not currently supported)'"),n!==i&&("function"===i&&void 0===n||void 0!==n)&&r.error('value types do not match. {parent} is "'+n+'", {child} is "'+i+'"'),i){case"function":FT(e.value,t.value,r);break;default:r.error('Unexpected error. Please file a bug with: {parent} is "'+n+'", {child} is "'+i+'"')}}(e,t,r);break;case"accessor":!function(e,t,r){var n="function"==typeof e.get,i="function"==typeof t.get,o="function"==typeof e.set,a="function"==typeof t.set;(n||i)&&(!n&&o&&r.error("{parent} is setter but {child} is getter"),!i&&a&&r.error("{parent} is getter but {child} is setter"),FT(e.get,t.get,r)),(o||a)&&(!o&&n&&r.error("{parent} is getter but {child} is setter"),!a&&i&&r.error("{parent} is setter but {child} is getter"),FT(e.set,t.set,r))}(e,t,r)}}var qT=[function(e){return e.toLowerCase()},function(e){return e.toUpperCase()},function(e){return e+"s"},function(e){return e.slice(0,-1)},function(e){return e.slice(1,e.length)}];function VT(e,t,r){r.key=t;var n=Object.getPrototypeOf(e),i=Object.getOwnPropertyDescriptor(n,t),o=new LT(n,e,i,r);if(void 0===i){var a=function(e,t){for(var r=0,n=qT.length;r<n;r++){var i=(0,qT[r])(t);if(i in e)return i}return null}(n,t),s=a?'\n\n  Did you mean "'+a+'"?':"";o.error("No descriptor matching {child} was found on the prototype chain."+s)}return GT(i,r,o),r}var BT=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zT=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),WT="This function will be removed in future versions.";function HT(e,t,r,n){var i=zT(n,2),o=i[0],a=void 0===o?WT:o,s=i[1],u=void 0===s?{}:s;if("function"!=typeof r.value)throw new SyntaxError("Only functions can be marked as deprecated");var c=e.constructor.name+"#"+t;return u.url&&(a+="\n\n    See "+u.url+" for more details.\n\n"),BT({},r,{value:function(){return CT("DEPRECATION "+c+": "+a),r.value.apply(this,arguments)}})}function YT(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return TT(HT,t)}var $T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},XT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function JT(){}function KT(e,t,r){return $T({},r,{value:function(){return function(e,t,r){if("object"===("undefined"==typeof console?"undefined":XT(console))){var n=console.warn;console.warn=JT;var i=t.apply(e,r);return console.warn=n,i}return t.apply(e,r)}(this,r.value,arguments)}})}var QT=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function ZT(e,t,r){var n=function(e){var t=void 0,r=void 0;return e.value?(t=e.value,r="value"):e.get?(t=e.get,r="get"):e.set&&(t=e.set,r="set"),{fn:t,wrapKey:r}}(r),i=n.fn,o=n.wrapKey,a=new WeakMap,s=Object.create(null),u=Object.create(null),c=0;return QT({},r,function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},o,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n,o,l="0",f=0,d=t.length;f<d;f++){var p=t[f],h=(n=u,(o=p)===Object(o)?o:n[o]||(n[o]={})),v=a.get(h);void 0===v&&(v=++c,a.set(h,v)),l+=v}return s[l]||function(e,t,r,n,i){var o=t.apply(e,r);return n[i]=o,o}(this,i,arguments,s,l)}))}function ew(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var tw=Object.defineProperty,rw=Object.getPrototypeOf,nw=void 0;function iw(e,t,r){var n=r.value,i=r.configurable,o=r.enumerable;if("function"!=typeof n)throw new SyntaxError("@autobind can only be used on functions, not: "+n);var a=e.constructor;return{configurable:i,enumerable:o,get:function(){if(this===e)return n;if(this.constructor!==a&&rw(this).constructor===a)return n;if(this.constructor!==a&&t in this.constructor.prototype)return function(e,t){if("undefined"==typeof WeakMap)throw new Error("Using @autobind on "+t.name+"() requires WeakMap support due to its use of super."+t.name+"()\n      See https://github.com/jayphelps/core-decorators.js/issues/20");nw||(nw=new WeakMap),!1===nw.has(e)&&nw.set(e,new WeakMap);var r=nw.get(e);return!1===r.has(t)&&r.set(t,PT(t,e)),r.get(t)}(this,n);var r=PT(n,this);return tw(this,t,{configurable:!0,writable:!0,enumerable:!1,value:r}),r},set:IT(t)}}function ow(e){return 1===e.length?function(e){for(var t=AT(e.prototype),r=RT(t),n=0,i=r.length;n<i;n++){var o=r[n],a=t[o];"function"==typeof a.value&&"constructor"!==o&&tw(e.prototype,o,iw(e.prototype,o,a))}}.apply(void 0,ew(e)):iw.apply(void 0,ew(e))}function aw(e,t,r){return r.writable=!1,r}function sw(e,t,r){return r.enumerable=!0,r}function uw(e,t,r){return r.enumerable=!1,r}function cw(e,t,r){return r.configurable=!1,r}var lw=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fw=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),dw=300;function pw(e,t,r,n){var i=fw(n,2),o=i[0],a=void 0===o?dw:o,s=i[1],u=void 0!==s&&s,c=r.value;if("function"!=typeof c)throw new SyntaxError("Only functions can be debounced");return lw({},r,{value:function(){var e=this,r=kT(this).debounceTimeoutIds,n=r[t],i=u&&!n,o=arguments;clearTimeout(n),r[t]=setTimeout(function(){delete r[t],u||c.apply(e,o)},a),i&&c.apply(this,o)}})}var hw=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vw=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),gw=300;function mw(e,t,r,n){var i=vw(n,2),o=i[0],a=void 0===o?gw:o,s=i[1],u=void 0===s?{}:s,c=r.value;if("function"!=typeof c)throw new SyntaxError("Only functions can be throttled");return!1!==u.leading&&(u.leading=!0),!1!==u.trailing&&(u.trailing=!0),hw({},r,{value:function(){var e=this,r=kT(this),n=r.throttleTimeoutIds,i=r.throttlePreviousTimestamps,o=n[t],s=i[t]||0,l=Date.now();u.trailing&&(r.throttleTrailingArgs=arguments),s||!1!==u.leading||(s=l);var f=a-(l-s);f<=0?(clearTimeout(o),delete n[t],i[t]=l,c.apply(this,arguments)):!o&&u.trailing&&(n[t]=setTimeout(function(){i[t]=!1===u.leading?0:Date.now(),delete n[t],c.apply(e,r.throttleTrailingArgs),r.throttleTrailingArgs=null},f))}})}var yw=Object.defineProperty;function _w(e,t,r,n){var i,o=(i=n,Array.isArray(i)?i:Array.from(i)),a=o[0],s=o.slice(1),u=r.configurable,c=r.enumerable,l=r.writable,f=r.get,d=r.set,p=r.value,h=!!f;return{configurable:u,enumerable:c,get:function(){var e=h?f.call(this):p,r=a.call.apply(a,[this,e].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(s)));if(h)return r;var n={configurable:u,enumerable:c};return n.value=r,n.writable=l,yw(this,t,n),r},set:h?d:IT()}}var bw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ew=Object.defineProperty,Sw=Object.getPrototypeOf;function Tw(e,t){if(r=e,"[object Symbol]"===Object.prototype.toString.call(r)&&"object"===(void 0===r?"undefined":bw(r))){do{if(t===Object.prototype)return void 0!==t[e];if(t.hasOwnProperty(e))return!0}while(t=Sw(t));return!1}return e in t;var r}function ww(e,t){if(!t.length)throw new SyntaxError("@mixin() class "+e.name+" requires at least one mixin as an argument");for(var r=0,n=t.length;r<n;r++)for(var i=AT(t[r]),o=RT(i),a=0,s=o.length;a<s;a++){var u=o[a];Tw(u,e.prototype)||Ew(e.prototype,u,i[u])}}function Ow(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return NT("@mixin is deprecated and will be removed shortly. Use @mixin from lodash-decorators.\n\n  https://www.npmjs.com/package/lodash-decorators"),"function"==typeof t[0]?ww(t[0],[]):function(e){return ww(e,t)}}var kw=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rw=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Aw={},Iw={time:console.time?console.time.bind(console):function(e){Aw[e]=new Date},timeEnd:console.timeEnd?console.timeEnd.bind(console):function(e){var t=new Date-Aw[e];delete Aw[e],console.log(e+": "+t+"ms")}},Pw=0;function Cw(e,t,r,n){var i=Rw(n,2),o=i[0],a=void 0===o?null:o,s=i[1],u=void 0===s?Iw:s,c=r.value;if(null===a&&(a=e.constructor.name+"."+t),"function"!=typeof c)throw new SyntaxError("@time can only be used on functions, not: "+c);return kw({},r,{value:function(){var e=a+"-"+Pw;Pw++,u.time(e);try{return c.apply(this,arguments)}finally{u.timeEnd(e)}}})}var Mw=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nw=Object.getPrototypeOf,Dw=Object.getOwnPropertyDescriptor;function jw(e,t,r){var n=Nw(e),i=Dw(n,t);return Mw({},i,{value:r.value,initializer:r.initializer,get:r.get||i.get,set:r.set||i.set})}var xw=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lw=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Uw={profile:console.profile?PT(console.profile,console):function(){},profileEnd:console.profileEnd?PT(console.profileEnd,console):function(){},warn:CT};function Fw(e,t,r,n){var i=Lw(n,3),o=i[0],a=void 0===o?null:o,s=i[1],u=void 0!==s&&s,c=i[2],l=void 0===c?Uw:c;if(!Gw.__enabled)return Gw.__warned||(l.warn("console.profile is not supported. All @profile decorators are disabled."),Gw.__warned=!0),r;var f=r.value;if(null===a&&(a=e.constructor.name+"."+t),"function"!=typeof f)throw new SyntaxError("@profile can only be used on functions, not: "+f);return xw({},r,{value:function(){var e=Date.now(),t=kT(this);(!0===u&&!t.profileLastRan||!1===u||"number"==typeof u&&e-t.profileLastRan>u||"function"==typeof u&&u.apply(this,arguments))&&(l.profile(a),t.profileLastRan=e);try{return f.apply(this,arguments)}finally{l.profileEnd(a)}}})}function Gw(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return TT(Fw,t)}Gw.__enabled=!!console.profile,Gw.__warned=!1;var qw=Object.defineProperty,Vw=Object.getOwnPropertyDescriptor;var Bw=Object.freeze({override:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return TT(VT,t)},deprecate:YT,deprecated:YT,suppressWarnings:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return TT(KT,t)},memoize:function(){NT("@memoize is deprecated and will be removed shortly. Use @memoize from lodash-decorators.\n\n  https://www.npmjs.com/package/lodash-decorators");for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return TT(ZT,t)},autobind:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(){return ow(arguments)}:ow(t)},readonly:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return TT(aw,t)},enumerable:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return TT(sw,t)},nonenumerable:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return TT(uw,t)},nonconfigurable:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return TT(cw,t)},debounce:function(){NT("@debounce is deprecated and will be removed shortly. Use @debounce from lodash-decorators.\n\n  https://www.npmjs.com/package/lodash-decorators");for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return TT(pw,t)},throttle:function(){NT("@throttle is deprecated and will be removed shortly. Use @throttle from lodash-decorators.\n\n  https://www.npmjs.com/package/lodash-decorators");for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return TT(mw,t)},decorate:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return TT(_w,t)},mixin:Ow,mixins:Ow,lazyInitialize:uT,time:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return TT(Cw,t)},extendDescriptor:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return TT(jw,t)},profile:Gw,applyDecorators:function(e,t){var r=e.prototype;for(var n in t)for(var i=t[n],o=0,a=i.length;o<a;o++){var s=i[o];qw(r,n,s(r,n,Vw(r,n)))}return e}}),zw=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Bw.deprecated;t.default=r});t(zw);var Ww=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=!0});t(Ww);var Hw=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return(e=Ww,e&&e.__esModule?e:{default:e}).default;var e}})});t(Hw);var Yw=r(function(e,t){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"base64",{enumerable:!0,get:function(){return r(Uy).default}}),Object.defineProperty(t,"cappedDebounce",{enumerable:!0,get:function(){return r(Fy).default}}),Object.defineProperty(t,"checkRequired",{enumerable:!0,get:function(){return r(Gy).default}}),Object.defineProperty(t,"Defer",{enumerable:!0,get:function(){return r(qy).default}}),Object.defineProperty(t,"makeStateDataType",{enumerable:!0,get:function(){return r(Vy).default}}),Object.defineProperty(t,"make",{enumerable:!0,get:function(){return r(v_).default}}),Object.defineProperty(t,"oneFlight",{enumerable:!0,get:function(){return r(rS).default}}),Object.defineProperty(t,"patterns",{enumerable:!0,get:function(){return r(nS).default}}),Object.defineProperty(t,"proxyEvents",{enumerable:!0,get:function(){return iS.proxyEvents}}),Object.defineProperty(t,"transferEvents",{enumerable:!0,get:function(){return iS.transferEvents}}),Object.defineProperty(t,"resolveWith",{enumerable:!0,get:function(){return r(oS).default}}),Object.defineProperty(t,"retry",{enumerable:!0,get:function(){return r(DS).default}}),Object.defineProperty(t,"tap",{enumerable:!0,get:function(){return r(jS).default}}),Object.defineProperty(t,"whileInFlight",{enumerable:!0,get:function(){return r(xS).default}}),Object.defineProperty(t,"Exception",{enumerable:!0,get:function(){return r(oT).default}}),Object.defineProperty(t,"deprecated",{enumerable:!0,get:function(){return r(zw).default}}),Object.defineProperty(t,"inBrowser",{enumerable:!0,get:function(){return r(Hw).default}})});t(Yw),rc("keys",function(){return function(e){return Pc(Bc(e))}});var $w=Yu.Object.keys,Xw=r(function(e){e.exports={default:$w,__esModule:!0}});t(Xw);var Jw=4;var Kw=function(e){return pv(e,Jw)},Qw=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.safeSetTimeout=function(){var e=setTimeout.apply(void 0,arguments);e.unref&&e.unref();return e},t.safeSetInterval=function(){var e=setInterval.apply(void 0,arguments);e.unref&&e.unref();return e}});t(Qw);Qw.safeSetTimeout,Qw.safeSetInterval;var Zw=0;var eO=function(e){var t=++Zw;return Pv(e)+t};var tO=function(e){return vb(function(t,r){var n=-1,i=r.length,o=i>1?r[i-1]:void 0,a=i>2?r[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,a&&aS(r[0],r[1],a)&&(o=i<3?void 0:o,i=1),t=Object(t);++n<i;){var s=r[n];s&&e(t,s,n,o)}return t})},rO=Object.prototype.hasOwnProperty,nO=tO(function(e,t){if(Mp(t)||Lp(t))ap(t,Up(t),e);else for(var r in t)rO.call(t,r)&&op(e,r,t[r])});var iO=function(e){return function(t){return null==e?void 0:e[t]}},oO=iO({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),aO=/[&<>"']/g,sO=RegExp(aO.source);var uO=function(e){return(e=Pv(e))&&sO.test(e)?e.replace(aO,oO):e};var cO=function(e){return function(t,r,n){for(var i=-1,o=Object(t),a=n(t),s=a.length;s--;){var u=a[e?s:++i];if(!1===r(o[u],u,o))break}return t}},lO=cO();var fO=function(e,t){return e&&lO(e,t,Up)};var dO=function(e,t){return e&&fO(e,hb(t))},pO="[object String]";var hO=function(e){return"string"==typeof e||!vp(e)&&up(e)&&sd(e)==pO};var vO=function(e,t){return Mf(t,function(t){return e[t]})};var gO=function(e){return null==e?[]:vO(e,Up(e))},mO=Math.max;var yO=function(e,t,r,n){e=Lp(e)?e:gO(e),r=r&&!n?BE(r):0;var i=e.length;return r<0&&(r=mO(i+r,0)),hO(e)?r<=i&&e.indexOf(t,r)>-1:!!i&&Kb(e,t,r)>-1},_O="[object Date]";var bO=function(e){return up(e)&&sd(e)==_O},EO=kp&&kp.isDate,SO=EO?Op(EO):bO,TO="__lodash_hash_undefined__";var wO=function(e){return this.__data__.set(e,TO),this};var OO=function(e){return this.__data__.has(e)};function kO(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Jd;++t<r;)this.add(e[t])}kO.prototype.add=kO.prototype.push=wO,kO.prototype.has=OO;var RO=kO;var AO=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1};var IO=function(e,t){return e.has(t)},PO=1,CO=2;var MO=function(e,t,r,n,i,o){var a=r&PO,s=e.length,u=t.length;if(s!=u&&!(a&&u>s))return!1;var c=o.get(e);if(c&&o.get(t))return c==t;var l=-1,f=!0,d=r&CO?new RO:void 0;for(o.set(e,t),o.set(t,e);++l<s;){var p=e[l],h=t[l];if(n)var v=a?n(h,p,l,t,e,o):n(p,h,l,e,t,o);if(void 0!==v){if(v)continue;f=!1;break}if(d){if(!AO(t,function(e,t){if(!IO(d,t)&&(p===e||i(p,e,r,n,o)))return d.push(t)})){f=!1;break}}else if(p!==h&&!i(p,h,r,n,o)){f=!1;break}}return o.delete(e),o.delete(t),f};var NO=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r};var DO=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r},jO=1,xO=2,LO="[object Boolean]",UO="[object Date]",FO="[object Error]",GO="[object Map]",qO="[object Number]",VO="[object RegExp]",BO="[object Set]",zO="[object String]",WO="[object Symbol]",HO="[object ArrayBuffer]",YO="[object DataView]",$O=Jf?Jf.prototype:void 0,XO=$O?$O.valueOf:void 0;var JO=function(e,t,r,n,i,o,a){switch(r){case YO:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case HO:return!(e.byteLength!=t.byteLength||!o(new _h(e),new _h(t)));case LO:case UO:case qO:return Df(+e,+t);case FO:return e.name==t.name&&e.message==t.message;case VO:case zO:return e==t+"";case GO:var s=NO;case BO:var u=n&jO;if(s||(s=DO),e.size!=t.size&&!u)return!1;var c=a.get(e);if(c)return c==t;n|=xO,a.set(e,t);var l=MO(s(e),s(t),n,i,o,a);return a.delete(e),l;case WO:if(XO)return XO.call(e)==XO.call(t)}return!1},KO=1,QO=Object.prototype.hasOwnProperty;var ZO=function(e,t,r,n,i,o){var a=r&KO,s=ih(e),u=s.length;if(u!=ih(t).length&&!a)return!1;for(var c=u;c--;){var l=s[c];if(!(a?l in t:QO.call(t,l)))return!1}var f=o.get(e);if(f&&o.get(t))return f==t;var d=!0;o.set(e,t),o.set(t,e);for(var p=a;++c<u;){var h=e[l=s[c]],v=t[l];if(n)var g=a?n(v,h,l,t,e,o):n(h,v,l,e,t,o);if(!(void 0===g?h===v||i(h,v,r,n,o):g)){d=!1;break}p||(p="constructor"==l)}if(d&&!p){var m=e.constructor,y=t.constructor;m!=y&&"constructor"in e&&"constructor"in t&&!("function"==typeof m&&m instanceof m&&"function"==typeof y&&y instanceof y)&&(d=!1)}return o.delete(e),o.delete(t),d},ek=1,tk="[object Arguments]",rk="[object Array]",nk="[object Object]",ik=Object.prototype.hasOwnProperty;var ok=function(e,t,r,n,i,o){var a=vp(e),s=vp(t),u=a?rk:gh(e),c=s?rk:gh(t),l=(u=u==tk?nk:u)==nk,f=(c=c==tk?nk:c)==nk,d=u==c;if(d&&mp(e)){if(!mp(t))return!1;a=!0,l=!1}if(d&&!l)return o||(o=new ep),a||Ap(e)?MO(e,t,r,n,i,o):JO(e,t,u,r,n,i,o);if(!(r&ek)){var p=l&&ik.call(e,"__wrapped__"),h=f&&ik.call(t,"__wrapped__");if(p||h){var v=p?e.value():e,g=h?t.value():t;return o||(o=new ep),i(v,g,r,n,o)}}return!!d&&(o||(o=new ep),ZO(e,t,r,n,i,o))};var ak=function e(t,r,n,i,o){return t===r||(null==t||null==r||!up(t)&&!up(r)?t!=t&&r!=r:ok(t,r,n,i,e,o))};var sk=function(e,t){return ak(e,t)},uk=Object.prototype.hasOwnProperty;var ck=function(e,t){return null!=e&&uk.call(e,t)};var lk=function(e,t,r){for(var n=-1,i=(t=Cv(t,e)).length,o=!1;++n<i;){var a=Dv(t[n]);if(!(o=null!=e&&r(e,a)))break;e=e[a]}return o||++n!=i?o:!!(i=null==e?0:e.length)&&Sp(i)&&bp(a,i)&&(vp(e)||hp(e))};var fk=function(e,t){return null!=e&&lk(e,t,ck)};var dk=function(e,t,r){var n=-1,i=(t=Cv(t,e)).length;for(i||(i=1,e=void 0);++n<i;){var o=null==e?void 0:e[Dv(t[n])];void 0===o&&(n=i,o=r),e=hd(o)?o.call(e):o}return e};var pk=function(e,t,r){for(var n=-1,i=null==e?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1},hk=uh&&1/DO(new uh([,-0]))[1]==1/0?function(e){return new uh(e)}:Pb,vk=200;var gk=function(e,t,r){var n=-1,i=Qb,o=e.length,a=!0,s=[],u=s;if(r)a=!1,i=pk;else if(o>=vk){var c=t?null:hk(e);if(c)return DO(c);a=!1,i=IO,u=new RO}else u=t?[]:s;e:for(;++n<o;){var l=e[n],f=t?t(l):l;if(l=r||0!==l?l:0,a&&f==f){for(var d=u.length;d--;)if(u[d]===f)continue e;t&&u.push(f),s.push(l)}else i(u,f,r)||(u!==s&&u.push(f),s.push(l))}return s};var mk=function(e){return up(e)&&Lp(e)},yk=vb(function(e){return gk(Xv(e,1,mk,!0))}),_k="Expected a function";var bk=function(e,t){var r;if("function"!=typeof t)throw new TypeError(_k);return e=BE(e),function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=void 0),r}};var Ek=function(e){return bk(2,e)};var Sk=function(e,t){return function(r,n){if(null==r)return r;if(!Lp(r))return e(r,n);for(var i=r.length,o=t?i:-1,a=Object(r);(t?o--:++o<i)&&!1!==n(a[o],o,a););return r}},Tk=Sk(fO);var wk=function(e,t){return(vp(e)?tp:Tk)(e,hb(t))},Ok=/\s+/,kk=function(e,t){var r,n=-1,i=e.length,o=t[0],a=t[1],s=t[2];switch(t.length){case 0:for(;++n<i;)(r=e[n]).callback.call(r.ctx);return;case 1:for(;++n<i;)(r=e[n]).callback.call(r.ctx,o);return;case 2:for(;++n<i;)(r=e[n]).callback.call(r.ctx,o,a);return;case 3:for(;++n<i;)(r=e[n]).callback.call(r.ctx,o,a,s);return;default:for(;++n<i;)(r=e[n]).callback.apply(r.ctx,t);return}},Rk=function(e,t,r,n){if(!r)return!0;if("object"==typeof r){for(var i in r)e[t].apply(e,[i,r[i]].concat(n));return!1}if(Ok.test(r)){for(var o=r.split(Ok),a=0,s=o.length;a<s;a++)e[t].apply(e,[o[a]].concat(n));return!1}return!0},Ak=function(e){return function(t,r,n){if(!t)throw new Error("Trying to listenTo event: '"+r+"' but the target object is undefined");if((this._listeningTo||(this._listeningTo={}))[t._listenId||(t._listenId=eO("l"))]=t,n||"object"!=typeof r||(n=this),"function"!=typeof t[e])throw new Error("Trying to listenTo event: '"+r+"' on object: "+t.toString()+" but it does not have an 'on' method so is unbindable");return t[e](r,n,this),this}},Ik=Array.prototype.slice,Pk={on:function(e,t,r){return Rk(this,"on",e,[t,r])&&t?(this._events||(this._events={}),(this._events[e]||(this._events[e]=[])).push({callback:t,context:r,ctx:r||this}),this):this},once:function(e,t,r){if(!Rk(this,"once",e,[t,r])||!t)return this;var n=this,i=Ek(function(){n.off(e,i),t.apply(this,arguments)});return i._callback=t,this.on(e,i,r)},off:function(e,t,r){var n,i,o,a,s,u,c,l;if(!this._events||!Rk(this,"off",e,[t,r]))return this;if(!e&&!t&&!r)return this._events=void 0,this;for(s=0,u=(a=e?[e]:Up(this._events)).length;s<u;s++)if(e=a[s],o=this._events[e]){if(this._events[e]=n=[],t||r)for(c=0,l=o.length;c<l;c++)i=o[c],(t&&t!==i.callback&&t!==i.callback._callback||r&&r!==i.context)&&n.push(i);n.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=Ik.call(arguments,1);if(!Rk(this,"trigger",e,t))return this;var r=this._events[e],n=this._events.all;return r&&kk(r,t),n&&kk(n,arguments),this},stopListening:function(e,t,r){var n=this._listeningTo;if(!n)return this;var i=!t&&!r;r||"object"!=typeof t||(r=this),e&&((n={})[e._listenId]=e);var o=this;return wk(n,function(e,n){e.off(t,r,o),(i||pg(e._events))&&delete o._listeningTo[n]}),this},createEmitter:function(e){return nO(e||{},Pk)},listenTo:Ak("on"),listenToOnce:Ak("once"),listenToAndRun:function(e,t,r){return this.listenTo.apply(this,arguments),r||"object"!=typeof t||(r=this),r.apply(this),this}};Pk.bind=Pk.on,Pk.unbind=Pk.off,Pk.removeListener=Pk.off,Pk.removeAllListeners=Pk.off,Pk.emit=Pk.trigger;var Ck=Pk,Mk=Array.prototype.slice;function Nk(e){if("object"!=typeof(e=e||{}))throw new TypeError("Options must be an object");this.storage={},this.separator=e.separator||"."}Nk.prototype.add=function(e,t){(this.storage[e]||(this.storage[e]=[])).push(t)},Nk.prototype.remove=function(e){var t,r;for(t in this.storage)(r=this.storage[t]).some(function(t,n){if(t===e)return r.splice(n,1),!0})},Nk.prototype.get=function(e){var t,r=[];for(t in this.storage)e&&e!==t&&0!==t.indexOf(e+this.separator)||(r=r.concat(this.storage[t]));return r},Nk.prototype.getGrouped=function(e){var t,r={};for(t in this.storage)e&&e!==t&&0!==t.indexOf(e+this.separator)||(r[t]=Mk.call(this.storage[t]));return r},Nk.prototype.getAll=function(e){var t,r={};for(t in this.storage)e!==t&&0!==t.indexOf(e+this.separator)||(r[t]=Mk.call(this.storage[t]));return r},Nk.prototype.run=function(e,t){var r=Mk.call(arguments,2);this.get(e).forEach(function(e){e.apply(t||this,r)})};var Dk=Nk,jk=function(e){return nO({},e)},xk=/^change:/,Lk=function(){};function Uk(e,t){t||(t={}),this.cid||(this.cid=eO("state")),this._events={},this._values={},this._eventBubblingHandlerCache={},this._definition=Object.create(this._definition),t.parse&&(e=this.parse(e,t)),this.parent=t.parent,this.collection=t.collection,this._keyTree=new Dk,this._initCollections(),this._initChildren(),this._cache={},this._previousAttributes={},e&&this.set(e,nO({silent:!0,initial:!0},t)),this._changed={},this._derived&&this._initDerived(),!1!==t.init&&this.initialize.apply(this,arguments)}function Fk(e,t,r,n){var i,o,a=e._definition[t]={};if(hO(r))(i=e._ensureValidType(r))&&(a.type=i);else{if(Array.isArray(r)&&(r={type:(o=r)[0],required:o[1],default:o[2]}),(i=e._ensureValidType(r.type))&&(a.type=i),r.required&&(a.required=!0),r.default&&"object"==typeof r.default)throw new TypeError("The default value for "+t+" cannot be an object/array, must be a value or a function which returns a value/object/array");a.default=r.default,a.allowNull=!!r.allowNull&&r.allowNull,r.setOnce&&(a.setOnce=!0),a.required&&void 0===a.default&&!a.setOnce&&(a.default=e._getDefaultForType(i)),a.test=r.test,a.values=r.values}return n&&(a.session=!0),i||(i=hO(r)?r:r.type,console.warn("Invalid data type of `"+i+"` for `"+t+"` property. Use one of the default types or define your own")),Object.defineProperty(e,t,{set:function(e){this.set(t,e)},get:function(){if(!this._values)throw Error('You may be trying to `extend` a state object with "'+t+'" which has been defined in `props` on the object being extended');var e=this._values[t],r=this._dataTypes[a.type];if(void 0!==e)return r&&r.get&&(e=r.get(e)),e;var n=dk(a,"default");(this._values[t]=n,void 0!==n)&&this._getOnChangeForType(a.type)(n,e,t);return n}}),a}function Gk(e,t,r){(e._derived[t]={fn:hd(r)?r:r.fn,cache:!1!==r.cache,depList:r.deps||[]}).depList.forEach(function(r){e._deps[r]=yk(e._deps[r]||[],[t])}),Object.defineProperty(e,t,{get:function(){return this._getDerivedProperty(t)},set:function(){throw new TypeError("`"+t+"` is a derived property, it can't be set directly.")}})}nO(Uk.prototype,Ck,{extraProperties:"ignore",idAttribute:"id",namespaceAttribute:"namespace",typeAttribute:"modelType",initialize:function(){return this},getId:function(){return this[this.idAttribute]},getNamespace:function(){return this[this.namespaceAttribute]},getType:function(){return this[this.typeAttribute]},isNew:function(){return null==this.getId()},escape:function(e){return uO(this.get(e))},isValid:function(e){return this._validate({},nO(e||{},{validate:!0}))},parse:function(e,t){return e},serialize:function(e){var t=nO({props:!0},e),r=this.getAttributes(t,!0),n=function(e,t){r[t]=this[t].serialize()}.bind(this);return dO(this._children,n),dO(this._collections,n),r},set:function(e,t,r){var n,i,o,a,s,u,c,l,f,d,p,h,v,g,m,y,_,b=this,E=this.extraProperties;if(ud(e)||null===e?(f=e,r=t):(f={})[e]=t,r=r||{},!this._validate(f,r))return!1;h=r.unset,p=r.silent,g=r.initial,n=this._changing,this._changing=!0,i=[],g?this._previousAttributes={}:n||(this._previousAttributes=this.attributes,this._changed={});for(var S=0,T=Object.keys(f),w=T.length;S<w;S++){if(o=typeof(a=f[l=T[S]]),v=this._values[l],!(s=this._definition[l])){if(this._children[l]||this._collections[l]){ud(a)||(a={}),this[l].set(a,r);continue}if("ignore"===E)continue;if("reject"===E)throw new TypeError('No "'+l+'" property defined on '+(this.type||"this")+' model and extraProperties not set to "ignore" or "allow"');if("allow"===E)s=this._createPropertyDefinition(l,"any");else if(E)throw new TypeError('Invalid value for extraProperties: "'+E+'"')}if(y=this._getCompareForType(s.type),_=this._getOnChangeForType(s.type),(d=this._dataTypes[s.type])&&d.set&&(a=(u=d.set(a)).val,o=u.type),s.test&&(c=s.test.call(this,a,o)))throw new TypeError("Property '"+l+"' failed validation with error: "+c);if(void 0===a&&s.required)throw new TypeError("Required property '"+l+"' must be of type "+s.type+". Tried to set "+a);if(null===a&&s.required&&!s.allowNull)throw new TypeError("Property '"+l+"' must be of type "+s.type+" (cannot be null). Tried to set "+a);if(s.type&&"any"!==s.type&&s.type!==o&&null!=a)throw new TypeError("Property '"+l+"' must be of type "+s.type+". Tried to set "+a);if(s.values&&!yO(s.values,a)){var O=dk(s,"default");if(h&&void 0!==O)a=O;else if(!h||h&&void 0!==a)throw new TypeError("Property '"+l+"' must be one of values: "+s.values.join(", ")+". Tried to set "+a)}if(m=g||!y(v,a,l),s.setOnce&&void 0!==v&&m)throw new TypeError("Property '"+l+"' can only be set once.");m?(_(a,v,l),g||(this._changed[l]=a,this._previousAttributes[l]=v,h&&delete this._values[l],p||i.push({prev:v,val:a,key:l})),h||(this._values[l]=a)):delete this._changed[l]}if(i.length&&(this._pending=!0),i.forEach(function(e){b.trigger("change:"+e.key,b,e.val,r)}),n)return this;for(;this._pending;)this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},get:function(e){return this[e]},toggle:function(e){var t,r,n,i,o=this._definition[e];if("boolean"===o.type)this[e]=!this[e];else{if(!o||!o.values)throw new TypeError("Can only toggle properties that are type `boolean` or have `values` array.");this[e]=(t=o.values,r=this[e],n=t.length,(i=t.indexOf(r)+1)>n-1&&(i=0),t[i])}return this},previousAttributes:function(){return jk(this._previousAttributes)},hasChanged:function(e){return null==e?!!Object.keys(this._changed).length:fk(this._derived,e)?this._derived[e].depList.some(function(e){return this.hasChanged(e)},this):fk(this._changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&jk(this._changed);var t,r,n=!1,i=this._changing?this._previousAttributes:this.attributes;for(var o in e)(r=this._definition[o])&&(this._getCompareForType(r.type)(i[o],t=e[o])||((n||(n={}))[o]=t));return n},toJSON:function(){return this.serialize()},unset:function(e,t){var r=this;(e=Array.isArray(e)?e:[e]).forEach(function(e){var n,i=r._definition[e];if(i)return i.required?(n=dk(i,"default"),r.set(e,n,t)):r.set(e,n,nO({},t,{unset:!0}))})},clear:function(e){var t=this;return Object.keys(this.attributes).forEach(function(r){t.unset(r,e)}),this},previous:function(e){return null!=e&&Object.keys(this._previousAttributes).length?this._previousAttributes[e]:null},_getDefaultForType:function(e){var t=this._dataTypes[e];return t&&t.default},_getCompareForType:function(e){var t=this._dataTypes[e];return t&&t.compare?t.compare.bind(this):sk},_getOnChangeForType:function(e){var t=this._dataTypes[e];return t&&t.onChange?t.onChange.bind(this):Lk},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=nO({},this.attributes,e);var r=this.validationError=this.validate(e,t)||null;return!r||(this.trigger("invalid",this,r,nO(t||{},{validationError:r})),!1)},_createPropertyDefinition:function(e,t,r){return Fk(this,e,t,r)},_ensureValidType:function(e){return yO(["string","number","boolean","array","object","date","state","any"].concat(Object.keys(this._dataTypes)),e)?e:void 0},getAttributes:function(e,t){e=nO({session:!1,props:!1,derived:!1},e||{});var r,n,i={};for(var o in this._definition)n=this._definition[o],(e.session&&n.session||e.props&&!n.session)&&(r=t?this._values[o]:this[o],t&&r&&hd(r.serialize)&&(r=r.serialize()),void 0===r&&(r=dk(n,"default")),void 0!==r&&(i[o]=r));if(e.derived)for(var a in this._derived)i[a]=this[a];return i},_initDerived:function(){var e=this;dO(this._derived,function(t,r){var n=e._derived[r];n.deps=n.depList;var i=function(){var t=n.fn.call(e);e._cache[r]===t&&n.cache||(n.cache&&(e._previousAttributes[r]=e._cache[r]),e._cache[r]=t,e.trigger("change:"+r,e,e._cache[r]))};n.deps.forEach(function(t){e._keyTree.add(t,i)})}),this.on("all",function(t){xk.test(t)&&e._keyTree.get(t.split(":")[1]).forEach(function(e){e()})},this)},_getDerivedProperty:function(e,t){return this._derived[e].cache?(!t&&this._cache.hasOwnProperty(e)||(this._cache[e]=this._derived[e].fn.apply(this)),this._cache[e]):this._derived[e].fn.apply(this)},_initCollections:function(){var e;if(this._collections)for(e in this._collections)this._safeSet(e,new this._collections[e](null,{parent:this}))},_initChildren:function(){var e;if(this._children)for(e in this._children)this._safeSet(e,new this._children[e]({},{parent:this})),this.listenTo(this[e],"all",this._getCachedEventBubblingHandler(e))},_getCachedEventBubblingHandler:function(e){return this._eventBubblingHandlerCache[e]||(this._eventBubblingHandlerCache[e]=function(t,r,n){xk.test(t)?this.trigger("change:"+e+"."+t.split(":")[1],r,n):"change"===t&&this.trigger("change",this)}.bind(this)),this._eventBubblingHandlerCache[e]},_verifyRequired:function(){var e=this.attributes;for(var t in this._definition)if(this._definition[t].required&&void 0===e[t])return!1;return!0},_safeSet:function(e,t){if(e in this)throw new Error("Encountered namespace collision while setting instance property `"+e+"`");return this[e]=t,this}}),Object.defineProperties(Uk.prototype,{attributes:{get:function(){return this.getAttributes({props:!0,session:!0})}},all:{get:function(){return this.getAttributes({session:!0,props:!0,derived:!0})}},isState:{get:function(){return!0},set:function(){}}});var qk={string:{default:function(){return""}},date:{set:function(e){var t;if(null==e)t="object";else if(SO(e))t="date",e=e.valueOf();else{var r=null,n=new Date(e).valueOf();isNaN(n)&&(n=new Date(parseInt(e,10)).valueOf(),isNaN(n)&&(r=!0)),e=n,t="date",r&&(t=typeof e)}return{val:e,type:t}},get:function(e){return null==e?e:new Date(e)},default:function(){return new Date}},array:{set:function(e){return{val:e,type:Array.isArray(e)?"array":typeof e}},default:function(){return[]}},object:{set:function(e){var t=typeof e;return"object"!==t&&void 0===e&&(e=null,t="object"),{val:e,type:t}},default:function(){return{}}},state:{set:function(e){return e instanceof Uk||e&&e.isState?{val:e,type:"state"}:{val:e,type:typeof e}},compare:function(e,t){return e===t},onChange:function(e,t,r){t&&this.stopListening(t,"all",this._getCachedEventBubblingHandler(r)),null!=e&&this.listenTo(e,"all",this._getCachedEventBubblingHandler(r))}}};Uk.extend=function(e){var t,r=this;t=e&&e.hasOwnProperty("constructor")?e.constructor:function(){return r.apply(this,arguments)},nO(t,r);var n=function(){this.constructor=t};if(n.prototype=r.prototype,t.prototype=new n,t.prototype._derived=nO({},r.prototype._derived),t.prototype._deps=nO({},r.prototype._deps),t.prototype._definition=nO({},r.prototype._definition),t.prototype._collections=nO({},r.prototype._collections),t.prototype._children=nO({},r.prototype._children),t.prototype._dataTypes=nO({},r.prototype._dataTypes||qk),e)for(var i=["dataTypes","props","session","derived","collections","children"],o=0;o<arguments.length;o++){var a=arguments[o];a.dataTypes&&dO(a.dataTypes,function(e,r){t.prototype._dataTypes[r]=e}),a.props&&dO(a.props,function(e,r){Fk(t.prototype,r,e)}),a.session&&dO(a.session,function(e,r){Fk(t.prototype,r,e,!0)}),a.derived&&dO(a.derived,function(e,r){Gk(t.prototype,r,e)}),a.collections&&dO(a.collections,function(e,r){t.prototype._collections[r]=e}),a.children&&dO(a.children,function(e,r){t.prototype._children[r]=e}),nO(t.prototype,cg(a,i))}return t.__super__=r.prototype,t};var Vk=Uk,Bk=r(function(e,t){t.__esModule=!0;var r,n=(r=Hy)&&r.__esModule?r:{default:r};t.default=function(e,t,r){return t in e?(0,n.default)(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}});t(Bk);var zk=r(function(e,t){t.__esModule=!0;var r,n=(r=HS)&&r.__esModule?r:{default:r};t.default=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return(0,n.default)(e)}});t(zk);l_("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return lb.def(Zy(this,"Set"),e=0===e?0:e,e)}},lb);tc(tc.P+tc.R,"Set",{toJSON:fb("Set")}),f_("Set"),d_("Set");var Wk=Yu.Set,Hk=r(function(e){e.exports={default:Wk,__esModule:!0}});t(Hk);var Yk=function(){return Xf.Date.now()},$k="Expected a function",Xk=Math.max,Jk=Math.min;var Kk=function(e,t,r){var n,i,o,a,s,u,c=0,l=!1,f=!1,d=!0;if("function"!=typeof e)throw new TypeError($k);function p(t){var r=n,o=i;return n=i=void 0,c=t,a=e.apply(o,r)}function h(e){var r=e-u;return void 0===u||r>=t||r<0||f&&e-c>=o}function v(){var e=Yk();if(h(e))return g(e);s=setTimeout(v,function(e){var r=t-(e-u);return f?Jk(r,o-(e-c)):r}(e))}function g(e){return s=void 0,d&&n?p(e):(n=i=void 0,a)}function m(){var e=Yk(),r=h(e);if(n=arguments,i=this,u=e,r){if(void 0===s)return function(e){return c=e,s=setTimeout(v,t),l?p(e):a}(u);if(f)return s=setTimeout(v,t),p(u)}return void 0===s&&(s=setTimeout(v,t)),a}return t=FE(t)||0,ud(r)&&(l=!!r.leading,o=(f="maxWait"in r)?Xk(FE(r.maxWait)||0,t):o,d="trailing"in r?!!r.trailing:d),m.cancel=function(){void 0!==s&&clearTimeout(s),c=0,n=u=i=s=void 0},m.flush=function(){return void 0===s?a:g(Yk())},m},Qk=8;function Zk(e,t,r){var n=QE(e,Qk,void 0,void 0,void 0,void 0,void 0,t=r?void 0:t);return n.placeholder=Zk.placeholder,n}Zk.placeholder={};var eR=Zk,tR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.NotFoundError=t.StorageError=void 0;var r=a(rT),n=a(By),i=a(nT),o=a(iT);function a(e){return e&&e.__esModule?e:{default:e}}var s=t.StorageError=function(e){function t(){return(0,n.default)(this,t),(0,i.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,o.default)(t,e),t}(Yw.Exception);t.NotFoundError=function(e){function t(){return(0,n.default)(this,t),(0,i.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,o.default)(t,e),t}(s)});t(tR);tR.NotFoundError,tR.StorageError;var rR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=h(Bk),n=h(ob),i=h(zk),o=h(Hk),a=h(pb),s=h(_f),u=h(Af),c=h(tS),l=h(dk),f=h(tg),d=h(Kk),p=h(eR);function h(e){return e&&e.__esModule?e:{default:e}}t.persist=function e(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];if(3===r.length)return e("@").apply(void 0,r);var i=r[0],o=r[1];return function(e,t,r){if("initialize"!==t)throw new TypeError("@persist can only currently be applied to AmpersandState objects or their derivatives and must be applied to the initialize method");r.value=(0,c.default)(r.value,function(e){for(var t=this,r=arguments.length,n=Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];var c=(0,u.default)(e,this,n),l="@"===i?"change":"change:"+i;return this.on(l,(0,d.default)(function(){var e=!o||u.default.apply(Reflect,[o,t].concat(n));return e?"@"===i?t.boundedStorage.put(i,t):t.boundedStorage.put(i,t[i]):s.default.resolve()},0)),c}),b(e,t)}},t.waitForValue=function(e){if(!e)throw new Error("`key` is required");return function(t,r,o){return m.add(t,r,e),o.value=(0,c.default)(o.value,function(e){for(var n=this,o=arguments.length,a=Array(o>1?o-1:0),c=1;c<o;c++)a[c-1]=arguments[c];var l=m.get(t,r);return s.default.all([].concat((0,i.default)(l)).map(function(e){return n.boundedStorage.waitFor(e)})).then(function(){return(0,u.default)(e,n,a)})}),"object"!==(void 0===t?"undefined":(0,n.default)(t))||t.prototype||(t[r]=o.value),b(t,r),o}};var v=a.default,g=o.default,m=new((0,Yw.make)(v,v,g));var y=new o.default;var _=new o.default;function b(e,t){var n=function(e){return e.namespace?e.namespace:e}(e);if(!y.has(n)){if(y.add(n),e.initialize)return void(e.initialize=(0,c.default)(e.initialize,function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=(0,u.default)(e,this,r);return(0,u.default)(i,this,r),o}));e.initialize=i}function i(){var n=this,i=this.getNamespace();this.spark.initialize=(0,c.default)(this.spark.initialize||f.default,function(o){var a=this;_.add(i);for(var c=arguments.length,f=Array(c>1?c-1:0),d=1;d<c;d++)f[d-1]=arguments[d];(0,u.default)(o,this,f);var h=(0,p.default)(function(e,t){a.logger.debug("storage:("+i+"): got `"+e+"` for first time"),"@"===e?n.parent.set((0,r.default)({},i.toLowerCase(),t)):(0,l.default)(n[e],"isState")?n[e].set(t):n.set(e,t),a.logger.debug("storage:("+i+"): set `"+e+"` for first time")}),v=(0,p.default)(function(e,t){return t instanceof tR.NotFoundError||t.toString().includes("MockNotFoundError")?(a.logger.debug("storage("+i+"): no data for `"+e+"`, continuing"),s.default.resolve()):(a.logger.error("storage("+i+"): failed to init `"+e+"`",t),s.default.reject(t))}),g=m.get(e,t),y=[];g.forEach(function(e){y.push(a.boundedStorage.get(i,e).then(h(e)).catch(v(e)))}),s.default.all(y).then(function(){_.delete(i),0===_.size&&(a.loaded=!0)})})}}});t(rR);rR.persist,rR.waitForValue;var nR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=l(wf),n=l(ac),i=l(_f),o=l(pb),a=l(By),s=l(Yy),u=l(h_);t.default=function(e,t){var u,l,d=(u=(0,Yw.oneFlight)({keyFactory:function(e){return e}}),function(e,t,r,n,i){var o={};Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0);o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0);void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null)}((l=function(){function r(){(0,a.default)(this,r),t.logger.debug("spark-store: constructing "+e+"Storage"),f.set(this,new o.default)}return(0,s.default)(r,[{key:"clear",value:function(){var e=[];return this.bindings.forEach(function(t){e.push(t.clear())}),i.default.all(e)}},{key:"del",value:function(e,r){return t.logger.debug("spark-store: removing "+e+":"+r),this._getBinding(e).then(function(e){return e.del(r)})}},{key:"get",value:function(e,r){return t.logger.debug("spark-store: retrieving "+e+":"+r),this._getBinding(e).then(function(e){return e.get(r)})}},{key:"put",value:function(e,r,n){return void 0===n?this.del(e,r):(t.logger.debug("spark-store: setting "+e+":"+r),this._getBinding(e).then(function(e){return e.put(r,n.serialize?n.serialize():n)}).then(function(){return n}))}},{key:"_getBinding",value:function(e){var r=this;return new i.default(function(n){t.logger.debug("storage: getting binding for `"+e+"`");var i=r.bindings.get(e);return i?(t.logger.debug("storage: found binding for `"+e+"`"),n(i)):n(r.adapter.bind(e,{logger:t.logger}).then(function(n){return t.logger.debug("storage: made binding for `"+e+"`"),r.bindings.set(e,n),n}))})}},{key:"adapter",get:function(){return t.config.storage[e+"Adapter"]}},{key:"bindings",get:function(){return f.get(this)}}]),r}()).prototype,"_getBinding",[u],(0,n.default)(l.prototype,"_getBinding"),l.prototype),l);return(0,r.default)(d.prototype,c.default),new d};var c=l(Ck);function l(e){return e&&e.__esModule?e:{default:e}}var f=new u.default});t(nR);var iR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=f(ac),n=f(pb),i=f(By),o=f(Yy),a=f(Xw),s=f(h_),u=f(dk),c=f(ud),l=f(vp);function f(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){var a,s;return new(a=(0,Yw.oneFlight)({keyFactory:function(e){return"initValue-"+e}}),function(e,t,r,n,i){var o={};Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0);o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0);void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null)}((s=function(){function r(){(0,i.default)(this,r),d.set(this,new n.default)}return(0,o.default)(r,[{key:"clear",value:function(){return t.spark[e+"Storage"].del(t.getNamespace())}},{key:"del",value:function(){for(var r,n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];return(r=t.spark[e+"Storage"]).del.apply(r,[t.getNamespace()].concat(i))}},{key:"get",value:function(r){var n=d.get(this).get(r);return n||(n=new Yw.Defer,d.get(this).set(r,n)),t.spark[e+"Storage"].get(t.getNamespace(),r).then(function(e){return n.resolve(),e})}},{key:"put",value:function(r,n){return t.spark[e+"Storage"].put(t.getNamespace(),r,p(n))}},{key:"waitFor",value:function(e){t.logger.debug("plugin-storage("+t.getNamespace()+"): waiting to init key `"+e+"`");var r=d.get(this).get(e);return r?(t.logger.debug("plugin-storage("+t.getNamespace()+"): already inited `"+e+"`"),r.promise):(t.logger.debug("plugin-storage("+t.getNamespace()+"): initing `"+e+"`"),this.initValue(e))}},{key:"initValue",value:function(r){var n=new Yw.Defer;return d.get(this).set(r,n),t.spark[e+"Storage"].get(t.getNamespace(),r).then(function(e){t.logger.debug("plugin-storage("+t.getNamespace()+"): got `"+r+"` for first time"),"@"===r?t.parent.set(e):(0,u.default)(t[r],"isState")?t[r].set(e):t.set(r,e),t.logger.debug("plugin-storage("+t.getNamespace()+"): set `"+r+"` for first time"),n.resolve(),t.logger.debug("plugin-storage("+t.getNamespace()+"): inited `"+r+"`")}).catch(function(e){return e instanceof tR.NotFoundError||e.toString().includes("MockNotFoundError")?(t.logger.debug("plugin-storage("+t.getNamespace()+"): no data for `"+r+"`, continuing"),n.resolve()):(t.logger.warn("plugin-storage("+t.getNamespace()+"): failed to init `"+r+"`",e),n.reject(e))}),n.promise}}]),r}()).prototype,"initValue",[a],(0,r.default)(s.prototype,"initValue"),s.prototype),s)};var d=new s.default;function p(e){if(!(0,c.default)(e))return e;var t=e.serialize?e.serialize():e;return(0,a.default)(t).forEach(function(e){var r=t[e];(0,l.default)(r)?0===r.length?t[e]=void 0:t[e]=r.map(p):(0,c.default)(r)&&(0,a.default)(r).forEach(function(e){r[e]=p(r[e])})}),(0,a.default)(t).reduce(function(e,r){return e&&!t[r]},!0)?void 0:t}});t(iR);var oR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(Xw),n=o(pb),i=o(_f);function o(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t=t||{},!e)return i.default.reject(new Error("`namespace` is required"));if(!t.logger)return i.default.reject(new Error("`options.logger` is required"));var o=t.logger,a=new n.default;return t.data&&(0,r.default)(t.data).forEach(function(e){a.set(e,t.data[e])}),o.debug("memory-store-adapter: returning binding"),i.default.resolve({clear:function(){return o.debug("memory-store-adapter: clearing the binding"),i.default.resolve(a.clear())},del:function(e){return o.debug("memory-store-adapter: deleting `"+e+"`"),i.default.resolve(a.delete(e))},get:function(e){o.debug("memory-store-adapter: reading `"+e+"`");var t=a.get(e);return void 0===t?i.default.reject(new tR.NotFoundError):i.default.resolve(t)},put:function(e,t){return o.debug("memory-store-adapter: writing `"+e+"`"),i.default.resolve(a.set(e,t))}})}t.default={bind:a,preload:function(e){return{bind:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e[t]&&(r.data=e[t]),a(t,r)}}}}});t(oR);var aR=r(function(e,t){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"persist",{enumerable:!0,get:function(){return rR.persist}}),Object.defineProperty(t,"waitForValue",{enumerable:!0,get:function(){return rR.waitForValue}}),Object.defineProperty(t,"makeSparkStore",{enumerable:!0,get:function(){return r(nR).default}}),Object.defineProperty(t,"makeSparkPluginStore",{enumerable:!0,get:function(){return r(iR).default}}),Object.defineProperty(t,"MemoryStoreAdapter",{enumerable:!0,get:function(){return r(oR).default}}),Object.defineProperty(t,"StorageError",{enumerable:!0,get:function(){return tR.StorageError}}),Object.defineProperty(t,"NotFoundError",{enumerable:!0,get:function(){return tR.NotFoundError}})});t(aR);var sR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=l(_f),n=l(Af),i=l(Xw),o=l(cg),a=l(ud),s=l(gg),u=l(my),c=l(Vk);function l(e){return e&&e.__esModule?e:{default:e}}var f=c.default.extend({derived:{boundedStorage:{deps:[],fn:function(){return(0,aR.makeSparkPluginStore)("bounded",this)}},unboundedStorage:{deps:[],fn:function(){return(0,aR.makeSparkPluginStore)("unbounded",this)}},config:{cache:!1,deps:["spark","spark.config"],fn:function(){if(this.spark&&this.spark.config){var e=this.getNamespace();return e?this.spark.config[e.toLowerCase()]:this.spark.config}return{}}},logger:{deps:["spark","spark.logger"],fn:function(){return this.spark.logger||console}},spark:{deps:["parent"],fn:function(){if(!this.parent&&!this.collection)throw new Error("Cannot determine `this.spark` without `this.parent` or `this.collection`. Please initialize `this` via `children` or `collection` or set `this.parent` manually");for(var e=this;e.parent||e.collection;)e=e.parent||e.collection;return e}}},session:{parent:{type:"any"},ready:{default:!0,type:"boolean"}},clear:function(e){var t=this;return(0,i.default)(this.attributes).forEach(function(r){"parent"!==r&&t.unset(r,e)}),(0,i.default)(this._children).forEach(function(e){t[e].clear()}),(0,i.default)(this._collections).forEach(function(e){t[e].reset()}),this},initialize:function(){for(var e=this,t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];(0,n.default)(c.default.prototype.initialize,this,r),this._dataTypes=(0,s.default)(this._dataTypes),(0,i.default)(this._dataTypes).forEach(function(t){e._dataTypes[t].set&&(e._dataTypes[t].set=e._dataTypes[t].set.bind(e))}),this.on("change",function(t,r){e.parent&&e.parent.trigger("change:"+e.getNamespace().toLowerCase(),e.parent,e,r)})},inspect:function(e){return u.default.inspect((0,o.default)(this.serialize({props:!0,session:!0,derived:!0}),"boundedStorage","unboundedStorage","config","logger","spark","parent"),{depth:e})},request:function(){var e;return(e=this.spark).request.apply(e,arguments)},upload:function(){var e;return(e=this.spark).upload.apply(e,arguments)},when:function(e){for(var t=this,n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];if(i&&i.length>0)throw new Error("#when() does not accept a callback, you must attach to its promise");return new r.default(function(r){t.once(e,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r(t)})})},_filterSetParameters:function(e,t,r){var n=void 0;return(0,a.default)(e)||null===e?(n=e,r=t):(n={})[e]=t,[n,r=r||{}]}});t.default=f});t(sR),tc(tc.S+tc.F*!Fu,"Object",{defineProperties:Cc});var uR=Yu.Object,cR=function(e,t){return uR.defineProperties(e,t)},lR=r(function(e){e.exports={default:cR,__esModule:!0}});t(lR);var fR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.OAuthError=void 0;var r=u(lR),n=u(rT),i=u(By),o=u(Yy),a=u(nT),s=u(iT);function u(e){return e&&e.__esModule?e:{default:e}}var c=t.OAuthError=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"parse",value:function(e){var t=e.body||e;return(0,r.default)(this,{error:{enumerable:!0,value:t.error},errorDescription:{enumerable:!0,value:t.error_description},errorUri:{enumerable:!0,value:t.error_uri},res:{enumerable:!1,value:e}}),this.errorDescription}}]),t}(Yw.Exception),l=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),t}(c),f=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),t}(c),d=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),t}(c),p=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),t}(c),h=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),t}(c),v=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),t}(c),g={OAuthError:c,InvalidRequestError:l,InvalidClientError:f,InvalidGrantError:d,UnauthorizedClientError:p,UnsupportGrantTypeError:h,InvalidScopeError:v,invalid_request:l,invalid_client:f,invalid_grant:d,unauthorized_client:p,unsupported_grant_type:h,invalid_scope:v,select:function(e){return g[e]||c}};t.default=g});t(fR);fR.OAuthError;var dR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.sortScope=function(e){if(!e)return"";return e.split(" ").sort().join(" ")},t.filterScope=function(e,t){if(!t)return"";return t.split(" ").filter(function(t){return t!==e}).sort().join(" ")}});t(dR);dR.sortScope,dR.filterScope;var pR=Uc("iterator"),hR=Yu.isIterable=function(e){var t=Object(e);return void 0!==t[pR]||"@@iterator"in t||vc.hasOwnProperty(ll(t))},vR=r(function(e){e.exports={default:hR,__esModule:!0}});t(vR);var gR=Yu.getIterator=function(e){var t=ml(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return Ju(t.call(e))},mR=r(function(e){e.exports={default:gR,__esModule:!0}});t(mR);var yR=r(function(e,t){t.__esModule=!0;var r=i(vR),n=i(mR);function i(e){return e&&e.__esModule?e:{default:e}}t.default=function(){return function(e,t){if(Array.isArray(e))return e;if((0,r.default)(Object(e)))return function(e,t){var r=[],i=!0,o=!1,a=void 0;try{for(var s,u=(0,n.default)(e);!(i=(s=u.next()).done)&&(r.push(s.value),!t||r.length!==t);i=!0);}catch(e){o=!0,a=e}finally{try{!i&&u.return&&u.return()}finally{if(o)throw a}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()});t(yR);var _R=function(e,t,r,n){if(!ud(e))return e;for(var i=-1,o=(t=Cv(t,e)).length,a=o-1,s=e;null!=s&&++i<o;){var u=Dv(t[i]),c=r;if(i!=a){var l=s[u];void 0===(c=n?n(l,u,s):void 0)&&(c=ud(l)?l:bp(t[i+1])?[]:{})}op(s,u,c),s=s[u]}return e};var bR=function(e,t,r){for(var n=-1,i=t.length,o={};++n<i;){var a=t[n],s=jv(e,a);r(s,a)&&_R(o,Cv(a,e),s)}return o};var ER=function(e,t){return null!=e&&t in Object(e)};var SR=function(e,t){return null!=e&&lk(e,t,ER)};var TR=function(e,t){return bR(e,t,function(t,r){return SR(e,r)})},wR=ug(function(e,t){return null==e?{}:TR(e,t)});tc(tc.S+tc.F*Uu(function(){Reflect.defineProperty(Qu.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(e,t,r){Ju(e),t=ju(t,!0),Ju(r);try{return Qu.f(e,t,r),!0}catch(e){return!1}}});var OR=Yu.Reflect.defineProperty,kR=r(function(e){e.exports={default:OR,__esModule:!0}});t(kR),tc(tc.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return Hu.f(Ju(e),t)}});var RR=Yu.Reflect.getOwnPropertyDescriptor,AR=r(function(e){e.exports={default:RR,__esModule:!0}});t(AR),tc(tc.S,"Number",{isNaN:function(e){return e!=e}});var IR=Yu.Number.isNaN,PR=r(function(e){e.exports={default:IR,__esModule:!0}});t(PR);var CR="[object Number]";var MR=function(e){return"number"==typeof e||up(e)&&sd(e)==CR},NR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(PR),n=o(lR),i=o(MR);function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){(0,n.default)(this,{loaded:{enumerable:!0,value:e,writable:!1},total:{enumerable:!0,value:t,writable:!1},lengthComputable:{enumerable:!0,value:(0,i.default)(e)&&!(0,r.default)(e)&&(0,i.default)(t)&&!(0,r.default)(t)&&t>0,writable:!1}})}});t(NR);var DR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(_f),n=s(kR),i=s(Xw),o=s(By),a=s(Yy);function s(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){var r=this;(0,o.default)(this,e),t&&(0,i.default)(t).forEach(function(e){var i=t[e];(0,n.default)(r,e,{enumerable:!0,value:i})})}return(0,a.default)(e,[{key:"onRequest",value:function(e){return r.default.resolve(e)}},{key:"onRequestError",value:function(e,t){return r.default.reject(t)}},{key:"onResponse",value:function(e,t){return r.default.resolve(t)}},{key:"onResponseError",value:function(e,t){return r.default.reject(t)}}],[{key:"create",value:function(){throw new Error("`Interceptor.create()` must be defined")}}]),e}();t.default=u});t(DR);var jR=Mu.f,xR=function(e){return function(t){for(var r,n=Cu(t),i=Pc(n),o=i.length,a=0,s=[];o>a;)jR.call(n,r=i[a++])&&s.push(e?[r,n[r]]:n[r]);return s}},LR=xR(!1);tc(tc.S,"Object",{values:function(e){return LR(e)}});var UR=Yu.Object.values,FR=r(function(e){e.exports={default:UR,__esModule:!0}});t(FR);var GR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=s(wf),n=s(rT),i=s(By),o=s(nT),a=s(iT);function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(e),s=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(e),u=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),c=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),l=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),f=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),d=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),p=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),h=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),v=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),g=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),m=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),y=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),_=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),b=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),E=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),S=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),T=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),w=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),O=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(s),k=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(e),R=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(k),A=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(k),I=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(k),P=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(k),C=function(e){function t(){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),t}(k);(0,r.default)(e,{0:t,NetworkOrCORSError:t,400:s,BadRequest:s,401:u,Unauthorized:u,402:c,PaymentRequired:c,403:l,Forbidden:l,404:f,NotFound:f,405:d,MethodNotAllowed:d,406:p,NotAcceptable:p,407:h,ProxyAuthenticationRequired:h,408:v,RequestTimeout:v,409:g,Conflict:g,410:m,Gone:m,411:y,LengthRequired:y,412:_,PreconditionFailed:_,413:b,RequestEntityTooLarge:b,414:E,RequestUriTooLong:E,415:S,UnsupportedMediaType:S,416:T,RequestRangeNotSatisfiable:T,417:w,ExpectationFailed:w,429:O,TooManyRequests:O,500:k,InternalServerError:k,501:R,NotImplemented:R,502:A,BadGateway:A,503:I,ServiceUnavailable:I,504:P,GatewayTimeout:P,505:C,HttpVersionNotSupported:C,select:function(t){if(null==t)return e;t=t.statusCode||t;var r=e[t];return r||(t=t.toString().split("").shift()+"00",t=parseInt(t,10),e[t]||e)}})}});t(GR);var qR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,n,i=v(Cf),o=v(FR),a=v(lR),s=v(ob),u=v(rT),c=v(By),l=v(Yy),f=v(nT),d=v(iT),p=v(wR),h=v(GR);function v(e){return e&&e.__esModule?e:{default:e}}var g=(n=r=function(e){function t(){return(0,c.default)(this,t),(0,f.default)(this,(t.__proto__||(0,u.default)(t)).apply(this,arguments))}return(0,d.default)(t,e),(0,l.default)(t,[{key:"parse",value:function(e){var t=e.body,r=void 0;switch(void 0===t?"undefined":(0,s.default)(t)){case"string":try{t=JSON.parse(t),r=this.parseObject(t)}catch(e){r=t}break;case"object":r=this.parseObject(t)}return r||(r=this.defaultMessage),(0,a.default)(this,{body:{enumerable:!1,value:t},httpVersion:{enumerable:!1,value:e.httpVersion},headers:{enumerable:!1,value:e.headers||{}},rawHeaders:{enumerable:!1,value:e.rawHeaders||[]},trailers:{enumerable:!1,value:e.trailers||{}},rawTrailers:{enumerable:!1,value:e.rawTrailers||[]},method:{enumerable:!1,value:e.method},url:{enumerable:!1,value:e.url},statusCode:{enumerable:!1,value:e.statusCode},statusMessage:{enumerable:!1,value:e.statusMessage},socket:{enumerable:!1,value:e.socket},_res:{enumerable:!1,value:e}}),r}},{key:"parseObject",value:function(e){var r=(0,o.default)((0,p.default)(e,t.errorKeys));if(0===r.length)return(0,i.default)(e,null,2);var n=r[0];return"object"===(void 0===n?"undefined":(0,s.default)(n))?this.parseObject(n):n}}]),t}(Yw.Exception),r.errorKeys=["error","errorString","response","errorResponse","message","msg"],r.defaultMessage="An error was received while trying to fulfill the request",n);t.default=g,(0,h.default)(g),g.makeSubTypes=h.default});t(qR);var VR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=f(_f),n=f(lR),i=f(rT),o=f(By),a=f(Yy),s=f(nT),u=f(iT),c=f(qR),l=f(DR);function f(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e,r){(0,o.default)(this,t);var a=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e)),u=r&&(r.error||r.ErrorConstructor)||c.default;return(0,n.default)(a,{ErrorConstructor:{value:u}}),a}return(0,u.default)(t,e),(0,a.default)(t,[{key:"onResponse",value:function(e,t){if(t.statusCode){if(t.statusCode<400)return r.default.resolve(t);if(404===t.statusCode&&t.body&&2000002===t.body.errorCode)return r.default.resolve(t)}return r.default.reject(new(this.ErrorConstructor.select(t.statusCode))(t))}}],[{key:"create",value:function(e){return new t(this,e)}}]),t}(l.default);t.default=d});t(VR);var BR=function(e){return e&&e.length>1?255===e[0]&&216===e[1]&&255===e[2]?{ext:"jpg",mime:"image/jpeg"}:137===e[0]&&80===e[1]&&78===e[2]&&71===e[3]?{ext:"png",mime:"image/png"}:71===e[0]&&73===e[1]&&70===e[2]?{ext:"gif",mime:"image/gif"}:87===e[8]&&69===e[9]&&66===e[10]&&80===e[11]?{ext:"webp",mime:"image/webp"}:70===e[0]&&76===e[1]&&73===e[2]&&70===e[3]?{ext:"flif",mime:"image/flif"}:(73===e[0]&&73===e[1]&&42===e[2]&&0===e[3]||77===e[0]&&77===e[1]&&0===e[2]&&42===e[3])&&67===e[8]&&82===e[9]?{ext:"cr2",mime:"image/x-canon-cr2"}:73===e[0]&&73===e[1]&&42===e[2]&&0===e[3]||77===e[0]&&77===e[1]&&0===e[2]&&42===e[3]?{ext:"tif",mime:"image/tiff"}:66===e[0]&&77===e[1]?{ext:"bmp",mime:"image/bmp"}:73===e[0]&&73===e[1]&&188===e[2]?{ext:"jxr",mime:"image/vnd.ms-photo"}:56===e[0]&&66===e[1]&&80===e[2]&&83===e[3]?{ext:"psd",mime:"image/vnd.adobe.photoshop"}:80===e[0]&&75===e[1]&&3===e[2]&&4===e[3]&&109===e[30]&&105===e[31]&&109===e[32]&&101===e[33]&&116===e[34]&&121===e[35]&&112===e[36]&&101===e[37]&&97===e[38]&&112===e[39]&&112===e[40]&&108===e[41]&&105===e[42]&&99===e[43]&&97===e[44]&&116===e[45]&&105===e[46]&&111===e[47]&&110===e[48]&&47===e[49]&&101===e[50]&&112===e[51]&&117===e[52]&&98===e[53]&&43===e[54]&&122===e[55]&&105===e[56]&&112===e[57]?{ext:"epub",mime:"application/epub+zip"}:80===e[0]&&75===e[1]&&3===e[2]&&4===e[3]&&77===e[30]&&69===e[31]&&84===e[32]&&65===e[33]&&45===e[34]&&73===e[35]&&78===e[36]&&70===e[37]&&47===e[38]&&109===e[39]&&111===e[40]&&122===e[41]&&105===e[42]&&108===e[43]&&108===e[44]&&97===e[45]&&46===e[46]&&114===e[47]&&115===e[48]&&97===e[49]?{ext:"xpi",mime:"application/x-xpinstall"}:80!==e[0]||75!==e[1]||3!==e[2]&&5!==e[2]&&7!==e[2]||4!==e[3]&&6!==e[3]&&8!==e[3]?117===e[257]&&115===e[258]&&116===e[259]&&97===e[260]&&114===e[261]?{ext:"tar",mime:"application/x-tar"}:82!==e[0]||97!==e[1]||114!==e[2]||33!==e[3]||26!==e[4]||7!==e[5]||0!==e[6]&&1!==e[6]?31===e[0]&&139===e[1]&&8===e[2]?{ext:"gz",mime:"application/gzip"}:66===e[0]&&90===e[1]&&104===e[2]?{ext:"bz2",mime:"application/x-bzip2"}:55===e[0]&&122===e[1]&&188===e[2]&&175===e[3]&&39===e[4]&&28===e[5]?{ext:"7z",mime:"application/x-7z-compressed"}:120===e[0]&&1===e[1]?{ext:"dmg",mime:"application/x-apple-diskimage"}:0===e[0]&&0===e[1]&&0===e[2]&&(24===e[3]||32===e[3])&&102===e[4]&&116===e[5]&&121===e[6]&&112===e[7]||51===e[0]&&103===e[1]&&112===e[2]&&53===e[3]||0===e[0]&&0===e[1]&&0===e[2]&&28===e[3]&&102===e[4]&&116===e[5]&&121===e[6]&&112===e[7]&&109===e[8]&&112===e[9]&&52===e[10]&&50===e[11]&&109===e[16]&&112===e[17]&&52===e[18]&&49===e[19]&&109===e[20]&&112===e[21]&&52===e[22]&&50===e[23]&&105===e[24]&&115===e[25]&&111===e[26]&&109===e[27]||0===e[0]&&0===e[1]&&0===e[2]&&28===e[3]&&102===e[4]&&116===e[5]&&121===e[6]&&112===e[7]&&105===e[8]&&115===e[9]&&111===e[10]&&109===e[11]||0===e[0]&&0===e[1]&&0===e[2]&&28===e[3]&&102===e[4]&&116===e[5]&&121===e[6]&&112===e[7]&&109===e[8]&&112===e[9]&&52===e[10]&&50===e[11]&&0===e[12]&&0===e[13]&&0===e[14]&&0===e[15]?{ext:"mp4",mime:"video/mp4"}:0===e[0]&&0===e[1]&&0===e[2]&&28===e[3]&&102===e[4]&&116===e[5]&&121===e[6]&&112===e[7]&&77===e[8]&&52===e[9]&&86===e[10]?{ext:"m4v",mime:"video/x-m4v"}:77===e[0]&&84===e[1]&&104===e[2]&&100===e[3]?{ext:"mid",mime:"audio/midi"}:109===e[31]&&97===e[32]&&116===e[33]&&114===e[34]&&111===e[35]&&115===e[36]&&107===e[37]&&97===e[38]?{ext:"mkv",mime:"video/x-matroska"}:26===e[0]&&69===e[1]&&223===e[2]&&163===e[3]?{ext:"webm",mime:"video/webm"}:0===e[0]&&0===e[1]&&0===e[2]&&20===e[3]&&102===e[4]&&116===e[5]&&121===e[6]&&112===e[7]?{ext:"mov",mime:"video/quicktime"}:82===e[0]&&73===e[1]&&70===e[2]&&70===e[3]&&65===e[8]&&86===e[9]&&73===e[10]?{ext:"avi",mime:"video/x-msvideo"}:48===e[0]&&38===e[1]&&178===e[2]&&117===e[3]&&142===e[4]&&102===e[5]&&207===e[6]&&17===e[7]&&166===e[8]&&217===e[9]?{ext:"wmv",mime:"video/x-ms-wmv"}:0===e[0]&&0===e[1]&&1===e[2]&&"b"===e[3].toString(16)[0]?{ext:"mpg",mime:"video/mpeg"}:73===e[0]&&68===e[1]&&51===e[2]||255===e[0]&&251===e[1]?{ext:"mp3",mime:"audio/mpeg"}:102===e[4]&&116===e[5]&&121===e[6]&&112===e[7]&&77===e[8]&&52===e[9]&&65===e[10]||77===e[0]&&52===e[1]&&65===e[2]&&32===e[3]?{ext:"m4a",mime:"audio/m4a"}:79===e[28]&&112===e[29]&&117===e[30]&&115===e[31]&&72===e[32]&&101===e[33]&&97===e[34]&&100===e[35]?{ext:"opus",mime:"audio/opus"}:79===e[0]&&103===e[1]&&103===e[2]&&83===e[3]?{ext:"ogg",mime:"audio/ogg"}:102===e[0]&&76===e[1]&&97===e[2]&&67===e[3]?{ext:"flac",mime:"audio/x-flac"}:82===e[0]&&73===e[1]&&70===e[2]&&70===e[3]&&87===e[8]&&65===e[9]&&86===e[10]&&69===e[11]?{ext:"wav",mime:"audio/x-wav"}:35===e[0]&&33===e[1]&&65===e[2]&&77===e[3]&&82===e[4]&&10===e[5]?{ext:"amr",mime:"audio/amr"}:37===e[0]&&80===e[1]&&68===e[2]&&70===e[3]?{ext:"pdf",mime:"application/pdf"}:77===e[0]&&90===e[1]?{ext:"exe",mime:"application/x-msdownload"}:67!==e[0]&&70!==e[0]||87!==e[1]||83!==e[2]?123===e[0]&&92===e[1]&&114===e[2]&&116===e[3]&&102===e[4]?{ext:"rtf",mime:"application/rtf"}:119===e[0]&&79===e[1]&&70===e[2]&&70===e[3]&&(0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]||79===e[4]&&84===e[5]&&84===e[6]&&79===e[7])?{ext:"woff",mime:"application/font-woff"}:119===e[0]&&79===e[1]&&70===e[2]&&50===e[3]&&(0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]||79===e[4]&&84===e[5]&&84===e[6]&&79===e[7])?{ext:"woff2",mime:"application/font-woff"}:76===e[34]&&80===e[35]&&(0===e[8]&&0===e[9]&&1===e[10]||1===e[8]&&0===e[9]&&2===e[10]||2===e[8]&&0===e[9]&&2===e[10])?{ext:"eot",mime:"application/octet-stream"}:0===e[0]&&1===e[1]&&0===e[2]&&0===e[3]&&0===e[4]?{ext:"ttf",mime:"application/font-sfnt"}:79===e[0]&&84===e[1]&&84===e[2]&&79===e[3]&&0===e[4]?{ext:"otf",mime:"application/font-sfnt"}:0===e[0]&&0===e[1]&&1===e[2]&&0===e[3]?{ext:"ico",mime:"image/x-icon"}:70===e[0]&&76===e[1]&&86===e[2]&&1===e[3]?{ext:"flv",mime:"video/x-flv"}:37===e[0]&&33===e[1]?{ext:"ps",mime:"application/postscript"}:253===e[0]&&55===e[1]&&122===e[2]&&88===e[3]&&90===e[4]&&0===e[5]?{ext:"xz",mime:"application/x-xz"}:83===e[0]&&81===e[1]&&76===e[2]&&105===e[3]?{ext:"sqlite",mime:"application/x-sqlite3"}:78===e[0]&&69===e[1]&&83===e[2]&&26===e[3]?{ext:"nes",mime:"application/x-nintendo-nes-rom"}:67===e[0]&&114===e[1]&&50===e[2]&&52===e[3]?{ext:"crx",mime:"application/x-google-chrome-extension"}:77===e[0]&&83===e[1]&&67===e[2]&&70===e[3]||73===e[0]&&83===e[1]&&99===e[2]&&40===e[3]?{ext:"cab",mime:"application/vnd.ms-cab-compressed"}:33===e[0]&&60===e[1]&&97===e[2]&&114===e[3]&&99===e[4]&&104===e[5]&&62===e[6]&&10===e[7]&&100===e[8]&&101===e[9]&&98===e[10]&&105===e[11]&&97===e[12]&&110===e[13]&&45===e[14]&&98===e[15]&&105===e[16]&&110===e[17]&&97===e[18]&&114===e[19]&&121===e[20]?{ext:"deb",mime:"application/x-deb"}:33===e[0]&&60===e[1]&&97===e[2]&&114===e[3]&&99===e[4]&&104===e[5]&&62===e[6]?{ext:"ar",mime:"application/x-unix-archive"}:237===e[0]&&171===e[1]&&238===e[2]&&219===e[3]?{ext:"rpm",mime:"application/x-rpm"}:31===e[0]&&160===e[1]||31===e[0]&&157===e[1]?{ext:"Z",mime:"application/x-compress"}:76===e[0]&&90===e[1]&&73===e[2]&&80===e[3]?{ext:"lz",mime:"application/x-lzip"}:208===e[0]&&207===e[1]&&17===e[2]&&224===e[3]&&161===e[4]&&177===e[5]&&26===e[6]&&225===e[7]?{ext:"msi",mime:"application/x-msi"}:null:{ext:"swf",mime:"application/x-shockwave-flash"}:{ext:"rar",mime:"application/x-rar-compressed"}:{ext:"zip",mime:"application/zip"}:null},zR=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.detect=void 0;var r=i(_f);t.default=o,t.detectSync=a;var n=i(BR);function i(e){return e&&e.__esModule?e:{default:e}}function o(e){return new r.default(function(t){t(a(e))})}function a(e){var t=e;if(Yw.inBrowser){if(e instanceof Blob)return e.type;if(e instanceof ArrayBuffer)t=new Uint8Array(e);else if(!(e instanceof Uint8Array))throw new Error("`detect` requires a buffer of type Blob, ArrayBuffer, or Uint8Array")}var r=(0,n.default)(t);return r?r.mime:"application/octet-stream"}t.detect=o});t(zR);zR.detect,zR.detectSync;var WR=Object.prototype.hasOwnProperty,HR=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),YR=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)void 0!==e[n]&&(r[n]=e[n]);return r},$R={arrayToObject:YR,assign:function(e,t){return Object.keys(t).reduce(function(e,r){return e[r]=t[r],e},e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],n=0;n<t.length;++n)for(var i=t[n],o=i.obj[i.prop],a=Object.keys(o),s=0;s<a.length;++s){var u=a[s],c=o[u];"object"==typeof c&&null!==c&&-1===r.indexOf(c)&&(t.push({obj:o,prop:u}),r.push(c))}return function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(Array.isArray(r)){for(var n=[],i=0;i<r.length;++i)void 0!==r[i]&&n.push(r[i]);t.obj[t.prop]=n}}}(t),e},decode:function(e,t,r){var n=e.replace(/\+/g," ");if("iso-8859-1"===r)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(e){return n}},encode:function(e,t,r){if(0===e.length)return e;var n="string"==typeof e?e:String(e);if("iso-8859-1"===r)return escape(n).replace(/%u[0-9a-f]{4}/gi,function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"});for(var i="",o=0;o<n.length;++o){var a=n.charCodeAt(o);45===a||46===a||95===a||126===a||a>=48&&a<=57||a>=65&&a<=90||a>=97&&a<=122?i+=n.charAt(o):a<128?i+=HR[a]:a<2048?i+=HR[192|a>>6]+HR[128|63&a]:a<55296||a>=57344?i+=HR[224|a>>12]+HR[128|a>>6&63]+HR[128|63&a]:(o+=1,a=65536+((1023&a)<<10|1023&n.charCodeAt(o)),i+=HR[240|a>>18]+HR[128|a>>12&63]+HR[128|a>>6&63]+HR[128|63&a])}return i},isBuffer:function(e){return null!=e&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},merge:function e(t,r,n){if(!r)return t;if("object"!=typeof r){if(Array.isArray(t))t.push(r);else{if("object"!=typeof t)return[t,r];(n&&(n.plainObjects||n.allowPrototypes)||!WR.call(Object.prototype,r))&&(t[r]=!0)}return t}if("object"!=typeof t)return[t].concat(r);var i=t;return Array.isArray(t)&&!Array.isArray(r)&&(i=YR(t,n)),Array.isArray(t)&&Array.isArray(r)?(r.forEach(function(r,i){WR.call(t,i)?t[i]&&"object"==typeof t[i]?t[i]=e(t[i],r,n):t.push(r):t[i]=r}),t):Object.keys(r).reduce(function(t,i){var o=r[i];return WR.call(t,i)?t[i]=e(t[i],o,n):t[i]=o,t},i)}},XR=String.prototype.replace,JR=/%20/g,KR={default:"RFC3986",formatters:{RFC1738:function(e){return XR.call(e,JR,"+")},RFC3986:function(e){return e}},RFC1738:"RFC1738",RFC3986:"RFC3986"},QR={brackets:function(e){return e+"[]"},indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},ZR=Array.isArray,eA=Array.prototype.push,tA=function(e,t){eA.apply(e,ZR(t)?t:[t])},rA=Date.prototype.toISOString,nA={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:$R.encode,encodeValuesOnly:!1,indices:!1,serializeDate:function(e){return rA.call(e)},skipNulls:!1,strictNullHandling:!1},iA=function e(t,r,n,i,o,a,s,u,c,l,f,d,p){var h=t;if("function"==typeof s?h=s(r,h):h instanceof Date&&(h=l(h)),null===h){if(i)return a&&!d?a(r,nA.encoder,p):r;h=""}if("string"==typeof h||"number"==typeof h||"boolean"==typeof h||$R.isBuffer(h))return a?[f(d?r:a(r,nA.encoder,p))+"="+f(a(h,nA.encoder,p))]:[f(r)+"="+f(String(h))];var v,g=[];if(void 0===h)return g;if(Array.isArray(s))v=s;else{var m=Object.keys(h);v=u?m.sort(u):m}for(var y=0;y<v.length;++y){var _=v[y];o&&null===h[_]||(Array.isArray(h)?tA(g,e(h[_],n(r,_),n,i,o,a,s,u,c,l,f,d,p)):tA(g,e(h[_],r+(c?"."+_:"["+_+"]"),n,i,o,a,s,u,c,l,f,d,p)))}return g},oA=Object.prototype.hasOwnProperty,aA={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,decoder:$R.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},sA=function(e){return e.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},uA=function(e,t,r){if(e){var n=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,i=/(\[[^[\]]*])/g,o=/(\[[^[\]]*])/.exec(n),a=o?n.slice(0,o.index):n,s=[];if(a){if(!r.plainObjects&&oA.call(Object.prototype,a)&&!r.allowPrototypes)return;s.push(a)}for(var u=0;null!==(o=i.exec(n))&&u<r.depth;){if(u+=1,!r.plainObjects&&oA.call(Object.prototype,o[1].slice(1,-1))&&!r.allowPrototypes)return;s.push(o[1])}return o&&s.push("["+n.slice(o.index)+"]"),function(e,t,r){for(var n=t,i=e.length-1;i>=0;--i){var o,a=e[i];if("[]"===a&&r.parseArrays)o=[].concat(n);else{o=r.plainObjects?Object.create(null):{};var s="["===a.charAt(0)&&"]"===a.charAt(a.length-1)?a.slice(1,-1):a,u=parseInt(s,10);r.parseArrays||""!==s?!isNaN(u)&&a!==s&&String(u)===s&&u>=0&&r.parseArrays&&u<=r.arrayLimit?(o=[])[u]=n:o[s]=n:o={0:n}}n=o}return n}(s,t,r)}},cA={formats:KR,parse:function(e,t){var r=t?$R.assign({},t):{};if(null!==r.decoder&&void 0!==r.decoder&&"function"!=typeof r.decoder)throw new TypeError("Decoder has to be a function.");if(r.ignoreQueryPrefix=!0===r.ignoreQueryPrefix,r.delimiter="string"==typeof r.delimiter||$R.isRegExp(r.delimiter)?r.delimiter:aA.delimiter,r.depth="number"==typeof r.depth?r.depth:aA.depth,r.arrayLimit="number"==typeof r.arrayLimit?r.arrayLimit:aA.arrayLimit,r.parseArrays=!1!==r.parseArrays,r.decoder="function"==typeof r.decoder?r.decoder:aA.decoder,r.allowDots=void 0===r.allowDots?aA.allowDots:!!r.allowDots,r.plainObjects="boolean"==typeof r.plainObjects?r.plainObjects:aA.plainObjects,r.allowPrototypes="boolean"==typeof r.allowPrototypes?r.allowPrototypes:aA.allowPrototypes,r.parameterLimit="number"==typeof r.parameterLimit?r.parameterLimit:aA.parameterLimit,r.strictNullHandling="boolean"==typeof r.strictNullHandling?r.strictNullHandling:aA.strictNullHandling,void 0!==r.charset&&"utf-8"!==r.charset&&"iso-8859-1"!==r.charset)throw new Error("The charset option must be either utf-8, iso-8859-1, or undefined");if(void 0===r.charset&&(r.charset=aA.charset),""===e||null==e)return r.plainObjects?Object.create(null):{};for(var n="string"==typeof e?function(e,t){var r,n={},i=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,o=t.parameterLimit===1/0?void 0:t.parameterLimit,a=i.split(t.delimiter,o),s=-1,u=t.charset;if(t.charsetSentinel)for(r=0;r<a.length;++r)0===a[r].indexOf("utf8=")&&("utf8=%E2%9C%93"===a[r]?u="utf-8":"utf8=%26%2310003%3B"===a[r]&&(u="iso-8859-1"),s=r,r=a.length);for(r=0;r<a.length;++r)if(r!==s){var c,l,f=a[r],d=f.indexOf("]="),p=-1===d?f.indexOf("="):d+1;-1===p?(c=t.decoder(f,aA.decoder,u),l=t.strictNullHandling?null:""):(c=t.decoder(f.slice(0,p),aA.decoder,u),l=t.decoder(f.slice(p+1),aA.decoder,u)),l&&t.interpretNumericEntities&&"iso-8859-1"===u&&(l=sA(l)),oA.call(n,c)?n[c]=$R.combine(n[c],l):n[c]=l}return n}(e,r):e,i=r.plainObjects?Object.create(null):{},o=Object.keys(n),a=0;a<o.length;++a){var s=o[a],u=uA(s,n[s],r);i=$R.merge(i,u,r)}return $R.compact(i)},stringify:function(e,t){var r=e,n=t?$R.assign({},t):{};if(null!==n.encoder&&void 0!==n.encoder&&"function"!=typeof n.encoder)throw new TypeError("Encoder has to be a function.");var i=void 0===n.delimiter?nA.delimiter:n.delimiter,o="boolean"==typeof n.strictNullHandling?n.strictNullHandling:nA.strictNullHandling,a="boolean"==typeof n.skipNulls?n.skipNulls:nA.skipNulls,s="boolean"==typeof n.encode?n.encode:nA.encode,u="function"==typeof n.encoder?n.encoder:nA.encoder,c="function"==typeof n.sort?n.sort:null,l=void 0===n.allowDots?nA.allowDots:!!n.allowDots,f="function"==typeof n.serializeDate?n.serializeDate:nA.serializeDate,d="boolean"==typeof n.encodeValuesOnly?n.encodeValuesOnly:nA.encodeValuesOnly,p=n.charset||nA.charset;if(void 0!==n.charset&&"utf-8"!==n.charset&&"iso-8859-1"!==n.charset)throw new Error("The charset option must be either utf-8, iso-8859-1, or undefined");if(void 0===n.format)n.format=KR.default;else if(!Object.prototype.hasOwnProperty.call(KR.formatters,n.format))throw new TypeError("Unknown format option provided.");var h,v,g=KR.formatters[n.format];"function"==typeof n.filter?r=(v=n.filter)("",r):Array.isArray(n.filter)&&(h=v=n.filter);var m,y=[];if("object"!=typeof r||null===r)return"";m=n.arrayFormat in QR?n.arrayFormat:"indices"in n?n.indices?"indices":"repeat":"indices";var _=QR[m];h||(h=Object.keys(r)),c&&h.sort(c);for(var b=0;b<h.length;++b){var E=h[b];a&&null===r[E]||tA(y,iA(r[E],E,_,o,a,s?u:null,v,c,l,f,g,d,p))}var S=y.join(i),T=!0===n.addQueryPrefix?"?":"";return n.charsetSentinel&&(T+="iso-8859-1"===p?"utf8=%26%2310003%3B&":"utf8=%E2%9C%93&"),S.length>0?T+S:""}},lA="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},fA=function(e){var t=dA.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)},dA=Object.prototype.toString;var pA,hA=Array.prototype.slice,vA=Object.prototype.toString,gA=Function.prototype.bind||function(e){var t=this;if("function"!=typeof t||"[object Function]"!==vA.call(t))throw new TypeError("Function.prototype.bind called on incompatible "+t);for(var r,n=hA.call(arguments,1),i=Math.max(0,t.length-n.length),o=[],a=0;a<i;a++)o.push("$"+a);if(r=Function("binder","return function ("+o.join(",")+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof r){var i=t.apply(this,n.concat(hA.call(arguments)));return Object(i)===i?i:this}return t.apply(e,n.concat(hA.call(arguments)))}),t.prototype){var s=function(){};s.prototype=t.prototype,r.prototype=new s,s.prototype=null}return r},mA=Object.prototype.toString,yA=function(e){var t=mA.call(e),r="[object Arguments]"===t;return r||(r="[object Array]"!==t&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===mA.call(e.callee)),r};if(!Object.keys){var _A=Object.prototype.hasOwnProperty,bA=Object.prototype.toString,EA=yA,SA=Object.prototype.propertyIsEnumerable,TA=!SA.call({toString:null},"toString"),wA=SA.call(function(){},"prototype"),OA=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],kA=function(e){var t=e.constructor;return t&&t.prototype===e},RA={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},AA=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!RA["$"+e]&&_A.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{kA(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();pA=function(e){var t=null!==e&&"object"==typeof e,r="[object Function]"===bA.call(e),n=EA(e),i=t&&"[object String]"===bA.call(e),o=[];if(!t&&!r&&!n)throw new TypeError("Object.keys called on a non-object");var a=wA&&r;if(i&&e.length>0&&!_A.call(e,0))for(var s=0;s<e.length;++s)o.push(String(s));if(n&&e.length>0)for(var u=0;u<e.length;++u)o.push(String(u));else for(var c in e)a&&"prototype"===c||!_A.call(e,c)||o.push(String(c));if(TA)for(var l=function(e){if("undefined"==typeof window||!AA)return kA(e);try{return kA(e)}catch(e){return!1}}(e),f=0;f<OA.length;++f)l&&"constructor"===OA[f]||!_A.call(e,OA[f])||o.push(OA[f]);return o}}var IA=pA,PA=Array.prototype.slice,CA=Object.keys,MA=CA?function(e){return CA(e)}:IA,NA=Object.keys;MA.shim=function(){Object.keys?function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2)||(Object.keys=function(e){return yA(e)?NA(PA.call(e)):NA(e)}):Object.keys=MA;return Object.keys||MA};var DA=MA,jA="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),xA=Object.prototype.toString,LA=Array.prototype.concat,UA=Object.defineProperty,FA=UA&&function(){var e={};try{for(var t in UA(e,"x",{enumerable:!1,value:e}),e)return!1;return e.x===e}catch(e){return!1}}(),GA=function(e,t,r,n){var i;t in e&&("function"!=typeof(i=n)||"[object Function]"!==xA.call(i)||!n())||(FA?UA(e,t,{configurable:!0,enumerable:!1,value:r,writable:!0}):e[t]=r)},qA=function(e,t){var r=arguments.length>2?arguments[2]:{},n=DA(t);jA&&(n=LA.call(n,Object.getOwnPropertySymbols(t)));for(var i=0;i<n.length;i+=1)GA(e,n[i],t[n[i]],r[n[i]])};qA.supportsDescriptors=!!FA;var VA=qA,BA=Object.getOwnPropertyDescriptor?function(){return Object.getOwnPropertyDescriptor(arguments,"callee").get}():function(){throw new TypeError},zA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator,WA=Object.getPrototypeOf||function(e){return e.__proto__},HA="undefined"==typeof Uint8Array?void 0:WA(Uint8Array),YA={"$ %Array%":Array,"$ %ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"$ %ArrayBufferPrototype%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer.prototype,"$ %ArrayIteratorPrototype%":zA?WA([][Symbol.iterator]()):void 0,"$ %ArrayPrototype%":Array.prototype,"$ %ArrayProto_entries%":Array.prototype.entries,"$ %ArrayProto_forEach%":Array.prototype.forEach,"$ %ArrayProto_keys%":Array.prototype.keys,"$ %ArrayProto_values%":Array.prototype.values,"$ %AsyncFromSyncIteratorPrototype%":void 0,"$ %AsyncFunction%":void 0,"$ %AsyncFunctionPrototype%":void 0,"$ %AsyncGenerator%":void 0,"$ %AsyncGeneratorFunction%":void 0,"$ %AsyncGeneratorPrototype%":void 0,"$ %AsyncIteratorPrototype%":void 0,"$ %Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"$ %Boolean%":Boolean,"$ %BooleanPrototype%":Boolean.prototype,"$ %DataView%":"undefined"==typeof DataView?void 0:DataView,"$ %DataViewPrototype%":"undefined"==typeof DataView?void 0:DataView.prototype,"$ %Date%":Date,"$ %DatePrototype%":Date.prototype,"$ %decodeURI%":decodeURI,"$ %decodeURIComponent%":decodeURIComponent,"$ %encodeURI%":encodeURI,"$ %encodeURIComponent%":encodeURIComponent,"$ %Error%":Error,"$ %ErrorPrototype%":Error.prototype,"$ %eval%":eval,"$ %EvalError%":EvalError,"$ %EvalErrorPrototype%":EvalError.prototype,"$ %Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"$ %Float32ArrayPrototype%":"undefined"==typeof Float32Array?void 0:Float32Array.prototype,"$ %Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"$ %Float64ArrayPrototype%":"undefined"==typeof Float64Array?void 0:Float64Array.prototype,"$ %Function%":Function,"$ %FunctionPrototype%":Function.prototype,"$ %Generator%":void 0,"$ %GeneratorFunction%":void 0,"$ %GeneratorPrototype%":void 0,"$ %Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"$ %Int8ArrayPrototype%":"undefined"==typeof Int8Array?void 0:Int8Array.prototype,"$ %Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"$ %Int16ArrayPrototype%":"undefined"==typeof Int16Array?void 0:Int8Array.prototype,"$ %Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"$ %Int32ArrayPrototype%":"undefined"==typeof Int32Array?void 0:Int32Array.prototype,"$ %isFinite%":isFinite,"$ %isNaN%":isNaN,"$ %IteratorPrototype%":zA?WA(WA([][Symbol.iterator]())):void 0,"$ %JSON%":JSON,"$ %JSONParse%":JSON.parse,"$ %Map%":"undefined"==typeof Map?void 0:Map,"$ %MapIteratorPrototype%":"undefined"!=typeof Map&&zA?WA((new Map)[Symbol.iterator]()):void 0,"$ %MapPrototype%":"undefined"==typeof Map?void 0:Map.prototype,"$ %Math%":Math,"$ %Number%":Number,"$ %NumberPrototype%":Number.prototype,"$ %Object%":Object,"$ %ObjectPrototype%":Object.prototype,"$ %ObjProto_toString%":Object.prototype.toString,"$ %ObjProto_valueOf%":Object.prototype.valueOf,"$ %parseFloat%":parseFloat,"$ %parseInt%":parseInt,"$ %Promise%":"undefined"==typeof Promise?void 0:Promise,"$ %PromisePrototype%":"undefined"==typeof Promise?void 0:Promise.prototype,"$ %PromiseProto_then%":"undefined"==typeof Promise?void 0:Promise.prototype.then,"$ %Promise_all%":"undefined"==typeof Promise?void 0:Promise.all,"$ %Promise_reject%":"undefined"==typeof Promise?void 0:Promise.reject,"$ %Promise_resolve%":"undefined"==typeof Promise?void 0:Promise.resolve,"$ %Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"$ %RangeError%":RangeError,"$ %RangeErrorPrototype%":RangeError.prototype,"$ %ReferenceError%":ReferenceError,"$ %ReferenceErrorPrototype%":ReferenceError.prototype,"$ %Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"$ %RegExp%":RegExp,"$ %RegExpPrototype%":RegExp.prototype,"$ %Set%":"undefined"==typeof Set?void 0:Set,"$ %SetIteratorPrototype%":"undefined"!=typeof Set&&zA?WA((new Set)[Symbol.iterator]()):void 0,"$ %SetPrototype%":"undefined"==typeof Set?void 0:Set.prototype,"$ %SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"$ %SharedArrayBufferPrototype%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer.prototype,"$ %String%":String,"$ %StringIteratorPrototype%":zA?WA(""[Symbol.iterator]()):void 0,"$ %StringPrototype%":String.prototype,"$ %Symbol%":zA?Symbol:void 0,"$ %SymbolPrototype%":zA?Symbol.prototype:void 0,"$ %SyntaxError%":SyntaxError,"$ %SyntaxErrorPrototype%":SyntaxError.prototype,"$ %ThrowTypeError%":BA,"$ %TypedArray%":HA,"$ %TypedArrayPrototype%":HA?HA.prototype:void 0,"$ %TypeError%":TypeError,"$ %TypeErrorPrototype%":TypeError.prototype,"$ %Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"$ %Uint8ArrayPrototype%":"undefined"==typeof Uint8Array?void 0:Uint8Array.prototype,"$ %Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"$ %Uint8ClampedArrayPrototype%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray.prototype,"$ %Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"$ %Uint16ArrayPrototype%":"undefined"==typeof Uint16Array?void 0:Uint16Array.prototype,"$ %Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"$ %Uint32ArrayPrototype%":"undefined"==typeof Uint32Array?void 0:Uint32Array.prototype,"$ %URIError%":URIError,"$ %URIErrorPrototype%":URIError.prototype,"$ %WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"$ %WeakMapPrototype%":"undefined"==typeof WeakMap?void 0:WeakMap.prototype,"$ %WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet,"$ %WeakSetPrototype%":"undefined"==typeof WeakSet?void 0:WeakSet.prototype},$A=function(e,t){if(arguments.length>1&&"boolean"!=typeof t)throw new TypeError('"allowMissing" argument must be a boolean');var r="$ "+e;if(!(r in YA))throw new SyntaxError("intrinsic "+e+" does not exist!");if(void 0===YA[r]&&!t)throw new TypeError("intrinsic "+e+" exists, but is not available. Please file an issue!");return YA[r]},XA=gA.call(Function.call,Object.prototype.hasOwnProperty),JA=$A("%TypeError%"),KA=$A("%SyntaxError%"),QA={"Property Descriptor":function(e,t){if("Object"!==e.Type(t))return!1;var r={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var n in t)if(XA(t,n)&&!r[n])return!1;var i=XA(t,"[[Value]]"),o=XA(t,"[[Get]]")||XA(t,"[[Set]]");if(i&&o)throw new JA("Property Descriptors may not be both accessor and data descriptors");return!0}},ZA=function(e,t,r,n){var i=QA[t];if("function"!=typeof i)throw new KA("unknown record type: "+t);if(!i(e,n))throw new JA(r+" must be a "+t);console.log(i(e,n),n)},eI=Number.isNaN||function(e){return e!=e},tI=Number.isNaN||function(e){return e!=e},rI=Number.isFinite||function(e){return"number"==typeof e&&!tI(e)&&e!==1/0&&e!==-1/0},nI=function(e){return e>=0?1:-1},iI=Function.prototype.toString,oI=/^\s*class\b/,aI=function(e){try{var t=iI.call(e);return oI.test(t)}catch(e){return!1}},sI=Object.prototype.toString,uI="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,cI=function(e){if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;if(uI)return function(e){try{return!aI(e)&&(iI.call(e),!0)}catch(e){return!1}}(e);if(aI(e))return!1;var t=sI.call(e);return"[object Function]"===t||"[object GeneratorFunction]"===t},lI=function(e){return null===e||"function"!=typeof e&&"object"!=typeof e},fI=Object.prototype.toString,dI=function(e){var t;if((t=arguments.length>1?arguments[1]:"[object Date]"===fI.call(e)?String:Number)===String||t===Number){var r,n,i=t===String?["toString","valueOf"]:["valueOf","toString"];for(n=0;n<i.length;++n)if(cI(e[i[n]])&&(r=e[i[n]](),lI(r)))return r;throw new TypeError("No default value")}throw new TypeError("invalid [[DefaultValue]] hint supplied")},pI=$A("%Object%"),hI=$A("%TypeError%"),vI=$A("%String%"),gI={ToPrimitive:function(e){return lI(e)?e:arguments.length>1?dI(e,arguments[1]):dI(e)},ToBoolean:function(e){return!!e},ToNumber:function(e){return+e},ToInteger:function(e){var t=this.ToNumber(e);return eI(t)?0:0!==t&&rI(t)?nI(t)*Math.floor(Math.abs(t)):t},ToInt32:function(e){return this.ToNumber(e)>>0},ToUint32:function(e){return this.ToNumber(e)>>>0},ToUint16:function(e){var t=this.ToNumber(e);return eI(t)||0===t||!rI(t)?0:function(e,t){var r=e%t;return Math.floor(r>=0?r:r+t)}(nI(t)*Math.floor(Math.abs(t)),65536)},ToString:function(e){return vI(e)},ToObject:function(e){return this.CheckObjectCoercible(e),pI(e)},CheckObjectCoercible:function(e,t){if(null==e)throw new hI(t||"Cannot call method on "+e);return e},IsCallable:cI,SameValue:function(e,t){return e===t?0!==e||1/e==1/t:eI(e)&&eI(t)},Type:function(e){return null===e?"Null":void 0===e?"Undefined":"function"==typeof e||"object"==typeof e?"Object":"number"==typeof e?"Number":"boolean"==typeof e?"Boolean":"string"==typeof e?"String":void 0},IsPropertyDescriptor:function(e){if("Object"!==this.Type(e))return!1;var t={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var r in e)if(XA(e,r)&&!t[r])return!1;var n=XA(e,"[[Value]]"),i=XA(e,"[[Get]]")||XA(e,"[[Set]]");if(n&&i)throw new hI("Property Descriptors may not be both accessor and data descriptors");return!0},IsAccessorDescriptor:function(e){return void 0!==e&&(ZA(this,"Property Descriptor","Desc",e),!(!XA(e,"[[Get]]")&&!XA(e,"[[Set]]")))},IsDataDescriptor:function(e){return void 0!==e&&(ZA(this,"Property Descriptor","Desc",e),!(!XA(e,"[[Value]]")&&!XA(e,"[[Writable]]")))},IsGenericDescriptor:function(e){return void 0!==e&&(ZA(this,"Property Descriptor","Desc",e),!this.IsAccessorDescriptor(e)&&!this.IsDataDescriptor(e))},FromPropertyDescriptor:function(e){if(void 0===e)return e;if(ZA(this,"Property Descriptor","Desc",e),this.IsDataDescriptor(e))return{value:e["[[Value]]"],writable:!!e["[[Writable]]"],enumerable:!!e["[[Enumerable]]"],configurable:!!e["[[Configurable]]"]};if(this.IsAccessorDescriptor(e))return{get:e["[[Get]]"],set:e["[[Set]]"],enumerable:!!e["[[Enumerable]]"],configurable:!!e["[[Configurable]]"]};throw new hI("FromPropertyDescriptor must be called with a fully populated Property Descriptor")},ToPropertyDescriptor:function(e){if("Object"!==this.Type(e))throw new hI("ToPropertyDescriptor requires an object");var t={};if(XA(e,"enumerable")&&(t["[[Enumerable]]"]=this.ToBoolean(e.enumerable)),XA(e,"configurable")&&(t["[[Configurable]]"]=this.ToBoolean(e.configurable)),XA(e,"value")&&(t["[[Value]]"]=e.value),XA(e,"writable")&&(t["[[Writable]]"]=this.ToBoolean(e.writable)),XA(e,"get")){var r=e.get;if(void 0!==r&&!this.IsCallable(r))throw new TypeError("getter must be a function");t["[[Get]]"]=r}if(XA(e,"set")){var n=e.set;if(void 0!==n&&!this.IsCallable(n))throw new hI("setter must be a function");t["[[Set]]"]=n}if((XA(t,"[[Get]]")||XA(t,"[[Set]]"))&&(XA(t,"[[Value]]")||XA(t,"[[Writable]]")))throw new hI("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return t}},mI=gA.call(Function.call,String.prototype.replace),yI=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,_I=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/,bI=function(){var e=gI.ToString(gI.CheckObjectCoercible(this));return mI(mI(e,yI,""),_I,"")},EI=function(){return String.prototype.trim&&"​"==="​".trim()?String.prototype.trim:bI},SI=gA.call(Function.call,EI());VA(SI,{getPolyfill:EI,implementation:bI,shim:function(){var e=EI();return VA(String.prototype,{trim:e},{trim:function(){return String.prototype.trim!==e}}),e}});var TI=SI,wI=Object.prototype.toString,OI=Object.prototype.hasOwnProperty,kI=function(e,t,r){if(!cI(t))throw new TypeError("iterator must be a function");var n;arguments.length>=3&&(n=r),"[object Array]"===wI.call(e)?function(e,t,r){for(var n=0,i=e.length;n<i;n++)OI.call(e,n)&&(null==r?t(e[n],n,e):t.call(r,e[n],n,e))}(e,t,n):"string"==typeof e?function(e,t,r){for(var n=0,i=e.length;n<i;n++)null==r?t(e.charAt(n),n,e):t.call(r,e.charAt(n),n,e)}(e,t,n):function(e,t,r){for(var n in e)OI.call(e,n)&&(null==r?t(e[n],n,e):t.call(r,e[n],n,e))}(e,t,n)},RI=function(e){if(!e)return{};var t={};return kI(TI(e).split("\n"),function(e){var r,n=e.indexOf(":"),i=TI(e.slice(0,n)).toLowerCase(),o=TI(e.slice(n+1));void 0===t[i]?t[i]=o:(r=t[i],"[object Array]"===Object.prototype.toString.call(r)?t[i].push(o):t[i]=[t[i],o])}),t},AI=function(){for(var e={},t=0;t<arguments.length;t++){var r=arguments[t];for(var n in r)II.call(r,n)&&(e[n]=r[n])}return e},II=Object.prototype.hasOwnProperty;var PI=r(function(e){var t,r=(t=Cf)&&t.__esModule?t:{default:t};function n(e,t,r){var n=e;return fA(t)?(r=t,"string"==typeof e&&(n={uri:e})):n=AI(t,{uri:e}),n.callback=r,n}function i(e,t,r){return o(t=n(e,t,r))}function o(e){if(void 0===e.callback)throw new Error("callback argument missing");var t=!1,n=function(r,n,i){t||(t=!0,e.callback(r,n,i))};function o(){var e=void 0;if(e=l.response?l.response:l.responseText||function(e){if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;if(""===e.responseType&&!t)return e.responseXML;return null}(l),m)try{e=JSON.parse(e)}catch(e){}return e}function a(e){return clearTimeout(f),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,n(e,y)}function s(){if(!c){var t;clearTimeout(f),t=e.useXDR&&void 0===l.status?200:1223===l.status?204:l.status;var r=y,i=null;return 0!==t?(r={body:o(),statusCode:t,method:p,headers:{},url:d,rawRequest:l},l.getAllResponseHeaders&&(r.headers=RI(l.getAllResponseHeaders()))):i=new Error("Internal XMLHttpRequest Error"),n(i,r,r.body)}}var u,c,l=e.xhr||null;l||(l=e.cors||e.useXDR?new i.XDomainRequest:new i.XMLHttpRequest);var f,d=e.uri||e.url,p=e.method||"GET",h=e.body||e.data,v=e.headers||{},g=!!e.sync,m=!1,y={body:void 0,headers:{},statusCode:0,method:p,url:d,rawRequest:l};if("json"in e&&!1!==e.json&&(m=!0,v.accept||v.Accept||(v.Accept="application/json"),"GET"!==p&&"HEAD"!==p&&(v["content-type"]||v["Content-Type"]||(v["Content-Type"]="application/json"),h=(0,r.default)(!0===e.json?h:e.json))),l.onreadystatechange=function(){4===l.readyState&&setTimeout(s,0)},l.onload=s,l.onerror=a,l.onprogress=function(){},l.onabort=function(){c=!0},l.ontimeout=a,l.open(p,d,!g,e.username,e.password),g||(l.withCredentials=!!e.withCredentials),!g&&e.timeout>0&&(f=setTimeout(function(){if(!c){c=!0,l.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",a(e)}},e.timeout)),l.setRequestHeader)for(u in v)v.hasOwnProperty(u)&&l.setRequestHeader(u,v[u]);else if(e.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(l.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(l),l.send(h||null),l}e.exports=i,i.XMLHttpRequest=lA.XMLHttpRequest||function(){},i.XDomainRequest="withCredentials"in new i.XMLHttpRequest?i.XMLHttpRequest:lA.XDomainRequest,function(e,t){for(var r=0;r<e.length;r+=1)t(e[r])}(["get","put","post","patch","head","delete"],function(e){i["delete"===e?"del":e]=function(t,r,i){return(r=n(t,r,i)).method=e.toUpperCase(),o(r)}})});t(PI);var CI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=d(ob),n=d(cc),i=d(mR),o=d(Xw),a=d(_f),s=d(wR),u=d(vp),c=d(cS);t.default=function(e){return new a.default(function(t){var a=(0,s.default)(e,"method","uri","withCredentials","headers","timeout","responseType");a.response=!0,function(e,t){e.method&&["PATCH","POST","PUT"].includes(e.method.toUpperCase())&&(e.xhr=new XMLHttpRequest,e.xhr.upload.onprogress=t.upload.emit.bind(t.upload,"progress"))}(a,e),function(e,t){if(t.auth)if(t.auth.bearer)e.headers.authorization="Bearer "+t.auth.bearer;else{var r=t.auth.user||t.auth.username,n=t.auth.pass||t.auth.password,i=btoa(r+":"+n);e.headers.authorization="Basic "+i}}(a,e),function(e,t){t.jar&&(e.withCredentials=!0)}(a,e),function(e,t){var r={cors:!0,withCredentials:!1,timeout:0};(0,c.default)(e,(0,s.default)(t,(0,o.default)(r)),r)}(a,e),function(e,t){"buffer"===t.responseType&&(e.responseType="arraybuffer")}(a,e),function(e,t){(t.body instanceof Blob||t.body instanceof ArrayBuffer)&&(t.json=e.json=!1,e.headers["content-type"]=e.headers["content-type"]||(0,zR.detectSync)(t.body))}(a,e),function(e,t){"json"in t&&!0!==t.json||!t.body?t.form?(e.headers["Content-Type"]="application/x-www-form-urlencoded",e.body=l.default.stringify(t.form),(0,n.default)(e,"json")):t.formData?e.body=(0,o.default)(t.formData).reduce(function(e,r){var n=t.formData[r];return function e(t,r,n){if((0,u.default)(n)){var o=!0,a=!1,s=void 0;try{for(var c,l=(0,i.default)(n);!(o=(c=l.next()).done);o=!0){var f=c.value;e(t,r,f)}}catch(e){a=!0,s=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw s}}return}n=function(e){if(e instanceof ArrayBuffer){var t=e.type?new Blob([e],{type:e.type}):new Blob([e]);return t.filename=e.filename||e.name||"untitled",t}return e}(n);n.name?(n.filename=n.name,t.append(r,n,n.name)):t.append(r,n)}(e,r,n),e},new FormData):(e.body=t.body,(0,n.default)(e,"json")):e.json=t.body}(a,e),function(e,t){t.qs&&(e.uri+="?"+l.default.stringify(t.qs))}(a,e);var d=(0,f.default)(a,function(n,i){n&&e.logger.warn(n),i?(i.options=e,function(e,t){if(!t.json&&"object"!==(0,r.default)(e.body))try{e.body=JSON.parse(e.body)}catch(e){}}(i,a),t(i)):t({statusCode:0,options:e,headers:e.headers,method:e.method,url:e.uri,body:n})});d.onprogress=e.download.emit.bind(e.download,"progress")}).catch(function(t){return{statusCode:0,options:e,headers:e.headers,method:e.method,url:e.uri,body:t}})};var l=d(cA),f=d(PI);function d(e){return e&&e.__esModule?e:{default:e}}});t(CI);var MI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(_f);t.default=function(e){e.url&&(e.uri=e.url,e.url=null);e.headers=e.headers||{},Yw.inBrowser||e.headers["user-agent"]||(e.headers["user-agent"]="@ciscospark/http-core");return e.download=new fS.EventEmitter,e.upload=new fS.EventEmitter,t(e.interceptors,"Request").then(function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];return n.default.apply(void 0,[e].concat(r))}).then(function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return t.apply(void 0,[e.interceptors.slice().reverse(),"Response"].concat(n))});function t(t,n,i){var o="on"+n,a="on"+n+"Error";return t.reduce(function(t,n){return t.then(function(t){return n[o]?n[o](e,t):r.default.resolve(t)},function(t){return n[a]?n[a](e,t):r.default.reject(t)})},r.default.resolve(i))}};var n=i(CI);function i(e){return e&&e.__esModule?e:{default:e}}});t(MI);var NI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.detectSync=t.detect=t.HttpStatusInterceptor=t.HttpError=t.Interceptor=t.ProgressEvent=t.request=t.defaults=void 0;var r=f(cc),n=f(kR),i=f(AR),o=f(hO),a=f(cS),s=f(eR),u=f(nO);Object.defineProperty(t,"ProgressEvent",{enumerable:!0,get:function(){return f(NR).default}}),Object.defineProperty(t,"Interceptor",{enumerable:!0,get:function(){return f(DR).default}}),Object.defineProperty(t,"HttpError",{enumerable:!0,get:function(){return f(qR).default}}),Object.defineProperty(t,"HttpStatusInterceptor",{enumerable:!0,get:function(){return f(VR).default}}),Object.defineProperty(t,"detect",{enumerable:!0,get:function(){return zR.detect}}),Object.defineProperty(t,"detectSync",{enumerable:!0,get:function(){return zR.detectSync}});var c=f(VR),l=f(MI);function f(e){return e&&e.__esModule?e:{default:e}}var d=(0,s.default)(function(e,t){if((0,o.default)(t)){var s=t;(t=arguments[2]||{}).uri=s}return["download","interceptors","logger","upload"].forEach(function(e){var r=(0,i.default)(t,e);r=(0,u.default)({},r,{enumerable:!1,writable:!0}),(0,n.default)(t,e,r)}),(0,a.default)(t,e),t.json||(0,r.default)(t,"json"),t.logger=t.logger||console,(0,l.default)(t)}),p={json:!0,interceptors:[c.default.create()]};t.defaults=d,t.request=d(p)});t(NI);NI.detectSync,NI.detect,NI.HttpStatusInterceptor,NI.HttpError,NI.Interceptor,NI.ProgressEvent,NI.request,NI.defaults;var DI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(kR),n=c(Af),i=c(rT),o=c(By),a=c(Yy),s=c(nT),u=c(iT);function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return(0,o.default)(this,t),(0,s.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,a.default)(t,[{key:"parse",value:function(e){var t=(0,n.default)(NI.HttpError.prototype.parse,this,[e]);return(0,r.default)(this,"options",{enumerable:!1,value:e.options}),this.options.url?t+="\n"+this.options.method+" "+this.options.url:this.options.uri?t+="\n"+this.options.method+" "+this.options.uri:t+="\n"+this.options.method+" "+this.options.service.toUpperCase()+"/"+this.options.resource,t+="\nWEBEX_TRACKING_ID: "+this.options.headers.trackingid,this.options.headers&&this.options.headers["x-trans-id"]&&(t+="\nX-Trans-Id: "+this.options.headers["x-trans-id"]),this.headers["retry-after"]&&((0,r.default)(this,"retryAfter",{enumerable:!0,value:this.headers["retry-after"],writeable:!1}),t+="\nRETRY-AFTER: "+this.retryAfter),t+="\n"}}]),t}(NI.HttpError);t.default=l,NI.HttpError.makeSubTypes(l);var f=function(e){function t(){return(0,o.default)(this,t),(0,s.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),t}(NI.HttpError.BadRequest);NI.HttpError[429]=f,NI.HttpError.TooManyRequests=f});t(DI);var jI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=d(ac),i=d(yR),o=d(Af),a=d(wf),s=d(_f),u=d(wR),c=d(DI),l=d(sR),f=d(fR);function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}function h(e){if(400!==e.statusCode)return s.default.reject(e);var t=f.default.select(e.body.error);return t===fR.OAuthError&&e instanceof c.default?s.default.reject(e):t?s.default.reject(new t(e._res||e)):s.default.reject(e)}var v=l.default.extend((p(r={derived:{canAuthorize:{deps:["access_token","isExpired"],fn:function(){return!!this.access_token&&!this.isExpired}},canDownscope:{deps:["canAuthorize"],fn:function(){return this.canAuthorize&&!!this.config.client_id}},canRefresh:{deps:["refresh_token"],fn:function(){return Yw.inBrowser?!!this.refresh_token&&!!this.config.refreshCallback:!!this.refresh_token&&!!this.config.client_secret}},isExpired:{deps:["expires","_isExpired"],fn:function(){return!!this.expires&&this._isExpired}},_string:{deps:["access_token","token_type"],fn:function(){return this.access_token&&this.token_type?this.token_type+" "+this.access_token:""}}},namespace:"Credentials",props:{scope:"string",access_token:"string",expires:"number",expires_in:"number",refresh_token:"string",refresh_token_expires:"number",refresh_token_expires_in:"number",token_type:{default:"Bearer",type:"string"}},session:{_isExpired:{default:!1,type:"boolean"},previousToken:{type:"state"}},downscope:function(e){var t=this;return this.logger.info("token: downscoping token to "+e),this.isExpired?(this.logger.info("token: request received to downscope expired access_token"),s.default.reject(new Error("cannot downscope expired access token"))):this.canDownscope?(e&&(e=(0,dR.sortScope)(e)),e===(0,dR.sortScope)(this.config.scope)?s.default.reject(new Error("token: scope reduction requires a reduced scope")):this.spark.request({method:"POST",uri:this.config.tokenUrl,addAuthHeader:!1,form:{grant_type:"urn:cisco:oauth:grant-type:scope-reduction",token:this.access_token,scope:e,client_id:this.config.client_id}}).then(function(r){return t.logger.info("token: downscoped token to "+e),new v((0,a.default)(r.body,{scope:e}),{parent:t.parent})})):(this.config.client_id?this.logger.info("token: request received to downscope invalid access_token"):this.logger.warn("token: cannot downscope without client_id"),s.default.reject(new Error("cannot downscope access token")))},initialize:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,o.default)(l.default.prototype.initialize,this,[t,r]),"string"==typeof t&&(this.access_token=t),!this.access_token)throw new Error("`access_token` is required");this.expires&&(this.expires<Date.now()?this._isExpired=!0:(0,Qw.safeSetTimeout)(function(){e._isExpired=!0},this.expires-Date.now()))},refresh:function(){var e=this;if(!this.canRefresh)throw new Error("Not enough information available to refresh this access token");var t=void 0;if(Yw.inBrowser){if(!this.config.refreshCallback)throw new Error("Cannot refresh access token without refreshCallback");t=s.default.resolve(this.config.refreshCallback(this.spark,this))}return(t||this.spark.request({method:"POST",uri:this.config.tokenUrl,form:{grant_type:"refresh_token",redirect_uri:this.config.redirect_uri,refresh_token:this.refresh_token},auth:{user:this.config.client_id,pass:this.config.client_secret,sendImmediately:!0},shouldRefreshAccessToken:!1}).then(function(e){return e.body})).then(function(t){if(!t)throw new Error("token: refreshCallback() did not produce an object");return t.refresh_token||(0,a.default)(t,(0,u.default)(e,"refresh_token","refresh_token_expires","refresh_token_expires_in")),e.access_token===t.access_token?(e.logger.error("token: new token matches current token"),e.logger.error("token: current token:",e.access_token),e.logger.error("token: new token:",t.access_token),s.default.reject(new Error("new token matches current token"))):(e.previousToken&&(e.previousToken.revoke(),e.unset("previousToken")),t.previousToken=e,t.scope=e.scope,new v(t,{parent:e.parent}))}).catch(h)},revoke:function(){var e=this;return this.isExpired?(this.logger.info("token: already expired, not making making revocation request"),s.default.resolve()):this.canAuthorize?this.config.client_secret?(this.logger.info("token: revoking access token"),this.spark.request({method:"POST",uri:this.config.revokeUrl,form:{token:this.access_token,token_type_hint:"access_token"},auth:{user:this.config.client_id,pass:this.config.client_secret,sendImmediately:!0},shouldRefreshAccessToken:!1}).then(function(){e.unset(["access_token","expires","expires_in","token_type"]),e.logger.info("token: access token revoked")}).catch(h)):(this.logger.info("token: no client secret available, not making revocation request"),s.default.resolve()):(this.logger.info("token: no longer valid, not making revocation request"),s.default.resolve())},set:function(){var e=this._filterSetParameters.apply(this,arguments),t=(0,i.default)(e,2),r=t[0],n=t[1];if(!r.token_type&&r.access_token&&r.access_token.includes(" ")){var s=r.access_token.split(" "),u=(0,i.default)(s,2),c=u[0],f=u[1];r=(0,a.default)({},r,{access_token:f,token_type:c})}var d=Date.now();return!r.expires&&r.expires_in&&(r.expires=d+1e3*r.expires_in),!r.refresh_token_expires&&r.refresh_token_expires_in&&(r.refresh_token_expires=d+1e3*r.refresh_token_expires_in),r.scope&&(r.scope=(0,dR.sortScope)(r.scope)),(0,o.default)(l.default.prototype.set,this,[r,n])},toString:function(){if(!this._string)throw new Error("cannot stringify Token");return this._string},validate:function(){var e=this;return this.spark.request({method:"POST",service:"conversation",resource:"users/validateAuthToken",body:{token:this.access_token}}).catch(function(t){if("statusCode"in t)return s.default.reject(t);e.logger.info("REMINDER: If you're investigating a network error here, it's normal");return e.spark.request({method:"POST",uri:"https://conv-a.wbx2.com/conversation/api/v1/users/validateAuthToken",body:{token:e.access_token},headers:{authorization:"Bearer "+e.access_token}})}).then(function(e){return e.body})},version:"1.50.6"},"downscope",[(0,Yw.oneFlight)({keyFactory:function(e){return e}})],(0,n.default)(r,"downscope"),r),p(r,"refresh",[Yw.oneFlight],(0,n.default)(r,"refresh"),r),p(r,"revoke",[Yw.oneFlight],(0,n.default)(r,"revoke"),r),r));t.default=v});t(jI);var xI=function(e){var t,r=this,n=[].slice.call(arguments);t=e&&e.hasOwnProperty("constructor")?e.constructor:function(){return r.apply(this,arguments)},nO(t,r);var i=function(){this.constructor=t};return i.prototype=r.prototype,t.prototype=new i,e&&(n.unshift(t.prototype),nO.apply(null,n)),t.__super__=r.prototype,t},LI=vb(function(e,t,r){var n=1;if(r.length){var i=pE(r,cE(LI));n|=32}return QE(e,n,t,r,i)});LI.placeholder={};var UI=LI,FI=[].slice;function GI(e,t){if(t||(t={}),t.model&&(this.model=t.model),t.comparator&&(this.comparator=t.comparator),t.parent&&(this.parent=t.parent),!this.mainIndex){var r=this.model&&this.model.prototype&&this.model.prototype.idAttribute;this.mainIndex=r||"id"}this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,nO({silent:!0},t))}nO(GI.prototype,Ck,{initialize:function(){},isModel:function(e){return this.model&&e instanceof this.model},add:function(e,t){return this.set(e,nO({merge:!1,add:!0,remove:!1},t))},parse:function(e,t){return e},serialize:function(){return this.map(function(e){if(e.serialize)return e.serialize();var t={};return nO(t,e),delete t.collection,t})},toJSON:function(){return this.serialize()},set:function(e,t){(t=nO({add:!0,remove:!0,merge:!0},t)).parse&&(e=this.parse(e,t));var r,n,i,o,a,s,u,c=!vp(e);e=c?e?[e]:[]:e.slice();var l=t.at,f=this.comparator&&null==l&&!1!==t.sort,d="string"==typeof this.comparator?this.comparator:null,p=[],h=[],v={},g=t.add,m=t.merge,y=t.remove,_=!(f||!g||!y)&&[],b=this.model&&this.model.prototype||Object.prototype;for(s=0,u=e.length;s<u;s++){if(i=e[s]||{},this.isModel(i)?r=n=i:b.generateId?r=b.generateId(i):void 0===(r=i[this.mainIndex])&&this._isDerivedIndex(b)&&(r=b._derived[this.mainIndex].fn.call(i)),o=this.get(r))y&&(v[o.cid||o[this.mainIndex]]=!0),m&&(i=i===n?n.attributes:i,t.parse&&(i=o.parse(i,t)),o.set?(o.set(i,t),f&&!a&&o.hasChanged(d)&&(a=!0)):nO(o,i)),e[s]=o;else if(g){if(!(n=e[s]=this._prepareModel(i,t)))continue;p.push(n),this._addReference(n,t)}(n=o||n)&&(_&&(n.isNew&&n.isNew()||!n[this.mainIndex]||!v[n.cid||n[this.mainIndex]])&&_.push(n),v[n[this.mainIndex]]=!0)}if(y){for(s=0,u=this.length;s<u;s++)v[(n=this.models[s]).cid||n[this.mainIndex]]||h.push(n);for(h.length&&this.remove(h,t),s=0,u=p.length;s<u;s++)this._index(p[s])}if(p.length||_&&_.length)if(f&&(a=!0),null!=l)for(s=0,u=p.length;s<u;s++)this.models.splice(l+s,0,p[s]);else{var E=_||p;for(s=0,u=E.length;s<u;s++)this.models.push(E[s])}if(a&&this.sort({silent:!0}),!t.silent){for(s=0,u=p.length;s<u;s++)(n=p[s]).trigger?n.trigger("add",n,this,t):this.trigger("add",n,this,t);(a||_&&_.length)&&this.trigger("sort",this,t)}return c?e[0]:e},get:function(e,t){if(null!=e){var r=this.mainIndex,n=this._indexes[t||r];return n&&(n[e]||void 0!==e[r]&&n[e[r]])||this._indexes.cid[e]||this._indexes.cid[e.cid]}},at:function(e){return this.models[e]},remove:function(e,t){var r,n,i,o,a=!vp(e);for(t||(t={}),r=0,n=(e=a?[e]:FI.call(e)).length;r<n;r++)(i=e[r]=this.get(e[r]))&&(this._deIndex(i),o=this.models.indexOf(i),this.models.splice(o,1),t.silent||(t.index=o,i.trigger?i.trigger("remove",i,this,t):this.trigger("remove",i,this,t)),this._removeReference(i,t));return a?e[0]:e},reset:function(e,t){t||(t={});for(var r=0,n=this.models.length;r<n;r++)this._removeReference(this.models[r],t);return t.previousModels=this.models,this._reset(),e=this.add(e,nO({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},sort:function(e){var t=this;if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),"string"==typeof this.comparator?this.models.sort(function(e,r){return e.get?(e=e.get(t.comparator),r=r.get(t.comparator)):(e=e[t.comparator],r=r[t.comparator]),e>r||void 0===e?1:e<r||void 0===r?-1:0}):1===this.comparator.length?this.models.sort(function(e,r){return(e=t.comparator(e))>(r=t.comparator(r))||void 0===e?1:e<r||void 0===r?-1:0}):this.models.sort(UI(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},_reset:function(){var e=FI.call(this.indexes||[]),t=0;e.push(this.mainIndex),e.push("cid");var r=e.length;for(this.models=[],this._indexes={};t<r;t++)this._indexes[e[t]]={}},_prepareModel:function(e,t){if(!this.model)return e;if(this.isModel(e))return e.collection||(e.collection=this),e;(t=t?nO({},t):{}).collection=this;var r=new this.model(e,t);return r.validationError?(this.trigger("invalid",this,r.validationError,t),!1):r},_deIndex:function(e,t,r){var n;if(void 0===t)for(var i in this._indexes)n=e.hasOwnProperty(i)?e[i]:e.get&&e.get(i),delete this._indexes[i][n];else{if(void 0===this._indexes[t])throw new Error("Given attribute is not an index");delete this._indexes[t][r]}},_index:function(e,t){var r;if(void 0===t)for(var n in this._indexes)null!=(r=e.hasOwnProperty(n)?e[n]:e.get&&e.get(n))&&(this._indexes[n][r]=e);else{if(void 0===this._indexes[t])throw new Error("Given attribute is not an index");(r=e[t]||e.get&&e.get(t))&&(this._indexes[t][r]=e)}},_isDerivedIndex:function(e){return!(!e||"object"!=typeof e._derived)&&Object.keys(e._derived).indexOf(this.mainIndex)>=0},_addReference:function(e,t){this._index(e),e.collection||(e.collection=this),e.on&&e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){this===e.collection&&delete e.collection,this._deIndex(e),e.off&&e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,r,n){var i=e.split(":")[0],o=e.split(":")[1];("add"!==i&&"remove"!==i||r===this)&&("destroy"===i&&this.remove(t,n),t&&"change"===i&&o&&this._indexes[o]&&(this._deIndex(t,o,t.previousAttributes()[o]),this._index(t,o)),this.trigger.apply(this,arguments))}}),Object.defineProperties(GI.prototype,{length:{get:function(){return this.models.length}},isCollection:{get:function(){return!0}}});["indexOf","lastIndexOf","every","some","forEach","map","filter","reduce","reduceRight"].forEach(function(e){GI.prototype[e]=function(){return this.models[e].apply(this.models,arguments)}}),GI.prototype.each=GI.prototype.forEach,GI.extend=xI;var qI=GI,VI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(qI),n=i(jI);function i(e){return e&&e.__esModule?e:{default:e}}var o=r.default.extend({mainIndex:"scope",model:n.default,namespace:"Credentials"});t.default=o});t(VI);var BI=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n,i,o,a,s,u,c=k(ac),l=k(_f),f=k(Af),d=k(Xw),p=k(wf),h=k(Cf),v=k(cc),g=k(pg),m=k(ud),y=k(gg),_=k(Kw),b=k(wg),E=k(yy),S=k(sR),T=k(fR),w=k(jI),O=k(VI);function k(e){return e&&e.__esModule?e:{default:e}}function R(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var A=S.default.extend((r=(0,Yw.oneFlight)({keyFactory:function(e){return e}}),n=(0,rR.waitForValue)("@"),i=(0,rR.persist)("@"),o=(0,rR.waitForValue)("@"),a=(0,Yw.whileInFlight)("isRefreshing"),s=(0,rR.waitForValue)("@"),R(u={collections:{userTokens:O.default},dataTypes:{token:(0,Yw.makeStateDataType)(w.default,"token").dataType},derived:{canAuthorize:{deps:["supertoken","supertoken.canAuthorize","canRefresh"],fn:function(){return Boolean(this.supertoken&&this.supertoken.canAuthorize||this.canRefresh)}},canRefresh:{deps:["supertoken","supertoken.canRefresh"],fn:function(){return!!this.config.jwtRefreshCallback||Boolean(this.supertoken&&this.supertoken.canRefresh)}}},props:{supertoken:(0,Yw.makeStateDataType)(w.default,"token").prop},namespace:"Credentials",session:{isRefreshing:{default:!1,type:"boolean"},ready:{default:!1,type:"boolean"},refreshTimer:{default:void 0,type:"any"}},buildLoginUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clientType:"public"};if(e.state&&!(0,m.default)(e.state))throw new Error("if specified, `options.state` must be an object");return e.client_id=this.config.client_id,e.redirect_uri=this.config.redirect_uri,e.scope=this.config.scope,(e=(0,y.default)(e)).response_type||(e.response_type="public"===e.clientType?"token":"code"),(0,v.default)(e,"clientType"),e.state&&((0,g.default)(e.state)?delete e.state:e.state=Yw.base64.toBase64Url((0,h.default)(e.state))),this.config.authorizeUrl+"?"+b.default.stringify(e)},buildLogoutUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.config.logoutUrl+"?"+b.default.stringify((0,p.default)({cisService:this.config.service,goto:this.config.redirect_uri},e))},calcRefreshTimeout:function(e){return Math.floor((Math.floor(4*Math.random())+6)/10*e)},constructor:function(){var e=this;this._dataTypes=(0,y.default)(this._dataTypes),(0,d.default)(this._dataTypes).forEach(function(t){e._dataTypes[t].set&&(e._dataTypes[t].set=e._dataTypes[t].set.bind(e))});for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];(0,f.default)(S.default,this,r)},downscope:function(e){var t=this;return this.supertoken.downscope(e).catch(function(r){return t.logger.error("credentials: failed to downscope supertoken to "+e,r),t.logger.error("credentials: falling back to supertoken for "+e),l.default.resolve(new w.default((0,p.default)({scope:e},t.supertoken.serialize())),{parent:t})})},getClientToken:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.logger.info("credentials: requesting client credentials grant"),(t=t||{}).scope=t.scope||"webexsquare:admin",this.spark.request({method:"POST",uri:this.config.tokenUrl,form:{grant_type:"client_credentials",scope:t.scope,self_contained_token:!0},auth:{user:this.config.client_id,pass:this.config.client_secret,sendImmediately:!0},shouldRefreshAccessToken:!1}).then(function(t){return new w.default(t.body,{parent:e})}).catch(function(e){if(400!==e.statusCode)return l.default.reject(e);var t=T.default.select(e.body.error);return l.default.reject(new t(e._res||e))})},getUserToken:function(e){var t=this;return l.default.resolve(!this.isRefreshing||new l.default(function(e){t.logger.info("credentials: token refresh inflight; delaying getUserToken until refresh completes"),t.once("change:isRefreshing",function(){t.logger.info("credentials: token refresh complete; reinvoking getUserToken"),e()})})).then(function(){if(!t.canAuthorize)return t.logger.info("credentials: cannot produce an access token from current state"),l.default.reject(new Error("Current state cannot produce an access token"));if(e||(e=(0,dR.filterScope)("spark:kms",t.config.scope)),(e=(0,dR.sortScope)(e))===(0,dR.sortScope)(t.config.scope))return l.default.resolve(t.supertoken);var r=t.userTokens.get(e);return r&&r.access_token?l.default.resolve(r):t.downscope(e).then((0,Yw.tap)(function(e){return t.userTokens.add(e)}))})},initialize:function(e,t){var r=this;e&&("string"==typeof e&&(this.supertoken=e),e.access_token&&(this.supertoken=e),e.authorization&&(e.authorization.supertoken?this.supertoken=e.authorization.supertoken:this.supertoken=e.authorization),this.supertoken&&this.supertoken.expires&&this.scheduleRefresh(this.supertoken.expires)),(0,f.default)(S.default.prototype.initialize,this,[e,t]),this.listenToOnce(this.parent,"change:config",function(){if(r.config.authorizationString){var e=E.default.parse(r.config.authorizationString,!0);r.config.client_id=e.query.client_id,r.config.redirect_uri=e.query.redirect_uri,r.config.scope=e.query.scope,r.config.authorizeUrl=e.href.substr(0,e.href.indexOf("?"))}}),this.spark.once("loaded",function(){r.ready=!0})},invalidate:function(){this.logger.info("credentials: invalidating tokens"),this.refreshTimer&&(clearTimeout(this.refreshTimer),this.unset("refreshTimer"));try{this.unset("supertoken")}catch(e){this.logger.warn("credentials: failed to clear supertoken",e)}for(;this.userTokens.models.length;)try{this.userTokens.remove(this.userTokens.models[0])}catch(e){this.logger.warn("credentials: failed to remove user token",e)}return this.logger.info("credentials: finished removing tokens"),l.default.resolve()},refresh:function(){var e=this;this.logger.info("credentials: refresh requested");var t=this.supertoken,r=(0,_.default)(this.userTokens.models);return this.config.jwtRefreshCallback?this.config.jwtRefreshCallback(this.spark).then(function(t){return e.spark.authorization.requestAccessTokenFromJwt({jwt:t})}):t.refresh().then(function(t){return e.refreshTimer&&(clearTimeout(e.refreshTimer),e.unset("refreshTimer")),e.supertoken=t,l.default.all(r.map(function(t){return e.downscope(t.scope).then(function(r){return e.logger.info("credentials: revoking token for "+t.scope),t.revoke().catch(function(t){e.logger.warn("credentials: failed to revoke user token",t)}).then(function(){e.userTokens.remove(t.scope),e.userTokens.add(r)})})}))}).then(function(){e.scheduleRefresh(e.supertoken.expires)}).catch(function(t){if(t instanceof T.default.InvalidRequestError){for(e.unset("supertoken");e.userTokens.models.length;)try{e.userTokens.remove(e.userTokens.models[0])}catch(t){e.logger.warn("credentials: failed to remove user token",t)}e.spark.trigger("client:InvalidRequestError")}return l.default.reject(t)})},scheduleRefresh:function(e){var t=this,r=e-Date.now();if(r>0){var n=this.calcRefreshTimeout(r);this.refreshTimer=(0,Qw.safeSetTimeout)(function(){return t.refresh()},n)}else this.refresh()},version:"1.50.6"},"getUserToken",[r,n],(0,c.default)(u,"getUserToken"),u),R(u,"initialize",[i],(0,c.default)(u,"initialize"),u),R(u,"invalidate",[Yw.oneFlight,o],(0,c.default)(u,"invalidate"),u),R(u,"refresh",[Yw.oneFlight,a,s],(0,c.default)(u,"refresh"),u),u));t.default=A});t(BI);var zI=function(e,t){return null==e||Uv(e,t)};var WI=function(e,t,r){return null==e?e:_R(e,t,r)};var HI=function(e,t,r){(void 0===r||Df(e[t],r))&&(void 0!==r||t in e)||np(e,t,r)};var YI=function(e,t){if("__proto__"!=t)return e[t]};var $I=function(e){return ap(e,Bp(e))};var XI=function(e,t,r,n,i,o,a){var s=YI(e,r),u=YI(t,r),c=a.get(u);if(c)HI(e,r,c);else{var l=o?o(s,u,r+"",e,t,a):void 0,f=void 0===l;if(f){var d=vp(u),p=!d&&mp(u),h=!d&&!p&&Ap(u);l=u,d||p||h?vp(s)?l=s:mk(s)?l=Hp(s):p?(f=!1,l=Wp(u,!0)):h?(f=!1,l=Rh(u,!0)):l=[]:Wv(u)||hp(u)?(l=s,hp(s)?l=$I(s):ud(s)&&!hd(s)||(l=Jh(u))):f=!1}f&&(a.set(u,l),i(l,u,n,o,a),a.delete(u)),HI(e,r,l)}};var JI=function e(t,r,n,i,o){t!==r&&lO(r,function(a,s){if(ud(a))o||(o=new ep),XI(t,r,s,n,e,i,o);else{var u=i?i(YI(t,s),a,s+"",t,r,o):void 0;void 0===u&&(u=a),HI(t,s,u)}},Bp)},KI=tO(function(e,t,r){JI(e,t,r)});for(var QI=function(e,t,r){var n=null==e?void 0:jv(e,t);return void 0===n?r:n},ZI=r(function(e){var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var r=new Uint8Array(16);e.exports=function(){return t(r),r}}else{var n=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n}}}),eP=[],tP=0;tP<256;++tP)eP[tP]=(tP+256).toString(16).substr(1);var rP,nP,iP=function(e,t){var r=t||0,n=eP;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join("")},oP=0,aP=0;var sP=function(e,t,r){var n=t&&r||0,i=t||[],o=(e=e||{}).node||rP,a=void 0!==e.clockseq?e.clockseq:nP;if(null==o||null==a){var s=ZI();null==o&&(o=rP=[1|s[0],s[1],s[2],s[3],s[4],s[5]]),null==a&&(a=nP=16383&(s[6]<<8|s[7]))}var u=void 0!==e.msecs?e.msecs:(new Date).getTime(),c=void 0!==e.nsecs?e.nsecs:aP+1,l=u-oP+(c-aP)/1e4;if(l<0&&void 0===e.clockseq&&(a=a+1&16383),(l<0||u>oP)&&void 0===e.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");oP=u,aP=c,nP=a;var f=(1e4*(268435455&(u+=122192928e5))+c)%4294967296;i[n++]=f>>>24&255,i[n++]=f>>>16&255,i[n++]=f>>>8&255,i[n++]=255&f;var d=u/4294967296*1e4&268435455;i[n++]=d>>>8&255,i[n++]=255&d,i[n++]=d>>>24&15|16,i[n++]=d>>>16&255,i[n++]=a>>>8|128,i[n++]=255&a;for(var p=0;p<6;++p)i[n+p]=o[p];return t||iP(i)};var uP=function(e,t,r){var n=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||ZI)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var o=0;o<16;++o)t[n+o]=i[o];return t||iP(i)},cP=uP;cP.v1=sP,cP.v4=uP;var lP=cP,fP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(_f),n=c(cc),i=c(rT),o=c(By),a=c(Yy),s=c(nT),u=c(iT);function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return(0,o.default)(this,t),(0,s.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,a.default)(t,[{key:"onRequest",value:function(e){var t=this;return e.headers=e.headers||{},"authorization"in e.headers||"auth"in e?(e.headers.authorization||(0,n.default)(e.headers,"authorization"),r.default.resolve(e)):this.requiresCredentials(e).then(function(r){return r?t.spark.credentials.getUserToken().then(function(t){return e.headers.authorization=t.toString(),e}):e})}},{key:"requiresCredentials",value:function(e){var t=this;return e.uri&&(e.uri.includes(this.spark.config.device.preDiscoveryServices.hydra)||e.uri.includes(this.spark.config.device.preDiscoveryServices.hydraServiceUrl))?r.default.resolve(!0):this.spark.internal.device?this.spark.internal.device.isSpecificService("hydra",e.uri).then(function(n){return!!n||(e.service?t.spark.internal.device.isService(e.service):!!e.uri&&t.spark.internal.device.isServiceUrl(e.uri).then(function(n){if(n)return!0;if((void 0===e.addAuthHeader&&t.spark.config.device.validateDomains&&(e.addAuthHeader=!0),e.addAuthHeader)&&t.spark.config.device.whitelistedServiceDomains.filter(function(t){return e.uri.includes(t)}).length)return r.default.resolve(!0);return!1}))}):r.default.resolve(!1)}},{key:"onResponseError",value:function(e,t){var i=this;return this.shouldAttemptReauth(t,e).then(function(o){return o&&(i.spark.logger.info("auth: received 401, attempting to reauthenticate"),t.options.headers&&(0,n.default)(t.options.headers,"authorization"),i.spark.credentials.canRefresh)?i.spark.credentials.refresh().then(function(){return i.replay(e)}):r.default.reject(t)})}},{key:"replay",value:function(e){return e.replayCount?e.replayCount+=1:e.replayCount=1,e.replayCount>this.spark.config.maxAuthenticationReplays?(this.spark.logger.error("auth: failed after "+this.spark.config.maxAuthenticationReplays+" replay attempts"),r.default.reject(new Error("Failed after "+this.spark.config.maxAuthenticationReplays+" replay attempts"))):(this.spark.logger.info("auth: replaying request "+e.replayCount+" time"),this.spark.request(e))}},{key:"shouldAttemptReauth",value:function(e,t){return t&&!1===t.shouldRefreshAccessToken?r.default.resolve(!1):401===e.statusCode?r.default.resolve(!0):r.default.resolve(!1)}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(NI.Interceptor);t.default=l});t(fP);var dP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(_f),n=u(rT),i=u(By),o=u(Yy),a=u(nT),s=u(iT);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"onRequest",value:function(e){return e.$timings=e.$timings||{},e.$timings.networkStart=Date.now(),e}},{key:"onResponse",value:function(e,t){return e.$timings.networkEnd=Date.now(),t}},{key:"onResponseError",value:function(e,t){return e.$timings.networkEnd=Date.now(),r.default.reject(t)}}],[{key:"create",value:function(e){return new t(this,e)}}]),t}(NI.Interceptor);t.default=c});t(dP);var pP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(_f),n=u(rT),i=u(By),o=u(Yy),a=u(nT),s=u(iT);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"onRequest",value:function(e){return e.noTransform?e:this.spark.transform("outbound",e)}},{key:"onResponse",value:function(e,t){return this.spark.transform("inbound",t)}},{key:"onResponseError",value:function(e,t){return this.spark.transform("inbound",t).then(function(e){return r.default.reject(e||t)})}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(NI.Interceptor);t.default=c});t(pP);var hP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(_f),n=l(cc),i=l(rT),o=l(By),a=l(Yy),s=l(nT),u=l(iT),c=l(Kw);function l(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){return(0,o.default)(this,t),(0,s.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,a.default)(t,[{key:"onRequest",value:function(e){return e.uri.includes(this.spark.config.credentials.samlUrl)||e.uri.includes(this.spark.config.credentials.tokenUrl)||e.uri.includes(this.spark.config.credentials.authorizeUrl)?e:"cisco-no-http-redirect"in e.headers?(e.headers["cisco-no-http-redirect"]||(0,n.default)(e.headers,"cisco-no-http-redirect"),e):(e.headers["cisco-no-http-redirect"]=!0,e.$redirectCount=e.$redirectCount||0,e)}},{key:"onResponse",value:function(e,t){if(t.headers&&t.headers["cisco-location"])return(e=(0,c.default)(e)).uri=t.headers["cisco-location"],e.$redirectCount+=1,e.$redirectCount>this.spark.config.maxAppLevelRedirects?r.default.reject(new Error("Maximum redirects exceeded")):this.spark.request(e);if(t.headers&&t.body&&2000002===t.body.errorCode&&t.body.location){if(e=(0,c.default)(e),t.options&&t.options.qs){var n=t.body.location.split("?");e.uri=n[0]}else e.uri=t.body.location;return e.$redirectCount+=1,e.$redirectCount>this.spark.config.maxLocusRedirects?r.default.reject(new Error("Maximum redirects exceeded")):this.spark.request(e)}return t}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(NI.Interceptor);t.default=f});t(hP);var vP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(_f),n=c(rT),i=c(By),o=c(Yy),a=c(nT),s=c(iT),u=c(QI);function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"onRequest",value:function(e){var t=(0,u.default)(this,"spark.logger",console);try{this.spark.trigger("request:start",e)}catch(e){t.warn("event handler for request:start failed ",e)}return r.default.resolve(e)}},{key:"onRequestError",value:function(e,t){var n=(0,u.default)(this,"spark.logger",console);try{this.spark.trigger("request:end",e,t),this.spark.trigger("request:failure",e,t)}catch(e){n.warn("event handler for request:end failed ",e)}return r.default.reject(t)}},{key:"onResponse",value:function(e,t){var n=(0,u.default)(this,"spark.logger",console);try{this.spark.trigger("request:success",t.options,t)}catch(e){n.warn("event handler for request:success failed ",e)}return r.default.resolve(t)}},{key:"onResponseError",value:function(e,t){var n=(0,u.default)(this,"spark.logger",console);try{this.spark.trigger("request:end",e,t),this.spark.trigger("request:failure",e,t)}catch(e){n.warn("event handler for request:failure failed ",e)}return r.default.reject(t)}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(NI.Interceptor);t.default=l});t(vP);var gP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(_f),n=l(rT),i=l(By),o=l(Yy),a=l(nT),s=l(iT),u=(l(cg),l(hO),l(vp),l(fk)),c=l(QI);l(my);function l(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"onRequest",value:function(e){var t=(0,c.default)(this,"spark.logger",console);return t.info("/**********************************************************************\\ "),t.info("Request:",e.method||"GET",e.uri),t.info("WEBEX_TRACKINGID: ",(0,c.default)(e,"headers.trackingid")),(0,u.default)(e,"headers.x-trans-id")&&t.info("X-Trans-ID: ",(0,c.default)(e,"headers.x-trans-id")),(0,u.default)(this,"spark.internal.device.userId")&&t.info("User ID:",(0,c.default)(this,"spark.internal.device.userId")),r.default.resolve(e)}},{key:"onRequestError",value:function(e,t){this.onRequest(e);var n=(0,c.default)(this,"spark.logger",console);return n.error("Request Failed: ",t.stack),n.info("\\**********************************************************************/"),r.default.reject(t)}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(NI.Interceptor);t.default=f});t(gP);var mP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(_f),n=u(rT),i=u(By),o=u(Yy),a=u(nT),s=u(iT);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"onRequest",value:function(e){return e.$timings=e.$timings||{},e.$timings.requestStart=Date.now(),e}},{key:"onRequestError",value:function(e){return e.$timings.requestEnd=e.$timings.requestFail=Date.now(),r.default.reject(e)}},{key:"onResponse",value:function(e,t){return e.$timings.requestEnd=Date.now(),r.default.resolve(t)}},{key:"onResponseError",value:function(e,t){return e.$timings.requestEnd=e.$timings.requestFail=Date.now(),r.default.reject(t)}}],[{key:"create",value:function(e){return new t(this,e)}}]),t}(NI.Interceptor);t.default=c});t(mP);var yP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(_f),n=(c(ob),c(rT)),i=c(By),o=c(Yy),a=c(nT),s=c(iT),u=(c(cg),c(QI));c(my);function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"onResponse",value:function(e,t){return this.printResponseHeader(e,t),(0,u.default)(this,"spark.logger",console).info("\\**********************************************************************/"),t}},{key:"onResponseError",value:function(e,t){return this.printResponseHeader(e,t),(0,u.default)(this,"spark.logger",console).info("\\**********************************************************************/"),r.default.reject(t)}},{key:"printResponseHeader",value:function(e,t){var r=(0,u.default)(this,"spark.logger",console);r.info("Status Code:",t.statusCode),r.info("WEBEX_TRACKINGID:",(0,u.default)(e,"headers.trackingid")||(0,u.default)(t,"headers.trackingid")),r.info("Network duration:",e.$timings.networkEnd-e.$timings.networkStart),r.info("Processing duration:",e.$timings.requestEnd-e.$timings.requestStart)}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(NI.Interceptor);t.default=l});t(yP);var _P=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(cc),n=u(rT),i=u(By),o=u(Yy),a=u(nT),s=u(iT);function u(e){return e&&e.__esModule?e:{default:e}}var c=new(u(h_).default),l=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"onRequest",value:function(e){if(e.headers=e.headers||{},"trackingid"in e.headers)return e.headers.trackingid||(0,r.default)(e.headers,"trackingid"),e;if(this.requiresTrackingId(e)&&(e.headers.trackingid=this.spark.sessionId+"_"+this.sequence),e.headers.trackingid&&e.replayCount){var t=e.headers.trackingid.split("+");t[1]=e.replayCount,e.headers.trackingid=t.join("+")}return e}},{key:"requiresTrackingId",value:function(e){return!e.headers.trackingid}},{key:"sequence",get:function(){var e=c.get(this)||0;return e+=1,c.set(this,e),e}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(NI.Interceptor);t.default=l});t(_P);var bP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(cc),n=l(rT),i=l(By),o=l(Yy),a=l(nT),s=l(iT),u=l(h_),c=l(QI);function l(e){return e&&e.__esModule?e:{default:e}}var f=new u.default,d=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.default)(this,t);var r=(0,c.default)(e,"spark.config.appName"),o=(0,c.default)(e,"spark.config.appVersion"),s=(0,c.default)(e,"spark.ciscospark",!1)?"ciscospark":"spark-js-sdk",u=(0,c.default)(e,"spark.version","development"),l=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return r&&o?f.set(l,r+"/"+o+" ("+(Yw.inBrowser?"web":"node")+") "+s+"/"+u):f.set(l,s+"/"+u+" ("+(Yw.inBrowser?"web":"node")+")"),l}return(0,s.default)(t,e),(0,o.default)(t,[{key:"onRequest",value:function(e){return e.headers=e.headers||{},e.uri&&(e.uri.includes(this.spark.config.credentials.samlUrl)||e.uri.includes(this.spark.config.credentials.tokenUrl)||e.uri.includes(this.spark.config.credentials.authorizeUrl))?e:"spark-user-agent"in e.headers?(e.headers["spark-user-agent"]||(0,r.default)(e.headers,"spark-user-agent"),e):(e.headers["spark-user-agent"]=f.get(this),e)}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(NI.Interceptor);t.default=d});t(bP);var EP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(_f),n=c(pb),i=c(rT),o=c(By),a=c(nT),s=c(Yy),u=c(iT);function c(e){return e&&e.__esModule?e:{default:e}}var l=new(c(h_).default),f=/.*(idbroker|identity)(bts)?.webex.com\/([^\/]+)/,d=function(e){function t(){var e;(0,o.default)(this,t);for(var r=arguments.length,s=Array(r),u=0;u<r;u++)s[u]=arguments[u];var c=(0,a.default)(this,(e=t.__proto__||(0,i.default)(t)).call.apply(e,[this].concat(s)));return l.set(c,new n.default),c}return(0,u.default)(t,e),(0,s.default)(t,null,[{key:"create",value:function(){return new t({spark:this})}}]),(0,s.default)(t,[{key:"onRequest",value:function(e){return this.isRateLimited(e.uri)?r.default.reject(new Error("API rate limited "+e.uri)):r.default.resolve(e)}},{key:"onResponseError",value:function(e,t){return 429===t.statusCode&&(e.uri.includes("idbroker")||e.uri.includes("identity"))&&this.setRateLimitExpiry(e.uri,this.extractRetryAfterTime(e)),r.default.reject(t)}},{key:"extractRetryAfterTime",value:function(e){var t=e.headers["retry-after"]||null;return null===t||t<=0?6e4:t>3600?36e5:1e3*t}},{key:"setRateLimitExpiry",value:function(e,t){var r=this.getApiName(e);if(!r)return!1;var n=(new Date).getTime()+t;return l.get(this).set(r,n)}},{key:"getRateLimitStatus",value:function(e){var t=this.getApiName(e);if(!t)return!1;var r=(new Date).getTime(),n=l.get(this);return void 0!==n.get(t)&&r<n.get(t)}},{key:"getApiName",value:function(e){if(!e)return null;var t=e.match(f);return t?t[2]:null}},{key:"isRateLimited",value:function(e){return!(!e||!e.includes("idbroker")&&!e.includes("identity"))&&this.getRateLimitStatus(e)}}]),t}(NI.Interceptor);t.default=d});t(EP);var SP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=Vk)&&r.__esModule?r:{default:r};var i=n.default.extend({props:{url:["string",!1,"https://idbroker.webex.com"],defaultUrl:["string",!1,"https://idbroker.webex.com"]}}),o=n.default.extend({props:{url:["string",!1,ku.env.IDENTITY_BASE_URL],defaultUrl:["string",!1,ku.env.IDENTITY_BASE_URL]}}),a=n.default.extend({extraProperties:"allow",children:{idbroker:i,identity:o},props:{authorizationString:["string",!1,ku.env.AUTHORIZATION_STRING],client_id:["string",!1,ku.env.CLIENT_ID],client_secret:["string",!1,ku.env.CLIENT_SECRET],redirect_uri:["string",!1,ku.env.REDIRECT_URI],scope:["string",!1,ku.env.SCOPE],cisService:["string",!1,"spark"]},derived:{activationUrl:{deps:["idbroker.url"],fn:function(){return(this.idbroker.url||"https://idbroker.webex.com")+"/idb/token/v1/actions/UserActivation/invoke"}},authorizeUrl:{deps:["idbroker.url"],fn:function(){return this.idbroker.url+"/idb/oauth2/v1/authorize"}},tokenUrl:{deps:["idbroker.url"],fn:function(){return this.idbroker.url+"/idb/oauth2/v1/access_token"}},revokeUrl:{deps:["idbroker.url"],fn:function(){return this.idbroker.url+"/idb/oauth2/v1/revoke"}},logoutUrl:{deps:["idbroker.url"],fn:function(){return this.idbroker.url+"/idb/oauth2/v1/logout"}},setPasswordUrl:{deps:["identity.url"],fn:function(){return(this.identity.url||"https://identity.webex.com")+"/identity/scim/v1/Users"}}}});t.default=a});t(SP);var TP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=SP)&&r.__esModule?r:{default:r};t.default={maxAppLevelRedirects:10,maxLocusRedirects:5,maxAuthenticationReplays:1,maxReconnectAttempts:1,onBeforeLogout:[],trackingIdPrefix:"spark-js-sdk",trackingIdSuffix:"",AlternateLogger:void 0,credentials:new n.default,device:{preDiscoveryServices:{hydra:"https://api.ciscospark.com/v1",hydraServiceUrl:"https://api.ciscospark.com/v1"},validateDomains:!1,whitelistedServiceDomains:["webexkubed.com","wbx3.com","wbx2.com","ciscospark.com","webex.com"]},payloadTransformer:{predicates:[],transforms:[]},storage:{boundedAdapter:aR.MemoryStoreAdapter,unboundedAdapter:aR.MemoryStoreAdapter}}});t(TP);var wP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=l(kR),n=l(Xw),i=l(yk),o=l(KI),a=l(hd),s=l(vp),u=l(fk),c=l(QI);function l(e){return e&&e.__esModule?e:{default:e}}function f(e,t,n){(e._derived[t]={fn:(0,a.default)(n)?n:n.fn,cache:!1!==n.cache,depList:n.deps||[]}).depList.forEach(function(r){e._deps[r]=(0,i.default)(e._deps[r]||[],[t])}),(0,r.default)(e,t,{get:function(){return this._getDerivedProperty(t)},set:function(){throw new TypeError("`"+t+"` is a derived property, it can't be set directly.")}})}t.default=function(e,t,r){return e.registerPlugin=function(i,a){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if((!e.prototype._children[i]||l.replace)&&(e.prototype._children[i]=a,l.proxies&&l.proxies.forEach(function(t){f(e.prototype,t,{deps:[i+"."+t],fn:function(){return this[i][t]}})}),l.interceptors&&(0,n.default)(l.interceptors).forEach(function(e){r[e]=l.interceptors[e]}),l.config&&(0,o.default)(t,l.config),(0,u.default)(l,"payloadTransformer.predicates")&&(t.payloadTransformer.predicates=t.payloadTransformer.predicates.concat((0,c.default)(l,"payloadTransformer.predicates"))),(0,u.default)(l,"payloadTransformer.transforms")&&(t.payloadTransformer.transforms=t.payloadTransformer.transforms.concat((0,c.default)(l,"payloadTransformer.transforms"))),l.onBeforeLogout&&(t.onBeforeLogout=t.onBeforeLogout||[],((0,s.default)(l.onBeforeLogout)?l.onBeforeLogout:[l.onBeforeLogout]).forEach(function(e){return t.onBeforeLogout.push({plugin:i,fn:e})})),a.prototype._definition&&a.prototype._definition.ready)){var d=e.prototype._derived.ready,p=d.fn,h={deps:d.depList.concat(i+".ready"),fn:p};f(e.prototype,"ready",h)}},e}});t(wP);var OP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=l(kR),n=l(Xw),i=l(yk),o=l(KI),a=l(hd),s=l(vp),u=l(fk),c=l(QI);function l(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,l){return e.registerPlugin=function(f,d){var p=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.prototype._children[f]||p.replace){if(e.prototype._children[f]=d,p.proxies)throw new Error("Proxies are not currently supported for private plugins");if(p.interceptors&&(0,n.default)(p.interceptors).forEach(function(e){l[e]=p.interceptors[e]}),p.config&&(0,o.default)(t,p.config),(0,u.default)(p,"payloadTransformer.predicates")&&(t.payloadTransformer.predicates=t.payloadTransformer.predicates.concat((0,c.default)(p,"payloadTransformer.predicates"))),(0,u.default)(p,"payloadTransformer.transforms")&&(t.payloadTransformer.transforms=t.payloadTransformer.transforms.concat((0,c.default)(p,"payloadTransformer.transforms"))),p.onBeforeLogout&&(t.onBeforeLogout=t.onBeforeLogout||[],((0,s.default)(p.onBeforeLogout)?p.onBeforeLogout:[p.onBeforeLogout]).forEach(function(e){return t.onBeforeLogout.push({plugin:f,fn:e})})),d.prototype._definition&&d.prototype._definition.ready){var h=e.prototype._derived.ready,v=h.fn,g={deps:h.depList.concat(f+".ready"),fn:v};!function(e,t,n){(e._derived[t]={fn:(0,a.default)(n)?n:n.fn,cache:!1!==n.cache,depList:n.deps||[]}).depList.forEach(function(r){e._deps[r]=(0,i.default)(e._deps[r]||[],[t])}),(0,r.default)(e,t,{get:function(){return this._getDerivedProperty(t)},set:function(){throw new TypeError("`"+t+"` is a derived property, it can't be set directly.")}})}(e.prototype,"ready",g)}}},e}});t(OP);var kP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(Xw),n=o(Vk),i=o(my);function o(e){return e&&e.__esModule?e:{default:e}}var a=n.default.extend({derived:{ready:{deps:[],fn:function(){var e=this;return(0,r.default)(this._children).reduce(function(t,r){return t&&e[r]&&!1!==e[r].ready},!0)}}},inspect:function(e){return i.default.inspect(this.serialize({props:!0,session:!0,derived:!0}),{depth:e})}});t.default=a});t(kP);var RP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=L(ac),i=L(cc),o=L(wf),a=L(zk),s=L(_f),u=L(Xw),c=L(Af),l=L(zI),f=L(WI),d=L(cg),p=L(KI),h=L(Mv),v=L(hO),g=L(hd),m=L(fk),y=L(QI),_=L(cS);t.registerPlugin=function(e,t,r){Y.registerPlugin(e,t,r)},t.registerInternalPlugin=function(e,t,r){x.default.registerPlugin(e,t,r)};var b=L(my),E=L(Vk),S=L(lP),T=L(fP),w=L(dP),O=L(pP),k=L(hP),R=L(vP),A=(L(gP),L(mP)),I=(L(yP),L(DI)),P=L(_P),C=L(bP),M=L(EP),N=L(TP),D=L(wP),j=L(OP),x=L(kP);function L(e){return e&&e.__esModule?e:{default:e}}var U,F,G,q,V,B,z={SparkTrackingIdInterceptor:P.default.create,RequestEventInterceptor:R.default.create,RateLimitInterceptor:M.default.create,RequestLoggerInterceptor:void 0,ResponseLoggerInterceptor:void 0,RequestTimingInterceptor:A.default.create,UrlInterceptor:void 0,SparkUserAgentInterceptor:C.default.create,AuthInterceptor:T.default.create,KmsDryErrorInterceptor:void 0,PayloadTransformerInterceptor:O.default.create,ConversationInterceptor:void 0,RedirectInterceptor:k.default.create,HttpStatusInterceptor:function(){return NI.HttpStatusInterceptor.create({error:I.default})},NetworkTimingInterceptor:w.default.create},W=["ResponseLoggerInterceptor","RequestTimingInterceptor","RequestEventInterceptor","SparkTrackingIdInterceptor","RateLimitInterceptor"],H=["HttpStatusInterceptor","NetworkTimingInterceptor","RequestLoggerInterceptor","RateLimitInterceptor"],Y=E.default.extend((r={version:"1.50.6",children:{internal:x.default},constructor:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];return"string"==typeof e?e={credentials:{supertoken:{access_token:e}}}:(["credentials.authorization","authorization","credentials.supertoken.supertoken","supertoken","access_token","credentials.authorization.supertoken"].forEach(function(t){var r=(0,y.default)(e,t);r&&((0,l.default)(e,t),(0,f.default)(e,"credentials.supertoken",r))}),["credentials","credentials.authorization"].forEach(function(t){var r=(0,y.default)(e,t);"string"==typeof r&&((0,l.default)(e,t),(0,f.default)(e,"credentials.supertoken",r))}),"string"==typeof(0,y.default)(e,"credentials.access_token")&&((0,f.default)(e,"credentials.access_token",this.bearerValidator((0,y.default)(e,"credentials.access_token").trim())),(0,f.default)(e,"credentials.supertoken",e.credentials))),(0,c.default)(E.default,this,[e,t])},derived:{boundedStorage:{deps:[],fn:function(){return(0,aR.makeSparkStore)("bounded",this)}},unboundedStorage:{deps:[],fn:function(){return(0,aR.makeSparkStore)("unbounded",this)}},ready:{deps:["loaded","internal.ready"],fn:function(){var e=this;return this.loaded&&(0,u.default)(this._children).reduce(function(t,r){return t&&e[r]&&!1!==e[r].ready},!0)}}},session:{config:{type:"object"},loaded:{default:!1,type:"boolean"},request:{setOnce:!0,type:"any"},sessionId:{setOnce:!0,type:"string"}},refresh:function(){var e;return(e=this.credentials).refresh.apply(e,arguments)},transform:function(e,t){var r=this,n=this.config.payloadTransformer.predicates.filter(function(t){return!t.direction||t.direction===e}),i={spark:this};return s.default.all(n.map(function(e){return e.test(i,t).then(function(r){if(r)return e.extract(t).then(function(t){return{name:e.name,target:t}})})})).then(function(t){return t.filter(function(e){return Boolean(e)}).reduce(function(t,n){var i=n.name,o=n.target,a=n.alias;return t.then(function(){return a?r.applyNamedTransform(e,a,o):r.applyNamedTransform(e,i,o)})},s.default.resolve())}).then(function(){return t})},applyNamedTransform:function(e,t,r){for(var n=arguments.length,i=Array(n>3?n-3:0),o=3;o<n;o++)i[o-3]=arguments[o];var u=this;return(0,v.default)(t)&&(i.unshift(r),r=t,t={spark:this,transform:function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return u.applyNamedTransform.apply(u,[e,t].concat(n))}}),t.spark.config.payloadTransformer.transforms.filter(function(t){return t.name===r&&(!t.direction||t.direction===e)}).reduce(function(e,r){return e.then(function(){var e;return r.alias?(e=t).transform.apply(e,[r.alias].concat((0,a.default)(i))):s.default.resolve(r.fn.apply(r,[t].concat((0,a.default)(i))))})},s.default.resolve()).then(function(){return(0,h.default)(i)})},getWindow:function(){return window},initialize:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};delete N.default.credentials.federation,this.config=(0,p.default)({},N.default,t.config),this.trigger("change:config");var r=function t(){e.loaded&&(e.trigger("loaded"),e.stopListening(e,"change:loaded",t))};pu(function(){e.listenToAndRun(e,"change:loaded",r)});var n=function t(){e.ready&&(e.trigger("ready"),e.stopListening(e,"change:ready",t))};pu(function(){e.listenToAndRun(e,"change:ready",n)}),(0,u.default)(this.constructor.prototype._children).forEach(function(t){e.listenTo(e[t],"change",function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];n.unshift("change:"+t),e.trigger.apply(e,n)})});var i=function(t,r){var n=z[r];return(0,g.default)(n)?(t.push((0,c.default)(n,e,[])),t):t},o=[];o=W.reduce(i,o),o=(0,u.default)(z).filter(function(e){return!(W.includes(e)||H.includes(e))}).reduce(i,o),o=H.reduce(i,o),this.request=(0,NI.defaults)({json:!0,interceptors:o});var a=(0,y.default)(this,"config.trackingIdPrefix","spark-js-sdk")+"_"+(0,y.default)(this,"config.trackingIdBase",S.default.v4());(0,m.default)(this,"config.trackingIdPrefix")&&(a+="_"+(0,y.default)(this,"config.trackingIdPrefix")),this.sessionId=a},setConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=(0,p.default)({},this.config,e)},bearerValidator:function(e){return e.includes("Bearer")&&e.split(" ").length-1==0?(console.warn("Your access token does not have a space between 'Bearer' and the token, please add a space to it or replace it with this already fixed version:\n\n"+e.replace("Bearer","Bearer ").replace(/\s+/g," ")),console.info("Tip: You don't need to add 'Bearer' to the access_token field. The token by itself is fine"),e.replace("Bearer","Bearer ").replace(/\s+/g," ")):e.split(" ").length-1>1?(console.warn("Your access token has "+(e.split(" ").length-2)+" too many spaces, please use this format:\n\n"+e.replace(/\s+/g," ")),console.info("Tip: You don't need to add 'Bearer' to the access_token field, the token by itself is fine"),e.replace(/\s+/g," ")):e.replace(/\s+/g," ")},inspect:function(e){return b.default.inspect((0,d.default)(this.serialize({props:!0,session:!0,derived:!0}),"boundedStorage","unboundedStorage","request","config"),{depth:e})},logout:function(e){for(var t=this,r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var u=this.credentials.supertoken&&(this.credentials.supertoken.refresh_token||this.credentials.supertoken.access_token);return e=(0,o.default)({token:u},e),this.config.onBeforeLogout.reverse().reduce(function(r,i){var o=i.plugin,u=i.fn;return r.then(function(){return s.default.resolve((0,c.default)(u,t[o]||t.internal[o],[e].concat((0,a.default)(n)))).catch(function(e){t.logger.warn("onBeforeLogout from plugin "+o+": failed",e)})})},s.default.resolve()).then(function(){return s.default.all([t.boundedStorage.clear(),t.unboundedStorage.clear()])}).then(function(){var e;return(e=t.credentials).invalidate.apply(e,(0,a.default)(n))}).then(function(){var r;return t.authorization&&t.authorization.logout&&(r=t.authorization).logout.apply(r,[e].concat((0,a.default)(n)))}).then(function(){return t.trigger("client:logout")})},measure:function(){var e;return this.metrics?(e=this.metrics).sendUnstructured.apply(e,arguments):s.default.resolve()},upload:function(e){var t=this;if(!e.file)return s.default.reject(new Error("`options.file` is required"));e.phases=e.phases||{},e.phases.initialize=e.phases.initialize||{},e.phases.upload=e.phases.upload||{},e.phases.finalize=e.phases.finalize||{},(0,_.default)(e.phases.initialize,{method:"POST"},(0,d.default)(e,"file","phases")),(0,_.default)(e.phases.upload,{method:"PUT",json:!1,withCredentials:!1,body:e.file,headers:{"x-trans-id":S.default.v4(),authorization:void 0}}),(0,_.default)(e.phases.finalize,{method:"POST"},(0,d.default)(e,"file","phases"));var r=new fS.EventEmitter,n=this._uploadPhaseInitialize(e).then(function(){var n=t._uploadPhaseUpload(e);return(0,Yw.transferEvents)("progress",n,r),n}).then(function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return t._uploadPhaseFinalize.apply(t,[e].concat(n))}).then(function(e){return e.body});return(0,Yw.proxyEvents)(r,n),n},_uploadPhaseInitialize:function(e){var t=this;return this.logger.debug("client: initiating upload session"),this.request(e.phases.initialize).then(function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return t._uploadApplySession.apply(t,[e].concat(n))}).then(function(e){return t.logger.debug("client: initiated upload session"),e})},_uploadApplySession:function(e,t){var r=t.body;["upload","finalize"].reduce(function(e,t){return e[t]=(0,u.default)(e[t]).reduce(function(e,t){return t.startsWith("$")&&(e[t.substr(1)]=e[t](r),(0,i.default)(e,t)),e},e[t]),e},e.phases)},_uploadPhaseUpload:function(e){var t=this;this.logger.debug("client: uploading file");var r=this.request(e.phases.upload).then(function(e){return t.logger.debug("client: uploaded file"),e});return(0,Yw.proxyEvents)(e.phases.upload.upload,r),r},_uploadPhaseFinalize:function(e){var t=this;return this.logger.debug("client: finalizing upload session"),this.request(e.phases.finalize).then(function(e){return t.logger.debug("client: finalized upload session"),e})}},U=r,F="_uploadPhaseUpload",G=[Yw.retry],q=(0,n.default)(r,"_uploadPhaseUpload"),V=r,B={},Object.keys(q).forEach(function(e){B[e]=q[e]}),B.enumerable=!!B.enumerable,B.configurable=!!B.configurable,("value"in B||B.initializer)&&(B.writable=!0),B=G.slice().reverse().reduce(function(e,t){return t(U,F,e)||e},B),V&&void 0!==B.initializer&&(B.value=B.initializer?B.initializer.call(V):void 0,B.initializer=void 0),void 0===B.initializer&&(Object.defineProperty(U,F,B),B=null),r));Y.version="1.50.6",(0,j.default)(x.default,N.default,z),(0,D.default)(Y,N.default,z),t.default=Y});t(RP);RP.registerPlugin,RP.registerInternalPlugin;var AP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.grantErrors=t.Token=t.sortScope=t.filterScope=t.Credentials=void 0,Object.defineProperty(t,"Credentials",{enumerable:!0,get:function(){return n(BI).default}}),Object.defineProperty(t,"filterScope",{enumerable:!0,get:function(){return dR.filterScope}}),Object.defineProperty(t,"sortScope",{enumerable:!0,get:function(){return dR.sortScope}}),Object.defineProperty(t,"Token",{enumerable:!0,get:function(){return n(jI).default}}),Object.defineProperty(t,"grantErrors",{enumerable:!0,get:function(){return n(fR).default}});var r=n(BI);function n(e){return e&&e.__esModule?e:{default:e}}(0,RP.registerPlugin)("credentials",r.default,{proxies:["canAuthorize","canRefresh"]})});t(AP);AP.grantErrors,AP.Token,AP.sortScope,AP.filterScope,AP.Credentials;var IP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,n,i=l(wf),o=l(Hy),a=l(By),s=l(Yy),u=l(h_),c=l(Ck);function l(e){return e&&e.__esModule?e:{default:e}}var f,d,p,h,v,g,m=new u.default,y=(r=function(){function e(){var t,r,i,s,u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,a.default)(this,e),t=this,r="ready",s=this,(i=n)&&(0,o.default)(t,r,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(s):void 0});var l=u.spark||c.parent;if(!l)throw new Error("One of `attrs.spark` or `options.parent` must be supplied when initializing a StatelessSparkPlugin");for(;l.parent||l.collection;)l=l.parent||l.collection;m.set(this,l)}return(0,s.default)(e,[{key:"config",get:function(){var e=this.getNamespace?this.getNamespace():this.namespace;return e?(e=e.toLowerCase(),this.spark.config[e]):this.spark.config}},{key:"logger",get:function(){return this.spark.logger}},{key:"spark",get:function(){return m.get(this)}}]),(0,s.default)(e,[{key:"request",value:function(){var e;return(e=this.spark).request.apply(e,arguments)}},{key:"upload",value:function(){var e;return(e=this.spark).upload.apply(e,arguments)}}]),e}(),f=r.prototype,d="ready",p=[Bw.readonly],h={enumerable:!0,initializer:function(){return!0}},g={},Object.keys(h).forEach(function(e){g[e]=h[e]}),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=p.slice().reverse().reduce(function(e,t){return t(f,d,e)||e},g),v&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(v):void 0,g.initializer=void 0),void 0===g.initializer&&(Object.defineProperty(f,d,g),g=null),n=g,r);t.default=y,(0,i.default)(y.prototype,c.default)});t(IP);var PP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=s(_f),n=s(pb),i=s(fk),o=s(sR),a=s(DI);function s(e){return e&&e.__esModule?e:{default:e}}var u=o.default.extend({session:{deferreds:{type:"object",default:function(){return new n.default}},queue:{type:"array",default:function(){return[]}}},derived:{bounce:{fn:function(){var e=this;return(0,Yw.cappedDebounce)(function(){return e.executeQueue.apply(e,arguments)},this.config.batcherWait,{maxCalls:this.config.batcherMaxCalls,maxWait:this.config.batcherMaxWait})}}},request:function(e){var t=this,n=new Yw.Defer;return this.fingerprintRequest(e).then(function(i){t.deferreds.has(i)?n.resolve(t.deferreds.get(i).promise):(t.deferreds.set(i,n),t.prepareItem(e).then(function(e){n.promise=n.promise.then((0,Yw.tap)(function(){return t.deferreds.delete(i)})).catch(function(e){return t.deferreds.delete(i),r.default.reject(e)}),t.enqueue(e).then(function(){return t.bounce()}).catch(function(e){return n.reject(e)})}).catch(function(e){return n.reject(e)}))}).catch(function(e){return n.reject(e)}),n.promise},enqueue:function(e){return this.queue.push(e),r.default.resolve()},prepareItem:function(e){return r.default.resolve(e)},executeQueue:function(){var e=this,t=this.queue.splice(0,this.config.batcherMaxCalls);return new r.default(function(n){n(e.prepareRequest(t).then(function(t){return e.submitHttpRequest(t).then(function(t){return e.handleHttpSuccess(t)})}).catch(function(n){return n instanceof a.default?e.handleHttpError(n):r.default.all(t.map(function(t){return e.getDeferredForRequest(t).then(function(e){e.reject(n)})}))}))}).catch(function(t){return e.logger.error(t.stack),r.default.reject(t)})},prepareRequest:function(e){return r.default.resolve(e)},submitHttpRequest:function(e){throw new Error("request() must be implemented")},handleHttpSuccess:function(e){var t=this;return r.default.all((e.body&&e.body.items||e.body).map(function(e){return t.acceptItem(e)}))},handleHttpError:function(e){var t=this;return e instanceof a.default&&(0,i.default)(e,"options.body.map")?r.default.all(e.options.body.map(function(r){return t.getDeferredForRequest(r).then(function(t){t.reject(e)})})):(this.logger.error("http error handler called without a SparkHttpError object",e),r.default.reject(e))},acceptItem:function(e){var t=this;return this.didItemFail(e).then(function(r){return r?t.handleItemFailure(e):t.handleItemSuccess(e)})},didItemFail:function(e){return r.default.resolve(!1)},handleItemFailure:function(e){return this.getDeferredForResponse(e).then(function(t){t.reject(e)})},handleItemSuccess:function(e){return this.getDeferredForResponse(e).then(function(t){t.resolve(e)})},getDeferredForRequest:function(e){var t=this;return this.fingerprintRequest(e).then(function(e){var r=t.deferreds.get(e);if(!r)throw new Error("Could not find pending request for received response");return r})},getDeferredForResponse:function(e){var t=this;return this.fingerprintResponse(e).then(function(e){var r=t.deferreds.get(e);if(!r)throw new Error("Could not find pending request for received response");return r})},fingerprintRequest:function(e){throw new Error("fingerprintRequest() must be implemented")},fingerprintResponse:function(e){throw new Error("fingerprintResponse() must be implemented")},version:"1.50.6"});t.default=u});t(PP);var CP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(y_),n=a(By),i=a(Yy),o=a(h_);function a(e){return e&&e.__esModule?e:{default:e}}var s=new o.default,u=new o.default,c=new o.default,l=function(){function e(t,r){return(0,n.default)(this,e),s.set(this,t.body.items),u.set(this,e.parseLinkHeaders(t.headers.link)),c.set(this,r),this}return(0,i.default)(e,[{key:"items",get:function(){return s.get(this)}},{key:"length",get:function(){return this.items.length}},{key:"links",get:function(){return u.get(this)}},{key:"spark",get:function(){return c.get(this)}}]),(0,i.default)(e,[{key:"next",value:function(){return this.getLink("next")}},{key:"hasNext",value:function(){return this.hasLink("next")}},{key:"previous",value:function(){return this.getLink("previous")}},{key:"hasPrevious",value:function(){return this.hasLink("previous")}},{key:"getLink",value:function(t){var r=this;return this.spark.request({uri:this.links[t]}).then(function(t){return new e(t,r.spark)})}},{key:"hasLink",value:function(e){return Boolean(this.links[e])}},{key:r.default,value:function(){var e=this,t=-1;return{next:function(){return(t+=1)<e.length?{value:e.items[t]}:{done:!0}}}}}],[{key:"parseLinkHeaders",value:function(e){return e?(e=Array.isArray(e)?e:[e]).reduce(function(e,t){var r=(t=t.split(";"))[0].replace("<","").replace(">","");return e[t[1].split("=")[1].replace(/"/g,"")]=r,e},{}):{}}}]),e}();t.default=l});t(CP),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={error:["log"],warn:["error","log"],info:["log"],debug:["info","log"],trace:["debug","info","log"]};function n(e){var t=r[e];if(t)for(t=t.slice();!console[e];)e=t.pop();return function(){for(var t,r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=console)[e].apply(t,n)}}var i=MP.SparkPlugin.extend({namespace:"Logger",error:n("error"),warn:n("warn"),log:n("log"),info:n("info"),debug:n("debug"),trace:n("trace"),version:"1.50.6"});(0,MP.registerPlugin)("logger",i),t.default=i}));var MP=r(function(e,t){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.config=t.Page=t.Batcher=t.RateLimitInterceptor=t.SparkUserAgentInterceptor=t.SparkTrackingIdInterceptor=t.RequestTimingInterceptor=t.RequestLoggerInterceptor=t.RequestEventInterceptor=t.ResponseLoggerInterceptor=t.RedirectInterceptor=t.PayloadTransformerInterceptor=t.NetworkTimingInterceptor=t.AuthInterceptor=t.SparkPlugin=t.StatelessSparkPlugin=t.SparkHttpError=t.registerInternalPlugin=t.registerPlugin=t.default=t.children=t.waitForValue=t.StorageError=t.persist=t.NotFoundError=t.MemoryStoreAdapter=t.makeSparkPluginStore=t.makeSparkStore=t.Token=t.sortScope=t.grantErrors=t.filterScope=t.Credentials=void 0,Object.defineProperty(t,"Credentials",{enumerable:!0,get:function(){return AP.Credentials}}),Object.defineProperty(t,"filterScope",{enumerable:!0,get:function(){return AP.filterScope}}),Object.defineProperty(t,"grantErrors",{enumerable:!0,get:function(){return AP.grantErrors}}),Object.defineProperty(t,"sortScope",{enumerable:!0,get:function(){return AP.sortScope}}),Object.defineProperty(t,"Token",{enumerable:!0,get:function(){return AP.Token}}),Object.defineProperty(t,"makeSparkStore",{enumerable:!0,get:function(){return aR.makeSparkStore}}),Object.defineProperty(t,"makeSparkPluginStore",{enumerable:!0,get:function(){return aR.makeSparkPluginStore}}),Object.defineProperty(t,"MemoryStoreAdapter",{enumerable:!0,get:function(){return aR.MemoryStoreAdapter}}),Object.defineProperty(t,"NotFoundError",{enumerable:!0,get:function(){return aR.NotFoundError}}),Object.defineProperty(t,"persist",{enumerable:!0,get:function(){return aR.persist}}),Object.defineProperty(t,"StorageError",{enumerable:!0,get:function(){return aR.StorageError}}),Object.defineProperty(t,"waitForValue",{enumerable:!0,get:function(){return aR.waitForValue}}),Object.defineProperty(t,"children",{enumerable:!0,get:function(){return RP.children}}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(RP).default}}),Object.defineProperty(t,"registerPlugin",{enumerable:!0,get:function(){return RP.registerPlugin}}),Object.defineProperty(t,"registerInternalPlugin",{enumerable:!0,get:function(){return RP.registerInternalPlugin}}),Object.defineProperty(t,"SparkHttpError",{enumerable:!0,get:function(){return r(DI).default}}),Object.defineProperty(t,"StatelessSparkPlugin",{enumerable:!0,get:function(){return r(IP).default}}),Object.defineProperty(t,"SparkPlugin",{enumerable:!0,get:function(){return r(sR).default}}),Object.defineProperty(t,"AuthInterceptor",{enumerable:!0,get:function(){return r(fP).default}}),Object.defineProperty(t,"NetworkTimingInterceptor",{enumerable:!0,get:function(){return r(dP).default}}),Object.defineProperty(t,"PayloadTransformerInterceptor",{enumerable:!0,get:function(){return r(pP).default}}),Object.defineProperty(t,"RedirectInterceptor",{enumerable:!0,get:function(){return r(hP).default}}),Object.defineProperty(t,"ResponseLoggerInterceptor",{enumerable:!0,get:function(){return r(yP).default}}),Object.defineProperty(t,"RequestEventInterceptor",{enumerable:!0,get:function(){return r(vP).default}}),Object.defineProperty(t,"RequestLoggerInterceptor",{enumerable:!0,get:function(){return r(gP).default}}),Object.defineProperty(t,"RequestTimingInterceptor",{enumerable:!0,get:function(){return r(mP).default}}),Object.defineProperty(t,"SparkTrackingIdInterceptor",{enumerable:!0,get:function(){return r(_P).default}}),Object.defineProperty(t,"SparkUserAgentInterceptor",{enumerable:!0,get:function(){return r(bP).default}}),Object.defineProperty(t,"RateLimitInterceptor",{enumerable:!0,get:function(){return r(EP).default}}),Object.defineProperty(t,"Batcher",{enumerable:!0,get:function(){return r(PP).default}}),Object.defineProperty(t,"Page",{enumerable:!0,get:function(){return r(CP).default}}),Object.defineProperty(t,"config",{enumerable:!0,get:function(){return r(TP).default}})});t(MP);MP.config,MP.Page,MP.Batcher,MP.RateLimitInterceptor,MP.SparkUserAgentInterceptor,MP.SparkTrackingIdInterceptor,MP.RequestTimingInterceptor,MP.RequestLoggerInterceptor,MP.RequestEventInterceptor,MP.ResponseLoggerInterceptor,MP.RedirectInterceptor,MP.PayloadTransformerInterceptor,MP.NetworkTimingInterceptor,MP.AuthInterceptor,MP.SparkPlugin,MP.StatelessSparkPlugin,MP.SparkHttpError,MP.registerInternalPlugin,MP.registerPlugin,MP.children,MP.waitForValue,MP.StorageError,MP.persist,MP.NotFoundError,MP.MemoryStoreAdapter,MP.makeSparkPluginStore,MP.makeSparkStore,MP.Token,MP.sortScope,MP.grantErrors,MP.filterScope,MP.Credentials;var NP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n,i,o=m(ac),a=m(cc),s=m(_f),u=m(wf),c=m(Af),l=m(Cf),f=m(cg),d=m(pg),p=m(gg),h=m(wg),v=m(yy),g=m(lP);function m(e){return e&&e.__esModule?e:{default:e}}function y(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var _=Yw.base64.encode((0,l.default)({})),b=MP.SparkPlugin.extend((r=(0,Yw.whileInFlight)("isAuthorizing"),n=(0,Yw.whileInFlight)("isAuthorizing"),y(i={derived:{isAuthenticating:{deps:["isAuthorizing"],fn:function(){return this.isAuthorizing}}},session:{isAuthorizing:{default:!1,type:"boolean"},ready:{default:!1,type:"boolean"}},namespace:"Credentials",initialize:function(e,t){var r=this,n=(0,c.default)(MP.SparkPlugin.prototype.initialize,this,[e,t]);if(!1===e.parse)return this.ready=!0,n;var i=v.default.parse(this.spark.getWindow().location.href,!0);this._checkForErrors(i);var o=i.hash;if(!o)return this.ready=!0,n;o.includes("#")&&(o=o.substr(1)),i.hash=h.default.parse(o),i.hash.state&&(i.hash.state=JSON.parse(Yw.base64.decode(i.hash.state)));var a=this._parseHash(i);return a?(this._cleanUrl(i),pu(function(){r.spark.credentials.set({supertoken:a}),r.ready=!0}),n):n},initiateLogin:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.state=e.state||{},e.state.csrf_token=this._generateSecurityToken(),"confidential"===this.config.clientType?this.initiateAuthorizationCodeGrant(e):this.initiateImplicitGrant(e)},initiateImplicitGrant:function(e){return this.logger.info("authorization: initiating implicit grant flow"),this.spark.getWindow().location=this.spark.credentials.buildLoginUrl((0,u.default)({response_type:"token"},e)),s.default.resolve()},initiateAuthorizationCodeGrant:function(e){return this.logger.info("authorization: initiating authorization code grant flow"),this.spark.getWindow().location=this.spark.credentials.buildLoginUrl((0,u.default)({response_type:"code"},e)),s.default.resolve()},requestAccessTokenFromJwt:function(e){var t=this,r=e.jwt;return this.spark.request({method:"POST",service:"hydra",resource:"jwt/login",headers:{authorization:r}}).then(function(e){var t=e.body;return{access_token:t.token,token_type:"Bearer",expires_in:t.expiresIn}}).then(function(e){t.spark.credentials.set({supertoken:e})})},logout:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.noRedirect||(this.spark.getWindow().location=this.spark.credentials.buildLogoutUrl(e))},_checkForErrors:function(e){var t=e.query;if(t&&t.error)throw new(MP.grantErrors.select(t.error))(t)},_cleanUrl:function(e){e=(0,p.default)(e),this.spark.getWindow().history&&this.spark.getWindow().history.replaceState&&(["access_token","token_type","expires_in","refresh_token","refresh_token_expires_in"].forEach(function(t){return(0,a.default)(e.hash,t)}),(0,d.default)(e.hash.state)?(0,a.default)(e.hash,"state"):(e.hash.state=Yw.base64.encode((0,l.default)((0,f.default)(e.hash.state,"csrf_token"))),e.hash.state===_&&(0,a.default)(e.hash,"state")),e.hash=h.default.stringify(e.hash),this.spark.getWindow().history.replaceState({},null,v.default.format(e)))},_generateSecurityToken:function(){this.logger.info("authorization: generating csrf token");var e=g.default.v4();return this.spark.getWindow().sessionStorage.setItem("oauth2-csrf-token",e),e},_parseHash:function(e){var t=(0,p.default)(e.hash);if(t&&this._verifySecurityToken(t),t.access_token)return t.expires_in&&(t.expires_in=parseInt(t.expires_in,10)),t.refresh_token_expires_in&&(t.refresh_token_expires_in=parseInt(t.refresh_token_expires_in,10)),t;this.ready=!0},_verifySecurityToken:function(e){var t=this.spark.getWindow().sessionStorage.getItem("oauth2-csrf-token");if(this.spark.getWindow().sessionStorage.removeItem("oauth2-csrf-token"),t){if(!e.state)throw new Error("Expected CSRF token "+t+", but not found in redirect hash");if(!e.state.csrf_token)throw new Error("Expected CSRF token "+t+", but not found in redirect hash");var r=e.state.csrf_token;if(r!==t)throw new Error("CSRF token "+r+" does not match stored token "+t)}},version:"1.50.6"},"initiateImplicitGrant",[r],(0,o.default)(i,"initiateImplicitGrant"),i),y(i,"initiateAuthorizationCodeGrant",[n],(0,o.default)(i,"initiateAuthorizationCodeGrant"),i),y(i,"requestAccessTokenFromJwt",[Yw.oneFlight],(0,o.default)(i,"requestAccessTokenFromJwt"),i),i));t.default=b});t(NP);var DP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={credentials:{clientType:"public"}}});t(DP);var jP=1,xP=2;var LP=function(e,t,r,n){var i=r.length,o=i,a=!n;if(null==e)return!o;for(e=Object(e);i--;){var s=r[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){var u=(s=r[i])[0],c=e[u],l=s[1];if(a&&s[2]){if(void 0===c&&!(u in e))return!1}else{var f=new ep;if(n)var d=n(c,l,u,e,t,f);if(!(void 0===d?ak(l,c,jP|xP,n,f):d))return!1}}return!0};var UP=function(e){return e==e&&!ud(e)};var FP=function(e){for(var t=Up(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,UP(i)]}return t};var GP=function(e,t){return function(r){return null!=r&&r[e]===t&&(void 0!==t||e in Object(r))}};var qP=function(e){var t=FP(e);return 1==t.length&&t[0][2]?GP(t[0][0],t[0][1]):function(r){return r===e||LP(r,e,t)}},VP=1,BP=2;var zP=function(e,t){return yv(e)&&UP(t)?GP(Dv(e),t):function(r){var n=QI(r,e);return void 0===n&&n===t?SR(r,e):ak(t,n,VP|BP)}};var WP=function(e){return function(t){return null==t?void 0:t[e]}};var HP=function(e){return function(t){return jv(t,e)}};var YP=function(e){return yv(e)?WP(Dv(e)):HP(e)};var $P=function(e){return"function"==typeof e?e:null==e?tg:"object"==typeof e?vp(e)?zP(e[0],e[1]):qP(e):YP(e)};var XP=function(e){return function(t,r,n){var i=Object(t);if(!Lp(t)){var o=$P(r,3);t=Up(t),r=function(e){return o(i[e],e,i)}}var a=e(t,r,n);return a>-1?i[o?t[a]:a]:void 0}},JP=Math.max;var KP=XP(function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=null==r?0:BE(r);return i<0&&(i=JP(n+i,0)),$b(e,$P(t,3),i)}),QP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=s(PR),n=s(Af),i=s(ud),o=s(cS),a=s(Vk);function s(e){return e&&e.__esModule?e:{default:e}}var u=a.default.extend({props:{key:"string",lastModified:"date",mutable:"boolean",type:"string",val:"string",value:"any"},constructor:function(e,t){return t=t||{},(0,o.default)(t,{parse:!0}),(0,n.default)(a.default.prototype.constructor,this,[e,t])},idAttribute:"key",parse:function(e){if(!e)return{};var t=Number(e.val);return e.val&&!(0,r.default)(t)?(e.value=t,e.type="number"):"true"===e.val?(e.value=!0,e.type="boolean"):"false"===e.val?(e.value=!1,e.type="boolean"):(e.value=e.val,e.type="string"),e},serialize:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=(0,n.default)(a.default.prototype.serialize,this,t);return i.lastModified&&(i.lastModified=new Date(i.lastModified).toISOString()),i},set:function(e,t,r){var o=void 0;return(0,i.default)(e)||null===e?(o=e,r=t):(o={})[e]=t,o=this.parse(o,r),(0,n.default)(a.default.prototype.set,this,[o,r])}});t.default=u});t(QP);var ZP=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(qI),n=i(QP);function i(e){return e&&e.__esModule?e:{default:e}}var o=r.default.extend({mainIndex:"key",model:n.default});t.default=o});t(ZP);var eC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(Xw),n=o(Vk),i=o(ZP);function o(e){return e&&e.__esModule?e:{default:e}}var a=n.default.extend({collections:{developer:i.default,entitlement:i.default,user:i.default},clear:function(e){var t=this;return(0,r.default)(this.attributes).forEach(function(r){t.unset(r,e)}),(0,r.default)(this._children).forEach(function(e){t[e].clear()}),(0,r.default)(this._collections).forEach(function(e){t[e].reset()}),this},initialize:function(){var e=this;["change:value","add","remove"].forEach(function(t){["developer","entitlement","user"].forEach(function(r){e[r].on(t,function(t,n){e.trigger("change:"+r,e,e[r],n)})})})}});t.default=a});t(eC);var tC=function(e,t){var r;return Tk(e,function(e,n,i){return!(r=t(e,n,i))}),!!r};var rC=function(e,t,r){var n=vp(e)?AO:tC;return r&&aS(e,t,r)&&(t=void 0),n(e,$P(t,3))},nC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=l(_f),n=l(Af),i=l(KP),o=l(rC),a=l(ud),s=l(cS),u=l(Vk),c=l(yy);function l(e){return e&&e.__esModule?e:{default:e}}var f=u.default.extend({props:{service:"string",defaultUrl:"string",availableHosts:{type:"array",default:function(){return[]}}},session:{currentHostIndex:{type:"number",default:0}},derived:{url:{deps:["defaultUrl","availableHosts","currentHostIndex"],fn:function(){if(0===this.availableHosts.length)return this.defaultUrl;var e=void 0;return e=this.currentHostIndex>=this.availableHosts.length?this.availableHosts[this.availableHosts.length-1]:this.availableHosts[this.currentHostIndex],this._changeUrlHost(this.defaultUrl,e.host)}}},constructor:function(e,t){return t=t||{},(0,s.default)(t,{parse:!0}),(0,n.default)(u.default.prototype.constructor,this,[e,t])},idAttribute:"service",serialize:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=(0,n.default)(u.default.prototype.serialize,this,t);return i.url=this.url,i},parse:function(e){return e?(e.availableHosts&&e.availableHosts.sort(function(e,t){return e.priority-t.priority}),e):{}},set:function(e,t,r){var i=void 0;return(0,a.default)(e)||null===e?(i=e,r=t):(i={})[e]=t,i=this.parse(i,r),(0,n.default)(u.default.prototype.set,this,[i,r])},markHostFailed:function(e){var t=this.getCurrentHost();if(e){var r=c.default.parse(e);t=(0,i.default)(this.availableHosts,function(e){return e.host===r.host})}t&&(t.failed=!0)},cycleNextHost:function(){for(var e=0;e<this.availableHosts.length;e+=1){var t=this.availableHosts[e];if(!t.failed&&this.currentHostIndex!==e)return this.currentHostIndex=e,r.default.resolve(t)}return this.currentHostIndex=0,r.default.reject(new Error("All hosts have failed for "+this.service))},doesUrlBelongToService:function(e){var t=c.default.parse(e),r=this.availableHosts.map(function(e){return e.host});return r.push(c.default.parse(this.defaultUrl).host),(0,o.default)(r,function(e){return e===t.host})},getCurrentHost:function(){return this.availableHosts[this.currentHostIndex]},resetAllHosts:function(){this.availableHosts.forEach(function(e){e.failed=!1})},replaceUrlWithCurrentHost:function(e){return this._changeUrlHost(e,this.getCurrentHost().host)},_changeUrlHost:function(e,t){var r=c.default.parse(e);return r.host=t,c.default.format(r)}});t.default=f});t(nC);var iC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(_f),n=o(qI),i=o(nC);function o(e){return e&&e.__esModule?e:{default:e}}var a=n.default.extend({mainIndex:"service",model:i.default,markFailedAndCycleUrl:function(e){return e?this.inferServiceFromUrl(e).then(function(t){return t.markHostFailed(e),t.cycleNextHost().then(function(){return t.url})}):r.default.reject(new Error("`uri` is a required parameter"))},resetAllAndRetry:function(e){return e?this.inferServiceFromUrl(e).then(function(e){return e.resetAllHosts(),e.url}):r.default.reject(new Error("`uri` is a required parameter"))},inferServiceFromUrl:function(e){var t=this.filter(function(t){return t.doesUrlBelongToService(e)});return t.length>=1?r.default.resolve(t[0]):r.default.reject(new Error("Unable to infer service for this url "+e))},inferServiceNameFromUrl:function(e){return this.inferServiceFromUrl(e).then(function(e){return e.service})}});t.default=a});t(iC);var oC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n,i,o,a,s,u,c,l,f,d=w(ac),p=w(FR),h=w(Af),v=w(_f),g=w(Xw),m=w(mR),y=w(KP),_=w(cg),b=w(my),E=w(eC),S=w(iC),T=w(yy);function w(e){return e&&e.__esModule?e:{default:e}}function O(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var k=MP.SparkPlugin.extend((r=(0,MP.waitForValue)("@"),n=(0,MP.waitForValue)("@"),i=(0,MP.persist)("@",function(){return!this.config.ephemeral}),o=(0,MP.waitForValue)("@"),a=(0,MP.waitForValue)("@"),s=(0,MP.waitForValue)("@"),u=(0,MP.waitForValue)("@"),c=(0,MP.waitForValue)("@"),l=(0,MP.waitForValue)("@"),O(f={children:{features:E.default},collections:{serviceCatalog:S.default},idAttribute:"url",namespace:"Device",props:{clientMessagingGiphy:"string",customerCompanyName:"string",customerLogoUrl:"string",deviceType:"string",helpUrl:"string",intranetInactivityDuration:"number",intranetInactivityCheckUrl:"string",ecmEnabledForAllUsers:{type:"boolean",default:function(){return!1}},ecmSupportedStorageProviders:{type:"array",default:function(){return[]}},modificationTime:"string",partnerCompanyName:"string",partnerLogoUrl:"string",reportingSiteDesc:"string",reportingSiteUrl:"string",searchEncryptionKeyUrl:"string",services:{default:function(){return{}},type:"object"},serviceHostMap:{default:function(){return{serviceLinks:{},hostCatalog:{}}},type:"object"},showSupportText:"boolean",supportProviderCompanyName:"string",supportProviderLogoUrl:"string",url:"string",userId:"string",webFileShareControl:"string",webSocketUrl:"string",whiteboardFileShareControl:"string"},derived:{registered:{deps:["url"],fn:function(){return Boolean(this.url)}}},session:{logoutTimer:"any",lastUserActivityDate:"number"},determineService:function(e){var t=this.features.developer.get("web-ha-messaging");if(t&&t.value){var r=!0,n=!1,i=void 0;try{for(var o,a=(0,m.default)((0,g.default)(this.serviceHostMap.serviceLinks));!(r=(o=a.next()).done);r=!0){var s=o.value,u=this.serviceHostMap.serviceLinks[s];if(e.startsWith(u))return v.default.resolve(s)}}catch(e){n=!0,i=e}finally{try{!r&&a.return&&a.return()}finally{if(n)throw i}}}else{var c=!0,l=!1,f=void 0;try{for(var d,p=(0,m.default)((0,g.default)(this.services));!(c=(d=p.next()).done);c=!0){var h=d.value,y=this.services[h];if(e.startsWith(y))return v.default.resolve(h.substr(0,h.length-10))}}catch(e){l=!0,f=e}finally{try{!c&&p.return&&p.return()}finally{if(l)throw f}}}return v.default.reject(new Error(e+" does not reflect a known service"))},getServiceUrl:function(e){var t=this,r=this.features.developer.get("web-ha-messaging");return r&&r.value?this._getServiceUrl(this.serviceHostMap.serviceLinks,e).then(function(r){return r||t.getPreDiscoveryServiceUrl(e)}):this._getServiceUrl(this.services,e).then(function(r){return r||t.getPreDiscoveryServiceUrl(e)})},getPreDiscoveryServiceUrl:function(e){return v.default.resolve(this._getServiceUrl(this.config.preDiscoveryServices,e))},getWebSocketUrl:function(){return this.useServiceCatalogUrl(this.webSocketUrl)},useServiceCatalogUrl:function(e){return this.serviceCatalog.inferServiceFromUrl(e).then(function(t){return t.replaceUrlWithCurrentHost(e)})},markUrlFailedAndGetNew:function(e){var t=this;return e?(this.logger.info("device: marking "+e+" as failed"),this.serviceCatalog.markFailedAndCycleUrl(e).then(function(r){return t.spark.internal.metrics.submitClientMetrics("web-ha",{tags:{action:"replace_url",failedUrl:e,newUrl:r}}),r}).catch(function(){return t._resetAllAndRetry(e)})):v.default.reject(new Error("`url` is a required parameter"))},_resetAllAndRetry:function(e){return e?(this.logger.info("device: reset available hosts and retry "+e),this.serviceCatalog.resetAllAndRetry(e)):v.default.reject(new Error("`url` is a required parameter"))},fetchNewUrls:function(e){var t=this;return new v.default(function(r){return t.serviceCatalog.inferServiceFromUrl(e).then(function(e){t.logger.info("device: refresh to "+e.service+" get new urls"),t.refresh(),t.on("serviceCatalogUpdated",function(){return r(e.url)})})})},initialize:function(){for(var e=this,t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];(0,h.default)(MP.SparkPlugin.prototype.initialize,this,r),["developer","entitlement","user"].forEach(function(t){e.features.on("change:"+t,function(t,r,n){e.trigger("change",e,n),e.trigger("change:features",e,e.features,n)})}),this.on("change:serviceHostMap",this._updateServiceCatalog),this.listenToAndRun(this,"change:intranetInactivityCheckUrl",function(){return e._resetLogoutTimer()}),this.listenToAndRun(this,"change:intranetInactivityDuration",function(){return e._resetLogoutTimer()}),this.listenTo(this.spark,"user-activity",function(){e.lastUserActivityDate=Date.now()})},inspect:function(e){return b.default.inspect((0,_.default)(this.serialize(),"features"),{depth:e})},isPreDiscoveryService:function(e){return v.default.resolve(this._isService(this.config.preDiscoveryServices,e))},isPreDiscoveryServiceUrl:function(e){return e?v.default.resolve(this._isServiceUrl(this.config.preDiscoveryServices,e)):v.default.reject(new Error("`uri` is a required parameter"))},isService:function(e){var t=this;if("idbroker"===e)return v.default.resolve(!1);var r=this.features.developer.get("web-ha-messaging");return r&&r.value?this._isService(this.serviceHostMap.serviceLinks,e).then(function(r){return r||t.isPreDiscoveryService(e)}):this._isService(this.services,e).then(function(r){return r||t.isPreDiscoveryService(e)})},isServiceUrl:function(e){if(!e)return v.default.reject(new Error("`uri` is a required parameter"));var t=this.features.developer.get("web-ha-messaging");return t&&t.value?this._isServiceUrl(this.serviceHostMap.serviceLinks,e)||this._isServiceUrlFromCatalog(this.serviceHostMap.hostCatalog,e)?v.default.resolve(!0):v.default.resolve(!1):v.default.resolve(this._isServiceUrl(this.services,e))},isSpecificService:function(e,t){return t===e?v.default.resolve(!0):this.getServiceUrl(e).then(function(e){return t.includes(e)})},_getServiceUrl:function(e,t){if(!t)return v.default.reject(new Error("`service` is a required parameter"));var r=this.features.developer.get("web-ha-messaging");if(r&&r.value){var n=this.serviceCatalog.get(t);if(n)return v.default.resolve(n.url)}return e?v.default.resolve(e[t+"ServiceUrl"]):v.default.reject(new Error("`target` is a required parameter"))},_isService:function(e,t){return this._getServiceUrl(e,t).then(function(e){return Boolean(e)})},_isServiceUrl:function(e,t){var r=this.features.developer.get("web-ha-messaging");if(r&&r.value){var n=!0,i=!1,o=void 0;try{for(var a,s=(0,m.default)((0,g.default)(e));!(n=(a=s.next()).done);n=!0){var u=a.value,c=e[u];if("idbroker"!==u&&t.startsWith(c))return!0}}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}}else{var l=!0,f=!1,d=void 0;try{for(var h,y=(0,m.default)((0,p.default)(e));!(l=(h=y.next()).done);l=!0){var _=h.value;if(_&&t.startsWith(_))return v.default.resolve(!0)}}catch(e){f=!0,d=e}finally{try{!l&&y.return&&y.return()}finally{if(f)throw d}}}return!1},_isServiceUrlFromCatalog:function(e,t){var r=T.default.parse(t).hostname;return!(!r||r.includes("idbroker")||!(0,y.default)(e,function(e){return(0,y.default)(e,function(e){return e.host===r})}))},refresh:function(){var e=this;if(this.logger.info("device: refreshing"),!this.registered)return this.logger.info("device: device not registered, registering"),this.register();var t=(0,_.default)(this.serialize(),"features","mediaClusters");return this.config.ephemeral&&(t.ttl=this.config.ephemeralDeviceTTL),this.request({method:"PUT",uri:this.url,body:t}).then(function(t){return e._processRegistrationSuccess(t)}).catch(function(t){return 404===t.statusCode?(e.logger.info("device: refresh failed with 404, attempting to register new device"),e.clear(),e.register()):v.default.reject(t)})},register:function(){var e=this;if(this.logger.info("device: registering"),this.registered)return this.logger.info("device: device already registered, refreshing"),this.refresh();var t=this.config.defaults;return this.config.ephemeral&&(t.ttl=this.config.ephemeralDeviceTTL),this.request({method:"POST",service:"wdm",resource:"devices",body:t}).then(function(t){return e._processRegistrationSuccess(t)})},unregister:function(){var e=this;return this.logger.info("device: unregistering"),this.url?this.request({uri:this.url,method:"DELETE"}).then(function(){return e.clear()}):(this.logger.warn("device: not registered"),v.default.resolve())},clear:function(){clearTimeout(this.refreshTimer);for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];(0,h.default)(MP.SparkPlugin.prototype.clear,this,t)},_processRegistrationSuccess:function(e){var t=this;if(this.logger.info("device: received registration payload"),this.set(e.body),this.config.ephemeral){this.logger.info("device: enqueing device refresh");var r=1e3*(this.config.ephemeralDeviceTTL/2+60);this.refreshTimer=(0,Qw.safeSetTimeout)(function(){return t.refresh()},r)}},_updateServiceCatalog:function(e){var t=this,r=this.features.developer.get("web-ha-messaging");r&&r.value&&(e.serviceHostMap&&e.serviceHostMap.serviceLinks&&e.serviceHostMap.hostCatalog?((0,g.default)(e.serviceHostMap.serviceLinks).forEach(function(r){var n=T.default.parse(e.serviceHostMap.serviceLinks[r]).hostname,i=e.serviceHostMap.hostCatalog[n];t.serviceCatalog.set({service:r,defaultUrl:e.serviceHostMap.serviceLinks[r],availableHosts:i||[]},{remove:!1})}),this.trigger("serviceCatalogUpdated")):this.refresh())},_resetLogoutTimer:function(){var e=this;if(clearTimeout(this.logoutTimer),this.off("change:lastUserActivityDate"),this.unset("logoutTimer"),this.config.enableInactivityEnforcement&&this.intranetInactivityCheckUrl&&this.intranetInactivityDuration){this.on("change:lastUserActivityDate",function(){return e._resetLogoutTimer()});var t=(0,Qw.safeSetTimeout)(function(){e.spark.request({headers:{"cisco-no-http-redirect":null,"spark-user-agent":null,trackingid:null},method:"GET",uri:e.intranetInactivityCheckUrl}).catch(function(){return e.logger.info("device: did not reach internal ping endpoint; logging out after inactivity on a public network"),e.spark.logout()}).catch(function(t){e.logger.warn("device: logout failed",t)})},1e3*this.intranetInactivityDuration);this.logoutTimer=t}},version:"1.50.6"},"determineService",[r],(0,d.default)(f,"determineService"),f),O(f,"getServiceUrl",[n],(0,d.default)(f,"getServiceUrl"),f),O(f,"initialize",[i],(0,d.default)(f,"initialize"),f),O(f,"isService",[o],(0,d.default)(f,"isService"),f),O(f,"isServiceUrl",[a],(0,d.default)(f,"isServiceUrl"),f),O(f,"isSpecificService",[s],(0,d.default)(f,"isSpecificService"),f),O(f,"refresh",[Yw.oneFlight,u],(0,d.default)(f,"refresh"),f),O(f,"register",[Yw.oneFlight,c],(0,d.default)(f,"register"),f),O(f,"unregister",[Yw.oneFlight,l],(0,d.default)(f,"unregister"),f),f));t.default=k});t(oC);var aC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return(e=oC,e&&e.__esModule?e:{default:e}).default;var e}})});t(aC);var sC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(_f),n=u(rT),i=u(By),o=u(Yy),a=u(nT),s=u(iT);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"onResponseError",value:function(e,t){return 451===t.statusCode&&(this.spark.internal.device.clear(),this.spark.credentials.clear(),this.spark.logger.info("Received `HTTP 451 Unavailable For Legal Reasons`, discarding credentials and device registration")),r.default.reject(t)}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(NI.Interceptor);t.default=c});t(sC);var uC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(cc),n=l(wf),i=l(_f),o=l(rT),a=l(By),s=l(Yy),u=l(nT),c=l(iT);function l(e){return e&&e.__esModule?e:{default:e}}var f=/(?:^\/)|(?:\/$)/,d=function(e){function t(){return(0,a.default)(this,t),(0,u.default)(this,(t.__proto__||(0,o.default)(t)).apply(this,arguments))}return(0,c.default)(t,e),(0,s.default)(t,[{key:"onRequest",value:function(e){return e.uri?e:(this.checkOptions(e),this.normalizeOptions(e),this.spark.internal.device.getServiceUrl(e.service).then(function(t){return t?(e.resource&&(t=t.replace(f,"")+"/"+e.resource.replace(f,"")),e.uri=t,e):i.default.reject(new Error("`"+e.service+"` is not a known service"))}))}},{key:"checkOptions",value:function(e){if(!e.api&&!e.service)throw new Error("A `service` or `uri` parameter is required");if(!e.resource)throw new Error("A `resource` parameter is required")}},{key:"normalizeOptions",value:function(e){e.service||((0,n.default)(e,{service:e.service||e.api}),(0,r.default)(e,"api"))}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(NI.Interceptor);t.default=d});t(uC);var cC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(_f),n=c(rT),i=c(By),o=c(Yy),a=c(nT),s=c(iT),u=c(WI);function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"onRequest",value:function(e){var t=this;return!this.spark.internal.device.url||e.headers&&"cisco-device-url"in e.headers&&!e.headers["cisco-device-url"]?r.default.resolve(e):r.default.resolve(e.service||this.spark.internal.device.determineService(e.uri)).then(function(r){return r&&"oauth"!==r&&"saml"!==r&&"idbroker"!==r&&(0,u.default)(e,"headers['cisco-device-url']",t.spark.internal.device.url),e}).catch(function(t){if(t.message.match(/does not reflect a known service/))return e;throw t})}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(NI.Interceptor);t.default=l});t(cC);var lC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(_f),n=u(rT),i=u(By),o=u(Yy),a=u(nT),s=u(iT);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"onResponseError",value:function(e,t){if(t instanceof MP.SparkHttpError.InternalServerError&&e.uri){var n=this.spark.internal.device.features.developer.get("web-ha-messaging");if(n&&n.value)return this.spark.internal.metrics.submitClientMetrics("web-ha",{fields:{success:!1},tags:{action:"failed",error:t.message,url:e.uri}}),this.spark.internal.device.markUrlFailedAndGetNew(e.uri).then(function(){return r.default.reject(t)})}return r.default.reject(t)}}],[{key:"create",value:function(){return new t({spark:this})}}]),t}(NI.Interceptor);t.default=c});t(lC);var fC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={device:{preDiscoveryServices:{wdmServiceUrl:"https://wdm-a.wbx2.com/wdm/api/v1",hydraServiceUrl:"https://api.ciscospark.com/v1",wdm:"https://wdm-a.wbx2.com/wdm/api/v1",hydra:"https://api.ciscospark.com/v1"},defaults:{name:ku.title||Yw.inBrowser&&"browser",deviceType:"WEB",model:"web-js-sdk",localizedModel:"webex-js-sdk",systemName:"WEBEX_JS_SDK",systemVersion:"1.0.0"},enableInactivityEnforcement:!1,ephemeral:!1,ephemeralDeviceTTL:1800}}});t(fC);var dC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.config=t.ServerErrorInterceptor=t.DeviceUrlInterceptor=t.UrlInterceptor=t.EmbargoInterceptor=t.ServiceModel=t.ServiceCollection=t.FeatureModel=t.FeatureCollection=t.FeaturesModel=t.Device=t.default=void 0,Object.defineProperty(t,"default",{enumerable:!0,get:function(){return u(aC).default}}),Object.defineProperty(t,"Device",{enumerable:!0,get:function(){return u(aC).default}}),Object.defineProperty(t,"FeaturesModel",{enumerable:!0,get:function(){return u(eC).default}}),Object.defineProperty(t,"FeatureCollection",{enumerable:!0,get:function(){return u(ZP).default}}),Object.defineProperty(t,"FeatureModel",{enumerable:!0,get:function(){return u(QP).default}}),Object.defineProperty(t,"ServiceCollection",{enumerable:!0,get:function(){return u(iC).default}}),Object.defineProperty(t,"ServiceModel",{enumerable:!0,get:function(){return u(nC).default}}),Object.defineProperty(t,"EmbargoInterceptor",{enumerable:!0,get:function(){return u(sC).default}}),Object.defineProperty(t,"UrlInterceptor",{enumerable:!0,get:function(){return u(uC).default}}),Object.defineProperty(t,"DeviceUrlInterceptor",{enumerable:!0,get:function(){return u(cC).default}}),Object.defineProperty(t,"ServerErrorInterceptor",{enumerable:!0,get:function(){return u(lC).default}}),Object.defineProperty(t,"config",{enumerable:!0,get:function(){return u(fC).default}});var r=u(aC),n=u(fC),i=u(uC),o=u(cC),a=u(sC),s=u(lC);function u(e){return e&&e.__esModule?e:{default:e}}(0,MP.registerInternalPlugin)("device",r.default,{interceptors:{UrlInterceptor:i.default.create,DeviceUrlInterceptor:o.default.create,EmbargoInterceptor:a.default.create,ServerErrorInterceptor:s.default.create},config:n.default,onBeforeLogout:function(){return this.unregister()}})});t(dC);dC.config,dC.ServerErrorInterceptor,dC.DeviceUrlInterceptor,dC.UrlInterceptor,dC.EmbargoInterceptor,dC.ServiceModel,dC.ServiceCollection,dC.FeatureModel,dC.FeatureCollection,dC.FeaturesModel,dC.Device;var pC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.config=t.default=void 0,Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i(NP).default}}),Object.defineProperty(t,"config",{enumerable:!0,get:function(){return i(DP).default}});var r=i(NP),n=i(DP);function i(e){return e&&e.__esModule?e:{default:e}}(0,MP.registerPlugin)("authorization",r.default,{config:n.default,proxies:["isAuthorizing","isAuthenticating"]})});t(pC);pC.config;t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return(e=pC,e&&e.__esModule?e:{default:e}).default;var e}}),Object.defineProperty(t,"config",{enumerable:!0,get:function(){return pC.config}})}));var hC=xR(!0);tc(tc.S,"Object",{entries:function(e){return hC(e)}});var vC=Yu.Object.entries,gC=r(function(e){e.exports={default:vC,__esModule:!0}});t(gC);var mC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.levels=void 0;var r=d(zk),n=d(cc),i=d(gC),o=d(mR),a=d(yR),s=d(Xw),u=d(hO),c=d(ud),l=d(vp),f=(d(fk),d(gg));function d(e){return e&&e.__esModule?e:{default:e}}var p={silent:0,error:1,warn:2,log:3,info:4,debug:5,trace:6},h=t.levels=(0,s.default)(p).filter(function(e){return"silent"!==e}),v={error:["log"],warn:["error","log"],info:["log"],debug:["info","log"],trace:["debug","info","log"]},g=/[Aa]uthorization/;function m(e){if((0,l.default)(e))return e.map(m);if(!(0,c.default)(e))return(0,u.default)(e)&&Yw.patterns.email.test(e)?"-- REDACTED --":e;var t=!0,r=!1,s=void 0;try{for(var f,d=(0,o.default)((0,i.default)(e));!(t=(f=d.next()).done);t=!0){var p=f.value,h=(0,a.default)(p,2),v=h[0],y=h[1];g.test(v)?(0,n.default)(e,v):e[v]=m(y)}}catch(e){r=!0,s=e}finally{try{!t&&d.return&&d.return()}finally{if(r)throw s}}return e}var y=MP.SparkPlugin.extend({namespace:"Logger",derived:{level:{cache:!1,fn:function(){return this.getCurrentLevel()}}},session:{buffer:{type:"array",default:function(){return[]}}},filter:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.map(function(e){return e instanceof Error?e:m(e=(0,f.default)(e))})},shouldPrint:function(e){return p[e]<=p[this.getCurrentLevel()]},shouldBuffer:function(e){return p[e]<=p.info},getCurrentLevel:function(){if(this.config.level)return this.config.level;if(h.includes(ku.env.CISCOSPARK_LOG_LEVEL))return ku.env.CISCOSPARK_LOG_LEVEL;var e=this.spark.internal.device&&this.spark.internal.device.features.developer.get("log-level");return e&&h.includes(e)?e:"error"},version:"1.50.6"});h.forEach(function(e){var t=v[e],n=e;if(t)for(t=t.slice();!console[n];)n=t.pop();y.prototype[e]=function(){try{var t=this.shouldPrint(e),i=this.shouldBuffer(e);if(!i&&!t)return;var o=this.filter.apply(this,arguments),a=o.map(function(e){return e instanceof MP.SparkHttpError?e.toString():e});if(t){var s,u=Yw.inBrowser?a:o;(s=console)[n].apply(s,(0,r.default)(u))}i&&(a.unshift(Date.now()),this.buffer.push(a),this.buffer.length>this.config.historyLength&&this.buffer.shift())}catch(t){console.warn("failed to execute Logger#"+e,t)}}}),t.default=y});t(mC);mC.levels;var yC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={logger:{level:ku.env.LOGGER_LEVEL,historyLength:1e3}}});t(yC);var _C=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.levels=t.default=void 0,Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i(mC).default}}),Object.defineProperty(t,"levels",{enumerable:!0,get:function(){return mC.levels}});var r=i(mC),n=i(yC);function i(e){return e&&e.__esModule?e:{default:e}}(0,MP.registerPlugin)("logger",r.default,{config:n.default,replace:!0})});t(_C);_C.levels;var bC=r(function(t){var r,n;r=e,n=function(){var e=!0;function t(t){function r(e){var r=t.match(e);return r&&r.length>1&&r[1]||""}function n(e){var r=t.match(e);return r&&r.length>1&&r[2]||""}var i,a=r(/(ipod|iphone|ipad)/i).toLowerCase(),s=!/like android/i.test(t)&&/android/i.test(t),u=/nexus\s*[0-6]\s*/i.test(t),c=!u&&/nexus\s*[0-9]+/i.test(t),l=/CrOS/.test(t),f=/silk/i.test(t),d=/sailfish/i.test(t),p=/tizen/i.test(t),h=/(web|hpw)(o|0)s/i.test(t),v=/windows phone/i.test(t),g=(/SamsungBrowser/i.test(t),!v&&/windows/i.test(t)),m=!a&&!f&&/macintosh/i.test(t),y=!s&&!d&&!p&&!h&&/linux/i.test(t),_=n(/edg([ea]|ios)\/(\d+(\.\d+)?)/i),b=r(/version\/(\d+(\.\d+)?)/i),E=/tablet/i.test(t)&&!/tablet pc/i.test(t),S=!E&&/[^-]mobi/i.test(t),T=/xbox/i.test(t);/opera/i.test(t)?i={name:"Opera",opera:e,version:b||r(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr\/|opios/i.test(t)?i={name:"Opera",opera:e,version:r(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||b}:/SamsungBrowser/i.test(t)?i={name:"Samsung Internet for Android",samsungBrowser:e,version:b||r(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/Whale/i.test(t)?i={name:"NAVER Whale browser",whale:e,version:r(/(?:whale)[\s\/](\d+(?:\.\d+)+)/i)}:/MZBrowser/i.test(t)?i={name:"MZ Browser",mzbrowser:e,version:r(/(?:MZBrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/coast/i.test(t)?i={name:"Opera Coast",coast:e,version:b||r(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}:/focus/i.test(t)?i={name:"Focus",focus:e,version:r(/(?:focus)[\s\/](\d+(?:\.\d+)+)/i)}:/yabrowser/i.test(t)?i={name:"Yandex Browser",yandexbrowser:e,version:b||r(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(t)?i={name:"UC Browser",ucbrowser:e,version:r(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/mxios/i.test(t)?i={name:"Maxthon",maxthon:e,version:r(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}:/epiphany/i.test(t)?i={name:"Epiphany",epiphany:e,version:r(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(t)?i={name:"Puffin",puffin:e,version:r(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(t)?i={name:"Sleipnir",sleipnir:e,version:r(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}:/k-meleon/i.test(t)?i={name:"K-Meleon",kMeleon:e,version:r(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:v?(i={name:"Windows Phone",osname:"Windows Phone",windowsphone:e},_?(i.msedge=e,i.version=_):(i.msie=e,i.version=r(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(t)?i={name:"Internet Explorer",msie:e,version:r(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:l?i={name:"Chrome",osname:"Chrome OS",chromeos:e,chromeBook:e,chrome:e,version:r(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/edg([ea]|ios)/i.test(t)?i={name:"Microsoft Edge",msedge:e,version:_}:/vivaldi/i.test(t)?i={name:"Vivaldi",vivaldi:e,version:r(/vivaldi\/(\d+(\.\d+)?)/i)||b}:d?i={name:"Sailfish",osname:"Sailfish OS",sailfish:e,version:r(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(t)?i={name:"SeaMonkey",seamonkey:e,version:r(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(t)?(i={name:"Firefox",firefox:e,version:r(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(t)&&(i.firefoxos=e,i.osname="Firefox OS")):f?i={name:"Amazon Silk",silk:e,version:r(/silk\/(\d+(\.\d+)?)/i)}:/phantom/i.test(t)?i={name:"PhantomJS",phantom:e,version:r(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(t)?i={name:"SlimerJS",slimer:e,version:r(/slimerjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(t)||/rim\stablet/i.test(t)?i={name:"BlackBerry",osname:"BlackBerry OS",blackberry:e,version:b||r(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:h?(i={name:"WebOS",osname:"WebOS",webos:e,version:b||r(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(t)&&(i.touchpad=e)):/bada/i.test(t)?i={name:"Bada",osname:"Bada",bada:e,version:r(/dolfin\/(\d+(\.\d+)?)/i)}:p?i={name:"Tizen",osname:"Tizen",tizen:e,version:r(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||b}:/qupzilla/i.test(t)?i={name:"QupZilla",qupzilla:e,version:r(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||b}:/chromium/i.test(t)?i={name:"Chromium",chromium:e,version:r(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||b}:/chrome|crios|crmo/i.test(t)?i={name:"Chrome",chrome:e,version:r(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:s?i={name:"Android",version:b}:/safari|applewebkit/i.test(t)?(i={name:"Safari",safari:e},b&&(i.version=b)):a?(i={name:"iphone"==a?"iPhone":"ipad"==a?"iPad":"iPod"},b&&(i.version=b)):i=/googlebot/i.test(t)?{name:"Googlebot",googlebot:e,version:r(/googlebot\/(\d+(\.\d+))/i)||b}:{name:r(/^(.*)\/(.*) /),version:n(/^(.*)\/(.*) /)},!i.msedge&&/(apple)?webkit/i.test(t)?(/(apple)?webkit\/537\.36/i.test(t)?(i.name=i.name||"Blink",i.blink=e):(i.name=i.name||"Webkit",i.webkit=e),!i.version&&b&&(i.version=b)):!i.opera&&/gecko\//i.test(t)&&(i.name=i.name||"Gecko",i.gecko=e,i.version=i.version||r(/gecko\/(\d+(\.\d+)?)/i)),i.windowsphone||!s&&!i.silk?!i.windowsphone&&a?(i[a]=e,i.ios=e,i.osname="iOS"):m?(i.mac=e,i.osname="macOS"):T?(i.xbox=e,i.osname="Xbox"):g?(i.windows=e,i.osname="Windows"):y&&(i.linux=e,i.osname="Linux"):(i.android=e,i.osname="Android");var w="";i.windows?w=function(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}(r(/Windows ((NT|XP)( \d\d?.\d)?)/i)):i.windowsphone?w=r(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):i.mac?w=(w=r(/Mac OS X (\d+([_\.\s]\d+)*)/i)).replace(/[_\s]/g,"."):a?w=(w=r(/os (\d+([_\s]\d+)*) like mac os x/i)).replace(/[_\s]/g,"."):s?w=r(/android[ \/-](\d+(\.\d+)*)/i):i.webos?w=r(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):i.blackberry?w=r(/rim\stablet\sos\s(\d+(\.\d+)*)/i):i.bada?w=r(/bada\/(\d+(\.\d+)*)/i):i.tizen&&(w=r(/tizen[\/\s](\d+(\.\d+)*)/i)),w&&(i.osversion=w);var O=!i.windows&&w.split(".")[0];return E||c||"ipad"==a||s&&(3==O||O>=4&&!S)||i.silk?i.tablet=e:(S||"iphone"==a||"ipod"==a||s||u||i.blackberry||i.webos||i.bada)&&(i.mobile=e),i.msedge||i.msie&&i.version>=10||i.yandexbrowser&&i.version>=15||i.vivaldi&&i.version>=1||i.chrome&&i.version>=20||i.samsungBrowser&&i.version>=4||i.whale&&1===o([i.version,"1.0"])||i.mzbrowser&&1===o([i.version,"6.0"])||i.focus&&1===o([i.version,"1.0"])||i.firefox&&i.version>=20||i.safari&&i.version>=6||i.opera&&i.version>=10||i.ios&&i.osversion&&i.osversion.split(".")[0]>=6||i.blackberry&&i.version>=10.1||i.chromium&&i.version>=20?i.a=e:i.msie&&i.version<10||i.chrome&&i.version<20||i.firefox&&i.version<20||i.safari&&i.version<6||i.opera&&i.version<10||i.ios&&i.osversion&&i.osversion.split(".")[0]<6||i.chromium&&i.version<20?i.c=e:i.x=e,i}var r=t("undefined"!=typeof navigator&&navigator.userAgent||"");function n(e){return e.split(".").length}function i(e,t){var r,n=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(r=0;r<e.length;r++)n.push(t(e[r]));return n}function o(e){for(var t=Math.max(n(e[0]),n(e[1])),r=i(e,function(e){var r=t-n(e);return i((e+=new Array(r+1).join(".0")).split("."),function(e){return new Array(20-e.length).join("0")+e}).reverse()});--t>=0;){if(r[0][t]>r[1][t])return 1;if(r[0][t]!==r[1][t])return-1;if(0===t)return 0}}function a(e,n,i){var a=r;"string"==typeof n&&(i=n,n=void 0),void 0===n&&(n=!1),i&&(a=t(i));var s=""+a.version;for(var u in e)if(e.hasOwnProperty(u)&&a[u]){if("string"!=typeof e[u])throw new Error("Browser version in the minVersion map should be a string: "+u+": "+String(e));return o([s,e[u]])<0}return n}return r.test=function(e){for(var t=0;t<e.length;++t){var n=e[t];if("string"==typeof n&&n in r)return!0}return!1},r.isUnsupportedBrowser=a,r.compareVersions=o,r.check=function(e,t,r){return!a(e,t,r)},r._detect=t,r.detect=t,r},t.exports?t.exports=n():r.bowser=n()}),EC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,r){void 0===r&&(r={}),this.execute=e,this.applicator=t,this.options=r}return Object.defineProperty(e.prototype,"bound",{get:function(){return null!=this.options.bound&&this.options.bound},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"setter",{get:function(){return null!=this.options.setter&&this.options.setter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getter",{get:function(){return null!=this.options.getter&&this.options.getter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"property",{get:function(){return null!=this.options.property&&this.options.property},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"method",{get:function(){return null==this.options.method||this.options.method},enumerable:!0,configurable:!0}),e}();t.DecoratorConfig=r});t(EC);EC.DecoratorConfig;var SC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.log=function(e){return void 0===e&&(e=""),"lodash-decorators -> "+e}});t(SC);SC.log;var TC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.resolveFunction=function(e,t,r,n){if(void 0===n&&(n=!0),hd(e))return e;if(hO(e)){if(t&&hd(t[e]))return t[e];if(r&&hd(r[e]))return r[e]}if(n)throw new ReferenceError(SC.log("Can not resolve method "+e+" on any target Objects"))}});t(TC);TC.resolveFunction;var wC=function(e){return void 0===e},OC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._weakMap=new WeakMap}return e.prototype.set=function(e,t){for(var r=this._weakMap,n=0,i=e.length-1;n<i;n++){var o=e[n],a=r.get(o);a||(a=new Map,r.set(o,a)),r=a}r.set(e[e.length-1],t)},e.prototype.get=function(e){for(var t=this._weakMap,r=0,n=e.length;r<n&&(t=t.get(e[r]),!wC(t));r++);return t},e.prototype.has=function(e){return!wC(this.get(e))},e}();t.CompositeKeyWeakMap=r});t(OC);OC.CompositeKeyWeakMap;var kC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.returnAtIndex=function(e,t){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return e.call.apply(e,[this].concat(r)),r[t]}}});t(kC);kC.returnAtIndex;var RC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.copyMetadata=function(e,t){return dO(t,function(t,r){return e[r]=t}),e}});t(RC);RC.copyMetadata;var AC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.bind=function(e,t){return RC.copyMetadata(e.bind(t),e)}});t(AC);AC.bind;var IC=200;var PC=function(e,t,r,n){var i=-1,o=Qb,a=!0,s=e.length,u=[],c=t.length;if(!s)return u;r&&(t=Mf(t,Op(r))),n?(o=pk,a=!1):t.length>=IC&&(o=IO,a=!1,t=new RO(t));e:for(;++i<s;){var l=e[i],f=null==r?l:r(l);if(l=n||0!==l?l:0,a&&f==f){for(var d=c;d--;)if(t[d]===f)continue e;u.push(l)}else o(t,f,n)||u.push(l)}return u},CC=vb(function(e,t){return mk(e)?PC(e,t):[]}),MC="[object DOMException]",NC="[object Error]";var DC=function(e){if(!up(e))return!1;var t=sd(e);return t==NC||t==MC||"string"==typeof e.message&&"string"==typeof e.name&&!Wv(e)},jC=vb(function(e,t){try{return Kv(e,void 0,t)}catch(e){return DC(e)?e:new Error(e)}}),xC=r(function(e,t){function r(e,t,r){var n=Object.getOwnPropertyDescriptor(e,r);if(!n||n.configurable){var i=Object.getOwnPropertyDescriptor(t,r);ud(i)?Object.defineProperty(e,r,i):e[r]=t[r]}}Object.defineProperty(t,"__esModule",{value:!0}),t.assignAll=function(e,t,n){void 0===n&&(n=[]);for(var i=0,o=CC.apply(void 0,[Object.getOwnPropertyNames(t)].concat(n));i<o.length;i++){var a=o[i];jC(r,e,t,a)}return e},t.assignProperty=r});t(xC);xC.assignAll,xC.assignProperty;var LC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=["length","name","arguments","called","prototype"];t.wrapConstructor=function(e,t){function n(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return t.call.apply(t,[this,e].concat(r))}return n.prototype=e.prototype,Object.defineProperty(n,"name",{configurable:!0,enumerable:!1,value:e.name,writable:!1}),xC.assignAll(n,e,r)}});t(LC);LC.wrapConstructor;var UC=r(function(e,t){function r(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),r(SC),r(TC),r(OC),r(kC),r(RC),r(AC),r(LC),r(xC)});t(UC);var FC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.InstanceChainMap=new UC.CompositeKeyWeakMap});t(FC);FC.InstanceChainMap;var GC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.createDecorator=function(e){var t=this,r=e.applicator;return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return function(i,o,a){var s=t._resolveDescriptor(i,o,a),u=s.value,c=s.get,l=s.set;return FC.InstanceChainMap.has([i,o])||(hd(u)?s.value=UC.copyMetadata(r.apply({config:e,target:i,value:u,args:n}),u):hd(c)&&e.getter?s.get=UC.copyMetadata(r.apply({config:e,target:i,value:c,args:n}),c):hd(l)&&e.setter&&(s.set=UC.copyMetadata(r.apply({config:e,target:i,value:l,args:n}),c))),s}}},e.prototype.createInstanceDecorator=function(e){var t=this,r=e.applicator,n=e.bound;return function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return function(o,a,s){var u=t._resolveDescriptor(o,a,s),c=u.value,l=u.writable,f=u.enumerable,d=u.configurable,p=u.get,h=u.set,v=!FC.InstanceChainMap.has([o,a]),g=FC.InstanceChainMap.get([o,a])||{fns:[],properties:[]},m=v&&hd(p),y=v&&hd(h),_=v&&hd(c),b=v&&!m&&!y&&!_;if(g.properties.push(a),g.fns.push(function(a,s,u){return t._isApplicable(u,e)?(n&&(a=UC.bind(a,s)),UC.copyMetadata(r.apply({args:i,target:o,instance:s,value:a,config:e}),a)):a}),FC.InstanceChainMap.set([o,a],g),!v)return u;g.isSetter=y,g.isGetter=m,g.isMethod=_,g.isProperty=b;var E=function(e,t,r){return g.fns.reduce(function(e,n){return n(e,r,t)},e)},S=function(e){var t=p||void 0,r=h||void 0;if(m||y)m&&(t=E(p,{value:p,getter:!0},e)),y&&(r=E(h,{value:h,setter:!0},e)),Object.defineProperty(e,a,{enumerable:f,configurable:d,get:t,set:r});else if(_||b){var n=E(c,_?{value:c,method:!0}:{value:c,property:!0},e);Object.defineProperty(e,a,{writable:l,enumerable:f,configurable:d,value:n})}};return(_||b)&&(delete u.value,delete u.writable),u.get=function(){S(this);var e=Object.getOwnPropertyDescriptor(this,a);return e.get?e.get.call(this):e.value},u.set=function(e){S(this);var t=Object.getOwnPropertyDescriptor(this,a);t.set?t.set.call(this,e):(b||_)&&(this[a]=e)},u}}},e.prototype._isApplicable=function(e,t){return!Boolean(e.getter&&!t.getter||e.setter&&!t.setter||e.method&&!t.method||e.property&&!t.property)},e.prototype._resolveDescriptor=function(e,t,r){return r||(Object.getOwnPropertyDescriptor(e,t)||{})},e}();t.InternalDecoratorFactory=r,t.DecoratorFactory=new r});t(GC);GC.InternalDecoratorFactory,GC.DecoratorFactory;var qC=r(function(e,t){function r(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),r(EC),r(GC),r(FC)});t(qC);var VC="Expected a function";var BC=function(e,t){if("function"!=typeof t)throw new TypeError(VC);return e=BE(e),function(){if(--e<1)return t.apply(this,arguments)}},zC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(){}}();t.Applicator=r});t(zC);zC.Applicator;var WC=function(e,t){return(WC=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};var HC=function(){return(HC=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function YC(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function $C(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}function XC(e){return this instanceof XC?(this.v=e,this):new XC(e)}var JC=Object.freeze({__extends:function(e,t){function r(){this.constructor=e}WC(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},get __assign(){return HC},__rest:function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&(r[n[i]]=e[n[i]])}return r},__decorate:function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},__param:function(e,t){return function(r,n){t(r,n,e)}},__metadata:function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter:function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(a,s)}u((n=n.apply(e,t||[])).next())})},__generator:function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},__exportStar:function(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])},__values:YC,__read:$C,__spread:function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat($C(arguments[t]));return e},__await:XC,__asyncGenerator:function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){i[e]&&(n[e]=function(t){return new Promise(function(r,n){o.push([e,t,r,n])>1||s(e,t)})})}function s(e,t){try{(r=i[e](t)).value instanceof XC?Promise.resolve(r.value.v).then(u,c):l(o[0][2],r)}catch(e){l(o[0][3],e)}var r}function u(e){s("next",e)}function c(e){s("throw",e)}function l(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}},__asyncDelegator:function(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:XC(e[n](t)),done:"return"===n}:i?i(t):t}:i}},__asyncValues:function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=YC(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){!function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)}(n,i,(t=e[r](t)).done,t.value)})}}},__makeTemplateObject:function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},__importStar:function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},__importDefault:function(e){return e&&e.__esModule?e:{default:e}}}),KC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){void 0===t&&(t={});var r=e.call(this)||this;return r._config=t,r}return JC.__extends(t,e),Object.defineProperty(t.prototype,"post",{get:function(){return!0===this._config.post},enumerable:!0,configurable:!0}),t.prototype.apply=function(e){var t=e.config.execute,r=e.value,n=void 0===r?tg:r,i=e.args,o=e.target,a=this;return function(){for(var e=this,r=[],s=0;s<arguments.length;s++)r[s]=arguments[s];var u=i.map(function(t){return UC.resolveFunction(t,e,o)}).slice();return a.post?u.push(n):u.unshift(n),t.apply(void 0,u).apply(this,r)}},t}(zC.Applicator);t.ComposeApplicator=r});t(KC);KC.ComposeApplicator;var QC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return JC.__extends(t,e),t.prototype.apply=function(e){var t=e.args,r=e.target,n=e.config.execute;return function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return n.apply(void 0,[UC.resolveFunction(t[0],this,r)].concat(t.slice(1))).apply(this,e)}},t}(zC.Applicator);t.PartialApplicator=r});t(QC);QC.PartialApplicator;var ZC=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return JC.__extends(t,e),t.prototype.apply=function(e){var t=e.config.execute,r=e.value,n=e.args;return eS.apply(void 0,[t,r].concat(n))},t}(zC.Applicator);t.PartialedApplicator=r});t(ZC);ZC.PartialedApplicator;var eM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return JC.__extends(t,e),t.prototype.apply=function(e){var t=e.args,r=e.target,n=e.value,i=e.config.execute;return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var a=n,s=0;return hd(a)||(a=UC.resolveFunction(t[0],this,r),s=1),i.apply(void 0,[a].concat(t.slice(s))).apply(this,e)}},t}(zC.Applicator);t.PartialValueApplicator=r});t(eM);eM.PartialValueApplicator;var tM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return JC.__extends(t,e),t.prototype.apply=function(e){var t=e.config,r=t.execute,n=(t.bound,e.args),i=e.value;return r.apply(void 0,n.concat([i]))},t}(zC.Applicator);t.PostValueApplicator=r});t(tM);tM.PostValueApplicator;var rM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return JC.__extends(t,e),t.prototype.apply=function(e){var t=e.value,r=e.config.execute,n=e.args;return r.apply(void 0,[t].concat(n))},t}(zC.Applicator);t.PreValueApplicator=r});t(rM);rM.PreValueApplicator;var nM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return JC.__extends(t,e),t.prototype.apply=function(e){var t=e.args,r=e.config.execute,n=e.target,i=e.value;return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return r(UC.resolveFunction(t[0],this,n),i).apply(this,e)}},t}(zC.Applicator);t.WrapApplicator=r});t(nM);nM.WrapApplicator;var iM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return JC.__extends(t,e),t.prototype.apply=function(e){var t=e.value,r=e.config.execute,n=e.args,i=e.instance;e.target;return i?r.apply(void 0,[t,i].concat(n)):t},t}(zC.Applicator);t.BindApplicator=r});t(iM);iM.BindApplicator;var oM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return JC.__extends(t,e),t.prototype.apply=function(e){var t=e.args,r=(e.target,e.config.execute),n=e.value;return function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return r.apply(void 0,[n.bind(this)].concat(e,t))}},t}(zC.Applicator);t.InvokeApplicator=r});t(oM);oM.InvokeApplicator;var aM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return JC.__extends(t,e),t.prototype.apply=function(e){var t=e.value,r=e.instance,n=e.config.execute,i=e.args,o=e.target,a=UC.resolveFunction(hd(i[0])?i[0]:ud(i[0])?i[0].resolver:i[0],r,o,!1);a&&r&&(a=a.bind(r));var s=a?n(t,a):n(t);if(ud(i[0])){var u=i[0],c=u.cache,l=u.type;c?s.cache=c:hd(l)&&(s.cache=new l)}return s},t}(zC.Applicator);t.MemoizeApplicator=r});t(aM);aM.MemoizeApplicator;var sM=r(function(e,t){function r(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),r(zC),r(KC),r(QC),r(ZC),r(eM),r(tM),r(rM),r(nM),r(iM),r(oM),r(aM)});t(sM);var uM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createInstanceDecorator(new qC.DecoratorConfig(BC,new sM.PostValueApplicator,{setter:!0}));function n(e){return r(e)}t.After=n,t.after=n,t.default=r});t(uM);uM.After,uM.after;var cM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createDecorator(new qC.DecoratorConfig(BC,new sM.PostValueApplicator,{setter:!0}));function n(e){return r(e)}t.AfterAll=n,t.afterAll=n,t.default=r});t(cM);cM.AfterAll,cM.afterAll;var lM=128;var fM=function(e,t,r){return t=r?void 0:t,t=e&&null==t?e.length:t,QE(e,lM,void 0,void 0,void 0,void 0,t)},dM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createDecorator(new qC.DecoratorConfig(fM,new sM.PreValueApplicator));function n(e){return r(e)}t.Ary=n,t.ary=n,t.default=r});t(dM);dM.Ary,dM.ary;var pM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createDecorator(new qC.DecoratorConfig(function(e){return eS(jC,e)},new sM.PreValueApplicator));function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e)}t.Attempt=n,t.attempt=n,t.default=r});t(pM);pM.Attempt,pM.attempt;var hM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createInstanceDecorator(new qC.DecoratorConfig(bk,new sM.PostValueApplicator,{setter:!0}));function n(e){return r(e)}t.Before=n,t.before=n,t.default=r});t(hM);hM.Before,hM.before;var vM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createDecorator(new qC.DecoratorConfig(bk,new sM.PostValueApplicator,{setter:!0}));function n(e){return r(e)}t.BeforeAll=n,t.beforeAll=n,t.default=r});t(vM);vM.BeforeAll,vM.beforeAll;var gM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createInstanceDecorator(new qC.DecoratorConfig(UI,new sM.BindApplicator));function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e)}t.Bind=n,t.bind=n,t.default=r});t(gM);gM.Bind,gM.bind;var mM=r(function(e,t){function r(e){return void 0===e&&(e=[]),function(t){return UC.wrapConstructor(t,function(r){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];!function(e,t,r){void 0===r&&(r=[]);var n=e.prototype;for(;n&&n!==Object.prototype;){for(var i=0,o=Object.getOwnPropertyNames(n);i<o.length;i++){var a=o[i],s=!r.length||-1!==r.indexOf(a),u=Object.getOwnPropertyDescriptor(n,a);if(s&&"constructor"!==a&&!t.hasOwnProperty(a)){if(u.get){var c=qC.InstanceChainMap.get([n,a]);if(!c||!c.isMethod)continue}var l=t[a];hd(l)&&Object.defineProperty(t,a,{configurable:!0,enumerable:u.enumerable,value:UC.copyMetadata(l.bind(t),l),writable:u.writable})}}n=Object.getPrototypeOf(n)}}(t,this,e),r.apply(this,n)})}}Object.defineProperty(t,"__esModule",{value:!0}),t.BindAll=r,t.bindAll=r,t.default=r});t(mM);mM.BindAll,mM.bindAll;var yM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createInstanceDecorator(new qC.DecoratorConfig(eR,new sM.PreValueApplicator,{bound:!0}));function n(e){return r(e)}t.Curry=n,t.curry=n,t.default=r});t(yM);yM.Curry,yM.curry;var _M=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createDecorator(new qC.DecoratorConfig(eR,new sM.PreValueApplicator));function n(e){return r(e)}t.CurryAll=n,t.curryAll=n,t.default=r});t(_M);_M.CurryAll,_M.curryAll;var bM=16;function EM(e,t,r){var n=QE(e,bM,void 0,void 0,void 0,void 0,void 0,t=r?void 0:t);return n.placeholder=EM.placeholder,n}EM.placeholder={};var SM=EM,TM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createInstanceDecorator(new qC.DecoratorConfig(SM,new sM.PreValueApplicator,{bound:!0}));function n(e){return r(e)}t.CurryRight=n,t.curryRight=n,t.default=r});t(TM);TM.CurryRight,TM.curryRight;var wM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createDecorator(new qC.DecoratorConfig(SM,new sM.PreValueApplicator));function n(e){return r(e)}t.CurryRightAll=n,t.curryRightAll=n,t.default=r});t(wM);wM.CurryRightAll,wM.curryRightAll;var OM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createInstanceDecorator(new qC.DecoratorConfig(Kk,new sM.PreValueApplicator,{setter:!0}));function n(e,t){return r(e,t)}t.Debounce=n,t.debounce=n,t.default=r});t(OM);OM.Debounce,OM.debounce;var kM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createDecorator(new qC.DecoratorConfig(Kk,new sM.PreValueApplicator));function n(e,t){return r(e,t)}t.DebounceAll=n,t.debounceAll=n,t.default=r});t(kM);kM.DebounceAll,kM.debounceAll;var RM="Expected a function";var AM=function(e,t,r){if("function"!=typeof e)throw new TypeError(RM);return setTimeout(function(){e.apply(void 0,r)},t)},IM=vb(function(e,t){return AM(e,1,t)}),PM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createDecorator(new qC.DecoratorConfig(IM,new sM.InvokeApplicator,{setter:!0}));function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e)}t.Defer=n,t.defer=n,t.default=r});t(PM);PM.Defer,PM.defer;var CM=vb(function(e,t,r){return AM(e,FE(t)||0,r)}),MM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createDecorator(new qC.DecoratorConfig(function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return CM.apply(void 0,[e.bind(this),t].concat(n,r))}},new sM.PreValueApplicator,{setter:!0}));function n(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return r.apply(void 0,[e].concat(t))}t.Delay=n,t.delay=n,t.default=r});t(MM);MM.Delay,MM.delay;var NM=512;var DM=function(e){return QE(e,NM)},jM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createInstanceDecorator(new qC.DecoratorConfig(DM,new sM.PartialValueApplicator,{property:!0}));function n(e){return r(e)}t.Flip=n,t.flip=n,t.default=r});t(jM);jM.Flip,jM.flip;var xM="Expected a function",LM=8,UM=32,FM=128,GM=256;var qM=function(e){return ug(function(t){var r=t.length,n=r,i=xb.prototype.thru;for(e&&t.reverse();n--;){var o=t[n];if("function"!=typeof o)throw new TypeError(xM);if(i&&!a&&"wrapper"==Db(o))var a=new xb([],!0)}for(n=a?n:r;++n<r;){o=t[n];var s=Db(o),u="wrapper"==s?Cb(o):void 0;a=u&&qb(u[0])&&u[1]==(FM|LM|UM|GM)&&!u[4].length&&1==u[9]?a[Db(u[0])].apply(a,u[3]):1==o.length&&qb(o)?a[s]():a.thru(o)}return function(){var e=arguments,n=e[0];if(a&&1==e.length&&vp(n))return a.plant(n).value();for(var i=0,o=r?t[i].apply(this,e):n;++i<r;)o=t[i].call(this,o);return o}})},VM=qM(),BM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createInstanceDecorator(new qC.DecoratorConfig(VM,new sM.ComposeApplicator({post:!0}),{property:!0}));function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e)}t.Flow=n,t.flow=n,t.default=r});t(BM);BM.Flow,BM.flow;var zM=qM(!0),WM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createInstanceDecorator(new qC.DecoratorConfig(zM,new sM.ComposeApplicator({post:!1}),{property:!0}));function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e)}t.FlowRight=n,t.flowRight=n,t.default=r});t(WM);WM.FlowRight,WM.flowRight;var HM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createInstanceDecorator(new qC.DecoratorConfig(Ev,new sM.MemoizeApplicator));function n(e){return r(e)}t.Memoize=n,t.memoize=n,t.default=r});t(HM);HM.Memoize,HM.memoize;var YM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createDecorator(new qC.DecoratorConfig(Ev,new sM.MemoizeApplicator));function n(e){return r(e)}t.MemoizeAll=n,t.memoizeAll=n,t.default=r});t(YM);YM.MemoizeAll,YM.memoizeAll;var $M=r(function(e,t){function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return nO.apply(void 0,[t.prototype].concat(e)),t}}Object.defineProperty(t,"__esModule",{value:!0}),t.Mixin=r,t.mixin=r,t.default=r});t($M);$M.Mixin,$M.mixin;var XM="Expected a function";var JM=function(e){if("function"!=typeof e)throw new TypeError(XM);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}},KM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createInstanceDecorator(new qC.DecoratorConfig(JM,new sM.PartialValueApplicator,{property:!0}));function n(e){return r(e)}t.Negate=n,t.negate=n,t.default=r});t(KM);KM.Negate,KM.negate;var QM=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createInstanceDecorator(new qC.DecoratorConfig(Ek,new sM.PreValueApplicator,{setter:!0}));function n(){return r()}t.Once=n,t.once=n,t.default=r});t(QM);QM.Once,QM.once;var ZM=vb,eN=Math.min,tN=ZM(function(e,t){var r=(t=1==t.length&&vp(t[0])?Mf(t[0],Op($P)):Mf(Xv(t,1),Op($P))).length;return vb(function(n){for(var i=-1,o=eN(n.length,r);++i<o;)n[i]=t[i].call(this,n[i]);return Kv(e,this,n)})}),rN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createDecorator(new qC.DecoratorConfig(tN,new sM.PreValueApplicator,{setter:!0}));function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e)}t.OverArgs=n,t.overArgs=n,t.default=r});t(rN);rN.OverArgs,rN.overArgs;var nN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createInstanceDecorator(new qC.DecoratorConfig(eS,new sM.PartialApplicator,{property:!0,method:!1}));function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e)}t.Partial=n,t.partial=n,t.default=r});t(nN);nN.Partial,nN.partial;var iN=vb(function(e,t){var r=pE(t,cE(iN));return QE(e,64,void 0,t,r)});iN.placeholder={};var oN=iN,aN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createInstanceDecorator(new qC.DecoratorConfig(oN,new sM.PartialApplicator,{property:!0,method:!1}));function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e)}t.PartialRight=n,t.partialRight=n,t.default=r});t(aN);aN.PartialRight,aN.partialRight;var sN=ug(function(e,t){return QE(e,256,void 0,void 0,void 0,t)}),uN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createInstanceDecorator(new qC.DecoratorConfig(sN,new sM.PartialValueApplicator,{property:!0}));function n(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return r.apply(void 0,[e].concat(t))}t.Rearg=n,t.rearg=n,t.default=r});t(uN);uN.Rearg,uN.rearg;var cN="Expected a function";var lN=function(e,t){if("function"!=typeof e)throw new TypeError(cN);return t=void 0===t?t:BE(t),vb(e,t)},fN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createDecorator(new qC.DecoratorConfig(lN,new sM.PreValueApplicator));function n(e){return r(e)}t.Rest=n,t.rest=n,t.default=r});t(fN);fN.Rest,fN.rest;var dN=function(e,t,r){var n=e.length;return r=void 0===r?n:r,!t&&r>=n?e:xv(e,t,r)},pN="Expected a function",hN=Math.max;var vN=function(e,t){if("function"!=typeof e)throw new TypeError(pN);return t=null==t?0:hN(BE(t),0),vb(function(r){var n=r[t],i=dN(r,0,t);return n&&Zp(i,n),Kv(e,this,i)})},gN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createDecorator(new qC.DecoratorConfig(vN,new sM.PreValueApplicator));function n(e){return r(e)}t.Spread=n,t.spread=n,t.default=r});t(gN);gN.Spread,gN.spread;var mN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createDecorator(new qC.DecoratorConfig(function(e){return UC.returnAtIndex(e,0)},new sM.PreValueApplicator));function n(){return r()}t.Tap=n,t.tap=n,t.default=r});t(mN);mN.Tap,mN.tap;var yN="Expected a function";var _N=function(e,t,r){var n=!0,i=!0;if("function"!=typeof e)throw new TypeError(yN);return ud(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),Kk(e,t,{leading:n,maxWait:t,trailing:i})},bN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createInstanceDecorator(new qC.DecoratorConfig(_N,new sM.PreValueApplicator,{setter:!0,getter:!0})),n=qC.DecoratorFactory.createInstanceDecorator(new qC.DecoratorConfig(_N,new sM.PreValueApplicator,{getter:!0})),i=qC.DecoratorFactory.createInstanceDecorator(new qC.DecoratorConfig(_N,new sM.PreValueApplicator,{setter:!0}));function o(e,t){return r(e,t)}function a(e,t){return n(e,t)}function s(e,t){return i(e,t)}t.Throttle=o,t.throttle=o,t.ThrottleGetter=a,t.throttleGetter=a,t.ThrottleSetter=s,t.throttleSetter=s,t.default=r});t(bN);bN.Throttle,bN.throttle,bN.ThrottleGetter,bN.throttleGetter,bN.ThrottleSetter,bN.throttleSetter;var EN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createDecorator(new qC.DecoratorConfig(_N,new sM.PreValueApplicator,{setter:!0}));function n(e,t){return r(e,t)}t.ThrottleAll=n,t.throttleAll=n,t.default=r});t(EN);EN.ThrottleAll,EN.throttleAll;var SN=function(e){return fM(e,1)},TN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createDecorator(new qC.DecoratorConfig(SN,new sM.PreValueApplicator));function n(){return r()}t.Unary=n,t.unary=n,t.default=r});t(TN);TN.Unary,TN.unary;var wN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=qC.DecoratorFactory.createDecorator(new qC.DecoratorConfig(tS,new sM.WrapApplicator));function n(e){return r(e)}t.Wrap=n,t.wrap=n,t.default=r});t(wN);wN.Wrap,wN.wrap;var ON=r(function(e,t){function r(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),r(qC),r(uM),r(cM),r(dM),r(pM),r(hM),r(vM),r(gM),r(mM),r(yM),r(_M),r(TM),r(wM),r(OM),r(kM),r(PM),r(MM),r(jM),r(BM),r(WM),r(HM),r(YM),r($M),r(KM),r(QM),r(rN),r(nN),r(aN),r(uN),r(fN),r(gN),r(mN),r(bN),r(EN),r(TN),r(wN)});t(ON);var kN=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(cc),n=o(pb),i=o(h_);function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,n){var i=n.initializer&&n.initializer();(0,r.default)(n,"value"),(0,r.default)(n,"initializer"),(0,r.default)(n,"writable"),n.get=function(){var e=a.get(this,t);return void 0!==e?e:i},n.set=function(e){var r=this[t];r!==e&&(a.set(this,t,e),this.trigger("change:"+t,e,r),this.trigger("change"))}};var a=new((0,Yw.make)(i.default,n.default))});t(kN);var RN=r(function(e){var t=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-\.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))? (\S*)(?: (\S*))?/,names:["value","direction","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+" %s"+(e.config?" %s":"")}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"invalid",names:["value"]}]};Object.keys(t).forEach(function(e){t[e].forEach(function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")})})}),AN=(RN.v,RN.o,RN.s,RN.i,RN.u,RN.e,RN.p,RN.z,RN.r,RN.t,RN.c,RN.b,RN.m,RN.a,r(function(e,t){var r=function(e){return String(Number(e))===e?Number(e):e},n=function(e,t,n){var i=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:i&&!t[e.name]&&(t[e.name]={});var o=e.push?{}:i?t[e.name]:t;!function(e,t,n,i){if(i&&!n)t[i]=r(e[1]);else for(var o=0;o<n.length;o+=1)null!=e[o+1]&&(t[n[o]]=r(e[o+1]))}(n.match(e.reg),o,e.names,e.name),e.push&&t[e.push].push(o)},i=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},r=[],o=t;return e.split(/(\r\n|\r|\n)/).filter(i).forEach(function(e){var t=e[0],i=e.slice(2);"m"===t&&(r.push({rtp:[],fmtp:[]}),o=r[r.length-1]);for(var a=0;a<(RN[t]||[]).length;a+=1){var s=RN[t][a];if(s.reg.test(i))return n(s,o,i)}}),t.media=r,t};var o=function(e,t){var n=t.split(/=(.+)/,2);return 2===n.length?e[n[0]]=r(n[1]):1===n.length&&t.length>1&&(e[n[0]]=void 0),e};t.parseParams=function(e){return e.split(/\;\s?/).reduce(o,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],n=e.split(" ").map(r),i=0;i<n.length;i+=3)t.push({component:n[i],ip:n[i+1],port:n[i+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map(function(e){return e.substring(1,e.length-1).split(",").reduce(o,{})})},t.parseSimulcastStreamList=function(e){return e.split(";").map(function(e){return e.split(",").map(function(e){var t,n=!1;return"~"!==e[0]?t=r(e):(t=r(e.substring(1,e.length)),n=!0),{scid:t,paused:n}})})}})),IN=(AN.parse,AN.parseParams,AN.parseFmtpConfig,AN.parsePayloads,AN.parseRemoteCandidates,AN.parseImageAttributes,AN.parseSimulcastStreamList,/%[sdv%]/g),PN=function(e,t,r){var n=[e+"="+(t.format instanceof Function?t.format(t.push?r:r[t.name]):t.format)];if(t.names)for(var i=0;i<t.names.length;i+=1){var o=t.names[i];t.name?n.push(r[t.name][o]):n.push(r[t.names[i]])}else n.push(r[t.name]);return function(e){var t=1,r=arguments,n=r.length;return e.replace(IN,function(e){if(t>=n)return e;var i=r[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}})}.apply(null,n)},CN=["v","o","s","i","u","e","p","c","b","t","r","z","a"],MN=["i","c","b","a"],NN={write:function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach(function(e){null==e.payloads&&(e.payloads="")});var r=t.outerOrder||CN,n=t.innerOrder||MN,i=[];return r.forEach(function(t){RN[t].forEach(function(r){r.name in e&&null!=e[r.name]?i.push(PN(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach(function(e){i.push(PN(t,r,e))})})}),e.media.forEach(function(e){i.push(PN("m",RN.m[0],e)),n.forEach(function(t){RN[t].forEach(function(r){r.name in e&&null!=e[r.name]?i.push(PN(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach(function(e){i.push(PN(t,r,e))})})})}),i.join("\r\n")+"\r\n"},parse:AN.parse,parseFmtpConfig:AN.parseFmtpConfig,parseParams:AN.parseParams,parsePayloads:AN.parsePayloads,parseRemoteCandidates:AN.parseRemoteCandidates,parseImageAttributes:AN.parseImageAttributes,parseSimulcastStreamList:AN.parseSimulcastStreamList};var DN=function(e,t){var r=[];return Tk(e,function(e,n,i){t(e,n,i)&&r.push(e)}),r};var jN=function(e,t){return(vp(e)?Yp:DN)(e,$P(t,3))},xN=!0,LN=!0;function UN(e,t,r){var n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}var FN={extractVersion:UN,wrapPeerConnectionEvent:function(e,t,r){if(e.RTCPeerConnection){var n=e.RTCPeerConnection.prototype,i=n.addEventListener;n.addEventListener=function(e,n){if(e!==t)return i.apply(this,arguments);var o=function(e){var t=r(e);t&&n(t)};return this._eventMap=this._eventMap||{},this._eventMap[n]=o,i.apply(this,[e,o])};var o=n.removeEventListener;n.removeEventListener=function(e,r){if(e!==t||!this._eventMap||!this._eventMap[r])return o.apply(this,arguments);var n=this._eventMap[r];return delete this._eventMap[r],o.apply(this,[e,n])},Object.defineProperty(n,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}},disableLog:function(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(xN=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},disableWarnings:function(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(LN=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},log:function(){if("object"==typeof window){if(xN)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},deprecated:function(e,t){LN&&console.warn(e+" is deprecated, please use "+t+" instead.")},detectBrowser:function(e){var t=e&&e.navigator,r={browser:null,version:null};if(void 0===e||!e.navigator)return r.browser="Not a browser.",r;if(t.mozGetUserMedia)r.browser="firefox",r.version=UN(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia)r.browser="chrome",r.version=UN(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))r.browser="edge",r.version=UN(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return r.browser="Not a supported browser.",r;r.browser="safari",r.version=UN(t.userAgent,/AppleWebKit\/(\d+)\./,1)}return r}},GN=FN.log,qN=FN.log;function VN(e,t,r){var n=r?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;var o=[];return e.forEach(function(e){"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)}),o.forEach(function(t){e.forEach(function(r){r.type===n&&r.trackId===t.id&&function e(t,r,n){r&&!n.has(r.id)&&(n.set(r.id,r),Object.keys(r).forEach(function(i){i.endsWith("Id")?e(t,t.get(r[i]),n):i.endsWith("Ids")&&r[i].forEach(function(r){e(t,t.get(r),n)})}))}(e,r,i)})}),i}var BN={shimGetUserMedia:function(e){var t=FN.detectBrowser(e),r=e&&e.navigator,n=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach(function(r){if("require"!==r&&"advanced"!==r&&"mediaSource"!==r){var n="object"==typeof e[r]?e[r]:{ideal:e[r]};void 0!==n.exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==n.ideal){t.optional=t.optional||[];var o={};"number"==typeof n.ideal?(o[i("min",r)]=n.ideal,t.optional.push(o),(o={})[i("max",r)]=n.ideal,t.optional.push(o)):(o[i("",r)]=n.ideal,t.optional.push(o))}void 0!==n.exact&&"number"!=typeof n.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",r)]=n.exact):["min","max"].forEach(function(e){void 0!==n[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,r)]=n[e])})}}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},i=function(e,i){if(t.version>=61)return i(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){var o=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])};o((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),o(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=n(e.audio)}if(e&&"object"==typeof e.video){var a=e.video.facingMode;a=a&&("object"==typeof a?a:{ideal:a});var s,u=t.version<66;if(a&&("user"===a.exact||"environment"===a.exact||"user"===a.ideal||"environment"===a.ideal)&&(!r.mediaDevices.getSupportedConstraints||!r.mediaDevices.getSupportedConstraints().facingMode||u)&&(delete e.video.facingMode,"environment"===a.exact||"environment"===a.ideal?s=["back","rear"]:"user"!==a.exact&&"user"!==a.ideal||(s=["front"]),s))return r.mediaDevices.enumerateDevices().then(function(t){var r=(t=t.filter(function(e){return"videoinput"===e.kind})).find(function(e){return s.some(function(t){return-1!==e.label.toLowerCase().indexOf(t)})});return!r&&t.length&&-1!==s.indexOf("back")&&(r=t[t.length-1]),r&&(e.video.deviceId=a.exact?{exact:r.deviceId}:{ideal:r.deviceId}),e.video=n(e.video),GN("chrome: "+JSON.stringify(e)),i(e)});e.video=n(e.video)}return GN("chrome: "+JSON.stringify(e)),i(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};r.getUserMedia=function(e,t,n){i(e,function(e){r.webkitGetUserMedia(e,t,function(e){n&&n(o(e))})})};var a=function(e){return new Promise(function(t,n){r.getUserMedia(e,t,n)})};if(r.mediaDevices||(r.mediaDevices={getUserMedia:a,enumerateDevices:function(){return new Promise(function(t){var r={audio:"audioinput",video:"videoinput"};return e.MediaStreamTrack.getSources(function(e){t(e.map(function(e){return{label:e.label,kind:r[e.kind],deviceId:e.id,groupId:""}}))})})},getSupportedConstraints:function(){return{deviceId:!0,echoCancellation:!0,facingMode:!0,frameRate:!0,height:!0,width:!0}}}),r.mediaDevices.getUserMedia){var s=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(e){return i(e,function(e){return s(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return t},function(e){return Promise.reject(o(e))})})}}else r.mediaDevices.getUserMedia=function(e){return a(e)};void 0===r.mediaDevices.addEventListener&&(r.mediaDevices.addEventListener=function(){GN("Dummy mediaDevices.addEventListener called.")}),void 0===r.mediaDevices.removeEventListener&&(r.mediaDevices.removeEventListener=function(){GN("Dummy mediaDevices.removeEventListener called.")})},shimMediaStream:function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},shimOnTrack:function(e){if("object"!=typeof e||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype)FN.wrapPeerConnectionEvent(e,"track",function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e});else{Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var r=this;return r._ontrackpoly||(r._ontrackpoly=function(t){t.stream.addEventListener("addtrack",function(n){var i;i=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find(function(e){return e.track&&e.track.id===n.track.id}):{track:n.track};var o=new Event("track");o.track=n.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],r.dispatchEvent(o)}),t.stream.getTracks().forEach(function(n){var i;i=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find(function(e){return e.track&&e.track.id===n.id}):{track:n};var o=new Event("track");o.track=n,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],r.dispatchEvent(o)})},r.addEventListener("addstream",r._ontrackpoly)),t.apply(r,arguments)}}},shimGetSendersWithDtmf:function(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){var i=r.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){n.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;r._senders=r._senders||[],i.apply(r,[e]),e.getTracks().forEach(function(e){r._senders.push(t(r,e))})};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;t._senders=t._senders||[],o.apply(t,[e]),e.getTracks().forEach(function(e){var r=t._senders.find(function(t){return t.track===e});r&&t._senders.splice(t._senders.indexOf(r),1)})}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=a.apply(e,[]);return t.forEach(function(t){t._pc=e}),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},shimSenderReceiverGetStats:function(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(e,[]);return r.forEach(function(t){t._pc=e}),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then(function(t){return VN(t,e.track,!0)})}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var n=e.RTCPeerConnection.prototype.getReceivers;n&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=n.apply(e,[]);return t.forEach(function(t){t._pc=e}),t}),FN.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then(function(t){return VN(t,e.track,!1)})}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t,r,n,o=arguments[0];return this.getSenders().forEach(function(e){e.track===o&&(t?n=!0:t=e)}),this.getReceivers().forEach(function(e){return e.track===o&&(r?n=!0:r=e),e.track===o}),n||t&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return i.apply(this,arguments)}}}},shimSourceObject:function(e){var t=e&&e.URL;"object"==typeof e&&(!e.HTMLMediaElement||"srcObject"in e.HTMLMediaElement.prototype||Object.defineProperty(e.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(e){var r=this;this._srcObject=e,this.src&&t.revokeObjectURL(this.src),e?(this.src=t.createObjectURL(e),e.addEventListener("addtrack",function(){r.src&&t.revokeObjectURL(r.src),r.src=t.createObjectURL(e)}),e.addEventListener("removetrack",function(){r.src&&t.revokeObjectURL(r.src),r.src=t.createObjectURL(e)})):this.src=""}}))},shimAddTrackRemoveTrackWithNative:function(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(t){return e._shimmedLocalStreams[t][0]})};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var n=t.apply(this,arguments);return this._shimmedLocalStreams[r.id]?-1===this._shimmedLocalStreams[r.id].indexOf(n)&&this._shimmedLocalStreams[r.id].push(n):this._shimmedLocalStreams[r.id]=[r,n],n};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(function(e){if(t.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError")});var n=t.getSenders();r.apply(this,arguments);var i=t.getSenders().filter(function(e){return-1===n.indexOf(e)});this._shimmedLocalStreams[e.id]=[e].concat(i)};var n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],n.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach(function(r){var n=t._shimmedLocalStreams[r].indexOf(e);-1!==n&&t._shimmedLocalStreams[r].splice(n,1),1===t._shimmedLocalStreams[r].length&&delete t._shimmedLocalStreams[r]}),i.apply(this,arguments)}},shimAddTrackRemoveTrack:function(e){if(e.RTCPeerConnection){var t=FN.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return this.shimAddTrackRemoveTrackWithNative(e);var r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=r.apply(this);return e._reverseStreams=e._reverseStreams||{},t.map(function(t){return e._reverseStreams[t.id]})};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var r=this;if(r._streams=r._streams||{},r._reverseStreams=r._reverseStreams||{},t.getTracks().forEach(function(e){if(r.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError")}),!r._reverseStreams[t.id]){var i=new e.MediaStream(t.getTracks());r._streams[t.id]=i,r._reverseStreams[i.id]=t,t=i}n.apply(r,[t])};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;t._streams=t._streams||{},t._reverseStreams=t._reverseStreams||{},i.apply(t,[t._streams[e.id]||e]),delete t._reverseStreams[t._streams[e.id]?t._streams[e.id].id:e.id],delete t._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,r){var n=this;if("closed"===n.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find(function(e){return e===t}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(n.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError");n._streams=n._streams||{},n._reverseStreams=n._reverseStreams||{};var o=n._streams[r.id];if(o)o.addTrack(t),Promise.resolve().then(function(){n.dispatchEvent(new Event("negotiationneeded"))});else{var a=new e.MediaStream([t]);n._streams[r.id]=a,n._reverseStreams[a.id]=r,n.addStream(a)}return n.getSenders().find(function(e){return e.track===t})},["createOffer","createAnswer"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=this,t=arguments;return arguments.length&&"function"==typeof arguments[0]?r.apply(e,[function(r){var n=s(e,r);t[0].apply(null,[n])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):r.apply(e,arguments).then(function(t){return s(e,t)})}});var o=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(function(t){var n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(n.id,"g"),i.id)}),new RTCSessionDescription({type:t.type,sdp:r})}(this,arguments[0]),o.apply(this,arguments)):o.apply(this,arguments)};var a=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=a.get.apply(this);return""===e.type?e:s(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,r=this;if("closed"===r.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===r))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");r._streams=r._streams||{},Object.keys(r._streams).forEach(function(n){r._streams[n].getTracks().find(function(t){return e.track===t})&&(t=r._streams[n])}),t&&(1===t.getTracks().length?r.removeStream(r._reverseStreams[t.id]):t.removeTrack(e.track),r.dispatchEvent(new Event("negotiationneeded")))}}function s(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(function(t){var n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(i.id,"g"),n.id)}),new RTCSessionDescription({type:t.type,sdp:r})}},shimPeerConnection:function(e){var t=FN.detectBrowser(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=function(t,r){return qN("PeerConnection"),t&&t.iceTransportPolicy&&(t.iceTransports=t.iceTransportPolicy),new e.webkitRTCPeerConnection(t,r)},e.RTCPeerConnection.prototype=e.webkitRTCPeerConnection.prototype,e.webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return e.webkitRTCPeerConnection.generateCertificate}})),e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,t,n){var i=this,o=arguments;if(arguments.length>0&&"function"==typeof e)return r.apply(this,arguments);if(0===r.length&&(0===arguments.length||"function"!=typeof arguments[0]))return r.apply(this,[]);var a=function(e){var t={};return e.result().forEach(function(e){var r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(function(t){r[t]=e.stat(t)}),t[r.id]=r}),t},s=function(e){return new Map(Object.keys(e).map(function(t){return[t,e[t]]}))};if(arguments.length>=2){return r.apply(this,[function(e){o[1](s(a(e)))},arguments[0]])}return new Promise(function(e,t){r.apply(i,[function(t){e(s(a(t)))},t])}).then(t,n)},t.version<51&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=arguments,t=this,n=new Promise(function(n,i){r.apply(t,[e[0],n,i])});return e.length<2?n:n.then(function(){e[1].apply(null,[])},function(t){e.length>=3&&e[2].apply(null,[t])})}}),t.version<52&&["createOffer","createAnswer"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=this;if(arguments.length<1||1===arguments.length&&"object"==typeof arguments[0]){var t=1===arguments.length?arguments[0]:void 0;return new Promise(function(n,i){r.apply(e,[n,i,t])})}return r.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}});var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},fixNegotiationNeeded:function(e){FN.wrapPeerConnectionEvent(e,"negotiationneeded",function(e){if("stable"===e.target.signalingState)return e})},shimGetDisplayMedia:function(e,t){!e.navigator||!e.navigator.mediaDevices||"getDisplayMedia"in e.navigator.mediaDevices||("function"==typeof t?(e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then(function(t){var n=r.video&&r.video.width,i=r.video&&r.video.height,o=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},n&&(r.video.mandatory.maxWidth=n),i&&(r.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(r)})},e.navigator.getDisplayMedia=function(t){return FN.deprecated("navigator.getDisplayMedia","navigator.mediaDevices.getDisplayMedia"),e.navigator.mediaDevices.getDisplayMedia(t)}):console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}},zN=r(function(e){var t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},t.splitSections=function(e){return e.split("\nm=").map(function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"})},t.getDescription=function(e){var r=t.splitSections(e);return r&&r[0]},t.getMediaSections=function(e){var r=t.splitSections(e);return r.shift(),r},t.matchPrefix=function(e,r){return t.splitLines(e).filter(function(e){return 0===e.indexOf(r)})},t.parseCandidate=function(e){for(var t,r={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},n=8;n<t.length;n+=2)switch(t[n]){case"raddr":r.relatedAddress=t[n+1];break;case"rport":r.relatedPort=parseInt(t[n+1],10);break;case"tcptype":r.tcpType=t[n+1];break;case"ufrag":r.ufrag=t[n+1],r.usernameFragment=t[n+1];break;default:r[t[n]]=t[n+1]}return r},t.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){var t=e.substr(9).split(" "),r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.channels=3===t.length?parseInt(t[2],10):1,r.numChannels=r.channels,r},t.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},t.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){for(var t,r={},n=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<n.length;i++)r[(t=n[i].trim().split("="))[0].trim()]=t[1];return r},t.writeFmtp=function(e){var t="",r=e.payloadType;if(void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var n=[];Object.keys(e.parameters).forEach(function(t){e.parameters[t]?n.push(t+"="+e.parameters[t]):n.push(t)}),t+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){var t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},t.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:parseInt(e.substr(7,t-7),10)},n=e.indexOf(":",t);return n>-1?(r.attribute=e.substr(t+1,n-t-1),r.value=e.substr(n+1)):r.attribute=e.substr(t+1),r},t.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map(function(e){return parseInt(e,10)})}},t.getMid=function(e){var r=t.matchPrefix(e,"a=mid:")[0];if(r)return r.substr(6)},t.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},t.getDtlsParameters=function(e,r){return{role:"auto",fingerprints:t.matchPrefix(e+r,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),r},t.getIceParameters=function(e,r){var n=t.splitLines(e);return{usernameFragment:(n=n.concat(t.splitLines(r))).filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:n.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)}},t.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},t.parseRtpParameters=function(e){for(var r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=t.splitLines(e)[0].split(" "),i=3;i<n.length;i++){var o=n[i],a=t.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){var s=t.parseRtpMap(a),u=t.matchPrefix(e,"a=fmtp:"+o+" ");switch(s.parameters=u.length?t.parseFmtp(u[0]):{},s.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(t.parseRtcpFb),r.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(s.name.toUpperCase())}}}return t.matchPrefix(e,"a=extmap:").forEach(function(e){r.headerExtensions.push(t.parseExtmap(e))}),r},t.writeRtpDescription=function(e,r){var n="";n+="m="+e+" ",n+=r.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=r.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",r.codecs.forEach(function(e){n+=t.writeRtpMap(e),n+=t.writeFmtp(e),n+=t.writeRtcpFb(e)});var i=0;return r.codecs.forEach(function(e){e.maxptime>i&&(i=e.maxptime)}),i>0&&(n+="a=maxptime:"+i+"\r\n"),n+="a=rtcp-mux\r\n",r.headerExtensions&&r.headerExtensions.forEach(function(e){n+=t.writeExtmap(e)}),n},t.parseRtpEncodingParameters=function(e){var r,n=[],i=t.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),a=-1!==i.fecMechanisms.indexOf("ULPFEC"),s=t.matchPrefix(e,"a=ssrc:").map(function(e){return t.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),u=s.length>0&&s[0].ssrc,c=t.matchPrefix(e,"a=ssrc-group:FID").map(function(e){return e.substr(17).split(" ").map(function(e){return parseInt(e,10)})});c.length>0&&c[0].length>1&&c[0][0]===u&&(r=c[0][1]),i.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:u,codecPayloadType:parseInt(e.parameters.apt,10)};u&&r&&(t.rtx={ssrc:r}),n.push(t),o&&((t=JSON.parse(JSON.stringify(t))).fec={ssrc:u,mechanism:a?"red+ulpfec":"red"},n.push(t))}}),0===n.length&&u&&n.push({ssrc:u});var l=t.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,n.forEach(function(e){e.maxBitrate=l})),n},t.parseRtcpParameters=function(e){var r={},n=t.matchPrefix(e,"a=ssrc:").map(function(e){return t.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];n&&(r.cname=n.value,r.ssrc=n.ssrc);var i=t.matchPrefix(e,"a=rtcp-rsize");r.reducedSize=i.length>0,r.compound=0===i.length;var o=t.matchPrefix(e,"a=rtcp-mux");return r.mux=o.length>0,r},t.parseMsid=function(e){var r,n=t.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(r=n[0].substr(7).split(" "))[0],track:r[1]};var i=t.matchPrefix(e,"a=ssrc:").map(function(e){return t.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});return i.length>0?{stream:(r=i[0].value.split(" "))[0],track:r[1]}:void 0},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,r,n){var i=void 0!==r?r:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||t.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.writeMediaSection=function(e,r,n,i){var o=t.writeRtpDescription(e.kind,r);if(o+=t.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=t.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var a="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+t.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+t.localCName+"\r\n"),o},t.getDirection=function(e,r){for(var n=t.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return r?t.getDirection(r):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){var r=t.splitLines(e)[0].substr(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}},t.parseOLine=function(e){var r=t.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var r=t.splitLines(e),n=0;n<r.length;n++)if(r[n].length<2||"="!==r[n].charAt(1))return!1;return!0},e.exports=t});function WN(e,t,r,n,i){var o=zN.writeRtpDescription(e.kind,t);if(o+=zN.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=zN.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":i||"active"),o+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var a=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=a;var s="msid:"+(n?n.id:"-")+" "+a+"\r\n";o+="a="+s,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+zN.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+zN.localCName+"\r\n"),o}function HN(e,t){var r={codecs:[],headerExtensions:[],fecMechanisms:[]},n=function(e,t){e=parseInt(e,10);for(var r=0;r<t.length;r++)if(t[r].payloadType===e||t[r].preferredPayloadType===e)return t[r]},i=function(e,t,r,i){var o=n(e.parameters.apt,r),a=n(t.parameters.apt,i);return o&&a&&o.name.toLowerCase()===a.name.toLowerCase()};return e.codecs.forEach(function(n){for(var o=0;o<t.codecs.length;o++){var a=t.codecs[o];if(n.name.toLowerCase()===a.name.toLowerCase()&&n.clockRate===a.clockRate){if("rtx"===n.name.toLowerCase()&&n.parameters&&a.parameters.apt&&!i(n,a,e.codecs,t.codecs))continue;(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(n.numChannels,a.numChannels),r.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter(function(e){for(var t=0;t<n.rtcpFeedback.length;t++)if(n.rtcpFeedback[t].type===e.type&&n.rtcpFeedback[t].parameter===e.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(e){for(var n=0;n<t.headerExtensions.length;n++){var i=t.headerExtensions[n];if(e.uri===i.uri){r.headerExtensions.push(i);break}}}),r}function YN(e,t,r){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)}function $N(e,t){var r=e.getRemoteCandidates().find(function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type});return r||e.addRemoteCandidate(t),!r}function XN(e,t){var r=new Error(t);return r.name=e,r.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],r}var JN=function(e,t){function r(t,r){r.addTrack(t),r.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function n(t,r,n,i){var o=new Event("track");o.track=r,o.receiver=n,o.transceiver={receiver:n},o.streams=i,e.setTimeout(function(){t._dispatchEvent("track",o)})}var i=function(r){var n=this,i=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){n[e]=i[e].bind(i)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",r=JSON.parse(JSON.stringify(r||{})),this.usingBundle="max-bundle"===r.bundlePolicy,"negotiate"===r.rtcpMuxPolicy)throw XN("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(r.rtcpMuxPolicy||(r.rtcpMuxPolicy="require"),r.iceTransportPolicy){case"all":case"relay":break;default:r.iceTransportPolicy="all"}switch(r.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:r.bundlePolicy="balanced"}if(r.iceServers=function(e,t){var r=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var n=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof n;return i&&(n=[n]),n=n.filter(function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||r?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(r=!0,!0)}),delete e.url,e.urls=i?n[0]:n,!!n.length}})}(r.iceServers||[],t),this._iceGatherers=[],r.iceCandidatePoolSize)for(var o=r.iceCandidatePoolSize;o>0;o--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:r.iceServers,gatherPolicy:r.iceTransportPolicy}));else r.iceCandidatePoolSize=0;this._config=r,this.transceivers=[],this._sdpSessionId=zN.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(i.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(i.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),i.prototype.onicecandidate=null,i.prototype.onaddstream=null,i.prototype.ontrack=null,i.prototype.onremovestream=null,i.prototype.onsignalingstatechange=null,i.prototype.oniceconnectionstatechange=null,i.prototype.onconnectionstatechange=null,i.prototype.onicegatheringstatechange=null,i.prototype.onnegotiationneeded=null,i.prototype.ondatachannel=null,i.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},i.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},i.prototype.getConfiguration=function(){return this._config},i.prototype.getLocalStreams=function(){return this.localStreams},i.prototype.getRemoteStreams=function(){return this.remoteStreams},i.prototype._createTransceiver=function(e,t){var r=this.transceivers.length>0,n={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&r)n.iceTransport=this.transceivers[0].iceTransport,n.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();n.iceTransport=i.iceTransport,n.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(n),n},i.prototype.addTrack=function(t,r){if(this._isClosed)throw XN("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var n;if(this.transceivers.find(function(e){return e.track===t}))throw XN("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(n=this.transceivers[i]);return n||(n=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(r)&&this.localStreams.push(r),n.track=t,n.stream=r,n.rtpSender=new e.RTCRtpSender(t,n.dtlsTransport),n.rtpSender},i.prototype.addStream=function(e){var r=this;if(t>=15025)e.getTracks().forEach(function(t){r.addTrack(t,e)});else{var n=e.clone();e.getTracks().forEach(function(e,t){var r=n.getTracks()[t];e.addEventListener("enabled",function(e){r.enabled=e.enabled})}),n.getTracks().forEach(function(e){r.addTrack(e,n)})}},i.prototype.removeTrack=function(t){if(this._isClosed)throw XN("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var r=this.transceivers.find(function(e){return e.rtpSender===t});if(!r)throw XN("InvalidAccessError","Sender was not created by this connection.");var n=r.stream;r.rtpSender.stop(),r.rtpSender=null,r.track=null,r.stream=null,-1===this.transceivers.map(function(e){return e.stream}).indexOf(n)&&this.localStreams.indexOf(n)>-1&&this.localStreams.splice(this.localStreams.indexOf(n),1),this._maybeFireNegotiationNeeded()},i.prototype.removeStream=function(e){var t=this;e.getTracks().forEach(function(e){var r=t.getSenders().find(function(t){return t.track===e});r&&t.removeTrack(r)})},i.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},i.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},i.prototype._createIceGatherer=function(t,r){var n=this;if(r&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var r=!e.candidate||0===Object.keys(e.candidate).length;i.state=r?"completed":"gathering",null!==n.transceivers[t].bufferedCandidateEvents&&n.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},i.prototype._gather=function(t,r){var n=this,i=this.transceivers[r].iceGatherer;if(!i.onlocalcandidate){var o=this.transceivers[r].bufferedCandidateEvents;this.transceivers[r].bufferedCandidateEvents=null,i.removeEventListener("localcandidate",this.transceivers[r].bufferCandidates),i.onlocalcandidate=function(e){if(!(n.usingBundle&&r>0)){var o=new Event("icecandidate");o.candidate={sdpMid:t,sdpMLineIndex:r};var a=e.candidate,s=!a||0===Object.keys(a).length;if(s)"new"!==i.state&&"gathering"!==i.state||(i.state="completed");else{"new"===i.state&&(i.state="gathering"),a.component=1,a.ufrag=i.getLocalParameters().usernameFragment;var u=zN.writeCandidate(a);o.candidate=Object.assign(o.candidate,zN.parseCandidate(u)),o.candidate.candidate=u,o.candidate.toJSON=function(){return{candidate:o.candidate.candidate,sdpMid:o.candidate.sdpMid,sdpMLineIndex:o.candidate.sdpMLineIndex,usernameFragment:o.candidate.usernameFragment}}}var c=zN.getMediaSections(n._localDescription.sdp);c[o.candidate.sdpMLineIndex]+=s?"a=end-of-candidates\r\n":"a="+o.candidate.candidate+"\r\n",n._localDescription.sdp=zN.getDescription(n._localDescription.sdp)+c.join("");var l=n.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});"gathering"!==n.iceGatheringState&&(n.iceGatheringState="gathering",n._emitGatheringStateChange()),s||n._dispatchEvent("icecandidate",o),l&&(n._dispatchEvent("icecandidate",new Event("icecandidate")),n.iceGatheringState="complete",n._emitGatheringStateChange())}},e.setTimeout(function(){o.forEach(function(e){i.onlocalcandidate(e)})},0)}},i.prototype._createIceAndDtlsTransports=function(){var t=this,r=new e.RTCIceTransport(null);r.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var n=new e.RTCDtlsTransport(r);return n.ondtlsstatechange=function(){t._updateConnectionState()},n.onerror=function(){Object.defineProperty(n,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:r,dtlsTransport:n}},i.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var r=this.transceivers[e].iceTransport;r&&(delete r.onicestatechange,delete this.transceivers[e].iceTransport);var n=this.transceivers[e].dtlsTransport;n&&(delete n.ondtlsstatechange,delete n.onerror,delete this.transceivers[e].dtlsTransport)},i.prototype._transceive=function(e,r,n){var i=HN(e.localCapabilities,e.remoteCapabilities);r&&e.rtpSender&&(i.encodings=e.sendEncodingParameters,i.rtcp={cname:zN.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(i.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(i)),n&&e.rtpReceiver&&i.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach(function(e){delete e.rtx}),e.recvEncodingParameters.length?i.encodings=e.recvEncodingParameters:i.encodings=[{}],i.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(i.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(i.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(i))},i.prototype.setLocalDescription=function(e){var t,r,n=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(XN("TypeError",'Unsupported type "'+e.type+'"'));if(!YN("setLocalDescription",e.type,n.signalingState)||n._isClosed)return Promise.reject(XN("InvalidStateError","Can not set local "+e.type+" in state "+n.signalingState));if("offer"===e.type)t=zN.splitSections(e.sdp),r=t.shift(),t.forEach(function(e,t){var r=zN.parseRtpParameters(e);n.transceivers[t].localCapabilities=r}),n.transceivers.forEach(function(e,t){n._gather(e.mid,t)});else if("answer"===e.type){t=zN.splitSections(n._remoteDescription.sdp),r=t.shift();var i=zN.matchPrefix(r,"a=ice-lite").length>0;t.forEach(function(e,t){var o=n.transceivers[t],a=o.iceGatherer,s=o.iceTransport,u=o.dtlsTransport,c=o.localCapabilities,l=o.remoteCapabilities;if(!(zN.isRejected(e)&&0===zN.matchPrefix(e,"a=bundle-only").length)&&!o.rejected){var f=zN.getIceParameters(e,r),d=zN.getDtlsParameters(e,r);i&&(d.role="server"),n.usingBundle&&0!==t||(n._gather(o.mid,t),"new"===s.state&&s.start(a,f,i?"controlling":"controlled"),"new"===u.state&&u.start(d));var p=HN(c,l);n._transceive(o,p.codecs.length>0,!1)}})}return n._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?n._updateSignalingState("have-local-offer"):n._updateSignalingState("stable"),Promise.resolve()},i.prototype.setRemoteDescription=function(i){var o=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(XN("TypeError",'Unsupported type "'+i.type+'"'));if(!YN("setRemoteDescription",i.type,o.signalingState)||o._isClosed)return Promise.reject(XN("InvalidStateError","Can not set remote "+i.type+" in state "+o.signalingState));var a={};o.remoteStreams.forEach(function(e){a[e.id]=e});var s=[],u=zN.splitSections(i.sdp),c=u.shift(),l=zN.matchPrefix(c,"a=ice-lite").length>0,f=zN.matchPrefix(c,"a=group:BUNDLE ").length>0;o.usingBundle=f;var d=zN.matchPrefix(c,"a=ice-options:")[0];return o.canTrickleIceCandidates=!!d&&d.substr(14).split(" ").indexOf("trickle")>=0,u.forEach(function(n,u){var d=zN.splitLines(n),p=zN.getKind(n),h=zN.isRejected(n)&&0===zN.matchPrefix(n,"a=bundle-only").length,v=d[0].substr(2).split(" ")[2],g=zN.getDirection(n,c),m=zN.parseMsid(n),y=zN.getMid(n)||zN.generateIdentifier();if(h||"application"===p&&("DTLS/SCTP"===v||"UDP/DTLS/SCTP"===v))o.transceivers[u]={mid:y,kind:p,protocol:v,rejected:!0};else{var _,b,E,S,T,w,O,k,R;!h&&o.transceivers[u]&&o.transceivers[u].rejected&&(o.transceivers[u]=o._createTransceiver(p,!0));var A,I,P=zN.parseRtpParameters(n);h||(A=zN.getIceParameters(n,c),(I=zN.getDtlsParameters(n,c)).role="client"),O=zN.parseRtpEncodingParameters(n);var C=zN.parseRtcpParameters(n),M=zN.matchPrefix(n,"a=end-of-candidates",c).length>0,N=zN.matchPrefix(n,"a=candidate:").map(function(e){return zN.parseCandidate(e)}).filter(function(e){return 1===e.component});if(("offer"===i.type||"answer"===i.type)&&!h&&f&&u>0&&o.transceivers[u]&&(o._disposeIceAndDtlsTransports(u),o.transceivers[u].iceGatherer=o.transceivers[0].iceGatherer,o.transceivers[u].iceTransport=o.transceivers[0].iceTransport,o.transceivers[u].dtlsTransport=o.transceivers[0].dtlsTransport,o.transceivers[u].rtpSender&&o.transceivers[u].rtpSender.setTransport(o.transceivers[0].dtlsTransport),o.transceivers[u].rtpReceiver&&o.transceivers[u].rtpReceiver.setTransport(o.transceivers[0].dtlsTransport)),"offer"!==i.type||h){if("answer"===i.type&&!h){b=(_=o.transceivers[u]).iceGatherer,E=_.iceTransport,S=_.dtlsTransport,T=_.rtpReceiver,w=_.sendEncodingParameters,k=_.localCapabilities,o.transceivers[u].recvEncodingParameters=O,o.transceivers[u].remoteCapabilities=P,o.transceivers[u].rtcpParameters=C,N.length&&"new"===E.state&&(!l&&!M||f&&0!==u?N.forEach(function(e){$N(_.iceTransport,e)}):E.setRemoteCandidates(N)),f&&0!==u||("new"===E.state&&E.start(b,A,"controlling"),"new"===S.state&&S.start(I)),!HN(_.localCapabilities,_.remoteCapabilities).codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&_.sendEncodingParameters[0].rtx&&delete _.sendEncodingParameters[0].rtx,o._transceive(_,"sendrecv"===g||"recvonly"===g,"sendrecv"===g||"sendonly"===g),!T||"sendrecv"!==g&&"sendonly"!==g?delete _.rtpReceiver:(R=T.track,m?(a[m.stream]||(a[m.stream]=new e.MediaStream),r(R,a[m.stream]),s.push([R,T,a[m.stream]])):(a.default||(a.default=new e.MediaStream),r(R,a.default),s.push([R,T,a.default])))}}else{(_=o.transceivers[u]||o._createTransceiver(p)).mid=y,_.iceGatherer||(_.iceGatherer=o._createIceGatherer(u,f)),N.length&&"new"===_.iceTransport.state&&(!M||f&&0!==u?N.forEach(function(e){$N(_.iceTransport,e)}):_.iceTransport.setRemoteCandidates(N)),k=e.RTCRtpReceiver.getCapabilities(p),t<15019&&(k.codecs=k.codecs.filter(function(e){return"rtx"!==e.name})),w=_.sendEncodingParameters||[{ssrc:1001*(2*u+2)}];var D,j=!1;if("sendrecv"===g||"sendonly"===g){if(j=!_.rtpReceiver,T=_.rtpReceiver||new e.RTCRtpReceiver(_.dtlsTransport,p),j)R=T.track,m&&"-"===m.stream||(m?(a[m.stream]||(a[m.stream]=new e.MediaStream,Object.defineProperty(a[m.stream],"id",{get:function(){return m.stream}})),Object.defineProperty(R,"id",{get:function(){return m.track}}),D=a[m.stream]):(a.default||(a.default=new e.MediaStream),D=a.default)),D&&(r(R,D),_.associatedRemoteMediaStreams.push(D)),s.push([R,T,D])}else _.rtpReceiver&&_.rtpReceiver.track&&(_.associatedRemoteMediaStreams.forEach(function(t){var r,n,i=t.getTracks().find(function(e){return e.id===_.rtpReceiver.track.id});i&&(r=i,(n=t).removeTrack(r),n.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:r})))}),_.associatedRemoteMediaStreams=[]);_.localCapabilities=k,_.remoteCapabilities=P,_.rtpReceiver=T,_.rtcpParameters=C,_.sendEncodingParameters=w,_.recvEncodingParameters=O,o._transceive(o.transceivers[u],!1,j)}}}),void 0===o._dtlsRole&&(o._dtlsRole="offer"===i.type?"active":"passive"),o._remoteDescription={type:i.type,sdp:i.sdp},"offer"===i.type?o._updateSignalingState("have-remote-offer"):o._updateSignalingState("stable"),Object.keys(a).forEach(function(t){var r=a[t];if(r.getTracks().length){if(-1===o.remoteStreams.indexOf(r)){o.remoteStreams.push(r);var i=new Event("addstream");i.stream=r,e.setTimeout(function(){o._dispatchEvent("addstream",i)})}s.forEach(function(e){var t=e[0],i=e[1];r.id===e[2].id&&n(o,t,i,[r])})}}),s.forEach(function(e){e[2]||n(o,e[0],e[1],[])}),e.setTimeout(function(){o&&o.transceivers&&o.transceivers.forEach(function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},i.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},i.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},i.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout(function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}},0))},i.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++}),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",r)}},i.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)}),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var r=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",r)}},i.prototype.createOffer=function(){var r=this;if(r._isClosed)return Promise.reject(XN("InvalidStateError","Can not call createOffer after close"));var n=r.transceivers.filter(function(e){return"audio"===e.kind}).length,i=r.transceivers.filter(function(e){return"video"===e.kind}).length,o=arguments[0];if(o){if(o.mandatory||o.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==o.offerToReceiveAudio&&(n=!0===o.offerToReceiveAudio?1:!1===o.offerToReceiveAudio?0:o.offerToReceiveAudio),void 0!==o.offerToReceiveVideo&&(i=!0===o.offerToReceiveVideo?1:!1===o.offerToReceiveVideo?0:o.offerToReceiveVideo)}for(r.transceivers.forEach(function(e){"audio"===e.kind?--n<0&&(e.wantReceive=!1):"video"===e.kind&&--i<0&&(e.wantReceive=!1)});n>0||i>0;)n>0&&(r._createTransceiver("audio"),n--),i>0&&(r._createTransceiver("video"),i--);var a=zN.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.transceivers.forEach(function(n,i){var o=n.track,a=n.kind,s=n.mid||zN.generateIdentifier();n.mid=s,n.iceGatherer||(n.iceGatherer=r._createIceGatherer(i,r.usingBundle));var u=e.RTCRtpSender.getCapabilities(a);t<15019&&(u.codecs=u.codecs.filter(function(e){return"rtx"!==e.name})),u.codecs.forEach(function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),n.remoteCapabilities&&n.remoteCapabilities.codecs&&n.remoteCapabilities.codecs.forEach(function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)})}),u.headerExtensions.forEach(function(e){(n.remoteCapabilities&&n.remoteCapabilities.headerExtensions||[]).forEach(function(t){e.uri===t.uri&&(e.id=t.id)})});var c=n.sendEncodingParameters||[{ssrc:1001*(2*i+1)}];o&&t>=15019&&"video"===a&&!c[0].rtx&&(c[0].rtx={ssrc:c[0].ssrc+1}),n.wantReceive&&(n.rtpReceiver=new e.RTCRtpReceiver(n.dtlsTransport,a)),n.localCapabilities=u,n.sendEncodingParameters=c}),"max-compat"!==r._config.bundlePolicy&&(a+="a=group:BUNDLE "+r.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),a+="a=ice-options:trickle\r\n",r.transceivers.forEach(function(e,t){a+=WN(e,e.localCapabilities,"offer",e.stream,r._dtlsRole),a+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===r.iceGatheringState||0!==t&&r.usingBundle||(e.iceGatherer.getLocalCandidates().forEach(function(e){e.component=1,a+="a="+zN.writeCandidate(e)+"\r\n"}),"completed"===e.iceGatherer.state&&(a+="a=end-of-candidates\r\n"))});var s=new e.RTCSessionDescription({type:"offer",sdp:a});return Promise.resolve(s)},i.prototype.createAnswer=function(){var r=this;if(r._isClosed)return Promise.reject(XN("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==r.signalingState&&"have-local-pranswer"!==r.signalingState)return Promise.reject(XN("InvalidStateError","Can not call createAnswer in signalingState "+r.signalingState));var n=zN.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.usingBundle&&(n+="a=group:BUNDLE "+r.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),n+="a=ice-options:trickle\r\n";var i=zN.getMediaSections(r._remoteDescription.sdp).length;r.transceivers.forEach(function(e,o){if(!(o+1>i)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?n+="m=application 0 DTLS/SCTP 5000\r\n":n+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?n+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(n+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(n+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var a;if(e.stream)"audio"===e.kind?a=e.stream.getAudioTracks()[0]:"video"===e.kind&&(a=e.stream.getVideoTracks()[0]),a&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1});var s=HN(e.localCapabilities,e.remoteCapabilities);!s.codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,n+=WN(e,s,"answer",e.stream,r._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(n+="a=rtcp-rsize\r\n")}});var o=new e.RTCSessionDescription({type:"answer",sdp:n});return Promise.resolve(o)},i.prototype.addIceCandidate=function(e){var t,r=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(n,i){if(!r._remoteDescription)return i(XN("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var o=e.sdpMLineIndex;if(e.sdpMid)for(var a=0;a<r.transceivers.length;a++)if(r.transceivers[a].mid===e.sdpMid){o=a;break}var s=r.transceivers[o];if(!s)return i(XN("OperationError","Can not add ICE candidate"));if(s.rejected)return n();var u=Object.keys(e.candidate).length>0?zN.parseCandidate(e.candidate):{};if("tcp"===u.protocol&&(0===u.port||9===u.port))return n();if(u.component&&1!==u.component)return n();if((0===o||o>0&&s.iceTransport!==r.transceivers[0].iceTransport)&&!$N(s.iceTransport,u))return i(XN("OperationError","Can not add ICE candidate"));var c=e.candidate.trim();0===c.indexOf("a=")&&(c=c.substr(2)),(t=zN.getMediaSections(r._remoteDescription.sdp))[o]+="a="+(u.type?c:"end-of-candidates")+"\r\n",r._remoteDescription.sdp=zN.getDescription(r._remoteDescription.sdp)+t.join("")}else for(var l=0;l<r.transceivers.length&&(r.transceivers[l].rejected||(r.transceivers[l].iceTransport.addRemoteCandidate({}),(t=zN.getMediaSections(r._remoteDescription.sdp))[l]+="a=end-of-candidates\r\n",r._remoteDescription.sdp=zN.getDescription(r._remoteDescription.sdp)+t.join(""),!r.usingBundle));l++);n()})},i.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var r=null;if(this.transceivers.forEach(function(e){e.rtpSender&&e.rtpSender.track===t?r=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(r=e.rtpReceiver)}),!r)throw XN("InvalidAccessError","Invalid selector.");return r.getStats()}var n=[];return this.transceivers.forEach(function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(t){e[t]&&n.push(e[t].getStats())})}),Promise.all(n).then(function(e){var t=new Map;return e.forEach(function(e){e.forEach(function(e){t.set(e.id,e)})}),t})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(t){var r=e[t];if(r&&r.prototype&&r.prototype.getStats){var n=r.prototype.getStats;r.prototype.getStats=function(){return n.apply(this).then(function(e){var t=new Map;return Object.keys(e).forEach(function(r){var n;e[r].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(n=e[r]).type]||n.type,t.set(r,e[r])}),t})}}});var o=["createOffer","createAnswer"];return o.forEach(function(e){var t=i.prototype[e];i.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then(function(t){"function"==typeof e[0]&&e[0].apply(null,[t])},function(t){"function"==typeof e[1]&&e[1].apply(null,[t])}):t.apply(this,arguments)}}),(o=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(e){var t=i.prototype[e];i.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)},function(t){"function"==typeof e[2]&&e[2].apply(null,[t])}):t.apply(this,arguments)}}),["getStats"].forEach(function(e){var t=i.prototype[e];i.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)}):t.apply(this,arguments)}}),i},KN={shimGetUserMedia:function(e){var t=e&&e.navigator,r=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return r(e).catch(function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))})}},shimPeerConnection:function(e){var t=FN.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var r=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){r.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var n=JN(e,t.version);e.RTCPeerConnection=function(e){var t,r,i;return e&&e.iceServers&&(e.iceServers=(t=e.iceServers,i=!1,(t=JSON.parse(JSON.stringify(t))).filter(function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&FN.deprecated("RTCIceServer.url","RTCIceServer.urls");var n="string"==typeof t;return n&&(t=[t]),t=t.filter(function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||i?0===e.indexOf("stun:")&&r>=14393&&-1===e.indexOf("?transport=udp"):(i=!0,!0)}),delete e.url,e.urls=n?t[0]:t,!!t.length}}))),new n(e)},e.RTCPeerConnection.prototype=n.prototype},shimReplaceTrack:function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)},shimGetDisplayMedia:function(e,t){if("getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&!("getDisplayMedia"in e.navigator.mediaDevices)){var r=e.navigator.getDisplayMedia;e.navigator.mediaDevices.getDisplayMedia=function(t){return r.call(e.navigator,t)},e.navigator.getDisplayMedia=function(t){return FN.deprecated("navigator.getDisplayMedia","navigator.mediaDevices.getDisplayMedia"),r.call(e.navigator,t)}}}},QN=FN.log,ZN={shimGetUserMedia:function(e){var t=FN.detectBrowser(e),r=e&&e.navigator,n=e&&e.MediaStreamTrack,i=function(e){return{name:{InternalError:"NotReadableError",NotSupportedError:"TypeError",PermissionDeniedError:"NotAllowedError",SecurityError:"NotAllowedError"}[e.name]||e.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[e.message]||e.message,constraint:e.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},o=function(e,n,o){var a=function(e){if("object"!=typeof e||e.require)return e;var t=[];return Object.keys(e).forEach(function(r){if("require"!==r&&"advanced"!==r&&"mediaSource"!==r){var n=e[r]="object"==typeof e[r]?e[r]:{ideal:e[r]};if(void 0===n.min&&void 0===n.max&&void 0===n.exact||t.push(r),void 0!==n.exact&&("number"==typeof n.exact?n.min=n.max=n.exact:e[r]=n.exact,delete n.exact),void 0!==n.ideal){e.advanced=e.advanced||[];var i={};"number"==typeof n.ideal?i[r]={min:n.ideal,max:n.ideal}:i[r]=n.ideal,e.advanced.push(i),delete n.ideal,Object.keys(n).length||delete e[r]}}}),t.length&&(e.require=t),e};return e=JSON.parse(JSON.stringify(e)),t.version<38&&(QN("spec: "+JSON.stringify(e)),e.audio&&(e.audio=a(e.audio)),e.video&&(e.video=a(e.video)),QN("ff37: "+JSON.stringify(e))),r.mozGetUserMedia(e,n,function(e){o(i(e))})};if(r.mediaDevices||(r.mediaDevices={getUserMedia:function(e){return new Promise(function(t,r){o(e,t,r)})},addEventListener:function(){},removeEventListener:function(){}}),r.mediaDevices.enumerateDevices=r.mediaDevices.enumerateDevices||function(){return new Promise(function(e){e([{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}])})},t.version<41){var a=r.mediaDevices.enumerateDevices.bind(r.mediaDevices);r.mediaDevices.enumerateDevices=function(){return a().then(void 0,function(e){if("NotFoundError"===e.name)return[];throw e})}}if(t.version<49){var s=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(e){return s(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(function(e){e.stop()}),new DOMException("The object can not be found here.","NotFoundError");return t},function(e){return Promise.reject(i(e))})}}if(!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){var u=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])},c=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(e){return"object"==typeof e&&"object"==typeof e.audio&&(e=JSON.parse(JSON.stringify(e)),u(e.audio,"autoGainControl","mozAutoGainControl"),u(e.audio,"noiseSuppression","mozNoiseSuppression")),c(e)},n&&n.prototype.getSettings){var l=n.prototype.getSettings;n.prototype.getSettings=function(){var e=l.apply(this,arguments);return u(e,"mozAutoGainControl","autoGainControl"),u(e,"mozNoiseSuppression","noiseSuppression"),e}}if(n&&n.prototype.applyConstraints){var f=n.prototype.applyConstraints;n.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"==typeof e&&(e=JSON.parse(JSON.stringify(e)),u(e,"autoGainControl","mozAutoGainControl"),u(e,"noiseSuppression","mozNoiseSuppression")),f.apply(this,[e])}}}r.getUserMedia=function(e,n,i){if(t.version<44)return o(e,n,i);FN.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(e).then(n,i)}},shimOnTrack:function(e){"object"!=typeof e||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.getTracks().forEach(function(t){var r=new Event("track");r.track=t,r.receiver={track:t},r.transceiver={receiver:r.receiver},r.streams=[e.stream],this.dispatchEvent(r)}.bind(this))}.bind(this))},enumerable:!0,configurable:!0}),"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimSourceObject:function(e){"object"==typeof e&&(!e.HTMLMediaElement||"srcObject"in e.HTMLMediaElement.prototype||Object.defineProperty(e.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(e){this.mozSrcObject=e}}))},shimPeerConnection:function(e){var t=FN.detectBrowser(e);if("object"==typeof e&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){e.RTCPeerConnection||(e.RTCPeerConnection=function(r,n){if(t.version<38&&r&&r.iceServers){for(var i=[],o=0;o<r.iceServers.length;o++){var a=r.iceServers[o];if(a.hasOwnProperty("urls"))for(var s=0;s<a.urls.length;s++){var u={url:a.urls[s]};0===a.urls[s].indexOf("turn")&&(u.username=a.username,u.credential=a.credential),i.push(u)}else i.push(r.iceServers[o])}r.iceServers=i}return new e.mozRTCPeerConnection(r,n)},e.RTCPeerConnection.prototype=e.mozRTCPeerConnection.prototype,e.mozRTCPeerConnection.generateCertificate&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return e.mozRTCPeerConnection.generateCertificate}}),e.RTCSessionDescription=e.mozRTCSessionDescription,e.RTCIceCandidate=e.mozRTCIceCandidate),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}});var r=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,r,o){return i.apply(this,[e||null]).then(function(e){if(t.version<48&&(e=function(e){var t=new Map;return Object.keys(e).forEach(function(r){t.set(r,e[r]),t[r]=e[r]}),t}(e)),t.version<53&&!r)try{e.forEach(function(e){e.type=n[e.type]||e.type})}catch(t){if("TypeError"!==t.name)throw t;e.forEach(function(t,r){e.set(r,Object.assign({},t,{type:n[t.type]||t.type}))})}return e}).then(r,o)}}},shimSenderGetStats:function(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(e,[]);return r.forEach(function(t){t._pc=e}),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},shimReceiverGetStats:function(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,r=t.apply(e,[]);return r.forEach(function(t){t._pc=e}),r}),FN.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},shimRemoveStream:function(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;FN.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(r){r.track&&-1!==e.getTracks().indexOf(r.track)&&t.removeTrack(r)})})},shimRTCDataChannel:function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},shimGetDisplayMedia:function(e,t){!e.navigator||!e.navigator.mediaDevices||"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){var n=new DOMException("getDisplayMedia without video constraints is undefined");return n.name="NotFoundError",n.code=8,Promise.reject(n)}return!0===r.video?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)},e.navigator.getDisplayMedia=function(t){return FN.deprecated("navigator.getDisplayMedia","navigator.mediaDevices.getDisplayMedia"),e.navigator.mediaDevices.getDisplayMedia(t)})}},eD={shimLocalStreamsAPI:function(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),"getStreamById"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getStreamById=function(e){var t=null;return this._localStreams&&this._localStreams.forEach(function(r){r.id===e&&(t=r)}),this._remoteStreams&&this._remoteStreams.forEach(function(r){r.id===e&&(t=r)}),t}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),-1===this._localStreams.indexOf(e)&&this._localStreams.push(e);var r=this;e.getTracks().forEach(function(n){t.call(r,n,e)})},e.RTCPeerConnection.prototype.addTrack=function(e,r){return r&&(this._localStreams?-1===this._localStreams.indexOf(r)&&this._localStreams.push(r):this._localStreams=[r]),t.call(this,e,r)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);var t=this._localStreams.indexOf(e);if(-1!==t){this._localStreams.splice(t,1);var r=this,n=e.getTracks();this.getSenders().forEach(function(e){-1!==n.indexOf(e.track)&&r.removeTrack(e)})}})}},shimRemoteStreamsAPI:function(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){this._onaddstream&&this.removeEventListener("addstream",this._onaddstream),this.addEventListener("addstream",this._onaddstream=e)}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach(function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var r=new Event("addstream");r.stream=t,e.dispatchEvent(r)}})}),t.apply(e,arguments)}}},shimCallbacksAPI:function(e){if("object"==typeof e&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,r=t.createOffer,n=t.createAnswer,i=t.setLocalDescription,o=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i};var s=function(e,t,r){var n=i.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n};t.setLocalDescription=s,s=function(e,t,r){var n=o.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.setRemoteDescription=s,s=function(e,t,r){var n=a.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.addIceCandidate=s}},shimGetUserMedia:function(e){var t=e&&e.navigator;t.getUserMedia||(t.webkitGetUserMedia?t.getUserMedia=t.webkitGetUserMedia.bind(t):t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,r,n){t.mediaDevices.getUserMedia(e).then(r,n)}.bind(t)))},shimRTCIceServerUrls:function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,r){if(e&&e.iceServers){for(var n=[],i=0;i<e.iceServers.length;i++){var o=e.iceServers[i];!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")?(FN.deprecated("RTCIceServer.url","RTCIceServer.urls"),(o=JSON.parse(JSON.stringify(o))).urls=o.url,delete o.url,n.push(o)):n.push(e.iceServers[i])}e.iceServers=n}return new t(e,r)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},shimTrackEventTransceiver:function(e){"object"==typeof e&&e.RTCPeerConnection&&"receiver"in e.RTCTrackEvent.prototype&&!e.RTCTransceiver&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimCreateOfferLegacy:function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){var r=this;if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var n=r.getTransceivers().find(function(e){return e.sender.track&&"audio"===e.sender.track.kind});!1===e.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveAudio||n||r.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var i=r.getTransceivers().find(function(e){return e.sender.track&&"video"===e.sender.track.kind});!1===e.offerToReceiveVideo&&i?"sendrecv"===i.direction?i.setDirection("sendonly"):"recvonly"===i.direction&&i.setDirection("inactive"):!0!==e.offerToReceiveVideo||i||r.addTransceiver("video")}return t.apply(r,arguments)}}},tD={shimRTCIceCandidate:function(e){if(e.RTCIceCandidate&&!(e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var r=new t(e),n=zN.parseCandidate(e.candidate),i=Object.assign(r,n);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,FN.wrapPeerConnectionEvent(e,"icecandidate",function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t})}},shimCreateObjectURL:function(e){var t=e&&e.URL;if("object"==typeof e&&e.HTMLMediaElement&&"srcObject"in e.HTMLMediaElement.prototype&&t.createObjectURL&&t.revokeObjectURL){var r=t.createObjectURL.bind(t),n=t.revokeObjectURL.bind(t),i=new Map,o=0;t.createObjectURL=function(e){if("getTracks"in e){var t="polyblob:"+ ++o;return i.set(t,e),FN.deprecated("URL.createObjectURL(stream)","elem.srcObject = stream"),t}return r(e)},t.revokeObjectURL=function(e){n(e),i.delete(e)};var a=Object.getOwnPropertyDescriptor(e.HTMLMediaElement.prototype,"src");Object.defineProperty(e.HTMLMediaElement.prototype,"src",{get:function(){return a.get.apply(this)},set:function(e){return this.srcObject=i.get(e)||null,a.set.apply(this,[e])}});var s=e.HTMLMediaElement.prototype.setAttribute;e.HTMLMediaElement.prototype.setAttribute=function(){return 2===arguments.length&&"src"===(""+arguments[0]).toLowerCase()&&(this.srcObject=i.get(arguments[1])||null),s.apply(this,arguments)}}},shimMaxMessageSize:function(e){if(!e.RTCSctpTransport&&e.RTCPeerConnection){var t=FN.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e,n,i,o;if(this._sctp=null,i=arguments[0],(o=zN.splitSections(i.sdp)).shift(),o.some(function(e){var t=zN.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})){var a,s=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var r=parseInt(t[1],10);return r!=r?-1:r}(arguments[0]),u=(e=s,n=65536,"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n),c=function(e,r){var n=65536;"firefox"===t.browser&&57===t.version&&(n=65535);var i=zN.matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?n=parseInt(i[0].substr(19),10):"firefox"===t.browser&&-1!==r&&(n=2147483637),n}(arguments[0],s);a=0===u&&0===c?Number.POSITIVE_INFINITY:0===u||0===c?Math.max(u,c):Math.min(u,c);var l={};Object.defineProperty(l,"maxMessageSize",{get:function(){return a}}),this._sctp=l}return r.apply(this,arguments)}}},shimSendThrowTypeError:function(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return r(e,this),e},FN.wrapPeerConnectionEvent(e,"datachannel",function(e){return r(e.channel,e.target),e})}function r(e,t){var r=e.send;e.send=function(){var n=arguments[0],i=n.length||n.size||n.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return r.apply(e,arguments)}}}},rD=(function(e,t){var r=e&&e.window,n={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};for(var i in t)hasOwnProperty.call(t,i)&&(n[i]=t[i]);var o=FN.log,a=FN.detectBrowser(r),s=BN||null,u=KN||null,c=ZN||null,l=eD||null,f=tD||null,d={browserDetails:a,commonShim:f,extractVersion:FN.extractVersion,disableLog:FN.disableLog,disableWarnings:FN.disableWarnings};switch(a.browser){case"chrome":if(!s||!s.shimPeerConnection||!n.shimChrome)return o("Chrome shim is not included in this adapter release."),d;o("adapter.js shimming chrome."),d.browserShim=s,f.shimCreateObjectURL(r),s.shimGetUserMedia(r),s.shimMediaStream(r),s.shimSourceObject(r),s.shimPeerConnection(r),s.shimOnTrack(r),s.shimAddTrackRemoveTrack(r),s.shimGetSendersWithDtmf(r),s.shimSenderReceiverGetStats(r),s.fixNegotiationNeeded(r),f.shimRTCIceCandidate(r),f.shimMaxMessageSize(r),f.shimSendThrowTypeError(r);break;case"firefox":if(!c||!c.shimPeerConnection||!n.shimFirefox)return o("Firefox shim is not included in this adapter release."),d;o("adapter.js shimming firefox."),d.browserShim=c,f.shimCreateObjectURL(r),c.shimGetUserMedia(r),c.shimSourceObject(r),c.shimPeerConnection(r),c.shimOnTrack(r),c.shimRemoveStream(r),c.shimSenderGetStats(r),c.shimReceiverGetStats(r),c.shimRTCDataChannel(r),f.shimRTCIceCandidate(r),f.shimMaxMessageSize(r),f.shimSendThrowTypeError(r);break;case"edge":if(!u||!u.shimPeerConnection||!n.shimEdge)return o("MS edge shim is not included in this adapter release."),d;o("adapter.js shimming edge."),d.browserShim=u,f.shimCreateObjectURL(r),u.shimGetUserMedia(r),u.shimPeerConnection(r),u.shimReplaceTrack(r),u.shimGetDisplayMedia(r),f.shimMaxMessageSize(r),f.shimSendThrowTypeError(r);break;case"safari":if(!l||!n.shimSafari)return o("Safari shim is not included in this adapter release."),d;o("adapter.js shimming safari."),d.browserShim=l,f.shimCreateObjectURL(r),l.shimRTCIceServerUrls(r),l.shimCreateOfferLegacy(r),l.shimCallbacksAPI(r),l.shimLocalStreamsAPI(r),l.shimRemoteStreamsAPI(r),l.shimTrackEventTransceiver(r),l.shimGetUserMedia(r),f.shimRTCIceCandidate(r),f.shimMaxMessageSize(r),f.shimSendThrowTypeError(r);break;default:o("Unsupported browser!")}}({window:e.window}),r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ensureH264=void 0;var r=o(jN),n=o(KP),i=o(eR);function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var r="screen"===e?{content:"slides",type:"video"}:{type:e},i=(0,n.default)((0,NN.parse)(t).media,r);return i?i.direction:"inactive"}function s(e){switch(e){case"inactive":case"sendrecv":return e;case"sendonly":return"recvonly";case"recvonly":return"sendonly";default:throw new Error('direction "'+e+'" is not valid')}}t.getMediaDirectionFromSDP=a,t.getMediaFromSDP=function(e,t,n){var i="screen"===e?{content:"slides",type:"video"}:{type:e},o=(0,r.default)((0,NN.parse)(t).media,i),a={};n&&("sendrecv"===n?(o.forEach(function(e){a[e.direction]=e}),!a.sendrecv||a.recvonly||a.sendonly?!a.sendrecv&&a.recvonly&&a.sendonly&&(o=[a.recvonly,a.sendonly]):o=a.sendrecv):o=o.filter(function(e){return e.direction===n}));return o},t.reverseMediaDirection=s,t.limitBandwith=function(e,t){var r=e.audioBandwidthLimit,n=e.videoBandwidthLimit;return t.split("\r\n").reduce(function(e,t){return e.push(t),t.startsWith("m=")&&e.push("b=TIAS:"+(t.includes("audio")?r:n)),e},[]).join("\r\n")},t.kindToPropertyFragment=function(e){return"audio"===e?"Audio":"Video"},t.getMediaDirectionFromSDPForAnswer=function(e,t){return s(a(e,t))},t.boolToDirection=u,t.getMediaDirectionFromTracks=function(e,t){if("closed"===t.signalingState)return"inactive";var r=t.getSenders().filter(function(t){return t.track&&t.track.kind===e}),n=r.length>0&&r.reduce(function(e,t){return e||t.track.enabled},!1),i=t.getReceivers().filter(function(t){return t.track&&t.track.kind===e}),o=i.length>0&&i.reduce(function(e,t){return e||t.track.enabled},!1);return u(n,o)},t.removeExtmap=function(e){return e.replace(/a=extmap.*\r\n/g,"")};t.ensureH264=(0,i.default)(function(e,t){if(e){if(!t.includes("m=video"))throw new Error("No video section found in offer");if(!/[hH]264/.test(t))throw new Error("Offer does not include h264 codec")}return t});function u(e,t){return e&&t?"sendrecv":e?"sendonly":t?"recvonly":"inactive"}}));t(rD);rD.ensureH264,rD.getMediaDirectionFromSDP,rD.getMediaFromSDP,rD.reverseMediaDirection,rD.limitBandwith,rD.kindToPropertyFragment,rD.getMediaDirectionFromSDPForAnswer,rD.boolToDirection,rD.getMediaDirectionFromTracks,rD.removeExtmap;var nD=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,n,i,o,a,s,u,c,l,f,d,p,h,v,g,m,y=N(wf),_=N(Hy),b=N(ac),E=N(yR),S=N(cc),T=N(_f),w=N(By),O=N(Yy),k=N(pb),R=N(h_),A=N(cS),I=N(bC),P=N(kN),C=N(Ck),M=N(RN);function N(e){return e&&e.__esModule?e:{default:e}}function D(e,t,r,n){r&&(0,_.default)(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function j(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}M.default.a.find(function(e){return"content"===e.name})||M.default.a.unshift({name:"content",reg:/^content:(slides)/});var x=new((0,Yw.make)(R.default,k.default)),L={audio:"Audio",video:"Video"};function U(e,t){return x.get(e,t)||"inactive"}var F=(r=(0,Yw.whileInFlight)("gumming"),n=(0,ON.debounce)(500),i=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,w.default)(this,e),this.logger=console,D(this,"localMediaStream",o,this),D(this,"remoteMediaStream",a,this),D(this,"localScreenShare",s,this),this.pc=new RTCPeerConnection({iceServers:[],bundlePolicy:"max-compat",sdpSemantics:"plan-b"}),D(this,"offerSdp",u,this),D(this,"answerSdp",c,this),D(this,"sendingAudio",l,this),D(this,"sendingVideo",f,this),D(this,"receivingAudio",d,this),D(this,"receivingVideo",p,this),D(this,"ended",h,this),this.negotiationNeeded=!1,this.bandwidthLimit={audioBandwidthLimit:6e4,videoBandwidthLimit:1e6},D(this,"constraints",v,this),D(this,"offerOptions",g,this),D(this,"gumming",m,this),n.parent?pu(function(){n.parent.logger&&(t.logger=n.parent.logger)}):r.logger&&(this.logger=r.logger),this.pc.onnegotiationneeded=function(){t.logger.info("peer connection emitted negotiationneeded"),t.answerSdp&&!t.negotiationNeeded&&(t.negotiationNeeded=!0,t.triggerNegotiationNeeded())},this.pc.ontrack=function(e){t.logger.info("peerConnection ontrack fired, updating remoteMediaStream"),t.trigger("track");var r=t.remoteMediaStream||new MediaStream;e.streams[0].getTracks().forEach(function(e){t.logger.info("adding "+e.kind+" track to remoteMediaStream"),r&&!r.getTracks().includes(e)&&r.addTrack(e),e.onended=function(){t.logger.info("remote "+e.kind+" has ended, removing track from remoteMediaStream"),r.removeTrack(e),e.onended=void 0;try{t["receiving"+L[e.kind]]=(0,rD.getMediaDirectionFromTracks)(e.kind,t.pc).includes("recv")}catch(r){t["receiving"+L[e.kind]]=!1}},t["receiving"+L[e.kind]]=(0,rD.getMediaDirectionFromTracks)(e.kind,t.pc).includes("recv")}),t.remoteMediaStream=r,t.trigger("internalTrackUpdate")}}return(0,O.default)(e,[{key:"audioDirection",get:function(){return(0,rD.getMediaDirectionFromTracks)("audio",this.pc)}},{key:"videoDirection",get:function(){return(0,rD.getMediaDirectionFromTracks)("video",this.pc)}},{key:"screenDirection",get:function(){return this.localScreenShare&&0!==this.localScreenShare.getTracks().length?"sendonly":"inactive"}},{key:"senderTracks",get:function(){return this.pc.getSenders().reduce(function(e,t){return t.track&&e.push(t.track),e},[])}},{key:"receiverTracks",get:function(){return this.pc.getReceivers().reduce(function(e,t){return t.track&&e.push(t.track),e},[])}}],[{key:"getUserMedia",value:function(e){var t=(0,A.default)({},e,{fake:"test"===ku.env.NODE_ENV});return navigator.mediaDevices.getUserMedia(t)}}]),(0,O.default)(e,[{key:"_prepareIceGatherer",value:function(){var e=this,t=!1;if("new"===this.pc.iceGatheringState)this.logger.info('ice gathering is in state "new", definitely need to block for ice gathering'),t=!0;else{var r=(0,NN.parse)(this.pc.localDescription.sdp);["audio","video","screen"].forEach(function(n){var i=n+"Direction";("inactive"!==e[i]||U(e,n)!==e[i]&&"inactive"!==U(e,n))&&(r.media.find(function(e){return e.type===n})?e.logger.info(n+" candidates already gathered"):(e.logger.info("transitioning "+n+" from inactive, ice needed"),t=!0))})}var n=void 0;return t&&(n=new T.default(function(t){e.logger.info("configuring ice gathering"),e.pc.onicecandidate=function(r){if(!r.candidate)return e.logger.info("ice gathering complete"),e.pc.onicecandidate=void 0,void t();e.logger.info("got ice candidate")}})),n}},{key:"createOffer",value:function(){var e=this;this.logger.info("beginning negotiation");var t=U(this,"video"),r=t.includes("send")||t.includes("recv"),n=this._prepareIceGatherer();return new T.default(function(t){if(e.gumming)return e.logger.info("gum in flight, waiting until it completes"),void t(e._getUserMedia().then((0,Yw.tap)(function(){return e.logger.info("gum completed")})));t()}).then((0,Yw.tap)(function(){return e.logger.info("starting create offer",e.offerOptions)})).then(function(){return e.offerOptions.offerToReceiveAudio=!!e.offerOptions.offerToReceiveAudio,e.offerOptions.offerToReceiveVideo=!!e.offerOptions.offerToReceiveVideo,e.logger.info("creating REAL offer",e.offerOptions),e.logger.info("createOffer audioDirection: "+e.audioDirection),e.logger.info("createOffer videoDirection: "+e.videoDirection),e.logger.info("createOffer screenDirection: "+e.screenDirection),e.updateLocalMediaToTargetDirection(),e.pc.createOffer(e.offerOptions)}).then((0,Yw.tap)(function(t){t.sdp=(0,rD.limitBandwith)(e.bandwidthLimit,t.sdp),t.sdp=(0,rD.removeExtmap)(t.sdp)})).then((0,Yw.tap)(function(){return e.logger.info("setting local description")})).then(function(t){return e.pc.setLocalDescription(t)}).then((0,Yw.tap)(function(){return n&&e.logger.info("blocking for ice gathering")})).then(function(){return n}).then((0,Yw.tap)(function(){return e.logger.info("limiting bandwith")})).then(function(){return(0,rD.limitBandwith)(e.bandwidthLimit,e.pc.localDescription.sdp)}).then((0,Yw.tap)(function(){return r&&e.logger.info("confirm h264 in offer")})).then((0,rD.ensureH264)(r)).then(function(t){if(e.localScreenShare){var r=e.localScreenShare.id,n=e.localScreenShare.getVideoTracks()[0];if(n){var i=r+" "+n.id,o=t.split(i);if(o[1])return o[1]="\r\na=content:slides"+o[1],t=o.join(i)}t+="a=content:slides\r\n"}return t}).then((0,Yw.tap)(function(t){e.offerSdp=t}))}},{key:"acceptAnswer",value:function(e){var t=this;this.logger.info("accepting answer"),this.logger.debug("new answer sdp:",e);var r=e.replace(/max-mbps=27600;max-fs=920/g,"max-mbps=27600;max-fs=8160");return r=r.replace(/m=video 0(.*?\r\n)/,"m=video 0$1a=inactive\r\n"),r=(0,rD.removeExtmap)(r),this.logger.debug("cleaned answer sdp:",r),"have-local-offer"===this.pc.signalingState?this.pc.setRemoteDescription(new RTCSessionDescription({sdp:r,type:"answer"})).then(function(){t.logger.info("answer accepted"),t.answerSdp=r,t.sendingAudio=(0,rD.getMediaDirectionFromTracks)("audio",t.pc).includes("send"),t.sendingVideo=(0,rD.getMediaDirectionFromTracks)("video",t.pc).includes("send"),t.updateLocalMediaToTargetDirection(),t.trigger("answeraccepted"),t.negotiationNeeded=!1}):T.default.resolve()}},{key:"_setNewMediaDirection",value:function(e,t){var r=this;this.logger.info("setting "+e+" direction to "+t);var n=t.includes("send");if(this.constraints[e]=n,!n)return this.logger.info("muting "+e+" local tracks"),this.localMediaStream?this.localMediaStream.getTracks().filter(function(t){return t.kind===e}).forEach(function(t){r.logger.info("muting existing "+e+" track from localMediaStream");var i=r.pc.getSenders().find(function(e){return e.track===t});I.default.firefox||r.localMediaStream.removeTrack(t),i&&(r.logger.info("muting existing "+e+" track on sender"),i.track.enabled=!1,t.enabled=!1,I.default.firefox||r.pc.removeTrack(i)),r.logger.info("setting sending"+L[e]+" to "+n),r["sending"+L[e]]=n}):T.default.resolve();var i=this.pc.getSenders().filter(function(t){return t.track&&t.track.kind===e});if(i.length>0){this.logger.info("enabling existing "+e+" sender track");var o=this.localMediaStream.getTracks().filter(function(t){return t.kind===e});return i.forEach(function(e){e.track.enabled=o.includes(e.track)}),this["sending"+L[e]]=n,T.default.resolve()}return this[e+"Direction"].includes("send")?T.default.resolve():this._setNewMediaConstraint(e,n)}},{key:"_setNewMediaTrack",value:function(e,t){return this.logger.info("setting new "+e+" track"),this.constraints[e]=!1,this.addOrReplaceTrack(t)}},{key:"_setNewMediaConstraint",value:function(e,t){return this.logger.info("setting "+e+" with new constraint"),this.constraints[e]=t,this._getUserMedia()}},{key:"_setScreenShare",value:function(e,t){var r=this;if(this.logger.info("calling _setScreenShare"),x.set(this,"screen",e),e.includes("send")){var n=(0,A.default)({},t,{mediaSource:"application",width:{min:"160",max:"1920"},height:{min:"90",max:"1080"},frameRate:{min:"1",max:"30"}});this._setNewMediaConstraint("screen",n)}else this.logger.info("removing existing screenshare tracks from peer connection and localScreenShare stream"),this.pc.getSenders().filter(function(e){return e.track&&r.localScreenShare.getTracks().includes(e.track)}).forEach(function(e){r.logger.info("removing screenshare track "+e.track.id+" from peer connection and localScreenShare stream");var t=e.track;e.track.enabled=!1,r.localScreenShare.removeTrack(t),r.pc.removeTrack(e),t.stop(),r.logger.info("removed screenshare track "+t.id+" from peer connection and localScreenShare stream")}),this.localScreenShare=!1}},{key:"setMedia",value:function(e,t,r){var n=this;return this.logger.info("setMedia"),"screen"===e?(this.logger.info("setMedia: setting new screen direction"),this._setScreenShare(t,r),T.default.resolve()):new T.default(function(i){if(r){if(!t.includes("send"))throw new Error("Cannot set new "+e+" track or constraint if direction does not include send");if(r instanceof MediaStreamTrack){if(r.kind!==e)throw new Error("track is not a valid "+e+" media stream track");i(n._setNewMediaTrack(e,r))}else i(n._setNewMediaConstraint(e,r))}else t===U(n,e)&&(n.logger.info("setMedia: "+e+" already transitioning to "+t+", not making changes"),i()),t===n[e+"Direction"]&&(n.logger.info("setMedia: "+e+" already set to "+t+", not making changes"),i()),i(n._setNewMediaDirection(e,t))}).then(function(){var r=t.includes("recv");n.logger.info("setMedia: set targetMediaDirection for "+e+" to "+t),x.set(n,e,t),n.logger.info("setMedia: set offerToReceive"+(0,rD.kindToPropertyFragment)(e)+" to "+r),n.offerOptions["offerToReceive"+(0,rD.kindToPropertyFragment)(e)]=r;var i=n.pc.getReceivers().filter(function(t){return t.track&&t.track.kind===e});r?i.length>0?(n.logger.info("setMedia: unpause existing receiving "+e+" track"),n.unpauseReceivingMedia(e)):!i.length&&n.answerSdp&&(n.logger.info("setMedia: no receiving "+e+" track exists, trigger negotiation"),n.triggerNegotiationNeeded()):i.length>0&&(n.logger.info("setMedia: pausing existing receiving "+e+" track"),n.pauseReceivingMedia(e))})}},{key:"_getUserMedia",value:function(){var t=this;return this.logger.info("enqueing request to get user media"),new T.default(function(e){return pu(e)}).then(function(){!0===t.constraints.audio&&t.pc.getSenders().find(function(e){return e.track&&"audio"===e.track.kind})&&(t.logger.info("already have a local audio track, removing constraint for a second one"),(0,S.default)(t.constraints,"audio")),!0===t.constraints.video&&t.pc.getSenders().find(function(e){return e.track&&"video"===e.track.kind})&&(t.logger.info("already have a local video track, removing constraint for a second one"),(0,S.default)(t.constraints,"video"));var r=t.constraints,n=r.audio,i=r.video,o=r.screen;return t.logger.info("getting user media with "+(n?"1":"0")+" audio track, "+(i?"1":"0")+" video track, and "+(o?"1":"0")+" screenshare track."),T.default.all([(n||i)&&e.getUserMedia({audio:n,video:i}),o&&e.getUserMedia({video:o})])}).then(function(e){var r=(0,E.default)(e,2),n=r[0],i=r[1],o=[];if(n&&(t.logger.info("got local media stream with "+n.getAudioTracks().length+" audio tracks and "+n.getVideoTracks().length+" video tracks"),n.getTracks().forEach(function(e){return o.push(t.addOrReplaceTrack(e))})),i){if(t.localScreenShare){var a=t.pc.getSenders().find(function(e){return t.localScreenShare.getTracks().includes(e.track)});a&&(t.logger.info("removing existing screenshare track from localScreenShare stream"),t.localScreenShare.removeTrack(a.track),t.logger.info("disabling existing screenshare track on sender"),a.track.enabled=!1),i.getTracks().forEach(function(e){a?(t.logger.info("replacing existing screenshare track on sender"),o.push(a.replaceTrack(e))):(t.logger.info("adding new screen track to peerConnection"),t.pc.addTrack(e,i))})}else t.logger.info("adding localScreenShare for the first time"),t.logger.info("adding new screenshare track to peer connection"),i.getVideoTracks().forEach(function(e){return t.pc.addTrack(e,i)});t.localScreenShare=i}return t.constraints={},T.default.all(o)}).catch(function(e){return t.trigger("error",e),T.default.reject(e)})}},{key:"addOrReplaceTrack",value:function(e){var t=this,r=[];this.localMediaStream||(this.localMediaStream=new MediaStream);var n=this.pc.getSenders().find(function(t){return t.track&&t.track.kind===e.kind}),i=this.localMediaStream.getTracks().find(function(t){return t.kind===e.kind});return i!==e&&(i&&(this.logger.info("removing previous "+i.kind+" track from localMediaStream"),this.localMediaStream.removeTrack(i)),this.logger.info("adding new "+e.kind+" track to localMediaStream"),this.localMediaStream.addTrack(e)),n?n.track===e?(this.logger.info("new track is the same as existing track, renabling "+e.kind+" track on sender"),n.track.enabled=!0):(this.logger.info("replacing new "+e.kind+" on existing sender"),r.push(n.replaceTrack(e).then(function(){t.logger.info("successfully replace "+e.kind+" on existing sender")}).catch(function(r){t.logger.warn(r),t.logger.warn("was not able to replace "+e.kind+" track on sender"),t.logger.info("adding as new "+e.kind+" track to peerConnection"),t.pc.removeTrack(n),t.pc.addTrack(e,t.localMediaStream)}))):(this.logger.info("adding new "+e.kind+" track to peerConnection"),this.pc.addTrack(e,this.localMediaStream)),this.logger.info("setting sending"+L[e.kind]+" to true"),this["sending"+L[e.kind]]=!0,T.default.all(r)}},{key:"pauseSendingMedia",value:function(e){var t=this;if(!e)throw new Error("kind is required");var r=this.pc.getSenders().filter(function(t){return t.track&&t.track.kind===e});if(0===r.length)throw new Error("No "+e+" media senders to pause");r.forEach(function(r){t.logger.info("pausing "+e+" sender"),r.track.enabled=!1}),this.logger.info("setting sending"+L[e]+" to false"),this["sending"+L[e]]=!1}},{key:"updateLocalMediaToTargetDirection",value:function(){var e=this;["audio","video"].forEach(function(t){var r=U(e,t),n=e[t+"Direction"];if(n!==r){var i=r.includes("send");n.includes("send")!==i&&e.pc.getSenders().forEach(function(e){e.track&&e.track.kind===t&&(e.track.enabled=i)});var o=r.includes("recv");n.includes("send")!==o&&e.pc.getReceivers().forEach(function(e){e.track&&e.track.kind===t&&(e.track.enabled=o)})}})}},{key:"unpauseSendingMedia",value:function(e){var t=this;if(!e)throw new Error("kind is required");var r=this.pc.getSenders().filter(function(t){return t.track&&t.track.kind===e});if(0===r.length)throw new Error("No "+e+" media senders to unpause");r.forEach(function(r){t.logger.info("unpausing "+e+" sender"),r.track.enabled=!0}),this.logger.info("setting sending"+L[e]+" to true"),this["sending"+L[e]]=!0}},{key:"pauseReceivingMedia",value:function(e){var t=this;if(!e)throw new Error("kind is required");var r=this.pc.getReceivers().filter(function(t){return t.track&&t.track.kind===e});if(0===r.length)throw new Error("No "+e+" receiver media tracks to pause");r.forEach(function(r){t.logger.info("pausing remote "+e+" track"),r.track.enabled=!1}),this.logger.info("setting receiving"+L[e]+" to false"),this["receiving"+L[e]]=!1}},{key:"unpauseReceivingMedia",value:function(e){var t=this;if(!e)throw new Error("kind is required");var r=this.pc.getReceivers().filter(function(t){return t.track&&t.track.kind===e});if(0===r.length)throw new Error("No "+e+" receiver media tracks to pause");r.forEach(function(r){t.logger.info("unpausing "+e+" receiver track"),r.track.enabled=!0}),this.logger.info("setting receiving"+L[e]+" to true from "+this["receiving"+L[e]]),this["receiving"+L[e]]=!0}},{key:"stop",value:function(){"closed"!==this.pc.signalingState&&(this.pc.getSenders().forEach(function(e){return e.track&&e.track.stop()}),this.pc.close()),this.pc.onnegotiationneeded=void 0,this.pc.ontrack=void 0,this.pc.onicecandidate=void 0,this.ended=!0,this.off()}},{key:"triggerNegotiationNeeded",value:function(){this.trigger("negotiationneeded")}},{key:"serialize",value:function(){return"WebRTCMediaEngine"}}]),e}(),o=j(i.prototype,"localMediaStream",[P.default],{enumerable:!0,initializer:null}),a=j(i.prototype,"remoteMediaStream",[P.default],{enumerable:!0,initializer:null}),s=j(i.prototype,"localScreenShare",[P.default],{enumerable:!0,initializer:null}),u=j(i.prototype,"offerSdp",[P.default],{enumerable:!0,initializer:function(){return""}}),c=j(i.prototype,"answerSdp",[P.default],{enumerable:!0,initializer:function(){return""}}),l=j(i.prototype,"sendingAudio",[P.default],{enumerable:!0,initializer:function(){return!1}}),f=j(i.prototype,"sendingVideo",[P.default],{enumerable:!0,initializer:function(){return!1}}),d=j(i.prototype,"receivingAudio",[P.default],{enumerable:!0,initializer:function(){return!1}}),p=j(i.prototype,"receivingVideo",[P.default],{enumerable:!0,initializer:function(){return!1}}),h=j(i.prototype,"ended",[P.default],{enumerable:!0,initializer:function(){return!1}}),v=j(i.prototype,"constraints",[Bw.nonenumerable],{enumerable:!0,initializer:function(){return{}}}),g=j(i.prototype,"offerOptions",[Bw.nonenumerable],{enumerable:!0,initializer:function(){return{}}}),m=j(i.prototype,"gumming",[Bw.nonenumerable,P.default],{enumerable:!0,initializer:function(){return!1}}),j(i.prototype,"_getUserMedia",[r,Yw.oneFlight],(0,b.default)(i.prototype,"_getUserMedia"),i.prototype),j(i.prototype,"triggerNegotiationNeeded",[n],(0,b.default)(i.prototype,"triggerNegotiationNeeded"),i.prototype),i);t.default=F,(0,y.default)(F.prototype,C.default)});t(nD);var iD=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.webrtcHelpers=t.WebRTCMediaEngine=t.default=void 0,Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n(nD).default}}),Object.defineProperty(t,"WebRTCMediaEngine",{enumerable:!0,get:function(){return n(nD).default}});var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(rD);function n(e){return e&&e.__esModule?e:{default:e}}t.webrtcHelpers=r});t(iD);iD.webrtcHelpers,iD.WebRTCMediaEngine;var oD=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=t.locusEventKeys=["locus.summary","locus.self_changed","locus.participant_joined","locus.participant_left","locus.participant_declined","locus.participant_alerted","locus.participant_updated","locus.participant_roles_updated","locus.participant_audio_muted","locus.participant_audio_unmuted","locus.participant_video_muted","locus.participant_video_unmuted","locus.floor_granted","locus.floor_released","locus.space_users_modified","locus.controls_updated","locus.participant_controls_updated"];t.default=r});t(oD);oD.locusEventKeys;var aD=function(e){return e&&e.length?e[0]:void 0},sD=vb(function(e,t){return mk(e)?PC(e,Xv(t,1,mk,!0)):[]}),uD=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DESYNC=t.LESS_THAN=t.GREATER_THAN=t.FETCH=t.EQUAL=t.USE_CURRENT=t.USE_INCOMING=void 0;var r=v(FR),n=v(pb),i=v(Hk),o=v(Xw),a=v(_f),s=v(Cf),u=v(mR),c=v(Ev),l=v(Mv),f=v(aD),d=v(sD),p=v(gg),h=v(lP);function v(e){return e&&e.__esModule?e:{default:e}}var g=t.USE_INCOMING="USE_INCOMING",m=t.USE_CURRENT="USE_CURRENT",y=t.EQUAL="EQUAL",_=t.FETCH="FETCH",b=t.GREATER_THAN="GREATER_THAN",E=t.LESS_THAN="LESS_THAN",S=t.DESYNC="DESYNC";function T(e){switch(e){case y:case b:return m;case E:return g;case S:return _;default:throw new Error(e+" is not a recognized sequence comparison result")}}var w=MP.SparkPlugin.extend({namespace:"Locus",alert:function(e){return this.request({method:"PUT",uri:e.url+"/participant/alert",body:{deviceUrl:this.spark.internal.device.url,sequence:e.sequence}}).then(function(e){return e.body})},compare:function(e,t){function r(e){var t=e.sequence;return!(t.entries&&t.entries.length||0!==t.rangeStart||0!==t.rangeEnd)}return r(e)||r(t)?g:t.baseSequence?this.compareDelta(e,t):T(this.compareSequence(e.sequence,t.sequence))},compareDelta:function(e,t){var r=this.compareSequence(e.sequence,t.sequence);if(r!==E)return T(r);switch(r=this.compareSequence(e.sequence,t.baseSequence)){case b:case y:return g;default:return _}},compareSequence:function(e,t){if(!e)throw new Error("`current` is required");if(!t)throw new Error("`incoming` is required");var r=(0,c.default)(function(e){return 0===e.entries.length?0:(0,f.default)(e.entries)}),n=(0,c.default)(function(e){return 0===e.entries.length?0:(0,l.default)(e.entries)}),i=(0,c.default)(function(e){return e.rangeStart||r(e)}),o=(0,c.default)(function(e){return n(e)||e.rangeEnd});function a(e,t){return e>=t.rangeStart&&e<=t.rangeEnd}if(i(e)>o(t))return b;if(o(e)<i(t))return E;var s=(0,d.default)(e.entries,t.entries),p=(0,d.default)(t.entries,e.entries),h=[],v=[],g=!0,m=!1,_=void 0;try{for(var T,w=(0,u.default)(s);!(g=(T=w.next()).done);g=!0){var O=T.value;a(O,t)||h.push(O)}}catch(e){m=!0,_=e}finally{try{!g&&w.return&&w.return()}finally{if(m)throw _}}var k=!0,R=!1,A=void 0;try{for(var I,P=(0,u.default)(p);!(k=(I=P.next()).done);k=!0){var C=I.value;a(C,e)||v.push(C)}}catch(e){R=!0,A=e}finally{try{!k&&P.return&&P.return()}finally{if(R)throw A}}if(!h.length&&!v.length)return e.rangeEnd-i(e)>t.rangeEnd-i(t)?b:e.rangeEnd-i(e)<t.rangeEnd-i(t)?E:y;if(h.length&&!v.length)return b;if(!h.length&&v.length)return E;if(!(e.rangeStart||e.rangeEnd||t.rangeStart||t.rangeEnd))return S;var M=!0,N=!1,D=void 0;try{for(var j,x=(0,u.default)(h);!(M=(j=x.next()).done);M=!0){var L=j.value;if(i(t)<L&&L<o(t))return S}}catch(e){N=!0,D=e}finally{try{!M&&x.return&&x.return()}finally{if(N)throw D}}var U=!0,F=!1,G=void 0;try{for(var q,V=(0,u.default)(v);!(U=(q=V.next()).done);U=!0){var B=q.value;if(i(e)<B&&B<o(e))return S}}catch(e){F=!0,G=e}finally{try{!U&&V.return&&V.return()}finally{if(F)throw G}}return h[0]>v[0]?b:E},create:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.correlationId;if(!r)throw new Error("options.correlationId is required");return this.request({method:"POST",service:"locus",resource:"loci/call",body:{correlationId:r,deviceUrl:this.spark.internal.device.url,invitee:{invitee:e},localMedias:[{localSdp:(0,s.default)({type:"SDP",sdp:t.localSdp})}],sequence:{entries:[],rangeStart:0,rangeEnd:0}}}).then(function(e){return e.body.locus})},createOrJoin:function(e,t){return e.url?this.join(e,t):this.create(e,t)},decline:function(e){var t=this;return this.request({method:"PUT",uri:e.url+"/participant/decline",body:{deviceUrl:this.spark.internal.device.url,sequence:e.sequence}}).then(function(e){return e.body}).catch(function(r){return r instanceof MP.SparkHttpError.Conflict?t.get(e):a.default.reject(r)})},get:function(e){return this.request({method:"GET",uri:""+e.url}).then(function(e){return e.body})},getCallHistory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new Date(e.from||Date.now()).toISOString();return this.request({method:"GET",service:"janus",resource:"history/userSessions",qs:{from:t}}).then(function(e){return e.body})},join:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.correlationId||t.correlationId;if(!r)throw new Error("locus.correlationId or options.correlationId is required");return this.request({method:"POST",uri:e.url+"/participant",body:{correlationId:r,deviceUrl:this.spark.internal.device.url,localMedias:[{localSdp:(0,s.default)({type:"SDP",sdp:t.localSdp})}],sequence:e.sequence||{entries:[],rangeStart:0,rangeEnd:0}}}).then(function(e){return e.body.locus})},leave:function(e){var t=this;return this.request({method:"PUT",uri:e.self.url+"/leave",body:{deviceUrl:this.spark.internal.device.url,sequence:e.sequence}}).then(function(e){return e.body.locus}).catch(function(r){return r instanceof MP.SparkHttpError.Conflict?t.get(e):a.default.reject(r)})},list:function(){return this.request({method:"GET",service:"locus",resource:"loci"}).then(function(e){return e.body.loci})},merge:function(e,t){if(!t.baseSequence)return t;var a=(0,p.default)(e);if((0,o.default)(t).forEach(function(e){"baseSequence"!==e&&"participants"!==e&&(a[e]=t[e]||a[e])}),t.participants||t.participants.length){var s=new i.default,u=new n.default;t.participants.forEach(function(e){e.removed?s.add(e.url):u.set(e.url,e)});var c=a.participants.reduce(function(e,t){return s.has(t.url)||(e[t.url]=t),e},{});u.forEach(function(e,t){c[t]=e}),a.participants=(0,r.default)(c)}return a},releaseFloorGrant:function(e,t){return this.spark.request({uri:t.url,method:"PUT",body:{floor:{disposition:"RELEASED"}}}).then(function(e){return e.body})},requestFloorGrant:function(e,t){return this.spark.request({uri:t.url,method:"PUT",body:{floor:{beneficiary:{url:e.self.url,devices:[{url:this.spark.internal.device.url}]},disposition:"GRANTED"}}}).then(function(e){return e.body})},sendDtmf:function(e,t){return this.request({method:"POST",uri:e.self.url+"/sendDtmf",body:{deviceUrl:this.spark.internal.device.url,dtmf:{correlationId:h.default.v4(),tones:t}}})},sync:function(e){return this.request({method:"GET",uri:e.syncUrl}).then(function(e){return e.body||{}})},updateMedia:function(e,t){var r=t.sdp,n=t.audioMuted,i=t.videoMuted,o=t.mediaId,a={audioMuted:n,videoMuted:i};return r&&(a.type="SDP",a.sdp=r),this.request({method:"PUT",uri:e.self.url+"/media",body:{deviceUrl:this.spark.internal.device.url,localMedias:[{localSdp:(0,s.default)(a),mediaId:o}],sequence:e.sequence}}).then(function(e){return e.body.locus})},version:"1.50.6"});t.default=w});t(uD);uD.DESYNC,uD.LESS_THAN,uD.GREATER_THAN,uD.FETCH,uD.EQUAL,uD.USE_CURRENT,uD.USE_INCOMING;var cD=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var lD=function(e){return cD.test(e)};var fD=function(e){return e.split("")},dD="[\\ud800-\\udfff]",pD="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",hD="\\ud83c[\\udffb-\\udfff]",vD="[^\\ud800-\\udfff]",gD="(?:\\ud83c[\\udde6-\\uddff]){2}",mD="[\\ud800-\\udbff][\\udc00-\\udfff]",yD="(?:"+pD+"|"+hD+")"+"?",_D="[\\ufe0e\\ufe0f]?"+yD+("(?:\\u200d(?:"+[vD,gD,mD].join("|")+")[\\ufe0e\\ufe0f]?"+yD+")*"),bD="(?:"+[vD+pD+"?",pD,gD,mD,dD].join("|")+")",ED=RegExp(hD+"(?="+hD+")|"+bD+_D,"g");var SD=function(e){return e.match(ED)||[]};var TD=function(e){return lD(e)?SD(e):fD(e)};var wD=function(e){return function(t){t=Pv(t);var r=lD(t)?TD(t):void 0,n=r?r[0]:t.charAt(0),i=r?dN(r,1).join(""):t.slice(1);return n[e]()+i}}("toUpperCase");var OD=function(e){return wD(Pv(e).toLowerCase())};var kD=function(e,t,r,n){var i=-1,o=null==e?0:e.length;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r},RD=iO({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),AD=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ID=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");var PD=function(e){return(e=Pv(e))&&e.replace(AD,RD).replace(ID,"")},CD=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var MD=function(e){return e.match(CD)||[]},ND=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var DD=function(e){return ND.test(e)},jD="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",xD="["+jD+"]",LD="\\d+",UD="[\\u2700-\\u27bf]",FD="[a-z\\xdf-\\xf6\\xf8-\\xff]",GD="[^\\ud800-\\udfff"+jD+LD+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",qD="(?:\\ud83c[\\udde6-\\uddff]){2}",VD="[\\ud800-\\udbff][\\udc00-\\udfff]",BD="[A-Z\\xc0-\\xd6\\xd8-\\xde]",zD="(?:"+FD+"|"+GD+")",WD="(?:"+BD+"|"+GD+")",HD="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",YD="[\\ufe0e\\ufe0f]?"+HD+("(?:\\u200d(?:"+["[^\\ud800-\\udfff]",qD,VD].join("|")+")[\\ufe0e\\ufe0f]?"+HD+")*"),$D="(?:"+[UD,qD,VD].join("|")+")"+YD,XD=RegExp([BD+"?"+FD+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[xD,BD,"$"].join("|")+")",WD+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[xD,BD+zD,"$"].join("|")+")",BD+"?"+zD+"+(?:['’](?:d|ll|m|re|s|t|ve))?",BD+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",LD,$D].join("|"),"g");var JD=function(e){return e.match(XD)||[]};var KD=function(e,t,r){return e=Pv(e),void 0===(t=r?void 0:t)?DD(e)?JD(e):MD(e):e.match(t)||[]},QD=RegExp("['’]","g");var ZD=function(e){return function(t){return kD(KD(PD(t).replace(QD,"")),e,"")}}(function(e,t,r){return t=t.toLowerCase(),e+(r?OD(t):t)}),ej=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Forbidden=t.NotAuthorized=t.BadRequest=t.UnknownResponse=t.ConnectionError=void 0;var r,n,i,o,a,s,u,c,l,f,d=y(lR),p=y(rT),h=y(By),v=y(Yy),g=y(nT),m=y(iT);function y(e){return e&&e.__esModule?e:{default:e}}var _=t.ConnectionError=(n=r=function(e){function t(){return(0,h.default)(this,t),(0,g.default)(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return(0,m.default)(t,e),(0,v.default)(t,[{key:"parse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,d.default)(this,{code:{value:e.code},reason:{value:e.reason}}),e.reason}}]),t}(Yw.Exception),r.defaultMessage="Failed to connect to socket",n);t.UnknownResponse=(o=i=function(e){function t(){return(0,h.default)(this,t),(0,g.default)(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return(0,m.default)(t,e),t}(_),i.defaultMessage="UnknownResponse is produced by IE when we receive a 4XXX. You probably want to treat this like a NotFound",o),t.BadRequest=(s=a=function(e){function t(){return(0,h.default)(this,t),(0,g.default)(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return(0,m.default)(t,e),t}(_),a.defaultMessage="BadRequest usually implies an attempt to use service account credentials",s),t.NotAuthorized=(c=u=function(e){function t(){return(0,h.default)(this,t),(0,g.default)(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return(0,m.default)(t,e),t}(_),u.defaultMessage="Please refresh your access token",c),t.Forbidden=(f=l=function(e){function t(){return(0,h.default)(this,t),(0,g.default)(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return(0,m.default)(t,e),t}(_),l.defaultMessage="Forbidden usually implies these credentials are not entitled for Spark",f)});t(ej);ej.Forbidden,ej.NotAuthorized,ej.BadRequest,ej.UnknownResponse,ej.ConnectionError;var tj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=g(Cf),n=g(kR),i=g(Xw),o=g(_f),a=g(rT),s=g(By),u=g(Yy),c=g(nT),l=g(iT),f=g(h_),d=g(ud),p=g(fk),h=g(cS),v=g(lP);function g(e){return e&&e.__esModule?e:{default:e}}var m=new f.default,y=function(e){function t(){(0,s.default)(this,t);var e=(0,c.default)(this,(t.__proto__||(0,a.default)(t)).call(this));return e.onmessage=e.onmessage.bind(e),e.onclose=e.onclose.bind(e),e}return(0,l.default)(t,e),(0,u.default)(t,[{key:"close",value:function(e){var t=this;return new o.default(function(r,n){t.logger.info("socket: closing");var i=m.get(t);if(2===i.readyState||3===i.readyState)return t.logger.info("socket: already closed"),void r();if((e=e||{}).code&&1e3!==e.code&&(e.code<3e3||e.code>4999))n(new Error("`options.code` must be 1000 or between 3000 and 4999 (inclusive)"));else{e=(0,h.default)(e,{code:1e3,reason:"Done"});var o=(0,Qw.safeSetTimeout)(function(){try{t.logger.info("socket: no close event received, forcing closure"),r(t.onclose({code:1e3,reason:"Done (forced)"}))}catch(e){t.logger.warn("socket: force-close failed",e)}},t.forceCloseDelay);i.onclose=function(e){t.logger.info("socket: close event fired",e.code,e.reason),clearTimeout(o),t.onclose(e),r(e)},i.close(e.code,e.reason)}})}},{key:"open",value:function(e,r){var a=this;return new o.default(function(o,s){if(e)if(m.get(a))s(new Error("Socket#open() can only be called once per instance"));else{r=r||{},(0,Yw.checkRequired)(["forceCloseDelay","pingInterval","pongTimeout","token","trackingId","logger"],r),(0,i.default)(r).forEach(function(e){(0,n.default)(a,e,{enumerable:!1,value:r[e]})});var u=t.getWebSocketConstructor();a.logger.info("socket: creating WebSocket");var c=new u(e);c.binaryType="arraybuffer",c.onmessage=a.onmessage,c.onclose=function(e){switch((e=a._fixCloseCode(e)).code){case 1005:return s(new ej.UnknownResponse(e));case 4400:return s(new ej.BadRequest(e));case 4401:return s(new ej.NotAuthorized(e));case 4403:return s(new ej.Forbidden(e));default:return s(new ej.ConnectionError(e))}},c.onopen=function(){a.logger.info("socket: connected"),a._authorize().then(function(){a.logger.info("socket: authorized"),c.onclose=a.onclose,o()}).catch(s)},c.onerror=function(e){a.logger.warn("socket: error event fired",e)},m.set(a,c),a.logger.info("socket: waiting for server")}else s(new Error("`url` is required"))})}},{key:"onclose",value:function(e){this.logger.info("socket: closed",e.code,e.reason),clearTimeout(this.pongTimer),clearTimeout(this.pingTimer),e=this._fixCloseCode(e),this.emit("close",e),this.removeAllListeners()}},{key:"onmessage",value:function(e){try{var t=JSON.parse(e.data),r=parseInt(t.sequenceNumber,10);this.logger.debug("socket: sequence number: ",r),this.expectedSequenceNumber&&r!==this.expectedSequenceNumber&&(this.logger.debug("socket: sequence number mismatch indicates lost mercury message. expected: "+this.expectedSequenceNumber+", actual: "+r),this.emit("sequence-mismatch",r,this.expectedSequenceNumber)),this.expectedSequenceNumber=r+1;var n={data:t};this._acknowledge(n),"pong"===t.type?this.emit("pong",n):this.emit("message",n)}catch(e){this.logger.warn("socket: error while receiving WebSocket message",e)}}},{key:"send",value:function(e){var t=this;return new o.default(function(n,i){return 1!==t.readyState?i(new Error("INVALID_STATE_ERROR")):((0,d.default)(e)&&(e=(0,r.default)(e)),m.get(t).send(e),n())})}},{key:"_acknowledge",value:function(e){return e?(0,p.default)(e,"data.id")?this.send({messageId:e.data.id,type:"ack"}):o.default.reject(new Error("`event.data.id` is required")):o.default.reject(new Error("`event` is required"))}},{key:"_authorize",value:function(){var e=this;return new o.default(function(t){e.logger.info("socket: authorizing"),e.send({id:v.default.v4(),type:"authorization",data:{token:e.token},trackingId:e.trackingId,logLevelToken:e.logLevelToken});e.once("message",function r(n){n.data.type||"mercury.buffer_state"!==n.data.data.eventType&&"mercury.registration_status"!==n.data.data.eventType||(e.removeListener("message",r),e._ping(),t())})})}},{key:"_fixCloseCode",value:function(e){if(1005===e.code&&e.reason)switch(e.reason.toLowerCase()){case"replaced":this.logger.info("socket: fixing CloseEvent code for reason: ",e.reason),e.code=4e3;break;case"authentication failed":case"authentication did not happen within the timeout window of 30000 seconds.":this.logger.info("socket: fixing CloseEvent code for reason: ",e.reason),e.code=1008}return e}},{key:"_ping",value:function(e){var t=this;return e=e||v.default.v4(),this.pongTimer=(0,Qw.safeSetTimeout)(function(){try{t.logger.info("socket: pong not receive in expected period, closing socket"),t.close({code:1e3,reason:"Pong not received"}).catch(function(e){t.logger.warn("socket: failed to close socket after missed pong",e)})}catch(e){t.logger.error("socket: error occurred in onPongNotReceived",e)}},this.pongTimeout),this.once("pong",function(){try{clearTimeout(t.pongTimer),t.pingTimer=(0,Qw.safeSetTimeout)(function(){return t._ping()},t.pingInterval)}catch(e){t.logger.error("socket: error occurred in scheduleNextPingAndCancelPongTimer",e)}}),this.once("pong",function(r){try{t.logger.debug("socket: pong",r.data.id),r.data&&r.data.id!==e&&(t.logger.info("socket: received pong for wrong ping id, closing socket"),t.logger.debug("socket: expected",e,"received",r.data.id),t.close({code:1e3,reason:"Pong mismatch"}))}catch(e){t.logger.error("socket: error occurred in confirmPongId",e)}}),this.logger.debug("socket: ping "+e),this.send({id:e,type:"ping"})}},{key:"binaryType",get:function(){return m.get(this).binaryType}},{key:"bufferedAmount",get:function(){return m.get(this).bufferedAmount}},{key:"extensions",get:function(){return m.get(this).extensions}},{key:"protocol",get:function(){return m.get(this).protocol}},{key:"readyState",get:function(){return m.get(this).readyState}},{key:"url",get:function(){return m.get(this).url}}],[{key:"getWebSocketConstructor",value:function(){throw new Error("Socket.getWebSocketConstructor() must be implemented in an environmentally appropriate way")}}]),t}(fS.EventEmitter);t.default=y});t(tj);var rj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=tj)&&r.__esModule?r:{default:r};n.default.getWebSocketConstructor=function(){return WebSocket},t.default=n.default});t(rj);var nj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return(e=rj,e&&e.__esModule?e:{default:e}).default;var e}})});t(nj);var ij=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n,i,o=m(ac),a=m(yR),s=m(cc),u=m(wf),c=m(Xw),l=m(_f),f=m(WI),d=m(QI),p=m(ZD),h=m(NS),v=m(nj),g=m(yy);function m(e){return e&&e.__esModule?e:{default:e}}function y(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var _=["idle","done (forced)","pong not received","pong mismatch"],b=MP.SparkPlugin.extend((r=(0,Yw.deprecated)("Mercury#listen(): Use Mercury#connect() instead"),n=(0,Yw.deprecated)("Mercury#stopListening(): Use Mercury#disconnect() instead"),y(i={namespace:"Mercury",session:{connected:{default:!1,type:"boolean"},connecting:{default:!1,type:"boolean"},socket:"object",localClusterServiceUrls:"object"},derived:{listening:{deps:["connected"],fn:function(){return this.connected}}},connect:function(e){var t=this;return this.connected?(this.logger.info("mercury: already connected, will not connect again"),l.default.resolve()):(this.connecting=!0,l.default.resolve(this.spark.internal.device.registered||this.spark.internal.device.register()).then(function(){return t.logger.info("mercury: connecting"),t._connectWithBackoff(e)}))},disconnect:function(){var e=this;return new l.default(function(t){if(e.backoffCall&&(e.logger.info("mercury: aborting connection"),e.backoffCall.abort()),e.socket)return e.socket.removeAllListeners("message"),e.once("offline",t),void e.socket.close();t()})},listen:function(){return this.connect()},stopListening:function(){return this.disconnect()},processRegistrationStatusEvent:function(e){this.localClusterServiceUrls=e.localClusterServiceUrls},_applyOverrides:function(e){e.headers&&(0,c.default)(e.headers).forEach(function(t){(0,f.default)(e,t,e.headers[t])})},_prepareUrl:function(e){var t=this;return e||(e=this.spark.internal.device.webSocketUrl),this.spark.internal.feature.getFeature("developer","web-ha-messaging").then(function(r){return r?t.spark.internal.device.useServiceCatalogUrl(e):e}).then(function(t){e=t}).then(function(){return t.spark.internal.feature.getFeature("developer","web-shared-mercury")}).then(function(r){return e=g.default.parse(e,!0),(0,u.default)(e.query,{outboundWireFormat:"text",bufferStates:!0,aliasHttpStatus:!0}),r&&((0,u.default)(e.query,{mercuryRegistrationStatus:!0,isRegistrationRefreshEnabled:!0}),(0,s.default)(e.query,"bufferStates")),(0,d.default)(t,"spark.config.device.ephemeral",!1)&&(e.query.multipleConnections=!0),g.default.format(e)})},_attemptConnection:function(e,t){var r=this,n=new v.default,i=void 0;n.on("close",function(){return r._onclose.apply(r,arguments)}),n.on("message",function(){return r._onmessage.apply(r,arguments)}),n.on("sequence-mismatch",function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r._emit.apply(r,["sequence-mismatch"].concat(t))}),l.default.all([this._prepareUrl(e),this.spark.credentials.getUserToken()]).then(function(e){var t=(0,a.default)(e,2),o=t[0],s=t[1];return i=o,n.open(o,{forceCloseDelay:r.config.forceCloseDelay,pingInterval:r.config.pingInterval,pongTimeout:r.config.pongTimeout,token:s.toString(),trackingId:r.spark.sessionId+"_"+Date.now(),logger:r.logger})}).then(function(){return r.socket=n,r.spark.internal.metrics.submitClientMetrics("web-ha-mercury",{fields:{success:!0},tags:{action:"connected",url:i}}),t(),r.spark.internal.feature.getFeature("developer","web-ha-messaging").then(function(e){return e?r.spark.internal.device.fetchNewUrls(i):l.default.resolve()})}).catch(function(e){return 1006!==e.code&&r.backoffCall&&r.backoffCall.getNumRetries()>0&&r._emit("connection_failed",e,{retries:r.backoffCall.getNumRetries()}),r.logger.info("mercury: connection attempt failed",e),e instanceof ej.UnknownResponse?(r.logger.info("mercury: received unknown response code, refreshing device registration"),r.spark.internal.device.refresh().then(function(){return t(e)})):e instanceof ej.NotAuthorized?(r.logger.info("mercury: received authorization error, reauthorizing"),r.spark.credentials.refresh({force:!0}).then(function(){return t(e)})):e instanceof ej.BadRequest||e instanceof ej.Forbidden?(r.logger.warn("mercury: received unrecoverable response from mercury"),r.backoffCall.abort(),t(e)):e instanceof ej.ConnectionError?r.spark.internal.feature.getFeature("developer","web-ha-messaging").then(function(t){return t?(r.logger.info("mercury: received a generic connection error, will try to connect to another datacenter"),r.spark.internal.metrics.submitClientMetrics("web-ha-mercury",{fields:{success:!1},tags:{action:"failed",error:e.message,url:i}}),r.spark.internal.device.markUrlFailedAndGetNew(i)):null}).then(function(){return t(e)}):t(e)}).catch(function(e){r.logger.error("mercury: failed to handle connection failure",e),t(e)})},_connectWithBackoff:function(e){var t=this;return new l.default(function(r,n){var i=void 0;(i=h.default.call(function(r){t.logger.info("mercury: executing connection attempt "+i.getNumRetries()),t._attemptConnection(e,r)},function(e){return t.connecting=!1,t.backoffCall=void 0,e?(t.logger.info("mercury: failed to connect after "+i.getNumRetries()+" retries; log statement about next retry was inaccurate"),n(e)):(t.connected=!0,t._emit("online"),r())})).setStrategy(new h.default.ExponentialStrategy({initialDelay:t.config.backoffTimeReset,maxDelay:t.config.backoffTimeMax})),t.config.maxRetries&&i.failAfter(t.config.maxRetries),i.on("abort",function(){t.logger.info("mercury: connection aborted"),n()}),i.on("callback",function(e){if(e){var r=i.getNumRetries(),n=Math.min(i.strategy_.nextBackoffDelay_,t.config.backoffTimeMax);t.logger.info("mercury: failed to connect; attempting retry "+(r+1)+" in "+n+" ms")}else t.logger.info("mercury: connected")}),i.start(),t.backoffCall=i})},_emit:function(){try{this.trigger.apply(this,arguments)}catch(e){this.logger.error("mercury: error occurred in event handler",e)}},_getEventHandlers:function(e){var t=e.split("."),r=(0,a.default)(t,2),n=r[0],i=r[1],o=[];if(!this.spark[n]&&!this.spark.internal[n])return o;var s=(0,p.default)("process_"+i+"_event");return(this.spark[n]||this.spark.internal[n])[s]&&o.push({name:s,namespace:n}),o},_onclose:function(e){try{var t=e.reason&&e.reason.toLowerCase(),r=this.socket.url;switch(this.socket.removeAllListeners(),this.unset("socket"),this.connected=!1,this._emit("offline",e),e.code){case 1003:this.logger.info("mercury: Mercury service rejected last message; will not reconnect: "+e.reason),this._emit("offline.permanent",e);break;case 4e3:this.logger.info("mercury: socket replaced; will not reconnect"),this._emit("offline.replaced",e);break;case 1001:case 1005:case 1006:case 1011:this.logger.info("mercury: socket disconnected; reconnecting"),this._emit("offline.transient",e),this._reconnect(r);break;case 1e3:_.includes(t)?(this.logger.info("mercury: socket disconnected; reconnecting"),this._emit("offline.transient",e),this._reconnect(r)):(this.logger.info("mercury: socket disconnected; will not reconnect"),this._emit("offline.permanent",e));break;default:this.logger.info("mercury: socket disconnected unexpectedly; will not reconnect"),this._emit("offline.permanent",e)}}catch(e){this.logger.error("mercury: error occurred in close handler",e)}},_onmessage:function(e){var t=this,r=e.data,n=r.data;return this._applyOverrides(n),this._getEventHandlers(n.eventType).reduce(function(e,r){return e.then(function(){var e=r.namespace,i=r.name;return new l.default(function(r){return r((t.spark[e]||t.spark.internal[e])[i](n))}).catch(function(e){return t.logger.error("mercury: error occurred in autowired event handler for "+n.eventType,e)})})},l.default.resolve()).then(function(){t._emit("event",e.data);var i=n.eventType.split("."),o=(0,a.default)(i,1)[0];t._emit("event:"+o,r),t._emit("event:"+n.eventType,r)}).catch(function(e){t.logger.error("mercury: error occurred processing socket message",e)})},_reconnect:function(e){return this.logger.info("mercury: reconnecting"),this.connect(e)},version:"1.50.6"},"connect",[Yw.oneFlight],(0,o.default)(i,"connect"),i),y(i,"disconnect",[Yw.oneFlight],(0,o.default)(i,"disconnect"),i),y(i,"listen",[r],(0,o.default)(i,"listen"),i),y(i,"stopListening",[n],(0,o.default)(i,"stopListening"),i),i));t.default=b});t(ij);var oj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={mercury:{pingInterval:15e3,pongTimeout:14e3,backoffTimeMax:32e3,backoffTimeReset:1e3,forceCloseDelay:2e3}}});t(oj);var aj=function(e,t,r,n){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(n,a,r(a),e)}return n};var sj=function(e,t,r,n){return Tk(e,function(e,i,o){t(n,e,r(e),o)}),n};var uj=function(e,t){return function(r,n){var i=vp(r)?aj:sj,o=t?t():{};return i(r,e,$P(n,2),o)}},cj=uj(function(e,t,r){e[r?0:1].push(t)},function(){return[[],[]]}),lj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(Af),n=o(_f),i=o(cj);function o(e){return e&&e.__esModule?e:{default:e}}var a=MP.SparkPlugin.extend({namespace:"Feature",getFeature:function(e,t,r){if("developer"!==e&&"user"!==e&&"entitlement"!==e)return n.default.reject(new Error("Invalid feature keyType provided. Only `developer`, `user`, and `entitlement` feature toggles are permitted."));r=r||{};var i=this.spark.internal.device.features[e].get(t);return i?r.full?n.default.resolve(i.serialize()):n.default.resolve(i.value):n.default.resolve(null)},setFeature:function(e,t,r){var i=this;return"developer"!==e&&"user"!==e?n.default.reject(new Error("Only `developer` and `user` feature toggles can be set.")):this.request({method:"POST",api:"feature",resource:"features/users/"+this.spark.internal.device.userId+"/"+e,body:{key:t,mutable:!0,val:r}}).then(function(t){return i.spark.internal.device.features[e].add(t.body,{merge:!0})})},setBundledFeatures:function(e){var t=this;return e.forEach(function(e){e.mutable=e.mutable||"true","USER"!==e.type&&"DEV"!==e.type&&(e.type="USER")}),this.request({method:"POST",api:"feature",resource:"features/users/"+this.spark.internal.device.userId+"/toggles",body:e}).then(function(e){var r=(0,i.default)(e.body.featureToggles,{type:"USER"});t.spark.internal.device.features.user.add(r[0],{merge:!0}),t.spark.internal.device.features.developer.add(r[1],{merge:!0})})},initialize:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];(0,r.default)(MP.SparkPlugin.prototype.initialize,this,t),this.listenToAndRun(this.spark,"change:internal.device.features.developer",this.trigger.bind(this,"change:developer")),this.listenToAndRun(this.spark,"change:internal.device.features.entitlement",this.trigger.bind(this,"change:entitlement")),this.listenToAndRun(this.spark,"change:internal.device.features.user",this.trigger.bind(this,"change:user"))},version:"1.50.6"});t.default=a});t(lj);var fj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={feature:{}}});t(fj),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i(lj).default}});var r=i(lj),n=i(fj);function i(e){return e&&e.__esModule?e:{default:e}}(0,MP.registerInternalPlugin)("feature",r.default,{config:n.default})}));var dj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(yR),n=o(Af),i=o(_f);function o(e){return e&&e.__esModule?e:{default:e}}var a=(0,o(ib).default)("metric id"),s=MP.Batcher.extend({namespace:"Metrics",prepareItem:function(e){return e.appType=e.appType||this.config.appType,e.env=e.env||"TEST",e.time=e.time||Date.now(),e.version=e.version||this.spark.version,i.default.resolve(e)},prepareRequest:function(e){return i.default.resolve(e.map(function(e){return e.postTime=e.postTime||Date.now(),e}))},submitHttpRequest:function(e){return this.spark.request({method:"POST",service:"metrics",resource:"metrics",body:{metrics:e}})},handleHttpSuccess:function(e){var t=this;return i.default.all(e.options.body.metrics.map(function(e){return t.acceptItem(e)}))},handleHttpError:function(e){var t=this;return e instanceof MP.SparkHttpError.NetworkOrCORSError?(this.logger.warn("metrics-batcher: received network error submitting metrics, reenqueuing payload"),i.default.all(e.options.body.metrics.map(function(e){return new i.default(function(r){var n=e[a].nextDelay;n<t.config.batcherRetryPlateau&&(e[a].nextDelay*=2),(0,Qw.safeSetTimeout)(function(){r(t.rerequest(e))},n)})}))):(0,n.default)(MP.Batcher.prototype.handleHttpError,this,[e])},rerequest:function(e){var t=this;return i.default.all([this.getDeferredForRequest(e),this.prepareItem(e)]).then(function(e){var n=(0,r.default)(e,2),i=n[0],o=n[1];t.enqueue(o).then(function(){return t.bounce()}).catch(function(e){return i.reject(e)})})},fingerprintRequest:function(e){return e[a]=e[a]||{nextDelay:1e3},i.default.resolve(e[a])},fingerprintResponse:function(e){return i.default.resolve(e[a])}});t.default=s});t(dj);var pj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=n(_f);function n(e){return e&&e.__esModule?e:{default:e}}var i=n(dj).default.extend({namespace:"Metrics",prepareItem:function(e){return r.default.resolve(e)},prepareRequest:function(e){return r.default.resolve(e)},submitHttpRequest:function(e){return this.spark.request({method:"POST",service:"metrics",resource:"clientmetrics",body:{metrics:e}})}});t.default=i});t(pj);var hj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(_f),n=i(wf);function i(e){return e&&e.__esModule?e:{default:e}}var o=i(dj).default.extend({namespace:"Metrics",prepareItem:function(e){return e.eventPayload.origin=(0,n.default)({buildType:"test",networkType:"unknown"},e.eventPayload.origin),r.default.resolve(e)},prepareRequest:function(e){return e.forEach(function(e){e.eventPayload.originTime.sent=(new Date).toISOString()}),r.default.resolve(e)},submitHttpRequest:function(e){return this.spark.request({method:"POST",service:"metrics",resource:"clientmetrics",body:{metrics:e}})}});t.default=o});t(hj);var vj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n,i=c(ac),o=c(wf),a=c(dj),s=c(pj),u=c(hj);function c(e){return e&&e.__esModule?e:{default:e}}var l,f,d,p,h,v,g=MP.SparkPlugin.extend((r=(0,Yw.deprecated)("Metrics#sendUnstructured() is deprecated; please use Metrics#submit()"),n={children:{batcher:a.default,clientMetricsBatcher:s.default,callDiagnosticEventsBatcher:u.default},namespace:"Metrics",sendUnstructured:function(e,t){return this.submit(e,t)},submit:function(e,t){return this.batcher.request((0,o.default)({key:e},t))},submitClientMetrics:function(e,t,r){var n={metricName:e};if(t.tags&&(n.tags=t.tags),t.fields&&(n.fields=t.fields),t.type&&(n.type=t.type),n.timestamp=Date.now(),r){var i={metrics:[n]};return this.postPreLoginMetric(i,r)}return this.clientMetricsBatcher.request(n)},aliasUser:function(e){return this.request({method:"POST",api:"metrics",resource:"clientmetrics",headers:{"x-prelogin-userid":e},body:{},qs:{alias:!0}})},postPreLoginMetric:function(e,t){var r=this;return this.spark.credentials.getClientToken().then(function(n){return r.request({method:"POST",api:"metrics",resource:"clientmetrics-prelogin",headers:{authorization:n.toString(),"x-prelogin-userid":t},body:e})})},submitCallDiagnosticEvents:function(e){var t={type:"diagnostic-event",eventPayload:e};return this.callDiagnosticEventsBatcher.request(t)},version:"1.50.6"},l=n,f="sendUnstructured",d=[r],p=(0,i.default)(n,"sendUnstructured"),h=n,v={},Object.keys(p).forEach(function(e){v[e]=p[e]}),v.enumerable=!!v.enumerable,v.configurable=!!v.configurable,("value"in v||v.initializer)&&(v.writable=!0),v=d.slice().reverse().reduce(function(e,t){return t(l,f,e)||e},v),h&&void 0!==v.initializer&&(v.value=v.initializer?v.initializer.call(h):void 0,v.initializer=void 0),void 0===v.initializer&&(Object.defineProperty(l,f,v),v=null),n));t.default=g});t(vj);var gj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={device:{preDiscoveryServices:{metricsServiceUrl:"https://metrics-a.wbx2.com/metrics/api/v1",metrics:"https://metrics-a.wbx2.com/metrics/api/v1"}},metrics:{appType:Yw.inBrowser?"browser":"nodejs",batcherWait:500,batcherMaxCalls:50,batcherMaxWait:1500,batcherRetryPlateau:32e3}}});t(gj);var mj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.config=t.default=void 0,Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i(vj).default}});var r=i(vj),n=i(gj);function i(e){return e&&e.__esModule?e:{default:e}}(0,MP.registerInternalPlugin)("metrics",r.default,{config:n.default}),t.config=n.default});t(mj);mj.config;var yj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.UnknownResponse=t.NotAuthorized=t.Forbidden=t.ConnectionError=t.BadRequest=t.config=t.Socket=t.Mercury=t.default=void 0,Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i(ij).default}}),Object.defineProperty(t,"Mercury",{enumerable:!0,get:function(){return i(ij).default}}),Object.defineProperty(t,"Socket",{enumerable:!0,get:function(){return i(nj).default}}),Object.defineProperty(t,"config",{enumerable:!0,get:function(){return i(oj).default}}),Object.defineProperty(t,"BadRequest",{enumerable:!0,get:function(){return ej.BadRequest}}),Object.defineProperty(t,"ConnectionError",{enumerable:!0,get:function(){return ej.ConnectionError}}),Object.defineProperty(t,"Forbidden",{enumerable:!0,get:function(){return ej.Forbidden}}),Object.defineProperty(t,"NotAuthorized",{enumerable:!0,get:function(){return ej.NotAuthorized}}),Object.defineProperty(t,"UnknownResponse",{enumerable:!0,get:function(){return ej.UnknownResponse}});var r=i(ij),n=i(oj);function i(e){return e&&e.__esModule?e:{default:e}}(0,MP.registerInternalPlugin)("mercury",r.default,{config:n.default,onBeforeLogout:function(){return this.disconnect()}})});t(yj);yj.UnknownResponse,yj.NotAuthorized,yj.Forbidden,yj.ConnectionError,yj.BadRequest,yj.config,yj.Socket,yj.Mercury;var _j=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DESYNC=t.LESS_THAN=t.GREATER_THAN=t.FETCH=t.EQUAL=t.USE_CURRENT=t.USE_INCOMING=t.eventKeys=void 0,Object.defineProperty(t,"eventKeys",{enumerable:!0,get:function(){return oD.locusEventKeys}}),Object.defineProperty(t,"USE_INCOMING",{enumerable:!0,get:function(){return uD.USE_INCOMING}}),Object.defineProperty(t,"USE_CURRENT",{enumerable:!0,get:function(){return uD.USE_CURRENT}}),Object.defineProperty(t,"EQUAL",{enumerable:!0,get:function(){return uD.EQUAL}}),Object.defineProperty(t,"FETCH",{enumerable:!0,get:function(){return uD.FETCH}}),Object.defineProperty(t,"GREATER_THAN",{enumerable:!0,get:function(){return uD.GREATER_THAN}}),Object.defineProperty(t,"LESS_THAN",{enumerable:!0,get:function(){return uD.LESS_THAN}}),Object.defineProperty(t,"DESYNC",{enumerable:!0,get:function(){return uD.DESYNC}});var r,n=(r=uD)&&r.__esModule?r:{default:r};(0,MP.registerInternalPlugin)("locus",n.default),t.default=n.default});t(_j);_j.DESYNC,_j.LESS_THAN,_j.GREATER_THAN,_j.FETCH,_j.EQUAL,_j.USE_CURRENT,_j.USE_INCOMING,_j.eventKeys;var bj=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=s(mR),n=s(pb),i=s(_f),o=s(QI),a=s(jN);function s(e){return e&&e.__esModule?e:{default:e}}function u(e){return Boolean(e.self&&d(e.self))}function c(e,t){return u(t)&&t.self.devices.some(function(t){return e.internal.device.url===t.url&&"JOINED"===t.state})}function l(e,t,r){var n=void 0,i=void 0;return r.person.isExternal||(i=r.person.id,n=e.people.inferPersonIdFromUuid(r.person.id)),{_id:r.id,isSelf:t.self.url===r.url,isInitiator:r.isCreator||!1,personUuid:i,personId:n,state:f(r),audioMuted:v(r),videoMuted:g(r)}}function f(e){var t=e.state&&e.state.toLowerCase();switch(t){case"idle":return"notified";case"joined":return"connected";case"left":return"disconnected";default:return t}}function d(e){return e&&"JOINED"===e.state}function p(e){return h(e)[0]}function h(e){return e.participants.filter(function(t){return"USER"===t.type&&t.url!==e.self.url})}function v(e){return d(e)&&!e.status.audioStatus.includes("SEND")}function g(e){return d(e)&&!e.status.videoStatus.includes("SEND")}t.activeParticipants=function(e){return(0,a.default)(e.participants,{state:"JOINED"})},t.direction=function(e){if(!e||!e.self)return"unknown";return e.self.isCreator?"out":"in"},t.waitForMediaShare=function(e){return function(){var t=new i.default(function(t,r){!function n(){try{e.logger.info("checking for media share");var i=e.locus.mediaShares.find(function(e){return"content"===e.name});if(!i)return e.logger.info("did not find media share, waiting for next locus change"),void e.once("change:locus",n);e.logger.info("found media share"),t(i)}catch(t){e.logger.error("something unexpected happened"),e.logger.error(t),r(t)}}()});return i.default.race([t,new i.default(function(e,t){return setTimeout(t(new Error("Could not find media share after 10000ms")),1e4)})])}},t.isActive=function(e){return"ACTIVE"===e.fullState.state},t.isCall=function(e){return e&&e.fullState&&"CALL"===e.fullState.type},t.joined=u,t.joinedOnThisDevice=c,t.participantsToCallMemberships=function(e,t){var i=new n.default,a=new n.default,s=!0,u=!1,c=void 0;try{for(var f,d=(0,r.default)(t.participants);!(s=(f=d.next()).done);s=!0){var p=f.value;"USER"===p.type?i.set(p.url,p):"RESOURCE_ROOM"===p.type&&a.set(p.url,p)}}catch(e){u=!0,c=e}finally{try{!s&&d.return&&d.return()}finally{if(u)throw c}}var h=[];return i.forEach(function(n){var i=l(e,t,n);if(n.devices){var s=!0,u=!1,c=void 0;try{for(var f,d=(0,r.default)(n.devices);!(s=(f=d.next()).done);s=!0){var p=f.value;if("JOINED"===p.state&&"OBSERVE"===(0,o.default)(p,"intent.type")){var m=a.get(p.url);i.audioMuted=v(m),i.videoMuted=g(m)}a.delete(p.url)}}catch(e){u=!0,c=e}finally{try{!s&&d.return&&d.return()}finally{if(u)throw c}}}h.push(i)}),a.forEach(function(r){var n=l(e,t,r);h.push(n)}),h},t.participantToCallMembership=l,t.participantStateToCallMembershipState=f,t.makeInternalCallId=function(e){return e.url+"_"+e.fullState.lastActive},t.mediaDirection=function(e,t){if(!t)return"inactive";if(!t.status)return"inactive";return(t.status[e+"Status"]||"inactive").toLowerCase()},t.participantIsJoined=d,t.remoteParticipant=p,t.remoteParticipants=h,t.remoteAudioMuted=v,t.remoteVideoMuted=g,t.shouldRing=function(e){return"NONE"!==(0,o.default)(e,"self.alertType.action")},t.getState=function(e){return e&&e.fullState&&e.fullState.state.toLowerCase()},t.getStatus=function(e,t,n){if(t){var i=p(t);if(i){if(c(e,t)&&i&&d(i))return"connected";if(t.replaces){var a=!0,s=!1,u=void 0;try{for(var l,f=(0,r.default)(t.replaces);!(a=(l=f.next()).done);a=!0){var h=l.value;if(h.locusUrl===n.url&&h.lastActive===(0,o.default)(n,"fullState.lastActive"))return"replaced"}}catch(e){s=!0,u=e}finally{try{!a&&f.return&&f.return()}finally{if(s)throw u}}}var v=t.self;if("LEFT"===i.state||"LEFT"===v.state)return"disconnected";if("DECLINED"===i.state)return"disconnected";if("NOTIFIED"===i.state)return"ringing"}}return"initiated"},t.getThisDevice=function(e,t){return t&&t.self&&t.self.devices.find(function(t){return t.url===e.internal.device.url})}});t(bj);bj.activeParticipants,bj.direction,bj.waitForMediaShare,bj.isActive,bj.isCall,bj.joined,bj.joinedOnThisDevice,bj.participantsToCallMemberships,bj.participantToCallMembership,bj.participantStateToCallMembershipState,bj.makeInternalCallId,bj.mediaDirection,bj.participantIsJoined,bj.remoteParticipant,bj.remoteParticipants,bj.remoteAudioMuted,bj.remoteVideoMuted,bj.shouldRing,bj.getState,bj.getStatus,bj.getThisDevice;var Ej=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e&&t)return"sendrecv";if(e&&!t)return"sendonly";if(!e&&t)return"recvonly";if(!e&&!t)return"inactive";throw new Error("If you see this error, your JavaScript engine has a major flaw")}});t(Ej);var Sj=Object.prototype.hasOwnProperty,Tj=uj(function(e,t,r){Sj.call(e,r)?++e[r]:np(e,r,1)});var wj=function(e,t,r){var n=null==e?0:e.length;return n?(t=r||void 0===t?1:BE(t),xv(e,t<0?0:t,n)):[]};var Oj=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0};var kj=function(e,t){var r=!0;return Tk(e,function(e,n,i){return r=!!t(e,n,i)}),r};var Rj=function(e,t,r){var n=vp(e)?Oj:kj;return r&&aS(e,t,r)&&(t=void 0),n(e,$P(t,3))},Aj=Object.prototype.hasOwnProperty,Ij=uj(function(e,t,r){Aj.call(e,r)?e[r].push(t):np(e,r,[t])}),Pj=uj(function(e,t,r){np(e,r,t)}),Cj=Math.max;var Mj=function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=null==r?0:BE(r);return i<0&&(i=Cj(n+i,0)),Kb(e,t,i)};var Nj=function(e){return null!=e&&e.length?xv(e,0,-1):[]};var Dj=function(e,t,r){t=Cv(t,e);var n=null==(e=Lv(e,t))?e:e[Dv(Mv(t))];return null==n?void 0:Kv(n,e,r)},jj=vb(Dj),xj=vb(function(e,t,r){var n=-1,i="function"==typeof t,o=Lp(e)?Array(e.length):[];return Tk(e,function(e){o[++n]=i?Kv(t,e,r):Dj(e,t,r)}),o});var Lj=function(e,t,r){for(var n=r+1;n--;)if(e[n]===t)return n;return n},Uj=Math.max,Fj=Math.min;var Gj=function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=n;return void 0!==r&&(i=(i=BE(r))<0?Uj(n+i,0):Fj(i,n-1)),t==t?Lj(e,t,i):$b(e,Xb,i,!0)};var qj=function(e,t){var r=-1,n=Lp(e)?Array(e.length):[];return Tk(e,function(e,i,o){n[++r]=t(e,i,o)}),n};var Vj=function(e,t){return(vp(e)?Mf:qj)(e,$P(t,3))};var Bj=function(e,t,r){for(var n=-1,i=e.length;++n<i;){var o=e[n],a=t(o);if(null!=a&&(void 0===s?a==a&&!vv(a):r(a,s)))var s=a,u=o}return u};var zj=function(e,t){return e>t};var Wj=function(e){return e&&e.length?Bj(e,tg,zj):void 0};var Hj=function(e,t){return e<t};var Yj=function(e){return e&&e.length?Bj(e,tg,Hj):void 0};var $j=function(e,t,r,n,i){return i(e,function(e,i,o){r=n?(n=!1,e):t(r,e,i,o)}),r};var Xj=function(e,t,r){var n=vp(e)?kD:$j,i=arguments.length<3;return n(e,$P(t,4),r,i,Tk)};var Jj=function(e,t,r,n){var i=null==e?0:e.length;for(n&&i&&(r=e[--i]);i--;)r=t(r,e[i],i,e);return r},Kj=cO(!0);var Qj=Sk(function(e,t){return e&&Kj(e,t,Up)},!0);var Zj=function(e,t,r){var n=vp(e)?Jj:$j,i=arguments.length<3;return n(e,$P(t,4),r,i,Qj)};var ex=function(e,t){return(vp(e)?Yp:DN)(e,JM($P(t,3)))},tx=Math.floor,rx=Math.random;var nx=function(e,t){return e+tx(rx()*(t-e+1))};var ix=function(e){var t=e.length;return t?e[nx(0,t-1)]:void 0};var ox=function(e){return ix(gO(e))};var ax=function(e){return(vp(e)?ix:ox)(e)};var sx=function(e,t){var r=-1,n=e.length,i=n-1;for(t=void 0===t?n:t;++r<t;){var o=nx(r,i),a=e[o];e[o]=e[r],e[r]=a}return e.length=t,e};var ux=function(e){return sx(Hp(e))};var cx=function(e){return sx(gO(e))};var lx=function(e){return(vp(e)?ux:cx)(e)};var fx=function(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e};var dx=function(e,t){if(e!==t){var r=void 0!==e,n=null===e,i=e==e,o=vv(e),a=void 0!==t,s=null===t,u=t==t,c=vv(t);if(!s&&!c&&!o&&e>t||o&&a&&u&&!s&&!c||n&&a&&u||!r&&u||!i)return 1;if(!n&&!o&&!c&&e<t||c&&r&&i&&!n&&!o||s&&r&&i||!a&&i||!u)return-1}return 0};var px=function(e,t,r){for(var n=-1,i=e.criteria,o=t.criteria,a=i.length,s=r.length;++n<a;){var u=dx(i[n],o[n]);if(u)return n>=s?u:u*("desc"==r[n]?-1:1)}return e.index-t.index};var hx=function(e,t,r){var n=-1;t=Mf(t.length?t:[tg],Op($P));var i=qj(e,function(e,r,i){return{criteria:Mf(t,function(t){return t(e)}),index:++n,value:e}});return fx(i,function(e,t){return px(e,t,r)})},vx=vb(function(e,t){if(null==e)return[];var r=t.length;return r>1&&aS(e,t[0],t[1])?t=[]:r>2&&aS(t[0],t[1],t[2])&&(t=[t[0]]),hx(e,Xv(t,1),[])});var gx={countBy:Tj,difference:sD,drop:wj,each:wk,every:Rj,filter:jN,find:KP,forEach:wk,groupBy:Ij,includes:yO,keyBy:Pj,indexOf:Mj,initial:Nj,invoke:jj,invokeMap:xj,isEmpty:pg,lastIndexOf:Gj,map:Vj,max:Wj,min:Yj,partition:cj,reduce:Xj,reduceRight:Zj,reject:ex,sample:ax,shuffle:lx,some:rC,sortBy:vx,tail:function(e){var t=null==e?0:e.length;return t?xv(e,1,t):[]},take:function(e,t,r){return e&&e.length?(t=r||void 0===t?1:BE(t),xv(e,0,t<0?0:t)):[]},without:CC},mx=[].slice,yx={};gx.each(["forEach","each","map","reduce","reduceRight","find","filter","reject","every","some","includes","invoke","invokeMap","max","min","take","initial","tail","drop","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","sample","partition"],function(e){gx[e]&&(yx[e]=function(){var t=mx.call(arguments);return t.unshift(this.models),gx[e].apply(gx,t)})});gx.each(["groupBy","countBy","sortBy","keyBy"],function(e){gx[e]&&(yx[e]=function(t,r){var n=hd(t)?t:function(e){return e.get?e.get(t):e[t]};return gx[e](this.models,n,r)})}),yx.where=function(e,t){return gx.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){var r;for(var n in e)if(r=t.get?t.get(n):t[n],e[n]!==r)return!1;return!0})},yx.findWhere=function(e){return this.where(e,!0)},yx.pluck=function(e){return gx.invokeMap(this.models,"get",e)},yx.first=function(){return this.models[0]},yx.last=function(){return this.models[this.models.length-1]},yx.size=function(){return this.models.length};var _x=yx,bx=r(function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0});var n=((r=Vk)&&r.__esModule?r:{default:r}).default.extend({idAttribute:"_id",props:{_id:{required:!0,type:"string"},isSelf:{default:!1,type:"boolean"},isInitiator:{default:!1,required:!0,type:"boolean"},personId:{type:"string"},personUuid:{require:!0,type:"string"},state:{required:!0,type:"string",values:["notified","connected","declined","disconnected","waiting"]},audioMuted:{default:!1,type:"boolean"},videoMuted:{default:!1,type:"boolean"}}});t.default=n});t(bx);var Ex=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(qI),n=o(_x),i=o(bx);function o(e){return e&&e.__esModule?e:{default:e}}var a=r.default.extend(n.default,{model:i.default,mainIndex:"_id"});t.default=a});function Sx(){this.head=null,this.tail=null,this.length=0}t(Ex),Sx.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},Sx.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},Sx.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},Sx.prototype.clear=function(){this.head=this.tail=null,this.length=0},Sx.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},Sx.prototype.concat=function(e){if(0===this.length)return nm.alloc(0);if(1===this.length)return this.head.data;for(var t=nm.allocUnsafe(e>>>0),r=this.head,n=0;r;)r.data.copy(t,n),n+=r.data.length,r=r.next;return t};var Tx=nm.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function wx(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),function(e){if(e&&!Tx(e))throw new Error("Unknown encoding: "+e)}(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=kx;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=Rx;break;default:return void(this.write=Ox)}this.charBuffer=new nm(6),this.charReceived=0,this.charLength=0}function Ox(e){return e.toString(this.encoding)}function kx(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function Rx(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}wx.prototype.write=function(e){for(var t="";this.charLength;){var r=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,r),this.charReceived+=r,this.charReceived<this.charLength)return"";if(e=e.slice(r,e.length),!((i=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&i<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var n=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,n),n-=this.charReceived);var i;n=(t+=e.toString(this.encoding,0,n)).length-1;if((i=t.charCodeAt(n))>=55296&&i<=56319){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),e.copy(this.charBuffer,0,0,o),t.substring(0,n)}return t},wx.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var r=e[e.length-t];if(1==t&&r>>5==6){this.charLength=2;break}if(t<=2&&r>>4==14){this.charLength=3;break}if(t<=3&&r>>3==30){this.charLength=4;break}}this.charReceived=t},wx.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var r=this.charReceived,n=this.charBuffer,i=this.encoding;t+=n.slice(0,r).toString(i)}return t},Px.ReadableState=Ix;var Ax=Ym("stream");function Ix(e,t){e=e||{},this.objectMode=!!e.objectMode,t instanceof iL&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var r=e.highWaterMark,n=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n,this.highWaterMark=~~this.highWaterMark,this.buffer=new Sx,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(this.decoder=new wx(e.encoding),this.encoding=e.encoding)}function Px(e){if(!(this instanceof Px))return new Px(e);this._readableState=new Ix(e,this),this.readable=!0,e&&"function"==typeof e.read&&(this._read=e.read),fS.call(this)}function Cx(e,t,r,n,i){var o=function(e,t){var r=null;Fm(t)||"string"==typeof t||null==t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk"));return r}(t,r);if(o)e.emit("error",o);else if(null===r)t.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,Dx(e)}(e,t);else if(t.objectMode||r&&r.length>0)if(t.ended&&!i){var a=new Error("stream.push() after EOF");e.emit("error",a)}else if(t.endEmitted&&i){var s=new Error("stream.unshift() after end event");e.emit("error",s)}else{var u;!t.decoder||i||n||(r=t.decoder.write(r),u=!t.objectMode&&0===r.length),i||(t.reading=!1),u||(t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,i?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&Dx(e))),function(e,t){t.readingMore||(t.readingMore=!0,pu(xx,e,t))}(e,t)}else i||(t.reading=!1);return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(t)}qm(Px,fS),Px.prototype.push=function(e,t){var r=this._readableState;return r.objectMode||"string"!=typeof e||(t=t||r.defaultEncoding)!==r.encoding&&(e=nm.from(e,t),t=""),Cx(this,r,e,t,!1)},Px.prototype.unshift=function(e){return Cx(this,this._readableState,e,"",!0)},Px.prototype.isPaused=function(){return!1===this._readableState.flowing},Px.prototype.setEncoding=function(e){return this._readableState.decoder=new wx(e),this._readableState.encoding=e,this};var Mx=8388608;function Nx(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=Mx?e=Mx:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function Dx(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(Ax("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?pu(jx,e):jx(e))}function jx(e){Ax("emit readable"),e.emit("readable"),Fx(e)}function xx(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(Ax("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function Lx(e){Ax("readable nexttick read 0"),e.read(0)}function Ux(e,t){t.reading||(Ax("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),Fx(e),t.flowing&&!t.reading&&e.read(0)}function Fx(e){var t=e._readableState;for(Ax("flow",t.flowing);t.flowing&&null!==e.read(););}function Gx(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=function(e,t,r){var n;e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?function(e,t){var r=t.head,n=1,i=r.data;e-=i.length;for(;r=r.next;){var o=r.data,a=e>o.length?o.length:e;if(a===o.length?i+=o:i+=o.slice(0,e),0===(e-=a)){a===o.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(a));break}++n}return t.length-=n,i}(e,t):function(e,t){var r=nm.allocUnsafe(e),n=t.head,i=1;n.data.copy(r),e-=n.data.length;for(;n=n.next;){var o=n.data,a=e>o.length?o.length:e;if(o.copy(r,r.length-e,0,a),0===(e-=a)){a===o.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(a));break}++i}return t.length-=i,r}(e,t);return n}(e,t.buffer,t.decoder),r);var r}function qx(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,pu(Vx,t,e))}function Vx(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function Bx(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}function zx(){}function Wx(e,t,r){this.chunk=e,this.encoding=t,this.callback=r,this.next=null}function Hx(e,t){Object.defineProperty(this,"buffer",{get:zm(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),e=e||{},this.objectMode=!!e.objectMode,t instanceof iL&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var r=e.highWaterMark,n=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var i=!1===e.decodeStrings;this.decodeStrings=!i,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,i=r.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,n,i){--t.pendingcb,r?pu(i,n):i(n);e._writableState.errorEmitted=!0,e.emit("error",n)}(e,r,n,t,i);else{var o=Kx(r);o||r.corked||r.bufferProcessing||!r.bufferedRequest||Jx(e,r),n?pu(Xx,e,r,o,i):Xx(e,r,o,i)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new eL(this)}function Yx(e){if(!(this instanceof Yx||this instanceof iL))return new Yx(e);this._writableState=new Hx(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev)),fS.call(this)}function $x(e,t,r,n,i,o,a){t.writelen=n,t.writecb=a,t.writing=!0,t.sync=!0,r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function Xx(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),Zx(e,t)}function Jx(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,i=new Array(n),o=t.corkedRequestsFree;o.entry=r;for(var a=0;r;)i[a]=r,r=r.next,a+=1;$x(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new eL(t)}else{for(;r;){var s=r.chunk,u=r.encoding,c=r.callback;if($x(e,t,!1,t.objectMode?1:s.length,s,u,c),r=r.next,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=r,t.bufferProcessing=!1}function Kx(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function Qx(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function Zx(e,t){var r=Kx(t);return r&&(0===t.pendingcb?(Qx(e,t),t.finished=!0,e.emit("finish")):Qx(e,t)),r}function eL(e){var t=this;this.next=null,this.entry=null,this.finish=function(r){var n=t.entry;for(t.entry=null;n;){var i=n.callback;e.pendingcb--,i(r),n=n.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}Px.prototype.read=function(e){Ax("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return Ax("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?qx(this):Dx(this),null;if(0===(e=Nx(e,t))&&t.ended)return 0===t.length&&qx(this),null;var n,i=t.needReadable;return Ax("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&Ax("length less than watermark",i=!0),t.ended||t.reading?Ax("reading or ended",i=!1):i&&(Ax("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=Nx(r,t))),null===(n=e>0?Gx(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&qx(this)),null!==n&&this.emit("data",n),n},Px.prototype._read=function(e){this.emit("error",new Error("not implemented"))},Px.prototype.pipe=function(e,t){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e)}n.pipesCount+=1,Ax("pipe count=%d opts=%j",n.pipesCount,t);var i=!t||!1!==t.end?a:c;function o(e){Ax("onunpipe"),e===r&&c()}function a(){Ax("onend"),e.end()}n.endEmitted?pu(i):r.once("end",i),e.on("unpipe",o);var s=function(e){return function(){var t=e._readableState;Ax("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&e.listeners("data").length&&(t.flowing=!0,Fx(e))}}(r);e.on("drain",s);var u=!1;function c(){Ax("cleanup"),e.removeListener("close",p),e.removeListener("finish",h),e.removeListener("drain",s),e.removeListener("error",d),e.removeListener("unpipe",o),r.removeListener("end",a),r.removeListener("end",c),r.removeListener("data",f),u=!0,!n.awaitDrain||e._writableState&&!e._writableState.needDrain||s()}var l=!1;function f(t){Ax("ondata"),l=!1,!1!==e.write(t)||l||((1===n.pipesCount&&n.pipes===e||n.pipesCount>1&&-1!==Bx(n.pipes,e))&&!u&&(Ax("false write response, pause",r._readableState.awaitDrain),r._readableState.awaitDrain++,l=!0),r.pause())}function d(t){var r;Ax("onerror",t),v(),e.removeListener("error",d),0===(r="error",e.listeners(r).length)&&e.emit("error",t)}function p(){e.removeListener("finish",h),v()}function h(){Ax("onfinish"),e.removeListener("close",p),v()}function v(){Ax("unpipe"),r.unpipe(e)}return r.on("data",f),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",d),e.once("close",p),e.once("finish",h),e.emit("pipe",r),n.flowing||(Ax("pipe resume"),r.resume()),e},Px.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var r=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<n;i++)r[i].emit("unpipe",this);return this}var o=Bx(t.pipes,e);return-1===o?this:(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},Px.prototype.on=function(e,t){var r=fS.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&Dx(this):pu(Lx,this))}return r},Px.prototype.addListener=Px.prototype.on,Px.prototype.resume=function(){var e=this._readableState;return e.flowing||(Ax("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,pu(Ux,e,t))}(this,e)),this},Px.prototype.pause=function(){return Ax("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(Ax("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Px.prototype.wrap=function(e){var t=this._readableState,r=!1,n=this;for(var i in e.on("end",function(){if(Ax("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&n.push(e)}n.push(null)}),e.on("data",function(i){(Ax("wrapped data"),t.decoder&&(i=t.decoder.write(i)),t.objectMode&&null==i)||(t.objectMode||i&&i.length)&&(n.push(i)||(r=!0,e.pause()))}),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));return function(e,t){for(var r=0,n=e.length;r<n;r++)t(e[r],r)}(["error","close","destroy","pause","resume"],function(t){e.on(t,n.emit.bind(n,t))}),n._read=function(t){Ax("wrapped _read",t),r&&(r=!1,e.resume())},n},Px._fromList=Gx,Yx.WritableState=Hx,qm(Yx,fS),Hx.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},Yx.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Yx.prototype.write=function(e,t,r){var n=this._writableState,i=!1;return"function"==typeof t&&(r=t,t=null),nm.isBuffer(e)?t="buffer":t||(t=n.defaultEncoding),"function"!=typeof r&&(r=zx),n.ended?function(e,t){var r=new Error("write after end");e.emit("error",r),pu(t,r)}(this,r):function(e,t,r,n){var i=!0,o=!1;return null===r?o=new TypeError("May not write null values to stream"):nm.isBuffer(r)||"string"==typeof r||void 0===r||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),pu(n,o),i=!1),i}(this,n,e,r)&&(n.pendingcb++,i=function(e,t,r,n,i){r=function(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=nm.from(t,r)),t}(t,r,n),nm.isBuffer(r)&&(n="buffer");var o=t.objectMode?1:r.length;t.length+=o;var a=t.length<t.highWaterMark;a||(t.needDrain=!0);if(t.writing||t.corked){var s=t.lastBufferedRequest;t.lastBufferedRequest=new Wx(r,n,i),s?s.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else $x(e,t,!1,o,r,n,i);return a}(this,n,e,t,r)),i},Yx.prototype.cork=function(){this._writableState.corked++},Yx.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||Jx(this,e))},Yx.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Yx.prototype._write=function(e,t,r){r(new Error("not implemented"))},Yx.prototype._writev=null,Yx.prototype.end=function(e,t,r){var n=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||function(e,t,r){t.ending=!0,Zx(e,t),r&&(t.finished?pu(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,n,r)},qm(iL,Px);for(var tL=Object.keys(Yx.prototype),rL=0;rL<tL.length;rL++){var nL=tL[rL];iL.prototype[nL]||(iL.prototype[nL]=Yx.prototype[nL])}function iL(e){if(!(this instanceof iL))return new iL(e);Px.call(this,e),Yx.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",oL)}function oL(){this.allowHalfOpen||this._writableState.ended||pu(aL,this)}function aL(e){e.end()}function sL(e){this.afterTransform=function(t,r){return function(e,t,r){var n=e._transformState;n.transforming=!1;var i=n.writecb;if(!i)return e.emit("error",new Error("no writecb in Transform class"));n.writechunk=null,n.writecb=null,null!=r&&e.push(r);i(t);var o=e._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&e._read(o.highWaterMark)}(e,t,r)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function uL(e){if(!(this instanceof uL))return new uL(e);iL.call(this,e),this._transformState=new sL(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(e){cL(t,e)}):cL(t)})}function cL(e,t){if(t)return e.emit("error",t);var r=e._writableState,n=e._transformState;if(r.length)throw new Error("Calling transform done when ws.length != 0");if(n.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}function lL(e){if(!(this instanceof lL))return new lL(e);uL.call(this,e)}function fL(){fS.call(this)}qm(uL,iL),uL.prototype.push=function(e,t){return this._transformState.needTransform=!1,iL.prototype.push.call(this,e,t)},uL.prototype._transform=function(e,t,r){throw new Error("Not implemented")},uL.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},uL.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},qm(lL,uL),lL.prototype._transform=function(e,t,r){r(null,e)},qm(fL,fS),fL.Readable=Px,fL.Writable=Yx,fL.Duplex=iL,fL.Transform=uL,fL.PassThrough=lL,fL.Stream=fL,fL.prototype.pipe=function(e,t){var r=this;function n(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function i(){r.readable&&r.resume&&r.resume()}r.on("data",n),e.on("drain",i),e._isStdio||t&&!1===t.end||(r.on("end",a),r.on("close",s));var o=!1;function a(){o||(o=!0,e.end())}function s(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){if(c(),0===fS.listenerCount(this,"error"))throw e}function c(){r.removeListener("data",n),e.removeListener("drain",i),r.removeListener("end",a),r.removeListener("close",s),r.removeListener("error",u),e.removeListener("error",u),r.removeListener("end",c),r.removeListener("close",c),e.removeListener("close",c)}return r.on("error",u),e.on("error",u),r.on("end",c),r.on("close",c),e.on("close",c),e.emit("pipe",r),e};var dL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(mR),n=u(rT),i=u(By),o=u(Yy),a=u(nT),s=u(iT);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,{objectMode:!0}))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"_transform",value:function(e,t,n){if(e){var i={local:null,remote:null},o={local:null,remote:null},a={local:null,remote:null},s={local:null,remote:null},u=!0,c=!1,l=void 0;try{for(var f,d=(0,r.default)(e.values());!(u=(f=d.next()).done);u=!0){var p=f.value;["outbound-rtp","outboundrtp"].includes(p.type)&&!p.isRemote&&("audio"===p.mediaType&&(a.local=p,a.remote=e.get(p.remoteId)),"video"===p.mediaType&&(s.local=p,s.remote=e.get(p.remoteId))),["inbound-rtp","inboundrtp"].includes(p.type)&&!p.isRemote&&("audio"===p.mediaType&&(i.local=p,i.remote=e.get(p.remoteId)),"video"===p.mediaType&&(o.local=p,o.remote=e.get(p.remoteId)))}}catch(e){c=!0,l=e}finally{try{!u&&d.return&&d.return()}finally{if(c)throw l}}this.push({incomingAudio:i,incomingVideo:o,outgoingAudio:a,outgoingVideo:s,report:e}),n()}else n()}}]),t}(fL.Transform);t.default=c});t(dL);var pL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(rT),n=u(By),i=u(Yy),o=u(nT),a=u(iT),s=u(h_);function u(e){return e&&e.__esModule?e:{default:e}}var c=new s.default,l=new s.default,f=new s.default,d=new s.default;var p=function(e){function t(e){(0,n.default)(this,t);var i=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this,{objectMode:!0}));c.has(e)||c.set(e,new fS.EventEmitter);var a=c.get(e);return f.has(i)||f.set(i,a),l.has(a)||l.set(a,e),a.once("error",function(e){i.emit("error",e)}),i}return(0,a.default)(t,e),(0,i.default)(t,[{key:"_read",value:function(){var e=this,t=f.get(this);t.once("data",function(t){e.isPaused()||e.push(t)}),d.has(t)||function e(t){var r=(0,Qw.safeSetTimeout)(function(){var r=l.get(t);r.getStats().then(function(n){t.emit("data",n),"closed"!==r.signalingState&&"closed"!==r.connectionState&&e(t)}).catch(function(e){t.emit("error",e)})},1e3);d.set(t,r)}(t)}}]),t}(fL.Readable);t.default=p});t(pL);var hL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n,i,o,a,s=S(ac),u=S(mR),c=S(Af),l=S(wf),f=S(_f),d=S(tS),p=S(QI),h=S(KP),v=S(cS),g=S(lP),m=S(iD),y=S(Ej),_=S(Ex),b=S(dL),E=S(pL);function S(e){return e&&e.__esModule?e:{default:e}}function T(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var w=iD.webrtcHelpers.boolToDirection,O=["ringing","connected","disconnected","replaced"];function k(e,t){var r="string"==typeof t?(0,NN.parse)(t):t,n=void 0;return(n="screen"===e?r.media.find(function(e){return"video"===e.type&&e.content}):r.media.find(function(t){return t.type===e}))&&n.direction?n.direction:"inactive"}function R(e){switch(e){case"inactive":case"sendrecv":return e;case"sendonly":return"recvonly";case"recvonly":return"sendonly";default:throw new Error('direction "'+e+'" is not valid')}}var A={audio:"Audio",video:"Video"},I=MP.SparkPlugin.extend((r=(0,Yw.whileInFlight)("locusJoinInFlight"),n=(0,Yw.deprecated)("Please use Call#reject()"),i=(0,Yw.whileInFlight)("locusLeaveInFlight"),o=(0,ON.debounce)(),T(a={namespace:"Phone",children:{media:m.default},collections:{memberships:_.default},session:{activeParticipantsCount:{default:0,required:!0,type:"number"},remoteAudioMuted:{default:!1,required:!1,type:"boolean"},remoteVideoMuted:{default:!1,required:!1,type:"boolean"},correlationId:"string",facingMode:{type:"string",values:["user","environment"]},internalCallId:{setOnce:!0,type:"string"},locus:"object",localMediaStream:"object",locusJoinInFlight:{default:!1,type:"boolean"},locusLeaveInFlight:{default:!1,type:"boolean"},me:{type:"object"}},derived:{id:{deps:["locus"],fn:function(){return(0,p.default)(this,"locus.url")}},isActive:{deps:["locus"],fn:function(){return!(!this.locus||!(0,bj.isActive)(this.locus))}},joinedOnThisDevice:{deps:["locus"],default:!1,fn:function(){return!(!this.locus||!(0,bj.joinedOnThisDevice)(this.spark,this.locus))}},locusUrl:{deps:["locus"],fn:function(){return(0,p.default)(this,"locus.url")}},device:{deps:["locus"],fn:function(){return(0,bj.getThisDevice)(this.spark,this.locus)}},mediaConnection:{deps:["locus"],fn:function(){var e=(0,bj.getThisDevice)(this.spark,this.locus);return(0,p.default)(e,"mediaConnections[0]")}},mediaId:{deps:["locus"],fn:function(){var e=(0,bj.getThisDevice)(this.spark,this.locus);return(0,p.default)(e,"mediaConnections[0].mediaId")}},remoteMember:{deps:["memberships","locus"],fn:function(){if((0,bj.isCall)(this.locus))return this.memberships.find(function(e){return!e.isSelf})}},direction:{deps:["locus"],fn:function(){return this.locus?(0,bj.direction)(this.locus):"out"}},from:{deps:["memberships"],fn:function(){if(this.isCall)return this.memberships.find(function(e){return e.isInitiator})}},to:{deps:["memberships"],fn:function(){if(this.isCall)return this.memberships.find(function(e){return!e.isInitiator})}},state:{deps:["locus"],fn:function(){if(this.config.enableExperimentalGroupCallingSupport)return(0,bj.getState)(this.locus)}},status:{deps:["locus"],fn:function(){return(0,bj.getStatus)(this.spark,this.locus,this.previousAttributes().locus)}},host:{deps:["locus"],fn:function(){if(this.config.enableExperimentalGroupCallingSupport)return this.locus.host}},roomId:{deps:["locus"],fn:function(){if(this.config.enableExperimentalGroupCallingSupport&&this.locus.conversationUrl)return Yw.base64.encode("ciscospark://us/ROOM/"+this.locus.conversationUrl.split("/").pop())}},remoteMediaStream:{deps:["media.remoteMediaStream"],fn:function(){return this.media.remoteMediaStream}},localScreenShare:{deps:["media.localScreenShare"],fn:function(){return this.media.localScreenShare}},receivingAudio:{deps:["media.receivingAudio"],fn:function(){return this.media.receivingAudio}},receivingVideo:{deps:["media.receivingVideo"],fn:function(){return this.media.receivingVideo}},sendingAudio:{deps:["media.sendingAudio"],fn:function(){return this.media.sendingAudio}},sendingVideo:{deps:["media.sendingVideo"],fn:function(){return this.media.sendingVideo}},isCall:{deps:["locus"],fn:function(){return(0,bj.isCall)(this.locus)}},supportsDtmf:{deps:["locus"],fn:function(){return(0,p.default)(this,"locus.self.enableDTMF")}}},acknowledge:function(){var e=this;return this.logger.info("call: acknowledging"),this.spark.internal.locus.alert(this.locus).then(function(t){return e.setLocus(t)}).then((0,Yw.tap)(function(){return e.logger.info("call: acknowledged")}))},answer:function(e){var t=this;return this.logger.info("call: answering"),this.locus?this.joinedOnThisDevice&&this.media.pc.remoteDescription&&this.media.pc.remoteDescription.sdp?(this.logger.info("call: already joined on this device"),f.default.resolve()):this.createOrJoinLocus(this.locus,e).then((0,Yw.tap)(function(){return t.logger.info("call: answered")})):(this.logger.info("call: no locus provided, answer() is a noop"),f.default.resolve())},changeReceivingMedia:function(e,t){var r=this;return new f.default(function(n){var i=(0,NN.parse)(r.media.offerSdp),o=(0,h.default)(i.media,{type:e});o&&o.direction.includes("recv")?(r.logger.info('changeReceivingMedia: expecting to renegotiate, waiting for call to emit "change:receiving'+A[e]+'"'),r.once("change:receiving"+A[e],function(){return n()})):(r.logger.info('changeReceivingMedia: expecting to renegotiate, waiting for media to emit "answeraccepted"'),r.media.once("answeraccepted",function(){return n()}));var a=(0,y.default)(r.media["sending"+A[e]],t);console.warn("starting to setMedia "+e+" to "+a),r.media.setMedia(e,a)})},changeSendingMedia:function(e,t){var r=this;if(this.logger.info('changeSendingMedia: changing sending "'+e+'" to "'+t+'"'),["audio","video"].includes(e)){var n=this.media.senderTracks.filter(function(t){return t.kind===e}),i=(0,y.default)(t,this.media["receiving"+A[e]]);return n.length>0?this.media.setMedia(e,i).then(function(){return r.updateMuteToggles(e,t)}):new f.default(function(t){r.once("mediaNegotiationCompleted",function(){return t()}),r.media.setMedia(e,i)})}return f.default.reject(new Error('kind must be one of "audio" or "video"'))},cleanup:function(){var e=this;return new f.default(function(t){pu(function(){e.media.stop(),e.stopListening(e.spark.internal.mercury),e.off(),t()})})},createOrJoinLocus:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(r.localMediaStream)this.localMediaStream=r.localMediaStream;else{r.constraints||(r.constraints={audio:!0,video:{facingMode:{ideal:this.spark.phone.defaultFacingMode}}});var n=(0,p.default)(r,"constraints.video.facingMode.ideal",(0,p.default)(r,"constraints.video.facingMode.exact"));"user"!==n&&"environment"!==n||(this.facingMode=n);var i=!r.constraints.audio&&!r.constraints.video;r.offerOptions=(0,v.default)(r.offerOptions,{offerToReceiveAudio:i||!!r.constraints.audio,offerToReceiveVideo:i||!!r.constraints.video}),r.constraints.fake&&(this.media.constraints.fake=!0),this.media.setMedia("audio",(0,y.default)(r.constraints.audio,r.offerOptions.offerToReceiveAudio),r.constraints.audio),"screen"===(0,p.default)(r,"constraints.video.mediaSource")||"application"===(0,p.default)(r,"constraints.video.mediaSource")?this.media.setMedia("screen","sendonly"):this.media.setMedia("video",(0,y.default)(r.constraints.video,r.offerOptions.offerToReceiveVideo),r.constraints.video)}return e.correlationId||(r.correlationId=g.default.v4(),this.correlationId=r.correlationId),this.correlationId||(this.correlationId=e.correlationId),this.media.bandwidthLimit={audioBandwidthLimit:this.config.audioBandwidthLimit,videoBandwidthLimit:this.config.videoBandwidthLimit},this.media.createOffer().then((0,Yw.tap)(function(){return t.logger.info("created offer")})).then(function(){return t.spark.internal.locus.createOrJoin(e,(0,l.default)({localSdp:t.media.offerSdp,correlationId:t.correlationId},r))}).then((0,Yw.tap)(function(){return t.logger.info("sent offer to locus")})).then((0,Yw.tap)(function(){return t.logger.info("setting locus")})).then(function(e){return t.setLocus(e)}).then((0,Yw.tap)(function(){return t.logger.info("successfully set locus")})).then(function(){var e=JSON.parse(t.mediaConnection.remoteSdp).sdp;return t.logger.info("accepting answer"),t.logger.info("peer state",t.media.pc&&t.media.pc.signalingState),t.media.ended?(t.logger.info("call: already ended, not accepting answer"),f.default.resolve()):t.media.acceptAnswer(e).then(function(){return t.logger.info("answer accepted")}).catch(function(e){return t.logger.error("failed to accept answer",e),f.default.reject(e)})})},decline:function(){return this.reject()},dial:function(e,t){var r=this;this.locusJoinInFlight=!0,this.logger.info("call: dialing");var n=e;if(Yw.base64.validate(e)){var i=Yw.base64.decode(e).split("/"),o=i[3],a=i[4],s=this.spark.internal.feature.getFeature("developer","web-ha-messaging");if("PEOPLE"===o&&(n=a),"ROOM"===o){if(!(0,p.default)(this,"config.enableExperimentalGroupCallingSupport"))throw new Error("Group calling is not enabled. Please enable config.phone.enableExperimentalGroupCallingSupport");s&&s.value?this.spark.internal.device.getServiceUrl("conversation").then(function(e){return n={url:e+"/conversations/"+a+"/locus"}}):n={url:this.spark.internal.device.services.conversationServiceUrl+"/conversations/"+a+"/locus"}}}return this.spark.internal.mercury.connect().then(function(){return r.createOrJoinLocus(n,t)}).then((0,Yw.tap)(function(){return r.logger.info("call: dialed")})).catch(function(e){r.trigger("error",e)}).then(function(){r.locusJoinInFlight=!1}),this},getRawStatsStream:function(){return new E.default(this.media.pc)},getStatsStream:function(){return this.getRawStatsStream().pipe(new b.default)},hangup:function(){var e=this;return"in"!==this.direction||this.joinedOnThisDevice?(this.logger.info("call: hanging up"),this.media.stop(),this.locusJoinInFlight?(this.logger.info("call: locus join in flight, waiting for rest call to complete before hanging up"),this.when("change:locusJoinInFlight").then(function(){return e.hangup()})):this.locus?this.leave():this.cleanup().then(function(){return e.logger.info("call: hang up complete, call never created")})):this.reject()},initialize:function(){for(var e=this,t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];(0,c.default)(MP.SparkPlugin.prototype.initialize,this,r),this.on("change:activeParticipantsCount",function(){return e.onChangeActiveParticipantsCount.apply(e,arguments)}),this.on("change:isActive",function(){return e.onChangeIsActive.apply(e,arguments)}),this.on("change:localMediaStream",function(){return e.onChangeLocalMediaStream.apply(e,arguments)}),this.on("change:media.localMediaStream",function(){e.localMediaStream=e.media.localMediaStream}),this.on("change:remoteMember",function(){return e.onChangeRemoteMember.apply(e,arguments)}),["localMediaStream","remoteAudioMuted","remoteMediaStream","remoteVideoMuted","localScreenShare"].forEach(function(t){e.on("change:"+t,function(){return e.trigger(t+":change")})}),this.on("replaced",function(){return e.cleanup()}),this.listenTo(this.memberships,"add",function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.trigger.apply(e,["memberships:add"].concat(r))}),this.listenTo(this.memberships,"change",function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.trigger.apply(e,["membership:change"].concat(r))}),this.listenTo(this.memberships,"change:audioMuted",function(){return e.onMembershipsAudioMuted.apply(e,arguments)}),this.listenTo(this.memberships,"change:state",function(){return e.onMembershipsChangeState.apply(e,arguments)}),this.listenTo(this.memberships,"change:videoMuted",function(){return e.onMembershipsVideoMuted.apply(e,arguments)}),this.listenTo(this.memberships,"remove",function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.trigger.apply(e,["memberships:remove"].concat(r))}),this.listenTo(this.spark.internal.mercury,"event:locus",function(t){return e.onLocusEvent(t)}),this.listenTo(this.spark.internal.mercury,"event:locus.difference",function(t){return e.onLocusEvent(t)}),this.listenTo(this.media,"error",function(t){return e.trigger("error",t)}),this.listenTo(this.media,"internalTrackUpdate",function(){e.trigger("remoteMediaStream:change")}),this.listenTo(this.media,"negotiationneeded",function(){return e.onMediaNegotiationNeeded.apply(e,arguments)}),this.locus?this.internalCallId=(0,bj.makeInternalCallId)(this.locus):this.once("change:locus",function(){e.internalCallId=(0,bj.makeInternalCallId)(e.locus)}),this.memberships.listenToAndRun(this,"change:locus",function(){e.locus&&e.locus.participants&&(e.memberships.set((0,bj.participantsToCallMemberships)(e.spark,e.locus)),e.me=e.memberships.find(function(e){return e.isSelf}))}),this.config.enableExperimentalGroupCallingSupport?(this.on("inactive",function(){return e.hangup()}),this.on("inactive",function(){return e.cleanup()}),this.on("change:state",function(){pu(function(){return e.trigger(e.state)})}),this.on=(0,d.default)(this.on,function(t,r){for(var n=arguments.length,i=Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];if(O.includes(r))throw new Error('The "'+r+'" event is no longer valid with "enableExperimentalGroupCallingSupport===true"');return(0,c.default)(t,e,[r].concat(i))})):(this.on("disconnected",function(){return e.hangup()}),this.on("disconnected",function(){return e.cleanup()}),this.on("change:status",function(){pu(function(){return e.trigger(e.status)})}))},leave:function(){var e=this;this.logger.info("leave: attempting to leave locus");var t=(0,p.default)(this,this.config.enableExperimentalGroupCallingSupport?"me.state":"status");return"disconnected"===t?(this.logger.info("already hung up, not calling locus again"),f.default.resolve()):"declined"===t?(this.logger.info("call was declined, not leaving again"),f.default.resolve()):"connected"!==t?(this.logger.info("call is neither connected, disconnected, or declined, declining instead of leaving"),this.decline()):(this.logger.info("leave: leaving locus"),this.spark.internal.locus.leave(this.locus).catch(function(t){return e.logger.error("leave: locus leave error: ",t.stack||t.toString()),f.default.reject(t)}).then((0,Yw.tap)(function(){return e.logger.info("leave "+e.locus.id+": finished leaving via locus")})).then((0,Yw.tap)(function(){return e.logger.info("leave "+e.locus.id+": setting locus")})).then(function(t){return e.setLocus(t)}).then((0,Yw.tap)(function(){return e.logger.info("leave "+e.locus.id+": finished setting locus")})).then((0,Yw.tap)(function(){return e.logger.info("call: hung up")})))},onLocusEvent:function(e){var t=this,r=(0,p.default)(e,"data.locus.self.devices"),n=r&&(0,h.default)(r,function(e){return e.url===t.spark.internal.device.url});if(((this.locus&&(0,bj.makeInternalCallId)(e.data.locus))===this.internalCallId||n&&this.correlationId===n.correlationId)&&(this.logger.info("locus event: "+e.data.eventType),this.setLocus(e.data.locus)),e.data.locus.replaces){var i=!0,o=!1,a=void 0;try{for(var s,c=(0,u.default)(e.data.locus.replaces);!(i=(s=c.next()).done);i=!0){var l=s.value;if(l.locusUrl+"_"+l.lastActive===this.internalCallId)return this.setLocus(e.data.locus),void this.logger.info("locus replacement event: "+e.data.eventType,this.locusUrl,"->",e.data.locus.url)}}catch(e){o=!0,a=e}finally{try{!i&&c.return&&c.return()}finally{if(o)throw a}}}},onMembershipsAudioMuted:function(){this.logger.info("onMembershipsAudioMuted"),this.remoteMember&&(this.remoteAudioMuted=this.remoteMember.audioMuted)},onMembershipsVideoMuted:function(){this.logger.info("onMembershipsVideoMuted"),this.remoteMember&&(this.remoteVideoMuted=this.remoteMember.videoMuted)},onChangeRemoteMember:function(){this.remoteMember?(this.remoteAudioMuted=this.remoteMember.audioMuted,this.remoteVideoMuted=this.remoteMember.videoMuted):(this.remoteAudioMuted=void 0,this.remoteVideoMuted=void 0)},onMembershipsChangeState:function(e){this.activeParticipantsCount=this.memberships.filter(function(e){return"connected"===e.state}).length,this.trigger("membership:"+e.state,e)},onMediaNegotiationNeeded:function(){var e=this;this.logger.info("onMediaNegotiationNeeded"),this.media.createOffer().then(function(){var t=(0,NN.parse)(e.media.offerSdp),r=k("audio",t),n=!r.includes("send"),i=k("video",t),o=!i.includes("send"),a=k("screen",t);e.logger.info("onMediaNegotiationNeeded: audioOfferDir="+r+" videoOfferDir="+i+" screenOfferDir="+a),e.logger.info("onMediaNegotiationNeeded: audioMuted="+n+" videoMuted="+o);var s={sdp:e.media.offerSdp,mediaId:e.mediaId,audioMuted:n,videoMuted:o};return e.updateMedia(s)}).then(function(){return e.pollForExpectedLocusAndSdp()}).then(function(){var t=JSON.parse(e.mediaConnection.remoteSdp).sdp;return e.media.acceptAnswer(t)}).then(function(){return e.emit("mediaNegotiationCompleted")}).catch(function(t){return e.emit("error",t)})},onChangeLocalMediaStream:function(){var e=this;this.localMediaStream&&this.localMediaStream!==this.media.localMediaStream&&(["audio","video"].forEach(function(t){var r=e.localMediaStream.getTracks().find(function(e){return e.kind===t});r?e.media.setMedia(t,(0,y.default)(r.enabled,e["receiving"+A[t]]),r):e.media.setMedia(t,(0,y.default)(!1,e["receiving"+A[t]]))}),this.localMediaStream=this.media.localMediaStream)},onChangeIsActive:function(){this.isActive||this.joinedOnThisDevice&&(this.logger.info("call: hanging up due to locus going inactive"),this.hangup())},onChangeActiveParticipantsCount:function(){if(this.joinedOnThisDevice&&1===this.activeParticipantsCount&&(!this.isCall||this.config.hangupIfLastActive.call)&&(this.isCall||this.config.hangupIfLastActive.meeting)){var e=this.previousAttributes().locus;e&&(0,bj.activeParticipants)(e).length>1&&(this.logger.info("call: hanging up due to last participant in call"),this.hangup())}},pollForExpectedLocusAndSdp:function(){var e=this;return new f.default(function(t,r){var n=(0,NN.parse)(e.media.offerSdp),i=k("audio",n),o=k("video",n),a=k("screen",n),s=e,u=0;!function n(){u+=1;try{if(e.logger.info("iteration "+u+": checking if current locus sdp has the expected audio and video directions"),c=JSON.parse(e.mediaConnection.remoteSdp).sdp,l=(0,NN.parse)(c),f=k("audio",l),d=k("video",l),p=k("screen",l),h=R(i),v=R(o),g=R(a),s.logger.info("audio: "+i+", "+f+", "+h),s.logger.info("video: "+o+", "+d+", "+v),s.logger.info("screen: "+a+", "+p+", "+g),f===h&&d===v&&p===g){e.logger.info("iteration "+u+": the current locus sdp has the expected audio and video directions");try{return e.logger.info("iteration "+u+": checking if current locus has the expected audio and video directions"),e.validateLocusMediaState(e.locus),e.logger.info("iteration "+u+": the current locus has the expected audio and video directions; not syncing"),void t()}catch(t){e.logger.info("iteration "+u+": the current locus does not have the expected audio and video directions; syncing")}}else e.logger.info("iteration "+u+": the current locus sdp does not have the expected audio and video directions; syncing");if(u>4)return void r(new Error("After "+u+" attempts polling locus"));setTimeout(function(){return e.spark.internal.locus.sync(e.locus).then(function(t){return e.setLocus(t)}).then(n).catch(r)},1e3*Math.pow(2,u))}catch(e){r(e)}var c,l,f,d,p,h,v,g}()})},releaseFloor:function(){var e=this;return this.logger.info("call: releasing floor grant"),f.default.resolve().then((0,bj.waitForMediaShare)(this)).then(function(t){return e.spark.internal.locus.releaseFloorGrant(e.locus,t)})},reject:function(){var e=this;return"out"===this.direction?f.default.resolve():(this.logger.info("call: rejecting"),this.spark.internal.locus.decline(this.locus).then(function(t){return e.setLocus(t)}).then((0,Yw.tap)(function(){return e.cleanup()})).then((0,Yw.tap)(function(){return e.logger.info("call: rejected")})))},requestFloor:function(){var e=this;return this.logger.info("call: requesting floor grant"),f.default.resolve().then((0,bj.waitForMediaShare)(this)).then(function(t){return e.spark.internal.locus.requestFloorGrant(e.locus,t)})},setLocus:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.locus;if(!n)return this.locus=e,f.default.resolve();switch(this.spark.internal.locus.compare(n,e)){case _j.USE_INCOMING:this.locus=this.spark.internal.locus.merge(this.locus,e),this.device&&(this.correlationId=this.device.correlationId);break;case _j.FETCH:return r?(this.logger.info("call: fetching locus according to sequencing algorithm"),this.spark.internal.locus.get(n).then(function(e){return t.setLocus(e,!0)})):(this.logger.info("call: syncing locus according to sequencing algorithm"),this.spark.internal.locus.sync(n).then(function(e){return t.setLocus(e,!0)}))}return f.default.resolve()},sendDtmf:function(e){return this.supportsDtmf?this.spark.internal.locus.sendDtmf(this.locus,e):f.default.reject(new Error("this call does not support dtmf"))},sendFeedback:function(e){return this.spark.internal.metrics.submit("meetup_call_user_rating",e)},startApplicationShare:function(){var e=this;return this.logger.info("call: sharing application"),new f.default(function(t){e.media.once("answeraccepted",t),e.media.setMedia("screen","sendonly",{mediaSource:"application"})}).then(function(){return e.requestFloor()})},startScreenShare:function(){var e=this;return this.logger.info("call: sharing screen"),new f.default(function(t){e.media.once("answeraccepted",t),e.media.setMedia("screen","sendonly",{mediaSource:"screen"})}).then(function(){return e.requestFloor()})},startReceivingAudio:function(){return this.changeReceivingMedia("audio",!0)},startReceivingVideo:function(){return this.changeReceivingMedia("video",!0)},startSendingAudio:function(){return this.changeSendingMedia("audio",!0)},startSendingVideo:function(){return this.changeSendingMedia("video",!0)},stopScreenShare:function(){var e=this;return this.logger.info("call: stopping screen/application share"),this.releaseFloor().then(function(){return new f.default(function(t){e.media.once("answeraccepted",t),e.media.setMedia("screen","inactive")})})},stopReceivingAudio:function(){return this.changeReceivingMedia("audio",!1)},stopReceivingVideo:function(){return this.changeReceivingMedia("video",!1)},stopSendingAudio:function(){return this.changeSendingMedia("audio",!1)},stopSendingVideo:function(){return this.changeSendingMedia("video",!1)},toggleFacingMode:function(){var e=this;if(!this.sendingVideo)throw new Error("Cannot toggle facingMode if we're not sending video");if("user"!==this.facingMode&&"environment"!==this.facingMode)throw new Error("Cannot determine current facing mode; specify a new localMediaStream to change cameras");var t={facingMode:{ideal:"user"===this.facingMode?"environment":"user"}};return this.media.setMedia("video",(0,y.default)(this.sendingAudio,this.sendingVideo),t).then(function(){e.facingMode=t.facingMode.ideal})},toggleReceivingAudio:function(){return this.receivingAudio?this.stopReceivingAudio():this.startReceivingAudio()},toggleReceivingVideo:function(){return this.receivingVideo?this.stopReceivingVideo():this.startReceivingVideo()},toggleSendingAudio:function(){return this.sendingAudio?this.stopSendingAudio():this.startSendingAudio()},toggleSendingVideo:function(){return this.sendingVideo?this.stopSendingVideo():this.startSendingVideo()},updateMedia:function(e){var t=this;if(this.logger.info("updateMedia"),e.sdp&&!e.sdp.includes("b="))throw new Error("outbound sdp should always have a 'b=' line");return this.spark.internal.locus.updateMedia(this.locus,e).then(function(e){return t.setLocus(e)})},updateVideoMuteSdp:function(e,t){var r=w(!t,this.receivingVideo),n=w(t,this.receivingVideo);return e.replace(new RegExp("a=mid:video[^a]+a="+n,"gi"),"a=mid:video\na="+r)},updateMuteToggles:function(e,t){this.logger.info("updating mute toggles: "+e+"="+t);var r={mediaId:this.mediaId,audioMuted:!this.sendingAudio,videoMuted:!this.sendingVideo};return"audio"===e?r.audioMuted=!t:"video"===e&&(r.videoMuted=!t,r.sdp=this.updateVideoMuteSdp(this.media.offerSdp,!t)),this.updateMedia(r)},validateLocusMediaState:function(e){var t=e.self.status.audioStatus.toLowerCase(),r=this.media.audioDirection;if(t!==r)throw this.logger.warn("locus: expected audio "+t+" (locus) to equal "+r+" (local media)"),new Error("locus.self.status.audioStatus indicates the received DTO is out of date");var n=e.self.status.videoStatus.toLowerCase(),i=this.media.videoDirection;if(n!==i)throw this.logger.warn("locus: expected video "+n+" (locus) to equal "+i+" (local media)"),new Error("locus.self.status.videoStatus indicates the received DTO is out of date");return e},waitForExpectedLocus:function(){var e=this;return new f.default(function(t){var r=function r(){try{e.validateLocusMediaState(e.locus),e.off("change:locus",r),t()}catch(t){e.logger.warn("locus: current locus not in expected state; waiting for next locus")}};e.on("change:locus",r),r()})},version:"1.50.6"},"acknowledge",[Yw.oneFlight],(0,s.default)(a,"acknowledge"),a),T(a,"answer",[Yw.oneFlight,r],(0,s.default)(a,"answer"),a),T(a,"createOrJoinLocus",[Yw.oneFlight],(0,s.default)(a,"createOrJoinLocus"),a),T(a,"decline",[n],(0,s.default)(a,"decline"),a),T(a,"dial",[Yw.oneFlight],(0,s.default)(a,"dial"),a),T(a,"leave",[Yw.oneFlight,i],(0,s.default)(a,"leave"),a),T(a,"onMediaNegotiationNeeded",[o],(0,s.default)(a,"onMediaNegotiationNeeded"),a),T(a,"pollForExpectedLocusAndSdp",[Yw.retry],(0,s.default)(a,"pollForExpectedLocusAndSdp"),a),T(a,"reject",[Yw.oneFlight],(0,s.default)(a,"reject"),a),T(a,"updateMuteToggles",[Yw.oneFlight],(0,s.default)(a,"updateMuteToggles"),a),a));I.make=function(e,t){return new I(e,t)},t.default=I});t(hL);var vL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=a(mR),n=a(Af),i=a(qI),o=a(hL);function a(e){return e&&e.__esModule?e:{default:e}}var s=i.default.extend({model:o.default,mainIndex:"internalCallId",indexes:["correlationId"],initialize:function(){for(var e=this,t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];(0,n.default)(i.default.prototype.initialize,this,r),this.on("add",function(t){e.listenTo(t,"change:state",function(){t.config.enableExperimentalGroupCallingSupport?"inactive"===t.state&&e.remove(t):"disconnected"===t.status&&e.remove(t)})})},has:function(e){if(this.get(e.url+"_"+e.fullState.lastActive))return!0;if(e.replaces){var t=!0,n=!1,i=void 0;try{for(var o,a=(0,r.default)(e.replaces);!(t=(o=a.next()).done);t=!0){var s=o.value;if(this.get(s.locusUrl+"_"+s.lastActive))return!0}}catch(e){n=!0,i=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw i}}}return!1}});t.default=s});t(vL);var gL=r(function(t){!function(){var r,n="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";if(b="object"==typeof ku&&"object"==typeof ku.versions&&ku.versions.node&&!1){var i=ku.versions.node.toString().replace("v","");n="Nodejs/"+i+" (NodeOS) AppleWebKit/"+i+" (KHTML, like Gecko) Nodejs/"+i+" Nodejs/"+i}r=void 0!==e?e:window,"undefined"==typeof window&&("undefined"==typeof window&&void 0!==e&&(e.navigator={userAgent:n,getUserMedia:function(){}},r.window=e),"undefined"==typeof location&&(r.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(r.screen={width:0,height:0}));var o=window.navigator;void 0!==o?(void 0!==o.webkitGetUserMedia&&(o.getUserMedia=o.webkitGetUserMedia),void 0!==o.mozGetUserMedia&&(o.getUserMedia=o.mozGetUserMedia)):o={getUserMedia:function(){},userAgent:n};var a=!!/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(o.userAgent||""),s=!(-1===o.userAgent.indexOf("Edge")||!o.msSaveOrOpenBlob&&!o.msSaveBlob),u=!!window.opera||o.userAgent.indexOf(" OPR/")>=0,c=void 0!==window.InstallTrigger,l=/^((?!chrome|android).)*safari/i.test(o.userAgent),f=!!window.chrome&&!u,d="undefined"!=typeof document&&!!document.documentMode&&!s;function p(e,t){var r=0,n=!1,i=window.setInterval(function(){e()&&(window.clearInterval(i),t(n)),r++>50&&(window.clearInterval(i),t(n=!0))},10)}var h={Android:function(){return o.userAgent.match(/Android/i)},BlackBerry:function(){return o.userAgent.match(/BlackBerry|BB10/i)},iOS:function(){return o.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return o.userAgent.match(/Opera Mini/i)},Windows:function(){return o.userAgent.match(/IEMobile/i)},any:function(){return h.Android()||h.BlackBerry()||h.iOS()||h.Opera()||h.Windows()},getOsName:function(){var e="Unknown OS";return h.Android()&&(e="Android"),h.BlackBerry()&&(e="BlackBerry"),h.iOS()&&(e="iOS"),h.Opera()&&(e="Opera Mini"),h.Windows()&&(e="Windows"),e}};var v="Unknown OS",g="Unknown OS Version";var m,y,_=function(){for(var e,t=o.appVersion,r=o.userAgent,n="-",i=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}],a=0;e=i[a];a++)if(e.r.test(r)){n=e.s;break}var s="-";switch(/Windows/.test(n)&&(/Windows (.*)/.test(n)&&(s=/Windows (.*)/.exec(n)[1]),n="Windows"),n){case"Mac OS X":/Mac OS X (10[\.\_\d]+)/.test(r)&&(s=/Mac OS X (10[\.\_\d]+)/.exec(r)[1]);break;case"Android":/Android ([\.\_\d]+)/.test(r)&&(s=/Android ([\.\_\d]+)/.exec(r)[1]);break;case"iOS":/OS (\d+)_(\d+)_?(\d+)?/.test(r)&&(s=(s=/OS (\d+)_(\d+)_?(\d+)?/.exec(t))[1]+"."+s[2]+"."+(0|s[3]))}return{osName:n,osVersion:s}}();_&&_.osName&&"-"!=_.osName?(v=_.osName,g=_.osVersion):h.any()&&"Android"==(v=h.getOsName())&&(g=!!(y=(m=(m||o.userAgent).toLowerCase()).match(/android\s([0-9\.]*)/))&&y[1]);var b="object"==typeof ku&&"object"==typeof ku.versions&&ku.versions.node;"Unknown OS"===v&&b&&(v="Nodejs",g=ku.versions.node.toString().replace("v",""));var E=!1,S=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(e){"undefined"!=typeof document&&"function"==typeof document.createElement&&(!E&&e in document.createElement("canvas")&&(E=!0),!S&&e in document.createElement("video")&&(S=!0))});var T=/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/,w=/([0-9]{1,3}(\.[0-9]{1,3}){3})/,O=/[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7}/;var k=[],R=[],A=[],I=[];o.mediaDevices&&o.mediaDevices.enumerateDevices&&(o.enumerateDevices=function(e){var t=o.mediaDevices.enumerateDevices();t&&t.then?o.mediaDevices.enumerateDevices().then(e).catch(function(){e([])}):e([])});var P=!1;"undefined"!=typeof MediaStreamTrack&&"getSources"in MediaStreamTrack?P=!0:o.mediaDevices&&o.mediaDevices.enumerateDevices&&(P=!0);var C=!1,M=!1,N=!1,D=!1,j=!1;var x=window.DetectRTC||{};x.browser=function(){o.appVersion;var e,t,r,n=o.userAgent,i=o.appName,a=""+parseFloat(o.appVersion),p=parseInt(o.appVersion,10);if(l&&!f&&-1!==n.indexOf("CriOS")&&(l=!1,f=!0),u){i="Opera";try{p=(a=o.userAgent.split("OPR/")[1].split(" ")[0]).split(".")[0]}catch(e){a="0.0.0.0",p=0}}else d?((t=n.indexOf("rv:"))>0?a=n.substring(t+3):(t=n.indexOf("MSIE"),a=n.substring(t+5)),i="IE"):f?(t=n.indexOf("Chrome"),i="Chrome",a=n.substring(t+7)):l?(t=n.indexOf("Safari"),i="Safari",a=n.substring(t+7),-1!==(t=n.indexOf("Version"))&&(a=n.substring(t+8)),-1!==o.userAgent.indexOf("Version/")&&(a=o.userAgent.split("Version/")[1].split(" ")[0])):c?(t=n.indexOf("Firefox"),i="Firefox",a=n.substring(t+8)):(e=n.lastIndexOf(" ")+1)<(t=n.lastIndexOf("/"))&&(i=n.substring(e,t),a=n.substring(t+1),i.toLowerCase()===i.toUpperCase()&&(i=o.appName));return s&&(i="Edge",a=o.userAgent.split("Edge/")[1]),-1!==(r=a.search(/[; \)]/))&&(a=a.substring(0,r)),p=parseInt(""+a,10),isNaN(p)&&(a=""+parseFloat(o.appVersion),p=parseInt(o.appVersion,10)),{fullVersion:a,version:p,name:i,isPrivateBrowsing:!1}}(),function(e){var t;try{if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,function(){t=!1},function(e){t=!0});else if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){var r;try{(r=window.indexedDB.open("test")).onerror=function(){return!0}}catch(e){t=!0}void 0===t&&p(function(){return"done"===r.readyState},function(e){e||(t=!r.result)})}else if(function(e){var t=e.toLowerCase();if(0===t.indexOf("msie")&&0===t.indexOf("trident"))return!1;var r=/(?:msie|rv:)\s?([\d\.]+)/.exec(t);return!!(r&&parseInt(r[1],10)>=10)}(window.navigator.userAgent)){t=!1;try{window.indexedDB||(t=!0)}catch(e){t=!0}}else if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem("test",1)}catch(e){t=!0}void 0===t&&(t=!1,window.localStorage.removeItem("test"))}}catch(e){t=!1}p(function(){return void 0!==t},function(r){e(t)})}(function(e){x.browser.isPrivateBrowsing=!!e}),x.browser["is"+x.browser.name]=!0,x.osName=v,x.osVersion=g;var L=!1;["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach(function(e){L||e in window&&(L=!0)}),x.isWebRTCSupported=L,x.isORTCSupported="undefined"!=typeof RTCIceGatherer;var U=!1;(x.browser.isChrome&&x.browser.version>=35?U=!0:x.browser.isFirefox&&x.browser.version>=34?U=!0:x.browser.isEdge&&x.browser.version>=17?U=!0:"Android"===x.osName&&x.browser.isChrome&&(U=!0),/^(https:|chrome-extension:)$/g.test(location.protocol||""))||("undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(x.browser.isChrome||x.browser.isEdge||x.browser.isOpera)?U=!1:x.browser.isFirefox&&(U=!1));x.isScreenCapturingSupported=U;var F={isSupported:!1,isCreateMediaStreamSourceSupported:!1};["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"].forEach(function(e){F.isSupported||e in window&&(F.isSupported=!0,window[e]&&"createMediaStreamSource"in window[e].prototype&&(F.isCreateMediaStreamSourceSupported=!0))}),x.isAudioContextSupported=F.isSupported,x.isCreateMediaStreamSourceSupported=F.isCreateMediaStreamSourceSupported;var G=!1;x.browser.isChrome&&x.browser.version>31&&(G=!0),x.isRtpDataChannelsSupported=G;var q=!1;x.browser.isFirefox&&x.browser.version>28?q=!0:x.browser.isChrome&&x.browser.version>25?q=!0:x.browser.isOpera&&x.browser.version>=11&&(q=!0),x.isSctpDataChannelsSupported=q,x.isMobileDevice=a;var V=!1;o.getUserMedia?V=!0:o.mediaDevices&&o.mediaDevices.getUserMedia&&(V=!0),x.browser.isChrome&&x.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(V="Requires HTTPs"),"Nodejs"===x.osName&&(V=!1),x.isGetUserMediaSupported=V;var B,z,W,H="";screen.width&&(H+=(screen.width?screen.width:"")+" x "+(screen.height?screen.height:""));x.displayResolution=H,x.displayAspectRatio=(B=screen.width,z=screen.height,W=function e(t,r){return 0==r?t:e(r,t%r)}(B,z),B/W/(z/W)).toFixed(2),x.isCanvasSupportsStreamCapturing=E,x.isVideoSupportsStreamCapturing=S,"Chrome"==x.browser.name&&x.browser.version>=53&&(x.isCanvasSupportsStreamCapturing||(x.isCanvasSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features"),x.isVideoSupportsStreamCapturing||(x.isVideoSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features")),x.DetectLocalIPAddress=function(e,t){if(x.isWebRTCSupported){var r=!0,n=!0;!function(e,t){if("undefined"!=typeof document&&"function"==typeof document.getElementById){var r={},n=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;if(!n){var i=document.getElementById("iframe");if(!i)return;var o=i.contentWindow;n=o.RTCPeerConnection||o.mozRTCPeerConnection||o.webkitRTCPeerConnection}if(n){var a=null;"Chrome"===x.browser&&x.browser.version<58&&(a={optional:[{RtpDataChannels:!0}]});var s=new n({iceServers:[{urls:"stun:stun.l.google.com:19302"}]},a);if(t&&(s.addStream?s.addStream(t):s.addTrack&&t.getTracks()[0]&&s.addTrack(t.getTracks()[0],t)),s.onicecandidate=function(e){e.candidate&&e.candidate.candidate?u(e.candidate.candidate):u()},!t)try{s.createDataChannel("sctp",{})}catch(e){}x.isPromisesSupported?s.createOffer().then(function(e){s.setLocalDescription(e).then(c)}):s.createOffer(function(e){s.setLocalDescription(e,c,function(){})},function(){})}}function u(t){if(t){var n=w.exec(t);if(n){var i=n[1],o=t.match(T);void 0===r[i]&&e(i,o,!0),r[i]=!0}}else e()}function c(){var e=s.localDescription.sdp.split("\n");e.forEach(function(e){e&&0===e.indexOf("a=candidate:")&&u(e)})}}(function(t){t?t.match(T)?e("Local: "+t,r=!1,n):t.match(O)?e("Public: "+t,r,n=!1):e("Public: "+t,r,n):e()},t)}},x.isWebSocketsSupported="WebSocket"in window&&2===window.WebSocket.CLOSING,x.isWebSocketsBlocked=!x.isWebSocketsSupported,"Nodejs"===x.osName&&(x.isWebSocketsSupported=!0,x.isWebSocketsBlocked=!1),x.checkWebSocketsSupport=function(e){e=e||function(){};try{var t,r=new WebSocket("wss://echo.websocket.org:443/");r.onopen=function(){x.isWebSocketsBlocked=!1,t=(new Date).getTime(),r.send("ping")},r.onmessage=function(){x.WebsocketLatency=(new Date).getTime()-t+"ms",e(),r.close(),r=null},r.onerror=function(){x.isWebSocketsBlocked=!0,e()}}catch(t){x.isWebSocketsBlocked=!0,e()}},x.load=function(e){!function(e){if(P)if(!o.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(o.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!o.enumerateDevices&&o.enumerateDevices&&(o.enumerateDevices=o.enumerateDevices.bind(o)),o.enumerateDevices){k=[],R=[],A=[],I=[],C=!1,M=!1,N=!1,D=!1,j=!1;var t={};o.enumerateDevices(function(r){r.forEach(function(e){var r={};for(var n in e)try{"function"!=typeof e[n]&&(r[n]=e[n])}catch(e){}t[r.deviceId+r.label+r.kind]||("audio"===r.kind&&(r.kind="audioinput"),"video"===r.kind&&(r.kind="videoinput"),r.deviceId||(r.deviceId=r.id),r.id||(r.id=r.deviceId),r.label?("videoinput"!==r.kind||j||(j=!0),"audioinput"!==r.kind||D||(D=!0)):(r.isCustomLabel=!0,"videoinput"===r.kind?r.label="Camera "+(I.length+1):"audioinput"===r.kind?r.label="Microphone "+(R.length+1):"audiooutput"===r.kind?r.label="Speaker "+(A.length+1):r.label="Please invoke getUserMedia once.",void 0!==x&&x.browser.isChrome&&x.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(r.label="HTTPs is required to get label of this "+r.kind+" device.")),"audioinput"===r.kind&&(C=!0,-1===R.indexOf(r)&&R.push(r)),"audiooutput"===r.kind&&(M=!0,-1===A.indexOf(r)&&A.push(r)),"videoinput"===r.kind&&(N=!0,-1===I.indexOf(r)&&I.push(r)),k.push(r),t[r.deviceId+r.label+r.kind]=r)}),void 0!==x&&(x.MediaDevices=k,x.hasMicrophone=C,x.hasSpeakers=M,x.hasWebcam=N,x.isWebsiteHasWebcamPermissions=j,x.isWebsiteHasMicrophonePermissions=D,x.audioInputDevices=R,x.audioOutputDevices=A,x.videoInputDevices=I),e&&e()})}else e&&e();else e&&e()}(e=e||function(){})},x.MediaDevices=void 0!==k?k:[],x.hasMicrophone=C,x.hasSpeakers=M,x.hasWebcam=N,x.isWebsiteHasWebcamPermissions=j,x.isWebsiteHasMicrophonePermissions=D,x.audioInputDevices=R,x.audioOutputDevices=A,x.videoInputDevices=I;var Y=!1;"undefined"!=typeof document&&"function"==typeof document.createElement&&"setSinkId"in document.createElement("video")&&(Y=!0),x.isSetSinkIdSupported=Y;var $=!1;x.browser.isFirefox&&"undefined"!=typeof mozRTCPeerConnection?"getSenders"in mozRTCPeerConnection.prototype&&($=!0):x.browser.isChrome&&"undefined"!=typeof webkitRTCPeerConnection&&"getSenders"in webkitRTCPeerConnection.prototype&&($=!0),x.isRTPSenderReplaceTracksSupported=$;var X=!1;x.browser.isFirefox&&x.browser.version>38&&(X=!0),x.isRemoteStreamProcessingSupported=X;var J=!1;"undefined"!=typeof MediaStreamTrack&&"applyConstraints"in MediaStreamTrack.prototype&&(J=!0),x.isApplyConstraintsSupported=J;var K=!1;x.browser.isFirefox&&x.browser.version>=43&&(K=!0),x.isMultiMonitorScreenCapturingSupported=K,x.isPromisesSupported=!!("Promise"in window),x.version="1.3.9",void 0===x&&(window.DetectRTC={});var Q=window.MediaStream;void 0===Q&&"undefined"!=typeof webkitMediaStream&&(Q=webkitMediaStream),x.MediaStream=void 0!==Q&&"function"==typeof Q&&Object.keys(Q.prototype),"undefined"!=typeof MediaStreamTrack?x.MediaStreamTrack=Object.keys(MediaStreamTrack.prototype):x.MediaStreamTrack=!1;var Z=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;x.RTCPeerConnection=void 0!==Z&&Object.keys(Z.prototype),window.DetectRTC=x,t.exports=x}()}),mL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.events=void 0;var r=l(Af),n=l(yR),i=l(_f),o=l(QI),a=l(cS),s=l(iD),u=l(hL),c=l(vL);function l(e){return e&&e.__esModule?e:{default:e}}var f=t.events={CALL_CREATED:"call:created",CALL_INCOMING:"call:incoming"},d=MP.SparkPlugin.extend({collections:{emittedCalls:c.default},session:{connected:{default:!1,type:"boolean"},defaultFacingMode:{default:"user",type:"string",values:["user","environment"]},registered:{default:!1,type:"boolean"}},namespace:"phone",isCallingSupported:function(){return new i.default(function(e){e(gL.isWebRTCSupported)})},register:function(){var e=this;return this.spark.internal.device.refresh().then(function(){return e.connected?i.default.resolve():i.default.all([e.emittedCalls.reset(),e.spark.internal.mercury.when("event:mercury.buffer_state").then(function(t){return"UNKNOWN"===(0,n.default)(t,1)[0].data.bufferState.locus?e.listActiveCalls():i.default.resolve()}),e.spark.internal.mercury.connect()])})},deregister:function(){var e=this;return this.spark.internal.mercury.disconnect().then(function(){return e.spark.internal.device.unregister()})},createLocalMediaStream:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.constraints||e;return(0,a.default)(t,{audio:!0,video:!0}),s.default.getUserMedia(t)},listActiveCalls:function(){var e=this;return this.spark.internal.locus.list().then(function(t){var r=e.emittedCalls.map(function(e){return e});return t?(t.forEach(function(t){if(!e.emittedCalls.has(t)){var n=u.default.make({locus:t,parent:e.spark});r.push(n),e.emittedCalls.add(n),e._triggerCallEvents(n,t)}}),r):r})},initialize:function(){for(var e=this,t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];(0,r.default)(MP.SparkPlugin.prototype.initialize,this,n),this.listenTo(this.spark.internal.mercury,"event:locus",function(t){return e.onLocusEvent(t)}),this.listenTo(this.spark.internal.mercury,"change:connected",function(){e.connected=e.spark.internal.mercury.connected,e.registered=!!e.spark.internal.device.url&&e.connected}),this.listenTo(this.spark.internal.device,"change:url",function(){e.registered=!!e.spark.internal.device.url&&e.connected})},onLocusEvent:function(e){var t=e.data.locus;if(!this.emittedCalls.has(t)&&"inactive"!==t.fullState.state.toLowerCase()){var r=u.default.make({locus:t},{parent:this.spark});this.emittedCalls.add(r),this._triggerCallEvents(r,e.data.locus)}},dial:function(e,t){var r=u.default.make({},{parent:this.spark});return r.dial(e,t),this.emittedCalls.add(r),r},_triggerCallEvents:function(e,t){this.trigger(f.CALL_CREATED,e),(0,bj.shouldRing)(t)&&((0,bj.isCall)(t)||!(0,bj.isCall)(t)&&(0,o.default)(this,"config.enableExperimentalGroupCallingSupport"))&&this.trigger(f.CALL_INCOMING,e)},version:"1.50.6"});t.default=d});t(mL);mL.events;var yL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=_f)&&r.__esModule?r:{default:r};var i=MP.Batcher.extend({namespace:"People",handleHttpSuccess:function(e){var t=this;return n.default.all(e.body.items.map(function(e){return t.handleItemSuccess(e.id,e)}))},handleItemFailure:function(e,t){return this.getDeferredForResponse(e).then(function(e){e.reject(t)})},handleItemSuccess:function(e,t){return this.getDeferredForResponse(e).then(function(e){e.resolve(t)})},fingerprintRequest:function(e){var t=this.spark.people.inferPersonIdFromUuid(e);return n.default.resolve(t)},fingerprintResponse:function(e){return n.default.resolve(e)},prepareRequest:function(e){return n.default.resolve(e.join())},submitHttpRequest:function(e){return this.spark.request({service:"hydra",resource:"people/?id="+e+"&showAllTypes="+this.config.showAllTypes})}});t.default=i});t(yL);var _L=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=a(ac),i=a(_f),o=a(yL);function a(e){return e&&e.__esModule?e:{default:e}}var s,u,c,l,f,d,p=MP.SparkPlugin.extend((r={namespace:"People",children:{batcher:o.default},get:function(e){if(!e)return i.default.reject(new Error("A person with an id is required"));if("me"===e)return this._getMe();var t=e.personId||e.id||e;return this.batcher.request(t)},list:function(e){var t=this;if(Array.isArray(e)){var r=e;return i.default.all(r.map(function(e){return t.batcher.request(e)}))}return this.request({service:"hydra",resource:"people",qs:e}).then(function(e){return new MP.Page(e,t.spark)})},inferPersonIdFromUuid:function(e){try{if(Yw.base64.decode(e).includes("ciscospark://"))return e}catch(e){}return Yw.base64.encode("ciscospark://us/PEOPLE/"+e)},_getMe:function(){return this.spark.request({service:"hydra",resource:"people/me"}).then(function(e){return e.body})},version:"1.50.6"},s=r,u="_getMe",c=[Yw.oneFlight],l=(0,n.default)(r,"_getMe"),f=r,d={},Object.keys(l).forEach(function(e){d[e]=l[e]}),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=c.slice().reverse().reduce(function(e,t){return t(s,u,e)||e},d),f&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(f):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(s,u,d),d=null),r));t.default=p});t(_L);var bL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={people:{batcherWait:100,batcherMaxCalls:10,batcherMaxWait:1500,showAllTypes:!1}}});t(bL),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i(_L).default}});var r=i(_L),n=i(bL);function i(e){return e&&e.__esModule?e:{default:e}}(0,MP.registerPlugin)("people",r.default,{config:n.default})}));var EL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={phone:{audioBandwidthLimit:64e3,videoBandwidthLimit:1e6,enableExperimentalGroupCallingSupport:!1,hangupIfLastActive:{call:!0,meeting:!1}}}});t(EL);var SL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.StatsStream=t.StatsFilter=t.remoteParticipant=t.boolToStatus=t.Call=t.phoneEvents=void 0,Object.defineProperty(t,"phoneEvents",{enumerable:!0,get:function(){return mL.events}}),Object.defineProperty(t,"Call",{enumerable:!0,get:function(){return i(hL).default}}),Object.defineProperty(t,"boolToStatus",{enumerable:!0,get:function(){return i(Ej).default}}),Object.defineProperty(t,"remoteParticipant",{enumerable:!0,get:function(){return bj.remoteParticipant}}),Object.defineProperty(t,"StatsFilter",{enumerable:!0,get:function(){return i(dL).default}}),Object.defineProperty(t,"StatsStream",{enumerable:!0,get:function(){return i(pL).default}});var r=i(mL),n=i(EL);function i(e){return e&&e.__esModule?e:{default:e}}t.default=r.default,(0,MP.registerPlugin)("phone",r.default,{config:n.default})});t(SL);SL.StatsStream,SL.StatsFilter,SL.remoteParticipant,SL.boolToStatus,SL.Call,SL.phoneEvents;var TL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=a(rT),n=a(By),i=a(nT),o=a(iT);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){return(0,n.default)(this,t),(0,i.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,o.default)(t,e),t}(a(fS).default);t.default=new s});t(TL);var wL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.AUDIO="audio",t.AUDIO_BANDWIDTH_LIMIT="64000",t.AUDIO_INPUT="audioinput",t.AUDIO_STATUS="audioStatus",t.ALTERNATE_REDIRECT_TRUE="alternateRedirect=true",t.ANSWER="ANSWER",t.ALERT="alert",t.ACTIVE="ACTIVE",t.BUSY="BUSY",t.CALL="call",t.CREATED="CREATED",t.CONFLICT="CONFLICT",t.CORRELATION_ID="correlationId",t.CONVERSATION_URL="CONVERSATION_URL",t.CONVERSATIONS="conversations",t.CALENDAR="calendar",t.CALENDAR_EVENTS_API="calendarEvents",t.CMR_MEETINGS="cmrmeetings",t.CLAIM="claim",t.CONTROLS="controls",t.CONTENT="content",t.DEVELOPMENT="development",t.DECLINE="decline",t.ERROR="ERROR",t.GET="GET",t.HECATE="hecate",t.HTTPS_PROTOCOL="https://",t.IDLE="IDLE",t.ICE_TIMEOUT=1e3,t.ICE_FAIL_TIMEOUT=3e3,t.IN_LOBBY="IN_LOBBY",t.IN_MEETING="IN_MEETING",t.INCOMING="INCOMING",t.INTENT_TO_JOIN=2423005,t.JOINED="JOINED",t.JOIN="join",t.LEAVE="leave",t.LOCAL="local",t.LOCI="loci",t.LOCUS_ID="LOCUS_ID",t.LOCUS_URL="locusUrl",t.LEFT="LEFT",t.MEETING_LINK="MEETING_LINK",t.MEETINGS="Meetings",t.MEETING="MEETING",t.MEETING_CENTER="MEETING_CENTER",t.MEETING_ID="MEETING_ID",t.MEETINGINFO="meetingInfo",t.MEDIA_SIP_URI="MEDIA_SIP_URI",t.MEDIA="media",t.MODERATOR_TRUE=!0,t.MODERATOR_FALSE=!1,t.MEDIA_PEER_CONNECTION_NAME="MediaPeerConnection",t.MEET="meet",t.MEET_M="m",t.NOT_IN_MEETING="NOT_IN_MEETING",t.NONE="NONE",t.ONE_ON_ONE="ONE_ON_ONE",t.OFFER="OFFER",t.OBSERVE="OBSERVE",t.OUTGOING="OUTGOING",t.ONLINE="online",t.OTHER="OTHER",t.PARTICIPANT="participant",t.PERSONAL_ROOM="PERSONAL_ROOM",t.PUT="PUT",t.POST="POST",t.RETRY_TIMEOUT=3e3,t.REMOTE="remote",t.REQUESTED="REQUESTED",t._ANSWER_="answer",t._ERROR_="error",t._DATA_="data",t._CLOSED_="closed",t.RTC_CONFIGURATION_FIREFOX={iceServers:[],bundlePolicy:"max-compat"},t.RTC_CONFIGURATION={iceServers:[]},t.RESOURCE_ROOM="RESOURCE_ROOM",t.READY="ready",t.RECEIVE_ONLY="RECVONLY",t.SIP_URI="SIP_URI",t.STOP="STOP",t.SHARE_PEER_CONNECTION_NAME="SharePeerConnection",t.SELF="SELF",t.SEND_RECEIVE="SENDRECV",t.TEMP_SIP_URI="TEMP_SIP_URI",t.TYPE="type",t.USE_URI_LOOKUP_FALSE="useUriLookup=false",t.USER="USER",t.UNKNOWN="UNKNOWN",t.VALID_PMR_ADDRESS=/([a-z0-9][-a-z0-9, '.']{0,62})@([a-z0-9][-a-z0-9, '.']{0,62})\.webex\.com/i,t.VALID_PMR_LINK=/(https:\/\/)?([a-z0-9][-a-z0-9, '.']{0,62})\.webex\.com\/(meet|join)\/([a-z0-9][-a-z0-9, '.']{0,62})\/?/i,t.VALID_PIN=/([0-9]{4,6})/,t.VIDEO="video",t.VIDEO_BANDWIDTH_LIMIT="4000000",t.VIDEO_INPUT="videoinput",t.VIDEO_STATUS="videoStatus",t.WEBEX_DOT_COM="webex.com",t.WEBEX_MEETING="WEBEX_MEETING",t.WAIT="WAIT",t.WWW_DOT="www.",t.ERROR_DICTIONARY={INTENT_TO_JOIN:{NAME:"IntentToJoinError",MESSAGE:"The meeting is locked. This is expected behavior. Call #join again with hostPin and/or moderator option",CODE:1},JOIN_MEETING:{NAME:"JoinMeetingError",MESSAGE:"Meeting:index#join --\x3e Error joining the call on getLocalMedia",CODE:2},RECONNECTION:{NAME:"ReconnectionError",MESSAGE:"There was an error in the reconnection flow, the call may not reconnect, disconnect and dial again.",CODE:3}},t.API={CALLIOPEDISCOVERY:"calliopeDiscovery",LOCUS:"locus"},t.DIALER_REGEX={SIP_ADDRESS:/^(sips?)?:?(?:([^\s>:@]+)(?::([^\s@>]+))?@)([\w\-.]+)(?::(\d+))?((?:;[^\s=?>;]+(?:=[^\s?;]+)?)*)(?:\?(([^\s&=>]+=[^\s&=>]+)(&[^\s&=>]+=[^\s&=>]+)*))?$/,PHONE_NUMBER:/^(?:(?:\+?1\s*(?:[.-]\s*)?)?(?:\(\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\s*\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\s*(?:[.-]\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\s*(?:[.-]\s*)?([0-9]{4})(?:\s*(?:#|x\.?|ext\.?|extension)\s*(\d+))?$/},t.CALENDAR_EVENTS={CREATE:"event:calendar.meeting.create",UPDATE:"event:calendar.meeting.update",CREATE_MINIMAL:"event:calendar.meeting.create.minimal",UPDATE_MINIMAL:"event:calendar.meeting.update.minimal",DELETE:"event:calendar.meeting.delete"},t.FLOOR_ACTION={GRANTED:"GRANTED",RELEASED:"RELEASED"},t.MEETING_STATE={TRANSITIONS:{ERROR:"error",START:"start",JOIN:"join",JOINED:"joined",LOCAL:"local",CONNECT:"connect",ESTABLISH:"establish",LEAVE:"leave",END:"end",CLEAN:"clean"},STATES:{IDLE:"IDLE",INCOMING:"INCOMING",DIALING:"DIALING",NOTIFIED:"NOTIFIED",DECLINED:"DECLINED",ON_GOING:"ON_GOING",CONNECTING_MEDIA_LOCAL:"CONNECTING_MEDIA_LOCAL",CONNECTING_MEDIA_REMOTE:"CONNECTING_MEDIA_REMOTE",ESTABLISHED_MEDIA:"ESTABLISHED_MEDIA",TERMINATING:"TERMINATING",LEFT:"LEFT",ENDED:"ENDED",ERROR:"ERROR"}},t.LOCUS={STATE:{INACTIVE:"inactive"},SEQUENCE:{UN_DEF:"undef",EMPTY:"empty",DEF:"def",NA:"na",RANGE_START:"rangeStart",RANGE_END:"rangeEnd"},SYNCDEBUG:"sync_debug"},t.LOCUSEVENT={LOCUS_MERCURY:"event:locus",CONTROLS_UPDATED:"locus.controls_updated",DIFFERENCE:"locus.difference",FLOOR_GRANTED:"locus.floor_granted",FLOOR_RELEASED:"locus.floor_released",MESSAGE_ROAP:"locus.message.roap",PARTICIPANT_JOIN:"locus.participant_joined",PARTICIPANT_LEFT:"locus.participant_left",PARTICIPANT_DECLINED:"locus.participant_declined",PARTICIPANT_UPDATED:"locus.participant_updated",PARTICIPANT_CONTROLS_UPDATED:"locus.participant_controls_updated",PARTICIPANT_ROLES_UPDATED:"locus.participant_roles_updated",PARTICIPANT_AUDIO_MUTED:"locus.participant_audio_muted",PARTICIPANT_AUDIO_UNMUTED:"locus.participant_audio_unmuted",PARTICIPANT_VIDEO_MUTED:"locus.participant_video_muted",PARTICIPANT_VIDEO_UNMUTED:"locus.participant_video_unmuted",RECORDING_STARTED:"locus.recording_started",RECORDING_START_FAILED:"locus.recording_start_failed",RECORDING_STOPPED:"locus.recording_stopped",SELF_CHANGED:"locus.self_changed"},t.RECONNECTION={STATE:{IN_PROGRESS:"IN_PROGRESS",COMPLETE:"COMPLETE",FAILURE:"FAILURE",DEFAULT_TRY_COUNT:0,DEFAULT_STATUS:""}},t.EVENT_TRIGGERS={MEETINGS_READY:"meetings:ready",MEDIA_AUDIO_CHANGED:"media:audioChanged",MEDIA_VIDEO_CHANGED:"media:videoChanged",MEDIA_READY:"media:ready",MEDIA_STOPPED:"media:stopped",MEDIA_UPDATE:"media:update",STATS_UPDATE:"stats:update",MEETING_ADDED:"meeting:added",MEETING_REMOVED:"meeting:removed",MEETING_RINGING:"meeting:ringing",MEETING_SELF_LOBBY_WAITING:"meeting:self:lobbyWaiting",MEETING_SELF_GUEST_ADMITTED:"meeting:self:guestAdmitted",MEMBERS_UPDATE:"members:update",MEMBERS_CONTENT_UPDATE:"members:content:update",MEMBERS_HOST_UPDATE:"members:host:update",MEMBERS_SELF_UPDATE:"members:self:update",MEETING_RECONNECTION_STARTING:"meeting:reconnectionStarting",MEETING_RECONNECTION_SUCCESS:"meeting:reconnectionSuccess",MEETING_RECONNECTION_FAILURE:"meeting:reconnectionFailure"},t.EVENT_STATS_MAP={BYTES_SENT:"bytesSent",BYTES_RECEIVED:"bytesReceived"},t.EVENT_TYPES={SELF:"self",OTHER:"other",LOCAL:"local",REMOTE:"remote",REMOTE_SHARE:"remoteShare",LOCAL_SHARE:"localShare",ERROR:"error"},t.DELTAEVENT={GT:"GT",CF:"CF",EQ:"EQ",LT:"LT"},t.MEETING_AUDIO_STATE_MACHINE={TRANSITIONS:{TOGGLE:"toggle",INIT:"init"},STATES:{MUTE_SELF:"SELF_AUDIO_OFF",UNMUTE_SELF:"SELF_AUDIO_ON"}},t.MEETING_VIDEO_STATE_MACHINE={TRANSITIONS:{TOGGLE:"toggle",INIT:"init"},STATES:{MUTE_SELF:"SELF_VIDEO_OFF",UNMUTE_SELF:"SELF_VIDEO_ON"}},t.SDP={A_CONTENT_SLIDES:"a=content:slides",ROLLBACK:"rollback",HAVE_LOCAL_OFFER:"have-local-offer",STABLE:"stable",OFFER:"offer",M_LINE:"m=",MAX_FS_8160:"max-fs=8160",B_LINE:"b=TIAS",CARRIAGE_RETURN:"\r\n",BAD_MEDIA_PORTS:[9,0]},t.ICE_STATE={CHECKING:"checking",CONNECTED:"connected",FAILED:"failed",DISCONNECTED:"disconnected"},t.RESOURCE={CLUSTERS:"clusters",REACHABILITY:"reachability",LOCI:"loci"},t.REACHABILITY={localStorage:"reachability.result"},t.ROAP={ROAP_TRANSITIONS:{STEP:"step"},ROAP_TYPES:{OFFER:"OFFER",ANSWER:"ANSWER",OK:"OK",ERROR:"ERROR",SHUTDOWN:"SHUTDOWN",OFFER_REQUEST:"OFFER_REQUEST"},ROAP_STATE:{INIT:"INIT",WAIT_RX_OFFER:"WAIT_RX_OFFER",WAIT_RX_ANSWER:"WAIT_RX_ANSWER",WAIT_RX_OK:"WAIT_RX_OK",WAIT_TX_OFFER:"WAIT_TX_OFFER",WAIT_TX_ANSWER:"WAIT_TX_ANSWER",WAIT_TX_OK:"WAIT_TX_OK",IDLE_LOCAL_OFFER:"IDLE_LOCAL_OFFER",IDLE_REMOTE_OFFER:"IDLE_REMOTE_OFFER",GLARE:"GLARE",ERROR:"ERROR"},ROAP_SIGNAL:{RX_OFFER:"RX_OFFER",TX_OFFER:"TX_OFFER",RX_ANSWER:"RX_ANSWER",TX_ANSWER:"TX_ANSWER",RX_OK:"RX_OK",TX_OK:"TX_OK",GLARE_RESOLVED:"GLARE_RESOLVED"},RECEIVE_ROAP_MSG:"RECEIVE_ROAP_MSG",SEND_ROAP_MSG:"SEND_ROAP_MSG",SEND_ROAP_MSG_SUCCESS:"SEND_ROAP_MSG_SUCCESS",RESET_ROAP_STATE:"RESET_ROAP_STATE",RECEIVE_CALL_LEAVE:"RECEIVE_CALL_LEAVE",ROAP_MERCURY:"event:locus.message.roap",ROAP_VERSION:"2",RX_:"RX_",TX_:"TX_"},t.EVENTS={ROAP_OK:"ROAP_OK",ROAP_ANSWER:"ROAP_ANSWER",SELF_UNADMITTED_GUEST:"SELF_UNADMITTED_GUEST",SELF_ADMITTED_GUEST:"SELF_ADMITTED_GUEST",CONVERSATION_URL_UPDATE:"CONVERSATION_URL_UPDATE",DESTROY_MEETING:"DESTROY_MEETING",LOCUS_INFO_UPDATE_PARTICIPANTS:"LOCUS_INFO_UPDATE_PARTICIPANTS",LOCUS_INFO_UPDATE_HOST:"LOCUS_INFO_UPDATE_HOST",LOCUS_INFO_UPDATE_MEDIA_SHARES:"LOCUS_INFO_UPDATE_MEDIA_SHARES",LOCUS_INFO_UPDATE_SELF:"LOCUS_INFO_UPDATE_SELF",LOCUS_INFO_UPDATE_URL:"LOCUS_INFO_UPDATE_URL"},t.DEFAULT_GET_STATS_FILTER={types:["track","transport","candidate-pair","outbound-rtp","outboundrtp","inbound-rtp","inboundrtp"]},t.DEFAULT_EVENT_VIDEO_SEND_KEYS=["rtpOutVideo","rtcOutVideo","rtcTransVideo"],t.DEFAULT_EVENT_AUDIO_SEND_KEYS=["rtpOutAudio","rtcOutAudio","rtcTransAudio"],t.DEFAULT_EVENT_VIDEO_RECEIVE_KEYS=["rtpInVideo","rtcInVideo","rtcTransVideo"],t.DEFAULT_EVENT_AUDIO_RECEIVE_KEYS=["rtpInAudio","rtcInAudio","rtcTransAudio"],t.DEFAULT_TRANSFORM_KEYS=["rtpOutVideo","rtpOutAudio","rtpInVideo","rtpInAudio","rtcOutAudio","rtcOutVideo","rtcInAudio","rtcInVideo","rtcTransAudio","rtcTransVideo","rtcCandidatePairAudio","rtcCandidatePairVideo"],t.DEFAULT_TRANSFORM_REGEX={rtpOutVideo:{regex:new RegExp("^(?:RTC)?[Oo]utbound_?[Rr][Tt][Pp]_?[Vv]ideo")},rtpOutAudio:{regex:new RegExp("^(?:RTC)?[Oo]utbound_?[Rr][Tt][Pp]_?[Aa]udio")},rtpInVideo:{regex:new RegExp("^(?:RTC)?[Ii]nbound_?[Rr][Tt][Pp]_?[Vv]ideo")},rtpInAudio:{regex:new RegExp("^(?:RTC)?[Ii]nbound_?[Rr][Tt][Pp]_?[Aa]udio")},rtcOutAudio:{regex:new RegExp("^RTCMediaStreamTrack_(?:local|sender)_"),profiler:{type:"kind",value:"audio"}},rtcOutVideo:{regex:new RegExp("^RTCMediaStreamTrack_(?:local|sender)_"),profiler:{type:"kind",value:"video"}},rtcInAudio:{regex:new RegExp("^RTCMediaStreamTrack_(?:remote|receiver)_"),profiler:{type:"kind",value:"audio"}},rtcInVideo:{regex:new RegExp("^RTCMediaStreamTrack_(?:remote|receiver)_"),profiler:{type:"kind",value:"video"}},rtcTransAudio:{regex:new RegExp("^RTCTransport_[Aa]udio")},rtcTransVideo:{regex:new RegExp("^RTCTransport_[Vv]ideo")},rtcCandidatePairAudio:{regex:new RegExp("^RTCIceCandidatePair_"),decider:"nominated",selector:!0,profiler:{type:"transportId",value:"audio"}},rtcCandidatePairVideo:{regex:new RegExp("^RTCIceCandidatePair_"),decider:"nominated",selector:!0,profiler:{type:"transportId",value:"video"}}},t.DEFAULT_STATS_INTERVAL=1e3,t.DEFAULT_STATS_HISTORY_MAX=1800,t.DEFAULT_EXCLUDED_STATS=["timestamp","ssrc","priority"]});t(wL);wL.AUDIO,wL.AUDIO_BANDWIDTH_LIMIT,wL.AUDIO_INPUT,wL.AUDIO_STATUS,wL.ALTERNATE_REDIRECT_TRUE,wL.ANSWER,wL.ALERT,wL.ACTIVE,wL.BUSY,wL.CALL,wL.CREATED,wL.CONFLICT,wL.CORRELATION_ID,wL.CONVERSATION_URL,wL.CONVERSATIONS,wL.CALENDAR,wL.CALENDAR_EVENTS_API,wL.CMR_MEETINGS,wL.CLAIM,wL.CONTROLS,wL.CONTENT,wL.DEVELOPMENT,wL.DECLINE,wL.ERROR,wL.GET,wL.HECATE,wL.HTTPS_PROTOCOL,wL.IDLE,wL.ICE_TIMEOUT,wL.ICE_FAIL_TIMEOUT,wL.IN_LOBBY,wL.IN_MEETING,wL.INCOMING,wL.INTENT_TO_JOIN,wL.JOINED,wL.JOIN,wL.LEAVE,wL.LOCAL,wL.LOCI,wL.LOCUS_ID,wL.LOCUS_URL,wL.LEFT,wL.MEETING_LINK,wL.MEETINGS,wL.MEETING,wL.MEETING_CENTER,wL.MEETING_ID,wL.MEETINGINFO,wL.MEDIA_SIP_URI,wL.MEDIA,wL.MODERATOR_TRUE,wL.MODERATOR_FALSE,wL.MEDIA_PEER_CONNECTION_NAME,wL.MEET,wL.MEET_M,wL.NOT_IN_MEETING,wL.NONE,wL.ONE_ON_ONE,wL.OFFER,wL.OBSERVE,wL.OUTGOING,wL.ONLINE,wL.OTHER,wL.PARTICIPANT,wL.PERSONAL_ROOM,wL.PUT,wL.POST,wL.RETRY_TIMEOUT,wL.REMOTE,wL.REQUESTED,wL._ANSWER_,wL._ERROR_,wL._DATA_,wL._CLOSED_,wL.RTC_CONFIGURATION_FIREFOX,wL.RTC_CONFIGURATION,wL.RESOURCE_ROOM,wL.READY,wL.RECEIVE_ONLY,wL.SIP_URI,wL.STOP,wL.SHARE_PEER_CONNECTION_NAME,wL.SELF,wL.SEND_RECEIVE,wL.TEMP_SIP_URI,wL.TYPE,wL.USE_URI_LOOKUP_FALSE,wL.USER,wL.UNKNOWN,wL.VALID_PMR_ADDRESS,wL.VALID_PMR_LINK,wL.VALID_PIN,wL.VIDEO,wL.VIDEO_BANDWIDTH_LIMIT,wL.VIDEO_INPUT,wL.VIDEO_STATUS,wL.WEBEX_DOT_COM,wL.WEBEX_MEETING,wL.WAIT,wL.WWW_DOT,wL.ERROR_DICTIONARY,wL.API,wL.DIALER_REGEX,wL.CALENDAR_EVENTS,wL.FLOOR_ACTION,wL.MEETING_STATE,wL.LOCUS,wL.LOCUSEVENT,wL.RECONNECTION,wL.EVENT_TRIGGERS,wL.EVENT_STATS_MAP,wL.EVENT_TYPES,wL.DELTAEVENT,wL.MEETING_AUDIO_STATE_MACHINE,wL.MEETING_VIDEO_STATE_MACHINE,wL.SDP,wL.ICE_STATE,wL.RESOURCE,wL.REACHABILITY,wL.ROAP,wL.EVENTS,wL.DEFAULT_GET_STATS_FILTER,wL.DEFAULT_EVENT_VIDEO_SEND_KEYS,wL.DEFAULT_EVENT_AUDIO_SEND_KEYS,wL.DEFAULT_EVENT_VIDEO_RECEIVE_KEYS,wL.DEFAULT_EVENT_AUDIO_RECEIVE_KEYS,wL.DEFAULT_TRANSFORM_KEYS,wL.DEFAULT_TRANSFORM_REGEX,wL.DEFAULT_STATS_INTERVAL,wL.DEFAULT_STATS_HISTORY_MAX,wL.DEFAULT_EXCLUDED_STATS;var OL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=KP)&&r.__esModule?r:{default:r};var i={meetingInfos:{},get:function(e){return this.meetingInfos[e]?this.meetingInfos[e]:(0,n.default)(this.meetingInfos,function(t){return t.sipUrl===e||t.locusId===e||t.userId===e||t.meetingLink===e})},set:function(e,t){return this.meetingInfos[e]=t,this.meetingInfos[e]},getAll:function(){return this.meetingInfos}};t.default=i});t(OL);var kL=r(function(e){!function(){e.exports=function(e){return(e instanceof nm?e:nm.from(e.toString(),"binary")).toString("base64")}}()}),RL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(kL),n=i(yy);function i(e){return e&&e.__esModule?e:{default:e}}var o={getParsedUrl:function(e){try{var t=n.default.parse(e);return!!t&&(t.protocol||(t=n.default.parse(""+wL.HTTPS_PROTOCOL+e)),t)}catch(e){return console.error(e),null}},isMeetingLink:function(e){var t=o.getParsedUrl(e),r=t.hostname&&t.hostname.includes(wL.WEBEX_DOT_COM),n=t.pathname&&(t.pathname.includes("/"+wL.MEET)||t.pathname.includes("/"+wL.MEET_M)||t.pathname.includes("/"+wL.JOIN));return r&&n},convertLinkToSip:function(e){var t=o.getParsedUrl(e);if(!t)return null;var r=void 0;if(t.pathname){var n=t.pathname.lastIndexOf("/");r=t.pathname.substring(n+1)}if(!r)return null;var i=void 0;if(t.hostname){var a=t.hostname.lastIndexOf("."+wL.WEBEX_DOT_COM);i=t.hostname.substring(0,a).replace(wL.WWW_DOT,"")}return i?r+"@"+i+"."+wL.WEBEX_DOT_COM:null},isSipUri:function(e){return wL.DIALER_REGEX.SIP_ADDRESS.exec(e)},isPhoneNumber:function(e){return wL.DIALER_REGEX.PHONE_NUMBER.test(e)},generateOptions:function(e){var t=e.destination,r=e.type,n=e.conversationServiceUrl;if(r)return{destination:t,type:r};var i={};return o.isMeetingLink(t)?(i.type=wL.MEETING_LINK,i.destination=t):o.isSipUri(t)?(i.type=wL.SIP_URI,i.destination=t):o.isPhoneNumber(t)?(i.type=wL.SIP_URI,i.destination=t):(i.type=wL.CONVERSATION_URL,i.destination=n+"/"+wL.CONVERSATIONS+"/"+t),i},getResourceUrl:function(e,t){var n="/"+wL.LOCI+"/"+wL.MEETINGINFO,i=wL.GET;switch(e){case wL.SIP_URI:case wL.PERSONAL_ROOM:case wL.MEETING_ID:n="/"+wL.LOCI+"/"+wL.MEETINGINFO+"/"+t+"?"+wL.TYPE+"="+e+"&"+wL.USE_URI_LOOKUP_FALSE;break;case wL.CONVERSATION_URL:i=wL.PUT;break;case wL.LOCUS_ID:n="/"+wL.LOCI+"/"+t+"/"+wL.MEETINGINFO,i=wL.PUT;break;case wL.MEETING_LINK:n="$/"+wL.LOCI+"/"+wL.MEETINGINFO+"/"+(0,r.default)(t)+"?"+wL.TYPE+"="+wL.MEETING_LINK+"&"+wL.USE_URI_LOOKUP_FALSE}return{resource:n,method:i}},getRequestParams:function(e,t,r,n){var i={method:e.method,api:n,resource:e.resource};return e.method===wL.GET?i.resource=i.resource.concat("&"+wL.ALTERNATE_REDIRECT_TRUE):t!==wL.LOCUS_ID&&(i.body={value:r,lookupType:t,alternateRedirect:!0}),i},getMeetingInfoAPIFormat:function(e){return{type:e.type,value:e.destination}}};t.default=o});t(RL);var AL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(rT),n=u(By),i=u(Yy),o=u(nT),a=u(iT),s=u(RL);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){var e,i,a,s;(0,n.default)(this,t);for(var u=arguments.length,c=Array(u),l=0;l<u;l++)c[l]=arguments[l];return i=a=(0,o.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(c))),a.namespace=wL.MEETINGS,s=i,(0,o.default)(a,s)}return(0,a.default)(t,e),(0,i.default)(t,[{key:"fetchMeetingInfo",value:function(e){if(!e||!e.type||!e.destination)throw new Error("MeetingInfo should be fetched with a type and destination specified, see list of valid types and their corresponding values in constants");var t=s.default.getMeetingInfoAPIFormat(e),r=s.default.getResourceUrl(t.type,t.value),n=s.default.getRequestParams(r,t.type,t.value,wL.API.LOCUS);return this.request(n)}}]),t}(MP.StatelessSparkPlugin);t.default=c});t(AL);var IL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=f(_f),n=f(rT),i=f(By),o=f(Yy),a=f(nT),s=f(iT),u=f(OL),c=f(AL),l=f(RL);function f(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e,r){(0,i.default)(this,t);var o=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,{},r));return o.namespace=wL.MEETINGS,o.meetingInfoRequest=new c.default({},r),o}return(0,s.default)(t,e),(0,o.default)(t,[{key:"requestFetchInfo",value:function(e){return this.meetingInfoRequest.fetchMeetingInfo(e).then(function(e){return t.setMeetingInfo(e.id,e),e}).catch(function(e){return r.default.reject(e)})}},{key:"fetchInfoOptions",value:function(e,t){return l.default.generateOptions({destination:e,type:t,conversationServiceUrl:this.spark.internal.device.services.conversationServiceUrl})}},{key:"fetchMeetingInfo",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.fetchInfoOptions(e,n);return this.requestFetchInfo(i).catch(function(n){return i.type===wL.MEETING_LINK?t.requestFetchInfo(t.fetchInfoOptions(l.default.convertLinkToSip(e),wL.SIP_URI)):r.default.reject(n)})}}],[{key:"getMeetingInfo",value:function(e){return u.default.get(e)}},{key:"setMeetingInfo",value:function(e,t){u.default.set(e,t)}}]),t}(MP.StatelessSparkPlugin);t.default=d});t(IL);var PL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=a(yR),n=a(_f),i=a(bC),o=a(NN);function a(e){return e&&e.__esModule?e:{default:e}}var s={},u=function(e,t){var r=void 0;return r=-1!==e[t].search(wL.AUDIO)?wL.AUDIO_BANDWIDTH_LIMIT:wL.VIDEO_BANDWIDTH_LIMIT,e.splice(t+1,0,wL.SDP.B_LINE+":"+r),e},c=function(e){var t=e,r=e.match(/\na=fmtp:(\d+).*level-asymmetry-allowed=1.*/g);return r&&r.forEach(function(e){t=t.replace(e,e+";"+wL.SDP.MAX_FS_8160)}),t},l=function(e){var t=e.match(/\nm=video.*/g),r=e.match(/\na=rtpmap:\d+\sH264.*/g);return!t||!!r},f=function(e){o.default.parse(e).media.forEach(function(e){return e.candidates&&0===e.candidates.length?(console.error("iceCandidate: Ice candadate never completed"),!1):wL.SDP.BAD_MEDIA_PORTS.includes(e.port)?(console.error("iceCandidate: Found invalid port number for the ice candidate"),!1):!(!e.icePwd||!e.iceUfrag)||(console.error("iceCandidate: ice ufrag and password not found"),!1)})},d=function(e){for(var t=e,r=t.split(wL.SDP.CARRIAGE_RETURN),n=0;n<r.length;n+=1)-1!==r[n].search(wL.SDP.M_LINE)&&(r=u(r,n));return t=r.join(wL.SDP.CARRIAGE_RETURN)};s.iceFailListener=function(e,t,r){e&&(e.oniceconnectionstatechange=function(){switch(e.iceConnectionState){case wL.ICE_STATE.FAILED:case wL.ICE_STATE.DISCONNECTED:console.error(r+" Interactive Connectivity Establishment(ICE)"+e.iceConnectionState+"!",new Date),setTimeout(function(){switch(e.iceConnectionState){case wL.ICE_STATE.FAILED:case wL.ICE_STATE.DISCONNECTED:t()}},wL.ICE_FAIL_TIMEOUT)}})},s.detectFailures=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){console.error("Ice failed, no function to reconnect with.")};s.iceFailListener(e,r,wL.MEDIA_PEER_CONNECTION_NAME),s.iceFailListener(t,r,wL.SHARE_PEER_CONNECTION_NAME)},s.setContentSlides=function(e){return e&&e.sdp&&(e.sdp+=""+wL.SDP.A_CONTENT_SLIDES+wL.SDP.CARRIAGE_RETURN),e},s.iceCandidate=function(e){return new n.default(function(t){var r=setTimeout(function(){e.sdp=d(e.localDescription.sdp),e.sdp=c(e.sdp),e.sdp=e.sdp.replace(/\na=extmap.*/g,""),f(e.sdp)?t(e):setTimeout(function(){t(e)},wL.RETRY_TIMEOUT)},wL.ICE_TIMEOUT);e.onicecandidate=function(n){n.candidate||e.sdp||(e.sdp=d(e.localDescription.sdp),e.sdp=c(e.sdp),e.sdp=e.sdp.replace(/\na=extmap.*/g,""),null===n.candidate&&(f(e.sdp),clearTimeout(r),t(e)))}})},s.replaceTrack=function(e,t){try{var r=e.getSenders();r.length>0&&r.forEach(function(e){e.track&&e.track.kind===t.kind&&e.replaceTrack(t)})}catch(e){console.error("replaceTrack: Error while replacing Tracks ",e)}},s.addStream=function(e,t){console.info("addStream: adding streams to peerconnection");try{if(t&&!i.default.msedge){if(e.getSenders&&e.getSenders().find(function(e){return null!=e.track}))return void t.getTracks().forEach(function(t){s.replaceTrack(e,t)});t.getTracks().forEach(function(r){e.addTrack(r,t)})}else i.default.msedge?e.addStream(t):console.error("addStream: No streams to add")}catch(e){console.error("addStream: Error while adding Stream ",e)}},s.setRemoteSessionDetails=function(e,t,r){var i=e.sharePeerConnection;console.info("Setting the remote description type: "+t+"State: "+e.signalingState);var o=[],a=r,s=(a=a.replace(/\na=extmap.*/g,"")).split(wL.SDP.M_LINE);if(4===s.length&&i){a=""+s[0]+wL.SDP.M_LINE+s[1]+wL.SDP.M_LINE+s[2];var u=""+s[0]+wL.SDP.M_LINE+s[3];o.push(i.setRemoteDescription(new window.RTCSessionDescription({type:t,sdp:u})))}return(e.signalingState===wL.SDP.HAVE_LOCAL_OFFER||e.signalingState===wL.SDP.STABLE&&t===wL.SDP.OFFER)&&o.push(e.setRemoteDescription(new window.RTCSessionDescription({type:t,sdp:a}))),n.default.all(o).catch(function(e){return console.error("Error setting the remoteDescription",e),n.default.reject(e)})},s.createOffer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.info("createOffer: creating a new offer");try{var t=e.peerConnection||new window.RTCPeerConnection(i.default.firefox?wL.RTC_CONFIGURATION_FIREFOX:wL.RTC_CONFIGURATION);e.streams&&(Array.isArray(e.streams)?s.addStream(t,e.streams[0]):s.addStream(t,e.streams));var r={offerToReceiveAudio:e.receiveAudio,offerToReceiveVideo:e.receiveVideo};return t.createOffer(r).then(function(e){return t.setLocalDescription(e)}).then(function(){return s.iceCandidate(t)}).then(function(){if(t.sdp=d(t.localDescription.sdp),t.sdp=c(t.sdp),!l(t.sdp))throw new Error("openH264 is downloading please Wait. Upload logs if not working on second try");return t.sdp=t.sdp.replace(/\na=extmap.*/g,""),t}).catch(function(e){throw s.close(t),e})}catch(e){throw console.error("createOffer: error while creating a offer ",e),e}},s.rollBackLocalDescription=function(e){return console.info("rollBackLocalDescription: rollingbacking peerconnection"),e.setLocalDescription(new RTCSessionDescription({type:wL.SDP.ROLLBACK})).then(function(){return e}).catch(function(e){return console.error("rollBackLocalDescription: Error while setting the Local Description ",e),n.default.error(e)})},s.updatePeerConnection=function(e){console.info("updatePeerConnection: updating the pc");var t=e.pc,i=e.sharePeerConnection,o={offerToReceiveAudio:!1,offerToReceiveVideo:!0},a={offerToReceiveAudio:e.offerToReceiveAudio,offerToReceiveVideo:e.offerToReceiveVideo};return void 0===t&&i?s.createAnswer({pc:i,screenConstraints:o,offerSdp:e.offerSdp[0]}).then(function(e){return e.sdp+=""+wL.SDP.A_CONTENT_SLIDES+wL.SDP.CARRIAGE_RETURN,[e.sdp]}):n.default.all([s.createAnswer({pc:t,sdpConstraints:a,offerSdp:e.offerSdp[0]}),s.createAnswer({pc:i,offerSdp:e.offerSdp[1],sdpConstraints:o})]).then(function(e){var t=(0,r.default)(e,2),n=t[0],o=t[1];return i.sdp+=""+wL.SDP.A_CONTENT_SLIDES+wL.SDP.CARRIAGE_RETURN,[n.sdp,o.sdp]})},s.createAnswer=function(e){var t=e.pc;return"have-remote-offer"===t.signalingState?n.default.resolve(t):s.setRemoteSessionDetails(t,"offer",e.offerSdp).then(function(){return t.createAnswer(e.sdpConstraints)}).then(function(e){return t.setLocalDescription(e)}).then(function(){return s.iceCandidate(t)}).then(function(){if(t.sdp=d(t.localDescription.sdp),t.sdp=c(t.sdp),!l(t.sdp))throw new Error("openH264 is downloading please Wait. Upload logs if not working on second try");return t.sdp=t.sdp.replace(/\na=extmap.*/g,""),t}).catch(function(e){console.error("updatePeerConnection: error while updating the PC ",e)})},s.close=function(e){return console.info("PC: close() -> closing the mediaPeerConnection"),n.default.resolve().then(function(){e&&e.close?e.close():console.warn("Peer connection has no close")}).catch(function(e){console.error("Error Cleaning Up the PeerConnection",e)})},t.default=s});t(PL);var CL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(_f),n=i(PL);function i(e){return e&&e.__esModule?e:{default:e}}var o={},a=wL.ANSWER.toLowerCase();o.shouldHandleMedia=function(e){var t=e.mediaProperties.mediaPeerConnection&&e.mediaProperties.mediaPeerConnection.signalingState===wL.SDP.HAVE_LOCAL_OFFER,r=e.mediaProperties.sharePeerConnection&&e.mediaProperties.sharePeerConnection.signalingState===wL.SDP.HAVE_LOCAL_OFFER;return!t&&!r},o.handleError=function(e){return n.default.rollBackLocalDescription({mediaPeerConnection:e}).then(function(){return r.default.resolve(!0)}).catch(function(e){return r.default.reject(e)})},o.findError=function(e,t,r){return(r===wL.ROAP.RECEIVE_ROAP_MSG||r===wL.ROAP.SEND_ROAP_MSG)&&e===wL.ERROR&&t===wL.CONFLICT},o.ensureMeeting=function(e,t){return!!(t!==wL.ROAP.RECEIVE_ROAP_MSG&&t!==wL.ROAP.SEND_ROAP_MSG&&t!==wL.ROAP.SEND_ROAP_MSG_SUCCESS||e)},o.compareLastRemoteOffer=function(e,t){var r=void 0,n=void 0,i=!1;return t.length>0&&t.length===e.length&&(console.log("previous offer",t[0].slice(0,20)),console.log("current offer",e[0].slice(0,20)),t.forEach(function(t,o){r=t.indexOf("IN"),n=e[o].indexOf("IN"),t.substring(r)!==e[o].substring(n)&&(i=!0)})),i},o.updatePeerConnection=function(e,t){if(!o.compareLastRemoteOffer(t.OFFER.sdps,e.roap.lastRoapOffer)){var i=[];return e.mediaProperties.mediaPeerConnection&&i.push(e.mediaProperties.mediaPeerConnection.sdp),e.mediaProperties.sharePeerConnection&&i.push(e.mediaProperties.sharePeerConnection.sdp),r.default.resolve(i)}return n.default.updatePeerConnection({offerSdp:t.OFFER.sdps,pc:e.mediaProperties.mediaPeerConnection,sharePeerConnection:e.mediaProperties.sharePeerConnection,offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then(function(r){return e.roap.lastRoapOffer=t.OFFER.sdps,r})},o.setRemoteDescription=function(e,t){if(console.info("Call-RoapHandler: Transmite WAIT_TX_OK",e.correlationId),!e||!e.mediaProperties.mediaPeerConnection&&!e.mediaProperties.sharePeerConnection)return console.error("Call-RoapHandler: DANGER no media or screen peer connection",e.correlationId),r.default.reject(new Error("Must provide a media or screen peer connection"));var i=void 0;return e.mediaProperties.mediaPeerConnection&&e.mediaProperties.sharePeerConnection?i=r.default.all([n.default.setRemoteSessionDetails(e.mediaProperties.mediaPeerConnection,a,t.ANSWER.sdps[0],e.clientIdentifiers),n.default.setRemoteSessionDetails(e.mediaProperties.sharePeerConnection,a,t.ANSWER.sdps[1],e.clientIdentifiers)]):e.mediaProperties.sharePeerConnection&&(i=n.default.setRemoteSessionDetails(e.mediaProperties.sharePeerConnection,a,t.ANSWER.sdps[0],e.clientIdentifiers)),i.then(function(){return console.info("Call-RoapHandler: setRemote Description successfull",e.correlationId),{seq:t.ANSWER.seq,locusId:e.locusId,locusSelfId:e.locusInfo.self.id,mediaId:e.mediaId,correlationId:e.correlationId}}).catch(function(e){throw console.error("Call-RoapHandler: Error setting remote and sending Roap Message",e),e})},t.default=o});t(CL);var ML=r(function(e,t){var r;r=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.i=function(e){return e},r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(e,t,r){e.exports=function(e,t){var r,n,i;for(r=1;r<arguments.length;r++)for(i in n=arguments[r])n.hasOwnProperty(i)&&(e[i]=n[i]);return e}},function(e,t,r){var n=r(0);e.exports={build:function(e,t){var r,i,o,a=t.plugins;for(r=0,i=a.length;r<i;r++)(o=a[r]).methods&&n(e,o.methods),o.properties&&Object.defineProperties(e,o.properties)},hook:function(e,t,r){var n,i,o,a,s=e.config.plugins,u=[e.context];for(r&&(u=u.concat(r)),n=0,i=s.length;n<i;n++)a=s[n],(o=s[n][t])&&o.apply(a,u)}}},function(e,t,r){function n(e){if(0===e.length)return e;var t,r,n=e.split(/[_-]/);if(1===n.length&&n[0][0].toLowerCase()===n[0][0])return e;for(r=n[0].toLowerCase(),t=1;t<n.length;t++)r=r+n[t].charAt(0).toUpperCase()+n[t].substring(1).toLowerCase();return r}n.prepended=function(e,t){return e+(t=n(t))[0].toUpperCase()+t.substring(1)},e.exports=n},function(e,t,r){var n=r(0),i=r(2);function o(e,t){e=e||{},this.options=e,this.defaults=t.defaults,this.states=[],this.transitions=[],this.map={},this.lifecycle=this.configureLifecycle(),this.init=this.configureInitTransition(e.init),this.data=this.configureData(e.data),this.methods=this.configureMethods(e.methods),this.map[this.defaults.wildcard]={},this.configureTransitions(e.transitions||[]),this.plugins=this.configurePlugins(e.plugins,t.plugin)}n(o.prototype,{addState:function(e){this.map[e]||(this.states.push(e),this.addStateLifecycleNames(e),this.map[e]={})},addStateLifecycleNames:function(e){this.lifecycle.onEnter[e]=i.prepended("onEnter",e),this.lifecycle.onLeave[e]=i.prepended("onLeave",e),this.lifecycle.on[e]=i.prepended("on",e)},addTransition:function(e){this.transitions.indexOf(e)<0&&(this.transitions.push(e),this.addTransitionLifecycleNames(e))},addTransitionLifecycleNames:function(e){this.lifecycle.onBefore[e]=i.prepended("onBefore",e),this.lifecycle.onAfter[e]=i.prepended("onAfter",e),this.lifecycle.on[e]=i.prepended("on",e)},mapTransition:function(e){var t=e.name,r=e.from,n=e.to;return this.addState(r),"function"!=typeof n&&this.addState(n),this.addTransition(t),this.map[r][t]=e,e},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(e){return"string"==typeof e?this.mapTransition(n({},this.defaults.init,{to:e,active:!0})):"object"==typeof e?this.mapTransition(n({},this.defaults.init,e,{active:!0})):(this.addState(this.defaults.init.from),this.defaults.init)},configureData:function(e){return"function"==typeof e?e:"object"==typeof e?function(){return e}:function(){return{}}},configureMethods:function(e){return e||{}},configurePlugins:function(e,t){var r,n,i;for(r=0,n=(e=e||[]).length;r<n;r++)"function"==typeof(i=e[r])&&(e[r]=i=i()),i.configure&&i.configure(this);return e},configureTransitions:function(e){var t,r,n,i,o,a=this.defaults.wildcard;for(r=0;r<e.length;r++)for(n=e[r],i=Array.isArray(n.from)?n.from:[n.from||a],o=n.to||a,t=0;t<i.length;t++)this.mapTransition({name:n.name,from:i[t],to:o})},transitionFor:function(e,t){var r=this.defaults.wildcard;return this.map[e][t]||this.map[r][t]},transitionsFor:function(e){var t=this.defaults.wildcard;return Object.keys(this.map[e]).concat(Object.keys(this.map[t]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}}),e.exports=o},function(e,t,r){var n=r(0),i=r(6),o=r(1),a=[null,[]];function s(e,t){this.context=e,this.config=t,this.state=t.init.from,this.observers=[e]}n(s.prototype,{init:function(e){if(n(this.context,this.config.data.apply(this.context,e)),o.hook(this,"init"),this.config.init.active)return this.fire(this.config.init.name,[])},is:function(e){return Array.isArray(e)?e.indexOf(this.state)>=0:this.state===e},isPending:function(){return this.pending},can:function(e){return!this.isPending()&&!!this.seek(e)},cannot:function(e){return!this.can(e)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(e,t){var r=this.config.defaults.wildcard,n=this.config.transitionFor(this.state,e),i=n&&n.to;return"function"==typeof i?i.apply(this.context,t):i===r?this.state:i},fire:function(e,t){return this.transit(e,this.state,this.seek(e,t),t)},transit:function(e,t,r,n){var i=this.config.lifecycle,o=this.config.options.observeUnchangedState||t!==r;return r?this.isPending()?this.context.onPendingTransition(e,t,r):(this.config.addState(r),this.beginTransit(),n.unshift({transition:e,from:t,to:r,fsm:this.context}),this.observeEvents([this.observersForEvent(i.onBefore.transition),this.observersForEvent(i.onBefore[e]),o?this.observersForEvent(i.onLeave.state):a,o?this.observersForEvent(i.onLeave[t]):a,this.observersForEvent(i.on.transition),o?["doTransit",[this]]:a,o?this.observersForEvent(i.onEnter.state):a,o?this.observersForEvent(i.onEnter[r]):a,o?this.observersForEvent(i.on[r]):a,this.observersForEvent(i.onAfter.transition),this.observersForEvent(i.onAfter[e]),this.observersForEvent(i.on[e])],n)):this.context.onInvalidTransition(e,t,r)},beginTransit:function(){this.pending=!0},endTransit:function(e){return this.pending=!1,e},failTransit:function(e){throw this.pending=!1,e},doTransit:function(e){this.state=e.to},observe:function(e){if(2===e.length){var t={};t[e[0]]=e[1],this.observers.push(t)}else this.observers.push(e[0])},observersForEvent:function(e){for(var t,r=0,n=this.observers.length,i=[];r<n;r++)(t=this.observers[r])[e]&&i.push(t);return[e,i,!0]},observeEvents:function(e,t,r,n){if(0===e.length)return this.endTransit(void 0===n||n);var i=e[0][0],a=e[0][1],s=e[0][2];if(t[0].event=i,i&&s&&i!==r&&o.hook(this,"lifecycle",t),0===a.length)return e.shift(),this.observeEvents(e,t,i,n);var u=a.shift(),c=u[i].apply(u,t);return c&&"function"==typeof c.then?c.then(this.observeEvents.bind(this,e,t,i)).catch(this.failTransit.bind(this)):!1===c?this.endTransit(!1):this.observeEvents(e,t,i,c)},onInvalidTransition:function(e,t,r){throw new i("transition is invalid in current state",e,t,r,this.state)},onPendingTransition:function(e,t,r){throw new i("transition is invalid while previous transition is still in progress",e,t,r,this.state)}}),e.exports=s},function(e,t,r){var n=r(0),i=r(2),o=r(1),a=r(3),s=r(4),u={is:function(e){return this._fsm.is(e)},can:function(e){return this._fsm.can(e)},cannot:function(e){return this._fsm.cannot(e)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(e,t,r){return this._fsm.onInvalidTransition(e,t,r)},onPendingTransition:function(e,t,r){return this._fsm.onPendingTransition(e,t,r)}},c={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(e){throw Error("use transitions to change state")}}};function l(e){return f(this||{},e)}function f(e,t){return d(e,new a(t,l)),e._fsm(),e}function d(e,t){if("object"!=typeof e||Array.isArray(e))throw Error("StateMachine can only be applied to objects");o.build(e,t),Object.defineProperties(e,c),n(e,u),n(e,t.methods),t.allTransitions().forEach(function(t){e[i(t)]=function(){return this._fsm.fire(t,[].slice.call(arguments))}}),e._fsm=function(){this._fsm=new s(this,t),this._fsm.init(arguments)}}l.version="3.0.1",l.factory=function(){var e,t;"function"==typeof arguments[0]?(e=arguments[0],t=arguments[1]||{}):(e=function(){this._fsm.apply(this,arguments)},t=arguments[0]||{});var r=new a(t,l);return d(e.prototype,r),e.prototype._fsm.config=r,e},l.apply=f,l.defaults={wildcard:"*",init:{name:"init",from:"none"}},e.exports=l},function(e,t,r){e.exports=function(e,t,r,n,i){this.message=e,this.transition=t,this.from=r,this.to=n,this.current=i}}])},e.exports=r()});t(ML);var NL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=ML)&&r.__esModule?r:{default:r};var i={createState:function(){return new(n.default.factory({init:wL.ROAP.ROAP_STATE.INIT,transitions:[{name:wL.ROAP.ROAP_TRANSITIONS.STEP,from:"*",to:function(e,t,r){var n=this.state;return function(e,t){var r=e.msg.messageType;if(t){if(r===wL.OFFER&&e.remote&&t.shareStatus===wL.REQUESTED)return!1;if(!t.mediaProperties.mediaPeerConnection&&!t.mediaProperties.sharePeerConnection&&r===wL.ANSWER)return!1}return console.info("Call-RoapHandler: success save proceeding with transition, ",e.msg),!0}(r,t)?function(e,t,r){switch(e){case wL.ROAP.ROAP_STATE.INIT:return t===wL.ROAP.ROAP_SIGNAL.RX_OFFER?wL.ROAP.ROAP_STATE.WAIT_TX_ANSWER:t===wL.ROAP.ROAP_SIGNAL.TX_OFFER?wL.ROAP.ROAP_STATE.WAIT_RX_ANSWER:e;case wL.ROAP.ROAP_STATE.WAIT_RX_OFFER:return e;case wL.ROAP.ROAP_STATE.WAIT_RX_ANSWER:return t===wL.ROAP.ROAP_SIGNAL.RX_ANSWER?r.mediaId?wL.ROAP.ROAP_STATE.WAIT_TX_OK:(console.error("Call-RoapHandler#Race Condition no mediaId"),e):t===wL.ROAP.ROAP_SIGNAL.RX_OFFER?wL.ROAP.ROAP_STATE.GLARE:e;case wL.ROAP.ROAP_STATE.WAIT_TX_OFFER:return e;case wL.ROAP.ROAP_STATE.WAIT_TX_ANSWER:return t===wL.ROAP.ROAP_SIGNAL.TX_ANSWER?wL.ROAP.ROAP_STATE.WAIT_RX_OK:e;case wL.ROAP.ROAP_STATE.WAIT_TX_OK:return t===wL.ROAP.ROAP_SIGNAL.TX_OK?wL.ROAP.ROAP_STATE.INIT:e;case wL.ROAP.ROAP_STATE.WAIT_RX_OK:return t===wL.ROAP.ROAP_SIGNAL.RX_OK?wL.ROAP.ROAP_STATE.INIT:e;case wL.ROAP.ROAP_STATE.ERROR:return wL.ROAP.ROAP_STATE.INIT;case wL.ROAP.ROAP_STATE.GLARE:return wL.ROAP.ROAP_STATE.WAIT_RX_ANSWER;default:return e}}(n,e,t):n}}],methods:{onAfterStep:function(e){console.log("roap:state#onAfterStep->"+e.event+" fired! State changed from '"+e.from+"' to '"+e.to+"' with transition '"+e.transition+"''.")}}}))}};t.default=i});t(NL);var DL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=NL)&&r.__esModule?r:{default:r};var i={sessions:{},getSession:function(e){return this.sessions[e]||(this.sessions[e]={}),this.sessions[e]},deleteSession:function(e){this.getSession(e)&&delete this.sessions[e]},getSessionSequence:function(e,t){var r=this.getSession(e);return r[t]||(r[t]={},r[t].state=n.default.createState()),r[t]},deleteSessionSequence:function(e,t){this.getSessionSequence(e,t)&&delete this.sessions[e][t]}};t.default=i});t(DL);var jL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=f(rT),n=f(By),i=f(Yy),o=f(nT),a=f(iT),s=f(Cf),u=f(TL),c=f(CL),l=f(DL);function f(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(){return(0,n.default)(this,t),(0,o.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,a.default)(t,e),(0,i.default)(t,[{key:"perform",value:function(e,t,r){var n=this;switch(e.state.state){case wL.ROAP.ROAP_STATE.WAIT_TX_ANSWER:c.default.shouldHandleMedia(t)&&c.default.updatePeerConnection(t,e).then(function(r){u.default.emit(wL.EVENTS.ROAP_ANSWER,{locusId:t.locusId,locusSelfId:t.locusInfo.self.id,mediaId:t.mediaId,sdps:r,seq:e.OFFER.seq,correlationId:t.correlationId,audioMuted:t.isAudioMuted(),videoMuted:t.isVideoMuted()})}).catch(function(e){n.logger.error(e)});break;case wL.ROAP.ROAP_STATE.WAIT_TX_OK:c.default.setRemoteDescription(t,e).then(function(e){u.default.emit(wL.EVENTS.ROAP_OK,e)});break;case wL.ROAP.ROAP_STATE.ERROR:this.logger.error("Call-RoapHandler#ERROR state=error",e);break;case wL.ROAP.ROAP_STATE.GLARE:e.GLARE_OFFER.tieBreaker=e.GLARE_OFFER.tieBreaker||0,e.OFFER.tieBreaker=e.OFFER.tieBreaker||0,this.logger.error("Resolve the GLARE condition"),e.GLARE_OFFER.tieBreaker<e.OFFER.tieBreaker?this.logger.error("local offer wins"):this.logger.error("remote offer wins",e),e.state.step(wL.ROAP.ROAP_SIGNAL.GLARE_RESOLVED,t,r),this.perform(e,t)}}},{key:"execute",value:function(e,t,r,n,i){t&&t.state&&(!function(e,t){var r=e.msg,n=r.seq,i=r.messageType;t.OFFER&&i===wL.OFFER?(t.GLARE_OFFER=e.msg,t.GLARE_OFFER.remote=!!e.remote,console.info("Its a GLARE condition seq:"+n+" new mercury event")):(console.info("Save OFFER/ANSWER seq:"+n+" new mercury event "+i+"local state: "+(0,s.default)(t.state.state,null,2)),t[i]=e.msg,t[i].remote=!!e.remote)}(r,t),e=wL.ROAP.ROAP_SIGNAL[""+i+r.msg.messageType],t.state.step(e,n,r),this.perform(t,n,r))}},{key:"handleAction",value:function(e,t,r,n){var i=void 0;switch(t.type){case wL.ROAP.RECEIVE_ROAP_MSG:t.remote=!0,this.execute(i,e,t,r,wL.ROAP.RX_);break;case wL.ROAP.SEND_ROAP_MSG:t.local=!0,this.execute(i,e,t,r,wL.ROAP.TX_);break;case wL.ROAP.SEND_ROAP_MSG_SUCCESS:l.default.getSessionSequence(n,t.seq).ANSWER&&(i=wL.ROAP.ROAP_SIGNAL.RX_ANSWER);break;case"RECEIVE_CALL_LEAVE":l.default.deleteSession(n),console.info("Call-this#RECEIVE_CALL_LEAVE: cleaning up the RoapHandler",n);break;case wL.ROAP.RESET_ROAP_STATE:l.default.deleteSessionSequence(n,t.msg.seq),console.info("Call-RoapHandler#RESET_ROAP_STATE: resetting the RoapHandler state",t.msg.seq);break;default:return!0}return!0}},{key:"submit",value:function(e){var t=e.correlationId,r=l.default.getSessionSequence(t,e.seq||e.msg.seq),n=this.spark.meetings.meetingCollection.get(t);return!!function(e,t,r){if(e&&e.type){if(e.msg&&e.msg.messageType&&e.msg.errorType&&c.default.findError(e.msg.messageType,e.msg.errorType,e.type))return c.default.handleError(t.mediaProperties.mediaPeerConnection).then(function(t){t&&l.default.deleteSessionSequence(r,e.msg.seq)}).catch(function(e){(void 0).logger.info("Cannot reset the peer connection",e)}),!0;if(!c.default.ensureMeeting(t,e.type))return!0}return!1}(e,n,t)||this.handleAction(r,e,n,t)}}]),t}(MP.StatelessSparkPlugin);t.default=d});t(jL);var xL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(Cf),n=l(_f),i=l(Xw),o=l(rT),a=l(By),s=l(Yy),u=l(nT),c=l(iT);function l(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){return(0,a.default)(this,t),(0,u.default)(this,(t.__proto__||(0,o.default)(t)).apply(this,arguments))}return(0,c.default)(t,e),(0,s.default)(t,[{key:"attachRechabilityData",value:function(e){var t=window.localStorage.getItem(wL.REACHABILITY.localStorage);if(t)try{var r=JSON.parse(t);r&&(0,i.default)(r).length&&(e.reachability=r)}catch(e){console.error("Exception in parsing reachability data : "+e)}return e}},{key:"joinMeetingWithRoap",value:function(e){var t=this;return this.logger.info("Call->Locus: Join locus with roap"),this.logger.info("Call-local SDP",e.roapMessage),n.default.resolve().then(function(){var n="",i={deviceUrl:t.spark.internal.device.url,usingResource:e.resourceId||null,correlationId:e.correlationId,localMedias:[{localSdp:(0,r.default)(t.attachRechabilityData({roapMessage:e.roapMessage,audioMuted:!1,videoMuted:!1}))}]};if(e.locusUrl)n=e.locusUrl+"/"+wL.PARTICIPANT;else{if(!e.sipUrl)throw new Error("Must provide a locusUrl or sipTarget");n=t.spark.internal.device.services.locusServiceUrl+"/"+wL.LOCI+"/"+wL.CALL,i.invitee={address:e.sipTarget}}return t.spark.request({method:wL.POST,uri:n,body:i}).then(function(r){var n=r.body.locus;return n.roapSeq=e.roapMessage.seq,n.id=n.url.split("/").pop(),t.logger.info("Call-Locus->App: Joined locus ["+n.id+"]["+n.fullState.lastActive+"]"),n}).catch(function(e){throw t.logger.error("MeetingAdapter#joinMeetingWithRoap failed",e),e})})}},{key:"sendRoap",value:function(e){var t=this,n=e.roapMessage,i=e.locusId,o=e.locusSelfId,a=e.mediaId,s=e.correlationId;a||this.logger.info("Race Condition /call mediaID not present");var u=wL.LOCI+"/"+i+"/"+wL.PARTICIPANT+"/"+o+"/"+wL.MEDIA,c=this.spark.internal.device.url;return this.logger.info("Call-sendRoap: "+u+" \n "+n.messageType+" \n seq:"+n.seq),this.spark.request({api:wL.API.LOCUS,resource:u,method:wL.PUT,body:{deviceUrl:c,correlationId:s,localMedias:[{localSdp:(0,r.default)(this.attachRechabilityData({roapMessage:n,audioMuted:!!e.audioMuted,videoMuted:!!e.audioVideo})),mediaId:e.mediaId}]}}).then(function(n){var i=n.body.mediaConnections&&n.body.mediaConnections.length>0&&n.body.mediaConnections[0];t.logger.info("Call-sendRoap:response:"+(0,r.default)(i,null,2)+"'\n StatusCode:'"+n.statusCode);var o=n.body.locus;return o.roapSeq=e.roapMessage.seq,o}).catch(function(i){throw t.logger.error("Call-sendRoap Error:"+(0,r.default)(i,null,2)),t.logger.error("Call-sendRoap errorBody:"+(0,r.default)(n,null,2)+" + '\\n mediaId:'"+e.mediaId),i})}}]),t}(MP.StatelessSparkPlugin);t.default=f});t(xL);var LL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=p(PR),n=p(_f),i=p(Cf),o=p(rT),a=p(By),s=p(Yy),u=p(nT),c=p(iT),l=p(TL),f=p(jL),d=p(xL);function p(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e,r){(0,a.default)(this,t);var n=(0,u.default)(this,(t.__proto__||(0,o.default)(t)).call(this,{},r));return n.roapHandler=new f.default({},r),n.roapRequest=new d.default({},r),n.lastRoapOffer={},l.default.on(wL.EVENTS.ROAP_OK,n.sendRoapOK.bind(n)),l.default.on(wL.EVENTS.ROAP_ANSWER,n.sendRoapAnswer.bind(n)),n}return(0,c.default)(t,e),(0,s.default)(t,[{key:"roapEvent",value:function(e){var t=e.message,r=e.correlationId;console.log("Call-Mercury->-App: receives Roap Message ["+(0,i.default)(t,null,2)+"]"),this.roapHandler.submit({type:wL.ROAP.RECEIVE_ROAP_MSG,msg:t,correlationId:r})}},{key:"stop",value:function(e,t){return this.roapHandler.submit({type:wL.ROAP.RECEIVE_CALL_LEAVE,seq:t,correlationId:e}),n.default.resolve()}},{key:"sendRoapOK",value:function(e){var t=this;return n.default.resolve().then(function(){var r=t.spark.meetings.meetingCollection.get(e.correlationId),n={messageType:wL.ROAP.ROAP_TYPES.OK,version:wL.ROAP.ROAP_VERSION,seq:e.seq};return console.log("ROAP:sendRoapOK ",e.seq),t.roapRequest.sendRoap({roapMessage:n,locusId:e.locusId,locusSelfId:e.locusSelfId,mediaId:e.mediaId,correlationId:e.correlationId,audioMuted:r.isAudioMuted(),videoMuted:r.isVideoMuted()}).then(function(){t.roapHandler.submit({type:wL.ROAP.SEND_ROAP_MSG,msg:n,correlationId:e.correlationId}),console.log("ROAP:sendRoapOK out",e.seq),r.setRoapSeq(e.seq)})})}},{key:"sendRoapAnswer",value:function(e){var t=this,r=this.spark.meetings.meetingCollection.get(e.correlationId),n={messageType:wL.ROAP.ROAP_TYPES.ANSWER,sdps:e.sdps,version:wL.ROAP.ROAP_VERSION,seq:e.seq};return this.roapRequest.sendRoap({roapMessage:n,locusId:e.locusId,locusSelfId:e.locusSelfId,mediaId:e.mediaId,correlationId:e.correlationId,audioMuted:e.audioMuted,videoMuted:e.videoMuted}).then(function(){r.setRoapSeq(e.seq),t.roapHandler.submit({type:wL.ROAP.SEND_ROAP_MSG,msg:n,correlationId:e.correlationId})})}},{key:"sendRoapError",value:function(e,t,r){var n={messageType:wL.ROAP.ROAP_TYPES.ERROR,version:wL.ROAP.ROAP_VERSION,errorType:r,seq:e.OFFER.seq};return this.roapRequest.sendRoap(n,t)}},{key:"sendRoapMediaRequest",value:function(e){var t=this,n=e.meeting,i={messageType:wL.ROAP.ROAP_TYPES.OFFER,sdps:e.sdps,version:wL.ROAP.ROAP_VERSION,seq:"number"!=typeof e.roapSeq&&(0,r.default)(parseFloat(e.roapSeq))?0:e.roapSeq+1,tieBreaker:4294967294};return this.roapHandler.submit({type:wL.ROAP.SEND_ROAP_MSG,msg:i,correlationId:n.correlationId}),this.roapRequest.sendRoap({roapMessage:i,correlationId:n.correlationId,locusId:n.locusId,locusSelfId:n.selfId,mediaId:n.mediaId,audioMuted:n.isAudioMuted(),videoMuted:n.isVideoMuted()}).then(function(e){return t.roapHandler.submit({type:wL.ROAP.SEND_ROAP_MSG_SUCCESS,seq:i.seq,correlationId:n.correlationId}),n.setRoapSeq(i.seq),e})}}]),t}(MP.StatelessSparkPlugin);t.default=h});t(LL);var UL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(_f),n=o(Cf),i=o(yR);function o(e){return e&&e.__esModule?e:{default:e}}var a={setLocalTracks:function(e,t,r){a.setLocalAudioTracks(e,r),a.setLocalVideoTracks(t,r)},setLocalAudioTracks:function(e,t){if(t&&t.getAudioTracks){var r=t.getAudioTracks(),n=(0,i.default)(r,1)[0];if(n)return n.enabled=!e.mute,!0}return!1},setLocalVideoTracks:function(e,t){if(t&&t.getVideoTracks){var r=t.getVideoTracks(),n=(0,i.default)(r,1)[0];if(n)return n.enabled=!e.mute,!0}return!1},generateLocalMedias:function(e,t,r){return e?[{localSdp:(0,n.default)({audioMuted:t.mute,videoMuted:r.mute}),mediaId:e}]:[]},getLocalMedia:function(e){var t=e.sendAudio,n=e.sendVideo,i=e.sendShare;return t||n?a.getMedia(t,n):i?a.getDisplayMedia({sendAudio:!1,sendShare:!0}):r.default.resolve(void 0)},attachMedia:function(e,t,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=[];return e.receiveVideo||e.receiveAudio||n?a.push(t.createOffer({receiveAudio:e.receiveAudio,receiveVideo:e.receiveVideo,streams:n,peerConnection:o.mediaPeerConnection})):a.push(void 0),(e.receiveShare||i)&&a.push(t.createOffer({receiveAudio:!1,receiveVideo:e.receiveShare,streams:i,peerConnection:o.sharePeerConnection})),r.default.all(a)},getDisplayMedia:function(e){return navigator.mediaDevices.getDisplayMedia({audio:e.sendAudio,video:e.sendScreen})},getMedia:function(e,t){var n={audio:e,video:t};return new r.default(function(e,t){navigator.mediaDevices.getUserMedia(n).then(function(t){e(t)}).catch(function(e){t(new Error({name:e.name,localMediaFailed:!0,cameraFailed:e===n.permissionDenied}))})})},getSupportedDevice:function(e){var t=e.sendAudio,n=e.sendVideo;return r.default.resolve().then(function(){return navigator.mediaDevices&&void 0!==navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then(function(e){var r={audio:e.filter(function(e){return e.kind===wL.AUDIO_INPUT}).length>0,video:e.filter(function(e){return e.kind===wL.VIDEO_INPUT}).length>0};return{sendAudio:r.audio&&t||!0,sendVideo:r.video&&n||!0}}):{sendAudio:!0,sendVideo:!0}})},toggleStream:function(){},stopStream:function(e){return e?r.default.resolve().then(function(){e.getTracks?e.getTracks().forEach(function(e){e.stop()}):e.stop&&e.stop()}):r.default.resolve()},getUserMedia:function(e){return a.getLocalMedia({sendAudio:e.sendAudio,sendVideo:e.sendVideo}).then(function(t){return a.getLocalMedia({sendShare:e.sendShare}).then(function(e){return[t,e]})})}};t.default=a});t(UL);var FL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(By),n=i(Yy);function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,r.default)(this,e),this.namespace=wL.MEETINGS,this.mediaDirection=t.mediaDirection,this.mediaPeerConnection=t.mediaPeerConnection,this.sharePeerConnection=t.sharePeerConnection,this.localStream=t.localStream,this.localShare=t.localShare,this.remoteStream=t.remoteStream,this.remoteShare=t.remoteShare}return(0,n.default)(e,[{key:"setAll",value:function(e,t,r,n,i,o,a){this.setMediaDirection(e),this.setMediaPeerConnection(t),this.setSharePeerConnection(r),this.setLocalStream(n),this.setLocalShare(i),this.setRemoteStream(o),this.setRemoteShare(a)}},{key:"setMediaDirection",value:function(e){this.mediaDirection=e}},{key:"setMediaPeerConnection",value:function(e){this.mediaPeerConnection=e}},{key:"setSharePeerConnection",value:function(e){this.sharePeerConnection=e}},{key:"setPeerConnections",value:function(e,t){this.setMediaPeerConnection(e),this.setSharePeerConnection(t)}},{key:"setLocalStream",value:function(e){this.localStream=e}},{key:"setLocalShare",value:function(e){this.localShare=e}},{key:"setRemoteStream",value:function(e){this.remoteStream=e}},{key:"setRemoteShare",value:function(e){this.remoteShare=e}},{key:"unsetMediaPeerConnection",value:function(){this.mediaPeerConnection=null}},{key:"unsetSharePeerConnection",value:function(){this.sharePeerConnection=null}},{key:"unsetLocalStream",value:function(){this.localStream=null}},{key:"unsetLocalShare",value:function(){this.localShare=null}},{key:"unsetRemoteStream",value:function(){this.remoteStream=null}},{key:"unsetRemoteShare",value:function(){this.remoteShare=null}},{key:"unsetPeerConnections",value:function(){this.unsetMediaPeerConnection(),this.unsetSharePeerConnection()}},{key:"unsetLocalStreams",value:function(){this.unsetLocalStream(),this.unsetLocalShare()}},{key:"unsetRemoteStreams",value:function(){this.unsetRemoteStream(),this.unsetRemoteShare()}},{key:"unsetShareStreams",value:function(){this.unsetLocalShare(),this.unsetRemoteShare()}},{key:"unsetMediaStreams",value:function(){this.unsetLocalStream(),this.unsetRemoteStream()}}]),e}();t.default=o});t(FL);var GL=r(function(e,t){var r;r=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.i=function(e){return e},r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){function n(e){if(0===e.length)return e;var t,r,n=e.split(/[_-]/);if(1===n.length&&n[0][0].toLowerCase()===n[0][0])return e;for(r=n[0].toLowerCase(),t=1;t<n.length;t++)r=r+n[t].charAt(0).toUpperCase()+n[t].substring(1).toLowerCase();return r}n.prepended=function(e,t){return e+(t=n(t))[0].toUpperCase()+t.substring(1)},e.exports=n},function(e,t,r){var n=r(0);e.exports=function(e){var t=n((e=e||{}).name||e.past||"history"),r=n(e.future||"future"),i=n.prepended("clear",t),o=n.prepended(t,"back"),a=n.prepended(t,"forward"),s=n.prepended("can",o),u=n.prepended("can",a),c=e.max,l={configure:function(e){e.addTransitionLifecycleNames(o),e.addTransitionLifecycleNames(a)},init:function(e){e[t]=[],e[r]=[]},lifecycle:function(e,n){"onEnterState"===n.event&&(e[t].push(n.to),c&&e[t].length>c&&e[t].shift(),n.transition!==o&&n.transition!==a&&(e[r].length=0))},methods:{},properties:{}};return l.methods[i]=function(){this[t].length=0,this[r].length=0},l.properties[s]={get:function(){return this[t].length>1}},l.properties[u]={get:function(){return this[r].length>0}},l.methods[o]=function(){if(!this[s])throw Error("no history");var e=this[t].pop(),n=this[t].pop();this[r].push(e),this._fsm.transit(o,e,n,[])},l.methods[a]=function(){if(!this[u])throw Error("no history");var e=this.state,t=this[r].pop();this._fsm.transit(a,e,t,[])},l}}])},e.exports=r()});t(GL);var qL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(ML),n=i(GL);function i(e){return e&&e.__esModule?e:{default:e}}var o={create:function(e){var t=this;return new r.default({init:wL.MEETING_STATE.STATES.IDLE,transitions:[{name:wL.MEETING_STATE.TRANSITIONS.START,from:wL.MEETING_STATE.STATES.IDLE,to:wL.MEETING_STATE.STATES.ON_GOING},{name:wL.MEETING_STATE.TRANSITIONS.START,from:wL.MEETING_STATE.STATES.IDLE,to:wL.MEETING_STATE.STATES.INCOMING},{name:wL.MEETING_STATE.TRANSITIONS.JOIN,from:wL.MEETING_STATE.STATES.IDLE,to:wL.MEETING_STATE.STATES.DIALING},{name:wL.MEETING_STATE.TRANSITIONS.JOIN,from:wL.MEETING_STATE.STATES.ON_GOING,to:wL.MEETING_STATE.STATES.DIALING},{name:wL.MEETING_STATE.TRANSITIONS.JOIN,from:wL.MEETING_STATE.STATES.INCOMING,to:wL.MEETING_STATE.STATES.DIALING},{name:wL.MEETING_STATE.TRANSITIONS.LOCAL,from:wL.MEETING_STATE.STATES.DIALING,to:wL.MEETING_STATE.STATES.CONNECTING_MEDIA_LOCAL},{name:wL.MEETING_STATE.TRANSITIONS.CONNECT,from:wL.MEETING_STATE.STATES.CONNECTING_MEDIA_LOCAL,to:wL.MEETING_STATE.STATES.CONNECTING_MEDIA_REMOTE},{name:wL.MEETING_STATE.TRANSITIONS.ESTABLISH,from:wL.MEETING_STATE.STATES.CONNECTING_MEDIA_REMOTE,to:wL.MEETING_STATE.STATES.ESTABLISHED_MEDIA},{name:wL.MEETING_STATE.TRANSITIONS.LEAVE,from:wL.MEETING_STATE.STATES.ESTABLISHED_MEDIA,to:wL.MEETING_STATE.STATES.TERMINATING},{name:wL.MEETING_STATE.TRANSITIONS.END,from:wL.MEETING_STATE.STATES.TERMINATING,to:wL.MEETING_STATE.STATES.ENDED},{name:wL.MEETING_STATE.TRANSITIONS.CLEAN,from:wL.MEETING_STATE.STATES.ENDED,to:wL.MEETING_STATE.STATES.IDLE},{name:wL.MEETING_STATE.TRANSITIONS.CLEAN,from:wL.MEETING_STATE.STATES.ERROR,to:wL.MEETING_STATE.STATES.IDLE},{name:wL.MEETING_STATE.TRANSITIONS.ERROR,from:"*",to:wL.MEETING_STATE.STATES.ERROR}],methods:{onInit:function(r){e.logger.log("Meeting:index#onInit->"+r.event+" fired! State changed from '"+r.from+"' to '"+r.to+"' with transition '"+r.transition+"' on Meeting Object: '"+t.id+"'.")},onError:function(r){e.logger.log("Meeting:index#onError->"+r.event+" fired! State changed from '"+r.from+"' to '"+r.to+"' with transition '"+r.transition+"' on Meeting Object: '"+t.id+"'.")},onClean:function(r){e.logger.log("Meeting:index#onClean->"+r.event+" fired! State changed from '"+r.from+"' to '"+r.to+"' with transition '"+r.transition+"' on Meeting Object: '"+t.id+"'.")},onJoin:function(r){e.logger.log("Meeting:index#onJoin->"+r.event+" fired! State changed from '"+r.from+"' to '"+r.to+"' with transition '"+r.transition+"' on Meeting Object: '"+t.id+"'.")},onLocal:function(r){e.logger.log("Meeting:index#onLocal->"+r.event+" fired! State changed from '"+r.from+"' to '"+r.to+"' with transition '"+r.transition+"' on Meeting Object: '"+t.id+"'.")},onConnect:function(r){e.logger.log("Meeting:index#onConnect->"+r.event+" fired! State changed from '"+r.from+"' to '"+r.to+"' with transition '"+r.transition+"' on Meeting Object: '"+t.id+"'.")},onEstablish:function(r){e.logger.log("Meeting:index#onEstablish->"+r.event+" fired! State changed from '"+r.from+"' to '"+r.to+"' with transition '"+r.transition+"' on Meeting Object: '"+t.id+"'.")}},plugins:[new n.default({max:25})]})}};t.default=o});t(qL);var VL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(_f),n=o(pg),i=o(UL);function o(e){return e&&e.__esModule?e:{default:e}}var a={parseLocusJoin:function(e){var t={};return t.locus=e.body.locus,t.mediaConnections=e.body.mediaConnections,t.locusUrl=t.locus.url,t.locusId=t.locus.url.split("/").pop(),t.selfId=t.locus.self.id,t.mediaConnections.forEach(function(e){e.mediaId&&(t.mediaId=e.mediaId)}),t},remoteUpdateAudioVideo:function(e,t,o){if(!o)return r.default.reject(new Error("You need a meeting object."));var a=i.default.generateLocalMedias(o.mediaId,e,t);return(0,n.default)(a)?r.default.reject(new Error("You need a media id on the meeting to change remote audio.")):o.meetingRequest.remoteAudioVideoToggle({locusUrl:o.locusUrl,selfId:o.selfId,localMedias:a,deviceUrl:o.deviceUrl,correlationId:o.correlationId})},leaveMeeting:function(e){return e?e.meetingRequest.leaveMeeting({locusUrl:e.locusUrl,selfId:e.selfId,correlationId:e.correlationId,resourceId:null,deviceUrl:e.deviceUrl}):r.default.reject(new Error("You need a meeting object."))},cleanOptions:function(e,t,r,n){return a.hasOwner(t)&&(a.isOwnerSelf(r,n)?(e.hostPin&&delete e.hostPin,e.moderator=wL.MODERATOR_TRUE):e.moderator=wL.MODERATOR_FALSE),e},hasOwner:function(e){return e&&e.owner},isOwnerSelf:function(e,t){return e===t},isPinOrGuest:function(e){return!(!e||!e.body||e.body.errorCode!==wL.INTENT_TO_JOIN)},joinMeeting:function(e,t){return e?e.meetingRequest.joinMeeting({sipUri:e.sipUri,deviceUrl:e.deviceUrl,locusUrl:e.locusUrl,correlationId:e.id,resourceId:e.resourceId,moderator:t.moderator,hostPin:t.hostPin}).then(function(e){return a.parseLocusJoin(e)}):r.default.reject(new Error("You need a meeting object."))},getSdps:function(e){var t=[];return e.mediaProperties.mediaPeerConnection&&t.push(e.mediaProperties.mediaPeerConnection.sdp),e.mediaProperties.sharePeerConnection&&t.push(e.mediaProperties.sharePeerConnection.sdp),t}};t.default=a});t(VL);var BL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=s(_f),n=s(ML),i=s(GL),o=s(UL),a=s(VL);function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e,t,r,n,i){e.trigger(n,{type:i,status:t.state,muted:t.muted,result:r})},c={create:function(e,t){return e.sendAudio?new n.default({transitions:[{name:wL.MEETING_AUDIO_STATE_MACHINE.TRANSITIONS.TOGGLE,from:"*",to:function(e){return function(e){return e.mute&&e.self?wL.MEETING_AUDIO_STATE_MACHINE.STATES.MUTE_SELF:!e.mute&&e.self?wL.MEETING_AUDIO_STATE_MACHINE.STATES.UNMUTE_SELF:null}(e)||this.state}}],data:{muted:!1,self:!0},methods:{isMuted:function(){return this.muted},isSelf:function(){return this.self},setData:function(e){this.muted=e.mute,this.self=e.self},onBeforeToggle:function(e,n){return e.from!==e.to&&function(e,t,n,i){a.default.remoteUpdateAudioVideo(n,{mute:i.video.muted},i).then(function(s){try{o.default.setLocalTracks(n,{mute:i.video.muted},i.mediaProperties.localStream)}catch(n){return a.default.remoteUpdateAudioVideo({mute:e.muted},{mute:i.video.muted},i).catch(function(e){console.log("audio:state#onBeforeToggle->"+t.event+" fired! State failed to change with transition '"+t.transition+"''. After local audio toggle failed, resetting remote also failed, meeting audio in bad state with error: "+e+".")}),u(i,e,n,wL.EVENT_TRIGGERS.MEDIA_AUDIO_CHANGED,wL.EVENT_TYPES.ERROR),console.log("audio:state#onBeforeToggle->"+t.event+" fired! State failed to change with transition '"+t.transition+"''. State has been reset and toggling has been reversed."),r.default.reject(n)}return u(i,e,s,wL.EVENT_TRIGGERS.MEDIA_AUDIO_CHANGED,wL.EVENT_TYPES.LOCAL),console.log("audio:state#onAfterToggle->"+t.event+" fired! State changed from '"+t.from+"' to '"+t.to+"' with transition '"+t.transition+"''."),r.default.resolve(s)}).catch(function(n){return u(i,e,n,wL.EVENT_TRIGGERS.MEDIA_AUDIO_CHANGED,wL.EVENT_TYPES.ERROR),console.log("audio:state#onAfterHistoryBack->"+t.event+" fired! State failed to change with transition '"+t.transition+"''. State has been reset and toggling has been reversed."),r.default.reject(n)})}(this,e,n,t),r.default.resolve(this.data)},onAfterToggle:function(e,t){return this.setData(t),r.default.resolve(this.data)},plugins:[new i.default({max:5})]}}):null}};t.default=c});t(BL);var zL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=s(_f),n=s(ML),i=s(GL),o=s(UL),a=s(VL);function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e,t,r,n,i){e.trigger(n,{type:i,status:t.state,muted:t.muted,result:r})},c={create:function(e,t){if(e.sendVideo)return new n.default({transitions:[{name:wL.MEETING_VIDEO_STATE_MACHINE.TRANSITIONS.TOGGLE,from:"*",to:function(e){return function(e){return e.mute&&e.self?wL.MEETING_VIDEO_STATE_MACHINE.STATES.MUTE_SELF:!e.mute&&e.self?wL.MEETING_VIDEO_STATE_MACHINE.STATES.UNMUTE_SELF:null}(e)||this.state}}],data:{muted:!1,self:!0},methods:{isMuted:function(){return this.muted},isSelf:function(){return this.self},setData:function(e){this.muted=e.mute,this.self=e.self},onBeforeToggle:function(e,n){return e.from!==e.to&&function(e,t,n,i){a.default.remoteUpdateAudioVideo({mute:i.audio.muted},n,i).then(function(s){try{o.default.setLocalTracks({mute:i.audio.muted},n,i.mediaProperties.localStream)}catch(n){return a.default.remoteUpdateAudioVideo({mute:i.audio.muted},{mute:e.muted},i).catch(function(e){console.log("video:state#onBeforeTogglek->"+t.event+" fired! State failed to change with transition "+t.transition+". After local video toggle failed, resetting remote also failed, meeting video in bad state with error: "+e+".")}),u(i,e,n,wL.EVENT_TRIGGERS.MEDIA_VIDEO_CHANGED,wL.EVENT_TYPES.ERROR),console.log("video:state#onBeforeTogglek->"+t.event+" fired! State failed to change with transition '"+t.transition+"''. State has been reset and toggling has been reversed."),r.default.reject(n)}return u(i,e,s,wL.EVENT_TRIGGERS.MEDIA_VIDEO_CHANGED,wL.EVENT_TYPES.LOCAL),console.log("video:state#onAfterToggle->"+t.event+" fired! State changed from '"+t.from+"' to '"+t.to+"' with transition '"+t.transition+"''."),r.default.resolve(s)}).catch(function(n){return u(i,e,n,wL.EVENT_TRIGGERS.MEDIA_VIDEO_CHANGED,wL.EVENT_TYPES.ERROR),console.log("video:state#onAfterHistoryBack->"+t.event+" fired! State failed to change with transition '"+t.transition+"''. State has been reset and toggling has been reversed."),r.default.reject(n)})}(this,e,n,t),r.default.resolve(this.data)},onAfterToggle:function(e,t){return this.setData(t),r.default.resolve(this.data)},plugins:[new i.default({max:5})]}})}};t.default=c});t(zL);var WL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={parse:function(e){return{policy:r.parsePolicy(e),type:r.parseMeetingType(e),sipUri:e.sipUri}},parsePolicy:function(e){var t={};return e.displayHints&&e.displayHints.joined&&e.displayHints.joined.length>0&&e.displayHints.joined.forEach(function(e){t[e]=!0}),t},parseMeetingType:function(e){var t=wL.UNKNOWN;return e.locusTags&&e.locusTags.indexOf(wL.ONE_ON_ONE)>=0||3===e.maxParticipants?wL.ONE_ON_ONE:(e.locusTags&&e.locusTags.indexOf(wL.MEETING)>=0&&(t=wL.MEETING),e.webexServiceType===wL.MEETING_CENTER||e.isPmr?wL.WEBEX_MEETING:t)}};t.default=r});t(WL);var HL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={parse:function(e,t){return e?{muted:r.getMuted(e),guest:e.guest,moderator:e.moderator,mediaStatus:r.getStatus(e.status),state:e.state,joinedWith:e.devices.some(function(e){return t===e.Url})?wL.SELF:wL.OTHER,creator:e.isCreator,selfId:e.id,selfIdentity:r.getSelfIdentity(e)}:null},getSelves:function(e,t,n){var i=e&&r.parse(e,n),o=t&&r.parse(t,n);return{previous:i,current:o,updates:{isUnadmittedGuest:r.isUnadmittedGuest(o),isAdmittedGuest:r.isAdmittedGuest(i,o)}}},getSelfIdentity:function(e){return e||e.person?e.person.id:null},getMuted:function(e){return e&&e.controls&&e.controls.audio?e.controls.audio.muted:null},getStatus:function(e){return{audio:e.audioStatus,video:e.videoStatus,slides:e.videoSlidesStatus}},isLocusGuestUnadmitted:function(e){return e&&e.guest&&e.state===wL.IDLE},isLocusGuestAdmitted:function(e){return e&&e.guest&&e.state===wL.JOINED},isUnadmittedGuest:function(e){if(!e)throw new TypeError("self must be defined to determine if self is unadmitted as guest.");return r.isLocusGuestUnadmitted(e)},isAdmittedGuest:function(e,t){if(!e)return!1;if(!t)throw new TypeError("New self must be defined to determine if self transitioned to admitted as guest.");return r.isLocusGuestUnadmitted(e)&&r.isLocusGuestAdmitted(t)},getSipUrl:function(e,t){return e&&t.type===wL.ONE_ON_ONE?{sipUri:e.person.sipUrl||e.person.emailAddress||e.person.email}:{sipUri:t.sipUri}}};t.default=r});t(HL);var YL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={parse:function(e){return e?{hostId:r.getId(e)}:null},getHosts:function(e,t){var n=e&&r.parse(e),i=t&&r.parse(t);return{previous:n,current:i,updates:{isNewHost:!n||!i||r.isDifferentHosts(n.hostId,i.hostId)}}},isDifferentHosts:function(e,t){return e!==t},getId:function(e){return e?e.id:null}};t.default=r});t(YL);var $L=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={parse:function(e){return e?{contentId:r.getContentId(e),disposition:r.getDisposition(e)}:null},getMediaShares:function(e,t){return{previous:e&&r.parse(e),current:t&&r.parse(t)}},getDisposition:function(e){var t=r.extractContentFloor(e);return t?t.disposition:null},extractContent:function(e){if(!e||!e.length)return null;var t=e[0];return t&&t.name===wL.CONTENT?t:null},extractFloor:function(e){return e?e.floor:null},extractContentFloor:function(e){var t=r.extractContent(e);return r.extractFloor(t)},getContentId:function(e){var t=r.extractContentFloor(e);return t&&t.beneficiary?t.beneficiary.id:null}};t.default=r});t($L);var XL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(Wj),n=i(Yj);function i(e){return e&&e.__esModule?e:{default:e}}var o={compareLocus:function(e,t){var i=Math.min(e.rangeStart,(0,n.default)(e.entries)),a=Math.max(e.rangeEnd,(0,r.default)(e.entries)),s=Math.min(t.rangeStart,(0,n.default)(t.entries)),u=Math.max(t.rangeEnd,(0,r.default)(t.entries)),c=o.calculateUnique(e,t),l=o.calculateUnique(t,e),f=!(0===e.rangeStart&&0===e.rangeEnd),d=!(0===t.rangeStart&&0===t.rangeEnd);return i>u?wL.DELTAEVENT.GT:a<s?wL.DELTAEVENT.LT:c.length||l.length?c.length&&!l.length?wL.DELTAEVENT.GT:l.length&&!c.length?wL.DELTAEVENT.LT:!f&&!d||o.hasUniqueButInRange(c,s,u)||o.hasUniqueButInRange(l,i,a)?wL.DELTAEVENT.CF:(0,n.default)(c)>(0,n.default)(l)?wL.DELTAEVENT.GT:wL.DELTAEVENT.LT:e.rangeEnd-i>t.rangeEnd-s?wL.DELTAEVENT.GT:e.rangeEnd-i<t.rangeEnd-s?wL.DELTAEVENT.LT:wL.DELTAEVENT.EQ},generateSyncDebugFlag:function(e,t){var r=t.baseSequence,n=e.locusInfo.sequence,i=t.sequence,a=["","","","","",""],s=function(e){return e?o.isEmptySequence(e)?wL.LOCUS.SEQUENCE.EMPTY:wL.LOCUS.SEQUENCE.DEF:wL.LOCUS.SEQUENCE.UN_DEF};a[0]=s(r),a[1]=s(n),a[2]=s(i),a[3]=r&&n?o.compareLocus(r,n).toLowerCase():wL.LOCUS.SEQUENCE.NA,a[4]=n&&i?o.compareLocus(n,i).toLowerCase():wL.LOCUS.SEQUENCE.NA,a[5]=r&&i?o.compareLocus(r,i).toLowerCase():wL.LOCUS.SEQUENCE.NA,e.desync=a.toString()},calculateUnique:function(e,t){var r=[];return e.entries.forEach(function(e){(e<t.rangeStart||e>t.rangeEnd)&&-1===t.entries.indexOf(e)&&r.push(e)}),r},isEmptySequence:function(e){return!!(Object.prototype.hasOwnProperty.call(e,wL.LOCUS.SEQUENCE.RANGE_START)&&0===e.rangeStart&&Object.prototype.hasOwnProperty.call(e,wL.LOCUS.SEQUENCE.RANGE_END)&&0===e.rangeEnd&&e.entries&&0===e.entries.length)},hasUniqueButInRange:function(e,t,r){return e.some(function(e){return e>t&&e<r})}};t.default=o});t(XL);var JL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(Yj),n=i(XL);function i(e){return e&&e.__esModule?e:{default:e}}var o={updateWithDeltaLocus:function(e,t){if(!(e.sequence&&e.sequence.rangeStart<=e.sequence.rangeEnd&&e.sequence.rangeEnd<=(0,r.default)(e.sequence.entries)))return null;if(!t.locusInfo.baseSequence)return t.meetingRequest.getFullLocus({desync:!0,locusUrl:t.locusUrl}).then(function(r){return r.body.baseSequence=e.baseSequence,t.locusInfo.onFullLocus(r.body),wL.DELTAEVENT.EQ});e.sequence;var i=void 0,a=void 0;switch((i=n.default.compareLocus(e.sequence,t.locusInfo.sequence))===wL.DELTAEVENT.GT&&e.baseSequence&&t.locusInfo.syncUrl&&((a=n.default.compareLocus(e.baseSequence,t.locusInfo.sequence))!==wL.DELTAEVENT.LT&&a!==wL.DELTAEVENT.CF||(i=wL.DELTAEVENT.CF)),e.baseSequence||i!==wL.DELTAEVENT.EQ||"INITIALIZING"!==e.fullState.state||0!==e.sequence.rangeStart||0!==e.sequence.rangeEnd||0!==e.sequence.entries.length||(i=wL.DELTAEVENT.GT,console.log("Special case for OBTP")),console.log("RESULT :",i),i){case wL.DELTAEVENT.LT:case wL.DELTAEVENT.EQ:t.locusDesync=!1,t.needToGetFullLocus=!1;break;case wL.DELTAEVENT.CF:n.default.generateSyncDebugFlag(t,e),t.locusDesync?t.meetingRequest.getFullLocus({desync:!0,locusUrl:t.locusUrl}).then(function(e){t.locusInfo.onFullLocus(e.body)}):(t.locusDesync=!0,o.syncMeeting(t,e));break;case wL.DELTAEVENT.GT:console.info("MeetingAmpstate#updateWithDeltaLocus: MeetingConstants.deltaLocusResult.GT"),t.locusInfo.onDeltaLocus(e),t.locusDesync=!1,t.needToGetFullLocus=!1}return i},syncMeeting:function(e,t){e&&e.locusInfo&&e.locusInfo.syncUrl&&e.locusInfo.fullState&&e.locusInfo.fullState.state!==wL.LOCUS.STATE.INACTIVE?e.meetingRequest.syncMeeting({syncUrl:t.syncUrl,desync:e.desync}).then(function(t){e.locusInfo.onDeltaLocus(t.body),console.log("meeting-adapter#syncMeeting: performing sync for uri: "+e.locusInfo.syncUrl+" and state: "+e.locusInfo.fullState.state)}).catch(function(e){console.error("Error syncing the locus",e)}):e&&e.locusInfo&&e.locusInfo.syncUrl&&e.locusInfo.fullState&&console.error("meeting-adapter#syncMeeting: skip sync for url: "+e.locusInfo.syncUrl+" and state: "+e.locusInfo.fullState.state)}};t.default=o});t(JL);var KL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=v(rT),n=v(By),i=v(Yy),o=v(nT),a=v(iT),s=v(sk),u=v(fS),c=v(TL),l=v(WL),f=v(HL),d=v(YL),p=v($L),h=v(JL);function v(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments[2];(0,n.default)(this,t);var s=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return s.updateMeeting=e,s.controls=i.controls||null,s.conversationUrl=i.conversationUrl||null,s.created=i.created||null,s.fullState=i.fullState||null,s.mediaShares=i.mediaShares||null,s.participantsUrl=i.participantsUrl||null,s.replaces=i.replaces||null,s.url=i.url||null,s.aclUrl=i.aclUrl||null,s.baseSequence=i.baseSequence||null,s.sequence=i.sequence||null,s.membership=i.membership||null,s.identities=i.identities||null,s.participants=i.participants||null,s.emitChange=!1,s.parsedLocus={states:[]},s.spark=a,s.updateMeetingInfo(i.info),s.updateSelf(i.self,i.participants),s.updateHostInfo(i.host),s}return(0,a.default)(t,e),(0,i.default)(t,[{key:"initialSetup",value:function(e,t){t?h.default.updateWithDeltaLocus(e,t):this.onFullLocus(e),this.emitChange=!0}},{key:"parse",value:function(e,t){var r=t.eventType;switch(r){case wL.LOCUSEVENT.PARTICIPANT_JOIN:case wL.LOCUSEVENT.PARTICIPANT_LEFT:case wL.LOCUSEVENT.CONTROLS_UPDATED:case wL.LOCUSEVENT.PARTICIPANT_AUDIO_MUTED:case wL.LOCUSEVENT.PARTICIPANT_AUDIO_UNMUTED:case wL.LOCUSEVENT.PARTICIPANT_VIDEO_MUTED:case wL.LOCUSEVENT.PARTICIPANT_VIDEO_UNMUTED:case wL.LOCUSEVENT.SELF_CHANGED:case wL.LOCUSEVENT.PARTICIPANT_UPDATED:case wL.LOCUSEVENT.PARTICIPANT_CONTROLS_UPDATED:case wL.LOCUSEVENT.PARTICIPANT_ROLES_UPDATED:case wL.LOCUSEVENT.PARTICIPANT_DECLINED:case wL.LOCUSEVENT.FLOOR_GRANTED:case wL.LOCUSEVENT.FLOOR_RELEASED:this.onFullLocus(t.locus,r);break;case wL.LOCUSEVENT.DIFFERENCE:h.default.updateWithDeltaLocus(t.locus,e);break;default:h.default.updateWithDeltaLocus(t.locus,e)}}},{key:"emitChanges",value:function(e,t){c.default.emit(e,t)}},{key:"onFullLocus",value:function(e,t){console.log("EVENTS",t),this.participants=e.participants,this.updateLocusInfo(e),this.updateParticipants(e.participants),this.isMeetingActive()}},{key:"onDeltaLocus",value:function(e){this.updateLocusInfo(e),this.updateParticipants(e.participants,!0)}},{key:"updateLocusInfo",value:function(e){this.updateControls(e.controls),this.updateConversationUrl(e.conversationUrl),this.updateCreated(e.created),this.updateFullState(e.state),this.updateHostInfo(e.host),this.updateMeetingInfo(e.info),this.updateMediaShares(e.mediaShares),this.updateParticipantsUrl(e.participantsUrl),this.updateReplace(e.replace),this.updateSelf(e.self,e.participants),this.updateLocusUrl(e.url),this.updateAclUrl(e.aclUrl),this.updateBasequence(e.baseSequence),this.updateSequence(e.sequence),this.updateMemberShip(e.membership),this.updateIdentifiers(e.identities)}},{key:"getLocusPartner",value:function(e,t){return e&&0!==e.length?e.find(function(r){return t&&r.identity!==t.identity&&(e.length<=2||r.type===wL.USER&&!r.removed)})||this.partner:(console.log("NO participants found ",e),null)}},{key:"isMeetingActive",value:function(){if(this.parsedLocus.info.type===wL.ONE_ON_ONE){var e=this.getLocusPartner(this.participants,this.self);this.updateMeeting({partner:e}),console.log("ISMEETINGACTIVE",e),(e.state!==wL.MEETING_STATE.STATES.LEFT||!this.parsedLocus.self||this.parsedLocus.self.state!==wL.MEETING_STATE.STATES.DECLINED&&this.parsedLocus.self.state!==wL.MEETING_STATE.STATES.NOTIFIED)&&(!this.parsedLocus.self||this.parsedLocus.self.state!==wL.MEETING_STATE.STATES.LEFT||e.state!==wL.MEETING_STATE.STATES.LEFT&&e.state!==wL.MEETING_STATE.STATES.DECLINED&&e.state!==wL.MEETING_STATE.STATES.NOTIFIED&&e.state!==wL.MEETING_STATE.STATES.IDLE)||(console.log("END the ONE ON ONE Call"),this.emit(wL.EVENTS.DESTROY_MEETING))}}},{key:"updateParticipants",value:function(e,t){t?console.log("Delta participants came through"):console.log("Full locus participants came through"),this.emitChanges(wL.EVENTS.LOCUS_INFO_UPDATE_PARTICIPANTS,{participants:e,selfIdentity:this.parsedLocus.self.selfIdentity,selfId:this.parsedLocus.self.selfId,hostId:this.parsedLocus.host.hostId})}},{key:"updateControls",value:function(e){e&&!(0,s.default)(this.controls,e)&&(this.controls=e,console.info("LocusInfo:controls got updated"))}},{key:"updateConversationUrl",value:function(e){e&&!(0,s.default)(this.conversationUrl,e)&&(this.conversationUrl=e,this.emitChanges(wL.EVENTS.CONVERSATION_URL_UPDATE,e),console.info("LocusInfo:conversationUrl got updated"))}},{key:"updateCreated",value:function(e){e&&!(0,s.default)(this.created,e)&&(this.created=e,console.info("LocusInfo:created got updated"))}},{key:"updateFullState",value:function(e){e&&!(0,s.default)(this.fullState,e)&&(this.fullState=e,console.info("LocusInfo:fullState got updated"))}},{key:"updateHostInfo",value:function(e){if(e&&!(0,s.default)(this.host,e)){var t=d.default.getHosts(this.host,e);this.updateMeeting(t.current),this.parsedLocus.host=t.current,t.updates.isNewHost&&this.emitChanges(wL.EVENTS.LOCUS_INFO_UPDATE_HOST,{newHost:t.current,oldHost:t.previous}),this.host=e,console.info("LocusInfo:host got updated")}}},{key:"updateMeetingInfo",value:function(e){if(e&&!(0,s.default)(this.info,e)){this.info=e;var t=l.default.parse(e);this.parsedLocus.info=t,this.updateMeeting(t),console.info("LocusInfo:info got updated",e),this.emitChanges("infoUpdated")}}},{key:"updateMediaShares",value:function(e){if(e&&!(0,s.default)(this.mediaShares,e)){var t=p.default.getMediaShares(this.mediaShares,e);this.updateMeeting(t.current),this.emitChanges(wL.EVENTS.LOCUS_INFO_UPDATE_MEDIA_SHARES,{current:t.current,previous:t.previous}),this.parsedLocus.mediaShares=t.current,this.mediaShares=e,console.info("LocusInfo:mediaShares got updated")}}},{key:"updateParticipantsUrl",value:function(e){e&&!(0,s.default)(this.participantsUrl,e)&&(this.participantsUrl=e,console.info("LocusInfo:participantsUrl got updated"))}},{key:"updateReplace",value:function(e){e&&!(0,s.default)(this.replace,e)&&(this.replace=e,console.info("LocusInfo:replace got updated"))}},{key:"updateSelf",value:function(e,t){if(e&&!(0,s.default)(this.self,e)){var r=f.default.getSelves(this.self,e,this.spark);this.updateMeeting(r.current),this.parsedLocus.self=r.current,this.parsedLocus.states[this.parsedLocus.states.length-1]!==r.current.state&&this.parsedLocus.states.push(r.current.state),this.updateMeeting(f.default.getSipUrl(this.getLocusPartner(t,e),this.parsedLocus.info)),r.updates.isUnadmittedGuest&&this.emit(wL.EVENTS.SELF_UNADMITTED_GUEST,e),r.updates.isAdmittedGuest&&this.emit(wL.EVENTS.SELF_ADMITTED_GUEST,e),this.emitChanges(wL.EVENTS.LOCUS_INFO_UPDATE_SELF,{oldSelf:r.previous,newSelf:r.current}),this.parsedLocus.self=r.current,this.self=e,console.info("LocusInfo:self got updated",e)}}},{key:"updateLocusUrl",value:function(e){e&&this.url!==e&&(this.url=e,this.emitChanges(wL.EVENTS.LOCUS_INFO_UPDATE_URL,e),console.info("LocusInfo:url got updated"))}},{key:"updateAclUrl",value:function(e){e&&!(0,s.default)(this.aclUrl,e)&&(this.aclUrl=e,console.info("LocusInfo:aclUrl got updated"))}},{key:"updateBasequence",value:function(e){e&&!(0,s.default)(this.baseSequence,e)&&(this.baseSequence=e,console.info("LocusInfo:baseSequence got updated"))}},{key:"updateSequence",value:function(e){e&&!(0,s.default)(this.sequence,e)&&(this.sequence=e,console.info("LocusInfo:sequence got updated"))}},{key:"updateMemberShip",value:function(e){e&&!(0,s.default)(this.membership,e)&&(this.membership=e,console.info("LocusInfo:membership got updated"))}},{key:"updateIdentifiers",value:function(e){e&&!(0,s.default)(this.identities,e)&&(this.identities=e,console.info("LocusInfo:identities got updated"))}}]),t}(u.default);t.default=g});t(KL);var QL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(FS),n=l(BS),i=l(HS),o=l(eT),a=l(rT),s=l(By),u=l(nT),c=l(iT);function l(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:wL.ERROR_DICTIONARY.RECONNECTION.MESSAGE;(0,s.default)(this,t);var n=(0,u.default)(this,(t.__proto__||(0,a.default)(t)).call(this,r));return n.name=wL.ERROR_DICTIONARY.RECONNECTION.NAME,n.sdkMessage=wL.ERROR_DICTIONARY.RECONNECTION.MESSAGE,n.error=e,n.code=wL.ERROR_DICTIONARY.RECONNECTION.CODE,n}return(0,c.default)(t,e),t}(function(e){function t(){var t=(0,o.default)(e,(0,i.default)(arguments));return(0,n.default)(t,(0,a.default)(this)),t}return t.prototype=(0,r.default)(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n.default?(0,n.default)(t,e):t.__proto__=e,t}(Error));t.default=f});t(QL);var ZL=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(_f),n=s(By),i=s(Yy),o=s(QL),a=s(PL);function s(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){(0,n.default)(this,e),this.status=wL.RECONNECTION.STATE.DEFAULT_STATUS,this.tryCount=wL.RECONNECTION.STATE.DEFAULT_TRY_COUNT,this.configure(t)}return(0,i.default)(e,[{key:"configure",value:function(e){this.backOff=e.config.reconnection.retry.backOff.start}},{key:"reset",value:function(){this.status=wL.RECONNECTION.STATE.DEFAULT_STATUS,this.tryCount=wL.RECONNECTION.STATE.DEFAULT_TRY_COUNT}},{key:"validate",value:function(e){return e.config.reconnection.enabled?e.locusInfo&&e.locusInfo.fullState&&e.locusInfo.fullState.state===wL.ACTIVE&&e.locusInfo.fullState.active?e.spark.internal.mercury.connected?this.status!==wL.RECONNECTION.STATE.DEFAULT_STATUS||this.status!==wL.RECONNECTION.STATE.COMPLETE||new o.default(new Error("Multiple reconnections cannot occur concurrently")):new o.default(new Error("mercury is not connected, cannot reconnect")):new o.default(new Error("locus server for this call is not active, cannot reconnect")):new o.default(new Error("Reconnection is not enabled."))}},{key:"reconnect",value:function(e){var t=this.validate(e);return!0===t?this.execute(e):r.default.reject(t)}},{key:"execute",value:function(e){var t=this;return this.status=wL.RECONNECTION.STATE.IN_PROGRESS,this.media(e).then(function(e){return console.info("Reconnection->Media reestablished at: "+new Date),t.status=wL.RECONNECTION.STATE.COMPLETE,r.default.resolve(e)}).catch(function(n){if(console.info("Reconnection->Media reestablishment failed at: "+new Date),t.tryCount>e.config.reconnection.retry.times)return t.status=wL.RECONNECTION.STATE.FAILURE,r.default.reject(new o.default(n));setTimeout(function(){return t.reconnect(e)},t.backOff*=e.config.reconnection.retry.backOff.rate)})}},{key:"media",value:function(t){return this.tryCount+=1,console.info("Reconnection->Re-establishing media at: "+new Date),t.addMedia({mediaSettings:t.mediaProperties.mediaDirection}).then(function(e){return r.default.resolve(e)}).catch(function(r){return console.error("Could not re use peer connections for the media.",r),e.cleanup(t),t.addMedia({mediaSettings:t.mediaProperties.mediaDirection,localStream:t.mediaProperties.localStream,localShare:t.mediaProperties.localShare})})}}],[{key:"cleanup",value:function(e){a.default.close(e.mediaProperties.mediaPeerConnection),a.default.close(e.mediaProperties.sharePeerConnection),e.mediaProperties.unsetPeerConnections()}}]),e}();t.default=u});t(ZL);var eU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(_f),n=u(rT),i=u(By),o=u(Yy),a=u(nT),s=u(iT);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"joinMeeting",value:function(e){var t=e.sipUri,r=e.deviceUrl,n=e.locusUrl,i=e.resourceId,o=e.correlationId,a=e.ensureConversation,s=e.moderator,u=e.hostPin,c="",l={deviceUrl:r,usingResource:i||null,correlationId:o,respOnlySdp:!0,allowMultiDevice:!0,ensureConversation:a||!1,supportsNativeLobby:1};return void 0!==s&&(l.moderator=s),void 0!==u&&(l.hostPIN=u),n?c=n+"/"+wL.PARTICIPANT:t&&(c=this.spark.internal.device.services.locusServiceUrl+"/"+wL.LOCI+"/"+wL.CALL,l.invitee={address:t}),i===t&&(l.callPreferences={requestedMedia:["SLIDES"]}),this.spark.request({method:wL.POST,uri:c,qs:{alternateRedirect:!0},body:l})}},{key:"syncMeeting",value:function(e){var t=e.desync,r=e.syncUrl;return t&&(r=r.concat(r.split("?")[1]?"&":"?").concat(wL.LOCUS.SYNCDEBUG+"="+t)),this.request({method:wL.GET,uri:r}).catch(function(e){return e})}},{key:"getFullLocus",value:function(e){var t=e.locusUrl,n=e.desync;return t?(n&&(t+="?"+wL.LOCUS.SYNCDEBUG+"="+n),this.request({method:wL.GET,uri:t}).catch(function(e){console.error("error getting full locus object",e)})):r.default.reject()}},{key:"leaveMeeting",value:function(e){var t=e.locusUrl+"/"+wL.PARTICIPANT+"/"+e.selfId+"/"+wL.LEAVE,r={deviceUrl:e.deviceUrl,usingResource:e.resourceId,correlationId:e.correlationId};return this.request({method:wL.PUT,uri:t,body:r})}},{key:"acknowledgeMeeting",value:function(e){var t=e.locusUrl+"/"+wL.PARTICIPANT+"/"+wL.ALERT,r={deviceUrl:e.deviceUrl,correlationId:e.id};return this.request({method:wL.PUT,uri:t,body:r})}},{key:"declineMeeting",value:function(e){var t=e.locusUrl+"/"+wL.PARTICIPANT+"/"+wL.DECLINE,r={deviceUrl:e.deviceUrl,reason:e.reason};return this.request({method:wL.PUT,uri:t,body:r})}},{key:"remoteAudioVideoToggle",value:function(e){var t=e.locusUrl+"/"+wL.PARTICIPANT+"/"+e.selfId+"/"+wL.MEDIA,r={deviceUrl:e.deviceUrl,usingResource:e.resourceId||null,correlationId:e.correlationId,respOnlySdp:!0,localMedias:e.localMedias};return this.request({method:wL.PUT,uri:t,body:r})}},{key:"changeMeetingFloor",value:function(e){var t={disposition:e.disposition};return e.disposition===wL.FLOOR_ACTION.GRANTED&&(t={beneficiary:{url:e.personUrl,devices:[{url:e.deviceUrl}]},disposition:e.disposition,requester:{url:e.personUrl}}),this.request({uri:e.uri,method:wL.PUT,body:{floor:t,resourceUrl:e.resourceUrl}})}}]),t}(MP.StatelessSparkPlugin);t.default=c});t(eU);var tU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={isUser:function(e){return e&&e.type===wL.USER},isGuest:function(e){return e&&e.guest},isDevice:function(e){return e&&e.type===wL.RESOURCE_ROOM},isSame:function(e,t){return e&&(e.id===t||e.person&&e.person.id===t)},isAssociatedSame:function(e,t){return e&&e.associatedUsers&&e.associatedUsers.some(function(e){return e.id===t||e.person&&e.person.id===t})},isNotAdmitted:function(e,t,r){return e&&e.guest&&e.devices&&e.devices[0]&&e.devices[0].intent&&e.devices[0].intent.type===wL.WAIT&&t&&r===wL.IN_LOBBY},isAudioMuted:function(e){if(!e)throw new Error("Audio could not be processed, participant is undefined.");var t=r.isMuted(e.status,wL.AUDIO_STATUS);if(e.controls&&e.controls.audio){if(e.controls.audio.muted)return!0;if(t)return!0}return!1},isVideoMuted:function(e){if(!e)throw new Error("Video could not be processed, participant is undefined.");return r.isMuted(e.status,wL.VIDEO_STATUS)},isMuted:function(e,t){if(e){if(e[t]===wL.RECEIVE_ONLY)return!0;if(e[t]===wL.SEND_RECEIVE)return!1}return null},isRecording:function(e){if(!e)throw new Error("Recording could not be processed, participant is undefined.");return!(!e.controls||!e.controls.localRecord)&&e.controls.localRecord.recording},extractStatus:function(e){if(!(e&&e.devices&&e.devices.length))return wL.NOT_IN_MEETING;var t=e&&e.devices?e.devices[0]:null;if(t){if(t.state===wL.JOINED&&(!t.intent||t.intent.type===wL.NONE))return wL.IN_MEETING;if(t.state===wL.IDLE&&t.intent&&(t.intent.type===wL.WAIT||t.intent.type===wL.OBSERVE))return wL.IN_LOBBY;if(t.state===wL.LEFT||t.state===wL.IDLE&&(!t.intent||t.intent.type===wL.NONE))return wL.NOT_IN_MEETING}return wL.NOT_IN_MEETING},extractId:function(e){return e?e.id:null},extractName:function(e){return e&&e.person?e.person.name:null}};t.default=r});t(tU);var rU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(By),n=o(Yy),i=o(tU);function o(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,r.default)(this,e),this.namespace=wL.MEETINGS,this.participant=null,this.id=null,this.name=null,this.isAudioMuted=null,this.isVideoMuted=null,this.isSelf=null,this.isHost=null,this.isGuest=null,this.isInLobby=null,this.isInMeeting=null,this.isNotAdmitted=null,this.isContentSharing=null,this.status=null,this.isDevice=null,this.isUser=null,this.associatedUser=null,this.isRecording=null,this.processParticipant(t),this.processParticipantOptions(t,n)}return(0,n.default)(e,[{key:"processParticipant",value:function(e){this.participant=e,e&&(this.id=i.default.extractId(e),this.name=i.default.extractName(e),this.isAudioMuted=i.default.isAudioMuted(e),this.isVideoMuted=i.default.isVideoMuted(e),this.isRecording=i.default.isRecording(e),this.isGuest=i.default.isGuest(e),this.isUser=i.default.isUser(e),this.isDevice=i.default.isDevice(e),this.processStatus(e),this.isNotAdmitted=i.default.isNotAdmitted(e,this.isGuest,this.status))}},{key:"processParticipantOptions",value:function(e,t){e&&t&&(this.processIsSelf(e,t.selfId),this.processIsHost(e,t.hostId),this.processIsContentSharing(e,t.contentSharingId))}},{key:"processStatus",value:function(e){switch(this.status=i.default.extractStatus(e),this.status){case wL.IN_LOBBY:this.isInLobby=!0,this.isInMeeting=!1;break;case wL.IN_MEETING:this.isInLobby=!1,this.isInMeeting=!0;break;case wL.NOT_IN_MEETING:this.isInLobby=!1,this.isInMeeting=!1;break;default:this.isInLobby=!1,this.isInMeeting=!1}}},{key:"setIsContentSharing",value:function(e){this.isContentSharing=e}},{key:"setIsHost",value:function(e){this.isHost=e}},{key:"setIsSelf",value:function(e){this.isSelf=e}},{key:"processIsContentSharing",value:function(e,t){i.default.isUser(e)?this.isContentSharing=i.default.isSame(e,t):i.default.isDevice(e)&&(this.isContentSharing=i.default.isAssociatedSame(e,t))}},{key:"processIsSelf",value:function(e,t){i.default.isUser(e)?this.isSelf=i.default.isSame(e,t):i.default.isDevice(e)&&(this.isSelf=i.default.isAssociatedSame(e,t),this.associatedUser=t)}},{key:"processIsHost",value:function(e,t){i.default.isUser(e)?this.isHost=i.default.isSame(e,t):i.default.isDevice(e)&&(this.isHost=i.default.isAssociatedSame(e,t))}}]),e}();t.default=a});t(rU);var nU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(By),n=i(Yy);function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(){(0,r.default)(this,e),this.namespace=wL.MEETINGS,this.members={}}return(0,n.default)(e,[{key:"set",value:function(e,t){this.members[e]=t}},{key:"setAll",value:function(e){this.members=e}},{key:"get",value:function(e){return this.members[e]}},{key:"getAll",value:function(){return this.members}}]),e}();t.default=o});t(nU);var iU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={generateAddMemberOptions:function(e,t,r){return{invitee:e,locusUrl:t,alertIfActive:r}},generateAdmitMemberOptions:function(e,t){return{locusUrl:t,memberIds:e}},getAddMemberBody:function(e){return{invitees:[{address:e.invitee.emailAddress||e.invitee.email}],alertIfActive:e.alertIfActive}},getAdmitMemberRequestBody:function(e){return{admit:{memberIds:e.memberIds}}},getAdmitMemberRequestParams:function(e){var t=r.getAdmitMemberRequestBody(e);return{method:wL.PUT,uri:e.locusUrl+"/"+wL.CONTROLS,body:t}},getAddMemberRequestParams:function(e){var t=r.getAddMemberBody(e);return{method:wL.PUT,uri:e.locusUrl,body:t}}};t.default=r});t(iU);var oU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(rT),n=u(By),i=u(Yy),o=u(nT),a=u(iT),s=u(iU);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){var e,i,a,s;(0,n.default)(this,t);for(var u=arguments.length,c=Array(u),l=0;l<u;l++)c[l]=arguments[l];return i=a=(0,o.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(c))),a.namespace=wL.MEETINGS,s=i,(0,o.default)(a,s)}return(0,a.default)(t,e),(0,i.default)(t,[{key:"addMembers",value:function(e){if(e&&e.invitee&&e.invitee.emailAddress&&e.invitee.email&&e.locusUrl)throw new Error("invitee must be passed and the associated locus url for this meeting object must be defined.");var t=s.default.getAddMemberRequestParams(e);return this.request(t)}},{key:"admitMember",value:function(e){if(!e||!e.locusUrl||!e.participantIds)throw new Error("memberIds must be an array passed and the associated locus url for this meeting object must be defined.");var t=s.default.getAdmitMemberRequestParams(e);return this.request(t)}}]),t}(MP.StatelessSparkPlugin);t.default=c});t(oU);var aU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=h(_f),n=h(rT),i=h(By),o=h(Yy),a=h(nT),s=h(iT),u=h(pg),c=h(TL),l=h(rU),f=h(nU),d=h(oU),p=h(iU);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e,r){(0,i.default)(this,t);var o=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,{},r));return o.namespace=wL.MEETINGS,o.membersRequest=new d.default({},r),o.membersCollection=new f.default,o.locusUrl=null,o.hostId=null,o.selfId=null,o.mediaShareContentId=null,o.setUpLocusInfoListeners(),o}return(0,s.default)(t,e),(0,o.default)(t,[{key:"setUpLocusInfoListeners",value:function(){this.setUpLocusUrlListener(),this.setUpLocusHostListener(),this.setUpLocusSelfListener(),this.setUpLocusParticipantsListener(),this.setUpLocusMediaSharesListener()}},{key:"setUpLocusSelfListener",value:function(){var e=this;c.default.on(wL.EVENTS.LOCUS_INFO_UPDATE_SELF,function(t){var r=null,n=null;if(t&&(t.newSelf&&(r=t.newSelf.id),t.oldSelf&&(n=t.oldSelf.id)),r){var i=e.membersCollection.get(r);i&&i.setIsSelf(!0)}if(n){var o=e.membersCollection.get(n);o&&o.setIsSelf(!1)}e.selfId=r,e.trigger(wL.EVENT_TRIGGERS.MEMBERS_SELF_UPDATE,{activeSelfId:r,endedSelfId:n})})}},{key:"setUpLocusHostListener",value:function(){var e=this;c.default.on(wL.EVENTS.LOCUS_INFO_UPDATE_HOST,function(t){var r=null,n=null;if(t&&(t.newHost&&(r=t.newHost.id),t.oldHost&&(n=t.oldHost.id)),r){var i=e.membersCollection.get(r);i&&i.setIsHost(!0)}if(n){var o=e.membersCollection.get(n);o&&o.setIsHost(!1)}e.hostId=r,e.trigger(wL.EVENT_TRIGGERS.MEMBERS_HOST_UPDATE,{activeHostId:r,endedHostId:n})})}},{key:"setUpLocusParticipantsListener",value:function(){var e=this;c.default.on(wL.EVENTS.LOCUS_INFO_UPDATE_PARTICIPANTS,function(t){e.handleParticipantsPayload(t)})}},{key:"handleParticipantsPayload",value:function(e){if(e){var t=this.handleLocusInfoUpdatedParticipants(e),r=this.handleMembersUpdate(t);this.trigger(wL.EVENT_TRIGGERS.MEMBERS_UPDATE,{delta:t,full:r})}}},{key:"handleMembersUpdate",value:function(e){return e&&(e.updated&&this.constructMembers(e.updated),e.added&&this.constructMembers(e.added)),this.membersCollection.getAll()}},{key:"constructMembers",value:function(e){var t=this;e.forEach(function(e){t.membersCollection.set(e.id,e)})}},{key:"setUpLocusMediaSharesListener",value:function(){var e=this;c.default.on(wL.EVENTS.LOCUS_INFO_UPDATE_MEDIA_SHARES,function(t){var r=t.current,n=null,i=null;if(r&&r.contentId&&(r.disposition===wL.FLOOR_ACTION.GRANTED?n=r.contentId:r.disposition===wL.FLOOR_ACTION.RELEASED&&(i=r.contentId)),n){var o=e.membersCollection.get(n);o&&o.setIsContentSharing(!0)}if(i){var a=e.membersCollection.get(i);a&&a.setIsContentSharing(!1)}e.mediaShareContentId=n,e.trigger(wL.EVENT_TRIGGERS.MEMBERS_CONTENT_UPDATE,{activeContentSharingId:n,endedContentSharingId:i})})}},{key:"setUpLocusUrlListener",value:function(){var e=this;c.default.on(wL.EVENTS.LOCUS_INFO_UPDATE_URL,function(t){t&&e.setLocusUrl(null,t)})}},{key:"handleLocusInfoUpdatedParticipants",value:function(e){if(this.hostId=e.hostId||this.hostId,this.selfId=e.selfId||this.selfId,!e.participants)throw new Error("Members update could not occur, participants payload was not present.");return this.update(e.participants)}},{key:"setLocusUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t)this.locusUrl=t;else{if(!e||!e.locusUrl&&!e.url)throw new Error("Setting locusUrl for the Members module should be done with a locus object or locusUrl");this.locusUrl=e.locusUrl||e.url}}},{key:"setHostId",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t)this.hostId=t;else{if(!e)throw new Error("Setting hostid for the Members module should be done with a locus object or hostId");this.hostId=e&&e.owner&&e.owner.info?e.owner.info:null}}},{key:"setSelfId",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t)this.selfId=t;else{if(!e)throw new Error("Setting selfid for the Members module should be done with a locus object or selfId");this.selfId=e&&e.self&&e.self.person&&e.self.person.id?e.self.person.id:null}}},{key:"setMediaShareContentId",value:function(e,t){if(t)this.mediaShareContentId=t;else{if(!e)throw new Error("Setting hostid for the Members module should be done with a locus object or hostId");this.mediaShareContentId=e&&e.mediaShares&&e.mediaShares.length&&e.mediaShares[0]&&e.mediaShares[0].name===wL.CONTENT&&e.mediaShares[0].floor&&e.mediaShares[0].floor.beneficiary?e.mediaShares[0].floor.beneficiary.id:null}}},{key:"update",value:function(e){var t=this,r={added:[],updated:[]};return e&&e.forEach(function(e){e.hideInRoster||(t.membersCollection.get(e.id)?r.updated.push(new l.default(e,{selfId:t.selfId,hostId:t.hostId,contentSharingId:t.mediaShareContentId})):r.added.push(new l.default(e,{selfId:t.selfId,hostId:t.hostId,contentSharingId:t.mediaShareContentId})))}),r}},{key:"addMember",value:function(e,t){if(e&&e.emailAddress&&e.email&&this.locusUrl)return r.default.reject(new Error("invitee must be passed and the associated locus url for this meeting object must be defined."));var n=p.default.generateAddMemberOptions(e,this.locusUrl,t);return this.membersRequest.addMember(n).then(function(e){return e}).catch(function(e){return e})}},{key:"admitMembers",value:function(e){if((0,u.default)(e))return r.default.reject(new Error("No member ids provided to admit."));var t=p.default.generateAdmitMemberOptions(e,this.locusUrl);return this.membersRequest.admitMember(t).then(function(e){return e}).catch(function(e){return e})}}]),t}(MP.StatelessSparkPlugin);t.default=v});t(aU);var sU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(By),n=i(Yy);function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(){(0,r.default)(this,e),this.history=[]}return(0,n.default)(e,[{key:"get",value:function(){return this.history}},{key:"clearHistory",value:function(){this.history=[]}},{key:"getHistoryAt",value:function(e){return this.history[e]}},{key:"getMostRecent",value:function(){return this.history.length>1?this.history[1]:void 0}},{key:"addHistory",value:function(e){var t=void 0;return this.history.length>=wL.DEFAULT_STATS_HISTORY_MAX&&(t=this.history.pop()),this.history.unshift(e),t}}]),e}();t.default=o});t(sU);var uU=Xf.isFinite;var cU=function(e){return"number"==typeof e&&uU(e)},lU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(cU),n=i(Up);function i(e){return e&&e.__esModule?e:{default:e}}var o={interval:function(e,t){if(!e||!e.data||!e.data.getData||0===(0,n.default)(e.data.getData()).length)return t;var i={};return(0,n.default)(t.data.getData()).forEach(function(o){i[o]=i[o]?i[o]:{},(0,n.default)(t.data.getData()[o]).forEach(function(n){var a=t.data.getData()[o][n];!(0,r.default)(a)||wL.DEFAULT_EXCLUDED_STATS.includes(n)&&0!==a||(e.data.getData()[o]&&e.data.getData()[o][n]?(a-=e.data.getData()[o][n],i[o][n]=a):i[o][n]=a)})}),i},aggregate:function(e,t){var i=t;return(0,n.default)(e.data.getData()).forEach(function(t){(0,n.default)(e.data.getData()[t]).forEach(function(n){var o=e.data.getData()[t][n];!(0,r.default)(o)||wL.DEFAULT_EXCLUDED_STATS.includes(n)&&0!==o||(i[t][n]?i[t][n]+=o:i[t][n]=o)})}),i}};t.default=o});t(lU);var fU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(By),n=a(Yy),i=a(Up),o=a(lU);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{format:wL.DEFAULT_TRANSFORM_KEYS,summary:{}};(0,r.default)(this,e),this.summary=n.summary,0===(0,i.default)(n.summary).length&&n.format.forEach(function(e){t.summary[e]={}})}return(0,n.default)(e,[{key:"setFormat",value:function(e){var t=this;this.clearSummary(),e.forEach(function(e){t.summary[e]={}})}},{key:"get",value:function(){return this.summary}},{key:"clear",value:function(){this.summary={}}},{key:"aggregate",value:function(e){this.summary=o.default.aggregate(e,this.summary)}}]),e}();t.default=s});t(fU);var dU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(By),n=o(Yy),i=o(lU);function o(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{previous:void 0,updated:void 0,interval:{}};(0,r.default)(this,e),this.previous=t.previous,this.updated=t.updated,this.interval=t.interval}return(0,n.default)(e,[{key:"setPrevious",value:function(e){this.previous=e}},{key:"setUpdated",value:function(e){this.updated=e}},{key:"getPrevious",value:function(){return this.previous}},{key:"getUpdated",value:function(){return this.updated}},{key:"get",value:function(){return this.interval}},{key:"calculateInterval",value:function(){this.interval=i.default.interval(this.getPrevious(),this.getUpdated())}},{key:"updateInterval",value:function(e){return this.setPrevious(this.updated),this.setUpdated(e),this.calculateInterval(),this.get()}}]),e}();t.default=a});t(dU);var pU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(rT),n=u(By),i=u(Yy),o=u(nT),a=u(iT),s=u(h_);function u(e){return e&&e.__esModule?e:{default:e}}var c=new s.default,l=new s.default,f=new s.default,d=new s.default,p=function(e){function t(e){(0,n.default)(this,t);var i=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this,{objectMode:!0}));c.has(e)||c.set(e,new fS.EventEmitter);var a=c.get(e);return f.has(i)||f.set(i,a),l.has(a)||l.set(a,e),a.once(wL._ERROR_,function(e){i.emit(wL._ERROR_,e)}),i}return(0,a.default)(t,e),(0,i.default)(t,[{key:"_read",value:function(){var e=this,t=f.get(this);t.once(wL._DATA_,function(t){e.isPaused()||e.push(t)}),d.has(t)||function e(t){var r=(0,Qw.safeSetTimeout)(function(){var r=l.get(t);r&&r.getStats().then(function(n){t.emit(wL._DATA_,n),r.signalingState!==wL._CLOSED_&&r.connectionState!==wL._CLOSED_&&e(t)}).catch(function(e){t.emit(wL._ERROR_,e)})},wL.DEFAULT_STATS_INTERVAL);d.set(t,r)}(t)}}]),t}(fL.Readable);t.default=p});t(pU);var hU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(wk),n=o(KP),i=o(Up);function o(e){return e&&e.__esModule?e:{default:e}}var a={simplify:function(e){return(0,n.default)((0,i.default)(wL.DEFAULT_TRANSFORM_REGEX),function(t){var r=!!wL.DEFAULT_TRANSFORM_REGEX[t].regex.test(e.id)&&t;if(r){if(wL.DEFAULT_TRANSFORM_REGEX[r].profiler&&(!e[wL.DEFAULT_TRANSFORM_REGEX[r].profiler.type].includes(wL.DEFAULT_TRANSFORM_REGEX[r].profiler.value)||!r.toLowerCase().includes(wL.DEFAULT_TRANSFORM_REGEX[r].profiler.value)))return r=!1;if(wL.DEFAULT_TRANSFORM_REGEX[r].decider&&e[wL.DEFAULT_TRANSFORM_REGEX[r].decider]!==wL.DEFAULT_TRANSFORM_REGEX[r].selector)return r=!1}return r})},parse:function(e){var t={};return e&&e.forEach&&e.size>0&&e.forEach(function(e){e&&e.type&&wL.DEFAULT_GET_STATS_FILTER.types.includes(e.type)&&(t[e.id]=e)}),t},convert:function(e,t){if(t.simplifyFn)return t.simplifyFn(e);var n={};return(0,r.default)(e,function(e){var t=a.simplify(e);t&&(n[t]=e)}),n},transform:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{simplifyFn:void 0},r=a.parse(e);return wL.DEFAULT_TRANSFORM_REGEX?a.convert(r,t):r}};t.default=a});t(hU);var vU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(By),n=o(Yy),i=o(lP);function o(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(t){(0,r.default)(this,e),this.data=t,this.id=i.default.v4()}return(0,n.default)(e,[{key:"getId",value:function(){return this.id}},{key:"getData",value:function(){return this.data}}]),e}();t.default=a});t(vU);var gU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(rT),n=c(By),i=c(Yy),o=c(nT),a=c(iT),s=c(hU),u=c(vU);function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return(0,n.default)(this,t),(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this,{objectMode:!0}))}return(0,a.default)(t,e),(0,i.default)(t,[{key:"_transform",value:function(e,t,r){if(e){var n=s.default.transform(e),i=new u.default(n);this.push({data:i}),r()}else r()}}]),t}(fL.Transform);t.default=l});t(gU);var mU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(rT),n=s(By),i=s(Yy),o=s(nT),a=s(iT);function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e,t,r,n,i){var o={};return o.found=r.some(function(r){return!!(e[r]&&e[r][n]&&e[r][n]>0)&&(o.match={type:t,key:r,data:e[r],stat:n,kind:i},!0)}),o},c=function(e){function t(e,i){(0,n.default)(this,t);var a=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this,{},i));return a.namespace=wL.MEETINGS,a.sentFirstVideoBytes=void 0,a.receivedFirstVideoBytes=void 0,a.sentFirstAudioBytes=void 0,a.receivedFirstAudioBytes=void 0,a}return(0,a.default)(t,e),(0,i.default)(t,[{key:"receiveEventAudio",value:function(e){if(e&&e.data&&e.data.getData()){var t=e.data.getData();if(t&&!this.receivedFirstAudioBytes){var r=u(t,wL.EVENT_TYPES.REMOTE,wL.DEFAULT_EVENT_AUDIO_RECEIVE_KEYS,wL.EVENT_STATS_MAP.BYTES_RECEIVED,wL.VIDEO);r&&r.found&&r.match&&(this.receivedFirstAudioBytes=r.match,this.trigger(wL.EVENT_TRIGGERS.STATS_UPDATE,this.receivedFirstAudioBytes))}}return this.receivedFirstVideoBytes}},{key:"receiveEventVideo",value:function(e){if(e&&e.data&&e.data.getData()){var t=e.data.getData();if(t&&!this.receivedFirstVideoBytes){var r=u(t,wL.EVENT_TYPES.REMOTE,wL.DEFAULT_EVENT_VIDEO_RECEIVE_KEYS,wL.EVENT_STATS_MAP.BYTES_RECEIVED,wL.VIDEO);r&&r.found&&r.match&&(this.receivedFirstVideoBytes=r.match,this.trigger(wL.EVENT_TRIGGERS.STATS_UPDATE,this.receivedFirstVideoBytes))}}return this.receivedFirstVideoBytes}},{key:"sendEventVideo",value:function(e){if(e&&e.data&&e.data.getData()){var t=e.data.getData();if(t&&!this.sentFirstVideoBytes){var r=u(t,wL.EVENT_TYPES.LOCAL,wL.DEFAULT_EVENT_VIDEO_SEND_KEYS,wL.EVENT_STATS_MAP.BYTES_SENT,wL.VIDEO);r&&r.found&&r.match&&(this.sentFirstVideoBytes=r.match,this.trigger(wL.EVENT_TRIGGERS.STATS_UPDATE,this.sentFirstVideoBytes))}}return this.sentFirstVideoBytes}},{key:"sendEventAudio",value:function(e){if(e&&e.data&&e.data.getData()){var t=e.data.getData();if(t&&!this.sentFirstAudioBytes){var r=u(t,wL.EVENT_TYPES.LOCAL,wL.DEFAULT_EVENT_AUDIO_SEND_KEYS,wL.EVENT_STATS_MAP.BYTES_SENT,wL.AUDIO);r&&r.found&&r.match&&(this.sentFirstAudioBytes=r.match,this.trigger(wL.EVENT_TRIGGERS.STATS_UPDATE,this.sentFirstAudioBytes))}}return this.sentFirstVideoBytes}},{key:"event",value:function(e){return{sentFirstVideoBytes:this.sendEventVideo(e),receivedFirstVideoBytes:this.receiveEventVideo(e),sentFirstAudioBytes:this.sendEventAudio(e),receivedFirstAudioBytes:this.receiveEventAudio(e)}}}]),t}(MP.StatelessSparkPlugin);t.default=c});t(mU);var yU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=h(rT),n=h(By),i=h(Yy),o=h(nT),a=h(iT),s=h(lP),u=h(sU),c=h(fU),l=h(dU),f=h(pU),d=h(gU),p=h(mU);function h(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e,i,a){(0,n.default)(this,t);var s=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this,{},i));return s.namespace=wL.MEETINGS,s.attrs=e,s.options=i,s.history=void 0,s.interval=void 0,s.aggregator=void 0,s.stream=void 0,s.filter=void 0,s.events=void 0,s.id=void 0,a&&a.history&&s.withHistory(),a&&a.interval&&s.withInterval(),a&&a.aggregator&&s.withAggregator(),a&&a.filter&&!a.stream&&s.withFilter(a.filter),a&&a.stream&&!a.filter&&s.withStream(a.stream),a&&a.events&&s.withEvents(a.events),a&&a.id&&s.withId(),s}return(0,a.default)(t,e),(0,i.default)(t,[{key:"doHistory",value:function(e){this.history&&this.history.addHistory(e)}},{key:"doInterval",value:function(e){this.interval&&this.interval.updateInterval(e)}},{key:"doAggregator",value:function(e){this.aggregator&&this.aggregator.aggregate(e)}},{key:"doEvents",value:function(e){this.events&&this.events.event(e)}},{key:"onData",value:function(e){var t=this;if(!this.filter)throw new Error("The stats peer connection filter must be set up before data can be worked upon.");this.filter.on("data",function(r){t.doHistory(r),t.doInterval(r),t.doAggregator(r),t.doEvents(r),e&&e(r)})}},{key:"withEvents",value:function(){var e=new p.default(this.attrs,this.options);return this.setEvents(e),this}},{key:"withHistory",value:function(){var e=new u.default;return this.setHistory(e),this}},{key:"withAggregator",value:function(){var e=new c.default;return this.setAggregator(e),this}},{key:"withInterval",value:function(){var e=new l.default;return this.setInterval(e),this}},{key:"withStream",value:function(e){var t=new f.default(e);return this.setStream(t),this}},{key:"withFilter",value:function(e){var t=new f.default(e);this.setStream(t);var r=new d.default;return this.setFilter(r),t.pipe(r),this}},{key:"withId",value:function(e){if(e)return this.setId(e),this;var t=s.default.v4();return this.setId(t),this}},{key:"build",value:function(){return this}},{key:"setId",value:function(e){this.id=e}},{key:"setHistory",value:function(e){this.history=e}},{key:"setInterval",value:function(e){this.interval=e}},{key:"setAggregator",value:function(e){this.aggregator=e}},{key:"setEvents",value:function(e){this.events=e}},{key:"setStream",value:function(e){this.stream=e}},{key:"setFilter",value:function(e){this.filter=e}},{key:"getId",value:function(){return this.id}},{key:"getHistory",value:function(){return this.history}},{key:"getInterval",value:function(){return this.interval}},{key:"getAggregator",value:function(){return this.aggregator}},{key:"getEvents",value:function(){return this.events}},{key:"getStream",value:function(){return this.stream}},{key:"getFilter",value:function(){return this.filter}}]),t}(MP.StatelessSparkPlugin);t.default=v});t(yU);var _U=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(rT),n=u(By),i=u(Yy),o=u(nT),a=u(iT),s=u(yU);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e,i,a){(0,n.default)(this,t);var s=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this,{},i));return s.namespace=wL.MEETINGS,s.attrs=e,s.options=i,s.media=void 0,s.screen=void 0,a&&a.media&&s.withMedia(a.media),a&&a.screen&&s.withScreen(a.screen),s}return(0,a.default)(t,e),(0,i.default)(t,[{key:"build",value:function(){return this}},{key:"withMedia",value:function(e){return this.media=new s.default(this.attrs,this.options,e),this}},{key:"withScreen",value:function(e){return this.screen=new s.default(this.attrs,this.options,e),this}},{key:"setMedia",value:function(e){this.media=e}},{key:"setScreen",value:function(e){this.screen=e}},{key:"getMedia",value:function(){return this.media}},{key:"getScreen",value:function(){return this.screen}}]),t}(MP.StatelessSparkPlugin);t.default=c});t(_U);var bU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(FS),n=l(BS),i=l(HS),o=l(eT),a=l(rT),s=l(By),u=l(nT),c=l(iT);function l(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:wL.ERROR_DICTIONARY.INTENT_TO_JOIN.MESSAGE;(0,s.default)(this,t);var n=(0,u.default)(this,(t.__proto__||(0,a.default)(t)).call(this,r));return n.name=wL.ERROR_DICTIONARY.INTENT_TO_JOIN.NAME,n.sdkMessage=wL.ERROR_DICTIONARY.INTENT_TO_JOIN.MESSAGE,n.error=e,n.joinIntentRequired=!0,n.code=wL.ERROR_DICTIONARY.INTENT_TO_JOIN.CODE,n}return(0,c.default)(t,e),t}(function(e){function t(){var t=(0,o.default)(e,(0,i.default)(arguments));return(0,n.default)(t,(0,a.default)(this)),t}return t.prototype=(0,r.default)(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n.default?(0,n.default)(t,e):t.__proto__=e,t}(Error));t.default=f});t(bU);var EU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(FS),n=l(BS),i=l(HS),o=l(eT),a=l(rT),s=l(By),u=l(nT),c=l(iT);function l(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wL.ERROR_DICTIONARY.JOIN_MEETING.MESSAGE;(0,s.default)(this,t);var i=(0,u.default)(this,(t.__proto__||(0,a.default)(t)).call(this,n));return i.name=wL.ERROR_DICTIONARY.JOIN_MEETING.NAME,i.sdkMessage=wL.ERROR_DICTIONARY.JOIN_MEETING.MESSAGE,i.error=e,i.joinOptions=r,i.code=wL.ERROR_DICTIONARY.JOIN_MEETING.CODE,i}return(0,c.default)(t,e),t}(function(e){function t(){var t=(0,o.default)(e,(0,i.default)(arguments));return(0,n.default)(t,(0,a.default)(this)),t}return t.prototype=(0,r.default)(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n.default?(0,n.default)(t,e):t.__proto__=e,t}(Error));t.default=f});t(EU);var SU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=I(wf),n=I(_f),i=I(yR),o=I(Xw),a=I(rT),s=I(By),u=I(Yy),c=I(nT),l=I(iT),f=I(lP),d=I(TL),p=I(LL),h=I(UL),v=I(FL),g=I(qL),m=I(BL),y=I(zL),_=I(KL),b=I(PL),E=I(ZL),S=I(eU),T=I(aU),w=I(VL),O=I(_U),k=I(bU),R=I(EU),A=I(QL);function I(e){return e&&e.__esModule?e:{default:e}}var P=function(e){function t(e,r){(0,s.default)(this,t);var n=(0,c.default)(this,(t.__proto__||(0,a.default)(t)).call(this,{},r));return n.namespace=wL.MEETINGS,n.getMediaStreams=function(e){return h.default.getUserMedia(e)},n.attrs=e,n.options=r,n.id=f.default.v4(),n.userId=e.userId,n.resource=e.resource,n.deviceUrl=e.deviceUrl,n.roapSeq=wL.ROAP_SEQ_PRE,n.meetingInfo={},n.members=new T.default({},{parent:n.spark}),n.roap=new p.default({},r),n.reconnectionManager=null,n.audio=null,n.video=null,n.state=g.default.create(n),n.stats=null,n.convoId=null,n.locusUrl=e.locus&&e.locus.url||null,n.sipUri=null,n.partner=null,n.type=null,n.owner=null,n.hostId=null,n.policy=null,n.meetingRequest=new S.default({},r),n.locusInfo=new _.default(n.updateMeetingObject.bind(n),e.locus?e.locus:{},n.spark),n.mediaProperties=new v.default,n.setUpLocusInfoListeners(),n}return(0,l.default)(t,e),(0,u.default)(t,[{key:"setUpLocusInfoListeners",value:function(){this.setUpLocusInfoSelfListener()}},{key:"setUpLocusInfoSelfListener",value:function(){var e=this;this.locusInfo.on(wL.EVENTS.SELF_UNADMITTED_GUEST,function(t){t&&e.trigger(wL.EVENT_TRIGGERS.MEETING_SELF_LOBBY_WAITING,{payload:t})}),this.locusInfo.on(wL.EVENTS.SELF_ADMITTED_GUEST,function(t){t&&e.trigger(wL.EVENT_TRIGGERS.MEETING_SELF_GUEST_ADMITTED,{payload:t})}),this.locusInfo.on(wL.EVENTS.DESTROY_MEETING,function(t){d.default.emit(wL.EVENTS.DESTROY_MEETING,{response:t,meeting:e})})}},{key:"updateMeetingObject",value:function(e){var t=this;console.log("UPDATES FROM ",e),e&&(0,o.default)(e).length&&(0,o.default)(e).forEach(function(r){t[r]=e[r]})}},{key:"invite",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.members.addMember(e,t)}},{key:"admit",value:function(e){return this.members.admitMembers(e)}},{key:"getMembers",value:function(){return this.members}},{key:"getStats",value:function(e){return this.stats?this.stats:this.createStats(e)}},{key:"createStats",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.stats=new O.default(this.attrs,this.options,e),this.stats}},{key:"isAudioMuted",value:function(){return this.audio&&this.audio.isMuted()}},{key:"isAudioSelf",value:function(){return this.audio&&this.audio.isSelf()}},{key:"isVideoMuted",value:function(){return this.video&&this.video.isMuted()}},{key:"isVideoSelf",value:function(){return this.video&&this.video.isSelf()}},{key:"parseMeetingInfo",value:function(e){!e||!e.body||e.errors&&e.errors.length>0||(this.convoId=e.body.convoId||this.convoId,this.locusUrl=e.body.locusUrl||this.locusUrl,this.sipUri=e.body.sipMeetingUri||this.sipUri,this.owner=e.body.owner||this.owner)}},{key:"parseLocus",value:function(e){e&&(this.locusUrl=e.url,this.setLocus(e),e.participants&&e.self&&(this.partner=w.default.getLocusPartner(e.participants,e.self)),!this.sipUri&&this.partner&&this.type===wL.ONE_ON_ONE&&(this.sipUri=this.partner.person.sipUrl||this.partner.person.emailAddress||this.partner.person.email))}},{key:"setSipUri",value:function(e){this.sipUri=e}},{key:"setRoapSeq",value:function(e){e&&(this.roapSeq=e)}},{key:"setLocus",value:function(e){var t=e.locus||e;this.mediaConnections=e.mediaConnections,this.locusUrl=e.locusUrl||e.url,this.locusId=e.locusId,this.selfId=e.selfId,this.mediaId=e.mediaId,this.hostId=t.host?t.host.id:this.hostId,this.locusInfo.initialSetup(t)}},{key:"setRemoteStream",value:function(e){var t=this;e&&(e.ontrack=function(e){var r=(0,i.default)(e.streams,1);t.mediaProperties.remoteStream=r[0],t.trigger(wL.EVENT_TRIGGERS.MEDIA_READY,{type:wL.EVENT_TYPES.REMOTE,stream:t.mediaProperties.remoteStream})})}},{key:"unsetRemoteStream",value:function(){this.mediaProperties.unsetRemoteStream()}},{key:"closeRemoteStream",value:function(){var e=this;return h.default.stopStream(this.mediaProperties.remoteStream).then(function(){e.trigger(wL.EVENT_TRIGGERS.MEDIA_STOPPED,{type:wL.EVENT_TYPES.REMOTE})})}},{key:"setShareStream",value:function(e){var t=this;e&&(e.ontrack=function(e){var r=(0,i.default)(e.streams,1);t.mediaProperties.remoteShare=r[0],t.trigger(wL.EVENT_TRIGGERS.MEDIA_READY,{type:wL.EVENT_TYPES.REMOTE_SHARE,stream:t.mediaProperties.remoteShare})})}},{key:"setLocalStream",value:function(e){e&&(this.mediaProperties.setLocalStream(e),this.trigger(wL.EVENT_TRIGGERS.MEDIA_READY,{type:wL.EVENT_TYPES.LOCAL,stream:this.mediaProperties.localStream}))}},{key:"setLocalShare",value:function(e){var t=this;e&&(this.mediaProperties.setLocalShare(e),this.mediaProperties.localShare.getVideoTracks().forEach(function(e){e.onended=function(){t.stopShare()}}),this.trigger(wL.EVENT_TRIGGERS.MEDIA_READY,{type:wL.EVENT_TYPES.LOCAL_SHARE,stream:this.mediaProperties.localShare}))}},{key:"closeLocalStream",value:function(){var e=this;return h.default.stopStream(this.mediaProperties.localStream).then(function(){e.trigger(wL.EVENT_TRIGGERS.MEDIA_STOPPED,{type:wL.EVENT_TYPES.LOCAL})})}},{key:"closeLocalShare",value:function(){var e=this;return h.default.stopStream(this.mediaProperties.localShare).then(function(){e.trigger(wL.EVENT_TRIGGERS.MEDIA_STOPPED,{type:wL.EVENT_TYPES.LOCAL_SHARE})})}},{key:"unsetLocalStream",value:function(){this.mediaProperties.unsetLocalStream()}},{key:"unsetLocalShare",value:function(){this.mediaProperties.unsetLocalShare()}},{key:"setPeerConnections",value:function(e,t){var r=this;this.mediaProperties.setPeerConnections(e,t),this.config.reconnection.detection&&(this.reconnectionManager=new E.default(this),b.default.detectFailures(this.mediaProperties.mediaPeerConnection,this.mediaProperties.sharePeerConnection,this.reconnect),this.spark.internal.mercury.on(wL.ONLINE,function(){r.reconnect()}))}},{key:"closePeerConnections",value:function(){return n.default.all([b.default.close(this.mediaProperties.mediaPeerConnection),b.default.close(this.mediaProperties.sharePeerConnection)])}},{key:"unsetPeerConnections",value:function(){this.mediaProperties.unsetPeerConnections(),this.config.reconnection.detection&&this.spark.internal.mercury.off(wL.ONLINE)}},{key:"setCorrelationId",value:function(e){this.correlationId=e}},{key:"muteAudio",value:function(){return!this.audio||this.audio&&!this.audio.toggle?n.default.reject(new Error("no audio control associated to the meeting")):this.audio.toggle({mute:!0,self:!0})}},{key:"unmuteAudio",value:function(){return!this.audio||this.audio&&!this.audio.toggle?n.default.reject(new Error("no audio control associated to the meeting")):this.audio.toggle({mute:!1,self:!0})}},{key:"muteVideo",value:function(){return!this.video||this.video&&!this.video.toggle?n.default.reject(new Error("no video control associated to the meeting")):this.video.toggle({mute:!0,self:!0})}},{key:"unmuteVideo",value:function(){return!this.video||this.video&&!this.video.toggle?n.default.reject(new Error("no audio control associated to the meeting")):this.video.toggle({mute:!1,self:!0})}},{key:"joinWithMedia",value:function(e,t,r){var o=this;this.join(e).then(function(e){return o.getMediaStreams(r).then(function(r){var a=(0,i.default)(r,2),s=a[0],u=a[1];return o.addMedia({mediaSettings:t,localShare:u,localStream:s}).then(function(t){n.default.resolve({join:e,media:t,local:[s,u]})})})}).catch(function(e){return n.default.reject(e)})}},{key:"reconnect",value:function(){var e=this;if(!this.reconnectionManager||!this.reconnectionManager.reconnect)throw new Error("Cannot reconnect, ReconnectionManager must first be defined.");return this.reconnectionManager.reconnect(this).then(function(t){return e.trigger(wL.EVENT_TRIGGERS.MEETING_RECONNECTION_SUCCESS,{reconnect:t}),n.default.resolve(t)}).catch(function(t){return e.trigger(wL.EVENT_TRIGGERS.MEETING_RECONNECTION_FAILURE,{error:new A.default(t)}),n.default.reject(new A.default(t))}).finally(function(t){return e.reconnectionManager.reset(),n.default.resolve(t)})}},{key:"join",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.ringing(wL.STOP,!1),this.resourceId=this.resourceId||t.resourceId,this.setCorrelationId(this.id),t=w.default.cleanOptions(t,this.meetingInfo,this.owner,this.userId),w.default.joinMeeting(this,t).then(function(t){return e.setLocus(t),t}).catch(function(r){return w.default.isPinOrGuest(r)?w.default.hasOwner(e.meetingInfo)?w.default.joinMeeting(e,t).then(function(t){return e.setLocus(t),t}):n.default.reject(new k.default(r)):(e.logger.log("Meeting:index#join --\x3e Error joining the call on getLocalMedia, ",r),n.default.reject(new R.default(r,t)))})}},{key:"addMedia",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.localStream,o=t.localShare;return this.mediaProperties.setMediaDirection((0,r.default)(this.config.mediaSettings,t.mediaSettings)),this.audio=this.audio||m.default.create(this.mediaProperties.mediaDirection,this),this.video=this.video||y.default.create(this.mediaProperties.mediaDirection,this),this.setLocalStream(n),this.setLocalShare(o),h.default.attachMedia(this.mediaProperties.mediaDirection,b.default,n,o,{mediaPeerConnection:this.mediaProperties.mediaPeerConnection,sharePeerConnection:this.mediaProperties.sharePeerConnection}).then(function(t){var r=(0,i.default)(t,2),n=r[0],o=r[1],a=b.default.setContentSlides(o);e.setPeerConnections(n,a),e.setRemoteStream(e.mediaProperties.mediaPeerConnection),e.setShareStream(e.mediaProperties.sharePeerConnection)}).catch(function(t){throw e.logger.log("Meeting:index#join --\x3e Error joining the call on roap initialization, ",t),t}).then(function(){return e.roap.sendRoapMediaRequest({sdps:w.default.getSdps(e),roapSeq:e.roapSeq,meeting:e}).catch(function(t){throw e.logger.error("Meeting:index#join --\x3e Error joining the call on send roap media request, ",t),t})}).then(function(){})}},{key:"ringing",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.trigger(wL.EVENT_TRIGGERS.MEETING_RINGING,{type:e,ringing:t})}},{key:"acknowledge",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e?e===wL.INCOMING?this.meetingRequest.acknowledgeMeeting({locusUrl:this.locusUrl,deviceUrl:this.deviceUrl,id:this.id}).then(function(e){return n.default.resolve(e)}).then(function(i){return t.ringing(e,r),n.default.resolve({message:"Meeting type: "+e+" is acknowledged. Triggered ringing with: "+r+".",ringing:r,response:i})}):n.default.resolve({message:"noop"}):n.default.reject(new Error("Type must be set to acknowledge the meeting."))}},{key:"decline",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wL.BUSY;return this.meetingRequest.declineMeeting({locusUrl:this.locusUrl,deviceUrl:this.deviceUrl,reason:t}).then(function(){e.ringing(wL.STOP,!1)})}},{key:"leave",value:function(){var e=this;return this.meetingRequest.leaveMeeting({locusUrl:this.locusUrl,selfId:this.selfId,correlationId:this.correlationId,resourceId:null,deviceUrl:this.deviceUrl}).then(function(){return e.closeLocalStream()}).then(function(){return e.closeLocalShare()}).then(function(){return e.closePeerConnections()}).then(function(){e.unsetLocalStream(),e.unsetLocalShare(),e.unsetRemoteStream(),e.unsetPeerConnections()}).then(function(){e.roap.stop(e.correlationId,e.roapSeq)}).catch(function(t){e.logger.error("An error occured while trying to leave meeting with an id of "+e.id,t)})}},{key:"share",value:function(){var e=this.locusInfo.mediaShares.find(function(e){return e.name===wL.CONTENT});return e?this.meetingRequest.changeMeetingFloor({disposition:wL.FLOOR_ACTION.GRANTED,personUrl:this.locusInfo.self.url,deviceUrl:this.deviceUrl,uri:e.url,resourceUrl:this.resourceUrl}):n.default.reject(new Error("Cannot share without content."))}},{key:"stopShare",value:function(){var e=this.locusInfo.mediaShares.find(function(e){return e.name===wL.CONTENT});return e?this.meetingRequest.changeMeetingFloor({disposition:wL.FLOOR_ACTION.RELEASED,personUrl:this.locusInfo.self.url,deviceUrl:this.deviceUrl,uri:e.url,resourceUrl:this.resourceUrl}):n.default.reject(new Error("Cannot stop share without content"))}}]),t}(MP.StatelessSparkPlugin);t.default=P});t(SU);var TU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={getClaimPmrLink:function(e){var t=wL.VALID_PMR_ADDRESS.test(e);return t?e:(t=e.match(wL.VALID_PMR_LINK))?t[4]+"@"+t[2]+"."+wL.WEBEX_DOT_COM:null},getClaimPmrPin:function(e){return wL.VALID_PIN.test(e)?e:null},getClaimedRequestParams:function(e,t,r){return{method:wL.POST,api:wL.HECATE,resource:"/"+wL.CMR_MEETINGS+"/"+wL.CLAIM,body:{userId:r.userId,passcode:t,preferred:r.preferred,meetingAddress:e}}}};t.default=r});t(TU);var wU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(_f),n=c(rT),i=c(By),o=c(Yy),a=c(nT),s=c(iT),u=c(TU);function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){var e,r,o,s;(0,i.default)(this,t);for(var u=arguments.length,c=Array(u),l=0;l<u;l++)c[l]=arguments[l];return r=o=(0,a.default)(this,(e=t.__proto__||(0,n.default)(t)).call.apply(e,[this].concat(c))),o.namespace=wL.MEETINGS,s=r,(0,a.default)(o,s)}return(0,s.default)(t,e),(0,o.default)(t,[{key:"claimPmr",value:function(e){if(!(e&&e.userId&&e.passcode&&e.meetingAddress&&e.preferred))throw new Error("Claiming a PMR should be done with userId, passcode, preferred, and meetingAddress in options.");var t=u.default.getClaimPmrPin(e.passcode);if(!t)return r.default.reject(new Error("The host pin provided was of an invalid format"));var n=u.default.getClaimPmrLink(e.meetingAddress);if(!n)return r.default.reject(new Error("The PMR link provided was of an invalid format"));var i=u.default.getClaimedRequestParams(n,t,e);return this.request(i)}}]),t}(MP.StatelessSparkPlugin);t.default=l});t(wU);var OU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(_f),n=l(rT),i=l(By),o=l(Yy),a=l(nT),s=l(iT),u=l(AL),c=l(wU);function l(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e,r){(0,i.default)(this,t);var o=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,{},r));return o.namespace=wL.MEETINGS,o.pmr=null,o.sipUri=null,o.link=null,o.userId=null,o.name=null,o.meetingInfoRequest=new u.default({},r),o.personalMeetingRoomRequest=new c.default({},r),o}return(0,s.default)(t,e),(0,o.default)(t,[{key:"claim",value:function(e,t){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o={userId:this.spark.internal.device.userId,passcode:t,meetingAddress:e,preferred:i};return this.personalMeetingRoomRequest.claimPmr(o).then(function(e){return e&&e.body?(n.set(e.body),e.body):r.default.reject(new Error("No PMR body provided. PMR values not updated."))})}},{key:"set",value:function(e){this.pmr=e,this.sipUri=e.sipMeetingUri,this.meetingLink=e.webExMeetingLink||e.meetingLink,this.userId=e.owner,this.name=e.meetingName,this.number=e.meetingNumber}},{key:"get",value:function(){var e=this,t={type:wL.PERSONAL_ROOM,destination:this.spark.internal.device.userId};return this.meetingInfoRequest.fetchMeetingInfo(t).then(function(t){return t&&t.body&&t.body.isPmr?(e.set(t.body),t.body):r.default.reject(new Error("The PMR requested is NOT a PMR. PMR values not set."))})}}]),t}(MP.StatelessSparkPlugin);t.default=f});t(OU);var kU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=u(Xw),n=u(Cf),i=u(rT),o=u(By),a=u(nT),s=u(iT);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){var e,s,u,c;(0,o.default)(this,t);for(var l=arguments.length,f=Array(l),d=0;d<l;d++)f[d]=arguments[d];return s=u=(0,a.default)(this,(e=t.__proto__||(0,i.default)(t)).call.apply(e,[this].concat(f))),u.getClusters=function(){return u.request({method:wL.GET,shouldRefreshAccessToken:!1,api:wL.API.CALLIOPEDISCOVERY,resource:wL.RESOURCE.CLUSTERS}).then(function(e){var t=e.body.clusters;return console.info("get clusters successful:"+(0,n.default)(t)),(0,r.default)(t)})},u.remoteSDPForClusters=function(e){return u.request({method:wL.POST,shouldRefreshAccessToken:!1,api:wL.API.CALLIOPEDISCOVERY,resource:wL.RESOURCE.REACHABILITY,body:{offers:e}}).then(function(e){return console.info("Remote SDPs got succcessfully"),e.body})},c=s,(0,a.default)(u,c)}return(0,s.default)(t,e),t}(MP.StatelessSparkPlugin);t.default=c});t(kU);var RU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=d(mR),n=d(Xw),i=d(_f),o=d(Cf),a=d(rT),s=d(By),u=d(nT),c=d(iT),l=d(PL),f=d(kU);function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e,c){(0,s.default)(this,t);var d=(0,u.default)(this,(t.__proto__||(0,a.default)(t)).call(this,{},c));return d.namespace=wL.MEETINGS,d.setup=function(){d.processedClusterResults=[],d.peerConnectionMap={}},d.gatherReachability=function(){d.setup();try{return window.localStorage.setItem(wL.REACHABILITY.localStorage,(0,o.default)({})),d.reachabilityRequest.getClusters().then(function(e){return d.performReachabilityCheck(e).then(function(e){return window.localStorage.setItem(wL.REACHABILITY.localStorage,(0,o.default)(e)),e})}).catch(function(e){return console.info("Error in calling getClusters() :"+e),{}})}catch(e){return console.log("There was an error while accessing LocalStorage",e),{}}},d.performReachabilityCheck=function(e){if(!e||!e.length)return i.default.resolve({});var t=[];return new i.default(function(r){d.getLocalSDPForClusters(e).then(function(e){e&&(0,n.default)(e).length&&e.localSDPList&&e.peerConnection||(console.info("Local SDP is empty or has missing elements..returning."),r({})),d.peerConnectionMap=e.peerConnection,t=e.localSDPList,d.setRemoteOfferForEachCluster(t).then(function(e){r(e)})}).catch(function(e){console.error("Error in getLocalSDPForClusters :"+e),r({})})})},d.setRemoteOfferForEachCluster=function(e){var t={};return new i.default(function(r){d.reachabilityRequest.remoteSDPForClusters(e).then(function(e){var n=e.answers;n&&n.length||(console.info("Remote SDP is empty "),d.cleanUpPeerConnections(d.peerConnectionMap),r({})),n.forEach(function(e){var i=e,a=i.clusterId;if(i&&i.sdp){var s=d.peerConnectionMap[a];d.setIceCallBackHandlers(s).then(function(e){if(e.clusterId=a,d.processedClusterResults.push(e.clusterId),t[e.clusterId]={start:e.iceStats.start,stop:e.iceStats.stop},d.processedClusterResults.length===n.length){var i=d.parseIceResultToReachabilityResult(t);console.info("Returning reachability result"+(0,o.default)(i)),r(i)}}).catch(function(e){console.error("Error setIceCallBackHandlers : "+e),d.cleanUpPeerConnections(d.peerConnectionMap),r({})}),l.default.setRemoteSessionDetails(s,wL._ANSWER_,i.sdp)}else console.info(a+" : Error in getting remote sdp :Error  : "),d.processedClusterResults.push(a),d.processedClusterResults.length===n.length&&(d.cleanUpPeerConnections(d.peerConnectionMap),r({}))})}).catch(function(e){console.error("Error in remoteSDPForClusters!:"+e),d.cleanUpPeerConnections(d.peerConnectionMap),r({})})})},d.getLocalSDPForClusters=function(e){var t={},r=[],n={};return new i.default(function(i,o){e.forEach(function(a){var s=a;l.default.createOffer({receiveAudio:!0,receiveVideo:!1}).then(function(o){n[s]=o;var a={sdp:o.sdp,clusterId:s};r.push(a),r.length===e.length&&(t.peerConnection=n,t.localSDPList=r,i(t))}).catch(function(e){o(new Error("Error in getLocalSDP : "+e)),console.error("Error in getLocalSDP : "+e)})})})},d.parseIceResultToReachabilityResult=function(e){if(!e||!(0,n.default)(e).length)return{};var t={},i=!0,o=!1,a=void 0;try{for(var s,u=(0,r.default)((0,n.default)(e));!(i=(s=u.next()).done);i=!0){var c=s.value,l={};if(e[c].start>0&&e[c].stop>0)l={reachable:!0,latencyInMilliseconds:e[c].stop-e[c].start};else l={reachable:!1};t[c]={udp:l}}}catch(e){o=!0,a=e}finally{try{!i&&u.return&&u.return()}finally{if(o)throw a}}return t},d.cleanUpPeerConnections=function(e){var t=!0,i=!1,o=void 0;try{for(var a,s=(0,r.default)((0,n.default)(e));!(t=(a=s.next()).done);t=!0){var u=a.value,c=e[u];c&&(console.info("Cleaning up peer connection created for cluster : "+u),c.close())}}catch(e){i=!0,o=e}finally{try{!t&&s.return&&s.return()}finally{if(i)throw o}}},d.setIceCallBackHandlers=function(e){var t=null,r={start:0,stop:0};return new i.default(function(n){function i(t,r,i){t&&r&&(window.clearTimeout(r),r=void 0),e.close(),n({iceStats:i})}t=window.setTimeout(function(){console.info(d.clusterId+" : onTimer, ice timeout!"),i(!1,t,r)},5e3),e.oniceconnectionstatechange=function(){e&&(e.iceConnectionState===wL.ICE_STATE.CHECKING&&(r.start=Date.now()),e.iceConnectionState===wL.ICE_STATE.CONNECTED&&(r.stop=Date.now(),i(!0,t,r)),e.iceConnectionState===wL.ICE_STATE.FAILED&&i(!1,t,r))}})},d.getClusters=function(){return d.reachabilityRequest.getClusters()},d.reachabilityRequest=new f.default({},c),d}return(0,c.default)(t,e),t}(MP.StatelessSparkPlugin);t.default=p});t(RU);var AU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(zk),n=c(_f),i=c(rT),o=c(By),a=c(Yy),s=c(nT),u=c(iT);function c(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return(0,o.default)(this,t),(0,s.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,a.default)(t,[{key:"getActiveMeetings",value:function(){var e=this;return this.request({api:wL.API.LOCUS,resource:wL.RESOURCE.LOCI}).then(function(t){return e.determineRedirections(t.body)}).catch(function(e){console.error("meeting-adapter: failed to get locus details error: ",e)})}},{key:"determineRedirections",value:function(e){var t=this;return e.remoteLocusClusterUrls&&e.remoteLocusClusterUrls.length?n.default.all(e.remoteLocusClusterUrls.map(function(n){return t.request({method:wL.GET,url:n,runWhitelistedDomains:!0}).then(function(t){var n,i;(n=e.loci).push.apply(n,(0,r.default)(t.body.loci)),(i=e.locusUrls).push.apply(i,(0,r.default)(t.body.locusUrls))}).catch(function(e){console.error("failed to get locus details from: ",n," Reason: ",e)})})).then(function(){return n.default.resolve(e)}):n.default.resolve(e)}}]),t}(MP.StatelessSparkPlugin);t.default=l});t(AU);var IU=function(e,t){if(null==e)return{};var r=Mf(oh(e),function(e){return[e]});return t=$P(t),bR(e,r,function(e,r){return t(e,r[0])})},PU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(By),n=a(Yy),i=a(KP),o=a(IU);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(){(0,r.default)(this,e),this.meetings={}}return(0,n.default)(e,[{key:"get",value:function(e){return this.meetings[e]}},{key:"set",value:function(e){return this.meetings[e.id]=e,this.meetings[e.id]}},{key:"remove",value:function(e){var t=this.meetings[e];return this.meetings[e]=null,delete this.meetings[e],t}},{key:"getAll",value:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{active:!1}).active?(0,o.default)(this.meetings,function(e){return e.active}):this.meetings}},{key:"getByKey",value:function(e,t){return e&&t?(0,i.default)(this.meetings,function(r){return r[e]===t}):null}}]),e}();t.default=s});t(PU);var CU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={extractDestination:function(e,t){var r=e;if(t===wL.LOCUS_ID){if(!e||!e.url)throw new Error("You cannot create a meeting by locus without a locus.url defined");var n=e.url.split("/");r=n[n.length-1]}return r},getMeetingAddedType:function(e){return e===wL.LOCUS_ID?wL.INCOMING:wL.CREATED},handleRoapMercury:function(e,t){var r=e.data;if(r.eventType===wL.LOCUSEVENT.MESSAGE_ROAP){var n=t.getByKey(wL.CORRELATION_ID,r.correlationId);n?n.roap.roapEvent(r):console.error("no meeting associated to roap event")}}};t.default=r});t(CU);var MU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=v(rT),n=v(By),i=v(Yy),o=v(nT),a=v(iT),s=v(TL),u=v(IL),c=v(SU),l=v(OU),f=v(RU),d=v(AU),p=v(PU),h=v(CU);function v(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(){var e;(0,n.default)(this,t);for(var i=arguments.length,a=Array(i),s=0;s<i;s++)a[s]=arguments[s];var c=(0,o.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(a)));return c.namespace=wL.MEETINGS,c.meetingInfo=new u.default({},{parent:c.spark}),c.request=new d.default({},{parent:c.spark}),c.meetingCollection=new p.default,c.personalMeetingRoom=new l.default({},{parent:c.spark}),c.reachability=null,c.onReady(),c}return(0,a.default)(t,e),(0,i.default)(t,[{key:"handleLocusEvent",value:function(e){var t=null;(t=this.meetingCollection.getByKey(wL.LOCUS_URL,e.locusUrl))?t.locusInfo.parse(t,e):this.create(e.locus,wL.LOCUS_ID).then(function(r){e.eventType===wL.LOCUSEVENT.DIFFERENCE?r.locusInfo.initialSetup(e.locus,t):r.locusInfo.initialSetup(e.locus)})}},{key:"handleLocusMercury",value:function(e){var t=e.data,r=t.eventType;r&&r!==wL.LOCUSEVENT.MESSAGE_ROAP&&this.handleLocusEvent(t)}},{key:"listenForEvents",value:function(){var e=this;this.spark.internal.mercury.on(wL.LOCUSEVENT.LOCUS_MERCURY,function(t){e.handleLocusMercury(t)}),this.spark.internal.mercury.on(wL.ROAP.ROAP_MERCURY,function(t){h.default.handleRoapMercury(t,e.meetingCollection)})}},{key:"listenInternal",value:function(){var e=this;s.default.on(wL.EVENTS.DESTROY_MEETING,function(t){e.destroy(t.meeting,t.response,t.type)})}},{key:"onReady",value:function(){var e=this;this.spark.once(wL.READY,function(){e.spark.canAuthorize&&(e.listenForEvents(),e.listenInternal(),e.trigger(wL.EVENT_TRIGGERS.MEETINGS_READY))})}},{key:"setReachability",value:function(){this.reachability=new f.default({},{parent:this.spark})}},{key:"getReachability",value:function(){return this.reachability}},{key:"startReachability",value:function(){this.reachability||this.setReachability(),this.getReachability().gatherReachability()}},{key:"getPersonalMeetingRoom",value:function(){return this.personalMeetingRoom}},{key:"destroy",value:function(e,t,r){if(!e||!e.id)throw new Error("Cannot remove a meeting without an id from the MeetingCollection.");return this.meetingCollection.remove(e.id),this.trigger(wL.EVENT_TRIGGERS.MEETING_REMOVED,{meeting:e,response:t,type:r}),t}},{key:"create",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.createMeeting(e,t)}},{key:"createMeeting",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=new c.default({userId:this.spark.internal.device.userId,deviceUrl:this.spark.internal.device.url,roapSeq:0,locus:r===wL.LOCUS_ID?e:null},{parent:this.spark});return this.meetingCollection.set(n),this.meetingInfo.fetchMeetingInfo(h.default.extractDestination(e,r),r).then(function(e){return n.parseMeetingInfo(e),n.meetingInfo=e,n}).catch(function(e){return console.error(e),n}).finally(function(){n.sipUri||n.setSipUri(e);var i=h.default.getMeetingAddedType(r);t.trigger(wL.EVENT_TRIGGERS.MEETING_ADDED,{meeting:n,type:i})})}},{key:"getMeetingByType",value:function(e,t){return this.meetingCollection.getByKey(e,t)}},{key:"getAllMeetings",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.meetingCollection.getAll(e)}},{key:"syncMeetings",value:function(){var e=this;return this.request.getActiveMeetings().then(function(t){t.loci&&t.loci.length>0&&t.loci.forEach(function(t){var r=e.meetingCollection.getByKey(wL.LOCUS_URL,t.url);r?r.locusInfo.onFullLocus(t):e.create(t,wL.LOCUS_ID).then(function(e){e.locusInfo.initialSetup(t)})})})}},{key:"getScheduledMeetings",value:function(){return this.meetingCollection.getAll({scheduled:!0})}}]),t}(MP.SparkPlugin);t.default=g});t(MU);var NU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={meetings:{mediaSettings:{sendAudio:!0,sendVideo:!0,receiveAudio:!0,receiveVideo:!0,pstn:!1,sendShare:!1,receiveShare:!1},reconnection:{enabled:!0,detection:!0,retry:{times:2,backOff:{start:1e3,rate:2}}}}}});t(NU),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(MU),n=i(NU);function i(e){return e&&e.__esModule?e:{default:e}}(0,MP.registerPlugin)("meetings",r.default,{config:n.default}),t.default=r.default}));var DU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(Bk),n=o(cc),i=o(vp);function o(e){return e&&e.__esModule?e:{default:e}}var a=MP.SparkPlugin.extend({create:function(e){var t="body";e.file&&(this.logger.warn("Supplying a single `file` property is deprecated; please supply a `files` array"),e.files=[e.file],(0,n.default)(e,"file")),(0,i.default)(e.files)&&e.files.reduce(function(e,t){return e||"string"!=typeof t},!1)&&(t="formData");var o=(0,r.default)({method:"POST",service:"hydra",resource:"messages"},t,e);return this.request(o).then(function(e){return e.body})},get:function(e){var t=e.id||e;return this.request({service:"hydra",resource:"messages/"+t}).then(function(e){return e.body.items||e.body})},list:function(e){var t=this;return this.request({service:"hydra",resource:"messages",qs:e}).then(function(e){return new MP.Page(e,t.spark)})},remove:function(e){var t=e.id||e;return this.request({method:"DELETE",service:"hydra",resource:"messages/"+t}).then(function(e){if(204!==e.statusCode)return e.body})},version:"1.50.6"});t.default=a});t(DU),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=DU)&&r.__esModule?r:{default:r};(0,MP.registerPlugin)("messages",n.default),t.default=n.default}));var jU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=MP.SparkPlugin.extend({create:function(e){return this.request({method:"POST",service:"hydra",resource:"memberships",body:e}).then(function(e){return e.body})},get:function(e){var t=e.id||e;return this.request({service:"hydra",resource:"memberships/"+t}).then(function(e){return e.body.items||e.body})},list:function(e){var t=this;return this.request({service:"hydra",resource:"memberships",qs:e}).then(function(e){return new MP.Page(e,t.spark)})},remove:function(e){var t=e.id||e;return this.request({method:"DELETE",service:"hydra",resource:"memberships/"+t}).then(function(e){if(204!==e.statusCode)return e.body})},update:function(e){var t=e.id||e;return this.request({method:"PUT",service:"hydra",resource:"memberships/"+t,body:e}).then(function(e){return e.body})},version:"1.50.6"});t.default=r});t(jU),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=jU)&&r.__esModule?r:{default:r};(0,MP.registerPlugin)("memberships",n.default),t.default=n.default}));var xU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=MP.SparkPlugin.extend({create:function(e){return this.request({method:"POST",service:"hydra",resource:"rooms",body:e}).then(function(e){return e.body})},get:function(e,t){var r=e.id||e;return this.request({service:"hydra",resource:"rooms/"+r,qs:t}).then(function(e){return e.body.items||e.body})},list:function(e){var t=this;return this.request({service:"hydra",resource:"rooms/",qs:e}).then(function(e){return new MP.Page(e,t.spark)})},remove:function(e){var t=e.id||e;return this.request({method:"DELETE",service:"hydra",resource:"rooms/"+t}).then(function(e){if(204!==e.statusCode)return e.body})},update:function(e){var t=e.id;return this.request({method:"PUT",service:"hydra",resource:"rooms/"+t,body:e}).then(function(e){return e.body})},version:"1.50.6"});t.default=r});t(xU),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=xU)&&r.__esModule?r:{default:r};(0,MP.registerPlugin)("rooms",n.default),t.default=n.default}));var LU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=MP.SparkPlugin.extend({create:function(e){return this.request({method:"POST",service:"hydra",resource:"teams",body:e}).then(function(e){return e.body})},get:function(e,t){var r=e.id||e;return this.request({service:"hydra",resource:"teams/"+r,qs:t}).then(function(e){return e.body.items||e.body})},list:function(e){var t=this;return this.request({service:"hydra",resource:"teams/",qs:e}).then(function(e){return new MP.Page(e,t.spark)})},update:function(e){var t=e.id;return this.request({method:"PUT",service:"hydra",resource:"teams/"+t,body:e}).then(function(e){return e.body})},version:"1.50.6"});t.default=r});t(LU),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=LU)&&r.__esModule?r:{default:r};(0,MP.registerPlugin)("teams",n.default),t.default=n.default}));var UU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=MP.SparkPlugin.extend({create:function(e){return this.request({method:"POST",service:"hydra",resource:"team/memberships",body:e}).then(function(e){return e.body})},get:function(e){var t=e.id||e;return this.request({service:"hydra",resource:"team/memberships/"+t}).then(function(e){return e.body.items||e.body})},list:function(e){var t=this;return this.request({service:"hydra",resource:"team/memberships",qs:e}).then(function(e){return new MP.Page(e,t.spark)})},remove:function(e){var t=e.id||e;return this.request({method:"DELETE",service:"hydra",resource:"team/memberships/"+t}).then(function(e){if(204!==e.statusCode)return e.body})},update:function(e){var t=e.id||e;return this.request({method:"PUT",service:"hydra",resource:"team/memberships/"+t,body:e}).then(function(e){return e.body})},version:"1.50.6"});t.default=r});t(UU),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=UU)&&r.__esModule?r:{default:r};(0,MP.registerPlugin)("teamMemberships",n.default),t.default=n.default}));var FU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=MP.SparkPlugin.extend({create:function(e){return this.request({method:"POST",service:"hydra",resource:"webhooks",body:e}).then(function(e){return e.body})},get:function(e){var t=e.id||e;return this.request({service:"hydra",resource:"webhooks/"+t}).then(function(e){return e.body.items||e.body})},list:function(e){var t=this;return this.request({service:"hydra",resource:"webhooks/",qs:e}).then(function(e){return new MP.Page(e,t.spark)})},remove:function(e){var t=e.id||e;return this.request({method:"DELETE",service:"hydra",resource:"webhooks/"+t}).then(function(e){if(204!==e.statusCode)return e.body})},update:function(e){var t=e.id;return this.request({method:"PUT",service:"hydra",resource:"webhooks/"+t,body:e}).then(function(e){return e.body})},version:"1.50.6"});t.default=r});t(FU),t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=FU)&&r.__esModule?r:{default:r};(0,MP.registerPlugin)("webhooks",n.default),t.default=n.default}));var GU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(cc),n=u(_f),i=u(Cf),o=u(By),a=u(Yy),s=u(h_);function u(e){return e&&e.__esModule?e:{default:e}}var c=new s.default,l=new s.default,f=function(){function e(t){(0,o.default)(this,e),this.Bound=function(){function e(t,r){(0,o.default)(this,e),c.set(this,t),l.set(this,r.logger)}return(0,a.default)(e,[{key:"_getRawData",value:function(){var e=localStorage.getItem(t);return e?JSON.parse(e):{}}},{key:"_load",value:function(){return this._getRawData()[c.get(this)]||{}}},{key:"_save",value:function(e){var r=this._getRawData();r[c.get(this)]=e,localStorage.setItem(t,(0,i.default)(r))}},{key:"clear",value:function(){return l.get(this).info("local-storage-store-adapter: clearing localStorage"),n.default.resolve(localStorage.removeItem(t))}},{key:"del",value:function(e){var t=this;return new n.default(function(n){l.get(t).info("local-storage-store-adapter: deleting `"+e+"`");var i=t._load();(0,r.default)(i,e),t._save(i),n()})}},{key:"get",value:function(e){var t=this;return new n.default(function(r,n){l.get(t).info("local-storage-store-adapter: reading `"+e+"`");var i=t._load()[e];return void 0!==i?r(i):n(new MP.NotFoundError("No value found for "+e))})}},{key:"put",value:function(e,t){var r=this;return new n.default(function(n){l.get(r).info("local-storage-store-adapter: writing `"+e+"`");var i=r._load();i[e]=t,r._save(i),n()})}}]),e}()}return(0,a.default)(e,[{key:"bind",value:function(e,t){return t=t||{},e?t.logger?(t.logger.info("local-storage-store-adapter: returning binding"),n.default.resolve(new this.Bound(e,t))):n.default.reject(new Error("`options.logger` is required")):n.default.reject(new Error("`namespace` is required"))}}]),e}();t.default=f});t(GU);var qU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=GU)&&r.__esModule?r:{default:r};t.default={boundedAdapter:new n.default("ciscospark"),unboundedAdapter:MP.MemoryStoreAdapter}});t(qU);var VU=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=(r=qU)&&r.__esModule?r:{default:r};t.default={hydra:ku.env.HYDRA_SERVICE_URL||"https://api.ciscospark.com/v1",hydraServiceUrl:ku.env.HYDRA_SERVICE_URL||"https://api.ciscospark.com/v1",credentials:{clientType:"confidential"},device:{ephemeral:!0},storage:n.default}});t(VU);var BU=MP.default.extend({ciscospark:!0,version:"1.50.6"});BU.version="1.50.6",BU.init=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.config=KI({},VU,e.config),new BU(e)};var zU=BU;e._babelPolyfill;var WU=zU;return window.ciscospark=WU}();
