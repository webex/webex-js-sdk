import {EMBEDDED_APP_TYPES} from '../constants';

const EmbeddedAppsUtils = {};

const SLIDO_REGEX = /.sli.do\//;

/**
 * Parse the relevant values that we care about
 * @param {Object} embeddedApp - raw embedded app obejct
 * @returns {Object} parsedObject - parsed embedded app object
 */
EmbeddedAppsUtils.parseApp = (embeddedApp) => {
  const parsedApp = {...embeddedApp};

  parsedApp.type = EMBEDDED_APP_TYPES.OTHER;
  const url = parsedApp.instanceInfo?.appInstanceUrl;

  if (url && url.match(SLIDO_REGEX)) {
    parsedApp.type = EMBEDDED_APP_TYPES.SLIDO;
  }

  return parsedApp;
};

/**
 * Parse the array of embedded apps
 * @param {array} embeddedApps
 * @returns {array} result - new array of parsed embedded app objects
 */
EmbeddedAppsUtils.parse = (embeddedApps) => embeddedApps && embeddedApps.map(EmbeddedAppsUtils.parseApp);


export default EmbeddedAppsUtils;
