/*!
 * Copyright (c) 2015-2019 Cisco Systems, Inc. See LICENSE file.
 */

import {assert} from '@webex/test-helper-chai';
import sinon from 'sinon';
import WebexCore from '@webex/webex-core';
import testUsers from '@webex/test-helper-test-users';

describe('http-core', () => {
  describe('interceptor', () => {
    let webex;

    before('create users', () => Promise.all([
      testUsers.create({count: 1})
    ])
      .then(([user]) => new Promise((resolve) => {
        setTimeout(() => {
          webex = new WebexCore({credentials: {supertoken: user.token}});
          resolve();
        }, 3000);
      })));

    describe('logOptions', () => {
      it('calls logger plugin', () => {
        const spy = sinon.spy(webex.logger, 'info');

        return webex.request({
          service: 'hydra',
          resource: 'people/me'
        }).then(() => {
          assert.called(spy);
        }).catch(() => {
          assert.called(spy);
        });
      });
    });
  });
});
