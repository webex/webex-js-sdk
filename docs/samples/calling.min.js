/*! Webex JS SDK v2.52.12 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Webex=t():e.Webex=t()}(self,(()=>(()=>{var e={50176:(e,t,n)=>{n(79169),n(63090),e.exports=n(63093).Array.from},70964:(e,t,n)=>{n(48901),e.exports=n(63093).Array.isArray},76216:(e,t,n)=>{n(78175),e.exports=n(63093).Date.now},23565:(e,t,n)=>{var r=n(63093),i=r.JSON||(r.JSON={stringify:JSON.stringify});e.exports=function(e){return i.stringify.apply(i,arguments)}},94175:(e,t,n)=>{n(56536),n(79169),n(39361),n(99228),n(90401),n(28878),n(33012),e.exports=n(63093).Map},68080:(e,t,n)=>{n(57044),e.exports=n(63093).Number.isNaN},7153:(e,t,n)=>{n(73274),e.exports=n(63093).Number.parseInt},68207:(e,t,n)=>{n(82464),e.exports=n(63093).Object.assign},25380:(e,t,n)=>{n(97660);var r=n(63093).Object;e.exports=function(e,t){return r.create(e,t)}},99848:(e,t,n)=>{n(84521);var r=n(63093).Object;e.exports=function(e,t){return r.defineProperties(e,t)}},82624:(e,t,n)=>{n(15356);var r=n(63093).Object;e.exports=function(e,t,n){return r.defineProperty(e,t,n)}},88058:(e,t,n)=>{n(39827),e.exports=n(63093).Object.entries},36759:(e,t,n)=>{n(8638),e.exports=n(63093).Object.freeze},44221:(e,t,n)=>{n(52812);var r=n(63093).Object;e.exports=function(e,t){return r.getOwnPropertyDescriptor(e,t)}},22991:(e,t,n)=>{n(40342),e.exports=n(63093).Object.getOwnPropertyDescriptors},65162:(e,t,n)=>{n(13418);var r=n(63093).Object;e.exports=function(e){return r.getOwnPropertyNames(e)}},72818:(e,t,n)=>{n(15898),e.exports=n(63093).Object.getOwnPropertySymbols},87595:(e,t,n)=>{n(92810),e.exports=n(63093).Object.getPrototypeOf},15297:(e,t,n)=>{n(5338),e.exports=n(63093).Object.keys},21900:(e,t,n)=>{n(99269),e.exports=n(63093).Object.setPrototypeOf},42837:(e,t,n)=>{n(73625),e.exports=n(63093).Object.values},97186:(e,t,n)=>{n(55),e.exports=n(63093).parseFloat},16111:(e,t,n)=>{n(68785),e.exports=n(63093).parseInt},89448:(e,t,n)=>{n(56536),n(79169),n(39361),n(63723),n(36556),n(8421),e.exports=n(63093).Promise},58564:(e,t,n)=>{n(41896),e.exports=n(63093).Reflect.apply},98401:(e,t,n)=>{n(90634),e.exports=n(63093).Reflect.construct},42437:(e,t,n)=>{n(69805),e.exports=n(63093).Reflect.get},19414:(e,t,n)=>{n(44562),e.exports=n(63093).Reflect.ownKeys},98828:(e,t,n)=>{n(56536),n(79169),n(39361),n(6348),n(30093),n(42235),n(68572),e.exports=n(63093).Set},71922:(e,t,n)=>{n(15898),n(56536),n(52145),n(74775),e.exports=n(63093).Symbol},72974:(e,t,n)=>{n(79169),n(39361),e.exports=n(33485).f("iterator")},90446:(e,t,n)=>{e.exports=n(33485).f("toPrimitive")},53868:(e,t,n)=>{n(56536),e.exports=n(33485).f("toStringTag")},69488:(e,t,n)=>{n(56536),n(39361),n(11610),n(91877),n(20206),e.exports=n(63093).WeakMap},18679:e=>{e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},86687:e=>{e.exports=function(){}},8003:e=>{e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},49226:(e,t,n)=>{var r=n(44425);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},51705:(e,t,n)=>{var r=n(26510);e.exports=function(e,t){var n=[];return r(e,!1,n.push,n,t),n}},43206:(e,t,n)=>{var r=n(6303),i=n(45321),o=n(10139);e.exports=function(e){return function(t,n,a){var s,c=r(t),u=i(c.length),d=o(a,u);if(e&&n!=n){for(;u>d;)if((s=c[d++])!=s)return!0}else for(;u>d;d++)if((e||d in c)&&c[d]===n)return e||d||0;return!e&&-1}}},18485:(e,t,n)=>{var r=n(31133),i=n(65474),o=n(54922),a=n(45321),s=n(243);e.exports=function(e,t){var n=1==e,c=2==e,u=3==e,d=4==e,l=6==e,f=5==e||l,p=t||s;return function(t,s,h){for(var v,m,g=o(t),E=i(g),y=r(s,h,3),S=a(E.length),_=0,C=n?p(t,S):c?p(t,0):void 0;S>_;_++)if((f||_ in E)&&(m=y(v=E[_],_,g),e))if(n)C[_]=m;else if(m)switch(e){case 3:return!0;case 5:return v;case 6:return _;case 2:C.push(v)}else if(d)return!1;return l?-1:u||d?d:C}}},33723:(e,t,n)=>{var r=n(44425),i=n(35730),o=n(23032)("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),r(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},243:(e,t,n)=>{var r=n(33723);e.exports=function(e,t){return new(r(e))(t)}},98659:(e,t,n)=>{"use strict";var r=n(18679),i=n(44425),o=n(44990),a=[].slice,s={},c=function(e,t,n){if(!(t in s)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";s[t]=Function("F,a","return new F("+r.join(",")+")")}return s[t](e,n)};e.exports=Function.bind||function(e){var t=r(this),n=a.call(arguments,1),s=function(){var r=n.concat(a.call(arguments));return this instanceof s?c(t,r.length,r):o(t,r,e)};return i(t.prototype)&&(s.prototype=t.prototype),s}},85158:(e,t,n)=>{var r=n(47489),i=n(23032)("toStringTag"),o="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?n:o?r(t):"Object"==(a=r(t))&&"function"==typeof t.callee?"Arguments":a}},47489:e=>{var t={}.toString;e.exports=function(e){return t.call(e).slice(8,-1)}},21706:(e,t,n)=>{"use strict";var r=n(56007).f,i=n(69270),o=n(561),a=n(31133),s=n(8003),c=n(26510),u=n(60354),d=n(85490),l=n(7183),f=n(97305),p=n(57010).fastKey,h=n(10069),v=f?"_s":"size",m=function(e,t){var n,r=p(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,u){var d=e((function(e,r){s(e,d,t,"_i"),e._t=t,e._i=i(null),e._f=void 0,e._l=void 0,e[v]=0,null!=r&&c(r,n,e[u],e)}));return o(d.prototype,{clear:function(){for(var e=h(this,t),n=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];e._f=e._l=void 0,e[v]=0},delete:function(e){var n=h(this,t),r=m(n,e);if(r){var i=r.n,o=r.p;delete n._i[r.i],r.r=!0,o&&(o.n=i),i&&(i.p=o),n._f==r&&(n._f=i),n._l==r&&(n._l=o),n[v]--}return!!r},forEach:function(e){h(this,t);for(var n,r=a(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!m(h(this,t),e)}}),f&&r(d.prototype,"size",{get:function(){return h(this,t)[v]}}),d},def:function(e,t,n){var r,i,o=m(e,t);return o?o.v=n:(e._l=o={i:i=p(t,!0),k:t,v:n,p:r=e._l,n:void 0,r:!1},e._f||(e._f=o),r&&(r.n=o),e[v]++,"F"!==i&&(e._i[i]=o)),e},getEntry:m,setStrong:function(e,t,n){u(e,t,(function(e,n){this._t=h(e,t),this._k=n,this._l=void 0}),(function(){for(var e=this,t=e._k,n=e._l;n&&n.r;)n=n.p;return e._t&&(e._l=n=n?n.n:e._t._f)?d(0,"keys"==t?n.k:"values"==t?n.v:[n.k,n.v]):(e._t=void 0,d(1))}),n?"entries":"values",!n,!0),l(t)}}},80540:(e,t,n)=>{var r=n(85158),i=n(51705);e.exports=function(e){return function(){if(r(this)!=e)throw TypeError(e+"#toJSON isn't generic");return i(this)}}},77760:(e,t,n)=>{"use strict";var r=n(561),i=n(57010).getWeak,o=n(49226),a=n(44425),s=n(8003),c=n(26510),u=n(18485),d=n(3920),l=n(10069),f=u(5),p=u(6),h=0,v=function(e){return e._l||(e._l=new m)},m=function(){this.a=[]},g=function(e,t){return f(e.a,(function(e){return e[0]===t}))};m.prototype={get:function(e){var t=g(this,e);if(t)return t[1]},has:function(e){return!!g(this,e)},set:function(e,t){var n=g(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(e){var t=p(this.a,(function(t){return t[0]===e}));return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,n,o){var u=e((function(e,r){s(e,u,t,"_i"),e._t=t,e._i=h++,e._l=void 0,null!=r&&c(r,n,e[o],e)}));return r(u.prototype,{delete:function(e){if(!a(e))return!1;var n=i(e);return!0===n?v(l(this,t)).delete(e):n&&d(n,this._i)&&delete n[this._i]},has:function(e){if(!a(e))return!1;var n=i(e);return!0===n?v(l(this,t)).has(e):n&&d(n,this._i)}}),u},def:function(e,t,n){var r=i(o(t),!0);return!0===r?v(e).set(t,n):r[e._i]=n,e},ufstore:v}},66924:(e,t,n)=>{"use strict";var r=n(3220),i=n(14518),o=n(57010),a=n(84930),s=n(44379),c=n(561),u=n(26510),d=n(8003),l=n(44425),f=n(8182),p=n(56007).f,h=n(18485)(0),v=n(97305);e.exports=function(e,t,n,m,g,E){var y=r[e],S=y,_=g?"set":"add",C=S&&S.prototype,R={};return v&&"function"==typeof S&&(E||C.forEach&&!a((function(){(new S).entries().next()})))?(S=t((function(t,n){d(t,S,e,"_c"),t._c=new y,null!=n&&u(n,g,t[_],t)})),h("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),(function(e){var t="add"==e||"set"==e;!(e in C)||E&&"clear"==e||s(S.prototype,e,(function(n,r){if(d(this,S,e),!t&&E&&!l(n))return"get"==e&&void 0;var i=this._c[e](0===n?0:n,r);return t?this:i}))})),E||p(S.prototype,"size",{get:function(){return this._c.size}})):(S=m.getConstructor(t,e,g,_),c(S.prototype,n),o.NEED=!0),f(S,e),R[e]=S,i(i.G+i.W+i.F,R),E||m.setStrong(S,e,g),S}},63093:e=>{var t=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=t)},10101:(e,t,n)=>{"use strict";var r=n(56007),i=n(35831);e.exports=function(e,t,n){t in e?r.f(e,t,i(0,n)):e[t]=n}},31133:(e,t,n)=>{var r=n(18679);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},59359:e=>{e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},97305:(e,t,n)=>{e.exports=!n(84930)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},3299:(e,t,n)=>{var r=n(44425),i=n(3220).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},75834:e=>{e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},94331:(e,t,n)=>{var r=n(31304),i=n(18382),o=n(55066);e.exports=function(e){var t=r(e),n=i.f;if(n)for(var a,s=n(e),c=o.f,u=0;s.length>u;)c.call(e,a=s[u++])&&t.push(a);return t}},14518:(e,t,n)=>{var r=n(3220),i=n(63093),o=n(31133),a=n(44379),s=n(3920),c="prototype",u=function(e,t,n){var d,l,f,p=e&u.F,h=e&u.G,v=e&u.S,m=e&u.P,g=e&u.B,E=e&u.W,y=h?i:i[t]||(i[t]={}),S=y[c],_=h?r:v?r[t]:(r[t]||{})[c];for(d in h&&(n=t),n)(l=!p&&_&&void 0!==_[d])&&s(y,d)||(f=l?_[d]:n[d],y[d]=h&&"function"!=typeof _[d]?n[d]:g&&l?o(f,r):E&&_[d]==f?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t[c]=e[c],t}(f):m&&"function"==typeof f?o(Function.call,f):f,m&&((y.virtual||(y.virtual={}))[d]=f,e&u.R&&S&&!S[d]&&a(S,d,f)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},84930:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},26510:(e,t,n)=>{var r=n(31133),i=n(12441),o=n(92566),a=n(49226),s=n(45321),c=n(25816),u={},d={},l=e.exports=function(e,t,n,l,f){var p,h,v,m,g=f?function(){return e}:c(e),E=r(n,l,t?2:1),y=0;if("function"!=typeof g)throw TypeError(e+" is not iterable!");if(o(g)){for(p=s(e.length);p>y;y++)if((m=t?E(a(h=e[y])[0],h[1]):E(e[y]))===u||m===d)return m}else for(v=g.call(e);!(h=v.next()).done;)if((m=i(v,E,h.value,t))===u||m===d)return m};l.BREAK=u,l.RETURN=d},3220:e=>{var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)},3920:e=>{var t={}.hasOwnProperty;e.exports=function(e,n){return t.call(e,n)}},44379:(e,t,n)=>{var r=n(56007),i=n(35831);e.exports=n(97305)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},588:(e,t,n)=>{var r=n(3220).document;e.exports=r&&r.documentElement},17209:(e,t,n)=>{e.exports=!n(97305)&&!n(84930)((function(){return 7!=Object.defineProperty(n(3299)("div"),"a",{get:function(){return 7}}).a}))},44990:e=>{e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},65474:(e,t,n)=>{var r=n(47489);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},92566:(e,t,n)=>{var r=n(64502),i=n(23032)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[i]===e)}},35730:(e,t,n)=>{var r=n(47489);e.exports=Array.isArray||function(e){return"Array"==r(e)}},44425:e=>{e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},12441:(e,t,n)=>{var r=n(49226);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&r(o.call(e)),t}}},95415:(e,t,n)=>{"use strict";var r=n(69270),i=n(35831),o=n(8182),a={};n(44379)(a,n(23032)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(a,{next:i(1,n)}),o(e,t+" Iterator")}},60354:(e,t,n)=>{"use strict";var r=n(34436),i=n(14518),o=n(29763),a=n(44379),s=n(64502),c=n(95415),u=n(8182),d=n(65194),l=n(23032)("iterator"),f=!([].keys&&"next"in[].keys()),p="keys",h="values",v=function(){return this};e.exports=function(e,t,n,m,g,E,y){c(n,t,m);var S,_,C,R=function(e){if(!f&&e in w)return w[e];switch(e){case p:case h:return function(){return new n(this,e)}}return function(){return new n(this,e)}},T=t+" Iterator",x=g==h,b=!1,w=e.prototype,I=w[l]||w["@@iterator"]||g&&w[g],L=I||R(g),O=g?x?R("entries"):L:void 0,A="Array"==t&&w.entries||I;if(A&&(C=d(A.call(new e)))!==Object.prototype&&C.next&&(u(C,T,!0),r||"function"==typeof C[l]||a(C,l,v)),x&&I&&I.name!==h&&(b=!0,L=function(){return I.call(this)}),r&&!y||!f&&!b&&w[l]||a(w,l,L),s[t]=L,s[T]=v,g)if(S={values:x?L:R(h),keys:E?L:R(p),entries:O},y)for(_ in S)_ in w||o(w,_,S[_]);else i(i.P+i.F*(f||b),t,S);return S}},98661:(e,t,n)=>{var r=n(23032)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o=[7],a=o[r]();a.next=function(){return{done:n=!0}},o[r]=function(){return a},e(o)}catch(e){}return n}},85490:e=>{e.exports=function(e,t){return{value:t,done:!!e}}},64502:e=>{e.exports={}},34436:e=>{e.exports=!0},57010:(e,t,n)=>{var r=n(46918)("meta"),i=n(44425),o=n(3920),a=n(56007).f,s=0,c=Object.isExtensible||function(){return!0},u=!n(84930)((function(){return c(Object.preventExtensions({}))})),d=function(e){a(e,r,{value:{i:"O"+ ++s,w:{}}})},l=e.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,r)){if(!c(e))return"F";if(!t)return"E";d(e)}return e[r].i},getWeak:function(e,t){if(!o(e,r)){if(!c(e))return!0;if(!t)return!1;d(e)}return e[r].w},onFreeze:function(e){return u&&l.NEED&&c(e)&&!o(e,r)&&d(e),e}}},9734:(e,t,n)=>{var r=n(3220),i=n(26998).set,o=r.MutationObserver||r.WebKitMutationObserver,a=r.process,s=r.Promise,c="process"==n(47489)(a);e.exports=function(){var e,t,n,u=function(){var r,i;for(c&&(r=a.domain)&&r.exit();e;){i=e.fn,e=e.next;try{i()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(c)n=function(){a.nextTick(u)};else if(!o||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var d=s.resolve(void 0);n=function(){d.then(u)}}else n=function(){i.call(r,u)};else{var l=!0,f=document.createTextNode("");new o(u).observe(f,{characterData:!0}),n=function(){f.data=l=!l}}return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}}},36253:(e,t,n)=>{"use strict";var r=n(18679);function i(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)}e.exports.f=function(e){return new i(e)}},47382:(e,t,n)=>{"use strict";var r=n(97305),i=n(31304),o=n(18382),a=n(55066),s=n(54922),c=n(65474),u=Object.assign;e.exports=!u||n(84930)((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=u({},e)[n]||Object.keys(u({},t)).join("")!=r}))?function(e,t){for(var n=s(e),u=arguments.length,d=1,l=o.f,f=a.f;u>d;)for(var p,h=c(arguments[d++]),v=l?i(h).concat(l(h)):i(h),m=v.length,g=0;m>g;)p=v[g++],r&&!f.call(h,p)||(n[p]=h[p]);return n}:u},69270:(e,t,n)=>{var r=n(49226),i=n(16287),o=n(75834),a=n(72596)("IE_PROTO"),s=function(){},c="prototype",u=function(){var e,t=n(3299)("iframe"),r=o.length;for(t.style.display="none",n(588).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),u=e.F;r--;)delete u[c][o[r]];return u()};e.exports=Object.create||function(e,t){var n;return null!==e?(s[c]=r(e),n=new s,s[c]=null,n[a]=e):n=u(),void 0===t?n:i(n,t)}},56007:(e,t,n)=>{var r=n(49226),i=n(17209),o=n(32548),a=Object.defineProperty;t.f=n(97305)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},16287:(e,t,n)=>{var r=n(56007),i=n(49226),o=n(31304);e.exports=n(97305)?Object.defineProperties:function(e,t){i(e);for(var n,a=o(t),s=a.length,c=0;s>c;)r.f(e,n=a[c++],t[n]);return e}},30826:(e,t,n)=>{var r=n(55066),i=n(35831),o=n(6303),a=n(32548),s=n(3920),c=n(17209),u=Object.getOwnPropertyDescriptor;t.f=n(97305)?u:function(e,t){if(e=o(e),t=a(t,!0),c)try{return u(e,t)}catch(e){}if(s(e,t))return i(!r.f.call(e,t),e[t])}},23208:(e,t,n)=>{var r=n(6303),i=n(95733).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"[object Window]"==o.call(e)?function(e){try{return i(e)}catch(e){return a.slice()}}(e):i(r(e))}},95733:(e,t,n)=>{var r=n(26567),i=n(75834).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},18382:(e,t)=>{t.f=Object.getOwnPropertySymbols},65194:(e,t,n)=>{var r=n(3920),i=n(54922),o=n(72596)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},26567:(e,t,n)=>{var r=n(3920),i=n(6303),o=n(43206)(!1),a=n(72596)("IE_PROTO");e.exports=function(e,t){var n,s=i(e),c=0,u=[];for(n in s)n!=a&&r(s,n)&&u.push(n);for(;t.length>c;)r(s,n=t[c++])&&(~o(u,n)||u.push(n));return u}},31304:(e,t,n)=>{var r=n(26567),i=n(75834);e.exports=Object.keys||function(e){return r(e,i)}},55066:(e,t)=>{t.f={}.propertyIsEnumerable},70874:(e,t,n)=>{var r=n(14518),i=n(63093),o=n(84930);e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],a={};a[e]=t(n),r(r.S+r.F*o((function(){n(1)})),"Object",a)}},30572:(e,t,n)=>{var r=n(97305),i=n(31304),o=n(6303),a=n(55066).f;e.exports=function(e){return function(t){for(var n,s=o(t),c=i(s),u=c.length,d=0,l=[];u>d;)n=c[d++],r&&!a.call(s,n)||l.push(e?[n,s[n]]:s[n]);return l}}},74737:(e,t,n)=>{var r=n(95733),i=n(18382),o=n(49226),a=n(3220).Reflect;e.exports=a&&a.ownKeys||function(e){var t=r.f(o(e)),n=i.f;return n?t.concat(n(e)):t}},23080:(e,t,n)=>{var r=n(3220).parseFloat,i=n(28685).trim;e.exports=1/r(n(58917)+"-0")!=-1/0?function(e){var t=i(String(e),3),n=r(t);return 0===n&&"-"==t.charAt(0)?-0:n}:r},24049:(e,t,n)=>{var r=n(3220).parseInt,i=n(28685).trim,o=n(58917),a=/^[-+]?0[xX]/;e.exports=8!==r(o+"08")||22!==r(o+"0x16")?function(e,t){var n=i(String(e),3);return r(n,t>>>0||(a.test(n)?16:10))}:r},19934:e=>{e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},77116:(e,t,n)=>{var r=n(49226),i=n(44425),o=n(36253);e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},35831:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},561:(e,t,n)=>{var r=n(44379);e.exports=function(e,t,n){for(var i in t)n&&e[i]?e[i]=t[i]:r(e,i,t[i]);return e}},29763:(e,t,n)=>{e.exports=n(44379)},74573:(e,t,n)=>{"use strict";var r=n(14518),i=n(18679),o=n(31133),a=n(26510);e.exports=function(e){r(r.S,e,{from:function(e){var t,n,r,s,c=arguments[1];return i(this),(t=void 0!==c)&&i(c),null==e?new this:(n=[],t?(r=0,s=o(c,arguments[2],2),a(e,!1,(function(e){n.push(s(e,r++))}))):a(e,!1,n.push,n),new this(n))}})}},72758:(e,t,n)=>{"use strict";var r=n(14518);e.exports=function(e){r(r.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},96573:(e,t,n)=>{var r=n(44425),i=n(49226),o=function(e,t){if(i(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=n(31133)(Function.call,n(30826).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return o(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:o}},7183:(e,t,n)=>{"use strict";var r=n(3220),i=n(63093),o=n(56007),a=n(97305),s=n(23032)("species");e.exports=function(e){var t="function"==typeof i[e]?i[e]:r[e];a&&t&&!t[s]&&o.f(t,s,{configurable:!0,get:function(){return this}})}},8182:(e,t,n)=>{var r=n(56007).f,i=n(3920),o=n(23032)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},72596:(e,t,n)=>{var r=n(5628)("keys"),i=n(46918);e.exports=function(e){return r[e]||(r[e]=i(e))}},5628:(e,t,n)=>{var r=n(63093),i=n(3220),o="__core-js_shared__",a=i[o]||(i[o]={});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(34436)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},312:(e,t,n)=>{var r=n(49226),i=n(18679),o=n(23032)("species");e.exports=function(e,t){var n,a=r(e).constructor;return void 0===a||null==(n=r(a)[o])?t:i(n)}},87268:(e,t,n)=>{var r=n(72579),i=n(59359);e.exports=function(e){return function(t,n){var o,a,s=String(i(t)),c=r(n),u=s.length;return c<0||c>=u?e?"":void 0:(o=s.charCodeAt(c))<55296||o>56319||c+1===u||(a=s.charCodeAt(c+1))<56320||a>57343?e?s.charAt(c):o:e?s.slice(c,c+2):a-56320+(o-55296<<10)+65536}}},28685:(e,t,n)=>{var r=n(14518),i=n(59359),o=n(84930),a=n(58917),s="["+a+"]",c=RegExp("^"+s+s+"*"),u=RegExp(s+s+"*$"),d=function(e,t,n){var i={},s=o((function(){return!!a[e]()||"​"!="​"[e]()})),c=i[e]=s?t(l):a[e];n&&(i[n]=c),r(r.P+r.F*s,"String",i)},l=d.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(u,"")),e};e.exports=d},58917:e=>{e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},26998:(e,t,n)=>{var r,i,o,a=n(31133),s=n(44990),c=n(588),u=n(3299),d=n(3220),l=d.process,f=d.setImmediate,p=d.clearImmediate,h=d.MessageChannel,v=d.Dispatch,m=0,g={},E="onreadystatechange",y=function(){var e=+this;if(g.hasOwnProperty(e)){var t=g[e];delete g[e],t()}},S=function(e){y.call(e.data)};f&&p||(f=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return g[++m]=function(){s("function"==typeof e?e:Function(e),t)},r(m),m},p=function(e){delete g[e]},"process"==n(47489)(l)?r=function(e){l.nextTick(a(y,e,1))}:v&&v.now?r=function(e){v.now(a(y,e,1))}:h?(o=(i=new h).port2,i.port1.onmessage=S,r=a(o.postMessage,o,1)):d.addEventListener&&"function"==typeof postMessage&&!d.importScripts?(r=function(e){d.postMessage(e+"","*")},d.addEventListener("message",S,!1)):r=E in u("script")?function(e){c.appendChild(u("script"))[E]=function(){c.removeChild(this),y.call(e)}}:function(e){setTimeout(a(y,e,1),0)}),e.exports={set:f,clear:p}},10139:(e,t,n)=>{var r=n(72579),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=r(e))<0?i(e+t,0):o(e,t)}},72579:e=>{var t=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:t)(e)}},6303:(e,t,n)=>{var r=n(65474),i=n(59359);e.exports=function(e){return r(i(e))}},45321:(e,t,n)=>{var r=n(72579),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},54922:(e,t,n)=>{var r=n(59359);e.exports=function(e){return Object(r(e))}},32548:(e,t,n)=>{var r=n(44425);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},46918:e=>{var t=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++t+n).toString(36))}},58411:(e,t,n)=>{var r=n(3220).navigator;e.exports=r&&r.userAgent||""},10069:(e,t,n)=>{var r=n(44425);e.exports=function(e,t){if(!r(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},10305:(e,t,n)=>{var r=n(3220),i=n(63093),o=n(34436),a=n(33485),s=n(56007).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},33485:(e,t,n)=>{t.f=n(23032)},23032:(e,t,n)=>{var r=n(5628)("wks"),i=n(46918),o=n(3220).Symbol,a="function"==typeof o;(e.exports=function(e){return r[e]||(r[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=r},25816:(e,t,n)=>{var r=n(85158),i=n(23032)("iterator"),o=n(64502);e.exports=n(63093).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[r(e)]}},63090:(e,t,n)=>{"use strict";var r=n(31133),i=n(14518),o=n(54922),a=n(12441),s=n(92566),c=n(45321),u=n(10101),d=n(25816);i(i.S+i.F*!n(98661)((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,i,l,f=o(e),p="function"==typeof this?this:Array,h=arguments.length,v=h>1?arguments[1]:void 0,m=void 0!==v,g=0,E=d(f);if(m&&(v=r(v,h>2?arguments[2]:void 0,2)),null==E||p==Array&&s(E))for(n=new p(t=c(f.length));t>g;g++)u(n,g,m?v(f[g],g):f[g]);else for(l=E.call(f),n=new p;!(i=l.next()).done;g++)u(n,g,m?a(l,v,[i.value,g],!0):i.value);return n.length=g,n}})},48901:(e,t,n)=>{var r=n(14518);r(r.S,"Array",{isArray:n(35730)})},74296:(e,t,n)=>{"use strict";var r=n(86687),i=n(85490),o=n(64502),a=n(6303);e.exports=n(60354)(Array,"Array",(function(e,t){this._t=a(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},78175:(e,t,n)=>{var r=n(14518);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},99228:(e,t,n)=>{"use strict";var r=n(21706),i=n(10069),o="Map";e.exports=n(66924)(o,(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=r.getEntry(i(this,o),e);return t&&t.v},set:function(e,t){return r.def(i(this,o),0===e?0:e,t)}},r,!0)},57044:(e,t,n)=>{var r=n(14518);r(r.S,"Number",{isNaN:function(e){return e!=e}})},73274:(e,t,n)=>{var r=n(14518),i=n(24049);r(r.S+r.F*(Number.parseInt!=i),"Number",{parseInt:i})},82464:(e,t,n)=>{var r=n(14518);r(r.S+r.F,"Object",{assign:n(47382)})},97660:(e,t,n)=>{var r=n(14518);r(r.S,"Object",{create:n(69270)})},84521:(e,t,n)=>{var r=n(14518);r(r.S+r.F*!n(97305),"Object",{defineProperties:n(16287)})},15356:(e,t,n)=>{var r=n(14518);r(r.S+r.F*!n(97305),"Object",{defineProperty:n(56007).f})},8638:(e,t,n)=>{var r=n(44425),i=n(57010).onFreeze;n(70874)("freeze",(function(e){return function(t){return e&&r(t)?e(i(t)):t}}))},52812:(e,t,n)=>{var r=n(6303),i=n(30826).f;n(70874)("getOwnPropertyDescriptor",(function(){return function(e,t){return i(r(e),t)}}))},13418:(e,t,n)=>{n(70874)("getOwnPropertyNames",(function(){return n(23208).f}))},92810:(e,t,n)=>{var r=n(54922),i=n(65194);n(70874)("getPrototypeOf",(function(){return function(e){return i(r(e))}}))},5338:(e,t,n)=>{var r=n(54922),i=n(31304);n(70874)("keys",(function(){return function(e){return i(r(e))}}))},99269:(e,t,n)=>{var r=n(14518);r(r.S,"Object",{setPrototypeOf:n(96573).set})},56536:()=>{},55:(e,t,n)=>{var r=n(14518),i=n(23080);r(r.G+r.F*(parseFloat!=i),{parseFloat:i})},68785:(e,t,n)=>{var r=n(14518),i=n(24049);r(r.G+r.F*(parseInt!=i),{parseInt:i})},63723:(e,t,n)=>{"use strict";var r,i,o,a,s=n(34436),c=n(3220),u=n(31133),d=n(85158),l=n(14518),f=n(44425),p=n(18679),h=n(8003),v=n(26510),m=n(312),g=n(26998).set,E=n(9734)(),y=n(36253),S=n(19934),_=n(58411),C=n(77116),R="Promise",T=c.TypeError,x=c.process,b=x&&x.versions,w=b&&b.v8||"",I=c[R],L="process"==d(x),O=function(){},A=i=y.f,k=!!function(){try{var e=I.resolve(1),t=(e.constructor={})[n(23032)("species")]=function(e){e(O,O)};return(L||"function"==typeof PromiseRejectionEvent)&&e.then(O)instanceof t&&0!==w.indexOf("6.6")&&-1===_.indexOf("Chrome/66")}catch(e){}}(),M=function(e){var t;return!(!f(e)||"function"!=typeof(t=e.then))&&t},N=function(e,t){if(!e._n){e._n=!0;var n=e._c;E((function(){for(var r=e._v,i=1==e._s,o=0,a=function(t){var n,o,a,s=i?t.ok:t.fail,c=t.resolve,u=t.reject,d=t.domain;try{s?(i||(2==e._h&&F(e),e._h=1),!0===s?n=r:(d&&d.enter(),n=s(r),d&&(d.exit(),a=!0)),n===t.promise?u(T("Promise-chain cycle")):(o=M(n))?o.call(n,c,u):c(n)):u(r)}catch(e){d&&!a&&d.exit(),u(e)}};n.length>o;)a(n[o++]);e._c=[],e._n=!1,t&&!e._h&&D(e)}))}},D=function(e){g.call(c,(function(){var t,n,r,i=e._v,o=P(e);if(o&&(t=S((function(){L?x.emit("unhandledRejection",i,e):(n=c.onunhandledrejection)?n({promise:e,reason:i}):(r=c.console)&&r.error&&r.error("Unhandled promise rejection",i)})),e._h=L||P(e)?2:1),e._a=void 0,o&&t.e)throw t.v}))},P=function(e){return 1!==e._h&&0===(e._a||e._c).length},F=function(e){g.call(c,(function(){var t;L?x.emit("rejectionHandled",e):(t=c.onrejectionhandled)&&t({promise:e,reason:e._v})}))},U=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),N(t,!0))},Z=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw T("Promise can't be resolved itself");(t=M(e))?E((function(){var r={_w:n,_d:!1};try{t.call(e,u(Z,r,1),u(U,r,1))}catch(e){U.call(r,e)}})):(n._v=e,n._s=1,N(n,!1))}catch(e){U.call({_w:n,_d:!1},e)}}};k||(I=function(e){h(this,I,R,"_h"),p(e),r.call(this);try{e(u(Z,this,1),u(U,this,1))}catch(e){U.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(561)(I.prototype,{then:function(e,t){var n=A(m(this,I));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=L?x.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&N(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new r;this.promise=e,this.resolve=u(Z,e,1),this.reject=u(U,e,1)},y.f=A=function(e){return e===I||e===a?new o(e):i(e)}),l(l.G+l.W+l.F*!k,{Promise:I}),n(8182)(I,R),n(7183)(R),a=n(63093)[R],l(l.S+l.F*!k,R,{reject:function(e){var t=A(this);return(0,t.reject)(e),t.promise}}),l(l.S+l.F*(s||!k),R,{resolve:function(e){return C(s&&this===a?I:this,e)}}),l(l.S+l.F*!(k&&n(98661)((function(e){I.all(e).catch(O)}))),R,{all:function(e){var t=this,n=A(t),r=n.resolve,i=n.reject,o=S((function(){var n=[],o=0,a=1;v(e,!1,(function(e){var s=o++,c=!1;n.push(void 0),a++,t.resolve(e).then((function(e){c||(c=!0,n[s]=e,--a||r(n))}),i)})),--a||r(n)}));return o.e&&i(o.v),n.promise},race:function(e){var t=this,n=A(t),r=n.reject,i=S((function(){v(e,!1,(function(e){t.resolve(e).then(n.resolve,r)}))}));return i.e&&r(i.v),n.promise}})},41896:(e,t,n)=>{var r=n(14518),i=n(18679),o=n(49226),a=(n(3220).Reflect||{}).apply,s=Function.apply;r(r.S+r.F*!n(84930)((function(){a((function(){}))})),"Reflect",{apply:function(e,t,n){var r=i(e),c=o(n);return a?a(r,t,c):s.call(r,t,c)}})},90634:(e,t,n)=>{var r=n(14518),i=n(69270),o=n(18679),a=n(49226),s=n(44425),c=n(84930),u=n(98659),d=(n(3220).Reflect||{}).construct,l=c((function(){function e(){}return!(d((function(){}),[],e)instanceof e)})),f=!c((function(){d((function(){}))}));r(r.S+r.F*(l||f),"Reflect",{construct:function(e,t){o(e),a(t);var n=arguments.length<3?e:o(arguments[2]);if(f&&!l)return d(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new(u.apply(e,r))}var c=n.prototype,p=i(s(c)?c:Object.prototype),h=Function.apply.call(e,p,t);return s(h)?h:p}})},69805:(e,t,n)=>{var r=n(30826),i=n(65194),o=n(3920),a=n(14518),s=n(44425),c=n(49226);a(a.S,"Reflect",{get:function e(t,n){var a,u,d=arguments.length<3?t:arguments[2];return c(t)===d?t[n]:(a=r.f(t,n))?o(a,"value")?a.value:void 0!==a.get?a.get.call(d):void 0:s(u=i(t))?e(u,n,d):void 0}})},44562:(e,t,n)=>{var r=n(14518);r(r.S,"Reflect",{ownKeys:n(74737)})},6348:(e,t,n)=>{"use strict";var r=n(21706),i=n(10069);e.exports=n(66924)("Set",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return r.def(i(this,"Set"),e=0===e?0:e,e)}},r)},79169:(e,t,n)=>{"use strict";var r=n(87268)(!0);n(60354)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})}))},15898:(e,t,n)=>{"use strict";var r=n(3220),i=n(3920),o=n(97305),a=n(14518),s=n(29763),c=n(57010).KEY,u=n(84930),d=n(5628),l=n(8182),f=n(46918),p=n(23032),h=n(33485),v=n(10305),m=n(94331),g=n(35730),E=n(49226),y=n(44425),S=n(54922),_=n(6303),C=n(32548),R=n(35831),T=n(69270),x=n(23208),b=n(30826),w=n(18382),I=n(56007),L=n(31304),O=b.f,A=I.f,k=x.f,M=r.Symbol,N=r.JSON,D=N&&N.stringify,P="prototype",F=p("_hidden"),U=p("toPrimitive"),Z={}.propertyIsEnumerable,V=d("symbol-registry"),G=d("symbols"),B=d("op-symbols"),W=Object[P],j="function"==typeof M&&!!w.f,H=r.QObject,K=!H||!H[P]||!H[P].findChild,q=o&&u((function(){return 7!=T(A({},"a",{get:function(){return A(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=O(W,t);r&&delete W[t],A(e,t,n),r&&e!==W&&A(W,t,r)}:A,Y=function(e){var t=G[e]=T(M[P]);return t._k=e,t},z=j&&"symbol"==typeof M.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof M},X=function(e,t,n){return e===W&&X(B,t,n),E(e),t=C(t,!0),E(n),i(G,t)?(n.enumerable?(i(e,F)&&e[F][t]&&(e[F][t]=!1),n=T(n,{enumerable:R(0,!1)})):(i(e,F)||A(e,F,R(1,{})),e[F][t]=!0),q(e,t,n)):A(e,t,n)},J=function(e,t){E(e);for(var n,r=m(t=_(t)),i=0,o=r.length;o>i;)X(e,n=r[i++],t[n]);return e},$=function(e){var t=Z.call(this,e=C(e,!0));return!(this===W&&i(G,e)&&!i(B,e))&&(!(t||!i(this,e)||!i(G,e)||i(this,F)&&this[F][e])||t)},Q=function(e,t){if(e=_(e),t=C(t,!0),e!==W||!i(G,t)||i(B,t)){var n=O(e,t);return!n||!i(G,t)||i(e,F)&&e[F][t]||(n.enumerable=!0),n}},ee=function(e){for(var t,n=k(_(e)),r=[],o=0;n.length>o;)i(G,t=n[o++])||t==F||t==c||r.push(t);return r},te=function(e){for(var t,n=e===W,r=k(n?B:_(e)),o=[],a=0;r.length>a;)!i(G,t=r[a++])||n&&!i(W,t)||o.push(G[t]);return o};j||(s((M=function(){if(this instanceof M)throw TypeError("Symbol is not a constructor!");var e=f(arguments.length>0?arguments[0]:void 0),t=function(n){this===W&&t.call(B,n),i(this,F)&&i(this[F],e)&&(this[F][e]=!1),q(this,e,R(1,n))};return o&&K&&q(W,e,{configurable:!0,set:t}),Y(e)})[P],"toString",(function(){return this._k})),b.f=Q,I.f=X,n(95733).f=x.f=ee,n(55066).f=$,w.f=te,o&&!n(34436)&&s(W,"propertyIsEnumerable",$,!0),h.f=function(e){return Y(p(e))}),a(a.G+a.W+a.F*!j,{Symbol:M});for(var ne="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),re=0;ne.length>re;)p(ne[re++]);for(var ie=L(p.store),oe=0;ie.length>oe;)v(ie[oe++]);a(a.S+a.F*!j,"Symbol",{for:function(e){return i(V,e+="")?V[e]:V[e]=M(e)},keyFor:function(e){if(!z(e))throw TypeError(e+" is not a symbol!");for(var t in V)if(V[t]===e)return t},useSetter:function(){K=!0},useSimple:function(){K=!1}}),a(a.S+a.F*!j,"Object",{create:function(e,t){return void 0===t?T(e):J(T(e),t)},defineProperty:X,defineProperties:J,getOwnPropertyDescriptor:Q,getOwnPropertyNames:ee,getOwnPropertySymbols:te});var ae=u((function(){w.f(1)}));a(a.S+a.F*ae,"Object",{getOwnPropertySymbols:function(e){return w.f(S(e))}}),N&&a(a.S+a.F*(!j||u((function(){var e=M();return"[null]"!=D([e])||"{}"!=D({a:e})||"{}"!=D(Object(e))}))),"JSON",{stringify:function(e){for(var t,n,r=[e],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=t=r[1],(y(t)||void 0!==e)&&!z(e))return g(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!z(t))return t}),r[1]=t,D.apply(N,r)}}),M[P][U]||n(44379)(M[P],U,M[P].valueOf),l(M,"Symbol"),l(Math,"Math",!0),l(r.JSON,"JSON",!0)},11610:(e,t,n)=>{"use strict";var r,i=n(3220),o=n(18485)(0),a=n(29763),s=n(57010),c=n(47382),u=n(77760),d=n(44425),l=n(10069),f=n(10069),p=!i.ActiveXObject&&"ActiveXObject"in i,h="WeakMap",v=s.getWeak,m=Object.isExtensible,g=u.ufstore,E=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},y={get:function(e){if(d(e)){var t=v(e);return!0===t?g(l(this,h)).get(e):t?t[this._i]:void 0}},set:function(e,t){return u.def(l(this,h),e,t)}},S=e.exports=n(66924)(h,E,y,u,!0,!0);f&&p&&(c((r=u.getConstructor(E,h)).prototype,y),s.NEED=!0,o(["delete","has","get","set"],(function(e){var t=S.prototype,n=t[e];a(t,e,(function(t,i){if(d(t)&&!m(t)){this._f||(this._f=new r);var o=this._f[e](t,i);return"set"==e?this:o}return n.call(this,t,i)}))})))},33012:(e,t,n)=>{n(74573)("Map")},28878:(e,t,n)=>{n(72758)("Map")},90401:(e,t,n)=>{var r=n(14518);r(r.P+r.R,"Map",{toJSON:n(80540)("Map")})},39827:(e,t,n)=>{var r=n(14518),i=n(30572)(!0);r(r.S,"Object",{entries:function(e){return i(e)}})},40342:(e,t,n)=>{var r=n(14518),i=n(74737),o=n(6303),a=n(30826),s=n(10101);r(r.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,n,r=o(e),c=a.f,u=i(r),d={},l=0;u.length>l;)void 0!==(n=c(r,t=u[l++]))&&s(d,t,n);return d}})},73625:(e,t,n)=>{var r=n(14518),i=n(30572)(!1);r(r.S,"Object",{values:function(e){return i(e)}})},36556:(e,t,n)=>{"use strict";var r=n(14518),i=n(63093),o=n(3220),a=n(312),s=n(77116);r(r.P+r.R,"Promise",{finally:function(e){var t=a(this,i.Promise||o.Promise),n="function"==typeof e;return this.then(n?function(n){return s(t,e()).then((function(){return n}))}:e,n?function(n){return s(t,e()).then((function(){throw n}))}:e)}})},8421:(e,t,n)=>{"use strict";var r=n(14518),i=n(36253),o=n(19934);r(r.S,"Promise",{try:function(e){var t=i.f(this),n=o(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},68572:(e,t,n)=>{n(74573)("Set")},42235:(e,t,n)=>{n(72758)("Set")},30093:(e,t,n)=>{var r=n(14518);r(r.P+r.R,"Set",{toJSON:n(80540)("Set")})},52145:(e,t,n)=>{n(10305)("asyncIterator")},74775:(e,t,n)=>{n(10305)("observable")},20206:(e,t,n)=>{n(74573)("WeakMap")},91877:(e,t,n)=>{n(72758)("WeakMap")},39361:(e,t,n)=>{n(74296);for(var r=n(3220),i=n(44379),o=n(64502),a=n(23032)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),c=0;c<s.length;c++){var u=s[c],d=r[u],l=d&&d.prototype;l&&!l[a]&&i(l,a,u),o[u]=o.Array}},85078:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(70655),i=n(2403),o=function(){function e(e){this._semaphore=new i.default(1,e)}return e.prototype.acquire=function(){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){switch(t.label){case 0:return[4,this._semaphore.acquire()];case 1:return e=t.sent(),[2,e[1]]}}))}))},e.prototype.runExclusive=function(e){return this._semaphore.runExclusive((function(){return e()}))},e.prototype.isLocked=function(){return this._semaphore.isLocked()},e.prototype.waitForUnlock=function(){return this._semaphore.waitForUnlock()},e.prototype.release=function(){this._semaphore.isLocked()&&this._semaphore.release()},e.prototype.cancel=function(){return this._semaphore.cancel()},e}();t.default=o},2403:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(70655),i=n(21764),o=function(){function e(e,t){void 0===t&&(t=i.E_CANCELED),this._value=e,this._cancelError=t,this._weightedQueues=[],this._weightedWaiters=[]}return e.prototype.acquire=function(e){var t=this;if(void 0===e&&(e=1),e<=0)throw new Error("invalid weight ".concat(e,": must be positive"));return new Promise((function(n,r){t._weightedQueues[e-1]||(t._weightedQueues[e-1]=[]),t._weightedQueues[e-1].push({resolve:n,reject:r}),t._dispatch()}))},e.prototype.runExclusive=function(e,t){return void 0===t&&(t=1),r.__awaiter(this,void 0,void 0,(function(){var n,i,o;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.acquire(t)];case 1:n=r.sent(),i=n[0],o=n[1],r.label=2;case 2:return r.trys.push([2,,4,5]),[4,e(i)];case 3:return[2,r.sent()];case 4:return o(),[7];case 5:return[2]}}))}))},e.prototype.waitForUnlock=function(e){var t=this;if(void 0===e&&(e=1),e<=0)throw new Error("invalid weight ".concat(e,": must be positive"));return new Promise((function(n){t._weightedWaiters[e-1]||(t._weightedWaiters[e-1]=[]),t._weightedWaiters[e-1].push(n),t._dispatch()}))},e.prototype.isLocked=function(){return this._value<=0},e.prototype.getValue=function(){return this._value},e.prototype.setValue=function(e){this._value=e,this._dispatch()},e.prototype.release=function(e){if(void 0===e&&(e=1),e<=0)throw new Error("invalid weight ".concat(e,": must be positive"));this._value+=e,this._dispatch()},e.prototype.cancel=function(){var e=this;this._weightedQueues.forEach((function(t){return t.forEach((function(t){return t.reject(e._cancelError)}))})),this._weightedQueues=[]},e.prototype._dispatch=function(){for(var e,t=this._value;t>0;t--){var n=null===(e=this._weightedQueues[t-1])||void 0===e?void 0:e.shift();if(n){var r=this._value,i=t;this._value-=t,t=this._value+1,n.resolve([r,this._newReleaser(i)])}}this._drainUnlockWaiters()},e.prototype._newReleaser=function(e){var t=this,n=!1;return function(){n||(n=!0,t.release(e))}},e.prototype._drainUnlockWaiters=function(){for(var e=this._value;e>0;e--)this._weightedWaiters[e-1]&&(this._weightedWaiters[e-1].forEach((function(e){return e()})),this._weightedWaiters[e-1]=[])},e}();t.default=o},21764:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.E_CANCELED=t.E_ALREADY_LOCKED=t.E_TIMEOUT=void 0,t.E_TIMEOUT=new Error("timeout while waiting for mutex to become available"),t.E_ALREADY_LOCKED=new Error("mutex already locked"),t.E_CANCELED=new Error("request for lock canceled")},48125:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tryAcquire=t.withTimeout=t.Semaphore=t.Mutex=void 0;var r=n(70655),i=n(85078);Object.defineProperty(t,"Mutex",{enumerable:!0,get:function(){return i.default}});var o=n(2403);Object.defineProperty(t,"Semaphore",{enumerable:!0,get:function(){return o.default}});var a=n(41960);Object.defineProperty(t,"withTimeout",{enumerable:!0,get:function(){return a.withTimeout}});var s=n(73143);Object.defineProperty(t,"tryAcquire",{enumerable:!0,get:function(){return s.tryAcquire}}),r.__exportStar(n(21764),t)},73143:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tryAcquire=void 0;var r=n(21764),i=n(41960);t.tryAcquire=function(e,t){return void 0===t&&(t=r.E_ALREADY_LOCKED),(0,i.withTimeout)(e,0,t)}},41960:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.withTimeout=void 0;var r=n(70655),i=n(21764);t.withTimeout=function(e,t,n){var o=this;return void 0===n&&(n=i.E_TIMEOUT),{acquire:function(i){if(void 0!==i&&i<=0)throw new Error("invalid weight ".concat(i,": must be positive"));return new Promise((function(a,s){return r.__awaiter(o,void 0,void 0,(function(){var o,c,u,d;return r.__generator(this,(function(r){switch(r.label){case 0:o=!1,c=setTimeout((function(){o=!0,s(n)}),t),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.acquire(i)];case 2:return u=r.sent(),o?(Array.isArray(u)?u[1]:u)():(clearTimeout(c),a(u)),[3,4];case 3:return d=r.sent(),o||(clearTimeout(c),s(d)),[3,4];case 4:return[2]}}))}))}))},runExclusive:function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,i;return r.__generator(this,(function(r){switch(r.label){case 0:n=function(){},r.label=1;case 1:return r.trys.push([1,,7,8]),[4,this.acquire(t)];case 2:return i=r.sent(),Array.isArray(i)?(n=i[1],[4,e(i[0])]):[3,4];case 3:return[2,r.sent()];case 4:return n=i,[4,e()];case 5:return[2,r.sent()];case 6:return[3,8];case 7:return n(),[7];case 8:return[2]}}))}))},release:function(t){e.release(t)},cancel:function(){return e.cancel()},waitForUnlock:function(r){if(void 0!==r&&r<=0)throw new Error("invalid weight ".concat(r,": must be positive"));return new Promise((function(i,o){e.waitForUnlock(r).then(i),setTimeout((function(){return o(n)}),t)}))},isLocked:function(){return e.isLocked()},getValue:function(){return e.getValue()},setValue:function(t){return e.setValue(t)}}}},51732:(e,t,n)=>{"use strict";n.r(t);var r=n(63755),i=n.n(r),o=n(66250),a=n(8167),s=n(31314),c=n(23710),u=n(69678),d=n(26305),l=n(35002),f=n(77193),p=n(33453),h=n.n(p),v=n(26771),m=n.n(v),g=n(18433),E=n.n(g);function y(e){var t=function(){if("undefined"==typeof Reflect||!i())return!1;if(i().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,l.Z)(e);if(t){var o=(0,l.Z)(this).constructor;n=i()(r,arguments,o)}else n=r.apply(this,arguments);return(0,d.Z)(this,n)}}var S=function(e){return e&&e.__esModule?e:{default:e}};m()(exports,"__esModule",{value:!0}),exports.createCallHistoryClient=exports.CallHistory=void 0;var _=S(n(4983)),C=n(14830),R=S(n(41309)),T=n(21471),x=n(22230),b=n(93698),w=n(93800),I=function(e){(0,u.Z)(r,e);var t,n=y(r);function r(e,t){var i;return(0,a.Z)(this,r),i=n.call(this),(0,f.Z)((0,c.Z)(i),"sdkConnector",void 0),(0,f.Z)((0,c.Z)(i),"webex",void 0),(0,f.Z)((0,c.Z)(i),"janusUrl",""),(0,f.Z)((0,c.Z)(i),"fromDate",""),(0,f.Z)((0,c.Z)(i),"loggerContext",{file:x.CALL_HISTORY_FILE,method:"getCallHistoryData"}),(0,f.Z)((0,c.Z)(i),"userSessions",void 0),i.sdkConnector=_.default,i.sdkConnector.getWebex()||_.default.setWebex(e),i.webex=i.sdkConnector.getWebex(),i.janusUrl=i.webex.internal.services._serviceUrls.janus,i.registerSessionsListener(),R.default.setLogger(t.level),i}return(0,s.Z)(r,[{key:"getCallHistoryData",value:(t=(0,o.Z)(h().mark((function e(){var t,n,r,i,o,a,s,c,u,d,l,f,p=arguments;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.length>0&&void 0!==p[0]?p[0]:x.NUMBER_OF_DAYS,n=p.length>1&&void 0!==p[1]?p[1]:x.LIMIT,r=p.length>2&&void 0!==p[2]?p[2]:C.SORT.DEFAULT,i=p.length>3&&void 0!==p[3]?p[3]:C.SORT_BY.DEFAULT,(o=new Date).setDate(o.getDate()-t),this.fromDate=o.toISOString(),a=E()(C.SORT_BY).includes(i)?i:C.SORT_BY.DEFAULT,s=E()(C.SORT).includes(r)?r:C.SORT.DEFAULT,R.default.log("Janus API URL ".concat(this.janusUrl),this.loggerContext),R.default.info("Call history from date : ".concat(this.fromDate),this.loggerContext),R.default.info("Call history sort type : ".concat(s),this.loggerContext),R.default.info("Call history sortby type : ".concat(a),this.loggerContext),c="".concat(this.janusUrl,"/").concat(x.HISTORY,"/").concat(b.USER_SESSIONS).concat(x.FROM_DATE,"=").concat(this.fromDate,"&limit=").concat(n,"&includeNewSessionTypes=true&sort=").concat(s),e.prev=14,e.next=17,this.webex.request({uri:"".concat(c),method:C.HTTP_METHODS.GET,service:C.ALLOWED_SERVICES.JANUS});case 17:return u=e.sent,this.userSessions=u.body,a===C.SORT_BY.START_TIME&&(s===C.SORT.DESC?this.userSessions[b.USER_SESSIONS].sort((function(e,t){return new Date(t[a]).getTime()-new Date(e[a]).getTime()})):s===C.SORT.ASC&&this.userSessions[b.USER_SESSIONS].sort((function(e,t){return new Date(e[a]).getTime()-new Date(t[a]).getTime()}))),d={statusCode:this.userSessions[b.STATUS_CODE],data:{userSessions:this.userSessions[b.USER_SESSIONS]},message:b.SUCCESS_MESSAGE},e.abrupt("return",d);case 24:return e.prev=24,e.t0=e.catch(14),l=e.t0,f=(0,T.serviceErrorCodeHandler)(l,this.loggerContext),e.abrupt("return",f);case 29:case"end":return e.stop()}}),e,this,[[14,24]])}))),function(){return t.apply(this,arguments)})},{key:"getSDKConnector",value:function(){return this.sdkConnector}},{key:"registerSessionsListener",value:function(){var e=this;this.sdkConnector.registerListener(w.MOBIUS_EVENT_KEYS.CALL_SESSION_EVENT_INCLUSIVE,function(){var t=(0,o.Z)(h().mark((function t(n){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n&&n.data.userSessions.userSessions&&e.emit(w.EVENT_KEYS.CALL_HISTORY_USER_SESSION_INFO,n);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}]),r}(n(29004).Eventing);exports.CallHistory=I;exports.createCallHistoryClient=function(e,t){return new I(e,t)}},22230:(e,t,n)=>{"use strict";n.r(t);var r=n(26771);n.n(r)()(exports,"__esModule",{value:!0}),exports.USER_SESSIONS=exports.STATUS_CODE=exports.SUCCESS_MESSAGE=exports.RESPONSE_MESSAGE=exports.NUMBER_OF_DAYS=exports.LIMIT=exports.HISTORY=exports.FROM_DATE=exports.CALL_HISTORY_FILE=void 0,exports.CALL_HISTORY_FILE="CallHistory",exports.FROM_DATE="?from",exports.HISTORY="history",exports.LIMIT=50,exports.NUMBER_OF_DAYS=10,exports.RESPONSE_MESSAGE="responseMessage",exports.SUCCESS_MESSAGE="SUCCESS",exports.STATUS_CODE="statusCode",exports.USER_SESSIONS="userSessions"},44614:(e,t,n)=>{"use strict";n.r(t);var r=n(66250),i=n(8167),o=n(31314),a=n(77193),s=n(33453),c=n.n(s),u=n(26771),d=function(e){return e&&e.__esModule?e:{default:e}};n.n(u)()(exports,"__esModule",{value:!0}),exports.createCallSettingsClient=exports.CallSettings=void 0;var l=d(n(4983)),f=d(n(41309)),p=n(14830),h=n(93698),v=n(61447),m=n(21471),g=function(){function e(t,n){(0,i.Z)(this,e),(0,a.Z)(this,"sdkConnector",void 0),(0,a.Z)(this,"webex",void 0),(0,a.Z)(this,"hydraEndpoint",void 0),(0,a.Z)(this,"userId",void 0),(0,a.Z)(this,"personId",void 0),(0,a.Z)(this,"orgId",void 0),(0,a.Z)(this,"xsiEndpoint",void 0),this.sdkConnector=l.default,this.sdkConnector.getWebex()||l.default.setWebex(t),this.webex=this.sdkConnector.getWebex(),this.hydraEndpoint=this.webex.internal.services._serviceUrls.hydra,f.default.setLogger(n.level),this.userId=this.webex.internal.device.userId,this.personId=(0,m.inferIdFromUuid)(this.webex.internal.device.userId,p.DecodeType.PEOPLE),this.orgId=(0,m.inferIdFromUuid)(this.webex.internal.device.orgId,p.DecodeType.ORGANIZATION)}var t,n,s,u,d,g,E;return(0,o.Z)(e,[{key:"getCallWaitingSetting",value:(E=(0,r.Z)(c().mark((function e(){var t,n,r,i,o,a,s,u,d,l,f,g,E;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={file:v.CALL_SETTINGS_FILE,method:"getCallWaitingSetting"},e.prev=1,e.next=4,this.webex.request({uri:"".concat(this.hydraEndpoint,"/").concat(h.XSI_ACTION_ENDPOINT_ORG_URL_PARAM),method:p.HTTP_METHODS.GET});case 4:return n=e.sent,r=n.body,this.xsiEndpoint=r[h.ITEMS][0][h.XSI_ACTION_ENDPOINT],i="".concat(this.xsiEndpoint,"/").concat(v.XSI_VERSION,"/").concat(v.USER_ENDPOINT,"/").concat(this.userId,"/").concat(h.SERVICES_ENDPOINT,"/").concat(v.CALL_WAITING_ENDPOINT),e.t0=fetch,e.t1="".concat(i),e.t2=p.HTTP_METHODS.GET,e.next=13,this.webex.credentials.getUserToken();case 13:return e.t3=e.sent,e.t4={Authorization:e.t3},e.t5={method:e.t2,headers:e.t4},e.next=18,(0,e.t0)(e.t1,e.t5);case 18:if((o=e.sent).ok){e.next=21;break}throw new Error("".concat(o.status));case 21:return e.next=23,o.text();case 23:return a=e.sent,s=new DOMParser,u=s.parseFromString(a,h.XML_TYPE),d=u.getElementsByTagName("active"),l=d[0].childNodes[0].textContent,f={statusCode:200,data:{callSetting:{enabled:"true"===l}},message:h.SUCCESS_MESSAGE},e.abrupt("return",f);case 33:return e.prev=33,e.t6=e.catch(1),g={statusCode:e.t6 instanceof Error?Number(e.t6.message):""},E=(0,m.serviceErrorCodeHandler)(g,t),e.abrupt("return",E);case 38:case"end":return e.stop()}}),e,this,[[1,33]])}))),function(){return E.apply(this,arguments)})},{key:"getDoNotDisturbSetting",value:(g=(0,r.Z)(c().mark((function e(){var t,n,r,i,o,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={file:v.CALL_SETTINGS_FILE,method:"getDoNotDisturbSetting"},e.prev=1,e.next=4,this.webex.request({uri:"".concat(this.hydraEndpoint,"/").concat(v.PEOPLE_ENDPOINT,"/").concat(this.personId,"/").concat(v.DND_ENDPOINT,"?").concat(v.ORG_ENDPOINT,"=").concat(this.orgId),method:p.HTTP_METHODS.GET});case 4:return n=e.sent,r=n.body,i={statusCode:n[h.STATUS_CODE],data:{callSetting:r},message:h.SUCCESS_MESSAGE},e.abrupt("return",i);case 10:return e.prev=10,e.t0=e.catch(1),o=e.t0,a=(0,m.serviceErrorCodeHandler)(o,t),e.abrupt("return",a);case 15:case"end":return e.stop()}}),e,this,[[1,10]])}))),function(){return g.apply(this,arguments)})},{key:"setDoNotDisturbSetting",value:(d=(0,r.Z)(c().mark((function e(t){var n,r,i,o,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={file:v.CALL_SETTINGS_FILE,method:"setDoNotDisturbSetting"},e.prev=1,r={enabled:t,ringSplashEnabled:!1},e.next=5,this.webex.request({uri:"".concat(this.hydraEndpoint,"/").concat(v.PEOPLE_ENDPOINT,"/").concat(this.personId,"/").concat(v.DND_ENDPOINT,"?").concat(v.ORG_ENDPOINT,"=").concat(this.orgId),method:p.HTTP_METHODS.PUT,body:r});case 5:return i=e.sent,o={statusCode:i[h.STATUS_CODE],data:{callSetting:r},message:h.SUCCESS_MESSAGE},e.abrupt("return",o);case 10:return e.prev=10,e.t0=e.catch(1),a=e.t0,s=(0,m.serviceErrorCodeHandler)(a,n),e.abrupt("return",s);case 15:case"end":return e.stop()}}),e,this,[[1,10]])}))),function(e){return d.apply(this,arguments)})},{key:"getCallForwardSetting",value:(u=(0,r.Z)(c().mark((function e(){var t,n,r,i,o,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={file:v.CALL_SETTINGS_FILE,method:"getCallForwardingSetting"},e.prev=1,e.next=4,this.webex.request({uri:"".concat(this.hydraEndpoint,"/").concat(v.PEOPLE_ENDPOINT,"/").concat(this.personId,"/").concat(v.CF_ENDPOINT,"?").concat(v.ORG_ENDPOINT,"=").concat(this.orgId),method:p.HTTP_METHODS.GET});case 4:return n=e.sent,r=n.body,i={statusCode:n[h.STATUS_CODE],data:{callSetting:r},message:h.SUCCESS_MESSAGE},e.abrupt("return",i);case 10:return e.prev=10,e.t0=e.catch(1),o=e.t0,a=(0,m.serviceErrorCodeHandler)(o,t),e.abrupt("return",a);case 15:case"end":return e.stop()}}),e,this,[[1,10]])}))),function(){return u.apply(this,arguments)})},{key:"setCallForwardSetting",value:(s=(0,r.Z)(c().mark((function e(t){var n,r,i,o,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={file:v.CALL_SETTINGS_FILE,method:"setCallForwardingSetting"},e.prev=1,e.next=4,this.webex.request({uri:"".concat(this.hydraEndpoint,"/").concat(v.PEOPLE_ENDPOINT,"/").concat(this.personId,"/").concat(v.CF_ENDPOINT,"?").concat(v.ORG_ENDPOINT,"=").concat(this.orgId),method:p.HTTP_METHODS.PUT,body:t});case 4:return r=e.sent,i={statusCode:r[h.STATUS_CODE],data:{callSetting:t},message:h.SUCCESS_MESSAGE},e.abrupt("return",i);case 9:return e.prev=9,e.t0=e.catch(1),o=e.t0,a=(0,m.serviceErrorCodeHandler)(o,n),e.abrupt("return",a);case 14:case"end":return e.stop()}}),e,this,[[1,9]])}))),function(e){return s.apply(this,arguments)})},{key:"getVoicemailSetting",value:(n=(0,r.Z)(c().mark((function e(){var t,n,r,i,o,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={file:v.CALL_SETTINGS_FILE,method:"getVoicemailSetting"},e.prev=1,e.next=4,this.webex.request({uri:"".concat(this.hydraEndpoint,"/").concat(v.PEOPLE_ENDPOINT,"/").concat(this.personId,"/").concat(v.VM_ENDPOINT,"?").concat(v.ORG_ENDPOINT,"=").concat(this.orgId),method:p.HTTP_METHODS.GET});case 4:return n=e.sent,r=n.body,i={statusCode:n[h.STATUS_CODE],data:{callSetting:r},message:h.SUCCESS_MESSAGE},e.abrupt("return",i);case 10:return e.prev=10,e.t0=e.catch(1),o=e.t0,a=(0,m.serviceErrorCodeHandler)(o,t),e.abrupt("return",a);case 15:case"end":return e.stop()}}),e,this,[[1,10]])}))),function(){return n.apply(this,arguments)})},{key:"setVoicemailSetting",value:(t=(0,r.Z)(c().mark((function e(t){var n,r,i,o,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={file:v.CALL_SETTINGS_FILE,method:"setVoicemailSetting"},e.prev=1,e.next=4,this.webex.request({uri:"".concat(this.hydraEndpoint,"/").concat(v.PEOPLE_ENDPOINT,"/").concat(this.personId,"/").concat(v.VM_ENDPOINT,"?").concat(v.ORG_ENDPOINT,"=").concat(this.orgId),method:p.HTTP_METHODS.PUT,body:t});case 4:return r=e.sent,i={statusCode:r[h.STATUS_CODE],data:{callSetting:t},message:h.SUCCESS_MESSAGE},e.abrupt("return",i);case 9:return e.prev=9,e.t0=e.catch(1),o=e.t0,a=(0,m.serviceErrorCodeHandler)(o,n),e.abrupt("return",a);case 14:case"end":return e.stop()}}),e,this,[[1,9]])}))),function(e){return t.apply(this,arguments)})},{key:"getSDKConnector",value:function(){return this.sdkConnector}}]),e}();exports.CallSettings=g;exports.createCallSettingsClient=function(e,t){return new g(e,t)}},61447:(e,t,n)=>{"use strict";n.r(t);var r=n(26771);n.n(r)()(exports,"__esModule",{value:!0}),exports.XSI_VERSION=exports.CALL_WAITING_ENDPOINT=exports.VM_ENDPOINT=exports.CF_ENDPOINT=exports.DND_ENDPOINT=exports.ORG_ENDPOINT=exports.USER_ENDPOINT=exports.PEOPLE_ENDPOINT=exports.CALL_SETTINGS_FILE=void 0,exports.CALL_SETTINGS_FILE="CallSettings",exports.PEOPLE_ENDPOINT="people",exports.USER_ENDPOINT="user",exports.ORG_ENDPOINT="orgId",exports.DND_ENDPOINT="features/doNotDisturb",exports.CF_ENDPOINT="features/callForwarding",exports.VM_ENDPOINT="features/voicemail",exports.CALL_WAITING_ENDPOINT="CallWaiting",exports.XSI_VERSION="v2.0"},52306:(e,t,n)=>{"use strict";n.r(t);var r=n(63755),i=n.n(r),o=n(27921),a=n.n(o),s=n(85579),c=n.n(s),u=n(22013),d=n.n(u),l=n(78149),f=n.n(l),p=n(66250),h=n(8167),v=n(31314),m=n(23710),g=n(69678),E=n(26305),y=n(35002),S=n(77193),_=n(33453),C=n.n(_),R=n(5940),T=n.n(R),x=n(95366),b=n.n(x),w=n(26771),I=n.n(w),L=n(18433),O=n.n(L),A=n(26243),k=n.n(A),M=n(66130),N=n.n(M);function D(e,t){var n=void 0!==c()&&e[d()]||e["@@iterator"];if(!n){if(f()(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return a()(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw o}}}}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function F(e){var t=function(){if("undefined"==typeof Reflect||!i())return!1;if(i().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,y.Z)(e);if(t){var o=(0,y.Z)(this).constructor;n=i()(r,arguments,o)}else n=r.apply(this,arguments);return(0,E.Z)(this,n)}}var U=T()?function(e,t,n,r){void 0===r&&(r=n);var i=b()(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),I()(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]},Z=T()?function(e,t){I()(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},V=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&U(t,e,n);return Z(t,e),t},G=function(e){return e&&e.__esModule?e:{default:e}};I()(exports,"__esModule",{value:!0}),exports.createClient=exports.CallingClient=void 0;var B=V(n(72038)),W=n(48125),j=n(21471),H=n(10475),K=n(32064),q=n(56891),Y=G(n(4983)),z=n(29004),X=n(93800),J=n(14830),$=G(n(41309)),Q=n(96364),ee=n(84407),te=n(74364),ne=n(12120),re=n(13563),ie=n(40241),oe=function(e){(0,g.Z)(_,e);var t,n,r,i,o,a,s,c,u,d,l,f,E,y=F(_);function _(e,t){var n,r,i,o,a;(0,h.Z)(this,_),a=y.call(this),(0,S.Z)((0,m.Z)(a),"sdkConnector",void 0),(0,S.Z)((0,m.Z)(a),"webex",void 0),(0,S.Z)((0,m.Z)(a),"mobiusServers",void 0),(0,S.Z)((0,m.Z)(a),"url",void 0),(0,S.Z)((0,m.Z)(a),"deviceInfo",{}),(0,S.Z)((0,m.Z)(a),"keepaliveTimer",void 0),(0,S.Z)((0,m.Z)(a),"failbackTimer",void 0),(0,S.Z)((0,m.Z)(a),"registerRetry",!1),(0,S.Z)((0,m.Z)(a),"mutex",void 0),(0,S.Z)((0,m.Z)(a),"rehomingIntervalMin",void 0),(0,S.Z)((0,m.Z)(a),"rehomingIntervalMax",void 0),(0,S.Z)((0,m.Z)(a),"failback429RetryAttempts",void 0),(0,S.Z)((0,m.Z)(a),"registration",void 0),(0,S.Z)((0,m.Z)(a),"clientError",void 0),(0,S.Z)((0,m.Z)(a),"callManager",void 0),(0,S.Z)((0,m.Z)(a),"isRegistered",void 0),(0,S.Z)((0,m.Z)(a),"sdkConfig",void 0),(0,S.Z)((0,m.Z)(a),"primaryMobiusUris",void 0),(0,S.Z)((0,m.Z)(a),"backupMobiusUris",void 0),(0,S.Z)((0,m.Z)(a),"metricManager",void 0),(0,S.Z)((0,m.Z)(a),"reconnectPending",void 0),(0,S.Z)((0,m.Z)(a),"mediaEngine",void 0),(0,S.Z)((0,m.Z)(a),"callsClearedHandler",(0,p.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.isDeviceRegistered()){e.next=3;break}return e.next=3,a.mutex.runExclusive((0,p.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.reconnectPending){e.next=4;break}return $.default.log("All calls cleared, reconnecting",{file:te.CALLING_CLIENT_FILE,method:te.CALLS_CLEARED_HANDLER_UTIL}),e.next=4,a.reconnectOnFailure(te.CALLS_CLEARED_HANDLER_UTIL);case 4:case"end":return e.stop()}}),e)}))));case 3:case"end":return e.stop()}}),e)})))),(0,S.Z)((0,m.Z)(a),"getRegistrationStatus",(function(){return a.isRegistered})),(0,S.Z)((0,m.Z)(a),"getDeviceId",(function(){var e;return null===(e=a.deviceInfo.device)||void 0===e?void 0:e.deviceId})),(0,S.Z)((0,m.Z)(a),"getCall",(function(e){return a.callManager.getCall(e)})),(0,S.Z)((0,m.Z)(a),"makeCall",(function(e){var t;if(e){var n=e.address.match(te.VALID_PHONE);if(n&&n[0].length===e.address.length){var r,i=e.address.replace(/[^[*+]\d#]/gi,"").replace(/\s+/gi,""),o={type:e.type,address:"tel:".concat(i)};t=a.callManager.createCall(o,J.CallDirection.OUTBOUND,null===(r=a.deviceInfo.device)||void 0===r?void 0:r.deviceId),$.default.log("New call created, callId: ".concat(t.getCallId()),{})}else{$.default.warn("Invalid phone number detected",{});var s=new ne.CallingClientError("An invalid phone number was detected. Check the number and try again.",{},K.ERROR_TYPE.CALL_ERROR,J.MobiusStatus.ACTIVE);a.emit(X.EVENT_KEYS.ERROR,s)}return t}})),a.sdkConnector=Y.default,a.sdkConnector.getWebex()||Y.default.setWebex(e),a.webex=a.sdkConnector.getWebex(),a.sdkConfig=t;var s=null!==(n=a.sdkConfig)&&void 0!==n&&null!==(r=n.serviceData)&&void 0!==r&&r.indicator?a.sdkConfig.serviceData:{indicator:J.ServiceIndicator.CALLING,domain:""};a.validateServiceData(s),a.registration=(0,Q.createRegistration)(a.webex,s),a.callManager=(0,ee.getCallManager)(a.webex,s.indicator),a.metricManager=(0,ie.getMetricManager)(a.webex,s.indicator),a.mediaEngine=B,a.primaryMobiusUris=[],a.backupMobiusUris=[],a.rehomingIntervalMin=te.DEFAULT_REHOMING_INTERVAL_MIN,a.rehomingIntervalMax=te.DEFAULT_REHOMING_INTERVAL_MAX,a.failback429RetryAttempts=0,a.clientError=(0,H.createClientError)("",{},K.ERROR_TYPE.DEFAULT,J.MobiusStatus.DEFAULT),a.isRegistered=J.MobiusStatus.DEFAULT,a.reconnectPending=!1,a.registerSessionsListener();var c=null!==(i=a.sdkConfig)&&void 0!==i&&null!==(o=i.logger)&&void 0!==o&&o.level?a.sdkConfig.logger.level:q.LOGGER.ERROR;return a.mutex=new W.Mutex,$.default.setLogger(c),a.detectNetworkChange(),a.incomingCallListener(),a.registerCallsClearedListener(),a}return(0,v.Z)(_,[{key:"getDeviceInfo",value:function(){return this.deviceInfo}},{key:"setDeviceInfo",value:function(e){this.deviceInfo=e}},{key:"isRegRetry",value:function(){return this.registerRetry}},{key:"isDeviceRegistered",value:function(){return this.isRegistered===J.MobiusStatus.ACTIVE}},{key:"setRegRetry",value:function(e){this.registerRetry=e}},{key:"setIsRegistered",value:function(e){this.isRegistered=e}},{key:"getMobiusUrl",value:function(){return this.url}},{key:"validateServiceData",value:function(e){if(!this.isValidServiceIndicator(e.indicator))throw new Error("Invalid service indicator, Allowed values are: ".concat(O()(J.ServiceIndicator)));if(!this.isValidServiceDomain(e))throw new Error("Invalid service domain.")}},{key:"isValidServiceIndicator",value:function(e){return O()(J.ServiceIndicator).some((function(t){return t===e}))}},{key:"isValidServiceDomain",value:function(e){var t=e.domain;return t?/^[a-z0-9]+([-.]{1}[a-z0-9]+)*\.[a-z]{2,6}$/i.test(t):e.indicator===J.ServiceIndicator.CALLING}},{key:"updateMobiusUris",value:function(){var e,t,n,r,i={file:te.CALLING_CLIENT_FILE,method:this.updateMobiusUris.name},o=[],a=[];if(null!==(e=this.mobiusServers)&&void 0!==e&&null!==(t=e.primary)&&void 0!==t&&t.uris){$.default.info("Adding Primary uris",i);var s,c=D(this.mobiusServers.primary.uris);try{for(c.s();!(s=c.n()).done;){var u=s.value;o.push("".concat(u).concat(te.URL_ENDPOINT))}}catch(e){c.e(e)}finally{c.f()}}if(null!==(n=this.mobiusServers)&&void 0!==n&&null!==(r=n.backup)&&void 0!==r&&r.uris){$.default.info("Adding Backup uris",i);var d,l=D(this.mobiusServers.backup.uris);try{for(l.s();!(d=l.n()).done;){var f=d.value;a.push("".concat(f).concat(te.URL_ENDPOINT))}}catch(e){l.e(e)}finally{l.f()}}$.default.info("Adding Default uri",i),o.length||a.length?a.push("".concat(this.webex.internal.services._serviceUrls.mobius).concat(te.URL_ENDPOINT)):o.push("".concat(this.webex.internal.services._serviceUrls.mobius).concat(te.URL_ENDPOINT)),this.primaryMobiusUris.length=0,this.backupMobiusUris.length=0;for(var p=0;p<o.length;p+=1)-1===this.primaryMobiusUris.indexOf(o[p])&&this.primaryMobiusUris.push(o[p]);for(var h=0;h<a.length;h+=1)-1===this.backupMobiusUris.indexOf(a[h])&&this.backupMobiusUris.push(a[h])}},{key:"incomingCallListener",value:function(){var e=this,t={file:te.CALLING_CLIENT_FILE,method:this.incomingCallListener.name};$.default.log("Listening for incoming calls... ",t),this.callManager.on(X.EVENT_KEYS.INCOMING_CALL,(function(t){e.emit(X.EVENT_KEYS.INCOMING_CALL,t)}))}},{key:"detectNetworkChange",value:(E=(0,p.Z)(C().mark((function e(){var t,n=this;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!1,setInterval((0,p.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.webex.internal.mercury.connected||t||0!==k()(n.callManager.getActiveCalls()).length||($.default.warn("Network has flapped, waiting for mercury connection to be up",{file:te.CALLING_CLIENT_FILE,method:te.NETWORK_CHANGE_DETECTION_UTIL}),n.emit(X.EVENT_KEYS.UNREGISTERED),n.clearKeepaliveTimer(),t=!0),!t||!n.webex.internal.mercury.connected){e.next=4;break}return e.next=4,n.mutex.runExclusive((0,p.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=14;break}if($.default.log("Mercury connection is up again, Re-registering with Mobius",{file:te.CALLING_CLIENT_FILE,method:te.NETWORK_CHANGE_DETECTION_UTIL}),n.clearKeepaliveTimer(),n.isRegistered!==J.MobiusStatus.ACTIVE){e.next=6;break}return e.next=6,n.deregister();case 6:if(!n.url){e.next=13;break}return e.next=9,n.restorePreviousRegistration(te.NETWORK_CHANGE_DETECTION_UTIL);case 9:if(e.sent||n.isDeviceRegistered()){e.next=13;break}return e.next=13,n.restartRegistration(te.NETWORK_CHANGE_DETECTION_UTIL);case 13:t=!1;case 14:case"end":return e.stop()}}),e)}))));case 4:case"end":return e.stop()}}),e)}))),te.NETWORK_FLAP_TIMEOUT);case 2:case"end":return e.stop()}}),e)}))),function(){return E.apply(this,arguments)})},{key:"getClientRegionInfo",value:(f=(0,p.Z)(C().mark((function e(){var t,n,r,i,o,a;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},e.prev=1,e.next=4,this.webex.request({uri:"".concat(this.webex.internal.services._serviceUrls.mobius).concat(te.URL_ENDPOINT).concat(te.IP_ENDPOINT),method:J.HTTP_METHODS.GET,headers:(n={},(0,S.Z)(n,te.CISCO_DEVICE_URL,this.webex.internal.device.url),(0,S.Z)(n,te.SPARK_USER_AGENT,te.CALLING_USER_AGENT),n),service:J.ALLOWED_SERVICES.MOBIUS});case 4:return r=e.sent,i=r.body.ipv4,e.next=8,this.webex.request({uri:"".concat(te.DISCOVERY_URL,"/").concat(i),method:J.HTTP_METHODS.GET,addAuthHeader:!1,headers:(0,S.Z)({},te.SPARK_USER_AGENT,null)});case 8:o=e.sent,a=o.body,t.clientRegion=null!=a&&a.clientRegion?a.clientRegion:"",t.countryCode=null!=a&&a.countryCode?a.countryCode:"",e.next=19;break;case 14:e.prev=14,e.t0=e.catch(1),(0,j.handleErrors)(this,e.t0,te.GET_MOBIUS_SERVERS_UTIL,te.CALLING_CLIENT_FILE),t.clientRegion="",t.countryCode="";case 19:return e.abrupt("return",t);case 20:case"end":return e.stop()}}),e,this,[[1,14]])}))),function(){return f.apply(this,arguments)})},{key:"getMobiusServers",value:(l=(0,p.Z)(C().mark((function e(){var t,n,r,i,o,a,s,c,u,d,l,f,p,h;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=!1,null===(t=this.sdkConfig)||void 0===t||null===(n=t.discovery)||void 0===n||!n.country||null===(r=this.sdkConfig)||void 0===r||null===(i=r.discovery)||void 0===i||!i.region){e.next=7;break}$.default.info("Updating region and country from the SDK config",{file:te.CALLING_CLIENT_FILE,method:te.GET_MOBIUS_SERVERS_UTIL}),a=null===(c=this.sdkConfig)||void 0===c||null===(u=c.discovery)||void 0===u?void 0:u.region,s=null===(d=this.sdkConfig)||void 0===d||null===(l=d.discovery)||void 0===l?void 0:l.country,e.next=13;break;case 7:return $.default.info("Updating region and country through Region discovery",{file:te.CALLING_CLIENT_FILE,method:te.GET_MOBIUS_SERVERS_UTIL}),e.next=10,this.getClientRegionInfo();case 10:f=e.sent,a=f.clientRegion,s=f.countryCode;case 13:if(!a||!s){e.next=30;break}return $.default.log("Found Region: ".concat(a," and country: ").concat(s,", going to fetch Mobius server"),""),e.prev=15,e.next=18,this.webex.request({uri:"".concat(this.webex.internal.services._serviceUrls.mobius).concat(te.URL_ENDPOINT,"?regionCode=").concat(a,"&countryCode=").concat(s),method:J.HTTP_METHODS.GET,headers:(p={},(0,S.Z)(p,te.CISCO_DEVICE_URL,this.webex.internal.device.url),(0,S.Z)(p,te.SPARK_USER_AGENT,te.CALLING_USER_AGENT),p),service:J.ALLOWED_SERVICES.MOBIUS});case 18:h=e.sent,$.default.log("Mobius Server found for the region",""),this.mobiusServers=h.body,this.updateMobiusUris(),e.next=28;break;case 24:e.prev=24,e.t0=e.catch(15),(0,j.handleErrors)(this,e.t0,te.GET_MOBIUS_SERVERS_UTIL,te.CALLING_CLIENT_FILE),o=!0;case 28:e.next=31;break;case 30:o=!0;case 31:o&&($.default.warn("Error in finding Mobius Servers. Will use the default URL.",""),this.primaryMobiusUris.push("".concat(this.webex.internal.services._serviceUrls.mobius).concat(te.URL_ENDPOINT)));case 32:case"end":return e.stop()}}),e,this,[[15,24]])}))),function(){return l.apply(this,arguments)})},{key:"sendKeepAlive",value:(d=(0,p.Z)(C().mark((function e(t){var n,r,i,o,a,s,c,u=this;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=null===(n=t.device)||void 0===n?void 0:n.deviceId,o=t.keepaliveInterval,a=null===(r=t.device)||void 0===r?void 0:r.uri,s=0,c={file:te.CALLING_CLIENT_FILE,method:te.KEEPALIVE_UTIL},this.clearKeepaliveTimer(),$.default.info("Fetched details :-> deviceId: ".concat(i,", interval :-> ").concat(o,", url: ").concat(a),c),this.isDeviceRegistered()?this.keepaliveTimer=setInterval((0,p.Z)(C().mark((function e(){var t;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.url,e.next=3,u.mutex.runExclusive((0,p.Z)(C().mark((function e(){var n,r,i;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(u.isDeviceRegistered()&&t===u.url&&s<5)){e.next=29;break}return e.prev=1,e.next=4,u.registration.postKeepAlive(a);case 4:n=e.sent,$.default.log("Sent Keepalive, status: ".concat(n.statusCode),c),s>0&&u.emit(X.EVENT_KEYS.RECONNECTED),s=0,e.next=29;break;case 10:return e.prev=10,e.t0=e.catch(1),s+=1,r=e.t0,$.default.warn("Keep-alive missed ".concat(s," times. Status -> ").concat(r.statusCode," "),c),e.next=17,(0,j.handleErrors)(u,r,te.KEEPALIVE_UTIL,te.CALLING_CLIENT_FILE);case 17:if(!((i=e.sent)||s>=5)){e.next=28;break}if(u.isRegistered=J.MobiusStatus.DEFAULT,u.clearKeepaliveTimer(),u.clearFailbackTimer(),u.emit(X.EVENT_KEYS.UNREGISTERED),i){e.next=26;break}return e.next=26,u.reconnectOnFailure(te.KEEPALIVE_UTIL);case 26:e.next=29;break;case 28:u.emit(X.EVENT_KEYS.RECONNECTING);case 29:case"end":return e.stop()}}),e,null,[[1,10]])}))));case 3:case"end":return e.stop()}}),e)}))),1e3*o):$.default.warn("Device is not active, exiting.",c);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"reconnectOnFailure",value:(u=(0,p.Z)(C().mark((function e(t){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.reconnectPending=!1,this.isDeviceRegistered()){e.next=13;break}if(0!==k()(this.callManager.getActiveCalls()).length){e.next=11;break}return e.next=5,this.restorePreviousRegistration(t);case 5:if(e.sent||this.isDeviceRegistered()){e.next=9;break}return e.next=9,this.restartRegistration(t);case 9:e.next=13;break;case 11:this.reconnectPending=!0,$.default.log("Active call(s) present, deferred reconnect till call cleanup.",{file:te.CALLING_CLIENT_FILE,method:te.RECONNECT_UTIL});case 13:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"clearKeepaliveTimer",value:function(){this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=void 0)}},{key:"registerCallsClearedListener",value:function(){var e={file:te.CALLING_CLIENT_FILE,method:this.registerCallsClearedListener.name};$.default.log("Registering listener for all calls cleared event",e),this.callManager.on(X.EVENT_KEYS.ALL_CALLS_CLEARED,this.callsClearedHandler)}},{key:"register",value:(c=(0,p.Z)(C().mark((function e(t){var n=this;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.mutex.runExclusive((0,p.Z)(C().mark((function e(){var r;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=5;break}return n.isRegistered=J.MobiusStatus.DEFAULT,n.emit(X.EVENT_KEYS.CONNECTING),e.next=5,n.getMobiusServers();case 5:return e.next=7,n.registerDevice(n.register.name);case 7:if(r=e.sent,n.isDeviceRegistered()||t||r){e.next=11;break}return e.next=11,n.startFailoverTimer();case 11:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"registerDevice",value:(s=(0,p.Z)(C().mark((function e(t){var n,r,i,o,a,s,c,u=arguments;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=u.length>1&&void 0!==u[1]?u[1]:this.primaryMobiusUris,r=!1,!this.isDeviceRegistered()){e.next=5;break}return $.default.log("[".concat(t,"] : Device already registered with : ").concat(this.url),{file:te.CALLING_CLIENT_FILE,method:te.REGISTER_UTIL}),e.abrupt("return",r);case 5:i=D(n),e.prev=6,i.s();case 8:if((o=i.n()).done){e.next=53;break}return a=o.value,e.prev=10,r=!1,this.isRegistered=J.MobiusStatus.DEFAULT,this.emit(X.EVENT_KEYS.CONNECTING),$.default.log("[".concat(t,"] : Mobius url to contact: ").concat(a),{file:te.CALLING_CLIENT_FILE,method:te.REGISTER_UTIL}),e.next=17,this.registration.createDevice(a);case 17:return s=e.sent,this.deviceInfo=s.body,this.emit(X.EVENT_KEYS.REGISTERED,s.body),this.isRegistered=J.MobiusStatus.ACTIVE,this.reconnectPending=!1,this.setMobiusUrl(a),this.setIntervalValues(this.deviceInfo),this.metricManager.setDeviceInfo(this.deviceInfo),this.metricManager.submitRegistrationMetric(re.METRIC_EVENT.REGISTRATION,re.REG_ACTION.REGISTER,re.METRIC_TYPE.BEHAVIORAL,void 0),this.sendKeepAlive(this.deviceInfo),this.initiateFailback(),e.abrupt("break",53);case 31:return e.prev=31,e.t0=e.catch(10),c=e.t0,e.next=36,(0,j.handleErrors)(this,c,te.REGISTER_UTIL,te.CALLING_CLIENT_FILE);case 36:if(r=e.sent,this.isRegistered!==J.MobiusStatus.ACTIVE){e.next=40;break}return $.default.info("[".concat(t,"] : Device is already restored, active mobius url: ").concat(this.getMobiusUrl()),{file:te.CALLING_CLIENT_FILE,method:te.REGISTER_UTIL}),e.abrupt("break",53);case 40:if(!r){e.next=44;break}return e.abrupt("break",53);case 44:if(t!==te.FAILBACK_UTIL){e.next=51;break}if(!(c.statusCode===K.ERROR_CODE.TOO_MANY_REQUESTS&&this.failback429RetryAttempts<te.REG_FAILBACK_429_MAX_RETRIES)){e.next=51;break}return e.next=49,this.scheduleFailback429Retry();case 49:return r=!0,e.abrupt("break",53);case 51:e.next=8;break;case 53:e.next=58;break;case 55:e.prev=55,e.t1=e.catch(6),i.e(e.t1);case 58:return e.prev=58,i.f(),e.finish(58);case 61:return e.abrupt("return",r);case 62:case"end":return e.stop()}}),e,this,[[6,55,58,61],[10,31]])}))),function(e){return s.apply(this,arguments)})},{key:"scheduleFailback429Retry",value:(a=(0,p.Z)(C().mark((function e(){var t;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.clearFailbackTimer(),this.failback429RetryAttempts+=1,$.default.log("Received 429 while rehoming, 429 retry count : ".concat(this.failback429RetryAttempts),{file:te.CALLING_CLIENT_FILE,method:te.FAILBACK_429_RETRY_UTIL}),t=this.getRegRetryInterval(this.failback429RetryAttempts),this.startFailbackTimer(t),e.next=7,this.restorePreviousRegistration(te.FAILBACK_429_RETRY_UTIL);case 7:if(e.sent||this.isDeviceRegistered()){e.next=11;break}return e.next=11,this.restartRegistration(te.FAILBACK_429_RETRY_UTIL);case 11:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"getRegRetryInterval",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return te.BASE_REG_RETRY_TIMER_VAL_IN_SEC+Math.pow(te.BASE_REG_TIMER_MFACTOR,e)+Math.floor((Math.random()*(te.REG_RANDOM_T_FACTOR_UPPER_LIMIT-te.SEC_TO_MSEC_MFACTOR+1)+te.SEC_TO_MSEC_MFACTOR)/te.SEC_TO_MSEC_MFACTOR)}},{key:"startFailoverTimer",value:(o=(0,p.Z)(C().mark((function e(){var t,n,r,i,o,a,s=this,c=arguments;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=c.length>0&&void 0!==c[0]?c[0]:1,n=c.length>1&&void 0!==c[1]?c[1]:0,r=this.getRegRetryInterval(t),n+r>te.REG_TRY_BACKUP_TIMER_VAL_IN_SEC&&(i=n+r-te.REG_TRY_BACKUP_TIMER_VAL_IN_SEC,r-=i),!(r>te.BASE_REG_RETRY_TIMER_VAL_IN_SEC)){e.next=10;break}a=Math.floor(N()()/1e3),setTimeout((0,p.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.mutex.runExclusive((0,p.Z)(C().mark((function e(){var r;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.registerDevice(te.FAILOVER_UTIL);case 2:if(o=e.sent,r=Math.floor(N()()/1e3),o||s.isDeviceRegistered()){e.next=7;break}return e.next=7,s.startFailoverTimer(t+1,n+(r-a));case 7:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e)}))),r*te.SEC_TO_MSEC_MFACTOR),$.default.log("Scheduled retry with primary in ".concat(r," seconds, number of attempts : ").concat(t),{file:te.CALLING_CLIENT_FILE,method:te.FAILOVER_UTIL}),e.next=19;break;case 10:if(!this.backupMobiusUris.length){e.next=18;break}return $.default.log("Failing over to backup servers.",{file:te.CALLING_CLIENT_FILE,method:te.FAILOVER_UTIL}),e.next=14,this.registerDevice(te.FAILOVER_UTIL,this.backupMobiusUris);case 14:(o=e.sent)||this.isDeviceRegistered()||(r=this.getRegRetryInterval(),setTimeout((0,p.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.mutex.runExclusive((0,p.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.registerDevice(te.FAILOVER_UTIL,s.backupMobiusUris);case 2:(o=e.sent)||s.isDeviceRegistered()||(0,j.emitFinalFailure)(s,te.FAILOVER_UTIL,te.CALLING_CLIENT_FILE);case 4:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e)}))),r*te.SEC_TO_MSEC_MFACTOR),$.default.log("Scheduled retry with backup servers in ".concat(r," seconds."),{file:te.CALLING_CLIENT_FILE,method:te.FAILOVER_UTIL})),e.next=19;break;case 18:(0,j.emitFinalFailure)(this,te.FAILOVER_UTIL,te.CALLING_CLIENT_FILE);case 19:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"clearFailbackTimer",value:function(){this.failbackTimer&&(clearTimeout(this.failbackTimer),this.failbackTimer=void 0)}},{key:"failbackRequired",value:function(){return this.isDeviceRegistered()&&-1===this.primaryMobiusUris.indexOf(this.url)}},{key:"getFailbackInterval",value:function(){return Math.floor(Math.random()*(this.rehomingIntervalMax-this.rehomingIntervalMin+1)+this.rehomingIntervalMin)}},{key:"initiateFailback",value:function(){if(this.failbackRequired()){if(!this.failbackTimer){this.failback429RetryAttempts=0;var e=this.getFailbackInterval();this.startFailbackTimer(e*te.MINUTES_TO_SEC_MFACTOR)}}else this.failback429RetryAttempts=0,this.clearFailbackTimer()}},{key:"startFailbackTimer",value:function(e){var t=this;this.failbackTimer=setTimeout((0,p.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.executeFailback());case 1:case"end":return e.stop()}}),e)}))),e*te.SEC_TO_MSEC_MFACTOR),$.default.log("Failback scheduled after ".concat(e," seconds."),{file:te.CALLING_CLIENT_FILE,method:this.startFailbackTimer.name})}},{key:"executeFailback",value:(i=(0,p.Z)(C().mark((function e(){var t=this;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.mutex.runExclusive((0,p.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.failbackRequired()){e.next=27;break}if(0!==k()(t.callManager.getActiveCalls()).length){e.next=24;break}return $.default.log("Attempting failback to primary.",{file:te.CALLING_CLIENT_FILE,method:te.FAILBACK_UTIL}),e.next=5,t.deregister();case 5:return e.next=7,t.registerDevice(te.FAILBACK_UTIL);case 7:if(e.sent||t.isDeviceRegistered()){e.next=22;break}return e.next=11,t.restorePreviousRegistration(te.FAILBACK_UTIL);case 11:if(!e.sent){e.next=15;break}return t.clearFailbackTimer(),e.abrupt("return");case 15:if(t.isDeviceRegistered()){e.next=20;break}return e.next=18,t.restartRegistration(te.FAILBACK_UTIL);case 18:e.next=22;break;case 20:t.failbackTimer=void 0,t.initiateFailback();case 22:e.next=27;break;case 24:$.default.log("Active calls present, deferring failback to next cycle.",{file:te.CALLING_CLIENT_FILE,method:te.FAILBACK_UTIL}),t.failbackTimer=void 0,t.initiateFailback();case 27:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"restartRegistration",value:(r=(0,p.Z)(C().mark((function e(t){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.clearFailbackTimer(),this.failback429RetryAttempts=0,e.next=4,this.registerDevice(t);case 4:if(e.sent||this.isDeviceRegistered()){e.next=8;break}return e.next=8,this.startFailoverTimer();case 8:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"restorePreviousRegistration",value:(n=(0,p.Z)(C().mark((function e(t){var n;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!1,!this.url){e.next=5;break}return e.next=4,this.registerDevice(t,[this.url]);case 4:n=e.sent;case 5:return e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"setIntervalValues",value:function(e){-1!==this.primaryMobiusUris.indexOf(this.url)&&(this.rehomingIntervalMin=null!=e&&e.rehomingIntervalMin?e.rehomingIntervalMin:te.DEFAULT_REHOMING_INTERVAL_MIN,this.rehomingIntervalMax=null!=e&&e.rehomingIntervalMax?e.rehomingIntervalMax:te.DEFAULT_REHOMING_INTERVAL_MAX)}},{key:"getLoggingLevel",value:function(){return $.default.getLogLevel()}},{key:"setMobiusUrl",value:function(e){this.url=e,this.callManager.updateActiveMobius(this.url)}},{key:"deregister",value:(t=(0,p.Z)(C().mark((function e(){var t,n;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.registration.deleteDevice(this.url,null===(t=this.deviceInfo.device)||void 0===t?void 0:t.deviceId,null===(n=this.deviceInfo.device)||void 0===n?void 0:n.clientDeviceUri);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),$.default.warn("Delete failed with Mobius",{});case 8:this.clearKeepaliveTimer(),this.isRegistered=J.MobiusStatus.DEFAULT,this.metricManager.submitRegistrationMetric(re.METRIC_EVENT.REGISTRATION,re.REG_ACTION.DEREGISTER,re.METRIC_TYPE.BEHAVIORAL,void 0);case 11:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(){return t.apply(this,arguments)})},{key:"getSDKConnector",value:function(){return this.sdkConnector}},{key:"registerSessionsListener",value:function(){var e=this;this.sdkConnector.registerListener(X.MOBIUS_EVENT_KEYS.CALL_SESSION_EVENT_INCLUSIVE,function(){var t=(0,p.Z)(C().mark((function t(n){var r,i;return C().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n||!n.data.userSessions.userSessions){t.next=7;break}if(1!==(r=null==n?void 0:n.data.userSessions.userSessions).length){t.next=5;break}if(r[0].sessionType===X.SessionType.WEBEX_CALLING){t.next=5;break}return t.abrupt("return");case 5:for(i=0;i<r.length;i+=1)r[i].sessionType!==X.SessionType.WEBEX_CALLING&&r.splice(i,1);e.emit(X.EVENT_KEYS.USER_SESSION_INFO,n);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"sendMetric",value:function(e,t,n,r){this.metricManager.submitRegistrationMetric(e,t,n,r)}}]),_}(z.Eventing);exports.CallingClient=oe;exports.createClient=function(e,t){return new oe(e,t)}},51290:(e,t,n)=>{"use strict";n.r(t);var r=n(66250),i=n(8167),o=n(31314),a=n(77193),s=n(33453),c=n.n(s),u=n(26771),d=function(e){return e&&e.__esModule?e:{default:e}};n.n(u)()(exports,"__esModule",{value:!0}),exports.createCallerId=exports.CallerId=void 0;var l=d(n(41309)),f=n(74364),p=d(n(4983)),h=n(29086),v=function(){function e(t,n){(0,i.Z)(this,e),(0,a.Z)(this,"webex",void 0),(0,a.Z)(this,"callerInfo",void 0),(0,a.Z)(this,"sdkConnector",void 0),(0,a.Z)(this,"emitter",void 0),this.sdkConnector=p.default,this.callerInfo={},this.sdkConnector.getWebex()||p.default.setWebex(t),this.webex=this.sdkConnector.getWebex(),this.emitter=n}var t,n;return(0,o.Z)(e,[{key:"resolveCallerId",value:(n=(0,r.Z)(c().mark((function e(t){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.resolveCallerIdDisplay)(t);case 2:n=e.sent,r=!1,n.name&&this.callerInfo.name!==n.name&&(l.default.info("Updating Name after resolution",{file:f.CALLER_ID_FILE,method:"resolveCallerId"}),this.callerInfo.name=n.name,r=!0),n.num&&this.callerInfo.num!==n.num&&(l.default.info("Updating Number after resolution",{file:f.CALLER_ID_FILE,method:"resolveCallerId"}),this.callerInfo.num=n.num,r=!0),this.callerInfo.avatarSrc&&this.callerInfo.avatarSrc===n.avatarSrc||(l.default.info("Updating Avatar Id after resolution",{file:f.CALLER_ID_FILE,method:"resolveCallerId"}),this.callerInfo.avatarSrc=n.avatarSrc,r=!0),this.callerInfo.id&&this.callerInfo.id===n.id||(l.default.info("Updating User Id after resolution",{file:f.CALLER_ID_FILE,method:"resolveCallerId"}),this.callerInfo.id=n.id,r=!0),r&&this.emitter(this.callerInfo);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"parseRemotePartyInfo",value:(t=(0,r.Z)(c().mark((function e(t){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=t.split(";").slice(-1)[0]).includes("externalId")?(r=n.split("=")[1],l.default.info("externalId retrieved: ".concat(r),{file:f.CALLER_ID_FILE,method:"parseRemotePartyInfo"}),this.resolveCallerId('id eq "'.concat(r,'"'))):l.default.warn("externalId not found!",{file:f.CALLER_ID_FILE,method:"parseRemotePartyInfo"});case 2:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"parseSipUri",value:function(e){var t={},n=e.split("@")[0].replace(/"/g,""),r=f.FETCH_NAME.exec(n),i=n.substring(n.indexOf(":")+1,n.length);r?(t.name=r[0].trimEnd(),l.default.info("Parsed Name: ".concat(t.name),{file:f.CALLER_ID_FILE,method:"parseSipUri"})):l.default.warn("Name field not found!",{file:f.CALLER_ID_FILE,method:"parseSipUri"});var o=i.match(f.VALID_PHONE);return o&&o[0].length===i.length?(t.num=i,l.default.info("Parsed Number: ".concat(t.num),{file:f.CALLER_ID_FILE,method:"parseSipUri"})):l.default.warn("Number field not found!",{file:f.CALLER_ID_FILE,method:"parseSipUri"}),t}},{key:"fetchCallerDetails",value:function(e){if(this.callerInfo.id=void 0,this.callerInfo.avatarSrc=void 0,this.callerInfo.name=void 0,this.callerInfo.num=void 0,"p-asserted-identity"in e){l.default.info("Parsing p-asserted-identity:- ".concat(e["p-asserted-identity"]),{file:f.CALLER_ID_FILE,method:"fetchCallerDetails"});var t=this.parseSipUri(e["p-asserted-identity"]);this.callerInfo.name=t.name,this.callerInfo.num=t.num,l.default.info("CallerId retrieved from p-asserted-identity: name: ".concat(this.callerInfo.name," , num: ").concat(this.callerInfo.num),{file:f.CALLER_ID_FILE,method:"fetchCallerDetails"})}if(e.from){l.default.info("Parsing from header:- ".concat(e.from),{file:f.CALLER_ID_FILE,method:"fetchCallerDetails"});var n=this.parseSipUri(e.from);l.default.info("CallerId retrieved from FROM: name: ".concat(n.name," , num: ").concat(n.num),{file:f.CALLER_ID_FILE,method:"fetchCallerDetails"}),!this.callerInfo.name&&n.name&&(l.default.info("Updating name field from From header",{file:f.CALLER_ID_FILE,method:"fetchCallerDetails"}),this.callerInfo.name=n.name),!this.callerInfo.num&&n.num&&(l.default.info("Updating number field from From header",{file:f.CALLER_ID_FILE,method:"fetchCallerDetails"}),this.callerInfo.num=n.num)}return(this.callerInfo.name||this.callerInfo.num)&&this.emitter(this.callerInfo),"x-broadworks-remote-party-info"in e&&(l.default.info("Parsing x-broadworks-remote-party-info:- ".concat(e["x-broadworks-remote-party-info"]),{file:f.CALLER_ID_FILE,method:"fetchCallerDetails"}),this.parseRemotePartyInfo(e["x-broadworks-remote-party-info"])),l.default.log("Intermediate callerId :- name: ".concat(this.callerInfo.name," , num: ").concat(this.callerInfo.num),{file:f.CALLER_ID_FILE,method:"fetchCallerDetails"}),this.callerInfo}}]),e}();exports.CallerId=v;exports.createCallerId=function(e,t){return new v(e,t)}},6599:(e,t,n)=>{"use strict";n.r(t);var r=n(63755),i=n.n(r),o=n(66250),a=n(8167),s=n(31314),c=n(23710),u=n(69678),d=n(26305),l=n(35002),f=n(77193),p=n(33453),h=n.n(p),v=n(26771),m=n.n(v),g=n(8450),E=n.n(g),y=n(18428),S=n.n(y);function _(e){var t=function(){if("undefined"==typeof Reflect||!i())return!1;if(i().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,l.Z)(e);if(t){var o=(0,l.Z)(this).constructor;n=i()(r,arguments,o)}else n=r.apply(this,arguments);return(0,d.Z)(this,n)}}var C=function(e){return e&&e.__esModule?e:{default:e}};m()(exports,"__esModule",{value:!0}),exports.createCall=exports.Call=void 0;var R=n(72038),T=n(7836),x=n(44940),b=n(32064),w=n(21471),I=n(14830),L=n(33846),O=n(74364),A=C(n(4983)),k=n(29004),M=n(93800),N=n(82060),D=C(n(41309)),P=n(51290),F=n(13563),U=n(40241),Z=n(93698),V=function(e){(0,u.Z)(z,e);var t,n,r,i,d,l,p,v,m,g,y,C,k,V,G,B,W,j,H,K,q,Y=_(z);function z(e,t,n,r,i,s,u){var d;(0,a.Z)(this,z),d=Y.call(this),(0,f.Z)((0,c.Z)(d),"sdkConnector",void 0),(0,f.Z)((0,c.Z)(d),"webex",void 0),(0,f.Z)((0,c.Z)(d),"destination",void 0),(0,f.Z)((0,c.Z)(d),"direction",void 0),(0,f.Z)((0,c.Z)(d),"callId",void 0),(0,f.Z)((0,c.Z)(d),"correlationId",void 0),(0,f.Z)((0,c.Z)(d),"deviceId",void 0),(0,f.Z)((0,c.Z)(d),"disconnectReason",void 0),(0,f.Z)((0,c.Z)(d),"callStateMachine",void 0),(0,f.Z)((0,c.Z)(d),"mediaStateMachine",void 0),(0,f.Z)((0,c.Z)(d),"seq",void 0),(0,f.Z)((0,c.Z)(d),"mediaConnection",void 0),(0,f.Z)((0,c.Z)(d),"earlyMedia",void 0),(0,f.Z)((0,c.Z)(d),"connected",void 0),(0,f.Z)((0,c.Z)(d),"callerInfo",void 0),(0,f.Z)((0,c.Z)(d),"localRoapMessage",void 0),(0,f.Z)((0,c.Z)(d),"mobiusUrl",void 0),(0,f.Z)((0,c.Z)(d),"remoteRoapMessage",void 0),(0,f.Z)((0,c.Z)(d),"deleteCb",void 0),(0,f.Z)((0,c.Z)(d),"callerId",void 0),(0,f.Z)((0,c.Z)(d),"sessionTimer",void 0),(0,f.Z)((0,c.Z)(d),"supplementaryServicesTimer",void 0),(0,f.Z)((0,c.Z)(d),"muted",void 0),(0,f.Z)((0,c.Z)(d),"held",void 0),(0,f.Z)((0,c.Z)(d),"metricManager",void 0),(0,f.Z)((0,c.Z)(d),"broadworksCorrelationInfo",void 0),(0,f.Z)((0,c.Z)(d),"serviceIndicator",void 0),(0,f.Z)((0,c.Z)(d),"waitingForOK",void 0),(0,f.Z)((0,c.Z)(d),"getDirection",(function(){return d.direction})),(0,f.Z)((0,c.Z)(d),"getCallId",(function(){return d.callId})),(0,f.Z)((0,c.Z)(d),"getCorrelationId",(function(){return d.correlationId})),(0,f.Z)((0,c.Z)(d),"setCallId",(function(e){d.callId=e,D.default.info("Setting callId : ".concat(d.callId," for correlationId: ").concat(d.correlationId),{file:O.CALL_FILE,method:d.setCallId.name})})),(0,f.Z)((0,c.Z)(d),"getDisconnectReason",(function(){return d.disconnectReason})),(0,f.Z)((0,c.Z)(d),"post",function(){var e=(0,o.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",d.webex.request({uri:"".concat(d.mobiusUrl).concat(O.DEVICES_ENDPOINT_RESOURCE,"/").concat(d.deviceId,"/").concat(O.CALL_ENDPOINT_RESOURCE),method:I.HTTP_METHODS.POST,service:I.ALLOWED_SERVICES.MOBIUS,headers:(n={},(0,f.Z)(n,O.CISCO_DEVICE_URL,d.webex.internal.device.url),(0,f.Z)(n,O.SPARK_USER_AGENT,O.CALLING_USER_AGENT),n),body:{device:{deviceId:d.deviceId,correlationId:d.correlationId},callee:{type:d.destination.type,address:d.destination.address},localMedia:{roap:t,mediaId:(0,x.v4)()}}}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,f.Z)((0,c.Z)(d),"getCallerInfo",(function(){return d.callerInfo})),(0,f.Z)((0,c.Z)(d),"end",(function(){d.sendCallStateMachineEvt({type:"E_SEND_CALL_DISCONNECT"})})),(0,f.Z)((0,c.Z)(d),"doHoldResume",(function(){d.held?d.sendCallStateMachineEvt({type:"E_CALL_RESUME"}):d.sendCallStateMachineEvt({type:"E_CALL_HOLD"})})),(0,f.Z)((0,c.Z)(d),"mute",(function(e){d.muted?(e.enabled=!0,d.muted=!1):(e.enabled=!1,d.muted=!0)})),d.destination=n,d.direction=r,d.sdkConnector=A.default,d.deviceId=i,d.serviceIndicator=u,d.sdkConnector.getWebex()||A.default.setWebex(t),d.webex=d.sdkConnector.getWebex(),d.metricManager=(0,U.getMetricManager)(d.webex,d.serviceIndicator),d.callId="".concat(O.DEFAULT_LOCAL_CALL_ID,"_").concat((0,x.v4)()),d.correlationId=(0,x.v4)(),d.deleteCb=s,d.connected=!1,d.held=!1,d.earlyMedia=!1,d.callerInfo={},d.localRoapMessage={},d.mobiusUrl=e,d.waitingForOK=!1,D.default.info("Mobius Url:- ".concat(d.mobiusUrl),{file:O.CALL_FILE,method:"constructor"}),d.seq=O.INITIAL_SEQ_NUMBER,d.callerId=(0,P.createCallerId)(t,(function(e){d.callerInfo=e;var t={correlationId:d.correlationId,callerId:d.callerInfo};d.emit(M.EVENT_KEYS.CALLER_ID,t)})),d.remoteRoapMessage=null,d.disconnectReason={code:N.DisconnectCode.NORMAL,cause:N.DisconnectCause.NORMAL};var l=(0,T.createMachine)({schema:{context:{},events:{}},id:"call-state",initial:"S_IDLE",context:{},states:{S_IDLE:{on:{E_RECV_CALL_SETUP:{target:"S_RECV_CALL_SETUP",actions:["incomingCallSetup"]},E_SEND_CALL_SETUP:{target:"S_SEND_CALL_SETUP",actions:["outgoingCallSetup"]},E_RECV_CALL_DISCONNECT:{target:"S_RECV_CALL_DISCONNECT",actions:["incomingCallDisconnect"]},E_SEND_CALL_DISCONNECT:{target:"S_SEND_CALL_DISCONNECT",actions:["outgoingCallDisconnect"]},E_UNKNOWN:{target:"S_UNKNOWN",actions:["unknownState"]}}},S_RECV_CALL_SETUP:{on:{E_SEND_CALL_ALERTING:{target:"S_SEND_CALL_PROGRESS",actions:["outgoingCallAlerting"]},E_RECV_CALL_DISCONNECT:{target:"S_RECV_CALL_DISCONNECT",actions:["incomingCallDisconnect"]},E_SEND_CALL_DISCONNECT:{target:"S_SEND_CALL_DISCONNECT",actions:["outgoingCallDisconnect"]},E_UNKNOWN:{target:"S_UNKNOWN",actions:["unknownState"]}}},S_SEND_CALL_SETUP:{on:{E_RECV_CALL_PROGRESS:{target:"S_RECV_CALL_PROGRESS",actions:["incomingCallProgress"]},E_RECV_CALL_DISCONNECT:{target:"S_RECV_CALL_DISCONNECT",actions:["incomingCallDisconnect"]},E_SEND_CALL_DISCONNECT:{target:"S_SEND_CALL_DISCONNECT",actions:["outgoingCallDisconnect"]},E_UNKNOWN:{target:"S_UNKNOWN",actions:["unknownState"]}}},S_RECV_CALL_PROGRESS:{on:{E_RECV_CALL_CONNECT:{target:"S_RECV_CALL_CONNECT",actions:["incomingCallConnect"]},E_RECV_CALL_DISCONNECT:{target:"S_RECV_CALL_DISCONNECT",actions:["incomingCallDisconnect"]},E_SEND_CALL_DISCONNECT:{target:"S_SEND_CALL_DISCONNECT",actions:["outgoingCallDisconnect"]},E_RECV_CALL_PROGRESS:{target:"S_RECV_CALL_PROGRESS",actions:["incomingCallProgress"]},E_UNKNOWN:{target:"S_UNKNOWN",actions:["unknownState"]}}},S_SEND_CALL_PROGRESS:{on:{E_SEND_CALL_CONNECT:{target:"S_SEND_CALL_CONNECT",actions:["outgoingCallConnect"]},E_RECV_CALL_DISCONNECT:{target:"S_RECV_CALL_DISCONNECT",actions:["incomingCallDisconnect"]},E_SEND_CALL_DISCONNECT:{target:"S_SEND_CALL_DISCONNECT",actions:["outgoingCallDisconnect"]},E_UNKNOWN:{target:"S_UNKNOWN",actions:["unknownState"]}}},S_RECV_CALL_CONNECT:{on:{E_CALL_ESTABLISHED:{target:"S_CALL_ESTABLISHED",actions:["callEstablished"]},E_RECV_CALL_DISCONNECT:{target:"S_RECV_CALL_DISCONNECT",actions:["incomingCallDisconnect"]},E_SEND_CALL_DISCONNECT:{target:"S_SEND_CALL_DISCONNECT",actions:["outgoingCallDisconnect"]},E_UNKNOWN:{target:"S_UNKNOWN",actions:["unknownState"]}}},S_SEND_CALL_CONNECT:{on:{E_CALL_ESTABLISHED:{target:"S_CALL_ESTABLISHED",actions:["callEstablished"]},E_RECV_CALL_DISCONNECT:{target:"S_RECV_CALL_DISCONNECT",actions:["incomingCallDisconnect"]},E_SEND_CALL_DISCONNECT:{target:"S_SEND_CALL_DISCONNECT",actions:["outgoingCallDisconnect"]},E_UNKNOWN:{target:"S_UNKNOWN",actions:["unknownState"]}}},S_CALL_HOLD:{on:{E_RECV_CALL_DISCONNECT:{target:"S_RECV_CALL_DISCONNECT",actions:["incomingCallDisconnect"]},E_SEND_CALL_DISCONNECT:{target:"S_SEND_CALL_DISCONNECT",actions:["outgoingCallDisconnect"]},E_CALL_ESTABLISHED:{target:"S_CALL_ESTABLISHED",actions:["callEstablished"]},E_UNKNOWN:{target:"S_UNKNOWN",actions:["unknownState"]}}},S_CALL_RESUME:{on:{E_RECV_CALL_DISCONNECT:{target:"S_RECV_CALL_DISCONNECT",actions:["incomingCallDisconnect"]},E_SEND_CALL_DISCONNECT:{target:"S_SEND_CALL_DISCONNECT",actions:["outgoingCallDisconnect"]},E_CALL_ESTABLISHED:{target:"S_CALL_ESTABLISHED",actions:["callEstablished"]},E_UNKNOWN:{target:"S_UNKNOWN",actions:["unknownState"]}}},S_CALL_ESTABLISHED:{on:{E_CALL_HOLD:{target:"S_CALL_HOLD",actions:["initiateCallHold"]},E_CALL_RESUME:{target:"S_CALL_RESUME",actions:["initiateCallResume"]},E_RECV_CALL_DISCONNECT:{target:"S_RECV_CALL_DISCONNECT",actions:["incomingCallDisconnect"]},E_SEND_CALL_DISCONNECT:{target:"S_SEND_CALL_DISCONNECT",actions:["outgoingCallDisconnect"]},E_CALL_ESTABLISHED:{target:"S_CALL_ESTABLISHED",actions:["callEstablished"]},E_UNKNOWN:{target:"S_UNKNOWN",actions:["unknownState"]}}},S_RECV_CALL_DISCONNECT:{on:{E_CALL_CLEARED:"S_CALL_CLEARED"}},S_SEND_CALL_DISCONNECT:{on:{E_CALL_CLEARED:"S_CALL_CLEARED"}},S_UNKNOWN:{on:{E_CALL_CLEARED:"S_CALL_CLEARED"}},S_ERROR:{on:{E_CALL_CLEARED:"S_CALL_CLEARED"}},S_CALL_CLEARED:{type:"final"}}},{actions:{incomingCallSetup:function(e,t){return d.handleIncomingCallSetup(t)},outgoingCallSetup:function(e,t){return d.handleOutgoingCallSetup(t)},incomingCallProgress:function(e,t){return d.handleIncomingCallProgress(t)},outgoingCallAlerting:function(e,t){return d.handleOutgoingCallAlerting(t)},incomingCallConnect:function(e,t){return d.handleIncomingCallConnect(t)},outgoingCallConnect:function(e,t){return d.handleOutgoingCallConnect(t)},callEstablished:function(e,t){return d.handleCallEstablished(t)},initiateCallHold:function(e,t){return d.handleCallHold(t)},initiateCallResume:function(e,t){return d.handleCallResume(t)},incomingCallDisconnect:function(e,t){return d.handleIncomingCallDisconnect(t)},outgoingCallDisconnect:function(e,t){return d.handleOutgoingCallDisconnect(t)},unknownState:function(e,t){return d.handleUnknownState(t)}}}),p=(0,T.createMachine)({schema:{context:{},events:{}},id:"roap-state",initial:"S_ROAP_IDLE",context:{},states:{S_ROAP_IDLE:{on:{E_RECV_ROAP_OFFER_REQUEST:{target:"S_RECV_ROAP_OFFER_REQUEST",actions:["incomingRoapOfferRequest"]},E_RECV_ROAP_OFFER:{target:"S_RECV_ROAP_OFFER",actions:["incomingRoapOffer"]},E_SEND_ROAP_OFFER:{target:"S_SEND_ROAP_OFFER",actions:["outgoingRoapOffer"]}}},S_RECV_ROAP_OFFER_REQUEST:{on:{E_SEND_ROAP_OFFER:{target:"S_SEND_ROAP_OFFER",actions:["outgoingRoapOffer"]},E_ROAP_OK:{target:"S_ROAP_OK",actions:["roapEstablished"]},E_ROAP_ERROR:{target:"S_ROAP_ERROR",actions:["roapError"]}}},S_RECV_ROAP_OFFER:{on:{E_SEND_ROAP_ANSWER:{target:"S_SEND_ROAP_ANSWER",actions:["outgoingRoapAnswer"]},E_ROAP_OK:{target:"S_ROAP_OK",actions:["roapEstablished"]},E_ROAP_ERROR:{target:"S_ROAP_ERROR",actions:["roapError"]}}},S_SEND_ROAP_OFFER:{on:{E_RECV_ROAP_ANSWER:{target:"S_RECV_ROAP_ANSWER",actions:["incomingRoapAnswer"]},E_SEND_ROAP_ANSWER:{target:"S_SEND_ROAP_ANSWER",actions:["outgoingRoapAnswer"]},E_SEND_ROAP_OFFER:{target:"S_SEND_ROAP_OFFER",actions:["outgoingRoapOffer"]},E_ROAP_ERROR:{target:"S_ROAP_ERROR",actions:["roapError"]}}},S_RECV_ROAP_ANSWER:{on:{E_ROAP_OK:{target:"S_ROAP_OK",actions:["roapEstablished"]},E_ROAP_ERROR:{target:"S_ROAP_ERROR",actions:["roapError"]}}},S_SEND_ROAP_ANSWER:{on:{E_RECV_ROAP_OFFER_REQUEST:{target:"S_RECV_ROAP_OFFER_REQUEST",actions:["incomingRoapOfferRequest"]},E_RECV_ROAP_OFFER:{target:"S_RECV_ROAP_OFFER",actions:["incomingRoapOffer"]},E_ROAP_OK:{target:"S_ROAP_OK",actions:["roapEstablished"]},E_SEND_ROAP_ANSWER:{target:"S_SEND_ROAP_ANSWER",actions:["outgoingRoapAnswer"]},E_ROAP_ERROR:{target:"S_ROAP_ERROR",actions:["roapError"]}}},S_ROAP_OK:{on:{E_RECV_ROAP_OFFER_REQUEST:{target:"S_RECV_ROAP_OFFER_REQUEST",actions:["incomingRoapOfferRequest"]},E_RECV_ROAP_OFFER:{target:"S_RECV_ROAP_OFFER",actions:["incomingRoapOffer"]},E_ROAP_OK:{target:"S_ROAP_OK",actions:["roapEstablished"]},E_SEND_ROAP_OFFER:{target:"S_SEND_ROAP_OFFER",actions:["outgoingRoapOffer"]},E_ROAP_ERROR:{target:"S_ROAP_ERROR",actions:["roapError"]},E_ROAP_TEARDOWN:{target:"S_ROAP_TEARDOWN"}}},S_ROAP_ERROR:{on:{E_ROAP_TEARDOWN:{target:"S_ROAP_TEARDOWN"},E_RECV_ROAP_OFFER_REQUEST:{target:"S_RECV_ROAP_OFFER_REQUEST",actions:["incomingRoapOfferRequest"]},E_RECV_ROAP_OFFER:{target:"S_RECV_ROAP_OFFER",actions:["incomingRoapOffer"]},E_RECV_ROAP_ANSWER:{target:"S_RECV_ROAP_ANSWER",actions:["incomingRoapAnswer"]},E_ROAP_OK:{target:"S_ROAP_OK",actions:["roapEstablished"]}}},S_ROAP_TEARDOWN:{type:"final"}}},{actions:{incomingRoapOffer:function(e,t){return d.handleIncomingRoapOffer(e,t)},incomingRoapAnswer:function(e,t){return d.handleIncomingRoapAnswer(e,t)},incomingRoapOfferRequest:function(e,t){return d.handleIncomingRoapOfferRequest(e,t)},outgoingRoapOffer:function(e,t){return d.handleOutgoingRoapOffer(e,t)},outgoingRoapAnswer:function(e,t){return d.handleOutgoingRoapAnswer(e,t)},roapEstablished:function(e,t){return d.handleRoapEstablished(e,t)},roapError:function(e,t){return d.handleRoapError(e,t)}}});return d.callStateMachine=(0,T.interpret)(l).onTransition((function(e,t){D.default.log("Call StateMachine:- state=".concat(e.value,", event=").concat(E()(t.type)),{}),"S_UNKNOWN"!==e.value&&d.metricManager.submitCallMetric(F.METRIC_EVENT.CALL,e.value.toString(),F.METRIC_TYPE.BEHAVIORAL,d.callId,d.correlationId,void 0)})).start(),d.mediaStateMachine=(0,T.interpret)(p).onTransition((function(e,t){var n;(D.default.log("Media StateMachine:- state=".concat(e.value,", event=").concat(E()(t.type)),{}),"S_ROAP_ERROR"!==e.value)&&d.metricManager.submitMediaMetric(F.METRIC_EVENT.MEDIA,e.value.toString(),F.METRIC_TYPE.BEHAVIORAL,d.callId,d.correlationId,d.localRoapMessage.sdp,null===(n=d.remoteRoapMessage)||void 0===n?void 0:n.sdp,void 0)})).start(),d.muted=!1,d}return(0,s.Z)(z,[{key:"isMuted",value:function(){return this.muted}},{key:"isConnected",value:function(){return this.connected}},{key:"isHeld",value:function(){return this.held}},{key:"handleIncomingCallSetup",value:function(e){D.default.info("handleIncomingCallSetup: ".concat(this.getCorrelationId(),"  "),{file:O.CALL_FILE,method:this.handleIncomingCallSetup.name}),this.sendCallStateMachineEvt({type:"E_SEND_CALL_ALERTING"})}},{key:"handleOutgoingCallSetup",value:(q=(0,o.Z)(h().mark((function e(t){var n,r,i,o=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D.default.info("handleOutgoingCallSetup: ".concat(this.getCorrelationId(),"  "),{file:O.CALL_FILE,method:this.handleOutgoingCallSetup.name}),n=t.data,e.prev=2,e.next=5,this.post(n);case 5:r=e.sent,D.default.log("handleOutgoingCallSetup: Response code: ".concat(r.statusCode),{file:O.CALL_FILE,method:this.handleOutgoingCallSetup.name}),this.setCallId(r.body.callId),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(2),D.default.warn("Call setup failed with Mobius",{file:O.CALL_FILE,method:this.handleOutgoingCallSetup.name}),i=e.t0,(0,w.handleCallErrors)((function(e){o.emit(M.EVENT_KEYS.CALL_ERROR,e),o.submitCallErrorMetric(e),o.sendCallStateMachineEvt({type:"E_UNKNOWN",data:i})}),b.ERROR_LAYER.CALL_CONTROL,(function(e){}),this.getCorrelationId(),i,this.handleOutgoingCallSetup.name,O.CALL_FILE);case 15:case"end":return e.stop()}}),e,this,[[2,10]])}))),function(e){return q.apply(this,arguments)})},{key:"handleCallHold",value:(K=(0,o.Z)(h().mark((function e(t){var n,r,i=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D.default.info("handleCallHold: ".concat(this.getCorrelationId(),"  "),{file:O.CALL_FILE,method:this.handleCallHold.name}),e.prev=1,e.next=4,this.postSSRequest(void 0,M.SUPPLEMENTARY_SERVICES.HOLD);case 4:n=e.sent,D.default.log("Response code: ".concat(n.statusCode),{file:O.CALL_FILE,method:this.handleCallHold.name}),!1===this.isHeld()&&(this.supplementaryServicesTimer=setTimeout((0,o.Z)(h().mark((function e(){var t,n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={file:O.CALL_FILE,method:i.handleCallHold.name},D.default.warn("Hold response timed out",{file:O.CALL_FILE,method:i.handleCallHold.name}),n=(0,L.createCallError)("An error occurred while placing the call on hold. Wait a moment and try again.",t,b.ERROR_TYPE.TIMEOUT,i.getCorrelationId(),b.ERROR_LAYER.CALL_CONTROL),i.emit(M.EVENT_KEYS.HOLD_ERROR,n),i.submitCallErrorMetric(n);case 5:case"end":return e.stop()}}),e)}))),O.SUPPLEMENTARY_SERVICES_TIMEOUT)),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(1),D.default.warn("Call Hold failed with Mobius",{file:O.CALL_FILE,method:this.handleCallHold.name}),r=e.t0,(0,w.handleCallErrors)((function(e){i.emit(M.EVENT_KEYS.HOLD_ERROR,e),i.submitCallErrorMetric(e),i.sendCallStateMachineEvt({type:"E_CALL_ESTABLISHED",data:r})}),b.ERROR_LAYER.CALL_CONTROL,(function(e){}),this.getCorrelationId(),r,this.handleOutgoingCallSetup.name,O.CALL_FILE);case 14:case"end":return e.stop()}}),e,this,[[1,9]])}))),function(e){return K.apply(this,arguments)})},{key:"handleCallResume",value:(H=(0,o.Z)(h().mark((function e(t){var n,r,i=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D.default.info("handleCallResume: ".concat(this.getCorrelationId(),"  "),{file:O.CALL_FILE,method:this.handleCallResume.name}),e.prev=1,e.next=4,this.postSSRequest(void 0,M.SUPPLEMENTARY_SERVICES.RESUME);case 4:n=e.sent,D.default.log("Response code: ".concat(n.statusCode),{file:O.CALL_FILE,method:this.handleCallResume.name}),!0===this.isHeld()&&(this.supplementaryServicesTimer=setTimeout((0,o.Z)(h().mark((function e(){var t,n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={file:O.CALL_FILE,method:i.handleCallResume.name},D.default.warn("Resume response timed out",{file:O.CALL_FILE,method:i.handleCallResume.name}),n=(0,L.createCallError)("An error occurred while resuming the call. Wait a moment and try again.",t,b.ERROR_TYPE.TIMEOUT,i.getCorrelationId(),b.ERROR_LAYER.CALL_CONTROL),i.emit(M.EVENT_KEYS.RESUME_ERROR,n),i.submitCallErrorMetric(n);case 5:case"end":return e.stop()}}),e)}))),O.SUPPLEMENTARY_SERVICES_TIMEOUT)),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(1),D.default.warn("Call Resume failed with Mobius",{file:O.CALL_FILE,method:this.handleCallResume.name}),r=e.t0,(0,w.handleCallErrors)((function(e){i.emit(M.EVENT_KEYS.RESUME_ERROR,e),i.submitCallErrorMetric(e),i.sendCallStateMachineEvt({type:"E_CALL_ESTABLISHED",data:r})}),b.ERROR_LAYER.CALL_CONTROL,(function(e){}),this.getCorrelationId(),r,this.handleOutgoingCallSetup.name,O.CALL_FILE);case 14:case"end":return e.stop()}}),e,this,[[1,9]])}))),function(e){return H.apply(this,arguments)})},{key:"handleIncomingCallProgress",value:function(e){var t;D.default.info("handleIncomingCallProgress: ".concat(this.getCorrelationId(),"  "),{file:O.CALL_FILE,method:this.handleIncomingCallProgress.name});var n=e.data;null!=n&&null!==(t=n.callProgressData)&&void 0!==t&&t.inbandMedia?(D.default.log("Inband media present. Setting Early Media flag",{file:O.CALL_FILE,method:this.handleIncomingCallProgress.name}),this.earlyMedia=!0):D.default.log("Inband media not present.",{file:O.CALL_FILE,method:this.handleIncomingCallProgress.name}),null!=n&&n.callerId&&(D.default.info("Processing Caller-Id data",{file:O.CALL_FILE,method:this.handleIncomingCallProgress.name}),this.startCallerIdResolution(n.callerId)),this.emit(M.EVENT_KEYS.PROGRESS,this.correlationId)}},{key:"handleIncomingRoapOfferRequest",value:function(e,t){D.default.info("handleIncomingRoapOfferRequest: ".concat(this.getCorrelationId(),"  "),{file:O.CALL_FILE,method:this.handleIncomingRoapOfferRequest.name});var n=t.data;this.mediaConnection?this.waitingForOK?(D.default.info("Waiting for Roap OK, buffer the remote Offer Request for later handling",{file:O.CALL_FILE,method:this.handleIncomingRoapOfferRequest.name}),this.remoteRoapMessage=n):(n.seq=this.seq+1,this.seq=n.seq,this.mediaConnection.roapMessageReceived(n)):(D.default.info("Media connection is not up, buffer the remote Offer Request for later handling",{file:O.CALL_FILE,method:this.handleIncomingRoapOfferRequest.name}),this.seq=n.seq,D.default.info("Setting Sequence No: ".concat(this.seq),{file:O.CALL_FILE,method:this.handleIncomingRoapOfferRequest.name}),this.remoteRoapMessage=n)}},{key:"handleOutgoingCallAlerting",value:(j=(0,o.Z)(h().mark((function e(t){var n,r,i=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D.default.info("handleOutgoingCallAlerting: ".concat(this.getCorrelationId(),"  "),{file:O.CALL_FILE,method:this.handleOutgoingCallAlerting.name}),e.prev=1,e.next=4,this.patch(N.MobiusCallState.ALERTING);case 4:n=e.sent,D.default.log("PATCH response: ".concat(n.statusCode),{file:O.CALL_FILE,method:this.handleOutgoingCallAlerting.name}),e.next=13;break;case 8:e.prev=8,e.t0=e.catch(1),D.default.warn("Call Progress failed with Mobius",{file:O.CALL_FILE,method:this.handleOutgoingCallAlerting.name}),r=e.t0,(0,w.handleCallErrors)((function(e){i.emit(M.EVENT_KEYS.CALL_ERROR,e),i.submitCallErrorMetric(e),i.sendCallStateMachineEvt({type:"E_UNKNOWN",data:r})}),b.ERROR_LAYER.CALL_CONTROL,(function(e){}),this.getCorrelationId(),r,this.handleOutgoingCallAlerting.name,O.CALL_FILE);case 13:case"end":return e.stop()}}),e,this,[[1,8]])}))),function(e){return j.apply(this,arguments)})},{key:"handleIncomingCallConnect",value:function(e){D.default.info("handleIncomingCallConnect: ".concat(this.getCorrelationId(),"  "),{file:O.CALL_FILE,method:this.handleIncomingCallConnect.name}),this.emit(M.EVENT_KEYS.CONNECT,this.correlationId),this.earlyMedia&&this.sendCallStateMachineEvt({type:"E_CALL_ESTABLISHED"})}},{key:"handleOutgoingCallConnect",value:(W=(0,o.Z)(h().mark((function e(t){var n,r,i=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D.default.info("handleOutgoingCallConnect: ".concat(this.getCorrelationId(),"  "),{file:O.CALL_FILE,method:this.handleOutgoingCallConnect.name}),this.remoteRoapMessage){e.next=4;break}return D.default.warn("Offer not yet received from remote end... Exiting",{file:O.CALL_FILE,method:this.handleOutgoingCallConnect.name}),e.abrupt("return");case 4:return e.prev=4,e.next=7,this.patch(N.MobiusCallState.CONNECTED);case 7:n=e.sent,D.default.log("PATCH response: ".concat(n.statusCode),{file:O.CALL_FILE,method:this.handleOutgoingCallConnect.name}),this.mediaConnection.roapMessageReceived(this.remoteRoapMessage),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(4),D.default.warn("Call Connect failed with Mobius",{file:O.CALL_FILE,method:this.handleOutgoingCallConnect.name}),r=e.t0,(0,w.handleCallErrors)((function(e){i.emit(M.EVENT_KEYS.CALL_ERROR,e),i.submitCallErrorMetric(e),i.sendCallStateMachineEvt({type:"E_UNKNOWN",data:r})}),b.ERROR_LAYER.CALL_CONTROL,(function(e){}),this.getCorrelationId(),r,this.handleOutgoingCallConnect.name,O.CALL_FILE);case 17:case"end":return e.stop()}}),e,this,[[4,12]])}))),function(e){return W.apply(this,arguments)})},{key:"handleIncomingCallDisconnect",value:(B=(0,o.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D.default.info("handleIncomingCallDisconnect: ".concat(this.getCorrelationId(),"  "),{file:O.CALL_FILE,method:this.handleIncomingCallDisconnect.name}),this.setDisconnectReason(),e.prev=2,e.next=5,this.delete();case 5:n=e.sent,D.default.log("handleOutgoingCallDisconnect: Response code: ".concat(n.statusCode),{file:O.CALL_FILE,method:this.handleIncomingCallDisconnect.name}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),D.default.warn("Delete Call failed with Mobius",{file:O.CALL_FILE,method:this.handleIncomingCallDisconnect.name});case 12:this.deleteCb(this.correlationId),this.sessionTimer&&clearInterval(this.sessionTimer),this.mediaConnection&&(this.mediaConnection.close(),D.default.info("Closing media channel",{file:O.CALL_FILE,method:"handleIncomingCallDisconnect"})),this.sendMediaStateMachineEvt({type:"E_ROAP_TEARDOWN"}),this.sendCallStateMachineEvt({type:"E_CALL_CLEARED"}),this.emit(M.EVENT_KEYS.DISCONNECT,this.correlationId);case 18:case"end":return e.stop()}}),e,this,[[2,9]])}))),function(e){return B.apply(this,arguments)})},{key:"handleOutgoingCallDisconnect",value:(G=(0,o.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setDisconnectReason(),e.prev=1,e.next=4,this.delete();case 4:n=e.sent,D.default.log("handleOutgoingCallDisconnect: Response code: ".concat(n.statusCode),{file:O.CALL_FILE,method:this.handleOutgoingCallDisconnect.name}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),D.default.warn("Delete Call failed with Mobius",{file:O.CALL_FILE,method:this.handleOutgoingCallDisconnect.name});case 11:this.deleteCb(this.correlationId),this.sessionTimer&&clearInterval(this.sessionTimer),this.mediaConnection&&(this.mediaConnection.close(),D.default.info("Closing media channel",{file:O.CALL_FILE,method:"handleOutgoingCallDisconnect"})),this.sendMediaStateMachineEvt({type:"E_ROAP_TEARDOWN"}),this.sendCallStateMachineEvt({type:"E_CALL_CLEARED"});case 16:case"end":return e.stop()}}),e,this,[[1,8]])}))),function(e){return G.apply(this,arguments)})},{key:"handleCallEstablished",value:function(e){var t=this;D.default.info("handleCallEstablished: ".concat(this.getCorrelationId(),"  "),{file:O.CALL_FILE,method:this.handleCallEstablished.name}),this.emit(M.EVENT_KEYS.ESTABLISHED,this.correlationId),this.earlyMedia=!1,this.connected=!0,this.sessionTimer&&(D.default.log("Resetting session timer",{file:O.CALL_FILE,method:"handleCallEstablished"}),clearInterval(this.sessionTimer)),this.sessionTimer=setInterval((0,o.Z)(h().mark((function e(){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.postStatus();case 3:e.sent,D.default.info("Session refresh successful",{file:O.CALL_FILE,method:"handleCallEstablished"}),e.next=12;break;case 7:e.prev=7,e.t0=e.catch(0),n=e.t0,t.sessionTimer&&clearInterval(t.sessionTimer),(0,w.handleCallErrors)((function(e){t.emit(M.EVENT_KEYS.CALL_ERROR,e),t.submitCallErrorMetric(e)}),b.ERROR_LAYER.CALL_CONTROL,(function(e){setTimeout((function(){t.postStatus(),t.sendCallStateMachineEvt({type:"E_CALL_ESTABLISHED"})}),1e3*e)}),t.getCorrelationId(),n,t.handleCallEstablished.name,O.CALL_FILE);case 12:case"end":return e.stop()}}),e,null,[[0,7]])}))),O.DEFAULT_SESSION_TIMER)}},{key:"handleUnknownState",value:(V=(0,o.Z)(h().mark((function e(t){var n,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D.default.info("handleUnknownState: ".concat(this.getCorrelationId(),"  "),{file:O.CALL_FILE,method:this.handleUnknownState.name}),null!=(n=t.data)&&n.media||D.default.warn("Call failed due to signalling issue",{file:O.CALL_FILE,method:this.handleUnknownState.name}),e.prev=3,this.setDisconnectReason(),e.next=7,this.delete();case 7:r=e.sent,D.default.log("handleOutgoingCallDisconnect: Response code: ".concat(r.statusCode),{file:O.CALL_FILE,method:this.handleUnknownState.name}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),D.default.warn("Delete Call failed with Mobius",{file:O.CALL_FILE,method:this.handleUnknownState.name});case 14:this.deleteCb(this.correlationId),this.sessionTimer&&clearInterval(this.sessionTimer),this.mediaConnection&&(this.mediaConnection.close(),D.default.info("Closing media channel",{file:O.CALL_FILE,method:this.handleUnknownState.name})),this.sendMediaStateMachineEvt({type:"E_ROAP_TEARDOWN"}),this.sendCallStateMachineEvt({type:"E_CALL_CLEARED"});case 19:case"end":return e.stop()}}),e,this,[[3,11]])}))),function(e){return V.apply(this,arguments)})},{key:"getEmitterCallback",value:function(e){var t=this;return function(n){switch(t.callStateMachine.state.value){case"S_CALL_HOLD":return t.emit(M.EVENT_KEYS.HOLD_ERROR,n),t.supplementaryServicesTimer&&(clearTimeout(t.supplementaryServicesTimer),t.supplementaryServicesTimer=void 0),t.submitCallErrorMetric(n),void t.sendCallStateMachineEvt({type:"E_CALL_ESTABLISHED",data:e});case"S_CALL_RESUME":return t.emit(M.EVENT_KEYS.RESUME_ERROR,n),t.submitCallErrorMetric(n),void t.sendCallStateMachineEvt({type:"E_CALL_ESTABLISHED",data:e});default:t.emit(M.EVENT_KEYS.CALL_ERROR,n),t.submitCallErrorMetric(n),t.connected||t.sendMediaStateMachineEvt({type:"E_ROAP_ERROR",data:e})}}}},{key:"handleRoapEstablished",value:(k=(0,o.Z)(h().mark((function e(t,n){var r,i,o,a,s,c,u,d=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D.default.info("handleRoapEstablished: ".concat(this.getCorrelationId(),"  "),{file:O.CALL_FILE,method:"handleRoapEstablished"}),this.waitingForOK=!1,r=n.data,i=r.received,o=r.message,i){e.next=21;break}return D.default.info("Sending Media Ok to the remote End",{file:O.CALL_FILE,method:"handleRoapEstablished"}),e.prev=5,o.seq=this.seq,e.next=9,this.postMedia(o);case 9:a=e.sent,D.default.log("handleRoapEstablished: Response code: ".concat(a.statusCode),{file:O.CALL_FILE,method:"handleRoapEstablished"}),this.earlyMedia||this.sendCallStateMachineEvt({type:"E_CALL_ESTABLISHED"}),e.next=19;break;case 14:e.prev=14,e.t0=e.catch(5),D.default.warn("MediaOk failed with Mobius",{file:O.CALL_FILE,method:"handleRoapEstablished"}),s=e.t0,(0,w.handleCallErrors)(this.getEmitterCallback(s),b.ERROR_LAYER.MEDIA,(function(e){d.connected&&setTimeout((function(){d.sendMediaStateMachineEvt({type:"E_ROAP_OK",data:n.data})}),1e3*e)}),this.getCorrelationId(),s,this.handleRoapEstablished.name,O.CALL_FILE);case 19:e.next=26;break;case 21:D.default.info("Notifying internal-media-core about ROAP OK message",{file:O.CALL_FILE,method:"handleRoapEstablished"}),o.seq=this.seq,this.mediaConnection&&this.mediaConnection.roapMessageReceived(o),this.earlyMedia||this.sendCallStateMachineEvt({type:"E_CALL_ESTABLISHED"}),("OFFER_REQUEST"===(null===(c=this.remoteRoapMessage)||void 0===c?void 0:c.messageType)||"OFFER"===(null===(u=this.remoteRoapMessage)||void 0===u?void 0:u.messageType)&&this.remoteRoapMessage.seq>this.seq)&&(this.seq=this.remoteRoapMessage.seq,this.mediaConnection.roapMessageReceived(this.remoteRoapMessage));case 26:case"end":return e.stop()}}),e,this,[[5,14]])}))),function(e,t){return k.apply(this,arguments)})},{key:"handleRoapError",value:(C=(0,o.Z)(h().mark((function e(t,n){var r,i,o,a=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D.default.info("handleRoapError: ".concat(this.getCorrelationId()),{file:O.CALL_FILE,method:this.handleRoapError.name}),!(r=n.data)){e.next=15;break}return e.prev=3,e.next=6,this.postMedia(r);case 6:i=e.sent,D.default.info("Response code: ".concat(i.statusCode),{file:O.CALL_FILE,method:this.handleRoapError.name}),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(3),D.default.warn("Failed to communicate ROAP error with Mobius",{file:O.CALL_FILE,method:this.handleRoapError.name}),o=e.t0,(0,w.handleCallErrors)((function(e){a.emit(M.EVENT_KEYS.CALL_ERROR,e),a.submitCallErrorMetric(e)}),b.ERROR_LAYER.MEDIA,(function(e){}),this.getCorrelationId(),o,this.handleRoapError.name,O.CALL_FILE);case 15:this.connected||(D.default.warn("Call failed due to media issue",{file:O.CALL_FILE,method:"handleRoapError"}),this.sendCallStateMachineEvt({type:"E_UNKNOWN",data:{media:!0}}));case 16:case"end":return e.stop()}}),e,this,[[3,10]])}))),function(e,t){return C.apply(this,arguments)})},{key:"handleOutgoingRoapOffer",value:(y=(0,o.Z)(h().mark((function e(t,n){var r,i,o,a=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D.default.info("handleOutgoingRoapOffer: ".concat(this.getCorrelationId()),{file:O.CALL_FILE,method:this.handleOutgoingRoapOffer.name}),null!=(r=n.data)&&r.sdp){e.next=6;break}return D.default.info("Initializing Offer...",{file:O.CALL_FILE,method:this.handleOutgoingRoapOffer.name}),this.mediaConnection.initiateOffer(),e.abrupt("return");case 6:return e.prev=6,e.next=9,this.postMedia(r);case 9:i=e.sent,D.default.log("handleOutgoingRoapOffer: Response code: ".concat(i.statusCode),{file:O.CALL_FILE,method:this.handleOutgoingRoapOffer.name}),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(6),D.default.warn("MediaOk failed with Mobius",{file:O.CALL_FILE,method:this.handleOutgoingRoapOffer.name}),o=e.t0,(0,w.handleCallErrors)(this.getEmitterCallback(o),b.ERROR_LAYER.MEDIA,(function(e){a.connected&&setTimeout((function(){a.sendMediaStateMachineEvt({type:"E_SEND_ROAP_OFFER",data:n.data})}),1e3*e)}),this.getCorrelationId(),o,this.handleOutgoingRoapOffer.name,O.CALL_FILE);case 18:case"end":return e.stop()}}),e,this,[[6,13]])}))),function(e,t){return y.apply(this,arguments)})},{key:"handleOutgoingRoapAnswer",value:(g=(0,o.Z)(h().mark((function e(t,n){var r,i,o,a=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D.default.info("handleOutgoingRoapAnswer: ".concat(this.getCorrelationId()),{file:O.CALL_FILE,method:this.handleOutgoingRoapAnswer.name}),r=n.data,e.prev=2,r.seq=this.seq,e.next=6,this.postMedia(r);case 6:i=e.sent,D.default.log("handleOutgoingRoapAnswer: Response code: ".concat(i.statusCode),{file:O.CALL_FILE,method:this.handleOutgoingRoapAnswer.name}),this.waitingForOK=!0,e.next=16;break;case 11:e.prev=11,e.t0=e.catch(2),D.default.warn("MediaAnswer failed with Mobius",{file:O.CALL_FILE,method:this.handleOutgoingRoapAnswer.name}),o=e.t0,(0,w.handleCallErrors)(this.getEmitterCallback(o),b.ERROR_LAYER.MEDIA,(function(e){a.connected&&setTimeout((function(){a.sendMediaStateMachineEvt({type:"E_SEND_ROAP_ANSWER",data:n.data})}),1e3*e)}),this.getCorrelationId(),o,this.handleOutgoingRoapAnswer.name,O.CALL_FILE);case 16:case"end":return e.stop()}}),e,this,[[2,11]])}))),function(e,t){return g.apply(this,arguments)})},{key:"handleIncomingRoapOffer",value:function(e,t){D.default.info("handleIncomingRoapOffer: ".concat(this.getCorrelationId()),{file:O.CALL_FILE,method:this.handleIncomingRoapOffer.name});var n=t.data;this.remoteRoapMessage=n,this.mediaConnection?this.waitingForOK?(D.default.info("Waiting for Roap OK, buffer the remote offer for later handling",{file:O.CALL_FILE,method:this.handleIncomingRoapOffer.name}),this.remoteRoapMessage=n):(D.default.info("Handling new offer...",{file:O.CALL_FILE,method:this.handleIncomingRoapOffer.name}),this.seq=n.seq,this.mediaConnection&&this.mediaConnection.roapMessageReceived(n)):(D.default.info("Media connection is not up, buffer the remote offer for later handling",{file:O.CALL_FILE,method:this.handleIncomingRoapOffer.name}),this.seq=n.seq,D.default.info("Setting Sequence No: ".concat(this.seq),{file:O.CALL_FILE,method:this.handleIncomingRoapOffer.name}))}},{key:"handleIncomingRoapAnswer",value:function(e,t){D.default.info("handleIncomingRoapAnswer: ".concat(this.getCorrelationId()),{file:O.CALL_FILE,method:this.handleIncomingRoapAnswer.name});var n=t.data;this.remoteRoapMessage=n,n.seq=this.seq,this.mediaConnection&&this.mediaConnection.roapMessageReceived(n)}},{key:"initMediaConnection",value:function(e){var t=new R.RoapMediaConnection({skipInactiveTransceivers:!0,iceServers:[],sdpMunging:{convertPort9to0:!0,addContentSlides:!1}},{send:{audio:e.localAudioTrack},receive:{audio:!0,video:!1,screenShareVideo:!1}},e.debugId||"WebexCallSDK-".concat(this.correlationId));this.mediaConnection=t}},{key:"sendCallStateMachineEvt",value:function(e){this.callStateMachine.send(e)}},{key:"sendMediaStateMachineEvt",value:function(e){this.mediaStateMachine.send(e)}},{key:"setDisconnectReason",value:function(){this.connected||this.direction===I.CallDirection.OUTBOUND?(this.disconnectReason.code=N.DisconnectCode.NORMAL,this.disconnectReason.cause=N.DisconnectCause.NORMAL):(this.disconnectReason.code=N.DisconnectCode.BUSY,this.disconnectReason.cause=N.DisconnectCause.BUSY)}},{key:"answer",value:(m=(0,o.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.localAudioTrack.enabled=!0,this.mediaConnection||(this.initMediaConnection(t),this.mediaRoapEventsListener(),this.mediaTrackListener()),"S_SEND_CALL_PROGRESS"===this.callStateMachine.state.value?this.sendCallStateMachineEvt({type:"E_SEND_CALL_CONNECT"}):D.default.warn("Call cannot be answered because the state is : ".concat(this.callStateMachine.state.value),{file:O.CALL_FILE,method:"answer"});case 3:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"dial",value:(v=(0,o.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.localAudioTrack.enabled=!0,this.mediaConnection||(this.initMediaConnection(t),this.mediaRoapEventsListener(),this.mediaTrackListener()),"S_ROAP_IDLE"===this.mediaStateMachine.state.value?this.sendMediaStateMachineEvt({type:"E_SEND_ROAP_OFFER"}):D.default.warn("Call cannot be dialed because the state is already : ".concat(this.mediaStateMachine.state.value),{file:O.CALL_FILE,method:"dial"});case 3:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"patch",value:(p=(0,o.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D.default.info("Send a PATCH for ".concat(t," to mobius"),{file:O.CALL_FILE,method:this.patch.name}),e.abrupt("return",this.webex.request({uri:"".concat(this.mobiusUrl).concat(O.DEVICES_ENDPOINT_RESOURCE,"/").concat(this.deviceId,"/").concat(O.CALLS_ENDPOINT_RESOURCE,"/").concat(this.callId),method:I.HTTP_METHODS.PATCH,service:I.ALLOWED_SERVICES.MOBIUS,headers:(n={},(0,f.Z)(n,O.CISCO_DEVICE_URL,this.webex.internal.device.url),(0,f.Z)(n,O.SPARK_USER_AGENT,O.CALLING_USER_AGENT),n),body:{device:{deviceId:this.deviceId,correlationId:this.correlationId},callId:this.callId,callState:t,inbandMedia:!1}}));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"postSSRequest",value:(l=(0,o.Z)(h().mark((function e(t,n){var r,i,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i={uri:"".concat(this.mobiusUrl).concat(Z.SERVICES_ENDPOINT),method:I.HTTP_METHODS.POST,service:I.ALLOWED_SERVICES.MOBIUS,headers:(r={},(0,f.Z)(r,O.CISCO_DEVICE_URL,this.webex.internal.device.url),(0,f.Z)(r,O.SPARK_USER_AGENT,O.CALLING_USER_AGENT),r),body:{device:{deviceId:this.deviceId,correlationId:this.correlationId},callId:this.callId}},e.t0=n,e.next=e.t0===M.SUPPLEMENTARY_SERVICES.HOLD?4:e.t0===M.SUPPLEMENTARY_SERVICES.RESUME?6:e.t0===M.SUPPLEMENTARY_SERVICES.TRANSFER?8:12;break;case 4:return i.uri="".concat(i.uri,"/").concat(O.CALL_HOLD_SERVICE,"/").concat(O.HOLD_ENDPOINT),e.abrupt("break",13);case 6:return i.uri="".concat(i.uri,"/").concat(O.CALL_HOLD_SERVICE,"/").concat(O.RESUME_ENDPOINT),e.abrupt("break",13);case 8:return i.uri="".concat(i.uri,"/").concat(O.CALL_TRANSFER_SERVICE,"/").concat(O.TRANSFER_ENDPOINT),(o=t).destination?(S()(i.body,{blindTransferContext:o}),S()(i.body,{transferType:N.TransferType.BLIND})):o.transferToCallId&&(S()(i.body,{consultTransferContext:o}),S()(i.body,{transferType:N.TransferType.CONSULT})),e.abrupt("break",13);case 12:D.default.warn("Unknown type for PUT request: ".concat(n),{file:O.CALL_FILE,method:this.postSSRequest.name});case 13:return e.abrupt("return",this.webex.request(i));case 14:case"end":return e.stop()}}),e,this)}))),function(e,t){return l.apply(this,arguments)})},{key:"postStatus",value:(d=(0,o.Z)(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.webex.request({uri:"".concat(this.mobiusUrl).concat(O.DEVICES_ENDPOINT_RESOURCE,"/").concat(this.deviceId,"/").concat(O.CALLS_ENDPOINT_RESOURCE,"/").concat(this.callId,"/").concat(O.CALL_STATUS_RESOURCE),method:I.HTTP_METHODS.POST,service:I.ALLOWED_SERVICES.MOBIUS,headers:(t={},(0,f.Z)(t,O.CISCO_DEVICE_URL,this.webex.internal.device.url),(0,f.Z)(t,O.SPARK_USER_AGENT,O.CALLING_USER_AGENT),t),body:{device:{deviceId:this.deviceId,correlationId:this.correlationId},callId:this.callId}}));case 1:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"completeTransfer",value:(i=(0,o.Z)(h().mark((function e(t,n,r){var i,o,a,s,c=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==N.TransferType.BLIND||!r){e.next=16;break}return D.default.info("Initiating Blind transfer with : ".concat(r),{file:O.CALL_FILE,method:this.completeTransfer.name}),i={transferorCallId:this.getCallId(),destination:r},e.prev=3,e.next=6,this.postSSRequest(i,M.SUPPLEMENTARY_SERVICES.TRANSFER);case 6:this.metricManager.submitCallMetric(F.METRIC_EVENT.CALL,F.TRANSFER_METRIC.BLIND_TRANSFER,F.METRIC_TYPE.BEHAVIORAL,this.getCallId(),this.getCorrelationId(),void 0),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(3),D.default.warn("Blind Transfer failed for correlationId ".concat(this.getCorrelationId()),{file:O.CALL_FILE,method:this.completeTransfer.name}),o=e.t0,(0,w.handleCallErrors)((function(e){c.emit(M.EVENT_KEYS.TRANSFER_ERROR,e),c.submitCallErrorMetric(e)}),b.ERROR_LAYER.CALL_CONTROL,(function(e){}),this.getCorrelationId(),o,this.completeTransfer.name,O.CALL_FILE);case 14:e.next=33;break;case 16:if(t!==N.TransferType.CONSULT||!n){e.next=32;break}return D.default.info("Initiating Consult transfer between : ".concat(this.callId," and ").concat(n),{file:O.CALL_FILE,method:this.completeTransfer.name}),a={transferorCallId:this.getCallId(),transferToCallId:n},e.prev=19,e.next=22,this.postSSRequest(a,M.SUPPLEMENTARY_SERVICES.TRANSFER);case 22:this.metricManager.submitCallMetric(F.METRIC_EVENT.CALL,F.TRANSFER_METRIC.CONSULT_TRANSFER,F.METRIC_TYPE.BEHAVIORAL,this.getCallId(),this.getCorrelationId(),void 0),e.next=30;break;case 25:e.prev=25,e.t1=e.catch(19),D.default.warn("Consult Transfer failed for correlationId ".concat(this.getCorrelationId()),{file:O.CALL_FILE,method:this.completeTransfer.name}),s=e.t1,(0,w.handleCallErrors)((function(e){c.emit(M.EVENT_KEYS.TRANSFER_ERROR,e),c.submitCallErrorMetric(e)}),b.ERROR_LAYER.CALL_CONTROL,(function(e){}),this.getCorrelationId(),s,this.completeTransfer.name,O.CALL_FILE);case 30:e.next=33;break;case 32:D.default.warn("Invalid information received, transfer failed for correlationId: ".concat(this.getCorrelationId()),{file:O.CALL_FILE,method:this.completeTransfer.name});case 33:case"end":return e.stop()}}),e,this,[[3,9],[19,25]])}))),function(e,t,n){return i.apply(this,arguments)})},{key:"getCallStats",value:(r=(0,o.Z)(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.mediaConnection.getStats();case 3:t=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),D.default.warn("Stats collection failed, using dummy stats",{file:O.CALL_FILE,method:this.getCallStats.name});case 9:return e.abrupt("return",(0,w.parseMediaQualityStatistics)(t));case 10:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(){return r.apply(this,arguments)})},{key:"postMedia",value:(n=(0,o.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D.default.log("Posting message to mobius",{file:O.CALL_FILE,method:this.postMedia.name}),e.abrupt("return",this.webex.request({uri:"".concat(this.mobiusUrl).concat(O.DEVICES_ENDPOINT_RESOURCE,"/").concat(this.deviceId,"/").concat(O.CALLS_ENDPOINT_RESOURCE,"/").concat(this.callId,"/").concat(O.MEDIA_ENDPOINT_RESOURCE),method:I.HTTP_METHODS.POST,service:I.ALLOWED_SERVICES.MOBIUS,headers:(n={},(0,f.Z)(n,O.CISCO_DEVICE_URL,this.webex.internal.device.url),(0,f.Z)(n,O.SPARK_USER_AGENT,O.CALLING_USER_AGENT),n),body:{device:{deviceId:this.deviceId,correlationId:this.correlationId},callId:this.callId,localMedia:{roap:t,mediaId:(0,x.v4)()}}}));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"mediaRoapEventsListener",value:function(){var e=this;this.mediaConnection.on(R.Event.ROAP_MESSAGE_TO_SEND,function(){var t=(0,o.Z)(h().mark((function t(n){var r,i,o,a;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:D.default.info("ROAP message to send (rcv from MEDIA-SDK) :\n          \n type:  ".concat(null===(r=n.roapMessage)||void 0===r?void 0:r.messageType,", seq: ").concat(n.roapMessage.seq," , version: ").concat(n.roapMessage.version),{}),D.default.info("SDP message to send : \n ".concat(null===(i=n.roapMessage)||void 0===i?void 0:i.sdp),{file:O.CALL_FILE,method:e.mediaRoapEventsListener.name}),t.t0=n.roapMessage.messageType,t.next=t.t0===N.RoapScenario.OK?5:t.t0===N.RoapScenario.OFFER?8:t.t0===N.RoapScenario.ANSWER?13:t.t0===N.RoapScenario.ERROR?16:t.t0===N.RoapScenario.OFFER_RESPONSE?18:21;break;case 5:return o={received:!1,message:n.roapMessage},e.sendMediaStateMachineEvt({type:"E_ROAP_OK",data:o}),t.abrupt("break",21);case 8:return a=n.roapMessage.sdp.replace(/^m=(video) (?:\d+) /gim,"m=$1 0 "),n.roapMessage.sdp=a,e.localRoapMessage=n.roapMessage,e.sendCallStateMachineEvt({type:"E_SEND_CALL_SETUP",data:n.roapMessage}),t.abrupt("break",21);case 13:return e.localRoapMessage=n.roapMessage,e.sendMediaStateMachineEvt({type:"E_SEND_ROAP_ANSWER",data:n.roapMessage}),t.abrupt("break",21);case 16:return e.sendMediaStateMachineEvt({type:"E_ROAP_ERROR",data:n.roapMessage}),t.abrupt("break",21);case 18:return e.localRoapMessage=n.roapMessage,e.sendMediaStateMachineEvt({type:"E_SEND_ROAP_OFFER",data:n.roapMessage}),t.abrupt("break",21);case 21:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"mediaTrackListener",value:function(){var e=this;this.mediaConnection.on(R.Event.REMOTE_TRACK_ADDED,(function(t){t.type===M.MEDIA_CONNECTION_EVENT_KEYS.MEDIA_TYPE_AUDIO&&e.emit(M.EVENT_KEYS.REMOTE_MEDIA,t.track)}))}},{key:"delete",value:(t=(0,o.Z)(h().mark((function e(){var t,n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCallStats();case 2:return n=e.sent,e.abrupt("return",this.webex.request({uri:"".concat(this.mobiusUrl).concat(O.DEVICES_ENDPOINT_RESOURCE,"/").concat(this.deviceId,"/").concat(O.CALLS_ENDPOINT_RESOURCE,"/").concat(this.callId),method:I.HTTP_METHODS.DELETE,service:I.ALLOWED_SERVICES.MOBIUS,headers:(t={},(0,f.Z)(t,O.CISCO_DEVICE_URL,this.webex.internal.device.url),(0,f.Z)(t,O.SPARK_USER_AGENT,O.CALLING_USER_AGENT),t),body:{device:{deviceId:this.deviceId,correlationId:this.correlationId},callId:this.callId,metrics:n,causecode:this.disconnectReason.code,cause:this.disconnectReason.cause}}));case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"submitCallErrorMetric",value:function(e){var t;e.getCallError().errorLayer===b.ERROR_LAYER.CALL_CONTROL?this.metricManager.submitCallMetric(F.METRIC_EVENT.CALL_ERROR,this.callStateMachine.state.value.toString(),F.METRIC_TYPE.BEHAVIORAL,this.callId,this.correlationId,e):this.metricManager.submitMediaMetric(F.METRIC_EVENT.MEDIA_ERROR,this.mediaStateMachine.state.value.toString(),F.METRIC_TYPE.BEHAVIORAL,this.callId,this.correlationId,this.localRoapMessage.sdp,null===(t=this.remoteRoapMessage)||void 0===t?void 0:t.sdp,e)}},{key:"handleMidCallEvent",value:function(e){var t=e.eventType,n=e.eventData;switch(t){case N.MidCallEventType.CALL_INFO:D.default.log("Received Midcall CallInfo Event for correlationId : ".concat(this.correlationId),{file:O.CALL_FILE,method:"handleMidCallEvent"});var r=n;this.startCallerIdResolution(r.callerId);break;case N.MidCallEventType.CALL_STATE:D.default.log("Received Midcall call event for correlationId : ".concat(this.correlationId),{file:O.CALL_FILE,method:"handleMidCallEvent"});var i=n;switch(i.callState){case M.MOBIUS_MIDCALL_STATE.HELD:D.default.log("Call is successfully held : ".concat(this.correlationId),{file:O.CALL_FILE,method:"handleMidCallEvent"}),this.emit(M.EVENT_KEYS.HELD,this.correlationId),this.held=!0,this.supplementaryServicesTimer&&(clearTimeout(this.supplementaryServicesTimer),this.supplementaryServicesTimer=void 0);break;case M.MOBIUS_MIDCALL_STATE.CONNECTED:D.default.log("Call is successfully resumed : ".concat(this.correlationId),{file:O.CALL_FILE,method:"handleMidCallEvent"}),this.emit(M.EVENT_KEYS.RESUMED,this.correlationId),this.held=!1,this.supplementaryServicesTimer&&(clearTimeout(this.supplementaryServicesTimer),this.supplementaryServicesTimer=void 0);break;default:D.default.warn("Unknown Supplementary service state: ".concat(i.callState," for correlationId : ").concat(this.correlationId),{file:O.CALL_FILE,method:"handleMidCallEvent"})}break;default:D.default.warn("Unknown Midcall type: ".concat(t," for correlationId : ").concat(this.correlationId),{file:O.CALL_FILE,method:"handleMidCallEvent"})}}},{key:"startCallerIdResolution",value:function(e){this.callerInfo=this.callerId.fetchCallerDetails(e)}},{key:"sendDTMF",value:function(e){this.connected?(D.default.info("Sending DTMF : ".concat(e),{file:O.CALL_FILE,method:"sendDTMF"}),this.mediaConnection.insertDTMF(e)):D.default.warn("Can't send DTMF as call is not yet connected",{file:O.CALL_FILE,method:"sendDTMF"})}},{key:"setBroadworksCorrelationInfo",value:function(e){this.broadworksCorrelationInfo=e}},{key:"getBroadworksCorrelationInfo",value:function(){return this.broadworksCorrelationInfo}},{key:"getCallRtpStats",value:function(){return this.getCallStats()}}]),z}(k.Eventing);exports.Call=V;exports.createCall=function(e,t,n,r,i,o,a){return new V(e,t,n,r,i,o,a)}},84407:(e,t,n)=>{"use strict";n.r(t);var r=n(63755),i=n.n(r),o=n(66250),a=n(8167),s=n(31314),c=n(23710),u=n(69678),d=n(26305),l=n(35002),f=n(77193),p=n(33453),h=n.n(p),v=n(26771),m=n.n(v),g=n(26243),E=n.n(g);function y(e){var t=function(){if("undefined"==typeof Reflect||!i())return!1;if(i().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,l.Z)(e);if(t){var o=(0,l.Z)(this).constructor;n=i()(r,arguments,o)}else n=r.apply(this,arguments);return(0,d.Z)(this,n)}}var S=function(e){return e&&e.__esModule?e:{default:e}};m()(exports,"__esModule",{value:!0}),exports.getCallManager=exports.CallManager=void 0;var _,C=n(74364),R=n(93800),T=n(29004),x=S(n(4983)),b=n(14830),w=n(82060),I=n(6599),L=S(n(41309)),O=function(e){(0,u.Z)(n,e);var t=y(n);function n(e,r){var i;return(0,a.Z)(this,n),i=t.call(this),(0,f.Z)((0,c.Z)(i),"sdkConnector",void 0),(0,f.Z)((0,c.Z)(i),"webex",void 0),(0,f.Z)((0,c.Z)(i),"callCollection",void 0),(0,f.Z)((0,c.Z)(i),"activeMobiusUrl",void 0),(0,f.Z)((0,c.Z)(i),"serviceIndicator",void 0),(0,f.Z)((0,c.Z)(i),"createCall",(function(e,t,n){L.default.log("Creating call object",{});var r=(0,I.createCall)(i.activeMobiusUrl,i.webex,e,t,n,(function(e){delete i.callCollection[e];var t=E()(i.getActiveCalls()).length;L.default.info("DELETE:: Deleted corelationId: ".concat(r.getCorrelationId()," from CallManager, Number of call records :- ").concat(t),{}),0===t&&i.emit(R.EVENT_KEYS.ALL_CALLS_CLEARED)}),i.serviceIndicator);return i.callCollection[r.getCorrelationId()]=r,L.default.log("New call created with correlationId: ".concat(r.getCorrelationId()),{}),L.default.info("ADD:: Added corelationId: ".concat(r.getCorrelationId()," to CallManager , Number of call records now:- ").concat(E()(i.getActiveCalls()).length),{}),r})),(0,f.Z)((0,c.Z)(i),"endCall",(function(e){var t=i.getCall(e);t&&t.end()})),(0,f.Z)((0,c.Z)(i),"getCall",(function(e){return i.callCollection[e]})),(0,f.Z)((0,c.Z)(i),"getActiveCalls",(function(){return i.callCollection})),i.sdkConnector=x.default,i.serviceIndicator=r,i.sdkConnector.getWebex()||x.default.setWebex(e),i.webex=i.sdkConnector.getWebex(),i.callCollection={},i.activeMobiusUrl="",i.listenForWsEvents(),i}return(0,s.Z)(n,[{key:"updateActiveMobius",value:function(e){this.activeMobiusUrl=e}},{key:"listenForWsEvents",value:function(){var e=this;this.sdkConnector.registerListener("event:mobius",function(){var t=(0,o.Z)(h().mark((function t(n){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.dequeueWsEvents(n);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"dequeueWsEvents",value:function(e){var t=this,n=e,r=n.data,i=r.callId,o=r.correlationId;switch(n.data.eventType){case w.MobiusEventType.CALL_SETUP:if(L.default.log("Received call Setup message for call: ".concat(i),{file:C.CALL_MANAGER_FILE,method:"dequeueWsEvents"}),n.data.midCallService)return void n.data.midCallService.forEach((function(e){var n=t.getCall(o);n?n.handleMidCallEvent(e):L.default.log("Dropping midcall event of type: ".concat(e.eventType," as it doesn't match with any existing call"),{file:C.CALL_MANAGER_FILE,method:"dequeueWsEvents"})}));var a,s=E()(this.callCollection).find((function(e){return t.callCollection[e].getCallId()===i}));s?(L.default.info("Found the call Object with a matching callId: ".concat(i," from our records with correlationId: ").concat(s),{file:C.CALL_MANAGER_FILE,method:"dequeueWsEvents"}),a=this.getCall(s)):(a=this.createCall({},b.CallDirection.INBOUND,n.data.deviceId),L.default.log("New incoming call created with correlationId from Call Setup message: ".concat(a.getCorrelationId()),{file:C.CALL_MANAGER_FILE,method:"dequeueWsEvents"}),a.setCallId(i),n.data.broadworksCorrelationInfo&&(L.default.log("Found broadworksCorrelationInfo: ".concat(n.data.broadworksCorrelationInfo),{file:C.CALL_MANAGER_FILE,method:"dequeueWsEvents"}),a.setBroadworksCorrelationInfo(n.data.broadworksCorrelationInfo))),n.data.callerId&&(L.default.info("Processing Caller-Id data",{file:C.CALL_MANAGER_FILE,method:"dequeueWsEvents"}),a.startCallerIdResolution(n.data.callerId)),this.emit(R.EVENT_KEYS.INCOMING_CALL,a),a.sendCallStateMachineEvt({type:"E_RECV_CALL_SETUP",data:n.data});break;case w.MobiusEventType.CALL_PROGRESS:L.default.log("Received call progress mobiusEvent for call: ".concat(o),{file:C.CALL_MANAGER_FILE,method:"dequeueWsEvents"}),this.getCall(o).sendCallStateMachineEvt({type:"E_RECV_CALL_PROGRESS",data:n.data});break;case w.MobiusEventType.CALL_MEDIA:var c;if(L.default.log("Received call media mobiusEvent for call: ".concat(o),{file:C.CALL_MANAGER_FILE,method:"dequeueWsEvents"}),o)c=this.getCall(o);else{var u=E()(this.callCollection).find((function(e){return t.callCollection[e].getCallId()===i}));u?(L.default.info("Found the call Object with a matching callId: ".concat(i," from our records with correlationId: ").concat(u),{file:C.CALL_MANAGER_FILE,method:"dequeueWsEvents"}),c=this.getCall(u)):(c=this.createCall({},b.CallDirection.INBOUND,n.data.deviceId),L.default.log("New incoming call created with correlationId from ROAP Message: ".concat(c.getCorrelationId()),{file:C.CALL_MANAGER_FILE,method:"dequeueWsEvents"}),c.setCallId(i))}if(c){var d,l,f,p,h;L.default.info("SDP from mobius ".concat(null===(d=n.data.message)||void 0===d?void 0:d.sdp),{file:C.CALL_MANAGER_FILE,method:"dequeueWsEvents"}),L.default.log("ROAP message from mobius with type:  ".concat(null===(l=n.data.message)||void 0===l?void 0:l.messageType,", seq: ").concat(null===(f=n.data.message)||void 0===f?void 0:f.seq," , version: ").concat(null===(p=n.data.message)||void 0===p?void 0:p.version),{file:C.CALL_MANAGER_FILE,method:"dequeueWsEvents"});var v=null===(h=n.data.message)||void 0===h?void 0:h.messageType;switch(v){case w.MediaState.OFFER:L.default.log("Received OFFER",{file:C.CALL_MANAGER_FILE,method:"dequeueWsEvents"}),c.sendMediaStateMachineEvt({type:"E_RECV_ROAP_OFFER",data:n.data.message});break;case w.MediaState.ANSWER:L.default.log("Received ANSWER",{file:C.CALL_MANAGER_FILE,method:"dequeueWsEvents"}),c.sendMediaStateMachineEvt({type:"E_RECV_ROAP_ANSWER",data:n.data.message});break;case w.MediaState.OFFER_REQUEST:L.default.log("Received OFFER_REQUEST",{file:C.CALL_MANAGER_FILE,method:"dequeueWsEvents"}),c.sendMediaStateMachineEvt({type:"E_RECV_ROAP_OFFER_REQUEST",data:n.data.message});break;case w.MediaState.OK:L.default.log("Received OK",{file:C.CALL_MANAGER_FILE,method:"dequeueWsEvents"});var m={received:!0,message:n.data.message};c.sendMediaStateMachineEvt({type:"E_ROAP_OK",data:m});break;case w.MediaState.ERROR:L.default.log("Received Error...",{file:C.CALL_MANAGER_FILE,method:"dequeueWsEvents"});break;default:L.default.log("Unknown Media mobiusEvent: ".concat(v," "),{file:C.CALL_MANAGER_FILE,method:"dequeueWsEvents"})}}else L.default.log("CorrelationId: ".concat(o," doesn't exist , discarding.."),{file:C.CALL_MANAGER_FILE,method:"dequeueWsEvents"});break;case w.MobiusEventType.CALL_CONNECTED:L.default.log("Received call connect for call: ".concat(o),{file:C.CALL_MANAGER_FILE,method:"dequeueWsEvents"}),this.getCall(o).sendCallStateMachineEvt({type:"E_RECV_CALL_CONNECT",data:n.data});break;case w.MobiusEventType.CALL_DISCONNECTED:L.default.log("Received call disconnect for call: ".concat(o),{file:C.CALL_MANAGER_FILE,method:"dequeueWsEvents"});var g=this.getCall(o);g&&g.sendCallStateMachineEvt({type:"E_RECV_CALL_DISCONNECT"});break;default:L.default.log("Unknown Call Event mobiusEvent: ".concat(n.data.eventType),{file:C.CALL_MANAGER_FILE,method:"dequeueWsEvents"})}}}]),n}(T.Eventing);exports.CallManager=O;exports.getCallManager=function(e,t){return _||(_=new O(e,t)),_}},82060:(e,t,n)=>{"use strict";n.r(t);var r=n(26771);n.n(r)()(exports,"__esModule",{value:!0}),exports.TransferType=exports.MobiusCallState=exports.RoapScenario=exports.MidCallEventType=exports.DisconnectCause=exports.DisconnectCode=exports.MediaState=exports.MobiusEventType=void 0,function(e){e.CALL_SETUP="mobius.call",e.CALL_PROGRESS="mobius.callprogress",e.CALL_CONNECTED="mobius.callconnected",e.CALL_MEDIA="mobius.media",e.CALL_DISCONNECTED="mobius.calldisconnected"}(exports.MobiusEventType||(exports.MobiusEventType={})),function(e){e.OFFER="OFFER",e.ANSWER="ANSWER",e.OFFER_REQUEST="OFFER_REQUEST",e.OK="OK",e.ERROR="ERROR"}(exports.MediaState||(exports.MediaState={})),function(e){e[e.BUSY=115]="BUSY",e[e.NORMAL=0]="NORMAL",e[e.MEDIA_INACTIVITY=131]="MEDIA_INACTIVITY"}(exports.DisconnectCode||(exports.DisconnectCode={})),function(e){e.BUSY="User Busy.",e.NORMAL="Normal Disconnect.",e.MEDIA_INACTIVITY="Media Inactivity."}(exports.DisconnectCause||(exports.DisconnectCause={})),function(e){e.CALL_INFO="callInfo",e.CALL_STATE="callState"}(exports.MidCallEventType||(exports.MidCallEventType={})),function(e){e.ANSWER="ANSWER",e.OK="OK",e.OFFER="OFFER",e.ERROR="ERROR",e.OFFER_RESPONSE="OFFER_RESPONSE"}(exports.RoapScenario||(exports.RoapScenario={})),function(e){e.PROCEEDING="sig_proceeding",e.PROGRESS="sig_progress",e.ALERTING="sig_alerting",e.CONNECTED="sig_connected"}(exports.MobiusCallState||(exports.MobiusCallState={})),function(e){e.BLIND="BLIND",e.CONSULT="CONSULT"}(exports.TransferType||(exports.TransferType={}))},74364:(e,t,n)=>{"use strict";n.r(t);var r=n(26771);n.n(r)()(exports,"__esModule",{value:!0}),exports.RTC_ICE_CANDIDATE_PAIR=exports.MEDIA_ID=exports.CODEC_ID=exports.REGISTRATION_FILE=exports.METRIC_FILE=exports.CALL_MANAGER_FILE=exports.CALL_FILE=exports.CALLING_CLIENT_FILE=exports.UTILS_FILE=exports.CALLER_ID_FILE=exports.WEBEX_WEB_CLIENT=exports.WEBEX=exports.WEB_AGENT=exports.VALID_PHONE=exports.URL_ENDPOINT=exports.SUPPLEMENTARY_SERVICES_TIMEOUT=exports.REGISTER_RETRY_TIMEOUT=exports.SPARK_USER_AGENT=exports.SCIM_USER_FILTER=exports.SCIM_ENDPOINT_RESOURCE=exports.RESUME_ENDPOINT=exports.TRANSFER_ENDPOINT=exports.HOLD_ENDPOINT=exports.CALL_TRANSFER_SERVICE=exports.CALL_HOLD_SERVICE=exports.NETWORK_FLAP_TIMEOUT=exports.MEDIA_ENDPOINT_RESOURCE=exports.INITIAL_SEQ_NUMBER=exports.IDENTITY_ENDPOINT_RESOURCE=exports.IP_ENDPOINT=exports.IDENTITY_BROKER=exports.FETCH_NAME=exports.DUMMY_MOBIUS_URL=exports.DUMMY_METRICS=exports.DISCOVERY_URL=exports.DEVICES_ENDPOINT_RESOURCE=exports.DEFAULT_SESSION_TIMER=exports.DEFAULT_REHOMING_INTERVAL_MIN=exports.DEFAULT_REHOMING_INTERVAL_MAX=exports.DEFAULT_LOCAL_CALL_ID=exports.DEFAULT_KEEPALIVE_INTERVAL=exports.CRLF=exports.CISCO_DEVICE_URL=exports.CALLS_ENDPOINT_RESOURCE=exports.CALL_STATUS_RESOURCE=exports.CALL_ENDPOINT_RESOURCE=exports.CALLING_USER_AGENT=exports.CALLING_FEATURE=exports.REPO_NAME=exports.VERSION=void 0,exports.RECONNECT_UTIL=exports.CALLS_CLEARED_HANDLER_UTIL=exports.NETWORK_CHANGE_DETECTION_UTIL=exports.FAILOVER_UTIL=exports.FAILBACK_429_RETRY_UTIL=exports.FAILBACK_UTIL=exports.KEEPALIVE_UTIL=exports.GET_MOBIUS_SERVERS_UTIL=exports.REGISTER_UTIL=exports.REG_FAILBACK_429_MAX_RETRIES=exports.REG_TRY_BACKUP_TIMER_VAL_IN_SEC=exports.REG_RANDOM_T_FACTOR_UPPER_LIMIT=exports.MINUTES_TO_SEC_MFACTOR=exports.SEC_TO_MSEC_MFACTOR=exports.BASE_REG_RETRY_TIMER_VAL_IN_SEC=exports.BASE_REG_TIMER_MFACTOR=exports.RTP_TX_STAT=exports.RTP_RX_STAT=exports.TOTAL_SAMPLES_DURATION=exports.SELECTED_CANDIDATE_PAIR_ID=exports.BYTES_SENT=exports.BYTES_RECEIVED=exports.MEDIA_SOURCE=exports.TARGET_BIT_RATE=exports.TRANSPORT=exports.TYPE=exports.TIMESTAMP=exports.JITTER_BUFFER_EMITTED_COUNT=exports.JITTER_BUFFER_DELAY=exports.PACKETS_DISCARDED=exports.PACKETS_LOST=exports.PACKETS_SENT=exports.PACKETS_RECEIVED=exports.OUTBOUND_RTP=exports.INBOUND_RTP=exports.ROUND_TRIP_TIME_MEASUREMENTS=exports.TOTAL_ROUND_TRIP_TIME=exports.REMOTE_INBOUND_RTP=exports.MIME_TYPE=exports.OUTBOUND_CODEC_MATCH=exports.INBOUND_CODEC_MATCH=exports.RTC_CODEC=exports.NETWORK_TYPE=exports.RTC_ICE_CANDIDATE=exports.LOCAL_CANDIDATE_ID=void 0,exports.VERSION="1.66.0",exports.REPO_NAME="web-calling-sdk",exports.CALLING_FEATURE="web-calling",exports.CALLING_USER_AGENT="".concat(exports.REPO_NAME,"/").concat(exports.VERSION," (").concat(exports.CALLING_FEATURE,")"),exports.CALL_ENDPOINT_RESOURCE="call",exports.CALL_STATUS_RESOURCE="status",exports.CALLS_ENDPOINT_RESOURCE="calls",exports.CISCO_DEVICE_URL="cisco-device-url",exports.CRLF="\r\n",exports.DEFAULT_KEEPALIVE_INTERVAL=30,exports.DEFAULT_LOCAL_CALL_ID="DefaultLocalId",exports.DEFAULT_REHOMING_INTERVAL_MAX=120,exports.DEFAULT_REHOMING_INTERVAL_MIN=60,exports.DEFAULT_SESSION_TIMER=6e5,exports.DEVICES_ENDPOINT_RESOURCE="devices",exports.DISCOVERY_URL="https://ds.ciscospark.com/v1/region",exports.DUMMY_METRICS={"rtp-rxstat":{Dur:0,Pkt:0,Oct:0,LatePkt:0,LostPkt:0,AvgJit:0,VQMetrics:{VoRxCodec:"unknown",VoPktSizeMs:0,maxJitter:0,VoOneWayDelayMs:0,networkType:"unknown",hwType:"unknown"}},"rtp-txstat":{Dur:0,Pkt:0,Oct:0,VQMetrics:{VoTxCodec:"unknown",rtpBitRate:0}}},exports.DUMMY_MOBIUS_URL="https://mobius.aintgen-a-1.int.infra.webex.com/api/v1",exports.FETCH_NAME=/^[a-zA-Z ]+/,exports.IDENTITY_BROKER="https://identitybts.webex.com/",exports.IP_ENDPOINT="myip",exports.IDENTITY_ENDPOINT_RESOURCE="identity",exports.INITIAL_SEQ_NUMBER=1,exports.MEDIA_ENDPOINT_RESOURCE="media",exports.NETWORK_FLAP_TIMEOUT=2e3,exports.CALL_HOLD_SERVICE="callhold",exports.CALL_TRANSFER_SERVICE="calltransfer",exports.HOLD_ENDPOINT="hold",exports.TRANSFER_ENDPOINT="commit",exports.RESUME_ENDPOINT="resume",exports.SCIM_ENDPOINT_RESOURCE="scim",exports.SCIM_USER_FILTER="v1/Users?filter=",exports.SPARK_USER_AGENT="spark-user-agent",exports.REGISTER_RETRY_TIMEOUT=1e4,exports.SUPPLEMENTARY_SERVICES_TIMEOUT=1e4,exports.URL_ENDPOINT="/calling/web/",exports.VALID_PHONE=/[\d\s()*#+.-]+/,exports.WEB_AGENT="(web)",exports.WEBEX="webex",exports.WEBEX_WEB_CLIENT="webex-web-client",exports.CALLER_ID_FILE="CallerId",exports.UTILS_FILE="utils",exports.CALLING_CLIENT_FILE="CallingClient",exports.CALL_FILE="call",exports.CALL_MANAGER_FILE="callManager",exports.METRIC_FILE="metric",exports.REGISTRATION_FILE="register",exports.CODEC_ID="codecId",exports.MEDIA_ID="id",exports.RTC_ICE_CANDIDATE_PAIR="RTCIceCandidatePair_",exports.LOCAL_CANDIDATE_ID="localCandidateId",exports.RTC_ICE_CANDIDATE="RTCIceCandidate_",exports.NETWORK_TYPE="networkType",exports.RTC_CODEC="RTCCodec_",exports.INBOUND_CODEC_MATCH="CIT01_",exports.OUTBOUND_CODEC_MATCH="COT01_",exports.MIME_TYPE="mimeType",exports.REMOTE_INBOUND_RTP="remote-inbound-rtp",exports.TOTAL_ROUND_TRIP_TIME="totalRoundTripTime",exports.ROUND_TRIP_TIME_MEASUREMENTS="roundTripTimeMeasurements",exports.INBOUND_RTP="inbound-rtp",exports.OUTBOUND_RTP="outbound-rtp",exports.PACKETS_RECEIVED="packetsReceived",exports.PACKETS_SENT="packetsSent",exports.PACKETS_LOST="packetsLost",exports.PACKETS_DISCARDED="packetsDiscarded",exports.JITTER_BUFFER_DELAY="jitterBufferDelay",exports.JITTER_BUFFER_EMITTED_COUNT="jitterBufferEmittedCount",exports.TIMESTAMP="timestamp",exports.TYPE="type",exports.TRANSPORT="transport",exports.TARGET_BIT_RATE="targetBitrate",exports.MEDIA_SOURCE="media-source",exports.BYTES_RECEIVED="bytesReceived",exports.BYTES_SENT="bytesSent",exports.SELECTED_CANDIDATE_PAIR_ID="selectedCandidatePairId",exports.TOTAL_SAMPLES_DURATION="totalSamplesDuration",exports.RTP_RX_STAT="rtp-rxstat",exports.RTP_TX_STAT="rtp-txstat",exports.BASE_REG_TIMER_MFACTOR=2,exports.BASE_REG_RETRY_TIMER_VAL_IN_SEC=30,exports.SEC_TO_MSEC_MFACTOR=1e3,exports.MINUTES_TO_SEC_MFACTOR=60,exports.REG_RANDOM_T_FACTOR_UPPER_LIMIT=1e4,exports.REG_TRY_BACKUP_TIMER_VAL_IN_SEC=1200,exports.REG_FAILBACK_429_MAX_RETRIES=5,exports.REGISTER_UTIL="registerDevice",exports.GET_MOBIUS_SERVERS_UTIL="getMobiusServers",exports.KEEPALIVE_UTIL="sendKeepAlive",exports.FAILBACK_UTIL="executeFailback",exports.FAILBACK_429_RETRY_UTIL="scheduleFailback429Retry",exports.FAILOVER_UTIL="startFailoverTimer",exports.NETWORK_CHANGE_DETECTION_UTIL="detectNetworkChange",exports.CALLS_CLEARED_HANDLER_UTIL="callsClearedHandler",exports.RECONNECT_UTIL="reconnectOnFailure"},40241:(e,t,n)=>{"use strict";n.r(t);var r=n(8167),i=n(31314),o=n(77193),a=n(26771),s=function(e){return e&&e.__esModule?e:{default:e}};n.n(a)()(exports,"__esModule",{value:!0}),exports.getMetricManager=void 0;var c,u=n(74364),d=n(13563),l=s(n(41309)),f=function(){function e(t,n){(0,r.Z)(this,e),(0,o.Z)(this,"webex",void 0),(0,o.Z)(this,"deviceInfo",void 0),(0,o.Z)(this,"serviceIndicator",void 0),l.default.info("Initializing metric manager...",{file:u.METRIC_FILE}),this.webex=t,this.serviceIndicator=n}return(0,i.Z)(e,[{key:"setDeviceInfo",value:function(e){this.deviceInfo=e}},{key:"submitRegistrationMetric",value:function(e,t,n,r){var i;switch(e){case d.METRIC_EVENT.REGISTRATION:var o,a,s,c,f,p;i={tags:{action:t,device_id:null===(o=this.deviceInfo)||void 0===o||null===(a=o.device)||void 0===a?void 0:a.deviceId,service_indicator:this.serviceIndicator},fields:{device_url:null===(s=this.deviceInfo)||void 0===s||null===(c=s.device)||void 0===c?void 0:c.clientDeviceUri,mobius_url:null===(f=this.deviceInfo)||void 0===f||null===(p=f.device)||void 0===p?void 0:p.uri,calling_sdk_version:u.VERSION},type:n};break;case d.METRIC_EVENT.REGISTRATION_ERROR:var h,v,m,g,E,y;if(r)i={tags:{action:t,device_id:null===(h=this.deviceInfo)||void 0===h||null===(v=h.device)||void 0===v?void 0:v.deviceId,service_indicator:this.serviceIndicator},fields:{device_url:null===(m=this.deviceInfo)||void 0===m||null===(g=m.device)||void 0===g?void 0:g.clientDeviceUri,mobius_url:null===(E=this.deviceInfo)||void 0===E||null===(y=E.device)||void 0===y?void 0:y.uri,calling_sdk_version:u.VERSION,error:r.getError().message,error_type:r.getError().type},type:n};break;default:l.default.warn("Invalid metric name received. Rejecting request to submit metric.",{file:u.METRIC_FILE,method:this.submitRegistrationMetric.name})}i&&this.webex.internal.metrics.submitClientMetrics(e,i)}},{key:"submitCallMetric",value:function(e,t,n,r,i,o){var a;switch(e){case d.METRIC_EVENT.CALL:var s,c,f,p,h,v;a={tags:{action:t,device_id:null===(s=this.deviceInfo)||void 0===s||null===(c=s.device)||void 0===c?void 0:c.deviceId,service_indicator:this.serviceIndicator},fields:{device_url:null===(f=this.deviceInfo)||void 0===f||null===(p=f.device)||void 0===p?void 0:p.clientDeviceUri,mobius_url:null===(h=this.deviceInfo)||void 0===h||null===(v=h.device)||void 0===v?void 0:v.uri,calling_sdk_version:u.VERSION,call_id:r,correlation_id:i},type:n};break;case d.METRIC_EVENT.CALL_ERROR:var m,g,E,y,S,_;if(o)a={tags:{action:t,device_id:null===(m=this.deviceInfo)||void 0===m||null===(g=m.device)||void 0===g?void 0:g.deviceId,service_indicator:this.serviceIndicator},fields:{device_url:null===(E=this.deviceInfo)||void 0===E||null===(y=E.device)||void 0===y?void 0:y.clientDeviceUri,mobius_url:null===(S=this.deviceInfo)||void 0===S||null===(_=S.device)||void 0===_?void 0:_.uri,calling_sdk_version:u.VERSION,call_id:r,correlation_id:i,error:o.getCallError().message,error_type:o.getCallError().type},type:n};break;default:l.default.warn("Invalid metric name received. Rejecting request to submit metric.",{file:u.METRIC_FILE,method:this.submitCallMetric.name})}a&&this.webex.internal.metrics.submitClientMetrics(e,a)}},{key:"submitMediaMetric",value:function(e,t,n,r,i,o,a,s){var c;switch(e){case d.METRIC_EVENT.MEDIA:var f,p,h,v,m,g;c={tags:{action:t,device_id:null===(f=this.deviceInfo)||void 0===f||null===(p=f.device)||void 0===p?void 0:p.deviceId,service_indicator:this.serviceIndicator},fields:{device_url:null===(h=this.deviceInfo)||void 0===h||null===(v=h.device)||void 0===v?void 0:v.clientDeviceUri,mobius_url:null===(m=this.deviceInfo)||void 0===m||null===(g=m.device)||void 0===g?void 0:g.uri,calling_sdk_version:u.VERSION,call_id:r,correlation_id:i,local_media_details:o,remote_media_details:a},type:n};break;case d.METRIC_EVENT.MEDIA_ERROR:var E,y,S,_,C,R;if(s)c={tags:{action:t,device_id:null===(E=this.deviceInfo)||void 0===E||null===(y=E.device)||void 0===y?void 0:y.deviceId,service_indicator:this.serviceIndicator},fields:{device_url:null===(S=this.deviceInfo)||void 0===S||null===(_=S.device)||void 0===_?void 0:_.clientDeviceUri,mobius_url:null===(C=this.deviceInfo)||void 0===C||null===(R=C.device)||void 0===R?void 0:R.uri,calling_sdk_version:u.VERSION,call_id:r,correlation_id:i,local_media_details:o,remote_media_details:a,error:s.getCallError().message,error_type:s.getCallError().type},type:n};break;default:l.default.warn("Invalid metric name received. Rejecting request to submit metric.",{file:u.METRIC_FILE,method:this.submitMediaMetric.name})}c&&this.webex.internal.metrics.submitClientMetrics(e,c)}}]),e}();exports.getMetricManager=function(e,t){return c||(c=new f(e,t)),c}},13563:(e,t,n)=>{"use strict";n.r(t);var r=n(26771);n.n(r)()(exports,"__esModule",{value:!0}),exports.TRANSFER_METRIC=exports.REG_ACTION=exports.METRIC_EVENT=exports.METRIC_TYPE=void 0,function(e){e.OPERATIONAL="operational",e.BEHAVIORAL="behavioral"}(exports.METRIC_TYPE||(exports.METRIC_TYPE={})),function(e){e.CALL="web-calling-sdk-callcontrol",e.CALL_ERROR="web-calling-sdk-callcontrol-error",e.MEDIA="web-calling-sdk-media",e.MEDIA_ERROR="web-calling-sdk-media-error",e.REGISTRATION="web-calling-sdk-registration",e.REGISTRATION_ERROR="web-calling-sdk-registration-error"}(exports.METRIC_EVENT||(exports.METRIC_EVENT={})),function(e){e.REGISTER="register",e.DEREGISTER="deregister",e.KEEPALIVE_FAILURE="keepaliveFailure"}(exports.REG_ACTION||(exports.REG_ACTION={})),function(e){e.BLIND_TRANSFER="Blind Transfer",e.CONSULT_TRANSFER="Consult Transfer"}(exports.TRANSFER_METRIC||(exports.TRANSFER_METRIC={}))},96364:(e,t,n)=>{"use strict";n.r(t);var r=n(5940),i=n.n(r),o=n(95366),a=n.n(o),s=n(26771),c=n.n(s),u=i()?function(e,t,n,r){void 0===r&&(r=n);var i=a()(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),c()(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]},d=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||u(t,e,n)};c()(exports,"__esModule",{value:!0}),d(n(27797),exports)},27797:(e,t,n)=>{"use strict";n.r(t);var r=n(66250),i=n(8167),o=n(31314),a=n(77193),s=n(33453),c=n.n(s),u=n(26771),d=function(e){return e&&e.__esModule?e:{default:e}};n.n(u)()(exports,"__esModule",{value:!0}),exports.createRegistration=exports.Registration=void 0;var l=n(44940),f=n(74364),p=n(14830),h=d(n(4983)),v=function(){function e(t,n){(0,i.Z)(this,e),(0,a.Z)(this,"sdkConnector",void 0),(0,a.Z)(this,"webex",void 0),(0,a.Z)(this,"userId",""),(0,a.Z)(this,"serviceData",void 0),this.sdkConnector=h.default,this.serviceData=n,this.sdkConnector.getWebex()||h.default.setWebex(t),this.webex=this.sdkConnector.getWebex(),this.userId=this.webex.internal.device.userId}var t,n,s;return(0,o.Z)(e,[{key:"postKeepAlive",value:(s=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.webex.request({uri:"".concat(t,"/status"),method:p.HTTP_METHODS.POST,headers:(n={},(0,a.Z)(n,f.CISCO_DEVICE_URL,this.webex.internal.device.url),(0,a.Z)(n,f.SPARK_USER_AGENT,f.CALLING_USER_AGENT),n),service:p.ALLOWED_SERVICES.MOBIUS}));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"deleteDevice",value:(n=(0,r.Z)(c().mark((function e(t,n,r){var i,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=fetch,e.t1="".concat(t).concat(f.DEVICES_ENDPOINT_RESOURCE,"/").concat(n),e.t2=p.HTTP_METHODS.DELETE,i={},(0,a.Z)(i,f.CISCO_DEVICE_URL,r),e.t3=a.Z,e.t4=i,e.next=9,this.webex.credentials.getUserToken();case 9:return e.t5=e.sent,(0,e.t3)(e.t4,"Authorization",e.t5),(0,a.Z)(i,"trackingId","".concat(f.WEBEX_WEB_CLIENT,"_").concat((0,l.v4)())),(0,a.Z)(i,f.SPARK_USER_AGENT,f.CALLING_USER_AGENT),e.t6=i,e.t7={method:e.t2,headers:e.t6},e.next=17,(0,e.t0)(e.t1,e.t7);case 17:return o=e.sent,e.abrupt("return",o.json());case 19:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"createDevice",value:(t=(0,r.Z)(c().mark((function e(t){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={userId:this.userId,clientDeviceUri:this.webex.internal.device.url,serviceData:this.serviceData},e.abrupt("return",this.webex.request({uri:"".concat(t,"device"),method:p.HTTP_METHODS.POST,headers:(n={},(0,a.Z)(n,f.CISCO_DEVICE_URL,r.clientDeviceUri),(0,a.Z)(n,f.SPARK_USER_AGENT,f.CALLING_USER_AGENT),n),body:r,service:p.ALLOWED_SERVICES.MOBIUS}));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();exports.Registration=v;exports.createRegistration=function(e,t){return new v(e,t)}},26379:(e,t,n)=>{"use strict";n.r(t);var r=n(21882),i=n(14917),o=n(66250),a=n(8167),s=n(31314),c=n(77193),u=n(33453),d=n.n(u),l=n(26771),f=n.n(l),p=n(43562),h=n.n(p),v=n(26243),m=n.n(v),g=function(e){return e&&e.__esModule?e:{default:e}};f()(exports,"__esModule",{value:!0}),exports.createContactsClient=exports.ContactsClient=void 0;var E=n(93698),y=n(14830),S=g(n(4983)),_=g(n(41309)),C=n(69462),R=n(99927),T=n(21471),x=function(){function e(t,n){(0,a.Z)(this,e),(0,c.Z)(this,"sdkConnector",void 0),(0,c.Z)(this,"webex",void 0),this.sdkConnector=S.default,this.sdkConnector.getWebex()||S.default.setWebex(t),this.webex=this.sdkConnector.getWebex(),_.default.setLogger(n.level)}var t,n,u;return(0,s.Z)(e,[{key:"getSDKConnector",value:function(){return this.sdkConnector}},{key:"decryptContact",value:(u=(0,o.Z)(d().mark((function e(t,n,r,o){var a,s,c,u,l,f,p,v,m,g,E,y,S,_,C,T,x,b,w,I,L,O,A,k,M,N;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.addressInfo,s=t.companyName,c=t.displayName,u=t.emails,l=t.firstName,f=t.lastName,p=t.phoneNumbers,v=t.sipAddresses,m=t.title,!a){e.next=13;break}_=0,C=h()(a);case 3:if(!(_<C.length)){e.next=13;break}if(T=(0,i.Z)(C[_],2),x=T[0],!(b=T[1])){e.next=9;break}return e.next=8,this.webex.internal.encryption.decryptText(r,b);case 8:b=e.sent;case 9:a[x]=b;case 10:_++,e.next=3;break;case 13:if(!s){e.next=17;break}return e.next=16,this.webex.internal.encryption.decryptText(r,s);case 16:g=e.sent;case 17:return e.next=19,this.webex.internal.encryption.decryptText(r,c);case 19:if(w=e.sent,!l){e.next=24;break}return e.next=23,this.webex.internal.encryption.decryptText(r,l);case 23:E=e.sent;case 24:if(!f){e.next=28;break}return e.next=27,this.webex.internal.encryption.decryptText(r,f);case 27:y=e.sent;case 28:if(!u){e.next=38;break}I=0;case 30:if(!(I<u.length)){e.next=38;break}return L=u[I].value,e.next=34,this.webex.internal.encryption.decryptText(r,L);case 34:u[I].value=e.sent;case 35:I+=1,e.next=30;break;case 38:if(!p){e.next=48;break}O=0;case 40:if(!(O<p.length)){e.next=48;break}return A=p[O].value,e.next=44,this.webex.internal.encryption.decryptText(r,A);case 44:p[O].value=e.sent;case 45:O+=1,e.next=40;break;case 48:if(!v){e.next=58;break}k=0;case 50:if(!(k<v.length)){e.next=58;break}return M=v[k].value,e.next=54,this.webex.internal.encryption.decryptText(r,M);case 54:v[k].value=e.sent;case 55:k+=1,e.next=50;break;case 58:if(!m){e.next=62;break}return e.next=61,this.webex.internal.encryption.decryptText(r,m);case 61:S=e.sent;case 62:return N={addressInfo:a,avatarUrlDomain:n,companyName:g,contactId:t.contactId,contactType:R.ContactType.CUSTOM,displayName:w,emails:u,encryptionKeyUrl:r,firstName:E,groups:t.groups,lastName:y,ownerId:o,phoneNumbers:p,sipAddresses:v,title:S},e.abrupt("return",N);case 64:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return u.apply(this,arguments)})},{key:"fetchContactFromDSS",value:(n=(0,o.Z)(d().mark((function e(t,n,r,i){var o,a,s,c,u,l,f,p,h,v,g,E,y,S,_,C,T;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=[],e.next=3,this.webex.internal.dss.lookup({ids:m()(t)});case 3:for(a=e.sent,s=0;s<a.length;s+=1)c=a[s],u=c.identity,l=c.displayName,f=c.emails,p=c.phoneNumbers,h=c.sipAddresses,v=c.additionalInfo,g=v.department,E=v.firstName,y=v.identityManager,S=v.jobTitle,_=v.lastName,C=y&&y.displayName?y.displayName:void 0,T={avatarUrlDomain:n,contactId:u,contactType:R.ContactType.CLOUD,department:g,displayName:l,emails:f,encryptionKeyUrl:r,firstName:E,groups:t[u],lastName:_,manager:C,ownerId:i,phoneNumbers:p,sipAddresses:h,title:S},o.push(T);return e.abrupt("return",o);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,r,i){return n.apply(this,arguments)})},{key:"getContacts",value:(t=(0,o.Z)(d().mark((function e(){var t,n,i,o,a,s,c,u,l,f,p,h,v,g,S,_,x,b;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={file:C.CONTACTS_FILE,method:"getContacts"},n=[],i={},o="",a="",s="",e.prev=6,e.next=9,this.webex.request({uri:"".concat(this.webex.internal.services._serviceUrls.contactsService,"/").concat(C.ENCRYPT_FILTER,"/").concat(C.USERS,"/").concat(C.CONTACT_FILTER),method:y.HTTP_METHODS.GET});case 9:if(c=e.sent,u=c.body){e.next=13;break}throw new Error("".concat(c));case 13:l=u.contacts,f=0;case 15:if(!(f<l.length)){e.next=31;break}if(p=l[f],o=p.avatarUrlDomain,a=p.encryptionKeyUrl,s=p.ownerId,p.contactType!==R.ContactType.CUSTOM){e.next=27;break}return e.next=23,this.decryptContact(p,o,a,s);case 23:h=e.sent,n.push(h),e.next=28;break;case 27:p.contactType===R.ContactType.CLOUD&&(v=p.contactId,g=p.groups,i[v]=g);case 28:f+=1,e.next=15;break;case 31:if(!m()(i).length){e.next=36;break}return e.next=34,this.fetchContactFromDSS(i,o,a,s);case 34:S=e.sent,n.push.apply(n,(0,r.Z)(S));case 36:return _={statusCode:c[E.STATUS_CODE],data:{contactList:n},message:E.SUCCESS_MESSAGE},e.abrupt("return",_);case 40:return e.prev=40,e.t0=e.catch(6),x=e.t0,b=(0,T.serviceErrorCodeHandler)(x,t),e.abrupt("return",b);case 45:case"end":return e.stop()}}),e,this,[[6,40]])}))),function(){return t.apply(this,arguments)})}]),e}();exports.ContactsClient=x;exports.createContactsClient=function(e,t){return new x(e,t)}},69462:(e,t,n)=>{"use strict";n.r(t);var r=n(26771);n.n(r)()(exports,"__esModule",{value:!0}),exports.USERS=exports.ENCRYPT_FILTER=exports.CONTACT_FILTER=exports.CONTACTS_FILE=void 0,exports.CONTACTS_FILE="Contacts",exports.CONTACT_FILTER="contacts",exports.ENCRYPT_FILTER="encrypt",exports.USERS="Users"},99927:(e,t,n)=>{"use strict";n.r(t);var r=n(26771);n.n(r)()(exports,"__esModule",{value:!0}),exports.ContactType=void 0,function(e){e.CUSTOM="CUSTOM",e.CLOUD="CLOUD"}(exports.ContactType||(exports.ContactType={}))},33846:(e,t,n)=>{"use strict";n.r(t);var r=n(63755),i=n.n(r),o=n(8167),a=n(31314),s=n(23710),c=n(69678),u=n(26305),d=n(35002),l=n(77193),f=n(26771);function p(e){var t=function(){if("undefined"==typeof Reflect||!i())return!1;if(i().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var o=(0,d.Z)(this).constructor;n=i()(r,arguments,o)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}var h=function(e){return e&&e.__esModule?e:{default:e}};n.n(f)()(exports,"__esModule",{value:!0}),exports.createCallError=exports.CallError=void 0;var v=function(e){(0,c.Z)(n,e);var t=p(n);function n(e,r,i,a,c){var u;return(0,o.Z)(this,n),u=t.call(this,e,r,i),(0,l.Z)((0,s.Z)(u),"correlationId",void 0),(0,l.Z)((0,s.Z)(u),"errorLayer",void 0),u.correlationId=a,u.errorLayer=c,u}return(0,a.Z)(n,[{key:"setCallError",value:function(e){this.message=e.message,this.correlationId=e.correlationId,this.context=e.context,this.type=e.type}},{key:"getCallError",value:function(){return{message:this.message,context:this.context,type:this.type,correlationId:this.correlationId,errorLayer:this.errorLayer}}}]),n}(h(n(22770)).default);exports.CallError=v;exports.createCallError=function(e,t,n,r,i){return new v(e,t,n,r,i)}},10475:(e,t,n)=>{"use strict";n.r(t);var r=n(63755),i=n.n(r),o=n(8167),a=n(31314),s=n(23710),c=n(69678),u=n(26305),d=n(35002),l=n(77193),f=n(26771);function p(e){var t=function(){if("undefined"==typeof Reflect||!i())return!1;if(i().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var o=(0,d.Z)(this).constructor;n=i()(r,arguments,o)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}var h=function(e){return e&&e.__esModule?e:{default:e}};n.n(f)()(exports,"__esModule",{value:!0}),exports.createClientError=exports.CallingClientError=void 0;var v=n(14830),m=function(e){(0,c.Z)(n,e);var t=p(n);function n(e,r,i,a){var c;return(0,o.Z)(this,n),c=t.call(this,e,r,i),(0,l.Z)((0,s.Z)(c),"status",v.MobiusStatus.DEFAULT),c.status=a,c}return(0,a.Z)(n,[{key:"setError",value:function(e){this.message=e.message,this.context=e.context,this.type=e.type}},{key:"getError",value:function(){return{message:this.message,context:this.context,type:this.type}}}]),n}(h(n(22770)).default);exports.CallingClientError=m;exports.createClientError=function(e,t,n,r){return new m(e,t,n,r)}},22770:(e,t,n)=>{"use strict";n.r(t);var r=n(63755),i=n.n(r),o=n(31314),a=n(8167),s=n(23710),c=n(69678),u=n(26305),d=n(35002),l=n(67097),f=n(77193),p=n(26771);function h(e){var t=function(){if("undefined"==typeof Reflect||!i())return!1;if(i().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var o=(0,d.Z)(this).constructor;n=i()(r,arguments,o)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}n.n(p)()(exports,"__esModule",{value:!0});var v=n(32064),m=function(e){(0,c.Z)(n,e);var t=h(n);function n(e,r,i){var o;return(0,a.Z)(this,n),o=t.call(this,e),(0,f.Z)((0,s.Z)(o),"type",void 0),(0,f.Z)((0,s.Z)(o),"context",void 0),o.type=i||v.ERROR_TYPE.DEFAULT,o.context=r,o}return(0,o.Z)(n)}((0,l.Z)(Error));exports.default=m},12120:(e,t,n)=>{"use strict";n.r(t);var r=n(26771),i=n.n(r);i()(exports,"__esModule",{value:!0}),exports.CallError=exports.CallingClientError=void 0;var o=n(10475);i()(exports,"CallingClientError",{enumerable:!0,get:function(){return o.CallingClientError}});var a=n(33846);i()(exports,"CallError",{enumerable:!0,get:function(){return a.CallError}})},32064:(e,t,n)=>{"use strict";n.r(t);var r=n(26771);n.n(r)()(exports,"__esModule",{value:!0}),exports.DEVICE_ERROR_CODE=exports.CALL_ERROR_CODE=exports.ERROR_CODE=exports.ERROR_TYPE=exports.ERROR_LAYER=void 0,function(e){e.CALL_CONTROL="call_control",e.MEDIA="media"}(exports.ERROR_LAYER||(exports.ERROR_LAYER={})),function(e){e.CALL_ERROR="call_error",e.DEFAULT="default_error",e.FORBIDDEN_ERROR="forbidden",e.NOT_FOUND="not_found",e.REGISTRATION_ERROR="registration_error",e.SERVICE_UNAVAILABLE="service_unavailable",e.TIMEOUT="timeout",e.TOKEN_ERROR="token_error",e.SERVER_ERROR="server_error"}(exports.ERROR_TYPE||(exports.ERROR_TYPE={})),function(e){e[e.UNAUTHORIZED=401]="UNAUTHORIZED",e[e.FORBIDDEN=403]="FORBIDDEN",e[e.DEVICE_NOT_FOUND=404]="DEVICE_NOT_FOUND",e[e.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",e[e.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.REQUEST_TIMEOUT=408]="REQUEST_TIMEOUT",e[e.TOO_MANY_REQUESTS=429]="TOO_MANY_REQUESTS"}(exports.ERROR_CODE||(exports.ERROR_CODE={})),function(e){e[e.INVALID_STATUS_UPDATE=111]="INVALID_STATUS_UPDATE",e[e.DEVICE_NOT_REGISTERED=112]="DEVICE_NOT_REGISTERED",e[e.CALL_NOT_FOUND=113]="CALL_NOT_FOUND",e[e.ERROR_PROCESSING=114]="ERROR_PROCESSING",e[e.USER_BUSY=115]="USER_BUSY",e[e.PARSING_ERROR=116]="PARSING_ERROR",e[e.TIMEOUT_ERROR=117]="TIMEOUT_ERROR",e[e.NOT_ACCEPTABLE=118]="NOT_ACCEPTABLE",e[e.CALL_REJECTED=119]="CALL_REJECTED",e[e.NOT_AVAILABLE=120]="NOT_AVAILABLE"}(exports.CALL_ERROR_CODE||(exports.CALL_ERROR_CODE={})),function(e){e[e.DEVICE_LIMIT_EXCEEDED=101]="DEVICE_LIMIT_EXCEEDED",e[e.DEVICE_CREATION_DISABLED=102]="DEVICE_CREATION_DISABLED",e[e.DEVICE_CREATION_FAILED=103]="DEVICE_CREATION_FAILED"}(exports.DEVICE_ERROR_CODE||(exports.DEVICE_ERROR_CODE={}))},29004:(e,t,n)=>{"use strict";n.r(t);var r=n(63755),i=n.n(r),o=n(8167),a=n(31314),s=n(14723),c=n(69678),u=n(26305),d=n(35002),l=n(26771);function f(e){var t=function(){if("undefined"==typeof Reflect||!i())return!1;if(i().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var o=(0,d.Z)(this).constructor;n=i()(r,arguments,o)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}var p=function(e){return e&&e.__esModule?e:{default:e}};n.n(l)()(exports,"__esModule",{value:!0}),exports.Eventing=void 0;var h=p(n(17187)),v=p(n(41309)),m=n(56891),g=function(e){(0,c.Z)(n,e);var t=f(n);function n(){return(0,o.Z)(this,n),t.apply(this,arguments)}return(0,a.Z)(n,[{key:"emit",value:function(e){for(var t,r=(new Date).toUTCString(),i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];return v.default.log("".concat(r," ").concat(m.LOG_PREFIX.EVENT,": ").concat(e.toString()," - event emitted with parameters -> ").concat(o," = "),{file:"Events/impl/index.ts",method:"emit"}),(t=(0,s.Z)((0,d.Z)(n.prototype),"emit",this)).call.apply(t,[this,e].concat(o))}},{key:"on",value:function(e,t){return(0,s.Z)((0,d.Z)(n.prototype),"on",this).call(this,e,t)}},{key:"off",value:function(e,t){return(0,s.Z)((0,d.Z)(n.prototype),"off",this).call(this,e,t)}}]),n}(h.default);exports.Eventing=g},93800:(e,t,n)=>{"use strict";n.r(t);var r,i=n(26771);n.n(i)()(exports,"__esModule",{value:!0}),exports.WEBSOCKET_KEYS=exports.WEBSOCKET_SCOPE=exports.MEDIA_CONNECTION_EVENT_KEYS=exports.MOBIUS_EVENT_KEYS=exports.SessionType=exports.Disposition=exports.MOBIUS_MIDCALL_STATE=exports.SUPPLEMENTARY_SERVICES=exports.EVENT_KEYS=void 0,function(e){e.ALERTING="call:alerting",e.CALL_ERROR="call:error",e.CALLER_ID="call:caller_id",e.CONNECT="call:connect",e.CONNECTING="callingClient: connecting",e.DISCONNECT="call:disconnect",e.ERROR="callingClient:error",e.ESTABLISHED="call:established",e.HELD="call:held",e.HOLD_ERROR="call:hold_error",e.INCOMING_CALL="callingClient:incoming_call",e.OUTGOING_CALL="callingClient:outgoing_call",e.PROGRESS="call:progress",e.RECONNECTED="callingClient:reconnected",e.RECONNECTING="callingClient:reconnecting",e.REGISTERED="callingClient:registered",e.REMOTE_MEDIA="call:remote_media",e.RESUME_ERROR="call:resume_error",e.RESUMED="call:resumed",e.TRANSFER_ERROR="call:transfer_error",e.UNREGISTERED="callingClient:unregistered",e.USER_SESSION_INFO="callingClient:user_recent_sessions",e.CB_VOICEMESSAGE_CONTENT_GET="call_back_voicemail_content_get",e.CALL_HISTORY_USER_SESSION_INFO="callHistory:user_recent_sessions",e.ALL_CALLS_CLEARED="callingClient:all_calls_cleared"}(exports.EVENT_KEYS||(exports.EVENT_KEYS={})),function(e){e.HOLD="hold",e.RESUME="resume",e.DIVERT="divert",e.TRANSFER="transfer",e.PARK="park"}(exports.SUPPLEMENTARY_SERVICES||(exports.SUPPLEMENTARY_SERVICES={})),function(e){e.HELD="HELD",e.CONNECTED="CONNECTED"}(exports.MOBIUS_MIDCALL_STATE||(exports.MOBIUS_MIDCALL_STATE={})),function(e){e.ANSWERED="Answered",e.CANCELED="Canceled",e.INITIATED="Initiated",e.MISSED="MISSED"}(exports.Disposition||(exports.Disposition={})),function(e){e.SPARK="SPARK",e.WEBEX_CALLING="WEBEXCALLING"}(exports.SessionType||(exports.SessionType={})),function(e){e.SERVER_EVENT_INCLUSIVE="event:mobius",e.CALL_SESSION_EVENT_INCLUSIVE="event:janus.user_recent_sessions"}(exports.MOBIUS_EVENT_KEYS||(exports.MOBIUS_EVENT_KEYS={})),function(e){e.ROAP_MESSAGE_TO_SEND="roap:messageToSend",e.MEDIA_TYPE_AUDIO="audio"}(exports.MEDIA_CONNECTION_EVENT_KEYS||(exports.MEDIA_CONNECTION_EVENT_KEYS={})),function(e){e.HELD="held",e.REMOTE_HELD="remoteheld",e.CONNECTED="connected"}(r||(r={})),exports.WEBSOCKET_SCOPE="mobius",function(e){e.CALL_PROGRESS="callprogress",e.CALL_CONNECTED="callconnected",e.CALL_DISCONNECTED="callconnected",e.CALL_INFO="callinfo",e.CALL="call",e.ROAP="ROAP"}(exports.WEBSOCKET_KEYS||(exports.WEBSOCKET_KEYS={}))},41309:(e,t,n)=>{"use strict";n.r(t);var r=n(26771);n.n(r)()(exports,"__esModule",{value:!0});var i=n(74364),o=n(56891),a=o.LOGGING_LEVEL.error,s=function(e,t){switch(t){case o.LOGGER.INFO:case o.LOGGER.LOG:console.log(e);break;case o.LOGGER.WARN:console.warn(e);break;case o.LOGGER.ERROR:console.error(e);break;case o.LOGGER.TRACE:console.trace(e)}},c=function(e,t){var n=(new Date).toUTCString();return"".concat(i.REPO_NAME,": ").concat(n,": ").concat(t,": ").concat(o.LOG_PREFIX.FILE,":").concat(e.file," - ").concat(o.LOG_PREFIX.METHOD,":").concat(e.method)};exports.default={log:function(e,t){a>=o.LOGGING_LEVEL.log&&s("".concat(c(t,"[LOG]")," - ").concat(o.LOG_PREFIX.MESSAGE,":").concat(e),o.LOGGER.LOG)},error:function(e,t){a>=o.LOGGING_LEVEL.error&&s("".concat(c(t,"[ERROR]")," - !").concat(o.LOG_PREFIX.ERROR,"!").concat(o.LOG_PREFIX.MESSAGE,":").concat(e.message),o.LOGGER.ERROR)},info:function(e,t){a>=o.LOGGING_LEVEL.info&&s("".concat(c(t,"[INFO]")," - ").concat(o.LOG_PREFIX.MESSAGE,":").concat(e),o.LOGGER.INFO)},warn:function(e,t){a>=o.LOGGING_LEVEL.warn&&s("".concat(c(t,"[WARN]")," - ").concat(o.LOG_PREFIX.MESSAGE,":").concat(e),o.LOGGER.WARN)},trace:function(e,t){a>=o.LOGGING_LEVEL.trace&&s("".concat(c(t,"[TRACE]")," - ").concat(o.LOG_PREFIX.MESSAGE,":").concat(e),o.LOGGER.TRACE)},setLogger:function(e){switch(e){case o.LOGGER.WARN:a=o.LOGGING_LEVEL.warn;break;case o.LOGGER.LOG:a=o.LOGGING_LEVEL.log;break;case o.LOGGER.INFO:a=o.LOGGING_LEVEL.info;break;case o.LOGGER.TRACE:a=o.LOGGING_LEVEL.trace;break;default:a=o.LOGGING_LEVEL.error}var t="Logger initialized for SDK version: ".concat(i.VERSION," with level: ").concat(a);s("".concat(c({file:"logger.ts",method:"setLogger"},""),"  - ").concat(o.LOG_PREFIX.MESSAGE,":").concat(t),o.LOGGER.INFO)},getLogLevel:function(){var e;switch(a){case o.LOGGING_LEVEL.warn:e=o.LOGGER.WARN;break;case o.LOGGING_LEVEL.log:e=o.LOGGER.LOG;break;case o.LOGGING_LEVEL.info:e=o.LOGGER.INFO;break;case o.LOGGING_LEVEL.trace:e=o.LOGGER.TRACE;break;default:e=o.LOGGER.ERROR}return e}}},56891:(e,t,n)=>{"use strict";n.r(t);var r=n(26771);n.n(r)()(exports,"__esModule",{value:!0}),exports.LOGGER=exports.LOGGING_LEVEL=exports.LOG_PREFIX=void 0,function(e){e.MAIN="CALLING_SDK",e.FILE="file",e.METHOD="method",e.EVENT="event",e.MESSAGE="message",e.ERROR="error"}(exports.LOG_PREFIX||(exports.LOG_PREFIX={})),function(e){e[e.error=1]="error",e[e.warn=2]="warn",e[e.log=3]="log",e[e.info=4]="info",e[e.trace=5]="trace"}(exports.LOGGING_LEVEL||(exports.LOGGING_LEVEL={})),function(e){e.ERROR="error",e.WARN="warn",e.INFO="info",e.LOG="log",e.TRACE="trace"}(exports.LOGGER||(exports.LOGGER={}))},4983:(e,t,n)=>{"use strict";n.r(t);var r=n(8167),i=n(31314),o=n(26771),a=n.n(o),s=n(27392),c=n.n(s);a()(exports,"__esModule",{value:!0});var u,d,l=n(56792),f=function(){function e(){(0,r.Z)(this,e)}return(0,i.Z)(e,[{key:"setWebex",value:function(e){if(u)throw new Error("You cannot set the SDKConnector instance more than once");var t=(0,l.validateWebex)(e),n=t.error,r=t.success;if(n)throw n;if(!r)throw new Error("An unknown error occurred setting up the webex instance.");d=e,u=this}},{key:"get",value:function(){return u}},{key:"getWebex",value:function(){return d}},{key:"request",value:function(e){return u.getWebex().request(e)}},{key:"registerListener",value:function(e,t){u.getWebex().internal.mercury.on(e,(function(e){t(e)}))}},{key:"unregisterListener",value:function(e){u.getWebex().internal.mercury.off(e)}}]),e}();exports.default=c()(new f)},56792:(e,t,n)=>{"use strict";n.r(t);var r=n(26771);n.n(r)()(exports,"__esModule",{value:!0}),exports.validateWebex=void 0;exports.validateWebex=function(e){return e.canAuthorize?e.ready?e.internal.mercury?{error:void 0,success:!0}:{error:new Error("webex.internal.mercury is not available"),success:!1}:{error:new Error("webex.ready is not true"),success:!1}:{error:new Error("webex.canAuthorize is not true"),success:!1}}},81145:(e,t,n)=>{"use strict";n.r(t);var r=n(13682),i=n(66250),o=n(8167),a=n(31314),s=n(77193),c=n(33453),u=n.n(c),d=n(26771),l=n.n(d),f=n(18433),p=n.n(f),h=n(26243),v=n.n(h),m=n(78149),g=n.n(m),E=n(73473),y=n.n(E),S=function(e){return e&&e.__esModule?e:{default:e}};l()(exports,"__esModule",{value:!0}),exports.BroadworksBackendConnector=void 0;var _=n(32064),C=S(n(4983)),R=n(93698),T=n(21471),x=n(32873),b=S(n(41309)),w=n(14830),I=n(20637),L=function(){function e(t,n){(0,o.Z)(this,e),(0,s.Z)(this,"bwtoken",void 0),(0,s.Z)(this,"userId",void 0),(0,s.Z)(this,"xsiAccessToken",void 0),(0,s.Z)(this,"xsiEndpoint",void 0),(0,s.Z)(this,"context",void 0),(0,s.Z)(this,"sdkConnector",void 0),(0,s.Z)(this,"webex",void 0),(0,s.Z)(this,"xsiVoiceMessageURI",void 0),this.sdkConnector=C.default,this.sdkConnector.getWebex()||C.default.setWebex(t),this.webex=this.sdkConnector.getWebex(),this.context=Math.random().toString(I.RADIX_RAND).substring(I.PREFIX),b.default.setLogger(n.level)}var t,n,c,d,l,f,h,m,E;return(0,a.Z)(e,[{key:"init",value:function(){var e={file:I.BROADWORKS_VOICEMAIL_FILE,method:"init"};return b.default.info("Initializing Broadworks voicemail connector",e),this.setXsiVoiceMessageURI()}},{key:"getSDKConnector",value:function(){return this.sdkConnector}},{key:"getUserId",value:(E=(0,i.Z)(u().mark((function e(){var t,n,r,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={file:I.BROADWORKS_VOICEMAIL_FILE,method:"getUserId"},e.prev=1,e.next=4,this.getBwToken();case 4:if(!(this.bwtoken&&this.bwtoken.split(".").length>1)){e.next=8;break}return n=Buffer.from(this.bwtoken.split(".")[1],R.BASE64).toString(R.BINARY),this.userId=JSON.parse(n).sub,e.abrupt("return",this.userId);case 8:throw r=_.ERROR_CODE.UNAUTHORIZED,new Error("".concat(r));case 12:return e.prev=12,e.t0=e.catch(1),i={statusCode:e.t0 instanceof Error?Number(e.t0.message):""},e.abrupt("return",(0,T.serviceErrorCodeHandler)(i,t));case 16:case"end":return e.stop()}}),e,this,[[1,12]])}))),function(){return E.apply(this,arguments)})},{key:"getBwToken",value:(m=(0,i.Z)(u().mark((function e(){var t,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.webex.request({uri:"".concat(this.webex.internal.services._serviceUrls.broadworksIdpProxy).concat(I.BW_TOKEN_FETCH_ENDPOINT),method:w.HTTP_METHODS.GET});case 3:t=e.sent,n=t.body,this.bwtoken=n[R.TOKEN][R.BEARER],e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),b.default.info("Broadworks token exception ".concat(e.t0),{});case 11:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return m.apply(this,arguments)})},{key:"setXsiVoiceMessageURI",value:(h=(0,i.Z)(u().mark((function e(){var t,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={file:I.BROADWORKS_VOICEMAIL_FILE,method:"setXsiVoiceMessageURI"},e.next=3,this.getUserId();case 3:return n=e.sent,e.next=6,(0,T.getXsiActionEndpoint)(this.webex,t,x.CALLING_BACKEND.BWRKS);case 6:return this.xsiEndpoint=e.sent,this.xsiAccessToken="".concat(R.BEARER," ").concat(this.bwtoken),b.default.info("XsiEndpoint is ".concat(this.xsiEndpoint),t),n&&(0,r.Z)(n)!==R.OBJECT&&(this.xsiVoiceMessageURI="".concat(this.xsiEndpoint,"/").concat(I.BW_XSI_ENDPOINT_VERSION,"/").concat(R.USER,"/").concat(n,"/").concat(I.VOICE_MESSAGING_MESSAGES),n={statusCode:R.SUCCESS_STATUS_CODE,data:{},message:R.SUCCESS_MESSAGE}),e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"getVoicemailList",value:(f=(0,i.Z)(u().mark((function e(t,n,r,i){var o,a,s,c,d,l,f,h,m,E,y,S,_,C,x,L,O,A,k;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o={file:I.BROADWORKS_VOICEMAIL_FILE,method:"getVoicemailList"},b.default.info("Offset: ".concat(t," Offset limit: ").concat(n," Sort type:").concat(r),o),a="".concat(this.xsiVoiceMessageURI).concat(I.JSON_FORMAT),c=p()(w.SORT).includes(r)?r:w.SORT.DEFAULT,!i){e.next=23;break}return e.prev=5,e.next=8,fetch("".concat(a),{method:w.HTTP_METHODS.GET,headers:{Authorization:this.xsiAccessToken}});case 8:if((h=e.sent).ok){e.next=11;break}throw new Error("".concat(h.status));case 11:return e.next=13,h.json();case 13:m=e.sent,0===v()(null==m||null===(d=m.VoiceMessagingMessages)||void 0===d?void 0:d.messageInfoList).length?s=[]:g()(null==m||null===(l=m.VoiceMessagingMessages)||void 0===l||null===(f=l.messageInfoList)||void 0===f?void 0:f.messageInfo)?(s=null==m||null===(S=m.VoiceMessagingMessages)||void 0===S||null===(_=S.messageInfoList)||void 0===_?void 0:_.messageInfo,s=(0,T.getSortedVoicemailList)(s,c)):s=Array(null==m||null===(E=m.VoiceMessagingMessages)||void 0===E||null===(y=E.messageInfoList)||void 0===y?void 0:y.messageInfo),(0,T.storeVoicemailList)(this.context,s),e.next=23;break;case 18:return e.prev=18,e.t0=e.catch(5),C={statusCode:e.t0 instanceof Error?Number(e.t0.message):""},x=(0,T.serviceErrorCodeHandler)(C,o),e.abrupt("return",x);case 23:return L=(0,T.fetchVoicemailList)(this.context,t,n,o),O=L.messages,A=L.moreVMAvailable,k={statusCode:A?R.SUCCESS_STATUS_CODE:I.NO_VOICEMAIL_STATUS_CODE,data:{voicemailList:O},message:A?R.SUCCESS_MESSAGE:I.NO_VOICEMAIL_MSG},e.abrupt("return",k);case 26:case"end":return e.stop()}}),e,this,[[5,18]])}))),function(e,t,n,r){return f.apply(this,arguments)})},{key:"getVoicemailContent",value:(l=(0,i.Z)(u().mark((function e(t){var n,r,i,o,a,s,c,d,l,f,p,h,v,m;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={file:I.BROADWORKS_VOICEMAIL_FILE,method:"getVoicemailContent"},e.prev=1,o="".concat(this.xsiEndpoint).concat(t),e.next=5,fetch("".concat(o),{method:"GET",headers:{Authorization:this.xsiAccessToken}});case 5:if((a=e.sent).ok){e.next=8;break}throw new Error("".concat(a.status));case 8:return e.next=10,a.text();case 10:return s=e.sent,c=new DOMParser,d=c.parseFromString(s,R.XML_TYPE),l=d.getElementsByTagName(I.MESSAGE_MEDIA_CONTENT)[0],f=null===(r=l.childNodes[1])||void 0===r?void 0:r.textContent,p=null===(i=l.childNodes[2])||void 0===i?void 0:i.textContent,b.default.info("Media type is  ".concat(f),n),h={statusCode:null==a?void 0:a.status,data:{voicemailContent:{type:f,content:p}},message:R.SUCCESS_MESSAGE},e.abrupt("return",h);case 21:return e.prev=21,e.t0=e.catch(1),v={statusCode:e.t0 instanceof Error?Number(e.t0.message):""},m=(0,T.serviceErrorCodeHandler)(v,n),e.abrupt("return",m);case 26:case"end":return e.stop()}}),e,this,[[1,21]])}))),function(e){return l.apply(this,arguments)})},{key:"voicemailMarkAsRead",value:(d=(0,i.Z)(u().mark((function e(t){var n,r,i,o,a,s;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={file:I.BROADWORKS_VOICEMAIL_FILE,method:"voicemailMarkAsRead"},e.prev=1,r="".concat(this.xsiEndpoint).concat(t,"/").concat(I.MARK_AS_READ),e.next=5,fetch(r,{method:w.HTTP_METHODS.PUT,headers:{Authorization:this.xsiAccessToken}});case 5:if((i=e.sent).ok){e.next=8;break}throw new Error("".concat(i.status));case 8:return o={statusCode:i.status,data:{},message:R.SUCCESS_MESSAGE},e.abrupt("return",o);case 12:return e.prev=12,e.t0=e.catch(1),a={statusCode:e.t0 instanceof Error?Number(e.t0.message):""},s=(0,T.serviceErrorCodeHandler)(a,n),e.abrupt("return",s);case 17:case"end":return e.stop()}}),e,this,[[1,12]])}))),function(e){return d.apply(this,arguments)})},{key:"voicemailMarkAsUnread",value:(c=(0,i.Z)(u().mark((function e(t){var n,r,i,o,a,s;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={file:I.BROADWORKS_VOICEMAIL_FILE,method:"voicemailMarkAsUnread"},e.prev=1,r="".concat(this.xsiEndpoint).concat(t,"/").concat(I.MARK_AS_UNREAD),e.next=5,fetch(r,{method:w.HTTP_METHODS.PUT,headers:{Authorization:this.xsiAccessToken}});case 5:if((i=e.sent).ok){e.next=8;break}throw new Error("".concat(i.status));case 8:return o={statusCode:i.status,data:{},message:R.SUCCESS_MESSAGE},e.abrupt("return",o);case 12:return e.prev=12,e.t0=e.catch(1),a={statusCode:e.t0 instanceof Error?Number(e.t0.message):""},s=(0,T.serviceErrorCodeHandler)(a,n),e.abrupt("return",s);case 17:case"end":return e.stop()}}),e,this,[[1,12]])}))),function(e){return c.apply(this,arguments)})},{key:"deleteVoicemail",value:(n=(0,i.Z)(u().mark((function e(t){var n,r,i,o,a,s;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={file:I.BROADWORKS_VOICEMAIL_FILE,method:"deleteVoicemail"},e.prev=1,r="".concat(this.xsiEndpoint).concat(t),e.next=5,fetch(r,{method:w.HTTP_METHODS.DELETE,headers:{Authorization:this.xsiAccessToken}});case 5:if((i=e.sent).ok){e.next=8;break}throw new Error("".concat(i.status));case 8:return o={statusCode:i.status,data:{},message:R.SUCCESS_MESSAGE},e.abrupt("return",o);case 12:return e.prev=12,e.t0=e.catch(1),a=e.t0,s=(0,T.serviceErrorCodeHandler)(a,n),e.abrupt("return",s);case 17:case"end":return e.stop()}}),e,this,[[1,12]])}))),function(e){return n.apply(this,arguments)})},{key:"getVMTranscript",value:(t=(0,i.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b.default.info("Message Id: ".concat(t),{}),e.abrupt("return",y().resolve(null));case 2:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"resolveContact",value:function(e){return b.default.info("Calling Party Info: ".concat(e),{}),y().resolve(null)}}]),e}();exports.BroadworksBackendConnector=L},99688:(e,t,n)=>{"use strict";n.r(t);var r=n(66250),i=n(8167),o=n(31314),a=n(77193),s=n(33453),c=n.n(s),u=n(26771),d=n.n(u),l=n(73473),f=n.n(l),p=function(e){return e&&e.__esModule?e:{default:e}};d()(exports,"__esModule",{value:!0}),exports.UcmBackendConnector=void 0;var h=p(n(4983)),v=n(14830),m=n(21471),g=n(93698),E=p(n(41309)),y=n(20637),S=n(32873),_=function(){function e(t,n){(0,i.Z)(this,e),(0,a.Z)(this,"vgEndpoint",void 0),(0,a.Z)(this,"userId",void 0),(0,a.Z)(this,"orgId",void 0),(0,a.Z)(this,"sdkConnector",void 0),(0,a.Z)(this,"webex",void 0),(0,a.Z)(this,"vgVoiceMessageURI",void 0),this.sdkConnector=h.default,this.sdkConnector.getWebex()||h.default.setWebex(t),this.webex=this.sdkConnector.getWebex(),this.userId=this.webex.internal.device.userId,this.orgId=this.webex.internal.device.orgId,E.default.setLogger(n.level)}var t,n,s,u,d,l,p,_;return(0,o.Z)(e,[{key:"init",value:function(){var e={file:y.UCM_VOICEMAIL_FILE,method:"init"};return E.default.info("Initializing UCM calling voicemail connector",e),this.setUcmVoiceMessageBaseURI()}},{key:"getSDKConnector",value:function(){return this.sdkConnector}},{key:"setUcmVoiceMessageBaseURI",value:function(){return this.vgEndpoint=(0,m.getVgActionEndpoint)(this.webex,S.CALLING_BACKEND.UCM),this.vgVoiceMessageURI="".concat(this.vgEndpoint,"/").concat(y.VMGATEWAY,"/").concat(y.API_V1,"/").concat(g.USERS,"/").concat(this.userId,"/"),this.vgVoiceMessageURI}},{key:"getVoicemailList",value:(_=(0,r.Z)(c().mark((function e(t,n,r){var i,o,a,s,u,d,l,f,p=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={file:y.UCM_VOICEMAIL_FILE,method:"getVoicemailList"},E.default.info("Offset: ".concat(t," Offset limit: ").concat(n," Sort type:").concat(r),i),o="".concat(this.vgVoiceMessageURI).concat(y.VOICEMAILS,"/").concat(y.OFFSET,"=").concat(t).concat(y.LIMIT,"=").concat(n).concat(y.SORT_ORDER,"=").concat(r),e.prev=3,e.next=6,this.webex.request({uri:"".concat(o),method:v.HTTP_METHODS.GET,headers:{orgId:this.orgId}});case 6:return a=e.sent,s=a.body,u=[],s.Message.forEach((function(e){var t={},n={},r={};n.$=e.Duration,t.duration=n,r.$=Number(e.ArrivalTime),t.time=r,(n={$:""}).$=e.MsgId,t.messageId=n,"true"===e.Read&&(t.read={});var i=e.CallerId,o={};(n={$:""}).$=i.CallerName,o.name=n,(n={$:""}).$=p.userId,o.userId=n,(n={$:""}).$=i.CallerNumber,o.address=n,t.callingPartyInfo=o,u.push(t)})),d={statusCode:a.statusCode,data:{voicemailList:u},message:g.SUCCESS_MESSAGE},e.abrupt("return",d);case 15:return e.prev=15,e.t0=e.catch(3),l=e.t0,f=(0,m.serviceErrorCodeHandler)(l,i),e.abrupt("return",f);case 20:case"end":return e.stop()}}),e,this,[[3,15]])}))),function(e,t,n){return _.apply(this,arguments)})},{key:"getVoicemailContent",value:(p=(0,r.Z)(c().mark((function e(t){var n,r,i,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={file:y.UCM_VOICEMAIL_FILE,method:"getVoicemailContent"},e.prev=1,e.next=4,this.getVoicemailContentUcm(t);case 4:return r=e.sent,e.abrupt("return",r);case 8:return e.prev=8,e.t0=e.catch(1),i=e.t0,o=(0,m.serviceErrorCodeHandler)(i,n),E.default.info("Voice mail content error is ".concat(o),n),e.abrupt("return",o);case 14:case"end":return e.stop()}}),e,this,[[1,8]])}))),function(e){return p.apply(this,arguments)})},{key:"getVoicemailContentUcm",value:(l=(0,r.Z)(c().mark((function e(t){var n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new(f())((function(e,i){var o="".concat(n.vgVoiceMessageURI).concat(y.VOICEMAILS,"/").concat(t,"/").concat(g.CONTENT),a="".concat(n.webex.internal.services._serviceUrls.mercuryApi);n.returnUcmPromise(o,a).then((function(t){200===t.statusCode?e(t):202===t.statusCode?n.sdkConnector.registerListener("event:ucm.voicemail_download_complete",function(){var t=(0,r.Z)(c().mark((function t(r){var o,s,u,d;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=r,u="".concat(n.vgVoiceMessageURI).concat(y.VOICEMAILS,"/").concat(null==s||null===(o=s.data)||void 0===o?void 0:o.messageId,"/").concat(g.CONTENT),t.next=4,n.returnUcmPromise(u,a);case 4:200===(d=t.sent).statusCode?(n.sdkConnector.unregisterListener("event:ucm.voicemail_download_complete"),e(d)):(n.sdkConnector.unregisterListener("event:ucm.voicemail_download_complete"),i(d));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()):i(t)})).catch((function(e){i(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return l.apply(this,arguments)})},{key:"returnUcmPromise",value:(d=(0,r.Z)(c().mark((function e(t,n){var r,i,o,a,s,u;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.webex.request({uri:"".concat(t),method:v.HTTP_METHODS.GET,headers:{orgId:this.orgId,deviceUrl:this.webex.internal.device.url,mercuryHostname:n}});case 2:return r=e.sent,i=null==r?void 0:r.body,o=r.headers,a=null==o?void 0:o.mediatype,s=i,u={statusCode:r.statusCode,data:{voicemailContent:{type:a,content:s}},message:g.SUCCESS_MESSAGE},e.abrupt("return",u);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return d.apply(this,arguments)})},{key:"voicemailMarkAsRead",value:(u=(0,r.Z)(c().mark((function e(t){var n,r,i,o,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={file:y.UCM_VOICEMAIL_FILE,method:"voicemailMarkAsRead"},e.prev=1,r="".concat(this.vgVoiceMessageURI).concat(y.VOICEMAILS,"/").concat(t),e.next=5,this.webex.request({uri:r,method:v.HTTP_METHODS.PUT,headers:{orgId:this.orgId},body:{read:"true"}});case 5:return i=e.sent,o={statusCode:i.statusCode,data:{},message:g.SUCCESS_MESSAGE},e.abrupt("return",o);case 10:return e.prev=10,e.t0=e.catch(1),a=e.t0,s=(0,m.serviceErrorCodeHandler)(a,n),e.abrupt("return",s);case 15:case"end":return e.stop()}}),e,this,[[1,10]])}))),function(e){return u.apply(this,arguments)})},{key:"voicemailMarkAsUnread",value:(s=(0,r.Z)(c().mark((function e(t){var n,r,i,o,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={file:y.UCM_VOICEMAIL_FILE,method:"voicemailMarkAsUnread"},e.prev=1,r="".concat(this.vgVoiceMessageURI).concat(y.VOICEMAILS,"/").concat(t),e.next=5,this.webex.request({uri:r,method:v.HTTP_METHODS.PUT,headers:{orgId:this.orgId},body:{read:"false"}});case 5:return i=e.sent,o={statusCode:i.statusCode,data:{},message:g.SUCCESS_MESSAGE},e.abrupt("return",o);case 10:return e.prev=10,e.t0=e.catch(1),a=e.t0,s=(0,m.serviceErrorCodeHandler)(a,n),e.abrupt("return",s);case 15:case"end":return e.stop()}}),e,this,[[1,10]])}))),function(e){return s.apply(this,arguments)})},{key:"deleteVoicemail",value:(n=(0,r.Z)(c().mark((function e(t){var n,r,i,o,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={file:y.UCM_VOICEMAIL_FILE,method:"deleteVoicemail"},e.prev=1,r="".concat(this.vgVoiceMessageURI).concat(y.VOICEMAILS,"/").concat(t),e.next=5,this.webex.request({uri:r,method:v.HTTP_METHODS.DELETE,headers:{orgId:this.orgId}});case 5:return i=e.sent,o={statusCode:i.statusCode,data:{},message:g.SUCCESS_MESSAGE},e.abrupt("return",o);case 10:return e.prev=10,e.t0=e.catch(1),a=e.t0,s=(0,m.serviceErrorCodeHandler)(a,n),e.abrupt("return",s);case 15:case"end":return e.stop()}}),e,this,[[1,10]])}))),function(e){return n.apply(this,arguments)})},{key:"getVMTranscript",value:(t=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return E.default.info("Message Id: ".concat(t),{}),e.abrupt("return",f().resolve(null));case 2:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"resolveContact",value:function(e){return E.default.info("Calling Party Info: ".concat(e),{}),f().resolve(null)}}]),e}();exports.UcmBackendConnector=_},25644:(e,t,n)=>{"use strict";n.r(t);var r=n(63755),i=n.n(r),o=n(66250),a=n(8167),s=n(31314),c=n(23710),u=n(69678),d=n(26305),l=n(35002),f=n(77193),p=n(33453),h=n.n(p),v=n(26771);function m(e){var t=function(){if("undefined"==typeof Reflect||!i())return!1;if(i().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,l.Z)(e);if(t){var o=(0,l.Z)(this).constructor;n=i()(r,arguments,o)}else n=r.apply(this,arguments);return(0,d.Z)(this,n)}}var g=function(e){return e&&e.__esModule?e:{default:e}};n.n(v)()(exports,"__esModule",{value:!0}),exports.createVoicemailClient=exports.Voicemail=void 0;var E=g(n(4983)),y=n(32873),S=g(n(41309)),_=n(21471),C=n(4311),R=n(81145),T=n(29004),x=n(99688),b=function(e){(0,u.Z)(v,e);var t,n,r,i,d,l,p=m(v);function v(e,t){var n;return(0,a.Z)(this,v),n=p.call(this),(0,f.Z)((0,c.Z)(n),"logger",void 0),(0,f.Z)((0,c.Z)(n),"sdkConnector",void 0),(0,f.Z)((0,c.Z)(n),"webex",void 0),(0,f.Z)((0,c.Z)(n),"callingBackend",void 0),(0,f.Z)((0,c.Z)(n),"backendConnector",void 0),n.logger=t,n.sdkConnector=E.default,n.sdkConnector.getWebex()||E.default.setWebex(e),n.webex=n.sdkConnector.getWebex(),n.callingBackend=(0,_.getCallingBackEnd)(n.webex),n.initializeBackendConnector(),S.default.setLogger(t.level),n}return(0,s.Z)(v,[{key:"init",value:function(){return this.backendConnector.init()}},{key:"initializeBackendConnector",value:function(){switch(this.callingBackend){case y.CALLING_BACKEND.WXC:this.backendConnector=new C.WxCallBackendConnector(this.webex,this.logger);break;case y.CALLING_BACKEND.BWRKS:this.backendConnector=new R.BroadworksBackendConnector(this.webex,this.logger);break;case y.CALLING_BACKEND.UCM:this.backendConnector=new x.UcmBackendConnector(this.webex,this.logger);break;default:throw new Error("Calling backend is not identified, exiting....")}}},{key:"getVoicemailList",value:(l=(0,o.Z)(h().mark((function e(t,n,r,i){var o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.backendConnector.getVoicemailList(t,n,r,i);case 2:return o=e.sent,e.abrupt("return",o);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return l.apply(this,arguments)})},{key:"getVoicemailContent",value:(d=(0,o.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.backendConnector.getVoicemailContent(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"voicemailMarkAsRead",value:(i=(0,o.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.backendConnector.voicemailMarkAsRead(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"voicemailMarkAsUnread",value:(r=(0,o.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.backendConnector.voicemailMarkAsUnread(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"deleteVoicemail",value:(n=(0,o.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.backendConnector.deleteVoicemail(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"getVMTranscript",value:(t=(0,o.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.backendConnector.getVMTranscript(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"resolveContact",value:function(e){return this.backendConnector.resolveContact(e)}},{key:"getSDKConnector",value:function(){return this.sdkConnector}}]),v}(T.Eventing);exports.Voicemail=b;exports.createVoicemailClient=function(e,t){return new b(e,t)}},4311:(e,t,n)=>{"use strict";n.r(t);var r=n(66250),i=n(8167),o=n(31314),a=n(77193),s=n(33453),c=n.n(s),u=n(26771),d=n.n(u),l=n(18433),f=n.n(l),p=n(26243),h=n.n(p),v=n(78149),m=n.n(v),g=function(e){return e&&e.__esModule?e:{default:e}};d()(exports,"__esModule",{value:!0}),exports.WxCallBackendConnector=void 0;var E=g(n(4983)),y=n(93698),S=n(21471),_=n(32873),C=g(n(41309)),R=n(14830),T=n(20637),x=function(){function e(t,n){(0,i.Z)(this,e),(0,a.Z)(this,"xsiEndpoint",void 0),(0,a.Z)(this,"userId",void 0),(0,a.Z)(this,"context",void 0),(0,a.Z)(this,"sdkConnector",void 0),(0,a.Z)(this,"xsiVoiceMessageURI",void 0),(0,a.Z)(this,"webex",void 0),this.sdkConnector=E.default,this.sdkConnector.getWebex()||E.default.setWebex(t),this.context=Math.random().toString(T.RADIX_RAND).substring(T.PREFIX),this.webex=this.sdkConnector.getWebex(),this.userId=this.webex.internal.device.userId,C.default.setLogger(n.level)}var t,n,s,u,d,l,p;return(0,o.Z)(e,[{key:"init",value:function(){var e={file:T.WEBEX_CALLING_VOICEMAIL_FILE,method:"init"};return C.default.info("Initializing Webex calling voicemail connector",e),this.setXsiVoiceMessageURI()}},{key:"getSDKConnector",value:function(){return this.sdkConnector}},{key:"setXsiVoiceMessageURI",value:(p=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={file:T.WEBEX_CALLING_VOICEMAIL_FILE,method:"setXsiVoiceMessageURI"},e.next=3,(0,S.getXsiActionEndpoint)(this.webex,n,_.CALLING_BACKEND.WXC);case 3:return this.xsiEndpoint=e.sent,C.default.info("XsiEndpoint is ".concat(this.xsiEndpoint),n),this.userId&&(this.xsiVoiceMessageURI="".concat(this.xsiEndpoint,"/").concat(T.BW_XSI_ENDPOINT_VERSION,"/").concat(y.USER,"/").concat(this.userId,"/").concat(T.VOICE_MESSAGING_MESSAGES),t={statusCode:y.SUCCESS_STATUS_CODE,data:{},message:y.SUCCESS_MESSAGE}),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"getVoicemailList",value:(l=(0,r.Z)(c().mark((function e(t,n,r,i){var o,a,s,u,d,l,p,v,g,E,_,x,b,w,I,L,O,A,k;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o={file:T.WEBEX_CALLING_VOICEMAIL_FILE,method:"getVoicemailList"},C.default.info("Offset: ".concat(t," Offset limit: ").concat(n," Sort type:").concat(r),o),!i){e.next=19;break}return s="".concat(this.xsiVoiceMessageURI).concat(T.JSON_FORMAT),u=f()(R.SORT).includes(r)?r:R.SORT.DEFAULT,e.prev=5,e.next=8,this.webex.request({uri:"".concat(s),method:R.HTTP_METHODS.GET});case 8:v=e.sent,g=v.body,0===h()(null==g||null===(d=g.VoiceMessagingMessages)||void 0===d?void 0:d.messageInfoList).length?a=[]:m()(null==g||null===(l=g.VoiceMessagingMessages)||void 0===l||null===(p=l.messageInfoList)||void 0===p?void 0:p.messageInfo)?(a=null==g||null===(x=g.VoiceMessagingMessages)||void 0===x||null===(b=x.messageInfoList)||void 0===b?void 0:b.messageInfo,a=(0,S.getSortedVoicemailList)(a,u)):a=Array(null==g||null===(E=g.VoiceMessagingMessages)||void 0===E||null===(_=E.messageInfoList)||void 0===_?void 0:_.messageInfo),(0,S.storeVoicemailList)(this.context,a),e.next=19;break;case 14:return e.prev=14,e.t0=e.catch(5),w=e.t0,I=(0,S.serviceErrorCodeHandler)(w,o),e.abrupt("return",I);case 19:return L=(0,S.fetchVoicemailList)(this.context,t,n,o),O=L.messages,A=L.moreVMAvailable,k={statusCode:A?y.SUCCESS_STATUS_CODE:T.NO_VOICEMAIL_STATUS_CODE,data:{voicemailList:O},message:A?y.SUCCESS_MESSAGE:T.NO_VOICEMAIL_MSG},e.abrupt("return",k);case 22:case"end":return e.stop()}}),e,this,[[5,14]])}))),function(e,t,n,r){return l.apply(this,arguments)})},{key:"getVoicemailContent",value:(d=(0,r.Z)(c().mark((function e(t){var n,r,i,o,a,s,u,d,l,f,p,h,v;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={file:T.WEBEX_CALLING_VOICEMAIL_FILE,method:"getVoicemailContent"},e.prev=1,o="".concat(this.xsiEndpoint).concat(t),e.next=5,this.webex.request({uri:"".concat(o),method:R.HTTP_METHODS.GET});case 5:return a=e.sent,s=new DOMParser,u=s.parseFromString(a[y.RAW_REQUEST].response,y.XML_TYPE),d=u.getElementsByTagName(T.MESSAGE_MEDIA_CONTENT)[0],l=null===(r=d.childNodes[1])||void 0===r?void 0:r.textContent,f=null===(i=d.childNodes[2])||void 0===i?void 0:i.textContent,C.default.info("Media type is  ".concat(l),n),p={statusCode:a.statusCode,data:{voicemailContent:{type:l,content:f}},message:y.SUCCESS_MESSAGE},e.abrupt("return",p);case 16:return e.prev=16,e.t0=e.catch(1),h=e.t0,v=(0,S.serviceErrorCodeHandler)(h,n),C.default.info("Voice mail content error is ".concat(v),n),e.abrupt("return",v);case 22:case"end":return e.stop()}}),e,this,[[1,16]])}))),function(e){return d.apply(this,arguments)})},{key:"voicemailMarkAsRead",value:(u=(0,r.Z)(c().mark((function e(t){var n,r,i,o,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={file:T.WEBEX_CALLING_VOICEMAIL_FILE,method:"voicemailMarkAsRead"},e.prev=1,r="".concat(this.xsiEndpoint).concat(t,"/").concat(T.MARK_AS_READ),e.next=5,this.webex.request({uri:r,method:R.HTTP_METHODS.PUT});case 5:return i=e.sent,o={statusCode:i.statusCode,data:{},message:y.SUCCESS_MESSAGE},e.abrupt("return",o);case 10:return e.prev=10,e.t0=e.catch(1),a=e.t0,s=(0,S.serviceErrorCodeHandler)(a,n),e.abrupt("return",s);case 15:case"end":return e.stop()}}),e,this,[[1,10]])}))),function(e){return u.apply(this,arguments)})},{key:"voicemailMarkAsUnread",value:(s=(0,r.Z)(c().mark((function e(t){var n,r,i,o,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={file:T.WEBEX_CALLING_VOICEMAIL_FILE,method:"voicemailMarkAsUnread"},e.prev=1,r="".concat(this.xsiEndpoint).concat(t,"/").concat(T.MARK_AS_UNREAD),e.next=5,this.webex.request({uri:r,method:R.HTTP_METHODS.PUT});case 5:return i=e.sent,o={statusCode:i.statusCode,data:{},message:y.SUCCESS_MESSAGE},e.abrupt("return",o);case 10:return e.prev=10,e.t0=e.catch(1),a=e.t0,s=(0,S.serviceErrorCodeHandler)(a,n),e.abrupt("return",s);case 15:case"end":return e.stop()}}),e,this,[[1,10]])}))),function(e){return s.apply(this,arguments)})},{key:"deleteVoicemail",value:(n=(0,r.Z)(c().mark((function e(t){var n,r,i,o,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={file:T.WEBEX_CALLING_VOICEMAIL_FILE,method:"deleteVoicemail"},e.prev=1,r="".concat(this.xsiEndpoint).concat(t),e.next=5,this.webex.request({uri:r,method:R.HTTP_METHODS.DELETE});case 5:return i=e.sent,o={statusCode:i.statusCode,data:{},message:y.SUCCESS_MESSAGE},e.abrupt("return",o);case 10:return e.prev=10,e.t0=e.catch(1),a=e.t0,s=(0,S.serviceErrorCodeHandler)(a,n),e.abrupt("return",s);case 15:case"end":return e.stop()}}),e,this,[[1,10]])}))),function(e){return n.apply(this,arguments)})},{key:"getVMTranscript",value:(t=(0,r.Z)(c().mark((function e(t){var n,r,i,o,a,s,u,d,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={file:T.WEBEX_CALLING_VOICEMAIL_FILE,method:"getVMTranscript"},e.prev=1,r="".concat(this.xsiEndpoint).concat(t,"/").concat(y.TRANSCRIPT),e.next=5,this.webex.request({uri:r,method:R.HTTP_METHODS.GET});case 5:return i=e.sent,o=new DOMParser,a=o.parseFromString(i[y.RAW_REQUEST].response,y.XML_TYPE),s=a.getElementsByTagName(T.TRANSCRIPT_CONTENT)[0],u={statusCode:i.statusCode,data:{voicemailTranscript:s.textContent},message:y.SUCCESS_MESSAGE},e.abrupt("return",u);case 13:return e.prev=13,e.t0=e.catch(1),d=e.t0,l=(0,S.serviceErrorCodeHandler)(d,n),e.abrupt("return",l);case 18:case"end":return e.stop()}}),e,this,[[1,13]])}))),function(e){return t.apply(this,arguments)})},{key:"resolveContact",value:function(e){return(0,S.resolveContact)(e)}}]),e}();exports.WxCallBackendConnector=x},20637:(e,t,n)=>{"use strict";n.r(t);var r=n(26771);n.n(r)()(exports,"__esModule",{value:!0}),exports.WEBEX_CALLING_VOICEMAIL_FILE=exports.VOICE_MESSAGING_MESSAGES=exports.VOICEMAILS=exports.VMGATEWAY=exports.UCM_VOICEMAIL_FILE=exports.TRANSCRIPT_CONTENT=exports.SORT_ORDER=exports.RADIX_RAND=exports.PREFIX=exports.OFFSET_LIMIT=exports.OFFSET_INDEX=exports.OFFSET=exports.NO_VOICEMAIL_STATUS_CODE=exports.NO_VOICEMAIL_MSG=exports.NATIVE_WEBEX_TEAMS_CALLING=exports.NATIVE_SIP_CALL_TO_UCM=exports.MESSAGE_MEDIA_CONTENT=exports.MARK_AS_UNREAD=exports.MARK_AS_READ=exports.LIMIT=exports.JSON_FORMAT=exports.ENTITLEMENT_STANDARD=exports.ENTITLEMENT_BROADWORKS_CONN=exports.ENTITLEMENT_BASIC=exports.BW_TOKEN_FETCH_ENDPOINT=exports.BW_XSI_URL=exports.BW_XSI_ENDPOINT_VERSION=exports.BROADWORKS_VOICEMAIL_FILE=exports.API_V1=void 0,exports.API_V1="api/v1",exports.BROADWORKS_VOICEMAIL_FILE="BroadworksBackendConnector",exports.BW_XSI_ENDPOINT_VERSION="v2.0",exports.BW_XSI_URL="broadworksXsiActionsUrl",exports.BW_TOKEN_FETCH_ENDPOINT="/idp/bwtoken/fetch",exports.ENTITLEMENT_BASIC="bc-sp-basic",exports.ENTITLEMENT_BROADWORKS_CONN="broadworks-connector",exports.ENTITLEMENT_STANDARD="bc-sp-standard",exports.JSON_FORMAT="?format=json",exports.LIMIT="&limit",exports.MARK_AS_READ="MarkAsRead",exports.MARK_AS_UNREAD="MarkAsUnread",exports.MESSAGE_MEDIA_CONTENT="messageMediaContent",exports.NATIVE_SIP_CALL_TO_UCM="NATIVE_SIP_CALL_TO_UCM",exports.NATIVE_WEBEX_TEAMS_CALLING="NATIVE_WEBEX_TEAMS_CALLING",exports.NO_VOICEMAIL_MSG="No additional voicemails",exports.NO_VOICEMAIL_STATUS_CODE=204,exports.OFFSET="?offset",exports.OFFSET_INDEX=0,exports.OFFSET_LIMIT=100,exports.PREFIX=2,exports.RADIX_RAND=36,exports.SORT_ORDER="&sortOrder",exports.TRANSCRIPT_CONTENT="content",exports.UCM_VOICEMAIL_FILE="UcmBackendConnector",exports.VMGATEWAY="vmgateway",exports.VOICEMAILS="voicemails",exports.VOICE_MESSAGING_MESSAGES="VoiceMessagingMessages",exports.WEBEX_CALLING_VOICEMAIL_FILE="WxCallBackendConnector"},32873:(e,t,n)=>{"use strict";n.r(t);var r=n(26771);n.n(r)()(exports,"__esModule",{value:!0}),exports.CALLING_BACKEND=void 0,function(e){e.WXC="WEBEX_CALLING",e.BWRKS="BROADWORKS_CALLING",e.UCM="UCM_CALLING",e.INVALID="Calling backend is currently not supported"}(exports.CALLING_BACKEND||(exports.CALLING_BACKEND={}))},21471:(e,t,n)=>{"use strict";n.r(t);var r=n(77193),i=n(66250),o=n(33453),a=n.n(o),s=n(5940),c=n.n(s),u=n(95366),d=n.n(u),l=n(26771),f=n.n(l),p=n(26243),h=n.n(p),v=n(8450),m=n.n(v),g=n(73473),E=n.n(g),y=c()?function(e,t,n,r){void 0===r&&(r=n);var i=d()(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),f()(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]},S=c()?function(e,t){f()(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},_=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&y(t,e,n);return S(t,e),t},C=function(e){return e&&e.__esModule?e:{default:e}};f()(exports,"__esModule",{value:!0}),exports.inferIdFromUuid=exports.fetchVoicemailList=exports.storeVoicemailList=exports.resolveContact=exports.resolveCallerIdByName=exports.resolveCallerIdDisplay=exports.getSortedVoicemailList=exports.getVgActionEndpoint=exports.getXsiActionEndpoint=exports.getCallingBackEnd=exports.waitForMsecs=exports.parseMediaQualityStatistics=exports.serviceErrorCodeHandler=exports.handleCallErrors=exports.handleErrors=exports.emitFinalFailure=void 0;var R=_(n(31795)),T=n(13563),x=n(33846),b=n(32064),w=n(14830),I=C(n(41309)),L=n(93800),O=n(10475),A=n(74364),k=n(32873),M=n(93698),N=n(20637),D=C(n(4983));function P(e,t){if(t.devices&&t.devices.length>0){e.setDeviceInfo({userId:t.userId,device:t.devices[0],keepaliveInterval:A.DEFAULT_KEEPALIVE_INTERVAL,rehomingIntervalMax:A.DEFAULT_REHOMING_INTERVAL_MAX,rehomingIntervalMin:A.DEFAULT_REHOMING_INTERVAL_MIN});var n="".concat(A.DEVICES_ENDPOINT_RESOURCE,"/").concat(t.devices[0].deviceId),r=t.devices[0].uri.replace(n,"");return e.setMobiusUrl(r),e.setIsRegistered(w.MobiusStatus.ACTIVE),!0}return!1}function F(e,t,n,r,i){var o={};o.context=e,o.type=t,o.message=n,o.correlationId=r,i.setCallError(o)}function U(e,t,n,r){var i={};i.context=e,i.type=t,i.message=n,r.setError(i)}function Z(e,t,n){switch(t){case A.GET_MOBIUS_SERVERS_UTIL:case A.REGISTER_UTIL:e.sendMetric(T.METRIC_EVENT.REGISTRATION_ERROR,T.REG_ACTION.REGISTER,T.METRIC_TYPE.BEHAVIORAL,n);break;case A.KEEPALIVE_UTIL:e.sendMetric(T.METRIC_EVENT.REGISTRATION,T.REG_ACTION.KEEPALIVE_FAILURE,T.METRIC_TYPE.BEHAVIORAL,n)}}function V(e,t,n,r){Z(e,t,n),r?e.emit(L.EVENT_KEYS.ERROR,n):t===A.REGISTER_UTIL?e.emit(L.EVENT_KEYS.UNREGISTERED):t!==A.KEEPALIVE_UTIL&&e.emit(L.EVENT_KEYS.ERROR,n)}function G(){return(G=(0,i.Z)(a().mark((function e(t,n,r,i){var o,s,c,u,d,l,f;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=(0,O.createClientError)("",{},b.ERROR_TYPE.DEFAULT,w.MobiusStatus.DEFAULT),s={file:i,method:r},c=n.statusCode,u=!1,I.default.warn("Status code: -> ".concat(c),s),e.t0=c,e.next=e.t0===b.ERROR_CODE.UNAUTHORIZED?8:e.t0===b.ERROR_CODE.INTERNAL_SERVER_ERROR?13:e.t0===b.ERROR_CODE.SERVICE_UNAVAILABLE?17:e.t0===b.ERROR_CODE.FORBIDDEN?21:e.t0===b.ERROR_CODE.DEVICE_NOT_FOUND?63:68;break;case 8:return u=!0,I.default.warn("401 Unauthorized",s),U(s,b.ERROR_TYPE.TOKEN_ERROR,"User is unauthorized due to an expired token. Sign out, then sign back in.",o),V(t,r,o,u),e.abrupt("break",70);case 13:return I.default.warn("500 Internal Server Error",s),U(s,b.ERROR_TYPE.SERVER_ERROR,"An unknown error occurred while placing the request. Wait a moment and try again.",o),V(t,r,o,u),e.abrupt("break",70);case 17:return I.default.warn("503 Service Unavailable",s),U(s,b.ERROR_TYPE.SERVICE_UNAVAILABLE,"An error occurred on the server while processing the request. Wait a moment and try again.",o),V(t,r,o,u),e.abrupt("break",70);case 21:if(I.default.warn("403 Forbidden",s),d=n.body){e.next=28;break}return I.default.warn("Error response has no body, throwing default error",s),U(s,b.ERROR_TYPE.FORBIDDEN_ERROR,"An unauthorized action has been received. This action has been blocked. Please contact the administrator if this persists.",o),V(t,r,o,u),e.abrupt("return",u);case 28:l=d.errorCode,I.default.warn("Error code found : ".concat(l),s),e.t1=l,e.next=e.t1===b.DEVICE_ERROR_CODE.DEVICE_LIMIT_EXCEEDED?33:e.t1===b.DEVICE_ERROR_CODE.DEVICE_CREATION_DISABLED?53:e.t1===b.DEVICE_ERROR_CODE.DEVICE_CREATION_FAILED?57:60;break;case 33:if(f="User device limit exceeded",t.isRegRetry()){e.next=50;break}if(!P(t,d)){e.next=47;break}return t.setRegRetry(!0),e.next=40,t.deregister();case 40:return e.next=42,t.restorePreviousRegistration(r);case 42:u=e.sent,t.setRegRetry(!1),t.isDeviceRegistered()&&(f="Restored Successfully"),e.next=48;break;case 47:t.emit(L.EVENT_KEYS.UNREGISTERED);case 48:e.next=51;break;case 50:t.emit(L.EVENT_KEYS.UNREGISTERED);case 51:return U(s,b.ERROR_TYPE.FORBIDDEN_ERROR,f,o),e.abrupt("break",62);case 53:return u=!0,U(s,b.ERROR_TYPE.FORBIDDEN_ERROR,"User is not configured for WebRTC calling. Please contact the administrator to resolve this issue.",o),V(t,r,o,u),e.abrupt("break",62);case 57:return U(s,b.ERROR_TYPE.FORBIDDEN_ERROR,"An unknown error occurred while provisioning the device. Wait a moment and try again.",o),V(t,r,o,u),e.abrupt("break",62);case 60:U(s,b.ERROR_TYPE.FORBIDDEN_ERROR,"An unknown error occurred. Wait a moment and try again. Please contact the administrator if the problem persists.",o),V(t,r,o,u);case 62:return e.abrupt("break",70);case 63:return u=!0,I.default.warn("404 Device Not Found",s),U(s,b.ERROR_TYPE.NOT_FOUND,"The client has unregistered. Please wait for the client to register before attempting the call. If error persists, sign out, sign back in and attempt the call.",o),V(t,r,o,u),e.abrupt("break",70);case 68:I.default.warn("Unknown Error",s),r===A.REGISTER_UTIL&&t.emit(L.EVENT_KEYS.UNREGISTERED);case 70:return e.abrupt("return",u);case 71:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(){return(B=(0,i.Z)(a().mark((function e(t,n,r,i,o,s,c){var u,d,l,f,p,h,v;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u={file:c,method:s},d=(0,x.createCallError)("",u,b.ERROR_TYPE.DEFAULT,"",n),l=o.statusCode,I.default.warn("Status code: ->".concat(l),u),e.t0=l,e.next=e.t0===b.ERROR_CODE.UNAUTHORIZED?7:e.t0===b.ERROR_CODE.FORBIDDEN||e.t0===b.ERROR_CODE.SERVICE_UNAVAILABLE?11:e.t0===b.ERROR_CODE.DEVICE_NOT_FOUND?48:e.t0===b.ERROR_CODE.INTERNAL_SERVER_ERROR?52:56;break;case 7:return I.default.warn("401 Unauthorized",u),F(u,b.ERROR_TYPE.TOKEN_ERROR,"User is unauthorized due to an expired token. Sign out, then sign back in.",i,d),t(d),e.abrupt("break",57);case 11:if(f=o.body){e.next=17;break}return I.default.warn("Error response has no body, throwing default error",u),F(u,403===o.statusCode?b.ERROR_TYPE.FORBIDDEN_ERROR:b.ERROR_TYPE.SERVICE_UNAVAILABLE,403===o.statusCode?"An unauthorized action has been received. This action has been blocked. Please contact the administrator if this persists.":"An error occurred on the server while processing the request. Wait a moment and try again.",i,d),t(d),e.abrupt("return");case 17:if(!(o.headers&&"retry-after"in o.headers&&r)){e.next=22;break}return p=o.headers["retry-after"],I.default.warn("Retry Interval received: ".concat(p),u),r(p),e.abrupt("return");case 22:h=f.errorCode,e.t1=h,e.next=e.t1===b.CALL_ERROR_CODE.INVALID_STATUS_UPDATE?26:e.t1===b.CALL_ERROR_CODE.DEVICE_NOT_REGISTERED?28:e.t1===b.CALL_ERROR_CODE.CALL_NOT_FOUND?30:e.t1===b.CALL_ERROR_CODE.ERROR_PROCESSING?32:e.t1===b.CALL_ERROR_CODE.USER_BUSY?34:e.t1===b.CALL_ERROR_CODE.PARSING_ERROR?36:e.t1===b.CALL_ERROR_CODE.NOT_ACCEPTABLE?38:e.t1===b.CALL_ERROR_CODE.CALL_REJECTED?40:e.t1===b.CALL_ERROR_CODE.NOT_AVAILABLE?42:44;break;case 26:return v="An invalid status update has been received for the call. Wait a moment and try again.",e.abrupt("break",45);case 28:return v="The client has unregistered. Please wait for the client to register before attempting the call. If error persists, sign out, sign back in and attempt the call.",e.abrupt("break",45);case 30:return v="Call is not found on the server. Wait a moment and try again.",e.abrupt("break",45);case 32:return v="An error occurred while processing the call on the server. Wait a moment and try again.",e.abrupt("break",45);case 34:return v="Called user is busy.",e.abrupt("break",45);case 36:return v="An error occurred while parsing the provided information. Wait a moment and try again.",e.abrupt("break",45);case 38:return v="An error occurred on the server while accepting the call. Wait a moment and try again. Please contact the administrator if this persists.",e.abrupt("break",45);case 40:return v="Call rejected by the server. Wait a moment and try again. Please contact the administrator if this persists.",e.abrupt("break",45);case 42:return v="Calling services not available. Wait a moment and try again. Please contact the administrator if this persists.",e.abrupt("break",45);case 44:v="An unknown error occurred. Wait a moment and try again.";case 45:return F(u,403===o.statusCode?b.ERROR_TYPE.FORBIDDEN_ERROR:b.ERROR_TYPE.SERVICE_UNAVAILABLE,v,i,d),t(d),e.abrupt("break",57);case 48:return I.default.warn("404 Call Not Found",u),F(u,b.ERROR_TYPE.NOT_FOUND,"Call is no longer active. Wait a moment and try again.",i,d),t(d),e.abrupt("break",57);case 52:return I.default.warn("500 Internal Server Error",u),F(u,b.ERROR_TYPE.SERVER_ERROR,"An unknown error occurred in the call. Wait a moment and try again.",i,d),t(d),e.abrupt("break",57);case 56:I.default.warn("Unknown Error",u);case 57:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(e,t){return j.apply(this,arguments)}function j(){return(j=(0,i.Z)(a().mark((function e(t,n){var r,i,o,s,c,u,d,l,f,p;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.statusCode,i="FAILURE",e.t0=r,e.next=e.t0===b.ERROR_CODE.BAD_REQUEST?5:e.t0===b.ERROR_CODE.UNAUTHORIZED?8:e.t0===b.ERROR_CODE.FORBIDDEN?11:e.t0===b.ERROR_CODE.DEVICE_NOT_FOUND?14:e.t0===b.ERROR_CODE.REQUEST_TIMEOUT?17:e.t0===b.ERROR_CODE.INTERNAL_SERVER_ERROR?20:e.t0===b.ERROR_CODE.SERVICE_UNAVAILABLE?23:26;break;case 5:return I.default.warn("400 Bad request",n),o={statusCode:400,data:{error:"400 Bad request"},message:i},e.abrupt("return",o);case 8:return I.default.warn("401 User is unauthorised, possible token expiry",n),s={statusCode:401,data:{error:"User is unauthorised, possible token expiry"},message:i},e.abrupt("return",s);case 11:return I.default.warn("403 User request is forbidden",n),c={statusCode:403,data:{error:"User request is forbidden"},message:i},e.abrupt("return",c);case 14:return I.default.warn("404 User info not found",n),u={statusCode:404,data:{error:"User info not found"},message:i},e.abrupt("return",u);case 17:return I.default.warn("408 Request to the server timedout",n),d={statusCode:408,data:{error:"Request to the server timedout"},message:i},e.abrupt("return",d);case 20:return I.default.warn("500 Internal server error occurred",n),l={statusCode:500,data:{error:"Internal server error occurred"},message:i},e.abrupt("return",l);case 23:return I.default.warn("503 Unable to establish a connection with the server",n),f={statusCode:503,data:{error:"Unable to establish a connection with the server"},message:i},e.abrupt("return",f);case 26:return I.default.warn("422 Exception has occurred",n),p={statusCode:422,data:{error:"422 Exception has occurred"},message:i},e.abrupt("return",p);case 29:case"end":return e.stop()}}),e)})))).apply(this,arguments)}exports.emitFinalFailure=function(e,t,n){var r=(0,O.createClientError)("",{},b.ERROR_TYPE.DEFAULT,w.MobiusStatus.DEFAULT);U({file:n,method:t},b.ERROR_TYPE.SERVICE_UNAVAILABLE,"An unknown error occurred. Wait a moment and try again. Please contact the administrator if the problem persists.",r),Z(e,t,r),e.emit(L.EVENT_KEYS.ERROR,r)},exports.handleErrors=function(e,t,n,r){return G.apply(this,arguments)},exports.handleCallErrors=function(e,t,n,r,i,o,a){return B.apply(this,arguments)},exports.serviceErrorCodeHandler=W,exports.parseMediaQualityStatistics=function e(t){if(!t||-1!==navigator.userAgent.indexOf("Firefox"))return I.default.info("RTCStatsReport is null, adding dummy stats",{file:A.UTILS_FILE,method:e.name}),A.DUMMY_METRICS;try{var n,r,i,o,a={},s={},c={},u={},d={},l={},f=0,p=0,v=0,g=0,E="",y=0;l.maxJitter=0,l.VoPktSizeMs=20,t.forEach((function(e){h()(e).forEach((function(t){if(t!==A.TIMESTAMP)if(n&&t!==A.TYPE)if(r&&t!==A.MEDIA_ID)if(r&&-1!==r.indexOf(A.RTC_ICE_CANDIDATE_PAIR))t===A.LOCAL_CANDIDATE_ID&&(s[r]=e[t]);else if(r&&-1!==r.indexOf(A.RTC_ICE_CANDIDATE))t===A.NETWORK_TYPE&&(a[r]=e[t]);else if(!r||-1===r.indexOf(A.INBOUND_CODEC_MATCH)&&-1===r.indexOf(A.OUTBOUND_CODEC_MATCH)&&-1===r.indexOf(A.RTC_CODEC)){if(n&&n===A.REMOTE_INBOUND_RTP)switch(t){case A.TOTAL_ROUND_TRIP_TIME:v=e[t];break;case A.ROUND_TRIP_TIME_MEASUREMENTS:g=e[t]}else if(n&&n===A.INBOUND_RTP)switch(t){case A.CODEC_ID:i=e[t];break;case A.PACKETS_RECEIVED:u.Pkt=e[t];break;case A.BYTES_RECEIVED:u.Oct=e[t];break;case A.PACKETS_DISCARDED:u.LatePkt=e[t];break;case A.PACKETS_LOST:u.LostPkt=e[t];break;case A.JITTER_BUFFER_DELAY:f=e[t];break;case A.JITTER_BUFFER_EMITTED_COUNT:p=e[t]}else if(n&&n===A.TRANSPORT){if(t===A.SELECTED_CANDIDATE_PAIR_ID)E=e[t]}else if(n&&n===A.OUTBOUND_RTP)switch(t){case A.CODEC_ID:o=e[t];break;case A.PACKETS_SENT:d.Pkt=e[t];break;case A.BYTES_SENT:d.Oct=e[t];break;case A.TARGET_BIT_RATE:y=e[t]}else if(n&&n===A.MEDIA_SOURCE&&t===A.TOTAL_SAMPLES_DURATION)u.Dur=e[t],d.Dur=e[t]}else t===A.MIME_TYPE&&(c[r]=e[t]);else r=e[t];else n=e[t]}))})),l.VoOneWayDelayMs=0!==g?v/(2*g):0,l.hwType="".concat(R.os,"/").concat(R.name,"-").concat(R.version),l.networkType=a[s[E]],u.AvgJit=f/p,l.VoRxCodec=c[i].split("/")[1];var S={};S.VoTxCodec=c[o].split("/")[1],S.rtpBitRate=y;var _={};return u.VQMetrics=l,d.VQMetrics=S,_[A.RTP_RX_STAT]=u,_[A.RTP_TX_STAT]=d,I.default.log(m()(_),{file:A.UTILS_FILE,method:e.name}),_}catch(t){return I.default.warn("Caught error while parsing RTP stats, ".concat(t),{file:A.UTILS_FILE,method:e.name}),A.DUMMY_METRICS}};function H(){return(H=(0,i.Z)(a().mark((function e(t,n,r){var i,o,s,c,u,d,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,e.t0=r,e.next=e.t0===k.CALLING_BACKEND.WXC?4:e.t0===k.CALLING_BACKEND.BWRKS?10:17;break;case 4:return e.next=6,t.request({uri:"".concat(t.internal.services._serviceUrls.hydra,"/").concat(M.XSI_ACTION_ENDPOINT_ORG_URL_PARAM),method:w.HTTP_METHODS.GET});case 6:return i=e.sent,o=i.body,s=o[M.ITEMS][0][M.XSI_ACTION_ENDPOINT],e.abrupt("return",s);case 10:return e.next=12,t.request({uri:"".concat(t.internal.services._serviceUrls.wdm,"/").concat(M.DEVICES),method:w.HTTP_METHODS.GET});case 12:return c=e.sent,u=c.body,d=u[M.DEVICES][0][M.SETTINGS][N.BW_XSI_URL],u[M.DEVICES][0][M.SETTINGS][N.BW_XSI_URL].endsWith(N.BW_XSI_ENDPOINT_VERSION)&&(d=u[M.DEVICES][0][M.SETTINGS][N.BW_XSI_URL].slice(0,-5)),e.abrupt("return",d);case 17:throw new Error("Calling backend is not identified, exiting....");case 18:e.next=25;break;case 20:return e.prev=20,e.t1=e.catch(0),W(l=e.t1,n),e.abrupt("return",l);case 25:case"end":return e.stop()}}),e,null,[[0,20]])})))).apply(this,arguments)}function K(e){return q.apply(this,arguments)}function q(){return(q=(0,i.Z)(a().mark((function e(t){var n,i,o,s,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return I.default.info("Starting resolution for filter:- ".concat(t),{file:A.UTILS_FILE,method:"scimQuery"}),i=D.default,o=i.getWebex(),s="".concat(o.internal.services._serviceUrls.identity,"/").concat(A.IDENTITY_ENDPOINT_RESOURCE,"/").concat(A.SCIM_ENDPOINT_RESOURCE,"/").concat(o.internal.device.orgId,"/").concat(A.SCIM_USER_FILTER),c=s+encodeURIComponent(t),e.abrupt("return",o.request({uri:c,method:w.HTTP_METHODS.GET,headers:(n={},(0,r.Z)(n,A.CISCO_DEVICE_URL,o.internal.device.url),(0,r.Z)(n,A.SPARK_USER_AGENT,A.CALLING_USER_AGENT),n),service:w.ALLOWED_SERVICES.MOBIUS}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e){return z.apply(this,arguments)}function z(){return(z=(0,i.Z)(a().mark((function e(t){var n,r,i,o,s,c,u,d,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={},e.prev=1,e.next=4,K(t);case 4:o=e.sent,r=o.body,I.default.info("Number of records found for this user :- ".concat(r.totalResults),{file:A.UTILS_FILE,method:"resolveCallerIdDisplay"}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),s=e.t0,I.default.warn("Error response: - ".concat(s.statusCode),{file:A.UTILS_FILE,method:"resolveCallerIdDisplay"});case 13:return null!==(n=r)&&void 0!==n&&n.totalResults&&r.totalResults>0&&(u=r.Resources[0],i.name=u.displayName,(d=u.phoneNumbers.find((function(e){return!0===e.primary})))?i.num=d.value:u.phoneNumbers.length>0&&(I.default.info("Failure to resolve caller information. Setting number as caller ID",{file:A.UTILS_FILE,method:"resolveCallerIdDisplay"}),i.num=u.phoneNumbers[0].value),l=null===(c=u.photos)||void 0===c?void 0:c.find((function(e){return"thumbnail"===e.type})),i.avatarSrc=l?l.value:"unknown",i.id=u.id,I.default.info("Extracted details:- name: ".concat(i.name," , number: ").concat(i.num,", photo: ").concat(i.avatarSrc,", id: ").concat(i.id),{file:A.UTILS_FILE,method:"resolveCallerIdDisplay"})),e.abrupt("return",i);case 15:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}function X(e){return J.apply(this,arguments)}function J(){return(J=(0,i.Z)(a().mark((function e(t){var n,r,i,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={},r=D.default,i=r.getWebex(),o=function(e){return i.people.list({displayName:e})},e.next=6,o(t).then((function(e){if(I.default.info("DS Result: ".concat(e),{file:A.UTILS_FILE,method:"resolveCallerIdByName"}),e&&e.items&&e.items.length>0){var t=e.items[0];n.name=t.displayName;var r=Buffer.from(t.id,"base64").toString("binary");n.id=r.split("/").pop();var i=t.phoneNumbers.find((function(e){return"work"===e.type}));i?n.num=i.value:t.phoneNumbers.length>0&&(n.num=t.phoneNumbers[0].value),n.avatarSrc=t.avatar,I.default.info("Extracted details:- name: ".concat(n.name," , number: ").concat(n.num,", photo: ").concat(n.avatarSrc,", id: ").concat(n.id),{file:A.UTILS_FILE,method:"resolveCallerIdByName"})}}));case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(){return($=(0,i.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.userExternalId||!t.userExternalId.$){e.next=2;break}return e.abrupt("return",Y('id eq "'.concat(t.userExternalId.$,'"')));case 2:if(!t.name||!t.name.$){e.next=4;break}return e.abrupt("return",X(t.name.$));case 4:return e.abrupt("return",null);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}exports.waitForMsecs=function(e){return new(E())((function(t){setTimeout(t,e)}))},exports.getCallingBackEnd=function(e){var t,n=e.internal.device.features.entitlement.models;if(e.internal.device.callingBehavior===N.NATIVE_WEBEX_TEAMS_CALLING)for(var r=0;r<n.length;r+=1){if(n[r][M.VALUES][M.KEY]===N.ENTITLEMENT_BASIC||n[r][M.VALUES][M.KEY]===N.ENTITLEMENT_STANDARD){t=k.CALLING_BACKEND.WXC;break}if(n[r][M.VALUES][M.KEY]===N.ENTITLEMENT_BROADWORKS_CONN){t=k.CALLING_BACKEND.BWRKS;break}}else t=e.internal.device.callingBehavior===N.NATIVE_SIP_CALL_TO_UCM?k.CALLING_BACKEND.UCM:k.CALLING_BACKEND.INVALID;return t},exports.getXsiActionEndpoint=function(e,t,n){return H.apply(this,arguments)},exports.getVgActionEndpoint=function(e,t){try{if(t&&t===k.CALLING_BACKEND.UCM)return e.internal.services._serviceUrls["ucmgmt-gateway"];throw new Error("Calling backend is not identified, exiting....")}catch(e){return e}},exports.getSortedVoicemailList=function(e,t){return t===w.SORT.DESC?e.sort((function(e,t){return t[M.TIME][M.PLACEHOLDER_KEY]-e[M.TIME][M.PLACEHOLDER_KEY]})):t===w.SORT.ASC&&e.sort((function(e,t){return e[M.TIME][M.PLACEHOLDER_KEY]-t[M.TIME][M.PLACEHOLDER_KEY]})),e},exports.resolveCallerIdDisplay=Y,exports.resolveCallerIdByName=X,exports.resolveContact=function(e){return $.apply(this,arguments)},exports.storeVoicemailList=function(e,t){var n=Buffer.from(m()(t),"utf8").toString("base64");sessionStorage.setItem(e,n.toString())},exports.fetchVoicemailList=function(e,t,n,r){var i=!1,o=[];try{var a=JSON.parse(Buffer.from(sessionStorage.getItem(e),"base64").toString("utf8"));I.default.info("Length of voicemail list:  ".concat(a.length),r),a.length>t+n&&(i=!0),o=a.slice(t,t+n)}catch(e){I.default.warn("Caught exception while fetching voicemail from storage. ".concat(e),r),W(e,{})}return{messages:o,moreVMAvailable:i}},exports.inferIdFromUuid=function(e,t){return Buffer.from("".concat(M.INFER_ID_CONSTANT,"/").concat(t,"/").concat(e),"binary").toString("base64")}},93698:(e,t,n)=>{"use strict";n.r(t);var r=n(26771);n.n(r)()(exports,"__esModule",{value:!0}),exports.INFER_ID_CONSTANT=exports.SERVICES_ENDPOINT=exports.XSI_ACTION_ENDPOINT_ORG_URL_PARAM=exports.XSI_ACTION_ENDPOINT=exports.XML_TYPE=exports.VALUES=exports.USER_SESSIONS=exports.USERS=exports.USER=exports.TRANSCRIPT=exports.TOKEN=exports.TIME=exports.SUCCESS_STATUS_CODE=exports.SUCCESS_MESSAGE=exports.STATUS_CODE=exports.SETTINGS=exports.RESPONSE_MESSAGE=exports.RESPONSE_DATA=exports.RESPONSE=exports.RAW_REQUEST=exports.PLACEHOLDER_KEY=exports.OBJECT=exports.KEY=exports.ITEMS=exports.FAILURE_MESSAGE=exports.DEVICES=exports.CONTENT=exports.BINARY=exports.BEARER=exports.BASE64=void 0,exports.BASE64="base64",exports.BEARER="bearer",exports.BINARY="binary",exports.CONTENT="content",exports.DEVICES="devices",exports.FAILURE_MESSAGE="FAILURE",exports.ITEMS="items",exports.KEY="key",exports.OBJECT="object",exports.PLACEHOLDER_KEY="$",exports.RAW_REQUEST="rawRequest",exports.RESPONSE="response",exports.RESPONSE_DATA="responseData",exports.RESPONSE_MESSAGE="responseMessage",exports.SETTINGS="settings",exports.STATUS_CODE="statusCode",exports.SUCCESS_MESSAGE="SUCCESS",exports.SUCCESS_STATUS_CODE=200,exports.TIME="time",exports.TOKEN="token",exports.TRANSCRIPT="transcript",exports.USER="user",exports.USERS="users",exports.USER_SESSIONS="userSessions",exports.VALUES="_values",exports.XML_TYPE="text/xml",exports.XSI_ACTION_ENDPOINT="xsiActionsEndpoint",exports.XSI_ACTION_ENDPOINT_ORG_URL_PARAM="organizations?callingData=true",exports.SERVICES_ENDPOINT="services",exports.INFER_ID_CONSTANT="ciscospark://us"},29086:(e,t,n)=>{"use strict";n.r(t);var r=n(5940),i=n.n(r),o=n(95366),a=n.n(o),s=n(26771),c=n.n(s),u=i()?function(e,t,n,r){void 0===r&&(r=n);var i=a()(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),c()(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]},d=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||u(t,e,n)};c()(exports,"__esModule",{value:!0}),d(n(21471),exports)},14830:(e,t,n)=>{"use strict";n.r(t);var r=n(26771);n.n(r)()(exports,"__esModule",{value:!0}),exports.DecodeType=exports.ServiceIndicator=exports.SORT_BY=exports.SORT=exports.CallDirection=exports.CallType=exports.MobiusStatus=exports.HTTP_METHODS=exports.ALLOWED_SERVICES=void 0,function(e){e.MOBIUS="mobius",e.JANUS="janus"}(exports.ALLOWED_SERVICES||(exports.ALLOWED_SERVICES={})),function(e){e.GET="GET",e.POST="POST",e.PATCH="PATCH",e.PUT="PUT",e.DELETE="DELETE"}(exports.HTTP_METHODS||(exports.HTTP_METHODS={})),function(e){e.ACTIVE="active",e.DEFAULT="default"}(exports.MobiusStatus||(exports.MobiusStatus={})),function(e){e.URI="uri",e.TEL="tel"}(exports.CallType||(exports.CallType={})),function(e){e.INBOUND="inbound",e.OUTBOUND="outbound"}(exports.CallDirection||(exports.CallDirection={})),function(e){e.ASC="ASC",e.DESC="DESC",e.DEFAULT="DESC"}(exports.SORT||(exports.SORT={})),function(e){e.END_TIME="endTime",e.DEFAULT="endTime",e.START_TIME="startTime"}(exports.SORT_BY||(exports.SORT_BY={})),function(e){e.CALLING="calling",e.CONTACT_CENTER="contactcenter"}(exports.ServiceIndicator||(exports.ServiceIndicator={})),function(e){e.PEOPLE="PEOPLE",e.ORGANIZATION="ORGANIZATION"}(exports.DecodeType||(exports.DecodeType={}))},24621:(e,t,n)=>{"use strict";n.r(t);var r=n(26771),i=n.n(r);i()(exports,"__esModule",{value:!0}),exports.createCallSettingsClient=exports.createContactsClient=exports.createVoicemailClient=exports.createCallHistoryClient=exports.createClient=void 0;var o=n(44614);i()(exports,"createCallSettingsClient",{enumerable:!0,get:function(){return o.createCallSettingsClient}});var a=n(26379);i()(exports,"createContactsClient",{enumerable:!0,get:function(){return a.createContactsClient}});var s=n(52306);i()(exports,"createClient",{enumerable:!0,get:function(){return s.createClient}});var c=n(51732);i()(exports,"createCallHistoryClient",{enumerable:!0,get:function(){return c.createCallHistoryClient}});var u=n(25644);i()(exports,"createVoicemailClient",{enumerable:!0,get:function(){return u.createVoicemailClient}})},72038:(e,t,n)=>{"use strict";n.r(t);var r=n(63755),i=n.n(r),o=n(77193),a=n(14723),s=n(67097),c=n(21882),u=n(14917),d=n(23710),l=n(69678),f=n(26305),p=n(35002),h=n(31314),v=n(8167),m=n(13682),g=n(33453),E=n.n(g),y=n(26771),S=n.n(y),_=n(78149),C=n.n(_),R=n(26243),T=n.n(R),x=n(95366),b=n.n(x),w=n(27392),I=n.n(w),L=n(62207),O=n.n(L),A=n(79529),k=n.n(A),M=n(5940),N=n.n(M),D=n(62962),P=n.n(D),F=n(19031),U=n.n(F),Z=n(83977),V=n.n(Z),G=n(8450),B=n.n(G),W=n(90487),j=n.n(W),H=n(62680),K=n.n(H),q=n(6919),Y=n.n(q),z=n(93364),X=n.n(z),J=n(18281),$=n.n(J),Q=n(27921),ee=n.n(Q),te=n(73473),ne=n.n(te),re=n(71544),ie=n.n(re),oe=n(21986),ae=n.n(oe),se=n(7520),ce=n.n(se),ue=n(18428),de=n.n(ue),le=n(53804),fe=n.n(le),pe=n(66130),he=n.n(pe),ve=n(85579),me=n.n(ve),ge=n(66282),Ee=n.n(ge),ye=n(43562),Se=n.n(ye),_e=n(22013),Ce=n.n(_e);function Re(e,t){var n=void 0!==me()&&e[Ce()]||e["@@iterator"];if(!n){if(C()(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return ee()(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Te(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function xe(e){var t=function(){if("undefined"==typeof Reflect||!i())return!1;if(i().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,p.Z)(e);if(t){var o=(0,p.Z)(this).constructor;n=i()(r,arguments,o)}else n=r.apply(this,arguments);return(0,f.Z)(this,n)}}S()(exports,"__esModule",{value:!0});var be=n(17156),we=n(81670),Ie=n(50468),Le=n(65661);function Oe(e){return e&&"object"===(0,m.Z)(e)&&"default"in e?e:{default:e}}function Ae(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!C()(t)&&T()(t).forEach((function(n){if("default"!==n&&!(n in e)){var r=b()(t,n);S()(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}}))})),I()(e)}var ke=Oe(be),Me=Oe(we),Ne=Oe(Ie),De=Oe(Le),Pe=void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function Fe(){throw new Error("setTimeout has not been defined")}function Ue(){throw new Error("clearTimeout has not been defined")}var Ze=Fe,Ve=Ue;function Ge(e){if(Ze===setTimeout)return setTimeout(e,0);if((Ze===Fe||!Ze)&&setTimeout)return Ze=setTimeout,setTimeout(e,0);try{return Ze(e,0)}catch(t){try{return Ze.call(null,e,0)}catch(t){return Ze.call(this,e,0)}}}"function"==typeof Pe.setTimeout&&(Ze=setTimeout),"function"==typeof Pe.clearTimeout&&(Ve=clearTimeout);var Be,We=[],je=!1,He=-1;function Ke(){je&&Be&&(je=!1,Be.length?We=Be.concat(We):He=-1,We.length&&qe())}function qe(){if(!je){var e=Ge(Ke);je=!0;for(var t=We.length;t;){for(Be=We,We=[];++He<t;)Be&&Be[He].run();He=-1,t=We.length}Be=null,je=!1,function(e){if(Ve===clearTimeout)return clearTimeout(e);if((Ve===Ue||!Ve)&&clearTimeout)return Ve=clearTimeout,clearTimeout(e);try{return Ve(e)}catch(t){try{return Ve.call(null,e)}catch(t){return Ve.call(this,e)}}}(e)}}function Ye(e,t){this.fun=e,this.array=t}Ye.prototype.run=function(){this.fun.apply(null,this.array)};function ze(){}var Xe=ze,Je=ze,$e=ze,Qe=ze,et=ze,tt=ze,nt=ze;var rt=Pe.performance||{},it=rt.now||rt.mozNow||rt.msNow||rt.oNow||rt.webkitNow||function(){return(new Date).getTime()};var ot=new Date;var at={nextTick:function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];We.push(new Ye(e,t)),1!==We.length||je||Ge(qe)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:Xe,addListener:Je,once:$e,off:Qe,removeListener:et,removeAllListeners:tt,emit:nt,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*it.call(rt),n=Math.floor(t),r=Math.floor(t%1*1e9);return e&&(n-=e[0],(r-=e[1])<0&&(n--,r+=1e9)),[n,r]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-ot)/1e3}},st="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},ct={exports:{}};!function(e){!function(){var t,n="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";if(S="object"===(0,m.Z)(at)&&"object"===(0,m.Z)(at.versions)&&at.versions.node&&!at.browser){var r=at.versions.node.toString().replace("v","");n="Nodejs/"+r+" (NodeOS) AppleWebKit/"+r+" (KHTML, like Gecko) Nodejs/"+r+" Nodejs/"+r}t=void 0!==st?st:window,"undefined"==typeof window&&("undefined"==typeof window&&void 0!==st&&(st.navigator={userAgent:n,getUserMedia:function(){}},t.window=st),"undefined"==typeof location&&(t.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(t.screen={width:0,height:0}));var i=window.navigator;void 0!==i?(void 0!==i.webkitGetUserMedia&&(i.getUserMedia=i.webkitGetUserMedia),void 0!==i.mozGetUserMedia&&(i.getUserMedia=i.mozGetUserMedia)):i={getUserMedia:function(){},userAgent:n};var o=!!/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(i.userAgent||""),a=!(-1===i.userAgent.indexOf("Edge")||!i.msSaveOrOpenBlob&&!i.msSaveBlob),s=!!window.opera||i.userAgent.indexOf(" OPR/")>=0,c=i.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(i.userAgent),u=/^((?!chrome|android).)*safari/i.test(i.userAgent),d=!!window.chrome&&!s,l="undefined"!=typeof document&&!!document.documentMode&&!a;function f(e,t){var n=0,r=!1,i=window.setInterval((function(){e()&&(window.clearInterval(i),t(r)),n++>50&&(window.clearInterval(i),t(r=!0))}),10)}var p={Android:function(){return i.userAgent.match(/Android/i)},BlackBerry:function(){return i.userAgent.match(/BlackBerry|BB10/i)},iOS:function(){return i.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return i.userAgent.match(/Opera Mini/i)},Windows:function(){return i.userAgent.match(/IEMobile/i)},any:function(){return p.Android()||p.BlackBerry()||p.iOS()||p.Opera()||p.Windows()},getOsName:function(){var e="Unknown OS";return p.Android()&&(e="Android"),p.BlackBerry()&&(e="BlackBerry"),p.iOS()&&(e="iOS"),p.Opera()&&(e="Opera Mini"),p.Windows()&&(e="Windows"),e}};var h="Unknown OS",v="Unknown OS Version";var g,E,y=function(){for(var e,t=i.appVersion,n=i.userAgent,r="-",o=[{s:"Chrome OS",r:/CrOS/},{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}],a=0;e=o[a];a++)if(e.r.test(n)){r=e.s;break}var s="-";switch(/Windows/.test(r)&&(/Windows (.*)/.test(r)&&(s=/Windows (.*)/.exec(r)[1]),r="Windows"),r){case"Mac OS X":/Mac OS X (10[\.\_\d]+)/.test(n)&&(s=/Mac OS X (10[\.\_\d]+)/.exec(n)[1]);break;case"Android":/Android ([\.\_\d]+)/.test(n)&&(s=/Android ([\.\_\d]+)/.exec(n)[1]);break;case"iOS":/OS (\d+)_(\d+)_?(\d+)?/.test(n)&&(s=/OS (\d+)_(\d+)_?(\d+)?/.exec(t))&&s.length>3&&(s=s[1]+"."+s[2]+"."+(0|s[3]))}return{osName:r,osVersion:s}}();y&&y.osName&&"-"!=y.osName?(h=y.osName,v=y.osVersion):p.any()&&"Android"==(h=p.getOsName())&&(v=!!(E=(g=(g||i.userAgent).toLowerCase()).match(/android\s([0-9\.]*)/))&&E[1]);var S="object"===(0,m.Z)(at)&&"object"===(0,m.Z)(at.versions)&&at.versions.node;"Unknown OS"===h&&S&&(h="Nodejs",v=at.versions.node.toString().replace("v",""));var _=!1,C=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach((function(e){"undefined"!=typeof document&&"function"==typeof document.createElement&&(!_&&e in document.createElement("canvas")&&(_=!0),!C&&e in document.createElement("video")&&(C=!0))}));var R=/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/,x=/([0-9]{1,3}(\.[0-9]{1,3}){3})/,b=/[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7}/;var w=[],I=[],L=[],A=[];i.mediaDevices&&i.mediaDevices.enumerateDevices&&(i.enumerateDevices=function(e){var t=i.mediaDevices.enumerateDevices();t&&t.then?i.mediaDevices.enumerateDevices().then(e).catch((function(){e([])})):e([])});var M=!1;("undefined"!=typeof MediaStreamTrack&&"getSources"in MediaStreamTrack||i.mediaDevices&&i.mediaDevices.enumerateDevices)&&(M=!0);var N=!1,D=!1,P=!1,F=!1,U=!1;var Z=window.DetectRTC||{};Z.browser=function(){i.appVersion;var e,t,n,r=i.userAgent,o=i.appName,f=""+O()(i.appVersion),p=k()(i.appVersion,10);if(s){o="Opera";try{p=(f=i.userAgent.split("OPR/")[1].split(" ")[0]).split(".")[0]}catch(e){f="0.0.0.0",p=0}}else l?((t=r.indexOf("rv:"))>0?f=r.substring(t+3):(t=r.indexOf("MSIE"),f=r.substring(t+5)),o="IE"):d?(t=r.indexOf("Chrome"),o="Chrome",f=r.substring(t+7)):u?-1!==r.indexOf("CriOS")?(t=r.indexOf("CriOS"),o="Chrome",f=r.substring(t+6)):-1!==r.indexOf("FxiOS")?(t=r.indexOf("FxiOS"),o="Firefox",f=r.substring(t+6)):(t=r.indexOf("Safari"),o="Safari",f=r.substring(t+7),-1!==(t=r.indexOf("Version"))&&(f=r.substring(t+8)),-1!==i.userAgent.indexOf("Version/")&&(f=i.userAgent.split("Version/")[1].split(" ")[0])):c?(t=r.indexOf("Firefox"),o="Firefox",f=r.substring(t+8)):(e=r.lastIndexOf(" ")+1)<(t=r.lastIndexOf("/"))&&(o=r.substring(e,t),f=r.substring(t+1),o.toLowerCase()===o.toUpperCase()&&(o=i.appName));return a&&(o="Edge",f=i.userAgent.split("Edge/")[1]),-1!==(n=f.search(/[; \)]/))&&(f=f.substring(0,n)),p=k()(""+f,10),isNaN(p)&&(f=""+O()(i.appVersion),p=k()(i.appVersion,10)),{fullVersion:f,version:p,name:o,isPrivateBrowsing:!1}}(),function(e){var t;try{if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,(function(){t=!1}),(function(e){t=!0}));else if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){var n;try{(n=window.indexedDB.open("test")).onerror=function(){return!0}}catch(e){t=!0}void 0===t&&f((function(){return"done"===n.readyState}),(function(e){e||(t=!n.result)}))}else if(function(e){var t=e.toLowerCase();if(0===t.indexOf("msie")&&0===t.indexOf("trident"))return!1;var n=/(?:msie|rv:)\s?([\d\.]+)/.exec(t);return!!(n&&k()(n[1],10)>=10)}(window.navigator.userAgent)){t=!1;try{window.indexedDB||(t=!0)}catch(e){t=!0}}else if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem("test",1)}catch(e){t=!0}void 0===t&&(t=!1,window.localStorage.removeItem("test"))}}catch(e){t=!1}f((function(){return void 0!==t}),(function(n){e(t)}))}((function(e){Z.browser.isPrivateBrowsing=!!e})),Z.browser["is"+Z.browser.name]=!0,Z.osName=h,Z.osVersion=v,"object"===(0,m.Z)(at)&&"object"===(0,m.Z)(at.versions)&&at.versions["node-webkit"];var V=!1;["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach((function(e){V||e in window&&(V=!0)})),Z.isWebRTCSupported=V,Z.isORTCSupported="undefined"!=typeof RTCIceGatherer;var G=!1;((Z.browser.isChrome&&Z.browser.version>=35||Z.browser.isFirefox&&Z.browser.version>=34||Z.browser.isEdge&&Z.browser.version>=17||"Android"===Z.osName&&Z.browser.isChrome)&&(G=!0),(i.getDisplayMedia||i.mediaDevices&&i.mediaDevices.getDisplayMedia)&&(G=!0),/^(https:|chrome-extension:)$/g.test(location.protocol||""))||("undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(Z.browser.isChrome||Z.browser.isEdge||Z.browser.isOpera)||Z.browser.isFirefox)&&(G=!1);Z.isScreenCapturingSupported=G;var B={isSupported:!1,isCreateMediaStreamSourceSupported:!1};["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"].forEach((function(e){B.isSupported||e in window&&(B.isSupported=!0,window[e]&&"createMediaStreamSource"in window[e].prototype&&(B.isCreateMediaStreamSourceSupported=!0))})),Z.isAudioContextSupported=B.isSupported,Z.isCreateMediaStreamSourceSupported=B.isCreateMediaStreamSourceSupported;var W=!1;Z.browser.isChrome&&Z.browser.version>31&&(W=!0),Z.isRtpDataChannelsSupported=W;var j=!1;(Z.browser.isFirefox&&Z.browser.version>28||Z.browser.isChrome&&Z.browser.version>25||Z.browser.isOpera&&Z.browser.version>=11)&&(j=!0),Z.isSctpDataChannelsSupported=j,Z.isMobileDevice=o;var H=!1;(i.getUserMedia||i.mediaDevices&&i.mediaDevices.getUserMedia)&&(H=!0),Z.browser.isChrome&&Z.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(H="Requires HTTPs"),"Nodejs"===Z.osName&&(H=!1),Z.isGetUserMediaSupported=H;var K,q,Y,z="";screen.width&&(z+=(screen.width?screen.width:"")+" x "+(screen.height?screen.height:""));Z.displayResolution=z,Z.displayAspectRatio=(K=screen.width,q=screen.height,Y=function e(t,n){return 0==n?t:e(n,t%n)}(K,q),K/Y/(q/Y)).toFixed(2),Z.isCanvasSupportsStreamCapturing=_,Z.isVideoSupportsStreamCapturing=C,"Chrome"==Z.browser.name&&Z.browser.version>=53&&(Z.isCanvasSupportsStreamCapturing||(Z.isCanvasSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features"),Z.isVideoSupportsStreamCapturing||(Z.isVideoSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features")),Z.DetectLocalIPAddress=function(e,t){if(Z.isWebRTCSupported){var n=!0,r=!0;!function(e,t){if("undefined"==typeof document||"function"!=typeof document.getElementById)return;var n={},r=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;if(!r){var i=document.getElementById("iframe");if(!i)return;var o=i.contentWindow;r=o.RTCPeerConnection||o.mozRTCPeerConnection||o.webkitRTCPeerConnection}if(!r)return;var a=null;"Chrome"===Z.browser&&Z.browser.version<58&&(a={optional:[{RtpDataChannels:!0}]});var s=new r({iceServers:[{urls:"stun:stun.l.google.com:19302"}]},a);t&&(s.addStream?s.addStream(t):s.addTrack&&t.getTracks()[0]&&s.addTrack(t.getTracks()[0],t));function c(t){if(t){var r=x.exec(t);if(r){var i=r[1],o=t.match(R),a=!0;void 0===n[i]&&e(i,o,a),n[i]=!0}}else e()}if(s.onicecandidate=function(e){e.candidate&&e.candidate.candidate?c(e.candidate.candidate):c()},!t)try{s.createDataChannel("sctp",{})}catch(e){}Z.isPromisesSupported?s.createOffer().then((function(e){s.setLocalDescription(e).then(u)})):s.createOffer((function(e){s.setLocalDescription(e,u,(function(){}))}),(function(){}));function u(){s.localDescription.sdp.split("\n").forEach((function(e){e&&0===e.indexOf("a=candidate:")&&c(e)}))}}((function(t){t?t.match(R)?e("Local: "+t,n=!1,r):t.match(b)?e("Public: "+t,n,r=!1):e("Public: "+t,n,r):e()}),t)}},Z.isWebSocketsSupported="WebSocket"in window&&2===window.WebSocket.CLOSING,Z.isWebSocketsBlocked=!Z.isWebSocketsSupported,"Nodejs"===Z.osName&&(Z.isWebSocketsSupported=!0,Z.isWebSocketsBlocked=!1),Z.checkWebSocketsSupport=function(e){e=e||function(){};try{var t,n=new WebSocket("wss://echo.websocket.org:443/");n.onopen=function(){Z.isWebSocketsBlocked=!1,t=(new Date).getTime(),n.send("ping")},n.onmessage=function(){Z.WebsocketLatency=(new Date).getTime()-t+"ms",e(),n.close(),n=null},n.onerror=function(){Z.isWebSocketsBlocked=!0,e()}}catch(t){Z.isWebSocketsBlocked=!0,e()}},Z.load=function(e){!function(e){if(M)if(!i.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(i.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!i.enumerateDevices&&i.enumerateDevices&&(i.enumerateDevices=i.enumerateDevices.bind(i)),i.enumerateDevices){w=[],I=[],L=[],A=[],N=!1,D=!1,P=!1,F=!1,U=!1;var t={};i.enumerateDevices((function(n){w=[],I=[],L=[],A=[],n.forEach((function(e){var n={};for(var r in e)try{"function"!=typeof e[r]&&(n[r]=e[r])}catch(e){}t[n.deviceId+n.label+n.kind]||("audio"===n.kind&&(n.kind="audioinput"),"video"===n.kind&&(n.kind="videoinput"),n.deviceId||(n.deviceId=n.id),n.id||(n.id=n.deviceId),n.label?("videoinput"!==n.kind||U||(U=!0),"audioinput"!==n.kind||F||(F=!0)):(n.isCustomLabel=!0,"videoinput"===n.kind?n.label="Camera "+(A.length+1):"audioinput"===n.kind?n.label="Microphone "+(I.length+1):"audiooutput"===n.kind?n.label="Speaker "+(L.length+1):n.label="Please invoke getUserMedia once.",void 0!==Z&&Z.browser.isChrome&&Z.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(n.label="HTTPs is required to get label of this "+n.kind+" device.")),"audioinput"===n.kind&&(N=!0,-1===I.indexOf(n)&&I.push(n)),"audiooutput"===n.kind&&(D=!0,-1===L.indexOf(n)&&L.push(n)),"videoinput"===n.kind&&(P=!0,-1===A.indexOf(n)&&A.push(n)),w.push(n),t[n.deviceId+n.label+n.kind]=n)})),void 0!==Z&&(Z.MediaDevices=w,Z.hasMicrophone=N,Z.hasSpeakers=D,Z.hasWebcam=P,Z.isWebsiteHasWebcamPermissions=U,Z.isWebsiteHasMicrophonePermissions=F,Z.audioInputDevices=I,Z.audioOutputDevices=L,Z.videoInputDevices=A),e&&e()}))}else e&&e();else e&&e()}(e=e||function(){})},Z.MediaDevices=void 0!==w?w:[],Z.hasMicrophone=N,Z.hasSpeakers=D,Z.hasWebcam=P,Z.isWebsiteHasWebcamPermissions=U,Z.isWebsiteHasMicrophonePermissions=F,Z.audioInputDevices=I,Z.audioOutputDevices=L,Z.videoInputDevices=A;var X=!1;"undefined"!=typeof document&&"function"==typeof document.createElement&&"setSinkId"in document.createElement("video")&&(X=!0),Z.isSetSinkIdSupported=X;var J=!1;Z.browser.isFirefox&&"undefined"!=typeof mozRTCPeerConnection?"getSenders"in mozRTCPeerConnection.prototype&&(J=!0):Z.browser.isChrome&&"undefined"!=typeof webkitRTCPeerConnection&&"getSenders"in webkitRTCPeerConnection.prototype&&(J=!0),Z.isRTPSenderReplaceTracksSupported=J;var $=!1;Z.browser.isFirefox&&Z.browser.version>38&&($=!0),Z.isRemoteStreamProcessingSupported=$;var Q=!1;"undefined"!=typeof MediaStreamTrack&&"applyConstraints"in MediaStreamTrack.prototype&&(Q=!0),Z.isApplyConstraintsSupported=Q;var ee=!1;Z.browser.isFirefox&&Z.browser.version>=43&&(ee=!0),Z.isMultiMonitorScreenCapturingSupported=ee,Z.isPromisesSupported=!!("Promise"in window),Z.version="1.4.1",void 0===Z&&(window.DetectRTC={});var te=window.MediaStream;void 0===te&&"undefined"!=typeof webkitMediaStream&&(te=webkitMediaStream),Z.MediaStream=void 0!==te&&"function"==typeof te&&T()(te.prototype),"undefined"!=typeof MediaStreamTrack?Z.MediaStreamTrack=T()(MediaStreamTrack.prototype):Z.MediaStreamTrack=!1;var ne=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;Z.RTCPeerConnection=void 0!==ne&&T()(ne.prototype),window.DetectRTC=Z,e.exports=Z}()}(ct);for(var ut,dt="MEDIA",lt="DEVICE",ft="MEDIA_STREAM_TRACK",pt={error:1,warn:2,info:3,debug:4},ht="error",vt=function(e,t){pt[e]<=pt[ht]&&console.log(function(e,t){var n=t.ID,r=t.mediaType,i=t.action,o=t.description,a=t.error,s=(new Date).toISOString(),c=a?a.stack?"".concat(a.message,": ").concat(a.stack):"".concat(a):"";return"".concat(s," ").concat(e," ").concat(n||""," ").concat(r," ").concat(i," ").concat(o," ").concat(c).replace(/\s+/g," ").trim()}(e,t))},mt={info:function(e){return vt("info",e)},warn:function(e){return vt("warn",e)},error:function(e){return vt("error",e)},debug:function(e){return vt("debug",e)}},gt=function(e){mt[e]=function(t){var n=t.ID,r=t.mediaType,i=t.action,o=t.description,a=t.error;return ht=e,vt(e,{ID:n,mediaType:r,action:i,description:o,error:a})}},Et=0,yt=["info","warn","error","debug"];Et<yt.length;Et++){gt(yt[Et])}function St(){}function _t(){_t.init.call(this)}function Ct(e){return void 0===e._maxListeners?_t.defaultMaxListeners:e._maxListeners}function Rt(e,t,n,r){var i,o,a,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]):(o=e._events=new St,e._eventsCount=0),a){if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),!a.warned&&(i=Ct(e))&&i>0&&a.length>i){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=a.length,s=c,"function"==typeof console.warn?console.warn(s):console.log(s)}}else a=o[t]=n,++e._eventsCount;return e}function Tt(e,t,n){var r=!1;function i(){e.removeListener(t,i),r||(r=!0,n.apply(e,arguments))}return i.listener=n,i}function xt(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function bt(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}function wt(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}St.prototype=N()(null),_t.EventEmitter=_t,_t.usingDomains=!1,_t.prototype.domain=void 0,_t.prototype._events=void 0,_t.prototype._maxListeners=void 0,_t.defaultMaxListeners=10,_t.init=function(){this.domain=null,_t.usingDomains&&undefined.active,this._events&&this._events!==P()(this)._events||(this._events=new St,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},_t.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},_t.prototype.getMaxListeners=function(){return Ct(this)},_t.prototype.emit=function(e){var t,n,r,i,o,a,s,c="error"===e;if(a=this._events)c=c&&null==a.error;else if(!c)return!1;if(s=this.domain,c){if(t=arguments[1],!s){if(t instanceof Error)throw t;var u=new Error('Uncaught, unspecified "error" event. ('+t+")");throw u.context=t,u}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=s,t.domainThrown=!1,s.emit("error",t),!1}if(!(n=a[e]))return!1;var d="function"==typeof n;switch(r=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var r=e.length,i=bt(e,r),o=0;o<r;++o)i[o].call(n)}(n,d,this);break;case 2:!function(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,o=bt(e,i),a=0;a<i;++a)o[a].call(n,r)}(n,d,this,arguments[1]);break;case 3:!function(e,t,n,r,i){if(t)e.call(n,r,i);else for(var o=e.length,a=bt(e,o),s=0;s<o;++s)a[s].call(n,r,i)}(n,d,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,r,i,o){if(t)e.call(n,r,i,o);else for(var a=e.length,s=bt(e,a),c=0;c<a;++c)s[c].call(n,r,i,o)}(n,d,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];!function(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,o=bt(e,i),a=0;a<i;++a)o[a].apply(n,r)}(n,d,this,i)}return!0},_t.prototype.addListener=function(e,t){return Rt(this,e,t,!1)},_t.prototype.on=_t.prototype.addListener,_t.prototype.prependListener=function(e,t){return Rt(this,e,t,!0)},_t.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,Tt(this,e,t)),this},_t.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,Tt(this,e,t)),this},_t.prototype.removeListener=function(e,t){var n,r,i,o,a;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new St:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length;o-- >0;)if(n[o]===t||n[o].listener&&n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new St,this;delete r[e]}else!function(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}(n,i);r.removeListener&&this.emit("removeListener",e,a||t)}return this},_t.prototype.off=function(e,t){return this.removeListener(e,t)},_t.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new St,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new St:delete n[e]),this;if(0===arguments.length){for(var r,i=T()(n),o=0;o<i.length;++o)"removeListener"!==(r=i[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new St,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},_t.prototype.listeners=function(e){var t,n,r=this._events;return n=r&&(t=r[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[],n},_t.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):xt.call(e,t)},_t.prototype.listenerCount=xt,_t.prototype.eventNames=function(){return this._eventsCount>0?U()(this._events):[]},function(e){e.AUDIO_INPUT="audioinput",e.AUDIO_OUTPUT="audiooutput",e.VIDEO_INPUT="videoinput"}(ut||(ut={}));var It,Lt,Ot=new(V()),At=(0,h.Z)((function e(t){(0,v.Z)(this,e),Me.default(this,"ID",void 0),Me.default(this,"groupID",void 0),Me.default(this,"label",void 0),Me.default(this,"kind",void 0),wt(this,Ot,{writable:!0,value:void 0}),De.default(this,Ot,t),this.ID=Ne.default(this,Ot).deviceId,this.groupID=Ne.default(this,Ot).groupId,this.label=Ne.default(this,Ot).label,this.kind=Ne.default(this,Ot).kind}));function kt(e){mt.debug({ID:e.id,mediaType:ft,action:"getTrackSettings()",description:"Called"});var t=e.getSettings();if(t)return mt.debug({ID:e.id,mediaType:ft,action:"getTrackSettings()",description:"Returning track settings ".concat(B()(t))}),t;var n=new Error("Unable to get track settings");return mt.info({ID:e.id,mediaType:ft,action:"getTrackSettings()",description:n.message,error:n}),{}}function Mt(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}!function(e){e.ENDED="ended",e.LIVE="live"}(It||(It={})),function(e){e.AUDIO="audio",e.VIDEO="video"}(Lt||(Lt={}));var Nt=new(V()),Dt=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),r=t.call(this),Me.default((0,d.Z)(r),"ID",void 0),Me.default((0,d.Z)(r),"kind",void 0),Me.default((0,d.Z)(r),"status",void 0),Me.default((0,d.Z)(r),"muted",void 0),Me.default((0,d.Z)(r),"label",void 0),Mt((0,d.Z)(r),Nt,{writable:!0,value:void 0}),r.ID=e.id,r.kind=e.kind,r.status=e.readyState,r.muted=e.muted,r.label=e.label,De.default((0,d.Z)(r),Nt,e),Ne.default((0,d.Z)(r),Nt).onmute=function(){var e=Ne.default((0,d.Z)(r),Nt).enabled?"muted":"unmuted";r.emit("track:mute",{action:e})},r}return(0,h.Z)(n,[{key:"stop",value:function(){Ne.default(this,Nt).stop(),this.status=It.ENDED}},{key:"applyConstraints",value:function(e){var t=this;return ke.default(E().mark((function n(){var r,i,o,a,s,c,u,d,l,f;return E().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:for(mt.debug({ID:null==e||null===(r=e.deviceId)||void 0===r?void 0:r.toString(),mediaType:lt,action:"applyConstraints()",description:"Called with ".concat(B()(e))}),mt.info({ID:null==e||null===(i=e.deviceId)||void 0===i?void 0:i.toString(),mediaType:lt,action:"applyConstraints()",description:"Applying constraints to track objects"}),a=navigator.mediaDevices.getSupportedConstraints(),s=[],c=0,u=T()(e);c<u.length;c++)d=u[c],a[d]||(mt.debug({ID:null==e||null===(l=e.deviceId)||void 0===l?void 0:l.toString(),mediaType:lt,action:"applyConstraints()",description:"Not suported constraint tracked ".concat(d)}),s.push(d));if(!(s.length>0)){n.next=9;break}return console.warn("#TrackObject Unsupported constraints - ".concat(s.join(", "))),mt.debug({ID:null==e||null===(f=e.deviceId)||void 0===f?void 0:f.toString(),mediaType:lt,action:"applyConstraints()",description:"Constraints not applied"}),n.abrupt("return",!1);case 9:return n.next=11,Ne.default(t,Nt).applyConstraints(e);case 11:return mt.debug({ID:null==e||null===(o=e.deviceId)||void 0===o?void 0:o.toString(),mediaType:lt,action:"applyConstraints()",description:"Constraints applied successfully"}),n.abrupt("return",!0);case 13:case"end":return n.stop()}}),n)})))()}},{key:"getSettings",value:function(){mt.debug({mediaType:dt,action:"getSettings()",description:"Called"}),mt.info({mediaType:dt,action:"getSettings()",description:"Fetching constraints properties for the current media stream track"});var e=kt(Ne.default(this,Nt));return mt.debug({mediaType:dt,action:"getSettings()",description:"Received settings ".concat(B()(e))}),e}},{key:"getMediaStreamTrack",value:function(){mt.debug({mediaType:dt,action:"getMediaStreamTrack()",description:"Called"});var e=Ne.default(this,Nt);return mt.debug({mediaType:dt,action:"getMediaStreamTrack()",description:"Received media stream track ".concat(B()(e))}),e}}]),n}(_t),Pt=new _t,Ft=[],Ut=function(){var e=ke.default(E().mark((function e(){var t;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(mt.debug({mediaType:lt,action:"getDevices()",description:"Called"}),null!==(t=navigator.mediaDevices)&&void 0!==t&&t.enumerateDevices){e.next=4;break}return console.warn("navigator.mediaDevices.enumerateDevices() is not supported."),e.abrupt("return",[]);case 4:return mt.info({mediaType:lt,action:"getDevices()",description:"Requesting list of available media input and output devices"}),e.abrupt("return",navigator.mediaDevices.enumerateDevices());case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Zt=function(){var e=ke.default(E().mark((function e(){var t;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return mt.debug({mediaType:lt,action:"getCameras()",description:"Called"}),e.next=3,Ut();case 3:return t=e.sent,mt.info({mediaType:lt,action:"getCameras()",description:"Filtering camera devices from all available media devices"}),e.abrupt("return",t.filter((function(e){return e.kind===ut.VIDEO_INPUT})).map((function(e){return mt.debug({ID:e.deviceId,mediaType:lt,action:"getCameras()",description:"Received camera device ".concat(B()(e))}),new At(e)})));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Vt=function(){var e=ke.default(E().mark((function e(){var t;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return mt.debug({mediaType:lt,action:"getMicrophones()",description:"Called"}),e.next=3,Ut();case 3:return t=e.sent,mt.info({mediaType:lt,action:"getMicrophones()",description:"Filtering microphones devices from all available media devices"}),e.abrupt("return",t.filter((function(e){return e.kind===ut.AUDIO_INPUT})).map((function(e){return mt.debug({ID:e.deviceId,mediaType:lt,action:"getMicrophones()",description:"Received microphone device ".concat(B()(e))}),new At(e)})));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Gt=function(){var e=ke.default(E().mark((function e(){var t;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return mt.debug({mediaType:lt,action:"getSpeakers()",description:"Called"}),e.next=3,Ut();case 3:return t=e.sent,mt.info({mediaType:lt,action:"getSpeakers()",description:"Filtering speaker devices from all available media devices"}),e.abrupt("return",t.filter((function(e){return e.kind===ut.AUDIO_OUTPUT})).map((function(e){return mt.debug({ID:e.deviceId,mediaType:lt,action:"getSpeakers()",description:"Received speaker device ".concat(B()(e))}),new At(e)})));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function Bt(e){mt.debug({mediaType:dt,action:"getUnsupportedConstraints()",description:"Called with ".concat(B()(e))}),mt.info({mediaType:dt,action:"getUnsupportedConstraints()",description:"Filtering list of media track unsupported constraints"});var t=navigator.mediaDevices.getSupportedConstraints(),n=[];return T()(e).forEach((function(e){Object.prototype.hasOwnProperty.call(t,e)&&t[e]||n.push(e)})),mt.debug({mediaType:dt,action:"getUnsupportedConstraints()",description:"Received unsupported constraints ".concat(n)}),n}function Wt(){return Wt=ke.default(E().mark((function e(t){var n,r,i,o,a;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(mt.debug({ID:null==t?void 0:t.ID,mediaType:lt,action:"createAudioTrack()",description:"Called ".concat(t?"with ".concat(B()(t)):""," ")}),!t||t.kind===ut.AUDIO_INPUT){e.next=5;break}throw n=new Error("Device ".concat(t.ID," is not of kind AUDIO_INPUT")),mt.error({ID:t.ID,mediaType:"DEVICE",action:"createAudioTrack()",description:n.message,error:n}),n;case 5:return mt.info({ID:null==t?void 0:t.ID,mediaType:lt,action:"createAudioTrack()",description:"Creating audio track"}),r=t?{audio:{deviceId:{exact:t.ID}}}:{audio:!0,video:!1},e.next=9,navigator.mediaDevices.getUserMedia(r);case 9:if(i=e.sent,!(o=i.getAudioTracks()[0])){e.next=14;break}return mt.debug({ID:null==t?void 0:t.ID,mediaType:lt,action:"createAudioTrack()",description:"Received audio track ".concat(B()(o))}),e.abrupt("return",new Dt(o));case 14:throw a=new Error("Device could not obtain an audio track of kind ".concat(null==t?void 0:t.kind)),mt.error({ID:null==t?void 0:t.ID,mediaType:"DEVICE",action:"createAudioTrack()",description:a.message,error:a}),a;case 17:case"end":return e.stop()}}),e)}))),Wt.apply(this,arguments)}function jt(){return jt=ke.default(E().mark((function e(t){var n,r,i,o,a;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(mt.debug({ID:null==t?void 0:t.ID,mediaType:lt,action:"createVideoTrack()",description:"Called ".concat(t?"with ".concat(B()(t)):""," ")}),!t||t.kind===ut.VIDEO_INPUT){e.next=5;break}throw n=new Error("Device ".concat(t.ID," is not of kind VIDEO_INPUT")),mt.error({ID:t.ID,mediaType:"DEVICE",action:"createVideoTrack()",description:n.message,error:n}),n;case 5:return mt.info({ID:null==t?void 0:t.ID,mediaType:lt,action:"createVideoTrack()",description:"Creating video track"}),r=t?{video:{deviceId:{exact:t.ID}}}:{audio:!1,video:!0},e.next=9,navigator.mediaDevices.getUserMedia(r);case 9:if(i=e.sent,!(o=i.getVideoTracks()[0])){e.next=14;break}return mt.debug({ID:null==t?void 0:t.ID,mediaType:lt,action:"createVideoTrack()",description:"Received video track ".concat(B()(o))}),e.abrupt("return",new Dt(o));case 14:throw a=new Error("Device could not obtain a video track of kind ".concat(null==t?void 0:t.kind)),mt.error({ID:null==t?void 0:t.ID,mediaType:"DEVICE",action:"createVideoTrack()",description:a.message,error:a}),a;case 17:case"end":return e.stop()}}),e)}))),jt.apply(this,arguments)}function Ht(){return Ht=ke.default(E().mark((function e(t){var n,r,i,o,a,s,c,d,l,f,p,h,v,m,g;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return mt.debug({ID:null==t||null===(n=t.deviceId)||void 0===n?void 0:n.toString(),mediaType:lt,action:"createContentTrack()",description:"Called ".concat(t?"with ".concat(B()(t)):""," ")}),mt.info({ID:null==t||null===(r=t.deviceId)||void 0===r?void 0:r.toString(),mediaType:dt,action:"createContentTrack()",description:"Creating content track"}),o={audio:!1,video:!0},e.prev=3,e.next=6,navigator.mediaDevices.getDisplayMedia(o);case 6:s=e.sent,c=s.getVideoTracks(),d=(0,u.Z)(c,1),a=d[0],e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(3),e.t0 instanceof Error&&mt.error({ID:null==t||null===(l=t.deviceId)||void 0===l?void 0:l.toString(),mediaType:"DEVICE",action:"createContentTrack()",description:e.t0.message,error:e.t0}),e.t0;case 16:if(!t){e.next=26;break}if(!((f=Bt(t)).length<=0)){e.next=23;break}a.applyConstraints(t),mt.debug({ID:null==t||null===(p=t.deviceId)||void 0===p?void 0:p.toString(),mediaType:lt,action:"createContentTrack()",description:"Applied media constraints to fetched content track"}),e.next=26;break;case 23:throw v=new Error("".concat(f.join(", ")," constraint is not supported by browser")),mt.error({ID:null==t||null===(h=t.deviceId)||void 0===h?void 0:h.toString(),mediaType:"DEVICE",action:"createContentTrack()",description:v.message,error:v}),v;case 26:if(!a){e.next=29;break}return mt.debug({ID:null==t||null===(m=t.deviceId)||void 0===m?void 0:m.toString(),mediaType:lt,action:"createContentTrack()",description:"Received content track ".concat(B()(a))}),e.abrupt("return",new Dt(a));case 29:throw g=new Error("Could not obtain a content track"),mt.error({ID:null==t||null===(i=t.deviceId)||void 0===i?void 0:i.toString(),mediaType:"DEVICE",action:"createContentTrack()",description:g.message,error:g}),g;case 32:case"end":return e.stop()}}),e,null,[[3,12]])}))),Ht.apply(this,arguments)}function Kt(){return qt.apply(this,arguments)}function qt(){return(qt=ke.default(E().mark((function e(){var t,n,r,i,o,a,s,d,l;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(mt.debug({mediaType:lt,action:"deviceChangePublisher()",description:"Called"}),null!==(t=navigator.mediaDevices)&&void 0!==t&&t.enumerateDevices){e.next=4;break}return console.warn("navigator.mediaDevices.enumerateDevices() is not supported."),e.abrupt("return");case 4:return mt.info({mediaType:lt,action:"deviceChangePublisher()",description:"Calling individual subscription listener obtained by device change event"}),e.next=7,navigator.mediaDevices.enumerateDevices();case 7:n=e.sent,r=[],i=[],o=[],a="changed",s=new(j()),n.length!==Ft.length&&(d=n.length<Ft.length?[n,Ft,"removed"]:[Ft,n,"added"],l=(0,u.Z)(d,3),i=l[0],o=l[1],a=l[2],i.forEach((function(e){s.add(e.groupId)})),r=o.filter((function(e){return!s.has(e.groupId)})),Ft.splice(0,Ft.length),Ft.push.apply(Ft,(0,c.Z)(n)),Pt.emit("device:changed",{action:a,devices:r}));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Yt(){return(Yt=ke.default(E().mark((function e(t,n){var r;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(mt.debug({mediaType:dt,action:"on()",description:"Subscribing to an ".concat(t,",").concat(n)}),Pt.on(t,n),"device:changed"!==t){e.next=8;break}return e.next=5,Ut();case 5:r=e.sent,Ft.push.apply(Ft,(0,c.Z)(r)),navigator.mediaDevices.addEventListener("devicechange",Kt);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var zt,Xt={isModuleAdded:!1,workletProcessorUrl:"https://models.intelligence.webex.com/bnr/1.1.0/noise-reduction-effect.worklet.js"};function Jt(e){if(navigator.mediaDevices.getSupportedConstraints().sampleRate){var t=kt(e).sampleRate;if(t&&![16e3,32e3,48e3].includes(t)){var n=new Error("Sample rate of ".concat(t," is not supported."));throw mt.error({ID:e.id,mediaType:ft,action:"isValidTrack()",description:n.message,error:n}),n}return!0}var r=new Error("Not supported");return mt.info({ID:e.id,mediaType:ft,action:"isValidTrack()",description:r.message,error:r}),!0}function $t(){return Qt.apply(this,arguments)}function Qt(){return(Qt=ke.default(E().mark((function e(){var t;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return mt.info({mediaType:ft,action:"loadProcessor()",description:"Creating and loading BNR module"}),t=new AudioContext,Xt.isModuleAdded=!0,Xt.audioContext=t,e.next=6,t.audioWorklet.addModule(Xt.workletProcessorUrl);case 6:return Xt.workletNode=new AudioWorkletNode(t,"noise-reduction-worklet-processor"),e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function en(){return(en=ke.default(E().mark((function e(t){var n,r,i,o,a,s,c,d,l,f;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(mt.debug({ID:t.id,mediaType:ft,action:"enableBNR()",description:"Called"}),e.prev=1,Jt(t),(n=new MediaStream).addTrack(t),mt.info({ID:t.id,mediaType:ft,action:"enableBNR()",description:"Checking if BNR module is present already"}),!(i=Xt.destinationTrack)||t.id!==i.id){e.next=12;break}throw o="BNR is enabled on the track already",a=new Error(o),mt.error({ID:t.id,mediaType:ft,action:"enableBNR()",description:o,error:a}),a;case 12:return Xt.isModuleAdded&&(mt.debug({ID:t.id,mediaType:ft,action:"enableBNR()",description:"Disposing existing BNR module"}),(r=Xt.workletNode).port.postMessage("DISPOSE")),mt.info({ID:t.id,mediaType:ft,action:"enableBNR()",description:"Creating worklet node, connecting source and destination streams"}),e.next=16,$t();case 16:return s=e.sent,(r=Xt.workletNode).port.postMessage("ENABLE"),Xt.sourceNode=s.createMediaStreamSource(n),Xt.sourceNode.connect(r),Xt.destinationStream=s.createMediaStreamDestination(),r.connect(Xt.destinationStream),mt.info({ID:t.id,mediaType:ft,action:"enableBNR()",description:"Obtaining noise reduced track and returning"}),c=Xt.destinationStream.stream,d=c.getAudioTracks(),l=(0,u.Z)(d,1),f=l[0],Xt.destinationTrack=f,e.abrupt("return",f);case 30:throw e.prev=30,e.t0=e.catch(1),mt.error({ID:t.id,mediaType:ft,action:"enableBNR()",description:"Error in enableBNR",error:e.t0}),e.t0;case 34:case"end":return e.stop()}}),e,null,[[1,30]])})))).apply(this,arguments)}!function(e){e[e.MediaConnectionError=30001]="MediaConnectionError",e[e.SdpError=30002]="SdpError",e[e.IceGatheringError=30003]="IceGatheringError",e[e.SdpAnswerHandlingError=30004]="SdpAnswerHandlingError",e[e.SdpOfferCreationError=30005]="SdpOfferCreationError",e[e.SdpOfferHandlingError=30006]="SdpOfferHandlingError"}(zt||(zt={}));var tn=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;(0,v.Z)(this,n);var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r=t.call(this,e),Me.default((0,d.Z)(r),"code",void 0),r.name=i.name||"MediaConnectionError",r.cause=i.cause,r.code=i.code||zt.MediaConnectionError,r}return(0,h.Z)(n)}((0,s.Z)(Error));function nn(e,t){var n=T()(e);if(K()){var r=K()(e);t&&(r=r.filter((function(t){return b()(e,t).enumerable}))),n.push.apply(n,r)}return n}var rn=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){(0,v.Z)(this,n);var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.call(this,e,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nn(Object(n),!0).forEach((function(t){Me.default(e,t,n[t])})):Y()?X()(e,Y()(n)):nn(Object(n)).forEach((function(t){S()(e,t,b()(n,t))}))}return e}({code:zt.SdpError,name:"SdpError"},r))}return(0,h.Z)(n)}(tn);function on(e,t){var n=T()(e);if(K()){var r=K()(e);t&&(r=r.filter((function(t){return b()(e,t).enumerable}))),n.push.apply(n,r)}return n}var an=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){(0,v.Z)(this,n);var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.call(this,e,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?on(Object(n),!0).forEach((function(t){Me.default(e,t,n[t])})):Y()?X()(e,Y()(n)):on(Object(n)).forEach((function(t){S()(e,t,b()(n,t))}))}return e}({code:zt.IceGatheringError,name:"IceGatheringError"},r))}return(0,h.Z)(n)}(rn);function sn(e,t){var n=T()(e);if(K()){var r=K()(e);t&&(r=r.filter((function(t){return b()(e,t).enumerable}))),n.push.apply(n,r)}return n}var cn=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){(0,v.Z)(this,n);var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.call(this,e,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sn(Object(n),!0).forEach((function(t){Me.default(e,t,n[t])})):Y()?X()(e,Y()(n)):sn(Object(n)).forEach((function(t){S()(e,t,b()(n,t))}))}return e}({code:zt.SdpAnswerHandlingError,name:"SdpAnswerHandlingError"},r))}return(0,h.Z)(n)}(rn);function un(e,t){var n=T()(e);if(K()){var r=K()(e);t&&(r=r.filter((function(t){return b()(e,t).enumerable}))),n.push.apply(n,r)}return n}var dn=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){(0,v.Z)(this,n);var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.call(this,e,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?un(Object(n),!0).forEach((function(t){Me.default(e,t,n[t])})):Y()?X()(e,Y()(n)):un(Object(n)).forEach((function(t){S()(e,t,b()(n,t))}))}return e}({code:zt.SdpOfferCreationError,name:"SdpOfferCreationError"},r))}return(0,h.Z)(n)}(rn);function ln(e,t){var n=T()(e);if(K()){var r=K()(e);t&&(r=r.filter((function(t){return b()(e,t).enumerable}))),n.push.apply(n,r)}return n}var fn,pn=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){(0,v.Z)(this,n);var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.call(this,e,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ln(Object(n),!0).forEach((function(t){Me.default(e,t,n[t])})):Y()?X()(e,Y()(n)):ln(Object(n)).forEach((function(t){S()(e,t,b()(n,t))}))}return e}({code:zt.SdpOfferHandlingError,name:"SdpOfferHandlingError"},r))}return(0,h.Z)(n)}(rn),hn=I()({__proto__:null,get ErrorCode(){return zt},IceGatheringError:an,MediaConnectionError:tn,SdpAnswerHandlingError:cn,SdpError:rn,SdpOfferCreationError:dn,SdpOfferHandlingError:pn}),vn=function(e){(0,l.Z)(n,e);var t=xe(n);function n(){return(0,v.Z)(this,n),t.apply(this,arguments)}return(0,h.Z)(n)}(_t),mn={info:function(){var e;return(e=console).info.apply(e,arguments)},log:function(){var e;return(e=console).log.apply(e,arguments)},error:function(){var e;return(e=console).error.apply(e,arguments)},warn:function(){var e;return(e=console).warn.apply(e,arguments)},trace:function(){var e;return(e=console).trace.apply(e,arguments)},debug:function(){var e;return(e=console).debug.apply(e,arguments)}},gn=mn,En=function(){return gn},yn=function(e){return e?e.stack?"".concat(e.message,": ").concat(e.stack):"".concat(e):""},Sn="\\d+",_n="[!#$%&'*+\\-.^_`{|}~a-zA-Z0-9]+",Cn="\\S+",Rn=".+",Tn=(0,h.Z)((function e(){(0,v.Z)(this,e)})),xn=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r){var i;return(0,v.Z)(this,n),(i=t.call(this)).bandwidthType=e,i.bandwidth=r,i}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"b=".concat(this.bandwidthType,":").concat(this.bandwidth)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(t[1],k()(t[2],10))}}}]),n}(Tn);fn=xn,xn.BW_TYPE_REGEX="CT|AS|TIAS",xn.regex=new RegExp("^(".concat(fn.BW_TYPE_REGEX,"):(").concat(Sn,")"));var bn,wn=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).mids=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=group:BUNDLE ".concat(this.mids.join(" "))}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n(e.match(n.regex)[1].split(" "))}}]),n}(Tn);wn.regex=new RegExp("^group:BUNDLE (".concat(Rn,")"));var In=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r,i,o,a,s,c,u,d,l){var f;return(0,v.Z)(this,n),(f=t.call(this)).foundation=e,f.componentId=r,f.transport=i,f.priority=o,f.connectionAddress=a,f.port=s,f.candidateType=c,f.relAddr=u,f.relPort=d,f.candidateExtensions=l,f}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){var e="";return e+="a=candidate:".concat(this.foundation," ").concat(this.componentId," ").concat(this.transport," ").concat(this.priority," ").concat(this.connectionAddress," ").concat(this.port," typ ").concat(this.candidateType),this.relAddr&&(e+=" raddr ".concat(this.relAddr)),this.relPort&&(e+=" rport ".concat(this.relPort)),this.candidateExtensions&&(e+=" ".concat(this.candidateExtensions)),e}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(t[1],k()(t[2],10),t[3],k()(t[4],10),t[5],k()(t[6],10),t[7],t[8],t[9]?k()(t[9],10):void 0,t[10])}}}]),n}(Tn);bn=In,In.ICE_CHARS="[a-zA-Z0-9+/]+",In.regex=new RegExp("^candidate:(".concat(bn.ICE_CHARS,") (").concat(Sn,") (").concat(Cn,") (").concat(Sn,") (").concat(Cn,") (").concat(Sn,") typ (").concat(Cn,")(?: raddr (").concat(Cn,"))?(?: rport (").concat(Sn,"))?(?: (").concat(Rn,"))?"));var Ln=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r,i){var o;return(0,v.Z)(this,n),(o=t.call(this)).netType=e,o.addrType=r,o.ipAddr=i,o}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"c=".concat(this.netType," ").concat(this.addrType," ").concat(this.ipAddr)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(t[1],t[2],t[3])}}}]),n}(Tn);Ln.regex=new RegExp("^(".concat(Cn,") (").concat(Cn,") (").concat(Cn,")"));var On=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).values=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=content:".concat(this.values.join(","))}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n(e.match(n.regex)[1].split(","))}}]),n}(Tn);On.regex=new RegExp("^content:(".concat(Rn,")$"));var An,kn=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).direction=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=".concat(this.direction)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n(e.match(n.regex)[1])}}]),n}(Tn);kn.regex=/^(sendrecv|sendonly|recvonly|inactive)$/;var Mn=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r,i,o){var a;return(0,v.Z)(this,n),(a=t.call(this)).id=e,a.uri=r,a.direction=i,a.extensionAttributes=o,a}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){var e="";return e+="a=extmap:".concat(this.id),this.direction&&(e+="/".concat(this.direction)),e+=" ".concat(this.uri),this.extensionAttributes&&(e+=" ".concat(this.extensionAttributes)),e}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex),r=k()(t[1],10),i=t[2];return new n(r,t[3],i,t[4])}}}]),n}(Tn);An=Mn,Mn.EXTMAP_DIRECTION="sendonly|recvonly|sendrecv|inactive",Mn.regex=new RegExp("^extmap:(".concat(Sn,")(?:/(").concat(An.EXTMAP_DIRECTION,"))? (").concat(Cn,")(?: (").concat(Rn,"))?"));var Nn=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).fingerprint=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=fingerprint:".concat(this.fingerprint)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n(e.match(n.regex)[1])}}]),n}(Tn);Nn.regex=new RegExp("^fingerprint:(".concat(Rn,")"));var Dn=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r){var i;return(0,v.Z)(this,n),(i=t.call(this)).payloadType=e,i.params=r,i}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){var e=this,t=ee()(this.params.keys()).map((function(t){return void 0!==e.params.get(t)?"".concat(t,"=").concat(e.params.get(t)):"".concat(t)})).join(";");return"a=fmtp:".concat(this.payloadType," ").concat(t)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(k()(t[1],10),function(e){e=e.replace(/^a=fmtp:\d+\x20/,"");var t=new($());return/^\d+([/-]\d+)+$/.test(e)?(t.set(e,void 0),t):(e.split(";").forEach((function(n){var r=n&&n.split("=");if(2!==r.length||!r[0]||!r[1])throw new Error("Fmtp params is invalid with ".concat(e));t.set(r[0],r[1])})),t)}(t[2]))}}}]),n}(Tn);Dn.regex=new RegExp("^fmtp:(".concat(Sn,") (").concat(Rn,")"));var Pn=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).options=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=ice-options:".concat(this.options.join(" "))}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n(e.match(n.regex)[1].split(" "))}}]),n}(Tn);Pn.regex=new RegExp("^ice-options:(".concat(Rn,")$"));var Fn=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).pwd=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=ice-pwd:".concat(this.pwd)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n(e.match(n.regex)[1])}}]),n}(Tn);Fn.regex=new RegExp("^ice-pwd:(".concat(Cn,")$"));var Un=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).ufrag=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=ice-ufrag:".concat(this.ufrag)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n(e.match(n.regex)[1])}}]),n}(Tn);Un.regex=new RegExp("^ice-ufrag:(".concat(Cn,")$"));var Zn,Vn=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).maxMessageSize=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=max-message-size:".concat(this.maxMessageSize)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(k()(t[1],10))}}}]),n}(Tn);Vn.regex=new RegExp("^max-message-size:(".concat(Sn,")"));var Gn=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r,i,o){var a;return(0,v.Z)(this,n),(a=t.call(this)).type=e,a.port=r,a.protocol=i,a.formats=o,a}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"m=".concat(this.type," ").concat(this.port," ").concat(this.protocol," ").concat(this.formats.join(" "))}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(t[1],k()(t[2],10),t[3],t[4].split(" "))}}}]),n}(Tn);Zn=Gn,Gn.MEDIA_TYPE="audio|video|application",Gn.regex=new RegExp("^(".concat(Zn.MEDIA_TYPE,") (").concat(Sn,") (").concat(Cn,") (").concat(Rn,")"));var Bn=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).mid=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=mid:".concat(this.mid)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n(e.match(n.regex)[1])}}]),n}(Tn);Bn.regex=new RegExp("^mid:(".concat(Cn,")$"));var Wn,jn=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r,i,o,a,s){var c;return(0,v.Z)(this,n),(c=t.call(this)).username=e,c.sessionId=r,c.sessionVersion=i,c.netType=o,c.addrType=a,c.ipAddr=s,c}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"o=".concat(this.username," ").concat(this.sessionId," ").concat(this.sessionVersion," ").concat(this.netType," ").concat(this.addrType," ").concat(this.ipAddr)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(t[1],t[2],k()(t[3],10),t[4],t[5],t[6])}}}]),n}(Tn);jn.regex=new RegExp("^(".concat(Cn,") (").concat(Cn,") (").concat(Sn,") (").concat(Cn,") (").concat(Cn,") (").concat(Cn,")"));var Hn=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r,i){var o;return(0,v.Z)(this,n),(o=t.call(this)).id=e,o.direction=r,o.params=i,o}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){var e="";return e+="a=rid:".concat(this.id," ").concat(this.direction),this.params&&(e+=" ".concat(this.params)),e}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(t[1],t[2],t[3])}}}]),n}(Tn);Wn=Hn,Hn.RID_ID="[\\w-]+",Hn.RID_DIRECTION="\\bsend\\b|\\brecv\\b",Hn.regex=new RegExp("^rid:(".concat(Wn.RID_ID,") (").concat(Wn.RID_DIRECTION,")(?:").concat("\\s","(").concat(Rn,"))?"));var Kn=function(e){(0,l.Z)(n,e);var t=xe(n);function n(){return(0,v.Z)(this,n),t.apply(this,arguments)}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=rtcp-mux"}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n}}]),n}(Tn);Kn.regex=/^rtcp-mux$/;var qn,Yn=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r){var i;return(0,v.Z)(this,n),(i=t.call(this)).payloadType=e,i.feedback=r,i}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=rtcp-fb:".concat(this.payloadType," ").concat(this.feedback)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(k()(t[1],10),t[2])}}}]),n}(Tn);Yn.regex=new RegExp("^rtcp-fb:(".concat(Sn,") (").concat(Rn,")"));var zn=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r,i,o){var a;return(0,v.Z)(this,n),(a=t.call(this)).payloadType=e,a.encodingName=r,a.clockRate=i,a.encodingParams=o,a}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){var e="";return e+="a=rtpmap:".concat(this.payloadType," ").concat(this.encodingName,"/").concat(this.clockRate),this.encodingParams&&(e+="/".concat(this.encodingParams)),e}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(k()(t[1],10),t[2],k()(t[3],10),t[4])}}}]),n}(Tn);qn=zn,zn.NON_SLASH_TOKEN="[^\\s/]+",zn.regex=new RegExp("^rtpmap:(".concat(Sn,") (").concat(qn.NON_SLASH_TOKEN,")/(").concat(qn.NON_SLASH_TOKEN,")(?:/(").concat(qn.NON_SLASH_TOKEN,"))?"));var Xn=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).port=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=sctp-port:".concat(this.port)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(k()(t[1],10))}}}]),n}(Tn);Xn.regex=new RegExp("^sctp-port:(".concat(Sn,")"));var Jn=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).info=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"i=".concat(this.info)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n(e.match(n.regex)[1])}}]),n}(Tn);Jn.regex=new RegExp("(".concat(Rn,")"));var $n=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).name=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"s=".concat(this.name)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n(e.match(n.regex)[1])}}]),n}(Tn);$n.regex=new RegExp("^(".concat(Rn,")"));var Qn=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).setup=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=setup:".concat(this.setup)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n(e.match(n.regex)[1])}}]),n}(Tn);Qn.regex=/^setup:(actpass|active|passive)$/;var er=function(){function e(t,n){(0,v.Z)(this,e),this.id=t,this.paused=n}return(0,h.Z)(e,[{key:"toString",value:function(){return this.paused?"~".concat(this.id):this.id}}]),e}(),tr=function(){function e(){(0,v.Z)(this,e),this.layers=[]}return(0,h.Z)(e,[{key:"addLayer",value:function(e){this.layers.push([e])}},{key:"addLayerWithAlternatives",value:function(e){this.layers.push(e)}},{key:"length",get:function(){return this.layers.length}},{key:"get",value:function(e){return this.layers[e]}},{key:"toString",value:function(){return this.layers.map((function(e){return e.map((function(e){return e.toString()})).join(",")})).join(";")}}],[{key:"fromString",value:function(t){var n=new e,r=t.split(";");if(1===r.length&&!r[0].trim())throw new Error("simulcast stream list empty");return r.forEach((function(e){if(!e)throw new Error("simulcast layer list empty");var t=e.split(","),r=[];t.forEach((function(e){if(!e||"~"===e)throw new Error("rid empty");var t="~"===e[0],n=t?e.substring(1):e;r.push(new er(n,t))})),n.addLayerWithAlternatives(r)})),n}}]),e}(),nr=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r){var i;return(0,v.Z)(this,n),(i=t.call(this)).sendLayers=e,i.recvLayers=r,i}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){var e="a=simulcast:";return this.sendLayers.length&&(e+="send ".concat(this.sendLayers.toString()),this.recvLayers.length&&(e+=" ")),this.recvLayers.length&&(e+="recv ".concat(this.recvLayers.toString())),e}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t,r,i=e.match(n.regex),o=i[3]&&i[4],a=i[1],s=tr.fromString(i[2]),c=new tr;if(o){if(a===i[3])return;c=tr.fromString(i[4])}return"send"===a?(t=s,r=c):(t=c,r=s),new n(t,r)}}}]),n}(Tn);nr.regex=new RegExp("^simulcast:(send|recv) (".concat(Cn,")(?: (send|recv) (").concat(Cn,"))?"));var rr=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r){var i;(0,v.Z)(this,n);var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;return(i=t.call(this)).ssrcId=e,i.attribute=r,i.attributeValue=o,i.attributeData=a,i}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){var e="a=ssrc:".concat(this.ssrcId," ").concat(this.attribute);return this.attributeValue&&(e+=":".concat(this.attributeValue)),this.attributeData&&(e+=" ".concat(this.attributeData)),e}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(k()(t[1],10),t[2],t[3],t[4])}}}]),n}(Tn);rr.regex=new RegExp("^ssrc:(".concat(Sn,") (").concat(_n,")(?::(").concat(_n,")?(?: (").concat(Cn,"))?)?$"));var ir=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r){var i;return(0,v.Z)(this,n),(i=t.call(this)).semantics=e,i.ssrcs=r,i}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=ssrc-group:".concat(this.semantics," ").concat(this.ssrcs.join(" "))}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(t[1],t[2].split(" ").map((function(e){return k()(e,10)})))}}}]),n}(Tn);ir.regex=new RegExp("^ssrc-group:(SIM|FID|FEC) ((?:".concat(Sn).concat("\\s","*)+)"));var or=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r){var i;return(0,v.Z)(this,n),(i=t.call(this)).startTime=e,i.stopTime=r,i}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"t=".concat(this.startTime," ").concat(this.stopTime)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(k()(t[1],10),k()(t[2],10))}}}]),n}(Tn);or.regex=new RegExp("^(".concat(Sn,") (").concat(Sn,")"));var ar=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).version=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"v=".concat(this.version)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(k()(t[1],10))}}}]),n}(Tn);ar.regex=new RegExp("^(".concat(Sn,")$"));var sr=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).value=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"".concat(this.value)}}],[{key:"fromSdpLine",value:function(e){return new n(e.match(n.regex)[1])}}]),n}(Tn);sr.regex=new RegExp("(".concat(Rn,")"));var cr=function(){function e(){(0,v.Z)(this,e),this.candidates=[]}return(0,h.Z)(e,[{key:"addLine",value:function(e){return e instanceof Un?(this.ufrag=e,!0):e instanceof Fn?(this.pwd=e,!0):e instanceof Pn?(this.options=e,!0):e instanceof In&&(this.candidates.push(e),!0)}},{key:"toLines",value:function(){var e=[];return this.ufrag&&e.push(this.ufrag),this.pwd&&e.push(this.pwd),this.options&&e.push(this.options),this.candidates.forEach((function(t){return e.push(t)})),e}}]),e}(),ur=function(){function e(t,n,r){(0,v.Z)(this,e),this.iceInfo=new cr,this.otherLines=[],this.type=t,this.port=n,this.protocol=r}return(0,h.Z)(e,[{key:"findOtherLine",value:function(e){return this.otherLines.find((function(t){return t instanceof e}))}},{key:"addLine",value:function(e){if(e instanceof wn)throw new Error("Error: bundle group line not allowed in media description");return e instanceof xn?(this.bandwidth=e,!0):e instanceof Bn?(this.mid=e.mid,!0):e instanceof Nn?(this.fingerprint=e.fingerprint,!0):e instanceof Qn?(this.setup=e.setup,!0):e instanceof Ln?(this.connection=e,!0):e instanceof On?(this.content=e,!0):this.iceInfo.addLine(e)}}]),e}(),dr=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this,e.type,e.port,e.protocol)).fmts=[],r.fmts=e.formats,r}return(0,h.Z)(n,[{key:"toLines",value:function(){var e=[];return e.push(new Gn(this.type,this.port,this.protocol,this.fmts)),this.connection&&e.push(this.connection),this.bandwidth&&e.push(this.bandwidth),e.push.apply(e,(0,c.Z)(this.iceInfo.toLines())),this.fingerprint&&e.push(new Nn(this.fingerprint)),this.setup&&e.push(new Qn(this.setup)),this.mid&&e.push(new Bn(this.mid)),this.content&&e.push(this.content),this.sctpPort&&e.push(new Xn(this.sctpPort)),this.maxMessageSize&&e.push(new Vn(this.maxMessageSize)),e.push.apply(e,(0,c.Z)(this.otherLines)),e}},{key:"addLine",value:function(e){if((0,a.Z)((0,p.Z)(n.prototype),"addLine",this).call(this,e))return!0;if(e instanceof Gn)throw new Error("Error: tried passing a MediaLine to an existing MediaInfo");return e instanceof Xn?(this.sctpPort=e.port,!0):e instanceof Vn?(this.maxMessageSize=e.maxMessageSize,!0):(this.otherLines.push(e),!0)}}]),n}(ur),lr=function(){function e(t){(0,v.Z)(this,e),this.fmtParams=new($()),this.feedback=[],this.pt=t}return(0,h.Z)(e,[{key:"addLine",value:function(e){if(e instanceof zn)return this.name=e.encodingName,this.clockRate=e.clockRate,this.encodingParams=e.encodingParams,!0;if(e instanceof Dn){if(this.fmtParams=new($())([].concat((0,c.Z)(ee()(this.fmtParams.entries())),(0,c.Z)(ee()(e.params.entries())))),e.params.has("apt")){var t=e.params.get("apt");this.primaryCodecPt=k()(t,10)}return!0}return e instanceof Yn&&(this.feedback.push(e.feedback),!0)}},{key:"toLines",value:function(){var e=this,t=[];return this.name&&this.clockRate&&t.push(new zn(this.pt,this.name,this.clockRate,this.encodingParams)),this.feedback.forEach((function(n){t.push(new Yn(e.pt,n))})),this.fmtParams.size>0&&t.push(new Dn(this.pt,this.fmtParams)),t}}]),e}(),fr=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this,e.type,e.port,e.protocol)).pts=[],r.extMaps=[],r.rids=[],r.codecs=new($()),r.rtcpMux=!1,r.ssrcs=[],r.ssrcGroups=[],r.pts=e.formats.map((function(e){return k()(e,10)})),r.pts.forEach((function(e){return r.codecs.set(e,new lr(e))})),r}return(0,h.Z)(n,[{key:"toLines",value:function(){var e=[];return e.push(new Gn(this.type,this.port,this.protocol,this.pts.map((function(e){return"".concat(e)})))),this.connection&&e.push(this.connection),this.bandwidth&&e.push(this.bandwidth),e.push.apply(e,(0,c.Z)(this.iceInfo.toLines())),this.fingerprint&&e.push(new Nn(this.fingerprint)),this.setup&&e.push(new Qn(this.setup)),this.mid&&e.push(new Bn(this.mid)),this.rtcpMux&&e.push(new Kn),this.content&&e.push(this.content),this.extMaps.forEach((function(t){return e.push(t)})),this.rids.forEach((function(t){return e.push(t)})),this.simulcast&&e.push(this.simulcast),this.direction&&e.push(new kn(this.direction)),this.codecs.forEach((function(t){return e.push.apply(e,(0,c.Z)(t.toLines()))})),e.push.apply(e,(0,c.Z)(this.ssrcs)),e.push.apply(e,(0,c.Z)(this.ssrcGroups)),e.push.apply(e,(0,c.Z)(this.otherLines)),e}},{key:"addLine",value:function(e){if((0,a.Z)((0,p.Z)(n.prototype),"addLine",this).call(this,e))return!0;if(e instanceof Gn)throw new Error("Error: tried passing a MediaLine to an existing MediaInfo");if(e instanceof kn)return this.direction=e.direction,!0;if(e instanceof Mn)return this.extMaps.push(e),!0;if(e instanceof Hn)return this.rids.push(e),!0;if(e instanceof Kn)return this.rtcpMux=!0,!0;if(e instanceof nr)return this.simulcast=e,!0;if(e instanceof zn||e instanceof Dn||e instanceof Yn){var t=this.codecs.get(e.payloadType);if(!t)throw new Error("Error: got line for unknown codec: ".concat(e.toSdpLine()));return t.addLine(e),!0}return e instanceof rr?(this.ssrcs.push(e),!0):e instanceof ir?(this.ssrcGroups.push(e),!0):(this.otherLines.push(e),!0)}},{key:"getCodecByPt",value:function(e){return this.codecs.get(e)}},{key:"removePt",value:function(e){var t=this,n=(0,c.Z)(this.codecs.values()).filter((function(t){return t.primaryCodecPt===e})).map((function(e){return e.pt})),r=[e].concat((0,c.Z)(n));r.forEach((function(e){t.codecs.delete(e)})),this.pts=this.pts.filter((function(e){return-1===r.indexOf(e)}))}}]),n}(ur),pr=function(){function e(){(0,v.Z)(this,e),this.groups=[],this.otherLines=[]}return(0,h.Z)(e,[{key:"addLine",value:function(e){return e instanceof ar?(this.version=e,!0):e instanceof jn?(this.origin=e,!0):e instanceof $n?(this.sessionName=e,!0):e instanceof Jn?(this.information=e,!0):e instanceof or?(this.timing=e,!0):e instanceof Ln?(this.connection=e,!0):e instanceof xn?(this.bandwidth=e,!0):e instanceof wn?(this.groups.push(e),!0):(this.otherLines.push(e),!0)}},{key:"toLines",value:function(){var e=[];return this.version&&e.push(this.version),this.origin&&e.push(this.origin),this.sessionName&&e.push(this.sessionName),this.information&&e.push(this.information),this.connection&&e.push(this.connection),this.bandwidth&&e.push(this.bandwidth),this.timing&&e.push(this.timing),this.groups&&e.push.apply(e,(0,c.Z)(this.groups)),e.push.apply(e,(0,c.Z)(this.otherLines)),e}}]),e}(),hr=function(){function e(){(0,v.Z)(this,e),this.session=new pr,this.media=[]}return(0,h.Z)(e,[{key:"avMedia",get:function(){return this.media.filter((function(e){return e instanceof fr}))}},{key:"toString",value:function(){var e=[];return e.push.apply(e,(0,c.Z)(this.session.toLines())),this.media.forEach((function(t){return e.push.apply(e,(0,c.Z)(t.toLines()))})),"".concat(e.map((function(e){return e.toSdpLine()})).join("\r\n"),"\r\n")}}]),e}(),vr=new(function(e){(0,l.Z)(n,e);var t=xe(n);function n(){var e;return(0,v.Z)(this,n),(e=t.call(this)).addParser("v",ar.fromSdpLine),e.addParser("o",jn.fromSdpLine),e.addParser("c",Ln.fromSdpLine),e.addParser("i",Jn.fromSdpLine),e.addParser("m",Gn.fromSdpLine),e.addParser("s",$n.fromSdpLine),e.addParser("t",or.fromSdpLine),e.addParser("b",xn.fromSdpLine),e.addParser("a",zn.fromSdpLine),e.addParser("a",Yn.fromSdpLine),e.addParser("a",Dn.fromSdpLine),e.addParser("a",kn.fromSdpLine),e.addParser("a",Mn.fromSdpLine),e.addParser("a",Bn.fromSdpLine),e.addParser("a",Un.fromSdpLine),e.addParser("a",Fn.fromSdpLine),e.addParser("a",Pn.fromSdpLine),e.addParser("a",Nn.fromSdpLine),e.addParser("a",Qn.fromSdpLine),e.addParser("a",Xn.fromSdpLine),e.addParser("a",Vn.fromSdpLine),e.addParser("a",Kn.fromSdpLine),e.addParser("a",wn.fromSdpLine),e.addParser("a",On.fromSdpLine),e.addParser("a",Hn.fromSdpLine),e.addParser("a",In.fromSdpLine),e.addParser("a",nr.fromSdpLine),e.addParser("a",rr.fromSdpLine),e.addParser("a",ir.fromSdpLine),e}return(0,h.Z)(n)}(function(){function e(){(0,v.Z)(this,e),this.parsers=new($())}return(0,h.Z)(e,[{key:"addParser",value:function(e,t){var n=this.parsers.get(e)||[];n.push(t),this.parsers.set(e,n)}},{key:"getParsers",value:function(e){return this.parsers.get(e)||[]}}]),e}()));function mr(e){return e.length>2}function gr(e){var t=function(e,t){var n=[];return e.split(/(\r\n|\r|\n)/).filter(mr).forEach((function(e){var r,i=e[0],o=e.slice(2),a=Re(t.getParsers(i));try{for(a.s();!(r=a.n()).done;){var s=(0,r.value)(o);if(s)return void n.push(s)}}catch(e){a.e(e)}finally{a.f()}var c=sr.fromSdpLine(e);n.push(c)})),n}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:vr),n=function(e){var t=new hr,n=t.session;return e.forEach((function(e){if(e instanceof Gn){var r;if("audio"===e.type||"video"===e.type)r=new fr(e);else{if("application"!==e.type)throw new Error("Unhandled media type: ".concat(e.type));r=new dr(e)}t.media.push(r),n=r}else n.addLine(e)})),t}(t);return n}function Er(e,t,n){var r=function(){var e=!!n;return e&&t?"sendrecv":e&&!t?"sendonly":!e&&t?"recvonly":"inactive"}();return{trackOrKind:n||e,direction:r}}function yr(e){var t,n=Re(e.codecs.values());try{for(n.s();!(t=n.n()).done;){var r;if("H264"===(null===(r=t.value.name)||void 0===r?void 0:r.toUpperCase()))return!0}}catch(e){n.e(e)}finally{n.f()}return!1}var Sr=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),r=t.call(this),Me.default((0,d.Z)(r),"value",void 0),r.value=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=".concat(this.value)}}],[{key:"fromSdpLine",value:function(){}}]),n}(Tn);function _r(e){e.avMedia.forEach((function(e){e.extMaps.length=0}))}function Cr(e,t){var n=gr(t);return e.disableRtx&&function(e){e.avMedia.forEach((function(e){var t=[];e.codecs.forEach((function(e,n){"rtx"===e.name&&e.primaryCodecPt&&t.push(n)})),t.forEach((function(t){return e.codecs.delete(t)})),e.pts=e.pts.filter((function(e){return!t.includes(e)}))}))}(n),n.toString()}function Rr(e,t){var n=gr(t);return e.convertCLineToIPv4&&function(e){var t=function(e){"IP6"===(null==e?void 0:e.addrType)&&(e.addrType="IP4",e.ipAddr="0.0.0.0")};t(e.session.connection),e.media.forEach((function(e){t(e.connection)}))}(n),e.bandwidthLimits&&function(e,t){e.avMedia.forEach((function(e){"audio"===e.type?e.addLine(new xn("TIAS",t.audio)):"video"===e.type&&e.addLine(new xn("TIAS",t.video))}))}(n,e.bandwidthLimits),e.periodicKeyframes&&function(e,t){e.avMedia.forEach((function(e){"video"===e.type&&e.addLine(new Sr("periodic-keyframes:".concat(t)))}))}(n,e.periodicKeyframes),e.convertPort9to0&&function(e){e.media.forEach((function(e){9===e.port&&(e.port=0)}))}(n),e.addContentSlides&&function(e){var t=e.avMedia.filter((function(e){return"video"===e.type}));2===t.length&&t[1].addLine(new On(["slides"]))}(n),e.disableExtmap&&_r(n),e.h264MaxFs&&function(e,t){var n={10:99,11:396,12:396,13:396,20:396,21:792,22:1620,30:1620,31:3600,32:5120,40:8192,41:8192,42:8704,50:22080,51:36864,52:36864,60:139264,61:139264,62:139264};e.avMedia.forEach((function(e){"video"===e.type&&e.codecs.forEach((function(e){var r;if("H264"===(null===(r=e.name)||void 0===r?void 0:r.toUpperCase())){var i=e.fmtParams.get("profile-level-id");if(i){var o=i.substring(0,4).toLowerCase(),a=k()(i.substring(4,6),16);if(!n[a])throw new Error("found unsupported h264 profile level id value in the SDP: ".concat(a));if(n[a]===t)return;if(n[a]<t)return e.fmtParams.set("max-fs","".concat(t)),void e.fmtParams.set("max-mbps","".concat(30*t));var s=T()(n).reverse().find((function(e){return n[e]===t}));if(s){var c=k()(s,10).toString(16);return e.fmtParams.set("profile-level-id","".concat(o).concat(c)),void e.fmtParams.set("max-mbps","".concat(30*t))}throw new Error("unsupported maxFsValue: ".concat(t))}}}))}))}(n,e.h264MaxFs),n.toString()}function Tr(e,t){var n=gr(t);return e.startBitrate&&function(e,t){!function(e,t){e.avMedia.forEach((function(e){"video"===e.type&&e.codecs.forEach((function(e){var n;"H264"===(null===(n=e.name)||void 0===n?void 0:n.toUpperCase())&&t.forEach((function(t,n){return e.fmtParams.set(n,t)}))}))}))}(e,new($())([["x-google-start-bitrate",t.toString()]]))}(n,e.startBitrate),e.disableExtmap&&_r(n),function(e){e.media.forEach((function(e){e.iceInfo.candidates=e.iceInfo.candidates.filter((function(e){return"xtls"!==e.transport.toLowerCase()}))}))}(n),n.toString()}function xr(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!C()(t)&&T()(t).forEach((function(n){if("default"!==n&&!(n in e)){var r=b()(t,n);S()(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}}))})),I()(e)}function br(e,t,n,r){return new(n||(n=ne()))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}var wr="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==Pe?Pe:"undefined"!=typeof self?self:{},Ir={exports:{}};!function(e){!function(t){var n,r={};r.VERSION="1.6.1";var i={},o=function(e,t){return function(){return t.apply(e,arguments)}},a=function(){var e,t,n=arguments,r=n[0];for(t=1;t<n.length;t++)for(e in n[t])!(e in r)&&n[t].hasOwnProperty(e)&&(r[e]=n[t][e]);return r},s=function(e,t){return{value:e,name:t}};r.TRACE=s(1,"TRACE"),r.DEBUG=s(2,"DEBUG"),r.INFO=s(3,"INFO"),r.TIME=s(4,"TIME"),r.WARN=s(5,"WARN"),r.ERROR=s(8,"ERROR"),r.OFF=s(99,"OFF");var c=function(e){this.context=e,this.setLevel(e.filterLevel),this.log=this.info};c.prototype={setLevel:function(e){e&&"value"in e&&(this.context.filterLevel=e)},getLevel:function(){return this.context.filterLevel},enabledFor:function(e){var t=this.context.filterLevel;return e.value>=t.value},trace:function(){this.invoke(r.TRACE,arguments)},debug:function(){this.invoke(r.DEBUG,arguments)},info:function(){this.invoke(r.INFO,arguments)},warn:function(){this.invoke(r.WARN,arguments)},error:function(){this.invoke(r.ERROR,arguments)},time:function(e){"string"==typeof e&&e.length>0&&this.invoke(r.TIME,[e,"start"])},timeEnd:function(e){"string"==typeof e&&e.length>0&&this.invoke(r.TIME,[e,"end"])},invoke:function(e,t){n&&this.enabledFor(e)&&n(t,a({level:e},this.context))}};var u,d=new c({filterLevel:r.OFF});(u=r).enabledFor=o(d,d.enabledFor),u.trace=o(d,d.trace),u.debug=o(d,d.debug),u.time=o(d,d.time),u.timeEnd=o(d,d.timeEnd),u.info=o(d,d.info),u.warn=o(d,d.warn),u.error=o(d,d.error),u.log=u.info,r.setHandler=function(e){n=e},r.setLevel=function(e){for(var t in d.setLevel(e),i)i.hasOwnProperty(t)&&i[t].setLevel(e)},r.getLevel=function(){return d.getLevel()},r.get=function(e){return i[e]||(i[e]=new c(a({name:e},d.context)))},r.createDefaultHandler=function(e){(e=e||{}).formatter=e.formatter||function(e,t){t.name&&e.unshift("["+t.name+"]")};var t={},n=function(e,t){Function.prototype.apply.call(e,console,t)};return"undefined"==typeof console?function(){}:function(i,o){i=Array.prototype.slice.call(i);var a,s=console.log;o.level===r.TIME?(a=(o.name?"["+o.name+"] ":"")+i[0],"start"===i[1]?console.time?console.time(a):t[a]=(new Date).getTime():console.timeEnd?console.timeEnd(a):n(s,[a+": "+((new Date).getTime()-t[a])+"ms"])):(o.level===r.WARN&&console.warn?s=console.warn:o.level===r.ERROR&&console.error?s=console.error:o.level===r.INFO&&console.info?s=console.info:o.level===r.DEBUG&&console.debug?s=console.debug:o.level===r.TRACE&&console.trace&&(s=console.trace),e.formatter(i,o),n(s,i))}},r.useDefaults=function(e){r.setLevel(e&&e.defaultLevel||r.DEBUG),r.setHandler(r.createDefaultHandler(e))},r.setDefaults=r.useDefaults,e.exports?e.exports=r:(r._prevLogger=t.Logger,r.noConflict=function(){return t.Logger=r._prevLogger,r},t.Logger=r)}(wr)}(Ir);var Lr,Or=Ir.exports,Ar=Or.get("webrtc-core");function kr(e){return br(this,void 0,void 0,E().mark((function t(){return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",navigator.mediaDevices.getUserMedia(e));case 1:case"end":return t.stop()}}),t)})))}function Mr(e){return navigator.mediaDevices.getDisplayMedia(e)}function Nr(){return br(this,void 0,void 0,E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",navigator.mediaDevices.enumerateDevices());case 1:case"end":return e.stop()}}),e)})))}function Dr(e){return br(this,void 0,void 0,E().mark((function t(){var n;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],e.includes(Lr.VideoInput)&&n.push(navigator.permissions.query({name:"camera"})),e.includes(Lr.AudioInput)&&n.push(navigator.permissions.query({name:"microphone"})),t.abrupt("return",ne().all(n));case 4:case"end":return t.stop()}}),t)})))}function Pr(e){return br(this,void 0,void 0,E().mark((function t(){var n;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Dr(e);case 3:if(!t.sent.every((function(e){return"granted"===e.state}))){t.next=6;break}return t.abrupt("return",!0);case 6:t.next=10;break;case 8:t.prev=8,t.t0=t.catch(0);case 10:return t.prev=10,t.next=13,Nr();case 13:return n=t.sent,t.abrupt("return",n.filter((function(t){return e.includes(t.kind)})).every((function(e){return e.label})));case 17:t.prev=17,t.t1=t.catch(10);case 19:return t.abrupt("return",!1);case 20:case"end":return t.stop()}}),t,null,[[0,8],[10,17]])})))}function Fr(e,t){return br(this,void 0,void 0,E().mark((function n(){var r,i;return E().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Pr(e);case 3:if(n.sent){n.next=13;break}return n.next=7,kr({audio:e.includes(Lr.AudioInput),video:e.includes(Lr.VideoInput)});case 7:return r=n.sent,n.next=10,t();case 10:return i=n.sent,r.getTracks().forEach((function(e){return e.stop()})),n.abrupt("return",i);case 13:return n.abrupt("return",t());case 16:throw n.prev=16,n.t0=n.catch(0),Ar.error(n.t0),new Error("Failed to ensure device permissions.");case 20:case"end":return n.stop()}}),n,null,[[0,16]])})))}Ar.setLevel(Or.DEBUG),function(e){e.AudioInput="audioinput",e.AudioOutput="audiooutput",e.VideoInput="videoinput"}(Lr||(Lr={}));var Ur,Zr=I()({__proto__:null,get DeviceKind(){return Lr},getUserMedia:kr,getDisplayMedia:Mr,enumerateDevices:Nr,setOnDeviceChangeHandler:function(e){navigator.mediaDevices.ondevicechange=e},checkDevicePermissions:Pr,ensureDevicePermissions:Fr}),Vr={exports:{}},Gr="object"===("undefined"==typeof Reflect?"undefined":(0,m.Z)(Reflect))?Reflect:null,Br=Gr&&"function"==typeof ie()?ie():function(e,t,n){return Function.prototype.apply.call(e,t,n)};Ur=Gr&&"function"==typeof U()?U():K()?function(e){return ae()(e).concat(K()(e))}:function(e){return ae()(e)};var Wr=ce()||function(e){return e!=e};function jr(){jr.init.call(this)}Vr.exports=jr,Vr.exports.once=function(e,t){return new(ne())((function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}ei(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&ei(e,"error",t,n)}(e,i,{once:!0})}))},jr.EventEmitter=jr,jr.prototype._events=void 0,jr.prototype._eventsCount=0,jr.prototype._maxListeners=void 0;var Hr=10;function Kr(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+(0,m.Z)(e))}function qr(e){return void 0===e._maxListeners?jr.defaultMaxListeners:e._maxListeners}function Yr(e,t,n,r){var i,o,a,s;if(Kr(n),void 0===(o=e._events)?(o=e._events=N()(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]),void 0===a)a=o[t]=n,++e._eventsCount;else if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=qr(e))>0&&a.length>i&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=a.length,s=c,console&&console.warn&&console.warn(s)}return e}function zr(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Xr(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=zr.bind(r);return i.listener=n,r.wrapFn=i,i}function Jr(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):Qr(i,i.length)}function $r(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function Qr(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function ei(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+(0,m.Z)(e));e.addEventListener(t,(function i(o){r.once&&e.removeEventListener(t,i),n(o)}))}}S()(jr,"defaultMaxListeners",{enumerable:!0,get:function(){return Hr},set:function(e){if("number"!=typeof e||e<0||Wr(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Hr=e}}),jr.init=function(){void 0!==this._events&&this._events!==P()(this)._events||(this._events=N()(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},jr.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||Wr(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},jr.prototype.getMaxListeners=function(){return qr(this)},jr.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var s=i[e];if(void 0===s)return!1;if("function"==typeof s)Br(s,this,t);else{var c=s.length,u=Qr(s,c);for(n=0;n<c;++n)Br(u[n],this,t)}return!0},jr.prototype.addListener=function(e,t){return Yr(this,e,t,!1)},jr.prototype.on=jr.prototype.addListener,jr.prototype.prependListener=function(e,t){return Yr(this,e,t,!0)},jr.prototype.once=function(e,t){return Kr(t),this.on(e,Xr(this,e,t)),this},jr.prototype.prependOnceListener=function(e,t){return Kr(t),this.prependListener(e,Xr(this,e,t)),this},jr.prototype.removeListener=function(e,t){var n,r,i,o,a;if(Kr(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=N()(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},jr.prototype.off=jr.prototype.removeListener,jr.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=N()(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=N()(null):delete n[e]),this;if(0===arguments.length){var i,o=T()(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=N()(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},jr.prototype.listeners=function(e){return Jr(this,e,!0)},jr.prototype.rawListeners=function(e){return Jr(this,e,!1)},jr.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):$r.call(e,t)},jr.prototype.listenerCount=$r,jr.prototype.eventNames=function(){return this._eventsCount>0?Ur(this._events):[]};var ti,ni=function(e){(0,l.Z)(n,e);var t=xe(n);function n(){return(0,v.Z)(this,n),t.apply(this,arguments)}return(0,h.Z)(n)}(Vr.exports.EventEmitter);exports.LocalTrackEvents=void 0,(ti=exports.LocalTrackEvents||(exports.LocalTrackEvents={})).Ended="ended",ti.Muted="muted",ti.PublishedStateUpdate="published-state-update",ti.UnderlyingTrackChange="underlying-track-change",ti.TrackConstraintsChange="track-constraints-change";var ri=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).isPublished=!1,r.effects=new($()),r.originalStream=e,r.underlyingStream=e,r.label=r.underlyingStream.getTracks()[0].label,r.underlyingTrack.onended=function(){r.emit(exports.LocalTrackEvents.Ended,{trackState:r.trackState})},r}return(0,h.Z)(n,[{key:"kind",get:function(){return this.underlyingTrack.kind}},{key:"id",get:function(){return this.underlyingTrack.id}},{key:"muted",get:function(){return!this.underlyingTrack.enabled}},{key:"published",get:function(){return this.isPublished}},{key:"underlyingStream",get:function(){return this._underlyingStream},set:function(e){this._underlyingStream=e}},{key:"trackState",get:function(){return{id:this.id,label:this.label,type:this.kind,muted:this.muted}}},{key:"underlyingTrack",get:function(){return this._underlyingStream.getTracks()[0]}},{key:"originalTrack",get:function(){return this.originalStream.getTracks()[0]}},{key:"setMuted",value:function(e){this.underlyingTrack.enabled===e&&(this.originalTrack.enabled=!e,this.underlyingTrack.enabled=!e,this.emit(exports.LocalTrackEvents.Muted,{trackState:this.trackState}),Ar.log("Local track ".concat(e?"muted":"unmuted",":"),{trackState:this.trackState}))}},{key:"setPublished",value:function(e){this.isPublished!==e&&(this.isPublished=e,this.emit(exports.LocalTrackEvents.PublishedStateUpdate,{trackState:this.trackState,isPublished:e}),Ar.log("Local track ".concat(e?"published":"unpublished",":"),{trackState:this.trackState}))}},{key:"stop",value:function(){this.originalTrack.stop(),this.underlyingTrack.stop(),this.emit(exports.LocalTrackEvents.Ended,{trackState:this.trackState}),Ar.log("Local track stopped:",{trackState:this.trackState})}},{key:"addEffect",value:function(e,t){return br(this,void 0,void 0,E().mark((function n(){return E().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.load(this.underlyingStream);case 2:this.underlyingStream=t.getUnderlyingStream(),this.effects.set(e,t),this.emit(exports.LocalTrackEvents.UnderlyingTrackChange);case 5:case"end":return n.stop()}}),n,this)})))}},{key:"getEffect",value:function(e){var t=this.effects.get(e);return t||Ar.log("No effect found with name '".concat(e,"'")),t}},{key:"disposeEffects",value:function(){this.effects.size>0&&(this.effects.forEach((function(e){return e.dispose()})),this.effects.clear(),this.underlyingStream=this.originalStream,this.emit(exports.LocalTrackEvents.UnderlyingTrackChange))}},{key:"applyConstraints",value:function(e){return br(this,void 0,void 0,E().mark((function t(){var n,r=this;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Ar.log("Applying constraints to local track:",e),n=this.underlyingTrack.applyConstraints(e).then((function(){r.emit(exports.LocalTrackEvents.TrackConstraintsChange)})),t.abrupt("return",n);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"getConstraints",value:function(){return this.underlyingTrack.getConstraints()}},{key:"getSettings",value:function(){return this.underlyingTrack.getSettings()}},{key:"getNumActiveSimulcastLayers",value:function(){var e=0;if("audio"===this.trackState.type)return e;var t=this.underlyingTrack.getSettings().height;return e=t<=180?1:t<=360?2:3}}]),n}(ni);ri.Events=exports.LocalTrackEvents;var ii,oi=function(e){(0,l.Z)(n,e);var t=xe(n);function n(){return(0,v.Z)(this,n),t.apply(this,arguments)}return(0,h.Z)(n)}(ri),ai=function(e){(0,l.Z)(n,e);var t=xe(n);function n(){return(0,v.Z)(this,n),t.apply(this,arguments)}return(0,h.Z)(n)}(ri),si=function(e){(0,l.Z)(n,e);var t=xe(n);function n(){return(0,v.Z)(this,n),t.apply(this,arguments)}return(0,h.Z)(n)}(ri);!function(e){e.DEVICE_PERMISSION_DENIED="DEVICE_PERMISSION_DENIED",e.CREATE_CAMERA_TRACK_FAILED="CREATE_CAMERA_TRACK_FAILED",e.CREATE_MICROPHONE_TRACK_FAILED="CREATE_MICROPHONE_TRACK_FAILED"}(ii||(ii={}));var ci=(0,h.Z)((function e(t){(0,v.Z)(this,e);var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.type=t,this.message=n}));function ui(e){return br(this,void 0,void 0,E().mark((function t(){var n;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Fr([Lr.AudioInput,Lr.VideoInput],Nr);case 3:n=t.sent,t.next=9;break;case 6:throw t.prev=6,t.t0=t.catch(0),new ci(ii.DEVICE_PERMISSION_DENIED,"Failed to ensure device permissions");case 9:return t.abrupt("return",n.filter((function(t){return!e||t.kind===e})));case 10:case"end":return t.stop()}}),t,null,[[0,6]])})))}var di,li,fi=Zr.setOnDeviceChangeHandler;exports.ConnectionState=void 0,(di=exports.ConnectionState||(exports.ConnectionState={})).New="New",di.Closed="Closed",di.Connected="Connected",di.Connecting="Connecting",di.Disconnected="Disconnected",di.Failed="Failed",function(e){e.ConnectionStateChanged="ConnectionStateChanged"}(li||(li={}));var pi=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).getCurrentStatesCallback=e,r.mediaConnectionState=r.evaluateMediaConnectionState(),r}return(0,h.Z)(n,[{key:"onConnectionStateChange",value:function(){this.handleAnyConnectionStateChange()}},{key:"onIceConnectionStateChange",value:function(){this.handleAnyConnectionStateChange()}},{key:"handleAnyConnectionStateChange",value:function(){var e=this.evaluateMediaConnectionState();e!==this.mediaConnectionState&&(this.mediaConnectionState=e,this.emit(li.ConnectionStateChanged,this.mediaConnectionState))}},{key:"evaluateMediaConnectionState",value:function(){var e,t=this.getCurrentStatesCallback(),n=t.connectionState,r=t.iceState,i=[n,r];return e=i.every((function(e){return"new"===e}))?exports.ConnectionState.New:i.some((function(e){return"closed"===e}))?exports.ConnectionState.Closed:i.some((function(e){return"failed"===e}))?exports.ConnectionState.Failed:i.some((function(e){return"disconnected"===e}))?exports.ConnectionState.Disconnected:i.every((function(e){return"connected"===e||"completed"===e}))?exports.ConnectionState.Connected:exports.ConnectionState.Connecting,Ar.log("iceConnectionState=".concat(r," connectionState=").concat(n," => ").concat(this.mediaConnectionState)),e}},{key:"getConnectionState",value:function(){return this.mediaConnectionState}}]),n}(ni);pi.Events=li;var hi=!0,vi=!0;function mi(e,t,n){var r=e.match(t);return r&&r.length>=n&&k()(r[n],10)}function gi(e,t,n){if(e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);var o=function(e){var t=n(e);t&&(r.handleEvent?r.handleEvent(t):r(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new($())),this._eventMap[t].set(r,o),i.apply(this,[e,o])};var o=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(n))return o.apply(this,arguments);var r=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===T()(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,r])},S()(r,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}}function Ei(e){return"boolean"!=typeof e?new Error("Argument type: "+(0,m.Z)(e)+". Please use a boolean."):(hi=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function yi(e){return"boolean"!=typeof e?new Error("Argument type: "+(0,m.Z)(e)+". Please use a boolean."):(vi=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function Si(){if("object"===("undefined"==typeof window?"undefined":(0,m.Z)(window))){if(hi)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function _i(e,t){vi&&console.warn(e+" is deprecated, please use "+t+" instead.")}function Ci(e){return"[object Object]"===Object.prototype.toString.call(e)}function Ri(e){return Ci(e)?T()(e).reduce((function(t,n){var r=Ci(e[n]),i=r?Ri(e[n]):e[n],a=r&&!T()(i).length;return void 0===i||a?t:de()(t,(0,o.Z)({},n,i))}),{}):e}function Ti(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),T()(t).forEach((function(r){r.endsWith("Id")?Ti(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach((function(t){Ti(e,e.get(t),n)}))})))}function xi(e,t,n){var r=n?"outbound-rtp":"inbound-rtp",i=new($());if(null===t)return i;var o=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((function(t){e.forEach((function(n){n.type===r&&n.trackId===t.id&&Ti(e,n,i)}))})),i}var bi=Si;function wi(e,t){var n=e&&e.navigator;if(n.mediaDevices){var r=function(e){if("object"!==(0,m.Z)(e)||e.mandatory||e.optional)return e;var t={};return T()(e).forEach((function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"===(0,m.Z)(e[n])?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var o={};"number"==typeof r.ideal?(o[i("min",n)]=r.ideal,t.optional.push(o),(o={})[i("max",n)]=r.ideal,t.optional.push(o)):(o[i("",n)]=r.ideal,t.optional.push(o))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach((function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},i=function(e,i){if(t.version>=61)return i(e);if((e=JSON.parse(B()(e)))&&"object"===(0,m.Z)(e.audio)){var o=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};o((e=JSON.parse(B()(e))).audio,"autoGainControl","googAutoGainControl"),o(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=r(e.audio)}if(e&&"object"===(0,m.Z)(e.video)){var a=e.video.facingMode;a=a&&("object"===(0,m.Z)(a)?a:{ideal:a});var s,c=t.version<66;if(a&&("user"===a.exact||"environment"===a.exact||"user"===a.ideal||"environment"===a.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||c))if(delete e.video.facingMode,"environment"===a.exact||"environment"===a.ideal?s=["back","rear"]:"user"!==a.exact&&"user"!==a.ideal||(s=["front"]),s)return n.mediaDevices.enumerateDevices().then((function(t){var n=(t=t.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return s.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!n&&t.length&&s.includes("back")&&(n=t[t.length-1]),n&&(e.video.deviceId=a.exact?{exact:n.deviceId}:{ideal:n.deviceId}),e.video=r(e.video),bi("chrome: "+B()(e)),i(e)}));e.video=r(e.video)}return bi("chrome: "+B()(e)),i(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,r){i(e,(function(e){n.webkitGetUserMedia(e,t,(function(e){r&&r(o(e))}))}))}.bind(n),n.mediaDevices.getUserMedia){var a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(e){return i(e,(function(e){return a(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return ne().reject(o(e))}))}))}}}}function Ii(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function Li(e){if("object"===(0,m.Z)(e)&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){S()(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.track.id})):{track:r.track};var o=new Event("track");o.track=r.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)})),t.stream.getTracks().forEach((function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.id})):{track:r};var o=new Event("track");o.track=r,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else gi(e,"track",(function(e){return e.transceiver||S()(e,"transceiver",{value:{receiver:e.receiver}}),e}))}function Oi(e){if("object"===(0,m.Z)(e)&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){var i=n.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((function(e){n._senders.push(t(n,e))}))};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach((function(e){var n=t._senders.find((function(t){return t.track===e}));n&&t._senders.splice(t._senders.indexOf(n),1)}))}}else if("object"===(0,m.Z)(e)&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=a.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},S()(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Ai(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,n=Array.prototype.slice.call(arguments),r=n[0],i=n[1],o=n[2];if(arguments.length>0&&"function"==typeof r)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof r))return t.apply(this,[]);var a=function(e){var t={};return e.result().forEach((function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){n[t]=e.stat(t)})),t[n.id]=n})),t},s=function(e){return new($())(T()(e).map((function(t){return[t,e[t]]})))};if(arguments.length>=2){return t.apply(this,[function(e){i(s(a(e)))},r])}return new(ne())((function(n,r){t.apply(e,[function(e){n(s(a(e)))},r])})).then(i,o)}}}function ki(e){if("object"===(0,m.Z)(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return xi(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var r=e.RTCPeerConnection.prototype.getReceivers;r&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=r.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),gi(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return xi(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t,n,r,o=arguments[0];return this.getSenders().forEach((function(e){e.track===o&&(t?r=!0:t=e)})),this.getReceivers().forEach((function(e){return e.track===o&&(n?r=!0:n=e),e.track===o})),r||t&&n?ne().reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():ne().reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return i.apply(this,arguments)}}}}function Mi(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},T()(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var r=this.getSenders();n.apply(this,arguments);var i=this.getSenders().filter((function(e){return-1===r.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(i)};var r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&T()(this._shimmedLocalStreams).forEach((function(n){var r=t._shimmedLocalStreams[n].indexOf(e);-1!==r&&t._shimmedLocalStreams[n].splice(r,1),1===t._shimmedLocalStreams[n].length&&delete t._shimmedLocalStreams[n]})),i.apply(this,arguments)}}function Ni(e,t){if(e.RTCPeerConnection){if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return Mi(e);var n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=n.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var n=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(n.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var i=new e.MediaStream(t.getTracks());this._streams[t.id]=i,this._reverseStreams[i.id]=t,t=i}r.apply(this,[t])};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((function(e){return e.track===t})))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var o=this._streams[n.id];if(o)o.addTrack(t),ne().resolve().then((function(){r.dispatchEvent(new Event("negotiationneeded"))}));else{var a=new e.MediaStream([t]);this._streams[n.id]=a,this._reverseStreams[a.id]=n,this.addStream(a)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=(0,o.Z)({},t,(function(){var e=this,t=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[function(n){var r=c(e,n);t[0].apply(null,[r])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):n.apply(this,arguments).then((function(t){return c(e,t)}))}));e.RTCPeerConnection.prototype[t]=r[t]}));var a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){var n=t.sdp;return T()(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})}(this,arguments[0]),a.apply(this,arguments)):a.apply(this,arguments)};var s=b()(e.RTCPeerConnection.prototype,"localDescription");S()(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=s.get.apply(this);return""===e.type?e:c(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},T()(this._streams).forEach((function(r){n._streams[r].getTracks().find((function(t){return e.track===t}))&&(t=n._streams[r])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function c(e,t){var n=t.sdp;return T()(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(i.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:n})}}function Di(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=(0,o.Z)({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=r[t]}))}function Pi(e,t){gi(e,"negotiationneeded",(function(e){var n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e}))}var Fi=I()({__proto__:null,shimMediaStream:Ii,shimOnTrack:Li,shimGetSendersWithDtmf:Oi,shimGetStats:Ai,shimSenderReceiverGetStats:ki,shimAddTrackRemoveTrackWithNative:Mi,shimAddTrackRemoveTrack:Ni,shimPeerConnection:Di,fixNegotiationNeeded:Pi,shimGetUserMedia:wi,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((function(t){var r=n.video&&n.video.width,i=n.video&&n.video.height,o=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}});function Ui(e,t){var n=e&&e.navigator,r=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,r){_i("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,r)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var i=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},o=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"===(0,m.Z)(e)&&"object"===(0,m.Z)(e.audio)&&(e=JSON.parse(B()(e)),i(e.audio,"autoGainControl","mozAutoGainControl"),i(e.audio,"noiseSuppression","mozNoiseSuppression")),o(e)},r&&r.prototype.getSettings){var a=r.prototype.getSettings;r.prototype.getSettings=function(){var e=a.apply(this,arguments);return i(e,"mozAutoGainControl","autoGainControl"),i(e,"mozNoiseSuppression","noiseSuppression"),e}}if(r&&r.prototype.applyConstraints){var s=r.prototype.applyConstraints;r.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===(0,m.Z)(e)&&(e=JSON.parse(B()(e)),i(e,"autoGainControl","mozAutoGainControl"),i(e,"noiseSuppression","mozNoiseSuppression")),s.apply(this,[e])}}}}function Zi(e){"object"===(0,m.Z)(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&S()(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function Vi(e,t){if("object"===(0,m.Z)(e)&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=(0,o.Z)({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=r[t]}));var n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),i=e[0],o=e[1],a=e[2];return r.apply(this,[i||null]).then((function(e){if(t.version<53&&!o)try{e.forEach((function(e){e.type=n[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach((function(t,r){e.set(r,de()({},t,{type:n[t.type]||t.type}))}))}return e})).then(o,a)}}}function Gi(e){if("object"===(0,m.Z)(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpSender.prototype))){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):ne().resolve(new($()))}}}function Bi(e){if("object"===(0,m.Z)(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpReceiver.prototype))){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n}),gi(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}}function Wi(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;_i("removeStream","removeTrack"),this.getSenders().forEach((function(n){n.track&&e.getTracks().includes(n.track)&&t.removeTrack(n)}))})}function ji(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function Hi(e){if("object"===(0,m.Z)(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1]&&arguments[1].sendEncodings;void 0===e&&(e=[]);var n=(e=(0,c.Z)(e)).length>0;n&&e.forEach((function(e){if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(O()(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(O()(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var r=t.apply(this,arguments);if(n){var i=r.sender,o=i.getParameters();(!("encodings"in o)||1===o.encodings.length&&0===T()(o.encodings[0]).length)&&(o.encodings=e,i.sendEncodings=e,this.setParametersPromises.push(i.setParameters(o).then((function(){delete i.sendEncodings})).catch((function(){delete i.sendEncodings}))))}return r})}}function Ki(e){if("object"===(0,m.Z)(e)&&e.RTCRtpSender){var t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){var e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}}function qi(e){if("object"===(0,m.Z)(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?ne().all(this.setParametersPromises).then((function(){return t.apply(n,e)})).finally((function(){n.setParametersPromises=[]})):t.apply(this,arguments)}}}function Yi(e){if("object"===(0,m.Z)(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?ne().all(this.setParametersPromises).then((function(){return t.apply(n,e)})).finally((function(){n.setParametersPromises=[]})):t.apply(this,arguments)}}}var zi=I()({__proto__:null,shimOnTrack:Zi,shimPeerConnection:Vi,shimSenderGetStats:Gi,shimReceiverGetStats:Bi,shimRemoveStream:Wi,shimRTCDataChannel:ji,shimAddTransceiver:Hi,shimGetParameters:Ki,shimCreateOffer:qi,shimCreateAnswer:Yi,shimGetUserMedia:Ui,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){var r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,ne().reject(r)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}});function Xi(e){if("object"===(0,m.Z)(e)&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((function(r){return t.call(n,r,e)})),e.getVideoTracks().forEach((function(r){return t.call(n,r,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var n=this,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return i&&i.forEach((function(e){n._localStreams?n._localStreams.includes(e)||n._localStreams.push(e):n._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var n=this._localStreams.indexOf(e);if(-1!==n){this._localStreams.splice(n,1);var r=e.getTracks();this.getSenders().forEach((function(e){r.includes(e.track)&&t.removeTrack(e)}))}})}}function Ji(e){if("object"===(0,m.Z)(e)&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){S()(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var n=new Event("addstream");n.stream=e,t.dispatchEvent(n)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}}))}),t.apply(e,arguments)}}}function $i(e){if("object"===(0,m.Z)(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,i=t.setLocalDescription,o=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),ne().resolve()):i},t.createAnswer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),ne().resolve()):i};var s=function(e,t,n){var r=i.apply(this,[e]);return n?(r.then(t,n),ne().resolve()):r};t.setLocalDescription=s,s=function(e,t,n){var r=o.apply(this,[e]);return n?(r.then(t,n),ne().resolve()):r},t.setRemoteDescription=s,s=function(e,t,n){var r=a.apply(this,[e]);return n?(r.then(t,n),ne().resolve()):r},t.addIceCandidate=s}}function Qi(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var n=t.mediaDevices,r=n.getUserMedia.bind(n);t.mediaDevices.getUserMedia=function(e){return r(eo(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))}function eo(e){return e&&void 0!==e.video?de()({},e,{video:Ri(e.video)}):e}function to(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){for(var r=[],i=0;i<e.iceServers.length;i++){var o=e.iceServers[i];!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")?(_i("RTCIceServer.url","RTCIceServer.urls"),(o=JSON.parse(B()(o))).urls=o.url,delete o.url,r.push(o)):r.push(e.iceServers[i])}e.iceServers=r}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&S()(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})}}function no(e){"object"===(0,m.Z)(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&S()(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function ro(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var n=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveAudio||n||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var r=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveVideo||r||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function io(e){"object"!==(0,m.Z)(e)||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var oo=I()({__proto__:null,shimLocalStreamsAPI:Xi,shimRemoteStreamsAPI:Ji,shimCallbacksAPI:$i,shimGetUserMedia:Qi,shimConstraints:eo,shimRTCIceServerUrls:to,shimTrackEventTransceiver:no,shimCreateOfferLegacy:ro,shimAudioContext:io}),ao={exports:{}};!function(e){var t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},t.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},t.getDescription=function(e){var n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){var n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter((function(e){return 0===e.indexOf(n)}))},t.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:k()(t[3],10),ip:t[4],address:t[4],port:k()(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=k()(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:void 0===n[t[r]]&&(n[t[r]]=t[r+1])}return n},t.writeCandidate=function(e){var t=[];t.push(e.foundation);var n=e.component;"rtp"===n?t.push(1):"rtcp"===n?t.push(2):t.push(n),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:k()(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=k()(t[1],10),n.channels=3===t.length?k()(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:k()(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)n[(t=r[i].trim().split("="))[0].trim()]=t[1];return n},t.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&T()(e.parameters).length){var r=[];T()(e.parameters).forEach((function(t){void 0!==e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)})),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:k()(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},t.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return k()(e,10)}))}},t.getMid=function(e){var n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substr(6)},t.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},t.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:k()(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"===(0,m.Z)(e.keyParams)?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){var r=t.matchPrefix(e+n,"a=ice-ufrag:")[0],i=t.matchPrefix(e+n,"a=ice-pwd:")[0];return r&&i?{usernameFragment:r.substr(12),password:i.substr(10)}:null},t.writeIceParameters=function(e){var t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){for(var n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=t.splitLines(e)[0].split(" "),i=3;i<r.length;i++){var o=r[i],a=t.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){var s=t.parseRtpMap(a),c=t.matchPrefix(e,"a=fmtp:"+o+" ");switch(s.parameters=c.length?t.parseFmtp(c[0]):{},s.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(t.parseRtcpFb),n.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(s.name.toUpperCase())}}}return t.matchPrefix(e,"a=extmap:").forEach((function(e){n.headerExtensions.push(t.parseExtmap(e))})),n},t.writeRtpDescription=function(e,n){var r="";r+="m="+e+" ",r+=n.codecs.length>0?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=n.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach((function(e){r+=t.writeRtpMap(e),r+=t.writeFmtp(e),r+=t.writeRtcpFb(e)}));var i=0;return n.codecs.forEach((function(e){e.maxptime>i&&(i=e.maxptime)})),i>0&&(r+="a=maxptime:"+i+"\r\n"),n.headerExtensions&&n.headerExtensions.forEach((function(e){r+=t.writeExtmap(e)})),r},t.parseRtpEncodingParameters=function(e){var n,r=[],i=t.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),a=-1!==i.fecMechanisms.indexOf("ULPFEC"),s=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=s.length>0&&s[0].ssrc,u=t.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return k()(e,10)}))}));u.length>0&&u[0].length>1&&u[0][0]===c&&(n=u[0][1]),i.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:c,codecPayloadType:k()(e.parameters.apt,10)};c&&n&&(t.rtx={ssrc:n}),r.push(t),o&&((t=JSON.parse(B()(t))).fec={ssrc:c,mechanism:a?"red+ulpfec":"red"},r.push(t))}})),0===r.length&&c&&r.push({ssrc:c});var d=t.matchPrefix(e,"b=");return d.length&&(d=0===d[0].indexOf("b=TIAS:")?k()(d[0].substr(7),10):0===d[0].indexOf("b=AS:")?1e3*k()(d[0].substr(5),10)*.95-16e3:void 0,r.forEach((function(e){e.maxBitrate=d}))),r},t.parseRtcpParameters=function(e){var n={},r=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];r&&(n.cname=r.value,n.ssrc=r.ssrc);var i=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=i.length>0,n.compound=0===i.length;var o=t.matchPrefix(e,"a=rtcp-mux");return n.mux=o.length>0,n},t.writeRtcpParameters=function(e){var t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){var n,r=t.matchPrefix(e,"a=msid:");if(1===r.length)return{stream:(n=r[0].substr(7).split(" "))[0],track:n[1]};var i=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return i.length>0?{stream:(n=i[0].value.split(" "))[0],track:n[1]}:void 0},t.parseSctpDescription=function(e){var n,r=t.parseMLine(e),i=t.matchPrefix(e,"a=max-message-size:");i.length>0&&(n=k()(i[0].substr(19),10)),isNaN(n)&&(n=65536);var o=t.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:k()(o[0].substr(12),10),protocol:r.fmt,maxMessageSize:n};var a=t.matchPrefix(e,"a=sctpmap:");if(a.length>0){var s=a[0].substr(10).split(" ");return{port:k()(s[0],10),protocol:s[1],maxMessageSize:n}}},t.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,n,r){var i=void 0!==n?n:2;return"v=0\r\no="+(r||"thisisadapterortc")+" "+(e||t.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,n){for(var r=t.splitLines(e),i=0;i<r.length;i++)switch(r[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[i].substr(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){var n=t.splitLines(e)[0].substr(2).split(" ");return{kind:n[0],port:k()(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){var n=t.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:k()(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var n=t.splitLines(e),r=0;r<n.length;r++)if(n[r].length<2||"="!==n[r].charAt(1))return!1;return!0},e.exports=t}(ao);var so=ao.exports,co=xr({__proto__:null,default:so},[ao.exports]);function uo(e){if(!(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===(0,m.Z)(e)&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(B()(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var n=new t(e),r=so.parseCandidate(e.candidate),i=de()(n,r);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,gi(e,"icecandidate",(function(t){return t.candidate&&S()(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}}function lo(e,t){if(e.RTCPeerConnection){"sctp"in e.RTCPeerConnection.prototype||S()(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var n=function(e){if(!e||!e.sdp)return!1;var t=so.splitSections(e.sdp);return t.shift(),t.some((function(e){var t=so.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))},r=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var n=k()(t[1],10);return n!=n?-1:n},i=function(e){var n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n},o=function(e,n){var r=65536;"firefox"===t.browser&&57===t.version&&(r=65535);var i=so.matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?r=k()(i[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(r=2147483637),r},a=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){(this._sctp=null,"chrome"===t.browser&&t.version>=76)&&("plan-b"===this.getConfiguration().sdpSemantics&&S()(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0}));if(n(arguments[0])){var e,s=r(arguments[0]),c=i(s),u=o(arguments[0],s);e=0===c&&0===u?Number.POSITIVE_INFINITY:0===c||0===u?Math.max(c,u):Math.min(c,u);var d={};S()(d,"maxMessageSize",{get:function(){return e}}),this._sctp=d}return a.apply(this,arguments)}}}function fo(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return n(e,this),e},gi(e,"datachannel",(function(e){return n(e.channel,e.target),e}))}function n(e,t){var n=e.send;e.send=function(){var r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}}function po(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;S()(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),S()(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}}function ho(e,t){if(e.RTCPeerConnection&&!("chrome"===t.browser&&t.version>=71||"safari"===t.browser&&t.version>=605)){var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){var r=t.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:r}):t.sdp=r}return n.apply(this,arguments)}}}function vo(e,t){if(e.RTCPeerConnection&&e.RTCPeerConnection.prototype){var n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?ne().resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),ne().resolve())})}}function mo(e,t){if(e.RTCPeerConnection&&e.RTCPeerConnection.prototype){var n=e.RTCPeerConnection.prototype.setLocalDescription;n&&0!==n.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){var e=this,t=arguments[0]||{};if("object"!==(0,m.Z)(t)||t.type&&t.sdp)return n.apply(this,arguments);if(!(t={type:t.type,sdp:t.sdp}).type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":t.type="offer";break;default:t.type="answer"}return t.sdp||"offer"!==t.type&&"answer"!==t.type?n.apply(this,[t]):("offer"===t.type?this.createOffer:this.createAnswer).apply(this).then((function(t){return n.apply(e,[t])}))})}}var go,Eo,yo=I()({__proto__:null,shimRTCIceCandidate:uo,shimMaxMessageSize:lo,shimSendThrowTypeError:fo,shimConnectionState:po,removeExtmapAllowMixed:ho,shimAddIceCandidateNullOrEmpty:vo,shimParameterlessSetLocalDescription:mo});!function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).window,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0},n=Si,r=function(e){var t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;var n=e.navigator;if(n.mozGetUserMedia)t.browser="firefox",t.version=mi(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=mi(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=mi(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(e),i={browserDetails:r,commonShim:yo,extractVersion:mi,disableLog:Ei,disableWarnings:yi,sdp:co};switch(r.browser){case"chrome":if(!Fi||!Di||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),i;if(null===r.version)return n("Chrome shim can not determine version, not shimming."),i;n("adapter.js shimming chrome."),i.browserShim=Fi,vo(e,r),mo(e),wi(e,r),Ii(e),Di(e,r),Li(e),Ni(e,r),Oi(e),Ai(e),ki(e),Pi(e,r),uo(e),po(e),lo(e,r),fo(e),ho(e,r);break;case"firefox":if(!zi||!Vi||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),i;n("adapter.js shimming firefox."),i.browserShim=zi,vo(e,r),mo(e),Ui(e,r),Vi(e,r),Zi(e),Wi(e),Gi(e),Bi(e),ji(e),Hi(e),Ki(e),qi(e),Yi(e),uo(e),po(e),lo(e,r),fo(e);break;case"safari":if(!oo||!t.shimSafari)return n("Safari shim is not included in this adapter release."),i;n("adapter.js shimming safari."),i.browserShim=oo,vo(e,r),mo(e),to(e),ro(e),$i(e),Xi(e),Ji(e),no(e),Qi(e),io(e),uo(e),lo(e,r),fo(e),ho(e,r);break;default:n("Unsupported browser!")}}({window:"undefined"==typeof window?void 0:window}),exports.MediaStreamTrackKind=void 0,(go=exports.MediaStreamTrackKind||(exports.MediaStreamTrackKind={})).Audio="audio",go.Video="video",function(e){e.IceGatheringStateChange="icegatheringstatechange",e.ConnectionStateChange="connectionstatechange"}(Eo||(Eo={}));var So,_o=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),r=t.call(this),Ar.log("PeerConnection init"),r.pc=function(e){return new RTCPeerConnection(e)}(e),r.connectionStateHandler=new pi((function(){return{connectionState:r.pc.connectionState,iceState:r.pc.iceConnectionState}})),r.connectionStateHandler.on(pi.Events.ConnectionStateChanged,(function(e){r.emit(n.Events.ConnectionStateChange,e)})),r.pc.oniceconnectionstatechange=function(){return r.connectionStateHandler.onIceConnectionStateChange()},r.pc.onconnectionstatechange=function(){return r.connectionStateHandler.onConnectionStateChange()},r.pc.onicegatheringstatechange=function(e){r.emit(n.Events.IceGatheringStateChange,e)},r}return(0,h.Z)(n,[{key:"getUnderlyingRTCPeerConnection",value:function(){return this.pc}},{key:"getConnectionState",value:function(){return this.connectionStateHandler.getConnectionState()}},{key:"addTrack",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(t=this.pc).addTrack.apply(t,[e].concat(r))}},{key:"addTransceiver",value:function(e,t){return this.pc.addTransceiver(e,t)}},{key:"removeTrack",value:function(e){this.pc.removeTrack(e)}},{key:"createDataChannel",value:function(e,t){return this.pc.createDataChannel(e,t)}},{key:"createAnswer",value:function(e){return br(this,void 0,void 0,E().mark((function t(){return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.pc.createAnswer(e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"createOffer",value:function(e){return br(this,void 0,void 0,E().mark((function t(){return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.pc.createOffer(e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"setLocalDescription",value:function(e){return br(this,void 0,void 0,E().mark((function t(){return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.pc.setLocalDescription(e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"setRemoteDescription",value:function(e){return br(this,void 0,void 0,E().mark((function t(){return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.pc.setRemoteDescription(e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"close",value:function(){this.pc.close()}},{key:"getLocalDescription",value:function(){return this.pc.localDescription}},{key:"getRemoteDescription",value:function(){return this.pc.remoteDescription}},{key:"getSenders",value:function(){return this.pc.getSenders()}},{key:"getTransceivers",value:function(){return this.pc.getTransceivers()}},{key:"getStats",value:function(e){return this.pc.getStats(e)}},{key:"iceGatheringState",get:function(){return this.pc.iceGatheringState}},{key:"getCurrentConnectionType",value:function(){var e;return br(this,void 0,void 0,E().mark((function t(){var n,r,i;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("connected"===this.pc.iceConnectionState||"completed"===this.pc.iceConnectionState){t.next=3;break}throw new Error("Ice connection is not established");case 3:return n=new(j()),r=[],t.next=7,this.pc.getStats();case 7:if(t.sent.forEach((function(e){var t;"candidate-pair"===e.type&&"succeeded"===(null===(t=e.state)||void 0===t?void 0:t.toLowerCase())&&n.add(e.localCandidateId),"local-candidate"===e.type&&r.push(e)})),i=r.find((function(e){return n.has(e.id)}))){t.next=11;break}return t.abrupt("return","unknown");case 11:if(!i.relayProtocol){t.next=13;break}return t.abrupt("return","TURN-".concat(i.relayProtocol.toUpperCase()));case 13:return t.abrupt("return",null===(e=i.protocol)||void 0===e?void 0:e.toUpperCase());case 14:case"end":return t.stop()}}),t,this)})))}}]),n}(ni);_o.Events=Eo,function(e){e.H264="video/H264",e.AV1="video/AV1",e.OPUS="audio/opus"}(So||(So={}));var Co;function Ro(e,t){return T()(t).every((function(n){if("clockRate"===n||"name"===n)return e[n]===t[n];if("fmtParams"===n){var r=e[n],i=t[n],o=(0,c.Z)(r.keys()).some((function(e){return"level-asymmetry-allowed"===e&&"1"===i.get(e)&&"1"===r.get(e)}));return(0,c.Z)(r.keys()).every((function(e){return i.get(e)&&"profile-level-id"===e?function(e,t,n){var r=fe()("0x".concat(e),16),i=fe()("0x".concat(t),16),o=r>>16,a=i>>16,s=(65280&r)>>8,c=(65280&i)>>8;return(o===a&&s===c||66===o&&66===a&&(64&s)==(64&c))&&(!!n||(255&r)<=(255&i))}(r.get(e),i.get(e),o):"packetization-mode"!==e||r.get(e)===i.get(e)}))}return!0}))}function To(e,t){return 0===t?e:To(t,e%t)}function xo(e,t){var n=To(e[0],e[1]),r=e[0]/n,i=e[1]/n;return Math.floor(Math.sqrt(16*t*16/(r*i)))*i}!function(e){e[e.NB=12e3]="NB",e[e.WB=2e4]="WB",e[e.FB=4e4]="FB",e[e.FB_MONO_MUSIC=64e3]="FB_MONO_MUSIC",e[e.FB_STEREO_MUSIC=128e3]="FB_STEREO_MUSIC"}(Co||(Co={}));var bo="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==Pe?Pe:"undefined"!=typeof self?self:{},wo={exports:{}};!function(e){!function(t){var n,r={};r.VERSION="1.6.1";var i={},o=function(e,t){return function(){return t.apply(e,arguments)}},a=function(){var e,t,n=arguments,r=n[0];for(t=1;t<n.length;t++)for(e in n[t])!(e in r)&&n[t].hasOwnProperty(e)&&(r[e]=n[t][e]);return r},s=function(e,t){return{value:e,name:t}};r.TRACE=s(1,"TRACE"),r.DEBUG=s(2,"DEBUG"),r.INFO=s(3,"INFO"),r.TIME=s(4,"TIME"),r.WARN=s(5,"WARN"),r.ERROR=s(8,"ERROR"),r.OFF=s(99,"OFF");var c=function(e){this.context=e,this.setLevel(e.filterLevel),this.log=this.info};c.prototype={setLevel:function(e){e&&"value"in e&&(this.context.filterLevel=e)},getLevel:function(){return this.context.filterLevel},enabledFor:function(e){var t=this.context.filterLevel;return e.value>=t.value},trace:function(){this.invoke(r.TRACE,arguments)},debug:function(){this.invoke(r.DEBUG,arguments)},info:function(){this.invoke(r.INFO,arguments)},warn:function(){this.invoke(r.WARN,arguments)},error:function(){this.invoke(r.ERROR,arguments)},time:function(e){"string"==typeof e&&e.length>0&&this.invoke(r.TIME,[e,"start"])},timeEnd:function(e){"string"==typeof e&&e.length>0&&this.invoke(r.TIME,[e,"end"])},invoke:function(e,t){n&&this.enabledFor(e)&&n(t,a({level:e},this.context))}};var u,d=new c({filterLevel:r.OFF});(u=r).enabledFor=o(d,d.enabledFor),u.trace=o(d,d.trace),u.debug=o(d,d.debug),u.time=o(d,d.time),u.timeEnd=o(d,d.timeEnd),u.info=o(d,d.info),u.warn=o(d,d.warn),u.error=o(d,d.error),u.log=u.info,r.setHandler=function(e){n=e},r.setLevel=function(e){for(var t in d.setLevel(e),i)i.hasOwnProperty(t)&&i[t].setLevel(e)},r.getLevel=function(){return d.getLevel()},r.get=function(e){return i[e]||(i[e]=new c(a({name:e},d.context)))},r.createDefaultHandler=function(e){(e=e||{}).formatter=e.formatter||function(e,t){t.name&&e.unshift("["+t.name+"]")};var t={},n=function(e,t){Function.prototype.apply.call(e,console,t)};return"undefined"==typeof console?function(){}:function(i,o){i=Array.prototype.slice.call(i);var a,s=console.log;o.level===r.TIME?(a=(o.name?"["+o.name+"] ":"")+i[0],"start"===i[1]?console.time?console.time(a):t[a]=(new Date).getTime():console.timeEnd?console.timeEnd(a):n(s,[a+": "+((new Date).getTime()-t[a])+"ms"])):(o.level===r.WARN&&console.warn?s=console.warn:o.level===r.ERROR&&console.error?s=console.error:o.level===r.INFO&&console.info?s=console.info:o.level===r.DEBUG&&console.debug?s=console.debug:o.level===r.TRACE&&console.trace&&(s=console.trace),e.formatter(i,o),n(s,i))}},r.useDefaults=function(e){r.setLevel(e&&e.defaultLevel||r.DEBUG),r.setHandler(r.createDefaultHandler(e))},r.setDefaults=r.useDefaults,e.exports?e.exports=r:(r._prevLogger=t.Logger,r.noConflict=function(){return t.Logger=r._prevLogger,r},t.Logger=r)}(bo)}(wo);var Io,Lo=wo.exports;Lo.useDefaults({defaultLevel:Lo.DEBUG,formatter:function(e,t){e.unshift("[".concat(t.name,"] "))}}),function(e){e.Multistream="multistream"}(Io||(Io={}));var Oo,Ao=function(){function e(t,n){(0,v.Z)(this,e),this.msgType=t,this.payload=n}return(0,h.Z)(e,null,[{key:"fromJson",value:function(t){return t.msgType&&t.payload?new e(t.msgType,t.payload):null}}]),e}();!function(e){e.Scr="scr",e.ScrAck="scrAck",e.ActiveSpeakerNotification="activeSpeakerNotification",e.SourceIndication="sourceIndication",e.SourceIndicationAck="sourceIndicationAck"}(Oo||(Oo={}));var ko=function(){function e(t,n,r){(0,v.Z)(this,e),this.mediaFamily=t,this.mediaContent=n,this.payload=r}return(0,h.Z)(e,[{key:"toString",value:function(){return"JmpMsg(mediaFamily=".concat(this.mediaFamily,", mediaContent=").concat(this.mediaContent,", payload=").concat(this.payload,")")}}]),e}();function Mo(e){var t=e;return Boolean(t.mediaContent&&t.mediaFamily&&t.payload&&function(e){var t=e;return Boolean(t.msgType&&t.payload)}(t.payload))}var No=function(){function e(t){(0,v.Z)(this,e),this.scrSeqNum=t}return(0,h.Z)(e,[{key:"toString",value:function(){return"JmpScrAckMsg(seqNum=".concat(this.scrSeqNum,")")}}]),e}();var Do=function(){function e(t,n){(0,v.Z)(this,e),this.seqNum=t,this.requests=n}return(0,h.Z)(e,[{key:"toString",value:function(){return"JmpScrMsg(seqNum=".concat(this.seqNum,", requests=[").concat(this.requests,"])")}}]),e}();var Po=function(){function e(t,n,r,i){(0,v.Z)(this,e);var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];this.policy=t,this.policySpecificInfo=n,this.ids=r,this.maxPayloadBitsPerSecond=i,this.codecInfos=o}return(0,h.Z)(e,[{key:"toString",value:function(){return"Request(policy=".concat(this.policy,", info=").concat(this.policySpecificInfo,", ids=[").concat(this.ids,"], maxPayloadBitsPerSecond=[").concat(this.maxPayloadBitsPerSecond,"], codecInfos=[").concat(this.codecInfos,"])")}}]),e}();function Fo(e){return Boolean(e.csi)}var Uo,Zo,Vo,Go,Bo=function(){function e(t){(0,v.Z)(this,e),this.sourceIndicationSeqNum=t}return(0,h.Z)(e,[{key:"toString",value:function(){return"SourceIndicationAckMsg(sourceIndicationSeqNum=".concat(this.sourceIndicationSeqNum,")")}}]),e}();function Wo(){return e=0,t=8388607,Math.floor(Math.random()*(t-e+1))+e;var e,t}function jo(e,t){return t<<8|(e===Uo.Audio?0:1)}function Ho(e,t){return e===Uo.Video&&t===Zo.Main?Go.VideoMain:e===Uo.Video&&t===Zo.Slides?Go.VideoSlides:e===Uo.Audio&&t===Zo.Main?Go.AudioMain:Go.AudioSlides}function Ko(e){return[Go.VideoMain,Go.VideoSlides].includes(e)?Uo.Video:Uo.Audio}function qo(e){return[Go.VideoMain,Go.AudioMain].includes(e)?Zo.Main:Zo.Slides}!function(e){e.Audio="AUDIO",e.Video="VIDEO"}(Uo||(Uo={})),function(e){e.Main="MAIN",e.Slides="SLIDES"}(Zo||(Zo={})),function(e){e.ActiveSpeaker="active-speaker",e.ReceiverSelected="receiver-selected"}(Vo||(Vo={})),function(e){e.VideoMain="VIDEO-MAIN",e.VideoSlides="VIDEO-SLIDES",e.AudioMain="AUDIO-MAIN",e.AudioSlides="AUDIO-SLIDES"}(Go||(Go={}));var Yo=function(e){return 0===e||e};function zo(e,t){var n=T()(e),r=T()(t);return n.length===r.length&&n.every((function(n){return e[n]===t[n]}))}var Xo=function(){function e(t,n,r,i){(0,v.Z)(this,e),this.seqNum=t,this.numTotalSources=n,this.numLiveSources=r,this.sources=i}return(0,h.Z)(e,[{key:"sourcesToString",value:function(){return this.sources.map((function(e){return"Source(id=".concat(e.id," state=").concat(e.state," ").concat(e.csi?"csi=".concat(e.csi):"",")")})).join(", ")}},{key:"toString",value:function(){return"SourceIndication(seqNum=".concat(this.seqNum," numTotalSources=").concat(this.numTotalSources," numLiveSources=").concat(this.numLiveSources," sources=[").concat(this.sourcesToString(),"])")}}]),e}();function Jo(e){var t=e;return Boolean(t.id&&function(e){var t=e;return(!t.mid||!t.ssrc)&&(Boolean(t.mid)||Boolean(t.ssrc))}(t.id)&&["no source","invalid source","live","avatar","bandwidth disabled"].includes(t.state))}var $o,Qo=function(){function e(t,n,r,i,o){(0,v.Z)(this,e),this.timerHandle=void 0,this.msg=t,this.numRetransmitsLeft=n,this.retransmitIntervalMs=r,this.transmitCallback=i,this.expirationCallback=o,this.scheduleTimer()}return(0,h.Z)(e,[{key:"onTimer",value:function(){var e;this.numRetransmitsLeft>0?(--this.numRetransmitsLeft,this.transmitCallback(this.msg),this.scheduleTimer()):null===(e=this.expirationCallback)||void 0===e||e.call(this,this.msg)}},{key:"scheduleTimer",value:function(){var e=this;this.timerHandle=window.setTimeout((function(){return e.onTimer()}),this.retransmitIntervalMs)}},{key:"cancel",value:function(){this.timerHandle&&clearTimeout(this.timerHandle),this.timerHandle=void 0}}]),e}();!function(e){e.SourceIndication="source-indication",e.ActiveSpeaker="active-speaker",e.ScrRequestReceived="scr-request-received"}($o||($o={}));var ea=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r){var i;(0,v.Z)(this,n);var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:250;return(i=t.call(this)).currScrSeqNum=1,i.currSourceIndicationSeqNum=1,i.txCallback=void 0,i.lastSentScr=void 0,i.lastSentScrAck=void 0,i.lastReceivedScr=void 0,i.mediaFamily=e,i.mediaContent=r,i.logger=Lo.get("JmpSession ".concat(i.mediaFamily,"-").concat(i.mediaContent)),i.maxNumRetransmits=o,i.retransmitIntervalMs=a,i}return(0,h.Z)(n,[{key:"getLogger",value:function(){return this.logger}},{key:"sendRequests",value:function(e){var t,n=this,r=new Do(this.currScrSeqNum++,e),i=new ko(this.mediaFamily,this.mediaContent,{msgType:Oo.Scr,payload:r});this.sendJmpMsg(i),null===(t=this.lastSentScr)||void 0===t||t.cancel(),this.lastSentScr=new Qo(r,this.maxNumRetransmits,this.retransmitIntervalMs,(function(e){return n.sendJmpScr(e)}),(function(e){n.logger.warn("Retransmits for message expired: ".concat(e))}))}},{key:"updateSourceIndication",value:function(e,t,n){var r,i=this,o=n.filter((function(e){var t;return null===(t=i.lastReceivedScr)||void 0===t?void 0:t.requests.some((function(t){return t.ids.find((function(t){return zo(t,e.id)}))}))})),a=new Xo(this.currSourceIndicationSeqNum++,e,t,o),s=new ko(this.mediaFamily,this.mediaContent,{msgType:Oo.SourceIndication,payload:a});this.sendJmpMsg(s),null===(r=this.lastSentSourceIndication)||void 0===r||r.cancel(),this.lastSentSourceIndication=new Qo(a,this.maxNumRetransmits,this.retransmitIntervalMs,(function(e){return i.sendSourceIndication(e)}),(function(e){i.logger.warn("Retransmits for message expired:",e)}))}},{key:"receive",value:function(e){var t,n,r,i,o,a,s,c;if(e.mediaContent===this.mediaContent&&e.mediaFamily===this.mediaFamily){this.logger.debug("Received JmpMsg",e);var u,d=e.payload;if(d.msgType===Oo.Scr){var l=d.payload;if(u=l,!Boolean(u.seqNum&&u.requests))return void this.logger.error("Received invalid SCR:",l);if(this.lastReceivedScr&&l.seqNum<(null===(t=this.lastReceivedScr)||void 0===t?void 0:t.seqNum))this.logger.info("Received old SCR, ignoring");else if(this.lastReceivedScr&&l.seqNum===this.lastReceivedScr.seqNum)this.lastSentScrAck?(this.logger.info("Received duplicate SCR, re-sending ACK"),this.sendJmpScrAck(this.lastSentScrAck)):this.logger.warn("Received duplicate SCR, but there was no ACK previously sent");else{this.logger.info("Received new SCR, sending ACK");var f=new No(l.seqNum);this.lastReceivedScr=l,this.lastSentScrAck=f,this.sendJmpScrAck(f),this.emit($o.ScrRequestReceived,l)}}else if(d.msgType===Oo.ScrAck){var p=d.payload;if(!function(e){return Boolean(e.scrSeqNum)}(p))return void this.logger.error("Received invalid SCR ACK:",p);p.scrSeqNum===(null===(r=null===(n=this.lastSentScr)||void 0===n?void 0:n.msg)||void 0===r?void 0:r.seqNum)?(this.logger.info("Received ACK for last sent SCR"),null===(i=this.lastSentScr)||void 0===i||i.cancel()):this.logger.info("Received ACK for old SCR")}else if(d.msgType===Oo.ActiveSpeakerNotification){var h=d.payload;if(!function(e){var t=e;return Boolean(t.seqNum&&t.csis)}(h))return void this.logger.info("Received invalid Active Speaker Notification:",h);this.logger.debug("Received Active Speaker Notification:",h),this.emit($o.ActiveSpeaker,h)}else if(d.msgType===Oo.SourceIndication){var v=d.payload;if(!function(e){var t,n=e;return Boolean(n.seqNum&&Yo(n.numTotalSources)&&Yo(n.numLiveSources)&&n.sources&&(null===(t=n.sources)||void 0===t?void 0:t.every((function(e){return Jo(e)}))))}(v))return void this.logger.error("Received invalid Source Indication:",v);if(this.lastReceivedSourceIndication&&v.seqNum<(null===(o=this.lastReceivedSourceIndication)||void 0===o?void 0:o.seqNum))this.logger.info("Received old Source Indication, ignoring");else if(this.lastReceivedSourceIndication&&v.seqNum===this.lastReceivedSourceIndication.seqNum)this.lastSentSourceIndicationAck?(this.logger.info("Received duplicate Source Indication, re-sending ACK"),this.sendSourceIndicationAck(this.lastSentSourceIndicationAck)):this.logger.warn("Received duplicate Source Indication, but there was no ACK previously sent");else{this.logger.info("Received new Source Indication, sending ACK");var m=new Bo(v.seqNum);this.lastReceivedSourceIndication=v,this.lastSentSourceIndicationAck=m,this.sendSourceIndicationAck(m),this.emit($o.SourceIndication,v)}}else if(d.msgType===Oo.SourceIndicationAck){var g=d.payload;if(!function(e){return Boolean(e.sourceIndicationSeqNum)}(g))return void this.logger.error("Received invalid SCR ACK:",g);g.sourceIndicationSeqNum===(null===(s=null===(a=this.lastSentSourceIndication)||void 0===a?void 0:a.msg)||void 0===s?void 0:s.seqNum)?(this.logger.info("Received ACK for last sent SCR"),null===(c=this.lastSentSourceIndication)||void 0===c||c.cancel()):this.logger.info("Received ACK for old SCR")}else this.logger.error("Received unknown JmpMsg")}else this.logger.error("JmpMsg ".concat(e," sent to incorrect JmpSession"))}},{key:"setTxCallback",value:function(e){this.txCallback=e}},{key:"close",value:function(){var e;this.logger.info("closing"),null===(e=this.lastSentScr)||void 0===e||e.cancel()}},{key:"sendSourceIndicationAck",value:function(e){var t=new ko(this.mediaFamily,this.mediaContent,{msgType:Oo.SourceIndicationAck,payload:e});this.sendJmpMsg(t)}},{key:"sendSourceIndication",value:function(e){var t=new ko(this.mediaFamily,this.mediaContent,{msgType:Oo.SourceIndication,payload:e});this.sendJmpMsg(t)}},{key:"sendJmpScrAck",value:function(e){var t=new ko(this.mediaFamily,this.mediaContent,{msgType:Oo.ScrAck,payload:e});this.sendJmpMsg(t)}},{key:"sendJmpScr",value:function(e){var t=new ko(this.mediaFamily,this.mediaContent,{msgType:Oo.Scr,payload:e});this.sendJmpMsg(t)}},{key:"sendJmpMsg",value:function(e){var t,n=new Ao(Io.Multistream,e);null===(t=this.txCallback)||void 0===t||t.call(this,B()(n))}}]),n}(_t),ta=function(){function e(t,n,r,i){(0,v.Z)(this,e);var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];this.policy=t,this.policySpecificInfo=n,this.receiveSlots=r,this.maxPayloadBitsPerSecond=i,this.codecInfos=o}return(0,h.Z)(e,[{key:"_toJmpScrRequest",value:function(){return new Po(this.policy,this.policySpecificInfo,this.receiveSlots.map((function(e){return e.id})),this.maxPayloadBitsPerSecond,this.codecInfos)}}]),e}();function na(e,t,n,r){return new(n||(n=ne()))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}var ra,ia="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==Pe?Pe:"undefined"!=typeof self?self:{};function oa(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function aa(e){if(e.__esModule)return e;var t=S()({},"__esModule",{value:!0});return T()(e).forEach((function(n){var r=b()(e,n);S()(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})})),t}var sa=new Uint8Array(16);function ca(){if(!ra&&!(ra="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ra(sa)}var ua=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function da(e){return"string"==typeof e&&ua.test(e)}for(var la,fa,pa=[],ha=0;ha<256;++ha)pa.push((ha+256).toString(16).substr(1));function va(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(pa[e[t+0]]+pa[e[t+1]]+pa[e[t+2]]+pa[e[t+3]]+"-"+pa[e[t+4]]+pa[e[t+5]]+"-"+pa[e[t+6]]+pa[e[t+7]]+"-"+pa[e[t+8]]+pa[e[t+9]]+"-"+pa[e[t+10]]+pa[e[t+11]]+pa[e[t+12]]+pa[e[t+13]]+pa[e[t+14]]+pa[e[t+15]]).toLowerCase();if(!da(n))throw TypeError("Stringified UUID is invalid");return n}var ma=0,ga=0;function Ea(e){if(!da(e))throw TypeError("Invalid UUID");var t,n=new Uint8Array(16);return n[0]=(t=k()(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=k()(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=k()(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=k()(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=k()(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n}var ya="6ba7b810-9dad-11d1-80b4-00c04fd430c8",Sa="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function _a(e,t,n){function r(e,r,i,o){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof r&&(r=Ea(r)),16!==r.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var a=new Uint8Array(16+e.length);if(a.set(r),a.set(e,r.length),(a=n(a))[6]=15&a[6]|t,a[8]=63&a[8]|128,i){o=o||0;for(var s=0;s<16;++s)i[o+s]=a[s];return i}return va(a)}try{r.name=e}catch(e){}return r.DNS=ya,r.URL=Sa,r}function Ca(e){return 14+(e+64>>>9<<4)+1}function Ra(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function Ta(e,t,n,r,i,o){return Ra((a=Ra(Ra(t,e),Ra(r,o)))<<(s=i)|a>>>32-s,n);var a,s}function xa(e,t,n,r,i,o,a){return Ta(t&n|~t&r,e,t,i,o,a)}function ba(e,t,n,r,i,o,a){return Ta(t&r|n&~r,e,t,i,o,a)}function wa(e,t,n,r,i,o,a){return Ta(t^n^r,e,t,i,o,a)}function Ia(e,t,n,r,i,o,a){return Ta(n^(t|~r),e,t,i,o,a)}var La=_a("v3",48,(function(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return function(e){for(var t=[],n=32*e.length,r="0123456789abcdef",i=0;i<n;i+=8){var o=e[i>>5]>>>i%32&255,a=k()(r.charAt(o>>>4&15)+r.charAt(15&o),16);t.push(a)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[Ca(t)-1]=t;for(var n=1732584193,r=-271733879,i=-1732584194,o=271733878,a=0;a<e.length;a+=16){var s=n,c=r,u=i,d=o;n=xa(n,r,i,o,e[a],7,-680876936),o=xa(o,n,r,i,e[a+1],12,-389564586),i=xa(i,o,n,r,e[a+2],17,606105819),r=xa(r,i,o,n,e[a+3],22,-1044525330),n=xa(n,r,i,o,e[a+4],7,-176418897),o=xa(o,n,r,i,e[a+5],12,1200080426),i=xa(i,o,n,r,e[a+6],17,-1473231341),r=xa(r,i,o,n,e[a+7],22,-45705983),n=xa(n,r,i,o,e[a+8],7,1770035416),o=xa(o,n,r,i,e[a+9],12,-1958414417),i=xa(i,o,n,r,e[a+10],17,-42063),r=xa(r,i,o,n,e[a+11],22,-1990404162),n=xa(n,r,i,o,e[a+12],7,1804603682),o=xa(o,n,r,i,e[a+13],12,-40341101),i=xa(i,o,n,r,e[a+14],17,-1502002290),n=ba(n,r=xa(r,i,o,n,e[a+15],22,1236535329),i,o,e[a+1],5,-165796510),o=ba(o,n,r,i,e[a+6],9,-1069501632),i=ba(i,o,n,r,e[a+11],14,643717713),r=ba(r,i,o,n,e[a],20,-373897302),n=ba(n,r,i,o,e[a+5],5,-701558691),o=ba(o,n,r,i,e[a+10],9,38016083),i=ba(i,o,n,r,e[a+15],14,-660478335),r=ba(r,i,o,n,e[a+4],20,-405537848),n=ba(n,r,i,o,e[a+9],5,568446438),o=ba(o,n,r,i,e[a+14],9,-1019803690),i=ba(i,o,n,r,e[a+3],14,-187363961),r=ba(r,i,o,n,e[a+8],20,1163531501),n=ba(n,r,i,o,e[a+13],5,-1444681467),o=ba(o,n,r,i,e[a+2],9,-51403784),i=ba(i,o,n,r,e[a+7],14,1735328473),n=wa(n,r=ba(r,i,o,n,e[a+12],20,-1926607734),i,o,e[a+5],4,-378558),o=wa(o,n,r,i,e[a+8],11,-2022574463),i=wa(i,o,n,r,e[a+11],16,1839030562),r=wa(r,i,o,n,e[a+14],23,-35309556),n=wa(n,r,i,o,e[a+1],4,-1530992060),o=wa(o,n,r,i,e[a+4],11,1272893353),i=wa(i,o,n,r,e[a+7],16,-155497632),r=wa(r,i,o,n,e[a+10],23,-1094730640),n=wa(n,r,i,o,e[a+13],4,681279174),o=wa(o,n,r,i,e[a],11,-358537222),i=wa(i,o,n,r,e[a+3],16,-722521979),r=wa(r,i,o,n,e[a+6],23,76029189),n=wa(n,r,i,o,e[a+9],4,-640364487),o=wa(o,n,r,i,e[a+12],11,-421815835),i=wa(i,o,n,r,e[a+15],16,530742520),n=Ia(n,r=wa(r,i,o,n,e[a+2],23,-995338651),i,o,e[a],6,-198630844),o=Ia(o,n,r,i,e[a+7],10,1126891415),i=Ia(i,o,n,r,e[a+14],15,-1416354905),r=Ia(r,i,o,n,e[a+5],21,-57434055),n=Ia(n,r,i,o,e[a+12],6,1700485571),o=Ia(o,n,r,i,e[a+3],10,-1894986606),i=Ia(i,o,n,r,e[a+10],15,-1051523),r=Ia(r,i,o,n,e[a+1],21,-2054922799),n=Ia(n,r,i,o,e[a+8],6,1873313359),o=Ia(o,n,r,i,e[a+15],10,-30611744),i=Ia(i,o,n,r,e[a+6],15,-1560198380),r=Ia(r,i,o,n,e[a+13],21,1309151649),n=Ia(n,r,i,o,e[a+4],6,-145523070),o=Ia(o,n,r,i,e[a+11],10,-1120210379),i=Ia(i,o,n,r,e[a+2],15,718787259),r=Ia(r,i,o,n,e[a+9],21,-343485551),n=Ra(n,s),r=Ra(r,c),i=Ra(i,u),o=Ra(o,d)}return[n,r,i,o]}(function(e){if(0===e.length)return[];for(var t=8*e.length,n=new Uint32Array(Ca(t)),r=0;r<t;r+=8)n[r>>5]|=(255&e[r/8])<<r%32;return n}(e),8*e.length))})),Oa=La;function Aa(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:case 3:return t^n^r;case 2:return t&n^t&r^n&r}}function ka(e,t){return e<<t|e>>>32-t}var Ma=_a("v5",80,(function(e){var t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var r=unescape(encodeURIComponent(e));e=[];for(var i=0;i<r.length;++i)e.push(r.charCodeAt(i))}else C()(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var o=e.length/4+2,a=Math.ceil(o/16),s=new Array(a),c=0;c<a;++c){for(var u=new Uint32Array(16),d=0;d<16;++d)u[d]=e[64*c+4*d]<<24|e[64*c+4*d+1]<<16|e[64*c+4*d+2]<<8|e[64*c+4*d+3];s[c]=u}s[a-1][14]=8*(e.length-1)/Math.pow(2,32),s[a-1][14]=Math.floor(s[a-1][14]),s[a-1][15]=8*(e.length-1)&4294967295;for(var l=0;l<a;++l){for(var f=new Uint32Array(80),p=0;p<16;++p)f[p]=s[l][p];for(var h=16;h<80;++h)f[h]=ka(f[h-3]^f[h-8]^f[h-14]^f[h-16],1);for(var v=n[0],m=n[1],g=n[2],E=n[3],y=n[4],S=0;S<80;++S){var _=Math.floor(S/20),R=ka(v,5)+Aa(_,m,g,E)+y+t[_]+f[S]>>>0;y=E,E=g,g=ka(m,30)>>>0,m=v,v=R}n[0]=n[0]+v>>>0,n[1]=n[1]+m>>>0,n[2]=n[2]+g>>>0,n[3]=n[3]+E>>>0,n[4]=n[4]+y>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]})),Na=Ma;var Da=I()({__proto__:null,v1:function(e,t,n){var r=t&&n||0,i=t||new Array(16),o=(e=e||{}).node||la,a=void 0!==e.clockseq?e.clockseq:fa;if(null==o||null==a){var s=e.random||(e.rng||ca)();null==o&&(o=la=[1|s[0],s[1],s[2],s[3],s[4],s[5]]),null==a&&(a=fa=16383&(s[6]<<8|s[7]))}var c=void 0!==e.msecs?e.msecs:he()(),u=void 0!==e.nsecs?e.nsecs:ga+1,d=c-ma+(u-ga)/1e4;if(d<0&&void 0===e.clockseq&&(a=a+1&16383),(d<0||c>ma)&&void 0===e.nsecs&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");ma=c,ga=u,fa=a;var l=(1e4*(268435455&(c+=122192928e5))+u)%4294967296;i[r++]=l>>>24&255,i[r++]=l>>>16&255,i[r++]=l>>>8&255,i[r++]=255&l;var f=c/4294967296*1e4&268435455;i[r++]=f>>>8&255,i[r++]=255&f,i[r++]=f>>>24&15|16,i[r++]=f>>>16&255,i[r++]=a>>>8|128,i[r++]=255&a;for(var p=0;p<6;++p)i[r+p]=o[p];return t||va(i)},v3:Oa,v4:function(e,t,n){var r=(e=e||{}).random||(e.rng||ca)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return va(r)},v5:Na,NIL:"00000000-0000-0000-0000-000000000000",version:function(e){if(!da(e))throw TypeError("Invalid UUID");return k()(e.substr(14,1),16)},validate:da,stringify:va,parse:Ea}),Pa=void 0,Fa=aa(Da),Ua=function(e){return JSON.parse(B()(e))},Za=function e(t,n){if(t===n)return!0;if(t&&n&&"object"===(0,m.Z)(t)&&"object"===(0,m.Z)(n)){if(t.constructor!==n.constructor)return!1;if(T()(t).length!==T()(n).length)return!1;for(var r in t){if(!n.hasOwnProperty(r))return!1;if(!e(t[r],n[r]))return!1}return!0}return!1},Va=["type","id","timestamp"],Ga=function(e,t){var n=Ua(t);T()(n).forEach((function(t){var r=n[t];e[t]&&T()(r).forEach((function(i){Za(r[i],e[t][i])&&!Va.includes(i)&&delete n[t][i],function(e){return!!T()(e).filter((function(e){return!Va.includes(e)})).length}(r)||delete n[t]}))}));var r=-1/0;return T()(n).forEach((function(e){var t=n[e];t.timestamp>r&&(r=t.timestamp)})),T()(n).forEach((function(e){var t=n[e];t.timestamp===r&&delete t.timestamp})),n.timestamp=r,n},Ba=function(e){return[{value:e,type:"string",id:""}]};Pa=function(e,t,n,r,i){void 0===r&&(r=(0,Fa.v4)()),void 0===i&&(i=function(){return ne().resolve()});var o={},a=function(e,n,i){t({id:r,timestamp:i?Math.round(i):he()(),name:e,payload:n})};e.addEventListener("icecandidate",(function(e){e.candidate&&a("onicecandidate",Ba(B()(e.candidate)))})),e.addEventListener("icecandidateerror",(function(e){var t=e,n=t.errorCode,r=t.errorText;a("onicecandidateerror",Ba("".concat(n,": ").concat(r)))})),e.addEventListener("track",(function(e){a("ontrack",Ba("".concat(e.track.kind,":").concat(e.track.id," ").concat(e.streams.map((function(e){return"stream:".concat(e.id)})).join(" "))))})),e.addEventListener("signalingstatechange",(function(){a("onsignalingstatechange",Ba(e.signalingState))})),e.addEventListener("iceconnectionstatechange",(function(){a("oniceconnectionstatechange",Ba(e.iceConnectionState))})),e.addEventListener("icegatheringstatechange",(function(){a("onicegatheringstatechange",Ba(e.iceGatheringState))})),e.addEventListener("connectionstatechange",(function(){a("onconnectionstatechange",Ba(e.connectionState))})),e.addEventListener("negotiationneeded",(function(){a("onnegotiationneeded",Ba("negotiationneeded"))})),e.addEventListener("datachannel",(function(e){a("ondatachannel",Ba("".concat(e.channel.id,": ").concat(e.channel.label)))}));var s=window.setInterval((function(){"closed"!==e.signalingState?e.getStats(null).then((function(e){var t=function(e){if(!e.size)return e;var t={};return e.forEach((function(e,n){t[n]=e})),t}(e);i(t).then((function(){var e,n=Ua(t),r=Ga(o,t);a("stats-report",(e=r,T()(e).filter((function(e){return"timestamp"!==e})).map((function(t){return e[t]}))),r.timestamp!==-1/0?r.timestamp:void 0),o=n}))})):window.clearInterval(s)}),n)};var Wa,ja="\\d+",Ha="[!#$%&'*+\\-.^_`{|}~a-zA-Z0-9]+",Ka="\\S+",qa=".+",Ya=(0,h.Z)((function e(){(0,v.Z)(this,e)})),za=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r){var i;return(0,v.Z)(this,n),(i=t.call(this)).bandwidthType=e,i.bandwidth=r,i}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"b=".concat(this.bandwidthType,":").concat(this.bandwidth)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(t[1],k()(t[2],10))}}}]),n}(Ya);Wa=za,za.BW_TYPE_REGEX="CT|AS|TIAS",za.regex=new RegExp("^(".concat(Wa.BW_TYPE_REGEX,"):(").concat(ja,")"));var Xa,Ja=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).mids=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=group:BUNDLE ".concat(this.mids.join(" "))}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n(e.match(n.regex)[1].split(" "))}}]),n}(Ya);Ja.regex=new RegExp("^group:BUNDLE (".concat(qa,")"));var $a=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r,i,o,a,s,c,u,d,l){var f;return(0,v.Z)(this,n),(f=t.call(this)).foundation=e,f.componentId=r,f.transport=i,f.priority=o,f.connectionAddress=a,f.port=s,f.candidateType=c,f.relAddr=u,f.relPort=d,f.candidateExtensions=l,f}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){var e="";return e+="a=candidate:".concat(this.foundation," ").concat(this.componentId," ").concat(this.transport," ").concat(this.priority," ").concat(this.connectionAddress," ").concat(this.port," typ ").concat(this.candidateType),this.relAddr&&(e+=" raddr ".concat(this.relAddr)),this.relPort&&(e+=" rport ".concat(this.relPort)),this.candidateExtensions&&(e+=" ".concat(this.candidateExtensions)),e}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(t[1],k()(t[2],10),t[3],k()(t[4],10),t[5],k()(t[6],10),t[7],t[8],t[9]?k()(t[9],10):void 0,t[10])}}}]),n}(Ya);Xa=$a,$a.ICE_CHARS="[a-zA-Z0-9+/]+",$a.regex=new RegExp("^candidate:(".concat(Xa.ICE_CHARS,") (").concat(ja,") (").concat(Ka,") (").concat(ja,") (").concat(Ka,") (").concat(ja,") typ (").concat(Ka,")(?: raddr (").concat(Ka,"))?(?: rport (").concat(ja,"))?(?: (").concat(qa,"))?"));var Qa=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r,i){var o;return(0,v.Z)(this,n),(o=t.call(this)).netType=e,o.addrType=r,o.ipAddr=i,o}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"c=".concat(this.netType," ").concat(this.addrType," ").concat(this.ipAddr)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(t[1],t[2],t[3])}}}]),n}(Ya);Qa.regex=new RegExp("^(".concat(Ka,") (").concat(Ka,") (").concat(Ka,")"));var es=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).values=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=content:".concat(this.values.join(","))}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n(e.match(n.regex)[1].split(","))}}]),n}(Ya);es.regex=new RegExp("^content:(".concat(qa,")$"));var ts,ns=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).direction=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=".concat(this.direction)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n(e.match(n.regex)[1])}}]),n}(Ya);ns.regex=/^(sendrecv|sendonly|recvonly|inactive)$/;var rs=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r,i,o){var a;return(0,v.Z)(this,n),(a=t.call(this)).id=e,a.uri=r,a.direction=i,a.extensionAttributes=o,a}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){var e="";return e+="a=extmap:".concat(this.id),this.direction&&(e+="/".concat(this.direction)),e+=" ".concat(this.uri),this.extensionAttributes&&(e+=" ".concat(this.extensionAttributes)),e}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex),r=k()(t[1],10),i=t[2];return new n(r,t[3],i,t[4])}}}]),n}(Ya);ts=rs,rs.EXTMAP_DIRECTION="sendonly|recvonly|sendrecv|inactive",rs.regex=new RegExp("^extmap:(".concat(ja,")(?:/(").concat(ts.EXTMAP_DIRECTION,"))? (").concat(Ka,")(?: (").concat(qa,"))?"));var is=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).fingerprint=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=fingerprint:".concat(this.fingerprint)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n(e.match(n.regex)[1])}}]),n}(Ya);is.regex=new RegExp("^fingerprint:(".concat(qa,")"));var os=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r){var i;return(0,v.Z)(this,n),(i=t.call(this)).payloadType=e,i.params=r,i}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){var e=this,t=ee()(this.params.keys()).map((function(t){return void 0!==e.params.get(t)?"".concat(t,"=").concat(e.params.get(t)):"".concat(t)})).join(";");return"a=fmtp:".concat(this.payloadType," ").concat(t)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(k()(t[1],10),function(e){e=e.replace(/^a=fmtp:\d+\x20/,"");var t=new($());return/^\d+([/-]\d+)+$/.test(e)?(t.set(e,void 0),t):(e.split(";").forEach((function(n){var r=n&&n.split("=");if(2!==r.length||!r[0]||!r[1])throw new Error("Fmtp params is invalid with ".concat(e));t.set(r[0],r[1])})),t)}(t[2]))}}}]),n}(Ya);os.regex=new RegExp("^fmtp:(".concat(ja,") (").concat(qa,")"));var as=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).options=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=ice-options:".concat(this.options.join(" "))}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n(e.match(n.regex)[1].split(" "))}}]),n}(Ya);as.regex=new RegExp("^ice-options:(".concat(qa,")$"));var ss=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).pwd=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=ice-pwd:".concat(this.pwd)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n(e.match(n.regex)[1])}}]),n}(Ya);ss.regex=new RegExp("^ice-pwd:(".concat(Ka,")$"));var cs=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).ufrag=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=ice-ufrag:".concat(this.ufrag)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n(e.match(n.regex)[1])}}]),n}(Ya);cs.regex=new RegExp("^ice-ufrag:(".concat(Ka,")$"));var us,ds=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).maxMessageSize=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=max-message-size:".concat(this.maxMessageSize)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(k()(t[1],10))}}}]),n}(Ya);ds.regex=new RegExp("^max-message-size:(".concat(ja,")"));var ls=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r,i,o){var a;return(0,v.Z)(this,n),(a=t.call(this)).type=e,a.port=r,a.protocol=i,a.formats=o,a}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"m=".concat(this.type," ").concat(this.port," ").concat(this.protocol," ").concat(this.formats.join(" "))}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(t[1],k()(t[2],10),t[3],t[4].split(" "))}}}]),n}(Ya);us=ls,ls.MEDIA_TYPE="audio|video|application",ls.regex=new RegExp("^(".concat(us.MEDIA_TYPE,") (").concat(ja,") (").concat(Ka,") (").concat(qa,")"));var fs=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).mid=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=mid:".concat(this.mid)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n(e.match(n.regex)[1])}}]),n}(Ya);fs.regex=new RegExp("^mid:(".concat(Ka,")$"));var ps,hs=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r,i,o,a,s){var c;return(0,v.Z)(this,n),(c=t.call(this)).username=e,c.sessionId=r,c.sessionVersion=i,c.netType=o,c.addrType=a,c.ipAddr=s,c}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"o=".concat(this.username," ").concat(this.sessionId," ").concat(this.sessionVersion," ").concat(this.netType," ").concat(this.addrType," ").concat(this.ipAddr)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(t[1],t[2],k()(t[3],10),t[4],t[5],t[6])}}}]),n}(Ya);hs.regex=new RegExp("^(".concat(Ka,") (").concat(Ka,") (").concat(ja,") (").concat(Ka,") (").concat(Ka,") (").concat(Ka,")"));var vs=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r,i){var o;return(0,v.Z)(this,n),(o=t.call(this)).id=e,o.direction=r,o.params=i,o}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){var e="";return e+="a=rid:".concat(this.id," ").concat(this.direction),this.params&&(e+=" ".concat(this.params)),e}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(t[1],t[2],t[3])}}}]),n}(Ya);ps=vs,vs.RID_ID="[\\w-]+",vs.RID_DIRECTION="\\bsend\\b|\\brecv\\b",vs.regex=new RegExp("^rid:(".concat(ps.RID_ID,") (").concat(ps.RID_DIRECTION,")(?:").concat("\\s","(").concat(qa,"))?"));var ms=function(e){(0,l.Z)(n,e);var t=xe(n);function n(){return(0,v.Z)(this,n),t.apply(this,arguments)}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=rtcp-mux"}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n}}]),n}(Ya);ms.regex=/^rtcp-mux$/;var gs,Es=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r){var i;return(0,v.Z)(this,n),(i=t.call(this)).payloadType=e,i.feedback=r,i}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=rtcp-fb:".concat(this.payloadType," ").concat(this.feedback)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(k()(t[1],10),t[2])}}}]),n}(Ya);Es.regex=new RegExp("^rtcp-fb:(".concat(ja,") (").concat(qa,")"));var ys=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r,i,o){var a;return(0,v.Z)(this,n),(a=t.call(this)).payloadType=e,a.encodingName=r,a.clockRate=i,a.encodingParams=o,a}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){var e="";return e+="a=rtpmap:".concat(this.payloadType," ").concat(this.encodingName,"/").concat(this.clockRate),this.encodingParams&&(e+="/".concat(this.encodingParams)),e}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(k()(t[1],10),t[2],k()(t[3],10),t[4])}}}]),n}(Ya);gs=ys,ys.NON_SLASH_TOKEN="[^\\s/]+",ys.regex=new RegExp("^rtpmap:(".concat(ja,") (").concat(gs.NON_SLASH_TOKEN,")/(").concat(gs.NON_SLASH_TOKEN,")(?:/(").concat(gs.NON_SLASH_TOKEN,"))?"));var Ss=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).port=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=sctp-port:".concat(this.port)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(k()(t[1],10))}}}]),n}(Ya);Ss.regex=new RegExp("^sctp-port:(".concat(ja,")"));var _s=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).info=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"i=".concat(this.info)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n(e.match(n.regex)[1])}}]),n}(Ya);_s.regex=new RegExp("(".concat(qa,")"));var Cs=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).name=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"s=".concat(this.name)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n(e.match(n.regex)[1])}}]),n}(Ya);Cs.regex=new RegExp("^(".concat(qa,")"));var Rs=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).setup=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=setup:".concat(this.setup)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n(e.match(n.regex)[1])}}]),n}(Ya);Rs.regex=/^setup:(actpass|active|passive)$/;var Ts=function(){function e(t,n){(0,v.Z)(this,e),this.id=t,this.paused=n}return(0,h.Z)(e,[{key:"toString",value:function(){return this.paused?"~".concat(this.id):this.id}}]),e}(),xs=function(){function e(){(0,v.Z)(this,e),this.layers=[]}return(0,h.Z)(e,[{key:"addLayer",value:function(e){this.layers.push([e])}},{key:"addLayerWithAlternatives",value:function(e){this.layers.push(e)}},{key:"length",get:function(){return this.layers.length}},{key:"get",value:function(e){return this.layers[e]}},{key:"toString",value:function(){return this.layers.map((function(e){return e.map((function(e){return e.toString()})).join(",")})).join(";")}}],[{key:"fromString",value:function(t){var n=new e,r=t.split(";");if(1===r.length&&!r[0].trim())throw new Error("simulcast stream list empty");return r.forEach((function(e){if(!e)throw new Error("simulcast layer list empty");var t=e.split(","),r=[];t.forEach((function(e){if(!e||"~"===e)throw new Error("rid empty");var t="~"===e[0],n=t?e.substring(1):e;r.push(new Ts(n,t))})),n.addLayerWithAlternatives(r)})),n}}]),e}(),bs=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r){var i;return(0,v.Z)(this,n),(i=t.call(this)).sendLayers=e,i.recvLayers=r,i}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){var e="a=simulcast:";return this.sendLayers.length&&(e+="send ".concat(this.sendLayers.toString()),this.recvLayers.length&&(e+=" ")),this.recvLayers.length&&(e+="recv ".concat(this.recvLayers.toString())),e}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t,r,i=e.match(n.regex),o=i[3]&&i[4],a=i[1],s=xs.fromString(i[2]),c=new xs;if(o){if(a===i[3])return;c=xs.fromString(i[4])}return"send"===a?(t=s,r=c):(t=c,r=s),new n(t,r)}}}]),n}(Ya);bs.regex=new RegExp("^simulcast:(send|recv) (".concat(Ka,")(?: (send|recv) (").concat(Ka,"))?"));var ws=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r){var i;(0,v.Z)(this,n);var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;return(i=t.call(this)).ssrcId=e,i.attribute=r,i.attributeValue=o,i.attributeData=a,i}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){var e="a=ssrc:".concat(this.ssrcId," ").concat(this.attribute);return this.attributeValue&&(e+=":".concat(this.attributeValue)),this.attributeData&&(e+=" ".concat(this.attributeData)),e}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(k()(t[1],10),t[2],t[3],t[4])}}}]),n}(Ya);ws.regex=new RegExp("^ssrc:(".concat(ja,") (").concat(Ha,")(?::(").concat(Ha,")?(?: (").concat(Ka,"))?)?$"));var Is=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r){var i;return(0,v.Z)(this,n),(i=t.call(this)).semantics=e,i.ssrcs=r,i}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=ssrc-group:".concat(this.semantics," ").concat(this.ssrcs.join(" "))}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(t[1],t[2].split(" ").map((function(e){return k()(e,10)})))}}}]),n}(Ya);Is.regex=new RegExp("^ssrc-group:(SIM|FID|FEC) ((?:".concat(ja).concat("\\s","*)+)"));var Ls=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r){var i;return(0,v.Z)(this,n),(i=t.call(this)).startTime=e,i.stopTime=r,i}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"t=".concat(this.startTime," ").concat(this.stopTime)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(k()(t[1],10),k()(t[2],10))}}}]),n}(Ya);Ls.regex=new RegExp("^(".concat(ja,") (").concat(ja,")"));var Os=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).version=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"v=".concat(this.version)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(k()(t[1],10))}}}]),n}(Ya);Os.regex=new RegExp("^(".concat(ja,")$"));var As=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).value=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"".concat(this.value)}}],[{key:"fromSdpLine",value:function(e){return new n(e.match(n.regex)[1])}}]),n}(Ya);As.regex=new RegExp("(".concat(qa,")"));var ks=function(){function e(){(0,v.Z)(this,e),this.candidates=[]}return(0,h.Z)(e,[{key:"addLine",value:function(e){return e instanceof cs?(this.ufrag=e,!0):e instanceof ss?(this.pwd=e,!0):e instanceof as?(this.options=e,!0):e instanceof $a&&(this.candidates.push(e),!0)}},{key:"toLines",value:function(){var e=[];return this.ufrag&&e.push(this.ufrag),this.pwd&&e.push(this.pwd),this.options&&e.push(this.options),this.candidates.forEach((function(t){return e.push(t)})),e}}]),e}(),Ms=function(){function e(t,n,r){(0,v.Z)(this,e),this.iceInfo=new ks,this.otherLines=[],this.type=t,this.port=n,this.protocol=r}return(0,h.Z)(e,[{key:"findOtherLine",value:function(e){return this.otherLines.find((function(t){return t instanceof e}))}},{key:"addLine",value:function(e){if(e instanceof Ja)throw new Error("Error: bundle group line not allowed in media description");return e instanceof za?(this.bandwidth=e,!0):e instanceof fs?(this.mid=e.mid,!0):e instanceof is?(this.fingerprint=e.fingerprint,!0):e instanceof Rs?(this.setup=e.setup,!0):e instanceof Qa?(this.connection=e,!0):e instanceof es?(this.content=e,!0):this.iceInfo.addLine(e)}}]),e}(),Ns=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this,e.type,e.port,e.protocol)).fmts=[],r.fmts=e.formats,r}return(0,h.Z)(n,[{key:"toLines",value:function(){var e=[];return e.push(new ls(this.type,this.port,this.protocol,this.fmts)),this.connection&&e.push(this.connection),this.bandwidth&&e.push(this.bandwidth),e.push.apply(e,(0,c.Z)(this.iceInfo.toLines())),this.fingerprint&&e.push(new is(this.fingerprint)),this.setup&&e.push(new Rs(this.setup)),this.mid&&e.push(new fs(this.mid)),this.content&&e.push(this.content),this.sctpPort&&e.push(new Ss(this.sctpPort)),this.maxMessageSize&&e.push(new ds(this.maxMessageSize)),e.push.apply(e,(0,c.Z)(this.otherLines)),e}},{key:"addLine",value:function(e){if((0,a.Z)((0,p.Z)(n.prototype),"addLine",this).call(this,e))return!0;if(e instanceof ls)throw new Error("Error: tried passing a MediaLine to an existing MediaInfo");return e instanceof Ss?(this.sctpPort=e.port,!0):e instanceof ds?(this.maxMessageSize=e.maxMessageSize,!0):(this.otherLines.push(e),!0)}}]),n}(Ms),Ds=function(){function e(t){(0,v.Z)(this,e),this.fmtParams=new($()),this.feedback=[],this.pt=t}return(0,h.Z)(e,[{key:"addLine",value:function(e){if(e instanceof ys)return this.name=e.encodingName,this.clockRate=e.clockRate,this.encodingParams=e.encodingParams,!0;if(e instanceof os){if(this.fmtParams=new($())([].concat((0,c.Z)(ee()(this.fmtParams.entries())),(0,c.Z)(ee()(e.params.entries())))),e.params.has("apt")){var t=e.params.get("apt");this.primaryCodecPt=k()(t,10)}return!0}return e instanceof Es&&(this.feedback.push(e.feedback),!0)}},{key:"toLines",value:function(){var e=this,t=[];return t.push(new ys(this.pt,this.name,this.clockRate,this.encodingParams)),this.feedback.forEach((function(n){t.push(new Es(e.pt,n))})),this.fmtParams.size>0&&t.push(new os(this.pt,this.fmtParams)),t}}]),e}(),Ps=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this,e.type,e.port,e.protocol)).pts=[],r.extMaps=[],r.rids=[],r.codecs=new($()),r.rtcpMux=!1,r.ssrcs=[],r.ssrcGroups=[],r.pts=e.formats.map((function(e){return k()(e,10)})),r.pts.forEach((function(e){return r.codecs.set(e,new Ds(e))})),r}return(0,h.Z)(n,[{key:"toLines",value:function(){var e=[];return e.push(new ls(this.type,this.port,this.protocol,this.pts.map((function(e){return"".concat(e)})))),this.connection&&e.push(this.connection),this.bandwidth&&e.push(this.bandwidth),e.push.apply(e,(0,c.Z)(this.iceInfo.toLines())),this.fingerprint&&e.push(new is(this.fingerprint)),this.setup&&e.push(new Rs(this.setup)),this.mid&&e.push(new fs(this.mid)),this.rtcpMux&&e.push(new ms),this.content&&e.push(this.content),this.extMaps.forEach((function(t){return e.push(t)})),this.rids.forEach((function(t){return e.push(t)})),this.simulcast&&e.push(this.simulcast),this.direction&&e.push(new ns(this.direction)),this.codecs.forEach((function(t){return e.push.apply(e,(0,c.Z)(t.toLines()))})),e.push.apply(e,(0,c.Z)(this.ssrcs)),e.push.apply(e,(0,c.Z)(this.ssrcGroups)),e.push.apply(e,(0,c.Z)(this.otherLines)),e}},{key:"addLine",value:function(e){if((0,a.Z)((0,p.Z)(n.prototype),"addLine",this).call(this,e))return!0;if(e instanceof ls)throw new Error("Error: tried passing a MediaLine to an existing MediaInfo");if(e instanceof ns)return this.direction=e.direction,!0;if(e instanceof rs)return this.extMaps.push(e),!0;if(e instanceof vs)return this.rids.push(e),!0;if(e instanceof ms)return this.rtcpMux=!0,!0;if(e instanceof bs)return this.simulcast=e,!0;if(e instanceof ys||e instanceof os||e instanceof Es){var t=this.codecs.get(e.payloadType);if(!t)throw new Error("Error: got line for unknown codec: ".concat(e.toSdpLine()));return t.addLine(e),!0}return e instanceof ws?(this.ssrcs.push(e),!0):e instanceof Is?(this.ssrcGroups.push(e),!0):(this.otherLines.push(e),!0)}},{key:"getCodecByPt",value:function(e){return this.codecs.get(e)}},{key:"removePt",value:function(e){var t=this,n=(0,c.Z)(this.codecs.values()).filter((function(t){return t.primaryCodecPt===e})).map((function(e){return e.pt})),r=[e].concat((0,c.Z)(n));r.forEach((function(e){t.codecs.delete(e)})),this.pts=this.pts.filter((function(e){return-1===r.indexOf(e)}))}}]),n}(Ms),Fs=function(){function e(){(0,v.Z)(this,e),this.groups=[],this.otherLines=[]}return(0,h.Z)(e,[{key:"addLine",value:function(e){return e instanceof Os?(this.version=e,!0):e instanceof hs?(this.origin=e,!0):e instanceof Cs?(this.sessionName=e,!0):e instanceof _s?(this.information=e,!0):e instanceof Ls?(this.timing=e,!0):e instanceof Qa?(this.connection=e,!0):e instanceof za?(this.bandwidth=e,!0):e instanceof Ja?(this.groups.push(e),!0):(this.otherLines.push(e),!0)}},{key:"toLines",value:function(){var e=[];return this.version&&e.push(this.version),this.origin&&e.push(this.origin),this.sessionName&&e.push(this.sessionName),this.information&&e.push(this.information),this.connection&&e.push(this.connection),this.bandwidth&&e.push(this.bandwidth),this.timing&&e.push(this.timing),this.groups&&e.push.apply(e,(0,c.Z)(this.groups)),e.push.apply(e,(0,c.Z)(this.otherLines)),e}}]),e}(),Us=function(){function e(){(0,v.Z)(this,e),this.session=new Fs,this.media=[]}return(0,h.Z)(e,[{key:"avMedia",get:function(){return this.media.filter((function(e){return e instanceof Ps}))}},{key:"toString",value:function(){var e=[];return e.push.apply(e,(0,c.Z)(this.session.toLines())),this.media.forEach((function(t){return e.push.apply(e,(0,c.Z)(t.toLines()))})),"".concat(e.map((function(e){return e.toSdpLine()})).join("\r\n"),"\r\n")}}]),e}(),Zs=new(function(e){(0,l.Z)(n,e);var t=xe(n);function n(){var e;return(0,v.Z)(this,n),(e=t.call(this)).addParser("v",Os.fromSdpLine),e.addParser("o",hs.fromSdpLine),e.addParser("c",Qa.fromSdpLine),e.addParser("i",_s.fromSdpLine),e.addParser("m",ls.fromSdpLine),e.addParser("s",Cs.fromSdpLine),e.addParser("t",Ls.fromSdpLine),e.addParser("b",za.fromSdpLine),e.addParser("a",ys.fromSdpLine),e.addParser("a",Es.fromSdpLine),e.addParser("a",os.fromSdpLine),e.addParser("a",ns.fromSdpLine),e.addParser("a",rs.fromSdpLine),e.addParser("a",fs.fromSdpLine),e.addParser("a",cs.fromSdpLine),e.addParser("a",ss.fromSdpLine),e.addParser("a",as.fromSdpLine),e.addParser("a",is.fromSdpLine),e.addParser("a",Rs.fromSdpLine),e.addParser("a",Ss.fromSdpLine),e.addParser("a",ds.fromSdpLine),e.addParser("a",ms.fromSdpLine),e.addParser("a",Ja.fromSdpLine),e.addParser("a",es.fromSdpLine),e.addParser("a",vs.fromSdpLine),e.addParser("a",$a.fromSdpLine),e.addParser("a",bs.fromSdpLine),e.addParser("a",ws.fromSdpLine),e.addParser("a",Is.fromSdpLine),e}return(0,h.Z)(n)}(function(){function e(){(0,v.Z)(this,e),this.parsers=new($())}return(0,h.Z)(e,[{key:"addParser",value:function(e,t){var n=this.parsers.get(e)||[];n.push(t),this.parsers.set(e,n)}},{key:"getParsers",value:function(e){return this.parsers.get(e)||[]}}]),e}()));function Vs(e){return e.length>2}function Gs(e){var t=function(e,t){var n=[];return e.split(/(\r\n|\r|\n)/).filter(Vs).forEach((function(e){var r,i=e[0],o=e.slice(2),a=Re(t.getParsers(i));try{for(a.s();!(r=a.n()).done;){var s=(0,r.value)(o);if(s)return void n.push(s)}}catch(e){a.e(e)}finally{a.f()}var c=As.fromSdpLine(e);n.push(c)})),n}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zs),n=function(e){var t=new Us,n=t.session;return e.forEach((function(e){if(e instanceof ls){var r;if("audio"===e.type||"video"===e.type)r=new Ps(e);else{if("application"!==e.type)throw new Error("Unhandled media type: ".concat(e.type));r=new Ns(e)}t.media.push(r),n=r}else n.addLine(e)})),t}(t);return n}var Bs,Ws={exports:{}},js="object"===("undefined"==typeof Reflect?"undefined":(0,m.Z)(Reflect))?Reflect:null,Hs=js&&"function"==typeof ie()?ie():function(e,t,n){return Function.prototype.apply.call(e,t,n)};Bs=js&&"function"==typeof U()?U():K()?function(e){return ae()(e).concat(K()(e))}:function(e){return ae()(e)};var Ks=ce()||function(e){return e!=e};function qs(){qs.init.call(this)}Ws.exports=qs,Ws.exports.once=function(e,t){return new(ne())((function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}rc(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&rc(e,"error",t,n)}(e,i,{once:!0})}))},qs.EventEmitter=qs,qs.prototype._events=void 0,qs.prototype._eventsCount=0,qs.prototype._maxListeners=void 0;var Ys=10;function zs(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+(0,m.Z)(e))}function Xs(e){return void 0===e._maxListeners?qs.defaultMaxListeners:e._maxListeners}function Js(e,t,n,r){var i,o,a,s;if(zs(n),void 0===(o=e._events)?(o=e._events=N()(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]),void 0===a)a=o[t]=n,++e._eventsCount;else if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=Xs(e))>0&&a.length>i&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=a.length,s=c,console&&console.warn&&console.warn(s)}return e}function $s(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Qs(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=$s.bind(r);return i.listener=n,r.wrapFn=i,i}function ec(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):nc(i,i.length)}function tc(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function nc(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function rc(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+(0,m.Z)(e));e.addEventListener(t,(function i(o){r.once&&e.removeEventListener(t,i),n(o)}))}}S()(qs,"defaultMaxListeners",{enumerable:!0,get:function(){return Ys},set:function(e){if("number"!=typeof e||e<0||Ks(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Ys=e}}),qs.init=function(){void 0!==this._events&&this._events!==P()(this)._events||(this._events=N()(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},qs.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||Ks(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},qs.prototype.getMaxListeners=function(){return Xs(this)},qs.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var s=i[e];if(void 0===s)return!1;if("function"==typeof s)Hs(s,this,t);else{var c=s.length,u=nc(s,c);for(n=0;n<c;++n)Hs(u[n],this,t)}return!0},qs.prototype.addListener=function(e,t){return Js(this,e,t,!1)},qs.prototype.on=qs.prototype.addListener,qs.prototype.prependListener=function(e,t){return Js(this,e,t,!0)},qs.prototype.once=function(e,t){return zs(t),this.on(e,Qs(this,e,t)),this},qs.prototype.prependOnceListener=function(e,t){return zs(t),this.prependListener(e,Qs(this,e,t)),this},qs.prototype.removeListener=function(e,t){var n,r,i,o,a;if(zs(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=N()(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},qs.prototype.off=qs.prototype.removeListener,qs.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=N()(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=N()(null):delete n[e]),this;if(0===arguments.length){var i,o=T()(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=N()(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},qs.prototype.listeners=function(e){return ec(this,e,!0)},qs.prototype.rawListeners=function(e){return ec(this,e,!1)},qs.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):tc.call(e,t)},qs.prototype.listenerCount=tc,qs.prototype.eventNames=function(){return this._eventsCount>0?Bs(this._events):[]};var ic,oc=function(e){(0,l.Z)(n,e);var t=xe(n);function n(){return(0,v.Z)(this,n),t.apply(this,arguments)}return(0,h.Z)(n)}(Ws.exports.EventEmitter);!function(e){e[e.NOT_OVERUSED=0]="NOT_OVERUSED",e[e.OVERUSED=1]="OVERUSED"}(ic||(ic={}));var ac,sc=function(){function e(t){(0,v.Z)(this,e),this.monitors=[],this.lastOverallOveruseState=ic.NOT_OVERUSED,this.isRunning=!1,this.overuseUpdateCallback=t}return(0,h.Z)(e,[{key:"addMonitor",value:function(e){var t=this;this.monitors.push(e),this.isRunning&&e.startMonitoring((function(){return t.onMonitorOveruseUpdate()}))}},{key:"start",value:function(){var e=this;this.isRunning=!0,this.monitors.forEach((function(t){return t.startMonitoring((function(){return e.onMonitorOveruseUpdate()}))}))}},{key:"stop",value:function(){this.isRunning=!1,this.monitors.forEach((function(e){return e.stopMonitoring()}))}},{key:"onMonitorOveruseUpdate",value:function(){var e=this.monitors.map((function(e){return e.getLastOveruseState()})).some((function(e){return e===ic.OVERUSED}))?ic.OVERUSED:ic.NOT_OVERUSED;e!==this.lastOverallOveruseState&&(this.lastOverallOveruseState=e,this.overuseUpdateCallback(e))}}]),e}();exports.ReceiveSlotEvents=void 0,(ac=exports.ReceiveSlotEvents||(exports.ReceiveSlotEvents={})).MediaStarted="media-started",ac.MediaStopped="media-stopped",ac.SourceUpdate="source-update";var cc=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r){var i;return(0,v.Z)(this,n),(i=t.call(this))._idGetter=e,i.handleTrackMuted=i.handleTrackMuted.bind((0,d.Z)(i)),i.handleTrackUnmuted=i.handleTrackUnmuted.bind((0,d.Z)(i)),i._stream=new MediaStream([r]),i._sourceState="no source",i.addTrackHandlers(r),i}return(0,h.Z)(n,[{key:"addTrackHandlers",value:function(e){e.addEventListener("mute",this.handleTrackMuted),e.addEventListener("unmute",this.handleTrackUnmuted)}},{key:"handleTrackMuted",value:function(){this.emit(exports.ReceiveSlotEvents.MediaStopped)}},{key:"handleTrackUnmuted",value:function(){this.emit(exports.ReceiveSlotEvents.MediaStarted)}},{key:"removeTrackHandlers",value:function(e){e.removeEventListener("mute",this.handleTrackMuted),e.removeEventListener("unmute",this.handleTrackUnmuted)}},{key:"replaceTrack",value:function(e){var t,n=null===(t=this._stream.getTracks())||void 0===t?void 0:t[0];n&&(this._stream.removeTrack(n),this.removeTrackHandlers(n)),this.addTrackHandlers(e),this._stream.addTrack(e)}},{key:"_updateSource",value:function(e,t){e===this._sourceState&&t===this._currentRxCsi||(this._sourceState=e,this._currentRxCsi=t,this.emit(exports.ReceiveSlotEvents.SourceUpdate,e,t))}},{key:"close",value:function(){var e=this;this._stream.getTracks().forEach((function(t){e.removeTrackHandlers(t)}))}},{key:"id",get:function(){return this._idGetter()}},{key:"stream",get:function(){return this._stream}},{key:"currentRxCsi",get:function(){return this._currentRxCsi}}]),n}(oc);cc.Events=exports.ReceiveSlotEvents;var uc=function(){function e(t){(0,v.Z)(this,e),this._rtcRtpTransceiver=t}return(0,h.Z)(e,[{key:"replaceTransceiver",value:function(e){this._rtcRtpTransceiver=e}},{key:"receiver",get:function(){return this._rtcRtpTransceiver.receiver}},{key:"sender",get:function(){return this._rtcRtpTransceiver.sender}},{key:"mid",get:function(){return this._rtcRtpTransceiver.mid}},{key:"close",value:function(){this._rtcRtpTransceiver.stop()}}]),e}(),dc=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r){var i;return(0,v.Z)(this,n),(i=t.call(this,e))._receiveSlot=new cc((function(){return i._rtcRtpTransceiver.mid?r(i._rtcRtpTransceiver.mid):null}),i._rtcRtpTransceiver.receiver.track),i}return(0,h.Z)(n,[{key:"replaceTransceiver",value:function(e){(0,a.Z)((0,p.Z)(n.prototype),"replaceTransceiver",this).call(this,e),this._receiveSlot.replaceTrack(e.receiver.track)}},{key:"close",value:function(){(0,a.Z)((0,p.Z)(n.prototype),"close",this).call(this),this._receiveSlot.close()}},{key:"receiveSlot",get:function(){return this._receiveSlot}},{key:"getStats",value:function(){return this.receiver.getStats()}}]),n}(uc);dc.rid="1";var lc=function(e){(0,l.Z)(n,e);var t=xe(n);function n(){return(0,v.Z)(this,n),t.apply(this,arguments)}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=jmp"}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n}}]),n}(Ya);lc.regex=/^jmp$/;var fc=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e){var r;return(0,v.Z)(this,n),(r=t.call(this)).streamIdMode=e,r}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){return"a=jmp-stream-id-mode:".concat(this.streamIdMode)}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e))return new n(e.match(n.regex)[1])}}]),n}(Ya);fc.regex=/^jmp-stream-id-mode:(MID-RID|SSRC)$/;var pc=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r){var i;return(0,v.Z)(this,n),(i=t.call(this)).source=e,i.csi=r,i}return(0,h.Z)(n,[{key:"toSdpLine",value:function(){var e="a=jmp-source:".concat(this.source);return this.csi&&(e+=" csi=".concat(this.csi)),e}}],[{key:"fromSdpLine",value:function(e){if(n.regex.test(e)){var t=e.match(n.regex);return new n(t[1],t[2])}}}]),n}(Ya);function hc(e){return C()(e)?e.map((function(e){return hc(e)})):e instanceof $()?new($())(e):e instanceof Date?new Date(e.getTime()):e&&"object"===(0,m.Z)(e)?ae()(e).reduce((function(t,n){return S()(t,n,b()(e,n)),t[n]=hc(e[n]),t}),N()(P()(e))):e}function vc(e,t){var n=t.map((function(e){return e.toLowerCase()}));e.avMedia.map((function(e){return(0,c.Z)(e.codecs.values()).map((function(e){return e.name}))})).flat().filter((function(e){return!n.includes(e.toLowerCase())})).forEach((function(t){return function(e,t){e.avMedia.forEach((function(e){var n=(0,c.Z)(e.codecs.entries()).filter((function(e){var n;return(null===(n=(0,u.Z)(e,2)[1].name)||void 0===n?void 0:n.toLowerCase())===t.toLowerCase()}));n.forEach((function(t){var n=(0,u.Z)(t,1)[0];return e.removePt(n)}))}))}(e,t)}))}function mc(e,t,n){if("max-compat"===t){var r=n.get(Go.AudioMain),i=n.get(Go.VideoMain),o=n.get(Go.AudioSlides),a=n.get(Go.VideoSlides);e.session.groups.splice(0,e.session.groups.length),r&&e.session.groups.push(new Ja(r)),i&&e.session.groups.push(new Ja(i)),o&&e.session.groups.push(new Ja(o)),a&&e.session.groups.push(new Ja(a))}}function gc(e,t,n){t.session.groups=e.session.groups,t.media=e.media.map((function(e){if(!e.mid)throw new Error("Offer mline is missing MID");var r=t.media.find((function(t){return t.mid===e.mid}));if(r)return r instanceof Ps&&(0,c.Z)(r.codecs.values()).forEach((function(e){e.fmtParams.set("x-google-start-bitrate","60000")})),r;if(!(e instanceof Ps))throw new Error("Answer is missing a non-media mline: ".concat(e.mid));var i=t.avMedia.find((function(t){return t.type===e.type}));if(!i)throw new Error("Answer has no mline of type ".concat(e.type,", can't generate synthetic answer mline for mid ").concat(e.mid));var o=hc(i);(o.mid=e.mid,o.simulcast=void 0,"sendrecv"!==e.direction&&"sendonly"!==e.direction||(o.direction="recvonly"),"recvonly"===e.direction)&&(o.direction="sendonly",n.getIngressStreamSignalerOrThrow(e.mid).signalRemoteStreams(o));return o}))}function Ec(e,t,n){e.avMedia.filter((function(e){return"sendrecv"===e.direction||"inactive"===e.direction})).forEach((function(e){if(e.otherLines.find((function(e){return e instanceof lc}))||e.addLine(new lc),!e.otherLines.find((function(e){return e instanceof pc}))){var r=function(e){var t,n,r;if(e.type.toLowerCase()===Uo.Audio.toLowerCase())r=Uo.Audio;else{if(e.type.toLowerCase()!==Uo.Video.toLowerCase())throw Error("Mline type doesn't match any known MediaFamily: ".concat(e.type));r=Uo.Video}return Ho(r,(null===(n=null===(t=e.content)||void 0===t?void 0:t.values)||void 0===n?void 0:n.some((function(e){return"slides"===e.toLowerCase()})))?Zo.Slides:Zo.Main)}(e),i=t.get(r);if(!i)throw new Error("Unable to find CSI for MediaType ".concat(r));e.addLine(new pc(e.mid,i.toString()))}e.otherLines.find((function(e){return e instanceof fc}))||e.addLine(new fc(n))}))}pc.regex=new RegExp("^jmp-source:(".concat(Ka,") (?:csi=(").concat(Ka,"))")),Zs.addParser("a",lc.fromSdpLine),Zs.addParser("a",pc.fromSdpLine),Zs.addParser("a",fc.fromSdpLine);var yc=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r){var i;return(0,v.Z)(this,n),(i=t.call(this,e)).requested=!1,i.csi=r,i.direction="sendrecv",i.handleTrackChange=i.handleTrackChange.bind((0,d.Z)(i)),i}return(0,h.Z)(n,[{key:"handleTrackChange",value:function(){var e;return na(this,void 0,void 0,E().mark((function t(){return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.requested){t.next=3;break}return t.next=3,this.sender.replaceTrack((null===(e=this.publishedTrack)||void 0===e?void 0:e.underlyingTrack)||null);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"replaceTransceiver",value:function(e){var t,r=this,i=N()(null,{replaceTransceiver:{get:function(){return(0,a.Z)((0,p.Z)(n.prototype),"replaceTransceiver",r)}}});return na(this,void 0,void 0,E().mark((function n(){return E().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i.replaceTransceiver.call(this,e),e.direction=this.direction,!this.requested){n.next=5;break}return n.next=5,this.sender.replaceTrack((null===(t=this.publishedTrack)||void 0===t?void 0:t.underlyingTrack)||null);case 5:case"end":return n.stop()}}),n,this)})))}},{key:"replacePublishedTrack",value:function(e){var t,n;return na(this,void 0,void 0,E().mark((function r(){return E().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(null===(t=this.publishedTrack)||void 0===t||t.off(exports.LocalTrackEvents.UnderlyingTrackChange,this.handleTrackChange),null===(n=this.publishedTrack)||void 0===n||n.setPublished(!1),!this.requested){r.next=5;break}return r.next=5,this.sender.replaceTrack((null==e?void 0:e.underlyingTrack)||null);case 5:this.publishedTrack=e,null==e||e.on(exports.LocalTrackEvents.UnderlyingTrackChange,this.handleTrackChange),null==e||e.setPublished(!0);case 8:case"end":return r.stop()}}),r,this)})))}},{key:"setTrackRequested",value:function(e){var t;return na(this,void 0,void 0,E().mark((function n(){var r;return E().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.requested===e){n.next=5;break}return this.requested=e,r=e&&(null===(t=this.publishedTrack)||void 0===t?void 0:t.underlyingTrack)||null,n.next=5,this.sender.replaceTrack(r);case 5:case"end":return n.stop()}}),n,this)})))}},{key:"updateSimulcastStreamStates",value:function(e){return na(this,void 0,void 0,E().mark((function t(){var n;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=this.sender.getParameters()).encodings.forEach((function(t,n){var r=e.get(n);t.active=Boolean(r),r&&(r.scaleDownRatio>=1&&t.scaleResolutionDownBy!==r.scaleDownRatio&&(t.scaleResolutionDownBy=r.scaleDownRatio),r.maxPayloadBitsPerSecond&&(t.maxBitrate=r.maxPayloadBitsPerSecond))})),t.next=4,this.sender.setParameters(n);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"getScaleDownRatio",value:function(e){var t;if(!e)return-1;if(!this.publishedTrack)return-1;var n=null===(t=this.publishedTrack)||void 0===t?void 0:t.underlyingTrack.getSettings(),r=null==n?void 0:n.height,i=null==n?void 0:n.width;return i&&r?Math.max(function(e,t,n){return t/xo(e,n)}([i,r],r,e),1):-1}},{key:"publishTrack",value:function(e){return this.replacePublishedTrack(e)}},{key:"unpublishTrack",value:function(){return this.replacePublishedTrack()}},{key:"setActive",value:function(e){return this.direction=e?"sendrecv":"inactive",this._rtcRtpTransceiver.direction=this.direction,this._rtcRtpTransceiver.direction!==this._rtcRtpTransceiver.currentDirection}},{key:"getStats",value:function(){return this.sender.getStats()}}]),n}(uc),Sc=function(){function e(t){var n=this;(0,v.Z)(this,e);var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return na(n,void 0,void 0,E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))};this.statsGetter=t,this.statsPreProcessor=r}return(0,h.Z)(e,[{key:"getStats",value:function(){return na(this,void 0,void 0,E().mark((function e(){var t,n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.statsGetter();case 2:return t=e.sent,n=new($()),t.forEach((function(e,t){return n.set(t,e)})),e.next=7,this.statsPreProcessor(n);case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)})))}}]),e}(),_c={0:"240",1:"2304",2:"8160"},Cc=function(){function e(t){(0,v.Z)(this,e),this.mid=t}return(0,h.Z)(e,[{key:"getReceiverId",value:function(){return{mid:this.mid,rid:"1"}}},{key:"signalLocalStreams",value:function(e){}},{key:"signalRemoteStreams",value:function(e){}}]),e}(),Rc=function(){function e(t){(0,v.Z)(this,e),this.streamIds=[],this.mid=t}return(0,h.Z)(e,[{key:"signalStreams",value:function(e,t,n){n.ssrcGroups=[],0===this.streamIds.length&&(this.streamIds=e?[{mid:this.mid,rid:"low"},{mid:this.mid,rid:"medium"},{mid:this.mid,rid:"high"}]:[{mid:this.mid}]),e&&(n.rids=this.streamIds.map((function(e,t){return new vs(e.rid,"send","max-fs=".concat(_c[t]))})),n.simulcast=new bs(xs.fromString("low;medium;high"),new xs))}},{key:"getSenderIds",value:function(){return this.streamIds}},{key:"getEncodingIndexForStreamId",value:function(e){return this.streamIds.findIndex((function(t){return zo(t,e)}))}}]),e}();function Tc(){return Math.floor(4294967295*Math.random())+1}var xc=function(){function e(){(0,v.Z)(this,e),this.ssrc=Tc()}return(0,h.Z)(e,[{key:"getReceiverId",value:function(){return de()({ssrc:this.ssrc},this.rtxSsrc?{rtxSsrc:this.rtxSsrc}:{})}},{key:"signalLocalStreams",value:function(e){}},{key:"signalRemoteStreams",value:function(e){e.addLine(new ws(this.ssrc,"cname","".concat(this.ssrc,"-cname"))),e.addLine(new ws(this.ssrc,"msid","-","1")),function(e,t){return(0,c.Z)(t.codecs.values()).some((function(t){var n;return(null===(n=t.name)||void 0===n?void 0:n.toLowerCase())===e.toLowerCase()}))}("rtx",e)&&(this.rtxSsrc=Tc(),e.addLine(new ws(this.rtxSsrc,"cname","".concat(this.ssrc,"-cname"))),e.addLine(new ws(this.rtxSsrc,"msid","-","1")),e.addLine(new Is("FID",[this.ssrc,this.rtxSsrc])))}}]),e}(),bc=function(){function e(){(0,v.Z)(this,e),this.streamIds=[]}return(0,h.Z)(e,[{key:"signalStreams",value:function(e,t,n){var r=this;if(n.rids=[],n.simulcast=void 0,n.ssrcs=[],n.ssrcGroups=[],n.extMaps=n.extMaps.filter((function(e){return!/^urn:ietf:params:rtp-hdrext:sdes:(?:mid|rtp-stream-id|repaired-rtp-stream-id)$/.test(e.uri)})),0===this.streamIds.length){var i=e?3:1;(0,c.Z)(Array(i).keys()).forEach((function(){var e={ssrc:Tc()};t&&(e.rtxSsrc=Tc()),r.streamIds.push(e)}))}this.streamIds.forEach((function(e){var r=e.ssrc;if(n.addLine(new ws(r,"cname","".concat(r,"-cname"))),n.addLine(new ws(r,"msid","-","1")),t){var i=e.rtxSsrc;n.addLine(new ws(i,"cname","".concat(r,"-cname"))),n.addLine(new ws(i,"msid","-","1")),n.addLine(new Is("FID",[r,i]))}})),e&&n.addLine(new Is("SIM",this.streamIds.map((function(e){return e.ssrc}))))}},{key:"getSenderIds",value:function(){return this.streamIds}},{key:"getEncodingIndexForStreamId",value:function(e){return this.streamIds.findIndex((function(t){return zo(t,e)}))}}]),e}(),wc=function(){function e(t){(0,v.Z)(this,e),this.egressStreamSignalersByMid=new($()),this.ingressStreamsSignalersByMid=new($()),this.ingressStreamSignalingMode=t,this.egressStreamSignalingMode=t}return(0,h.Z)(e,[{key:"getOrCreateEgressStreamSignaler",value:function(e){var t,n=this.getEgressStreamSignaler(e);return n||(t="MID-RID"===this.egressStreamSignalingMode?new Rc(e):new bc,this.egressStreamSignalersByMid.set(e,t),t)}},{key:"getEgressStreamSignalerOrThrow",value:function(e){var t=this.getEgressStreamSignaler(e);if(!t)throw new Error("Couldn't find EgressStreamSignaler for mid ".concat(e));return t}},{key:"getEgressStreamSignaler",value:function(e){return this.egressStreamSignalersByMid.get(e)}},{key:"getOrCreateIngressStreamSignaler",value:function(e){var t,n=this.getIngressStreamSignaler(e);return n||(t="MID-RID"===this.ingressStreamSignalingMode?new Cc(e):new xc,this.ingressStreamsSignalersByMid.set(e,t),t)}},{key:"getIngressStreamSignaler",value:function(e){return this.ingressStreamsSignalersByMid.get(e)}},{key:"getIngressStreamSignalerOrThrow",value:function(e){var t=this.getIngressStreamSignaler(e);if(!t)throw new Error("Couldn't find IngressStreamSignaler for mid ".concat(e));return t}}]),e}(),Ic=function(e,t){return na(void 0,void 0,void 0,E().mark((function n(){var r;return E().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={audio:{senders:[],receivers:[]},video:{senders:[],receivers:[]},screenShareAudio:{senders:[],receivers:[]},screenShareVideo:{senders:[],receivers:[]}},n.next=3,ne().all((0,c.Z)(e.entries()).map((function(e){var t=(0,u.Z)(e,2),n=t[0],i=t[1];return na(void 0,void 0,void 0,E().mark((function e(){var t,o;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.getStats();case 2:e.t0=e.sent,e.t1=i.mid,e.t2=i.csi,e.t3=null===(t=i.publishedTrack)||void 0===t?void 0:t.label,o={report:e.t0,mid:e.t1,csi:e.t2,currentDirection:"sendonly",localTrackLabel:e.t3},n===Go.AudioMain&&r.audio.senders.push(o),n===Go.VideoMain&&r.video.senders.push(o),n===Go.AudioSlides&&r.screenShareAudio.senders.push(o),n===Go.VideoSlides&&r.screenShareVideo.senders.push(o);case 11:case"end":return e.stop()}}),e)})))})));case 3:return n.next=5,ne().all((0,c.Z)(t.entries()).map((function(e){var t=(0,u.Z)(e,2),n=t[0],i=t[1];return na(void 0,void 0,void 0,E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ne().all(i.map((function(e){return na(void 0,void 0,void 0,E().mark((function t(){var i,o,a;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getStats();case 2:t.t0=t.sent,t.t1=null===(i=e.receiveSlot.id)||void 0===i?void 0:i.mid,t.t2=e.receiveSlot.currentRxCsi,t.t3=null===(o=e.receiveSlot.stream.getTracks()[0])||void 0===o?void 0:o.label,a={report:t.t0,mid:t.t1,csi:t.t2,currentDirection:"recvonly",localTrackLabel:t.t3},n===Go.AudioMain&&r.audio.receivers.push(a),n===Go.VideoMain&&r.video.receivers.push(a),n===Go.AudioSlides&&r.screenShareAudio.receivers.push(a),n===Go.VideoSlides&&r.screenShareVideo.receivers.push(a);case 11:case"end":return t.stop()}}),t)})))}))));case 1:case"end":return e.stop()}}),e)})))})));case 5:return n.abrupt("return",r);case 6:case"end":return n.stop()}}),n)})))},Lc={exports:{}};!function(e,t){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||S()(e,t,{enumerable:!0,get:r})},n.r=function(e){void 0!==me()&&Ee()&&S()(e,Ee(),{value:"Module"}),S()(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==(0,m.Z)(e)&&e&&e.__esModule)return e;var r=N()(null);if(n.r(r),S()(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=90)}({17:function(e,t,n){t.__esModule=!0,t.default=void 0;var r=n(18),i=function(){function e(){}return e.getFirstMatch=function(e,t){var n=t.match(e);return n&&n.length>0&&n[1]||""},e.getSecondMatch=function(e,t){var n=t.match(e);return n&&n.length>1&&n[2]||""},e.matchAndReturnConst=function(e,t,n){if(e.test(t))return n},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return k()(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return k()(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,n,r){void 0===r&&(r=!1);var i=e.getVersionPrecision(t),o=e.getVersionPrecision(n),a=Math.max(i,o),s=0,c=e.map([t,n],(function(t){var n=a-e.getVersionPrecision(t),r=t+new Array(n+1).join(".0");return e.map(r.split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));for(r&&(s=a-Math.min(i,o)),a-=1;a>=s;){if(c[0][a]>c[1][a])return 1;if(c[0][a]===c[1][a]){if(a===s)return 0;a-=1}else if(c[0][a]<c[1][a])return-1}},e.map=function(e,t){var n,r=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n+=1)r.push(t(e[n]));return r},e.find=function(e,t){var n,r;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(n=0,r=e.length;n<r;n+=1){var i=e[n];if(t(i,n))return i}},e.assign=function(e){for(var t,n,r=e,i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];if(de())return de().apply(Object,[e].concat(o));var s=function(){var e=o[t];"object"==(0,m.Z)(e)&&null!==e&&T()(e).forEach((function(t){r[t]=e[t]}))};for(t=0,n=o.length;t<n;t+=1)s();return e},e.getBrowserAlias=function(e){return r.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return r.BROWSER_MAP[e]||""},e}();t.default=i,e.exports=t.default},18:function(e,t,n){t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,n){t.__esModule=!0,t.default=void 0;var r,i=(r=n(91))&&r.__esModule?r:{default:r},o=n(18);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),S()(e,r.key,r)}}var s=function(){function e(){}var t,n,r;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new i.default(e,t)},e.parse=function(e){return new i.default(e).getResult()},t=e,r=[{key:"BROWSER_MAP",get:function(){return o.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return o.ENGINE_MAP}},{key:"OS_MAP",get:function(){return o.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return o.PLATFORMS_MAP}}],(n=null)&&a(t.prototype,n),r&&a(t,r),e}();t.default=s,e.exports=t.default},91:function(e,t,n){t.__esModule=!0,t.default=void 0;var r=c(n(92)),i=c(n(93)),o=c(n(94)),a=c(n(95)),s=c(n(17));function c(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=s.default.find(r.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=s.default.find(i.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=s.default.find(o.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=s.default.find(a.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return s.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,n={},r=0,i={},o=0;if(T()(e).forEach((function(t){var a=e[t];"string"==typeof a?(i[t]=a,o+=1):"object"==(0,m.Z)(a)&&(n[t]=a,r+=1)})),r>0){var a=T()(n),c=s.default.find(a,(function(e){return t.isOS(e)}));if(c){var u=this.satisfies(n[c]);if(void 0!==u)return u}var d=s.default.find(a,(function(e){return t.isPlatform(e)}));if(d){var l=this.satisfies(n[d]);if(void 0!==l)return l}}if(o>0){var f=T()(i),p=s.default.find(f,(function(e){return t.isBrowser(e,!0)}));if(void 0!==p)return this.compareVersion(i[p])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var n=this.getBrowserName().toLowerCase(),r=e.toLowerCase(),i=s.default.getBrowserTypeByAlias(r);return t&&i&&(r=i.toLowerCase()),r===n},t.compareVersion=function(e){var t=[0],n=e,r=!1,i=this.getBrowserVersion();if("string"==typeof i)return">"===e[0]||"<"===e[0]?(n=e.substr(1),"="===e[1]?(r=!0,n=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?n=e.substr(1):"~"===e[0]&&(r=!0,n=e.substr(1)),t.indexOf(s.default.compareVersions(i,n,r))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=u,e.exports=t.default},92:function(e,t,n){t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=/version\/(\d+(\.?_?\d+)+)/i,a=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},n=i.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},n=i.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},n=i.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},n=i.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},n=i.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},n=i.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},n=i.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},n=i.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},n=i.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},n=i.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},n=i.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},n=i.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},n=i.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},n=i.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},n=i.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return n&&(t.version=n),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},n=i.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},n=i.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},n=i.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},n=i.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},n=i.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},n=i.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},n=i.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},n=i.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},n=i.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},n=i.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},n=i.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},n=i.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t={name:"Android Browser"},n=i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},n=i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},n=i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:i.default.getFirstMatch(t,e),version:i.default.getSecondMatch(t,e)}}}];t.default=a,e.exports=t.default},93:function(e,t,n){t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),a=[{test:[/Roku\/DVP/],describe:function(e){var t=i.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:o.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=i.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=i.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),n=i.default.getWindowsVersionName(t);return{name:o.OS_MAP.Windows,version:t,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:o.OS_MAP.iOS},n=i.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return n&&(t.version=n),t}},{test:[/macintosh/i],describe:function(e){var t=i.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),n=i.default.getMacOSVersionName(t),r={name:o.OS_MAP.MacOS,version:t};return n&&(r.versionName=n),r}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=i.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:o.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t=i.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),n=i.default.getAndroidVersionName(t),r={name:o.OS_MAP.Android,version:t};return n&&(r.versionName=n),r}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=i.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),n={name:o.OS_MAP.WebOS};return t&&t.length&&(n.version=t),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=i.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||i.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||i.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:o.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=i.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=i.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:o.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:o.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=i.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.PlayStation4,version:t}}}];t.default=a,e.exports=t.default},94:function(e,t,n){t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),a=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=i.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",n={type:o.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(n.model=t),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),n=e.test(/like (ipod|iphone)/i);return t&&!n},describe:function(e){var t=i.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:o.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}}];t.default=a,e.exports=t.default},95:function(e,t,n){t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),a=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:o.ENGINE_MAP.Blink};var t=i.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:o.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:o.ENGINE_MAP.Trident},n=i.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:o.ENGINE_MAP.Presto},n=i.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=e.test(/gecko/i),n=e.test(/like gecko/i);return t&&!n},describe:function(e){var t={name:o.ENGINE_MAP.Gecko},n=i.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:o.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:o.ENGINE_MAP.WebKit},n=i.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}}];t.default=a,e.exports=t.default}})}(Lc);var Oc=oa(Lc.exports);function Ac(){return Oc.getParser(window.navigator.userAgent).getBrowser()}var kc={exports:{}};!function(e){!function(t){var n,r={};r.VERSION="1.6.1";var i={},o=function(e,t){return function(){return t.apply(e,arguments)}},a=function(){var e,t,n=arguments,r=n[0];for(t=1;t<n.length;t++)for(e in n[t])!(e in r)&&n[t].hasOwnProperty(e)&&(r[e]=n[t][e]);return r},s=function(e,t){return{value:e,name:t}};r.TRACE=s(1,"TRACE"),r.DEBUG=s(2,"DEBUG"),r.INFO=s(3,"INFO"),r.TIME=s(4,"TIME"),r.WARN=s(5,"WARN"),r.ERROR=s(8,"ERROR"),r.OFF=s(99,"OFF");var c=function(e){this.context=e,this.setLevel(e.filterLevel),this.log=this.info};c.prototype={setLevel:function(e){e&&"value"in e&&(this.context.filterLevel=e)},getLevel:function(){return this.context.filterLevel},enabledFor:function(e){var t=this.context.filterLevel;return e.value>=t.value},trace:function(){this.invoke(r.TRACE,arguments)},debug:function(){this.invoke(r.DEBUG,arguments)},info:function(){this.invoke(r.INFO,arguments)},warn:function(){this.invoke(r.WARN,arguments)},error:function(){this.invoke(r.ERROR,arguments)},time:function(e){"string"==typeof e&&e.length>0&&this.invoke(r.TIME,[e,"start"])},timeEnd:function(e){"string"==typeof e&&e.length>0&&this.invoke(r.TIME,[e,"end"])},invoke:function(e,t){n&&this.enabledFor(e)&&n(t,a({level:e},this.context))}};var u,d=new c({filterLevel:r.OFF});(u=r).enabledFor=o(d,d.enabledFor),u.trace=o(d,d.trace),u.debug=o(d,d.debug),u.time=o(d,d.time),u.timeEnd=o(d,d.timeEnd),u.info=o(d,d.info),u.warn=o(d,d.warn),u.error=o(d,d.error),u.log=u.info,r.setHandler=function(e){n=e},r.setLevel=function(e){for(var t in d.setLevel(e),i)i.hasOwnProperty(t)&&i[t].setLevel(e)},r.getLevel=function(){return d.getLevel()},r.get=function(e){return i[e]||(i[e]=new c(a({name:e},d.context)))},r.createDefaultHandler=function(e){(e=e||{}).formatter=e.formatter||function(e,t){t.name&&e.unshift("["+t.name+"]")};var t={},n=function(e,t){Function.prototype.apply.call(e,console,t)};return"undefined"==typeof console?function(){}:function(i,o){i=Array.prototype.slice.call(i);var a,s=console.log;o.level===r.TIME?(a=(o.name?"["+o.name+"] ":"")+i[0],"start"===i[1]?console.time?console.time(a):t[a]=(new Date).getTime():console.timeEnd?console.timeEnd(a):n(s,[a+": "+((new Date).getTime()-t[a])+"ms"])):(o.level===r.WARN&&console.warn?s=console.warn:o.level===r.ERROR&&console.error?s=console.error:o.level===r.INFO&&console.info?s=console.info:o.level===r.DEBUG&&console.debug?s=console.debug:o.level===r.TRACE&&console.trace&&(s=console.trace),e.formatter(i,o),n(s,i))}},r.useDefaults=function(e){r.setLevel(e&&e.defaultLevel||r.DEBUG),r.setHandler(r.createDefaultHandler(e))},r.setDefaults=r.useDefaults,e.exports?e.exports=r:(r._prevLogger=t.Logger,r.noConflict=function(){return t.Logger=r._prevLogger,r},t.Logger=r)}(ia)}(kc);var Mc,Nc=kc.exports,Dc=Nc.get("web-client-media-engine");function Pc(e){return[Go.VideoMain,Go.VideoSlides].includes(e)?exports.MediaStreamTrackKind.Video:exports.MediaStreamTrackKind.Audio}function Fc(e){return e===exports.MediaStreamTrackKind.Video?Uo.Video:Uo.Audio}Dc.setLevel(Nc.DEBUG),function(e){e.VideoSourceCountUpdate="video-source-count-update",e.AudioSourceCountUpdate="audio-source-count-update",e.ActiveSpeakerNotification="active-speaker-notification",e.ConnectionStateUpdate="connection-state-update"}(Mc||(Mc={}));var Uc,Zc,Vc={floorControlledPresentation:!1,disableSimulcast:"Firefox"===Ac().name,streamSignalingMode:"SSRC",bundlePolicy:"max-compat",iceServers:void 0,disableContentSimulcast:!0,enableMainAudio:!0,enableMainVideo:!0},Gc=function(e){(0,l.Z)(n,e);var t=xe(n);function n(){var e;(0,v.Z)(this,n);var r,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(e=t.call(this)).sendTransceivers=new($()),e.recvTransceivers=new($()),e.jmpSessions=new($()),e.pendingJmpTasks=[],e.metricsCallback=function(){},e.overuseUpdateCallback=function(){},e.customCodecParameters=new($()),e.midMap=new($()),e.currentMid=0,e.options=de()(de()({},Vc),o),Dc.info("Creating multistream connection with options ".concat(B()(e.options))),e.initializePeerConnection(),e.streamSignalerManager=new wc(e.options.streamSignalingMode),e.overuseStateManager=new sc((function(t){return e.overuseUpdateCallback(t)})),e.overuseStateManager.start(),e.statsManager=new Sc((function(){return e.pc.getStats()}),(function(t){return e.preProcessStats(t)}));var a=Wo(),s=e.getVideoEncodingOptions(Zo.Main);if(e.createSendTransceiver(Go.VideoMain,a,s),e.createSendTransceiver(Go.AudioMain,a),null===(r=e.sendTransceivers.get(Go.VideoMain))||void 0===r||r.setActive(e.options.enableMainVideo),null===(i=e.sendTransceivers.get(Go.AudioMain))||void 0===i||i.setActive(e.options.enableMainAudio),e.options.floorControlledPresentation){var c=e.getVideoEncodingOptions(Zo.Slides),u=Wo();e.createSendTransceiver(Go.VideoSlides,u,c),e.createSendTransceiver(Go.AudioSlides,u)}return e}return(0,h.Z)(n,[{key:"addMid",value:function(e){var t=this.currentMid++,n=this.midMap.get(e)||[];n.push("".concat(t)),this.midMap.set(e,n)}},{key:"clearMids",value:function(){this.midMap=new($()),this.currentMid=0}},{key:"initializePeerConnection",value:function(){var e,t=this;null===(e=this.pc)||void 0===e||e.close(),this.pc=new _o({iceServers:this.options.iceServers,bundlePolicy:this.options.bundlePolicy}),this.pc.on(_o.Events.ConnectionStateChange,(function(e){return t.emit(Mc.ConnectionStateUpdate,e)})),this.attachMetricsObserver(),this.createDataChannel()}},{key:"getConnectionState",value:function(){return this.pc.getConnectionState()}},{key:"getVideoEncodingOptions",value:function(e){return(e===Zo.Main?!this.options.disableSimulcast:!this.options.disableContentSimulcast)?[{scaleResolutionDownBy:4,active:!1},{scaleResolutionDownBy:2,active:!1},{active:!1}]:[{active:!1}]}},{key:"createSendTransceiver",value:function(e,t,n){var r;try{r=this.pc.addTransceiver(Pc(e),{direction:"sendrecv",sendEncodings:n})}catch(e){throw Dc.error("addTransceiver failed due to : ".concat(e)),e}this.addMid(e);var i=jo(Ko(e),t);this.sendTransceivers.set(e,new yc(r,i)),this.createJmpSession(e)}},{key:"createJmpSession",value:function(e){var t=this,n=new ea(Ko(e),qo(e));if(n.setTxCallback((function(e){var n;"open"===(null===(n=t.dataChannel)||void 0===n?void 0:n.readyState)?(Dc.info("Sending JMP message: ".concat(e)),t.dataChannel.send(e)):Dc.error("DataChannel not created or not connected. Unable to send JMP message.")})),Ko(e)===Uo.Video){var r=0,i=0;n.on($o.SourceIndication,(function(n){n.sources.forEach((function(e){var n=t.getReceiveSlotById(e.id);n?n._updateSource(e.state,e.csi):Dc.warn("Got source indication for unknown receive slot: ".concat(e.id))})),n.numTotalSources===r&&n.numLiveSources===i||(r=n.numTotalSources,i=n.numLiveSources,t.emit(Mc.VideoSourceCountUpdate,n.numTotalSources,n.numLiveSources,qo(e)))})),n.on($o.ScrRequestReceived,(function(n){t.sendSourceWarnings(e,n.requests),t.updateRequestedStreams(e,n.requests)}))}if(Ko(e)===Uo.Audio){var o=0,a=0;n.on($o.SourceIndication,(function(n){n.sources.forEach((function(e){var n=t.getReceiveSlotById(e.id);n?n._updateSource(e.state,e.csi):Dc.warn("Got source indication for unknown receive slot: ".concat(e.id))})),n.numTotalSources===o&&n.numLiveSources===a||(o=n.numTotalSources,a=n.numLiveSources,t.emit(Mc.AudioSourceCountUpdate,n.numTotalSources,n.numLiveSources,qo(e)))})),n.on($o.ActiveSpeaker,(function(e){return t.emit(Mc.ActiveSpeakerNotification,e)})),n.on($o.ScrRequestReceived,(function(n){t.updateRequestedStreams(e,n.requests)}))}this.jmpSessions.set(e,n)}},{key:"sendSourceWarnings",value:function(e,t){var n;if(Ko(e)===Uo.Video){var r=this.getSendTransceiverOrThrow(e),i=this.streamSignalerManager.getEgressStreamSignalerOrThrow(r.mid),o=(null===(n=r.publishedTrack)||void 0===n?void 0:n.getNumActiveSimulcastLayers())||0,a=[];if(t.forEach((function(e){var t=e.ids,n=e.policySpecificInfo;t.forEach((function(e){Fo(n)&&r.csi!==n.csi?a.push({id:e,state:"invalid source",csi:n.csi}):i.getSenderIds().some((function(t){return zo(e,t)}))?i.getEncodingIndexForStreamId(e)>o&&a.push({id:e,state:"no source",csi:r.csi}):a.push({id:e,state:"invalid source",csi:r.csi})}))})),a.length>0){var s=r.publishedTrack,c=!!s&&s.published&&!s.muted;this.sendSourceIndication(e,+c,a)}}}},{key:"updateRequestedStreams",value:function(e,t){var n=this.getSendTransceiverOrThrow(e),r=this.streamSignalerManager.getEgressStreamSignalerOrThrow(n.mid),i=new($()),o=t.filter((function(e){return Fo(e.policySpecificInfo)}));o.length!==t.length&&Dc.warn("Ignoring non-receiver-selected requests"),o.forEach((function(t){var o,a=t.ids,s=t.policySpecificInfo,c=t.codecInfos,u=t.maxPayloadBitsPerSecond;if(a.length>1)throw new Error("More than a single ID being unexpected/invalid ".concat(a));if(0!==a.length)if(n.csi===s.csi){var d=a[0],l=c[0];if(r.getSenderIds().some((function(e){return zo(d,e)}))){var f=r.getEncodingIndexForStreamId(d);-1!==f?i.set(f,{scaleDownRatio:n.getScaleDownRatio(null===(o=null==l?void 0:l.h264)||void 0===o?void 0:o.maxFs),maxPayloadBitsPerSecond:u}):Dc.warn("".concat(e,": Unable to get encoding index for stream ID: ").concat(B()(d)))}else Dc.warn("".concat(e,": Unable to find matching stream ID for requested ID: ").concat(B()(d)))}else Dc.warn("csi in the scr request does not match")})),n.setTrackRequested(i.size>0),Ko(e)===Uo.Video&&n.updateSimulcastStreamStates(i)}},{key:"createDataChannel",value:function(){var e=this,t=this.pc.createDataChannel("datachannel",{});t.onopen=function(t){Dc.info("DataChannel opened: ",t),e.sendTransceivers.forEach((function(t,n){var r=t.publishedTrack;if(r)if(Ko(n)===Uo.Audio)e.sendSourceIndication(n,+!r.muted);else{var i=e.streamSignalerManager.getEgressStreamSignalerOrThrow(t.mid),o=r.muted?"avatar":"live",a=i.getSenderIds().map((function(e){return{id:e,state:o,csi:t.csi}}));e.sendSourceIndication(n,+!r.muted,a)}else e.sendSourceIndication(n,0)})),Dc.info("Flushing pending JMP task queue"),e.pendingJmpTasks.forEach((function(e){return e()})),e.pendingJmpTasks=[]},t.onmessage=function(t){var n;try{n=JSON.parse(t.data)}catch(e){return void Dc.error("Error parsing datachannel JSON: ".concat(e))}Dc.debug("DataChannel got msg: ",n);var r=Ao.fromJson(n);if(r){var i=r.payload;if(Mo(i)){var o=Ho(i.mediaFamily,i.mediaContent),a=e.jmpSessions.get(o);a?a.receive(i):Dc.error("Unable to find JMP session for media type ".concat(o,"."))}else Dc.error("Received invalid JMP msg: ".concat(i))}else Dc.error("Received invalid datachannel message: ".concat(t))},t.onclose=function(e){Dc.info("DataChannel closed: ",e)},t.onerror=function(e){Dc.info("DataChannel error: ",e)},this.dataChannel=t}},{key:"close",value:function(){this.sendTransceivers.forEach((function(e){return e.close()})),this.recvTransceivers.forEach((function(e){e.forEach((function(e){return e.close()}))})),this.pc.close()}},{key:"sendSourceIndication",value:function(e,t){var n,r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=function(){var n;null===(n=r.jmpSessions.get(e))||void 0===n||n.updateSourceIndication(1,t,i)};"open"===(null===(n=this.dataChannel)||void 0===n?void 0:n.readyState)?o():this.pendingJmpTasks.push(o)}},{key:"publishTrack",value:function(e){return na(this,void 0,void 0,E().mark((function t(){var n,r,i,o;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e instanceof ai&&this.options.floorControlledPresentation?Zo.Slides:Zo.Main,r=Fc(e.kind),i=Ho(r,n),o=this.getSendTransceiverOrThrow(i),e!==o.publishedTrack){t.next=7;break}return Dc.warn("This track has already been published on the transceiver."),t.abrupt("return",ne().resolve());case 7:return this.addTrackListeners(i,e),t.abrupt("return",o.publishTrack(e));case 9:case"end":return t.stop()}}),t,this)})))}},{key:"unpublishTrack",value:function(e){return na(this,void 0,void 0,E().mark((function t(){var n,r,i,o;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e instanceof ai&&this.options.floorControlledPresentation?Zo.Slides:Zo.Main,r=Fc(e.kind),i=Ho(r,n),o=this.getSendTransceiverOrThrow(i),t.abrupt("return",o.unpublishTrack());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"addTrackListeners",value:function(e,t){var n=this,r=function(){var t=n.getVideoSources(e);null!=t&&n.sendSourceIndication(e,1,t)};t.on(ri.Events.TrackConstraintsChange,r);var i=function(t){if(Ko(e)===Uo.Audio)n.sendSourceIndication(e,+!t.trackState.muted);else{var r=n.getVideoSources(e);null!=r&&n.sendSourceIndication(e,+!t.trackState.muted,r)}};t.on(ri.Events.Muted,i);t.on(ri.Events.PublishedStateUpdate,(function o(a){if(a.isPublished||(t.off(ri.Events.Muted,i),t.off(ri.Events.PublishedStateUpdate,o),t.off(ri.Events.TrackConstraintsChange,r)),Ko(e)===Uo.Audio)n.sendSourceIndication(e,+a.isPublished);else{var s=n.getVideoSources(e);null!=s&&n.sendSourceIndication(e,+a.isPublished,s)}}))}},{key:"getVideoSources",value:function(e){var t,n,r,i=this.getSendTransceiverOrThrow(e),o=this.streamSignalerManager.getEgressStreamSignaler(i.mid);if(!o)return null;var a=(null===(t=i.publishedTrack)||void 0===t?void 0:t.getNumActiveSimulcastLayers())||0,s=null===(n=i.publishedTrack)||void 0===n?void 0:n.published,c=!0===(null===(r=i.publishedTrack)||void 0===r?void 0:r.muted);return o.getSenderIds().map((function(e){return{id:e,state:s?c?"avatar":a<=o.getEncodingIndexForStreamId(e)?"no source":"live":"no source",csi:i.csi}}))}},{key:"createReceiveSlot",value:function(e){return na(this,void 0,void 0,E().mark((function t(){var n,r,i=this;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.pc.addTransceiver(Pc(e),{direction:"recvonly"}),this.addMid(e),r=new dc(n,(function(e){var t=i.streamSignalerManager.getIngressStreamSignaler(e);return t?t.getReceiverId():null})),!this.pc.getRemoteDescription()){t.next=6;break}return t.next=6,this.doLocalOfferAnswer();case 6:return this.recvTransceivers.set(e,[].concat((0,c.Z)(this.recvTransceivers.get(e)||[]),[r])),t.abrupt("return",r.receiveSlot);case 8:case"end":return t.stop()}}),t,this)})))}},{key:"getIngressPayloadType",value:function(e,t){var n,r,i,o=t.split("/")[1],a=null===(n=this.sendTransceivers.get(e))||void 0===n?void 0:n.mid,s=Gs(null===(r=this.pc.getLocalDescription())||void 0===r?void 0:r.sdp),u=Gs(null===(i=this.pc.getRemoteDescription())||void 0===i?void 0:i.sdp).avMedia.filter((function(e){return a===e.mid})).map((function(e){return(0,c.Z)(e.codecs.values())})).flat().filter((function(e){return e.name===o})),d=s.avMedia.filter((function(e){return a===e.mid})).map((function(e){return(0,c.Z)(e.codecs.values())})).flat().filter((function(e){return e.name===o}));if(!u||!d||0===u.length||0===d.length)throw new Error("sender codecs or receiver codecs is undefined or empty");var l=u[0],f=d.find((function(e){return Ro(l,e)}));if(!f||!f.pt)throw new Error("ingress payload type is not well defined in receiver codecs");return f.pt}},{key:"createOffer",value:function(){return na(this,void 0,void 0,E().mark((function e(){var t=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.pc.getLocalDescription()||this.currentMid++,e.abrupt("return",this.pc.createOffer().then((function(e){if(!e.sdp)throw new Error("No SDP offer");return e.sdp=t.preProcessLocalOffer(e.sdp),t.pc.setLocalDescription(e)})).then((function(){return e=t.pc,new(ne())((function(t,n){var r=function(){var r=e.getLocalDescription();r?t(r):n(new Error("Local description was null"))};e.on(_o.Events.IceGatheringStateChange,(function(e){"complete"===e.target.iceGatheringState&&r()})),"complete"===e.iceGatheringState&&r()}));var e})).then((function(e){return{sdp:t.prepareLocalOfferForRemoteServer(e.sdp),type:e.type}})));case 2:case"end":return e.stop()}}),e,this)})))}},{key:"setAnswer",value:function(e){return na(this,void 0,void 0,E().mark((function t(){var n,r,i=this;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=!this.pc.getRemoteDescription(),r=this.preProcessRemoteAnswer(e),t.abrupt("return",this.pc.setRemoteDescription({type:"answer",sdp:r}).then((function(){n&&i.customCodecParameters.size>0&&i.doLocalOfferAnswer()})));case 3:case"end":return t.stop()}}),t,this)})))}},{key:"doLocalOfferAnswer",value:function(){var e;return na(this,void 0,void 0,E().mark((function t(){var n,r;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.pc.createOffer();case 2:if((n=t.sent).sdp){t.next=5;break}throw new Error("No SDP offer");case 5:return n.sdp=this.preProcessLocalOffer(n.sdp),t.next=8,this.pc.setLocalDescription(n);case 8:return r=this.preProcessRemoteAnswer(null===(e=this.pc.getRemoteDescription())||void 0===e?void 0:e.sdp),t.abrupt("return",this.pc.setRemoteDescription({type:"answer",sdp:r}));case 10:case"end":return t.stop()}}),t,this)})))}},{key:"enableMultistreamAudio",value:function(e){var t=this.sendTransceivers.get(Go.AudioMain);return!!t&&t.setActive(e)}},{key:"preProcessLocalOffer",value:function(e){var t,n=this,r=Gs(e);return vc(r,["h264","opus","rtx"]),t=2e7,r.avMedia.forEach((function(e){e.bandwidth=new za("TIAS",t)})),r.avMedia.filter((function(e){return"recvonly"===e.direction})).forEach((function(e){n.streamSignalerManager.getOrCreateIngressStreamSignaler(e.mid).signalLocalStreams(e)})),r.avMedia.filter((function(e){return"sendrecv"===e.direction})).forEach((function(e){var t=n.streamSignalerManager.getOrCreateEgressStreamSignaler(e.mid),r=function(e){return!!e.simulcast||e.ssrcGroups.map((function(e){return e.semantics})).some((function(e){return"SIM"===e}))}(e),i="video"===e.type;t.signalStreams(r,i,e),"video"===e.type&&(0,c.Z)(e.codecs.values()).filter((function(e){return"H264"===e.name})).forEach((function(e){e.fmtParams.set("max-mbps","".concat(244800)),e.fmtParams.set("max-fs","".concat(8160))}));var o=(0,c.Z)(n.sendTransceivers.keys()).find((function(t){var r;return(null===(r=n.sendTransceivers.get(t))||void 0===r?void 0:r.mid)===e.mid}));o&&n.customCodecParameters.has(o)&&(0,c.Z)(e.codecs.values()).filter((function(t){return t.name===("audio"===e.type?"opus":"H264")})).forEach((function(e){var t;null===(t=n.customCodecParameters.get(o))||void 0===t||t.forEach((function(t,n){null===t?e.fmtParams.delete(n):e.fmtParams.set(n,"".concat(t))}))}))})),"Firefox"!==Ac().name&&mc(r,this.options.bundlePolicy,this.midMap),r.toString()}},{key:"prepareLocalOfferForRemoteServer",value:function(e){var t=Gs(e),n=new($());this.sendTransceivers.forEach((function(e,t){n.set(e.mid,qo(t))})),function(e,t){t.forEach((function(t,n){var r=e.media.find((function(e){return e.mid===n}));if(!r)throw new Error("Error trying to set content type for mid ".concat(n,": not found in SDP"));t===Zo.Slides&&r.addLine(new es(["slides"]))}))}(t,n);var r,i,o=new($());return this.sendTransceivers.forEach((function(e,t){o.set(t,e.csi)})),Ec(t,o,this.options.streamSignalingMode),i=[],(r=t).media=r.media.filter((function(e){return(e instanceof Ns||e instanceof Ps&&"recvonly"!==e.direction)&&(i.push(e.mid),!0)})),r.session.groups.forEach((function(e){e.mids=e.mids.filter((function(e){return i.includes(e)}))})),t.avMedia.filter((function(e){return"sendrecv"===e.direction&&"video"===e.type})).forEach((function(e){var t=e.ssrcGroups.find((function(e){return"SIM"===e.semantics}));t&&t.ssrcs.forEach((function(t,n){e.addLine(new ws(t,"fmtp","* max-fs=".concat(_c[n])))}))})),t.toString()}},{key:"preProcessRemoteAnswer",value:function(e){var t,n=Gs(e);return gc(Gs(null===(t=this.pc.getLocalDescription())||void 0===t?void 0:t.sdp),n,this.streamSignalerManager),"Firefox"===Ac().name&&mc(n,this.options.bundlePolicy,this.midMap),n.toString()}},{key:"getSendTransceiverOrThrow",value:function(e){var t=this.sendTransceivers.get(e);if(!t)throw new Error("Unable to find matching transceiver for media type ".concat(e));return t}},{key:"getPublishedTracks",value:function(){return(0,c.Z)(this.sendTransceivers.values()).map((function(e){return e.publishedTrack})).filter(Boolean)}},{key:"setCodecParameters",value:function(e,t){return na(this,void 0,void 0,E().mark((function n(){var r;return E().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=this.customCodecParameters.get(e)||new($()),Se()(t).forEach((function(e){var t=(0,u.Z)(e,2),n=t[0],i=t[1];r.set(n,i)})),this.customCodecParameters.set(e,r),!this.pc.getRemoteDescription()){n.next=6;break}return n.next=6,this.doLocalOfferAnswer();case 6:case"end":return n.stop()}}),n,this)})))}},{key:"deleteCodecParameters",value:function(e,t){return na(this,void 0,void 0,E().mark((function n(){var r;return E().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=this.customCodecParameters.get(e)||new($()),t.forEach((function(e){r.set(e,null)})),this.customCodecParameters.set(e,r),!this.pc.getRemoteDescription()){n.next=6;break}return n.next=6,this.doLocalOfferAnswer();case 6:case"end":return n.stop()}}),n,this)})))}},{key:"requestMedia",value:function(e,t){var n,r=this,i=function(){var n,i=r.jmpSessions.get(e);if(i){var o=[];t.forEach((function(e){return e.receiveSlots.forEach((function(e){e.id?o.push(e.id):Dc.error("Running subscribe task, but ReceiveSlot ID is missing!")}))})),null===(n=r.recvTransceivers.get(e))||void 0===n||n.forEach((function(e){o.some((function(t){return zo(t,e.receiveSlot.id)}))||e.receiveSlot._updateSource("no source",void 0)})),i.sendRequests(t.map((function(e){return e._toJmpScrRequest()})))}else Dc.error("Unable to find jmp session for ".concat(e))};"open"===(null===(n=this.dataChannel)||void 0===n?void 0:n.readyState)?i():this.pendingJmpTasks.push(i)}},{key:"renewPeerConnection",value:function(e){var t=this;e&&(this.options=de()(de()({},Vc),e)),Dc.info("Renewing multistream connection with options ".concat(B()(this.options))),this.clearMids(),this.initializePeerConnection(),this.streamSignalerManager=new wc(this.options.streamSignalingMode);var n=Wo();this.sendTransceivers.forEach((function(e,r){var i;t.addMid(r),e.replaceTransceiver(t.pc.addTransceiver(Pc(r),{direction:"sendrecv",sendEncodings:Ko(r)===Uo.Video?t.getVideoEncodingOptions(qo(r)):void 0})),e.csi=jo(Ko(r),n),null===(i=t.jmpSessions.get(r))||void 0===i||i.close(),t.createJmpSession(r)})),this.recvTransceivers.forEach((function(e,n){e.forEach((function(e){t.addMid(n),e.replaceTransceiver(t.pc.addTransceiver(Pc(n),{direction:"recvonly"}))}))}))}},{key:"getReceiveSlotById",value:function(e){return(0,c.Z)(this.recvTransceivers.values()).flat().map((function(e){return e.receiveSlot})).find((function(t){var n=t.id||{};return T()(n).length===T()(e).length&&T()(n).every((function(t){return Object.prototype.hasOwnProperty.call(e,t)&&n[t]===e[t]}))}))}},{key:"getStats",value:function(){return this.statsManager.getStats()}},{key:"getTransceiverStats",value:function(){return na(this,void 0,void 0,E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ic(this.sendTransceivers,this.recvTransceivers));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"preProcessStats",value:function(e){return na(this,void 0,void 0,E().mark((function t(){var n=this;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ne().all((0,c.Z)(this.sendTransceivers.entries()).map((function(t){var r=(0,u.Z)(t,2),i=r[0],o=r[1];return na(n,void 0,void 0,E().mark((function t(){return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.getStats();case 2:t.sent.forEach((function(t){var n;if("outbound-rtp"===t.type){var r=e.get(t.id);r.mid=o.mid,r.csi=o.csi,r.mediaType=i;var a=null===(n=o.publishedTrack)||void 0===n?void 0:n.underlyingTrack.getSettings();(null==a?void 0:a.frameRate)&&(r.targetFrameRate=null==a?void 0:a.frameRate),e.set(t.id,r)}}));case 3:case"end":return t.stop()}}),t)})))})));case 2:return t.next=4,ne().all((0,c.Z)(this.recvTransceivers.entries()).map((function(t){var r=(0,u.Z)(t,2),i=r[0],o=r[1];return na(n,void 0,void 0,E().mark((function t(){var n=this;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ne().all(o.map((function(t){return na(n,void 0,void 0,E().mark((function n(){var r=this;return E().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.getStats();case 2:n.sent.forEach((function(n){var o;if("inbound-rtp"===n.type){var a=e.get(n.id);a.mid=null===(o=t.receiveSlot.id)||void 0===o?void 0:o.mid,a.csi=t.receiveSlot.currentRxCsi,a.mediaType=i;var s=r.streamSignalerManager.getIngressStreamSignaler(a.mid);s&&de()(a,s.getReceiverId()),e.set(n.id,a)}}));case 3:case"end":return n.stop()}}),n)})))})));case 2:case"end":return t.stop()}}),t)})))})));case 4:case"end":return t.stop()}}),t,this)})))}},{key:"attachMetricsObserver",value:function(){var e=this;Pa(this.pc.getUnderlyingRTCPeerConnection(),(function(t){return e.metricsCallback(t)}),5e3)}},{key:"setMetricsCallback",value:function(e){this.metricsCallback=e}},{key:"setOveruseUpdateCallback",value:function(e){this.overuseUpdateCallback=e}},{key:"getCsiByMediaType",value:function(e){var t;return null===(t=this.sendTransceivers.get(e))||void 0===t?void 0:t.csi}},{key:"getAllCsis",value:function(){return{audioMain:this.getCsiByMediaType(Go.AudioMain),audioSlides:this.getCsiByMediaType(Go.AudioSlides),videoMain:this.getCsiByMediaType(Go.VideoMain),videoSlides:this.getCsiByMediaType(Go.VideoSlides)}}}]),n}(oc);function Bc(e,t){var n=T()(e);if(K()){var r=K()(e);t&&(r=r.filter((function(t){return b()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bc(Object(n),!0).forEach((function(t){Me.default(e,t,n[t])})):Y()?X()(e,Y()(n)):Bc(Object(n)).forEach((function(t){S()(e,t,b()(n,t))}))}return e}exports.Event=void 0,function(e){e.CONNECTION_STATE_CHANGED="connectionState:changed",e.REMOTE_TRACK_ADDED="remoteTrack:added",e.ROAP_MESSAGE_TO_SEND="roap:messageToSend",e.ROAP_STARTED="roap:started",e.ROAP_FAILURE="roap:failure",e.ROAP_DONE="roap:done",e.DTMF_TONE_CHANGED="dtmfTone:changed",e.ACTIVE_SPEAKERS_CHANGED="activeSpeakers:changed",e.VIDEO_SOURCES_COUNT_CHANGED="videoSourcesCount:changed",e.AUDIO_SOURCES_COUNT_CHANGED="audioSourcesCount:changed"}(exports.Event||(exports.Event={})),exports.RemoteTrackType=void 0,(Uc=exports.RemoteTrackType||(exports.RemoteTrackType={})).AUDIO="audio",Uc.VIDEO="video",Uc.SCREENSHARE_VIDEO="screenShareVideo",exports.ErrorType=void 0,(Zc=exports.ErrorType||(exports.ErrorType={})).DOUBLECONFLICT="DOUBLECONFLICT",Zc.CONFLICT="CONFLICT",Zc.FAILED="FAILED",Zc.INVALID_STATE="INVALID_STATE",Zc.NOMATCH="NOMATCH",Zc.OUT_OF_ORDER="OUT_OF_ORDER",Zc.REFUSED="REFUSED",Zc.RETRY="RETRY",Zc.TIMEOUT="TIMEOUT";var jc=[{type:"audio",kind:"audio"},{type:"video",kind:"video"},{type:"screenShareVideo",kind:"video"}],Hc=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r,i){var o;return(0,v.Z)(this,n),o=t.call(this),Me.default((0,d.Z)(o),"id",void 0),Me.default((0,d.Z)(o),"config",void 0),Me.default((0,d.Z)(o),"pc",void 0),Me.default((0,d.Z)(o),"localTracks",void 0),Me.default((0,d.Z)(o),"transceivers",void 0),Me.default((0,d.Z)(o),"receiveOptions",void 0),Me.default((0,d.Z)(o),"mediaConnectionState",void 0),Me.default((0,d.Z)(o),"lastEmittedMediaConnectionState",void 0),o.config=e,o.receiveOptions=Wc({},r.receive),o.localTracks=Wc({},r.send),o.id=i||"MediaConnection",o.transceivers={},o.mediaConnectionState=exports.ConnectionState.New,o.pc=new window.RTCPeerConnection({iceServers:o.config.iceServers,bundlePolicy:"max-compat"}),o.pc.ontrack=o.onTrack.bind((0,d.Z)(o)),o.pc.oniceconnectionstatechange=o.onIceConnectionStateChange.bind((0,d.Z)(o)),o.pc.onconnectionstatechange=o.onConnectionStateChange.bind((0,d.Z)(o)),o}return(0,h.Z)(n,[{key:"log",value:function(e,t){En().info("".concat(this.id,":").concat(e," ").concat(t))}},{key:"warn",value:function(e,t){En().warn("".concat(this.id,":").concat(e," ").concat(t))}},{key:"error",value:function(e,t,n){En().error("".concat(this.id,":").concat(e," ").concat(t," ").concat(yn(n)))}},{key:"createTransceivers",value:function(){var e=this;jc.forEach((function(t){var n=t.type,r=n,i=n,o=Er(t.kind,e.receiveOptions[r],e.localTracks[r]);e.config.skipInactiveTransceivers&&"inactive"===o.direction||(e.transceivers[i]=e.pc.addTransceiver(o.trackOrKind,{direction:o.direction}))})),this.setupTransceiverListeners()}},{key:"initializeTransceivers",value:function(e){if(this.pc.getTransceivers().length>0)throw this.error("initiateOffer()","SDP negotiation already started"),new Error("SDP negotiation already started");e?this.addLocalTracks():this.createTransceivers()}},{key:"close",value:function(){this.pc.close(),this.pc.ontrack=null,this.pc.oniceconnectionstatechange=null,this.pc.onconnectionstatechange=null,this.pc.onicegatheringstatechange=null,this.pc.onicecandidate=null,this.pc.onicecandidateerror=null}},{key:"getConfig",value:function(){return this.config}},{key:"getSendReceiveOptions",value:function(){return{send:this.localTracks,receive:this.receiveOptions}}},{key:"updateRemoteQualityLevel",value:function(e){return e!==this.receiveOptions.remoteQualityLevel&&(this.receiveOptions.remoteQualityLevel=e,!0)}},{key:"updateTransceivers",value:function(e){var t=this,n=!1;return this.receiveOptions.audio=e.receive.audio,this.receiveOptions.video=e.receive.video,this.receiveOptions.screenShareVideo=e.receive.screenShareVideo,this.identifyTransceivers(),jc.forEach((function(r){var i=r.type,o=r.kind,a=i,s=i,c=e.send[a],u=t.transceivers[s];if(void 0!==c&&c!==t.localTracks[a]&&(t.localTracks[a]=c,u&&(t.log("updateTransceivers()",'replacing sender track on "'.concat(i,'" transceiver')),u.sender.replaceTrack(c))),u){var d=Er(o,t.receiveOptions[a],t.localTracks[a]);u.direction!==d.direction&&(t.log("updateTransceivers()","updating direction to ".concat(d.direction,' on "').concat(i,'" transceiver')),u.direction=d.direction,n=!0)}})),n}},{key:"updateSendOptions",value:function(e){return this.updateTransceivers({send:e,receive:Wc({},this.receiveOptions)})}},{key:"updateReceiveOptions",value:function(e){var t=!1;return this.updateRemoteQualityLevel(e.remoteQualityLevel)&&(t=!0),this.updateTransceivers({send:this.localTracks,receive:e})&&(t=!0),t}},{key:"updateSendReceiveOptions",value:function(e){var t=!1;return this.updateRemoteQualityLevel(e.receive.remoteQualityLevel)&&(t=!0),this.updateTransceivers(e)&&(t=!0),t}},{key:"getConnectionState",value:function(){return this.log("getConnectionState()","called, returning ".concat(this.mediaConnectionState)),this.mediaConnectionState}},{key:"getStats",value:function(){return this.pc.getStats()}},{key:"getTransceiverStats",value:function(){var e=this;return ke.default(E().mark((function t(){var n,r,i,o,a;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n={audio:{senders:[],receivers:[]},video:{senders:[],receivers:[]},screenShareAudio:{senders:[],receivers:[]},screenShareVideo:{senders:[],receivers:[]}},r=E().mark((function t(r){var i;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(i=e.transceivers[r])){t.next=6;break}return t.next=4,i.sender.getStats().then((function(e){var t,o;n[r].senders.push({report:e,currentDirection:i.currentDirection,localTrackLabel:null===(t=i.sender)||void 0===t||null===(o=t.track)||void 0===o?void 0:o.label})}));case 4:return t.next=6,i.receiver.getStats().then((function(e){var t,o;n[r].receivers.push({report:e,currentDirection:i.currentDirection,localTrackLabel:null===(t=i.sender)||void 0===t||null===(o=t.track)||void 0===o?void 0:o.label})}));case 6:case"end":return t.stop()}}),t)})),i=0,o=jc;case 3:if(!(i<o.length)){t.next=9;break}return a=o[i].type,t.delegateYield(r(a),"t0",6);case 6:i++,t.next=3;break;case 9:return t.abrupt("return",n);case 10:case"end":return t.stop()}}),t)})))()}},{key:"insertDTMF",value:function(e,t,n){if(!this.transceivers.audio)throw new Error("audio transceiver missing");if(!this.transceivers.audio.sender)throw new Error("this.transceivers.audio.sender is null");if(!this.transceivers.audio.sender.dtmf)throw new Error("this.transceivers.audio.sender.dtmf is null");this.transceivers.audio.sender.dtmf.insertDTMF(e.toUpperCase(),t,n)}},{key:"setupTransceiverListeners",value:function(){var e,t;null!==(e=this.transceivers.audio)&&void 0!==e&&null!==(t=e.sender)&&void 0!==t&&t.dtmf&&(this.transceivers.audio.sender.dtmf.ontonechange=this.onToneChange.bind(this))}},{key:"onToneChange",value:function(e){this.log("onToneChange()",'emitting Event.DTMF_TONE_CHANGED with tone="'.concat(e.tone,'"')),this.emit(exports.Event.DTMF_TONE_CHANGED,{tone:e.tone})}},{key:"identifyTransceivers",value:function(){var e=this;if(!this.transceivers.audio&&!this.transceivers.video&&!this.transceivers.screenShareVideo){var t=this.pc.getTransceivers();this.log("identifyTransceivers()","transceivers.length=".concat(t.length)),t.forEach((function(t,n){e.log("identifyTransceivers()","transceiver[".concat(n,"].mid=").concat(t.mid))}));var n=(0,u.Z)(t,3);this.transceivers.audio=n[0],this.transceivers.video=n[1],this.transceivers.screenShareVideo=n[2],this.setupTransceiverListeners()}}},{key:"onTrack",value:function(e){var t,n,r,i,o,a,s,c,u,d;this.log("onTrack()","callback called: event=".concat(B()(e)));var l="0",f="1",p="2",h=e.track,v=null;switch(this.identifyTransceivers(),null!==(t=e.transceiver)&&void 0!==t&&t.mid?(this.log("onTrack()","identifying track by event.transceiver.mid"),v=e.transceiver.mid):v=h.id===(null===(n=this.transceivers.audio)||void 0===n||null===(r=n.receiver)||void 0===r||null===(i=r.track)||void 0===i?void 0:i.id)?l:h.id===(null===(o=this.transceivers.video)||void 0===o||null===(a=o.receiver)||void 0===a||null===(s=a.track)||void 0===s?void 0:s.id)?f:h.id===(null===(c=this.transceivers.screenShareVideo)||void 0===c||null===(u=c.receiver)||void 0===u||null===(d=u.track)||void 0===d?void 0:d.id)?p:null,this.log("onTrack()","trackMediaID=".concat(v)),v){case l:this.log("onTrack()","emitting Event.REMOTE_TRACK_ADDED with type=AUDIO"),this.emit(exports.Event.REMOTE_TRACK_ADDED,{type:exports.RemoteTrackType.AUDIO,track:h});break;case f:this.log("onTrack()","emitting Event.REMOTE_TRACK_ADDED with type=VIDEO"),this.emit(exports.Event.REMOTE_TRACK_ADDED,{type:exports.RemoteTrackType.VIDEO,track:h});break;case p:this.log("onTrack()","emitting Event.REMOTE_TRACK_ADDED with type=SCREENSHARE_VIDEO"),this.emit(exports.Event.REMOTE_TRACK_ADDED,{type:exports.RemoteTrackType.SCREENSHARE_VIDEO,track:h});break;default:this.error("onTrack()","failed to match remote track media id: ".concat(v))}}},{key:"addLocalTracks",value:function(){this.log("addLocalTracks()","adding tracks ".concat(B()(this.localTracks))),this.localTracks.audio&&this.pc.addTrack(this.localTracks.audio),this.localTracks.video&&this.pc.addTrack(this.localTracks.video),this.localTracks.screenShareVideo&&this.pc.addTrack(this.localTracks.screenShareVideo)}},{key:"onConnectionStateChange",value:function(){this.log("onConnectionStateChange()","callback called: connectionState=".concat(this.pc.connectionState)),this.evaluateMediaConnectionState()}},{key:"onIceConnectionStateChange",value:function(){this.log("onIceConnectionStateChange()","callback called: iceConnectionState=".concat(this.pc.iceConnectionState)),this.evaluateMediaConnectionState()}},{key:"evaluateMediaConnectionState",value:function(){var e=this.pc.connectionState,t=this.pc.iceConnectionState,n=[e,t];n.some((function(e){return"closed"===e}))?this.mediaConnectionState=exports.ConnectionState.Closed:n.some((function(e){return"failed"===e}))?this.mediaConnectionState=exports.ConnectionState.Failed:n.some((function(e){return"disconnected"===e}))?this.mediaConnectionState=exports.ConnectionState.Disconnected:n.every((function(e){return"connected"===e||"completed"===e}))?this.mediaConnectionState=exports.ConnectionState.Connected:this.mediaConnectionState=exports.ConnectionState.Connecting,this.log("evaluateConnectionState","iceConnectionState=".concat(t," rtcPcConnectionState=").concat(e," => mediaConnectionState=").concat(this.mediaConnectionState)),this.lastEmittedMediaConnectionState!==this.mediaConnectionState&&(this.emit(exports.Event.CONNECTION_STATE_CHANGED,{state:this.mediaConnectionState}),this.lastEmittedMediaConnectionState=this.mediaConnectionState)}},{key:"createSdpMungingConfig",value:function(){if(this.receiveOptions.remoteQualityLevel){var e={LOW:1620,MEDIUM:3600,HIGH:8192};if(!e[this.receiveOptions.remoteQualityLevel])throw new Error("invalid value for receiveOptions.remoteQualityLevel: ".concat(this.receiveOptions.remoteQualityLevel));return this.config.sdpMunging.h264MaxFs&&this.warn("createSdpMungingConfig","conflict: both config.sdpMunging.h264MaxFs and receiveOptions.remoteQualityLevel are set, remoteQualityLevel will override the config"),Wc(Wc({},this.config.sdpMunging),{},{h264MaxFs:e[this.receiveOptions.remoteQualityLevel]})}return this.config.sdpMunging}},{key:"createLocalOffer",value:function(){var e=this,t=this.createSdpMungingConfig();return this.pc.createOffer().then((function(n){e.log("createLocalOffer","local SDP offer created");var r={type:n.type,sdp:Cr(t,(null==n?void 0:n.sdp)||"")};return e.pc.setLocalDescription(r)})).then((function(){return e.waitForIceCandidates()})).then((function(){var n;return{sdp:Rr(t,(null===(n=e.pc.localDescription)||void 0===n?void 0:n.sdp)||"")}})).catch((function(e){throw e instanceof an||e instanceof rn?e:new dn("createLocalOffer() failure: ".concat(e.message),{cause:e})}))}},{key:"handleRemoteOffer",value:function(e){var t=this;if(this.log("handleRemoteOffer","called"),!e)return ne().reject(new pn("SDP missing"));var n=Tr(this.config.sdpMunging,e),r=this.createSdpMungingConfig();return this.pc.setRemoteDescription(new window.RTCSessionDescription({type:"offer",sdp:n})).then((function(){return t.pc.createAnswer()})).then((function(e){var n={type:e.type,sdp:Cr(r,(null==e?void 0:e.sdp)||"")};return t.pc.setLocalDescription(n)})).then((function(){return t.waitForIceCandidates()})).then((function(){var e;return{sdp:Rr(r,(null===(e=t.pc.localDescription)||void 0===e?void 0:e.sdp)||"")}})).catch((function(e){throw e instanceof an||e instanceof rn?e:new pn("handleRemoteOffer() failure: ".concat(e.message),{cause:e})}))}},{key:"handleRemoteAnswer",value:function(e){if(this.log("handleRemoteAnswer","called"),!e)return ne().reject(new cn("SDP answer missing"));var t=Tr(this.config.sdpMunging,e);return this.pc.setRemoteDescription(new window.RTCSessionDescription({type:"answer",sdp:t})).catch((function(e){throw new cn("handleRemoteAnswer() failure: ".concat(e.message),{cause:e})}))}},{key:"waitForIceCandidates",value:function(){var e=this;return new(ne())((function(t,n){var r=performance.now(),i=!1,o=function(){var t;return function(e,t){if(!t)return new Error("SDP is missing");var n,r=Re(gr(t).avMedia);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!i.iceInfo.candidates.length)return new an("ice candidates missing for m-line with mid=".concat(i.mid));if(!e.allowPort0&&0===i.port)return new rn("Found invalid port number 0 at m-line with mid=".concat(i.mid));if(!i.iceInfo.pwd||!i.iceInfo.ufrag)return new an("ice ufrag and password not found for m-line with mid=".concat(i.mid));if(e.requireH264&&"video"===i.type&&!yr(i))return new rn("H264 codec is missing for video media description with mid=".concat(i.mid))}}catch(e){r.e(e)}finally{r.f()}return!1}({allowPort0:!!e.config.sdpMunging.convertPort9to0,requireH264:!!e.config.requireH264},null===(t=e.pc.localDescription)||void 0===t?void 0:t.sdp)},a=function(){if(!i){var a=performance.now()-r;e.log("waitForIceCandidates()","checking SDP...");var s=o();s&&(e.error("waitForIceCandidates()","SDP not valid after waiting: ".concat(s.message)),n(s)),e.log("waitForIceCandidates()","It took ".concat(a," milliseconds to gather ice candidates")),i=!0,e.pc.onicegatheringstatechange=null,e.pc.onicecandidate=null,e.pc.onicecandidateerror=null,t()}};if("complete"===e.pc.iceGatheringState&&!1===o())return e.log("waitForIceCandidates()",'iceGatheringState is already "complete" and local SDP is valid'),void t();e.log("waitForIceCandidates()","waiting for ICE candidates to be gathered..."),e.pc.onicegatheringstatechange=function(){e.log("waitForIceCandidates()","iceGatheringState changed to ".concat(e.pc.iceGatheringState)),"complete"===e.pc.iceGatheringState&&a()},e.pc.onicecandidate=function(t){var n,r;null===t.candidate?(e.log("waitForIceCandidates()","evt.candidate === null received"),a()):e.log("waitForIceCandidates()","ICE Candidate(".concat(null===(n=t.candidate)||void 0===n?void 0:n.sdpMLineIndex,"): ").concat(null===(r=t.candidate)||void 0===r?void 0:r.candidate))},e.pc.onicecandidateerror=function(t){e.warn("waitForIceCandidates()","onicecandidateerror: ".concat(t))}}))}}]),n}(vn),Kc=!0,qc=!0;function Yc(e,t,n){var r=e.match(t);return r&&r.length>=n&&k()(r[n],10)}function zc(e,t,n){if(e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);var o=function(e){var t=n(e);t&&(r.handleEvent?r.handleEvent(t):r(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new($())),this._eventMap[t].set(r,o),i.apply(this,[e,o])};var o=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(n))return o.apply(this,arguments);var r=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===T()(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,r])},S()(r,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}}function Xc(e){return"boolean"!=typeof e?new Error("Argument type: "+(0,m.Z)(e)+". Please use a boolean."):(Kc=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function Jc(e){return"boolean"!=typeof e?new Error("Argument type: "+(0,m.Z)(e)+". Please use a boolean."):(qc=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function $c(){if("object"===("undefined"==typeof window?"undefined":(0,m.Z)(window))){if(Kc)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function Qc(e,t){qc&&console.warn(e+" is deprecated, please use "+t+" instead.")}function eu(e){return"[object Object]"===Object.prototype.toString.call(e)}function tu(e){return eu(e)?T()(e).reduce((function(t,n){var r=eu(e[n]),i=r?tu(e[n]):e[n],a=r&&!T()(i).length;return void 0===i||a?t:de()(t,(0,o.Z)({},n,i))}),{}):e}function nu(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),T()(t).forEach((function(r){r.endsWith("Id")?nu(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach((function(t){nu(e,e.get(t),n)}))})))}function ru(e,t,n){var r=n?"outbound-rtp":"inbound-rtp",i=new($());if(null===t)return i;var o=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((function(t){e.forEach((function(n){n.type===r&&n.trackId===t.id&&nu(e,n,i)}))})),i}var iu=$c;function ou(e,t){var n=e&&e.navigator;if(n.mediaDevices){var r=function(e){if("object"!==(0,m.Z)(e)||e.mandatory||e.optional)return e;var t={};return T()(e).forEach((function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"===(0,m.Z)(e[n])?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var o={};"number"==typeof r.ideal?(o[i("min",n)]=r.ideal,t.optional.push(o),(o={})[i("max",n)]=r.ideal,t.optional.push(o)):(o[i("",n)]=r.ideal,t.optional.push(o))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach((function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},i=function(e,i){if(t.version>=61)return i(e);if((e=JSON.parse(B()(e)))&&"object"===(0,m.Z)(e.audio)){var o=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};o((e=JSON.parse(B()(e))).audio,"autoGainControl","googAutoGainControl"),o(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=r(e.audio)}if(e&&"object"===(0,m.Z)(e.video)){var a=e.video.facingMode;a=a&&("object"===(0,m.Z)(a)?a:{ideal:a});var s,c=t.version<66;if(a&&("user"===a.exact||"environment"===a.exact||"user"===a.ideal||"environment"===a.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||c))if(delete e.video.facingMode,"environment"===a.exact||"environment"===a.ideal?s=["back","rear"]:"user"!==a.exact&&"user"!==a.ideal||(s=["front"]),s)return n.mediaDevices.enumerateDevices().then((function(t){var n=(t=t.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return s.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!n&&t.length&&s.includes("back")&&(n=t[t.length-1]),n&&(e.video.deviceId=a.exact?{exact:n.deviceId}:{ideal:n.deviceId}),e.video=r(e.video),iu("chrome: "+B()(e)),i(e)}));e.video=r(e.video)}return iu("chrome: "+B()(e)),i(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,r){i(e,(function(e){n.webkitGetUserMedia(e,t,(function(e){r&&r(o(e))}))}))}.bind(n),n.mediaDevices.getUserMedia){var a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(e){return i(e,(function(e){return a(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return ne().reject(o(e))}))}))}}}}function au(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function su(e){if("object"===(0,m.Z)(e)&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){S()(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.track.id})):{track:r.track};var o=new Event("track");o.track=r.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)})),t.stream.getTracks().forEach((function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.id})):{track:r};var o=new Event("track");o.track=r,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else zc(e,"track",(function(e){return e.transceiver||S()(e,"transceiver",{value:{receiver:e.receiver}}),e}))}function cu(e){if("object"===(0,m.Z)(e)&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){var i=n.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((function(e){n._senders.push(t(n,e))}))};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach((function(e){var n=t._senders.find((function(t){return t.track===e}));n&&t._senders.splice(t._senders.indexOf(n),1)}))}}else if("object"===(0,m.Z)(e)&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=a.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},S()(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function uu(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,n=Array.prototype.slice.call(arguments),r=n[0],i=n[1],o=n[2];if(arguments.length>0&&"function"==typeof r)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof r))return t.apply(this,[]);var a=function(e){var t={};return e.result().forEach((function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){n[t]=e.stat(t)})),t[n.id]=n})),t},s=function(e){return new($())(T()(e).map((function(t){return[t,e[t]]})))};if(arguments.length>=2){return t.apply(this,[function(e){i(s(a(e)))},r])}return new(ne())((function(n,r){t.apply(e,[function(e){n(s(a(e)))},r])})).then(i,o)}}}function du(e){if("object"===(0,m.Z)(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return ru(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var r=e.RTCPeerConnection.prototype.getReceivers;r&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=r.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),zc(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return ru(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t,n,r,o=arguments[0];return this.getSenders().forEach((function(e){e.track===o&&(t?r=!0:t=e)})),this.getReceivers().forEach((function(e){return e.track===o&&(n?r=!0:n=e),e.track===o})),r||t&&n?ne().reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():ne().reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return i.apply(this,arguments)}}}}function lu(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},T()(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var r=this.getSenders();n.apply(this,arguments);var i=this.getSenders().filter((function(e){return-1===r.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(i)};var r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&T()(this._shimmedLocalStreams).forEach((function(n){var r=t._shimmedLocalStreams[n].indexOf(e);-1!==r&&t._shimmedLocalStreams[n].splice(r,1),1===t._shimmedLocalStreams[n].length&&delete t._shimmedLocalStreams[n]})),i.apply(this,arguments)}}function fu(e,t){if(e.RTCPeerConnection){if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return lu(e);var n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=n.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var n=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(n.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var i=new e.MediaStream(t.getTracks());this._streams[t.id]=i,this._reverseStreams[i.id]=t,t=i}r.apply(this,[t])};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((function(e){return e.track===t})))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var o=this._streams[n.id];if(o)o.addTrack(t),ne().resolve().then((function(){r.dispatchEvent(new Event("negotiationneeded"))}));else{var a=new e.MediaStream([t]);this._streams[n.id]=a,this._reverseStreams[a.id]=n,this.addStream(a)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=(0,o.Z)({},t,(function(){var e=this,t=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[function(n){var r=c(e,n);t[0].apply(null,[r])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):n.apply(this,arguments).then((function(t){return c(e,t)}))}));e.RTCPeerConnection.prototype[t]=r[t]}));var a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){var n=t.sdp;return T()(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})}(this,arguments[0]),a.apply(this,arguments)):a.apply(this,arguments)};var s=b()(e.RTCPeerConnection.prototype,"localDescription");S()(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=s.get.apply(this);return""===e.type?e:c(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},T()(this._streams).forEach((function(r){n._streams[r].getTracks().find((function(t){return e.track===t}))&&(t=n._streams[r])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function c(e,t){var n=t.sdp;return T()(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(i.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:n})}}function pu(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=(0,o.Z)({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=r[t]}))}function hu(e,t){zc(e,"negotiationneeded",(function(e){var n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e}))}var vu=I()({__proto__:null,shimMediaStream:au,shimOnTrack:su,shimGetSendersWithDtmf:cu,shimGetStats:uu,shimSenderReceiverGetStats:du,shimAddTrackRemoveTrackWithNative:lu,shimAddTrackRemoveTrack:fu,shimPeerConnection:pu,fixNegotiationNeeded:hu,shimGetUserMedia:ou,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((function(t){var r=n.video&&n.video.width,i=n.video&&n.video.height,o=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}});function mu(e,t){var n=e&&e.navigator,r=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,r){Qc("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,r)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var i=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},o=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"===(0,m.Z)(e)&&"object"===(0,m.Z)(e.audio)&&(e=JSON.parse(B()(e)),i(e.audio,"autoGainControl","mozAutoGainControl"),i(e.audio,"noiseSuppression","mozNoiseSuppression")),o(e)},r&&r.prototype.getSettings){var a=r.prototype.getSettings;r.prototype.getSettings=function(){var e=a.apply(this,arguments);return i(e,"mozAutoGainControl","autoGainControl"),i(e,"mozNoiseSuppression","noiseSuppression"),e}}if(r&&r.prototype.applyConstraints){var s=r.prototype.applyConstraints;r.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===(0,m.Z)(e)&&(e=JSON.parse(B()(e)),i(e,"autoGainControl","mozAutoGainControl"),i(e,"noiseSuppression","mozNoiseSuppression")),s.apply(this,[e])}}}}function gu(e){"object"===(0,m.Z)(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&S()(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function Eu(e,t){if("object"===(0,m.Z)(e)&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=(0,o.Z)({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=r[t]}));var n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),i=e[0],o=e[1],a=e[2];return r.apply(this,[i||null]).then((function(e){if(t.version<53&&!o)try{e.forEach((function(e){e.type=n[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach((function(t,r){e.set(r,de()({},t,{type:n[t.type]||t.type}))}))}return e})).then(o,a)}}}function yu(e){if("object"===(0,m.Z)(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpSender.prototype))){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):ne().resolve(new($()))}}}function Su(e){if("object"===(0,m.Z)(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpReceiver.prototype))){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n}),zc(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}}function _u(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;Qc("removeStream","removeTrack"),this.getSenders().forEach((function(n){n.track&&e.getTracks().includes(n.track)&&t.removeTrack(n)}))})}function Cu(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function Ru(e){if("object"===(0,m.Z)(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1]&&arguments[1].sendEncodings;void 0===e&&(e=[]);var n=(e=(0,c.Z)(e)).length>0;n&&e.forEach((function(e){if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(O()(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(O()(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var r=t.apply(this,arguments);if(n){var i=r.sender,o=i.getParameters();(!("encodings"in o)||1===o.encodings.length&&0===T()(o.encodings[0]).length)&&(o.encodings=e,i.sendEncodings=e,this.setParametersPromises.push(i.setParameters(o).then((function(){delete i.sendEncodings})).catch((function(){delete i.sendEncodings}))))}return r})}}function Tu(e){if("object"===(0,m.Z)(e)&&e.RTCRtpSender){var t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){var e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}}function xu(e){if("object"===(0,m.Z)(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?ne().all(this.setParametersPromises).then((function(){return t.apply(n,e)})).finally((function(){n.setParametersPromises=[]})):t.apply(this,arguments)}}}function bu(e){if("object"===(0,m.Z)(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?ne().all(this.setParametersPromises).then((function(){return t.apply(n,e)})).finally((function(){n.setParametersPromises=[]})):t.apply(this,arguments)}}}var wu=I()({__proto__:null,shimOnTrack:gu,shimPeerConnection:Eu,shimSenderGetStats:yu,shimReceiverGetStats:Su,shimRemoveStream:_u,shimRTCDataChannel:Cu,shimAddTransceiver:Ru,shimGetParameters:Tu,shimCreateOffer:xu,shimCreateAnswer:bu,shimGetUserMedia:mu,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){var r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,ne().reject(r)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}});function Iu(e){if("object"===(0,m.Z)(e)&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((function(r){return t.call(n,r,e)})),e.getVideoTracks().forEach((function(r){return t.call(n,r,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var n=this,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return i&&i.forEach((function(e){n._localStreams?n._localStreams.includes(e)||n._localStreams.push(e):n._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var n=this._localStreams.indexOf(e);if(-1!==n){this._localStreams.splice(n,1);var r=e.getTracks();this.getSenders().forEach((function(e){r.includes(e.track)&&t.removeTrack(e)}))}})}}function Lu(e){if("object"===(0,m.Z)(e)&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){S()(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var n=new Event("addstream");n.stream=e,t.dispatchEvent(n)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}}))}),t.apply(e,arguments)}}}function Ou(e){if("object"===(0,m.Z)(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,i=t.setLocalDescription,o=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),ne().resolve()):i},t.createAnswer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),ne().resolve()):i};var s=function(e,t,n){var r=i.apply(this,[e]);return n?(r.then(t,n),ne().resolve()):r};t.setLocalDescription=s,s=function(e,t,n){var r=o.apply(this,[e]);return n?(r.then(t,n),ne().resolve()):r},t.setRemoteDescription=s,s=function(e,t,n){var r=a.apply(this,[e]);return n?(r.then(t,n),ne().resolve()):r},t.addIceCandidate=s}}function Au(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var n=t.mediaDevices,r=n.getUserMedia.bind(n);t.mediaDevices.getUserMedia=function(e){return r(ku(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))}function ku(e){return e&&void 0!==e.video?de()({},e,{video:tu(e.video)}):e}function Mu(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){for(var r=[],i=0;i<e.iceServers.length;i++){var o=e.iceServers[i];!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")?(Qc("RTCIceServer.url","RTCIceServer.urls"),(o=JSON.parse(B()(o))).urls=o.url,delete o.url,r.push(o)):r.push(e.iceServers[i])}e.iceServers=r}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&S()(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})}}function Nu(e){"object"===(0,m.Z)(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&S()(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function Du(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var n=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveAudio||n||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var r=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveVideo||r||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function Pu(e){"object"!==(0,m.Z)(e)||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var Fu=I()({__proto__:null,shimLocalStreamsAPI:Iu,shimRemoteStreamsAPI:Lu,shimCallbacksAPI:Ou,shimGetUserMedia:Au,shimConstraints:ku,shimRTCIceServerUrls:Mu,shimTrackEventTransceiver:Nu,shimCreateOfferLegacy:Du,shimAudioContext:Pu}),Uu={exports:{}};!function(e){var t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},t.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},t.getDescription=function(e){var n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){var n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter((function(e){return 0===e.indexOf(n)}))},t.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:k()(t[3],10),ip:t[4],address:t[4],port:k()(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=k()(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:void 0===n[t[r]]&&(n[t[r]]=t[r+1])}return n},t.writeCandidate=function(e){var t=[];t.push(e.foundation);var n=e.component;"rtp"===n?t.push(1):"rtcp"===n?t.push(2):t.push(n),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:k()(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=k()(t[1],10),n.channels=3===t.length?k()(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:k()(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)n[(t=r[i].trim().split("="))[0].trim()]=t[1];return n},t.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&T()(e.parameters).length){var r=[];T()(e.parameters).forEach((function(t){void 0!==e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)})),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:k()(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},t.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return k()(e,10)}))}},t.getMid=function(e){var n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substr(6)},t.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},t.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:k()(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"===(0,m.Z)(e.keyParams)?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){var r=t.matchPrefix(e+n,"a=ice-ufrag:")[0],i=t.matchPrefix(e+n,"a=ice-pwd:")[0];return r&&i?{usernameFragment:r.substr(12),password:i.substr(10)}:null},t.writeIceParameters=function(e){var t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){for(var n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=t.splitLines(e)[0].split(" "),i=3;i<r.length;i++){var o=r[i],a=t.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){var s=t.parseRtpMap(a),c=t.matchPrefix(e,"a=fmtp:"+o+" ");switch(s.parameters=c.length?t.parseFmtp(c[0]):{},s.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(t.parseRtcpFb),n.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(s.name.toUpperCase())}}}return t.matchPrefix(e,"a=extmap:").forEach((function(e){n.headerExtensions.push(t.parseExtmap(e))})),n},t.writeRtpDescription=function(e,n){var r="";r+="m="+e+" ",r+=n.codecs.length>0?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=n.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach((function(e){r+=t.writeRtpMap(e),r+=t.writeFmtp(e),r+=t.writeRtcpFb(e)}));var i=0;return n.codecs.forEach((function(e){e.maxptime>i&&(i=e.maxptime)})),i>0&&(r+="a=maxptime:"+i+"\r\n"),n.headerExtensions&&n.headerExtensions.forEach((function(e){r+=t.writeExtmap(e)})),r},t.parseRtpEncodingParameters=function(e){var n,r=[],i=t.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),a=-1!==i.fecMechanisms.indexOf("ULPFEC"),s=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=s.length>0&&s[0].ssrc,u=t.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return k()(e,10)}))}));u.length>0&&u[0].length>1&&u[0][0]===c&&(n=u[0][1]),i.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:c,codecPayloadType:k()(e.parameters.apt,10)};c&&n&&(t.rtx={ssrc:n}),r.push(t),o&&((t=JSON.parse(B()(t))).fec={ssrc:c,mechanism:a?"red+ulpfec":"red"},r.push(t))}})),0===r.length&&c&&r.push({ssrc:c});var d=t.matchPrefix(e,"b=");return d.length&&(d=0===d[0].indexOf("b=TIAS:")?k()(d[0].substr(7),10):0===d[0].indexOf("b=AS:")?1e3*k()(d[0].substr(5),10)*.95-16e3:void 0,r.forEach((function(e){e.maxBitrate=d}))),r},t.parseRtcpParameters=function(e){var n={},r=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];r&&(n.cname=r.value,n.ssrc=r.ssrc);var i=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=i.length>0,n.compound=0===i.length;var o=t.matchPrefix(e,"a=rtcp-mux");return n.mux=o.length>0,n},t.writeRtcpParameters=function(e){var t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){var n,r=t.matchPrefix(e,"a=msid:");if(1===r.length)return{stream:(n=r[0].substr(7).split(" "))[0],track:n[1]};var i=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return i.length>0?{stream:(n=i[0].value.split(" "))[0],track:n[1]}:void 0},t.parseSctpDescription=function(e){var n,r=t.parseMLine(e),i=t.matchPrefix(e,"a=max-message-size:");i.length>0&&(n=k()(i[0].substr(19),10)),isNaN(n)&&(n=65536);var o=t.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:k()(o[0].substr(12),10),protocol:r.fmt,maxMessageSize:n};var a=t.matchPrefix(e,"a=sctpmap:");if(a.length>0){var s=a[0].substr(10).split(" ");return{port:k()(s[0],10),protocol:s[1],maxMessageSize:n}}},t.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,n,r){var i=void 0!==n?n:2;return"v=0\r\no="+(r||"thisisadapterortc")+" "+(e||t.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,n){for(var r=t.splitLines(e),i=0;i<r.length;i++)switch(r[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[i].substr(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){var n=t.splitLines(e)[0].substr(2).split(" ");return{kind:n[0],port:k()(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){var n=t.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:k()(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var n=t.splitLines(e),r=0;r<n.length;r++)if(n[r].length<2||"="!==n[r].charAt(1))return!1;return!0},e.exports=t}(Uu);var Zu=Uu.exports,Vu=Ae({__proto__:null,default:Zu},[Uu.exports]);function Gu(e){if(!(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===(0,m.Z)(e)&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(B()(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var n=new t(e),r=Zu.parseCandidate(e.candidate),i=de()(n,r);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,zc(e,"icecandidate",(function(t){return t.candidate&&S()(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}}function Bu(e,t){if(e.RTCPeerConnection){"sctp"in e.RTCPeerConnection.prototype||S()(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var n=function(e){if(!e||!e.sdp)return!1;var t=Zu.splitSections(e.sdp);return t.shift(),t.some((function(e){var t=Zu.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))},r=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var n=k()(t[1],10);return n!=n?-1:n},i=function(e){var n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n},o=function(e,n){var r=65536;"firefox"===t.browser&&57===t.version&&(r=65535);var i=Zu.matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?r=k()(i[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(r=2147483637),r},a=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){(this._sctp=null,"chrome"===t.browser&&t.version>=76)&&("plan-b"===this.getConfiguration().sdpSemantics&&S()(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0}));if(n(arguments[0])){var e,s=r(arguments[0]),c=i(s),u=o(arguments[0],s);e=0===c&&0===u?Number.POSITIVE_INFINITY:0===c||0===u?Math.max(c,u):Math.min(c,u);var d={};S()(d,"maxMessageSize",{get:function(){return e}}),this._sctp=d}return a.apply(this,arguments)}}}function Wu(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return n(e,this),e},zc(e,"datachannel",(function(e){return n(e.channel,e.target),e}))}function n(e,t){var n=e.send;e.send=function(){var r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}}function ju(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;S()(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),S()(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}}function Hu(e,t){if(e.RTCPeerConnection&&!("chrome"===t.browser&&t.version>=71||"safari"===t.browser&&t.version>=605)){var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){var r=t.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:r}):t.sdp=r}return n.apply(this,arguments)}}}function Ku(e,t){if(e.RTCPeerConnection&&e.RTCPeerConnection.prototype){var n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?ne().resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),ne().resolve())})}}function qu(e,t){if(e.RTCPeerConnection&&e.RTCPeerConnection.prototype){var n=e.RTCPeerConnection.prototype.setLocalDescription;n&&0!==n.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){var e=this,t=arguments[0]||{};if("object"!==(0,m.Z)(t)||t.type&&t.sdp)return n.apply(this,arguments);if(!(t={type:t.type,sdp:t.sdp}).type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":t.type="offer";break;default:t.type="answer"}return t.sdp||"offer"!==t.type&&"answer"!==t.type?n.apply(this,[t]):("offer"===t.type?this.createOffer:this.createAnswer).apply(this).then((function(t){return n.apply(e,[t])}))})}}var Yu=I()({__proto__:null,shimRTCIceCandidate:Gu,shimMaxMessageSize:Bu,shimSendThrowTypeError:Wu,shimConnectionState:ju,removeExtmapAllowMixed:Hu,shimAddIceCandidateNullOrEmpty:Ku,shimParameterlessSetLocalDescription:qu});!function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).window,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0},n=$c,r=function(e){var t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;var n=e.navigator;if(n.mozGetUserMedia)t.browser="firefox",t.version=Yc(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=Yc(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=Yc(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(e),i={browserDetails:r,commonShim:Yu,extractVersion:Yc,disableLog:Xc,disableWarnings:Jc,sdp:Vu};switch(r.browser){case"chrome":if(!vu||!pu||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),i;if(null===r.version)return n("Chrome shim can not determine version, not shimming."),i;n("adapter.js shimming chrome."),i.browserShim=vu,Ku(e,r),qu(e),ou(e,r),au(e),pu(e,r),su(e),fu(e,r),cu(e),uu(e),du(e),hu(e,r),Gu(e),ju(e),Bu(e,r),Wu(e),Hu(e,r);break;case"firefox":if(!wu||!Eu||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),i;n("adapter.js shimming firefox."),i.browserShim=wu,Ku(e,r),qu(e),mu(e,r),Eu(e,r),gu(e),_u(e),yu(e),Su(e),Cu(e),Ru(e),Tu(e),xu(e),bu(e),Gu(e),ju(e),Bu(e,r),Wu(e);break;case"safari":if(!Fu||!t.shimSafari)return n("Safari shim is not included in this adapter release."),i;n("adapter.js shimming safari."),i.browserShim=Fu,Ku(e,r),qu(e),Mu(e),Du(e),Ou(e),Iu(e),Lu(e),Nu(e),Au(e),Pu(e),Gu(e),Bu(e,r),Wu(e),Hu(e,r);break;default:n("Unsupported browser!")}}({window:"undefined"==typeof window?void 0:window});var zu,Xu,Ju=function(){return Ju=de()||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ju.apply(this,arguments)};function $u(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof K()){var i=0;for(r=K()(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function Qu(e){var t="function"==typeof me()&&Ce(),n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ed(e,t){var n="function"==typeof me()&&e[Ce()];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function td(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}!function(e){e.Start="xstate.start",e.Stop="xstate.stop",e.Raise="xstate.raise",e.Send="xstate.send",e.Cancel="xstate.cancel",e.NullEvent="",e.Assign="xstate.assign",e.After="xstate.after",e.DoneState="done.state",e.DoneInvoke="done.invoke",e.Log="xstate.log",e.Init="xstate.init",e.Invoke="xstate.invoke",e.ErrorExecution="error.execution",e.ErrorCommunication="error.communication",e.ErrorPlatform="error.platform",e.ErrorCustom="xstate.error",e.Update="xstate.update",e.Pure="xstate.pure",e.Choose="xstate.choose"}(zu||(zu={})),function(e){e.Parent="#_parent",e.Internal="#_internal"}(Xu||(Xu={}));var nd=zu.Start,rd=zu.Stop,id=zu.Raise,od=zu.Send,ad=zu.Cancel,sd=zu.NullEvent,cd=zu.Assign;zu.After,zu.DoneState;var ud=zu.Log,dd=zu.Init,ld=zu.Invoke;zu.ErrorExecution;var fd,pd=zu.ErrorPlatform,hd=zu.ErrorCustom,vd=zu.Update,md=zu.Choose,gd=zu.Pure,Ed=".",yd={},Sd="xstate.guard",_d="",Cd="production"===at.env.NODE_ENV;function Rd(e,t,n){void 0===n&&(n=Ed);var r=bd(e,n),i=bd(t,n);return Wd(i)?!!Wd(r)&&i===r:Wd(r)?r in i:T()(r).every((function(e){return e in i&&Rd(r[e],i[e])}))}function Td(e){try{return Wd(e)||"number"==typeof e?"".concat(e):e.type}catch(e){throw new Error("Events must be strings or objects with a string event.type property.")}}function xd(e,t){try{return Gd(e)?e:e.toString().split(t)}catch(t){throw new Error("'".concat(e,"' is not a valid state path."))}}function bd(e,t){return n=e,"object"===(0,m.Z)(n)&&"value"in n&&"context"in n&&"event"in n&&"_event"in n?e.value:Gd(e)?wd(e):"string"!=typeof e?e:wd(xd(e,t));var n}function wd(e){if(1===e.length)return e[0];for(var t={},n=t,r=0;r<e.length-1;r++)r===e.length-2?n[e[r]]=e[r+1]:(n[e[r]]={},n=n[e[r]]);return t}function Id(e,t){for(var n={},r=T()(e),i=0;i<r.length;i++){var o=r[i];n[o]=t(e[o],o,e,i)}return n}function Ld(e,t,n){var r,i,o={};try{for(var a=Qu(T()(e)),s=a.next();!s.done;s=a.next()){var c=s.value,u=e[c];n(u)&&(o[c]=t(u,c,e))}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return o}var Od=function(e){return function(t){var n,r,i=t;try{for(var o=Qu(e),a=o.next();!a.done;a=o.next()){i=i[a.value]}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}};function Ad(e){return e?Wd(e)?[[e]]:kd(T()(e).map((function(t){var n=e[t];return"string"==typeof n||n&&T()(n).length?Ad(e[t]).map((function(e){return[t].concat(e)})):[[t]]}))):[[]]}function kd(e){var t;return(t=[]).concat.apply(t,td([],ed(e),!1))}function Md(e){return Gd(e)?e:[e]}function Nd(e){return void 0===e?[]:Md(e)}function Dd(e,t,n){var r,i;if(Bd(e))return e(t,n.data);var o={};try{for(var a=Qu(T()(e)),s=a.next();!s.done;s=a.next()){var c=s.value,u=e[c];Bd(u)?o[c]=u(t,n.data):o[c]=u}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return o}function Pd(e){return e instanceof ne()||!(null===e||!Bd(e)&&"object"!==(0,m.Z)(e)||!Bd(e.then))}function Fd(e,t){var n,r,i=ed([[],[]],2),o=i[0],a=i[1];try{for(var s=Qu(e),c=s.next();!c.done;c=s.next()){var u=c.value;t(u)?o.push(u):a.push(u)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return[o,a]}function Ud(e,t){return Id(e.states,(function(e,n){if(e){var r=(Wd(t)?void 0:t[n])||(e?e.current:void 0);if(r)return{current:r,states:Ud(e,r)}}}))}function Zd(e,t,n,r){Cd||Vd(!!e,"Attempting to update undefined context");var i=e?n.reduce((function(e,n){var i,o,a=n.assignment,s={state:r,action:n,_event:t},c={};if(Bd(a))c=a(e,t.data,s);else try{for(var u=Qu(T()(a)),d=u.next();!d.done;d=u.next()){var l=d.value,f=a[l];c[l]=Bd(f)?f(e,t.data,s):f}}catch(e){i={error:e}}finally{try{d&&!d.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}return de()({},e,c)}),e):e;return i}var Vd=function(){};function Gd(e){return C()(e)}function Bd(e){return"function"==typeof e}function Wd(e){return"string"==typeof e}function jd(e,t){if(e)return Wd(e)?{type:Sd,name:e,predicate:t?t[e]:void 0}:Bd(e)?{type:Sd,name:e.name,predicate:e}:e}Cd||(Vd=function(e,t){var n=e instanceof Error?e:void 0;if((n||!e)&&void 0!==console){var r=["Warning: ".concat(t)];n&&r.push(n),console.warn.apply(console,r)}});var Hd=function(){return"function"==typeof me()&&me().observable||"@@observable"}();function Kd(e){return!!e&&"__xstatenode"in e}function qd(e,t){return Wd(e)||"number"==typeof e?Ju({type:e},t):e}function Yd(e,t){if(!Wd(e)&&"$$type"in e&&"scxml"===e.$$type)return e;var n=qd(e);return Ju({name:n.type,data:n,$$type:"scxml",type:"external"},t)}function zd(e,t){return Md(t).map((function(t){return void 0===t||"string"==typeof t||Kd(t)?{target:t,event:e}:Ju(Ju({},t),{event:e})}))}function Xd(e,t,n,r,i){var o=e.options.guards,a={state:i,cond:t,_event:r};if(t.type===Sd)return((null==o?void 0:o[t.name])||t.predicate)(n,r.data,a);var s=null==o?void 0:o[t.type];if(!s)throw new Error("Guard '".concat(t.type,"' is not implemented on machine '").concat(e.id,"'."));return s(n,r.data,a)}function Jd(e){return"string"==typeof e?{type:e}:e}function $d(e,t,n){var r=function(){},i="object"===(0,m.Z)(e),o=i?e:null;return{next:((i?e.next:e)||r).bind(o),error:((i?e.error:t)||r).bind(o),complete:((i?e.complete:n)||r).bind(o)}}function Qd(e,t){return"".concat(e,":invocation[").concat(t,"]")}(fd={})[Hd]=function(){return this},fd[me().observable]=function(){return this};var el=Yd({type:dd});function tl(e,t){return t&&t[e]||void 0}function nl(e,t){var n;if(Wd(e)||"number"==typeof e)n=Bd(r=tl(e,t))?{type:e,exec:r}:r||{type:e,exec:void 0};else if(Bd(e))n={type:e.name||e.toString(),exec:e};else{var r;if(Bd(r=tl(e.type,t)))n=Ju(Ju({},e),{exec:r});else if(r){var i=r.type||e.type;n=Ju(Ju(Ju({},r),e),{type:i})}else n=e}return n}var rl=function(e,t){return e?(Gd(e)?e:[e]).map((function(e){return nl(e,t)})):[]};function il(e){var t=nl(e);return Ju(Ju({id:Wd(e)?e:t.id},t),{type:t.type})}function ol(e){return Wd(e)?{type:id,event:e}:al(e,{to:Xu.Internal})}function al(e,t){return{to:t?t.to:void 0,type:od,event:Bd(e)?e:qd(e),delay:t?t.delay:void 0,id:t&&void 0!==t.id?t.id:Bd(e)?e.name:Td(e)}}var sl=function(e,t,n){return Ju(Ju({},e),{value:Wd(e.expr)?e.expr:e.expr(t,n.data,{_event:n})})};function cl(e,t){var n="".concat(zu.DoneState,".").concat(e),r={type:n,data:t,toString:function(){return n}};return r}function ul(e,t){var n="".concat(zu.DoneInvoke,".").concat(e),r={type:n,data:t,toString:function(){return n}};return r}function dl(e,t){var n="".concat(zu.ErrorPlatform,".").concat(e),r={type:n,data:t,toString:function(){return n}};return r}function ll(e,t,n,r,i,o,a){void 0===a&&(a=!1);var s=ed(a?[[],i]:Fd(i,(function(e){return e.type===cd})),2),c=s[0],u=s[1],d=c.length?Zd(n,r,c,t):n,l=a?[n]:void 0,f=kd(u.map((function(n){var i;switch(n.type){case id:return{type:id,_event:Yd(n.event)};case od:var s=function(e,t,n,r){var i,o={_event:n},a=Yd(Bd(e.event)?e.event(t,n.data,o):e.event);if(Wd(e.delay)){var s=r&&r[e.delay];i=Bd(s)?s(t,n.data,o):s}else i=Bd(e.delay)?e.delay(t,n.data,o):e.delay;var c=Bd(e.to)?e.to(t,n.data,o):e.to;return Ju(Ju({},e),{to:c,_event:a,event:a.data,delay:i})}(n,d,r,e.options.delays);return Cd||Vd(!Wd(n.delay)||"number"==typeof s.delay,"No delay reference for delay expression '".concat(n.delay,"' was found on machine '").concat(e.id,"'")),s.to!==Xu.Internal&&(null==o||o(s,d,r)),s;case ud:var c=sl(n,d,r);return null==o||o(c,d,r),c;case md:if(!(h=null===(i=n.conds.find((function(n){var i=jd(n.cond,e.options.guards);return!i||Xd(e,i,d,r,o?void 0:t)})))||void 0===i?void 0:i.actions))return[];var u=ed(ll(e,t,d,r,rl(Nd(h),e.options.actions),o,a),2),f=u[0],p=u[1];return d=p,null==l||l.push(d),f;case gd:var h;if(!(h=n.get(d,r.data)))return[];var v=ed(ll(e,t,d,r,rl(Nd(h),e.options.actions),o,a),2),m=v[0],g=v[1];return d=g,null==l||l.push(d),m;case rd:c=function(e,t,n){var r=Bd(e.activity)?e.activity(t,n.data):e.activity,i="string"==typeof r?{id:r}:r;return{type:zu.Stop,activity:i}}(n,d,r);return null==o||o(c,d,r),c;case cd:d=Zd(d,r,[n],o?void 0:t),null==l||l.push(d);break;default:var E=nl(n,e.options.actions),y=E.exec;if(o)o(E,d,r);else if(y&&l){var S=l.length-1;E=Ju(Ju({},E),{exec:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];y.apply(void 0,td([l[S]],ed(t),!1))}})}return E}})).filter((function(e){return!!e})));return[f,d]}var fl=function(e,t){return t(e)};function pl(e){var t;return(t={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:e}}})[Hd]=function(){return this},t}function hl(e,t,n){var r=pl(t);if(r.deferred=!0,Kd(e)){var i=r.state=fl(void 0,(function(){return(n?e.withContext(n):e).initialState}));r.getSnapshot=function(){return i}}return r}var vl=function(e){return"atomic"===e.type||"final"===e.type};function ml(e){return T()(e.states).map((function(t){return e.states[t]}))}function gl(e){return ml(e).filter((function(e){return"history"!==e.type}))}function El(e){var t=[e];return vl(e)?t:t.concat(kd(gl(e).map(El)))}function yl(e,t){var n,r,i,o,a,s,c,u,d=_l(new(j())(e)),l=new(j())(t);try{for(var f=Qu(l),p=f.next();!p.done;p=f.next())for(var h=(R=p.value).parent;h&&!l.has(h);)l.add(h),h=h.parent}catch(e){n={error:e}}finally{try{p&&!p.done&&(r=f.return)&&r.call(f)}finally{if(n)throw n.error}}var v=_l(l);try{for(var m=Qu(l),g=m.next();!g.done;g=m.next()){if("compound"!==(R=g.value).type||v.get(R)&&v.get(R).length){if("parallel"===R.type)try{for(var E=(a=void 0,Qu(gl(R))),y=E.next();!y.done;y=E.next()){var S=y.value;l.has(S)||(l.add(S),d.get(S)?d.get(S).forEach((function(e){return l.add(e)})):S.initialStateNodes.forEach((function(e){return l.add(e)})))}}catch(e){a={error:e}}finally{try{y&&!y.done&&(s=E.return)&&s.call(E)}finally{if(a)throw a.error}}}else d.get(R)?d.get(R).forEach((function(e){return l.add(e)})):R.initialStateNodes.forEach((function(e){return l.add(e)}))}}catch(e){i={error:e}}finally{try{g&&!g.done&&(o=m.return)&&o.call(m)}finally{if(i)throw i.error}}try{for(var _=Qu(l),C=_.next();!C.done;C=_.next()){var R;for(h=(R=C.value).parent;h&&!l.has(h);)l.add(h),h=h.parent}}catch(e){c={error:e}}finally{try{C&&!C.done&&(u=_.return)&&u.call(_)}finally{if(c)throw c.error}}return l}function Sl(e,t){var n=t.get(e);if(!n)return{};if("compound"===e.type){var r=n[0];if(!r)return{};if(vl(r))return r.key}var i={};return n.forEach((function(e){i[e.key]=Sl(e,t)})),i}function _l(e){var t,n,r=new($());try{for(var i=Qu(e),o=i.next();!o.done;o=i.next()){var a=o.value;r.has(a)||r.set(a,[]),a.parent&&(r.has(a.parent)||r.set(a.parent,[]),r.get(a.parent).push(a))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}function Cl(e,t){return Sl(e,_l(yl([e],t)))}function Rl(e,t){return C()(e)?e.some((function(e){return e===t})):e instanceof j()&&e.has(t)}function Tl(e,t){return"compound"===t.type?gl(t).some((function(t){return"final"===t.type&&Rl(e,t)})):"parallel"===t.type&&gl(t).every((function(t){return Tl(e,t)}))}function xl(e){return new(j())(kd(e.map((function(e){return e.tags}))))}function bl(e,t){if(e===t)return!0;if(void 0===e||void 0===t)return!1;if(Wd(e)||Wd(t))return e===t;var n=T()(e),r=T()(t);return n.length===r.length&&n.every((function(n){return bl(e[n],t[n])}))}var wl=function(){function e(e){var t,n,r=this;this.actions=[],this.activities=yd,this.meta={},this.events=[],this.value=e.value,this.context=e.context,this._event=e._event,this._sessionid=e._sessionid,this.event=this._event.data,this.historyValue=e.historyValue,this.history=e.history,this.actions=e.actions||[],this.activities=e.activities||yd,this.meta=(void 0===(n=e.configuration)&&(n=[]),n.reduce((function(e,t){return void 0!==t.meta&&(e[t.id]=t.meta),e}),{})),this.events=e.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=e.configuration,this.transitions=e.transitions,this.children=e.children,this.done=!!e.done,this.tags=null!==(t=C()(e.tags)?new(j())(e.tags):e.tags)&&void 0!==t?t:new(j()),this.machine=e.machine,S()(this,"nextEvents",{get:function(){return function(e){return td([],ed(new(j())(kd(td([],ed(e.map((function(e){return e.ownEvents}))),!1)))),!1)}(r.configuration)}})}return e.from=function(t,n){return t instanceof e?t.context!==n?new e({value:t.value,context:n,_event:t._event,_sessionid:null,historyValue:t.historyValue,history:t.history,actions:[],activities:t.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):t:new e({value:t,context:n,_event:el,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},e.create=function(t){return new e(t)},e.inert=function(t,n){if(t instanceof e){if(!t.actions.length)return t;var r=el;return new e({value:t.value,context:n,_event:r,_sessionid:null,historyValue:t.historyValue,history:t.history,activities:t.activities,configuration:t.configuration,transitions:[],children:{}})}return e.from(t,n)},e.prototype.toStrings=function(e,t){var n=this;if(void 0===e&&(e=this.value),void 0===t&&(t="."),Wd(e))return[e];var r=T()(e);return r.concat.apply(r,td([],ed(r.map((function(r){return n.toStrings(e[r],t).map((function(e){return r+t+e}))}))),!1))},e.prototype.toJSON=function(){var e=this;e.configuration,e.transitions;var t=e.tags;e.machine;var n=$u(e,["configuration","transitions","tags","machine"]);return Ju(Ju({},n),{tags:ee()(t)})},e.prototype.matches=function(e){return Rd(e,this.value)},e.prototype.hasTag=function(e){return this.tags.has(e)},e.prototype.can=function(e){var t;Cd&&Vd(!!this.machine,"state.can(...) used outside of a machine-created State object; this will always return false.");var n=null===(t=this.machine)||void 0===t?void 0:t.getTransitionData(this,e);return!!(null==n?void 0:n.transitions.length)&&n.transitions.some((function(e){return void 0!==e.target||e.actions.length}))},e}(),Il={deferEvents:!1},Ll=function(){function e(e){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=Ju(Ju({},Il),e)}return e.prototype.initialize=function(e){if(this.initialized=!0,e){if(!this.options.deferEvents)return void this.schedule(e);this.process(e)}this.flushEvents()},e.prototype.schedule=function(e){if(this.initialized&&!this.processingEvent){if(0!==this.queue.length)throw new Error("Event queue should be empty when it is not processing events");this.process(e),this.flushEvents()}else this.queue.push(e)},e.prototype.clear=function(){this.queue=[]},e.prototype.flushEvents=function(){for(var e=this.queue.shift();e;)this.process(e),e=this.queue.shift()},e.prototype.process=function(e){this.processingEvent=!0;try{e()}catch(e){throw this.clear(),e}finally{this.processingEvent=!1}},e}(),Ol=new($()),Al=0,kl={bookId:function(){return"x:".concat(Al++)},register:function(e,t){return Ol.set(e,t),e},get:function(e){return Ol.get(e)},free:function(e){Ol.delete(e)}};function Ml(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==Pe?Pe:void(Cd||console.warn("XState could not find a global object in this environment. Please let the maintainers know and raise an issue here: https://github.com/statelyai/xstate/issues"))}function Nl(e){if(Ml()){var t=function(){var e=Ml();if(e&&"__xstate__"in e)return e.__xstate__}();t&&t.register(e)}}function Dl(e,t){void 0===t&&(t={});var n=e.initialState,r=new(j()),i=[],o=!1,a=function(e){var t;return Ju(((t={subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}})[Hd]=function(){return this},t),e)}({id:t.id,send:function(t){i.push(t),function(){if(!o){for(o=!0;i.length>0;){var t=i.shift();n=e.transition(n,t,s),r.forEach((function(e){return e.next(n)}))}o=!1}}()},getSnapshot:function(){return n},subscribe:function(e,t,i){var o=$d(e,t,i);return r.add(o),o.next(n),{unsubscribe:function(){r.delete(o)}}}}),s={parent:t.parent,self:a,id:t.id||"anonymous",observers:r};return n=e.start?e.start(s):n,a}var Pl,Fl={sync:!1,autoForward:!1};!function(e){e[e.NotStarted=0]="NotStarted",e[e.Running=1]="Running",e[e.Stopped=2]="Stopped"}(Pl||(Pl={}));var Ul=function(){function e(t,n){var r=this;void 0===n&&(n=e.defaultOptions),this.machine=t,this.delayedEventsMap={},this.listeners=new(j()),this.contextListeners=new(j()),this.stopListeners=new(j()),this.doneListeners=new(j()),this.eventListeners=new(j()),this.sendListeners=new(j()),this.initialized=!1,this.status=Pl.NotStarted,this.children=new($()),this.forwardTo=new(j()),this.init=this.start,this.send=function(e,t){if(Gd(e))return r.batch(e),r.state;var n=Yd(qd(e,t));if(r.status===Pl.Stopped)return Cd||Vd(!1,'Event "'.concat(n.name,'" was sent to stopped service "').concat(r.machine.id,'". This service has already reached its final state, and will not transition.\nEvent: ').concat(B()(n.data))),r.state;if(r.status!==Pl.Running&&!r.options.deferEvents)throw new Error('Event "'.concat(n.name,'" was sent to uninitialized service "').concat(r.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\nEvent: ').concat(B()(n.data)));return r.scheduler.schedule((function(){r.forward(n);var e=r.nextState(n);r.update(e,n)})),r._state},this.sendTo=function(e,t){var n,i=r.parent&&(t===Xu.Parent||r.parent.id===t),o=i?r.parent:Wd(t)?r.children.get(t)||kl.get(t):(n=t)&&"function"==typeof n.send?t:void 0;if(o)"machine"in o?(r.status!==Pl.Stopped||r.parent!==o||r.state.done)&&o.send(Ju(Ju({},e),{name:e.name===hd?"".concat(dl(r.id)):e.name,origin:r.sessionId})):o.send(e.data);else{if(!i)throw new Error("Unable to send event to child '".concat(t,"' from service '").concat(r.id,"'."));Cd||Vd(!1,"Service '".concat(r.id,"' has no parent: unable to send event ").concat(e.type))}},this._exec=function(e,t,n,i){void 0===i&&(i=r.machine.options.actions);var o=e.exec||tl(e.type,i),a=Bd(o)?o:o?o.exec:e.exec;if(a)try{return a(t,n.data,r.machine.config.predictableActionArguments?{action:e,_event:n}:{action:e,state:r.state,_event:n})}catch(e){throw r.parent&&r.parent.send({type:"xstate.error",data:e}),e}switch(e.type){case od:var s=e;if("number"==typeof s.delay)return void r.defer(s);s.to?r.sendTo(s._event,s.to):r.send(s._event);break;case ad:r.cancel(e.sendId);break;case nd:if(r.status!==Pl.Running)return;var c=e.activity;if(!r.machine.config.predictableActionArguments&&!r.state.activities[c.id||c.type])break;if(c.type===zu.Invoke){var u=Jd(c.src),d=r.machine.options.services?r.machine.options.services[u.type]:void 0,l=c.id,f=c.data;Cd||Vd(!("forward"in c),"`forward` property is deprecated (found in invocation of '".concat(c.src,"' in in machine '").concat(r.machine.id,"'). ")+"Please use `autoForward` instead.");var p="autoForward"in c?c.autoForward:!!c.forward;if(!d)return void(Cd||Vd(!1,"No service found for invocation '".concat(c.src,"' in machine '").concat(r.machine.id,"'.")));var h=f?Dd(f,t,n):void 0;if("string"==typeof d)return;var v=Bd(d)?d(t,n.data,{data:h,src:u,meta:c.meta}):d;if(!v)return;var m=void 0;Kd(v)&&(v=h?v.withContext(h):v,m={autoForward:p}),r.spawn(v,l,m)}else r.spawnActivity(c);break;case rd:r.stopChild(e.activity.id);break;case ud:var g=e.label,E=e.value;g?r.logger(g,E):r.logger(E);break;default:Cd||Vd(!1,"No implementation found for action type '".concat(e.type,"'"))}};var i=Ju(Ju({},e.defaultOptions),n),o=i.clock,a=i.logger,s=i.parent,c=i.id,u=void 0!==c?c:t.id;this.id=u,this.logger=a,this.clock=o,this.parent=s,this.options=i,this.scheduler=new Ll({deferEvents:this.options.deferEvents}),this.sessionId=kl.bookId()}return S()(e.prototype,"initialState",{get:function(){var e=this;return this._initialState?this._initialState:fl(this,(function(){return e._initialState=e.machine.initialState,e._initialState}))},enumerable:!1,configurable:!0}),S()(e.prototype,"state",{get:function(){return Cd||Vd(this.status!==Pl.NotStarted,"Attempted to read state from uninitialized service '".concat(this.id,"'. Make sure the service is started first.")),this._state},enumerable:!1,configurable:!0}),e.prototype.execute=function(e,t){var n,r;try{for(var i=Qu(e.actions),o=i.next();!o.done;o=i.next()){var a=o.value;this.exec(a,e,t)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},e.prototype.update=function(e,t){var n,r,i,o,a,s,c,u,d=this;if(e._sessionid=this.sessionId,this._state=e,this.machine.config.predictableActionArguments&&t!==el||!this.options.execute||this.execute(this.state),this.children.forEach((function(e){d.state.children[e.id]=e})),this.devTools&&this.devTools.send(t.data,e),e.event)try{for(var l=Qu(this.eventListeners),f=l.next();!f.done;f=l.next()){(0,f.value)(e.event)}}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}try{for(var p=Qu(this.listeners),h=p.next();!h.done;h=p.next()){(0,h.value)(e,e.event)}}catch(e){i={error:e}}finally{try{h&&!h.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}try{for(var v=Qu(this.contextListeners),m=v.next();!m.done;m=v.next()){(0,m.value)(this.state.context,this.state.history?this.state.history.context:void 0)}}catch(e){a={error:e}}finally{try{m&&!m.done&&(s=v.return)&&s.call(v)}finally{if(a)throw a.error}}if(this.state.done){var g=e.configuration.find((function(e){return"final"===e.type&&e.parent===d.machine})),E=g&&g.doneData?Dd(g.doneData,e.context,t):void 0;try{for(var y=Qu(this.doneListeners),S=y.next();!S.done;S=y.next()){(0,S.value)(ul(this.id,E))}}catch(e){c={error:e}}finally{try{S&&!S.done&&(u=y.return)&&u.call(y)}finally{if(c)throw c.error}}this._stop()}},e.prototype.onTransition=function(e){return this.listeners.add(e),this.status===Pl.Running&&e(this.state,this.state.event),this},e.prototype.subscribe=function(e,t,n){var r=this,i=$d(e,t,n);this.listeners.add(i.next),this.status!==Pl.NotStarted&&i.next(this.state);var o=function e(){r.doneListeners.delete(e),r.stopListeners.delete(e),i.complete()};return this.status===Pl.Stopped?i.complete():(this.onDone(o),this.onStop(o)),{unsubscribe:function(){r.listeners.delete(i.next),r.doneListeners.delete(o),r.stopListeners.delete(o)}}},e.prototype.onEvent=function(e){return this.eventListeners.add(e),this},e.prototype.onSend=function(e){return this.sendListeners.add(e),this},e.prototype.onChange=function(e){return this.contextListeners.add(e),this},e.prototype.onStop=function(e){return this.stopListeners.add(e),this},e.prototype.onDone=function(e){return this.doneListeners.add(e),this},e.prototype.off=function(e){return this.listeners.delete(e),this.eventListeners.delete(e),this.sendListeners.delete(e),this.stopListeners.delete(e),this.doneListeners.delete(e),this.contextListeners.delete(e),this},e.prototype.start=function(e){var t=this;if(this.status===Pl.Running)return this;this.machine._init(),kl.register(this.sessionId,this),this.initialized=!0,this.status=Pl.Running;var n=void 0===e?this.initialState:fl(this,(function(){return n=e,"object"===(0,m.Z)(n)&&null!==n&&"value"in n&&"_event"in n?t.machine.resolveState(e):t.machine.resolveState(wl.from(e,t.machine.context));var n}));return this.options.devTools&&this.attachDev(),this.scheduler.initialize((function(){t.update(n,el)})),this},e.prototype._stop=function(){var e,t,n,r,i,o,a,s,c,u;try{for(var d=Qu(this.listeners),l=d.next();!l.done;l=d.next()){var f=l.value;this.listeners.delete(f)}}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=d.return)&&t.call(d)}finally{if(e)throw e.error}}try{for(var p=Qu(this.stopListeners),h=p.next();!h.done;h=p.next()){(f=h.value)(),this.stopListeners.delete(f)}}catch(e){n={error:e}}finally{try{h&&!h.done&&(r=p.return)&&r.call(p)}finally{if(n)throw n.error}}try{for(var v=Qu(this.contextListeners),m=v.next();!m.done;m=v.next()){f=m.value;this.contextListeners.delete(f)}}catch(e){i={error:e}}finally{try{m&&!m.done&&(o=v.return)&&o.call(v)}finally{if(i)throw i.error}}try{for(var g=Qu(this.doneListeners),E=g.next();!E.done;E=g.next()){f=E.value;this.doneListeners.delete(f)}}catch(e){a={error:e}}finally{try{E&&!E.done&&(s=g.return)&&s.call(g)}finally{if(a)throw a.error}}if(!this.initialized)return this;this.initialized=!1,this.status=Pl.Stopped,this._initialState=void 0;try{for(var y=Qu(T()(this.delayedEventsMap)),S=y.next();!S.done;S=y.next()){var _=S.value;this.clock.clearTimeout(this.delayedEventsMap[_])}}catch(e){c={error:e}}finally{try{S&&!S.done&&(u=y.return)&&u.call(y)}finally{if(c)throw c.error}}this.scheduler.clear(),this.scheduler=new Ll({deferEvents:this.options.deferEvents})},e.prototype.stop=function(){var e=this,t=this.scheduler;return this._stop(),t.schedule((function(){var t=Yd({type:"xstate.stop"}),n=fl(e,(function(){var n=kd(td([],ed(e.state.configuration),!1).sort((function(e,t){return t.order-e.order})).map((function(t){return rl(t.onExit,e.machine.options.actions)}))),r=ed(ll(e.machine,e.state,e.state.context,t,n,e.machine.config.predictableActionArguments?e._exec:void 0,e.machine.config.predictableActionArguments||e.machine.config.preserveActionOrder),2),i=r[0],o=r[1],a=new wl({value:e.state.value,context:o,_event:t,_sessionid:e.sessionId,historyValue:void 0,history:e.state,actions:i.filter((function(e){return e.type!==id&&(e.type!==od||!!e.to&&e.to!==Xu.Internal)})),activities:{},events:[],configuration:[],transitions:[],children:{},done:e.state.done,tags:e.state.tags,machine:e.machine});return a.changed=!0,a}));e.update(n,t),e.children.forEach((function(e){Bd(e.stop)&&e.stop()})),e.children.clear(),kl.free(e.sessionId)})),this},e.prototype.batch=function(e){var t=this;if(this.status===Pl.NotStarted&&this.options.deferEvents)Cd||Vd(!1,"".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'" and are deferred. Make sure .start() is called for this service.\nEvent: ').concat(B()(event)));else if(this.status!==Pl.Running)throw new Error("".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'));this.scheduler.schedule((function(){var n,r,i=t.state,o=!1,a=[],s=function(e){var n=Yd(e);t.forward(n),i=fl(t,(function(){return t.machine.transition(i,n)})),a.push.apply(a,td([],ed(i.actions.map((function(e){return n=i,r=(t=e).exec,Ju(Ju({},t),{exec:void 0!==r?function(){return r(n.context,n.event,{action:t,state:n,_event:n._event})}:void 0});var t,n,r}))),!1)),o=o||!!i.changed};try{for(var c=Qu(e),u=c.next();!u.done;u=c.next()){s(u.value)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}i.changed=o,i.actions=a,t.update(i,Yd(e[e.length-1]))}))},e.prototype.sender=function(e){return this.send.bind(this,e)},e.prototype._nextState=function(e){var t=this,n=Yd(e);if(0===n.name.indexOf(pd)&&!this.state.nextEvents.some((function(e){return 0===e.indexOf(pd)})))throw n.data.data;return fl(this,(function(){return t.machine.transition(t.state,n,void 0,t.machine.config.predictableActionArguments?t._exec:void 0)}))},e.prototype.nextState=function(e){return this._nextState(e)},e.prototype.forward=function(e){var t,n;try{for(var r=Qu(this.forwardTo),i=r.next();!i.done;i=r.next()){var o=i.value,a=this.children.get(o);if(!a)throw new Error("Unable to forward event '".concat(e,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(o,"'."));a.send(e)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.prototype.defer=function(e){var t=this;this.delayedEventsMap[e.id]=this.clock.setTimeout((function(){e.to?t.sendTo(e._event,e.to):t.send(e._event)}),e.delay)},e.prototype.cancel=function(e){this.clock.clearTimeout(this.delayedEventsMap[e]),delete this.delayedEventsMap[e]},e.prototype.exec=function(e,t,n){void 0===n&&(n=this.machine.options.actions),this._exec(e,t.context,t._event,n)},e.prototype.removeChild=function(e){var t;this.children.delete(e),this.forwardTo.delete(e),null===(t=this.state)||void 0===t||delete t.children[e]},e.prototype.stopChild=function(e){var t=this.children.get(e);t&&(this.removeChild(e),Bd(t.stop)&&t.stop())},e.prototype.spawn=function(e,t,n){if(this.status!==Pl.Running)return hl(e,t);if(Pd(e))return this.spawnPromise(ne().resolve(e),t);if(Bd(e))return this.spawnCallback(e,t);if(function(e){try{return"function"==typeof e.send}catch(e){return!1}}(i=e)&&"id"in i)return this.spawnActor(e,t);if(function(e){try{return"subscribe"in e&&Bd(e.subscribe)}catch(e){return!1}}(e))return this.spawnObservable(e,t);if(Kd(e))return this.spawnMachine(e,Ju(Ju({},n),{id:t}));if(null!==(r=e)&&"object"===(0,m.Z)(r)&&"transition"in r&&"function"==typeof r.transition)return this.spawnBehavior(e,t);throw new Error('Unable to spawn entity "'.concat(t,'" of type "').concat((0,m.Z)(e),'".'));var r,i},e.prototype.spawnMachine=function(t,n){var r=this;void 0===n&&(n={});var i=new e(t,Ju(Ju({},this.options),{parent:this,id:n.id||t.id})),o=Ju(Ju({},Fl),n);o.sync&&i.onTransition((function(e){r.send(vd,{state:e,id:i.id})}));var a=i;return this.children.set(i.id,a),o.autoForward&&this.forwardTo.add(i.id),i.onDone((function(e){r.removeChild(i.id),r.send(Yd(e,{origin:i.id}))})).start(),a},e.prototype.spawnBehavior=function(e,t){var n=Dl(e,{id:t,parent:this});return this.children.set(t,n),n},e.prototype.spawnPromise=function(e,t){var n,r,i=this,o=!1;e.then((function(e){o||(r=e,i.removeChild(t),i.send(Yd(ul(t,e),{origin:t})))}),(function(e){if(!o){i.removeChild(t);var n=dl(t,e);try{i.send(Yd(n,{origin:t}))}catch(r){!function(e,t,n){if(!Cd){var r=e.stack?" Stacktrace was '".concat(e.stack,"'"):"";if(e===t)console.error("Missing onError handler for invocation '".concat(n,"', error was '").concat(e,"'.").concat(r));else{var i=t.stack?" Stacktrace was '".concat(t.stack,"'"):"";console.error("Missing onError handler and/or unhandled exception/promise rejection for invocation '".concat(n,"'. ")+"Original error: '".concat(e,"'. ").concat(r," Current error is '").concat(t,"'.").concat(i))}}}(e,r,t),i.devTools&&i.devTools.send(n,i.state),i.machine.strict&&i.stop()}}}));var a=((n={id:t,send:function(){},subscribe:function(t,n,r){var i=$d(t,n,r),o=!1;return e.then((function(e){o||(i.next(e),o||i.complete())}),(function(e){o||i.error(e)})),{unsubscribe:function(){return o=!0}}},stop:function(){o=!0},toJSON:function(){return{id:t}},getSnapshot:function(){return r}})[Hd]=function(){return this},n);return this.children.set(t,a),a},e.prototype.spawnCallback=function(e,t){var n,r,i,o=this,a=!1,s=new(j()),c=new(j());try{i=e((function(e){r=e,c.forEach((function(t){return t(e)})),a||o.send(Yd(e,{origin:t}))}),(function(e){s.add(e)}))}catch(e){this.send(dl(t,e))}if(Pd(i))return this.spawnPromise(i,t);var u=((n={id:t,send:function(e){return s.forEach((function(t){return t(e)}))},subscribe:function(e){var t=$d(e);return c.add(t.next),{unsubscribe:function(){c.delete(t.next)}}},stop:function(){a=!0,Bd(i)&&i()},toJSON:function(){return{id:t}},getSnapshot:function(){return r}})[Hd]=function(){return this},n);return this.children.set(t,u),u},e.prototype.spawnObservable=function(e,t){var n,r,i=this,o=e.subscribe((function(e){r=e,i.send(Yd(e,{origin:t}))}),(function(e){i.removeChild(t),i.send(Yd(dl(t,e),{origin:t}))}),(function(){i.removeChild(t),i.send(Yd(ul(t),{origin:t}))})),a=((n={id:t,send:function(){},subscribe:function(t,n,r){return e.subscribe(t,n,r)},stop:function(){return o.unsubscribe()},getSnapshot:function(){return r},toJSON:function(){return{id:t}}})[Hd]=function(){return this},n);return this.children.set(t,a),a},e.prototype.spawnActor=function(e,t){return this.children.set(t,e),e},e.prototype.spawnActivity=function(e){var t=this.machine.options&&this.machine.options.activities?this.machine.options.activities[e.type]:void 0;if(t){var n=t(this.state.context,e);this.spawnEffect(e.id,n)}else Cd||Vd(!1,"No implementation found for activity '".concat(e.type,"'"))},e.prototype.spawnEffect=function(e,t){var n;this.children.set(e,((n={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:t||void 0,getSnapshot:function(){},toJSON:function(){return{id:e}}})[Hd]=function(){return this},n))},e.prototype.attachDev=function(){var e=Ml();if(this.options.devTools&&e){if(e.__REDUX_DEVTOOLS_EXTENSION__){var t="object"===(0,m.Z)(this.options.devTools)?this.options.devTools:void 0;this.devTools=e.__REDUX_DEVTOOLS_EXTENSION__.connect(Ju(Ju({name:this.id,autoPause:!0,stateSanitizer:function(e){return{value:e.value,context:e.context,actions:e.actions}}},t),{features:Ju({jump:!1,skip:!1},t?t.features:void 0)}),this.machine),this.devTools.init(this.state)}Nl(this)}},e.prototype.toJSON=function(){return{id:this.id}},e.prototype[Hd]=function(){return this},e.prototype.getSnapshot=function(){return this.status===Pl.NotStarted?this.initialState:this._state},e.defaultOptions={execute:!0,deferEvents:!0,clock:{setTimeout:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return setTimeout(e,t)})),clearTimeout:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return clearTimeout(e)}))},logger:console.log.bind(console),devTools:!1},e.interpret=Zl,e}();function Zl(e,t){return new Ul(e,t)}function Vl(e){if("string"==typeof e){var t={type:e,toString:function(){return e}};return t}return e}function Gl(e){return Ju(Ju({type:ld},e),{toJSON:function(){e.onDone,e.onError;var t=$u(e,["onDone","onError"]);return Ju(Ju({},t),{type:ld,src:Vl(e.src)})}})}var Bl="",Wl="*",jl={},Hl=function(e){return"#"===e[0]},Kl=function(){return{actions:{},guards:{},services:{},activities:{},delays:{}}},ql=function(){function e(t,n,r,i){var o,a=this;void 0===r&&(r="context"in t?t.context:void 0),this.config=t,this._context=r,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new($()),initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=de()(Kl(),n),this.parent=null==i?void 0:i.parent,this.key=this.config.key||(null==i?void 0:i.key)||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:Ed),this.id=this.config.id||td([this.machine.key],ed(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&T()(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:null!==(o=this.config.schema)&&void 0!==o?o:{},this.description=this.config.description,Cd||Vd(!("parallel"in this.config),'The "parallel" property is deprecated and will be removed in version 4.1. '.concat(this.config.parallel?"Replace with `type: 'parallel'`":"Use `type: '".concat(this.type,"'`")," in the config for state node '").concat(this.id,"' instead.")),this.initial=this.config.initial,this.states=this.config.states?Id(this.config.states,(function(t,n){var r,i=new e(t,{},void 0,{parent:a,key:n});return de()(a.idMap,Ju(((r={})[i.id]=i,r),i.idMap)),i})):jl;var s=0;!function e(t){var n,r;t.order=s++;try{for(var i=Qu(ml(t)),o=i.next();!o.done;o=i.next()){e(o.value)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}(this),this.history=!0===this.config.history?"shallow":this.config.history||!1,this._transient=!!this.config.always||!!this.config.on&&(C()(this.config.on)?this.config.on.some((function(e){return e.event===Bl})):Bl in this.config.on),this.strict=!!this.config.strict,this.onEntry=Nd(this.config.entry||this.config.onEntry).map((function(e){return nl(e)})),this.onExit=Nd(this.config.exit||this.config.onExit).map((function(e){return nl(e)})),this.meta=this.config.meta,this.doneData="final"===this.type?this.config.data:void 0,this.invoke=Nd(this.config.invoke).map((function(e,t){var n,r;if(Kd(e)){var i=Qd(a.id,t);return a.machine.options.services=Ju(((n={})[i]=e,n),a.machine.options.services),Gl({src:i,id:i})}if(Wd(e.src)){i=e.id||Qd(a.id,t);return Gl(Ju(Ju({},e),{id:i,src:e.src}))}if(Kd(e.src)||Bd(e.src)){i=e.id||Qd(a.id,t);return a.machine.options.services=Ju(((r={})[i]=e.src,r),a.machine.options.services),Gl(Ju(Ju({id:i},e),{src:i}))}var o=e.src;return Gl(Ju(Ju({id:Qd(a.id,t)},e),{src:o}))})),this.activities=Nd(this.config.activities).concat(this.invoke).map((function(e){return il(e)})),this.transition=this.transition.bind(this),this.tags=Nd(this.config.tags)}return e.prototype._init=function(){this.__cache.transitions||El(this).forEach((function(e){return e.on}))},e.prototype.withConfig=function(t,n){var r=this.options,i=r.actions,o=r.activities,a=r.guards,s=r.services,c=r.delays;return new e(this.config,{actions:Ju(Ju({},i),t.actions),activities:Ju(Ju({},o),t.activities),guards:Ju(Ju({},a),t.guards),services:Ju(Ju({},s),t.services),delays:Ju(Ju({},c),t.delays)},null!=n?n:this.context)},e.prototype.withContext=function(t){return new e(this.config,this.options,t)},S()(e.prototype,"context",{get:function(){return Bd(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),S()(e.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:Id(this.states,(function(e){return e.definition})),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){return this.definition},S()(e.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var e=this.transitions;return this.__cache.on=e.reduce((function(e,t){return e[t.eventType]=e[t.eventType]||[],e[t.eventType].push(t),e}),{})},enumerable:!1,configurable:!0}),S()(e.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),S()(e.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),e.prototype.getCandidates=function(e){if(this.__cache.candidates[e])return this.__cache.candidates[e];var t=e===Bl,n=this.transitions.filter((function(n){var r=n.eventType===e;return t?r:r||n.eventType===Wl}));return this.__cache.candidates[e]=n,n},e.prototype.getDelayedTransitions=function(){var e=this,t=this.config.after;if(!t)return[];var n=function(t,n){var r=function(e,t){var n=t?"#".concat(t):"";return"".concat(zu.After,"(").concat(e,")").concat(n)}(Bd(t)?"".concat(e.id,":delay[").concat(n,"]"):t,e.id);return e.onEntry.push(al(r,{delay:t})),e.onExit.push({type:ad,sendId:r}),r},r=Gd(t)?t.map((function(e,t){var r=n(e.delay,t);return Ju(Ju({},e),{event:r})})):kd(T()(t).map((function(e,r){var i=t[e],o=Wd(i)?{target:i}:i,a=isNaN(+e)?e:+e,s=n(a,r);return Nd(o).map((function(e){return Ju(Ju({},e),{event:s,delay:a})}))})));return r.map((function(t){var n=t.delay;return Ju(Ju({},e.formatTransition(t)),{delay:n})}))},e.prototype.getStateNodes=function(e){var t,n=this;if(!e)return[];var r=e instanceof wl?e.value:bd(e,this.delimiter);if(Wd(r)){var i=this.getStateNode(r).initial;return void 0!==i?this.getStateNodes(((t={})[r]=i,t)):[this,this.states[r]]}var o=T()(r),a=[this];return a.push.apply(a,td([],ed(kd(o.map((function(e){return n.getStateNode(e).getStateNodes(r[e])})))),!1)),a},e.prototype.handles=function(e){var t=Td(e);return this.events.includes(t)},e.prototype.resolveState=function(e){var t=e instanceof wl?e:wl.create(e),n=ee()(yl([],this.getStateNodes(t.value)));return new wl(Ju(Ju({},t),{value:this.resolve(t.value),configuration:n,done:Tl(n,this),tags:xl(n),machine:this.machine}))},e.prototype.transitionLeafNode=function(e,t,n){var r=this.getStateNode(e).next(t,n);return r&&r.transitions.length?r:this.next(t,n)},e.prototype.transitionCompoundNode=function(e,t,n){var r=T()(e),i=this.getStateNode(r[0])._transition(e[r[0]],t,n);return i&&i.transitions.length?i:this.next(t,n)},e.prototype.transitionParallelNode=function(e,t,n){var r,i,o={};try{for(var a=Qu(T()(e)),s=a.next();!s.done;s=a.next()){var c=s.value,u=e[c];if(u){var d=this.getStateNode(c)._transition(u,t,n);d&&(o[c]=d)}}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}var l=T()(o).map((function(e){return o[e]})),f=kd(l.map((function(e){return e.transitions})));if(!l.some((function(e){return e.transitions.length>0})))return this.next(t,n);var p=kd(l.map((function(e){return e.entrySet}))),h=kd(T()(o).map((function(e){return o[e].configuration})));return{transitions:f,entrySet:p,exitSet:kd(l.map((function(e){return e.exitSet}))),configuration:h,source:t,actions:kd(T()(o).map((function(e){return o[e].actions})))}},e.prototype._transition=function(e,t,n){return Wd(e)?this.transitionLeafNode(e,t,n):1===T()(e).length?this.transitionCompoundNode(e,t,n):this.transitionParallelNode(e,t,n)},e.prototype.getTransitionData=function(e,t){return this._transition(e.value,e,Yd(t))},e.prototype.next=function(e,t){var n,r,i,o=this,a=t.name,s=[],c=[];try{for(var u=Qu(this.getCandidates(a)),d=u.next();!d.done;d=u.next()){var l=d.value,f=l.cond,p=l.in,h=e.context,v=!p||(Wd(p)&&Hl(p)?e.matches(bd(this.getStateNodeById(p).path,this.delimiter)):Rd(bd(p,this.delimiter),Od(this.path.slice(0,-2))(e.value))),m=!1;try{m=!f||Xd(this.machine,f,h,t,e)}catch(e){throw new Error("Unable to evaluate guard '".concat(f.name||f.type,"' in transition for event '").concat(a,"' in state node '").concat(this.id,"':\n").concat(e.message))}if(m&&v){void 0!==l.target&&(c=l.target),s.push.apply(s,td([],ed(l.actions),!1)),i=l;break}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}if(i){if(!c.length)return{transitions:[i],entrySet:[],exitSet:[],configuration:e.value?[this]:[],source:e,actions:s};var g=kd(c.map((function(t){return o.getRelativeStateNodes(t,e.historyValue)}))),E=!!i.internal,y=[];return E||c.forEach((function(e){y.push.apply(y,td([],ed(o.getExternalReentryNodes(e)),!1))})),{transitions:[i],entrySet:y,exitSet:E?[]:[this],configuration:g,source:e,actions:s}}},e.prototype.getExternalReentryNodes=function(e){for(var t=[],n=ed(e.order>this.order?[e,this]:[this,e],2),r=n[0],i=n[1];r&&r!==i;)t.push(r),r=r.parent;return r!==i?[]:(t.push(i),t)},e.prototype.getActions=function(e,t,n,r,i,o){var a,s,c,u,d=yl([],o?this.getStateNodes(o.value):[this]);try{for(var l=Qu(e),f=l.next();!f.done;f=l.next()){Rl(d,v=f.value)&&!Rl(n.entrySet,v.parent)||n.entrySet.push(v)}}catch(e){a={error:e}}finally{try{f&&!f.done&&(s=l.return)&&s.call(l)}finally{if(a)throw a.error}}try{for(var p=Qu(d),h=p.next();!h.done;h=p.next()){var v;Rl(e,v=h.value)&&!Rl(n.exitSet,v.parent)||n.exitSet.push(v)}}catch(e){c={error:e}}finally{try{h&&!h.done&&(u=p.return)&&u.call(p)}finally{if(c)throw c.error}}var m=kd(n.entrySet.map((function(e){var t=[];if("final"!==e.type)return t;var o=e.parent;if(!o.parent)return t;t.push(cl(e.id,e.doneData),cl(o.id,e.doneData?Dd(e.doneData,r,i):void 0));var a=o.parent;return"parallel"===a.type&&gl(a).every((function(e){return Tl(n.configuration,e)}))&&t.push(cl(a.id)),t})));n.exitSet.sort((function(e,t){return t.order-e.order})),n.entrySet.sort((function(e,t){return e.order-t.order}));var g=new(j())(n.entrySet),E=new(j())(n.exitSet),y=ed([kd(ee()(g).map((function(e){return td(td([],ed(e.activities.map((function(e){return function(e){var t=il(e);return{type:zu.Start,activity:t,exec:void 0}}(e)}))),!1),ed(e.onEntry),!1)}))).concat(m.map(ol)),kd(ee()(E).map((function(e){return td(td([],ed(e.onExit),!1),ed(e.activities.map((function(e){return function(e){var t=Bd(e)?e:il(e);return{type:zu.Stop,activity:t,exec:void 0}}(e)}))),!1)})))],2),S=y[0],_=y[1],C=rl(_.concat(n.actions).concat(S),this.machine.options.actions);if(t){var R=rl(kd(td([],ed(e),!1).sort((function(e,t){return t.order-e.order})).map((function(e){return e.onExit}))),this.machine.options.actions).filter((function(e){return e.type!==id&&(e.type!==od||!!e.to&&e.to!==Xu.Internal)}));return C.concat(R)}return C},e.prototype.transition=function(e,t,n,r){void 0===e&&(e=this.initialState);var i,o,a=Yd(t);if(e instanceof wl)i=void 0===n?e:this.resolveState(wl.from(e,n));else{var s=Wd(e)?this.resolve(wd(this.getResolvedPath(e))):this.resolve(e),c=null!=n?n:this.machine.context;i=this.resolveState(wl.from(s,c))}if(!Cd&&a.name===Wl)throw new Error("An event cannot have the wildcard type ('".concat(Wl,"')"));if(this.strict&&!this.events.includes(a.name)&&(o=a.name,!/^(done|error)\./.test(o)))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(a.name,"'"));var u=this._transition(i.value,i,a)||{transitions:[],configuration:[],entrySet:[],exitSet:[],source:i,actions:[]},d=yl([],this.getStateNodes(i.value)),l=u.configuration.length?yl(d,u.configuration):d;return u.configuration=td([],ed(l),!1),this.resolveTransition(u,i,i.context,r,a)},e.prototype.resolveRaisedTransition=function(e,t,n,r){var i,o=e.actions;return(e=this.transition(e,t,void 0,r))._event=n,e.event=n.data,(i=e.actions).unshift.apply(i,td([],ed(o),!1)),e},e.prototype.resolveTransition=function(e,t,n,r,i){var o,a,s=this;void 0===i&&(i=el);var c=e.configuration,u=!t||e.transitions.length>0,d=u?e.configuration:t?t.configuration:[],l=Tl(d,this),f=u?Cl(this.machine,c):void 0,p=t?t.historyValue?t.historyValue:e.source?this.machine.historyValue(t.value):void 0:void 0,h=this.getActions(new(j())(d),l,e,n,i,t),v=t?Ju({},t.activities):{};try{for(var g=Qu(h),E=g.next();!E.done;E=g.next()){var y=E.value;y.type===nd?v[y.activity.id||y.activity.type]=y:y.type===rd&&(v[y.activity.id||y.activity.type]=!1)}}catch(e){o={error:e}}finally{try{E&&!E.done&&(a=g.return)&&a.call(g)}finally{if(o)throw o.error}}var S,_,C=ed(ll(this,t,n,i,h,r,this.machine.config.predictableActionArguments||this.machine.config.preserveActionOrder),2),R=C[0],T=C[1],x=ed(Fd(R,(function(e){return e.type===id||e.type===od&&e.to===Xu.Internal})),2),b=x[0],w=x[1],I=R.filter((function(e){var t;return e.type===nd&&(null===(t=e.activity)||void 0===t?void 0:t.type)===ld})),L=I.reduce((function(e,t){return e[t.activity.id]=function(e,t,n,r){var i,o=Jd(e.src),a=null===(i=null==t?void 0:t.options.services)||void 0===i?void 0:i[o.type],s=e.data?Dd(e.data,n,r):void 0,c=a?hl(a,e.id,s):pl(e.id);return c.meta=e,c}(t.activity,s.machine,T,i),e}),t?Ju({},t.children):{}),O=new wl({value:f||t.value,context:T,_event:i,_sessionid:t?t._sessionid:null,historyValue:f?p?(S=p,_=f,{current:_,states:Ud(S,_)}):void 0:t?t.historyValue:void 0,history:!f||e.source?t:void 0,actions:f?w:[],activities:f?v:t?t.activities:{},events:[],configuration:d,transitions:e.transitions,children:L,done:l,tags:xl(d),machine:this}),A=n!==T;O.changed=i.name===vd||A;var k=O.history;k&&delete k.history;var M=!l&&(this._transient||c.some((function(e){return e._transient})));if(!(u||M&&i.name!==Bl))return O;var N=O;if(!l)for(M&&(N=this.resolveRaisedTransition(N,{type:sd},i,r));b.length;){var D=b.shift();N=this.resolveRaisedTransition(N,D._event,i,r)}var P=N.changed||(k?!!N.actions.length||A||(0,m.Z)(k.value)!==(0,m.Z)(N.value)||!bl(N.value,k.value):void 0);return N.changed=P,N.history=k,N},e.prototype.getStateNode=function(e){if(Hl(e))return this.machine.getStateNodeById(e);if(!this.states)throw new Error("Unable to retrieve child state '".concat(e,"' from '").concat(this.id,"'; no child states exist."));var t=this.states[e];if(!t)throw new Error("Child state '".concat(e,"' does not exist on '").concat(this.id,"'"));return t},e.prototype.getStateNodeById=function(e){var t=Hl(e)?e.slice("#".length):e;if(t===this.id)return this;var n=this.machine.idMap[t];if(!n)throw new Error("Child state node '#".concat(t,"' does not exist on machine '").concat(this.id,"'"));return n},e.prototype.getStateNodeByPath=function(e){if("string"==typeof e&&Hl(e))try{return this.getStateNodeById(e.slice(1))}catch(e){}for(var t=xd(e,this.delimiter).slice(),n=this;t.length;){var r=t.shift();if(!r.length)break;n=n.getStateNode(r)}return n},e.prototype.resolve=function(e){var t,n=this;if(!e)return this.initialStateValue||jl;switch(this.type){case"parallel":return Id(this.initialStateValue,(function(t,r){return t?n.getStateNode(r).resolve(e[r]||t):jl}));case"compound":if(Wd(e)){var r=this.getStateNode(e);return"parallel"===r.type||"compound"===r.type?((t={})[e]=r.initialStateValue,t):e}return T()(e).length?Id(e,(function(e,t){return e?n.getStateNode(t).resolve(e):jl})):this.initialStateValue||{};default:return e||jl}},e.prototype.getResolvedPath=function(e){if(Hl(e)){var t=this.machine.idMap[e.slice("#".length)];if(!t)throw new Error("Unable to find state node '".concat(e,"'"));return t.path}return xd(e,this.delimiter)},S()(e.prototype,"initialStateValue",{get:function(){var e,t;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;if("parallel"===this.type)t=Ld(this.states,(function(e){return e.initialStateValue||jl}),(function(e){return!("history"===e.type)}));else if(void 0!==this.initial){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));t=vl(this.states[this.initial])?this.initial:((e={})[this.initial]=this.states[this.initial].initialStateValue,e)}else t={};return this.__cache.initialStateValue=t,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),e.prototype.getInitialState=function(e,t){this._init();var n=this.getStateNodes(e);return this.resolveTransition({configuration:n,entrySet:td([],ed(n),!1),exitSet:[],transitions:[],source:void 0,actions:[]},void 0,null!=t?t:this.machine.context,void 0)},S()(e.prototype,"initialState",{get:function(){var e=this.initialStateValue;if(!e)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(e)},enumerable:!1,configurable:!0}),S()(e.prototype,"target",{get:function(){var e;if("history"===this.type){var t=this.config;e=Wd(t.target)&&Hl(t.target)?wd(this.machine.getStateNodeById(t.target).path.slice(this.path.length-1)):t.target}return e},enumerable:!1,configurable:!0}),e.prototype.getRelativeStateNodes=function(e,t,n){return void 0===n&&(n=!0),n?"history"===e.type?e.resolveHistory(t):e.initialStateNodes:[e]},S()(e.prototype,"initialStateNodes",{get:function(){var e=this;return vl(this)?[this]:"compound"!==this.type||this.initial?kd(Ad(this.initialStateValue).map((function(t){return e.getFromRelativePath(t)}))):(Cd||Vd(!1,"Compound state node '".concat(this.id,"' has no initial state.")),[this])},enumerable:!1,configurable:!0}),e.prototype.getFromRelativePath=function(e){if(!e.length)return[this];var t=ed(e),n=t[0],r=t.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(n,"' from node with no states"));var i=this.getStateNode(n);if("history"===i.type)return i.resolveHistory();if(!this.states[n])throw new Error("Child state '".concat(n,"' does not exist on '").concat(this.id,"'"));return this.states[n].getFromRelativePath(r)},e.prototype.historyValue=function(e){if(T()(this.states).length)return{current:e||this.initialStateValue,states:Ld(this.states,(function(t,n){if(!e)return t.historyValue();var r=Wd(e)?void 0:e[n];return t.historyValue(r||t.initialStateValue)}),(function(e){return!e.history}))}},e.prototype.resolveHistory=function(e){var t=this;if("history"!==this.type)return[this];var n=this.parent;if(!e){var r=this.target;return r?kd(Ad(r).map((function(e){return n.getFromRelativePath(e)}))):n.initialStateNodes}var i,o,a=(i=n.path,o="states",function(e){var t,n,r=e;try{for(var a=Qu(i),s=a.next();!s.done;s=a.next()){var c=s.value;r=r[o][c]}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return r})(e).current;return Wd(a)?[n.getStateNode(a)]:kd(Ad(a).map((function(e){return"deep"===t.history?n.getFromRelativePath(e):[n.states[e[0]]]})))},S()(e.prototype,"stateIds",{get:function(){var e=this,t=kd(T()(this.states).map((function(t){return e.states[t].stateIds})));return[this.id].concat(t)},enumerable:!1,configurable:!0}),S()(e.prototype,"events",{get:function(){var e,t,n,r;if(this.__cache.events)return this.__cache.events;var i=this.states,o=new(j())(this.ownEvents);if(i)try{for(var a=Qu(T()(i)),s=a.next();!s.done;s=a.next()){var c=i[s.value];if(c.states)try{for(var u=(n=void 0,Qu(c.events)),d=u.next();!d.done;d=u.next()){var l=d.value;o.add("".concat(l))}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return this.__cache.events=ee()(o)},enumerable:!1,configurable:!0}),S()(e.prototype,"ownEvents",{get:function(){var e=new(j())(this.transitions.filter((function(e){return!(!e.target&&!e.actions.length&&e.internal)})).map((function(e){return e.eventType})));return ee()(e)},enumerable:!1,configurable:!0}),e.prototype.resolveTarget=function(e){var t=this;if(void 0!==e)return e.map((function(e){if(!Wd(e))return e;var n=e[0]===t.delimiter;if(n&&!t.parent)return t.getStateNodeByPath(e.slice(1));var r=n?t.key+e:e;if(!t.parent)return t.getStateNodeByPath(r);try{return t.parent.getStateNodeByPath(r)}catch(e){throw new Error("Invalid transition definition for state node '".concat(t.id,"':\n").concat(e.message))}}))},e.prototype.formatTransition=function(e){var t=this,n=function(e){if(void 0!==e&&e!==_d)return Nd(e)}(e.target),r="internal"in e?e.internal:!n||n.some((function(e){return Wd(e)&&e[0]===t.delimiter})),i=this.machine.options.guards,o=this.resolveTarget(n),a=Ju(Ju({},e),{actions:rl(Nd(e.actions)),cond:jd(e.cond,i),target:o,source:this,internal:r,eventType:e.event,toJSON:function(){return Ju(Ju({},a),{target:a.target?a.target.map((function(e){return"#".concat(e.id)})):void 0,source:"#".concat(t.id)})}});return a},e.prototype.formatTransitions=function(){var e,t,n,r=this;if(this.config.on)if(C()(this.config.on))n=this.config.on;else{var i=this.config.on,o=Wl,a=i[o],s=void 0===a?[]:a,c=$u(i,["symbol"===(0,m.Z)(o)?o:"*"]);n=kd(T()(c).map((function(e){Cd||e!==Bl||Vd(!1,"Empty string transition configs (e.g., `{ on: { '': ... }}`) for transient transitions are deprecated. Specify the transition in the `{ always: ... }` property instead. "+'Please check the `on` configuration for "#'.concat(r.id,'".'));var t=zd(e,c[e]);return Cd||function(e,t,n){var r=n.slice(0,-1).some((function(e){return!("cond"in e)&&!("in"in e)&&(Wd(e.target)||Kd(e.target))})),i=t===Bl?"the transient event":"event '".concat(t,"'");Vd(!r,"One or more transitions for ".concat(i," on state '").concat(e.id,"' are unreachable. ")+"Make sure that the default transition is the last one defined.")}(r,e,t),t})).concat(zd(Wl,s)))}else n=[];var u=this.config.always?zd("",this.config.always):[],d=this.config.onDone?zd(String(cl(this.id)),this.config.onDone):[];Cd||Vd(!(this.config.onDone&&!this.parent),'Root nodes cannot have an ".onDone" transition. Please check the config of "'.concat(this.id,'".'));var l=kd(this.invoke.map((function(e){var t=[];return e.onDone&&t.push.apply(t,td([],ed(zd(String(ul(e.id)),e.onDone)),!1)),e.onError&&t.push.apply(t,td([],ed(zd(String(dl(e.id)),e.onError)),!1)),t}))),f=this.after,p=kd(td(td(td(td([],ed(d),!1),ed(l),!1),ed(n),!1),ed(u),!1).map((function(e){return Nd(e).map((function(e){return r.formatTransition(e)}))})));try{for(var h=Qu(f),v=h.next();!v.done;v=h.next()){var g=v.value;p.push(g)}}catch(t){e={error:t}}finally{try{v&&!v.done&&(t=h.return)&&t.call(h)}finally{if(e)throw e.error}}return p},e}(),Yl=!1;var zl=function(e){return{type:cd,assignment:e}};function Xl(e,t){var n=T()(e);if(K()){var r=K()(e);t&&(r=r.filter((function(t){return b()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Jl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xl(Object(n),!0).forEach((function(t){Me.default(e,t,n[t])})):Y()?X()(e,Y()(n)):Xl(Object(n)).forEach((function(t){S()(e,t,b()(n,t))}))}return e}var $l=4294967294,Ql=2,ef=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r,i,o,a){var s;(0,v.Z)(this,n),s=t.call(this),Me.default((0,d.Z)(s),"id",void 0),Me.default((0,d.Z)(s),"createLocalOfferCallback",void 0),Me.default((0,d.Z)(s),"handleRemoteOfferCallback",void 0),Me.default((0,d.Z)(s),"handleRemoteAnswerCallback",void 0),Me.default((0,d.Z)(s),"stateMachine",void 0),Me.default((0,d.Z)(s),"initiateOfferPromises",void 0),s.id=o||"ROAP",s.createLocalOfferCallback=e,s.handleRemoteOfferCallback=r,s.handleRemoteAnswerCallback=i,s.initiateOfferPromises=[];var c=function(e,t){return Cd||e.predictableActionArguments||Yl||(Yl=!0,console.warn("It is highly recommended to set `predictableActionArguments` to `true` when using `createMachine`. https://xstate.js.org/docs/guides/actions.html")),new ql(e,t)}({tsTypes:{},schema:{context:{},events:{},services:{}},preserveActionOrder:!0,id:"roap",initial:"idle",context:{seq:a||0,pendingLocalOffer:!1,isHandlingOfferRequest:!1,retryCounter:0},states:{browserError:{onEntry:function(e,t){s.error("FSM","browserError state onEntry: context=".concat(B()(e),":"),t.data),s.emit(exports.Event.ROAP_FAILURE,t.data)}},remoteError:{onEntry:function(e,t){s.log("FSM","remoteError state onEntry called, emitting Event.ROAP_FAILURE"),s.emit(exports.Event.ROAP_FAILURE,t.data)}},idle:{always:{cond:"isPendingLocalOffer",actions:["increaseSeq","sendStartedEvent"],target:"creatingLocalOffer"},on:{INITIATE_OFFER:{actions:["increaseSeq","sendStartedEvent"],target:"creatingLocalOffer"},REMOTE_OFFER_ARRIVED:[{cond:"isSameSeq",actions:"sendOutOfOrderError"},{actions:["updateSeq","sendStartedEvent"],target:"settingRemoteOffer"}],REMOTE_OFFER_REQUEST_ARRIVED:[{cond:"isSameSeq",actions:"sendOutOfOrderError"},{actions:["updateSeq","setOfferRequestFlag","sendStartedEvent"],target:"creatingLocalOffer"}],REMOTE_ANSWER_ARRIVED:[{cond:"isSameSeq",actions:"ignoreDuplicate"},{actions:"sendInvalidStateError"}],REMOTE_OK_ARRIVED:{actions:"sendInvalidStateError"}}},creatingLocalOffer:{invoke:{src:"createLocalOffer",onDone:[{cond:"isPendingLocalOffer",target:"creatingLocalOffer"},{cond:"isHandlingOfferRequest",actions:["sendRoapOfferResponseMessage","resolvePendingInitiateOfferPromises"],target:"waitingForAnswer"},{actions:["sendRoapOfferMessage","resolvePendingInitiateOfferPromises"],target:"waitingForAnswer"}],onError:{actions:"rejectPendingInitiateOfferPromises",target:"browserError"}},onEntry:["resetPendingLocalOffer"],on:{INITIATE_OFFER:{actions:"enqueueNewOfferCreation"},REMOTE_OFFER_ARRIVED:[{actions:"handleGlare"}],REMOTE_OFFER_REQUEST_ARRIVED:[{cond:"isHandlingOfferRequest",actions:"ignoreDuplicate"},{actions:"handleGlare"}],REMOTE_ANSWER_ARRIVED:{actions:"sendInvalidStateError"},REMOTE_OK_ARRIVED:{actions:"sendInvalidStateError"}}},waitingForAnswer:{on:{REMOTE_ANSWER_ARRIVED:[{actions:["resetRetryCounter","updateSeq"],target:"settingRemoteAnswer"}],INITIATE_OFFER:{actions:"enqueueNewOfferCreation"},REMOTE_OFFER_ARRIVED:{actions:"handleGlare"},REMOTE_OFFER_REQUEST_ARRIVED:[{cond:"isHandlingOfferRequest",actions:"ignoreDuplicate"},{actions:"handleGlare"}],REMOTE_OK_ARRIVED:{actions:"sendInvalidStateError"},ERROR_ARRIVED:[{cond:"shouldErrorTriggerOfferRetry",actions:["increaseSeq","increaseRetryCounter"],target:"creatingLocalOffer"},{cond:"isSameSeq",target:"remoteError"}]}},settingRemoteAnswer:{invoke:{src:"handleRemoteAnswer",onDone:{actions:["sendRoapOKMessage","resetOfferRequestFlag","sendDoneEvent"],target:"idle"},onError:{actions:"sendGenericError",target:"browserError"}},on:{INITIATE_OFFER:{actions:"enqueueNewOfferCreation"},REMOTE_OFFER_ARRIVED:{actions:"sendInvalidStateError"},REMOTE_OFFER_REQUEST_ARRIVED:{actions:"sendInvalidStateError"},REMOTE_ANSWER_ARRIVED:[{cond:"isSameSeq",actions:"ignoreDuplicate"},{actions:"sendInvalidStateError"}],REMOTE_OK_ARRIVED:{actions:"sendInvalidStateError"}}},settingRemoteOffer:{invoke:{src:"handleRemoteOffer",onDone:{actions:["sendRoapAnswerMessage"],target:"waitingForOK"},onError:{actions:"sendGenericError",target:"browserError"}},on:{INITIATE_OFFER:{actions:"enqueueNewOfferCreation"},REMOTE_OFFER_ARRIVED:[{cond:"isSameSeq",actions:"ignoreDuplicate"},{actions:"sendRetryAfterError"}],REMOTE_OFFER_REQUEST_ARRIVED:{actions:"sendInvalidStateError"},REMOTE_ANSWER_ARRIVED:{actions:"sendInvalidStateError"},REMOTE_OK_ARRIVED:{actions:"sendInvalidStateError"}}},waitingForOK:{on:{REMOTE_OK_ARRIVED:[{actions:["updateSeq","sendDoneEvent"],target:"idle"}],INITIATE_OFFER:{actions:"enqueueNewOfferCreation"},REMOTE_OFFER_ARRIVED:[{cond:"isSameSeq",actions:"ignoreDuplicate"},{actions:"sendInvalidStateError"}],REMOTE_OFFER_REQUEST_ARRIVED:{actions:"sendInvalidStateError"},REMOTE_ANSWER_ARRIVED:{actions:"sendInvalidStateError"},ERROR_ARRIVED:{cond:"isSameSeq",target:"remoteError"}}}}},{services:{createLocalOffer:function(){return s.createLocalOfferCallback()},handleRemoteAnswer:function(e,t){return s.handleRemoteAnswerCallback(t.sdp)},handleRemoteOffer:function(e,t){return s.handleRemoteOfferCallback(t.sdp)}},actions:{enqueueNewOfferCreation:zl((function(e){return Jl(Jl({},e),{},{pendingLocalOffer:!0})})),resetPendingLocalOffer:zl((function(e){return Jl(Jl({},e),{},{pendingLocalOffer:!1})})),increaseSeq:zl((function(e){return Jl(Jl({},e),{},{seq:e.seq+1})})),updateSeq:zl((function(e,t){return Jl(Jl({},e),{},{seq:t.seq})})),increaseRetryCounter:zl((function(e){return Jl(Jl({},e),{},{retryCounter:e.retryCounter+1})})),resetRetryCounter:zl((function(e){return Jl(Jl({},e),{},{retryCounter:0})})),setOfferRequestFlag:zl((function(e){return Jl(Jl({},e),{},{isHandlingOfferRequest:!0})})),resetOfferRequestFlag:zl((function(e){return Jl(Jl({},e),{},{isHandlingOfferRequest:!1})})),handleGlare:function(e,t){t.tieBreaker===$l?s.sendErrorMessage(t.seq,exports.ErrorType.DOUBLECONFLICT):s.sendErrorMessage(t.seq,exports.ErrorType.CONFLICT)},sendRoapOfferMessage:function(e,t){return s.sendRoapOfferMessage(e.seq,t.data.sdp)},sendRoapOfferResponseMessage:function(e,t){return s.sendRoapOfferResponseMessage(e.seq,t.data.sdp)},sendRoapOKMessage:function(e){return s.sendRoapOkMessage(e.seq)},sendRoapAnswerMessage:function(e,t){return s.sendRoapAnswerMessage(e.seq,t.data.sdp)},sendStartedEvent:function(){return s.sendStartedEvent()},sendDoneEvent:function(){return s.sendDoneEvent()},sendGenericError:function(e){return s.sendErrorMessage(e.seq,exports.ErrorType.FAILED)},sendInvalidStateError:function(e,t){return s.sendErrorMessage(t.seq,exports.ErrorType.INVALID_STATE)},sendOutOfOrderError:function(e,t){return s.sendErrorMessage(t.seq,exports.ErrorType.OUT_OF_ORDER)},sendRetryAfterError:function(e,t){return s.sendErrorMessage(t.seq,exports.ErrorType.FAILED,{retryAfter:Math.floor(11*Math.random())})},ignoreDuplicate:function(e,t){return s.log("FSM","ignoring duplicate roap message ".concat(t.type," with seq=").concat(t.seq))},resolvePendingInitiateOfferPromises:function(){return s.resolvePendingInitiateOfferPromises()},rejectPendingInitiateOfferPromises:function(e,t){return s.rejectPendingInitiateOfferPromises(t.data)}},guards:{isPendingLocalOffer:function(e){return e.pendingLocalOffer},isHandlingOfferRequest:function(e){return e.isHandlingOfferRequest},isSameSeq:function(e,t){return t.seq===e.seq&&(s.log("FSM","incoming roap message seq is same as current context seq: ".concat(t.seq)),!0)},shouldErrorTriggerOfferRetry:function(e,t){if([exports.ErrorType.DOUBLECONFLICT,exports.ErrorType.INVALID_STATE,exports.ErrorType.OUT_OF_ORDER,exports.ErrorType.RETRY].includes(t.errorType)){if(t.seq===e.seq&&e.retryCounter<Ql)return s.log("FSM","retryable error message received with matching seq and retryCounter ".concat(e.retryCounter," < ").concat(Ql)),!0;t.seq!==e.seq?s.log("FSM","ignoring error message with wrong seq: ".concat(t.seq," !== ").concat(e.seq)):s.log("FSM","reached max retries: retryCounter=".concat(e.retryCounter))}return!1}}});return s.stateMachine=Zl(c).onTransition((function(e,t){return s.log("onTransition","state=".concat(e.value,", event=").concat(B()(t)))})).start(),s}return(0,h.Z)(n,[{key:"log",value:function(e,t){En().info("".concat(this.id,":").concat(e," ").concat(t))}},{key:"error",value:function(e,t,n){En().error("".concat(this.id,":").concat(e," ").concat(t," ").concat(yn(n)))}},{key:"sendRoapOfferMessage",value:function(e,t){this.log("sendRoapOfferMessage","emitting ROAP OFFER"),this.emit(exports.Event.ROAP_MESSAGE_TO_SEND,{roapMessage:{seq:e,messageType:"OFFER",sdp:t,tieBreaker:$l}})}},{key:"sendRoapOfferResponseMessage",value:function(e,t){this.log("sendRoapOfferResponseMessage","emitting ROAP OFFER RESPONSE"),this.emit(exports.Event.ROAP_MESSAGE_TO_SEND,{roapMessage:{seq:e,messageType:"OFFER_RESPONSE",sdp:t}})}},{key:"sendRoapOkMessage",value:function(e){this.log("sendRoapOkMessage","emitting ROAP OK"),this.emit(exports.Event.ROAP_MESSAGE_TO_SEND,{roapMessage:{seq:e,messageType:"OK"}})}},{key:"sendRoapAnswerMessage",value:function(e,t){this.log("sendRoapAnswerMessage","emitting ROAP ANSWER"),this.emit(exports.Event.ROAP_MESSAGE_TO_SEND,{roapMessage:{seq:e,messageType:"ANSWER",sdp:t}})}},{key:"sendDoneEvent",value:function(){this.log("sendDoneEvent","emitting ROAP DONE"),this.emit(exports.Event.ROAP_DONE)}},{key:"sendStartedEvent",value:function(){this.log("sendStartedEvent","emitting ROAP STARTED"),this.emit(exports.Event.ROAP_STARTED)}},{key:"sendErrorMessage",value:function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).retryAfter;this.log("sendErrorMessage","emitting ROAP ERROR (".concat(t,")")),this.emit(exports.Event.ROAP_MESSAGE_TO_SEND,{roapMessage:{seq:e,messageType:"ERROR",errorType:t,retryAfter:n}})}},{key:"getStateMachine",value:function(){return this.stateMachine}},{key:"initiateOffer",value:function(){var e=this;return new(ne())((function(t,n){e.initiateOfferPromises.push({resolve:t,reject:n}),e.stateMachine.send("INITIATE_OFFER")}))}},{key:"resolvePendingInitiateOfferPromises",value:function(){for(;this.initiateOfferPromises.length>0;){var e=this.initiateOfferPromises.shift();null==e||e.resolve()}}},{key:"rejectPendingInitiateOfferPromises",value:function(e){for(;this.initiateOfferPromises.length>0;){var t=this.initiateOfferPromises.shift();null==t||t.reject(e)}}},{key:"validateIncomingRoapMessage",value:function(e){var t,n=e.errorType,r=e.messageType,i=e.seq,o=!0;return i<this.stateMachine.state.context.seq&&(o=!1,"ERROR"!==r?(t=exports.ErrorType.OUT_OF_ORDER,this.error("validateIncomingRoapMessage","received roap message ".concat(r," with seq too low: ").concat(i," < ").concat(this.stateMachine.state.context.seq))):this.error("validateIncomingRoapMessage","received ERROR message ".concat(n," with seq too low: ").concat(i," < ").concat(this.stateMachine.state.context.seq,", ignoring it"))),{isValid:o,errorToSend:t}}},{key:"roapMessageReceived",value:function(e){var t=e.errorCause,n=e.errorType,r=e.messageType,i=e.sdp,o=e.seq,a=e.tieBreaker,s=this.validateIncomingRoapMessage(e),c=s.isValid,u=s.errorToSend;if(c)switch(r){case"ANSWER":this.stateMachine.send("REMOTE_ANSWER_ARRIVED",{sdp:i,seq:o});break;case"OFFER":this.stateMachine.send("REMOTE_OFFER_ARRIVED",{sdp:i,seq:o,tieBreaker:a});break;case"OFFER_REQUEST":this.stateMachine.send("REMOTE_OFFER_REQUEST_ARRIVED",{seq:o,tieBreaker:a});break;case"OK":this.stateMachine.send("REMOTE_OK_ARRIVED",{sdp:i,seq:o});break;case"ERROR":this.error("roapMessageReceived","Error received: seq=".concat(o," type=").concat(n," cause=").concat(t)),n===exports.ErrorType.CONFLICT&&this.error("roapMessageReceived","CONFLICT error type received - this should never happen, because we use the tieBreaker value ".concat($l)),this.stateMachine.send("ERROR_ARRIVED",{seq:o,errorType:n});break;case"OFFER_RESPONSE":this.error("roapMessageReceived","Received unexpected OFFER_RESPONSE: seq=".concat(o));break;default:throw this.error("roapMessageReceived()","unsupported messageType: ".concat(r)),new Error("unhandled messageType")}else u&&this.sendErrorMessage(o,u)}},{key:"stop",value:function(){this.stateMachine.stop()}},{key:"getSeq",value:function(){return this.stateMachine.state.context.seq}}]),n}(vn);function tf(e,t){var n=T()(e);if(K()){var r=K()(e);t&&(r=r.filter((function(t){return b()(e,t).enumerable}))),n.push.apply(n,r)}return n}function nf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tf(Object(n),!0).forEach((function(t){Me.default(e,t,n[t])})):Y()?X()(e,Y()(n)):tf(Object(n)).forEach((function(t){S()(e,t,b()(n,t))}))}return e}var rf=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r,i){var o;return(0,v.Z)(this,n),o=t.call(this),Me.default((0,d.Z)(o),"id",void 0),Me.default((0,d.Z)(o),"debugId",void 0),Me.default((0,d.Z)(o),"mediaConnection",void 0),Me.default((0,d.Z)(o),"roap",void 0),Me.default((0,d.Z)(o),"sdpNegotiationStarted",void 0),o.debugId=i,o.id=i||"RoapMediaConnection",o.sdpNegotiationStarted=!1,o.log("constructor()","config: ".concat(B()(e),", options: ").concat(B()(r))),o.mediaConnection=o.createMediaConnection(e,r,i),o.roap=o.createRoap(i),o}return(0,h.Z)(n,[{key:"log",value:function(e,t){En().info("".concat(this.id,":").concat(e," ").concat(t))}},{key:"error",value:function(e,t,n){En().error("".concat(this.id,":").concat(e," ").concat(t," ").concat(yn(n)))}},{key:"createMediaConnection",value:function(e,t,n){var r=new Hc(e,t,n);return r.on(exports.Event.REMOTE_TRACK_ADDED,this.onRemoteTrack.bind(this)),r.on(exports.Event.CONNECTION_STATE_CHANGED,this.onConnectionStateChanged.bind(this)),r.on(exports.Event.DTMF_TONE_CHANGED,this.onDtmfToneChanged.bind(this)),r}},{key:"createRoap",value:function(e,t){var n=this,r=new ef(this.createLocalOffer.bind(this),this.handleRemoteOffer.bind(this),this.handleRemoteAnswer.bind(this),e,t);return r.on(exports.Event.ROAP_MESSAGE_TO_SEND,(function(e){return n.emit(exports.Event.ROAP_MESSAGE_TO_SEND,e)})),r.on(exports.Event.ROAP_STARTED,(function(){return n.emit(exports.Event.ROAP_STARTED)})),r.on(exports.Event.ROAP_DONE,(function(){return n.emit(exports.Event.ROAP_DONE)})),r.on(exports.Event.ROAP_FAILURE,(function(e){return n.emit(exports.Event.ROAP_FAILURE,e)})),r}},{key:"initiateOffer",value:function(){return this.log("initiateOffer()","called"),this.sdpNegotiationStarted?(this.error("initiateOffer()","SDP negotiation already started"),ne().reject(new Error("SDP negotiation already started"))):(this.mediaConnection.initializeTransceivers(!1),this.sdpNegotiationStarted=!0,this.roap.initiateOffer())}},{key:"close",value:function(){this.log("close()","called"),this.closeMediaConnection(),this.stopRoapSession()}},{key:"closeMediaConnection",value:function(){this.mediaConnection.close(),this.mediaConnection.removeAllListeners()}},{key:"stopRoapSession",value:function(){this.roap.stop(),this.roap.removeAllListeners()}},{key:"reconnect",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.log("reconnect()","iceServers: ".concat(B()(e)));var n=nf(nf({},this.mediaConnection.getConfig()),{},{iceServers:e}),r=this.mediaConnection.getSendReceiveOptions(),i=this.roap.getSeq();return this.stopRoapSession(),this.closeMediaConnection(),this.sdpNegotiationStarted=!1,this.mediaConnection=this.createMediaConnection(n,r,this.debugId),this.roap=this.createRoap(this.debugId,i),t?this.initiateOffer():ne().resolve()}},{key:"updateSendOptions",value:function(e){return this.log("updateSendOptions()","called with ".concat(B()(e))),this.mediaConnection.updateSendOptions(e)?(this.log("updateSendOptions()","triggering offer..."),this.roap.initiateOffer()):ne().resolve()}},{key:"updateReceiveOptions",value:function(e){return this.log("updateReceiveOptions()","called with ".concat(B()(e))),this.mediaConnection.updateReceiveOptions(e)?(this.log("updateReceiveOptions()","triggering offer..."),this.roap.initiateOffer()):ne().resolve()}},{key:"updateSendReceiveOptions",value:function(e){return this.log("updateSendReceiveOptions()","called with ".concat(B()(e))),this.mediaConnection.updateSendReceiveOptions(e)?(this.log("updateSendReceiveOptions()","triggering offer..."),this.roap.initiateOffer()):ne().resolve()}},{key:"getConnectionState",value:function(){return this.mediaConnection.getConnectionState()}},{key:"getStats",value:function(){return this.mediaConnection.getStats()}},{key:"getTransceiverStats",value:function(){return this.mediaConnection.getTransceiverStats()}},{key:"insertDTMF",value:function(e,t,n){this.log("insertDTMF()",'called with tones="'.concat(e,'", duration=').concat(t,", interToneGap=").concat(n)),this.mediaConnection.insertDTMF(e,t,n)}},{key:"roapMessageReceived",value:function(e){this.log("roapMessageReceived()","called with messageType=".concat(e.messageType,", seq=").concat(e.seq)),this.sdpNegotiationStarted||("OFFER"===e.messageType&&(this.sdpNegotiationStarted=!0,this.mediaConnection.initializeTransceivers(!0)),"OFFER_REQUEST"===e.messageType&&(this.sdpNegotiationStarted=!0,this.mediaConnection.initializeTransceivers(!1))),this.roap.roapMessageReceived(e)}},{key:"onRemoteTrack",value:function(e){this.emit(exports.Event.REMOTE_TRACK_ADDED,e)}},{key:"onConnectionStateChanged",value:function(e){this.emit(exports.Event.CONNECTION_STATE_CHANGED,e)}},{key:"onDtmfToneChanged",value:function(e){this.emit(exports.Event.DTMF_TONE_CHANGED,e)}},{key:"createLocalOffer",value:function(){return this.mediaConnection.createLocalOffer()}},{key:"handleRemoteOffer",value:function(e){return this.mediaConnection.handleRemoteOffer(e)}},{key:"handleRemoteAnswer",value:function(e){return this.mediaConnection.handleRemoteAnswer(e)}}]),n}(vn),of="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==Pe?Pe:"undefined"!=typeof self?self:{},af={exports:{}};!function(e){!function(t){var n,r={};r.VERSION="1.6.1";var i={},o=function(e,t){return function(){return t.apply(e,arguments)}},a=function(){var e,t,n=arguments,r=n[0];for(t=1;t<n.length;t++)for(e in n[t])!(e in r)&&n[t].hasOwnProperty(e)&&(r[e]=n[t][e]);return r},s=function(e,t){return{value:e,name:t}};r.TRACE=s(1,"TRACE"),r.DEBUG=s(2,"DEBUG"),r.INFO=s(3,"INFO"),r.TIME=s(4,"TIME"),r.WARN=s(5,"WARN"),r.ERROR=s(8,"ERROR"),r.OFF=s(99,"OFF");var c=function(e){this.context=e,this.setLevel(e.filterLevel),this.log=this.info};c.prototype={setLevel:function(e){e&&"value"in e&&(this.context.filterLevel=e)},getLevel:function(){return this.context.filterLevel},enabledFor:function(e){var t=this.context.filterLevel;return e.value>=t.value},trace:function(){this.invoke(r.TRACE,arguments)},debug:function(){this.invoke(r.DEBUG,arguments)},info:function(){this.invoke(r.INFO,arguments)},warn:function(){this.invoke(r.WARN,arguments)},error:function(){this.invoke(r.ERROR,arguments)},time:function(e){"string"==typeof e&&e.length>0&&this.invoke(r.TIME,[e,"start"])},timeEnd:function(e){"string"==typeof e&&e.length>0&&this.invoke(r.TIME,[e,"end"])},invoke:function(e,t){n&&this.enabledFor(e)&&n(t,a({level:e},this.context))}};var u,d=new c({filterLevel:r.OFF});(u=r).enabledFor=o(d,d.enabledFor),u.trace=o(d,d.trace),u.debug=o(d,d.debug),u.time=o(d,d.time),u.timeEnd=o(d,d.timeEnd),u.info=o(d,d.info),u.warn=o(d,d.warn),u.error=o(d,d.error),u.log=u.info,r.setHandler=function(e){n=e},r.setLevel=function(e){for(var t in d.setLevel(e),i)i.hasOwnProperty(t)&&i[t].setLevel(e)},r.getLevel=function(){return d.getLevel()},r.get=function(e){return i[e]||(i[e]=new c(a({name:e},d.context)))},r.createDefaultHandler=function(e){(e=e||{}).formatter=e.formatter||function(e,t){t.name&&e.unshift("["+t.name+"]")};var t={},n=function(e,t){Function.prototype.apply.call(e,console,t)};return"undefined"==typeof console?function(){}:function(i,o){i=Array.prototype.slice.call(i);var a,s=console.log;o.level===r.TIME?(a=(o.name?"["+o.name+"] ":"")+i[0],"start"===i[1]?console.time?console.time(a):t[a]=(new Date).getTime():console.timeEnd?console.timeEnd(a):n(s,[a+": "+((new Date).getTime()-t[a])+"ms"])):(o.level===r.WARN&&console.warn?s=console.warn:o.level===r.ERROR&&console.error?s=console.error:o.level===r.INFO&&console.info?s=console.info:o.level===r.DEBUG&&console.debug?s=console.debug:o.level===r.TRACE&&console.trace&&(s=console.trace),e.formatter(i,o),n(s,i))}},r.useDefaults=function(e){r.setLevel(e&&e.defaultLevel||r.DEBUG),r.setHandler(r.createDefaultHandler(e))},r.setDefaults=r.useDefaults,e.exports?e.exports=r:(r._prevLogger=t.Logger,r.noConflict=function(){return t.Logger=r._prevLogger,r},t.Logger=r)}(of)}(af);var sf=af.exports;sf.useDefaults({defaultLevel:sf.DEBUG,formatter:function(e,t){e.unshift("[".concat(t.name,"] "))}});var cf,uf,df=function(){function e(t,n,r,i){(0,v.Z)(this,e),this.priority=t,this.crossPriorityDuplication=n,this.crossPolicyDuplication=r,this.preferLiveVideo=i}return(0,h.Z)(e,[{key:"toString",value:function(){return"ActiveSpeakerInfo(priority=".concat(this.priority,", crossPriorityDuplication=").concat(this.crossPriorityDuplication,", crossPolicyDuplication=").concat(this.crossPolicyDuplication,", preferLiveVideo=").concat(this.preferLiveVideo,")")}}]),e}();!function(e){e.Multistream="multistream"}(cf||(cf={})),function(e){e.Scr="scr",e.ScrAck="scrAck",e.ActiveSpeakerNotification="activeSpeakerNotification",e.SourceIndication="sourceIndication",e.SourceIndicationAck="sourceIndicationAck"}(uf||(uf={}));var lf,ff,pf=(0,h.Z)((function e(t,n){(0,v.Z)(this,e),this.payloadType=t,this.h264=n})),hf=(0,h.Z)((function e(t,n,r,i,o){(0,v.Z)(this,e),this.maxFs=t,this.maxFps=n,this.maxMbps=r,this.maxWidth=i,this.maxHeight=o})),vf=function(){function e(t){(0,v.Z)(this,e),this.csi=t}return(0,h.Z)(e,[{key:"toString",value:function(){return"ReceiverSelectedInfo(csi=".concat(this.csi,")")}}]),e}();function mf(e,t){var n=T()(e);if(K()){var r=K()(e);t&&(r=r.filter((function(t){return b()(e,t).enumerable}))),n.push.apply(n,r)}return n}function gf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mf(Object(n),!0).forEach((function(t){Me.default(e,t,n[t])})):Y()?X()(e,Y()(n)):mf(Object(n)).forEach((function(t){S()(e,t,b()(n,t))}))}return e}exports.MediaFamily=void 0,function(e){e.Audio="AUDIO",e.Video="VIDEO"}(exports.MediaFamily||(exports.MediaFamily={})),function(e){e.Main="MAIN",e.Slides="SLIDES"}(lf||(lf={})),exports.Policy=void 0,function(e){e.ActiveSpeaker="active-speaker",e.ReceiverSelected="receiver-selected"}(exports.Policy||(exports.Policy={})),exports.MediaType=void 0,function(e){e.VideoMain="VIDEO-MAIN",e.VideoSlides="VIDEO-SLIDES",e.AudioMain="AUDIO-MAIN",e.AudioSlides="AUDIO-SLIDES"}(exports.MediaType||(exports.MediaType={})),function(e){e.SourceIndication="source-indication",e.ActiveSpeaker="active-speaker",e.ScrRequestReceived="scr-request-received"}(ff||(ff={}));var Ef=function(e){(0,l.Z)(n,e);var t=xe(n);function n(e,r){var i;return(0,v.Z)(this,n),i=t.call(this),Me.default((0,d.Z)(i),"id",void 0),Me.default((0,d.Z)(i),"debugId",void 0),Me.default((0,d.Z)(i),"multistreamConnection",void 0),Me.default((0,d.Z)(i),"roap",void 0),Me.default((0,d.Z)(i),"sdpNegotiationStarted",!1),i.debugId=r,i.id=r||"MultistreamRoapMediaConnection",i.configureWcmeLogger(r),i.log("constructor()","config: ".concat(B()(e))),i.multistreamConnection=i.createMultistreamConnection(e),i.roap=i.createRoap(r),i}return(0,h.Z)(n,[{key:"configureWcmeLogger",value:function(e){var t,n=En();t=function(t,r){var i=ee()(t).map((function(e){return"object"===(0,m.Z)(e)?B()(e):e}));switch(i.unshift("".concat(e||"",":[").concat(r.name,"]")),r.level.name){case"TRACE":n.trace.apply(n,(0,c.Z)(i));break;case"DEBUG":n.debug.apply(n,(0,c.Z)(i));break;case"INFO":n.info.apply(n,(0,c.Z)(i));break;case"WARN":n.warn.apply(n,(0,c.Z)(i));break;case"ERROR":n.error.apply(n,(0,c.Z)(i))}},Nc.setHandler(t),Lo.setHandler(t)}},{key:"log",value:function(e,t){En().info("".concat(this.id,":").concat(e," ").concat(t))}},{key:"error",value:function(e,t,n){En().error("".concat(this.id,":").concat(e," ").concat(t," ").concat(yn(n)))}},{key:"createMultistreamConnection",value:function(e){var t=this;this.log("createMultistreamConnection()","creating MultistreamConnection with floorControlledPresentation: true");var n=new Gc(gf(gf({},e),{},{floorControlledPresentation:!0}));return n.on(Mc.ActiveSpeakerNotification,(function(e){t.emit(exports.Event.ACTIVE_SPEAKERS_CHANGED,{csis:e.csis})})),n.on(Mc.AudioSourceCountUpdate,(function(e,n,r){t.emit(exports.Event.AUDIO_SOURCES_COUNT_CHANGED,e,n,r)})),n.on(Mc.VideoSourceCountUpdate,(function(e,n,r){t.emit(exports.Event.VIDEO_SOURCES_COUNT_CHANGED,e,n,r)})),n.on(Mc.ConnectionStateUpdate,(function(e){t.emit(exports.Event.CONNECTION_STATE_CHANGED,{state:e})})),n}},{key:"createRoap",value:function(e,t){var n=this,r=new ef(this.createLocalOffer.bind(this),this.handleRemoteOffer.bind(this),this.handleRemoteAnswer.bind(this),e,t);return r.on(exports.Event.ROAP_MESSAGE_TO_SEND,(function(e){return n.emit(exports.Event.ROAP_MESSAGE_TO_SEND,e)})),r.on(exports.Event.ROAP_STARTED,(function(){return n.emit(exports.Event.ROAP_STARTED)})),r.on(exports.Event.ROAP_DONE,(function(){return n.emit(exports.Event.ROAP_DONE)})),r.on(exports.Event.ROAP_FAILURE,(function(e){return n.emit(exports.Event.ROAP_FAILURE,e)})),r}},{key:"initiateOffer",value:function(){return this.log("initiateOffer()","called"),this.sdpNegotiationStarted?(this.error("initiateOffer()","SDP negotiation already started"),ne().reject(new Error("SDP negotiation already started"))):(this.sdpNegotiationStarted=!0,this.roap.initiateOffer())}},{key:"close",value:function(){this.log("close()","called"),this.closeMediaConnection(),this.stopRoapSession()}},{key:"closeMediaConnection",value:function(){this.multistreamConnection.close(),this.multistreamConnection.removeAllListeners()}},{key:"stopRoapSession",value:function(){this.roap.stop(),this.roap.removeAllListeners()}},{key:"reconnect",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.log("reconnect()","iceServers: ".concat(B()(e)));var n=this.roap.getSeq();return this.stopRoapSession(),this.sdpNegotiationStarted=!1,this.multistreamConnection.renewPeerConnection({iceServers:e}),this.roap=this.createRoap(this.debugId,n),t?this.initiateOffer():ne().resolve()}},{key:"getConnectionState",value:function(){var e=this.multistreamConnection.getConnectionState();return this.log("getConnectionState()","called, returning ".concat(e)),e}},{key:"getStats",value:function(){return this.multistreamConnection.getStats()}},{key:"getTransceiverStats",value:function(){return this.multistreamConnection.getTransceiverStats()}},{key:"roapMessageReceived",value:function(e){if(this.log("roapMessageReceived()","called with messageType=".concat(e.messageType,", seq=").concat(e.seq)),!this.sdpNegotiationStarted&&"OFFER"===e.messageType)throw new Error("incoming first offer is not supported by MultistreamRoapMediaConnection");this.roap.roapMessageReceived(e)}},{key:"enableMultistreamAudio",value:function(e){return this.log("enableMultistreamAudio()","called"),this.multistreamConnection.enableMultistreamAudio(e)?this.roap.initiateOffer():ne().resolve()}},{key:"publishTrack",value:function(e){return this.log("publishTrack()","called"),this.multistreamConnection.publishTrack(e)}},{key:"unpublishTrack",value:function(e){return this.log("unpublishTrack()","called"),this.multistreamConnection.unpublishTrack(e)}},{key:"createReceiveSlot",value:function(e){return this.log("createReceiveSlot()","called"),this.multistreamConnection.createReceiveSlot(e)}},{key:"requestMedia",value:function(e,t){return this.log("requestMedia()","called"),this.multistreamConnection.requestMedia(e,t)}},{key:"createLocalOffer",value:function(){return this.multistreamConnection.createOffer().then((function(e){return e.sdp?{sdp:e.sdp}:ne().reject(new dn("empty local SDP"))})).catch((function(e){throw new dn("createLocalOffer() failure: ".concat(e.message),{cause:e})}))}},{key:"handleRemoteOffer",value:function(){return ne().reject(new pn("remote offers not supported by WCME"))}},{key:"handleRemoteAnswer",value:function(e){if(e){var t=Tr({},e);return t=t.replace(/\r\nb=TIAS:.*\r\n/g,"\r\n"),this.multistreamConnection.setAnswer(t).catch((function(e){throw new cn("handleRemoteAnswer() failure: ".concat(e.message),{cause:e})}))}return ne().reject(new cn("empty answer"))}}]),n}(_t),yf=hn;function Sf(){var e=!1;return mt.info({mediaType:dt,action:"isBrowserSupported()",description:"Checking is current browser supported by webrtc"}),(ct.exports.browser.isChrome||ct.exports.browser.isFirefox||ct.exports.browser.isSafari||ct.exports.browser.isEdge)&&ct.exports.isWebRTCSupported&&(e=!0),e}var _f={createAudioTrack:function(e){return Wt.apply(this,arguments)},createVideoTrack:function(e){return jt.apply(this,arguments)},createContentTrack:function(e){return Ht.apply(this,arguments)},getCameras:Zt,getMicrophones:Vt,getSpeakers:Gt,on:function(e,t){return Yt.apply(this,arguments)},off:function(e,t){mt.debug({mediaType:dt,action:"off()",description:"Called ".concat(e," with ").concat(t," listener")}),Pt.off(e,t)},Effects:{BNR:{enableBNR:function(e){return en.apply(this,arguments)},disableBNR:function(){mt.debug({mediaType:ft,action:"disableBNR()",description:"Called"});try{if(mt.info({mediaType:ft,action:"disableBNR()",description:"Checking if BNR is enabled before disabling"}),!Xt.isModuleAdded){var e=new Error("Can not disable as BNR is not enabled");throw mt.error({mediaType:ft,action:"disableBNR()",description:"Can not disable as BNR is not enabled"}),e}mt.info({mediaType:ft,action:"disableBNR()",description:"Using existing AudioWorkletNode for disabling BNR"}),Xt.workletNode.port.postMessage("DISPOSE"),mt.info({mediaType:ft,action:"disableBNR()",description:"Obtaining raw media stream track and removing bnr context"});var t=Xt.sourceNode.mediaStream,n=null==t?void 0:t.getAudioTracks(),r=(0,u.Z)(n,1)[0];return Xt.isModuleAdded=!1,delete Xt.workletNode,delete Xt.audioContext,delete Xt.sourceNode,delete Xt.destinationStream,delete Xt.destinationTrack,r}catch(e){throw mt.error({mediaType:ft,action:"disableBNR()",description:"Error in disableBNR",error:e}),e}}}},isBrowserSupported:Sf};exports.ActiveSpeakerInfo=df,exports.CodecInfo=pf,exports.Errors=yf,exports.H264Codec=hf,exports.LocalCameraTrack=oi,exports.LocalDisplayTrack=ai,exports.LocalMicrophoneTrack=si,exports.LocalTrack=ri,exports.Media=_f,exports.MediaRequest=ta,exports.MultistreamRoapMediaConnection=Ef,exports.PeerConnection=_o,exports.ReceiveSlot=cc,exports.ReceiverSelectedInfo=vf,exports.RoapMediaConnection=rf,exports.WcmeError=ci,exports.createCameraTrack=function(e){return br(this,void 0,void 0,E().mark((function t(){var n;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,kr({video:de()({},e)});case 3:n=t.sent,t.next=9;break;case 6:throw t.prev=6,t.t0=t.catch(0),new ci(ii.CREATE_CAMERA_TRACK_FAILED,"Failed to create camera track ".concat(t.t0));case 9:return t.abrupt("return",new oi(n));case 10:case"end":return t.stop()}}),t,null,[[0,6]])})))},exports.createDisplayTrack=function(){return br(this,void 0,void 0,E().mark((function e(){var t;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Mr({video:!0});case 2:return t=e.sent,e.abrupt("return",new ai(t));case 4:case"end":return e.stop()}}),e)})))},exports.createMicrophoneTrack=function(e){return br(this,void 0,void 0,E().mark((function t(){var n;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,kr({audio:de()({},e)});case 3:n=t.sent,t.next=9;break;case 6:throw t.prev=6,t.t0=t.catch(0),new ci(ii.CREATE_MICROPHONE_TRACK_FAILED,"Failed to create microphone track ".concat(t.t0));case 9:return t.abrupt("return",new si(n));case 10:case"end":return t.stop()}}),t,null,[[0,6]])})))},exports.getAudioInputDevices=function(){return br(this,void 0,void 0,E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ui(Lr.AudioInput));case 1:case"end":return e.stop()}}),e)})))},exports.getAudioOutputDevices=function(){return br(this,void 0,void 0,E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ui(Lr.AudioOutput));case 1:case"end":return e.stop()}}),e)})))},exports.getDevices=ui,exports.getErrorDescription=yn,exports.getLogger=En,exports.getMediaFamily=function(e){return[exports.MediaType.VideoMain,exports.MediaType.VideoSlides].includes(e)?exports.MediaFamily.Video:exports.MediaFamily.Audio},exports.getVideoInputDevices=function(){return br(this,void 0,void 0,E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ui(Lr.VideoInput));case 1:case"end":return e.stop()}}),e)})))},exports.isBrowserSupported=Sf,exports.setLogger=function(e){gn=e||mn},exports.setOnDeviceChangeHandler=fi},44940:(e,t,n)=>{"use strict";n.r(t),n.d(t,{NIL:()=>V,parse:()=>S,stringify:()=>f,v1:()=>g,v3:()=>k,v4:()=>M,v5:()=>Z,validate:()=>u,version:()=>G});var r,i=n(66130),o=n.n(i),a=new Uint8Array(16);function s(){if(!r&&!(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(a)}const c=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const u=function(e){return"string"==typeof e&&c.test(e)};for(var d=[],l=0;l<256;++l)d.push((l+256).toString(16).substr(1));const f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(d[e[t+0]]+d[e[t+1]]+d[e[t+2]]+d[e[t+3]]+"-"+d[e[t+4]]+d[e[t+5]]+"-"+d[e[t+6]]+d[e[t+7]]+"-"+d[e[t+8]]+d[e[t+9]]+"-"+d[e[t+10]]+d[e[t+11]]+d[e[t+12]]+d[e[t+13]]+d[e[t+14]]+d[e[t+15]]).toLowerCase();if(!u(n))throw TypeError("Stringified UUID is invalid");return n};var p,h,v=0,m=0;const g=function(e,t,n){var r=t&&n||0,i=t||new Array(16),a=(e=e||{}).node||p,c=void 0!==e.clockseq?e.clockseq:h;if(null==a||null==c){var u=e.random||(e.rng||s)();null==a&&(a=p=[1|u[0],u[1],u[2],u[3],u[4],u[5]]),null==c&&(c=h=16383&(u[6]<<8|u[7]))}var d=void 0!==e.msecs?e.msecs:o()(),l=void 0!==e.nsecs?e.nsecs:m+1,g=d-v+(l-m)/1e4;if(g<0&&void 0===e.clockseq&&(c=c+1&16383),(g<0||d>v)&&void 0===e.nsecs&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");v=d,m=l,h=c;var E=(1e4*(268435455&(d+=122192928e5))+l)%4294967296;i[r++]=E>>>24&255,i[r++]=E>>>16&255,i[r++]=E>>>8&255,i[r++]=255&E;var y=d/4294967296*1e4&268435455;i[r++]=y>>>8&255,i[r++]=255&y,i[r++]=y>>>24&15|16,i[r++]=y>>>16&255,i[r++]=c>>>8|128,i[r++]=255&c;for(var S=0;S<6;++S)i[r+S]=a[S];return t||f(i)};var E=n(79529),y=n.n(E);const S=function(e){if(!u(e))throw TypeError("Invalid UUID");var t,n=new Uint8Array(16);return n[0]=(t=y()(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=y()(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=y()(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=y()(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=y()(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n};var _="6ba7b810-9dad-11d1-80b4-00c04fd430c8",C="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function R(e,t,n){function r(e,r,i,o){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof r&&(r=S(r)),16!==r.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var a=new Uint8Array(16+e.length);if(a.set(r),a.set(e,r.length),(a=n(a))[6]=15&a[6]|t,a[8]=63&a[8]|128,i){o=o||0;for(var s=0;s<16;++s)i[o+s]=a[s];return i}return f(a)}try{r.name=e}catch(e){}return r.DNS=_,r.URL=C,r}function T(e){return 14+(e+64>>>9<<4)+1}function x(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function b(e,t,n,r,i,o){return x((a=x(x(t,e),x(r,o)))<<(s=i)|a>>>32-s,n);var a,s}function w(e,t,n,r,i,o,a){return b(t&n|~t&r,e,t,i,o,a)}function I(e,t,n,r,i,o,a){return b(t&r|n&~r,e,t,i,o,a)}function L(e,t,n,r,i,o,a){return b(t^n^r,e,t,i,o,a)}function O(e,t,n,r,i,o,a){return b(n^(t|~r),e,t,i,o,a)}const A=function(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return function(e){for(var t=[],n=32*e.length,r="0123456789abcdef",i=0;i<n;i+=8){var o=e[i>>5]>>>i%32&255,a=y()(r.charAt(o>>>4&15)+r.charAt(15&o),16);t.push(a)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[T(t)-1]=t;for(var n=1732584193,r=-271733879,i=-1732584194,o=271733878,a=0;a<e.length;a+=16){var s=n,c=r,u=i,d=o;n=w(n,r,i,o,e[a],7,-680876936),o=w(o,n,r,i,e[a+1],12,-389564586),i=w(i,o,n,r,e[a+2],17,606105819),r=w(r,i,o,n,e[a+3],22,-1044525330),n=w(n,r,i,o,e[a+4],7,-176418897),o=w(o,n,r,i,e[a+5],12,1200080426),i=w(i,o,n,r,e[a+6],17,-1473231341),r=w(r,i,o,n,e[a+7],22,-45705983),n=w(n,r,i,o,e[a+8],7,1770035416),o=w(o,n,r,i,e[a+9],12,-1958414417),i=w(i,o,n,r,e[a+10],17,-42063),r=w(r,i,o,n,e[a+11],22,-1990404162),n=w(n,r,i,o,e[a+12],7,1804603682),o=w(o,n,r,i,e[a+13],12,-40341101),i=w(i,o,n,r,e[a+14],17,-1502002290),n=I(n,r=w(r,i,o,n,e[a+15],22,1236535329),i,o,e[a+1],5,-165796510),o=I(o,n,r,i,e[a+6],9,-1069501632),i=I(i,o,n,r,e[a+11],14,643717713),r=I(r,i,o,n,e[a],20,-373897302),n=I(n,r,i,o,e[a+5],5,-701558691),o=I(o,n,r,i,e[a+10],9,38016083),i=I(i,o,n,r,e[a+15],14,-660478335),r=I(r,i,o,n,e[a+4],20,-405537848),n=I(n,r,i,o,e[a+9],5,568446438),o=I(o,n,r,i,e[a+14],9,-1019803690),i=I(i,o,n,r,e[a+3],14,-187363961),r=I(r,i,o,n,e[a+8],20,1163531501),n=I(n,r,i,o,e[a+13],5,-1444681467),o=I(o,n,r,i,e[a+2],9,-51403784),i=I(i,o,n,r,e[a+7],14,1735328473),n=L(n,r=I(r,i,o,n,e[a+12],20,-1926607734),i,o,e[a+5],4,-378558),o=L(o,n,r,i,e[a+8],11,-2022574463),i=L(i,o,n,r,e[a+11],16,1839030562),r=L(r,i,o,n,e[a+14],23,-35309556),n=L(n,r,i,o,e[a+1],4,-1530992060),o=L(o,n,r,i,e[a+4],11,1272893353),i=L(i,o,n,r,e[a+7],16,-155497632),r=L(r,i,o,n,e[a+10],23,-1094730640),n=L(n,r,i,o,e[a+13],4,681279174),o=L(o,n,r,i,e[a],11,-358537222),i=L(i,o,n,r,e[a+3],16,-722521979),r=L(r,i,o,n,e[a+6],23,76029189),n=L(n,r,i,o,e[a+9],4,-640364487),o=L(o,n,r,i,e[a+12],11,-421815835),i=L(i,o,n,r,e[a+15],16,530742520),n=O(n,r=L(r,i,o,n,e[a+2],23,-995338651),i,o,e[a],6,-198630844),o=O(o,n,r,i,e[a+7],10,1126891415),i=O(i,o,n,r,e[a+14],15,-1416354905),r=O(r,i,o,n,e[a+5],21,-57434055),n=O(n,r,i,o,e[a+12],6,1700485571),o=O(o,n,r,i,e[a+3],10,-1894986606),i=O(i,o,n,r,e[a+10],15,-1051523),r=O(r,i,o,n,e[a+1],21,-2054922799),n=O(n,r,i,o,e[a+8],6,1873313359),o=O(o,n,r,i,e[a+15],10,-30611744),i=O(i,o,n,r,e[a+6],15,-1560198380),r=O(r,i,o,n,e[a+13],21,1309151649),n=O(n,r,i,o,e[a+4],6,-145523070),o=O(o,n,r,i,e[a+11],10,-1120210379),i=O(i,o,n,r,e[a+2],15,718787259),r=O(r,i,o,n,e[a+9],21,-343485551),n=x(n,s),r=x(r,c),i=x(i,u),o=x(o,d)}return[n,r,i,o]}(function(e){if(0===e.length)return[];for(var t=8*e.length,n=new Uint32Array(T(t)),r=0;r<t;r+=8)n[r>>5]|=(255&e[r/8])<<r%32;return n}(e),8*e.length))};const k=R("v3",48,A);const M=function(e,t,n){var r=(e=e||{}).random||(e.rng||s)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return f(r)};var N=n(78149),D=n.n(N);function P(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:case 3:return t^n^r;case 2:return t&n^t&r^n&r}}function F(e,t){return e<<t|e>>>32-t}const U=function(e){var t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var r=unescape(encodeURIComponent(e));e=[];for(var i=0;i<r.length;++i)e.push(r.charCodeAt(i))}else D()(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var o=e.length/4+2,a=Math.ceil(o/16),s=new Array(a),c=0;c<a;++c){for(var u=new Uint32Array(16),d=0;d<16;++d)u[d]=e[64*c+4*d]<<24|e[64*c+4*d+1]<<16|e[64*c+4*d+2]<<8|e[64*c+4*d+3];s[c]=u}s[a-1][14]=8*(e.length-1)/Math.pow(2,32),s[a-1][14]=Math.floor(s[a-1][14]),s[a-1][15]=8*(e.length-1)&4294967295;for(var l=0;l<a;++l){for(var f=new Uint32Array(80),p=0;p<16;++p)f[p]=s[l][p];for(var h=16;h<80;++h)f[h]=F(f[h-3]^f[h-8]^f[h-14]^f[h-16],1);for(var v=n[0],m=n[1],g=n[2],E=n[3],y=n[4],S=0;S<80;++S){var _=Math.floor(S/20),C=F(v,5)+P(_,m,g,E)+y+t[_]+f[S]>>>0;y=E,E=g,g=F(m,30)>>>0,m=v,v=C}n[0]=n[0]+v>>>0,n[1]=n[1]+m>>>0,n[2]=n[2]+g>>>0,n[3]=n[3]+E>>>0,n[4]=n[4]+y>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]};const Z=R("v5",80,U),V="00000000-0000-0000-0000-000000000000";const G=function(e){if(!u(e))throw TypeError("Invalid UUID");return y()(e.substr(14,1),16)}},57504:(e,t,n)=>{"use strict";var r=n(26771);r(t,"__esModule",{value:!0}),r(t,"createCallHistoryClient",{enumerable:!0,get:function(){return i.createCallHistoryClient}}),r(t,"createCallSettingsClient",{enumerable:!0,get:function(){return i.createCallSettingsClient}}),r(t,"createClient",{enumerable:!0,get:function(){return i.createClient}}),r(t,"createContactsClient",{enumerable:!0,get:function(){return i.createContactsClient}}),r(t,"createVoicemailClient",{enumerable:!0,get:function(){return i.createVoicemailClient}});var i=n(24621)},17187:e=>{"use strict";var t,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}v(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&v(e,"error",t,n)}(e,i,{once:!0})}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var a=10;function s(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function u(e,t,n,r){var i,o,a,u;if(s(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]),void 0===a)a=o[t]=n,++e._eventsCount;else if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=c(e))>0&&a.length>i&&!a.warned){a.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=e,d.type=t,d.count=a.length,u=d,console&&console.warn&&console.warn(u)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function l(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=d.bind(r);return i.listener=n,r.wrapFn=i,i}function f(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):h(i,i.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function h(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function v(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){r.once&&e.removeEventListener(t,i),n(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)r(c,this,t);else{var u=c.length,d=h(c,u);for(n=0;n<u;++n)r(d[n],this,t)}return!0},o.prototype.addListener=function(e,t){return u(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return u(this,e,t,!0)},o.prototype.once=function(e,t){return s(t),this.on(e,l(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return s(t),this.prependListener(e,l(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,r,i,o,a;if(s(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},o.prototype.listeners=function(e){return f(this,e,!0)},o.prototype.rawListeners=function(e){return f(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},o.prototype.listenerCount=p,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},31795:function(e,t,n){var r;e=n.nmd(e),function(){"use strict";var i={function:!0,object:!0},o=i[typeof window]&&window||this,a=i[typeof t]&&t,s=i.object&&e&&!e.nodeType&&e,c=a&&s&&"object"==typeof n.g&&n.g;!c||c.global!==c&&c.window!==c&&c.self!==c||(o=c);var u=Math.pow(2,53)-1,d=/\bOpera/,l=Object.prototype,f=l.hasOwnProperty,p=l.toString;function h(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function v(e){return e=S(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:h(e)}function m(e,t){for(var n in e)f.call(e,n)&&t(e[n],n,e)}function g(e){return null==e?h(e):p.call(e).slice(8,-1)}function E(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function y(e,t){var n=null;return function(e,t){var n=-1,r=e?e.length:0;if("number"==typeof r&&r>-1&&r<=u)for(;++n<r;)t(e[n],n,e);else m(e,t)}(e,(function(r,i){n=t(n,r,i,e)})),n}function S(e){return String(e).replace(/^ +| +$/g,"")}var _=function e(t){var n=o,r=t&&"object"==typeof t&&"String"!=g(t);r&&(n=t,t=null);var i=n.navigator||{},a=i.userAgent||"";t||(t=a);var s,c,u,l,f,h=r?!!i.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(p.toString()),_="Object",C=r?_:"ScriptBridgingProxyObject",R=r?_:"Environment",T=r&&n.java?"JavaPackage":g(n.java),x=r?_:"RuntimeObject",b=/\bJava/.test(T)&&n.java,w=b&&g(n.environment)==R,I=b?"a":"α",L=b?"b":"β",O=n.document||{},A=n.operamini||n.opera,k=d.test(k=r&&A?A["[[Class]]"]:g(A))?k:A=null,M=t,N=[],D=null,P=t==a,F=P&&A&&"function"==typeof A.version&&A.version(),U=y([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],(function(e,n){return e||RegExp("\\b"+(n.pattern||E(n))+"\\b","i").exec(t)&&(n.label||n)})),Z=function(e){return y(e,(function(e,n){return e||RegExp("\\b"+(n.pattern||E(n))+"\\b","i").exec(t)&&(n.label||n)}))}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),V=W([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),G=function(e){return y(e,(function(e,n,r){return e||(n[V]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(V)]||RegExp("\\b"+E(r)+"(?:\\b|\\w*\\d)","i").exec(t))&&r}))}({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),B=function(e){return y(e,(function(e,n){var r=n.pattern||E(n);return!e&&(e=RegExp("\\b"+r+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(e=function(e,t,n){var r={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&n&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(r=r[/[\d.]+$/.exec(e)])&&(e="Windows "+r),e=String(e),t&&n&&(e=e.replace(RegExp(t,"i"),n)),v(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(e,r,n.label||n)),e}))}(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function W(e){return y(e,(function(e,n){var r=n.pattern||E(n);return!e&&(e=RegExp("\\b"+r+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+r+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+r+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((e=String(n.label&&!RegExp(r,"i").test(n.label)?n.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),n=n.label||n,e=v(e[0].replace(RegExp(r,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),e}))}function j(e){return y(e,(function(e,n){return e||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null}))}if(U&&(U=[U]),/\bAndroid\b/.test(B)&&!V&&(s=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(t))&&(V=S(s[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),G&&!V?V=W([G]):G&&V&&(V=V.replace(RegExp("^("+E(G)+")[-_.\\s]","i"),G+" ").replace(RegExp("^("+E(G)+")[-_.]?(\\w)","i"),G+" $2")),(s=/\bGoogle TV\b/.exec(V))&&(V=s[0]),/\bSimulator\b/i.test(t)&&(V=(V?V+" ":"")+"Simulator"),"Opera Mini"==Z&&/\bOPiOS\b/.test(t)&&N.push("running in Turbo/Uncompressed mode"),"IE"==Z&&/\blike iPhone OS\b/.test(t)?(G=(s=e(t.replace(/like iPhone OS/,""))).manufacturer,V=s.product):/^iP/.test(V)?(Z||(Z="Safari"),B="iOS"+((s=/ OS ([\d_]+)/i.exec(t))?" "+s[1].replace(/_/g,"."):"")):"Konqueror"==Z&&/^Linux\b/i.test(B)?B="Kubuntu":G&&"Google"!=G&&(/Chrome/.test(Z)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(V))||/\bAndroid\b/.test(B)&&/^Chrome/.test(Z)&&/\bVersion\//i.test(t)?(Z="Android Browser",B=/\bAndroid\b/.test(B)?B:"Android"):"Silk"==Z?(/\bMobi/i.test(t)||(B="Android",N.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&N.unshift("accelerated")):"UC Browser"==Z&&/\bUCWEB\b/.test(t)?N.push("speed mode"):"PaleMoon"==Z&&(s=/\bFirefox\/([\d.]+)\b/.exec(t))?N.push("identifying as Firefox "+s[1]):"Firefox"==Z&&(s=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(B||(B="Firefox OS"),V||(V=s[1])):!Z||(s=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec(Z))?(Z&&!V&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(s+"/")+8))&&(Z=null),(s=V||G||B)&&(V||G||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(B))&&(Z=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(B)?B:s)+" Browser")):"Electron"==Z&&(s=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&N.push("Chromium "+s),F||(F=j(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",E(Z),"(?:Firefox|Minefield|NetFront)"])),(s=("iCab"==U&&parseFloat(F)>3?"WebKit":/\bOpera\b/.test(Z)&&(/\bOPR\b/.test(t)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(U)&&"WebKit"||!U&&/\bMSIE\b/i.test(t)&&("Mac OS"==B?"Tasman":"Trident")||"WebKit"==U&&/\bPlayStation\b(?! Vita\b)/i.test(Z)&&"NetFront")&&(U=[s]),"IE"==Z&&(s=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?(Z+=" Mobile",B="Windows Phone "+(/\+$/.test(s)?s:s+".x"),N.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?(Z="IE Mobile",B="Windows Phone 8.x",N.unshift("desktop mode"),F||(F=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=Z&&"Trident"==U&&(s=/\brv:([\d.]+)/.exec(t))&&(Z&&N.push("identifying as "+Z+(F?" "+F:"")),Z="IE",F=s[1]),P){if(l="global",f=null!=(u=n)?typeof u[l]:"number",/^(?:boolean|number|string|undefined)$/.test(f)||"object"==f&&!u[l])g(s=n.runtime)==C?(Z="Adobe AIR",B=s.flash.system.Capabilities.os):g(s=n.phantom)==x?(Z="PhantomJS",F=(s=s.version||null)&&s.major+"."+s.minor+"."+s.patch):"number"==typeof O.documentMode&&(s=/\bTrident\/(\d+)/i.exec(t))?(F=[F,O.documentMode],(s=+s[1]+4)!=F[1]&&(N.push("IE "+F[1]+" mode"),U&&(U[1]=""),F[1]=s),F="IE"==Z?String(F[1].toFixed(1)):F[0]):"number"==typeof O.documentMode&&/^(?:Chrome|Firefox)\b/.test(Z)&&(N.push("masking as "+Z+" "+F),Z="IE",F="11.0",U=["Trident"],B="Windows");else if(b&&(M=(s=b.lang.System).getProperty("os.arch"),B=B||s.getProperty("os.name")+" "+s.getProperty("os.version")),w){try{F=n.require("ringo/engine").version.join("."),Z="RingoJS"}catch(e){(s=n.system)&&s.global.system==n.system&&(Z="Narwhal",B||(B=s[0].os||null))}Z||(Z="Rhino")}else"object"==typeof n.process&&!n.process.browser&&(s=n.process)&&("object"==typeof s.versions&&("string"==typeof s.versions.electron?(N.push("Node "+s.versions.node),Z="Electron",F=s.versions.electron):"string"==typeof s.versions.nw&&(N.push("Chromium "+F,"Node "+s.versions.node),Z="NW.js",F=s.versions.nw)),Z||(Z="Node.js",M=s.arch,B=s.platform,F=(F=/[\d.]+/.exec(s.version))?F[0]:null));B=B&&v(B)}if(F&&(s=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(F)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(P&&i.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(D=/b/i.test(s)?"beta":"alpha",F=F.replace(RegExp(s+"\\+?$"),"")+("beta"==D?L:I)+(/\d+\+?/.exec(s)||"")),"Fennec"==Z||"Firefox"==Z&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(B))Z="Firefox Mobile";else if("Maxthon"==Z&&F)F=F.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(V))"Xbox 360"==V&&(B=null),"Xbox 360"==V&&/\bIEMobile\b/.test(t)&&N.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(Z)&&(!Z||V||/Browser|Mobi/.test(Z))||"Windows CE"!=B&&!/Mobi/i.test(t))if("IE"==Z&&P)try{null===n.external&&N.unshift("platform preview")}catch(e){N.unshift("embedded")}else(/\bBlackBerry\b/.test(V)||/\bBB10\b/.test(t))&&(s=(RegExp(V.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||F)?(B=((s=[s,/BB10/.test(t)])[1]?(V=null,G="BlackBerry"):"Device Software")+" "+s[0],F=null):this!=m&&"Wii"!=V&&(P&&A||/Opera/.test(Z)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==Z&&/\bOS X (?:\d+\.){2,}/.test(B)||"IE"==Z&&(B&&!/^Win/.test(B)&&F>5.5||/\bWindows XP\b/.test(B)&&F>8||8==F&&!/\bTrident\b/.test(t)))&&!d.test(s=e.call(m,t.replace(d,"")+";"))&&s.name&&(s="ing as "+s.name+((s=s.version)?" "+s:""),d.test(Z)?(/\bIE\b/.test(s)&&"Mac OS"==B&&(B=null),s="identify"+s):(s="mask"+s,Z=k?v(k.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(s)&&(B=null),P||(F=null)),U=["Presto"],N.push(s));else Z+=" Mobile";(s=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(s=[parseFloat(s.replace(/\.(\d)$/,".0$1")),s],"Safari"==Z&&"+"==s[1].slice(-1)?(Z="WebKit Nightly",D="alpha",F=s[1].slice(0,-1)):F!=s[1]&&F!=(s[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1])||(F=null),s[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(t)||0)[1],537.36==s[0]&&537.36==s[2]&&parseFloat(s[1])>=28&&"WebKit"==U&&(U=["Blink"]),P&&(h||s[1])?(U&&(U[1]="like Chrome"),s=s[1]||((s=s[0])<530?1:s<532?2:s<532.05?3:s<533?4:s<534.03?5:s<534.07?6:s<534.1?7:s<534.13?8:s<534.16?9:s<534.24?10:s<534.3?11:s<535.01?12:s<535.02?"13+":s<535.07?15:s<535.11?16:s<535.19?17:s<536.05?18:s<536.1?19:s<537.01?20:s<537.11?"21+":s<537.13?23:s<537.18?24:s<537.24?25:s<537.36?26:"Blink"!=U?"27":"28")):(U&&(U[1]="like Safari"),s=(s=s[0])<400?1:s<500?2:s<526?3:s<533?4:s<534?"4+":s<535?5:s<537?6:s<538?7:s<601?8:s<602?9:s<604?10:s<606?11:s<608?12:"12"),U&&(U[1]+=" "+(s+="number"==typeof s?".x":/[.+]/.test(s)?"":"+")),"Safari"==Z&&(!F||parseInt(F)>45)?F=s:"Chrome"==Z&&/\bHeadlessChrome/i.test(t)&&N.unshift("headless")),"Opera"==Z&&(s=/\bzbov|zvav$/.exec(B))?(Z+=" ",N.unshift("desktop mode"),"zvav"==s?(Z+="Mini",F=null):Z+="Mobile",B=B.replace(RegExp(" *"+s+"$"),"")):"Safari"==Z&&/\bChrome\b/.exec(U&&U[1])?(N.unshift("desktop mode"),Z="Chrome Mobile",F=null,/\bOS X\b/.test(B)?(G="Apple",B="iOS 4.3+"):B=null):/\bSRWare Iron\b/.test(Z)&&!F&&(F=j("Chrome")),F&&0==F.indexOf(s=/[\d.]+$/.exec(B))&&t.indexOf("/"+s+"-")>-1&&(B=S(B.replace(s,""))),B&&-1!=B.indexOf(Z)&&!RegExp(Z+" OS").test(B)&&(B=B.replace(RegExp(" *"+E(Z)+" *"),"")),U&&!/\b(?:Avant|Nook)\b/.test(Z)&&(/Browser|Lunascape|Maxthon/.test(Z)||"Safari"!=Z&&/^iOS/.test(B)&&/\bSafari\b/.test(U[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(Z)&&U[1])&&(s=U[U.length-1])&&N.push(s),N.length&&(N=["("+N.join("; ")+")"]),G&&V&&V.indexOf(G)<0&&N.push("on "+G),V&&N.push((/^on /.test(N[N.length-1])?"":"on ")+V),B&&(s=/ ([\d.+]+)$/.exec(B),c=s&&"/"==B.charAt(B.length-s[0].length-1),B={architecture:32,family:s&&!c?B.replace(s[0],""):B,version:s?s[1]:null,toString:function(){var e=this.version;return this.family+(e&&!c?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(s=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(M))&&!/\bi686\b/i.test(M)?(B&&(B.architecture=64,B.family=B.family.replace(RegExp(" *"+s),"")),Z&&(/\bWOW64\b/i.test(t)||P&&/\w(?:86|32)$/.test(i.cpuClass||i.platform)&&!/\bWin64; x64\b/i.test(t))&&N.unshift("32-bit")):B&&/^OS X/.test(B.family)&&"Chrome"==Z&&parseFloat(F)>=39&&(B.architecture=64),t||(t=null);var H={};return H.description=t,H.layout=U&&U[0],H.manufacturer=G,H.name=Z,H.prerelease=D,H.product=V,H.ua=t,H.version=Z&&F,H.os=B||{architecture:null,family:null,version:null,toString:function(){return"null"}},H.parse=e,H.toString=function(){return this.description||""},H.version&&N.unshift(F),H.name&&N.unshift(Z),B&&Z&&(B!=String(B).split(" ")[0]||B!=Z.split(" ")[0]&&!V)&&N.push(V?"("+B+")":"on "+B),N.length&&(H.description=N.join(" ")),H}();o.platform=_,void 0===(r=function(){return _}.call(t,n,t,e))||(e.exports=r)}.call(this)},70655:(e,t,n)=>{"use strict";n.r(t),n.d(t,{__assign:()=>o,__asyncDelegator:()=>x,__asyncGenerator:()=>T,__asyncValues:()=>b,__await:()=>R,__awaiter:()=>h,__classPrivateFieldGet:()=>A,__classPrivateFieldIn:()=>M,__classPrivateFieldSet:()=>k,__createBinding:()=>m,__decorate:()=>s,__esDecorate:()=>u,__exportStar:()=>g,__extends:()=>i,__generator:()=>v,__importDefault:()=>O,__importStar:()=>L,__makeTemplateObject:()=>w,__metadata:()=>p,__param:()=>c,__propKey:()=>l,__read:()=>y,__rest:()=>a,__runInitializers:()=>d,__setFunctionName:()=>f,__spread:()=>S,__spreadArray:()=>C,__spreadArrays:()=>_,__values:()=>E});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function s(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function c(e,t){return function(n,r){t(n,r,e)}}function u(e,t,n,r,i,o){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,c=r.kind,u="getter"===c?"get":"setter"===c?"set":"value",d=!t&&e?r.static?e:e.prototype:null,l=t||(d?Object.getOwnPropertyDescriptor(d,r.name):{}),f=!1,p=n.length-1;p>=0;p--){var h={};for(var v in r)h[v]="access"===v?{}:r[v];for(var v in r.access)h.access[v]=r.access[v];h.addInitializer=function(e){if(f)throw new TypeError("Cannot add initializers after decoration has completed");o.push(a(e||null))};var m=(0,n[p])("accessor"===c?{get:l.get,set:l.set}:l[u],h);if("accessor"===c){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(s=a(m.get))&&(l.get=s),(s=a(m.set))&&(l.set=s),(s=a(m.init))&&i.push(s)}else(s=a(m))&&("field"===c?i.push(s):l[u]=s)}d&&Object.defineProperty(d,r.name,l),f=!0}function d(e,t,n){for(var r=arguments.length>2,i=0;i<t.length;i++)n=r?t[i].call(e,n):t[i].call(e);return r?n:void 0}function l(e){return"symbol"==typeof e?e:"".concat(e)}function f(e,t,n){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function h(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function v(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}var m=Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function g(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||m(t,e,n)}function E(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function S(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}function _(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function C(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function R(e){return this instanceof R?(this.v=e,this):new R(e)}function T(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{(n=i[e](t)).value instanceof R?Promise.resolve(n.value.v).then(c,u):d(o[0][2],n)}catch(e){d(o[0][3],e)}var n}function c(e){s("next",e)}function u(e){s("throw",e)}function d(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function x(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:R(e[r](t)),done:!1}:i?i(t):t}:i}}function b(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=E(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,i,(t=e[n](t)).done,t.value)}))}}}function w(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var I=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function L(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&m(t,e,n);return I(t,e),t}function O(e){return e&&e.__esModule?e:{default:e}}function A(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function k(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}function M(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},7836:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ActionTypes:()=>o,Interpreter:()=>St,InterpreterStatus:()=>Et,Machine:()=>kt,SpecialTargets:()=>a,State:()=>ut,StateNode:()=>At,actions:()=>i,assign:()=>Ut,createMachine:()=>Mt,createSchema:()=>Pt,doneInvoke:()=>Wt,forwardTo:()=>Bt,interpret:()=>Rt,mapState:()=>Nt,matchState:()=>Dt,matchesState:()=>P,send:()=>Zt,sendParent:()=>Vt,sendUpdate:()=>Gt,spawn:()=>Ct,spawnBehavior:()=>gt,t:()=>Ft,toActorRef:()=>Xe,toEventObject:()=>se,toObserver:()=>fe,toSCXMLEvent:()=>ce});var r={};n.r(r),n.d(r,{after:()=>S,assign:()=>y,cancel:()=>g,choose:()=>L,doneState:()=>_,error:()=>w,errorExecution:()=>x,errorPlatform:()=>b,init:()=>R,invoke:()=>T,log:()=>C,nullEvent:()=>E,pure:()=>O,raise:()=>v,send:()=>m,start:()=>p,stop:()=>h,update:()=>I});var i={};n.r(i),n.d(i,{actionTypes:()=>r,after:()=>Pe,assign:()=>Ne,cancel:()=>Oe,choose:()=>We,done:()=>Fe,doneInvoke:()=>Ue,error:()=>Ze,escalate:()=>Be,forwardTo:()=>Ge,getActionFunction:()=>ve,initEvent:()=>he,isActionObject:()=>De,log:()=>Ie,pure:()=>Ve,raise:()=>ye,resolveActions:()=>je,resolveLog:()=>Le,resolveRaise:()=>Se,resolveSend:()=>Ce,resolveStop:()=>Me,respond:()=>be,send:()=>_e,sendParent:()=>Re,sendTo:()=>Te,sendUpdate:()=>xe,start:()=>Ae,stop:()=>ke,toActionObject:()=>me,toActionObjects:()=>ge,toActivityDefinition:()=>Ee});var o,a,s=function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},s.apply(this,arguments)};function c(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function u(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function d(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function l(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}!function(e){e.Start="xstate.start",e.Stop="xstate.stop",e.Raise="xstate.raise",e.Send="xstate.send",e.Cancel="xstate.cancel",e.NullEvent="",e.Assign="xstate.assign",e.After="xstate.after",e.DoneState="done.state",e.DoneInvoke="done.invoke",e.Log="xstate.log",e.Init="xstate.init",e.Invoke="xstate.invoke",e.ErrorExecution="error.execution",e.ErrorCommunication="error.communication",e.ErrorPlatform="error.platform",e.ErrorCustom="xstate.error",e.Update="xstate.update",e.Pure="xstate.pure",e.Choose="xstate.choose"}(o||(o={})),function(e){e.Parent="#_parent",e.Internal="#_internal"}(a||(a={}));var f,p=o.Start,h=o.Stop,v=o.Raise,m=o.Send,g=o.Cancel,E=o.NullEvent,y=o.Assign,S=o.After,_=o.DoneState,C=o.Log,R=o.Init,T=o.Invoke,x=o.ErrorExecution,b=o.ErrorPlatform,w=o.ErrorCustom,I=o.Update,L=o.Choose,O=o.Pure,A=".",k={},M="xstate.guard",N="",D=!0;function P(e,t,n){void 0===n&&(n=A);var r=Z(e,n),i=Z(t,n);return ne(i)?!!ne(r)&&i===r:ne(r)?r in i:Object.keys(r).every((function(e){return e in i&&P(r[e],i[e])}))}function F(e){try{return ne(e)||"number"==typeof e?"".concat(e):e.type}catch(e){throw new Error("Events must be strings or objects with a string event.type property.")}}function U(e,t){try{return ee(e)?e:e.toString().split(t)}catch(t){throw new Error("'".concat(e,"' is not a valid state path."))}}function Z(e,t){return"object"==typeof(n=e)&&"value"in n&&"context"in n&&"event"in n&&"_event"in n?e.value:ee(e)?V(e):"string"!=typeof e?e:V(U(e,t));var n}function V(e){if(1===e.length)return e[0];for(var t={},n=t,r=0;r<e.length-1;r++)r===e.length-2?n[e[r]]=e[r+1]:(n[e[r]]={},n=n[e[r]]);return t}function G(e,t){for(var n={},r=Object.keys(e),i=0;i<r.length;i++){var o=r[i];n[o]=t(e[o],o,e,i)}return n}function B(e,t,n){var r,i,o={};try{for(var a=u(Object.keys(e)),s=a.next();!s.done;s=a.next()){var c=s.value,d=e[c];n(d)&&(o[c]=t(d,c,e))}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return o}var W=function(e){return function(t){var n,r,i=t;try{for(var o=u(e),a=o.next();!a.done;a=o.next()){i=i[a.value]}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}};function j(e){return e?ne(e)?[[e]]:H(Object.keys(e).map((function(t){var n=e[t];return"string"==typeof n||n&&Object.keys(n).length?j(e[t]).map((function(e){return[t].concat(e)})):[[t]]}))):[[]]}function H(e){var t;return(t=[]).concat.apply(t,l([],d(e),!1))}function K(e){return ee(e)?e:[e]}function q(e){return void 0===e?[]:K(e)}function Y(e,t,n){var r,i;if(te(e))return e(t,n.data);var o={};try{for(var a=u(Object.keys(e)),s=a.next();!s.done;s=a.next()){var c=s.value,d=e[c];te(d)?o[c]=d(t,n.data):o[c]=d}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return o}function z(e){return e instanceof Promise||!(null===e||!te(e)&&"object"!=typeof e||!te(e.then))}function X(e,t){var n,r,i=d([[],[]],2),o=i[0],a=i[1];try{for(var s=u(e),c=s.next();!c.done;c=s.next()){var l=c.value;t(l)?o.push(l):a.push(l)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return[o,a]}function J(e,t){return G(e.states,(function(e,n){if(e){var r=(ne(t)?void 0:t[n])||(e?e.current:void 0);if(r)return{current:r,states:J(e,r)}}}))}function $(e,t,n,r){D||Q(!!e,"Attempting to update undefined context");var i=e?n.reduce((function(e,n){var i,o,a=n.assignment,s={state:r,action:n,_event:t},c={};if(te(a))c=a(e,t.data,s);else try{for(var d=u(Object.keys(a)),l=d.next();!l.done;l=d.next()){var f=l.value,p=a[f];c[f]=te(p)?p(e,t.data,s):p}}catch(e){i={error:e}}finally{try{l&&!l.done&&(o=d.return)&&o.call(d)}finally{if(i)throw i.error}}return Object.assign({},e,c)}),e):e;return i}var Q=function(){};function ee(e){return Array.isArray(e)}function te(e){return"function"==typeof e}function ne(e){return"string"==typeof e}function re(e,t){if(e)return ne(e)?{type:M,name:e,predicate:t?t[e]:void 0}:te(e)?{type:M,name:e.name,predicate:e}:e}D||(Q=function(e,t){var n=e instanceof Error?e:void 0;if((n||!e)&&void 0!==console){var r=["Warning: ".concat(t)];n&&r.push(n),console.warn.apply(console,r)}});var ie=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();(f={})[ie]=function(){return this},f[Symbol.observable]=function(){return this};function oe(e){return!!e&&"__xstatenode"in e}var ae=function(){var e=0;return function(){return(++e).toString(16)}}();function se(e,t){return ne(e)||"number"==typeof e?s({type:e},t):e}function ce(e,t){if(!ne(e)&&"$$type"in e&&"scxml"===e.$$type)return e;var n=se(e);return s({name:n.type,data:n,$$type:"scxml",type:"external"},t)}function ue(e,t){return K(t).map((function(t){return void 0===t||"string"==typeof t||oe(t)?{target:t,event:e}:s(s({},t),{event:e})}))}function de(e,t,n,r,i){var o=e.options.guards,a={state:i,cond:t,_event:r};if(t.type===M)return((null==o?void 0:o[t.name])||t.predicate)(n,r.data,a);var s=null==o?void 0:o[t.type];if(!s)throw new Error("Guard '".concat(t.type,"' is not implemented on machine '").concat(e.id,"'."));return s(n,r.data,a)}function le(e){return"string"==typeof e?{type:e}:e}function fe(e,t,n){if("object"==typeof e)return e;var r=function(){};return{next:e,error:t||r,complete:n||r}}function pe(e,t){return"".concat(e,":invocation[").concat(t,"]")}var he=ce({type:R});function ve(e,t){return t&&t[e]||void 0}function me(e,t){var n;if(ne(e)||"number"==typeof e)n=te(r=ve(e,t))?{type:e,exec:r}:r||{type:e,exec:void 0};else if(te(e))n={type:e.name||e.toString(),exec:e};else{var r;if(te(r=ve(e.type,t)))n=s(s({},e),{exec:r});else if(r){var i=r.type||e.type;n=s(s(s({},r),e),{type:i})}else n=e}return n}var ge=function(e,t){return e?(ee(e)?e:[e]).map((function(e){return me(e,t)})):[]};function Ee(e){var t=me(e);return s(s({id:ne(e)?e:t.id},t),{type:t.type})}function ye(e){return ne(e)?{type:v,event:e}:_e(e,{to:a.Internal})}function Se(e){return{type:v,_event:ce(e.event)}}function _e(e,t){return{to:t?t.to:void 0,type:m,event:te(e)?e:se(e),delay:t?t.delay:void 0,id:t&&void 0!==t.id?t.id:te(e)?e.name:F(e)}}function Ce(e,t,n,r){var i,o={_event:n},a=ce(te(e.event)?e.event(t,n.data,o):e.event);if(ne(e.delay)){var c=r&&r[e.delay];i=te(c)?c(t,n.data,o):c}else i=te(e.delay)?e.delay(t,n.data,o):e.delay;var u=te(e.to)?e.to(t,n.data,o):e.to;return s(s({},e),{to:u,_event:a,event:a.data,delay:i})}function Re(e,t){return _e(e,s(s({},t),{to:a.Parent}))}function Te(e,t,n){return _e(t,s(s({},n),{to:e}))}function xe(){return Re(I)}function be(e,t){return _e(e,s(s({},t),{to:function(e,t,n){return n._event.origin}}))}var we=function(e,t){return{context:e,event:t}};function Ie(e,t){return void 0===e&&(e=we),{type:C,label:t,expr:e}}var Le=function(e,t,n){return s(s({},e),{value:ne(e.expr)?e.expr:e.expr(t,n.data,{_event:n})})},Oe=function(e){return{type:g,sendId:e}};function Ae(e){var t=Ee(e);return{type:o.Start,activity:t,exec:void 0}}function ke(e){var t=te(e)?e:Ee(e);return{type:o.Stop,activity:t,exec:void 0}}function Me(e,t,n){var r=te(e.activity)?e.activity(t,n.data):e.activity,i="string"==typeof r?{id:r}:r;return{type:o.Stop,activity:i}}var Ne=function(e){return{type:y,assignment:e}};function De(e){return"object"==typeof e&&"type"in e}function Pe(e,t){var n=t?"#".concat(t):"";return"".concat(o.After,"(").concat(e,")").concat(n)}function Fe(e,t){var n="".concat(o.DoneState,".").concat(e),r={type:n,data:t,toString:function(){return n}};return r}function Ue(e,t){var n="".concat(o.DoneInvoke,".").concat(e),r={type:n,data:t,toString:function(){return n}};return r}function Ze(e,t){var n="".concat(o.ErrorPlatform,".").concat(e),r={type:n,data:t,toString:function(){return n}};return r}function Ve(e){return{type:o.Pure,get:e}}function Ge(e,t){return _e((function(e,t){return t}),s(s({},t),{to:e}))}function Be(e,t){return Re((function(t,n,r){return{type:w,data:te(e)?e(t,n,r):e}}),s(s({},t),{to:a.Parent}))}function We(e){return{type:o.Choose,conds:e}}function je(e,t,n,r,i,o){void 0===o&&(o=!1);var a=d(o?[[],i]:X(i,(function(e){return e.type===y})),2),c=a[0],u=a[1],f=c.length?$(n,r,c,t):n,p=o?[n]:void 0,g=H(u.map((function(n){var i;switch(n.type){case v:return Se(n);case m:var a=Ce(n,f,r,e.options.delays);return D||Q(!ne(n.delay)||"number"==typeof a.delay,"No delay reference for delay expression '".concat(n.delay,"' was found on machine '").concat(e.id,"'")),a;case C:return Le(n,f,r);case L:if(!(E=null===(i=n.conds.find((function(n){var i=re(n.cond,e.options.guards);return!i||de(e,i,f,r,t)})))||void 0===i?void 0:i.actions))return[];var c=d(je(e,t,f,r,ge(q(E),e.options.actions),o),2),u=c[0],g=c[1];return f=g,null==p||p.push(f),u;case O:var E;if(!(E=n.get(f,r.data)))return[];var S=d(je(e,t,f,r,ge(q(E),e.options.actions),o),2),_=S[0],R=S[1];return f=R,null==p||p.push(f),_;case h:return Me(n,f,r);case y:f=$(f,r,[n],t),null==p||p.push(f);break;default:var T=me(n,e.options.actions),x=T.exec;if(x&&p){var b=p.length-1;T=s(s({},T),{exec:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];x.apply(void 0,l([p[b]],d(t),!1))}})}return T}})).filter((function(e){return!!e})));return[g,f]}var He=[],Ke=function(e,t){He.push(e);var n=t(e);return He.pop(),n},qe=function(e){return e(He[He.length-1])};function Ye(e){var t;return(t={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:e}}})[ie]=function(){return this},t}function ze(e,t,n){var r=Ye(t);if(r.deferred=!0,oe(e)){var i=r.state=Ke(void 0,(function(){return(n?e.withContext(n):e).initialState}));r.getSnapshot=function(){return i}}return r}function Xe(e){var t;return s(((t={subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}})[ie]=function(){return this},t),e)}var Je=function(e){return"atomic"===e.type||"final"===e.type};function $e(e){return Object.keys(e.states).map((function(t){return e.states[t]}))}function Qe(e){var t=[e];return Je(e)?t:t.concat(H($e(e).map(Qe)))}function et(e,t){var n,r,i,o,a,s,c,d,l=nt(new Set(e)),f=new Set(t);try{for(var p=u(f),h=p.next();!h.done;h=p.next())for(var v=(T=h.value).parent;v&&!f.has(v);)f.add(v),v=v.parent}catch(e){n={error:e}}finally{try{h&&!h.done&&(r=p.return)&&r.call(p)}finally{if(n)throw n.error}}var m=nt(f);try{for(var g=u(f),E=g.next();!E.done;E=g.next()){if("compound"!==(T=E.value).type||m.get(T)&&m.get(T).length){if("parallel"===T.type)try{for(var y=(a=void 0,u($e(T))),S=y.next();!S.done;S=y.next()){var _=S.value;"history"!==_.type&&(f.has(_)||(f.add(_),l.get(_)?l.get(_).forEach((function(e){return f.add(e)})):_.initialStateNodes.forEach((function(e){return f.add(e)}))))}}catch(e){a={error:e}}finally{try{S&&!S.done&&(s=y.return)&&s.call(y)}finally{if(a)throw a.error}}}else l.get(T)?l.get(T).forEach((function(e){return f.add(e)})):T.initialStateNodes.forEach((function(e){return f.add(e)}))}}catch(e){i={error:e}}finally{try{E&&!E.done&&(o=g.return)&&o.call(g)}finally{if(i)throw i.error}}try{for(var C=u(f),R=C.next();!R.done;R=C.next()){var T;for(v=(T=R.value).parent;v&&!f.has(v);)f.add(v),v=v.parent}}catch(e){c={error:e}}finally{try{R&&!R.done&&(d=C.return)&&d.call(C)}finally{if(c)throw c.error}}return f}function tt(e,t){var n=t.get(e);if(!n)return{};if("compound"===e.type){var r=n[0];if(!r)return{};if(Je(r))return r.key}var i={};return n.forEach((function(e){i[e.key]=tt(e,t)})),i}function nt(e){var t,n,r=new Map;try{for(var i=u(e),o=i.next();!o.done;o=i.next()){var a=o.value;r.has(a)||r.set(a,[]),a.parent&&(r.has(a.parent)||r.set(a.parent,[]),r.get(a.parent).push(a))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}function rt(e,t){return tt(e,nt(et([e],t)))}function it(e,t){return Array.isArray(e)?e.some((function(e){return e===t})):e instanceof Set&&e.has(t)}function ot(e,t){return"compound"===t.type?$e(t).some((function(t){return"final"===t.type&&it(e,t)})):"parallel"===t.type&&$e(t).every((function(t){return ot(e,t)}))}function at(e){return new Set(H(e.map((function(e){return e.tags}))))}function st(e,t){if(e===t)return!0;if(void 0===e||void 0===t)return!1;if(ne(e)||ne(t))return e===t;var n=Object.keys(e),r=Object.keys(t);return n.length===r.length&&n.every((function(n){return st(e[n],t[n])}))}function ct(e){return"object"==typeof e&&null!==e&&("value"in e&&"_event"in e)}var ut=function(){function e(e){var t,n,r=this;this.actions=[],this.activities=k,this.meta={},this.events=[],this.value=e.value,this.context=e.context,this._event=e._event,this._sessionid=e._sessionid,this.event=this._event.data,this.historyValue=e.historyValue,this.history=e.history,this.actions=e.actions||[],this.activities=e.activities||k,this.meta=(void 0===(n=e.configuration)&&(n=[]),n.reduce((function(e,t){return void 0!==t.meta&&(e[t.id]=t.meta),e}),{})),this.events=e.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=e.configuration,this.transitions=e.transitions,this.children=e.children,this.done=!!e.done,this.tags=null!==(t=Array.isArray(e.tags)?new Set(e.tags):e.tags)&&void 0!==t?t:new Set,this.machine=e.machine,Object.defineProperty(this,"nextEvents",{get:function(){return function(e){return l([],d(new Set(H(l([],d(e.map((function(e){return e.ownEvents}))),!1)))),!1)}(r.configuration)}})}return e.from=function(t,n){return t instanceof e?t.context!==n?new e({value:t.value,context:n,_event:t._event,_sessionid:null,historyValue:t.historyValue,history:t.history,actions:[],activities:t.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):t:new e({value:t,context:n,_event:he,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},e.create=function(t){return new e(t)},e.inert=function(t,n){if(t instanceof e){if(!t.actions.length)return t;var r=he;return new e({value:t.value,context:n,_event:r,_sessionid:null,historyValue:t.historyValue,history:t.history,activities:t.activities,configuration:t.configuration,transitions:[],children:{}})}return e.from(t,n)},e.prototype.toStrings=function(e,t){var n=this;if(void 0===e&&(e=this.value),void 0===t&&(t="."),ne(e))return[e];var r=Object.keys(e);return r.concat.apply(r,l([],d(r.map((function(r){return n.toStrings(e[r],t).map((function(e){return r+t+e}))}))),!1))},e.prototype.toJSON=function(){var e=this;e.configuration,e.transitions;var t=e.tags;e.machine;var n=c(e,["configuration","transitions","tags","machine"]);return s(s({},n),{tags:Array.from(t)})},e.prototype.matches=function(e){return P(e,this.value)},e.prototype.hasTag=function(e){return this.tags.has(e)},e.prototype.can=function(e){var t;D&&Q(!!this.machine,"state.can(...) used outside of a machine-created State object; this will always return false.");var n=null===(t=this.machine)||void 0===t?void 0:t.getTransitionData(this,e);return!!(null==n?void 0:n.transitions.length)&&n.transitions.some((function(e){return void 0!==e.target||e.actions.length}))},e}(),dt={deferEvents:!1},lt=function(){function e(e){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=s(s({},dt),e)}return e.prototype.initialize=function(e){if(this.initialized=!0,e){if(!this.options.deferEvents)return void this.schedule(e);this.process(e)}this.flushEvents()},e.prototype.schedule=function(e){if(this.initialized&&!this.processingEvent){if(0!==this.queue.length)throw new Error("Event queue should be empty when it is not processing events");this.process(e),this.flushEvents()}else this.queue.push(e)},e.prototype.clear=function(){this.queue=[]},e.prototype.flushEvents=function(){for(var e=this.queue.shift();e;)this.process(e),e=this.queue.shift()},e.prototype.process=function(e){this.processingEvent=!0;try{e()}catch(e){throw this.clear(),e}finally{this.processingEvent=!1}},e}(),ft=new Map,pt=0,ht={bookId:function(){return"x:".concat(pt++)},register:function(e,t){return ft.set(e,t),e},get:function(e){return ft.get(e)},free:function(e){ft.delete(e)}};function vt(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:void(D||console.warn("XState could not find a global object in this environment. Please let the maintainers know and raise an issue here: https://github.com/statelyai/xstate/issues"))}function mt(e){if(vt()){var t=function(){var e=vt();if(e&&"__xstate__"in e)return e.__xstate__}();t&&t.register(e)}}function gt(e,t){void 0===t&&(t={});var n=e.initialState,r=new Set,i=[],o=!1,a=Xe({id:t.id,send:function(t){i.push(t),function(){if(!o){for(o=!0;i.length>0;){var t=i.shift();n=e.transition(n,t,s),r.forEach((function(e){return e.next(n)}))}o=!1}}()},getSnapshot:function(){return n},subscribe:function(e,t,i){var o=fe(e,t,i);return r.add(o),o.next(n),{unsubscribe:function(){r.delete(o)}}}}),s={parent:t.parent,self:a,id:t.id||"anonymous",observers:r};return n=e.start?e.start(s):n,a}var Et,yt={sync:!1,autoForward:!1};!function(e){e[e.NotStarted=0]="NotStarted",e[e.Running=1]="Running",e[e.Stopped=2]="Stopped"}(Et||(Et={}));var St=function(){function e(t,n){var r=this;void 0===n&&(n=e.defaultOptions),this.machine=t,this.scheduler=new lt,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=Et.NotStarted,this.children=new Map,this.forwardTo=new Set,this.init=this.start,this.send=function(e,t){if(ee(e))return r.batch(e),r.state;var n=ce(se(e,t));if(r.status===Et.Stopped)return D||Q(!1,'Event "'.concat(n.name,'" was sent to stopped service "').concat(r.machine.id,'". This service has already reached its final state, and will not transition.\nEvent: ').concat(JSON.stringify(n.data))),r.state;if(r.status!==Et.Running&&!r.options.deferEvents)throw new Error('Event "'.concat(n.name,'" was sent to uninitialized service "').concat(r.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\nEvent: ').concat(JSON.stringify(n.data)));return r.scheduler.schedule((function(){r.forward(n);var e=r.nextState(n);r.update(e,n)})),r._state},this.sendTo=function(e,t){var n,i=r.parent&&(t===a.Parent||r.parent.id===t),o=i?r.parent:ne(t)?r.children.get(t)||ht.get(t):(n=t)&&"function"==typeof n.send?t:void 0;if(o)"machine"in o?o.send(s(s({},e),{name:e.name===w?"".concat(Ze(r.id)):e.name,origin:r.sessionId})):o.send(e.data);else{if(!i)throw new Error("Unable to send event to child '".concat(t,"' from service '").concat(r.id,"'."));D||Q(!1,"Service '".concat(r.id,"' has no parent: unable to send event ").concat(e.type))}};var i=s(s({},e.defaultOptions),n),o=i.clock,c=i.logger,u=i.parent,d=i.id,l=void 0!==d?d:t.id;this.id=l,this.logger=c,this.clock=o,this.parent=u,this.options=i,this.scheduler=new lt({deferEvents:this.options.deferEvents}),this.sessionId=ht.bookId()}return Object.defineProperty(e.prototype,"initialState",{get:function(){var e=this;return this._initialState?this._initialState:Ke(this,(function(){return e._initialState=e.machine.initialState,e._initialState}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return D||Q(this.status!==Et.NotStarted,"Attempted to read state from uninitialized service '".concat(this.id,"'. Make sure the service is started first.")),this._state},enumerable:!1,configurable:!0}),e.prototype.execute=function(e,t){var n,r;try{for(var i=u(e.actions),o=i.next();!o.done;o=i.next()){var a=o.value;this.exec(a,e,t)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},e.prototype.update=function(e,t){var n,r,i,o,a,s,c,d,l=this;if(e._sessionid=this.sessionId,this._state=e,this.options.execute&&this.execute(this.state),this.children.forEach((function(e){l.state.children[e.id]=e})),this.devTools&&this.devTools.send(t.data,e),e.event)try{for(var f=u(this.eventListeners),p=f.next();!p.done;p=f.next()){(0,p.value)(e.event)}}catch(e){n={error:e}}finally{try{p&&!p.done&&(r=f.return)&&r.call(f)}finally{if(n)throw n.error}}try{for(var h=u(this.listeners),v=h.next();!v.done;v=h.next()){(0,v.value)(e,e.event)}}catch(e){i={error:e}}finally{try{v&&!v.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}try{for(var m=u(this.contextListeners),g=m.next();!g.done;g=m.next()){(0,g.value)(this.state.context,this.state.history?this.state.history.context:void 0)}}catch(e){a={error:e}}finally{try{g&&!g.done&&(s=m.return)&&s.call(m)}finally{if(a)throw a.error}}var E=ot(e.configuration||[],this.machine);if(this.state.configuration&&E){var y=e.configuration.find((function(e){return"final"===e.type&&e.parent===l.machine})),S=y&&y.doneData?Y(y.doneData,e.context,t):void 0;try{for(var _=u(this.doneListeners),C=_.next();!C.done;C=_.next()){(0,C.value)(Ue(this.id,S))}}catch(e){c={error:e}}finally{try{C&&!C.done&&(d=_.return)&&d.call(_)}finally{if(c)throw c.error}}this.stop()}},e.prototype.onTransition=function(e){return this.listeners.add(e),this.status===Et.Running&&e(this.state,this.state.event),this},e.prototype.subscribe=function(e,t,n){var r,i=this;if(!e)return{unsubscribe:function(){}};var o=n;return"function"==typeof e?r=e:(r=e.next.bind(e),o=e.complete.bind(e)),this.listeners.add(r),this.status===Et.Running&&r(this.state),o&&this.onDone(o),{unsubscribe:function(){r&&i.listeners.delete(r),o&&i.doneListeners.delete(o)}}},e.prototype.onEvent=function(e){return this.eventListeners.add(e),this},e.prototype.onSend=function(e){return this.sendListeners.add(e),this},e.prototype.onChange=function(e){return this.contextListeners.add(e),this},e.prototype.onStop=function(e){return this.stopListeners.add(e),this},e.prototype.onDone=function(e){return this.doneListeners.add(e),this},e.prototype.off=function(e){return this.listeners.delete(e),this.eventListeners.delete(e),this.sendListeners.delete(e),this.stopListeners.delete(e),this.doneListeners.delete(e),this.contextListeners.delete(e),this},e.prototype.start=function(e){var t=this;if(this.status===Et.Running)return this;this.machine._init(),ht.register(this.sessionId,this),this.initialized=!0,this.status=Et.Running;var n=void 0===e?this.initialState:Ke(this,(function(){return ct(e)?t.machine.resolveState(e):t.machine.resolveState(ut.from(e,t.machine.context))}));return this.options.devTools&&this.attachDev(),this.scheduler.initialize((function(){t.update(n,he)})),this},e.prototype.stop=function(){var e,t,n,r,i,o,a,s,c,f,p=this;try{for(var h=u(this.listeners),v=h.next();!v.done;v=h.next()){var m=v.value;this.listeners.delete(m)}}catch(t){e={error:t}}finally{try{v&&!v.done&&(t=h.return)&&t.call(h)}finally{if(e)throw e.error}}try{for(var g=u(this.stopListeners),E=g.next();!E.done;E=g.next()){(m=E.value)(),this.stopListeners.delete(m)}}catch(e){n={error:e}}finally{try{E&&!E.done&&(r=g.return)&&r.call(g)}finally{if(n)throw n.error}}try{for(var y=u(this.contextListeners),S=y.next();!S.done;S=y.next()){m=S.value;this.contextListeners.delete(m)}}catch(e){i={error:e}}finally{try{S&&!S.done&&(o=y.return)&&o.call(y)}finally{if(i)throw i.error}}try{for(var _=u(this.doneListeners),C=_.next();!C.done;C=_.next()){m=C.value;this.doneListeners.delete(m)}}catch(e){a={error:e}}finally{try{C&&!C.done&&(s=_.return)&&s.call(_)}finally{if(a)throw a.error}}if(!this.initialized)return this;l([],d(this.state.configuration),!1).sort((function(e,t){return t.order-e.order})).forEach((function(e){var t,n;try{for(var r=u(e.definition.exit),i=r.next();!i.done;i=r.next()){var o=i.value;p.exec(o,p.state)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}})),this.children.forEach((function(e){te(e.stop)&&e.stop()}));try{for(var R=u(Object.keys(this.delayedEventsMap)),T=R.next();!T.done;T=R.next()){var x=T.value;this.clock.clearTimeout(this.delayedEventsMap[x])}}catch(e){c={error:e}}finally{try{T&&!T.done&&(f=R.return)&&f.call(R)}finally{if(c)throw c.error}}return this.scheduler.clear(),this.initialized=!1,this.status=Et.Stopped,ht.free(this.sessionId),this},e.prototype.batch=function(e){var t=this;if(this.status===Et.NotStarted&&this.options.deferEvents)D||Q(!1,"".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'" and are deferred. Make sure .start() is called for this service.\nEvent: ').concat(JSON.stringify(event)));else if(this.status!==Et.Running)throw new Error("".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'));this.scheduler.schedule((function(){var n,r,i=t.state,o=!1,a=[],c=function(e){var n=ce(e);t.forward(n),i=Ke(t,(function(){return t.machine.transition(i,n)})),a.push.apply(a,l([],d(i.actions.map((function(e){return n=i,r=(t=e).exec,s(s({},t),{exec:void 0!==r?function(){return r(n.context,n.event,{action:t,state:n,_event:n._event})}:void 0});var t,n,r}))),!1)),o=o||!!i.changed};try{for(var f=u(e),p=f.next();!p.done;p=f.next()){c(p.value)}}catch(e){n={error:e}}finally{try{p&&!p.done&&(r=f.return)&&r.call(f)}finally{if(n)throw n.error}}i.changed=o,i.actions=a,t.update(i,ce(e[e.length-1]))}))},e.prototype.sender=function(e){return this.send.bind(this,e)},e.prototype.nextState=function(e){var t=this,n=ce(e);if(0===n.name.indexOf(b)&&!this.state.nextEvents.some((function(e){return 0===e.indexOf(b)})))throw n.data.data;return Ke(this,(function(){return t.machine.transition(t.state,n)}))},e.prototype.forward=function(e){var t,n;try{for(var r=u(this.forwardTo),i=r.next();!i.done;i=r.next()){var o=i.value,a=this.children.get(o);if(!a)throw new Error("Unable to forward event '".concat(e,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(o,"'."));a.send(e)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.prototype.defer=function(e){var t=this;this.delayedEventsMap[e.id]=this.clock.setTimeout((function(){e.to?t.sendTo(e._event,e.to):t.send(e._event)}),e.delay)},e.prototype.cancel=function(e){this.clock.clearTimeout(this.delayedEventsMap[e]),delete this.delayedEventsMap[e]},e.prototype.exec=function(e,t,n){void 0===n&&(n=this.machine.options.actions);var r=t.context,i=t._event,a=e.exec||ve(e.type,n),s=te(a)?a:a?a.exec:e.exec;if(s)try{return s(r,i.data,{action:e,state:this.state,_event:i})}catch(e){throw this.parent&&this.parent.send({type:"xstate.error",data:e}),e}switch(e.type){case m:var c=e;if("number"==typeof c.delay)return void this.defer(c);c.to?this.sendTo(c._event,c.to):this.send(c._event);break;case g:this.cancel(e.sendId);break;case p:if(this.status!==Et.Running)return;var u=e.activity;if(!this.state.activities[u.id||u.type])break;if(u.type===o.Invoke){var d=le(u.src),l=this.machine.options.services?this.machine.options.services[d.type]:void 0,f=u.id,v=u.data;D||Q(!("forward"in u),"`forward` property is deprecated (found in invocation of '".concat(u.src,"' in in machine '").concat(this.machine.id,"'). ")+"Please use `autoForward` instead.");var E="autoForward"in u?u.autoForward:!!u.forward;if(!l)return void(D||Q(!1,"No service found for invocation '".concat(u.src,"' in machine '").concat(this.machine.id,"'.")));var y=v?Y(v,r,i):void 0;if("string"==typeof l)return;var S=te(l)?l(r,i.data,{data:y,src:d,meta:u.meta}):l;if(!S)return;var _=void 0;oe(S)&&(S=y?S.withContext(y):S,_={autoForward:E}),this.spawn(S,f,_)}else this.spawnActivity(u);break;case h:this.stopChild(e.activity.id);break;case C:var R=e.label,T=e.value;R?this.logger(R,T):this.logger(T);break;default:D||Q(!1,"No implementation found for action type '".concat(e.type,"'"))}},e.prototype.removeChild=function(e){var t;this.children.delete(e),this.forwardTo.delete(e),null===(t=this.state)||void 0===t||delete t.children[e]},e.prototype.stopChild=function(e){var t=this.children.get(e);t&&(this.removeChild(e),te(t.stop)&&t.stop())},e.prototype.spawn=function(e,t,n){if(z(e))return this.spawnPromise(Promise.resolve(e),t);if(te(e))return this.spawnCallback(e,t);if(function(e){try{return"function"==typeof e.send}catch(e){return!1}}(i=e)&&"id"in i)return this.spawnActor(e,t);if(function(e){try{return"subscribe"in e&&te(e.subscribe)}catch(e){return!1}}(e))return this.spawnObservable(e,t);if(oe(e))return this.spawnMachine(e,s(s({},n),{id:t}));if(null!==(r=e)&&"object"==typeof r&&"transition"in r&&"function"==typeof r.transition)return this.spawnBehavior(e,t);throw new Error('Unable to spawn entity "'.concat(t,'" of type "').concat(typeof e,'".'));var r,i},e.prototype.spawnMachine=function(t,n){var r=this;void 0===n&&(n={});var i=new e(t,s(s({},this.options),{parent:this,id:n.id||t.id})),o=s(s({},yt),n);o.sync&&i.onTransition((function(e){r.send(I,{state:e,id:i.id})}));var a=i;return this.children.set(i.id,a),o.autoForward&&this.forwardTo.add(i.id),i.onDone((function(e){r.removeChild(i.id),r.send(ce(e,{origin:i.id}))})).start(),a},e.prototype.spawnBehavior=function(e,t){var n=gt(e,{id:t,parent:this});return this.children.set(t,n),n},e.prototype.spawnPromise=function(e,t){var n,r,i=this,o=!1;e.then((function(e){o||(r=e,i.removeChild(t),i.send(ce(Ue(t,e),{origin:t})))}),(function(e){if(!o){i.removeChild(t);var n=Ze(t,e);try{i.send(ce(n,{origin:t}))}catch(r){!function(e,t,n){if(!D){var r=e.stack?" Stacktrace was '".concat(e.stack,"'"):"";if(e===t)console.error("Missing onError handler for invocation '".concat(n,"', error was '").concat(e,"'.").concat(r));else{var i=t.stack?" Stacktrace was '".concat(t.stack,"'"):"";console.error("Missing onError handler and/or unhandled exception/promise rejection for invocation '".concat(n,"'. ")+"Original error: '".concat(e,"'. ").concat(r," Current error is '").concat(t,"'.").concat(i))}}}(e,r,t),i.devTools&&i.devTools.send(n,i.state),i.machine.strict&&i.stop()}}}));var a=((n={id:t,send:function(){},subscribe:function(t,n,r){var i=fe(t,n,r),o=!1;return e.then((function(e){o||(i.next(e),o||i.complete())}),(function(e){o||i.error(e)})),{unsubscribe:function(){return o=!0}}},stop:function(){o=!0},toJSON:function(){return{id:t}},getSnapshot:function(){return r}})[ie]=function(){return this},n);return this.children.set(t,a),a},e.prototype.spawnCallback=function(e,t){var n,r,i,o=this,a=!1,s=new Set,c=new Set;try{i=e((function(e){r=e,c.forEach((function(t){return t(e)})),a||o.send(ce(e,{origin:t}))}),(function(e){s.add(e)}))}catch(e){this.send(Ze(t,e))}if(z(i))return this.spawnPromise(i,t);var u=((n={id:t,send:function(e){return s.forEach((function(t){return t(e)}))},subscribe:function(e){var t=fe(e);return c.add(t.next),{unsubscribe:function(){c.delete(t.next)}}},stop:function(){a=!0,te(i)&&i()},toJSON:function(){return{id:t}},getSnapshot:function(){return r}})[ie]=function(){return this},n);return this.children.set(t,u),u},e.prototype.spawnObservable=function(e,t){var n,r,i=this,o=e.subscribe((function(e){r=e,i.send(ce(e,{origin:t}))}),(function(e){i.removeChild(t),i.send(ce(Ze(t,e),{origin:t}))}),(function(){i.removeChild(t),i.send(ce(Ue(t),{origin:t}))})),a=((n={id:t,send:function(){},subscribe:function(t,n,r){return e.subscribe(t,n,r)},stop:function(){return o.unsubscribe()},getSnapshot:function(){return r},toJSON:function(){return{id:t}}})[ie]=function(){return this},n);return this.children.set(t,a),a},e.prototype.spawnActor=function(e,t){return this.children.set(t,e),e},e.prototype.spawnActivity=function(e){var t=this.machine.options&&this.machine.options.activities?this.machine.options.activities[e.type]:void 0;if(t){var n=t(this.state.context,e);this.spawnEffect(e.id,n)}else D||Q(!1,"No implementation found for activity '".concat(e.type,"'"))},e.prototype.spawnEffect=function(e,t){var n;this.children.set(e,((n={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:t||void 0,getSnapshot:function(){},toJSON:function(){return{id:e}}})[ie]=function(){return this},n))},e.prototype.attachDev=function(){var e=vt();if(this.options.devTools&&e){if(e.__REDUX_DEVTOOLS_EXTENSION__){var t="object"==typeof this.options.devTools?this.options.devTools:void 0;this.devTools=e.__REDUX_DEVTOOLS_EXTENSION__.connect(s(s({name:this.id,autoPause:!0,stateSanitizer:function(e){return{value:e.value,context:e.context,actions:e.actions}}},t),{features:s({jump:!1,skip:!1},t?t.features:void 0)}),this.machine),this.devTools.init(this.state)}mt(this)}},e.prototype.toJSON=function(){return{id:this.id}},e.prototype[ie]=function(){return this},e.prototype.getSnapshot=function(){return this.status===Et.NotStarted?this.initialState:this._state},e.defaultOptions={execute:!0,deferEvents:!0,clock:{setTimeout:function(e,t){return setTimeout(e,t)},clearTimeout:function(e){return clearTimeout(e)}},logger:console.log.bind(console),devTools:!1},e.interpret=Rt,e}(),_t=function(e){return ne(e)?s(s({},yt),{name:e}):s(s(s({},yt),{name:ae()}),e)};function Ct(e,t){var n=_t(t);return qe((function(t){if(!D){var r=oe(e)||te(e);Q(!!t||r,'Attempted to spawn an Actor (ID: "'.concat(oe(e)?e.id:"undefined",'") outside of a service. This will have no effect.'))}return t?t.spawn(e,n.name,n):ze(e,n.name)}))}function Rt(e,t){return new St(e,t)}function Tt(e){if("string"==typeof e){var t={type:e,toString:function(){return e}};return t}return e}function xt(e){return s(s({type:T},e),{toJSON:function(){e.onDone,e.onError;var t=c(e,["onDone","onError"]);return s(s({},t),{type:T,src:Tt(e.src)})}})}var bt="",wt="*",It={},Lt=function(e){return"#"===e[0]},Ot=function(){return{actions:{},guards:{},services:{},activities:{},delays:{}}},At=function(){function e(t,n,r,i){var o,a=this;void 0===r&&(r="context"in t?t.context:void 0),this.config=t,this._context=r,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign(Ot(),n),this.parent=null==i?void 0:i.parent,this.key=this.config.key||(null==i?void 0:i.key)||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:A),this.id=this.config.id||l([this.machine.key],d(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:null!==(o=this.config.schema)&&void 0!==o?o:{},this.description=this.config.description,D||Q(!("parallel"in this.config),'The "parallel" property is deprecated and will be removed in version 4.1. '.concat(this.config.parallel?"Replace with `type: 'parallel'`":"Use `type: '".concat(this.type,"'`")," in the config for state node '").concat(this.id,"' instead.")),this.initial=this.config.initial,this.states=this.config.states?G(this.config.states,(function(t,n){var r,i=new e(t,{},void 0,{parent:a,key:n});return Object.assign(a.idMap,s(((r={})[i.id]=i,r),i.idMap)),i})):It;var c=0;!function e(t){var n,r;t.order=c++;try{for(var i=u($e(t)),o=i.next();!o.done;o=i.next()){e(o.value)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}(this),this.history=!0===this.config.history?"shallow":this.config.history||!1,this._transient=!!this.config.always||!!this.config.on&&(Array.isArray(this.config.on)?this.config.on.some((function(e){return e.event===bt})):bt in this.config.on),this.strict=!!this.config.strict,this.onEntry=q(this.config.entry||this.config.onEntry).map((function(e){return me(e)})),this.onExit=q(this.config.exit||this.config.onExit).map((function(e){return me(e)})),this.meta=this.config.meta,this.doneData="final"===this.type?this.config.data:void 0,this.invoke=q(this.config.invoke).map((function(e,t){var n,r;if(oe(e)){var i=pe(a.id,t);return a.machine.options.services=s(((n={})[i]=e,n),a.machine.options.services),xt({src:i,id:i})}if(ne(e.src)){i=e.id||pe(a.id,t);return xt(s(s({},e),{id:i,src:e.src}))}if(oe(e.src)||te(e.src)){i=e.id||pe(a.id,t);return a.machine.options.services=s(((r={})[i]=e.src,r),a.machine.options.services),xt(s(s({id:i},e),{src:i}))}var o=e.src;return xt(s(s({id:pe(a.id,t)},e),{src:o}))})),this.activities=q(this.config.activities).concat(this.invoke).map((function(e){return Ee(e)})),this.transition=this.transition.bind(this),this.tags=q(this.config.tags)}return e.prototype._init=function(){this.__cache.transitions||Qe(this).forEach((function(e){return e.on}))},e.prototype.withConfig=function(t,n){var r=this.options,i=r.actions,o=r.activities,a=r.guards,c=r.services,u=r.delays;return new e(this.config,{actions:s(s({},i),t.actions),activities:s(s({},o),t.activities),guards:s(s({},a),t.guards),services:s(s({},c),t.services),delays:s(s({},u),t.delays)},null!=n?n:this.context)},e.prototype.withContext=function(t){return new e(this.config,this.options,t)},Object.defineProperty(e.prototype,"context",{get:function(){return te(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:G(this.states,(function(e){return e.definition})),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){return this.definition},Object.defineProperty(e.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var e=this.transitions;return this.__cache.on=e.reduce((function(e,t){return e[t.eventType]=e[t.eventType]||[],e[t.eventType].push(t),e}),{})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),e.prototype.getCandidates=function(e){if(this.__cache.candidates[e])return this.__cache.candidates[e];var t=e===bt,n=this.transitions.filter((function(n){var r=n.eventType===e;return t?r:r||n.eventType===wt}));return this.__cache.candidates[e]=n,n},e.prototype.getDelayedTransitions=function(){var e=this,t=this.config.after;if(!t)return[];var n=function(t,n){var r=Pe(te(t)?"".concat(e.id,":delay[").concat(n,"]"):t,e.id);return e.onEntry.push(_e(r,{delay:t})),e.onExit.push(Oe(r)),r};return(ee(t)?t.map((function(e,t){var r=n(e.delay,t);return s(s({},e),{event:r})})):H(Object.keys(t).map((function(e,r){var i=t[e],o=ne(i)?{target:i}:i,a=isNaN(+e)?e:+e,c=n(a,r);return q(o).map((function(e){return s(s({},e),{event:c,delay:a})}))})))).map((function(t){var n=t.delay;return s(s({},e.formatTransition(t)),{delay:n})}))},e.prototype.getStateNodes=function(e){var t,n=this;if(!e)return[];var r=e instanceof ut?e.value:Z(e,this.delimiter);if(ne(r)){var i=this.getStateNode(r).initial;return void 0!==i?this.getStateNodes(((t={})[r]=i,t)):[this,this.states[r]]}var o=Object.keys(r),a=[this];return a.push.apply(a,l([],d(H(o.map((function(e){return n.getStateNode(e).getStateNodes(r[e])})))),!1)),a},e.prototype.handles=function(e){var t=F(e);return this.events.includes(t)},e.prototype.resolveState=function(e){var t=e instanceof ut?e:ut.create(e),n=Array.from(et([],this.getStateNodes(t.value)));return new ut(s(s({},t),{value:this.resolve(t.value),configuration:n,done:ot(n,this),tags:at(n),machine:this.machine}))},e.prototype.transitionLeafNode=function(e,t,n){var r=this.getStateNode(e).next(t,n);return r&&r.transitions.length?r:this.next(t,n)},e.prototype.transitionCompoundNode=function(e,t,n){var r=Object.keys(e),i=this.getStateNode(r[0])._transition(e[r[0]],t,n);return i&&i.transitions.length?i:this.next(t,n)},e.prototype.transitionParallelNode=function(e,t,n){var r,i,o={};try{for(var a=u(Object.keys(e)),s=a.next();!s.done;s=a.next()){var c=s.value,d=e[c];if(d){var l=this.getStateNode(c)._transition(d,t,n);l&&(o[c]=l)}}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}var f=Object.keys(o).map((function(e){return o[e]})),p=H(f.map((function(e){return e.transitions})));if(!f.some((function(e){return e.transitions.length>0})))return this.next(t,n);var h=H(f.map((function(e){return e.entrySet}))),v=H(Object.keys(o).map((function(e){return o[e].configuration})));return{transitions:p,entrySet:h,exitSet:H(f.map((function(e){return e.exitSet}))),configuration:v,source:t,actions:H(Object.keys(o).map((function(e){return o[e].actions})))}},e.prototype._transition=function(e,t,n){return ne(e)?this.transitionLeafNode(e,t,n):1===Object.keys(e).length?this.transitionCompoundNode(e,t,n):this.transitionParallelNode(e,t,n)},e.prototype.getTransitionData=function(e,t){return this._transition(e.value,e,ce(t))},e.prototype.next=function(e,t){var n,r,i,o=this,a=t.name,s=[],c=[];try{for(var f=u(this.getCandidates(a)),p=f.next();!p.done;p=f.next()){var h=p.value,v=h.cond,m=h.in,g=e.context,E=!m||(ne(m)&&Lt(m)?e.matches(Z(this.getStateNodeById(m).path,this.delimiter)):P(Z(m,this.delimiter),W(this.path.slice(0,-2))(e.value))),y=!1;try{y=!v||de(this.machine,v,g,t,e)}catch(e){throw new Error("Unable to evaluate guard '".concat(v.name||v.type,"' in transition for event '").concat(a,"' in state node '").concat(this.id,"':\n").concat(e.message))}if(y&&E){void 0!==h.target&&(c=h.target),s.push.apply(s,l([],d(h.actions),!1)),i=h;break}}}catch(e){n={error:e}}finally{try{p&&!p.done&&(r=f.return)&&r.call(f)}finally{if(n)throw n.error}}if(i){if(!c.length)return{transitions:[i],entrySet:[],exitSet:[],configuration:e.value?[this]:[],source:e,actions:s};var S=H(c.map((function(t){return o.getRelativeStateNodes(t,e.historyValue)}))),_=!!i.internal;return{transitions:[i],entrySet:_?[]:H(S.map((function(e){return o.nodesFromChild(e)}))),exitSet:_?[]:[this],configuration:S,source:e,actions:s}}},e.prototype.nodesFromChild=function(e){if(e.escapes(this))return[];for(var t=[],n=e;n&&n!==this;)t.push(n),n=n.parent;return t.push(this),t},e.prototype.escapes=function(e){if(this===e)return!1;for(var t=this.parent;t;){if(t===e)return!1;t=t.parent}return!0},e.prototype.getActions=function(e,t,n,r){var i,o,a,s,c=et([],r?this.getStateNodes(r.value):[this]),f=e.configuration.length?et(c,e.configuration):c;try{for(var p=u(f),h=p.next();!h.done;h=p.next()){it(c,g=h.value)||e.entrySet.push(g)}}catch(e){i={error:e}}finally{try{h&&!h.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}try{for(var v=u(c),m=v.next();!m.done;m=v.next()){var g;it(f,g=m.value)&&!it(e.exitSet,g.parent)||e.exitSet.push(g)}}catch(e){a={error:e}}finally{try{m&&!m.done&&(s=v.return)&&s.call(v)}finally{if(a)throw a.error}}var E=H(e.entrySet.map((function(r){var i=[];if("final"!==r.type)return i;var o=r.parent;if(!o.parent)return i;i.push(Fe(r.id,r.doneData),Fe(o.id,r.doneData?Y(r.doneData,t,n):void 0));var a=o.parent;return"parallel"===a.type&&$e(a).every((function(t){return ot(e.configuration,t)}))&&i.push(Fe(a.id)),i})));e.exitSet.sort((function(e,t){return t.order-e.order})),e.entrySet.sort((function(e,t){return e.order-t.order}));var y=new Set(e.entrySet),S=new Set(e.exitSet),_=d([H(Array.from(y).map((function(e){return l(l([],d(e.activities.map((function(e){return Ae(e)}))),!1),d(e.onEntry),!1)}))).concat(E.map(ye)),H(Array.from(S).map((function(e){return l(l([],d(e.onExit),!1),d(e.activities.map((function(e){return ke(e)}))),!1)})))],2),C=_[0],R=_[1];return ge(R.concat(e.actions).concat(C),this.machine.options.actions)},e.prototype.transition=function(e,t,n){void 0===e&&(e=this.initialState);var r,i,o=ce(t);if(e instanceof ut)r=void 0===n?e:this.resolveState(ut.from(e,n));else{var a=ne(e)?this.resolve(V(this.getResolvedPath(e))):this.resolve(e),s=null!=n?n:this.machine.context;r=this.resolveState(ut.from(a,s))}if(!D&&o.name===wt)throw new Error("An event cannot have the wildcard type ('".concat(wt,"')"));if(this.strict&&!this.events.includes(o.name)&&(i=o.name,!/^(done|error)\./.test(i)))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(o.name,"'"));var c=this._transition(r.value,r,o)||{transitions:[],configuration:[],entrySet:[],exitSet:[],source:r,actions:[]},u=et([],this.getStateNodes(r.value)),f=c.configuration.length?et(u,c.configuration):u;return c.configuration=l([],d(f),!1),this.resolveTransition(c,r,r.context,o)},e.prototype.resolveRaisedTransition=function(e,t,n){var r,i=e.actions;return(e=this.transition(e,t))._event=n,e.event=n.data,(r=e.actions).unshift.apply(r,l([],d(i),!1)),e},e.prototype.resolveTransition=function(e,t,n,r){var i,o,c=this;void 0===r&&(r=he);var l=e.configuration,f=!t||e.transitions.length>0,g=f?rt(this.machine,l):void 0,y=t?t.historyValue?t.historyValue:e.source?this.machine.historyValue(t.value):void 0:void 0,S=this.getActions(e,n,r,t),_=t?s({},t.activities):{};try{for(var C=u(S),R=C.next();!R.done;R=C.next()){var x=R.value;x.type===p?_[x.activity.id||x.activity.type]=x:x.type===h&&(_[x.activity.id||x.activity.type]=!1)}}catch(e){i={error:e}}finally{try{R&&!R.done&&(o=C.return)&&o.call(C)}finally{if(i)throw i.error}}var b,w,L=d(je(this,t,n,r,S,this.machine.config.preserveActionOrder),2),O=L[0],A=L[1],k=d(X(O,(function(e){return e.type===v||e.type===m&&e.to===a.Internal})),2),M=k[0],N=k[1],D=O.filter((function(e){var t;return e.type===p&&(null===(t=e.activity)||void 0===t?void 0:t.type)===T})),P=D.reduce((function(e,t){return e[t.activity.id]=function(e,t,n,r){var i,o=le(e.src),a=null===(i=null==t?void 0:t.options.services)||void 0===i?void 0:i[o.type],s=e.data?Y(e.data,n,r):void 0,c=a?ze(a,e.id,s):Ye(e.id);return c.meta=e,c}(t.activity,c.machine,A,r),e}),t?s({},t.children):{}),F=f?e.configuration:t?t.configuration:[],U=ot(F,this),Z=new ut({value:g||t.value,context:A,_event:r,_sessionid:t?t._sessionid:null,historyValue:g?y?(b=y,w=g,{current:w,states:J(b,w)}):void 0:t?t.historyValue:void 0,history:!g||e.source?t:void 0,actions:g?N:[],activities:g?_:t?t.activities:{},events:[],configuration:F,transitions:e.transitions,children:P,done:U,tags:null==t?void 0:t.tags,machine:this}),V=n!==A;Z.changed=r.name===I||V;var G=Z.history;G&&delete G.history;var B=!U&&(this._transient||l.some((function(e){return e._transient})));if(!(f||B&&r.name!==bt))return Z;var W=Z;if(!U)for(B&&(W=this.resolveRaisedTransition(W,{type:E},r));M.length;){var j=M.shift();W=this.resolveRaisedTransition(W,j._event,r)}var H=W.changed||(G?!!W.actions.length||V||typeof G.value!=typeof W.value||!st(W.value,G.value):void 0);return W.changed=H,W.history=G,W.tags=at(W.configuration),W},e.prototype.getStateNode=function(e){if(Lt(e))return this.machine.getStateNodeById(e);if(!this.states)throw new Error("Unable to retrieve child state '".concat(e,"' from '").concat(this.id,"'; no child states exist."));var t=this.states[e];if(!t)throw new Error("Child state '".concat(e,"' does not exist on '").concat(this.id,"'"));return t},e.prototype.getStateNodeById=function(e){var t=Lt(e)?e.slice("#".length):e;if(t===this.id)return this;var n=this.machine.idMap[t];if(!n)throw new Error("Child state node '#".concat(t,"' does not exist on machine '").concat(this.id,"'"));return n},e.prototype.getStateNodeByPath=function(e){if("string"==typeof e&&Lt(e))try{return this.getStateNodeById(e.slice(1))}catch(e){}for(var t=U(e,this.delimiter).slice(),n=this;t.length;){var r=t.shift();if(!r.length)break;n=n.getStateNode(r)}return n},e.prototype.resolve=function(e){var t,n=this;if(!e)return this.initialStateValue||It;switch(this.type){case"parallel":return G(this.initialStateValue,(function(t,r){return t?n.getStateNode(r).resolve(e[r]||t):It}));case"compound":if(ne(e)){var r=this.getStateNode(e);return"parallel"===r.type||"compound"===r.type?((t={})[e]=r.initialStateValue,t):e}return Object.keys(e).length?G(e,(function(e,t){return e?n.getStateNode(t).resolve(e):It})):this.initialStateValue||{};default:return e||It}},e.prototype.getResolvedPath=function(e){if(Lt(e)){var t=this.machine.idMap[e.slice("#".length)];if(!t)throw new Error("Unable to find state node '".concat(e,"'"));return t.path}return U(e,this.delimiter)},Object.defineProperty(e.prototype,"initialStateValue",{get:function(){var e,t;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;if("parallel"===this.type)t=B(this.states,(function(e){return e.initialStateValue||It}),(function(e){return!("history"===e.type)}));else if(void 0!==this.initial){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));t=Je(this.states[this.initial])?this.initial:((e={})[this.initial]=this.states[this.initial].initialStateValue,e)}else t={};return this.__cache.initialStateValue=t,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),e.prototype.getInitialState=function(e,t){this._init();var n=this.getStateNodes(e);return this.resolveTransition({configuration:n,entrySet:n,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,null!=t?t:this.machine.context,void 0)},Object.defineProperty(e.prototype,"initialState",{get:function(){var e=this.initialStateValue;if(!e)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){var e;if("history"===this.type){var t=this.config;e=ne(t.target)&&Lt(t.target)?V(this.machine.getStateNodeById(t.target).path.slice(this.path.length-1)):t.target}return e},enumerable:!1,configurable:!0}),e.prototype.getRelativeStateNodes=function(e,t,n){return void 0===n&&(n=!0),n?"history"===e.type?e.resolveHistory(t):e.initialStateNodes:[e]},Object.defineProperty(e.prototype,"initialStateNodes",{get:function(){var e=this;return Je(this)?[this]:"compound"!==this.type||this.initial?H(j(this.initialStateValue).map((function(t){return e.getFromRelativePath(t)}))):(D||Q(!1,"Compound state node '".concat(this.id,"' has no initial state.")),[this])},enumerable:!1,configurable:!0}),e.prototype.getFromRelativePath=function(e){if(!e.length)return[this];var t=d(e),n=t[0],r=t.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(n,"' from node with no states"));var i=this.getStateNode(n);if("history"===i.type)return i.resolveHistory();if(!this.states[n])throw new Error("Child state '".concat(n,"' does not exist on '").concat(this.id,"'"));return this.states[n].getFromRelativePath(r)},e.prototype.historyValue=function(e){if(Object.keys(this.states).length)return{current:e||this.initialStateValue,states:B(this.states,(function(t,n){if(!e)return t.historyValue();var r=ne(e)?void 0:e[n];return t.historyValue(r||t.initialStateValue)}),(function(e){return!e.history}))}},e.prototype.resolveHistory=function(e){var t=this;if("history"!==this.type)return[this];var n=this.parent;if(!e){var r=this.target;return r?H(j(r).map((function(e){return n.getFromRelativePath(e)}))):n.initialStateNodes}var i,o,a=(i=n.path,o="states",function(e){var t,n,r=e;try{for(var a=u(i),s=a.next();!s.done;s=a.next()){var c=s.value;r=r[o][c]}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return r})(e).current;return ne(a)?[n.getStateNode(a)]:H(j(a).map((function(e){return"deep"===t.history?n.getFromRelativePath(e):[n.states[e[0]]]})))},Object.defineProperty(e.prototype,"stateIds",{get:function(){var e=this,t=H(Object.keys(this.states).map((function(t){return e.states[t].stateIds})));return[this.id].concat(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"events",{get:function(){var e,t,n,r;if(this.__cache.events)return this.__cache.events;var i=this.states,o=new Set(this.ownEvents);if(i)try{for(var a=u(Object.keys(i)),s=a.next();!s.done;s=a.next()){var c=i[s.value];if(c.states)try{for(var d=(n=void 0,u(c.events)),l=d.next();!l.done;l=d.next()){var f=l.value;o.add("".concat(f))}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return this.__cache.events=Array.from(o)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ownEvents",{get:function(){var e=new Set(this.transitions.filter((function(e){return!(!e.target&&!e.actions.length&&e.internal)})).map((function(e){return e.eventType})));return Array.from(e)},enumerable:!1,configurable:!0}),e.prototype.resolveTarget=function(e){var t=this;if(void 0!==e)return e.map((function(e){if(!ne(e))return e;var n=e[0]===t.delimiter;if(n&&!t.parent)return t.getStateNodeByPath(e.slice(1));var r=n?t.key+e:e;if(!t.parent)return t.getStateNodeByPath(r);try{return t.parent.getStateNodeByPath(r)}catch(e){throw new Error("Invalid transition definition for state node '".concat(t.id,"':\n").concat(e.message))}}))},e.prototype.formatTransition=function(e){var t=this,n=function(e){if(void 0!==e&&e!==N)return q(e)}(e.target),r="internal"in e?e.internal:!n||n.some((function(e){return ne(e)&&e[0]===t.delimiter})),i=this.machine.options.guards,o=this.resolveTarget(n),a=s(s({},e),{actions:ge(q(e.actions)),cond:re(e.cond,i),target:o,source:this,internal:r,eventType:e.event,toJSON:function(){return s(s({},a),{target:a.target?a.target.map((function(e){return"#".concat(e.id)})):void 0,source:"#".concat(t.id)})}});return a},e.prototype.formatTransitions=function(){var e,t,n,r=this;if(this.config.on)if(Array.isArray(this.config.on))n=this.config.on;else{var i=this.config.on,o=wt,a=i[o],s=void 0===a?[]:a,f=c(i,["*"]);n=H(Object.keys(f).map((function(e){D||e!==bt||Q(!1,"Empty string transition configs (e.g., `{ on: { '': ... }}`) for transient transitions are deprecated. Specify the transition in the `{ always: ... }` property instead. "+'Please check the `on` configuration for "#'.concat(r.id,'".'));var t=ue(e,f[e]);return D||function(e,t,n){var r=n.slice(0,-1).some((function(e){return!("cond"in e)&&!("in"in e)&&(ne(e.target)||oe(e.target))})),i=t===bt?"the transient event":"event '".concat(t,"'");Q(!r,"One or more transitions for ".concat(i," on state '").concat(e.id,"' are unreachable. ")+"Make sure that the default transition is the last one defined.")}(r,e,t),t})).concat(ue(wt,s)))}else n=[];var p=this.config.always?ue("",this.config.always):[],h=this.config.onDone?ue(String(Fe(this.id)),this.config.onDone):[];D||Q(!(this.config.onDone&&!this.parent),'Root nodes cannot have an ".onDone" transition. Please check the config of "'.concat(this.id,'".'));var v=H(this.invoke.map((function(e){var t=[];return e.onDone&&t.push.apply(t,l([],d(ue(String(Ue(e.id)),e.onDone)),!1)),e.onError&&t.push.apply(t,l([],d(ue(String(Ze(e.id)),e.onError)),!1)),t}))),m=this.after,g=H(l(l(l(l([],d(h),!1),d(v),!1),d(n),!1),d(p),!1).map((function(e){return q(e).map((function(e){return r.formatTransition(e)}))})));try{for(var E=u(m),y=E.next();!y.done;y=E.next()){var S=y.value;g.push(S)}}catch(t){e={error:t}}finally{try{y&&!y.done&&(t=E.return)&&t.call(E)}finally{if(e)throw e.error}}return g},e}();function kt(e,t,n){return void 0===n&&(n=e.context),new At(e,t,n)}function Mt(e,t){return new At(e,t)}function Nt(e,t){var n,r,i;try{for(var o=u(Object.keys(e)),a=o.next();!a.done;a=o.next()){var s=a.value;P(s,t)&&(!i||t.length>i.length)&&(i=s)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return e[i]}function Dt(e,t,n){var r,i,o=ut.from(e,e instanceof ut?e.context:void 0);try{for(var a=u(t),s=a.next();!s.done;s=a.next()){var c=d(s.value,2),l=c[0],f=c[1];if(o.matches(l))return f(o)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return n(o)}function Pt(e){return e}var Ft=Pt,Ut=Ne,Zt=_e,Vt=Re,Gt=xe,Bt=Ge,Wt=Ue},27921:(e,t,n)=>{e.exports=n(50176)},78149:(e,t,n)=>{e.exports=n(70964)},66130:(e,t,n)=>{e.exports=n(76216)},8450:(e,t,n)=>{e.exports=n(23565)},18281:(e,t,n)=>{e.exports=n(94175)},7520:(e,t,n)=>{e.exports=n(68080)},53804:(e,t,n)=>{e.exports=n(7153)},18428:(e,t,n)=>{e.exports=n(68207)},5940:(e,t,n)=>{e.exports=n(25380)},93364:(e,t,n)=>{e.exports=n(99848)},26771:(e,t,n)=>{e.exports=n(82624)},43562:(e,t,n)=>{e.exports=n(88058)},27392:(e,t,n)=>{e.exports=n(36759)},95366:(e,t,n)=>{e.exports=n(44221)},6919:(e,t,n)=>{e.exports=n(22991)},21986:(e,t,n)=>{e.exports=n(65162)},62680:(e,t,n)=>{e.exports=n(72818)},62962:(e,t,n)=>{e.exports=n(87595)},26243:(e,t,n)=>{e.exports=n(15297)},22863:(e,t,n)=>{e.exports=n(21900)},18433:(e,t,n)=>{e.exports=n(42837)},62207:(e,t,n)=>{e.exports=n(97186)},79529:(e,t,n)=>{e.exports=n(16111)},73473:(e,t,n)=>{e.exports=n(89448)},71544:(e,t,n)=>{e.exports=n(58564)},63755:(e,t,n)=>{e.exports=n(98401)},66411:(e,t,n)=>{e.exports=n(42437)},19031:(e,t,n)=>{e.exports=n(19414)},90487:(e,t,n)=>{e.exports=n(98828)},85579:(e,t,n)=>{e.exports=n(71922)},22013:(e,t,n)=>{e.exports=n(72974)},64233:(e,t,n)=>{e.exports=n(90446)},66282:(e,t,n)=>{e.exports=n(53868)},83977:(e,t,n)=>{e.exports=n(69488)},11996:(e,t,n)=>{var r=n(63207).default,i=n(26771),o=n(85579),a=n(5940),s=n(62962),c=n(22863),u=n(73473);function d(){"use strict";e.exports=d=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},n=Object.prototype,l=n.hasOwnProperty,f=i||function(e,t,n){e[t]=n.value},p="function"==typeof o?o:{},h=p.iterator||"@@iterator",v=p.asyncIterator||"@@asyncIterator",m=p.toStringTag||"@@toStringTag";function g(e,t,n){return i(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{g({},"")}catch(e){g=function(e,t,n){return e[t]=n}}function E(e,t,n,r){var i=t&&t.prototype instanceof _?t:_,o=a(i.prototype),s=new M(r||[]);return f(o,"_invoke",{value:L(e,n,s)}),o}function y(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=E;var S={};function _(){}function C(){}function R(){}var T={};g(T,h,(function(){return this}));var x=s&&s(s(N([])));x&&x!==n&&l.call(x,h)&&(T=x);var b=R.prototype=_.prototype=a(T);function w(e){["next","throw","return"].forEach((function(t){g(e,t,(function(e){return this._invoke(t,e)}))}))}function I(e,t){function n(i,o,a,s){var c=y(e[i],e,o);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==r(d)&&l.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var i;f(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(o,o):o()}})}function L(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return D()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=O(a,n);if(s){if(s===S)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=y(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===S)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function O(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),S;var i=y(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,S;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,S):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,S)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function N(e){if(e){var t=e[h];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(l.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:D}}function D(){return{value:void 0,done:!0}}return C.prototype=R,f(b,"constructor",{value:R,configurable:!0}),f(R,"constructor",{value:C,configurable:!0}),C.displayName=g(R,m,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===C||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return c?c(e,R):(e.__proto__=R,g(e,m,"GeneratorFunction")),e.prototype=a(b),e},t.awrap=function(e){return{__await:e}},w(I.prototype),g(I.prototype,v,(function(){return this})),t.AsyncIterator=I,t.async=function(e,n,r,i,o){void 0===o&&(o=u);var a=new I(E(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},w(b),g(b,m,"Generator"),g(b,h,(function(){return this})),g(b,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=N,M.prototype={constructor:M,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&l.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var a=l.call(i,"catchLoc"),s=l.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&l.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,S):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),S},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),S}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;k(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:N(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),S}},t}e.exports=d,e.exports.__esModule=!0,e.exports.default=e.exports},63207:(e,t,n)=>{var r=n(85579),i=n(22013);function o(t){return e.exports=o="function"==typeof r&&"symbol"==typeof i?function(e){return typeof e}:function(e){return e&&"function"==typeof r&&e.constructor===r&&e!==r.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,o(t)}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports},33453:(e,t,n)=>{var r=n(11996)();e.exports=r;try{regeneratorRuntime=r}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},17156:e=>{function t(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}e.exports=function(e){return function(){var n=this,r=arguments;return new Promise((function(i,o){var a=e.apply(n,r);function s(e){t(a,i,o,s,c,"next",e)}function c(e){t(a,i,o,s,c,"throw",e)}s(void 0)}))}},e.exports.__esModule=!0,e.exports.default=e.exports},48912:e=>{e.exports=function(e,t){return t.get?t.get.call(e):t.value},e.exports.__esModule=!0,e.exports.default=e.exports},43448:e=>{e.exports=function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}},e.exports.__esModule=!0,e.exports.default=e.exports},54069:e=>{e.exports=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)},e.exports.__esModule=!0,e.exports.default=e.exports},50468:(e,t,n)=>{var r=n(48912),i=n(54069);e.exports=function(e,t){var n=i(e,t,"get");return r(e,n)},e.exports.__esModule=!0,e.exports.default=e.exports},65661:(e,t,n)=>{var r=n(43448),i=n(54069);e.exports=function(e,t,n){var o=i(e,t,"set");return r(e,o,n),n},e.exports.__esModule=!0,e.exports.default=e.exports},81670:(e,t,n)=>{var r=n(64062);e.exports=function(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},95036:(e,t,n)=>{var r=n(18698).default;e.exports=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},64062:(e,t,n)=>{var r=n(18698).default,i=n(95036);e.exports=function(e){var t=i(e,"string");return"symbol"===r(t)?t:String(t)},e.exports.__esModule=!0,e.exports.default=e.exports},18698:e=>{function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},80759:(e,t,n)=>{"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{Z:()=>r})},23710:(e,t,n)=>{"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,{Z:()=>r})},66250:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(73473);function i(e,t,n,i,o,a,s){try{var c=e[a](s),u=c.value}catch(e){return void n(e)}c.done?t(u):r.resolve(u).then(i,o)}function o(e){return function(){var t=this,n=arguments;return new r((function(r,o){var a=e.apply(t,n);function s(e){i(a,r,o,s,c,"next",e)}function c(e){i(a,r,o,s,c,"throw",e)}s(void 0)}))}}},8167:(e,t,n)=>{"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,{Z:()=>r})},956:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(63755),i=n(35148);function o(e,t,n){return o=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}()?r.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&(0,i.Z)(o,n.prototype),o},o.apply(null,arguments)}},31314:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(26771),i=n(44660);function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),r(e,(0,i.Z)(o.key),o)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),r(e,"prototype",{writable:!1}),e}},77193:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(26771),i=n(44660);function o(e,t,n){return(t=(0,i.Z)(t))in e?r(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},14723:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(66411),i=n(95366),o=n(90797);function a(){return a="undefined"!=typeof Reflect&&r?r.bind():function(e,t,n){var r=(0,o.Z)(e,t);if(r){var a=i(r,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}},a.apply(this,arguments)}},35002:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(22863),i=n(62962);function o(e){return o=r?i.bind():function(e){return e.__proto__||i(e)},o(e)}},69678:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(5940),i=n(26771),o=n(35148);function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=r(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),i(e,"prototype",{writable:!1}),t&&(0,o.Z)(e,t)}},26305:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(13682),i=n(23710);function o(e,t){if(t&&("object"===(0,r.Z)(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,i.Z)(e)}},35148:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(22863);function i(e,t){return i=r?r.bind():function(e,t){return e.__proto__=t,e},i(e,t)}},14917:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(78149);var i=n(85579),o=n(22013);var a=n(33422);function s(e,t){return function(e){if(r(e))return e}(e)||function(e,t){var n=null==e?null:void 0!==i&&e[o]||e["@@iterator"];if(null!=n){var r,a,s,c,u=[],d=!0,l=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;d=!1}else for(;!(d=(r=s.call(n)).done)&&(u.push(r.value),u.length!==t);d=!0);}catch(e){l=!0,a=e}finally{try{if(!d&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(l)throw a}}return u}}(e,t)||(0,a.Z)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},90797:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(35002);function i(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,r.Z)(e)););return e}},21882:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var r=n(78149),i=n(80759);var o=n(85579),a=n(22013),s=n(27921);var c=n(33422);function u(e){return function(e){if(r(e))return(0,i.Z)(e)}(e)||function(e){if(void 0!==o&&null!=e[a]||null!=e["@@iterator"])return s(e)}(e)||(0,c.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},44660:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(13682),i=n(64233);function o(e){var t=function(e,t){if("object"!==(0,r.Z)(e)||null===e)return e;var n=e[i];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==(0,r.Z)(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===(0,r.Z)(t)?t:String(t)}},13682:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(85579),i=n(22013);function o(e){return o="function"==typeof r&&"symbol"==typeof i?function(e){return typeof e}:function(e){return e&&"function"==typeof r&&e.constructor===r&&e!==r.prototype?"symbol":typeof e},o(e)}},33422:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(27921),i=n(80759);function o(e,t){if(e){if("string"==typeof e)return(0,i.Z)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?r(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,i.Z)(e,t):void 0}}},67097:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(18281),i=n(5940),o=n(35002),a=n(35148);var s=n(956);function c(e){var t="function"==typeof r?new r:void 0;return c=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return(0,s.Z)(e,arguments,(0,o.Z)(this).constructor)}return r.prototype=i(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),(0,a.Z)(r,e)},c(e)}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}return n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n(57504)})()));
//# sourceMappingURL=calling.min.js.map