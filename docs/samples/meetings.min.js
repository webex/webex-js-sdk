/*! Webex JS SDK vundefined */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Webex=t():e.Webex=t()}(self,(()=>(()=>{var __webpack_modules__={26981:(e,t,r)=>{"use strict";r(11983);var n,i=(n=r(11543))&&n.__esModule?n:{default:n};i.default._babelPolyfill&&"undefined"!=typeof console&&console.warn&&console.warn("@babel/polyfill is loaded more than once on this page. This is probably not desirable/intended and may have consequences if different versions of the polyfills are applied sequentially. If you do need to load the polyfill more than once, use @babel/polyfill/noConflict instead to bypass the warning."),i.default._babelPolyfill=!0},11983:(e,t,r)=>{"use strict";r(15033),r(88033),r(72863),r(56141),r(74316),r(117),r(86863),r(30290),r(44007),r(91235),r(58930),r(31794),r(1523),r(52928)},15033:(e,t,r)=>{r(98997),r(57944),r(65388),r(10266),r(57557),r(63386),r(30081),r(54943),r(40192),r(24371),r(17026),r(16736),r(7260),r(4649),r(88325),r(52798),r(86911),r(84394),r(78769),r(729),r(99383),r(19315),r(15072),r(10348),r(71028),r(2610),r(64007),r(87616),r(86762),r(43316),r(93019),r(40293),r(60640),r(96589),r(93210),r(12372),r(30511),r(6781),r(74434),r(14783),r(95521),r(94093),r(86378),r(52380),r(2803),r(63725),r(7977),r(14192),r(2940),r(35731),r(79382),r(38877),r(22539),r(39820),r(28417),r(74333),r(82858),r(22058),r(95472),r(57001),r(57492),r(50447),r(65624),r(51263),r(65193),r(28241),r(96723),r(9394),r(66938),r(11961),r(69659),r(23354),r(99620),r(638),r(32338),r(20641),r(21575),r(75611),r(91033),r(50160),r(65271),r(18221),r(92523),r(65441),r(88375),r(9106),r(9139),r(33352),r(53289),r(35943),r(59483),r(88292),r(86174),r(86975),r(71412),r(30360),r(18394),r(83118),r(78772),r(71308),r(87080),r(58615),r(35244),r(39544),r(45475),r(33770),r(5201),r(61385),r(12813),r(82509),r(98253),r(57391),r(33307),r(63315),r(12920),r(95443),r(69815),r(43771),r(76935),r(17846),r(56403),r(51200),r(30951),r(10029),r(69310),r(66722),r(18372),r(14604),r(84781),r(38416),r(24395),r(49649),r(32475),r(12924),r(16337),r(83286),r(47225),r(68766),e.exports=r(14411)},72863:(e,t,r)=>{r(98125),e.exports=r(14411).Array.flatMap},88033:(e,t,r)=>{r(49348),e.exports=r(14411).Array.includes},58930:(e,t,r)=>{r(1768),e.exports=r(14411).Object.entries},44007:(e,t,r)=>{r(59223),e.exports=r(14411).Object.getOwnPropertyDescriptors},91235:(e,t,r)=>{r(67442),e.exports=r(14411).Object.values},31794:(e,t,r)=>{"use strict";r(12813),r(14936),e.exports=r(14411).Promise.finally},74316:(e,t,r)=>{r(20239),e.exports=r(14411).String.padEnd},56141:(e,t,r)=>{r(28755),e.exports=r(14411).String.padStart},86863:(e,t,r)=>{r(66948),e.exports=r(14411).String.trimRight},117:(e,t,r)=>{r(53412),e.exports=r(14411).String.trimLeft},30290:(e,t,r)=>{r(78284),e.exports=r(38833).f("asyncIterator")},11543:(e,t,r)=>{r(94296),e.exports=r(1275).global},87411:e=>{e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},23206:(e,t,r)=>{var n=r(700);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},1275:e=>{var t=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=t)},30999:(e,t,r)=>{var n=r(87411);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}}},50697:(e,t,r)=>{e.exports=!r(13834)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},42394:(e,t,r)=>{var n=r(700),i=r(71075).document,o=n(i)&&n(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},44553:(e,t,r)=>{var n=r(71075),i=r(1275),o=r(30999),s=r(2550),a=r(94324),c="prototype",u=function(e,t,r){var l,d,h,f=e&u.F,p=e&u.G,m=e&u.S,g=e&u.P,v=e&u.B,y=e&u.W,b=p?i:i[t]||(i[t]={}),E=b[c],w=p?n:m?n[t]:(n[t]||{})[c];for(l in p&&(r=t),r)(d=!f&&w&&void 0!==w[l])&&a(b,l)||(h=d?w[l]:r[l],b[l]=p&&"function"!=typeof w[l]?r[l]:v&&d?o(h,n):y&&w[l]==h?function(e){var t=function(t,r,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,n)}return e.apply(this,arguments)};return t[c]=e[c],t}(h):g&&"function"==typeof h?o(Function.call,h):h,g&&((b.virtual||(b.virtual={}))[l]=h,e&u.R&&E&&!E[l]&&s(E,l,h)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},13834:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},71075:e=>{var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)},94324:e=>{var t={}.hasOwnProperty;e.exports=function(e,r){return t.call(e,r)}},2550:(e,t,r)=>{var n=r(249),i=r(43652);e.exports=r(50697)?function(e,t,r){return n.f(e,t,i(1,r))}:function(e,t,r){return e[t]=r,e}},43393:(e,t,r)=>{e.exports=!r(50697)&&!r(13834)((function(){return 7!=Object.defineProperty(r(42394)("div"),"a",{get:function(){return 7}}).a}))},700:e=>{e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},249:(e,t,r)=>{var n=r(23206),i=r(43393),o=r(3377),s=Object.defineProperty;t.f=r(50697)?Object.defineProperty:function(e,t,r){if(n(e),t=o(t,!0),n(r),i)try{return s(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},43652:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},3377:(e,t,r)=>{var n=r(700);e.exports=function(e,t){if(!n(e))return e;var r,i;if(t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;if("function"==typeof(r=e.valueOf)&&!n(i=r.call(e)))return i;if(!t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},94296:(e,t,r)=>{var n=r(44553);n(n.G,{global:r(71075)})},23079:e=>{e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},23373:(e,t,r)=>{var n=r(89426);e.exports=function(e,t){if("number"!=typeof e&&"Number"!=n(e))throw TypeError(t);return+e}},12802:(e,t,r)=>{var n=r(9739)("unscopables"),i=Array.prototype;null==i[n]&&r(98442)(i,n,{}),e.exports=function(e){i[n][e]=!0}},9959:(e,t,r)=>{"use strict";var n=r(7384)(!0);e.exports=function(e,t,r){return t+(r?n(e,t).length:1)}},30599:e=>{e.exports=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e}},59719:(e,t,r)=>{var n=r(17481);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},4893:(e,t,r)=>{"use strict";var n=r(54200),i=r(15044),o=r(61838);e.exports=[].copyWithin||function(e,t){var r=n(this),s=o(r.length),a=i(e,s),c=i(t,s),u=arguments.length>2?arguments[2]:void 0,l=Math.min((void 0===u?s:i(u,s))-c,s-a),d=1;for(c<a&&a<c+l&&(d=-1,c+=l-1,a+=l-1);l-- >0;)c in r?r[a]=r[c]:delete r[a],a+=d,c+=d;return r}},70852:(e,t,r)=>{"use strict";var n=r(54200),i=r(15044),o=r(61838);e.exports=function(e){for(var t=n(this),r=o(t.length),s=arguments.length,a=i(s>1?arguments[1]:void 0,r),c=s>2?arguments[2]:void 0,u=void 0===c?r:i(c,r);u>a;)t[a++]=e;return t}},61545:(e,t,r)=>{var n=r(8500),i=r(61838),o=r(15044);e.exports=function(e){return function(t,r,s){var a,c=n(t),u=i(c.length),l=o(s,u);if(e&&r!=r){for(;u>l;)if((a=c[l++])!=a)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===r)return e||l||0;return!e&&-1}}},66934:(e,t,r)=>{var n=r(82794),i=r(60975),o=r(54200),s=r(61838),a=r(44087);e.exports=function(e,t){var r=1==e,c=2==e,u=3==e,l=4==e,d=6==e,h=5==e||d,f=t||a;return function(t,a,p){for(var m,g,v=o(t),y=i(v),b=n(a,p,3),E=s(y.length),w=0,S=r?f(t,E):c?f(t,0):void 0;E>w;w++)if((h||w in y)&&(g=b(m=y[w],w,v),e))if(r)S[w]=g;else if(g)switch(e){case 3:return!0;case 5:return m;case 6:return w;case 2:S.push(m)}else if(l)return!1;return d?-1:u||l?l:S}}},9857:(e,t,r)=>{var n=r(23079),i=r(54200),o=r(60975),s=r(61838);e.exports=function(e,t,r,a,c){n(t);var u=i(e),l=o(u),d=s(u.length),h=c?d-1:0,f=c?-1:1;if(r<2)for(;;){if(h in l){a=l[h],h+=f;break}if(h+=f,c?h<0:d<=h)throw TypeError("Reduce of empty array with no initial value")}for(;c?h>=0:d>h;h+=f)h in l&&(a=t(a,l[h],h,u));return a}},54849:(e,t,r)=>{var n=r(17481),i=r(40689),o=r(9739)("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),n(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},44087:(e,t,r)=>{var n=r(54849);e.exports=function(e,t){return new(n(e))(t)}},46966:(e,t,r)=>{"use strict";var n=r(23079),i=r(17481),o=r(16137),s=[].slice,a={};e.exports=Function.bind||function(e){var t=n(this),r=s.call(arguments,1),c=function(){var n=r.concat(s.call(arguments));return this instanceof c?function(e,t,r){if(!(t in a)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";a[t]=Function("F,a","return new F("+n.join(",")+")")}return a[t](e,r)}(t,n.length,n):o(t,n,e)};return i(t.prototype)&&(c.prototype=t.prototype),c}},12845:(e,t,r)=>{var n=r(89426),i=r(9739)("toStringTag"),o="Arguments"==n(function(){return arguments}());e.exports=function(e){var t,r,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?r:o?n(t):"Object"==(s=n(t))&&"function"==typeof t.callee?"Arguments":s}},89426:e=>{var t={}.toString;e.exports=function(e){return t.call(e).slice(8,-1)}},95144:(e,t,r)=>{"use strict";var n=r(83530).f,i=r(62545),o=r(24092),s=r(82794),a=r(30599),c=r(62971),u=r(19121),l=r(78611),d=r(75993),h=r(51916),f=r(82153).fastKey,p=r(91603),m=h?"_s":"size",g=function(e,t){var r,n=f(t);if("F"!==n)return e._i[n];for(r=e._f;r;r=r.n)if(r.k==t)return r};e.exports={getConstructor:function(e,t,r,u){var l=e((function(e,n){a(e,l,t,"_i"),e._t=t,e._i=i(null),e._f=void 0,e._l=void 0,e[m]=0,null!=n&&c(n,r,e[u],e)}));return o(l.prototype,{clear:function(){for(var e=p(this,t),r=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];e._f=e._l=void 0,e[m]=0},delete:function(e){var r=p(this,t),n=g(r,e);if(n){var i=n.n,o=n.p;delete r._i[n.i],n.r=!0,o&&(o.n=i),i&&(i.p=o),r._f==n&&(r._f=i),r._l==n&&(r._l=o),r[m]--}return!!n},forEach:function(e){p(this,t);for(var r,n=s(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!g(p(this,t),e)}}),h&&n(l.prototype,"size",{get:function(){return p(this,t)[m]}}),l},def:function(e,t,r){var n,i,o=g(e,t);return o?o.v=r:(e._l=o={i:i=f(t,!0),k:t,v:r,p:n=e._l,n:void 0,r:!1},e._f||(e._f=o),n&&(n.n=o),e[m]++,"F"!==i&&(e._i[i]=o)),e},getEntry:g,setStrong:function(e,t,r){u(e,t,(function(e,r){this._t=p(e,t),this._k=r,this._l=void 0}),(function(){for(var e=this,t=e._k,r=e._l;r&&r.r;)r=r.p;return e._t&&(e._l=r=r?r.n:e._t._f)?l(0,"keys"==t?r.k:"values"==t?r.v:[r.k,r.v]):(e._t=void 0,l(1))}),r?"entries":"values",!r,!0),d(t)}}},33503:(e,t,r)=>{"use strict";var n=r(24092),i=r(82153).getWeak,o=r(59719),s=r(17481),a=r(30599),c=r(62971),u=r(66934),l=r(41063),d=r(91603),h=u(5),f=u(6),p=0,m=function(e){return e._l||(e._l=new g)},g=function(){this.a=[]},v=function(e,t){return h(e.a,(function(e){return e[0]===t}))};g.prototype={get:function(e){var t=v(this,e);if(t)return t[1]},has:function(e){return!!v(this,e)},set:function(e,t){var r=v(this,e);r?r[1]=t:this.a.push([e,t])},delete:function(e){var t=f(this.a,(function(t){return t[0]===e}));return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,r,o){var u=e((function(e,n){a(e,u,t,"_i"),e._t=t,e._i=p++,e._l=void 0,null!=n&&c(n,r,e[o],e)}));return n(u.prototype,{delete:function(e){if(!s(e))return!1;var r=i(e);return!0===r?m(d(this,t)).delete(e):r&&l(r,this._i)&&delete r[this._i]},has:function(e){if(!s(e))return!1;var r=i(e);return!0===r?m(d(this,t)).has(e):r&&l(r,this._i)}}),u},def:function(e,t,r){var n=i(o(t),!0);return!0===n?m(e).set(t,r):n[e._i]=r,e},ufstore:m}},58091:(e,t,r)=>{"use strict";var n=r(56341),i=r(35366),o=r(1564),s=r(24092),a=r(82153),c=r(62971),u=r(30599),l=r(17481),d=r(71240),h=r(61461),f=r(21309),p=r(94805);e.exports=function(e,t,r,m,g,v){var y=n[e],b=y,E=g?"set":"add",w=b&&b.prototype,S={},_=function(e){var t=w[e];o(w,e,"delete"==e||"has"==e?function(e){return!(v&&!l(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return v&&!l(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,r){return t.call(this,0===e?0:e,r),this})};if("function"==typeof b&&(v||w.forEach&&!d((function(){(new b).entries().next()})))){var T=new b,x=T[E](v?{}:-0,1)!=T,A=d((function(){T.has(1)})),I=h((function(e){new b(e)})),C=!v&&d((function(){for(var e=new b,t=5;t--;)e[E](t,t);return!e.has(-0)}));I||((b=t((function(t,r){u(t,b,e);var n=p(new y,t,b);return null!=r&&c(r,g,n[E],n),n}))).prototype=w,w.constructor=b),(A||C)&&(_("delete"),_("has"),g&&_("get")),(C||x)&&_(E),v&&w.clear&&delete w.clear}else b=m.getConstructor(t,e,g,E),s(b.prototype,r),a.NEED=!0;return f(b,e),S[e]=b,i(i.G+i.W+i.F*(b!=y),S),v||m.setStrong(b,e,g),b}},14411:e=>{var t=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=t)},51676:(e,t,r)=>{"use strict";var n=r(83530),i=r(21761);e.exports=function(e,t,r){t in e?n.f(e,t,i(0,r)):e[t]=r}},82794:(e,t,r)=>{var n=r(23079);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}}},41792:(e,t,r)=>{"use strict";var n=r(71240),i=Date.prototype.getTime,o=Date.prototype.toISOString,s=function(e){return e>9?e:"0"+e};e.exports=n((function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-50000000000001))}))||!n((function(){o.call(new Date(NaN))}))?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),r=e.getUTCMilliseconds(),n=t<0?"-":t>9999?"+":"";return n+("00000"+Math.abs(t)).slice(n?-6:-4)+"-"+s(e.getUTCMonth()+1)+"-"+s(e.getUTCDate())+"T"+s(e.getUTCHours())+":"+s(e.getUTCMinutes())+":"+s(e.getUTCSeconds())+"."+(r>99?r:"0"+s(r))+"Z"}:o},27687:(e,t,r)=>{"use strict";var n=r(59719),i=r(9241),o="number";e.exports=function(e){if("string"!==e&&e!==o&&"default"!==e)throw TypeError("Incorrect hint");return i(n(this),e!=o)}},13589:e=>{e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},51916:(e,t,r)=>{e.exports=!r(71240)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},83383:(e,t,r)=>{var n=r(17481),i=r(56341).document,o=n(i)&&n(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},97590:e=>{e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},4535:(e,t,r)=>{var n=r(15825),i=r(32520),o=r(41144);e.exports=function(e){var t=n(e),r=i.f;if(r)for(var s,a=r(e),c=o.f,u=0;a.length>u;)c.call(e,s=a[u++])&&t.push(s);return t}},35366:(e,t,r)=>{var n=r(56341),i=r(14411),o=r(98442),s=r(1564),a=r(82794),c="prototype",u=function(e,t,r){var l,d,h,f,p=e&u.F,m=e&u.G,g=e&u.S,v=e&u.P,y=e&u.B,b=m?n:g?n[t]||(n[t]={}):(n[t]||{})[c],E=m?i:i[t]||(i[t]={}),w=E[c]||(E[c]={});for(l in m&&(r=t),r)h=((d=!p&&b&&void 0!==b[l])?b:r)[l],f=y&&d?a(h,n):v&&"function"==typeof h?a(Function.call,h):h,b&&s(b,l,h,e&u.U),E[l]!=h&&o(E,l,f),v&&w[l]!=h&&(w[l]=h)};n.core=i,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},46881:(e,t,r)=>{var n=r(9739)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[n]=!1,!"/./"[e](t)}catch(e){}}return!0}},71240:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},25307:(e,t,r)=>{"use strict";r(58615);var n=r(1564),i=r(98442),o=r(71240),s=r(13589),a=r(9739),c=r(18868),u=a("species"),l=!o((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),d=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2===r.length&&"a"===r[0]&&"b"===r[1]}();e.exports=function(e,t,r){var h=a(e),f=!o((function(){var t={};return t[h]=function(){return 7},7!=""[e](t)})),p=f?!o((function(){var t=!1,r=/a/;return r.exec=function(){return t=!0,null},"split"===e&&(r.constructor={},r.constructor[u]=function(){return r}),r[h](""),!t})):void 0;if(!f||!p||"replace"===e&&!l||"split"===e&&!d){var m=/./[h],g=r(s,h,""[e],(function(e,t,r,n,i){return t.exec===c?f&&!i?{done:!0,value:m.call(t,r,n)}:{done:!0,value:e.call(r,t,n)}:{done:!1}})),v=g[0],y=g[1];n(String.prototype,e,v),i(RegExp.prototype,h,2==t?function(e,t){return y.call(e,this,t)}:function(e){return y.call(e,this)})}}},6439:(e,t,r)=>{"use strict";var n=r(59719);e.exports=function(){var e=n(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},3885:(e,t,r)=>{"use strict";var n=r(40689),i=r(17481),o=r(61838),s=r(82794),a=r(9739)("isConcatSpreadable");e.exports=function e(t,r,c,u,l,d,h,f){for(var p,m,g=l,v=0,y=!!h&&s(h,f,3);v<u;){if(v in c){if(p=y?y(c[v],v,r):c[v],m=!1,i(p)&&(m=void 0!==(m=p[a])?!!m:n(p)),m&&d>0)g=e(t,r,p,o(p.length),g,d-1)-1;else{if(g>=9007199254740991)throw TypeError();t[g]=p}g++}v++}return g}},62971:(e,t,r)=>{var n=r(82794),i=r(55539),o=r(63894),s=r(59719),a=r(61838),c=r(18444),u={},l={},d=e.exports=function(e,t,r,d,h){var f,p,m,g,v=h?function(){return e}:c(e),y=n(r,d,t?2:1),b=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(o(v)){for(f=a(e.length);f>b;b++)if((g=t?y(s(p=e[b])[0],p[1]):y(e[b]))===u||g===l)return g}else for(m=v.call(e);!(p=m.next()).done;)if((g=i(m,y,p.value,t))===u||g===l)return g};d.BREAK=u,d.RETURN=l},65979:(e,t,r)=>{e.exports=r(97355)("native-function-to-string",Function.toString)},56341:e=>{var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)},41063:e=>{var t={}.hasOwnProperty;e.exports=function(e,r){return t.call(e,r)}},98442:(e,t,r)=>{var n=r(83530),i=r(21761);e.exports=r(51916)?function(e,t,r){return n.f(e,t,i(1,r))}:function(e,t,r){return e[t]=r,e}},26137:(e,t,r)=>{var n=r(56341).document;e.exports=n&&n.documentElement},44352:(e,t,r)=>{e.exports=!r(51916)&&!r(71240)((function(){return 7!=Object.defineProperty(r(83383)("div"),"a",{get:function(){return 7}}).a}))},94805:(e,t,r)=>{var n=r(17481),i=r(87135).set;e.exports=function(e,t,r){var o,s=t.constructor;return s!==r&&"function"==typeof s&&(o=s.prototype)!==r.prototype&&n(o)&&i&&i(e,o),e}},16137:e=>{e.exports=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},60975:(e,t,r)=>{var n=r(89426);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},63894:(e,t,r)=>{var n=r(4919),i=r(9739)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||o[i]===e)}},40689:(e,t,r)=>{var n=r(89426);e.exports=Array.isArray||function(e){return"Array"==n(e)}},22289:(e,t,r)=>{var n=r(17481),i=Math.floor;e.exports=function(e){return!n(e)&&isFinite(e)&&i(e)===e}},17481:e=>{e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},89543:(e,t,r)=>{var n=r(17481),i=r(89426),o=r(9739)("match");e.exports=function(e){var t;return n(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},55539:(e,t,r)=>{var n=r(59719);e.exports=function(e,t,r,i){try{return i?t(n(r)[0],r[1]):t(r)}catch(t){var o=e.return;throw void 0!==o&&n(o.call(e)),t}}},47938:(e,t,r)=>{"use strict";var n=r(62545),i=r(21761),o=r(21309),s={};r(98442)(s,r(9739)("iterator"),(function(){return this})),e.exports=function(e,t,r){e.prototype=n(s,{next:i(1,r)}),o(e,t+" Iterator")}},19121:(e,t,r)=>{"use strict";var n=r(35113),i=r(35366),o=r(1564),s=r(98442),a=r(4919),c=r(47938),u=r(21309),l=r(44408),d=r(9739)("iterator"),h=!([].keys&&"next"in[].keys()),f="keys",p="values",m=function(){return this};e.exports=function(e,t,r,g,v,y,b){c(r,t,g);var E,w,S,_=function(e){if(!h&&e in I)return I[e];switch(e){case f:case p:return function(){return new r(this,e)}}return function(){return new r(this,e)}},T=t+" Iterator",x=v==p,A=!1,I=e.prototype,C=I[d]||I["@@iterator"]||v&&I[v],R=C||_(v),k=v?x?_("entries"):R:void 0,O="Array"==t&&I.entries||C;if(O&&(S=l(O.call(new e)))!==Object.prototype&&S.next&&(u(S,T,!0),n||"function"==typeof S[d]||s(S,d,m)),x&&C&&C.name!==p&&(A=!0,R=function(){return C.call(this)}),n&&!b||!h&&!A&&I[d]||s(I,d,R),a[t]=R,a[T]=m,v)if(E={values:x?R:_(p),keys:y?R:_(f),entries:k},b)for(w in E)w in I||o(I,w,E[w]);else i(i.P+i.F*(h||A),t,E);return E}},61461:(e,t,r)=>{var n=r(9739)("iterator"),i=!1;try{var o=[7][n]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var r=!1;try{var o=[7],s=o[n]();s.next=function(){return{done:r=!0}},o[n]=function(){return s},e(o)}catch(e){}return r}},78611:e=>{e.exports=function(e,t){return{value:t,done:!!e}}},4919:e=>{e.exports={}},35113:e=>{e.exports=!1},77117:e=>{var t=Math.expm1;e.exports=!t||t(10)>22025.465794806718||t(10)<22025.465794806718||-2e-17!=t(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:Math.exp(e)-1}:t},59396:(e,t,r)=>{var n=r(84247),i=Math.pow,o=i(2,-52),s=i(2,-23),a=i(2,127)*(2-s),c=i(2,-126);e.exports=Math.fround||function(e){var t,r,i=Math.abs(e),u=n(e);return i<c?u*(i/c/s+1/o-1/o)*c*s:(r=(t=(1+s/o)*i)-(t-i))>a||r!=r?u*(1/0):u*r}},19007:e=>{e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)}},84247:e=>{e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},82153:(e,t,r)=>{var n=r(90430)("meta"),i=r(17481),o=r(41063),s=r(83530).f,a=0,c=Object.isExtensible||function(){return!0},u=!r(71240)((function(){return c(Object.preventExtensions({}))})),l=function(e){s(e,n,{value:{i:"O"+ ++a,w:{}}})},d=e.exports={KEY:n,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,n)){if(!c(e))return"F";if(!t)return"E";l(e)}return e[n].i},getWeak:function(e,t){if(!o(e,n)){if(!c(e))return!0;if(!t)return!1;l(e)}return e[n].w},onFreeze:function(e){return u&&d.NEED&&c(e)&&!o(e,n)&&l(e),e}}},37:(e,t,r)=>{var n=r(56341),i=r(7122).set,o=n.MutationObserver||n.WebKitMutationObserver,s=n.process,a=n.Promise,c="process"==r(89426)(s);e.exports=function(){var e,t,r,u=function(){var n,i;for(c&&(n=s.domain)&&n.exit();e;){i=e.fn,e=e.next;try{i()}catch(n){throw e?r():t=void 0,n}}t=void 0,n&&n.enter()};if(c)r=function(){s.nextTick(u)};else if(!o||n.navigator&&n.navigator.standalone)if(a&&a.resolve){var l=a.resolve(void 0);r=function(){l.then(u)}}else r=function(){i.call(n,u)};else{var d=!0,h=document.createTextNode("");new o(u).observe(h,{characterData:!0}),r=function(){h.data=d=!d}}return function(n){var i={fn:n,next:void 0};t&&(t.next=i),e||(e=i,r()),t=i}}},83285:(e,t,r)=>{"use strict";var n=r(23079);function i(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n})),this.resolve=n(t),this.reject=n(r)}e.exports.f=function(e){return new i(e)}},49821:(e,t,r)=>{"use strict";var n=r(51916),i=r(15825),o=r(32520),s=r(41144),a=r(54200),c=r(60975),u=Object.assign;e.exports=!u||r(71240)((function(){var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach((function(e){t[e]=e})),7!=u({},e)[r]||Object.keys(u({},t)).join("")!=n}))?function(e,t){for(var r=a(e),u=arguments.length,l=1,d=o.f,h=s.f;u>l;)for(var f,p=c(arguments[l++]),m=d?i(p).concat(d(p)):i(p),g=m.length,v=0;g>v;)f=m[v++],n&&!h.call(p,f)||(r[f]=p[f]);return r}:u},62545:(e,t,r)=>{var n=r(59719),i=r(30413),o=r(97590),s=r(53548)("IE_PROTO"),a=function(){},c="prototype",u=function(){var e,t=r(83383)("iframe"),n=o.length;for(t.style.display="none",r(26137).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),u=e.F;n--;)delete u[c][o[n]];return u()};e.exports=Object.create||function(e,t){var r;return null!==e?(a[c]=n(e),r=new a,a[c]=null,r[s]=e):r=u(),void 0===t?r:i(r,t)}},83530:(e,t,r)=>{var n=r(59719),i=r(44352),o=r(9241),s=Object.defineProperty;t.f=r(51916)?Object.defineProperty:function(e,t,r){if(n(e),t=o(t,!0),n(r),i)try{return s(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},30413:(e,t,r)=>{var n=r(83530),i=r(59719),o=r(15825);e.exports=r(51916)?Object.defineProperties:function(e,t){i(e);for(var r,s=o(t),a=s.length,c=0;a>c;)n.f(e,r=s[c++],t[r]);return e}},57762:(e,t,r)=>{var n=r(41144),i=r(21761),o=r(8500),s=r(9241),a=r(41063),c=r(44352),u=Object.getOwnPropertyDescriptor;t.f=r(51916)?u:function(e,t){if(e=o(e),t=s(t,!0),c)try{return u(e,t)}catch(e){}if(a(e,t))return i(!n.f.call(e,t),e[t])}},85009:(e,t,r)=>{var n=r(8500),i=r(14230).f,o={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return s&&"[object Window]"==o.call(e)?function(e){try{return i(e)}catch(e){return s.slice()}}(e):i(n(e))}},14230:(e,t,r)=>{var n=r(92851),i=r(97590).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,i)}},32520:(e,t)=>{t.f=Object.getOwnPropertySymbols},44408:(e,t,r)=>{var n=r(41063),i=r(54200),o=r(53548)("IE_PROTO"),s=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),n(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?s:null}},92851:(e,t,r)=>{var n=r(41063),i=r(8500),o=r(61545)(!1),s=r(53548)("IE_PROTO");e.exports=function(e,t){var r,a=i(e),c=0,u=[];for(r in a)r!=s&&n(a,r)&&u.push(r);for(;t.length>c;)n(a,r=t[c++])&&(~o(u,r)||u.push(r));return u}},15825:(e,t,r)=>{var n=r(92851),i=r(97590);e.exports=Object.keys||function(e){return n(e,i)}},41144:(e,t)=>{t.f={}.propertyIsEnumerable},81025:(e,t,r)=>{var n=r(35366),i=r(14411),o=r(71240);e.exports=function(e,t){var r=(i.Object||{})[e]||Object[e],s={};s[e]=t(r),n(n.S+n.F*o((function(){r(1)})),"Object",s)}},15346:(e,t,r)=>{var n=r(51916),i=r(15825),o=r(8500),s=r(41144).f;e.exports=function(e){return function(t){for(var r,a=o(t),c=i(a),u=c.length,l=0,d=[];u>l;)r=c[l++],n&&!s.call(a,r)||d.push(e?[r,a[r]]:a[r]);return d}}},17285:(e,t,r)=>{var n=r(14230),i=r(32520),o=r(59719),s=r(56341).Reflect;e.exports=s&&s.ownKeys||function(e){var t=n.f(o(e)),r=i.f;return r?t.concat(r(e)):t}},13765:(e,t,r)=>{var n=r(56341).parseFloat,i=r(97370).trim;e.exports=1/n(r(18275)+"-0")!=-1/0?function(e){var t=i(String(e),3),r=n(t);return 0===r&&"-"==t.charAt(0)?-0:r}:n},80500:(e,t,r)=>{var n=r(56341).parseInt,i=r(97370).trim,o=r(18275),s=/^[-+]?0[xX]/;e.exports=8!==n(o+"08")||22!==n(o+"0x16")?function(e,t){var r=i(String(e),3);return n(r,t>>>0||(s.test(r)?16:10))}:n},98332:e=>{e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},38614:(e,t,r)=>{var n=r(59719),i=r(17481),o=r(83285);e.exports=function(e,t){if(n(e),i(t)&&t.constructor===e)return t;var r=o.f(e);return(0,r.resolve)(t),r.promise}},21761:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},24092:(e,t,r)=>{var n=r(1564);e.exports=function(e,t,r){for(var i in t)n(e,i,t[i],r);return e}},1564:(e,t,r)=>{var n=r(56341),i=r(98442),o=r(41063),s=r(90430)("src"),a=r(65979),c="toString",u=(""+a).split(c);r(14411).inspectSource=function(e){return a.call(e)},(e.exports=function(e,t,r,a){var c="function"==typeof r;c&&(o(r,"name")||i(r,"name",t)),e[t]!==r&&(c&&(o(r,s)||i(r,s,e[t]?""+e[t]:u.join(String(t)))),e===n?e[t]=r:a?e[t]?e[t]=r:i(e,t,r):(delete e[t],i(e,t,r)))})(Function.prototype,c,(function(){return"function"==typeof this&&this[s]||a.call(this)}))},29073:(e,t,r)=>{"use strict";var n=r(12845),i=RegExp.prototype.exec;e.exports=function(e,t){var r=e.exec;if("function"==typeof r){var o=r.call(e,t);if("object"!=typeof o)throw new TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==n(e))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},18868:(e,t,r)=>{"use strict";var n,i,o=r(6439),s=RegExp.prototype.exec,a=String.prototype.replace,c=s,u="lastIndex",l=(n=/a/,i=/b*/g,s.call(n,"a"),s.call(i,"a"),0!==n[u]||0!==i[u]),d=void 0!==/()??/.exec("")[1];(l||d)&&(c=function(e){var t,r,n,i,c=this;return d&&(r=new RegExp("^"+c.source+"$(?!\\s)",o.call(c))),l&&(t=c[u]),n=s.call(c,e),l&&n&&(c[u]=c.global?n.index+n[0].length:t),d&&n&&n.length>1&&a.call(n[0],r,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(n[i]=void 0)})),n}),e.exports=c},61541:e=>{e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},87135:(e,t,r)=>{var n=r(17481),i=r(59719),o=function(e,t){if(i(e),!n(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,n){try{(n=r(82794)(Function.call,r(57762).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,r){return o(e,r),t?e.__proto__=r:n(e,r),e}}({},!1):void 0),check:o}},75993:(e,t,r)=>{"use strict";var n=r(56341),i=r(83530),o=r(51916),s=r(9739)("species");e.exports=function(e){var t=n[e];o&&t&&!t[s]&&i.f(t,s,{configurable:!0,get:function(){return this}})}},21309:(e,t,r)=>{var n=r(83530).f,i=r(41063),o=r(9739)("toStringTag");e.exports=function(e,t,r){e&&!i(e=r?e:e.prototype,o)&&n(e,o,{configurable:!0,value:t})}},53548:(e,t,r)=>{var n=r(97355)("keys"),i=r(90430);e.exports=function(e){return n[e]||(n[e]=i(e))}},97355:(e,t,r)=>{var n=r(14411),i=r(56341),o="__core-js_shared__",s=i[o]||(i[o]={});(e.exports=function(e,t){return s[e]||(s[e]=void 0!==t?t:{})})("versions",[]).push({version:n.version,mode:r(35113)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},59789:(e,t,r)=>{var n=r(59719),i=r(23079),o=r(9739)("species");e.exports=function(e,t){var r,s=n(e).constructor;return void 0===s||null==(r=n(s)[o])?t:i(r)}},85139:(e,t,r)=>{"use strict";var n=r(71240);e.exports=function(e,t){return!!e&&n((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},7384:(e,t,r)=>{var n=r(51549),i=r(13589);e.exports=function(e){return function(t,r){var o,s,a=String(i(t)),c=n(r),u=a.length;return c<0||c>=u?e?"":void 0:(o=a.charCodeAt(c))<55296||o>56319||c+1===u||(s=a.charCodeAt(c+1))<56320||s>57343?e?a.charAt(c):o:e?a.slice(c,c+2):s-56320+(o-55296<<10)+65536}}},83256:(e,t,r)=>{var n=r(89543),i=r(13589);e.exports=function(e,t,r){if(n(t))throw TypeError("String#"+r+" doesn't accept regex!");return String(i(e))}},79048:(e,t,r)=>{var n=r(35366),i=r(71240),o=r(13589),s=/"/g,a=function(e,t,r,n){var i=String(o(e)),a="<"+t;return""!==r&&(a+=" "+r+'="'+String(n).replace(s,"&quot;")+'"'),a+">"+i+"</"+t+">"};e.exports=function(e,t){var r={};r[e]=t(a),n(n.P+n.F*i((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})),"String",r)}},9823:(e,t,r)=>{var n=r(61838),i=r(40005),o=r(13589);e.exports=function(e,t,r,s){var a=String(o(e)),c=a.length,u=void 0===r?" ":String(r),l=n(t);if(l<=c||""==u)return a;var d=l-c,h=i.call(u,Math.ceil(d/u.length));return h.length>d&&(h=h.slice(0,d)),s?h+a:a+h}},40005:(e,t,r)=>{"use strict";var n=r(51549),i=r(13589);e.exports=function(e){var t=String(i(this)),r="",o=n(e);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(r+=t);return r}},97370:(e,t,r)=>{var n=r(35366),i=r(13589),o=r(71240),s=r(18275),a="["+s+"]",c=RegExp("^"+a+a+"*"),u=RegExp(a+a+"*$"),l=function(e,t,r){var i={},a=o((function(){return!!s[e]()||"​"!="​"[e]()})),c=i[e]=a?t(d):s[e];r&&(i[r]=c),n(n.P+n.F*a,"String",i)},d=l.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(u,"")),e};e.exports=l},18275:e=>{e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},7122:(e,t,r)=>{var n,i,o,s=r(82794),a=r(16137),c=r(26137),u=r(83383),l=r(56341),d=l.process,h=l.setImmediate,f=l.clearImmediate,p=l.MessageChannel,m=l.Dispatch,g=0,v={},y="onreadystatechange",b=function(){var e=+this;if(v.hasOwnProperty(e)){var t=v[e];delete v[e],t()}},E=function(e){b.call(e.data)};h&&f||(h=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return v[++g]=function(){a("function"==typeof e?e:Function(e),t)},n(g),g},f=function(e){delete v[e]},"process"==r(89426)(d)?n=function(e){d.nextTick(s(b,e,1))}:m&&m.now?n=function(e){m.now(s(b,e,1))}:p?(o=(i=new p).port2,i.port1.onmessage=E,n=s(o.postMessage,o,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(n=function(e){l.postMessage(e+"","*")},l.addEventListener("message",E,!1)):n=y in u("script")?function(e){c.appendChild(u("script"))[y]=function(){c.removeChild(this),b.call(e)}}:function(e){setTimeout(s(b,e,1),0)}),e.exports={set:h,clear:f}},15044:(e,t,r)=>{var n=r(51549),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=n(e))<0?i(e+t,0):o(e,t)}},99707:(e,t,r)=>{var n=r(51549),i=r(61838);e.exports=function(e){if(void 0===e)return 0;var t=n(e),r=i(t);if(t!==r)throw RangeError("Wrong length!");return r}},51549:e=>{var t=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:t)(e)}},8500:(e,t,r)=>{var n=r(60975),i=r(13589);e.exports=function(e){return n(i(e))}},61838:(e,t,r)=>{var n=r(51549),i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},54200:(e,t,r)=>{var n=r(13589);e.exports=function(e){return Object(n(e))}},9241:(e,t,r)=>{var n=r(17481);e.exports=function(e,t){if(!n(e))return e;var r,i;if(t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;if("function"==typeof(r=e.valueOf)&&!n(i=r.call(e)))return i;if(!t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},58754:(e,t,r)=>{"use strict";if(r(51916)){var n=r(35113),i=r(56341),o=r(71240),s=r(35366),a=r(67728),c=r(29895),u=r(82794),l=r(30599),d=r(21761),h=r(98442),f=r(24092),p=r(51549),m=r(61838),g=r(99707),v=r(15044),y=r(9241),b=r(41063),E=r(12845),w=r(17481),S=r(54200),_=r(63894),T=r(62545),x=r(44408),A=r(14230).f,I=r(18444),C=r(90430),R=r(9739),k=r(66934),O=r(61545),N=r(59789),P=r(71308),L=r(4919),D=r(61461),M=r(75993),U=r(70852),B=r(4893),F=r(83530),j=r(57762),V=F.f,H=j.f,G=i.RangeError,q=i.TypeError,$=i.Uint8Array,Z="ArrayBuffer",z="Shared"+Z,K="BYTES_PER_ELEMENT",W="prototype",J=Array[W],Y=c.ArrayBuffer,Q=c.DataView,X=k(0),ee=k(2),te=k(3),re=k(4),ne=k(5),ie=k(6),oe=O(!0),se=O(!1),ae=P.values,ce=P.keys,ue=P.entries,le=J.lastIndexOf,de=J.reduce,he=J.reduceRight,fe=J.join,pe=J.sort,me=J.slice,ge=J.toString,ve=J.toLocaleString,ye=R("iterator"),be=R("toStringTag"),Ee=C("typed_constructor"),we=C("def_constructor"),Se=a.CONSTR,_e=a.TYPED,Te=a.VIEW,xe="Wrong length!",Ae=k(1,(function(e,t){return Oe(N(e,e[we]),t)})),Ie=o((function(){return 1===new $(new Uint16Array([1]).buffer)[0]})),Ce=!!$&&!!$[W].set&&o((function(){new $(1).set({})})),Re=function(e,t){var r=p(e);if(r<0||r%t)throw G("Wrong offset!");return r},ke=function(e){if(w(e)&&_e in e)return e;throw q(e+" is not a typed array!")},Oe=function(e,t){if(!w(e)||!(Ee in e))throw q("It is not a typed array constructor!");return new e(t)},Ne=function(e,t){return Pe(N(e,e[we]),t)},Pe=function(e,t){for(var r=0,n=t.length,i=Oe(e,n);n>r;)i[r]=t[r++];return i},Le=function(e,t,r){V(e,t,{get:function(){return this._d[r]}})},De=function(e){var t,r,n,i,o,s,a=S(e),c=arguments.length,l=c>1?arguments[1]:void 0,d=void 0!==l,h=I(a);if(null!=h&&!_(h)){for(s=h.call(a),n=[],t=0;!(o=s.next()).done;t++)n.push(o.value);a=n}for(d&&c>2&&(l=u(l,arguments[2],2)),t=0,r=m(a.length),i=Oe(this,r);r>t;t++)i[t]=d?l(a[t],t):a[t];return i},Me=function(){for(var e=0,t=arguments.length,r=Oe(this,t);t>e;)r[e]=arguments[e++];return r},Ue=!!$&&o((function(){ve.call(new $(1))})),Be=function(){return ve.apply(Ue?me.call(ke(this)):ke(this),arguments)},Fe={copyWithin:function(e,t){return B.call(ke(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return re(ke(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return U.apply(ke(this),arguments)},filter:function(e){return Ne(this,ee(ke(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return ne(ke(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return ie(ke(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){X(ke(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return se(ke(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return oe(ke(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return fe.apply(ke(this),arguments)},lastIndexOf:function(e){return le.apply(ke(this),arguments)},map:function(e){return Ae(ke(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return de.apply(ke(this),arguments)},reduceRight:function(e){return he.apply(ke(this),arguments)},reverse:function(){for(var e,t=this,r=ke(t).length,n=Math.floor(r/2),i=0;i<n;)e=t[i],t[i++]=t[--r],t[r]=e;return t},some:function(e){return te(ke(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return pe.call(ke(this),e)},subarray:function(e,t){var r=ke(this),n=r.length,i=v(e,n);return new(N(r,r[we]))(r.buffer,r.byteOffset+i*r.BYTES_PER_ELEMENT,m((void 0===t?n:v(t,n))-i))}},je=function(e,t){return Ne(this,me.call(ke(this),e,t))},Ve=function(e){ke(this);var t=Re(arguments[1],1),r=this.length,n=S(e),i=m(n.length),o=0;if(i+t>r)throw G(xe);for(;o<i;)this[t+o]=n[o++]},He={entries:function(){return ue.call(ke(this))},keys:function(){return ce.call(ke(this))},values:function(){return ae.call(ke(this))}},Ge=function(e,t){return w(e)&&e[_e]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},qe=function(e,t){return Ge(e,t=y(t,!0))?d(2,e[t]):H(e,t)},$e=function(e,t,r){return!(Ge(e,t=y(t,!0))&&w(r)&&b(r,"value"))||b(r,"get")||b(r,"set")||r.configurable||b(r,"writable")&&!r.writable||b(r,"enumerable")&&!r.enumerable?V(e,t,r):(e[t]=r.value,e)};Se||(j.f=qe,F.f=$e),s(s.S+s.F*!Se,"Object",{getOwnPropertyDescriptor:qe,defineProperty:$e}),o((function(){ge.call({})}))&&(ge=ve=function(){return fe.call(this)});var Ze=f({},Fe);f(Ze,He),h(Ze,ye,He.values),f(Ze,{slice:je,set:Ve,constructor:function(){},toString:ge,toLocaleString:Be}),Le(Ze,"buffer","b"),Le(Ze,"byteOffset","o"),Le(Ze,"byteLength","l"),Le(Ze,"length","e"),V(Ze,be,{get:function(){return this[_e]}}),e.exports=function(e,t,r,c){var u=e+((c=!!c)?"Clamped":"")+"Array",d="get"+e,f="set"+e,p=i[u],v=p||{},y=p&&x(p),b=!p||!a.ABV,S={},_=p&&p[W],I=function(e,r){V(e,r,{get:function(){return function(e,r){var n=e._d;return n.v[d](r*t+n.o,Ie)}(this,r)},set:function(e){return function(e,r,n){var i=e._d;c&&(n=(n=Math.round(n))<0?0:n>255?255:255&n),i.v[f](r*t+i.o,n,Ie)}(this,r,e)},enumerable:!0})};b?(p=r((function(e,r,n,i){l(e,p,u,"_d");var o,s,a,c,d=0,f=0;if(w(r)){if(!(r instanceof Y||(c=E(r))==Z||c==z))return _e in r?Pe(p,r):De.call(p,r);o=r,f=Re(n,t);var v=r.byteLength;if(void 0===i){if(v%t)throw G(xe);if((s=v-f)<0)throw G(xe)}else if((s=m(i)*t)+f>v)throw G(xe);a=s/t}else a=g(r),o=new Y(s=a*t);for(h(e,"_d",{b:o,o:f,l:s,e:a,v:new Q(o)});d<a;)I(e,d++)})),_=p[W]=T(Ze),h(_,"constructor",p)):o((function(){p(1)}))&&o((function(){new p(-1)}))&&D((function(e){new p,new p(null),new p(1.5),new p(e)}),!0)||(p=r((function(e,r,n,i){var o;return l(e,p,u),w(r)?r instanceof Y||(o=E(r))==Z||o==z?void 0!==i?new v(r,Re(n,t),i):void 0!==n?new v(r,Re(n,t)):new v(r):_e in r?Pe(p,r):De.call(p,r):new v(g(r))})),X(y!==Function.prototype?A(v).concat(A(y)):A(v),(function(e){e in p||h(p,e,v[e])})),p[W]=_,n||(_.constructor=p));var C=_[ye],R=!!C&&("values"==C.name||null==C.name),k=He.values;h(p,Ee,!0),h(_,_e,u),h(_,Te,!0),h(_,we,p),(c?new p(1)[be]==u:be in _)||V(_,be,{get:function(){return u}}),S[u]=p,s(s.G+s.W+s.F*(p!=v),S),s(s.S,u,{BYTES_PER_ELEMENT:t}),s(s.S+s.F*o((function(){v.of.call(p,1)})),u,{from:De,of:Me}),K in _||h(_,K,t),s(s.P,u,Fe),M(u),s(s.P+s.F*Ce,u,{set:Ve}),s(s.P+s.F*!R,u,He),n||_.toString==ge||(_.toString=ge),s(s.P+s.F*o((function(){new p(1).slice()})),u,{slice:je}),s(s.P+s.F*(o((function(){return[1,2].toLocaleString()!=new p([1,2]).toLocaleString()}))||!o((function(){_.toLocaleString.call([1,2])}))),u,{toLocaleString:Be}),L[u]=R?C:k,n||R||h(_,ye,k)}}else e.exports=function(){}},29895:(e,t,r)=>{"use strict";var n=r(56341),i=r(51916),o=r(35113),s=r(67728),a=r(98442),c=r(24092),u=r(71240),l=r(30599),d=r(51549),h=r(61838),f=r(99707),p=r(14230).f,m=r(83530).f,g=r(70852),v=r(21309),y="ArrayBuffer",b="DataView",E="prototype",w="Wrong index!",S=n[y],_=n[b],T=n.Math,x=n.RangeError,A=n.Infinity,I=S,C=T.abs,R=T.pow,k=T.floor,O=T.log,N=T.LN2,P="buffer",L="byteLength",D="byteOffset",M=i?"_b":P,U=i?"_l":L,B=i?"_o":D;function F(e,t,r){var n,i,o,s=new Array(r),a=8*r-t-1,c=(1<<a)-1,u=c>>1,l=23===t?R(2,-24)-R(2,-77):0,d=0,h=e<0||0===e&&1/e<0?1:0;for((e=C(e))!=e||e===A?(i=e!=e?1:0,n=c):(n=k(O(e)/N),e*(o=R(2,-n))<1&&(n--,o*=2),(e+=n+u>=1?l/o:l*R(2,1-u))*o>=2&&(n++,o/=2),n+u>=c?(i=0,n=c):n+u>=1?(i=(e*o-1)*R(2,t),n+=u):(i=e*R(2,u-1)*R(2,t),n=0));t>=8;s[d++]=255&i,i/=256,t-=8);for(n=n<<t|i,a+=t;a>0;s[d++]=255&n,n/=256,a-=8);return s[--d]|=128*h,s}function j(e,t,r){var n,i=8*r-t-1,o=(1<<i)-1,s=o>>1,a=i-7,c=r-1,u=e[c--],l=127&u;for(u>>=7;a>0;l=256*l+e[c],c--,a-=8);for(n=l&(1<<-a)-1,l>>=-a,a+=t;a>0;n=256*n+e[c],c--,a-=8);if(0===l)l=1-s;else{if(l===o)return n?NaN:u?-A:A;n+=R(2,t),l-=s}return(u?-1:1)*n*R(2,l-t)}function V(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function H(e){return[255&e]}function G(e){return[255&e,e>>8&255]}function q(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function $(e){return F(e,52,8)}function Z(e){return F(e,23,4)}function z(e,t,r){m(e[E],t,{get:function(){return this[r]}})}function K(e,t,r,n){var i=f(+r);if(i+t>e[U])throw x(w);var o=e[M]._b,s=i+e[B],a=o.slice(s,s+t);return n?a:a.reverse()}function W(e,t,r,n,i,o){var s=f(+r);if(s+t>e[U])throw x(w);for(var a=e[M]._b,c=s+e[B],u=n(+i),l=0;l<t;l++)a[c+l]=u[o?l:t-l-1]}if(s.ABV){if(!u((function(){S(1)}))||!u((function(){new S(-1)}))||u((function(){return new S,new S(1.5),new S(NaN),S.name!=y}))){for(var J,Y=(S=function(e){return l(this,S),new I(f(e))})[E]=I[E],Q=p(I),X=0;Q.length>X;)(J=Q[X++])in S||a(S,J,I[J]);o||(Y.constructor=S)}var ee=new _(new S(2)),te=_[E].setInt8;ee.setInt8(0,2147483648),ee.setInt8(1,2147483649),!ee.getInt8(0)&&ee.getInt8(1)||c(_[E],{setInt8:function(e,t){te.call(this,e,t<<24>>24)},setUint8:function(e,t){te.call(this,e,t<<24>>24)}},!0)}else S=function(e){l(this,S,y);var t=f(e);this._b=g.call(new Array(t),0),this[U]=t},_=function(e,t,r){l(this,_,b),l(e,S,b);var n=e[U],i=d(t);if(i<0||i>n)throw x("Wrong offset!");if(i+(r=void 0===r?n-i:h(r))>n)throw x("Wrong length!");this[M]=e,this[B]=i,this[U]=r},i&&(z(S,L,"_l"),z(_,P,"_b"),z(_,L,"_l"),z(_,D,"_o")),c(_[E],{getInt8:function(e){return K(this,1,e)[0]<<24>>24},getUint8:function(e){return K(this,1,e)[0]},getInt16:function(e){var t=K(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=K(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return V(K(this,4,e,arguments[1]))},getUint32:function(e){return V(K(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return j(K(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return j(K(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){W(this,1,e,H,t)},setUint8:function(e,t){W(this,1,e,H,t)},setInt16:function(e,t){W(this,2,e,G,t,arguments[2])},setUint16:function(e,t){W(this,2,e,G,t,arguments[2])},setInt32:function(e,t){W(this,4,e,q,t,arguments[2])},setUint32:function(e,t){W(this,4,e,q,t,arguments[2])},setFloat32:function(e,t){W(this,4,e,Z,t,arguments[2])},setFloat64:function(e,t){W(this,8,e,$,t,arguments[2])}});v(S,y),v(_,b),a(_[E],s.VIEW,!0),t[y]=S,t[b]=_},67728:(e,t,r)=>{for(var n,i=r(56341),o=r(98442),s=r(90430),a=s("typed_array"),c=s("view"),u=!(!i.ArrayBuffer||!i.DataView),l=u,d=0,h="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");d<9;)(n=i[h[d++]])?(o(n.prototype,a,!0),o(n.prototype,c,!0)):l=!1;e.exports={ABV:u,CONSTR:l,TYPED:a,VIEW:c}},90430:e=>{var t=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++t+r).toString(36))}},83843:(e,t,r)=>{var n=r(56341).navigator;e.exports=n&&n.userAgent||""},91603:(e,t,r)=>{var n=r(17481);e.exports=function(e,t){if(!n(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},48155:(e,t,r)=>{var n=r(56341),i=r(14411),o=r(35113),s=r(38833),a=r(83530).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=o?{}:n.Symbol||{});"_"==e.charAt(0)||e in t||a(t,e,{value:s.f(e)})}},38833:(e,t,r)=>{t.f=r(9739)},9739:(e,t,r)=>{var n=r(97355)("wks"),i=r(90430),o=r(56341).Symbol,s="function"==typeof o;(e.exports=function(e){return n[e]||(n[e]=s&&o[e]||(s?o:i)("Symbol."+e))}).store=n},18444:(e,t,r)=>{var n=r(12845),i=r(9739)("iterator"),o=r(4919);e.exports=r(14411).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[n(e)]}},71412:(e,t,r)=>{var n=r(35366);n(n.P,"Array",{copyWithin:r(4893)}),r(12802)("copyWithin")},35943:(e,t,r)=>{"use strict";var n=r(35366),i=r(66934)(4);n(n.P+n.F*!r(85139)([].every,!0),"Array",{every:function(e){return i(this,e,arguments[1])}})},30360:(e,t,r)=>{var n=r(35366);n(n.P,"Array",{fill:r(70852)}),r(12802)("fill")},33352:(e,t,r)=>{"use strict";var n=r(35366),i=r(66934)(2);n(n.P+n.F*!r(85139)([].filter,!0),"Array",{filter:function(e){return i(this,e,arguments[1])}})},83118:(e,t,r)=>{"use strict";var n=r(35366),i=r(66934)(6),o="findIndex",s=!0;o in[]&&Array(1)[o]((function(){s=!1})),n(n.P+n.F*s,"Array",{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r(12802)(o)},18394:(e,t,r)=>{"use strict";var n=r(35366),i=r(66934)(5),o="find",s=!0;o in[]&&Array(1)[o]((function(){s=!1})),n(n.P+n.F*s,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r(12802)(o)},9106:(e,t,r)=>{"use strict";var n=r(35366),i=r(66934)(0),o=r(85139)([].forEach,!0);n(n.P+n.F*!o,"Array",{forEach:function(e){return i(this,e,arguments[1])}})},65271:(e,t,r)=>{"use strict";var n=r(82794),i=r(35366),o=r(54200),s=r(55539),a=r(63894),c=r(61838),u=r(51676),l=r(18444);i(i.S+i.F*!r(61461)((function(e){Array.from(e)})),"Array",{from:function(e){var t,r,i,d,h=o(e),f="function"==typeof this?this:Array,p=arguments.length,m=p>1?arguments[1]:void 0,g=void 0!==m,v=0,y=l(h);if(g&&(m=n(m,p>2?arguments[2]:void 0,2)),null==y||f==Array&&a(y))for(r=new f(t=c(h.length));t>v;v++)u(r,v,g?m(h[v],v):h[v]);else for(d=y.call(h),r=new f;!(i=d.next()).done;v++)u(r,v,g?s(d,m,[i.value,v],!0):i.value);return r.length=v,r}})},86174:(e,t,r)=>{"use strict";var n=r(35366),i=r(61545)(!1),o=[].indexOf,s=!!o&&1/[1].indexOf(1,-0)<0;n(n.P+n.F*(s||!r(85139)(o)),"Array",{indexOf:function(e){return s?o.apply(this,arguments)||0:i(this,e,arguments[1])}})},50160:(e,t,r)=>{var n=r(35366);n(n.S,"Array",{isArray:r(40689)})},71308:(e,t,r)=>{"use strict";var n=r(12802),i=r(78611),o=r(4919),s=r(8500);e.exports=r(19121)(Array,"Array",(function(e,t){this._t=s(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])}),"values"),o.Arguments=o.Array,n("keys"),n("values"),n("entries")},92523:(e,t,r)=>{"use strict";var n=r(35366),i=r(8500),o=[].join;n(n.P+n.F*(r(60975)!=Object||!r(85139)(o)),"Array",{join:function(e){return o.call(i(this),void 0===e?",":e)}})},86975:(e,t,r)=>{"use strict";var n=r(35366),i=r(8500),o=r(51549),s=r(61838),a=[].lastIndexOf,c=!!a&&1/[1].lastIndexOf(1,-0)<0;n(n.P+n.F*(c||!r(85139)(a)),"Array",{lastIndexOf:function(e){if(c)return a.apply(this,arguments)||0;var t=i(this),r=s(t.length),n=r-1;for(arguments.length>1&&(n=Math.min(n,o(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in t&&t[n]===e)return n||0;return-1}})},9139:(e,t,r)=>{"use strict";var n=r(35366),i=r(66934)(1);n(n.P+n.F*!r(85139)([].map,!0),"Array",{map:function(e){return i(this,e,arguments[1])}})},18221:(e,t,r)=>{"use strict";var n=r(35366),i=r(51676);n(n.S+n.F*r(71240)((function(){function e(){}return!(Array.of.call(e)instanceof e)})),"Array",{of:function(){for(var e=0,t=arguments.length,r=new("function"==typeof this?this:Array)(t);t>e;)i(r,e,arguments[e++]);return r.length=t,r}})},88292:(e,t,r)=>{"use strict";var n=r(35366),i=r(9857);n(n.P+n.F*!r(85139)([].reduceRight,!0),"Array",{reduceRight:function(e){return i(this,e,arguments.length,arguments[1],!0)}})},59483:(e,t,r)=>{"use strict";var n=r(35366),i=r(9857);n(n.P+n.F*!r(85139)([].reduce,!0),"Array",{reduce:function(e){return i(this,e,arguments.length,arguments[1],!1)}})},65441:(e,t,r)=>{"use strict";var n=r(35366),i=r(26137),o=r(89426),s=r(15044),a=r(61838),c=[].slice;n(n.P+n.F*r(71240)((function(){i&&c.call(i)})),"Array",{slice:function(e,t){var r=a(this.length),n=o(this);if(t=void 0===t?r:t,"Array"==n)return c.call(this,e,t);for(var i=s(e,r),u=s(t,r),l=a(u-i),d=new Array(l),h=0;h<l;h++)d[h]="String"==n?this.charAt(i+h):this[i+h];return d}})},53289:(e,t,r)=>{"use strict";var n=r(35366),i=r(66934)(3);n(n.P+n.F*!r(85139)([].some,!0),"Array",{some:function(e){return i(this,e,arguments[1])}})},88375:(e,t,r)=>{"use strict";var n=r(35366),i=r(23079),o=r(54200),s=r(71240),a=[].sort,c=[1,2,3];n(n.P+n.F*(s((function(){c.sort(void 0)}))||!s((function(){c.sort(null)}))||!r(85139)(a)),"Array",{sort:function(e){return void 0===e?a.call(o(this)):a.call(o(this),i(e))}})},78772:(e,t,r)=>{r(75993)("Array")},32338:(e,t,r)=>{var n=r(35366);n(n.S,"Date",{now:function(){return(new Date).getTime()}})},21575:(e,t,r)=>{var n=r(35366),i=r(41792);n(n.P+n.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},20641:(e,t,r)=>{"use strict";var n=r(35366),i=r(54200),o=r(9241);n(n.P+n.F*r(71240)((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})})),"Date",{toJSON:function(e){var t=i(this),r=o(t);return"number"!=typeof r||isFinite(r)?t.toISOString():null}})},91033:(e,t,r)=>{var n=r(9739)("toPrimitive"),i=Date.prototype;n in i||r(98442)(i,n,r(27687))},75611:(e,t,r)=>{var n=Date.prototype,i="Invalid Date",o="toString",s=n[o],a=n.getTime;new Date(NaN)+""!=i&&r(1564)(n,o,(function(){var e=a.call(this);return e==e?s.call(this):i}))},78769:(e,t,r)=>{var n=r(35366);n(n.P,"Function",{bind:r(46966)})},99383:(e,t,r)=>{"use strict";var n=r(17481),i=r(44408),o=r(9739)("hasInstance"),s=Function.prototype;o in s||r(83530).f(s,o,{value:function(e){if("function"!=typeof this||!n(e))return!1;if(!n(this.prototype))return e instanceof this;for(;e=i(e);)if(this.prototype===e)return!0;return!1}})},729:(e,t,r)=>{var n=r(83530).f,i=Function.prototype,o=/^\s*function ([^ (]*)/,s="name";s in i||r(51916)&&n(i,s,{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(e){return""}}})},82509:(e,t,r)=>{"use strict";var n=r(95144),i=r(91603),o="Map";e.exports=r(58091)(o,(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=n.getEntry(i(this,o),e);return t&&t.v},set:function(e,t){return n.def(i(this,o),0===e?0:e,t)}},n,!0)},12372:(e,t,r)=>{var n=r(35366),i=r(19007),o=Math.sqrt,s=Math.acosh;n(n.S+n.F*!(s&&710==Math.floor(s(Number.MAX_VALUE))&&s(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?Math.log(e)+Math.LN2:i(e-1+o(e-1)*o(e+1))}})},30511:(e,t,r)=>{var n=r(35366),i=Math.asinh;n(n.S+n.F*!(i&&1/i(0)>0),"Math",{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}})},6781:(e,t,r)=>{var n=r(35366),i=Math.atanh;n(n.S+n.F*!(i&&1/i(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}})},74434:(e,t,r)=>{var n=r(35366),i=r(84247);n(n.S,"Math",{cbrt:function(e){return i(e=+e)*Math.pow(Math.abs(e),1/3)}})},14783:(e,t,r)=>{var n=r(35366);n(n.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}})},95521:(e,t,r)=>{var n=r(35366),i=Math.exp;n(n.S,"Math",{cosh:function(e){return(i(e=+e)+i(-e))/2}})},94093:(e,t,r)=>{var n=r(35366),i=r(77117);n(n.S+n.F*(i!=Math.expm1),"Math",{expm1:i})},86378:(e,t,r)=>{var n=r(35366);n(n.S,"Math",{fround:r(59396)})},52380:(e,t,r)=>{var n=r(35366),i=Math.abs;n(n.S,"Math",{hypot:function(e,t){for(var r,n,o=0,s=0,a=arguments.length,c=0;s<a;)c<(r=i(arguments[s++]))?(o=o*(n=c/r)*n+1,c=r):o+=r>0?(n=r/c)*n:r;return c===1/0?1/0:c*Math.sqrt(o)}})},2803:(e,t,r)=>{var n=r(35366),i=Math.imul;n(n.S+n.F*r(71240)((function(){return-5!=i(4294967295,5)||2!=i.length})),"Math",{imul:function(e,t){var r=65535,n=+e,i=+t,o=r&n,s=r&i;return 0|o*s+((r&n>>>16)*s+o*(r&i>>>16)<<16>>>0)}})},63725:(e,t,r)=>{var n=r(35366);n(n.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}})},7977:(e,t,r)=>{var n=r(35366);n(n.S,"Math",{log1p:r(19007)})},14192:(e,t,r)=>{var n=r(35366);n(n.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},2940:(e,t,r)=>{var n=r(35366);n(n.S,"Math",{sign:r(84247)})},35731:(e,t,r)=>{var n=r(35366),i=r(77117),o=Math.exp;n(n.S+n.F*r(71240)((function(){return-2e-17!=!Math.sinh(-2e-17)})),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(i(e)-i(-e))/2:(o(e-1)-o(-e-1))*(Math.E/2)}})},79382:(e,t,r)=>{var n=r(35366),i=r(77117),o=Math.exp;n(n.S,"Math",{tanh:function(e){var t=i(e=+e),r=i(-e);return t==1/0?1:r==1/0?-1:(t-r)/(o(e)+o(-e))}})},38877:(e,t,r)=>{var n=r(35366);n(n.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}})},10348:(e,t,r)=>{"use strict";var n=r(56341),i=r(41063),o=r(89426),s=r(94805),a=r(9241),c=r(71240),u=r(14230).f,l=r(57762).f,d=r(83530).f,h=r(97370).trim,f="Number",p=n[f],m=p,g=p.prototype,v=o(r(62545)(g))==f,y="trim"in String.prototype,b=function(e){var t=a(e,!1);if("string"==typeof t&&t.length>2){var r,n,i,o=(t=y?t.trim():h(t,3)).charCodeAt(0);if(43===o||45===o){if(88===(r=t.charCodeAt(2))||120===r)return NaN}else if(48===o){switch(t.charCodeAt(1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+t}for(var s,c=t.slice(2),u=0,l=c.length;u<l;u++)if((s=c.charCodeAt(u))<48||s>i)return NaN;return parseInt(c,n)}}return+t};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(e){var t=arguments.length<1?0:e,r=this;return r instanceof p&&(v?c((function(){g.valueOf.call(r)})):o(r)!=f)?s(new m(b(t)),r,p):b(t)};for(var E,w=r(51916)?u(m):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;w.length>S;S++)i(m,E=w[S])&&!i(p,E)&&d(p,E,l(m,E));p.prototype=g,g.constructor=p,r(1564)(n,f,p)}},64007:(e,t,r)=>{var n=r(35366);n(n.S,"Number",{EPSILON:Math.pow(2,-52)})},87616:(e,t,r)=>{var n=r(35366),i=r(56341).isFinite;n(n.S,"Number",{isFinite:function(e){return"number"==typeof e&&i(e)}})},86762:(e,t,r)=>{var n=r(35366);n(n.S,"Number",{isInteger:r(22289)})},43316:(e,t,r)=>{var n=r(35366);n(n.S,"Number",{isNaN:function(e){return e!=e}})},93019:(e,t,r)=>{var n=r(35366),i=r(22289),o=Math.abs;n(n.S,"Number",{isSafeInteger:function(e){return i(e)&&o(e)<=9007199254740991}})},40293:(e,t,r)=>{var n=r(35366);n(n.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},60640:(e,t,r)=>{var n=r(35366);n(n.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},96589:(e,t,r)=>{var n=r(35366),i=r(13765);n(n.S+n.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},93210:(e,t,r)=>{var n=r(35366),i=r(80500);n(n.S+n.F*(Number.parseInt!=i),"Number",{parseInt:i})},71028:(e,t,r)=>{"use strict";var n=r(35366),i=r(51549),o=r(23373),s=r(40005),a=1..toFixed,c=Math.floor,u=[0,0,0,0,0,0],l="Number.toFixed: incorrect invocation!",d="0",h=function(e,t){for(var r=-1,n=t;++r<6;)n+=e*u[r],u[r]=n%1e7,n=c(n/1e7)},f=function(e){for(var t=6,r=0;--t>=0;)r+=u[t],u[t]=c(r/e),r=r%e*1e7},p=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==u[e]){var r=String(u[e]);t=""===t?r:t+s.call(d,7-r.length)+r}return t},m=function(e,t,r){return 0===t?r:t%2==1?m(e,t-1,r*e):m(e*e,t/2,r)};n(n.P+n.F*(!!a&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r(71240)((function(){a.call({})}))),"Number",{toFixed:function(e){var t,r,n,a,c=o(this,l),u=i(e),g="",v=d;if(u<0||u>20)throw RangeError(l);if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return String(c);if(c<0&&(g="-",c=-c),c>1e-21)if(t=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t}(c*m(2,69,1))-69,r=t<0?c*m(2,-t,1):c/m(2,t,1),r*=4503599627370496,(t=52-t)>0){for(h(0,r),n=u;n>=7;)h(1e7,0),n-=7;for(h(m(10,n,1),0),n=t-1;n>=23;)f(1<<23),n-=23;f(1<<n),h(1,1),f(2),v=p()}else h(0,r),h(1<<-t,0),v=p()+s.call(d,u);return v=u>0?g+((a=v.length)<=u?"0."+s.call(d,u-a)+v:v.slice(0,a-u)+"."+v.slice(a-u)):g+v}})},2610:(e,t,r)=>{"use strict";var n=r(35366),i=r(71240),o=r(23373),s=1..toPrecision;n(n.P+n.F*(i((function(){return"1"!==s.call(1,void 0)}))||!i((function(){s.call({})}))),"Number",{toPrecision:function(e){var t=o(this,"Number#toPrecision: incorrect invocation!");return void 0===e?s.call(t):s.call(t,e)}})},88325:(e,t,r)=>{var n=r(35366);n(n.S+n.F,"Object",{assign:r(49821)})},57944:(e,t,r)=>{var n=r(35366);n(n.S,"Object",{create:r(62545)})},10266:(e,t,r)=>{var n=r(35366);n(n.S+n.F*!r(51916),"Object",{defineProperties:r(30413)})},65388:(e,t,r)=>{var n=r(35366);n(n.S+n.F*!r(51916),"Object",{defineProperty:r(83530).f})},40192:(e,t,r)=>{var n=r(17481),i=r(82153).onFreeze;r(81025)("freeze",(function(e){return function(t){return e&&n(t)?e(i(t)):t}}))},57557:(e,t,r)=>{var n=r(8500),i=r(57762).f;r(81025)("getOwnPropertyDescriptor",(function(){return function(e,t){return i(n(e),t)}}))},54943:(e,t,r)=>{r(81025)("getOwnPropertyNames",(function(){return r(85009).f}))},63386:(e,t,r)=>{var n=r(54200),i=r(44408);r(81025)("getPrototypeOf",(function(){return function(e){return i(n(e))}}))},4649:(e,t,r)=>{var n=r(17481);r(81025)("isExtensible",(function(e){return function(t){return!!n(t)&&(!e||e(t))}}))},16736:(e,t,r)=>{var n=r(17481);r(81025)("isFrozen",(function(e){return function(t){return!n(t)||!!e&&e(t)}}))},7260:(e,t,r)=>{var n=r(17481);r(81025)("isSealed",(function(e){return function(t){return!n(t)||!!e&&e(t)}}))},52798:(e,t,r)=>{var n=r(35366);n(n.S,"Object",{is:r(61541)})},30081:(e,t,r)=>{var n=r(54200),i=r(15825);r(81025)("keys",(function(){return function(e){return i(n(e))}}))},17026:(e,t,r)=>{var n=r(17481),i=r(82153).onFreeze;r(81025)("preventExtensions",(function(e){return function(t){return e&&n(t)?e(i(t)):t}}))},24371:(e,t,r)=>{var n=r(17481),i=r(82153).onFreeze;r(81025)("seal",(function(e){return function(t){return e&&n(t)?e(i(t)):t}}))},86911:(e,t,r)=>{var n=r(35366);n(n.S,"Object",{setPrototypeOf:r(87135).set})},84394:(e,t,r)=>{"use strict";var n=r(12845),i={};i[r(9739)("toStringTag")]="z",i+""!="[object z]"&&r(1564)(Object.prototype,"toString",(function(){return"[object "+n(this)+"]"}),!0)},15072:(e,t,r)=>{var n=r(35366),i=r(13765);n(n.G+n.F*(parseFloat!=i),{parseFloat:i})},19315:(e,t,r)=>{var n=r(35366),i=r(80500);n(n.G+n.F*(parseInt!=i),{parseInt:i})},12813:(e,t,r)=>{"use strict";var n,i,o,s,a=r(35113),c=r(56341),u=r(82794),l=r(12845),d=r(35366),h=r(17481),f=r(23079),p=r(30599),m=r(62971),g=r(59789),v=r(7122).set,y=r(37)(),b=r(83285),E=r(98332),w=r(83843),S=r(38614),_="Promise",T=c.TypeError,x=c.process,A=x&&x.versions,I=A&&A.v8||"",C=c[_],R="process"==l(x),k=function(){},O=i=b.f,N=!!function(){try{var e=C.resolve(1),t=(e.constructor={})[r(9739)("species")]=function(e){e(k,k)};return(R||"function"==typeof PromiseRejectionEvent)&&e.then(k)instanceof t&&0!==I.indexOf("6.6")&&-1===w.indexOf("Chrome/66")}catch(e){}}(),P=function(e){var t;return!(!h(e)||"function"!=typeof(t=e.then))&&t},L=function(e,t){if(!e._n){e._n=!0;var r=e._c;y((function(){for(var n=e._v,i=1==e._s,o=0,s=function(t){var r,o,s,a=i?t.ok:t.fail,c=t.resolve,u=t.reject,l=t.domain;try{a?(i||(2==e._h&&U(e),e._h=1),!0===a?r=n:(l&&l.enter(),r=a(n),l&&(l.exit(),s=!0)),r===t.promise?u(T("Promise-chain cycle")):(o=P(r))?o.call(r,c,u):c(r)):u(n)}catch(e){l&&!s&&l.exit(),u(e)}};r.length>o;)s(r[o++]);e._c=[],e._n=!1,t&&!e._h&&D(e)}))}},D=function(e){v.call(c,(function(){var t,r,n,i=e._v,o=M(e);if(o&&(t=E((function(){R?x.emit("unhandledRejection",i,e):(r=c.onunhandledrejection)?r({promise:e,reason:i}):(n=c.console)&&n.error&&n.error("Unhandled promise rejection",i)})),e._h=R||M(e)?2:1),e._a=void 0,o&&t.e)throw t.v}))},M=function(e){return 1!==e._h&&0===(e._a||e._c).length},U=function(e){v.call(c,(function(){var t;R?x.emit("rejectionHandled",e):(t=c.onrejectionhandled)&&t({promise:e,reason:e._v})}))},B=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),L(t,!0))},F=function(e){var t,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw T("Promise can't be resolved itself");(t=P(e))?y((function(){var n={_w:r,_d:!1};try{t.call(e,u(F,n,1),u(B,n,1))}catch(e){B.call(n,e)}})):(r._v=e,r._s=1,L(r,!1))}catch(e){B.call({_w:r,_d:!1},e)}}};N||(C=function(e){p(this,C,_,"_h"),f(e),n.call(this);try{e(u(F,this,1),u(B,this,1))}catch(e){B.call(this,e)}},(n=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=r(24092)(C.prototype,{then:function(e,t){var r=O(g(this,C));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=R?x.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&L(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new n;this.promise=e,this.resolve=u(F,e,1),this.reject=u(B,e,1)},b.f=O=function(e){return e===C||e===s?new o(e):i(e)}),d(d.G+d.W+d.F*!N,{Promise:C}),r(21309)(C,_),r(75993)(_),s=r(14411)[_],d(d.S+d.F*!N,_,{reject:function(e){var t=O(this);return(0,t.reject)(e),t.promise}}),d(d.S+d.F*(a||!N),_,{resolve:function(e){return S(a&&this===s?C:this,e)}}),d(d.S+d.F*!(N&&r(61461)((function(e){C.all(e).catch(k)}))),_,{all:function(e){var t=this,r=O(t),n=r.resolve,i=r.reject,o=E((function(){var r=[],o=0,s=1;m(e,!1,(function(e){var a=o++,c=!1;r.push(void 0),s++,t.resolve(e).then((function(e){c||(c=!0,r[a]=e,--s||n(r))}),i)})),--s||n(r)}));return o.e&&i(o.v),r.promise},race:function(e){var t=this,r=O(t),n=r.reject,i=E((function(){m(e,!1,(function(e){t.resolve(e).then(r.resolve,n)}))}));return i.e&&n(i.v),r.promise}})},69310:(e,t,r)=>{var n=r(35366),i=r(23079),o=r(59719),s=(r(56341).Reflect||{}).apply,a=Function.apply;n(n.S+n.F*!r(71240)((function(){s((function(){}))})),"Reflect",{apply:function(e,t,r){var n=i(e),c=o(r);return s?s(n,t,c):a.call(n,t,c)}})},66722:(e,t,r)=>{var n=r(35366),i=r(62545),o=r(23079),s=r(59719),a=r(17481),c=r(71240),u=r(46966),l=(r(56341).Reflect||{}).construct,d=c((function(){function e(){}return!(l((function(){}),[],e)instanceof e)})),h=!c((function(){l((function(){}))}));n(n.S+n.F*(d||h),"Reflect",{construct:function(e,t){o(e),s(t);var r=arguments.length<3?e:o(arguments[2]);if(h&&!d)return l(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(u.apply(e,n))}var c=r.prototype,f=i(a(c)?c:Object.prototype),p=Function.apply.call(e,f,t);return a(p)?p:f}})},18372:(e,t,r)=>{var n=r(83530),i=r(35366),o=r(59719),s=r(9241);i(i.S+i.F*r(71240)((function(){Reflect.defineProperty(n.f({},1,{value:1}),1,{value:2})})),"Reflect",{defineProperty:function(e,t,r){o(e),t=s(t,!0),o(r);try{return n.f(e,t,r),!0}catch(e){return!1}}})},14604:(e,t,r)=>{var n=r(35366),i=r(57762).f,o=r(59719);n(n.S,"Reflect",{deleteProperty:function(e,t){var r=i(o(e),t);return!(r&&!r.configurable)&&delete e[t]}})},84781:(e,t,r)=>{"use strict";var n=r(35366),i=r(59719),o=function(e){this._t=i(e),this._i=0;var t,r=this._k=[];for(t in e)r.push(t)};r(47938)(o,"Object",(function(){var e,t=this,r=t._k;do{if(t._i>=r.length)return{value:void 0,done:!0}}while(!((e=r[t._i++])in t._t));return{value:e,done:!1}})),n(n.S,"Reflect",{enumerate:function(e){return new o(e)}})},24395:(e,t,r)=>{var n=r(57762),i=r(35366),o=r(59719);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return n.f(o(e),t)}})},49649:(e,t,r)=>{var n=r(35366),i=r(44408),o=r(59719);n(n.S,"Reflect",{getPrototypeOf:function(e){return i(o(e))}})},38416:(e,t,r)=>{var n=r(57762),i=r(44408),o=r(41063),s=r(35366),a=r(17481),c=r(59719);s(s.S,"Reflect",{get:function e(t,r){var s,u,l=arguments.length<3?t:arguments[2];return c(t)===l?t[r]:(s=n.f(t,r))?o(s,"value")?s.value:void 0!==s.get?s.get.call(l):void 0:a(u=i(t))?e(u,r,l):void 0}})},32475:(e,t,r)=>{var n=r(35366);n(n.S,"Reflect",{has:function(e,t){return t in e}})},12924:(e,t,r)=>{var n=r(35366),i=r(59719),o=Object.isExtensible;n(n.S,"Reflect",{isExtensible:function(e){return i(e),!o||o(e)}})},16337:(e,t,r)=>{var n=r(35366);n(n.S,"Reflect",{ownKeys:r(17285)})},83286:(e,t,r)=>{var n=r(35366),i=r(59719),o=Object.preventExtensions;n(n.S,"Reflect",{preventExtensions:function(e){i(e);try{return o&&o(e),!0}catch(e){return!1}}})},68766:(e,t,r)=>{var n=r(35366),i=r(87135);i&&n(n.S,"Reflect",{setPrototypeOf:function(e,t){i.check(e,t);try{return i.set(e,t),!0}catch(e){return!1}}})},47225:(e,t,r)=>{var n=r(83530),i=r(57762),o=r(44408),s=r(41063),a=r(35366),c=r(21761),u=r(59719),l=r(17481);a(a.S,"Reflect",{set:function e(t,r,a){var d,h,f=arguments.length<4?t:arguments[3],p=i.f(u(t),r);if(!p){if(l(h=o(t)))return e(h,r,a,f);p=c(0)}if(s(p,"value")){if(!1===p.writable||!l(f))return!1;if(d=i.f(f,r)){if(d.get||d.set||!1===d.writable)return!1;d.value=a,n.f(f,r,d)}else n.f(f,r,c(0,a));return!0}return void 0!==p.set&&(p.set.call(f,a),!0)}})},87080:(e,t,r)=>{var n=r(56341),i=r(94805),o=r(83530).f,s=r(14230).f,a=r(89543),c=r(6439),u=n.RegExp,l=u,d=u.prototype,h=/a/g,f=/a/g,p=new u(h)!==h;if(r(51916)&&(!p||r(71240)((function(){return f[r(9739)("match")]=!1,u(h)!=h||u(f)==f||"/a/i"!=u(h,"i")})))){u=function(e,t){var r=this instanceof u,n=a(e),o=void 0===t;return!r&&n&&e.constructor===u&&o?e:i(p?new l(n&&!o?e.source:e,t):l((n=e instanceof u)?e.source:e,n&&o?c.call(e):t),r?this:d,u)};for(var m=function(e){e in u||o(u,e,{configurable:!0,get:function(){return l[e]},set:function(t){l[e]=t}})},g=s(l),v=0;g.length>v;)m(g[v++]);d.constructor=u,u.prototype=d,r(1564)(n,"RegExp",u)}r(75993)("RegExp")},58615:(e,t,r)=>{"use strict";var n=r(18868);r(35366)({target:"RegExp",proto:!0,forced:n!==/./.exec},{exec:n})},39544:(e,t,r)=>{r(51916)&&"g"!=/./g.flags&&r(83530).f(RegExp.prototype,"flags",{configurable:!0,get:r(6439)})},45475:(e,t,r)=>{"use strict";var n=r(59719),i=r(61838),o=r(9959),s=r(29073);r(25307)("match",1,(function(e,t,r,a){return[function(r){var n=e(this),i=null==r?void 0:r[t];return void 0!==i?i.call(r,n):new RegExp(r)[t](String(n))},function(e){var t=a(r,e,this);if(t.done)return t.value;var c=n(e),u=String(this);if(!c.global)return s(c,u);var l=c.unicode;c.lastIndex=0;for(var d,h=[],f=0;null!==(d=s(c,u));){var p=String(d[0]);h[f]=p,""===p&&(c.lastIndex=o(u,i(c.lastIndex),l)),f++}return 0===f?null:h}]}))},33770:(e,t,r)=>{"use strict";var n=r(59719),i=r(54200),o=r(61838),s=r(51549),a=r(9959),c=r(29073),u=Math.max,l=Math.min,d=Math.floor,h=/\$([$&`']|\d\d?|<[^>]*>)/g,f=/\$([$&`']|\d\d?)/g;r(25307)("replace",2,(function(e,t,r,p){return[function(n,i){var o=e(this),s=null==n?void 0:n[t];return void 0!==s?s.call(n,o,i):r.call(String(o),n,i)},function(e,t){var i=p(r,e,this,t);if(i.done)return i.value;var d=n(e),h=String(this),f="function"==typeof t;f||(t=String(t));var g=d.global;if(g){var v=d.unicode;d.lastIndex=0}for(var y=[];;){var b=c(d,h);if(null===b)break;if(y.push(b),!g)break;""===String(b[0])&&(d.lastIndex=a(h,o(d.lastIndex),v))}for(var E,w="",S=0,_=0;_<y.length;_++){b=y[_];for(var T=String(b[0]),x=u(l(s(b.index),h.length),0),A=[],I=1;I<b.length;I++)A.push(void 0===(E=b[I])?E:String(E));var C=b.groups;if(f){var R=[T].concat(A,x,h);void 0!==C&&R.push(C);var k=String(t.apply(void 0,R))}else k=m(T,h,x,A,C,t);x>=S&&(w+=h.slice(S,x)+k,S=x+T.length)}return w+h.slice(S)}];function m(e,t,n,o,s,a){var c=n+e.length,u=o.length,l=f;return void 0!==s&&(s=i(s),l=h),r.call(a,l,(function(r,i){var a;switch(i.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,n);case"'":return t.slice(c);case"<":a=s[i.slice(1,-1)];break;default:var l=+i;if(0===l)return r;if(l>u){var h=d(l/10);return 0===h?r:h<=u?void 0===o[h-1]?i.charAt(1):o[h-1]+i.charAt(1):r}a=o[l-1]}return void 0===a?"":a}))}}))},5201:(e,t,r)=>{"use strict";var n=r(59719),i=r(61541),o=r(29073);r(25307)("search",1,(function(e,t,r,s){return[function(r){var n=e(this),i=null==r?void 0:r[t];return void 0!==i?i.call(r,n):new RegExp(r)[t](String(n))},function(e){var t=s(r,e,this);if(t.done)return t.value;var a=n(e),c=String(this),u=a.lastIndex;i(u,0)||(a.lastIndex=0);var l=o(a,c);return i(a.lastIndex,u)||(a.lastIndex=u),null===l?-1:l.index}]}))},61385:(e,t,r)=>{"use strict";var n=r(89543),i=r(59719),o=r(59789),s=r(9959),a=r(61838),c=r(29073),u=r(18868),l=r(71240),d=Math.min,h=[].push,f="split",p="length",m="lastIndex",g=4294967295,v=!l((function(){RegExp(g,"y")}));r(25307)("split",2,(function(e,t,r,l){var y;return y="c"=="abbc"[f](/(b)*/)[1]||4!="test"[f](/(?:)/,-1)[p]||2!="ab"[f](/(?:ab)*/)[p]||4!="."[f](/(.?)(.?)/)[p]||"."[f](/()()/)[p]>1||""[f](/.?/)[p]?function(e,t){var i=String(this);if(void 0===e&&0===t)return[];if(!n(e))return r.call(i,e,t);for(var o,s,a,c=[],l=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),d=0,f=void 0===t?g:t>>>0,v=new RegExp(e.source,l+"g");(o=u.call(v,i))&&!((s=v[m])>d&&(c.push(i.slice(d,o.index)),o[p]>1&&o.index<i[p]&&h.apply(c,o.slice(1)),a=o[0][p],d=s,c[p]>=f));)v[m]===o.index&&v[m]++;return d===i[p]?!a&&v.test("")||c.push(""):c.push(i.slice(d)),c[p]>f?c.slice(0,f):c}:"0"[f](void 0,0)[p]?function(e,t){return void 0===e&&0===t?[]:r.call(this,e,t)}:r,[function(r,n){var i=e(this),o=null==r?void 0:r[t];return void 0!==o?o.call(r,i,n):y.call(String(i),r,n)},function(e,t){var n=l(y,e,this,t,y!==r);if(n.done)return n.value;var u=i(e),h=String(this),f=o(u,RegExp),p=u.unicode,m=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(v?"y":"g"),b=new f(v?u:"^(?:"+u.source+")",m),E=void 0===t?g:t>>>0;if(0===E)return[];if(0===h.length)return null===c(b,h)?[h]:[];for(var w=0,S=0,_=[];S<h.length;){b.lastIndex=v?S:0;var T,x=c(b,v?h:h.slice(S));if(null===x||(T=d(a(b.lastIndex+(v?0:S)),h.length))===w)S=s(h,S,p);else{if(_.push(h.slice(w,S)),_.length===E)return _;for(var A=1;A<=x.length-1;A++)if(_.push(x[A]),_.length===E)return _;S=w=T}}return _.push(h.slice(w)),_}]}))},35244:(e,t,r)=>{"use strict";r(39544);var n=r(59719),i=r(6439),o=r(51916),s="toString",a=/./[s],c=function(e){r(1564)(RegExp.prototype,s,e,!0)};r(71240)((function(){return"/a/b"!=a.call({source:"a",flags:"b"})}))?c((function(){var e=n(this);return"/".concat(e.source,"/","flags"in e?e.flags:!o&&e instanceof RegExp?i.call(e):void 0)})):a.name!=s&&c((function(){return a.call(this)}))},98253:(e,t,r)=>{"use strict";var n=r(95144),i=r(91603);e.exports=r(58091)("Set",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return n.def(i(this,"Set"),e=0===e?0:e,e)}},n)},50447:(e,t,r)=>{"use strict";r(79048)("anchor",(function(e){return function(t){return e(this,"a","name",t)}}))},65624:(e,t,r)=>{"use strict";r(79048)("big",(function(e){return function(){return e(this,"big","","")}}))},51263:(e,t,r)=>{"use strict";r(79048)("blink",(function(e){return function(){return e(this,"blink","","")}}))},65193:(e,t,r)=>{"use strict";r(79048)("bold",(function(e){return function(){return e(this,"b","","")}}))},82858:(e,t,r)=>{"use strict";var n=r(35366),i=r(7384)(!1);n(n.P,"String",{codePointAt:function(e){return i(this,e)}})},22058:(e,t,r)=>{"use strict";var n=r(35366),i=r(61838),o=r(83256),s="endsWith",a=""[s];n(n.P+n.F*r(46881)(s),"String",{endsWith:function(e){var t=o(this,e,s),r=arguments.length>1?arguments[1]:void 0,n=i(t.length),c=void 0===r?n:Math.min(i(r),n),u=String(e);return a?a.call(t,u,c):t.slice(c-u.length,c)===u}})},28241:(e,t,r)=>{"use strict";r(79048)("fixed",(function(e){return function(){return e(this,"tt","","")}}))},96723:(e,t,r)=>{"use strict";r(79048)("fontcolor",(function(e){return function(t){return e(this,"font","color",t)}}))},9394:(e,t,r)=>{"use strict";r(79048)("fontsize",(function(e){return function(t){return e(this,"font","size",t)}}))},22539:(e,t,r)=>{var n=r(35366),i=r(15044),o=String.fromCharCode,s=String.fromCodePoint;n(n.S+n.F*(!!s&&1!=s.length),"String",{fromCodePoint:function(e){for(var t,r=[],n=arguments.length,s=0;n>s;){if(t=+arguments[s++],i(t,1114111)!==t)throw RangeError(t+" is not a valid code point");r.push(t<65536?o(t):o(55296+((t-=65536)>>10),t%1024+56320))}return r.join("")}})},95472:(e,t,r)=>{"use strict";var n=r(35366),i=r(83256),o="includes";n(n.P+n.F*r(46881)(o),"String",{includes:function(e){return!!~i(this,e,o).indexOf(e,arguments.length>1?arguments[1]:void 0)}})},66938:(e,t,r)=>{"use strict";r(79048)("italics",(function(e){return function(){return e(this,"i","","")}}))},74333:(e,t,r)=>{"use strict";var n=r(7384)(!0);r(19121)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=n(t,r),this._i+=e.length,{value:e,done:!1})}))},11961:(e,t,r)=>{"use strict";r(79048)("link",(function(e){return function(t){return e(this,"a","href",t)}}))},39820:(e,t,r)=>{var n=r(35366),i=r(8500),o=r(61838);n(n.S,"String",{raw:function(e){for(var t=i(e.raw),r=o(t.length),n=arguments.length,s=[],a=0;r>a;)s.push(String(t[a++])),a<n&&s.push(String(arguments[a]));return s.join("")}})},57001:(e,t,r)=>{var n=r(35366);n(n.P,"String",{repeat:r(40005)})},69659:(e,t,r)=>{"use strict";r(79048)("small",(function(e){return function(){return e(this,"small","","")}}))},57492:(e,t,r)=>{"use strict";var n=r(35366),i=r(61838),o=r(83256),s="startsWith",a=""[s];n(n.P+n.F*r(46881)(s),"String",{startsWith:function(e){var t=o(this,e,s),r=i(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),n=String(e);return a?a.call(t,n,r):t.slice(r,r+n.length)===n}})},23354:(e,t,r)=>{"use strict";r(79048)("strike",(function(e){return function(){return e(this,"strike","","")}}))},99620:(e,t,r)=>{"use strict";r(79048)("sub",(function(e){return function(){return e(this,"sub","","")}}))},638:(e,t,r)=>{"use strict";r(79048)("sup",(function(e){return function(){return e(this,"sup","","")}}))},28417:(e,t,r)=>{"use strict";r(97370)("trim",(function(e){return function(){return e(this,3)}}))},98997:(e,t,r)=>{"use strict";var n=r(56341),i=r(41063),o=r(51916),s=r(35366),a=r(1564),c=r(82153).KEY,u=r(71240),l=r(97355),d=r(21309),h=r(90430),f=r(9739),p=r(38833),m=r(48155),g=r(4535),v=r(40689),y=r(59719),b=r(17481),E=r(54200),w=r(8500),S=r(9241),_=r(21761),T=r(62545),x=r(85009),A=r(57762),I=r(32520),C=r(83530),R=r(15825),k=A.f,O=C.f,N=x.f,P=n.Symbol,L=n.JSON,D=L&&L.stringify,M="prototype",U=f("_hidden"),B=f("toPrimitive"),F={}.propertyIsEnumerable,j=l("symbol-registry"),V=l("symbols"),H=l("op-symbols"),G=Object[M],q="function"==typeof P&&!!I.f,$=n.QObject,Z=!$||!$[M]||!$[M].findChild,z=o&&u((function(){return 7!=T(O({},"a",{get:function(){return O(this,"a",{value:7}).a}})).a}))?function(e,t,r){var n=k(G,t);n&&delete G[t],O(e,t,r),n&&e!==G&&O(G,t,n)}:O,K=function(e){var t=V[e]=T(P[M]);return t._k=e,t},W=q&&"symbol"==typeof P.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof P},J=function(e,t,r){return e===G&&J(H,t,r),y(e),t=S(t,!0),y(r),i(V,t)?(r.enumerable?(i(e,U)&&e[U][t]&&(e[U][t]=!1),r=T(r,{enumerable:_(0,!1)})):(i(e,U)||O(e,U,_(1,{})),e[U][t]=!0),z(e,t,r)):O(e,t,r)},Y=function(e,t){y(e);for(var r,n=g(t=w(t)),i=0,o=n.length;o>i;)J(e,r=n[i++],t[r]);return e},Q=function(e){var t=F.call(this,e=S(e,!0));return!(this===G&&i(V,e)&&!i(H,e))&&(!(t||!i(this,e)||!i(V,e)||i(this,U)&&this[U][e])||t)},X=function(e,t){if(e=w(e),t=S(t,!0),e!==G||!i(V,t)||i(H,t)){var r=k(e,t);return!r||!i(V,t)||i(e,U)&&e[U][t]||(r.enumerable=!0),r}},ee=function(e){for(var t,r=N(w(e)),n=[],o=0;r.length>o;)i(V,t=r[o++])||t==U||t==c||n.push(t);return n},te=function(e){for(var t,r=e===G,n=N(r?H:w(e)),o=[],s=0;n.length>s;)!i(V,t=n[s++])||r&&!i(G,t)||o.push(V[t]);return o};q||(a((P=function(){if(this instanceof P)throw TypeError("Symbol is not a constructor!");var e=h(arguments.length>0?arguments[0]:void 0),t=function(r){this===G&&t.call(H,r),i(this,U)&&i(this[U],e)&&(this[U][e]=!1),z(this,e,_(1,r))};return o&&Z&&z(G,e,{configurable:!0,set:t}),K(e)})[M],"toString",(function(){return this._k})),A.f=X,C.f=J,r(14230).f=x.f=ee,r(41144).f=Q,I.f=te,o&&!r(35113)&&a(G,"propertyIsEnumerable",Q,!0),p.f=function(e){return K(f(e))}),s(s.G+s.W+s.F*!q,{Symbol:P});for(var re="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;re.length>ne;)f(re[ne++]);for(var ie=R(f.store),oe=0;ie.length>oe;)m(ie[oe++]);s(s.S+s.F*!q,"Symbol",{for:function(e){return i(j,e+="")?j[e]:j[e]=P(e)},keyFor:function(e){if(!W(e))throw TypeError(e+" is not a symbol!");for(var t in j)if(j[t]===e)return t},useSetter:function(){Z=!0},useSimple:function(){Z=!1}}),s(s.S+s.F*!q,"Object",{create:function(e,t){return void 0===t?T(e):Y(T(e),t)},defineProperty:J,defineProperties:Y,getOwnPropertyDescriptor:X,getOwnPropertyNames:ee,getOwnPropertySymbols:te});var se=u((function(){I.f(1)}));s(s.S+s.F*se,"Object",{getOwnPropertySymbols:function(e){return I.f(E(e))}}),L&&s(s.S+s.F*(!q||u((function(){var e=P();return"[null]"!=D([e])||"{}"!=D({a:e})||"{}"!=D(Object(e))}))),"JSON",{stringify:function(e){for(var t,r,n=[e],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=t=n[1],(b(t)||void 0!==e)&&!W(e))return v(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!W(t))return t}),n[1]=t,D.apply(L,n)}}),P[M][B]||r(98442)(P[M],B,P[M].valueOf),d(P,"Symbol"),d(Math,"Math",!0),d(n.JSON,"JSON",!0)},63315:(e,t,r)=>{"use strict";var n=r(35366),i=r(67728),o=r(29895),s=r(59719),a=r(15044),c=r(61838),u=r(17481),l=r(56341).ArrayBuffer,d=r(59789),h=o.ArrayBuffer,f=o.DataView,p=i.ABV&&l.isView,m=h.prototype.slice,g=i.VIEW,v="ArrayBuffer";n(n.G+n.W+n.F*(l!==h),{ArrayBuffer:h}),n(n.S+n.F*!i.CONSTR,v,{isView:function(e){return p&&p(e)||u(e)&&g in e}}),n(n.P+n.U+n.F*r(71240)((function(){return!new h(2).slice(1,void 0).byteLength})),v,{slice:function(e,t){if(void 0!==m&&void 0===t)return m.call(s(this),e);for(var r=s(this).byteLength,n=a(e,r),i=a(void 0===t?r:t,r),o=new(d(this,h))(c(i-n)),u=new f(this),l=new f(o),p=0;n<i;)l.setUint8(p++,u.getUint8(n++));return o}}),r(75993)(v)},12920:(e,t,r)=>{var n=r(35366);n(n.G+n.W+n.F*!r(67728).ABV,{DataView:r(29895).DataView})},30951:(e,t,r)=>{r(58754)("Float32",4,(function(e){return function(t,r,n){return e(this,t,r,n)}}))},10029:(e,t,r)=>{r(58754)("Float64",8,(function(e){return function(t,r,n){return e(this,t,r,n)}}))},76935:(e,t,r)=>{r(58754)("Int16",2,(function(e){return function(t,r,n){return e(this,t,r,n)}}))},56403:(e,t,r)=>{r(58754)("Int32",4,(function(e){return function(t,r,n){return e(this,t,r,n)}}))},95443:(e,t,r)=>{r(58754)("Int8",1,(function(e){return function(t,r,n){return e(this,t,r,n)}}))},17846:(e,t,r)=>{r(58754)("Uint16",2,(function(e){return function(t,r,n){return e(this,t,r,n)}}))},51200:(e,t,r)=>{r(58754)("Uint32",4,(function(e){return function(t,r,n){return e(this,t,r,n)}}))},69815:(e,t,r)=>{r(58754)("Uint8",1,(function(e){return function(t,r,n){return e(this,t,r,n)}}))},43771:(e,t,r)=>{r(58754)("Uint8",1,(function(e){return function(t,r,n){return e(this,t,r,n)}}),!0)},57391:(e,t,r)=>{"use strict";var n,i=r(56341),o=r(66934)(0),s=r(1564),a=r(82153),c=r(49821),u=r(33503),l=r(17481),d=r(91603),h=r(91603),f=!i.ActiveXObject&&"ActiveXObject"in i,p="WeakMap",m=a.getWeak,g=Object.isExtensible,v=u.ufstore,y=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},b={get:function(e){if(l(e)){var t=m(e);return!0===t?v(d(this,p)).get(e):t?t[this._i]:void 0}},set:function(e,t){return u.def(d(this,p),e,t)}},E=e.exports=r(58091)(p,y,b,u,!0,!0);h&&f&&(c((n=u.getConstructor(y,p)).prototype,b),a.NEED=!0,o(["delete","has","get","set"],(function(e){var t=E.prototype,r=t[e];s(t,e,(function(t,i){if(l(t)&&!g(t)){this._f||(this._f=new n);var o=this._f[e](t,i);return"set"==e?this:o}return r.call(this,t,i)}))})))},33307:(e,t,r)=>{"use strict";var n=r(33503),i=r(91603),o="WeakSet";r(58091)(o,(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return n.def(i(this,o),e,!0)}},n,!1,!0)},98125:(e,t,r)=>{"use strict";var n=r(35366),i=r(3885),o=r(54200),s=r(61838),a=r(23079),c=r(44087);n(n.P,"Array",{flatMap:function(e){var t,r,n=o(this);return a(e),t=s(n.length),r=c(n,0),i(r,n,n,t,0,1,e,arguments[1]),r}}),r(12802)("flatMap")},49348:(e,t,r)=>{"use strict";var n=r(35366),i=r(61545)(!0);n(n.P,"Array",{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r(12802)("includes")},1768:(e,t,r)=>{var n=r(35366),i=r(15346)(!0);n(n.S,"Object",{entries:function(e){return i(e)}})},59223:(e,t,r)=>{var n=r(35366),i=r(17285),o=r(8500),s=r(57762),a=r(51676);n(n.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,r,n=o(e),c=s.f,u=i(n),l={},d=0;u.length>d;)void 0!==(r=c(n,t=u[d++]))&&a(l,t,r);return l}})},67442:(e,t,r)=>{var n=r(35366),i=r(15346)(!1);n(n.S,"Object",{values:function(e){return i(e)}})},14936:(e,t,r)=>{"use strict";var n=r(35366),i=r(14411),o=r(56341),s=r(59789),a=r(38614);n(n.P+n.R,"Promise",{finally:function(e){var t=s(this,i.Promise||o.Promise),r="function"==typeof e;return this.then(r?function(r){return a(t,e()).then((function(){return r}))}:e,r?function(r){return a(t,e()).then((function(){throw r}))}:e)}})},20239:(e,t,r)=>{"use strict";var n=r(35366),i=r(9823),o=r(83843),s=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);n(n.P+n.F*s,"String",{padEnd:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!1)}})},28755:(e,t,r)=>{"use strict";var n=r(35366),i=r(9823),o=r(83843),s=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);n(n.P+n.F*s,"String",{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},53412:(e,t,r)=>{"use strict";r(97370)("trimLeft",(function(e){return function(){return e(this,1)}}),"trimStart")},66948:(e,t,r)=>{"use strict";r(97370)("trimRight",(function(e){return function(){return e(this,2)}}),"trimEnd")},78284:(e,t,r)=>{r(48155)("asyncIterator")},78745:(e,t,r)=>{for(var n=r(71308),i=r(15825),o=r(1564),s=r(56341),a=r(98442),c=r(4919),u=r(9739),l=u("iterator"),d=u("toStringTag"),h=c.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=i(f),m=0;m<p.length;m++){var g,v=p[m],y=f[v],b=s[v],E=b&&b.prototype;if(E&&(E[l]||a(E,l,h),E[d]||a(E,d,v),c[v]=h,y))for(g in n)E[g]||o(E,g,n[g],!0)}},60025:(e,t,r)=>{var n=r(35366),i=r(7122);n(n.G+n.B,{setImmediate:i.set,clearImmediate:i.clear})},51629:(e,t,r)=>{var n=r(56341),i=r(35366),o=r(83843),s=[].slice,a=/MSIE .\./.test(o),c=function(e){return function(t,r){var n=arguments.length>2,i=!!n&&s.call(arguments,2);return e(n?function(){("function"==typeof t?t:Function(t)).apply(this,i)}:t,r)}};i(i.G+i.B+i.F*a,{setTimeout:c(n.setTimeout),setInterval:c(n.setInterval)})},1523:(e,t,r)=>{r(51629),r(60025),r(78745),e.exports=r(14411)},52928:e=>{var t=function(e){"use strict";var t,r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var o=t&&t.prototype instanceof v?t:v,s=Object.create(o.prototype),a=new k(n||[]);return i(s,"_invoke",{value:A(e,r,a)}),s}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var h="suspendedStart",f="suspendedYield",p="executing",m="completed",g={};function v(){}function y(){}function b(){}var E={};u(E,s,(function(){return this}));var w=Object.getPrototypeOf,S=w&&w(w(O([])));S&&S!==r&&n.call(S,s)&&(E=S);var _=b.prototype=v.prototype=Object.create(E);function T(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function r(i,o,s,a){var c=d(e[i],e,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==typeof l&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,a)}),(function(e){r("throw",e,s,a)})):t.resolve(l).then((function(e){u.value=e,s(u)}),(function(e){return r("throw",e,s,a)}))}a(c.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function A(e,t,r){var n=h;return function(i,o){if(n===p)throw new Error("Generator is already running");if(n===m){if("throw"===i)throw o;return N()}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=I(s,r);if(a){if(a===g)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===h)throw n=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=p;var c=d(e,t,r);if("normal"===c.type){if(n=r.done?m:f,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=m,r.method="throw",r.arg=c.arg)}}}function I(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,I(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=d(i,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var s=o.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function O(e){if(e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}return{next:N}}function N(){return{value:t,done:!0}}return y.prototype=b,i(_,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:y,configurable:!0}),y.displayName=u(b,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,c,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},T(x.prototype),u(x.prototype,a,(function(){return this})),e.AsyncIterator=x,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var s=new x(l(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},T(_),u(_,c,"Generator"),u(_,s,(function(){return this})),u(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=O,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return a.type="throw",a.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=n.call(s,"catchLoc"),u=n.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;R(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:O(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},50176:(e,t,r)=>{r(79169),r(63090),e.exports=r(63093).Array.from},70964:(e,t,r)=>{r(48901),e.exports=r(63093).Array.isArray},76216:(e,t,r)=>{r(78175),e.exports=r(63093).Date.now},23565:(e,t,r)=>{var n=r(63093),i=n.JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return i.stringify.apply(i,arguments)}},94175:(e,t,r)=>{r(56536),r(79169),r(39361),r(99228),r(90401),r(28878),r(33012),e.exports=r(63093).Map},86337:(e,t,r)=>{r(14211),e.exports=r(63093).Number.isInteger},68080:(e,t,r)=>{r(57044),e.exports=r(63093).Number.isNaN},68207:(e,t,r)=>{r(82464),e.exports=r(63093).Object.assign},25380:(e,t,r)=>{r(97660);var n=r(63093).Object;e.exports=function(e,t){return n.create(e,t)}},99848:(e,t,r)=>{r(84521);var n=r(63093).Object;e.exports=function(e,t){return n.defineProperties(e,t)}},82624:(e,t,r)=>{r(15356);var n=r(63093).Object;e.exports=function(e,t,r){return n.defineProperty(e,t,r)}},88058:(e,t,r)=>{r(39827),e.exports=r(63093).Object.entries},36759:(e,t,r)=>{r(8638),e.exports=r(63093).Object.freeze},44221:(e,t,r)=>{r(52812);var n=r(63093).Object;e.exports=function(e,t){return n.getOwnPropertyDescriptor(e,t)}},22991:(e,t,r)=>{r(40342),e.exports=r(63093).Object.getOwnPropertyDescriptors},72818:(e,t,r)=>{r(15898),e.exports=r(63093).Object.getOwnPropertySymbols},87595:(e,t,r)=>{r(92810),e.exports=r(63093).Object.getPrototypeOf},15297:(e,t,r)=>{r(5338),e.exports=r(63093).Object.keys},21900:(e,t,r)=>{r(99269),e.exports=r(63093).Object.setPrototypeOf},42837:(e,t,r)=>{r(73625),e.exports=r(63093).Object.values},16111:(e,t,r)=>{r(68785),e.exports=r(63093).parseInt},89448:(e,t,r)=>{r(56536),r(79169),r(39361),r(63723),r(36556),r(8421),e.exports=r(63093).Promise},58564:(e,t,r)=>{r(41896),e.exports=r(63093).Reflect.apply},98401:(e,t,r)=>{r(90634),e.exports=r(63093).Reflect.construct},53268:(e,t,r)=>{r(51244),e.exports=r(63093).Reflect.defineProperty},76409:(e,t,r)=>{r(16877),e.exports=r(63093).Reflect.deleteProperty},46383:(e,t,r)=>{r(39181),e.exports=r(63093).Reflect.getOwnPropertyDescriptor},42437:(e,t,r)=>{r(69805),e.exports=r(63093).Reflect.get},98828:(e,t,r)=>{r(56536),r(79169),r(39361),r(6348),r(30093),r(42235),r(68572),e.exports=r(63093).Set},71922:(e,t,r)=>{r(15898),r(56536),r(52145),r(74775),e.exports=r(63093).Symbol},72974:(e,t,r)=>{r(79169),r(39361),e.exports=r(33485).f("iterator")},90446:(e,t,r)=>{e.exports=r(33485).f("toPrimitive")},69488:(e,t,r)=>{r(56536),r(39361),r(11610),r(91877),r(20206),e.exports=r(63093).WeakMap},18679:e=>{e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},86687:e=>{e.exports=function(){}},8003:e=>{e.exports=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e}},49226:(e,t,r)=>{var n=r(44425);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},51705:(e,t,r)=>{var n=r(26510);e.exports=function(e,t){var r=[];return n(e,!1,r.push,r,t),r}},43206:(e,t,r)=>{var n=r(6303),i=r(45321),o=r(10139);e.exports=function(e){return function(t,r,s){var a,c=n(t),u=i(c.length),l=o(s,u);if(e&&r!=r){for(;u>l;)if((a=c[l++])!=a)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===r)return e||l||0;return!e&&-1}}},18485:(e,t,r)=>{var n=r(31133),i=r(65474),o=r(54922),s=r(45321),a=r(243);e.exports=function(e,t){var r=1==e,c=2==e,u=3==e,l=4==e,d=6==e,h=5==e||d,f=t||a;return function(t,a,p){for(var m,g,v=o(t),y=i(v),b=n(a,p,3),E=s(y.length),w=0,S=r?f(t,E):c?f(t,0):void 0;E>w;w++)if((h||w in y)&&(g=b(m=y[w],w,v),e))if(r)S[w]=g;else if(g)switch(e){case 3:return!0;case 5:return m;case 6:return w;case 2:S.push(m)}else if(l)return!1;return d?-1:u||l?l:S}}},33723:(e,t,r)=>{var n=r(44425),i=r(35730),o=r(23032)("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),n(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},243:(e,t,r)=>{var n=r(33723);e.exports=function(e,t){return new(n(e))(t)}},98659:(e,t,r)=>{"use strict";var n=r(18679),i=r(44425),o=r(44990),s=[].slice,a={};e.exports=Function.bind||function(e){var t=n(this),r=s.call(arguments,1),c=function(){var n=r.concat(s.call(arguments));return this instanceof c?function(e,t,r){if(!(t in a)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";a[t]=Function("F,a","return new F("+n.join(",")+")")}return a[t](e,r)}(t,n.length,n):o(t,n,e)};return i(t.prototype)&&(c.prototype=t.prototype),c}},85158:(e,t,r)=>{var n=r(47489),i=r(23032)("toStringTag"),o="Arguments"==n(function(){return arguments}());e.exports=function(e){var t,r,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?r:o?n(t):"Object"==(s=n(t))&&"function"==typeof t.callee?"Arguments":s}},47489:e=>{var t={}.toString;e.exports=function(e){return t.call(e).slice(8,-1)}},21706:(e,t,r)=>{"use strict";var n=r(56007).f,i=r(69270),o=r(561),s=r(31133),a=r(8003),c=r(26510),u=r(60354),l=r(85490),d=r(7183),h=r(97305),f=r(57010).fastKey,p=r(10069),m=h?"_s":"size",g=function(e,t){var r,n=f(t);if("F"!==n)return e._i[n];for(r=e._f;r;r=r.n)if(r.k==t)return r};e.exports={getConstructor:function(e,t,r,u){var l=e((function(e,n){a(e,l,t,"_i"),e._t=t,e._i=i(null),e._f=void 0,e._l=void 0,e[m]=0,null!=n&&c(n,r,e[u],e)}));return o(l.prototype,{clear:function(){for(var e=p(this,t),r=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];e._f=e._l=void 0,e[m]=0},delete:function(e){var r=p(this,t),n=g(r,e);if(n){var i=n.n,o=n.p;delete r._i[n.i],n.r=!0,o&&(o.n=i),i&&(i.p=o),r._f==n&&(r._f=i),r._l==n&&(r._l=o),r[m]--}return!!n},forEach:function(e){p(this,t);for(var r,n=s(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!g(p(this,t),e)}}),h&&n(l.prototype,"size",{get:function(){return p(this,t)[m]}}),l},def:function(e,t,r){var n,i,o=g(e,t);return o?o.v=r:(e._l=o={i:i=f(t,!0),k:t,v:r,p:n=e._l,n:void 0,r:!1},e._f||(e._f=o),n&&(n.n=o),e[m]++,"F"!==i&&(e._i[i]=o)),e},getEntry:g,setStrong:function(e,t,r){u(e,t,(function(e,r){this._t=p(e,t),this._k=r,this._l=void 0}),(function(){for(var e=this,t=e._k,r=e._l;r&&r.r;)r=r.p;return e._t&&(e._l=r=r?r.n:e._t._f)?l(0,"keys"==t?r.k:"values"==t?r.v:[r.k,r.v]):(e._t=void 0,l(1))}),r?"entries":"values",!r,!0),d(t)}}},80540:(e,t,r)=>{var n=r(85158),i=r(51705);e.exports=function(e){return function(){if(n(this)!=e)throw TypeError(e+"#toJSON isn't generic");return i(this)}}},77760:(e,t,r)=>{"use strict";var n=r(561),i=r(57010).getWeak,o=r(49226),s=r(44425),a=r(8003),c=r(26510),u=r(18485),l=r(3920),d=r(10069),h=u(5),f=u(6),p=0,m=function(e){return e._l||(e._l=new g)},g=function(){this.a=[]},v=function(e,t){return h(e.a,(function(e){return e[0]===t}))};g.prototype={get:function(e){var t=v(this,e);if(t)return t[1]},has:function(e){return!!v(this,e)},set:function(e,t){var r=v(this,e);r?r[1]=t:this.a.push([e,t])},delete:function(e){var t=f(this.a,(function(t){return t[0]===e}));return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,r,o){var u=e((function(e,n){a(e,u,t,"_i"),e._t=t,e._i=p++,e._l=void 0,null!=n&&c(n,r,e[o],e)}));return n(u.prototype,{delete:function(e){if(!s(e))return!1;var r=i(e);return!0===r?m(d(this,t)).delete(e):r&&l(r,this._i)&&delete r[this._i]},has:function(e){if(!s(e))return!1;var r=i(e);return!0===r?m(d(this,t)).has(e):r&&l(r,this._i)}}),u},def:function(e,t,r){var n=i(o(t),!0);return!0===n?m(e).set(t,r):n[e._i]=r,e},ufstore:m}},66924:(e,t,r)=>{"use strict";var n=r(3220),i=r(14518),o=r(57010),s=r(84930),a=r(44379),c=r(561),u=r(26510),l=r(8003),d=r(44425),h=r(8182),f=r(56007).f,p=r(18485)(0),m=r(97305);e.exports=function(e,t,r,g,v,y){var b=n[e],E=b,w=v?"set":"add",S=E&&E.prototype,_={};return m&&"function"==typeof E&&(y||S.forEach&&!s((function(){(new E).entries().next()})))?(E=t((function(t,r){l(t,E,e,"_c"),t._c=new b,null!=r&&u(r,v,t[w],t)})),p("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),(function(e){var t="add"==e||"set"==e;!(e in S)||y&&"clear"==e||a(E.prototype,e,(function(r,n){if(l(this,E,e),!t&&y&&!d(r))return"get"==e&&void 0;var i=this._c[e](0===r?0:r,n);return t?this:i}))})),y||f(E.prototype,"size",{get:function(){return this._c.size}})):(E=g.getConstructor(t,e,v,w),c(E.prototype,r),o.NEED=!0),h(E,e),_[e]=E,i(i.G+i.W+i.F,_),y||g.setStrong(E,e,v),E}},63093:e=>{var t=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=t)},10101:(e,t,r)=>{"use strict";var n=r(56007),i=r(35831);e.exports=function(e,t,r){t in e?n.f(e,t,i(0,r)):e[t]=r}},31133:(e,t,r)=>{var n=r(18679);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}}},59359:e=>{e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},97305:(e,t,r)=>{e.exports=!r(84930)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},3299:(e,t,r)=>{var n=r(44425),i=r(3220).document,o=n(i)&&n(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},75834:e=>{e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},94331:(e,t,r)=>{var n=r(31304),i=r(18382),o=r(55066);e.exports=function(e){var t=n(e),r=i.f;if(r)for(var s,a=r(e),c=o.f,u=0;a.length>u;)c.call(e,s=a[u++])&&t.push(s);return t}},14518:(e,t,r)=>{var n=r(3220),i=r(63093),o=r(31133),s=r(44379),a=r(3920),c="prototype",u=function(e,t,r){var l,d,h,f=e&u.F,p=e&u.G,m=e&u.S,g=e&u.P,v=e&u.B,y=e&u.W,b=p?i:i[t]||(i[t]={}),E=b[c],w=p?n:m?n[t]:(n[t]||{})[c];for(l in p&&(r=t),r)(d=!f&&w&&void 0!==w[l])&&a(b,l)||(h=d?w[l]:r[l],b[l]=p&&"function"!=typeof w[l]?r[l]:v&&d?o(h,n):y&&w[l]==h?function(e){var t=function(t,r,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,n)}return e.apply(this,arguments)};return t[c]=e[c],t}(h):g&&"function"==typeof h?o(Function.call,h):h,g&&((b.virtual||(b.virtual={}))[l]=h,e&u.R&&E&&!E[l]&&s(E,l,h)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},84930:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},26510:(e,t,r)=>{var n=r(31133),i=r(12441),o=r(92566),s=r(49226),a=r(45321),c=r(25816),u={},l={},d=e.exports=function(e,t,r,d,h){var f,p,m,g,v=h?function(){return e}:c(e),y=n(r,d,t?2:1),b=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(o(v)){for(f=a(e.length);f>b;b++)if((g=t?y(s(p=e[b])[0],p[1]):y(e[b]))===u||g===l)return g}else for(m=v.call(e);!(p=m.next()).done;)if((g=i(m,y,p.value,t))===u||g===l)return g};d.BREAK=u,d.RETURN=l},3220:e=>{var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)},3920:e=>{var t={}.hasOwnProperty;e.exports=function(e,r){return t.call(e,r)}},44379:(e,t,r)=>{var n=r(56007),i=r(35831);e.exports=r(97305)?function(e,t,r){return n.f(e,t,i(1,r))}:function(e,t,r){return e[t]=r,e}},588:(e,t,r)=>{var n=r(3220).document;e.exports=n&&n.documentElement},17209:(e,t,r)=>{e.exports=!r(97305)&&!r(84930)((function(){return 7!=Object.defineProperty(r(3299)("div"),"a",{get:function(){return 7}}).a}))},44990:e=>{e.exports=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},65474:(e,t,r)=>{var n=r(47489);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},92566:(e,t,r)=>{var n=r(64502),i=r(23032)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||o[i]===e)}},35730:(e,t,r)=>{var n=r(47489);e.exports=Array.isArray||function(e){return"Array"==n(e)}},58015:(e,t,r)=>{var n=r(44425),i=Math.floor;e.exports=function(e){return!n(e)&&isFinite(e)&&i(e)===e}},44425:e=>{e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},12441:(e,t,r)=>{var n=r(49226);e.exports=function(e,t,r,i){try{return i?t(n(r)[0],r[1]):t(r)}catch(t){var o=e.return;throw void 0!==o&&n(o.call(e)),t}}},95415:(e,t,r)=>{"use strict";var n=r(69270),i=r(35831),o=r(8182),s={};r(44379)(s,r(23032)("iterator"),(function(){return this})),e.exports=function(e,t,r){e.prototype=n(s,{next:i(1,r)}),o(e,t+" Iterator")}},60354:(e,t,r)=>{"use strict";var n=r(34436),i=r(14518),o=r(29763),s=r(44379),a=r(64502),c=r(95415),u=r(8182),l=r(65194),d=r(23032)("iterator"),h=!([].keys&&"next"in[].keys()),f="keys",p="values",m=function(){return this};e.exports=function(e,t,r,g,v,y,b){c(r,t,g);var E,w,S,_=function(e){if(!h&&e in I)return I[e];switch(e){case f:case p:return function(){return new r(this,e)}}return function(){return new r(this,e)}},T=t+" Iterator",x=v==p,A=!1,I=e.prototype,C=I[d]||I["@@iterator"]||v&&I[v],R=C||_(v),k=v?x?_("entries"):R:void 0,O="Array"==t&&I.entries||C;if(O&&(S=l(O.call(new e)))!==Object.prototype&&S.next&&(u(S,T,!0),n||"function"==typeof S[d]||s(S,d,m)),x&&C&&C.name!==p&&(A=!0,R=function(){return C.call(this)}),n&&!b||!h&&!A&&I[d]||s(I,d,R),a[t]=R,a[T]=m,v)if(E={values:x?R:_(p),keys:y?R:_(f),entries:k},b)for(w in E)w in I||o(I,w,E[w]);else i(i.P+i.F*(h||A),t,E);return E}},98661:(e,t,r)=>{var n=r(23032)("iterator"),i=!1;try{var o=[7][n]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var r=!1;try{var o=[7],s=o[n]();s.next=function(){return{done:r=!0}},o[n]=function(){return s},e(o)}catch(e){}return r}},85490:e=>{e.exports=function(e,t){return{value:t,done:!!e}}},64502:e=>{e.exports={}},34436:e=>{e.exports=!0},57010:(e,t,r)=>{var n=r(46918)("meta"),i=r(44425),o=r(3920),s=r(56007).f,a=0,c=Object.isExtensible||function(){return!0},u=!r(84930)((function(){return c(Object.preventExtensions({}))})),l=function(e){s(e,n,{value:{i:"O"+ ++a,w:{}}})},d=e.exports={KEY:n,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,n)){if(!c(e))return"F";if(!t)return"E";l(e)}return e[n].i},getWeak:function(e,t){if(!o(e,n)){if(!c(e))return!0;if(!t)return!1;l(e)}return e[n].w},onFreeze:function(e){return u&&d.NEED&&c(e)&&!o(e,n)&&l(e),e}}},9734:(e,t,r)=>{var n=r(3220),i=r(26998).set,o=n.MutationObserver||n.WebKitMutationObserver,s=n.process,a=n.Promise,c="process"==r(47489)(s);e.exports=function(){var e,t,r,u=function(){var n,i;for(c&&(n=s.domain)&&n.exit();e;){i=e.fn,e=e.next;try{i()}catch(n){throw e?r():t=void 0,n}}t=void 0,n&&n.enter()};if(c)r=function(){s.nextTick(u)};else if(!o||n.navigator&&n.navigator.standalone)if(a&&a.resolve){var l=a.resolve(void 0);r=function(){l.then(u)}}else r=function(){i.call(n,u)};else{var d=!0,h=document.createTextNode("");new o(u).observe(h,{characterData:!0}),r=function(){h.data=d=!d}}return function(n){var i={fn:n,next:void 0};t&&(t.next=i),e||(e=i,r()),t=i}}},36253:(e,t,r)=>{"use strict";var n=r(18679);function i(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n})),this.resolve=n(t),this.reject=n(r)}e.exports.f=function(e){return new i(e)}},47382:(e,t,r)=>{"use strict";var n=r(97305),i=r(31304),o=r(18382),s=r(55066),a=r(54922),c=r(65474),u=Object.assign;e.exports=!u||r(84930)((function(){var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach((function(e){t[e]=e})),7!=u({},e)[r]||Object.keys(u({},t)).join("")!=n}))?function(e,t){for(var r=a(e),u=arguments.length,l=1,d=o.f,h=s.f;u>l;)for(var f,p=c(arguments[l++]),m=d?i(p).concat(d(p)):i(p),g=m.length,v=0;g>v;)f=m[v++],n&&!h.call(p,f)||(r[f]=p[f]);return r}:u},69270:(e,t,r)=>{var n=r(49226),i=r(16287),o=r(75834),s=r(72596)("IE_PROTO"),a=function(){},c="prototype",u=function(){var e,t=r(3299)("iframe"),n=o.length;for(t.style.display="none",r(588).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),u=e.F;n--;)delete u[c][o[n]];return u()};e.exports=Object.create||function(e,t){var r;return null!==e?(a[c]=n(e),r=new a,a[c]=null,r[s]=e):r=u(),void 0===t?r:i(r,t)}},56007:(e,t,r)=>{var n=r(49226),i=r(17209),o=r(32548),s=Object.defineProperty;t.f=r(97305)?Object.defineProperty:function(e,t,r){if(n(e),t=o(t,!0),n(r),i)try{return s(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},16287:(e,t,r)=>{var n=r(56007),i=r(49226),o=r(31304);e.exports=r(97305)?Object.defineProperties:function(e,t){i(e);for(var r,s=o(t),a=s.length,c=0;a>c;)n.f(e,r=s[c++],t[r]);return e}},30826:(e,t,r)=>{var n=r(55066),i=r(35831),o=r(6303),s=r(32548),a=r(3920),c=r(17209),u=Object.getOwnPropertyDescriptor;t.f=r(97305)?u:function(e,t){if(e=o(e),t=s(t,!0),c)try{return u(e,t)}catch(e){}if(a(e,t))return i(!n.f.call(e,t),e[t])}},23208:(e,t,r)=>{var n=r(6303),i=r(95733).f,o={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return s&&"[object Window]"==o.call(e)?function(e){try{return i(e)}catch(e){return s.slice()}}(e):i(n(e))}},95733:(e,t,r)=>{var n=r(26567),i=r(75834).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,i)}},18382:(e,t)=>{t.f=Object.getOwnPropertySymbols},65194:(e,t,r)=>{var n=r(3920),i=r(54922),o=r(72596)("IE_PROTO"),s=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),n(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?s:null}},26567:(e,t,r)=>{var n=r(3920),i=r(6303),o=r(43206)(!1),s=r(72596)("IE_PROTO");e.exports=function(e,t){var r,a=i(e),c=0,u=[];for(r in a)r!=s&&n(a,r)&&u.push(r);for(;t.length>c;)n(a,r=t[c++])&&(~o(u,r)||u.push(r));return u}},31304:(e,t,r)=>{var n=r(26567),i=r(75834);e.exports=Object.keys||function(e){return n(e,i)}},55066:(e,t)=>{t.f={}.propertyIsEnumerable},70874:(e,t,r)=>{var n=r(14518),i=r(63093),o=r(84930);e.exports=function(e,t){var r=(i.Object||{})[e]||Object[e],s={};s[e]=t(r),n(n.S+n.F*o((function(){r(1)})),"Object",s)}},30572:(e,t,r)=>{var n=r(97305),i=r(31304),o=r(6303),s=r(55066).f;e.exports=function(e){return function(t){for(var r,a=o(t),c=i(a),u=c.length,l=0,d=[];u>l;)r=c[l++],n&&!s.call(a,r)||d.push(e?[r,a[r]]:a[r]);return d}}},74737:(e,t,r)=>{var n=r(95733),i=r(18382),o=r(49226),s=r(3220).Reflect;e.exports=s&&s.ownKeys||function(e){var t=n.f(o(e)),r=i.f;return r?t.concat(r(e)):t}},24049:(e,t,r)=>{var n=r(3220).parseInt,i=r(28685).trim,o=r(58917),s=/^[-+]?0[xX]/;e.exports=8!==n(o+"08")||22!==n(o+"0x16")?function(e,t){var r=i(String(e),3);return n(r,t>>>0||(s.test(r)?16:10))}:n},19934:e=>{e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},77116:(e,t,r)=>{var n=r(49226),i=r(44425),o=r(36253);e.exports=function(e,t){if(n(e),i(t)&&t.constructor===e)return t;var r=o.f(e);return(0,r.resolve)(t),r.promise}},35831:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},561:(e,t,r)=>{var n=r(44379);e.exports=function(e,t,r){for(var i in t)r&&e[i]?e[i]=t[i]:n(e,i,t[i]);return e}},29763:(e,t,r)=>{e.exports=r(44379)},74573:(e,t,r)=>{"use strict";var n=r(14518),i=r(18679),o=r(31133),s=r(26510);e.exports=function(e){n(n.S,e,{from:function(e){var t,r,n,a,c=arguments[1];return i(this),(t=void 0!==c)&&i(c),null==e?new this:(r=[],t?(n=0,a=o(c,arguments[2],2),s(e,!1,(function(e){r.push(a(e,n++))}))):s(e,!1,r.push,r),new this(r))}})}},72758:(e,t,r)=>{"use strict";var n=r(14518);e.exports=function(e){n(n.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},96573:(e,t,r)=>{var n=r(44425),i=r(49226),o=function(e,t){if(i(e),!n(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,n){try{(n=r(31133)(Function.call,r(30826).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,r){return o(e,r),t?e.__proto__=r:n(e,r),e}}({},!1):void 0),check:o}},7183:(e,t,r)=>{"use strict";var n=r(3220),i=r(63093),o=r(56007),s=r(97305),a=r(23032)("species");e.exports=function(e){var t="function"==typeof i[e]?i[e]:n[e];s&&t&&!t[a]&&o.f(t,a,{configurable:!0,get:function(){return this}})}},8182:(e,t,r)=>{var n=r(56007).f,i=r(3920),o=r(23032)("toStringTag");e.exports=function(e,t,r){e&&!i(e=r?e:e.prototype,o)&&n(e,o,{configurable:!0,value:t})}},72596:(e,t,r)=>{var n=r(5628)("keys"),i=r(46918);e.exports=function(e){return n[e]||(n[e]=i(e))}},5628:(e,t,r)=>{var n=r(63093),i=r(3220),o="__core-js_shared__",s=i[o]||(i[o]={});(e.exports=function(e,t){return s[e]||(s[e]=void 0!==t?t:{})})("versions",[]).push({version:n.version,mode:r(34436)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},312:(e,t,r)=>{var n=r(49226),i=r(18679),o=r(23032)("species");e.exports=function(e,t){var r,s=n(e).constructor;return void 0===s||null==(r=n(s)[o])?t:i(r)}},87268:(e,t,r)=>{var n=r(72579),i=r(59359);e.exports=function(e){return function(t,r){var o,s,a=String(i(t)),c=n(r),u=a.length;return c<0||c>=u?e?"":void 0:(o=a.charCodeAt(c))<55296||o>56319||c+1===u||(s=a.charCodeAt(c+1))<56320||s>57343?e?a.charAt(c):o:e?a.slice(c,c+2):s-56320+(o-55296<<10)+65536}}},28685:(e,t,r)=>{var n=r(14518),i=r(59359),o=r(84930),s=r(58917),a="["+s+"]",c=RegExp("^"+a+a+"*"),u=RegExp(a+a+"*$"),l=function(e,t,r){var i={},a=o((function(){return!!s[e]()||"​"!="​"[e]()})),c=i[e]=a?t(d):s[e];r&&(i[r]=c),n(n.P+n.F*a,"String",i)},d=l.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(u,"")),e};e.exports=l},58917:e=>{e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},26998:(e,t,r)=>{var n,i,o,s=r(31133),a=r(44990),c=r(588),u=r(3299),l=r(3220),d=l.process,h=l.setImmediate,f=l.clearImmediate,p=l.MessageChannel,m=l.Dispatch,g=0,v={},y="onreadystatechange",b=function(){var e=+this;if(v.hasOwnProperty(e)){var t=v[e];delete v[e],t()}},E=function(e){b.call(e.data)};h&&f||(h=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return v[++g]=function(){a("function"==typeof e?e:Function(e),t)},n(g),g},f=function(e){delete v[e]},"process"==r(47489)(d)?n=function(e){d.nextTick(s(b,e,1))}:m&&m.now?n=function(e){m.now(s(b,e,1))}:p?(o=(i=new p).port2,i.port1.onmessage=E,n=s(o.postMessage,o,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(n=function(e){l.postMessage(e+"","*")},l.addEventListener("message",E,!1)):n=y in u("script")?function(e){c.appendChild(u("script"))[y]=function(){c.removeChild(this),b.call(e)}}:function(e){setTimeout(s(b,e,1),0)}),e.exports={set:h,clear:f}},10139:(e,t,r)=>{var n=r(72579),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=n(e))<0?i(e+t,0):o(e,t)}},72579:e=>{var t=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:t)(e)}},6303:(e,t,r)=>{var n=r(65474),i=r(59359);e.exports=function(e){return n(i(e))}},45321:(e,t,r)=>{var n=r(72579),i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},54922:(e,t,r)=>{var n=r(59359);e.exports=function(e){return Object(n(e))}},32548:(e,t,r)=>{var n=r(44425);e.exports=function(e,t){if(!n(e))return e;var r,i;if(t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;if("function"==typeof(r=e.valueOf)&&!n(i=r.call(e)))return i;if(!t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},46918:e=>{var t=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++t+r).toString(36))}},58411:(e,t,r)=>{var n=r(3220).navigator;e.exports=n&&n.userAgent||""},10069:(e,t,r)=>{var n=r(44425);e.exports=function(e,t){if(!n(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},10305:(e,t,r)=>{var n=r(3220),i=r(63093),o=r(34436),s=r(33485),a=r(56007).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=o?{}:n.Symbol||{});"_"==e.charAt(0)||e in t||a(t,e,{value:s.f(e)})}},33485:(e,t,r)=>{t.f=r(23032)},23032:(e,t,r)=>{var n=r(5628)("wks"),i=r(46918),o=r(3220).Symbol,s="function"==typeof o;(e.exports=function(e){return n[e]||(n[e]=s&&o[e]||(s?o:i)("Symbol."+e))}).store=n},25816:(e,t,r)=>{var n=r(85158),i=r(23032)("iterator"),o=r(64502);e.exports=r(63093).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[n(e)]}},63090:(e,t,r)=>{"use strict";var n=r(31133),i=r(14518),o=r(54922),s=r(12441),a=r(92566),c=r(45321),u=r(10101),l=r(25816);i(i.S+i.F*!r(98661)((function(e){Array.from(e)})),"Array",{from:function(e){var t,r,i,d,h=o(e),f="function"==typeof this?this:Array,p=arguments.length,m=p>1?arguments[1]:void 0,g=void 0!==m,v=0,y=l(h);if(g&&(m=n(m,p>2?arguments[2]:void 0,2)),null==y||f==Array&&a(y))for(r=new f(t=c(h.length));t>v;v++)u(r,v,g?m(h[v],v):h[v]);else for(d=y.call(h),r=new f;!(i=d.next()).done;v++)u(r,v,g?s(d,m,[i.value,v],!0):i.value);return r.length=v,r}})},48901:(e,t,r)=>{var n=r(14518);n(n.S,"Array",{isArray:r(35730)})},74296:(e,t,r)=>{"use strict";var n=r(86687),i=r(85490),o=r(64502),s=r(6303);e.exports=r(60354)(Array,"Array",(function(e,t){this._t=s(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])}),"values"),o.Arguments=o.Array,n("keys"),n("values"),n("entries")},78175:(e,t,r)=>{var n=r(14518);n(n.S,"Date",{now:function(){return(new Date).getTime()}})},99228:(e,t,r)=>{"use strict";var n=r(21706),i=r(10069),o="Map";e.exports=r(66924)(o,(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=n.getEntry(i(this,o),e);return t&&t.v},set:function(e,t){return n.def(i(this,o),0===e?0:e,t)}},n,!0)},14211:(e,t,r)=>{var n=r(14518);n(n.S,"Number",{isInteger:r(58015)})},57044:(e,t,r)=>{var n=r(14518);n(n.S,"Number",{isNaN:function(e){return e!=e}})},82464:(e,t,r)=>{var n=r(14518);n(n.S+n.F,"Object",{assign:r(47382)})},97660:(e,t,r)=>{var n=r(14518);n(n.S,"Object",{create:r(69270)})},84521:(e,t,r)=>{var n=r(14518);n(n.S+n.F*!r(97305),"Object",{defineProperties:r(16287)})},15356:(e,t,r)=>{var n=r(14518);n(n.S+n.F*!r(97305),"Object",{defineProperty:r(56007).f})},8638:(e,t,r)=>{var n=r(44425),i=r(57010).onFreeze;r(70874)("freeze",(function(e){return function(t){return e&&n(t)?e(i(t)):t}}))},52812:(e,t,r)=>{var n=r(6303),i=r(30826).f;r(70874)("getOwnPropertyDescriptor",(function(){return function(e,t){return i(n(e),t)}}))},92810:(e,t,r)=>{var n=r(54922),i=r(65194);r(70874)("getPrototypeOf",(function(){return function(e){return i(n(e))}}))},5338:(e,t,r)=>{var n=r(54922),i=r(31304);r(70874)("keys",(function(){return function(e){return i(n(e))}}))},99269:(e,t,r)=>{var n=r(14518);n(n.S,"Object",{setPrototypeOf:r(96573).set})},56536:()=>{},68785:(e,t,r)=>{var n=r(14518),i=r(24049);n(n.G+n.F*(parseInt!=i),{parseInt:i})},63723:(e,t,r)=>{"use strict";var n,i,o,s,a=r(34436),c=r(3220),u=r(31133),l=r(85158),d=r(14518),h=r(44425),f=r(18679),p=r(8003),m=r(26510),g=r(312),v=r(26998).set,y=r(9734)(),b=r(36253),E=r(19934),w=r(58411),S=r(77116),_="Promise",T=c.TypeError,x=c.process,A=x&&x.versions,I=A&&A.v8||"",C=c[_],R="process"==l(x),k=function(){},O=i=b.f,N=!!function(){try{var e=C.resolve(1),t=(e.constructor={})[r(23032)("species")]=function(e){e(k,k)};return(R||"function"==typeof PromiseRejectionEvent)&&e.then(k)instanceof t&&0!==I.indexOf("6.6")&&-1===w.indexOf("Chrome/66")}catch(e){}}(),P=function(e){var t;return!(!h(e)||"function"!=typeof(t=e.then))&&t},L=function(e,t){if(!e._n){e._n=!0;var r=e._c;y((function(){for(var n=e._v,i=1==e._s,o=0,s=function(t){var r,o,s,a=i?t.ok:t.fail,c=t.resolve,u=t.reject,l=t.domain;try{a?(i||(2==e._h&&U(e),e._h=1),!0===a?r=n:(l&&l.enter(),r=a(n),l&&(l.exit(),s=!0)),r===t.promise?u(T("Promise-chain cycle")):(o=P(r))?o.call(r,c,u):c(r)):u(n)}catch(e){l&&!s&&l.exit(),u(e)}};r.length>o;)s(r[o++]);e._c=[],e._n=!1,t&&!e._h&&D(e)}))}},D=function(e){v.call(c,(function(){var t,r,n,i=e._v,o=M(e);if(o&&(t=E((function(){R?x.emit("unhandledRejection",i,e):(r=c.onunhandledrejection)?r({promise:e,reason:i}):(n=c.console)&&n.error&&n.error("Unhandled promise rejection",i)})),e._h=R||M(e)?2:1),e._a=void 0,o&&t.e)throw t.v}))},M=function(e){return 1!==e._h&&0===(e._a||e._c).length},U=function(e){v.call(c,(function(){var t;R?x.emit("rejectionHandled",e):(t=c.onrejectionhandled)&&t({promise:e,reason:e._v})}))},B=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),L(t,!0))},F=function(e){var t,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw T("Promise can't be resolved itself");(t=P(e))?y((function(){var n={_w:r,_d:!1};try{t.call(e,u(F,n,1),u(B,n,1))}catch(e){B.call(n,e)}})):(r._v=e,r._s=1,L(r,!1))}catch(e){B.call({_w:r,_d:!1},e)}}};N||(C=function(e){p(this,C,_,"_h"),f(e),n.call(this);try{e(u(F,this,1),u(B,this,1))}catch(e){B.call(this,e)}},(n=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=r(561)(C.prototype,{then:function(e,t){var r=O(g(this,C));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=R?x.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&L(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new n;this.promise=e,this.resolve=u(F,e,1),this.reject=u(B,e,1)},b.f=O=function(e){return e===C||e===s?new o(e):i(e)}),d(d.G+d.W+d.F*!N,{Promise:C}),r(8182)(C,_),r(7183)(_),s=r(63093)[_],d(d.S+d.F*!N,_,{reject:function(e){var t=O(this);return(0,t.reject)(e),t.promise}}),d(d.S+d.F*(a||!N),_,{resolve:function(e){return S(a&&this===s?C:this,e)}}),d(d.S+d.F*!(N&&r(98661)((function(e){C.all(e).catch(k)}))),_,{all:function(e){var t=this,r=O(t),n=r.resolve,i=r.reject,o=E((function(){var r=[],o=0,s=1;m(e,!1,(function(e){var a=o++,c=!1;r.push(void 0),s++,t.resolve(e).then((function(e){c||(c=!0,r[a]=e,--s||n(r))}),i)})),--s||n(r)}));return o.e&&i(o.v),r.promise},race:function(e){var t=this,r=O(t),n=r.reject,i=E((function(){m(e,!1,(function(e){t.resolve(e).then(r.resolve,n)}))}));return i.e&&n(i.v),r.promise}})},41896:(e,t,r)=>{var n=r(14518),i=r(18679),o=r(49226),s=(r(3220).Reflect||{}).apply,a=Function.apply;n(n.S+n.F*!r(84930)((function(){s((function(){}))})),"Reflect",{apply:function(e,t,r){var n=i(e),c=o(r);return s?s(n,t,c):a.call(n,t,c)}})},90634:(e,t,r)=>{var n=r(14518),i=r(69270),o=r(18679),s=r(49226),a=r(44425),c=r(84930),u=r(98659),l=(r(3220).Reflect||{}).construct,d=c((function(){function e(){}return!(l((function(){}),[],e)instanceof e)})),h=!c((function(){l((function(){}))}));n(n.S+n.F*(d||h),"Reflect",{construct:function(e,t){o(e),s(t);var r=arguments.length<3?e:o(arguments[2]);if(h&&!d)return l(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(u.apply(e,n))}var c=r.prototype,f=i(a(c)?c:Object.prototype),p=Function.apply.call(e,f,t);return a(p)?p:f}})},51244:(e,t,r)=>{var n=r(56007),i=r(14518),o=r(49226),s=r(32548);i(i.S+i.F*r(84930)((function(){Reflect.defineProperty(n.f({},1,{value:1}),1,{value:2})})),"Reflect",{defineProperty:function(e,t,r){o(e),t=s(t,!0),o(r);try{return n.f(e,t,r),!0}catch(e){return!1}}})},16877:(e,t,r)=>{var n=r(14518),i=r(30826).f,o=r(49226);n(n.S,"Reflect",{deleteProperty:function(e,t){var r=i(o(e),t);return!(r&&!r.configurable)&&delete e[t]}})},39181:(e,t,r)=>{var n=r(30826),i=r(14518),o=r(49226);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return n.f(o(e),t)}})},69805:(e,t,r)=>{var n=r(30826),i=r(65194),o=r(3920),s=r(14518),a=r(44425),c=r(49226);s(s.S,"Reflect",{get:function e(t,r){var s,u,l=arguments.length<3?t:arguments[2];return c(t)===l?t[r]:(s=n.f(t,r))?o(s,"value")?s.value:void 0!==s.get?s.get.call(l):void 0:a(u=i(t))?e(u,r,l):void 0}})},6348:(e,t,r)=>{"use strict";var n=r(21706),i=r(10069);e.exports=r(66924)("Set",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return n.def(i(this,"Set"),e=0===e?0:e,e)}},n)},79169:(e,t,r)=>{"use strict";var n=r(87268)(!0);r(60354)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=n(t,r),this._i+=e.length,{value:e,done:!1})}))},15898:(e,t,r)=>{"use strict";var n=r(3220),i=r(3920),o=r(97305),s=r(14518),a=r(29763),c=r(57010).KEY,u=r(84930),l=r(5628),d=r(8182),h=r(46918),f=r(23032),p=r(33485),m=r(10305),g=r(94331),v=r(35730),y=r(49226),b=r(44425),E=r(54922),w=r(6303),S=r(32548),_=r(35831),T=r(69270),x=r(23208),A=r(30826),I=r(18382),C=r(56007),R=r(31304),k=A.f,O=C.f,N=x.f,P=n.Symbol,L=n.JSON,D=L&&L.stringify,M="prototype",U=f("_hidden"),B=f("toPrimitive"),F={}.propertyIsEnumerable,j=l("symbol-registry"),V=l("symbols"),H=l("op-symbols"),G=Object[M],q="function"==typeof P&&!!I.f,$=n.QObject,Z=!$||!$[M]||!$[M].findChild,z=o&&u((function(){return 7!=T(O({},"a",{get:function(){return O(this,"a",{value:7}).a}})).a}))?function(e,t,r){var n=k(G,t);n&&delete G[t],O(e,t,r),n&&e!==G&&O(G,t,n)}:O,K=function(e){var t=V[e]=T(P[M]);return t._k=e,t},W=q&&"symbol"==typeof P.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof P},J=function(e,t,r){return e===G&&J(H,t,r),y(e),t=S(t,!0),y(r),i(V,t)?(r.enumerable?(i(e,U)&&e[U][t]&&(e[U][t]=!1),r=T(r,{enumerable:_(0,!1)})):(i(e,U)||O(e,U,_(1,{})),e[U][t]=!0),z(e,t,r)):O(e,t,r)},Y=function(e,t){y(e);for(var r,n=g(t=w(t)),i=0,o=n.length;o>i;)J(e,r=n[i++],t[r]);return e},Q=function(e){var t=F.call(this,e=S(e,!0));return!(this===G&&i(V,e)&&!i(H,e))&&(!(t||!i(this,e)||!i(V,e)||i(this,U)&&this[U][e])||t)},X=function(e,t){if(e=w(e),t=S(t,!0),e!==G||!i(V,t)||i(H,t)){var r=k(e,t);return!r||!i(V,t)||i(e,U)&&e[U][t]||(r.enumerable=!0),r}},ee=function(e){for(var t,r=N(w(e)),n=[],o=0;r.length>o;)i(V,t=r[o++])||t==U||t==c||n.push(t);return n},te=function(e){for(var t,r=e===G,n=N(r?H:w(e)),o=[],s=0;n.length>s;)!i(V,t=n[s++])||r&&!i(G,t)||o.push(V[t]);return o};q||(a((P=function(){if(this instanceof P)throw TypeError("Symbol is not a constructor!");var e=h(arguments.length>0?arguments[0]:void 0),t=function(r){this===G&&t.call(H,r),i(this,U)&&i(this[U],e)&&(this[U][e]=!1),z(this,e,_(1,r))};return o&&Z&&z(G,e,{configurable:!0,set:t}),K(e)})[M],"toString",(function(){return this._k})),A.f=X,C.f=J,r(95733).f=x.f=ee,r(55066).f=Q,I.f=te,o&&!r(34436)&&a(G,"propertyIsEnumerable",Q,!0),p.f=function(e){return K(f(e))}),s(s.G+s.W+s.F*!q,{Symbol:P});for(var re="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;re.length>ne;)f(re[ne++]);for(var ie=R(f.store),oe=0;ie.length>oe;)m(ie[oe++]);s(s.S+s.F*!q,"Symbol",{for:function(e){return i(j,e+="")?j[e]:j[e]=P(e)},keyFor:function(e){if(!W(e))throw TypeError(e+" is not a symbol!");for(var t in j)if(j[t]===e)return t},useSetter:function(){Z=!0},useSimple:function(){Z=!1}}),s(s.S+s.F*!q,"Object",{create:function(e,t){return void 0===t?T(e):Y(T(e),t)},defineProperty:J,defineProperties:Y,getOwnPropertyDescriptor:X,getOwnPropertyNames:ee,getOwnPropertySymbols:te});var se=u((function(){I.f(1)}));s(s.S+s.F*se,"Object",{getOwnPropertySymbols:function(e){return I.f(E(e))}}),L&&s(s.S+s.F*(!q||u((function(){var e=P();return"[null]"!=D([e])||"{}"!=D({a:e})||"{}"!=D(Object(e))}))),"JSON",{stringify:function(e){for(var t,r,n=[e],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=t=n[1],(b(t)||void 0!==e)&&!W(e))return v(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!W(t))return t}),n[1]=t,D.apply(L,n)}}),P[M][B]||r(44379)(P[M],B,P[M].valueOf),d(P,"Symbol"),d(Math,"Math",!0),d(n.JSON,"JSON",!0)},11610:(e,t,r)=>{"use strict";var n,i=r(3220),o=r(18485)(0),s=r(29763),a=r(57010),c=r(47382),u=r(77760),l=r(44425),d=r(10069),h=r(10069),f=!i.ActiveXObject&&"ActiveXObject"in i,p="WeakMap",m=a.getWeak,g=Object.isExtensible,v=u.ufstore,y=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},b={get:function(e){if(l(e)){var t=m(e);return!0===t?v(d(this,p)).get(e):t?t[this._i]:void 0}},set:function(e,t){return u.def(d(this,p),e,t)}},E=e.exports=r(66924)(p,y,b,u,!0,!0);h&&f&&(c((n=u.getConstructor(y,p)).prototype,b),a.NEED=!0,o(["delete","has","get","set"],(function(e){var t=E.prototype,r=t[e];s(t,e,(function(t,i){if(l(t)&&!g(t)){this._f||(this._f=new n);var o=this._f[e](t,i);return"set"==e?this:o}return r.call(this,t,i)}))})))},33012:(e,t,r)=>{r(74573)("Map")},28878:(e,t,r)=>{r(72758)("Map")},90401:(e,t,r)=>{var n=r(14518);n(n.P+n.R,"Map",{toJSON:r(80540)("Map")})},39827:(e,t,r)=>{var n=r(14518),i=r(30572)(!0);n(n.S,"Object",{entries:function(e){return i(e)}})},40342:(e,t,r)=>{var n=r(14518),i=r(74737),o=r(6303),s=r(30826),a=r(10101);n(n.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,r,n=o(e),c=s.f,u=i(n),l={},d=0;u.length>d;)void 0!==(r=c(n,t=u[d++]))&&a(l,t,r);return l}})},73625:(e,t,r)=>{var n=r(14518),i=r(30572)(!1);n(n.S,"Object",{values:function(e){return i(e)}})},36556:(e,t,r)=>{"use strict";var n=r(14518),i=r(63093),o=r(3220),s=r(312),a=r(77116);n(n.P+n.R,"Promise",{finally:function(e){var t=s(this,i.Promise||o.Promise),r="function"==typeof e;return this.then(r?function(r){return a(t,e()).then((function(){return r}))}:e,r?function(r){return a(t,e()).then((function(){throw r}))}:e)}})},8421:(e,t,r)=>{"use strict";var n=r(14518),i=r(36253),o=r(19934);n(n.S,"Promise",{try:function(e){var t=i.f(this),r=o(e);return(r.e?t.reject:t.resolve)(r.v),t.promise}})},68572:(e,t,r)=>{r(74573)("Set")},42235:(e,t,r)=>{r(72758)("Set")},30093:(e,t,r)=>{var n=r(14518);n(n.P+n.R,"Set",{toJSON:r(80540)("Set")})},52145:(e,t,r)=>{r(10305)("asyncIterator")},74775:(e,t,r)=>{r(10305)("observable")},20206:(e,t,r)=>{r(74573)("WeakMap")},91877:(e,t,r)=>{r(72758)("WeakMap")},39361:(e,t,r)=>{r(74296);for(var n=r(3220),i=r(44379),o=r(64502),s=r(23032)("toStringTag"),a="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),c=0;c<a.length;c++){var u=a[c],l=n[u],d=l&&l.prototype;d&&!d[s]&&i(d,s,u),o[u]=o.Array}},16282:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{ET:()=>NoiseReductionEffect,FW:()=>VirtualBackgroundEffect});var process=__webpack_require__(34155);function __awaiter$6(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}let getRandomValues;const rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&(getRandomValues="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!getRandomValues))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}const byteToHex=[];for(let e=0;e<256;++e)byteToHex.push((e+256).toString(16).slice(1));function unsafeStringify(e,t=0){return byteToHex[e[t+0]]+byteToHex[e[t+1]]+byteToHex[e[t+2]]+byteToHex[e[t+3]]+"-"+byteToHex[e[t+4]]+byteToHex[e[t+5]]+"-"+byteToHex[e[t+6]]+byteToHex[e[t+7]]+"-"+byteToHex[e[t+8]]+byteToHex[e[t+9]]+"-"+byteToHex[e[t+10]]+byteToHex[e[t+11]]+byteToHex[e[t+12]]+byteToHex[e[t+13]]+byteToHex[e[t+14]]+byteToHex[e[t+15]]}const randomUUID="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var native={randomUUID};function v4(e,t,r){if(native.randomUUID&&!t&&!e)return native.randomUUID();const n=(e=e||{}).random||(e.rng||rng)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return unsafeStringify(n)}var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==__webpack_require__.g?__webpack_require__.g:"undefined"!=typeof self?self:{},events={exports:{}},R="object"==typeof Reflect?Reflect:null,ReflectApply=R&&"function"==typeof R.apply?R.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)},ReflectOwnKeys;function ProcessEmitWarning(e){console&&console.warn&&console.warn(e)}ReflectOwnKeys=R&&"function"==typeof R.ownKeys?R.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var NumberIsNaN=Number.isNaN||function(e){return e!=e};function EventEmitter$1(){EventEmitter$1.init.call(this)}events.exports=EventEmitter$1,events.exports.once=once,EventEmitter$1.EventEmitter=EventEmitter$1,EventEmitter$1.prototype._events=void 0,EventEmitter$1.prototype._eventsCount=0,EventEmitter$1.prototype._maxListeners=void 0;var defaultMaxListeners=10;function checkListener(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function _getMaxListeners(e){return void 0===e._maxListeners?EventEmitter$1.defaultMaxListeners:e._maxListeners}function _addListener(e,t,r,n){var i,o,s;if(checkListener(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]),void 0===s)s=o[t]=r,++e._eventsCount;else if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=_getMaxListeners(e))>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=s.length,ProcessEmitWarning(a)}return e}function onceWrapper(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=onceWrapper.bind(n);return i.listener=r,n.wrapFn=i,i}function _listeners(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?unwrapListeners(i):arrayClone(i,i.length)}function listenerCount(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function arrayClone(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function spliceOne(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function unwrapListeners(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function once(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}eventTargetAgnosticAddListener(e,t,o,{once:!0}),"error"!==t&&addErrorHandlerIfEventEmitter(e,i,{once:!0})}))}function addErrorHandlerIfEventEmitter(e,t,r){"function"==typeof e.on&&eventTargetAgnosticAddListener(e,"error",t,r)}function eventTargetAgnosticAddListener(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}Object.defineProperty(EventEmitter$1,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(e){if("number"!=typeof e||e<0||NumberIsNaN(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");defaultMaxListeners=e}}),EventEmitter$1.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},EventEmitter$1.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||NumberIsNaN(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},EventEmitter$1.prototype.getMaxListeners=function(){return _getMaxListeners(this)},EventEmitter$1.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var a=i[e];if(void 0===a)return!1;if("function"==typeof a)ReflectApply(a,this,t);else{var c=a.length,u=arrayClone(a,c);for(r=0;r<c;++r)ReflectApply(u[r],this,t)}return!0},EventEmitter$1.prototype.addListener=function(e,t){return _addListener(this,e,t,!1)},EventEmitter$1.prototype.on=EventEmitter$1.prototype.addListener,EventEmitter$1.prototype.prependListener=function(e,t){return _addListener(this,e,t,!0)},EventEmitter$1.prototype.once=function(e,t){return checkListener(t),this.on(e,_onceWrap(this,e,t)),this},EventEmitter$1.prototype.prependOnceListener=function(e,t){return checkListener(t),this.prependListener(e,_onceWrap(this,e,t)),this},EventEmitter$1.prototype.removeListener=function(e,t){var r,n,i,o,s;if(checkListener(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():spliceOne(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},EventEmitter$1.prototype.off=EventEmitter$1.prototype.removeListener,EventEmitter$1.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},EventEmitter$1.prototype.listeners=function(e){return _listeners(this,e,!0)},EventEmitter$1.prototype.rawListeners=function(e){return _listeners(this,e,!1)},EventEmitter$1.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):listenerCount.call(e,t)},EventEmitter$1.prototype.listenerCount=listenerCount,EventEmitter$1.prototype.eventNames=function(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]};class EventEmitter extends events.exports.EventEmitter{}var logger$1={exports:{}};!function(e){!function(t){var r,n={};n.VERSION="1.6.1";var i={},o=function(e,t){return function(){return t.apply(e,arguments)}},s=function(){var e,t,r=arguments,n=r[0];for(t=1;t<r.length;t++)for(e in r[t])!(e in n)&&r[t].hasOwnProperty(e)&&(n[e]=r[t][e]);return n},a=function(e,t){return{value:e,name:t}};n.TRACE=a(1,"TRACE"),n.DEBUG=a(2,"DEBUG"),n.INFO=a(3,"INFO"),n.TIME=a(4,"TIME"),n.WARN=a(5,"WARN"),n.ERROR=a(8,"ERROR"),n.OFF=a(99,"OFF");var c=function(e){this.context=e,this.setLevel(e.filterLevel),this.log=this.info};c.prototype={setLevel:function(e){e&&"value"in e&&(this.context.filterLevel=e)},getLevel:function(){return this.context.filterLevel},enabledFor:function(e){var t=this.context.filterLevel;return e.value>=t.value},trace:function(){this.invoke(n.TRACE,arguments)},debug:function(){this.invoke(n.DEBUG,arguments)},info:function(){this.invoke(n.INFO,arguments)},warn:function(){this.invoke(n.WARN,arguments)},error:function(){this.invoke(n.ERROR,arguments)},time:function(e){"string"==typeof e&&e.length>0&&this.invoke(n.TIME,[e,"start"])},timeEnd:function(e){"string"==typeof e&&e.length>0&&this.invoke(n.TIME,[e,"end"])},invoke:function(e,t){r&&this.enabledFor(e)&&r(t,s({level:e},this.context))}};var u,l=new c({filterLevel:n.OFF});(u=n).enabledFor=o(l,l.enabledFor),u.trace=o(l,l.trace),u.debug=o(l,l.debug),u.time=o(l,l.time),u.timeEnd=o(l,l.timeEnd),u.info=o(l,l.info),u.warn=o(l,l.warn),u.error=o(l,l.error),u.log=u.info,n.setHandler=function(e){r=e},n.setLevel=function(e){for(var t in l.setLevel(e),i)i.hasOwnProperty(t)&&i[t].setLevel(e)},n.getLevel=function(){return l.getLevel()},n.get=function(e){return i[e]||(i[e]=new c(s({name:e},l.context)))},n.createDefaultHandler=function(e){(e=e||{}).formatter=e.formatter||function(e,t){t.name&&e.unshift("["+t.name+"]")};var t={},r=function(e,t){Function.prototype.apply.call(e,console,t)};return"undefined"==typeof console?function(){}:function(i,o){i=Array.prototype.slice.call(i);var s,a=console.log;o.level===n.TIME?(s=(o.name?"["+o.name+"] ":"")+i[0],"start"===i[1]?console.time?console.time(s):t[s]=(new Date).getTime():console.timeEnd?console.timeEnd(s):r(a,[s+": "+((new Date).getTime()-t[s])+"ms"])):(o.level===n.WARN&&console.warn?a=console.warn:o.level===n.ERROR&&console.error?a=console.error:o.level===n.INFO&&console.info?a=console.info:o.level===n.DEBUG&&console.debug?a=console.debug:o.level===n.TRACE&&console.trace&&(a=console.trace),e.formatter(i,o),r(a,i))}},n.useDefaults=function(e){n.setLevel(e&&e.defaultLevel||n.DEBUG),n.setHandler(n.createDefaultHandler(e))},n.setDefaults=n.useDefaults,e.exports?e.exports=n:(n._prevLogger=t.Logger,n.noConflict=function(){return t.Logger=n._prevLogger,n},t.Logger=n)}(commonjsGlobal)}(logger$1);var Logger=logger$1.exports;const logger=Logger.get("web-media-effects"),consoleLogHandler=Logger.createDefaultHandler({formatter:(e,t)=>{e.unshift(t.name)}});var EffectEnv,EffectEvent;Logger.setHandler(consoleLogHandler),function(e){e.Prod="prod",e.Int="int"}(EffectEnv||(EffectEnv={})),function(e){e.TrackUpdated="track-updated",e.Enabled="enabled",e.Disabled="disabled",e.Disposed="disposed"}(EffectEvent||(EffectEvent={}));class BaseEffect extends EventEmitter{get underlyingStream(){return this.getUnderlyingStream()}get inputTrack(){var e;return null===(e=this.inputStream)||void 0===e?void 0:e.getTracks()[0]}constructor(){super(),this.id=v4(),this.isEnabled=!1;const e=this.constructor;if(void 0===e.kind)throw new Error("base effect: derived class must define a static 'kind' property.");this.kind=e.kind}getOutputTrack(){return this.outputTrack}getOutputStream(){return this.outputStream}getUnderlyingStream(){return logger.warn("getUnderlyingStream() is deprecated and will be removed in a future major release. Please use getOutputStream() instead."),this.getOutputStream()}load(e){return __awaiter$6(this,void 0,void 0,(function*(){if(!e)throw new Error("base effect: track is a required parameter");if(e instanceof MediaStream)return this.loadMediaStream(e);if(e instanceof MediaStreamTrack)return this.loadMediaStreamTrack(e);throw this.isEnabled=!1,new Error("base effect: invalid argument type")}))}loadMediaStream(e){return __awaiter$6(this,void 0,void 0,(function*(){if(yield this.loadMedia(e.getTracks()[0],e),!this.outputStream)throw new Error("base effect: load failed to create output stream");return this.outputStream}))}loadMediaStreamTrack(e){return __awaiter$6(this,void 0,void 0,(function*(){if(yield this.loadMedia(e),!this.outputTrack)throw new Error("base effect: load failed to create output track");return this.outputTrack}))}loadMedia(e,t){return __awaiter$6(this,void 0,void 0,(function*(){this.outputTrack=e,t?(this.inputStream=t,this.outputStream=new MediaStream,this.outputStream.addTrack(this.outputTrack)):this.inputStream=new MediaStream([e])}))}replaceInputTrack(e){return __awaiter$6(this,void 0,void 0,(function*(){if(!e)throw new Error("base effect: track is a required parameter");this.inputStream&&this.inputTrack&&this.inputStream.removeTrack(this.inputTrack),this.inputStream&&this.inputStream.addTrack(e)}))}enable(){return __awaiter$6(this,void 0,void 0,(function*(){if(!this.effectTrack)throw new Error("base effect: effect track is undefined");this.isEnabled=!0,this.outputTrack=this.effectTrack,this.emit(EffectEvent.Enabled),this.emit(EffectEvent.TrackUpdated,this.effectTrack)}))}disable(){return __awaiter$6(this,void 0,void 0,(function*(){if(!this.inputTrack)throw new Error("base effect: input track is undefined");this.isEnabled=!1,this.outputTrack=this.inputTrack,this.emit(EffectEvent.Disabled),this.emit(EffectEvent.TrackUpdated,this.inputTrack)}))}dispose(){var e;return __awaiter$6(this,void 0,void 0,(function*(){null===(e=this.effectTrack)||void 0===e||e.stop(),delete this.outputTrack,delete this.effectTrack,this.removeAllListeners()}))}setEnabled(e){return __awaiter$6(this,void 0,void 0,(function*(){e?yield this.enable():yield this.disable()}))}}class BaseCameraEffect extends BaseEffect{}class BaseMicrophoneEffect extends BaseEffect{constructor(e){super(),this.audioContext=e||new AudioContext}}const defaultOptions$1={maxGain:2,rampTime:1};class GainEffect extends BaseMicrophoneEffect{constructor(e){super(e.audioContext),this.gainValue=1,this.options=Object.assign(Object.assign({},defaultOptions$1),e),logger.log("GainEffect init",{options:this.options})}loadMediaStream(e){const t=Object.create(null,{loadMediaStream:{get:()=>super.loadMediaStream}});return __awaiter$6(this,void 0,void 0,(function*(){if(yield t.loadMediaStream.call(this,e),this.outputStream=yield this.createOutputStream(),!this.outputStream)throw new Error("gain effect: failed to create output stream");return this.outputStream.getAudioTracks()[0].enabled=e.getTracks()[0].enabled,this.outputStream}))}loadMediaStreamTrack(e){const t=Object.create(null,{loadMediaStreamTrack:{get:()=>super.loadMediaStreamTrack}});return __awaiter$6(this,void 0,void 0,(function*(){if(yield t.loadMediaStreamTrack.call(this,e),[this.outputTrack]=(yield this.createOutputStream()).getTracks(),!this.outputTrack)throw new Error("gain effect: failed to create output track");return this.outputTrack}))}createOutputStream(){return __awaiter$6(this,void 0,void 0,(function*(){if(!this.inputStream)throw new Error("gain effect: failed to create input stream");const e=this.audioContext.createMediaStreamSource(this.inputStream);this.gainNode=new GainNode(this.audioContext),e.connect(this.gainNode);const t=this.audioContext.createMediaStreamDestination();return this.gainNode.connect(t),[this.effectTrack]=t.stream.getTracks(),t.stream}))}setGainValue(e){e>this.options.maxGain&&(e=this.options.maxGain),this.gainValue=e,this.gainNode.gain.linearRampToValueAtTime(e,this.audioContext.currentTime+this.options.rampTime)}enable(){const e=Object.create(null,{enable:{get:()=>super.enable}});return __awaiter$6(this,void 0,void 0,(function*(){this.gainNode.gain.linearRampToValueAtTime(this.gainValue,this.audioContext.currentTime+this.options.rampTime),yield e.enable.call(this)}))}disable(){const e=Object.create(null,{disable:{get:()=>super.disable}});return __awaiter$6(this,void 0,void 0,(function*(){this.gainNode.gain.linearRampToValueAtTime(1,this.audioContext.currentTime+this.options.rampTime),yield e.disable.call(this)}))}dispose(){const e=Object.create(null,{dispose:{get:()=>super.dispose}});return __awaiter$6(this,void 0,void 0,(function*(){this.gainNode.disconnect(),yield e.dispose.call(this)}))}}GainEffect.kind="gain-effect";const appendScript=e=>__awaiter$6(void 0,void 0,void 0,(function*(){return new Promise(((t,r)=>{var n;const i=document.getElementsByTagName("script")[0],o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src=e,o.onload=t,o.onerror=r,null===(n=i.parentNode)||void 0===n||n.insertBefore(o,i)}))})),fetchUrls=(e,t,r)=>{const n=r===EffectEnv.Int?"https://models-auth.us-east-2.int.infra.intelligence.webex.com/generate":"https://models-auth.intelligence.webex.com/generate",i={items:Array.isArray(e)?e:[e]},o={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(i)};return fetch(n,o).then((e=>{if(!e.ok)throw e;return e.json()}))},fetchSignedUrl=(e,t,r)=>fetchUrls(e,t,r).then((e=>{var t,r;return null===(r=null===(t=e.items)||void 0===t?void 0:t[0])||void 0===r?void 0:r.url})).catch((()=>{throw new Error("unable to fetch url; check auth token and try again")})),memoizeBlobUrl=e=>{const t=new Map;function r(...r){return __awaiter$6(this,void 0,void 0,(function*(){const n=JSON.stringify(r),i=t.get(n);if(void 0!==i)return i;const o=yield e.apply(this,r),s=yield fetch(o),a=URL.createObjectURL(yield s.blob());return t.set(n,a),a}))}return r.clearCache=()=>{t.clear()},r},memoizedFetchSignedUrl=memoizeBlobUrl(fetchSignedUrl);var FutureState;!function(e){e.Pending="pending",e.Resolved="resolved",e.Rejected="rejected"}(FutureState||(FutureState={}));class Future{constructor(e){this.state=FutureState.Pending,this.promise=null!=e?e:new Promise(((e,t)=>{this.resolve=t=>{this.state=FutureState.Resolved,e(t)},this.reject=e=>{this.state=FutureState.Rejected,t(e)}}))}}const hasSimdSupport=()=>__awaiter$6(void 0,void 0,void 0,(function*(){return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]))})),omitKey=(e,t)=>Object.fromEntries(Object.entries(t).filter((t=>t[0]!==e)));var NoiseReductionMode;!function(e){e.Legacy="LEGACY",e.Worklet="WORKLET"}(NoiseReductionMode||(NoiseReductionMode={}));class NoiseReductionEffect extends BaseMicrophoneEffect{get isLoaded(){return!!this.loadFuture}constructor(e){super(null==e?void 0:e.audioContext),this.isReady=!1,this.disableFuture=new Future,this.enableFuture=new Future,this.options=Object.assign({},e),logger.log("noise reduction: init effect",omitKey("authToken",this.options))}fetchUrl(e){return __awaiter$6(this,void 0,void 0,(function*(){let t=e;if(!this.options.authToken)throw new Error("noise reduction: auth token is required");return!this.options.avoidSimd&&(yield NoiseReductionEffect.supportsSimd())&&(t=e.replace(".js",".simd.js")),memoizedFetchSignedUrl(t,this.options.authToken,this.options.env).catch((e=>{throw new Error(`noise reduction: ${e.message}`)}))}))}loadMediaStream(e){const t=Object.create(null,{loadMedia:{get:()=>super.loadMedia}});return __awaiter$6(this,void 0,void 0,(function*(){logger.log("noise reduction: load stream",e);const[r]=e.getAudioTracks();if(!r)throw new Error("noise reduction: load stream failed, no audio track found");if(yield t.loadMedia.call(this,r,e),this.outputStream=yield this.createOutputStream(),!this.outputStream)throw new Error("noise reduction: failed to create output stream");return this.outputStream.getAudioTracks()[0].enabled=r.enabled,this.outputStream}))}loadMediaStreamTrack(e){const t=Object.create(null,{loadMediaStreamTrack:{get:()=>super.loadMediaStreamTrack}});return __awaiter$6(this,void 0,void 0,(function*(){if(yield t.loadMediaStreamTrack.call(this,e),[this.outputTrack]=(yield this.createOutputStream()).getTracks(),!this.outputTrack)throw new Error("noise reduction: failed to create output track");return this.outputTrack}))}createOutputStream(){var e;return __awaiter$6(this,void 0,void 0,(function*(){if(!this.inputStream)throw new Error("noise reduction: failed to create input stream");const t=this.audioContext.createMediaStreamDestination();return[this.effectTrack]=t.stream.getTracks(),this.loadFuture?this.loadFuture.promise:(this.loadFuture=new Future,yield null===(e=this.disposeFuture)||void 0===e?void 0:e.promise,this.disposeFuture=new Future,this.options.mode===NoiseReductionMode.Legacy?this.loadLegacy(this.inputStream,t):this.loadWorklet(this.inputStream,t))}))}loadWorklet(e,t){var r,n;return __awaiter$6(this,void 0,void 0,(function*(){if(!this.loadFuture)throw new Error("noise reduction: the load future was not initialized correctly");logger.log("noise reduction: load worklet");try{const i=this.options.workletProcessorUrl||(yield this.fetchUrl("denoise/processors/2.4.2/noise-reduction-processor.worklet.js"));if(logger.log("noise reduction: fetch worklet processor"),yield null===(n=null===(r=this.audioContext)||void 0===r?void 0:r.audioWorklet)||void 0===n?void 0:n.addModule(i),!AudioWorkletNode)throw new Error("noise reduction: `AudioWorkletNode` unavailable in current scope");logger.log("noise reduction: attach worklet processor"),this.workletNode=new AudioWorkletNode(this.audioContext,"noise-reduction-worklet-processor"),this.workletNode.port.onmessage=e=>{var r,n,i;switch(logger.log(`noise reduction: worklet processor ${e.data.type.toLowerCase()}`),e.data.type){case NoiseReductionEffect.Events.Ready:this.isReady=!0,null===(r=this.loadFuture)||void 0===r||r.resolve(t.stream);break;case NoiseReductionEffect.Events.Disabled:this.handleDisabled();break;case NoiseReductionEffect.Events.Enabled:this.handleEnabled();break;case NoiseReductionEffect.Events.Disposed:this.isEnabled=!1,this.isReady=!1,null===(n=this.disposeFuture)||void 0===n||n.resolve(),this.emit(EffectEvent.Disposed);break;case NoiseReductionEffect.Events.Error:{const t=new Error(`noise reduction: worklet processor error, "${e.data.payload}"`);null===(i=this.loadFuture)||void 0===i||i.reject(t),logger.error(t);break}default:logger.warn("noise reduction: worklet processor unhandled message",e.data)}},this.workletNode.connect(t),this.sourceNode=this.audioContext.createMediaStreamSource(e),this.sourceNode.connect(this.workletNode)}catch(e){this.loadFuture.reject(new Error("noise reduction: failed to load worklet processor"))}return this.loadFuture.promise}))}loadLegacy(e,t){var r;return __awaiter$6(this,void 0,void 0,(function*(){if(!this.loadFuture)throw new Error("noise reduction: the load future was not initialized correctly");logger.log("noise reduction: load legacy");try{const n=this.options.legacyProcessorUrl||(yield this.fetchUrl("denoise/processors/2.4.2/noise-reduction-processor.legacy.js"));if((null===(r=window.WebMediaEffects)||void 0===r?void 0:r.NoiseReductionLegacyProcessor)||(yield appendScript(n)),this.legacyProcessor=new window.WebMediaEffects.NoiseReductionLegacyProcessor(this.audioContext.sampleRate),this.legacyProcessor){const r={16e3:256,32e3:512,48e3:512}[this.audioContext.sampleRate];this.legacyScriptNode=this.audioContext.createScriptProcessor(r,1,1),this.legacyScriptNode.connect(t),this.legacyScriptNode.onaudioprocess=this.legacyProcessor.processAudioChunk,this.sourceNode=this.audioContext.createMediaStreamSource(e),this.sourceNode.connect(this.legacyScriptNode),this.isReady=!0,this.loadFuture.resolve(t.stream)}}catch(e){this.loadFuture.reject(new Error("noise reduction: failed to load legacy processor"))}return this.loadFuture.promise}))}enable(){var e,t;return __awaiter$6(this,void 0,void 0,(function*(){if(logger.log("noise reduction: enable effect"),!this.isReady)throw new Error("noise reduction: not setup or ready");return this.enableFuture=new Future,null===(e=this.workletNode)||void 0===e||e.port.postMessage("ENABLE"),null===(t=this.legacyProcessor)||void 0===t||t.setEnabled(!0).then((()=>this.handleEnabled())),this.enableFuture.promise}))}disable(){var e,t;return __awaiter$6(this,void 0,void 0,(function*(){if(logger.log("noise reduction: disable effect"),!this.isReady)throw new Error("noise reduction: not setup or ready");return this.disableFuture=new Future,null===(e=this.workletNode)||void 0===e||e.port.postMessage("DISABLE"),null===(t=this.legacyProcessor)||void 0===t||t.setEnabled(!1).then((()=>this.handleDisabled())),this.disableFuture.promise}))}dispose(){const e=Object.create(null,{dispose:{get:()=>super.dispose}});var t,r,n,i,o,s,a;return __awaiter$6(this,void 0,void 0,(function*(){logger.log("noise reduction: dispose effect"),this.loadFuture&&(yield this.loadFuture.promise,this.loadFuture=void 0,null===(t=this.workletNode)||void 0===t||t.port.postMessage("DISPOSE"),null===(r=this.legacyProcessor)||void 0===r||r.dispose().then(null===(n=this.disposeFuture)||void 0===n?void 0:n.resolve),yield null===(i=this.disposeFuture)||void 0===i?void 0:i.promise,null===(o=this.workletNode)||void 0===o||o.disconnect(),null===(s=this.legacyScriptNode)||void 0===s||s.disconnect(),null===(a=this.sourceNode)||void 0===a||a.disconnect(),yield e.dispose.call(this),logger.log("noise reduction: effect disposed"))}))}handleDisabled(){const e=Object.create(null,{disable:{get:()=>super.disable}});return __awaiter$6(this,void 0,void 0,(function*(){yield e.disable.call(this),this.disableFuture.resolve()}))}handleEnabled(){const e=Object.create(null,{enable:{get:()=>super.enable}});return __awaiter$6(this,void 0,void 0,(function*(){yield e.enable.call(this),this.enableFuture.resolve()}))}}NoiseReductionEffect.kind="noise-reduction-effect",NoiseReductionEffect.supportsSimd=hasSimdSupport,NoiseReductionEffect.Events={Ready:"READY",Disabled:"DISABLED",Disposed:"DISPOSED",Enabled:"ENABLED",Error:"ERROR"};var __awaiter$5=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};const toAbsoluteURI=(e,t)=>!t||e.startsWith("http")?new URL(e).href:e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t;function compileShader(e,t,r){var n;const i=e.createShader(t);if(!i)throw new Error("[ladon-ts] - error creating shader");if(e.shaderSource(i,r),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS)){const t=null!==(n=e.getShaderInfoLog(i))&&void 0!==n?n:"unknown error compiling shader.";throw new Error("[ladon-ts] - "+t)}return i}function linkProgram(e,t,r){var n;const i=e.createProgram();if(!i)throw new Error("[ladon-ts] - error creating GPU program");if(e.attachShader(i,t),e.attachShader(i,r),e.linkProgram(i),!e.getProgramParameter(i,e.LINK_STATUS)){const t=null!==(n=e.getProgramInfoLog(i))&&void 0!==n?n:"unknown error linking program.";throw new Error("[ladon-ts] - "+t)}return i}const resizeImage=(e,t,r,n,i)=>{const o=new Uint8ClampedArray(n*i*4),s=t/n,a=r/i,c=4*t;let u=0;for(let t=0;t<i;t++){const r=Math.floor(t*a)*c;for(let t=0;t<n;t++){const n=r+4*Math.floor(t*s);o[u++]=e[n],o[u++]=e[n+1],o[u++]=e[n+2],o[u++]=e[n+3]}}return o},getModelUrl=({mask:{model_url_resolver:e,model_uri:t}})=>__awaiter$5(void 0,void 0,void 0,(function*(){let r;return r="string"==typeof e?e:yield e(t),r})),LIB_VERSION="4.2.4";var Quality,BlurStrength;!function(e){e.TINY="TINY",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH",e.ULTRA="ULTRA"}(Quality||(Quality={})),function(e){e.WEAK="WEAK",e.MODERATE="MODERATE",e.STRONG="STRONG",e.STRONGER="STRONGER",e.STRONGEST="STRONGEST"}(BlurStrength||(BlurStrength={}));const getBlurConfig=(e,t)=>{let r=25,n=11;switch(e){case BlurStrength.WEAK:r=9,n=2;break;case BlurStrength.MODERATE:r=15,n=6;break;case BlurStrength.STRONG:r=25,n=11;break;case BlurStrength.STRONGER:r=37,n=17;break;case BlurStrength.STRONGEST:r=49,n=23}return{type:"blur",horizontal_mirror:t,kernel_size:r,sigma:n}},getConfig=(e,t,r=Quality.LOW,n="local",i={type:"blur",horizontal_mirror:!1,kernel_size:37,sigma:17},o=(e=>Promise.resolve(toAbsoluteURI(e,"https://models.intelligence.webex.com/ladon"))),s="https://models.intelligence.webex.com/ladon")=>{const a="1.0.0",c={base_url:s,wasm_uri:"/wasm/1.15.1b/",render:i,input:{height:e,width:t},mask:{generation_interval_ms:48,generator:n,model_url_resolver:o,model_uri:`/models/${a}/mv2_dlv3plus_dynamic_dev_plus_dual_op11_mn3sm100.onnx`,worker_uri:`/${LIB_VERSION}/worker/segmentation.js`,model_rank:3,input_size:{height:e,width:t},output_size:{height:e,width:t}}};let u={};switch(r){case Quality.TINY:u={generation_interval_ms:48,model_uri:`/models/${a}/tiny_model.onnx`,input_size:{height:144,width:256},output_size:{height:360,width:640},model_rank:4};break;case Quality.LOW:u={generation_interval_ms:48,model_uri:`/models/${a}/mv2_dlv3plus_dynamic_dev_plus_dual_op11_mn3sm100.onnx`};break;case Quality.MEDIUM:u={generation_interval_ms:24,model_uri:`/models/${a}/mv2_dlv3plus_dynamic_dev_plus_dual_op11_mn3sm100.onnx`};break;case Quality.HIGH:u={generation_interval_ms:36,model_uri:`/models/${a}/mv2_dlv3plus_dynamic_dev_plus_dual_op11_full_depth_2.onnx`};break;case Quality.ULTRA:u={generation_interval_ms:0,model_uri:`/models/${a}/mv2_dlv3plus_dynamic_dev_plus_dual_op11_full_depth_2.onnx`};break;default:throw new Error("[ladon-ts] - unknown quality option: "+r)}return Object.assign(Object.assign({},c),{mask:Object.assign(Object.assign({},c.mask),u)})};var ort_min={exports:{}};(function(module,exports){var t;globalThis,t=()=>(()=>{var __webpack_modules__={8453:(e,t,r)=>{r.r(t),r.d(t,{InferenceSession:()=>f,Tensor:()=>d,env:()=>s,registerBackend:()=>o});const n={},i=[],o=(e,t,r)=>{if(!t||"function"!=typeof t.init||"function"!=typeof t.createSessionHandler)throw new TypeError("not a valid backend");{const o=n[e];if(void 0===o)n[e]={backend:t,priority:r};else{if(o.priority>r)return;if(o.priority===r&&o.backend!==t)throw new Error(`cannot register backend "${e}" using priority ${r}`)}if(r>=0){const t=i.indexOf(e);-1!==t&&i.splice(t,1);for(let t=0;t<i.length;t++)if(n[i[t]].priority<=r)return void i.splice(t,0,e);i.push(e)}}},s=new class{constructor(){this.wasm={},this.webgl={},this.webgpu={},this.logLevelInternal="warning"}set logLevel(e){if(void 0!==e){if("string"!=typeof e||-1===["verbose","info","warning","error","fatal"].indexOf(e))throw new Error(`Unsupported logging level: ${e}`);this.logLevelInternal=e}}get logLevel(){return this.logLevelInternal}},a=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array]]),c=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]);let u=!1;class l{constructor(e,t,r){let n,i,o;if((()=>{if(!u){u=!0;const e="undefined"!=typeof BigInt64Array&&"function"==typeof BigInt64Array.from,t="undefined"!=typeof BigUint64Array&&"function"==typeof BigUint64Array.from;e&&(a.set("int64",BigInt64Array),c.set(BigInt64Array,"int64")),t&&(a.set("uint64",BigUint64Array),c.set(BigUint64Array,"uint64"))}})(),"string"==typeof e)if(n=e,o=r,"string"===e){if(!Array.isArray(t))throw new TypeError("A string tensor's data must be a string array.");i=t}else{const r=a.get(e);if(void 0===r)throw new TypeError(`Unsupported tensor type: ${e}.`);if(Array.isArray(t))i=r.from(t);else{if(!(t instanceof r))throw new TypeError(`A ${n} tensor's data must be type of ${r}`);i=t}}else if(o=t,Array.isArray(e)){if(0===e.length)throw new TypeError("Tensor type cannot be inferred from an empty array.");const t=typeof e[0];if("string"===t)n="string",i=e;else{if("boolean"!==t)throw new TypeError(`Invalid element type of data array: ${t}.`);n="bool",i=Uint8Array.from(e)}}else{const t=c.get(e.constructor);if(void 0===t)throw new TypeError(`Unsupported type for tensor data: ${e.constructor}.`);n=t,i=e}if(void 0===o)o=[i.length];else if(!Array.isArray(o))throw new TypeError("A tensor's dims must be a number array");const s=(e=>{let t=1;for(let r=0;r<e.length;r++){const n=e[r];if("number"!=typeof n||!Number.isSafeInteger(n))throw new TypeError(`dims[${r}] must be an integer, got: ${n}`);if(n<0)throw new RangeError(`dims[${r}] must be a non-negative integer, got: ${n}`);t*=n}return t})(o);if(s!==i.length)throw new Error(`Tensor's size(${s}) does not match data length(${i.length}).`);this.dims=o,this.type=n,this.data=i,this.size=s}static bufferToTensor(e,t){if(void 0===e)throw new Error("Image buffer must be defined");if(void 0===t.height||void 0===t.width)throw new Error("Image height and width must be defined");if("NHWC"===t.tensorLayout)throw new Error("NHWC Tensor layout is not supported yet");const{height:r,width:n}=t,i=t.norm??{mean:255,bias:0};let o,s;o="number"==typeof i.mean?[i.mean,i.mean,i.mean,i.mean]:[i.mean[0],i.mean[1],i.mean[2],i.mean[3]??255],s="number"==typeof i.bias?[i.bias,i.bias,i.bias,i.bias]:[i.bias[0],i.bias[1],i.bias[2],i.bias[3]??0];const a=void 0!==t.bitmapFormat?t.bitmapFormat:"RGBA",c=void 0!==t.tensorFormat&&void 0!==t.tensorFormat?t.tensorFormat:"RGB",u=r*n,d="RGBA"===c?new Float32Array(4*u):new Float32Array(3*u);let h=4,f=0,p=1,m=2,g=3,v=0,y=u,b=2*u,E=-1;"RGB"===a&&(h=3,f=0,p=1,m=2,g=-1),"RGBA"===c?E=3*u:"RBG"===c?(v=0,b=u,y=2*u):"BGR"===c&&(b=0,y=u,v=2*u);for(let t=0;t<u;t++,f+=h,m+=h,p+=h,g+=h)d[v++]=(e[f]+s[0])/o[0],d[y++]=(e[p]+s[1])/o[1],d[b++]=(e[m]+s[2])/o[2],-1!==E&&-1!==g&&(d[E++]=(e[g]+s[3])/o[3]);return new l("float32",d,"RGBA"===c?[1,4,r,n]:[1,3,r,n])}static async fromImage(e,t){const r="undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement,n="undefined"!=typeof ImageData&&e instanceof ImageData,i="undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap,o="string"==typeof e;let s,a=t??{};if(r){const r=document.createElement("canvas");r.width=e.width,r.height=e.height;const n=r.getContext("2d");if(null==n)throw new Error("Can not access image data");{let r=e.height,i=e.width;if(void 0!==t&&void 0!==t.resizedHeight&&void 0!==t.resizedWidth&&(r=t.resizedHeight,i=t.resizedWidth),void 0!==t){if(a=t,void 0!==t.tensorFormat)throw new Error("Image input config format must be RGBA for HTMLImageElement");if(a.tensorFormat="RGBA",void 0!==t.height&&t.height!==r)throw new Error("Image input config height doesn't match HTMLImageElement height");if(a.height=r,void 0!==t.width&&t.width!==i)throw new Error("Image input config width doesn't match HTMLImageElement width");a.width=i}else a.tensorFormat="RGBA",a.height=r,a.width=i;n.drawImage(e,0,0),s=n.getImageData(0,0,i,r).data}}else{if(!n){if(i){if(void 0===t)throw new Error("Please provide image config with format for Imagebitmap");if(void 0!==t.bitmapFormat)throw new Error("Image input config format must be defined for ImageBitmap");const r=document.createElement("canvas").getContext("2d");if(null!=r){const n=e.height,i=e.width;if(r.drawImage(e,0,0,i,n),s=r.getImageData(0,0,i,n).data,void 0!==t){if(void 0!==t.height&&t.height!==n)throw new Error("Image input config height doesn't match ImageBitmap height");if(a.height=n,void 0!==t.width&&t.width!==i)throw new Error("Image input config width doesn't match ImageBitmap width");a.width=i}else a.height=n,a.width=i;return l.bufferToTensor(s,a)}throw new Error("Can not access image data")}if(o)return new Promise(((r,n)=>{const i=document.createElement("canvas"),o=i.getContext("2d");if(!e||!o)return n();const s=new Image;s.crossOrigin="Anonymous",s.src=e,s.onload=()=>{i.width=s.width,i.height=s.height,o.drawImage(s,0,0,i.width,i.height);const e=o.getImageData(0,0,i.width,i.height);if(void 0!==t){if(void 0!==t.height&&t.height!==i.height)throw new Error("Image input config height doesn't match height");if(a.height=i.height,void 0!==t.width&&t.width!==i.width)throw new Error("Image input config width doesn't match width");a.width=i.width}else a.height=i.height,a.width=i.width;r(l.bufferToTensor(e.data,a))}}));throw new Error("Input data provided is not supported - aborted tensor creation")}{const r="RGBA";let n,i;if(void 0!==t&&void 0!==t.resizedWidth&&void 0!==t.resizedHeight?(n=t.resizedHeight,i=t.resizedWidth):(n=e.height,i=e.width),void 0!==t){if(a=t,void 0!==t.bitmapFormat&&t.bitmapFormat!==r)throw new Error("Image input config format must be RGBA for ImageData");a.bitmapFormat="RGBA"}else a.bitmapFormat="RGBA";if(a.height=n,a.width=i,void 0!==t){const t=document.createElement("canvas");t.width=i,t.height=n;const r=t.getContext("2d");if(null==r)throw new Error("Can not access image data");r.putImageData(e,0,0),s=r.getImageData(0,0,i,n).data}else s=e.data}}if(void 0!==s)return l.bufferToTensor(s,a);throw new Error("Input data provided is not supported - aborted tensor creation")}toDataURL(e){const t=document.createElement("canvas");t.width=this.dims[3],t.height=this.dims[2];const r=t.getContext("2d");if(null!=r){let n,i;void 0!==e?.tensorLayout&&"NHWC"===e.tensorLayout?(n=this.dims[2],i=this.dims[3]):(n=this.dims[3],i=this.dims[2]);const o=void 0!==e?.format?e.format:"RGB",s=e?.norm;let a,c;void 0===s||void 0===s.mean?a=[255,255,255,255]:"number"==typeof s.mean?a=[s.mean,s.mean,s.mean,s.mean]:(a=[s.mean[0],s.mean[1],s.mean[2],0],void 0!==s.mean[3]&&(a[3]=s.mean[3])),void 0===s||void 0===s.bias?c=[0,0,0,0]:"number"==typeof s.bias?c=[s.bias,s.bias,s.bias,s.bias]:(c=[s.bias[0],s.bias[1],s.bias[2],0],void 0!==s.bias[3]&&(c[3]=s.bias[3]));const u=i*n;let l=0,d=u,h=2*u,f=-1;"RGBA"===o?(l=0,d=u,h=2*u,f=3*u):"RGB"===o?(l=0,d=u,h=2*u):"RBG"===o&&(l=0,h=u,d=2*u);for(let e=0;e<i;e++)for(let t=0;t<n;t++){const n=(this.data[l++]-c[0])*a[0],i=(this.data[d++]-c[1])*a[1],o=(this.data[h++]-c[2])*a[2],s=-1===f?255:(this.data[f++]-c[3])*a[3];r.fillStyle="rgba("+n+","+i+","+o+","+s+")",r.fillRect(t,e,1,1)}return t.toDataURL()}throw new Error("Can not access image data")}toImageData(e){const t=document.createElement("canvas").getContext("2d");let r;if(null==t)throw new Error("Can not access image data");{let n,i,o;void 0!==e?.tensorLayout&&"NHWC"===e.tensorLayout?(n=this.dims[2],i=this.dims[1],o=this.dims[3]):(n=this.dims[3],i=this.dims[2],o=this.dims[1]);const s=void 0!==e&&void 0!==e.format?e.format:"RGB",a=e?.norm;let c,u;void 0===a||void 0===a.mean?c=[255,255,255,255]:"number"==typeof a.mean?c=[a.mean,a.mean,a.mean,a.mean]:(c=[a.mean[0],a.mean[1],a.mean[2],255],void 0!==a.mean[3]&&(c[3]=a.mean[3])),void 0===a||void 0===a.bias?u=[0,0,0,0]:"number"==typeof a.bias?u=[a.bias,a.bias,a.bias,a.bias]:(u=[a.bias[0],a.bias[1],a.bias[2],0],void 0!==a.bias[3]&&(u[3]=a.bias[3]));const l=i*n;if(void 0!==e){if(void 0!==e.height&&e.height!==i)throw new Error("Image output config height doesn't match tensor height");if(void 0!==e.width&&e.width!==n)throw new Error("Image output config width doesn't match tensor width");if(void 0!==e.format&&4===o&&"RGBA"!==e.format||3===o&&"RGB"!==e.format&&"BGR"!==e.format)throw new Error("Tensor format doesn't match input tensor dims")}const d=4;let h=0,f=1,p=2,m=3,g=0,v=l,y=2*l,b=-1;"RGBA"===s?(g=0,v=l,y=2*l,b=3*l):"RGB"===s?(g=0,v=l,y=2*l):"RBG"===s&&(g=0,y=l,v=2*l),r=t.createImageData(n,i);for(let e=0;e<i*n;h+=d,f+=d,p+=d,m+=d,e++)r.data[h]=(this.data[g++]-u[0])*c[0],r.data[f]=(this.data[v++]-u[1])*c[1],r.data[p]=(this.data[y++]-u[2])*c[2],r.data[m]=-1===b?255:(this.data[b++]-u[3])*c[3]}return r}reshape(e){return new l(this.type,this.data,e)}}const d=l;class h{constructor(e){this.handler=e}async run(e,t,r){const n={};let i={};if("object"!=typeof e||null===e||e instanceof d||Array.isArray(e))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let o=!0;if("object"==typeof t){if(null===t)throw new TypeError("Unexpected argument[1]: cannot be null.");if(t instanceof d)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(t)){if(0===t.length)throw new TypeError("'fetches' cannot be an empty array.");o=!1;for(const e of t){if("string"!=typeof e)throw new TypeError("'fetches' must be a string array or an object.");if(-1===this.outputNames.indexOf(e))throw new RangeError(`'fetches' contains invalid output name: ${e}.`);n[e]=null}if("object"==typeof r&&null!==r)i=r;else if(void 0!==r)throw new TypeError("'options' must be an object.")}else{let e=!1;const s=Object.getOwnPropertyNames(t);for(const r of this.outputNames)if(-1!==s.indexOf(r)){const i=t[r];(null===i||i instanceof d)&&(e=!0,o=!1,n[r]=i)}if(e){if("object"==typeof r&&null!==r)i=r;else if(void 0!==r)throw new TypeError("'options' must be an object.")}else i=t}}else if(void 0!==t)throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(const t of this.inputNames)if(void 0===e[t])throw new Error(`input '${t}' is missing in 'feeds'.`);if(o)for(const e of this.outputNames)n[e]=null;const s=await this.handler.run(e,n,i),a={};for(const e in s)Object.hasOwnProperty.call(s,e)&&(a[e]=new d(s[e].type,s[e].data,s[e].dims));return a}static async create(e,t,r,o){let s,a={};if("string"==typeof e){if(s=e,"object"==typeof t&&null!==t)a=t;else if(void 0!==t)throw new TypeError("'options' must be an object.")}else if(e instanceof Uint8Array){if(s=e,"object"==typeof t&&null!==t)a=t;else if(void 0!==t)throw new TypeError("'options' must be an object.")}else{if(!(e instanceof ArrayBuffer||"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer))throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");{const n=e;let i=0,c=e.byteLength;if("object"==typeof t&&null!==t)a=t;else if("number"==typeof t){if(i=t,!Number.isSafeInteger(i))throw new RangeError("'byteOffset' must be an integer.");if(i<0||i>=n.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${n.byteLength}).`);if(c=e.byteLength-i,"number"==typeof r){if(c=r,!Number.isSafeInteger(c))throw new RangeError("'byteLength' must be an integer.");if(c<=0||i+c>n.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${n.byteLength-i}].`);if("object"==typeof o&&null!==o)a=o;else if(void 0!==o)throw new TypeError("'options' must be an object.")}else if(void 0!==r)throw new TypeError("'byteLength' must be a number.")}else if(void 0!==t)throw new TypeError("'options' must be an object.");s=new Uint8Array(n,i,c)}}const c=(a.executionProviders||[]).map((e=>"string"==typeof e?e:e.name)),u=await(async e=>{const t=0===e.length?i:e,r=[];for(const e of t){const t=n[e];if(t){if(t.initialized)return t.backend;if(t.aborted)continue;const n=!!t.initPromise;try{return n||(t.initPromise=t.backend.init()),await t.initPromise,t.initialized=!0,t.backend}catch(i){n||r.push({name:e,err:i}),t.aborted=!0}finally{delete t.initPromise}}}throw new Error(`no available backend found. ERR: ${r.map((e=>`[${e.name}] ${e.err}`)).join(", ")}`)})(c),l=await u.createSessionHandler(s,a);return new h(l)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}const f=h},5716:(e,t,r)=>{t.R=void 0;const n=r(6027),i=r(1723);t.R=new class{async init(){}async createSessionHandler(e,t){const r=new n.Session(t);return await r.loadModel(e),new i.OnnxjsSessionHandler(r)}}},2818:(e,t,r)=>{t.c8=t.rX=void 0;const n=r(8453),i=r(5381),o=r(9544),s=r(6640);t.rX=()=>{if(("number"!=typeof n.env.wasm.initTimeout||n.env.wasm.initTimeout<0)&&(n.env.wasm.initTimeout=0),"boolean"!=typeof n.env.wasm.simd&&(n.env.wasm.simd=!0),"boolean"!=typeof n.env.wasm.proxy&&(n.env.wasm.proxy=!1),"number"!=typeof n.env.wasm.numThreads||!Number.isInteger(n.env.wasm.numThreads)||n.env.wasm.numThreads<=0){const e="undefined"==typeof navigator?(0,i.cpus)().length:navigator.hardwareConcurrency;n.env.wasm.numThreads=Math.min(4,Math.ceil((e||1)/2))}},t.c8=new class{async init(){(0,t.rX)(),await(0,o.initWasm)()}async createSessionHandler(e,t){const r=new s.OnnxruntimeWebAssemblySessionHandler;return await r.loadModel(e,t),Promise.resolve(r)}}},1057:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(8453),t);const o=r(8453);{const e=r(5716).R;(0,o.registerBackend)("webgl",e,-10)}{const e=r(2818).c8;(0,o.registerBackend)("cpu",e,10),(0,o.registerBackend)("wasm",e,10),(0,o.registerBackend)("xnnpack",e,9)}},4910:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createAttributeWithCacheKey=void 0;class r{constructor(e){Object.assign(this,e)}get cacheKey(){return this._cacheKey||(this._cacheKey=Object.getOwnPropertyNames(this).sort().map((e=>`${this[e]}`)).join(";")),this._cacheKey}}t.createAttributeWithCacheKey=e=>new r(e)},6874:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Attribute=void 0;const n=r(1446),i=r(1287),o=r(9240),s=r(7273);var a=i.onnxruntime.experimental.fbs;class c{constructor(e){if(this._attributes=new Map,null!=e){for(const t of e)t instanceof n.onnx.AttributeProto?this._attributes.set(t.name,[c.getValue(t),c.getType(t)]):t instanceof a.Attribute&&this._attributes.set(t.name(),[c.getValue(t),c.getType(t)]);if(this._attributes.size<e.length)throw new Error("duplicated attribute names")}}set(e,t,r){this._attributes.set(e,[r,t])}delete(e){this._attributes.delete(e)}getFloat(e,t){return this.get(e,"float",t)}getInt(e,t){return this.get(e,"int",t)}getString(e,t){return this.get(e,"string",t)}getTensor(e,t){return this.get(e,"tensor",t)}getFloats(e,t){return this.get(e,"floats",t)}getInts(e,t){return this.get(e,"ints",t)}getStrings(e,t){return this.get(e,"strings",t)}getTensors(e,t){return this.get(e,"tensors",t)}get(e,t,r){const n=this._attributes.get(e);if(void 0===n){if(void 0!==r)return r;throw new Error(`required attribute not found: ${e}`)}if(n[1]!==t)throw new Error(`type mismatch: expected ${t} but got ${n[1]}`);return n[0]}static getType(e){const t=e instanceof n.onnx.AttributeProto?e.type:e.type();switch(t){case n.onnx.AttributeProto.AttributeType.FLOAT:return"float";case n.onnx.AttributeProto.AttributeType.INT:return"int";case n.onnx.AttributeProto.AttributeType.STRING:return"string";case n.onnx.AttributeProto.AttributeType.TENSOR:return"tensor";case n.onnx.AttributeProto.AttributeType.FLOATS:return"floats";case n.onnx.AttributeProto.AttributeType.INTS:return"ints";case n.onnx.AttributeProto.AttributeType.STRINGS:return"strings";case n.onnx.AttributeProto.AttributeType.TENSORS:return"tensors";default:throw new Error(`attribute type is not supported yet: ${n.onnx.AttributeProto.AttributeType[t]}`)}}static getValue(e){const t=e instanceof n.onnx.AttributeProto?e.type:e.type();if(t===n.onnx.AttributeProto.AttributeType.GRAPH||t===n.onnx.AttributeProto.AttributeType.GRAPHS)throw new Error("graph attribute is not supported yet");const r=this.getValueNoCheck(e);if(t===n.onnx.AttributeProto.AttributeType.INT&&s.LongUtil.isLong(r))return s.LongUtil.longToNumber(r);if(t===n.onnx.AttributeProto.AttributeType.INTS){const e=r,t=new Array(e.length);for(let r=0;r<e.length;r++){const n=e[r];t[r]=s.LongUtil.longToNumber(n)}return t}if(t===n.onnx.AttributeProto.AttributeType.TENSOR)return e instanceof n.onnx.AttributeProto?o.Tensor.fromProto(r):o.Tensor.fromOrtTensor(r);if(t===n.onnx.AttributeProto.AttributeType.TENSORS){if(e instanceof n.onnx.AttributeProto)return r.map((e=>o.Tensor.fromProto(e)));if(e instanceof a.Attribute)return r.map((e=>o.Tensor.fromOrtTensor(e)))}if(t===n.onnx.AttributeProto.AttributeType.STRING&&e instanceof n.onnx.AttributeProto){const e=r;return(0,s.decodeUtf8String)(e)}return t===n.onnx.AttributeProto.AttributeType.STRINGS&&e instanceof n.onnx.AttributeProto?r.map(s.decodeUtf8String):r}static getValueNoCheck(e){return e instanceof n.onnx.AttributeProto?this.getValueNoCheckFromOnnxFormat(e):this.getValueNoCheckFromOrtFormat(e)}static getValueNoCheckFromOnnxFormat(e){switch(e.type){case n.onnx.AttributeProto.AttributeType.FLOAT:return e.f;case n.onnx.AttributeProto.AttributeType.INT:return e.i;case n.onnx.AttributeProto.AttributeType.STRING:return e.s;case n.onnx.AttributeProto.AttributeType.TENSOR:return e.t;case n.onnx.AttributeProto.AttributeType.GRAPH:return e.g;case n.onnx.AttributeProto.AttributeType.FLOATS:return e.floats;case n.onnx.AttributeProto.AttributeType.INTS:return e.ints;case n.onnx.AttributeProto.AttributeType.STRINGS:return e.strings;case n.onnx.AttributeProto.AttributeType.TENSORS:return e.tensors;case n.onnx.AttributeProto.AttributeType.GRAPHS:return e.graphs;default:throw new Error(`unsupported attribute type: ${n.onnx.AttributeProto.AttributeType[e.type]}`)}}static getValueNoCheckFromOrtFormat(e){switch(e.type()){case a.AttributeType.FLOAT:return e.f();case a.AttributeType.INT:return e.i();case a.AttributeType.STRING:return e.s();case a.AttributeType.TENSOR:return e.t();case a.AttributeType.GRAPH:return e.g();case a.AttributeType.FLOATS:return e.floatsArray();case a.AttributeType.INTS:{const t=[];for(let r=0;r<e.intsLength();r++)t.push(e.ints(r));return t}case a.AttributeType.STRINGS:{const t=[];for(let r=0;r<e.stringsLength();r++)t.push(e.strings(r));return t}case a.AttributeType.TENSORS:{const t=[];for(let r=0;r<e.tensorsLength();r++)t.push(e.tensors(r));return t}default:throw new Error(`unsupported attribute type: ${a.AttributeType[e.type()]}`)}}}t.Attribute=c},1975:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resolveBackend=t.backend=void 0;const n=r(4418),i=new Map;async function o(e){const r=t.backend;if(void 0!==r[e]&&function(e){const t=e;return"initialize"in t&&"function"==typeof t.initialize&&"createSessionHandler"in t&&"function"==typeof t.createSessionHandler&&"dispose"in t&&"function"==typeof t.dispose}(r[e])){const t=r[e];let n=t.initialize();if("object"==typeof n&&"then"in n&&(n=await n),n)return i.set(e,t),t}}t.backend={webgl:new n.WebGLBackend},t.resolveBackend=async function e(t){if(!t)return e(["webgl"]);{const e="string"==typeof t?[t]:t;for(const t of e){const e=i.get(t);if(e)return e;const r=await o(t);if(r)return r}}throw new Error("no available backend to use")}},4418:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLBackend=void 0;const n=r(8453),i=r(1315),o=r(2171),s=r(3389);t.WebGLBackend=class{get contextId(){return n.env.webgl.contextId}set contextId(e){n.env.webgl.contextId=e}get matmulMaxBatchSize(){return n.env.webgl.matmulMaxBatchSize}set matmulMaxBatchSize(e){n.env.webgl.matmulMaxBatchSize=e}get textureCacheMode(){return n.env.webgl.textureCacheMode}set textureCacheMode(e){n.env.webgl.textureCacheMode=e}get pack(){return n.env.webgl.pack}set pack(e){n.env.webgl.pack=e}get async(){return n.env.webgl.async}set async(e){n.env.webgl.async=e}initialize(){try{return this.glContext=(0,s.createWebGLContext)(this.contextId),"number"!=typeof this.matmulMaxBatchSize&&(this.matmulMaxBatchSize=16),"string"!=typeof this.textureCacheMode&&(this.textureCacheMode="full"),"boolean"!=typeof this.pack&&(this.pack=!1),"boolean"!=typeof this.async&&(this.async=!1),i.Logger.setWithEnv(n.env),i.Logger.verbose("WebGLBackend",`Created WebGLContext: ${typeof this.glContext} with matmulMaxBatchSize: ${this.matmulMaxBatchSize}; textureCacheMode: ${this.textureCacheMode}; pack: ${this.pack}; async: ${this.async}.`),!0}catch(e){return i.Logger.warning("WebGLBackend",`Unable to initialize WebGLBackend. ${e}`),!1}}createSessionHandler(e){return new o.WebGLSessionHandler(this,e)}dispose(){this.glContext.dispose()}}},6859:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoordsGlslLib=void 0;const n=r(7273),i=r(1997),o=r(6757),s=r(7618),a=r(432);class c extends i.GlslLib{constructor(e){super(e)}getFunctions(){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.offsetToCoords()),this.coordsToOffset()),this.toVec()),this.valueFrom()),this.getCommonUtilFuncs()),this.getInputsSamplingSnippets()),this.getOutputSamplingSnippet())}getCustomTypes(){return{}}offsetToCoords(){return{offsetToCoords:new i.GlslLibRoutine("\n      vec2 offsetToCoords(int offset, int width, int height) {\n        int t = offset / width;\n        int s = offset - t*width;\n        vec2 coords = (vec2(s,t) + vec2(0.5,0.5)) / vec2(width, height);\n        return coords;\n      }\n      ")}}coordsToOffset(){return{coordsToOffset:new i.GlslLibRoutine("\n      int coordsToOffset(vec2 coords, int width, int height) {\n        float s = coords.s * float(width);\n        float t = coords.t * float(height);\n        int offset = int(t) * width + int(s);\n        return offset;\n      }\n      ")}}getOutputSamplingSnippet(){const e=this.context.outputTextureLayout;return e.isPacked?this.getPackedOutputSamplingSnippet(e):this.getUnpackedOutputSamplingSnippet(e)}getPackedOutputSamplingSnippet(e){const t=e.unpackedShape,r=[e.width,e.height],n={},s="getOutputCoords";switch(t.length){case 0:n[s]=this.getOutputScalarCoords();break;case 1:n[s]=this.getOutputPacked1DCoords(t,r);break;case 2:n[s]=this.getOutputPacked2DCoords(t,r);break;case 3:n[s]=this.getOutputPacked3DCoords(t,r);break;default:n[s]=this.getOutputPackedNDCoords(t,r)}const a=`\n      void setOutput(vec4 val) {\n        ${(0,o.getGlsl)(this.context.glContext.version).output} = val;\n      }\n    `;return n.floatTextureSetRGBA=new i.GlslLibRoutine(a),n}getUnpackedOutputSamplingSnippet(e){const t=e.unpackedShape,r=[e.width,e.height],n={},s="getOutputCoords";switch(t.length){case 0:n[s]=this.getOutputScalarCoords();break;case 1:n[s]=this.getOutputUnpacked1DCoords(t,r);break;case 2:n[s]=this.getOutputUnpacked2DCoords(t,r);break;case 3:n[s]=this.getOutputUnpacked3DCoords(t,r);break;case 4:n[s]=this.getOutputUnpacked4DCoords(t,r);break;case 5:n[s]=this.getOutputUnpacked5DCoords(t,r);break;case 6:n[s]=this.getOutputUnpacked6DCoords(t,r);break;default:throw new Error(`Unsupported output dimensionality: ${t.length}`)}const a=`\n        void setOutput(float val) {\n          ${(0,o.getGlsl)(this.context.glContext.version).output} = vec4(val, 0, 0, 0);\n        }\n    `;return n.floatTextureSetR=new i.GlslLibRoutine(a),n}getOutputScalarCoords(){return new i.GlslLibRoutine("\n      int getOutputCoords() {\n        return 0;\n      }\n    ")}getOutputPacked1DCoords(e,t){const r=t;let n="";return 1===r[0]?(n=`\n          int getOutputCoords() {\n            return 2 * int(TexCoords.y * ${r[1]}.0);\n          }\n        `,new i.GlslLibRoutine(n)):1===r[1]?(n=`\n          int getOutputCoords() {\n            return 2 * int(TexCoords.x * ${r[0]}.0);\n          }\n        `,new i.GlslLibRoutine(n)):(n=`\n        int getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                 vec2(${r[0]}, ${r[1]}));\n          return 2 * (resTexRC.y * ${r[0]} + resTexRC.x);\n        }\n      `,new i.GlslLibRoutine(n))}getOutputPacked2DCoords(e,t){let r="";if(n.ArrayUtil.arraysEqual(e,t))return r=`\n        ivec2 getOutputCoords() {\n          return 2 * ivec2(TexCoords.xy * vec2(${t[0]}, ${t[1]}));\n        }\n      `,new i.GlslLibRoutine(r);const o=t,s=Math.ceil(e[1]/2);return r=`\n        ivec2 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(${o[0]}, ${o[1]}));\n\n          int index = resTexRC.y * ${o[0]} + resTexRC.x;\n\n          // reverse r and c order for packed texture\n          int r = imod(index, ${s}) * 2;\n          int c = 2 * (index / ${s});\n\n          return ivec2(r, c);\n        }\n      `,new i.GlslLibRoutine(r)}getOutputPacked3DCoords(e,t){const r=[t[0],t[1]],n=Math.ceil(e[2]/2),o=n*Math.ceil(e[1]/2),s=`\n        ivec3 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(${r[0]}, ${r[1]}));\n          int index = resTexRC.y * ${r[0]} + resTexRC.x;\n\n          int b = index / ${o};\n          index -= b * ${o};\n\n          // reverse r and c order for packed texture\n          int r = imod(index, ${n}) * 2;\n          int c = 2 * (index / ${n});\n\n          return ivec3(b, r, c);\n        }\n      `;return new i.GlslLibRoutine(s)}getOutputPackedNDCoords(e,t){const r=[t[0],t[1]],n=Math.ceil(e[e.length-1]/2),o=n*Math.ceil(e[e.length-2]/2);let s=o,a="",c="b, r, c";for(let t=2;t<e.length-1;t++)s*=e[e.length-t-1],a=`\n      int b${t} = index / ${s};\n      index -= b${t} * ${s};\n    `+a,c=`b${t}, `+c;const u=`\n      ivec${e.length} getOutputCoords() {\n        ivec2 resTexRC = ivec2(TexCoords.xy *\n                              vec2(${r[0]}, ${r[1]}));\n        int index = resTexRC.y * ${r[0]} + resTexRC.x;\n\n        ${a}\n\n        int b = index / ${o};\n        index -= b * ${o};\n\n        // reverse r and c order for packed texture\n        int r = imod(index, ${n}) * 2;\n        int c = 2 * (index / ${n});\n\n        return ivec${e.length}(${c});\n      }\n    `;return new i.GlslLibRoutine(u)}getOutputUnpacked1DCoords(e,t){const r=`\n        int getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(${t[0]}, ${t[1]}));\n          return resTexRC.y * ${t[0]} + resTexRC.x;\n        }\n      `;return new i.GlslLibRoutine(r)}getOutputUnpacked2DCoords(e,t){const r=`\n        ivec2 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(${t[0]}, ${t[1]}));\n          int index = resTexRC.y * ${t[0]} + resTexRC.x;\n          int r = index / ${e[1]};\n          int c = index - r * ${e[1]};\n          return ivec2(r, c);\n        }\n      `;return new i.GlslLibRoutine(r)}getOutputUnpacked3DCoords(e,t){let r="";const n=e.length;let o=null;n<2&&(o=[]),o=new Array(n-1),o[n-2]=e[n-1];for(let t=n-3;t>=0;--t)o[t]=o[t+1]*e[t+1];const s=["r","c","d"],a=o.map(((e,t)=>`int ${s[t]} = index / ${e}; ${t===o.length-1?`int ${s[t+1]} = index - ${s[t]} * ${e}`:`index -= ${s[t]} * ${e}`};`)).join("");return r=`\n        ivec3 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(${t[0]}, ${t[1]}));\n          int index = resTexRC.y * ${t[0]} + resTexRC.x;\n          ${a}\n          return ivec3(r, c, d);\n        }\n      `,new i.GlslLibRoutine(r)}getOutputUnpacked4DCoords(e,t){let r="";const n=e.length;let o=null;n<2&&(o=[]),o=new Array(n-1),o[n-2]=e[n-1];for(let t=n-3;t>=0;--t)o[t]=o[t+1]*e[t+1];const s=["r","c","d","d2"],a=o.map(((e,t)=>`int ${s[t]} = index / ${e}; ${t===o.length-1?`int ${s[t+1]} = index - ${s[t]} * ${e}`:`index -= ${s[t]} * ${e}`};`)).join("");return r=`\n      ivec4 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(${t[0]}, ${t[1]}));\n          int index = resTexRC.y * ${t[0]} + resTexRC.x;\n          ${a}\n          return ivec4(r, c, d, d2);\n        }\n      `,new i.GlslLibRoutine(r)}getOutputUnpacked5DCoords(e,t){let r="";const n=e.length;let o=null;n<2&&(o=[]),o=new Array(n-1),o[n-2]=e[n-1];for(let t=n-3;t>=0;--t)o[t]=o[t+1]*e[t+1];const s=["r","c","d","d2","d3"],a=o.map(((e,t)=>`int ${s[t]} = index / ${e}; ${t===o.length-1?`int ${s[t+1]} = index - ${s[t]} * ${e}`:`index -= ${s[t]} * ${e}`};`)).join("");return r=`\n      ivec5 getOutputCoords() {\n          ivec2 resTexRC = ivec2(TexCoords.xy *\n                                vec2(${t[0]}, ${t[1]}));\n          int index = resTexRC.y * ${t[0]} + resTexRC.x;\n          ${a}\n          return ivec5(r, c, d, d2, d3);\n        }\n      `,new i.GlslLibRoutine(r)}getOutputUnpacked6DCoords(e,t){let r="";const n=e.length;let o=null;n<2&&(o=[]),o=new Array(n-1),o[n-2]=e[n-1];for(let t=n-3;t>=0;--t)o[t]=o[t+1]*e[t+1];const s=["r","c","d","d2","d3","d4"],a=o.map(((e,t)=>`int ${s[t]} = index / ${e}; ${t===o.length-1?`int ${s[t+1]} = index - ${s[t]} * ${e}`:`index -= ${s[t]} * ${e}`};`)).join("");return r=`\n     ivec6 getOutputCoords() {\n         ivec2 resTexRC = ivec2(TexCoords.xy *\n                               vec2(${t[0]}, ${t[1]}));\n         int index = resTexRC.y * ${t[0]} + resTexRC.x;\n         ${a}\n         return ivec6(r, c, d, d2, d3, d4);\n       }\n     `,new i.GlslLibRoutine(r)}getCommonUtilFuncs(){const e={};let t="uvFromFlat";e[t]=new i.GlslLibRoutine("\n    vec2 uvFromFlat(int texNumR, int texNumC, int index) {\n      int texC = index / texNumR;\n      int texR = index - texC * texNumR;\n      // TODO: swap texR, texC order in following function so row is corresponding to u and column is corresponding to\n      //       v.\n      return (vec2(texR, texC) + halfCR) / vec2(texNumR, texNumC);\n    }\n    "),t="packedUVfrom1D",e[t]=new i.GlslLibRoutine("\n      vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n        int texelIndex = index / 2;\n        int texR = texelIndex / texNumC;\n        int texC = texelIndex - texR * texNumC;\n        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n      }\n      "),t="packedUVfrom2D",e[t]=new i.GlslLibRoutine("\n      vec2 packedUVfrom2D(int texNumR, int texNumC, int texelsInLogicalRow, int row, int col) {\n        int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n        int texR = texelIndex / texNumC;\n        int texC = texelIndex - texR * texNumC;\n        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n      }\n      "),t="packedUVfrom3D",e[t]=new i.GlslLibRoutine("\n      vec2 packedUVfrom3D(int texNumR, int texNumC,\n          int texelsInBatch, int texelsInLogicalRow, int b,\n          int row, int col) {\n        int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n        int texR = index / texNumC;\n        int texC = index - texR * texNumC;\n        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n      }\n      "),t="sampleTexture";const r=(0,o.getGlsl)(this.context.glContext.version);return e[t]=new i.GlslLibRoutine(`\n        float sampleTexture(sampler2D textureSampler, vec2 uv) {\n            return ${r.texture2D}(textureSampler, uv).r;\n        }`),e}getInputsSamplingSnippets(){const e={},t=this.context.outputTextureLayout;return this.context.programInfo.inputNames.forEach(((r,n)=>{const i=this.context.inputTextureLayouts[n],o=(0,a.generateShaderFuncNameFromInputSamplerName)(r);i.isPacked?e[o]=this.getPackedSamplerFromInput(o,r,i):e[o]=this.getUnpackedSamplerFromInput(o,r,i);const s=(0,a.generateShaderFuncNameFromInputSamplerNameAtOutCoords)(r);i.unpackedShape.length<=t.unpackedShape.length&&(i.isPacked?e[s]=this.getPackedSamplerAtOutputCoords(s,i,t,r):e[s]=this.getUnpackedSamplerAtOutputCoords(s,i,t,r))})),e}getPackedSamplerAtOutputCoords(e,t,r,o){const s=t.unpackedShape,c=r.unpackedShape,u=o,l=(0,a.generateShaderFuncNameFromInputSamplerName)(u),d=s.length,h=c.length,f=n.BroadcastUtil.getBroadcastDims(s,c),p=(0,a.getCoordsDataType)(h),m=h-d;let g;const v=(0,a.getGlChannels)();g=0===d?"":h<2&&f.length>=1?"coords = 0;":f.map((e=>`coords.${v[e+m]} = 0;`)).join("\n");let y="";y=h<2&&d>0?"coords":s.map(((e,t)=>`coords.${v[t+m]}`)).join(", ");let b="return outputValue;";const E=1===n.ShapeUtil.size(s),w=1===n.ShapeUtil.size(c);if(1!==d||E||w){if(E&&!w)b=1===h?"\n          return vec4(outputValue.x, outputValue.x, 0., 0.);\n        ":"\n          return vec4(outputValue.x);\n        ";else if(f.length){const e=d-2,t=d-1;f.indexOf(e)>-1&&f.indexOf(t)>-1?b="return vec4(outputValue.x);":f.indexOf(e)>-1?b="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":f.indexOf(t)>-1&&(b="return vec4(outputValue.xx, outputValue.zz);")}}else b="\n        return vec4(outputValue.xy, outputValue.xy);\n      ";const S=`\n      vec4 ${e}() {\n        ${p} coords = getOutputCoords();\n        \n        int lastDim = coords.${v[h-1]};\n        coords.${v[h-1]} = coords.${v[h-2]};\n        coords.${v[h-2]} = lastDim;\n      \n        ${g}\n        vec4 outputValue = ${l}(${y});\n        ${b}\n      }\n    `;return new i.GlslLibRoutine(S,["coordinates.getOutputCoords"])}getUnpackedSamplerAtOutputCoords(e,t,r,o){const s=[r.width,r.height],c=[t.width,t.height],u=t.unpackedShape.length,l=r.unpackedShape.length,d=t.unpackedShape,h=r.unpackedShape,f=(0,a.generateShaderFuncNameFromInputSamplerName)(o);if(u===l&&n.ArrayUtil.arraysEqual(c,s)){const t=`\n          float ${e}() {\n            return sampleTexture(${o}, TexCoords);\n          }\n        `;return new i.GlslLibRoutine(t,["coordinates.sampleTexture"])}const p=(0,a.getCoordsDataType)(l),m=n.BroadcastUtil.getBroadcastDims(d,h),g=l-u;let v;const y=(0,a.getGlChannels)();v=0===u?"":l<2&&m.length>=1?"coords = 0;":m.map((e=>`coords.${y[e+g]} = 0;`)).join("\n");let b="";b=l<2&&u>0?"coords":t.unpackedShape.map(((e,t)=>`coords.${y[t+g]}`)).join(", ");const E=`\n        float ${e}() {\n          ${p} coords = getOutputCoords();\n          ${v}\n          return ${f}(${b});\n        }\n      `;return new i.GlslLibRoutine(E,["coordinates.getOutputCoords"])}getPackedSamplerFromInput(e,t,r){switch(r.unpackedShape.length){case 0:return this.getPackedSamplerScalar(e,t);case 1:return this.getPackedSampler1D(e,t,r);case 2:return this.getPackedSampler2D(e,t,r);case 3:return this.getPackedSampler3D(e,t,r);default:return this.getPackedSamplerND(e,t,r)}}getUnpackedSamplerFromInput(e,t,r){const n=r.unpackedShape;switch(n.length){case 0:return this.getUnpackedSamplerScalar(e,t,r);case 1:return this.getUnpackedSampler1D(e,t,r);case 2:return this.getUnpackedSampler2D(e,t,r);case 3:return this.getUnpackedSampler3D(e,t,r);case 4:return this.getUnpackedSampler4D(e,t,r);case 5:return this.getUnpackedSampler5D(e,t,r);case 6:return this.getUnpackedSampler6D(e,t,r);default:throw new Error(`Unsupported dimension ${n.length}-D`)}}getPackedSamplerScalar(e,t){const r=`\n          vec4 ${e}() {\n            return ${(0,o.getGlsl)(this.context.glContext.version).texture2D}(${t}, halfCR);\n          }\n        `;return new i.GlslLibRoutine(r)}getPackedSampler1D(e,t,r){const n=[r.width,r.height],s=[n[1],n[0]],a=(0,o.getGlsl)(this.context.glContext.version),c=`vec4 ${e}(int index) {\n      vec2 uv = packedUVfrom1D(\n      ${s[0]}, ${s[1]}, index);\n      return ${a.texture2D}(${t}, uv);\n    }`;return new i.GlslLibRoutine(c,["coordinates.packedUVfrom1D"])}getPackedSampler2D(e,t,r){const s=r.unpackedShape,a=[r.width,r.height],c=(0,o.getGlsl)(this.context.glContext.version),u=a[0],l=a[1];if(null!=a&&n.ArrayUtil.arraysEqual(s,a)){const r=`vec4 ${e}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${l}.0, ${u}.0);\n        return ${c.texture2D}(${t}, uv);\n      }`;return new i.GlslLibRoutine(r)}const d=a,h=Math.ceil(s[1]/2),f=`vec4 ${e}(int row, int col) {\n      vec2 uv = packedUVfrom2D(${d[1]}, ${d[0]}, ${h}, row, col);\n      return ${c.texture2D}(${t}, uv);\n    }`;return new i.GlslLibRoutine(f,["coordinates.packedUVfrom2D"])}getPackedSampler3D(e,t,r){const n=r.unpackedShape,s=[r.width,r.height],c=[s[0],s[1]],u=(0,o.getGlsl)(this.context.glContext.version);if(1===n[0]){const o=n.slice(1),s=[1,2],c=(0,a.squeezeInputShape)(n,o),u=["b","row","col"],l=JSON.parse(JSON.stringify(r));l.unpackedShape=c;const d=this.getPackedSamplerFromInput(e,t,l),h=`${d.routineBody}\n      vec4 ${e}(int b, int row, int col) {\n        return ${e}(${(0,a.getSqueezedParams)(u,s)});\n      } `;return new i.GlslLibRoutine(h,d.dependencies)}const l=c[0],d=c[1],h=Math.ceil(n[2]/2),f=`vec4 ${e}(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ${d}, ${l}, ${h*Math.ceil(n[1]/2)}, ${h}, b, row, col);\n      return ${u.texture2D}(${t}, uv);}`;return new i.GlslLibRoutine(f,["coordinates.packedUVfrom3D"])}getPackedSamplerND(e,t,r){const n=r.unpackedShape,s=n.length,a=[r.width,r.height],c=(0,o.getGlsl)(this.context.glContext.version),u=[a[0],a[1]],l=u[1],d=u[0],h=Math.ceil(n[s-1]/2);let f=h*Math.ceil(n[s-2]/2),p="int b, int row, int col",m=`b * ${f} + (row / 2) * ${h} + (col / 2)`;for(let e=2;e<s-1;e++)p=`int b${e}, `+p,f*=n[s-e-1],m=`b${e} * ${f} + `+m;const g=`vec4 ${e}(${p}) {\n      int index = ${m};\n      int texR = index / ${d};\n      int texC = index - texR * ${d};\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}, ${l});\n      return ${c.texture2D}(${t}, uv);\n    }`;return new i.GlslLibRoutine(g)}getUnpackedSamplerScalar(e,t,r){const[n,o]=[r.width,r.height];if(1===n&&1===o){const r=`\n          float ${e}() {\n            return sampleTexture(${t}, halfCR);\n          }\n        `;return new i.GlslLibRoutine(r,["coordinates.sampleTexture"])}const s=`\n        float ${e}() {\n          int offset_${t} = coordsToOffset(TexCoords, ${n}, ${o});\n          vec2 uv = uvFromFlat(${n}, ${o}, offset_${t});\n          return sampleTexture(${t}, uv);\n        }\n      `;return new i.GlslLibRoutine(s,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler1D(e,t,r){const n=r.width,o=r.height;if(1===o&&1===n){const r=`\n        float ${e}(int index) {\n          return sampleTexture(${t}, halfCR);\n        }\n      `;return new i.GlslLibRoutine(r,["coordinates.sampleTexture"])}if(1===o){const r=`\n          float ${e}(int index) {\n            vec2 uv = vec2((float(index) + 0.5) / ${n}.0, 0.5);\n            return sampleTexture(${t}, uv);\n          }\n        `;return new i.GlslLibRoutine(r,["coordinates.sampleTexture"])}if(1===n){const r=`\n          float ${e}(int index) {\n            vec2 uv = vec2(0.5, (float(index) + 0.5) / ${o}.0);\n            return sampleTexture(${t}, uv);\n          }\n        `;return new i.GlslLibRoutine(r,["coordinates.sampleTexture"])}const s=`\n        float ${e}(int index) {\n          vec2 uv = uvFromFlat(${n}, ${o}, index);\n          return sampleTexture(${t}, uv);\n        }\n      `;return new i.GlslLibRoutine(s,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler2D(e,t,r){const o=r.unpackedShape,c=[r.height,r.width];if(null!=c&&n.ArrayUtil.arraysEqual(o,c)){const r=`\n          float ${e}(int row, int col) {\n            vec2 uv = (vec2(row, col) + halfCR) / vec2(${c[1]}.0, ${c[0]}.0);\n            return sampleTexture(${t}, uv);\n          }\n        `;return new i.GlslLibRoutine(r,["coordinates.sampleTexture"])}const{newShape:u,keptDims:l}=(0,s.squeezeShape)(o),d=u;if(d.length<o.length){const n=(0,a.squeezeInputShape)(o,d),s=JSON.parse(JSON.stringify(r));s.unpackedShape=n;const c=["col","row"],u=`\n          ${this.getUnpackedSamplerFromInput(e,t,s).routineBody}\n          float ${e}(int row, int col) {\n            return ${e}(${(0,a.getSqueezedParams)(c,l)});\n          }\n        `;return new i.GlslLibRoutine(u,["coordinates.sampleTexture"])}const h=c[1],f=c[0];if(1===f){const r=`\n          float ${e}(int row, int col) {\n            int offset_${t} = coordsToOffset(TexCoords, ${h}, ${f});\n            float index = dot(vec3(row, col, offset_${t}), vec3(${o[1]}, 1, 1));\n            vec2 uv = vec2(0.5, (index + 0.5) / ${h}.0);\n            return sampleTexture(${t}, uv);\n          }\n        `;return new i.GlslLibRoutine(r,["coordinates.sampleTexture","coordinates.coordsToOffset"])}if(1===h){const r=`\n          float ${e}(int row, int col) {\n            int offset_${t} = coordsToOffset(TexCoords, ${h}, ${f});\n            float index = dot(vec3(row, col, offset_${t}), vec3(${o[1]}, 1, 1));\n            vec2 uv = vec2((index + 0.5) / ${f}.0, 0.5);\n            return sampleTexture(${t}, uv);\n          }\n        `;return new i.GlslLibRoutine(r,["coordinates.sampleTexture","coordinates.coordsToOffset"])}const p=`\n        float ${e}(int row, int col) {\n          int index = col * ${o[1]} + row;\n          vec2 uv = uvFromFlat(${h}, ${f}, index);\n          return sampleTexture(${t}, uv);\n        }\n      `;return new i.GlslLibRoutine(p,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler3D(e,t,r){const n=r.unpackedShape,o=n[1]*n[2],c=n[2],{newShape:u,keptDims:l}=(0,s.squeezeShape)(n),d=u;if(d.length<n.length){const o=(0,a.squeezeInputShape)(n,d),s=["batch","col","row"],c=JSON.parse(JSON.stringify(r));c.unpackedShape=o;const u=this.getUnpackedSamplerFromInput(e,t,c),h=l.reverse(),f=`\n          ${u.routineBody}\n          float ${e}(int batch, int row, int col) {\n            return ${e}(${(0,a.getSqueezedParams)(s,h)});\n          }\n        `;return new i.GlslLibRoutine(f,u.dependencies)}const h=`\n          float ${e}(int depth, int row, int col) {\n            // Explicitly use integer operations as dot() only works on floats.\n            int index = depth * ${o} + col * ${c} + row;\n            vec2 uv = uvFromFlat(${r.width}, ${r.height}, index);\n            return sampleTexture(${t}, uv);\n          }\n      `;return new i.GlslLibRoutine(h,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler4D(e,t,r){const n=r.unpackedShape,o=n[3],s=n[2]*o,a=`\n        float ${e}(int row, int col, int depth, int depth2) {\n          int index = row * ${n[1]*s} + col * ${s} +\n              depth2 * ${o} + depth;\n          vec2 uv = uvFromFlat(${r.width}, ${r.height}, index);\n          return sampleTexture(${t}, uv);\n        }\n      `;return new i.GlslLibRoutine(a,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler5D(e,t,r){const n=r.unpackedShape,o=n[4],c=n[3]*o,u=n[2]*c,l=n[1]*u,{newShape:d,keptDims:h}=(0,s.squeezeShape)(n);if(d.length<n.length){const o=(0,a.squeezeInputShape)(n,d),s=["row","col","depth","depth2","depth3"],c=JSON.parse(JSON.stringify(r));c.unpackedShape=o;const u=`\n          ${this.getUnpackedSamplerFromInput(e,t,c).routineBody}\n          float ${e}(int row, int col, int depth, int depth2, int depth3) {\n            return ${e}(${(0,a.getSqueezedParams)(s,h)});\n          }\n        `;return new i.GlslLibRoutine(u,["coordinates.sampleTexture","coordinates.uvFromFlat"])}const f=`\n        float ${e}(int row, int col, int depth, int depth2, int depth3) {\n          int index = row * ${l} + col * ${u} + depth * ${c} +\n          depth3 * ${o} + depth2;\n          vec2 uv = uvFromFlat(${r.width}, ${r.height}, index);\n          return sampleTexture(${t}, uv);\n        }\n      `;return new i.GlslLibRoutine(f,["coordinates.sampleTexture","coordinates.uvFromFlat"])}getUnpackedSampler6D(e,t,r){const n=r.unpackedShape,o=n[5],c=n[4]*o,u=n[3]*c,l=n[2]*u,d=n[1]*l,{newShape:h,keptDims:f}=(0,s.squeezeShape)(n);if(h.length<n.length){const o=(0,a.squeezeInputShape)(n,h),s=["row","col","depth","depth2","depth3","depth4"],c=JSON.parse(JSON.stringify(r));c.unpackedShape=o;const u=`\n            ${this.getUnpackedSamplerFromInput(e,t,c).routineBody}\n            float ${e}(int row, int col, int depth,\n              int depth2, int depth3, int depth4) {\n              return ${e}(${(0,a.getSqueezedParams)(s,f)});\n            }\n          `;return new i.GlslLibRoutine(u,["coordinates.sampleTexture","coordinates.uvFromFlat"])}const p=`\n          float ${e}(int row, int col, int depth,\n            int depth2, int depth3, int depth4) {\n            int index = row * ${d} + col * ${l} + depth * ${u} +\n            depth2 * ${c} + depth3 * ${o} + depth4;\n            vec2 uv = uvFromFlat(${r.width}, ${r.height}, index);\n            return sampleTexture(${t}, uv);\n          }\n        `;return new i.GlslLibRoutine(p,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}toVec(){const e=this.context.outputTextureLayout,t=e.shape.length,r=e.strides,n=e.width,o=e.height,s=[];for(let e=0;e<t-1;++e)s.push(`\n        c[${e}] = offset / ${r[e]};`),s.push(`\n        offset -= c[${e}] * ${r[e]};`);s.push(`\n        c[${t-1}] = offset;`);const a=`\n      void toVec(vec2 texCoords, out int c[${t}]) {\n        int offset = coordsToOffset(texCoords, ${n}, ${o});\n        ${s.join("")}\n      }\n      void toVec(int offset, out int c[${t}]) {\n        ${s.join("")}\n      }\n    `;return{toVec:new i.GlslLibRoutine(a,["coordinates.coordsToOffset"])}}valueFrom(){const e={};return this.context.programInfo.inputNames.forEach(((t,r)=>{const n=this.context.inputTextureLayouts[r],o=(n.unpackedShape.length>0?n.unpackedShape:n.shape).length;let s=`_${t}`;e[s]=new i.GlslLibRoutine(this.getValueFromSingle(t,o,n.width,n.height,!1),[`shapeUtils.indicesToOffset${s}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"]),s+="_T",e[s]=new i.GlslLibRoutine(this.getValueFromSingle(t,o,n.width,n.height,!0),[`shapeUtils.indicesToOffset${s}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"])})),e}getValueFromSingle(e,t,r,n,i){let s=`_${e}`;return i&&(s+="_T"),`\n        float ${s}(int m[${t}]) {\n          int offset = indicesToOffset${s}(m);\n          vec2 coords = offsetToCoords(offset, ${r}, ${n});\n          float value = getColorAsFloat(${(0,o.getGlsl)(this.context.glContext.version).texture2D}(${e}, coords));\n          return value;\n        }\n        `}getPackedValueFrom(e,t,r,n,i){let s=`_${e}_Pack`;return i&&(s+="_T"),`\n        vec4 ${s}(int m[${t}]) {\n          int offset = indicesToOffset_${e}(m);\n          vec2 coords = offsetToCoords(offset, ${r}, ${n});\n          return ${(0,o.getGlsl)(this.context.glContext.version).texture2D}(${e}, coords);\n        }\n        `}}t.CoordsGlslLib=c},1997:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.TopologicalSortGlslRoutines=t.GlslLibRoutineNode=t.GlslLibRoutine=t.GlslLib=t.GlslContext=t.FunctionType=void 0,(r=t.FunctionType||(t.FunctionType={}))[r.ValueBased=0]="ValueBased",r[r.Positional=1]="Positional",t.GlslContext=class{constructor(e,t,r,n){this.glContext=e,this.programInfo=t,this.inputTextureLayouts=r,this.outputTextureLayout=n}},t.GlslLib=class{constructor(e){this.context=e}},t.GlslLibRoutine=class{constructor(e,t){this.routineBody=e,this.dependencies=t}},t.GlslLibRoutineNode=class{constructor(e,t,r){this.name=e,this.dependencies=r||[],t&&(this.routineBody=t)}addDependency(e){e&&this.dependencies.push(e)}},t.TopologicalSortGlslRoutines=class{static returnOrderedNodes(e){if(!e||0===e.length)return[];if(1===e.length)return e;const t=new Set,r=new Set,n=new Array;return this.createOrderedNodes(e,t,r,n),n}static createOrderedNodes(e,t,r,n){for(let i=0;i<e.length;++i)this.dfsTraverse(e[i],t,r,n)}static dfsTraverse(e,t,r,n){if(!e||r.has(e.name))return;if(t.has(e.name))throw new Error("Cyclic dependency detected. Can't topologically sort routines needed for shader.");t.add(e.name);const i=e.dependencies;if(i&&i.length>0)for(let e=0;e<i.length;++e)this.dfsTraverse(i[e],t,r,n);n.push(e),r.add(e.name),t.delete(e.name)}}},1371:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EncodingGlslLib=void 0;const n=r(1997);class i extends n.GlslLib{constructor(e){super(e)}getFunctions(){return Object.assign(Object.assign({},this.encodeFloat32()),this.decodeFloat32())}getCustomTypes(){return{}}encodeFloat32(){return{encode:new n.GlslLibRoutine("highp vec4 encode(highp float f) {\n        return vec4(f, 0.0, 0.0, 0.0);\n      }\n        ")}}decodeFloat32(){return{decode:new n.GlslLibRoutine("highp float decode(highp vec4 rgba) {\n        return rgba.r;\n      }\n        ")}}encodeUint8(){const e=i.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{encode:new n.GlslLibRoutine(`\n      highp vec4 encode(highp float f) {\n        highp float F = abs(f);\n        highp float Sign = step(0.0,-f);\n        highp float Exponent = floor(log2(F));\n        highp float Mantissa = (exp2(- Exponent) * F);\n        Exponent = floor(log2(F) + 127.0) + floor(log2(Mantissa));\n        highp vec4 rgba;\n        rgba[0] = 128.0 * Sign  + floor(Exponent*exp2(-1.0));\n        rgba[1] = 128.0 * mod(Exponent,2.0) + mod(floor(Mantissa*128.0),128.0);\n        rgba[2] = floor(mod(floor(Mantissa*exp2(23.0 -8.0)),exp2(8.0)));\n        rgba[3] = floor(exp2(23.0)*mod(Mantissa,exp2(-15.0)));\n        ${e}\n        rgba = rgba / 255.0; // values need to be normalized to [0,1]\n        return rgba;\n    }\n        `)}}decodeUint8(){const e=i.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{decode:new n.GlslLibRoutine(`\n        highp float decode(highp vec4 rgba) {\n          rgba = rgba * 255.0; // values need to be de-normalized from [0,1] to [0,255]\n          ${e}\n          highp float Sign = 1.0 - step(128.0,rgba[0])*2.0;\n          highp float Exponent = 2.0 * mod(rgba[0],128.0) + step(128.0,rgba[1]) - 127.0;\n          highp float Mantissa = mod(rgba[1],128.0)*65536.0 + rgba[2]*256.0 +rgba[3] + float(0x800000);\n          highp float Result =  Sign * exp2(Exponent) * (Mantissa * exp2(-23.0 ));\n          return Result;\n      }\n        `)}}static isLittleEndian(){const e=new ArrayBuffer(4),t=new Uint32Array(e),r=new Uint8Array(e);if(t[0]=3735928559,239===r[0])return!0;if(222===r[0])return!1;throw new Error("unknown endianness")}}t.EncodingGlslLib=i},2691:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FragColorGlslLib=void 0;const n=r(1997),i=r(6757);class o extends n.GlslLib{constructor(e){super(e)}getFunctions(){return Object.assign(Object.assign({},this.setFragColor()),this.getColorAsFloat())}getCustomTypes(){return{}}setFragColor(){const e=(0,i.getGlsl)(this.context.glContext.version);return{setFragColor:new n.GlslLibRoutine(`\n        void setFragColor(float value) {\n            ${e.output} = encode(value);\n        }\n        `,["encoding.encode"])}}getColorAsFloat(){return{getColorAsFloat:new n.GlslLibRoutine("\n        float getColorAsFloat(vec4 color) {\n            return decode(color);\n        }\n        ",["encoding.decode"])}}}t.FragColorGlslLib=o},3878:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.replaceInlines=void 0;const r=/@inline[\s\n\r]+(\w+)[\s\n\r]+([0-9a-zA-Z_]+)\s*\(([^)]*)\)\s*{(([^}]|[\n\r])*)}/gm;t.replaceInlines=function(e){const t={};let n;for(;null!==(n=r.exec(e));){const e=n[3].split(",").map((e=>{const t=e.trim().split(" ");return t&&2===t.length?{type:t[0],name:t[1]}:null})).filter((e=>null!==e));t[n[2]]={params:e,body:n[4]}}for(const r in t){const i="(\\w+)?\\s+([_0-9a-zA-Z]+)\\s+=\\s+__FUNC__\\((.*)\\)\\s*;".replace("__FUNC__",r),o=new RegExp(i,"gm");for(;null!==(n=o.exec(e));){const i=n[1],o=n[2],s=n[3].split(","),a=i?`${i} ${o};`:"";let c=t[r].body,u="";t[r].params.forEach(((e,t)=>{e&&(u+=`${e.type} ${e.name} = ${s[t]};\n`)})),c=`${u}\n ${c}`,c=c.replace("return",`${o} = `);const l=`\n      ${a}\n      {\n        ${c}\n      }\n      `;e=e.replace(n[0],l)}}return e.replace(r,"")}},8897:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GlslPreprocessor=void 0;const n=r(1997),i=r(3878),o=r(1248),s=r(6757);t.GlslPreprocessor=class{constructor(e,t,r,i){this.libs={},this.glslLibRoutineDependencyGraph={},this.context=new n.GlslContext(e,t,r,i),Object.keys(o.glslRegistry).forEach((e=>{const t=new o.glslRegistry[e](this.context);this.libs[e]=t}));const s=this.glslLibRoutineDependencyGraph;for(const e in this.libs){const t=this.libs[e].getFunctions();for(const r in t){const i=e+"."+r;let o;s[i]?(o=s[i],o.routineBody=t[r].routineBody):(o=new n.GlslLibRoutineNode(i,t[r].routineBody),s[i]=o);const a=t[r].dependencies;if(a)for(let e=0;e<a.length;++e)if(s[a[e]])o.addDependency(s[a[e]]);else{const t=new n.GlslLibRoutineNode(a[e]);s[a[e]]=t,o.addDependency(t)}}}}preprocess(){const e=this.context.programInfo;let t=e.shaderSource;return this.context.programInfo.hasMain||(t=`${t}\n      ${(0,s.getDefaultFragShaderMain)(this.context.glContext.version,this.context.outputTextureLayout.shape.length)}`),t=(0,i.replaceInlines)(t),`${(0,s.getFragShaderPreamble)(this.context.glContext.version)}\n    ${this.getUniforms(e.inputNames,e.variables)}\n    ${this.getImports(t)}\n    ${t}`}getImports(e){const t=this.selectGlslLibRoutinesToBeIncluded(e);if(0===t.length)return"";let r="";for(let e=0;e<t.length;++e){if(!t[e].routineBody)throw new Error(`Missing body for the Glsl Library routine: ${t[e].name}`);r+=t[e].routineBody+"\n"}return r}selectGlslLibRoutinesToBeIncluded(e){const t=[];return Object.keys(this.glslLibRoutineDependencyGraph).forEach((r=>{const n=r.split(".")[1];-1!==e.indexOf(n)&&t.push(this.glslLibRoutineDependencyGraph[r])})),n.TopologicalSortGlslRoutines.returnOrderedNodes(t)}getUniforms(e,t){const r=[];if(e)for(const t of e)r.push(`uniform sampler2D ${t};`);if(t)for(const e of t)r.push(`uniform ${e.type} ${e.name}${e.arrayLength?`[${e.arrayLength}]`:""};`);return r.join("\n")}}},1248:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.glslRegistry=void 0;const n=r(6859),i=r(1371),o=r(2691),s=r(9183),a=r(9314);t.glslRegistry={encoding:i.EncodingGlslLib,fragcolor:o.FragColorGlslLib,vec:a.VecGlslLib,shapeUtils:s.ShapeUtilsGlslLib,coordinates:n.CoordsGlslLib}},9183:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ShapeUtilsGlslLib=void 0;const n=r(1997);class i extends n.GlslLib{constructor(e){super(e)}getFunctions(){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.bcastIndex()),this.bcastMatmulIndex()),this.offsetToIndices()),this.indicesToOffset()),this.incrementIndices())}getCustomTypes(){return{}}bcastIndex(){const e=this.context.outputTextureLayout.shape.length,t={};return this.context.programInfo.inputNames.forEach(((r,i)=>{const o=this.context.inputTextureLayouts[i].unpackedShape;if(o.length<=e){const i=o.length,s=e-i,a=`bcastIndices_${r}`;let c="";for(let e=0;e<i;++e)c+=`\n          realIndices[${e}] = int( mod(float(bcastedIndices[${s+e}]), ${o[e]}.0) );\n          `;const u=`\n        void ${a} (int bcastedIndices[${e}], out int realIndices[${i}]) {\n          ${c}\n        }\n        `;t[a]=new n.GlslLibRoutine(u)}})),t}bcastMatmulIndex(){const e=this.context.outputTextureLayout.shape.length,t={};return this.context.programInfo.inputNames.forEach(((r,i)=>{const o=this.context.inputTextureLayouts[i].shape;if(!(o.length<2||o.length>e)){const i=o.length,s=e-i,a=`bcastMatmulIndices_${r}`;let c="";for(let e=0;e<i-2;++e)c+=`\n          realIndices[${e}] = int( mod(float(bcastedIndices[${s+e}]), ${o[e]}.0) );\n          `;const u=`\n        void ${a}(int bcastedIndices[${e}], out int realIndices[${i}]) {\n          ${c}\n          realIndices[${i-1}] = bcastedIndices[${e-1}];\n          realIndices[${i-2}] = bcastedIndices[${e-2}];\n        }\n        `;t[a]=new n.GlslLibRoutine(u)}})),t}indicesToOffset(){const e={};return this.context.programInfo.inputNames.forEach(((t,r)=>{const o=this.context.inputTextureLayouts[r].shape,s=this.context.inputTextureLayouts[r].strides,a=o.length;let c=`indicesToOffset_${t}`;e[c]=new n.GlslLibRoutine(i.indexToOffsetSingle(c,a,s)),c=`indicesToOffset_${t}_T`,e[c]=new n.GlslLibRoutine(i.indexToOffsetSingle(c,a,s.slice().reverse()))})),e}static indexToOffsetSingle(e,t,r){let n="";for(let e=t-1;e>=0;--e)n+=`\n        offset += indices[${e}] * ${r[e]};\n        `;return`\n      int ${e}(int indices[${t}]) {\n        int offset = 0;\n        ${n}\n        return offset;\n      }\n      `}offsetToIndices(){const e={};return this.context.programInfo.inputNames.forEach(((t,r)=>{const o=this.context.inputTextureLayouts[r].shape,s=this.context.inputTextureLayouts[r].strides,a=o.length;let c=`offsetToIndices_${t}`;e[c]=new n.GlslLibRoutine(i.offsetToIndicesSingle(c,a,s)),c=`offsetToIndices_${t}_T`,e[c]=new n.GlslLibRoutine(i.offsetToIndicesSingle(c,a,s.slice().reverse()))})),e}static offsetToIndicesSingle(e,t,r){const n=[];for(let e=0;e<t-1;++e)n.push(`\n      indices[${e}] = offset / ${r[e]};`),n.push(`\n        offset -= indices[${e}] * ${r[e]};`);return n.push(`\n      indices[${t-1}] = offset;`),`\n      void ${e}(int offset, out int indices[${t}]) {\n        ${n.join("")}\n      }\n      `}incrementIndices(){const e={};return this.context.programInfo.inputNames.forEach(((t,r)=>{const i=this.context.inputTextureLayouts[r].shape,o=i.length,s=`incrementIndices_${t}`;let a="";for(let e=0;e<o;++e)a+=`\n        shape[${e}] = ${i[e]};`;const c=`\n        void ${s}(int axis, out int indices[${o}]) {\n          int shape[${o}];\n          ${a};\n          for(int i = ${o} -1 ; i >= 0; --i) {\n            if(i > axis) continue;\n            indices[i] += 1;\n            if(indices[i] < shape[i]) {\n              break;\n            }\n            indices[i] = 0;\n          }\n        }\n        `;e[s]=new n.GlslLibRoutine(c)})),e}}t.ShapeUtilsGlslLib=i},6757:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultFragShaderMain=t.getFragShaderPreamble=t.getVertexShaderSource=t.getGlsl=void 0;const r={version:"",attribute:"attribute",varyingVertex:"varying",varyingFrag:"varying",texture2D:"texture2D",output:"gl_FragColor",outputDeclaration:""},n={version:"#version 300 es",attribute:"in",varyingVertex:"out",varyingFrag:"in",texture2D:"texture",output:"outputColor",outputDeclaration:"out vec4 outputColor;"};function i(e){return 1===e?r:n}t.getGlsl=i,t.getVertexShaderSource=function(e){const t=i(e);return`${t.version}\n      precision highp float;\n      ${t.attribute} vec3 position;\n      ${t.attribute} vec2 textureCoord;\n\n      ${t.varyingVertex} vec2 TexCoords;\n\n      void main()\n      {\n          gl_Position = vec4(position, 1.0);\n          TexCoords = textureCoord;\n      }`},t.getFragShaderPreamble=function(e){const t=i(e);return`${t.version}\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ${t.varyingFrag} vec2 TexCoords;\n    ${t.outputDeclaration}\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    // Custom vector types to handle higher dimenalities.\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    `},t.getDefaultFragShaderMain=function(e,t){return`\n  void main() {\n    int indices[${t}];\n    toVec(TexCoords, indices);\n    vec4 result = vec4(process(indices));\n    ${i(e).output} = result;\n  }\n  `}},9314:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VecGlslLib=void 0;const n=r(1997);class i extends n.GlslLib{constructor(e){super(e)}getCustomTypes(){return{}}getFunctions(){return Object.assign(Object.assign(Object.assign(Object.assign({},this.binaryVecFunctions()),this.copyVec()),this.setVecItem()),this.getVecItem())}binaryVecFunctions(){const e=this.context.outputTextureLayout.shape.length,t={add:"+=",sub:"-=",mul:"*=",div:"/="},r={};for(const i in t){const o=`${i}Vec`;let s="";for(let r=0;r<e;++r)s+=`\n          dest[${r}] ${t[i]} src[${r}];\n          `;const a=`\n        void ${o}(int src[${e}], out int dest[${e}]) {\n          ${s}\n        }\n        `;r[o]=new n.GlslLibRoutine(a)}return r}copyVec(){const e=this.context.outputTextureLayout.shape.length;let t="";for(let r=0;r<e;++r)t+=`\n        dest[${r}] = src[${r}];\n        `;const r=`\n      void copyVec(int src[${e}], out int dest[${e}]) {\n        ${t}\n      }\n      `;return{copyVec:new n.GlslLibRoutine(r)}}setVecItem(){const e=this.context.outputTextureLayout.shape.length;let t=`\n        if(index < 0)\n            index =${e} + index;\n        if (index == 0)\n            m[0] = value;\n        `;for(let r=1;r<e-1;++r)t+=`\n        else if (index == ${r})\n            m[${r}] = value;\n            `;t+=`\n        else\n            m[${e-1}] = value;\n        `;const r=`\n      void setVecItem(out int m[${e}], int index, int value) {\n        ${t}\n      }\n        `;return{setVecItem:new n.GlslLibRoutine(r)}}getVecItem(){const e=this.context.outputTextureLayout.shape.length;let t=`\n        if(index < 0)\n            index = ${e} + index;\n        if (index == 0)\n            return m[0];\n      `;for(let r=1;r<e-1;++r)t+=`\n        else if (index == ${r})\n            return m[${r}];\n      `;t+=`\n        else\n            return m[${e-1}];\n        `;const r=`\n      int getVecItem(int m[${e}], int index) {\n        ${t}\n      }\n    `;return{getVecItem:new n.GlslLibRoutine(r)}}}t.VecGlslLib=i},7860:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLInferenceHandler=void 0;const n=r(1315),i=r(9240),o=r(7273),s=r(9),a=r(7379),c=r(2488),u=r(540),l=r(3314),d=r(5639);t.WebGLInferenceHandler=class{constructor(e){this.session=e,this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map}calculateTextureWidthAndHeight(e,t){return(0,l.calculateTextureWidthAndHeight)(this.session.layoutStrategy,e,t)}executeProgram(e,t){if(t.length<e.inputNames.length)throw new Error(`Input size mustn't be less than ${e.inputNames.length}.`);if(e.inputNames.length!==e.inputTypes.length)throw new Error("input names size does not match input types");const r=[];for(let n=0;n<e.inputNames.length;++n)r[n]=this.getOrCreateTextureData(t[n],e.inputTypes[n]);const n=((e,t)=>{const r=t.map((e=>`${e.unpackedShape.join(",")};${e.width}x${e.height}`)).join("_");let n=e.name;return e.cacheHint&&(n+="["+e.cacheHint+"]"),n+=":"+r,n})(e,r);let i=this.session.programManager.getArtifact(n);const o=i?i.programInfo:"function"==typeof e.get?e.get():e,s=(0,l.createTextureLayoutFromTextureType)(this.session.layoutStrategy,o.output.dims,o.output.textureType),a=this.createTextureData(s,o.output.type);return i||(i=this.session.programManager.build(o,r,a),this.session.programManager.setArtifact(n,i)),this.runProgram(i,r,a),a}run(e,t){return this.executeProgram(e,t).tensor}runProgram(e,t,r){for(let r=0;r<t.length;++r)if(!!t[r].isPacked!=(e.programInfo.inputTypes[r]===d.TextureType.packed))throw new Error(`input[${r}] property packed inconsistent`);if(!!r.isPacked!=(e.programInfo.output.textureType===d.TextureType.packed))throw new Error("output property packed inconsistent");this.session.programManager.run(e,t,r)}getOrCreateTextureData(e,t){let r=this.getTextureData(e.dataId,t===d.TextureType.packed);if(!r&&(r=this.getTextureData(e.dataId,t!==d.TextureType.packed),r))return t===d.TextureType.packed?this.pack(r):this.unpack(r);if(!r){const n=(0,l.createTextureLayoutFromTextureType)(this.session.layoutStrategy,e.dims,t);if(t===d.TextureType.packedLastDimension){const r=1,n=4,i=e.dims;if(4===i.length){const o=[i[0],Math.ceil(i[1]*i[2]*i[3]/n)],s=(0,l.createTextureLayoutFromTextureType)(this.session.layoutStrategy,o,t);let a=e.numberData;if(i[1]*i[2]*i[3]%n!=0){const t=i[0],o=i[1]*i[2]*i[3],s=Math.ceil(o*r/n)*n;a=new Float32Array(t*s);for(let n=0;n<t;++n){const t=n*o,i=n*s+n%r*o;a.set(e.numberData.subarray(t,t+o),i)}}return this.createTextureData(s,e.type,a,e,1)}}if(t===d.TextureType.packed){const t=(0,l.createTextureLayoutFromShape)(this.session.layoutStrategy,e.dims,1,[],{reverseWH:!0}),n=this.createTextureData(t,e.type,e.numberData,e,1);r=this.pack(n)}else r=this.createTextureData(n,e.type,e.numberData,e,1)}return r}createTextureDataFromLayoutBindTensor(e,t,r,n){return this.createTextureData(e,t,r,n,1)}createTextureData(e,t,r,i,o){n.Logger.verbose("InferenceHandler",`Creating TextureData: layout:[${JSON.stringify(e)}]`);const s=this.session.textureManager.createTextureFromLayout(t,e,r,o);return this.createTextureDataFromTexture(e,t,s,i)}reshapeUnpacked(e,t){const r=this.getOrCreateTextureData(e,d.TextureType.unpacked),n={channels:r.channels,height:r.height,width:r.width,shape:0!==t.length?t:[1],strides:o.ShapeUtil.computeStrides(t),unpackedShape:t};return this.createTextureDataFromTexture(n,e.type,r.texture).tensor}reshapePacked(e,t){const r=this.getOrCreateTextureData(e,d.TextureType.packed);if((0,a.isReshapeCheap)(e.dims,t)){const n={channels:r.channels,height:r.height,width:r.width,shape:0!==t.length?t:[1],strides:o.ShapeUtil.computeStrides(t),unpackedShape:t,isPacked:!0};return this.createTextureDataFromTexture(n,e.type,r.texture).tensor}const n=(0,a.processDims3D)(e.dims),i=(0,a.processDims3D)(t),s=this.reshapePacked(e,n),c=this.run((0,a.createPackedReshape3DProgramInfoLoader)(this,s,i),[s]);return this.reshapePacked(c,t)}cast(e,t){const r=this.getOrCreateTextureData(e,d.TextureType.unpacked);return this.createTextureDataFromTexture(r,t,r.texture).tensor}createTextureDataFromTexture(e,t,r,n,o){const s=Object.assign(Object.assign({},e),{tensor:n||new i.Tensor(e.unpackedShape,t,(e=>this.readTexture(s)),(async e=>this.readTextureAsync(s)),void 0,o),texture:r});return this.setTextureData(s.tensor.dataId,s,e.isPacked),s}getTextureData(e,t=!1){return this.session.isInitializer(e)?this.session.getTextureData(e,t):t?this.packedTextureDataCache.get(e):this.unpackedTextureDataCache.get(e)}setTextureData(e,t,r=!1){this.session.isInitializer(e)?this.session.setTextureData(e,t,r):(r?this.packedTextureDataCache:this.unpackedTextureDataCache).set(e,t)}isTextureLayoutCached(e,t=!1){return!!this.getTextureData(e.dataId,t)}dispose(){this.session.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach((e=>this.session.textureManager.releaseTexture(e))),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach((e=>this.session.textureManager.releaseTexture(e))),this.unpackedTextureDataCache=new Map}readTexture(e){return e.isPacked?this.readTexture(this.unpack(e)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTexture(e,e.tensor.type,e.channels):this.session.textureManager.readUint8TextureAsFloat((0,c.encodeAsUint8)(this,e))}async readTextureAsync(e){return e.isPacked?this.readTextureAsync(this.unpack(e)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTextureAsync(e,e.tensor.type,e.channels):this.session.textureManager.readUint8TextureAsFloat((0,c.encodeAsUint8)(this,e))}pack(e){return this.executeProgram((0,s.createPackProgramInfoLoader)(this,e.tensor),[e.tensor])}unpack(e){return this.executeProgram((0,u.createUnpackProgramInfoLoader)(this,e.tensor),[e.tensor])}}},4110:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.WEBGL_OP_RESOLVE_RULES=void 0;const s=r(8817),a=o(r(5194)),c=r(4752),u=r(6668),l=r(9754),d=r(5042),h=r(6742),f=r(4125),p=r(6149),m=r(5378),g=r(6981),v=r(7413),y=r(7006),b=r(8276),E=r(5565),w=r(2834),S=r(1010),_=r(8126),T=r(2801),x=r(565),A=r(2444),I=r(815),C=r(564),R=r(5416),k=r(1240),O=r(5944),N=r(5707),P=o(r(9087)),L=r(7862),D=r(3980);t.WEBGL_OP_RESOLVE_RULES=[["Abs","","6+",P.abs],["Acos","","7+",P.acos],["Add","","7+",a.add],["And","","7+",a.and],["Asin","","7+",P.asin],["Atan","","7+",P.atan],["AveragePool","","7+",w.averagePool,w.parseAveragePoolAttributes],["BatchNormalization","","7+",s.batchNormalization,s.parseBatchNormalizationAttributes],["Cast","","6+",c.cast,c.parseCastAttributes],["Ceil","","6+",P.ceil],["Clip","","6-10",P.clip,P.parseClipAttributes],["Clip","","11+",P.clipV11],["Concat","","4+",u.concat,u.parseConcatAttributes],["Conv","","1+",l.conv,l.parseConvAttributes],["ConvTranspose","","1+",d.convTranspose,d.parseConvTransposeAttributes],["Cos","","7+",P.cos],["Div","","7+",a.div],["Dropout","","7+",P.identity],["DepthToSpace","","1+",h.depthToSpace,h.parseDepthToSpaceAttributes],["Equal","","7+",a.equal],["Elu","","6+",P.elu,P.parseEluAttributes],["Exp","","6+",P.exp],["Flatten","","1+",f.flatten,f.parseFlattenAttributes],["Floor","","6+",P.floor],["FusedConv","com.microsoft","1+",l.conv,l.parseConvAttributes],["Gather","","1+",p.gather,p.parseGatherAttributes],["Gemm","","7-10",m.gemm,m.parseGemmAttributesV7],["Gemm","","11+",m.gemm,m.parseGemmAttributesV11],["GlobalAveragePool","","1+",w.globalAveragePool,w.parseGlobalAveragePoolAttributes],["GlobalMaxPool","","1+",w.globalMaxPool],["Greater","","7+",a.greater],["Identity","","1+",P.identity],["ImageScaler","","1+",g.imageScaler,g.parseImageScalerAttributes],["InstanceNormalization","","6+",v.instanceNormalization,v.parseInstanceNormalizationAttributes],["LeakyRelu","","6+",P.leakyRelu,P.parseLeakyReluAttributes],["Less","","7+",a.less],["LRN","","1+",y.lrn,y.parseLrnAttributes],["Log","","6+",P.log],["MatMul","","1+",b.matMul,b.parseMatMulAttributes],["MaxPool","","1+",w.maxPool,w.parseMaxPoolAttributes],["Mul","","7+",a.mul],["Neg","","6+",P.neg],["Not","","1+",P.not],["Or","","7+",a.or],["Pad","","2-10",E.padV2,E.parsePadAttributesV2],["Pad","","11+",E.padV11,E.parsePadAttributesV11],["Pow","","7+",a.pow],["PRelu","","7+",a.pRelu],["ReduceLogSum","","1+",S.reduceLogSum,S.parseReduceAttributes],["ReduceMax","","1+",S.reduceMax,S.parseReduceAttributes],["ReduceMean","","1+",S.reduceMean,S.parseReduceAttributes],["ReduceMin","","1+",S.reduceMin,S.parseReduceAttributes],["ReduceProd","","1+",S.reduceProd,S.parseReduceAttributes],["ReduceSum","","1-12",S.reduceSum,S.parseReduceAttributes],["ReduceSumSquare","","1+",S.reduceLogSumSquare,S.parseReduceAttributes],["Relu","","6+",P.relu],["Reshape","","5+",_.reshape],["Resize","","10",T.resize,T.parseResizeAttributesV10],["Resize","","11+",T.resize,T.parseResizeAttributesV11],["Shape","","1+",x.shape],["Sigmoid","","6+",P.sigmoid],["Sin","","7+",P.sin],["Slice","","10+",A.sliceV10],["Slice","","1-9",A.slice,A.parseSliceAttributes],["Softmax","","1-12",I.softmax,I.parseSoftmaxAttributes],["Softmax","","13+",I.softmaxV13,I.parseSoftmaxAttributesV13],["Split","","2-12",C.split,C.parseSplitAttributes],["Sqrt","","6+",P.sqrt],["Squeeze","","1-12",R.squeeze,R.parseSqueezeAttributes],["Squeeze","","13+",R.squeezeV13],["Sub","","7+",a.sub],["Sum","","6+",k.sum],["Tan","","7+",P.tan],["Tanh","","6+",P.tanh],["Tile","","6+",O.tile],["Transpose","","1+",N.transpose,N.parseTransposeAttributes],["Upsample","","7-8",D.upsample,D.parseUpsampleAttributesV7],["Upsample","","9",D.upsample,D.parseUpsampleAttributesV9],["Unsqueeze","","1-12",L.unsqueeze,L.parseUnsqueezeAttributes],["Unsqueeze","","13+",L.unsqueezeV13],["Xor","","7+",a.xor]]},8817:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseBatchNormalizationAttributes=t.batchNormalization=void 0;const n=r(4910),i=r(6757),o=r(5639),s={name:"BatchNormalization",inputNames:["A","Scale","B","Mean","Variance"],inputTypes:[o.TextureType.unpacked,o.TextureType.unpacked,o.TextureType.unpacked,o.TextureType.unpacked,o.TextureType.unpacked]};t.batchNormalization=(e,t,r)=>(c(t),[e.run(Object.assign(Object.assign({},s),{cacheHint:r.cacheKey,get:()=>a(e,t,r)}),t)]),t.parseBatchNormalizationAttributes=e=>{const t=e.attributes.getFloat("epsilon",1e-5),r=e.attributes.getFloat("momentum",.9),i=e.attributes.getInt("spatial",1);return(0,n.createAttributeWithCacheKey)({epsilon:t,momentum:r,spatial:i})};const a=(e,t,r)=>{const n=(0,i.getGlsl)(e.session.backend.glContext.version),a=t[0].dims.length,[c,u]=e.calculateTextureWidthAndHeight(t[1].dims,o.TextureType.unpacked),l=`\n  float process(int[${a}] indices) {\n    vec2 position = offsetToCoords(indices[1], ${c}, ${u});\n    float scale = getColorAsFloat(${n.texture2D}(Scale, position));\n    float mean = getColorAsFloat(${n.texture2D}(Mean, position));\n    float variance = getColorAsFloat(${n.texture2D}(Variance, position));\n    float b = getColorAsFloat(${n.texture2D}(B, position));\n\n    return scale * ( (_A(indices) - mean) / sqrt(variance + float(${r.epsilon})) ) + b;\n  }`;return Object.assign(Object.assign({},s),{output:{dims:t[0].dims,type:t[0].type,textureType:o.TextureType.unpacked},shaderSource:l})},c=e=>{if(!e||5!==e.length)throw new Error("BatchNormalization requires 5 inputs.");const t=e[0],r=e[1],n=e[2],i=e[3],o=e[4];if(t.dims.length<3||1!==r.dims.length||1!==n.dims.length||1!==i.dims.length||1!==o.dims.length)throw new Error("invalid input shape.");if(r.dims[0]!==t.dims[1]||n.dims[0]!==t.dims[1]||i.dims[0]!==t.dims[1]||o.dims[0]!==t.dims[1])throw new Error("invalid input shape.");if("float32"!==t.type&&"float64"!==t.type||"float32"!==r.type&&"float64"!==r.type||"float32"!==n.type&&"float64"!==n.type||"float32"!==i.type&&"float64"!==i.type||"float32"!==o.type&&"float64"!==o.type)throw new Error("invalid input tensor types.")}},5194:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.xor=t.sub=t.pRelu=t.pow=t.or=t.mul=t.less=t.greater=t.equal=t.div=t.and=t.add=t.glslPRelu=t.glslPow=t.glslXor=t.glslOr=t.glslAnd=t.glslLess=t.glslGreater=t.glslEqual=t.glslSub=t.glslMul=t.glslDiv=t.glslAdd=void 0;const n=r(7273),i=r(1997),o=r(6757),s=r(5639);function a(){const e="add_";return{body:`\n  float ${e}(float a, float b) {\n    return a + b;\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    return v1 + v2;\n  }\n  `,name:e,type:i.FunctionType.ValueBased}}function c(){const e="div_";return{body:`\n  float ${e}(float a, float b) {\n    return a / b;\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    return v1 / v2;\n  }\n  `,name:e,type:i.FunctionType.ValueBased}}function u(){const e="mul_";return{body:`\n  float ${e}(float a, float b) {\n    return a * b;\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    return v1 * v2;\n  }\n  `,name:e,type:i.FunctionType.ValueBased}}function l(){const e="sub_";return{body:`\n  float ${e}(float a, float b) {\n    return a - b;\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    return v1 - v2;\n  }\n  `,name:e,type:i.FunctionType.ValueBased}}function d(){const e="equal_";return{body:`\n  float ${e}(float a, float b) {\n    return float(a == b);\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    return vec4(equal(v1, v2));\n  }\n  `,name:e,type:i.FunctionType.ValueBased}}function h(){const e="greater_";return{body:`\n  float ${e}(float a, float b) {\n    return float(a > b);\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    return vec4( v1.r > v2.r ,\n      v1.g > v2.g,\n      v1.b > v2.b,\n      v1.a > v2.a );\n  }\n  `,name:e,type:i.FunctionType.ValueBased}}function f(){const e="less_";return{body:`\n  float ${e}(float a, float b) {\n    return float(a < b);\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    return vec4( v1.r < v2.r ,\n                v1.g < v2.g,\n                v1.b < v2.b,\n                v1.a < v2.a );\n  }\n  `,name:e,type:i.FunctionType.ValueBased}}function p(){const e="and_";return{body:`\n  float ${e}(float a, float b) {\n    return float( bool(a) && bool(b) );\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    bvec4 b1 = bvec4(v1);\n    bvec4 b2 = bvec4(v2);\n    return vec4( b1.r && b2.r ,\n                b1.g && b2.g,\n                b1.b && b2.b,\n                b1.a && b2.a );\n  }\n  `,name:e,type:i.FunctionType.ValueBased}}function m(){const e="or_";return{body:`\n  float ${e}(float a, float b) {\n    return float( bool(a) || bool(b) );\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    bvec4 b1 = bvec4(v1);\n    bvec4 b2 = bvec4(v2);\n    return vec4( b1.r || b2.r ,\n                b1.g || b2.g,\n                b1.b || b2.b,\n                b1.a || b2.a );\n  }\n  `,name:e,type:i.FunctionType.ValueBased}}function g(){const e="xor_";return{body:`\n  float ${e}(float a, float b) {\n    return float( bool(a) ^^ bool(b) );\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    bvec4 b1 = bvec4(v1);\n    bvec4 b2 = bvec4(v2);\n    return vec4( b1.r ^^ b2.r ,\n                b1.g ^^ b2.g,\n                b1.b ^^ b2.b,\n                b1.a ^^ b2.a );\n  }\n  `,name:e,type:i.FunctionType.ValueBased}}function v(){return function(e){const t=`${e}_`;return{body:`\n  float ${t}(float a, float b) {\n    return ${e}(a, b);\n  }\n  vec4 ${t}(vec4 v1, vec4 v2) {\n    return ${e}(v1, v2);\n  }\n  `,name:t,type:i.FunctionType.ValueBased}}("pow")}function y(){const e="prelu_";return{body:`\n  float ${e}(float a, float b) {\n    return a < 0.0 ? a * b: a;\n  }\n  vec4 ${e}(vec4 v1, vec4 v2) {\n    return vec4(\n      v1.r < 0.0 ? v1.r * v2.r: v1.r,\n      v1.g < 0.0 ? v1.g * v2.g: v1.g,\n      v1.b < 0.0 ? v1.b * v2.b: v1.b,\n      v1.a < 0.0 ? v1.a * v2.a: v1.a\n      );\n  }\n  `,name:e,type:i.FunctionType.ValueBased}}t.glslAdd=a,t.glslDiv=c,t.glslMul=u,t.glslSub=l,t.glslEqual=d,t.glslGreater=h,t.glslLess=f,t.glslAnd=p,t.glslOr=m,t.glslXor=g,t.glslPow=v,t.glslPRelu=y;const b=(e,t,r,n=t[0].type,i)=>{const o=e.session.pack?s.TextureType.packed:s.TextureType.unpacked;return{name:r.name,inputNames:["A","B"],inputTypes:[o,o],cacheHint:i,get:()=>E(e,t,r,n)}},E=(e,t,r,i=t[0].type)=>{const a=e.session.pack?s.TextureType.packed:s.TextureType.unpacked,c=!n.ShapeUtil.areEqual(t[0].dims,t[1].dims);let u=t[0].dims;const l=e.session.pack;if(c){const s=n.BroadcastUtil.calcShape(t[0].dims,t[1].dims,!1);if(!s)throw new Error("Can't perform binary op on the given tensors");u=s;const c=u.length,d=0!==t[0].dims.length?t[0].dims.length:1,h=0!==t[1].dims.length?t[1].dims.length:1,f=0!==t[0].dims.length?"bcastIndices_A(indices, aindices);":"aindices[0] = 0;",p=0!==t[1].dims.length?"bcastIndices_B(indices, bindices);":"bindices[0] = 0;",m=(0,o.getGlsl)(e.session.backend.glContext.version),g=l?`\n      ${r.body}\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n        vec4 result = ${r.name}(a, b);\n        ${m.output} = result;\n      }`:`\n      ${r.body}\n      float process(int indices[${c}]) {\n        int aindices[${d}];\n        int bindices[${h}];\n        ${f}\n        ${p}\n        return ${r.name}(_A(aindices), _B(bindices));\n      }`;return{name:r.name,inputNames:["A","B"],inputTypes:[a,a],output:{dims:u,type:i,textureType:a},shaderSource:g,hasMain:l}}const d=(0,o.getGlsl)(e.session.backend.glContext.version),h=`\n    ${r.body}\n    void main() {\n      vec4 v1 = ${d.texture2D}(A, TexCoords);\n      vec4 v2 = ${d.texture2D}(B, TexCoords);\n      vec4 result = ${r.name}(v1, v2);\n      ${d.output} = result;\n    }\n    `;return{name:r.name,inputNames:["A","B"],inputTypes:[a,a],output:{dims:t[0].dims,type:i,textureType:a},shaderSource:h,hasMain:!0}};t.add=(e,t)=>[e.run(b(e,t,a()),t)],t.and=(e,t)=>[e.run(b(e,t,p(),"bool"),t)],t.div=(e,t)=>[e.run(b(e,t,c()),t)],t.equal=(e,t)=>[e.run(b(e,t,d(),"bool"),t)],t.greater=(e,t)=>[e.run(b(e,t,h(),"bool"),t)],t.less=(e,t)=>[e.run(b(e,t,f(),"bool"),t)],t.mul=(e,t)=>[e.run(b(e,t,u()),t)],t.or=(e,t)=>[e.run(b(e,t,m(),"bool"),t)],t.pow=(e,t)=>[e.run(b(e,t,v()),t)],t.pRelu=(e,t)=>[e.run(b(e,t,y()),t)],t.sub=(e,t)=>[e.run(b(e,t,l()),t)],t.xor=(e,t)=>[e.run(b(e,t,g(),"bool"),t)]},4752:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseCastAttributes=t.cast=void 0;const n=r(7273);t.cast=(e,t,r)=>(i(t),[e.cast(t[0],r)]),t.parseCastAttributes=e=>n.ProtoUtil.tensorDataTypeFromProto(e.attributes.getInt("to"));const i=e=>{if(!e||1!==e.length)throw new Error("Cast requires 1 input.");if("string"===e[0].type)throw new Error("Invalid input type.")}},4595:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createPackedConcatProgramInfoLoader=void 0;const n=r(6757),i=r(5639),o=r(432),s=r(5614);t.createPackedConcatProgramInfoLoader=(e,t,r)=>{const c=(u=t.length,l=r.cacheKey,{name:"Concat (packed)",inputNames:Array.from({length:u},((e,t)=>`X${t}`)),inputTypes:Array(u).fill(i.TextureType.packed),cacheHint:l});var u,l;return Object.assign(Object.assign({},c),{get:()=>((e,t,r,c)=>{const u=r[0].dims.slice();if(c>=u.length||c<-1*u.length)throw new Error("axis specified for concat doesn't match input dimensionality");c<0&&(c=u.length+c);const l=u.slice(0);for(let e=1;e<r.length;e++){const t=r[e].dims.slice();for(let e=0;e<u.length;e++)if(e===c)l[c]+=t[e];else if(u[e]!==t[e])throw new Error("non concat dimensions must match")}const d=l.length,h=(0,s.getChannels)("coords",d),f=(0,o.getCoordsDataType)(d),p=(0,s.unpackFromChannel)(),m=r.map((e=>e.dims)),g=(0,o.getGlChannels)(d),v=new Array(m.length-1);v[0]=m[0][c];for(let e=1;e<v.length;e++)v[e]=v[e-1]+m[e][c];const y=g[c],b=g.slice(-2),E=g.join();let w=`if (${y} < ${v[0]}) {\n        return getChannel(\n            getX0(${E}), vec2(${b.join()}));\n        }`;for(let e=1;e<v.length;e++){const t=v[e-1];w+=`\n            if (${y} < ${v[e]}  && ${y} >= ${v[e-1]}) {\n              return getChannel(\n                getX${e}(${a(g,y,t)}),\n                vec2(${a(b,y,t)}));\n            }`}const S=v.length,_=v[v.length-1];w+=`\n            return getChannel(\n              getX${S}(${a(g,y,_)}),\n              vec2(${a(b,y,_)}));`;const T=(0,n.getGlsl)(e.session.backend.glContext.version),x=`\n          ${p}\n          float getValue(${g.map((e=>"int "+e))}) {\n            ${w}\n          }\n\n          void main() {\n            ${f} coords = getOutputCoords();\n            int lastDim = coords.${g[d-1]};\n            coords.${g[d-1]} = coords.${g[d-2]};\n            coords.${g[d-2]} = lastDim;\n\n            vec4 result = vec4(getValue(${h}), 0., 0., 0.);\n\n            ${h[d-1]} = ${h[d-1]} + 1;\n            if (${h[d-1]} < ${l[d-1]}) {\n              result.g = getValue(${h});\n            }\n\n            ${h[d-2]} = ${h[d-2]} + 1;\n            if (${h[d-2]} < ${l[d-2]}) {\n              result.a = getValue(${h});\n            }\n\n            ${h[d-1]} = ${h[d-1]} - 1;\n            if (${h[d-2]} < ${l[d-2]} &&\n                ${h[d-1]} < ${l[d-1]}) {\n              result.b = getValue(${h});\n            }\n            ${T.output} = result;\n          }\n        `;return Object.assign(Object.assign({},t),{output:{dims:l,type:r[0].type,textureType:i.TextureType.packed},shaderSource:x,hasMain:!0})})(e,c,t,r.axis)})};const a=(e,t,r)=>{const n=e.indexOf(t);return e.map(((e,t)=>t===n?`${e} - ${r}`:e)).join()}},6668:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseConcatAttributes=t.concat=void 0;const n=r(4910),i=r(5639),o=r(4595);t.concat=(e,t,r)=>(d(t),e.session.pack&&t[0].dims.length>1?[e.run((0,o.createPackedConcatProgramInfoLoader)(e,t,r),t)]:[e.run(s(e,t,r),t)]);const s=(e,t,r)=>{const n=(o=t.length,s=r.cacheKey,{name:"Concat",inputNames:Array.from({length:o},((e,t)=>`X${t}`)),inputTypes:Array(o).fill(i.TextureType.unpacked),cacheHint:s});var o,s;return Object.assign(Object.assign({},n),{get:()=>((e,t,r,n)=>{const o=r[0].dims.slice();if(n>=o.length||n<-1*o.length)throw new Error("axis specified for concat doesn't match input dimensionality");n<0&&(n=o.length+n);const s=o.slice(0);for(let e=1;e<r.length;e++){const t=r[e].dims.slice();for(let e=0;e<o.length;e++)if(e===n)s[n]+=t[e];else if(o[e]!==t[e])throw new Error("non concat dimensions must match")}const d=s.length,h=new Array(r.length);let f=0;for(let e=0;e<h.length;++e)f+=r[e].dims[n],h[e]=f;let p="";p=r.length<5?a(h):c(h);const m=`\n        ${u(r.length,d)}\n        ${l(h)}\n        ${p}\n        float process(int indices[${d}]) {\n          int textureIndex = getTextureWhereDataResides (indices[${n}]);\n\n          if(textureIndex != 0) {\n            indices[${n}] = indices[${n}] - int(getSizeInConcatAxisValueFromIndex(textureIndex-int(1)));\n          }\n\n          return fetchDataFromCorrectTexture(textureIndex, indices);\n        }`;return Object.assign(Object.assign({},t),{output:{dims:s,type:r[0].type,textureType:i.TextureType.unpacked},shaderSource:m})})(0,n,t,r.axis)})},a=e=>`int getTextureWhereDataResides(int index) {\n      ${e.map(((e,t)=>`if(index<${e}) {return ${t};}\n`)).join("")}\n    }`,c=e=>a(e),u=(e,t)=>{const r=[`float fetchDataFromCorrectTexture(int textureIndex, int indices[${t}]) {`];for(let t=0;t<e;++t)0===t?r.push(`\tif (textureIndex == ${t}) { return _X${t}(indices); }`):t===e-1?r.push(`\telse { return _X${t}(indices); }`):r.push(`\telse if (textureIndex == ${t}) { return _X${t}(indices); }`);return r.push("\t}"),r.join("\n")},l=e=>{const t=["int getSizeInConcatAxisValueFromIndex(int index) {"];for(let r=0;r<e.length;++r)0===r?t.push(`\tif (index == ${r}) { return ${e[r]}; }`):r===e.length-1?t.push(`\telse { return ${e[r]}; }`):t.push(`\telse if (index == ${r}) { return ${e[r]}; }`);return t.push("\t}"),t.join("\n")};t.parseConcatAttributes=e=>(0,n.createAttributeWithCacheKey)({axis:e.attributes.getInt("axis")});const d=e=>{if(!e||e.length<1)throw new Error("too few inputs");const t=e[0].type,r=e[0].dims.length;if("string"===t)throw new Error("string tensor is not supported yet");for(const n of e){if(n.type!==t)throw new Error("input tensors should be one type");if(n.dims.length!==r)throw new Error("input tensors should have the same shape")}}},7825:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createUnpackedGroupedConvProgramInfoLoader=void 0;const n=r(1315),i=r(6757),o=r(5639),s=r(9754),a=r(2150);t.createUnpackedGroupedConvProgramInfoLoader=(e,t,r)=>{const c=(u=t.length>2,l=r.cacheKey,{name:"GroupedConv",inputNames:u?["X","W","Bias"]:["X","W"],inputTypes:u?[o.TextureType.unpacked,o.TextureType.unpacked,o.TextureType.unpacked]:[o.TextureType.unpacked,o.TextureType.unpacked],cacheHint:l});var u,l;return Object.assign(Object.assign({},c),{get:()=>((e,t,r,c)=>{const u=t.length>2?"value += getBias(output_channel);":"",l=t[0].dims.slice(),d=t[1].dims.slice(),h=d[0]/c.group;n.Logger.verbose("GroupedConv",`autpPad:${c.autoPad}, dilations:${c.dilations}, group:${c.group}, kernelShape:${c.kernelShape}, pads:${c.pads}, strides:${c.strides}`);const f=(0,s.calculateOutputShape)(l,d,c.dilations,c.pads,c.strides),p=(0,i.getGlsl)(e.session.backend.glContext.version),{activationFunction:m,applyActivation:g}=(0,a.getActivationSnippet)(c),v=`\n  const ivec2 strides = ivec2(${c.strides[0]}, ${c.strides[1]});\n  const ivec2 pads = ivec2(${c.pads[0]}, ${c.pads[1]});\n  ${m}\n  void main() {\n    ivec4 coords = getOutputCoords();\n    int batch = coords.x;\n    int output_channel = coords.y;\n    ivec2 xRCCorner = coords.zw * strides - pads;\n    int group_id = output_channel / ${h};\n\n    float value = 0.0;\n    for (int wInChannel = 0; wInChannel < ${d[1]}; wInChannel++) {\n      int input_channel = group_id * ${d[1]} + wInChannel;\n      for (int wHeight = 0; wHeight < ${d[2]}; wHeight++) {\n        int xHeight = xRCCorner.x + wHeight * ${c.dilations[0]};\n\n        if (xHeight < 0 || xHeight >= ${l[2]}) {\n          continue;\n        }\n\n        for (int wWidth = 0; wWidth < ${d[3]}; wWidth++) {\n          int xWidth = xRCCorner.y + wWidth * ${c.dilations[1]};\n          if (xWidth < 0 || xWidth >= ${l[3]}) {\n            continue;\n          }\n\n          float xVal = getX(batch, input_channel, xWidth, xHeight);\n          float wVal = getW(output_channel, wInChannel, wWidth, wHeight);\n          value += xVal*wVal;\n        }\n      }\n    }\n    ${u}\n    ${g}\n    ${p.output} = vec4(value, .0, .0, .0);\n  }\n`;return Object.assign(Object.assign({},r),{output:{dims:f,type:t[0].type,textureType:o.TextureType.unpacked},shaderSource:v,hasMain:!0})})(e,t,c,r)})}},7708:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.conv2DPacked=t.conv2DPackedPointwise=void 0;const n=r(9754),i=r(5950),o=r(5632);t.conv2DPackedPointwise=(e,t,r)=>{const i=t[0].dims,s=t[1].dims,a=(0,n.calculateOutputShape)(i,s,r.dilations,r.pads,r.strides),c=e.reshapePacked(t[0],[i[1],i[2]*i[3]]),u=e.reshapePacked(t[1],[s[0],s[1]]),l=t.length>2?[u,c,t[2]]:[u,c],d=e.run((0,o.createPackedMatmulProgramInfoLoader)(e,l,r),l);return e.reshapePacked(d,a)},t.conv2DPacked=(e,t,r)=>{const s=t[0].dims,a=t[1].dims,c=(0,n.calculateOutputShape)(s,a,r.dilations,r.pads,r.strides),u=e.run((0,i.createPackedIm2ColProgramInfoLoader)(e,t[0],t[1],c,r),[t[0]]),l=e.reshapePacked(t[1],[a[0],a[1]*a[2]*a[3]]),d=3===t.length?[l,u,t[2]]:[l,u],h=e.run((0,o.createPackedMatmulProgramInfoLoader)(e,d,r),d);return e.reshapePacked(h,c)}},5042:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseConvTransposeAttributes=t.convTranspose=void 0;const n=r(4910),i=r(6757),o=r(5639),s=r(2150),a=(e,t,r,n,i,o)=>(e-1)*t+r+(n-1)*i+1-o,c=(e,t,r,n,i)=>{const o=Math.floor(e/2);"SAME_UPPER"===t?(r[n]=o,r[i]=e-o):"SAME_LOWER"===t&&(r[n]=e-o,r[i]=o)};t.convTranspose=(e,t,r)=>(h(t,r),u(e,t,r));const u=(e,t,r)=>{const n=d(r,t);return[l(e,t,n)]},l=(e,t,r)=>e.run(((e,t,r)=>{const n=(a=t.length>2,c=r.cacheKey,{name:"ConvTranspose",inputNames:a?["X","W","B"]:["X","W"],inputTypes:a?[o.TextureType.unpacked,o.TextureType.unpacked,o.TextureType.unpacked]:[o.TextureType.unpacked,o.TextureType.unpacked],cacheHint:c});var a,c;return Object.assign(Object.assign({},n),{get:()=>((e,t,r,n)=>{const a=t.length>2?"getB(output_channel)":"0.0",c=t[0].dims,u=t[1].dims,l=u[1],d=u[0]/n.group,h=[t[0].dims[0],t[1].dims[1]*n.group,...n.outputShape],f=(0,i.getGlsl)(e.session.backend.glContext.version),{activationFunction:p,applyActivation:m}=(0,s.getActivationSnippet)(n),g=`\n  const ivec2 strides = ivec2(${n.strides[0]}, ${n.strides[1]});\n  const ivec2 pads = ivec2(${n.pads[0]}, ${n.pads[1]});\n  ${p}\n  void main() {\n    ivec4 coords = getOutputCoords();\n    int batch = coords.x;\n    int output_channel = coords.y;\n\n    ivec2 loc = coords.zw + pads;\n\n    int group_id = output_channel / ${l};\n    int wOutChannel = output_channel - group_id * ${l};\n\n    float value = ${a};\n    for (int inChannelOffset = 0; inChannelOffset < ${d}; inChannelOffset++) {\n      int input_channel = group_id * ${d} + inChannelOffset;\n      for (int wWOff = 0; wWOff < ${u[2]}; wWOff++) {\n        for (int wHOff = 0; wHOff < ${u[3]}; wHOff++) {\n          ivec2 wOff = ivec2(wWOff * ${n.dilations[0]}, wHOff * ${n.dilations[1]});\n          ivec2 wLoc = loc - wOff;\n          ivec2 wLocIn = wLoc / strides;\n          if (\n            wLocIn * strides == wLoc &&\n            wLocIn.x >= 0 && wLocIn.x < ${c[2]} &&\n            wLocIn.y >= 0 && wLocIn.y < ${c[3]}\n          ) {\n            float xVal = getX(batch, input_channel, wLocIn.y, wLocIn.x);\n            float wVal = getW(input_channel, wOutChannel, wHOff, wWOff);\n            value += xVal * wVal;\n          }\n        }\n      }\n    }\n    ${m}\n    ${f.output} = vec4(value, .0, .0, .0);\n  }\n`;return Object.assign(Object.assign({},r),{output:{dims:h,type:t[0].type,textureType:o.TextureType.unpacked},shaderSource:g,hasMain:!0})})(e,t,n,r)})})(e,t,r),t),d=(e,t)=>{const r=e.kernelShape.slice();if(0===e.kernelShape.length)for(let e=2;e<t[1].dims.length;++e)r.push(t[1].dims[e]);const n=e.pads.slice(),i=e.outputShape.slice();((e,t,r,n,i,o,s,u)=>{const l=e.length-2,d=0===u.length;for(let h=0;h<l;++h){const f=d?e[h+2]*o[h]:u[h],p=a(e[h+2],o[h],i[h],t[h],r[h],f);c(p,n,i,h,h+l),d&&u.push(o[h]*(e[h+2]-1)+s[h]+(t[h]-1)*r[h]+1-i[h]-i[h+l])}})(t[0].dims,r,e.dilations,e.autoPad,n,e.strides,e.outputPadding,i);const o=Object.assign({},e);return Object.assign(o,{kernelShape:r,pads:n,outputShape:i,cacheKey:e.cacheKey}),o};t.parseConvTransposeAttributes=e=>{const t=e.attributes,r=(0,s.parseInternalActivationAttributes)(t),i=t.getString("auto_pad","NOTSET"),o=t.getInts("dilations",[1,1]),a=t.getInt("group",1),c=t.getInts("kernel_shape",[]),u=t.getInts("output_padding",[0,0]),l=t.getInts("output_shape",[]),d=t.getInts("pads",[0,0,0,0]),h=t.getInts("strides",[1,1]);return(0,n.createAttributeWithCacheKey)(Object.assign({autoPad:i,dilations:o,group:a,kernelShape:c,outputPadding:u,outputShape:l,pads:d,strides:h},r))};const h=(e,t)=>{if(!e||2!==e.length&&3!==e.length)throw new Error("Conv requires 2 or 3 inputs");if(4!==e[0].dims.length||4!==e[1].dims.length)throw new Error("currently only support 2-dimensional conv");if(e[0].dims[1]!==e[1].dims[0])throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");const r=e[1].dims[1]*t.group;if(3===e.length&&(1!==e[2].dims.length||e[2].dims[0]!==r))throw new Error("invalid bias");const n=e[0].dims.length-2;if(t.dilations.length!==n)throw new Error(`dilations should be ${n}D`);if(t.strides.length!==n)throw new Error(`strides should be ${n}D`);if(t.pads.length!==2*n)throw new Error(`pads should be ${2*n}D`);if(t.outputPadding.length!==n)throw new Error(`output_padding should be ${n}D`);if(0!==t.kernelShape.length&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(0!==t.outputShape.length&&t.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape");if("float32"!==e[0].type||"float32"!==e[1].type)throw new Error("ConvTranspose input(X,W) should be float tensor");if(3===e.length&&"float32"!==e[2].type)throw new Error("ConvTranspose input(bias) should be float tensor")}},9754:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseConvAttributes=t.conv=t.calculateOutputShape=void 0;const n=r(4910),i=r(7273),o=r(7825),s=r(7708),a=r(3281),c=r(2150),u=r(1625),l=r(8276);t.calculateOutputShape=(e,t,r,n,i)=>{const o=e[0],s=e.slice(2),a=s.length,c=t[0],u=t.slice(2).map(((e,t)=>e+(e-1)*(r[t]-1))),l=s.map(((e,t)=>e+n[t]+n[t+a])).map(((e,t)=>Math.floor((e-u[t]+i[t])/i[t])));return[o,c].concat(...l)},t.conv=(e,t,r)=>(m(t,r),d(e,t,r));const d=(e,t,r)=>{const n=p(r,t),i=e.session.pack,a=1===n.kernelShape[0]&&1===n.kernelShape[1];return n.group>1?[e.run((0,o.createUnpackedGroupedConvProgramInfoLoader)(e,t,n),t)]:a&&i?[h(e,t,n)]:i&&4===t[0].dims.length&&1===t[0].dims[0]&&!a?[(0,s.conv2DPacked)(e,t,n)]:[f(e,t,n)]},h=(e,r,n)=>{const i=r[0].dims,o=r[1].dims,s=(0,t.calculateOutputShape)(i,o,n.dilations,n.pads,n.strides),a=e.reshapeUnpacked(r[0],[i[1],i[2]*i[3]]),c=e.reshapeUnpacked(r[1],[o[0],o[1]]),u=r.length>2?[c,a,r[2]]:[c,a],d=e.run((0,l.createMatmulProgramInfoLoader)(u,n),u);return e.reshapeUnpacked(d,s)},f=(e,r,n)=>{const i=r[0].dims,o=r[1].dims,s=(0,t.calculateOutputShape)(i,o,n.dilations,n.pads,n.strides),c=e.run((0,u.createIm2ColProgramInfoLoader)(e,r[0],r[1],s,n),[r[0]]),l=3===r.length?[c,r[1],r[2]]:[c,r[1]];return e.run((0,a.createDotProductProgramInfoLoader)(e,r,s,n),l)},p=(e,t)=>{const r=e.kernelShape.slice();if(0===e.kernelShape.length)for(let e=2;e<t[1].dims.length;++e)r.push(t[1].dims[e]);const n=e.pads.slice();i.PoolConvUtil.adjustPadsBasedOnAutoPad(t[0].dims,e.strides,e.dilations,r,n,e.autoPad);const o=Object.assign({},e);return Object.assign(o,{kernelShape:r,pads:n,cacheKey:e.cacheKey}),o};t.parseConvAttributes=e=>{const t=e.attributes,r=(0,c.parseInternalActivationAttributes)(t),i=t.getString("auto_pad","NOTSET"),o=t.getInts("dilations",[1,1]),s=t.getInt("group",1),a=t.getInts("kernel_shape",[]),u=t.getInts("pads",[0,0,0,0]),l=t.getInts("strides",[1,1]);return(0,n.createAttributeWithCacheKey)(Object.assign({autoPad:i,dilations:o,group:s,kernelShape:a,pads:u,strides:l},r))};const m=(e,t)=>{if(!e||2!==e.length&&3!==e.length)throw new Error("Conv requires 2 or 3 inputs");if(4!==e[0].dims.length||4!==e[1].dims.length)throw new Error("currently only support 2-dimensional conv");if(e[0].dims[1]!==e[1].dims[1]*t.group)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(3===e.length&&(1!==e[2].dims.length||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");const r=e[0].dims.length-2;if(t.dilations.length!==r)throw new Error(`dilations should be ${r}D`);if(t.strides.length!==r)throw new Error(`strides should be ${r}D`);if(t.pads.length!==2*r)throw new Error(`pads should be ${2*r}D`);if(0!==t.kernelShape.length&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if("float32"!==e[0].type||"float32"!==e[1].type)throw new Error("Conv input(X,W) should be float tensor");if(3===e.length&&"float32"!==e[2].type)throw new Error("Conv input(bias) should be float tensor")}},6742:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseDepthToSpaceAttributes=t.depthToSpace=void 0;const n=r(5707);t.depthToSpace=(e,t,r)=>{i(t);const o=r.blocksize,s=o*o,a="DCR"===r.mode?[0,3,4,1,5,2]:[0,1,4,2,5,3],c="DCR"===r.mode?[t[0].dims[0],o,o,t[0].dims[1]/s,t[0].dims[2],t[0].dims[3]]:[t[0].dims[0],t[0].dims[1]/s,o,o,t[0].dims[2],t[0].dims[3]],u=e.reshapeUnpacked(t[0],c),l={perm:a,cacheKey:`${a}`},[d]=(0,n.transpose)(e,[u],l),h=[t[0].dims[0],t[0].dims[1]/s,t[0].dims[2]*o,t[0].dims[3]*o];return[e.reshapeUnpacked(d,h)]},t.parseDepthToSpaceAttributes=e=>{const t=e.attributes.getInt("blocksize");if(t<1)throw new Error(`blocksize must be >= 1, but got : ${t} for DepthToSpace`);const r=e.attributes.getString("mode","DCR");if("DCR"!==r&&"CRD"!==r)throw new Error(`unrecognized mode: ${r} for DepthToSpace`);return{mode:r,blocksize:t}};const i=e=>{if(1!==e.length)throw new Error(`DepthToSpace expect 1 inputs, but got ${e.length}`);if("string"===e[0].type||4!==e[0].dims.length)throw new TypeError("DepthToSpace input should be a 4-D numeric tensor")}},3281:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createDotProductProgramInfoLoader=void 0;const n=r(7273),i=r(6757),o=r(5639),s=r(2150),a=r(1625);t.createDotProductProgramInfoLoader=(e,t,r,c)=>{const u=((e,t)=>({name:"ConvDotProduct",inputNames:e?["Im2Col","K","B"]:["Im2Col","K"],inputTypes:e?[o.TextureType.unpacked,o.TextureType.packedLastDimension,o.TextureType.unpacked]:[o.TextureType.unpacked,o.TextureType.packedLastDimension],cacheKey:t.activationCacheKey}))(t.length>2,c);return Object.assign(Object.assign({},u),{get:()=>((e,t,r,c,u)=>{const l=r[0].dims,d=r[1].dims,h=[d[0],Math.ceil(l[1]*d[2]*d[3]/4)],f=(0,a.calculateIm2ColDims)(l,d,c),[p,m]=e.calculateTextureWidthAndHeight(h,o.TextureType.packedLastDimension),g=n.ShapeUtil.computeStrides(f),[v,y]=e.calculateTextureWidthAndHeight(f,o.TextureType.packedLastDimension),b=c.length,E=r.length<3?"0.0":"_B(b)",w=Math.ceil(l[1]*d[2]*d[3]/4),{activationFunction:S,applyActivation:_}=(0,s.getActivationSnippet)(u),T=(0,i.getGlsl)(e.session.backend.glContext.version),x=`\n${S}\nfloat process(int indices[${b}]) {\n  int b[1];\n  b[0] = indices[1];\n  int im2col[4];\n  im2col[0] = indices[0];\n  im2col[1] = indices[2];\n  im2col[2] = indices[3];\n  int im2colOffset = im2col[0] * ${g[0]} + im2col[1] * ${g[1]} + im2col[2] * ${g[2]};\n  int kernelOffset = indices[1] * ${h[1]};\n  float value = ${E};\n  for (int i = 0; i < ${w}; ++i) {\n    vec2 im2colCoords = offsetToCoords(im2colOffset, ${v}, ${y});\n    vec2 kernelCoords = offsetToCoords(kernelOffset, ${p}, ${m});\n    value += dot(${T.texture2D}(Im2Col, im2colCoords), ${T.texture2D}(K, kernelCoords));\n    ++im2colOffset;\n    ++kernelOffset;\n  }\n  ${_}\n  return value;\n}`;return Object.assign(Object.assign({},t),{output:{dims:c,type:r[0].type,textureType:o.TextureType.unpacked},shaderSource:x})})(e,u,t,r,c)})}},4125:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseFlattenAttributes=t.flatten=void 0;const n=r(7273);t.flatten=(e,t,r)=>{i(t,r);const o=n.ShapeUtil.flattenShape(t[0].dims,r);return[e.reshapeUnpacked(t[0],o)]},t.parseFlattenAttributes=e=>e.attributes.getInt("axis",1);const i=(e,t)=>{if(!e||1!==e.length)throw new Error("Flatten requires 1 input.");const r=e[0].dims.length;if(0===r)throw new Error("scalar tensor is not supported.");if(t<-r||t>r)throw new Error("Invalid axis");if("string"===e[0].type)throw new Error("string tensor is not supported.")}},2150:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseInternalActivationAttributes=t.getActivationSnippet=void 0;const n=r(7273),i=r(9087);t.getActivationSnippet=function(e){let t;switch(e.activation){case"Relu":t=(0,i.glslRelu)();break;case"Sigmoid":t=(0,i.glslSigmoid)();break;case"Clip":t=(0,i.glslClip)(e.clipMin,e.clipMax);break;default:return{activationFunction:"",applyActivation:""}}const r=t.name;return{activationFunction:t.body,applyActivation:`value = ${r}_(value);`}},t.parseInternalActivationAttributes=e=>{const t=e.getString("activation","");if("Clip"===t){const[r,i]=e.getFloats("activation_params",[n.MIN_CLIP,n.MAX_CLIP]);return{activation:t,clipMax:i,clipMin:r,activationCacheKey:`${t}:${r},${i}`}}return{activation:t,activationCacheKey:t}}},6149:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseGatherAttributes=t.gather=void 0;const n=r(4910),i=r(6145),o=r(7273),s=r(5639);t.gather=(e,t,r)=>(u(t,r.axis),[e.run(c(e,t,r),t)]),t.parseGatherAttributes=e=>(0,n.createAttributeWithCacheKey)({axis:e.attributes.getInt("axis",0)});const a={name:"Gather",inputNames:["A","B"],inputTypes:[s.TextureType.unpacked,s.TextureType.unpacked]},c=(e,t,r)=>{const n=Object.assign(Object.assign({},a),{cacheHint:r.cacheKey});return Object.assign(Object.assign({},n),{get:()=>((e,t,r,n)=>{const i=r[0].dims.slice(),a=r[1].dims.slice(),c=new Array(i.length+a.length-1);n=o.ShapeUtil.normalizeAxis(n,i.length);const u=[];for(let e=0;e<c.length;e++)e<n?(c[e]=i[e],u.push(`inputIdx[${e}] = outputIdx[${e}];`)):e<n+a.length?(c[e]=a[e-n],u.push(`indexDataIdx[${e-n}] = outputIdx[${e}];`)):(c[e]=i[e-a.length+1],u.push(`inputIdx[${e-a.length+1}] = outputIdx[${e}];`));const l=`\n      float process(int outputIdx[${c.length||1}]) {\n        int inputIdx[${i.length}];\n        int indexDataIdx[${a.length||1}];\n        indexDataIdx[0] = 0;\n        ${u.join("\n        ")}\n        int idx = int(_B(indexDataIdx));\n        inputIdx[${n}] = idx < 0 ? idx + ${i[n]} : idx;\n        return _A(inputIdx);\n      }`;return Object.assign(Object.assign({},t),{output:{dims:c,type:r[0].type,textureType:s.TextureType.unpacked},shaderSource:l})})(0,n,t,r.axis)})},u=(e,t)=>{if(!e||2!==e.length)throw new Error("Gather requires 2 inputs.");const r=e[0].dims.length;if(r<1)throw new Error("Invalid input shape.");if(t<-r||t>r-1)throw new Error("Invalid axis.");if(-1===i.NUMBER_TYPES.indexOf(e[0].type))throw new Error("Invaid input type.");if("int32"!==e[1].type&&"int16"!==e[1].type)throw new Error("Invaid input type.")}},5378:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseGemmAttributesV11=t.parseGemmAttributesV7=t.gemm=void 0;const n=r(4910),i=r(7273),o=r(5639);t.gemm=(e,t,r)=>(u(t,r),[e.run(a(t,r),t)]);const s=(e,t)=>{const r=0!==e.attributes.getInt("transA",0),i=0!==e.attributes.getInt("transB",0),o=e.attributes.getFloat("alpha",1),s=e.attributes.getFloat("beta",1);return(0,n.createAttributeWithCacheKey)({transA:r,transB:i,alpha:o,beta:s,isOptionalC:t})};t.parseGemmAttributesV7=e=>s(e,!1),t.parseGemmAttributesV11=e=>s(e,!0);const a=(e,t)=>{const r={name:"Gemm",inputNames:3===e.length?["A","B","C"]:["A","B"],inputTypes:3===e.length?[o.TextureType.unpacked,o.TextureType.unpacked,o.TextureType.unpacked]:[o.TextureType.unpacked,o.TextureType.unpacked],key:t.cacheKey};return Object.assign(Object.assign({},r),{get:()=>c(r,e,t)})},c=(e,t,r)=>{const n=t[0].dims.slice(),s=t[1].dims.slice(),[a,c]=i.GemmUtil.getShapeOfGemmResult(n,r.transA,s,r.transB,3===t.length?t[2].dims:void 0),u=[a,c];if(!u)throw new Error("Can't use gemm on the given tensors");let l=n[n.length-1],d="";r.transA&&(l=n[0]),r.transA&&r.transB?d="value += _A_T(a) * _B_T(b);":r.transA&&!r.transB?d="value += _A_T(a) * _B(b);":!r.transA&&r.transB?d="value += _A(a) * _B_T(b);":r.transA||r.transB||(d="value += _A(a) * _B(b);");const h=u.length,f=`\n      float process(int indices[${h}]) {\n          int a[${h}];\n          int b[${h}];\n          ${3===t.length?`int c[${t[2].dims.length}];`:""}\n\n          copyVec(indices, a);\n          copyVec(indices, b);\n          ${3===t.length?"bcastIndices_C(indices, c);":""}\n\n          float value = 0.0;\n          for (int k=0; k<${l}; ++k) {\n              a[${h-1}] = k;\n              b[${h-2}] = k;\n              ${d}\n          }\n\n          value = value * alpha;\n          ${3===t.length?"value += beta * _C(c);":""}\n          return value;\n      }`;return Object.assign(Object.assign({},e),{output:{dims:u,type:t[0].type,textureType:o.TextureType.unpacked},variables:[{name:"alpha",type:"float",data:r.alpha},{name:"beta",type:"float",data:r.beta}],shaderSource:f})},u=(e,t)=>{if(!e)throw new Error("Input is missing");if(t.isOptionalC&&(e.length<2||e.length>3))throw new Error("Invaid input shape.");if(!t.isOptionalC&&3!==e.length)throw new Error("Gemm requires 3 inputs");if(3===e.length&&1!==e[2].dims.length&&2!==e[2].dims.length)throw new Error("Invalid input shape of C");if("float32"!==e[0].type&&"float64"!==e[0].type||"float32"!==e[1].type&&"float64"!==e[1].type||3===e.length&&"float32"!==e[2].type&&"float64"!==e[2].type)throw new Error("Invalid input type.");if(e[0].type!==e[1].type||3===e.length&&e[0].type!==e[2].type)throw new Error("Input types are mismatched")}},5950:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createPackedIm2ColProgramInfoLoader=void 0;const n=r(6757),i=r(5639),o=r(5614);t.createPackedIm2ColProgramInfoLoader=(e,t,r,s,a)=>{const c=(u=a.cacheKey,{name:"Im2Col (packed)",inputNames:["A"],inputTypes:[i.TextureType.packed],cacheHint:u});var u;return Object.assign(Object.assign({},c),{get:()=>((e,t,r,s,a,c)=>{const u=r.dims,l=s.dims,d=a.length,h=[l[1]*l[2]*l[3],a[2]*a[3]],f=l[2]*l[3],p=(0,o.unpackFromChannel)(),m=(0,n.getGlsl)(e.session.backend.glContext.version);let g="";for(let e=0;e<=1;e++)for(let t=0;t<=1;t++)g+=`\n            blockIndex = rc.x + ${t};\n            pos = rc.y + ${e};\n\n            if(blockIndex < ${h[1]} && pos < ${h[0]}) {\n              offsetY = int(blockIndex / (${a[d-1]})) * ${c.strides[0]} -\n                ${c.pads[0]};\n              d0 = offsetY + ${c.dilations[0]} * (imod(pos, ${f}) / ${l[2]});\n\n              if(d0 < ${u[2]} && d0 >= 0) {\n                offsetX = imod(blockIndex, ${a[d-1]}) * ${c.strides[1]} -\n                  ${c.pads[1]};\n                d1 = offsetX + ${c.dilations[1]} * imod(imod(pos, ${f}), ${l[2]});\n\n                if(d1 < ${u[3]} && d1 >= 0) {\n\n                  ch = int(float(pos)/ ${f}.);\n                    innerDims = vec2(d0, d1);\n                    result[${2*e+t}] = getChannel(\n                      getA(0, ch, int(innerDims.x),\n                      int(innerDims.y)), innerDims);\n                }\n              }\n            }\n\n          `;const v=`\n      ${p}\n\n      void main() {\n        ivec2 rc = getOutputCoords();\n          vec4 result = vec4(0.0);\n          int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n          vec2 innerDims;\n          ${g}\n          ${m.output} = result;\n      }\n            `;return Object.assign(Object.assign({},t),{output:{dims:h,type:r.type,textureType:i.TextureType.packed},shaderSource:v,hasMain:!0})})(e,c,t,r,s,a)})}},1625:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.calculateIm2ColDims=t.createIm2ColProgramInfoLoader=void 0;const n=r(5639);t.createIm2ColProgramInfoLoader=(e,r,i,o,s)=>{const a=(c=s.cacheKey,{name:"Im2Col",inputNames:["X"],inputTypes:[n.TextureType.unpacked],cacheHint:c});var c;return Object.assign(Object.assign({},a),{get:()=>((e,r,i,o,s,a)=>{const c=i.dims,u=o.dims,l=s.length,d=(0,t.calculateIm2ColDims)(c,u,s,4),h=`\n        const int XC = ${c[1]};\n        const int XH = ${c[2]};\n        const int XW = ${c[3]};\n        const int KH = ${a.kernelShape[0]};\n        const int KW = ${a.kernelShape[1]};\n        const int dilationH = ${a.dilations[0]};\n        const int dilationW = ${a.dilations[1]};\n        const int strideH = ${a.strides[0]};\n        const int strideW = ${a.strides[1]};\n        const int padH = ${a.pads[0]};\n        const int padW = ${a.pads[1]};\n        const int KHKW = KH*KW;\n        const int XCKHKW = XC * KHKW;\n        const int outputChannels = 4;\n        vec4 process(int indices[${l}]) {\n          int b  = indices[0]; // batch size\n          int oh = indices[1] * strideH - padH; //output height\n          int ow = indices[2] * strideW - padW; //output width\n          int p = indices[3] * outputChannels; //patch\n          vec4 value = vec4(0.0);\n          for(int i=0; i < outputChannels; ++i) {\n            if(p < XCKHKW) {\n              int patchC = p / KHKW;\n              int patchH = (p - patchC*KHKW) / KW;\n              int patchW = (p - patchC*KHKW) - patchH * KW;\n              int xh2 = oh + patchH * dilationH;\n              int xw2 = ow + patchW * dilationW;\n              int x[${c.length}];\n              x[0] = b;\n              x[1] = patchC;\n              x[2] = xh2;\n              x[3] = xw2;\n              if(xh2 >= 0 &&\n                  xh2 < XH &&\n                  xw2 >= 0 &&\n                  xw2 < XW) {\n                value[i] = _X(x);\n              }\n            }\n            ++p;\n          }\n          return value;\n        }\n        `;return Object.assign(Object.assign({},r),{output:{dims:d,type:i.type,textureType:n.TextureType.packedLastDimension},shaderSource:h})})(0,a,r,i,o,s)})},t.calculateIm2ColDims=(e,t,r,n=4)=>[r[0],r[2],r[3],Math.ceil(e[1]*t[2]*t[3]/n)]},6981:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseImageScalerAttributes=t.imageScaler=void 0;const n=r(4910),i=r(5639);t.imageScaler=(e,t,r)=>(c(t),[e.run(s(e,t,r),t)]),t.parseImageScalerAttributes=e=>{const t=e.attributes.getFloat("scale"),r=e.attributes.getFloats("bias");return(0,n.createAttributeWithCacheKey)({scale:t,bias:r})};const o={name:"ImageScaler",inputNames:["X"],inputTypes:[i.TextureType.unpacked]},s=(e,t,r)=>{const n=Object.assign(Object.assign({},o),{cacheHint:r.cacheKey});return Object.assign(Object.assign({},n),{get:()=>((e,t,r,n)=>{const o=r[0].dims.slice(),s=o.length,c=`\n      ${a(n.bias.length)}\n      float process(int indices[${s}]) {\n        return _X(indices) * scale + getBias(bias, indices[1]);\n      }`;return Object.assign(Object.assign({},t),{output:{dims:o,type:r[0].type,textureType:i.TextureType.unpacked},variables:[{name:"bias",type:"float",arrayLength:n.bias.length,data:n.bias},{name:"scale",type:"float",data:n.scale}],shaderSource:c})})(0,n,t,r)})},a=e=>{const t=[`float getBias(float bias[${e}], int channel) {`];for(let r=0;r<e;++r)0===r?t.push(`\tif (channel == ${r}) { return bias[${r}]; }`):r===e-1?t.push(`\telse { return bias[${r}]; }`):t.push(`\telse if (channel == ${r}) { return bias[${r}]; }`);return t.push("\t}"),t.join("\n")},c=e=>{if(!e||1!==e.length)throw new Error("ImageScaler requires 1 input.");if(4!==e[0].dims.length)throw new Error("Invalid input shape.");if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("Invalid input type.")}},7413:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseInstanceNormalizationAttributes=t.instanceNormalization=void 0;const n=r(6757),i=r(5639);t.instanceNormalization=(e,t,r)=>{u(t);const n=e.run(s(t[0]),t);return[e.run(c(e,t[0],r,n.dims),[t[0],n,t[1],t[2]])]},t.parseInstanceNormalizationAttributes=e=>e.attributes.getFloat("epsilon",1e-5);const o={name:"InstanceNormalization_MeanAndVariance",inputNames:["X"],inputTypes:[i.TextureType.unpacked]},s=e=>Object.assign(Object.assign({},o),{get:()=>((e,t)=>{const r=t.dims.slice(),n=r[1],o=r[2]*r[3],s=[r[0],n],a=`\n      vec4 process(int[2] indices) {\n        vec4 v = vec4(0.0);\n        int a[4];\n        a[0] = indices[0];\n        a[1] = indices[1];\n        float temp = 0.0;\n        for(int a2=0; a2<${r[2]}; a2++) {\n          a[2] = a2;\n          for(int a3=0; a3<${r[3]}; a3++) {\n            a[3] = a3;\n            float x = _X(a);\n            temp += x;\n          }\n        }\n        float mean = temp / float(${o});\n        temp = 0.0;\n        for(int a2=0; a2<${r[2]}; a2++) {\n          a[2] = a2;\n          for(int a3=0; a3<${r[3]}; a3++) {\n            a[3] = a3;\n            float x = _X(a);\n            temp += (x - mean) * (x - mean);\n          }\n        }\n        v.r = mean;\n        v.g = temp / float(${o});\n\n        return v;\n      }`;return Object.assign(Object.assign({},e),{output:{dims:s,type:t.type,textureType:i.TextureType.packedLastDimension},shaderSource:a})})(o,e)}),a={name:"InstanceNormalization_ComputeOutput",inputNames:["X","MeanAndVariance","Scale","B"],inputTypes:[i.TextureType.unpacked,i.TextureType.packedLastDimension,i.TextureType.unpacked,i.TextureType.unpacked]},c=(e,t,r,o)=>{const s=Object.assign(Object.assign({},a),{cacheHint:`${r}`});return Object.assign(Object.assign({},s),{get:()=>((e,t,r,o,s)=>{const a=(0,n.getGlsl)(e.session.backend.glContext.version),[c,u]=e.calculateTextureWidthAndHeight(s,i.TextureType.packedLastDimension),[l,d]=[c/4,u],h=`\n      vec4 get_MeanAndVariance(int[2] mv) {\n        int offset = indicesToOffset_MeanAndVariance(mv);\n        vec2 coords = offsetToCoords(offset, ${l}, ${d});\n        return ${a.texture2D}(MeanAndVariance, coords);\n      }\n\n      float process(int[4] indices) {\n        int mv[2];\n        mv[0] = indices[0];\n        mv[1] = indices[1];\n        vec4 mean_and_variance = get_MeanAndVariance(mv);\n        float mean = mean_and_variance.r;\n        float variance = mean_and_variance.g;\n\n        int sb[1];\n        sb[0] = indices[1];\n        float scale = _Scale(sb);\n        float b = _B(sb);\n\n        return scale * (_X(indices) - mean) / sqrt(variance + epsilon) + b;\n      }`;return Object.assign(Object.assign({},t),{output:{dims:r.dims,type:r.type,textureType:i.TextureType.unpacked},variables:[{name:"epsilon",type:"float",data:o}],shaderSource:h})})(e,s,t,r,o)})},u=e=>{if(!e||3!==e.length)throw new Error("InstanceNormalization requires 3 inputs.");const t=e[0],r=e[1],n=e[2];if(t.dims.length<3||1!==r.dims.length||1!==n.dims.length)throw new Error("Invalid input shape.");if(r.dims[0]!==t.dims[1]||n.dims[0]!==t.dims[1])throw new Error("Input shapes are mismatched.");if("float32"!==t.type&&"float64"!==t.type||"float32"!==r.type&&"float64"!==r.type||"float32"!==n.type&&"float64"!==n.type)throw new Error("Invalid input type.");if(4!==e[0].dims.length)throw new Error("Only support 4-D input shape.")}},7006:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createLrnProgramInfoLoader=t.parseLrnAttributes=t.lrn=void 0;const n=r(4910),i=r(5639);t.lrn=(e,t,r)=>(a(t),[e.run(s(t,r),t)]),t.parseLrnAttributes=e=>{const t=e.attributes.getFloat("alpha",1e-4),r=e.attributes.getFloat("beta",.75),i=e.attributes.getFloat("bias",1),o=e.attributes.getInt("size");return(0,n.createAttributeWithCacheKey)({alpha:t,beta:r,bias:i,size:o})};const o={name:"LRN",inputNames:["X"],inputTypes:[i.TextureType.unpacked]};function s(e,t){return Object.assign(Object.assign({},o),{cacheHint:t.cacheKey,get:()=>function(e,t){const r=e[0].dims[1],n=e[0].dims.length,s=-Math.floor((t.size-1)/2),a=Math.ceil((t.size-1)/2),c=`float(${t.alpha}) / float(${t.size})`,u=`\n    float process(int indices[${n}]) {\n        int c = indices[1];\n        float x = _X(indices);\n        float square_sum = 0.0;\n\n        for (int i = ${s}; i <= ${a}; i++) {\n          int idx = c + i;\n          if (c >= 0 && c < ${r}) {\n            indices[1] = idx;\n            float j = _X(indices);\n            square_sum += j * j;\n          }\n        }\n        return x / pow(float(${t.bias}) + ${c} * square_sum, float(${t.beta}));\n    }`;return Object.assign(Object.assign({},o),{cacheHint:t.cacheKey,output:{dims:e[0].dims,type:e[0].type,textureType:i.TextureType.unpacked},shaderSource:u})}(e,t)})}t.createLrnProgramInfoLoader=s;const a=e=>{if(!e||1!==e.length)throw new Error("LRN requires 1 input.");if(4!==e[0].dims.length)throw new Error('currently only support LRN for input with "NCHW" format');if("float32"!==e[0].type)throw new Error("input should be float type")}},5632:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createPackedMatmulProgramInfoLoader=void 0;const n=r(7273),i=r(6757),o=r(5639),s=r(432),a=r(2150),c=r(8276);t.createPackedMatmulProgramInfoLoader=(e,t,r)=>{const u=(l=t.length>2,d=r.activationCacheKey,{name:"MatMul (packed)",inputNames:l?["A","B","Bias"]:["A","B"],inputTypes:l?[o.TextureType.packed,o.TextureType.packed,o.TextureType.packed]:[o.TextureType.packed,o.TextureType.packed],cacheHint:d});var l,d;return Object.assign(Object.assign({},u),{get:()=>((e,t,r,u)=>{const l=r.length>2,d=l?"value += getBiasForMatmul();":"",h=r[0].dims,f=r[1].dims,p=n.BroadcastUtil.calcShape(h,f,!0),m=!n.ShapeUtil.areEqual(r[0].dims,r[1].dims);if(!p)throw new Error("Can't use matmul on the given tensors");const g=h[h.length-1],v=Math.ceil(g/2),y=h.length,b=f.length,E=(0,i.getGlsl)(e.session.backend.glContext.version),w=(0,s.getCoordsDataType)(p.length),S=p.length,_=(0,s.getGlChannels)(),{activationFunction:T,applyActivation:x}=(0,a.getActivationSnippet)(u),A=l?`${(0,c.getBiasForMatmul)(w,_,r[2].dims,p,!0)}`:"",I=m?`${function(e,t,r,i){let o=[],s=[];const a=r[0].dims,c=r[1].dims,u=a.length,l=c.length,d=i.length,h=d-u,f=d-l;o=a.map(((e,r)=>`coords.${t[r+h]}`)),o[u-1]="i*2",o.join(", "),s=c.map(((e,r)=>`coords.${t[r+f]}`)),s[l-2]="i*2",s.join(", ");const p=n.BroadcastUtil.getBroadcastDims(a,i),m=n.BroadcastUtil.getBroadcastDims(c,i),g=p.map((e=>`coords.${t[e+h]} = 0;`)).join("\n"),v=m.map((e=>`coords.${t[e+f]} = 0;`)).join("\n"),y=`int lastDim = coords.${t[d-1]};\n  coords.${t[d-1]} = coords.${t[d-2]};\n  coords.${t[d-2]} = lastDim;`;return`\nvec4 getAAtOutCoordsMatmul(int i) {\n  ${e} coords = getOutputCoords();\n  ${y}\n  ${g}\n  vec4 outputValue = getA(${o});\n  return outputValue;\n}\n\nvec4 getBAtOutCoordsMatmul(int i) {\n  ${e} coords = getOutputCoords();\n  ${y}\n  ${v}\n  vec4 outputValue = getB(${s});\n  return outputValue;\n}`}(w,_,r,p)}`:"",C=m?"getAAtOutCoordsMatmul(i)":`getA(${function(e,t){let r="";for(let n=0;n<t-2;n++)r+=`rc.${e[n]}, `;return r+=`rc.${e[t-2]}, i*2`,r}(_,y)})`,R=m?"getBAtOutCoordsMatmul(i)":`getB(${function(e,t){let r="";for(let n=0;n<t-2;n++)r+=`rc.${e[n]}, `;return r+=`i*2, rc.${e[t-1]}`,r}(_,b)})`,k=`\n            ${I}\n            ${A}\n            ${T}\n            void main() {\n              ${m?"":`${w} rc =\n          getOutputCoords(); int lastDim = rc.${_[S-1]}; rc.${_[S-1]} =\n          rc.${_[S-2]}; rc.${_[S-2]} = lastDim;\n      `}\n\n              vec4 value = vec4(0);\n              for (int i = 0; i < ${v}; i++) {\n                vec4 a = ${C};\n                vec4 b = ${R};\n\n                value += (a.rrbb * b.rgrg);\n                value += (a.ggaa * b.baba);\n              }\n              ${d}\n              ${x}\n              ${E.output} = value;\n            }`;return Object.assign(Object.assign({},t),{output:{dims:p,type:r[0].type,textureType:o.TextureType.packed},shaderSource:k,hasMain:!0})})(e,u,t,r)})}},8276:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBiasForMatmul=t.createMatmulProgramInfoLoader=t.parseMatMulAttributes=t.matMul=void 0;const n=r(7273),i=r(5639),o=r(432),s=r(2150),a=r(5632);t.matMul=(e,t,r)=>(l(t),e.session.pack?[e.run((0,a.createPackedMatmulProgramInfoLoader)(e,t,r),t)]:[e.run(u(t,r),t)]),t.parseMatMulAttributes=e=>(0,s.parseInternalActivationAttributes)(e.attributes);const c=(e,t)=>({name:"MatMul",inputNames:e?["A","B","Bias"]:["A","B"],inputTypes:e?[i.TextureType.unpacked,i.TextureType.unpacked,i.TextureType.unpacked]:[i.TextureType.unpacked,i.TextureType.unpacked],cacheHint:t});function u(e,t){const r=c(e.length>2,t.activationCacheKey);return Object.assign(Object.assign({},r),{get:()=>function(e,t,r){const a=t[0].dims,c=t[1].dims,u=n.BroadcastUtil.calcShape(a,c,!0);if(!u)throw new Error("Can't use matmul on the given tensors");const l=(0,o.getCoordsDataType)(u.length),h=(0,o.getGlChannels)(),{activationFunction:f,applyActivation:p}=(0,s.getActivationSnippet)(r),m=t.length>2,g=m?"value += getBiasForMatmul();":"",v=m?`${d(l,h,t[2].dims,u,!1)}`:"",y=u.length,b=a.length,E=c.length,w=`\n    ${f}\n    ${v}\n    float process(int indices[${y}]) {\n        int a[${b}];\n        int b[${E}];\n        bcastMatmulIndices_A(indices, a);\n        bcastMatmulIndices_B(indices, b);\n\n        float value;\n        for (int k=0; k<${a[a.length-1]}; ++k) {\n            a[${b-1}] = k;\n            b[${E-2}] = k;\n            value += _A(a) * _B(b);\n        }\n        ${g}\n        ${p}\n        return value;\n    }`;return Object.assign(Object.assign({},e),{output:{dims:u,type:t[0].type,textureType:i.TextureType.unpacked},shaderSource:w})}(r,e,t)})}t.createMatmulProgramInfoLoader=u;const l=e=>{if(!e||2!==e.length)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.");if("float32"!==e[0].type&&"float64"!==e[0].type||"float32"!==e[1].type&&"float64"!==e[1].type)throw new Error("inputs should be float type");if(e[0].type!==e[1].type)throw new Error("inputs types should match")};function d(e,t,r,i,o){let s="";const a=r.length,c=i.length,u=c-a;s=c<2&&a>0?"coords":r.map(((e,r)=>`coords.${t[r+u]}`)).join(", ");const l=n.BroadcastUtil.getBroadcastDims(r,i).map((e=>`coords.${t[e+u]} = 0;`)).join("\n");let d="vec4(outputValue.xx, outputValue.yy)";return 1===n.ShapeUtil.size(r)&&(d="vec4(outputValue.x)"),o?`\nvec4 getBiasForMatmul() {\n  ${e} coords = getOutputCoords();\n  ${l}\n  vec4 outputValue = getBias(${s});\n  return ${d};\n}`:`\nfloat getBiasForMatmul() {\n  ${e} coords = getOutputCoords();\n  ${l}\n  return getBias(coords.x);\n}`}t.getBiasForMatmul=d},9:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createPackProgramInfoLoader=void 0;const n=r(6757),i=r(5639),o=r(432),s=r(5614),a={name:"pack",inputNames:["A"],inputTypes:[i.TextureType.unpackedReversed]};t.createPackProgramInfoLoader=(e,t)=>Object.assign(Object.assign({},a),{get:()=>((e,t)=>{const r=(0,n.getGlsl)(e.session.backend.glContext.version),c=t.dims,u=c.length,l=t.dims.length,d=(0,o.getCoordsDataType)(l),h=(0,s.getChannels)("rc",l),f=(p=l,m=h,g=c[c.length-2],v=c[c.length-1],0===p||1===p?"":`\n    int r = ${m[p-2]};\n    int c = ${m[p-1]};\n    int rp1 = ${m[p-2]} + 1;\n    int cp1 = ${m[p-1]} + 1;\n    bool rEdge = rp1 >= ${v};\n    bool cEdge = cp1 >= ${g};\n    `);var p,m,g,v;let y;y=0===u?[1,1]:1===u?[c[0],1]:[c[l-1],c[l-2]];const b=function(e,t,r){if(0===e)return"false";if(1===e)return`rc > ${t[0]}`;let n="";for(let i=e-2;i<e;i++)n+=`${r[i]} >= ${t[i-e+2]}`,i<e-1&&(n+="||");return n}(l,y,h),E=function(e,t){const r=e.length;if(0===r)return"getA(), 0, 0, 0";if(1===r)return`getA(rc),\n            rc + 1 >= ${e[0]} ? 0. : getA(rc + 1),\n            0, 0`;let n="";if(r>2)for(let e=0;e<r-2;++e)n+=`${t[e]},`;return`getA(${n}r, c),\n          rEdge ? 0. : getA(${n}rp1, c),\n          cEdge ? 0. : getA(${n}r, cp1),\n          rEdge || cEdge ? 0. : getA(${n}rp1, cp1)`}(c,h),w=`\n        void main() {\n          ${d} rc = getOutputCoords();\n\n          if(${b}) {\n            ${r.output} = vec4(0);\n          } else {\n            ${f}\n\n            ${r.output} = vec4(${E});\n          }\n        }\n      `;return Object.assign(Object.assign({},a),{hasMain:!0,output:{dims:t.dims,type:t.type,textureType:i.TextureType.packed},shaderSource:w})})(e,t)})},5614:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unpackFromChannel=t.getChannels=t.getVecChannels=void 0;const n=r(432);function i(e,t){return(0,n.getGlChannels)(t).map((t=>`${e}.${t}`))}t.getVecChannels=i,t.getChannels=function(e,t){return 1===t?[e]:i(e,t)},t.unpackFromChannel=function(){return"\n    float getChannel(vec4 frag, int dim) {\n      int modCoord = imod(dim, 2);\n      return modCoord == 0 ? frag.r : frag.g;\n    }\n\n    float getChannel(vec4 frag, vec2 innerDims) {\n      vec2 modCoord = mod(innerDims, 2.);\n      return modCoord.x == 0. ?\n        (modCoord.y == 0. ? frag.r : frag.g) :\n        (modCoord.y == 0. ? frag.b : frag.a);\n    }\n  "}},5565:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parsePadAttributesV11=t.padV11=t.parsePadAttributesV2=t.padV2=void 0;const n=r(4910),i=r(7273),o=r(6757),s=r(5639),a={name:"Pad",inputNames:["A"],inputTypes:[s.TextureType.unpacked]};t.padV2=(e,t,r)=>(l(t),[e.run(Object.assign(Object.assign({},a),{cacheHint:r.cacheKey,get:()=>u(e,t[0],r)}),t)]),t.parsePadAttributesV2=e=>{const t=e.attributes.getString("mode","constant"),r=e.attributes.getFloat("value",0),i=e.attributes.getInts("pads");return(0,n.createAttributeWithCacheKey)({mode:t,value:r,pads:i})},t.padV11=(e,r,n)=>{d(r);const i=c(e,r,n);return(0,t.padV2)(e,[r[0]],i)},t.parsePadAttributesV11=e=>e.attributes.getString("mode","constant");const c=(e,t,r)=>{if(!e.session.isInitializer(t[1].dataId)||t.length>=3&&!e.session.isInitializer(t[2].dataId))throw new Error("dynamic pad attributes are not allowed");const i=Array.from(t[1].integerData),o=t.length>=3?t[2].floatData[0]:0;return(0,n.createAttributeWithCacheKey)({mode:r,pads:i,value:o})},u=(e,t,r)=>{const n=i.ShapeUtil.padShape(t.dims.slice(),r.pads),o=n.length,a=`\n      ${h(e,t,r)}\n      float process(int[${o}] indices) {\n          return padA(indices);\n      }`;return{name:"Pad",inputNames:["A"],inputTypes:[s.TextureType.unpacked],output:{dims:n,type:t.type,textureType:s.TextureType.unpacked},shaderSource:a}},l=e=>{if(!e||1!==e.length)throw new Error("Pad requires 1 input");if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("Invalid input type.")},d=e=>{if(!e||2!==e.length&&3!==e.length)throw new Error("Pad requires 2 or 3 inputs");if("int32"!==e[1].type)throw new Error("Invalid input type.");if(e.length>=3&&"string"===e[2].type)throw new Error("Invalid input type.")},h=(e,t,r)=>{const n=(0,o.getGlsl)(e.session.backend.glContext.version),[a,c]=e.calculateTextureWidthAndHeight(t.dims,s.TextureType.unpacked),u=i.ShapeUtil.computeStrides(t.dims);switch(r.mode){case"constant":return f(n,t.dims,u,a,c,r.pads,r.value);case"reflect":return p(n,t.dims,u,a,c,r.pads);case"edge":return m(n,t.dims,u,a,c,r.pads);default:throw new Error("Invalid mode")}},f=(e,t,r,n,i,o,s)=>{const a=t.length;let c="";for(let e=a-1;e>=0;--e)c+=`\n        k = m[${e}] - ${o[e]};\n        if (k < 0)  return constant;\n        if (k >= ${t[e]}) return constant;\n        offset += k * ${r[e]};\n        `;return`\n      float padA(int m[${a}]) {\n        const float constant = float(${s});\n        int offset = 0;\n        int k = 0;\n        ${c}\n        vec2 coords = offsetToCoords(offset, ${n}, ${i});\n        float value = getColorAsFloat(${e.texture2D}(A, coords));\n        return value;\n      }\n      `},p=(e,t,r,n,i,o)=>{const s=t.length;let a="";for(let e=s-1;e>=0;--e)a+=`\n        k = m[${e}] - ${o[e]};\n        if (k < 0) { k = -k; }\n        {\n          const int _2n_1 = ${2*(t[e]-1)};\n          k = int( mod( float(k), float(_2n_1) ) ) ;\n          if(k >= ${t[e]}) { k = _2n_1 - k; }\n        }\n        offset += k * ${r[e]};\n        `;return`\n      float padA(int m[${s}]) {\n        int offset = 0;\n        int k = 0;\n        ${a}\n        vec2 coords = offsetToCoords(offset, ${n}, ${i});\n        float value = getColorAsFloat(${e.texture2D}(A, coords));\n        return value;\n      }\n      `},m=(e,t,r,n,i,o)=>{const s=t.length;let a="";for(let e=s-1;e>=0;--e)a+=`\n        k = m[${e}] - ${o[e]};\n        if (k < 0)  k = 0;\n        if (k >= ${t[e]}) k = ${t[e]-1};\n        offset += k * ${r[e]};\n      `;return`\n      float padA(int m[${s}]) {\n        int offset = 0;\n        int k = 0;\n        ${a}\n        vec2 coords = offsetToCoords(offset, ${n}, ${i});\n        float value = getColorAsFloat(${e.texture2D}(A, coords));\n        return value;\n      }\n      `}},2834:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.globalMaxPool=t.parseMaxPoolAttributes=t.maxPool=t.parseGlobalAveragePoolAttributes=t.globalAveragePool=t.parseAveragePoolAttributes=t.averagePool=void 0;const n=r(4910),i=r(7273),o=r(5639);t.averagePool=(e,t,r)=>{d(t);const n={name:"AveragePool",inputNames:["X"],inputTypes:[o.TextureType.unpacked],cacheHint:r.cacheKey};return[e.run(Object.assign(Object.assign({},n),{get:()=>s(t,n,!1,r)}),t)]},t.parseAveragePoolAttributes=e=>{const t=e.attributes.getString("auto_pad","NOTSET"),r=e.attributes.getInt("ceil_mode",0),i=0!==e.attributes.getInt("count_include_pad",0),o=e.attributes.getInts("kernel_shape"),s=e.attributes.getInts("strides",[]),a=e.attributes.getInts("pads",[]);if(0!==r)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");return(0,n.createAttributeWithCacheKey)({autoPad:t,ceilMode:r,countIncludePad:i,kernelShape:o,strides:s,pads:a})};const s=(e,t,r,n)=>{const[s,a]=c(e,n,r),u=i.ShapeUtil.size(s.kernelShape);let l="";s.countIncludePad?l+=`value /= float(${u});`:l+=`value /= float(${u} - pad);`;const d=`\n        ${h(e[0].dims,s,"value += _X(x);",l,"0.0")}\n      `;return Object.assign(Object.assign({},t),{output:{dims:a,type:e[0].type,textureType:o.TextureType.unpacked},shaderSource:d})};t.globalAveragePool=(e,t,r)=>{d(t);const n={name:"GlobalAveragePool",inputNames:["X"],inputTypes:[o.TextureType.unpacked],cacheHint:`${r.countIncludePad}`};return[e.run(Object.assign(Object.assign({},n),{get:()=>s(t,n,!0,r)}),t)]},t.parseGlobalAveragePoolAttributes=e=>{const t=0!==e.attributes.getInt("count_include_pad",0);return(0,n.createAttributeWithCacheKey)({autoPad:"",ceilMode:0,countIncludePad:t,kernelShape:[],strides:[],pads:[]})},t.maxPool=(e,t,r)=>{d(t);const n={name:"MaxPool",inputNames:["X"],inputTypes:[o.TextureType.unpacked],cacheHint:r.cacheKey};return[e.run(Object.assign(Object.assign({},n),{get:()=>a(t,n,!1,r)}),t)]},t.parseMaxPoolAttributes=e=>{const t=e.attributes.getString("auto_pad","NOTSET"),r=e.attributes.getInt("ceil_mode",0),i=e.attributes.getInts("kernel_shape"),o=e.attributes.getInts("strides",[]),s=e.attributes.getInts("pads",[]),a=e.attributes.getInt("storage_order",0),c=e.attributes.getInts("dilations",[]);if(0!==a)throw new Error("column major storage order is not yet supported for MaxPool");if(0!==r)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");return(0,n.createAttributeWithCacheKey)({autoPad:t,ceilMode:r,countIncludePad:!1,kernelShape:i,strides:o,pads:s,storageOrder:a,dilations:c})};const a=(e,t,r,n)=>{const[i,s]=c(e,n,r),a=`\n      ${h(e[0].dims,i,"\n      value = max(_X(x), value);\n    ","","-1e5")}\n    `;return Object.assign(Object.assign({},t),{output:{dims:s,type:e[0].type,textureType:o.TextureType.unpacked},shaderSource:a})},c=(e,t,r)=>{const n=e[0].dims.slice(),o=Object.hasOwnProperty.call(t,"dilations"),s=t.kernelShape.slice(),a=t.strides.slice(),c=o?t.dilations.slice():[],u=t.pads.slice();i.PoolConvUtil.adjustPoolAttributes(r,n,s,a,c,u);const l=i.PoolConvUtil.computePoolOutputShape(r,n,a,c,s,u,t.autoPad),d=Object.assign({},t);return o?Object.assign(d,{kernelShape:s,strides:a,pads:u,dilations:c,cacheKey:t.cacheKey}):Object.assign(d,{kernelShape:s,strides:a,pads:u,cacheKey:t.cacheKey}),[d,l]},u={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[],cacheKey:""},l={name:"GlobalMaxPool",inputNames:["X"],inputTypes:[o.TextureType.unpacked]};t.globalMaxPool=(e,t)=>(d(t),[e.run(Object.assign(Object.assign({},l),{get:()=>a(t,l,!0,u)}),t)]);const d=e=>{if(!e||1!==e.length)throw new Error("Pool ops requires 1 input.");if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("Invalid input type.")},h=(e,t,r,n,o)=>{const s=e.length;if(t.kernelShape.length<=2){const i=t.kernelShape[t.kernelShape.length-1],a=t.strides[t.strides.length-1],c=t.pads[t.pads.length/2-1],u=t.pads[t.pads.length-1],l=e[s-1];let d="",h="",f="";if(d=c+u!==0?`\n          for (int i = 0; i < ${i}; i++) {\n            x[${s} - 1] = indices[${s} - 1] * ${a} - ${c} + i;\n            if (x[${s} - 1] < 0 || x[${s} - 1] >= ${l}) {\n              pad++;\n              continue;\n            }\n            ${r}\n          }`:`\n          for (int i = 0; i < ${i}; i++) {\n            x[${s} - 1] = indices[${s} - 1] * ${a} - ${c} + i;\n            ${r}\n          }`,2===t.kernelShape.length){const r=t.kernelShape[t.kernelShape.length-2],n=t.strides[t.strides.length-2],o=t.pads[t.pads.length/2-2],a=t.pads[t.pads.length-2],c=e[s-2];h=o+a!==0?`\n            for (int j = 0; j < ${r}; j++) {\n              x[${s} - 2] = indices[${s} - 2] * ${n} - ${o} + j;\n              if (x[${s} - 2] < 0 || x[${s} - 2] >= ${c}) {\n                pad+= ${i};\n                continue;\n              }\n          `:`\n            for (int j = 0; j < ${r}; j++) {\n              x[${s} - 2] = indices[${s} - 2] * ${n} - ${o} + j;\n            `,f="\n          }\n        "}return`\n        float process(int indices[${s}]) {\n          int x[${s}];\n          copyVec(indices, x);\n\n          float value = ${o};\n          int pad = 0;\n          ${h}\n          ${d}\n          ${f}\n          ${n}\n          return value;\n        }\n      `}{const a=i.ShapeUtil.size(t.kernelShape),c=i.ShapeUtil.computeStrides(t.kernelShape),u=c.length,l=t.pads.length,d=p(u),h=f(e,"inputDims"),m=f(t.pads,"pads"),g=f(c,"kernelStrides"),v=f(t.strides,"strides");let y="";return y=t.pads.reduce(((e,t)=>e+t))?`\n            if (x[j] >= inputDims[j] || x[j] < 0) {\n              pad++;\n              isPad = true;\n              break;\n            }\n          }\n          if (!isPad) {\n            ${r}\n          }`:`\n          }\n          ${r}\n        `,`\n        ${d}\n        float process(int indices[${s}]) {\n          int x[${s}];\n          copyVec(indices, x);\n          int offset[${u}];\n          int pads[${l}];\n          int inputDims[${s}];\n          int kernelStrides[${u}];\n          int strides[${u}];\n          ${m}\n          ${h}\n          ${v}\n          ${g}\n\n          float value = ${o};\n          int pad = 0;\n          bool isPad = false;\n          for (int i = 0; i < ${a}; i++) {\n            offsetToIndices(i, kernelStrides, offset);\n            isPad = false;\n            for (int j = ${s} - ${u}; j < ${s}; j++) {\n              x[j] = indices[j] * strides[j - ${s} + ${u}]\n                + offset[j - ${s} + ${u}] - pads[j - 2];\n              ${y}\n          }\n          ${n}\n\n          return value;\n        }\n      `}},f=(e,t)=>{let r="";for(let n=0;n<e.length;n++)r+=`\n      ${t}[${n}] = ${e[n]};\n    `;return r},p=e=>`\n  void offsetToIndices(int offset, int[${e}] strides, out int[${e}] indices) {\n    if (${e} == 0) {\n      return;\n    }\n    for (int i = 0; i < ${e} - 1; ++i) {\n      indices[i] = offset / strides[i];\n      offset -= indices[i] * strides[i];\n    }\n    indices[${e} - 1] = offset;\n  }`},1010:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reduceLogSumSquare=t.reduceLogSum=t.reduceProd=t.reduceMin=t.reduceMax=t.reduceMean=t.reduceSum=t.parseReduceAttributes=void 0;const n=r(4910),i=r(6145),o=r(7273),s=r(5639),a=(e,t,r,n,i)=>{u(t);const o={name:n,inputNames:["A"],inputTypes:[s.TextureType.unpacked]};return[e.run(Object.assign(Object.assign({},o),{cacheHint:r.cacheKey,get:()=>c(e,t,r,n,i,o)}),t)]};t.parseReduceAttributes=e=>{const t=e.attributes.getInts("axes",[]),r=1===e.attributes.getInt("keepdims",1);return(0,n.createAttributeWithCacheKey)({axes:t,keepDims:r})};const c=(e,t,r,n,i,a)=>{const c=[],u=t[0].dims.length||1,l=[],d=o.ShapeUtil.normalizeAxes(r.axes,t[0].dims.length),h=i(t,d);let f=h[1];for(let e=0;e<t[0].dims.length;e++)d.indexOf(e)>=0||0===d.length?(r.keepDims&&c.push(1),f=`\n          for(int j${e} = 0; j${e} < ${t[0].dims[e]}; j${e}++) {\n            inputIdx[${e}] = j${e};\n            ${f}\n          }`):(l.push(`inputIdx[${e}] = outputIdx[${c.length}];`),c.push(t[0].dims[e]));const p=`\n      float process(int outputIdx[${c.length||1}]) {\n        float value;                 // final result\n        int inputIdx[${u}];      // addressing input data\n        ${l.join("\n")}\n        ${h[0]}       // init ops for reduce max/min\n        ${f}\n        ${h[2]}       // final computation for reduce mean\n        return value;\n      }`;return Object.assign(Object.assign({},a),{output:{dims:c,type:t[0].type,textureType:s.TextureType.unpacked},shaderSource:p})},u=e=>{if(!e||1!==e.length)throw new Error("Reduce op requires 1 input.");if(-1===i.NUMBER_TYPES.indexOf(e[0].type))throw new Error("Invalid input type.")};t.reduceSum=(e,t,r)=>a(e,t,r,"ReduceSum",(()=>["value = 0.0;","value += _A(inputIdx);",""])),t.reduceMean=(e,t,r)=>a(e,t,r,"ReduceMean",((e,t)=>{let r=1;for(let n=0;n<e[0].dims.length;n++)(t.indexOf(n)>=0||0===t.length)&&(r*=e[0].dims[n]);return["value = 0.0;","value += _A(inputIdx);",`value /= ${r}.;`]})),t.reduceMax=(e,t,r)=>a(e,t,r,"ReduceMax",((e,t)=>{const r=[];for(let n=0;n<e[0].dims.length;n++)(t.indexOf(n)>=0||0===t.length)&&r.push(`inputIdx[${n}] = 0;`);return[`${r.join("\n")}\nvalue = _A(inputIdx);`,"value = max(value, _A(inputIdx));",""]})),t.reduceMin=(e,t,r)=>a(e,t,r,"ReduceMin",((e,t)=>{const r=[];for(let n=0;n<e[0].dims.length;n++)(t.indexOf(n)>=0||0===t.length)&&r.push(`inputIdx[${n}] = 0;`);return[`${r.join("\n")}\nvalue = _A(inputIdx);`,"value = min(value, _A(inputIdx));",""]})),t.reduceProd=(e,t,r)=>a(e,t,r,"ReduceProd",(()=>["value = 1.0;","value *= _A(inputIdx);",""])),t.reduceLogSum=(e,t,r)=>a(e,t,r,"ReduceLogSum",(()=>["value = 0.0;","value += _A(inputIdx);","value = log(value);"])),t.reduceLogSumSquare=(e,t,r)=>a(e,t,r,"ReduceLogSumSquare",(()=>["float t; value = 0.0;","t = _A(inputIdx); value += t * t;",""]))},7379:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isReshapeCheap=t.processDims3D=t.createPackedReshape3DProgramInfoLoader=void 0;const n=r(7273),i=r(6757),o=r(5639),s=r(5614);t.createPackedReshape3DProgramInfoLoader=(e,t,r)=>{const a=(e=>({name:"Reshape (packed)",inputTypes:[o.TextureType.packed],inputNames:["A"],cacheHint:`${e}`}))(r);return Object.assign(Object.assign({},a),{get:()=>((e,t,r,a)=>{const c=t.dims,u=a;let l="";for(let e=0;e<4;e++){let t="";switch(e){case 0:t="outputCoords = rc;";break;case 1:t="outputCoords = ivec3(rc.x, rc.y+1, rc.z);";break;case 2:t="outputCoords = ivec3(rc.x, rc.y, rc.z+1);";break;case 3:t="outputCoords = ivec3(rc.x, rc.y+1, rc.z+1);";break;default:throw new Error}l+=`\n        ${t}\n        ${e>0?"if(outputCoords.y < rows && outputCoords.z < cols){":""}\n          int flattenedIndex = getFlattenedIndex(outputCoords);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flattenedIndex);\n          vec2 innerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[${e}] = getChannel(getA(inputRC.x, inputRC.y, inputRC.z), innerDims);\n\n        ${e>0?"}":""}\n      `}const d=(0,i.getGlsl)(e.session.backend.glContext.version),h=`\n      ${function(e){const t=n.ShapeUtil.computeStrides(e),r=["b","r","c"],i="index";return`\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ${t.map(((e,n)=>`int ${r[n]} = ${i} / ${e}; ${n===t.length-1?`int ${r[n+1]} = ${i} - ${r[n]} * ${e}`:`index -= ${r[n]} * ${e}`};`)).join("")}\n      return ivec3(b, r, c);\n    }\n  `}(c)}\n      ${function(e){const t=n.ShapeUtil.computeStrides(e);return`\n  int getFlattenedIndex(ivec3 coords) {\n    // reverse y, z order\n    return coords.x * ${t[0]} + coords.z * ${t[1]} + coords.y;\n  }\n`}(u)}\n      ${(0,s.unpackFromChannel)()}\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.0);\n\n        ivec3 outputCoords;\n        int rows = ${u[2]};\n        int cols = ${u[1]};\n\n        ${l}\n        ${d.output} = result;\n      }\n    `;return Object.assign(Object.assign({},r),{output:{dims:u,type:t.type,textureType:o.TextureType.packed},shaderSource:h,hasMain:!0})})(e,t,a,r)})},t.processDims3D=function(e){if(0===e.length)return[1,1,1];let t=1;for(let r=0;r<e.length-2;++r)t*=e[r];return[t,e.length>1?e[e.length-2]:1,e[e.length-1]]},t.isReshapeCheap=function(e,t){let r=!1;return r=0===e.length||0===t.length||(e.length<2||t.length<2?e[e.length-1]===t[t.length-1]:e[e.length-1]===t[t.length-1]&&e[e.length-2]===t[t.length-2]),r}},8126:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reshape=void 0;const n=r(7273);t.reshape=(e,t)=>{const r=n.ShapeUtil.calculateReshapedDims(t[0].dims,t[1].integerData);return e.session.pack?[e.reshapePacked(t[0],r)]:[e.reshapeUnpacked(t[0],r)]}},2801:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseResizeAttributesV11=t.parseResizeAttributesV10=t.resize=void 0;const n=r(6757),i=r(5639),o=r(432),s=r(5614),a=r(3980),c={name:"Resize",inputNames:["A"],inputTypes:[i.TextureType.packed]};t.resize=(e,t,r)=>((0,a.validateInputs)(t,r),[e.run(Object.assign(Object.assign({},c),{cacheHint:r.cacheKey,get:()=>u(e,t,r)}),t)]),t.parseResizeAttributesV10=e=>(0,a.parseUpsampleAttributes)(e,10),t.parseResizeAttributesV11=e=>(0,a.parseUpsampleAttributes)(e,11);const u=(e,t,r)=>{const a=(0,n.getGlsl)(e.session.backend.glContext.version),[u,d]=l(t,r);if(u.every((e=>1===e))&&"tf_crop_and_resize"!==r.coordinateTransformMode)return Object.assign(Object.assign({},c),{output:{dims:d,type:t[0].type,textureType:i.TextureType.packed},hasMain:!0,shaderSource:`void main() {\n                    vec4 v = ${a.texture2D}(X, TexCoords);\n                    ${a.output} = v;\n                }`});const h=d.length;if(h<2)throw new Error(`output dimension should be at least 2, but got ${h}`);const f=d[h-2],p=d[h-1],m=t[0].dims;if(h!==m.length)throw new Error(`output dimension should match input ${m.length}, but got ${h}`);const g=m[h-2],v=m[h-1],y=u[h-2],b=u[h-1];let E="";if("linear"!==r.mode)throw new Error(`resize (packed) does not support mode: '${r.mode}'`);switch(r.coordinateTransformMode){case"asymmetric":E="\n                    vec4 getSourceFracIndex(ivec4 coords) {\n                        return vec4(coords) / scaleWHWH;\n                    }\n                ";break;case"half_pixel":E="\n                    vec4 getSourceFracIndex(ivec4 coords) {\n                        return (vec4(coords) + 0.5) / scaleWHWH - 0.5;\n                    }\n                ";break;case"pytorch_half_pixel":E=`\n                    vec4 getSourceFracIndex(ivec4 coords) {\n                        vec4 fcoords = vec4(coords);\n                        return vec4(\n                            ${p}.0 > 1.0 ? (fcoords.x + 0.5) / scaleWHWH.x - 0.5 : 0.0,\n                            ${f}.0 > 1.0 ? (fcoords.y + 0.5) / scaleWHWH.y - 0.5 : 0.0,\n                            ${p}.0 > 1.0 ? (fcoords.z + 0.5) / scaleWHWH.z - 0.5 : 0.0,\n                            ${f}.0 > 1.0 ? (fcoords.w + 0.5) / scaleWHWH.w - 0.5 : 0.0\n                          );\n                    }\n                `;break;case"align_corners":E=`\n                    vec4 getSourceFracIndex(ivec4 coords) {\n                        vec4 resized = vec4(${p}.0 - 1.0, ${f}.0 - 1.0, ${p}.0 - 1.0,\n                            ${f}.0 - 1.0);\n                        vec4 original = vec4(${v}.0 - 1.0, ${g}.0 - 1.0, ${v}.0 - 1.0,\n                            ${g}.0 - 1.0);\n                        vec4 new_scale = original / resized;\n                        return vec4(coords) * new_scale;\n                    }\n                `;break;default:throw new Error(`resize (packed) does not support coordinateTransformMode:                                 '${r.coordinateTransformMode}'`)}const w=(0,o.getCoordsDataType)(h),S=`\n            const vec2 inputWH = vec2(${g}.0, ${v}.0);\n            const vec4 scaleWHWH = vec4(float(${y}), float(${b}), float(${y}), float(${b}));\n            ${(0,s.unpackFromChannel)()}\n            ${E}\n            float getAValue(int x10, int r, int c, int d) {\n                return getChannel(getA(x10, r, c, d), vec2(c, d));\n            }\n            void main() {\n                ${w} rc = getOutputCoords();\n\n                int batch = rc[0];\n                int depth = rc[1];\n\n                // retrieve the 4 coordinates that is used in the 4 packed output values.\n                ivec4 coords = ivec4(rc.wz, rc.w + 1, rc.z + 1);\n\n                // calculate the source index in fraction\n                vec4 sourceFrac = getSourceFracIndex(coords);\n\n                // get the lower and upper bound of the 4 values that will be packed into one texel.\n                ivec4 x00 = ivec4(max(sourceFrac.xy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xy)));\n                ivec4 x01 = ivec4(max(sourceFrac.xw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xw)));\n                ivec4 x10 = ivec4(max(sourceFrac.zy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zy)));\n                ivec4 x11 = ivec4(max(sourceFrac.zw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zw)));\n\n                bool hasNextRow = rc.w < ${f-1};\n                bool hasNextCol = rc.z < ${p-1};\n\n                // pack x00, x01, x10, x11's top-left corner into one vec4 structure\n                vec4 topLeft = vec4(\n                    getAValue(batch, depth, x00.x, x00.y),\n                    hasNextCol ? getAValue(batch, depth, x01.x, x01.y) : 0.0,\n                    hasNextRow ? getAValue(batch, depth, x10.x, x10.y) : 0.0,\n                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.y) : 0.0);\n\n                // pack x00, x01, x10, x11's top-right corner into one vec4 structure\n                vec4 topRight = vec4(\n                    getAValue(batch, depth, x00.x, x00.w),\n                    hasNextCol ? getAValue(batch, depth, x01.x, x01.w) : 0.0,\n                    hasNextRow ? getAValue(batch, depth, x10.x, x10.w) : 0.0,\n                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.w) : 0.0);\n\n                // pack x00, x01, x10, x11's bottom-left corner into one vec4 structure\n                vec4 bottomLeft = vec4(\n                    getAValue(batch, depth, x00.z, x00.y),\n                    hasNextCol ? getAValue(batch, depth, x01.z, x01.y) : 0.0,\n                    hasNextRow ? getAValue(batch, depth, x10.z, x10.y) : 0.0,\n                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.y) : 0.0);\n\n                // pack x00, x01, x10, x11's bottom-right corner into one vec4 structure\n                vec4 bottomRight = vec4(\n                    getAValue(batch, depth, x00.z, x00.w),\n                    hasNextCol ? getAValue(batch, depth, x01.z, x01.w) : 0.0,\n                    hasNextRow ? getAValue(batch, depth, x10.z, x10.w) : 0.0,\n                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.w) : 0.0);\n\n                // calculate the interpolation fraction on u and v direction\n                vec4 frac = vec4(sourceFrac) - floor(sourceFrac);\n                vec4 clampFrac = clamp(frac, vec4(0.0), vec4(1.0));\n\n                vec4 top = mix(topLeft, topRight, clampFrac.ywyw);\n                vec4 bottom = mix(bottomLeft, bottomRight, clampFrac.ywyw);\n                vec4 newValue = mix(top, bottom, clampFrac.xxzz);\n\n                ${a.output} = vec4(newValue);\n            }\n        `;return Object.assign(Object.assign({},c),{output:{dims:d,type:t[0].type,textureType:i.TextureType.packed},hasMain:!0,shaderSource:S})},l=(e,t)=>{const r=e[0].dims;let n,i=t.scales;if(0===i.length){const o=e[t.scalesInputIdx];if(o&&0!==o.size){if(e[t.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");i=d(o,t.mode,t.isResize)}else{const o=e[t.sizesInputIdx];if(!o||0===o.size)throw new Error("Either scales or sizes MUST be provided as input.");n=Array.from(o.integerData),i=h(n,r,t.mode,t.isResize)}}else if(e[t.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");const o=n||r.map(((e,t)=>Math.floor(e*i[t])));return[i,o]},d=(e,t,r)=>{const n=Array.from(e.floatData);return(0,a.scalesValidation)(n,t,r),n},h=(e,t,r,n)=>{const i=t.length,o=new Array(i);for(let r=0,n=i;r<n;r++)if(0===t[r]){if(0!==e[r])throw new Error("Input dim is zero but required output dim is non-zero.");o[r]=1}else o[r]=e[r]/t[r];return(0,a.scalesValidation)(o,r,n),o}},565:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.shape=void 0;const n=r(9240);t.shape=(e,t)=>(i(t),[new n.Tensor([t[0].dims.length],"int32",void 0,void 0,new Int32Array(t[0].dims))]);const i=e=>{if(!e||1!==e.length)throw new Error("Shape requires 1 input.")}},2444:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sliceV10=t.parseSliceAttributes=t.slice=void 0;const n=r(4910),i=r(6145),o=r(7273),s=r(5639),a={name:"Slice",inputNames:["A"],inputTypes:[s.TextureType.unpacked]};t.slice=(e,t,r)=>(u(t),[e.run(Object.assign(Object.assign({},a),{cacheHint:r.cacheKey,get:()=>c(e,t[0],r)}),t)]),t.parseSliceAttributes=e=>{const t=e.attributes.getInts("starts"),r=e.attributes.getInts("ends"),i=e.attributes.getInts("axes",[]);return(0,n.createAttributeWithCacheKey)({starts:t,ends:r,axes:i})};const c=(e,t,r)=>{const n=0===r.axes.length?t.dims.slice(0).map(((e,t)=>t)):r.axes,i=o.ShapeUtil.normalizeAxes(n,t.dims.length),c=r.starts.map(((e,r)=>e>t.dims[i[r]]-1?t.dims[i[r]]:o.ShapeUtil.normalizeAxis(e,t.dims[i[r]]))),u=r.ends.map(((e,r)=>e>t.dims[i[r]]-1?t.dims[i[r]]:o.ShapeUtil.normalizeAxis(e,t.dims[i[r]]))),l=t.dims.slice(),d=[];for(let e=0;e<i.length;e++)l[i[e]]=u[e]-c[e],c[e]>0&&d.push(`outputIdx[${i[e]}] += ${c[e]};`);const h=`\n      float process(int outputIdx[${l.length}]) {\n        ${d.join("\n      ")}\n        return _A(outputIdx);\n      }`;return Object.assign(Object.assign({},a),{output:{dims:l,type:t.type,textureType:s.TextureType.unpacked},shaderSource:h})},u=e=>{if(!e||1!==e.length)throw new Error("Slice requires 1 input.");if(-1===i.NUMBER_TYPES.indexOf(e[0].type))throw new Error("Invalid input type.")};t.sliceV10=(e,t)=>{d(t);const r=l(e,t);return[e.run(Object.assign(Object.assign({},a),{cacheHint:r.cacheKey,get:()=>c(e,t[0],r)}),[t[0]])]};const l=(e,t)=>{if(!e.session.isInitializer(t[1].dataId)||!e.session.isInitializer(t[2].dataId)||t.length>=4&&!e.session.isInitializer(t[3].dataId)||t.length>=5&&!e.session.isInitializer(t[4].dataId))throw new Error("dynamic slice attributes are not allowed");if(t.length>=5&&t[4].integerData.some((e=>1!==e)))throw new Error("currently non-1 steps is not supported for Slice");const r=Array.from(t[1].integerData),n=Array.from(t[2].integerData),i=t.length>=4?Array.from(t[3].integerData):[];return{starts:r,ends:n,axes:i,cacheKey:`${i};${r};${n}`}},d=e=>{if(!e||e.length<3||e.length>5)throw new Error("Invalid input number.");if("int32"!==e[1].type||1!==e[1].dims.length)throw new Error("Invalid input type.");if("int32"!==e[2].type||1!==e[2].dims.length)throw new Error("Invalid input type.");if(e.length>=4&&("int32"!==e[3].type||1!==e[3].dims.length))throw new Error("Invalid input type.");if(e.length>=5&&("int32"!==e[4].type||1!==e[4].dims.length))throw new Error("Invalid input type.")}},815:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.softmaxV13=t.parseSoftmaxAttributesV13=t.parseSoftmaxAttributes=t.softmax=void 0;const n=r(4910),i=r(7273),o=r(6757),s=r(5639),a=r(5707),c={name:"SoftmaxComputeMax",inputNames:["A"],inputTypes:[s.TextureType.unpacked]},u={name:"SoftmaxComputeScale",inputNames:["A","Max"],inputTypes:[s.TextureType.unpacked,s.TextureType.unpacked]},l={name:"SoftMax",inputNames:["A","Max","Norm"],inputTypes:[s.TextureType.unpacked,s.TextureType.unpacked,s.TextureType.unpacked]};t.softmax=(e,t,r)=>{m(t);const n=t[0].dims.slice(),o=i.ShapeUtil.normalizeAxis(r.axis,n.length),s=i.ShapeUtil.sizeToDimension(n,o),a=i.ShapeUtil.sizeFromDimension(n,o);return d(e,t,r,s,a)},t.parseSoftmaxAttributes=e=>(0,n.createAttributeWithCacheKey)({axis:e.attributes.getInt("axis",1)}),t.parseSoftmaxAttributesV13=e=>(0,n.createAttributeWithCacheKey)({axis:e.attributes.getInt("axis",-1)}),t.softmaxV13=(e,t,r)=>{m(t);const o=t[0].dims.slice(),s=i.ShapeUtil.normalizeAxis(r.axis,o.length),c=o.length,u=s!==c-1,l=[];let h,f=[],p=[];u&&(f=Array.from({length:c}).map(((e,t)=>t)),f[s]=c-1,f[c-1]=s,f.map((e=>l.push(o[e]))),h=(0,n.createAttributeWithCacheKey)({perm:f}),p=(0,a.transpose)(e,t,h));const g=u?i.ShapeUtil.sizeToDimension(l,c-1):i.ShapeUtil.sizeToDimension(o,c-1),v=u?i.ShapeUtil.sizeFromDimension(l,c-1):i.ShapeUtil.sizeFromDimension(o,c-1),y=d(e,u?p:t,r,g,v);return u?(0,a.transpose)(e,y,h):y};const d=(e,t,r,n,i)=>{const o=h(e,t[0],n,i,[n]),s=e.run(Object.assign(Object.assign({},c),{cacheHint:r.cacheKey,get:()=>o}),t),a=f(e,t[0],n,i,o.output.dims,[n]),d=e.run(Object.assign(Object.assign({},u),{cacheHint:r.cacheKey,get:()=>a}),[t[0],s]),m=p(e,t[0],n,i,o.output.dims,a.output.dims);return[e.run(Object.assign(Object.assign({},l),{cacheHint:r.cacheKey,get:()=>m}),[t[0],s,d])]},h=(e,t,r,n,i)=>{const[a,u]=e.calculateTextureWidthAndHeight(t.dims,s.TextureType.unpacked),l=i.length;if(r<1||n<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(1!==i.length)throw new Error("Dimensionality of the output should be 1");if(i[0]!==r)throw new Error("Shape of the output should be equal to logical row count");const d=(0,o.getGlsl)(e.session.backend.glContext.version),h=`\n      float process(int[${l}] indices) {\n        int logical_row_start_offset = indices[0] * ${n};\n\n        float max = getColorAsFloat(${d.texture2D}(A, offsetToCoords(logical_row_start_offset, ${a},\n        ${u} )));\n        for(int i=1; i<${n}; ++i)\n        {\n          float current = getColorAsFloat(${d.texture2D}(A, offsetToCoords(logical_row_start_offset + i,\n            ${a}, ${u})));\n          if(current > max)\n          max = current;\n        }\n\n        return max;\n      }`;return Object.assign(Object.assign({},c),{output:{dims:i,type:t.type,textureType:s.TextureType.unpacked},shaderSource:h})},f=(e,t,r,n,i,a)=>{const[c,l]=e.calculateTextureWidthAndHeight(t.dims,s.TextureType.unpacked),d=a.length;if(r<1||n<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(1!==a.length)throw new Error("Dimensionality of the output should be 1");if(a[0]!==r)throw new Error("Shape of the output should be equal to logical row count");if(1!==i.length)throw new Error("Dimensionality of the intermediate results should be 1");if(i[0]!==r)throw new Error("Shape of the intermediate results should be equal to logical row count");const h=`\n      float process(int[${d}] indices) {\n        int logical_row_start_offset = indices[0] * ${n};\n\n        float norm_factor = 0.0;\n        float max = _Max(indices);\n        for(int i=0; i<${n}; ++i)\n        {\n          norm_factor += exp(getColorAsFloat(${(0,o.getGlsl)(e.session.backend.glContext.version).texture2D}(A, offsetToCoords(logical_row_start_offset + i,\n            ${c}, ${l}))) - max);\n        }\n\n        return norm_factor;\n      }`;return Object.assign(Object.assign({},u),{output:{dims:a,type:t.type,textureType:s.TextureType.unpacked},shaderSource:h})},p=(e,t,r,n,i,o)=>{const[a,c]=e.calculateTextureWidthAndHeight(t.dims,s.TextureType.unpacked),u=t.dims.length;if(r<1||n<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(1!==i.length||1!==o.length)throw new Error("Dimensionality of the intermediate results should be 1");if(i[0]!==r||o[0]!==r)throw new Error("Shape of the intermediate results should be equal to logical row count");const d=`\n      float process(int[${u}] indices) {\n\n      // get offset of current logical tensor index from the 2-D texture coordinates (TexCoords)\n      int offset = coordsToOffset(TexCoords, ${a}, ${c});\n\n      //determine the logical row for this index\n      int logical_row_index[1];\n      logical_row_index[0] = offset / ${n};\n\n      float norm_factor = _Norm(logical_row_index);\n\n      // avoid possible division by 0\n      // if norm_facor is 0, all elements are zero\n      // if so, return 0\n      if(norm_factor == 0.0)\n        return 0.0;\n\n      return exp(_A(indices) - _Max(logical_row_index)) / norm_factor;\n    }`;return Object.assign(Object.assign({},l),{output:{dims:t.dims,type:t.type,textureType:s.TextureType.unpacked},shaderSource:d})},m=e=>{if(!e||1!==e.length)throw new Error("Softmax requires 1 input.");if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("Invalid input type")}},564:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseSplitAttributes=t.split=void 0;const n=r(4910),i=r(7273),o=r(5639),s={name:"Split",inputNames:["A"],inputTypes:[o.TextureType.unpacked]};t.split=(e,t,r)=>{u(t);const n=i.ShapeUtil.normalizeAxis(r.axis,t[0].dims.length),o=a(e,t,n,r),l=[];for(let i=0;i<o;++i)l.push(e.run(Object.assign(Object.assign({},s),{cacheHint:`${r.cacheKey};${i}`,get:()=>c(e,t[0],r,n,i)}),t));return l},t.parseSplitAttributes=e=>{const t=e.attributes.getInt("axis",0),r=e.attributes.getInts("split",[]),i=e.outputs.length;return(0,n.createAttributeWithCacheKey)({axis:t,split:r,numOutputs:i})};const a=(e,t,r,n)=>{const[,o]=i.SplitUtil.splitShape(t[0].dims,r,n.split,n.numOutputs);return o.length},c=(e,t,r,n,a)=>{const[c,u]=i.SplitUtil.splitShape(t.dims,n,r.split,r.numOutputs),l=u[a],d=c[a],h=`\n      float process(int indices[${d.length}]) {\n        indices[${n}] += ${l};\n        return _A(indices);\n      }\n    `;return Object.assign(Object.assign({},s),{cacheHint:`${r.cacheKey}:${a}`,output:{dims:d,type:t.type,textureType:o.TextureType.unpacked},shaderSource:h})},u=e=>{if(!e||1!==e.length)throw new Error("Split requires one input.");if("int8"!==e[0].type&&"uint8"!==e[0].type&&"int16"!==e[0].type&&"uint16"!==e[0].type&&"int32"!==e[0].type&&"uint32"!==e[0].type&&"float32"!==e[0].type&&"float64"!==e[0].type&&"bool"!==e[0].type)throw new Error("Invalid input type.")}},5416:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseSqueezeAttributes=t.squeezeV13=t.squeeze=void 0;const n=r(7273);t.squeeze=(e,t,r)=>{i(t);const o=n.ShapeUtil.squeezeShape(t[0].dims,r);return[e.reshapeUnpacked(t[0],o)]},t.squeezeV13=(e,r)=>(o(r),(0,t.squeeze)(e,[r[0]],Array.from(r[1].integerData))),t.parseSqueezeAttributes=e=>e.attributes.getInts("axes");const i=e=>{if(!e||1!==e.length)throw new Error("Squeeze requires 1 input.");if("string"===e[0].type)throw new Error("invalid input tensor types.")},o=e=>{if(!e||2!==e.length)throw new Error("Squeeze requires 2 inputs.");if("int32"!==e[1].type)throw new Error("Invalid input type.")}},1240:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sum=void 0;const n=r(6757),i=r(5639);t.sum=(e,t)=>{s(t);const r={name:"Sum",inputNames:t.map(((e,t)=>`X${t}`)),inputTypes:new Array(t.length).fill(i.TextureType.unpacked)};return[e.run(Object.assign(Object.assign({},r),{get:()=>o(e,t,r)}),t)]};const o=(e,t,r)=>{const o=(0,n.getGlsl)(e.session.backend.glContext.version),s=t[0].dims.slice(),a=`\n      void main() {\n        vec4 result = ${t.map(((e,t)=>`${o.texture2D}(X${t},TexCoords)`)).join(" + ")};\n        ${o.output} = result;\n      }\n    `;return Object.assign(Object.assign({},r),{output:{dims:s,type:t[0].type,textureType:i.TextureType.unpacked},hasMain:!0,shaderSource:a})},s=e=>{if(!e||0===e.length)throw new Error("Sum requires inputs.");const t=e[0].dims.length;for(let r=1;r<e.length;r++){if(t!==e[r].dims.length)throw new Error("Input shapes are mismatched.");for(let n=0;n<t;n++)if(e[0].dims[n]!==e[r].dims[n])throw new Error("Input shapes are not matched.")}if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("Invalid input type.");for(let t=1;t<e.length;t++)if(e[0].type!==e[t].type)throw new Error("Input types are not matched.")}},5944:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tile=void 0;const n=r(6145),i=r(5639);t.tile=(e,t)=>{s(t);const r={name:"Tile",inputNames:["A"],inputTypes:[i.TextureType.unpacked]};return[e.run(Object.assign(Object.assign({},r),{get:()=>o(e,t,r)}),t)]};const o=(e,t,r)=>{const n=t[0].dims.slice(),o=new Array(n.length),s=[];for(let e=0;e<n.length;e++)o[e]=n[e]*t[1].numberData[e],s.push(`inputIdx[${e}] = int(mod(float(outputIdx[${e}]), ${n[e]}.));`);const a=o.length,c=`\n      float process(int outputIdx[${a}]) {\n        int inputIdx[${a}];\n        ${s.join("\n")}\n        return _A(inputIdx);\n      }\n    `;return Object.assign(Object.assign({},r),{output:{dims:o,type:t[0].type,textureType:i.TextureType.unpacked},shaderSource:c})},s=e=>{if(!e||2!==e.length)throw new Error("Tile requires 2 input.");if(1!==e[1].dims.length)throw new Error("The second input shape must 1 dimension.");if(e[1].dims[0]!==e[0].dims.length)throw new Error("Invalid input shape.");if(-1===n.NUMBER_TYPES.indexOf(e[0].type))throw new Error("Invalid input type.");if("int32"!==e[1].type&&"int16"!==e[1].type)throw new Error("Invalid repeat type.")}},5707:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseTransposeAttributes=t.transpose=void 0;const n=r(4910),i=r(7273),o=r(5639),s={name:"Transpose",inputNames:["A"],inputTypes:[o.TextureType.unpacked]};t.transpose=(e,t,r)=>(d(t),[e.run(Object.assign(Object.assign({},s),{cacheHint:r.cacheKey,get:()=>a(e,t[0],r.perm)}),t)]),t.parseTransposeAttributes=e=>(0,n.createAttributeWithCacheKey)({perm:e.attributes.getInts("perm",[])});const a=(e,t,r)=>{const n=t.dims;r=c(n,r);const i=u(n,r),a=n.length,d=`\n      ${l("perm",r,a)}\n      float process(int indices[${a}]) {\n        int a[${a}];\n        perm(a, indices);\n        return _A(a);\n      }`;return Object.assign(Object.assign({},s),{output:{dims:i,type:t.type,textureType:o.TextureType.unpacked},shaderSource:d})},c=(e,t)=>(t&&t.length!==e.length&&(t=[...e.keys()].reverse()),t),u=(e,t)=>(t=c(e,t),i.ShapeUtil.sortBasedOnPerm(e,t)),l=(e,t,r)=>{const n=[];n.push(`void ${e}(out int a[${r}], int src[${r}]) {`);for(let e=0;e<r;++e)n.push(`\ta[${t[e]}]=src[${e}];`);return n.push("\t}"),n.join("\n")},d=e=>{if(!e||1!==e.length)throw new Error("Transpose requires 1 input.");if("float32"!==e[0].type&&"float64"!==e[0].type)throw new Error("input should be float tensor")}},2488:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.encodeAsUint8=void 0;const n=r(6757),i=r(5639);t.encodeAsUint8=(e,t)=>{const r=t.shape,o=(0,n.getGlsl)(e.session.backend.glContext.version),s=`\n    const float FLOAT_MAX = 1.70141184e38;\n    const float FLOAT_MIN = 1.17549435e-38;\n\n    bool isNaN(float val) {\n      return (val < 1.0 || 0.0 < val || val == 0.0) ? false : true;\n    }\n\n    highp vec4 encodeAsUint8(highp float v) {\n      if (isNaN(v)) {\n        return vec4(255, 255, 255, 255);\n      }\n\n      highp float av = abs(v);\n\n      if(av < FLOAT_MIN) {\n        return vec4(0.0, 0.0, 0.0, 0.0);\n      } else if(v > FLOAT_MAX) {\n        return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n      } else if(v < -FLOAT_MAX) {\n        return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n      }\n\n      highp vec4 c = vec4(0,0,0,0);\n\n      highp float e = floor(log2(av));\n      highp float m = exp2(fract(log2(av))) - 1.0;\n\n      c[2] = floor(128.0 * m);\n      m -= c[2] / 128.0;\n      c[1] = floor(32768.0 * m);\n      m -= c[1] / 32768.0;\n      c[0] = floor(8388608.0 * m);\n\n      highp float ebias = e + 127.0;\n      c[3] = floor(ebias / 2.0);\n      ebias -= c[3] * 2.0;\n      c[2] += floor(ebias) * 128.0;\n\n      c[3] += 128.0 * step(0.0, -v);\n\n      return c / 255.0;\n    }\n\n    void main() {\n      float value = ${o.texture2D}(X,TexCoords).r;\n      ${o.output} = encodeAsUint8(value);\n    }`,a={name:"Uint8Encode",inputTypes:[i.TextureType.unpacked],inputNames:["X"],output:{dims:r,type:t.tensor.type,textureType:i.TextureType.downloadUint8AsFloat},shaderSource:s,hasMain:!0};return e.executeProgram(a,[t.tensor])}},9087:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tanh=t.tan=t.sqrt=t.sin=t.sigmoid=t.relu=t.not=t.neg=t.log=t.parseLeakyReluAttributes=t.leakyRelu=t.identity=t.floor=t.exp=t.parseEluAttributes=t.elu=t.cos=t.ceil=t.clipV11=t.parseClipAttributes=t.clip=t.atan=t.asin=t.acos=t.abs=t.glslTanh=t.glslTan=t.glslSqrt=t.glslSigmoid=t.glslRelu=t.glslSin=t.glslNot=t.glslNeg=t.glslLog=t.glslLeakyRelu=t.glslIdentity=t.glslClip=t.glslFloor=t.glslExp=t.glslElu=t.glslCos=t.glslCeil=t.glslAtan=t.glslAsin=t.glslAcos=t.glslAbs=void 0;const n=r(4910),i=r(7273),o=r(1997),s=r(6757),a=r(5639);function c(){return R("abs")}function u(){return R("acos")}function l(){return R("asin")}function d(){return R("atan")}function h(){return R("ceil")}function f(){return R("cos")}function p(e){const t="elu";return{body:`\n  const float alpha = float(${e});\n\n  float ${t}_(float a) {\n    return a >= 0.0 ? a: (exp(a) - 1.0) * alpha;\n  }\n  vec4 ${t}_(vec4 v) {\n    return vec4(${t}_(v.x), ${t}_(v.y), ${t}_(v.z), ${t}_(v.w));\n  }\n  `,name:t,type:o.FunctionType.ValueBased}}function m(){return R("exp")}function g(){return R("floor")}function v(e,t){const r="clip";return{body:`\n  const float min = float(${e});\n  const float max = float(${t});\n\n  float ${r}_(float a) {\n    return clamp(a, min, max);\n  }\n  vec4 ${r}_(vec4 v) {\n    return clamp(v, min, max);\n  }\n  `,name:r,type:o.FunctionType.ValueBased}}function y(){const e="indentity";return{body:`\n  float ${e}_(float a) {\n    return a;\n  }\n  vec4 ${e}_(vec4 v) {\n    return v;\n  }\n  `,name:e,type:o.FunctionType.ValueBased}}function b(e){const t="leakyRelu";return{body:`\n  const float alpha = float(${e});\n\n  float ${t}_(float a) {\n    return a < 0.0 ? a * alpha : a;\n  }\n  vec4 ${t}_(vec4 v) {\n    return vec4(${t}_(v.x), ${t}_(v.y), ${t}_(v.z), ${t}_(v.w));\n  }\n  `,name:t,type:o.FunctionType.ValueBased}}function E(){return R("log")}function w(){const e="neg";return{body:`\n  float ${e}_(float a) {\n    return -a;\n  }\n  vec4 ${e}_(vec4 v) {\n    return -v;\n  }\n  `,name:e,type:o.FunctionType.ValueBased}}function S(){const e="not";return{body:`\n  float ${e}_(float a) {\n    return float( ! bool(a) );\n  }\n  bool ${e}_(bool a) {\n    return !a;\n  }\n  vec4 ${e}_(vec4 v) {\n    return vec4(!bool(v.x), !bool(v.y), !bool(v.z), !bool(v.w));\n  }\n  bvec4 ${e}_(bvec4 v) {\n    return bvec4(!v.x, !v.y, !v.z, !v.w);\n  }\n  `,name:e,type:o.FunctionType.ValueBased}}function _(){return R("sin")}function T(){const e="relu";return{body:`\n  float ${e}_(float a) {\n    return max( a, 0.0 );\n  }\n  vec4 ${e}_(vec4 v) {\n    return max( v, 0.0 );\n  }\n  `,name:e,type:o.FunctionType.ValueBased}}function x(){const e="sigmoid";return{body:`\n  float ${e}_(float a) {\n    return 1.0 / (1.0 + exp(-a));\n  }\n  vec4 ${e}_(vec4 v) {\n    return 1.0 / (1.0 + exp(-v));\n  }\n  `,name:e,type:o.FunctionType.ValueBased}}function A(){return R("sqrt")}function I(){return R("tan")}function C(){const e="tanh";return{body:`\n  float ${e}_(float a) {\n    a = clamp(a, -10., 10.);\n    a = exp(2.*a);\n    return (a - 1.) / (a + 1.);\n  }\n  vec4 ${e}_(vec4 v) {\n    v = clamp(v, -10., 10.);\n    v = exp(2.*v);\n    return (v - 1.) / (v + 1.);\n  }\n  `,name:e,type:o.FunctionType.ValueBased}}function R(e){return{body:`\n  float ${e}_(float a) {\n    return ${e}(a);\n  }\n  vec4 ${e}_(vec4 v) {\n    return ${e}(v);\n  }\n  `,name:e,type:o.FunctionType.ValueBased}}t.glslAbs=c,t.glslAcos=u,t.glslAsin=l,t.glslAtan=d,t.glslCeil=h,t.glslCos=f,t.glslElu=p,t.glslExp=m,t.glslFloor=g,t.glslClip=v,t.glslIdentity=y,t.glslLeakyRelu=b,t.glslLog=E,t.glslNeg=w,t.glslNot=S,t.glslSin=_,t.glslRelu=T,t.glslSigmoid=x,t.glslSqrt=A,t.glslTan=I,t.glslTanh=C;const k=(e,t,r,n)=>{const i=e.session.pack?a.TextureType.packed:a.TextureType.unpacked,o={name:r.name,inputTypes:[i],inputNames:["A"],cacheHint:n};return Object.assign(Object.assign({},o),{get:()=>((e,t,r,n)=>{const i=e.session.pack?a.TextureType.packed:a.TextureType.unpacked,o=(0,s.getGlsl)(e.session.backend.glContext.version);return Object.assign(Object.assign({},t),{output:{dims:r.dims,type:r.type,textureType:i},shaderSource:`\n     ${n.body}\n     void main() {\n       vec4 v = ${o.texture2D}(A, TexCoords);\n       v = ${n.name}_(v);\n       ${o.output} = v;\n     }\n     `,hasMain:!0})})(e,o,t,r)})};t.abs=(e,t)=>[e.run(k(e,t[0],c()),t)],t.acos=(e,t)=>[e.run(k(e,t[0],u()),t)],t.asin=(e,t)=>[e.run(k(e,t[0],l()),t)],t.atan=(e,t)=>[e.run(k(e,t[0],d()),t)],t.clip=(e,t,r)=>[e.run(k(e,t[0],v(r.min,r.max),r.cacheKey),t)],t.parseClipAttributes=e=>(0,n.createAttributeWithCacheKey)({min:e.attributes.getFloat("min",i.MIN_CLIP),max:e.attributes.getFloat("max",i.MAX_CLIP)}),t.clipV11=(e,r)=>{const n=O(e,r);return(0,t.clip)(e,[r[0]],n)};const O=(e,t)=>{if(t.length>=3&&(!e.session.isInitializer(t[1].dataId)||!e.session.isInitializer(t[2].dataId)))throw new Error("dynamic clip attributes are not allowed");const r=t.length>=3?t[1].numberData[0]:i.MIN_CLIP,o=t.length>=3?t[2].numberData[0]:i.MAX_CLIP;return(0,n.createAttributeWithCacheKey)({min:r,max:o})};t.ceil=(e,t)=>[e.run(k(e,t[0],h()),t)],t.cos=(e,t)=>[e.run(k(e,t[0],f()),t)],t.elu=(e,t,r)=>[e.run(k(e,t[0],p(r.alpha),r.cacheKey),t)],t.parseEluAttributes=e=>(0,n.createAttributeWithCacheKey)({alpha:e.attributes.getFloat("alpha",1)}),t.exp=(e,t)=>[e.run(k(e,t[0],m()),t)],t.floor=(e,t)=>[e.run(k(e,t[0],g()),t)],t.identity=(e,t)=>[e.run(k(e,t[0],y()),t)],t.leakyRelu=(e,t,r)=>[e.run(k(e,t[0],b(r.alpha),r.cacheKey),t)],t.parseLeakyReluAttributes=e=>(0,n.createAttributeWithCacheKey)({alpha:e.attributes.getFloat("alpha",.01)}),t.log=(e,t)=>[e.run(k(e,t[0],E()),t)],t.neg=(e,t)=>[e.run(k(e,t[0],w()),t)],t.not=(e,t)=>[e.run(k(e,t[0],S()),t)],t.relu=(e,t)=>[e.run(k(e,t[0],T()),t)],t.sigmoid=(e,t)=>[e.run(k(e,t[0],x()),t)],t.sin=(e,t)=>[e.run(k(e,t[0],_()),t)],t.sqrt=(e,t)=>[e.run(k(e,t[0],A()),t)],t.tan=(e,t)=>[e.run(k(e,t[0],I()),t)],t.tanh=(e,t)=>[e.run(k(e,t[0],C()),t)]},540:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createUnpackProgramInfoLoader=t.createUnpackProgramInfo=void 0;const n=r(6757),i=r(5639),o=r(432),s=r(5614),a={name:"unpack",inputNames:["A"],inputTypes:[i.TextureType.packed]};t.createUnpackProgramInfo=(e,t)=>{const r=t.dims.length,c=(0,s.getChannels)("rc",r),u=c.slice(-2),l=(0,o.getCoordsDataType)(r),d=(0,s.unpackFromChannel)(),h=0===t.dims.length?"":function(e,t){if(1===e)return"rc";let r="";for(let n=0;n<e;n++)r+=t[n],n<e-1&&(r+=",");return r}(r,c),f=r<=1?"rc":`vec2(${u.join(",")})`,p=`\n    ${d}\n    void main() {\n      ${l} rc = getOutputCoords();\n\n       // Sample the texture with the coords to get the rgba channel value.\n       vec4 packedInput = getA(${h});\n\n       ${(0,n.getGlsl)(e.session.backend.glContext.version).output} = vec4(getChannel(packedInput, ${f}), 0, 0, 0);\n     }\n   `;return Object.assign(Object.assign({},a),{hasMain:!0,output:{dims:t.dims,type:t.type,textureType:i.TextureType.unpacked},shaderSource:p})},t.createUnpackProgramInfoLoader=(e,r)=>Object.assign(Object.assign({},a),{get:()=>(0,t.createUnpackProgramInfo)(e,r)})},7862:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseUnsqueezeAttributes=t.unsqueezeV13=t.unsqueeze=void 0;const n=r(7273);t.unsqueeze=(e,t,r)=>{i(t);const o=n.ShapeUtil.unsqueezeShape(t[0].dims,r);return[e.reshapeUnpacked(t[0],o)]},t.unsqueezeV13=(e,r)=>(o(r),(0,t.unsqueeze)(e,[r[0]],Array.from(r[1].integerData))),t.parseUnsqueezeAttributes=e=>e.attributes.getInts("axes");const i=e=>{if(!e||1!==e.length)throw new Error("Unsqueeze requires 1 input.");if("string"===e[0].type)throw new Error("invalid input tensor types.")},o=e=>{if(!e||2!==e.length)throw new Error("Unsqueeze requires 2 inputs.");if("int32"!==e[1].type)throw new Error("Invalid input type.")}},3980:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.scalesValidation=t.validateInputs=t.parseUpsampleAttributes=t.parseUpsampleAttributesV9=t.parseUpsampleAttributesV7=t.upsample=void 0;const n=r(4910),i=r(6757),o=r(5639),s={name:"Upsample",inputNames:["X"],inputTypes:[o.TextureType.unpacked]};t.upsample=(e,r,n)=>((0,t.validateInputs)(r,n),[e.run(Object.assign(Object.assign({},s),{cacheHint:n.cacheKey,get:()=>a(e,r,n)}),r)]),t.parseUpsampleAttributesV7=e=>(0,t.parseUpsampleAttributes)(e,7),t.parseUpsampleAttributesV9=e=>(0,t.parseUpsampleAttributes)(e,9),t.parseUpsampleAttributes=(e,r)=>{const i=r>=10,o=e.attributes.getString("mode","nearest");if("nearest"!==o&&"linear"!==o&&(r<11||"cubic"!==o))throw new Error(`unrecognized mode: ${o}`);let s=[];r<9&&(s=e.attributes.getFloats("scales"),(0,t.scalesValidation)(s,o,i));const a=e.attributes.getFloat("extrapolation_value",0),c=r>10?e.attributes.getString("coordinate_transformation_mode","half_pixel"):"asymmetric";if(-1===["asymmetric","pytorch_half_pixel","tf_half_pixel_for_nn","align_corners","tf_crop_and_resize","half_pixel"].indexOf(c))throw new Error(`coordinate_transform_mode '${c}' is not supported`);const u="tf_crop_and_resize"===c,l=u,d="nearest"===o&&r>=11?e.attributes.getString("nearest_mode","round_prefer_floor"):"";if(-1===["round_prefer_floor","round_prefer_ceil","floor","ceil",""].indexOf(d))throw new Error(`nearest_mode '${d}' is not supported`);const h=e.attributes.getFloat("cubic_coeff_a",-.75),f=0!==e.attributes.getInt("exclude_outside",0);if(f&&"cubic"!==o)throw new Error("exclude_outside can be set to 1 only when mode is CUBIC.");const p=r<11||"nearest"===o&&"asymmetric"===c&&"floor"===d;let m=0,g=0,v=0;return r>10?e.inputs.length>2?(m=1,g=2,v=3):(g=1,v=2):9===r&&(g=1),(0,n.createAttributeWithCacheKey)({opset:r,isResize:i,mode:o,scales:s,extrapolationValue:a,coordinateTransformMode:c,useExtrapolation:l,needRoiInput:u,nearestMode:d,cubicCoefficientA:h,excludeOutside:f,useNearest2xOptimization:p,roiInputIdx:m,scalesInputIdx:g,sizesInputIdx:v})};const a=(e,t,r)=>{const n=(0,i.getGlsl)(e.session.backend.glContext.version),[a,c]=e.calculateTextureWidthAndHeight(t[0].dims,o.TextureType.unpacked),u=t[0].dims.map(((e,t)=>Math.floor(e*r.scales[t]))),[l,d]=e.calculateTextureWidthAndHeight(u,o.TextureType.unpacked),h=u.length,f=new Array(h),p=new Array(h);let m=`\n      int output_pitches[${h}];\n      int input_pitches[${h}];\n      `;for(let e=h-1;e>=0;e--)f[e]=e===h-1?1:f[e+1]*u[e+1],p[e]=e===h-1?1:p[e+1]*t[0].dims[e+1],m+=`\n        output_pitches[${e}] = ${f[e]};\n        input_pitches[${e}] = ${p[e]};\n        `;const g=`\n      float getInputFloat(int index) {\n        vec2 coords = offsetToCoords(index, ${a}, ${c});\n        float value = getColorAsFloat(${n.texture2D}(X, coords));\n        return value;\n      }\n      `,v="nearest"===r.mode?`\n    ${g}\n    float process(int indices[${h}]) {\n      int input_index = 0;\n      int output_index = coordsToOffset(TexCoords, ${l}, ${d});\n\n      ${m}\n\n      int d, m;\n      for (int dim = 0; dim < ${h}; ++dim) {\n        d = output_index / output_pitches[dim];\n        m = output_index - d * output_pitches[dim];\n        output_index = m;\n\n        if (scales[dim] != 1 && d > 0) {\n          int d2 = d / scales[dim];\n          m = d - d2 * scales[dim];\n          d = d2;\n        }\n        input_index += input_pitches[dim] * d;\n      }\n\n      return getInputFloat(input_index);\n    }`:4===h?`\n    ${g}\n    float process(int indices[4]) {\n      int input_index = 0;\n      int output_index = coordsToOffset(TexCoords, ${l}, ${d});\n\n      ${m}\n\n      int m;\n      int index_of_dim0, index_of_dim1, index_of_dim2, index_of_dim3;\n      index_of_dim0 = output_index / output_pitches[0];\n      m = output_index - index_of_dim0 * output_pitches[0];\n      index_of_dim1 = m / output_pitches[1];\n      m = m - index_of_dim1 * output_pitches[1];\n      index_of_dim2 = m / output_pitches[2];\n      m = m - index_of_dim2 * output_pitches[2];\n      index_of_dim3 = m;\n\n      int index_of_input_dim2, index_of_input_dim3, x_offset, y_offset;\n      index_of_input_dim2 = index_of_dim2 / scales[2];\n      y_offset = index_of_dim2 - index_of_input_dim2 * scales[2];\n      index_of_input_dim3 = index_of_dim3 / scales[3];\n      x_offset = index_of_dim3 - index_of_input_dim3 * scales[3];\n\n      input_index = index_of_dim0 * input_pitches[0] +\n            index_of_dim1 * input_pitches[1] +\n            index_of_input_dim2 * input_pitches[2] +\n            index_of_input_dim3;\n\n      float x00 = getInputFloat(input_index);\n      float x10, x01, x11;\n\n      bool end_of_dim2 = false;\n      if (index_of_input_dim2 == (${t[0].dims[2]} - 1)) {\n        // It's the end in dimension 2\n        x01 = x00;\n        end_of_dim2 = true;\n      } else {\n        x01 = getInputFloat(input_index + input_pitches[2]);\n      }\n\n      if (index_of_input_dim3 == (input_pitches[2] - 1)) {\n        // It's the end in dimension 3\n        x10 = x00;\n        x11 = x01;\n      }\n      else {\n        x10 = getInputFloat(input_index + 1);\n        x11 = end_of_dim2 ? x10 : getInputFloat(input_index + input_pitches[2] + 1);\n      }\n\n      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[2]);\n      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[2]);\n      return y0 + float(x_offset) * (y1 - y0) / float(scales[3]);\n    }`:`\n    ${g}\n    float process(int indices[2]) {\n      int input_index = 0;\n      int output_index = coordsToOffset(TexCoords, ${l}, ${d});\n\n      ${m}\n\n      int m;\n      int index_of_dim0, index_of_dim1;\n      index_of_dim0 = output_index / output_pitches[0];\n      m = output_index - index_of_dim0 * output_pitches[0];\n      index_of_dim1 = m;\n\n      int index_of_input_dim0, index_of_input_dim1, x_offset, y_offset;\n      index_of_input_dim0 = index_of_dim0 / scales[0];\n      y_offset = index_of_dim0 - index_of_input_dim0 * scales[0];\n      index_of_input_dim1 = index_of_dim1 / scales[1];\n      x_offset = index_of_dim1 - index_of_input_dim1 * scales[1];\n\n      input_index = index_of_input_dim0 * input_pitches[0] + index_of_input_dim1;\n\n      float x00 = getInputFloat(input_index);\n      float x10, x01, x11;\n\n      bool end_of_dim0 = false;\n      if (index_of_input_dim0 == (${t[0].dims[0]} - 1)) {\n        // It's the end in dimension 0\n        x01 = x00;\n        end_of_dim0 = true;\n      } else {\n        x01 = getInputFloat(input_index + input_pitches[0]);\n      }\n\n      if (index_of_input_dim1 == (input_pitches[0] - 1)) {\n        // It's the end in dimension 1\n        x10 = x00;\n        x11 = x01;\n      }\n      else {\n        x10 = getInputFloat(input_index + 1);\n        x11 = end_of_dim0 ? x10 : getInputFloat(input_index + input_pitches[0] + 1);\n      }\n\n      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[0]);\n      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[0]);\n      return y0 + float(x_offset) * (y1 - y0) / float(scales[1]);\n    }`;return Object.assign(Object.assign({},s),{output:{dims:u,type:t[0].type,textureType:o.TextureType.unpacked},shaderSource:v,variables:[{name:"scales",type:"int",arrayLength:r.scales.length,data:r.scales.map((e=>Math.ceil(e)))}]})};t.validateInputs=(e,t)=>{if(!e||t.opset<9&&1!==e.length||t.opset>=9&&t.opset<11&&2!==e.length||t.opset>=11&&e.length<2)throw new Error("invalid inputs.");if(t.scales.length>0&&e[0].dims.length!==t.scales.length)throw new Error("Invalid input shape.");if("string"===e[0].type)throw new Error("Invalid input tensor types.")},t.scalesValidation=(e,t,r)=>{if(r){for(const t of e)if(t<=0)throw new Error("Scale value should be greater than 0.")}else for(const t of e)if(t<1)throw new Error("Scale value should be greater than or equal to 1.");if(!("linear"!==t&&"cubic"!==t||2===e.length||4===e.length&&1===e[0]&&1===e[1]))throw new Error(`'Linear' mode and 'Cubic' mode only support 2-D inputs ('Bilinear', 'Bicubic')         or 4-D inputs with the corresponding outermost 2 scale values being 1         in the ${r?"Resize":"Upsample"} opeartor.`)}},2757:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProgramManager=void 0;const n=r(8453),i=r(1315),o=r(8897),s=r(6757);t.ProgramManager=class{constructor(e,t,r){this.profiler=e,this.glContext=t,this.textureLayoutStrategy=r,this.repo=new Map,this.attributesBound=!1}getArtifact(e){return this.repo.get(e)}setArtifact(e,t){this.repo.set(e,t)}run(e,t,r){var n;this.profiler.event("op",`ProgramManager.run ${null!==(n=e.programInfo.name)&&void 0!==n?n:"unknown kernel"}`,(()=>{var n;const o=this.glContext.gl,s=e.program;o.useProgram(s);try{this.bindOutput(r),this.attributesBound||this.bindAttributes(e.attribLocations),this.bindUniforms(e.uniformLocations,null!==(n=e.programInfo.variables)&&void 0!==n?n:[],t)}catch(t){throw i.Logger.error("ProgramManager",e.programInfo.shaderSource),t}this.profiler.event("backend","GlContext.draw()",(()=>{this.glContext.draw()}))}),this.glContext)}dispose(){this.vertexShader&&this.glContext.deleteShader(this.vertexShader),this.repo.forEach((e=>this.glContext.deleteProgram(e.program)))}build(e,t,r){return this.profiler.event("backend","ProgramManager.build",(()=>{const n=new o.GlslPreprocessor(this.glContext,e,t,r),i=n.preprocess(),s=this.compile(i);return{programInfo:e,program:s,uniformLocations:this.getUniformLocations(s,n.context.programInfo.inputNames,n.context.programInfo.variables),attribLocations:this.getAttribLocations(s)}}))}compile(e){if(!this.vertexShader){i.Logger.verbose("ProrgramManager","Compiling and caching Vertex shader for the first time");const e=(0,s.getVertexShaderSource)(this.glContext.version);this.vertexShader=this.glContext.compileShader(e,this.glContext.gl.VERTEX_SHADER)}n.env.debug&&i.Logger.verbose("ProrgramManager",`FragShader:\n${e}\n`);const t=this.glContext.compileShader(e,this.glContext.gl.FRAGMENT_SHADER),r=this.glContext.createProgram(this.vertexShader,t);return this.glContext.deleteShader(t),r}bindOutput(e){const t=e.width,r=e.height;i.Logger.verbose("ProrgramManager",`Binding output texture to Framebuffer: w/h=${t}/${r}, shape=${e.shape}, type=${e.tensor.type}`),this.glContext.attachFramebuffer(e.texture,t,r)}bindAttributes(e){const t=e.position,r=e.textureCoord;this.glContext.setVertexAttributes(t,r),this.attributesBound=!0}bindUniforms(e,t,r){var n;const i=this.glContext.gl;let o=0;for(const{name:s,type:a,location:c,arrayLength:u}of e){const e=null===(n=t.find((e=>e.name===s)))||void 0===n?void 0:n.data;if("sampler2D"!==a&&!e)throw new Error(`variable '${s}' does not have data defined in program info`);switch(a){case"sampler2D":this.bindTexture(r[o],c,o),o++;break;case"float":u?i.uniform1fv(c,e):i.uniform1f(c,e);break;case"int":u?i.uniform1iv(c,e):i.uniform1i(c,e);break;default:throw new Error(`Uniform not implemented: ${a}`)}}}bindTexture(e,t,r){this.glContext.bindTextureToUniform(e.texture,r,t)}getAttribLocations(e){return{position:this.getAttribLocation(e,"position"),textureCoord:this.getAttribLocation(e,"textureCoord")}}getUniformLocations(e,t,r){const n=[];if(t)for(const r of t)n.push({name:r,type:"sampler2D",location:this.getUniformLocation(e,r)});if(r)for(const t of r)n.push(Object.assign(Object.assign({},t),{location:this.getUniformLocation(e,t.name)}));return n}getUniformLocation(e,t){const r=this.glContext.gl.getUniformLocation(e,t);if(null===r)throw new Error(`Uniform ${t} not found.`);return r}getAttribLocation(e,t){return this.glContext.gl.getAttribLocation(e,t)}}},2171:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLSessionHandler=void 0;const n=r(1315),i=r(5881),o=r(7860),s=r(4110),a=r(2757),c=r(7618),u=r(5243);t.WebGLSessionHandler=class{constructor(e,t){this.backend=e,this.context=t,this.layoutStrategy=new c.PreferLogicalStrategy(e.glContext.maxTextureSize),this.programManager=new a.ProgramManager(this.context.profiler,e.glContext,this.layoutStrategy),this.textureManager=new u.TextureManager(e.glContext,this.layoutStrategy,this.context.profiler,{reuseTextures:"full"===e.textureCacheMode}),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map,this.pack=e.pack,this.pack2unpackMap=new Map,this.unpack2packMap=new Map}createInferenceHandler(){return new o.WebGLInferenceHandler(this)}onGraphInitialized(e){const t=e.getValues().filter((e=>-1===e.from&&e.tensor)).map((e=>e.tensor.dataId));this.initializers=new Set(t)}isInitializer(e){return!!this.initializers&&this.initializers.has(e)}addInitializer(e){this.initializers.add(e)}getTextureData(e,t){return t?this.packedTextureDataCache.get(e):this.unpackedTextureDataCache.get(e)}setTextureData(e,t,r=!1){n.Logger.verbose("WebGLSessionHandler","Storing Texture data in cache"),r?this.packedTextureDataCache.set(e,t):this.unpackedTextureDataCache.set(e,t)}dispose(){this.programManager.dispose(),this.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach((e=>this.textureManager.releaseTexture(e,!0))),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach((e=>this.textureManager.releaseTexture(e,!0))),this.unpackedTextureDataCache=new Map}resolve(e,t,r){const n=(0,i.resolveOperator)(e,t,s.WEBGL_OP_RESOLVE_RULES);return{impl:n.opImpl,context:n.opInit?n.opInit(e,r):e}}}},9622:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Uint8DataEncoder=t.RGBAFloatDataEncoder=t.RedFloat32DataEncoder=void 0;const n=r(1315);t.RedFloat32DataEncoder=class{constructor(e,t=1){if(1===t)this.internalFormat=e.R32F,this.format=e.RED,this.textureType=e.FLOAT,this.channelSize=t;else{if(4!==t)throw new Error(`Invalid number of channels: ${t}`);this.internalFormat=e.RGBA32F,this.format=e.RGBA,this.textureType=e.FLOAT,this.channelSize=t}}encode(e,t){let r,i;return e.constructor!==Float32Array&&(n.Logger.warning("Encoder","data was not of type Float32; creating new Float32Array"),i=new Float32Array(e)),t*this.channelSize>e.length?(n.Logger.warning("Encoder","Source data too small. Allocating larger array"),i=e,r=this.allocate(t*this.channelSize),i.forEach(((e,t)=>r[t]=e))):(i=e,r=i),r}allocate(e){return new Float32Array(4*e)}decode(e,t){return 1===this.channelSize?e.filter(((e,t)=>t%4==0)).subarray(0,t):e.subarray(0,t)}},t.RGBAFloatDataEncoder=class{constructor(e,t=1,r){if(1!==t&&4!==t)throw new Error(`Invalid number of channels: ${t}`);this.internalFormat=e.RGBA,this.format=e.RGBA,this.channelSize=t,this.textureType=r||e.FLOAT}encode(e,t){let r=e;return 1===this.channelSize&&(n.Logger.verbose("Encoder","Exploding into a larger array"),r=this.allocate(t),e.forEach(((e,t)=>r[4*t]=e))),r}allocate(e){return new Float32Array(4*e)}decode(e,t){return 1===this.channelSize?e.filter(((e,t)=>t%4==0)).subarray(0,t):e.subarray(0,t)}},t.Uint8DataEncoder=class{constructor(e,t=1){if(this.channelSize=4,1===t)this.internalFormat=e.ALPHA,this.format=e.ALPHA,this.textureType=e.UNSIGNED_BYTE,this.channelSize=t;else{if(4!==t)throw new Error(`Invalid number of channels: ${t}`);this.internalFormat=e.RGBA,this.format=e.RGBA,this.textureType=e.UNSIGNED_BYTE,this.channelSize=t}}encode(e,t){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}allocate(e){return new Uint8Array(e*this.channelSize)}decode(e,t){if(e instanceof Uint8Array)return e.subarray(0,t);throw new Error(`Invalid array type: ${e.constructor}`)}}},7618:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBatchDim=t.sizeToSquarishShape=t.getRowsCols=t.sizeFromShape=t.isInt=t.parseAxisParam=t.squeezeShape=t.PreferLogicalStrategy=t.AlwaysKeepOriginalSizeStrategy=void 0;const n=r(1315),i=r(7273);function o(e,t){const r=[],n=[],i=null!=t&&Array.isArray(t)&&0===t.length,o=null==t||i?null:s(t,e).sort();let a=0;for(let t=0;t<e.length;++t){if(null!=o){if(o[a]===t&&1!==e[t])throw new Error(`Can't squeeze axis ${t} since its dim '${e[t]}' is not 1`);(null==o[a]||o[a]>t)&&1===e[t]&&(r.push(e[t]),n.push(t)),o[a]<=t&&a++}1!==e[t]&&(r.push(e[t]),n.push(t))}return{newShape:r,keptDims:n}}function s(e,t){const r=t.length;return e=null==e?t.map(((e,t)=>t)):[].concat(e),(0,i.assert)(e.every((e=>e>=-r&&e<r)),(()=>`All values in axis param must be in range [-${r}, ${r}) but got axis ${e}`)),(0,i.assert)(e.every(a),(()=>`All values in axis param must be integers but got axis ${e}`)),e.map((e=>e<0?r+e:e))}function a(e){return e%1==0}function c(e){if(0===e.length)return 1;let t=e[0];for(let r=1;r<e.length;r++)t*=e[r];return t}function u(e){const t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}t.AlwaysKeepOriginalSizeStrategy=class{constructor(e){this.maxTextureSize=e}computeTextureWH(e,t){if(0===e.length)return[1,1];const r=this.maxTextureSize;if(t&&void 0!==t.breakAxis){const i=t.breakAxis>=e.length?1:e.slice(t.breakAxis).reduce(((e,t)=>e*t)),o=t.breakAxis<=0?1:e.slice(0,t.breakAxis).reduce(((e,t)=>e*t));if(!(i>r||o>r))return[i,o];n.Logger.verbose("TextureLayout",`Given width/height preferences were unattainable: shape:${e}, breakAxis:${t.breakAxis}`)}const i=e.reduce(((e,t)=>e*t));let o=Math.floor(Math.sqrt(i));for(;o<r&&o<i&&i%o!=0;o++);if(o>=r||i%o!=0)throw new Error(`The given dimensions are outside this GPU's boundaries: ${e}`);return[o,i/o]}},t.PreferLogicalStrategy=class{constructor(e){this.maxTextureSize=e}computeTextureWH(e,t){const r=this.computeTexture(e,t);return t&&t.isPacked&&(r[0]/=2,r[1]/=2),t&&t.reverseWH?[r[1],r[0]]:r}computeTexture(e,t){const r=t&&t.isPacked;if(0===e.length)return r?[2,2]:[1,1];let i=this.maxTextureSize;if(t&&void 0!==t.breakAxis){const r=t.breakAxis>=e.length?1:e.slice(t.breakAxis).reduce(((e,t)=>e*t)),o=t.breakAxis<=0?1:e.slice(0,t.breakAxis).reduce(((e,t)=>e*t));if(!(r>i||o>i))return[r,o];n.Logger.verbose("TextureLayout",`Given width/height preferences were unattainable: shape:${e}, breakAxis:${t.breakAxis}`)}let s=e.slice(0);if(r&&(i*=2,s=s.map(((e,t)=>t>=s.length-2?s[t]%2==0?s[t]:s[t]+1:s[t])),1===s.length&&(s=[2,s[0]])),2!==s.length){const e=o(s);s=e.newShape}const a=c(s);return s.length<=1&&a<=i?[1,a]:2===s.length&&s[0]<=i&&s[1]<=i?s:3===s.length&&s[0]*s[1]<=i&&s[2]<=i?[s[0]*s[1],s[2]]:3===s.length&&s[0]<=i&&s[1]*s[2]<=i?[s[0],s[1]*s[2]]:4===s.length&&s[0]*s[1]*s[2]<=i&&s[3]<=i?[s[0]*s[1]*s[2],s[3]]:4===s.length&&s[0]<=i&&s[1]*s[2]*s[3]<=i?[s[0],s[1]*s[2]*s[3]]:r?u(a/4).map((e=>2*e)):u(a)}},t.squeezeShape=o,t.parseAxisParam=s,t.isInt=a,t.sizeFromShape=c,t.getRowsCols=function(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]},t.sizeToSquarishShape=u,t.getBatchDim=function(e,t=2){return c(e.slice(0,e.length-t))}},3314:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTextureLayoutFromShape=t.calculateTextureWidthAndHeight=t.createTextureLayoutFromTextureType=void 0;const n=r(7273),i=r(5639);t.createTextureLayoutFromTextureType=(e,r,n)=>{const o=n===i.TextureType.unpacked||n===i.TextureType.unpackedReversed?1:4,s=n===i.TextureType.packed,a=n===i.TextureType.unpackedReversed||n===i.TextureType.packed,c=n===i.TextureType.packedLastDimension?r.length-1:void 0,u=n===i.TextureType.packedLastDimension?r.map(((e,t)=>t===r.length-1?4*e:e)):void 0;return(0,t.createTextureLayoutFromShape)(e,r,o,u,{isPacked:s,reverseWH:a,breakAxis:c})},t.calculateTextureWidthAndHeight=(e,r,n)=>{const i=(0,t.createTextureLayoutFromTextureType)(e,r,n);return[i.width,i.height]},t.createTextureLayoutFromShape=(e,t,r=1,i,o)=>{const s=!(!o||!o.isPacked),[a,c]=e.computeTextureWH(s&&i||t,o),u=t.length;let l=t.slice(0);if(0===u&&(l=[1]),1===r)i=t;else if(s){if(4!==r)throw new Error("a packed texture must be 4-channel");i=t,u>0&&(l[u-1]=Math.ceil(l[u-1]/2)),u>1&&(l[u-2]=Math.ceil(l[u-2]/2))}else if(!i)throw new Error("Unpacked shape is needed when using channels > 1");return{width:a,height:c,channels:r,isPacked:s,shape:l,strides:n.ShapeUtil.computeStrides(l),unpackedShape:i,reversedWH:o&&o.reverseWH}}},5243:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextureManager=void 0;const n=r(1315);t.TextureManager=class{constructor(e,t,r,n){this.glContext=e,this.layoutStrategy=t,this.profiler=r,this.config=n,this.pendingRead=new Map,n.reuseTextures&&(this.inUseTextures=new Map,this.idleTextures=new Map,this.textureLookup=new Map)}createTextureFromLayout(e,t,r,i){const o=this.toEncoderType(e),s=this.glContext.getEncoder(o,t.channels||1,i);if(t.isPacked&&1===i)throw new Error("not implemented");const a=t.width,c=t.height;let u,l;if(this.config.reuseTextures){u=`${a}x${c}_${s.format}_${s.internalFormat}_${s.textureType}`,l=this.inUseTextures.get(u),l||(l=[],this.inUseTextures.set(u,l));const t=this.idleTextures.get(u);if(t&&t.length>0){const n=t.pop();return l.push(n),1===i&&this.glContext.updateTexture(n,a,c,s,this.toTextureData(e,r)),n}}n.Logger.verbose("TextureManager",`Creating new texture of size ${t.width}x${t.height}`);const d=this.glContext.allocateTexture(a,c,s,this.toTextureData(e,r));return this.config.reuseTextures&&(l.push(d),this.textureLookup.set(d,u)),d}readTexture(e,t,r){return r||(r=1),this.profiler.event("backend","TextureManager.readTexture",(()=>{const n=e.shape.reduce(((e,t)=>e*t))*r,i=this.glContext.readTexture(e.texture,e.width,e.height,n,this.toEncoderType(t),r);return this.toTensorData(t,i)}))}async readTextureAsync(e,t,r){const n=e.tensor.dataId;if(r||(r=1),this.pendingRead.has(n)){const e=this.pendingRead.get(n);return new Promise((t=>null==e?void 0:e.push(t)))}return this.profiler.event("backend","TextureManager.readTextureAsync",(async()=>{this.pendingRead.set(n,[]);const i=e.shape.reduce(((e,t)=>e*t))*r;await this.glContext.createAndWaitForFence();const o=this.glContext.readTexture(e.texture,e.width,e.height,i,this.toEncoderType(t),r),s=this.toTensorData(t,o),a=this.pendingRead.get(n);return this.pendingRead.delete(n),null==a||a.forEach((e=>e(s))),s}))}readUint8TextureAsFloat(e){return this.profiler.event("backend","TextureManager.readUint8TextureAsFloat",(()=>{const t=e.shape.reduce(((e,t)=>e*t)),r=this.glContext.readTexture(e.texture,e.width,e.height,4*t,"byte",4);return new Float32Array(r.buffer,r.byteOffset,t)}))}releaseTexture(e,t){let r;if(this.config.reuseTextures&&(r=this.textureLookup.get(e.texture),r)){t&&this.textureLookup.delete(r);const n=this.inUseTextures.get(r);if(n){const t=n.indexOf(e.texture);if(-1!==t){n.splice(t,1);let i=this.idleTextures.get(r);i||(i=[],this.idleTextures.set(r,i)),i.push(e.texture)}}}r&&!t||(n.Logger.verbose("TextureManager",`Deleting texture of size ${e.width}x${e.height}`),this.glContext.deleteTexture(e.texture))}toTensorData(e,t){switch(e){case"int16":return t instanceof Int16Array?t:Int16Array.from(t);case"int32":return t instanceof Int32Array?t:Int32Array.from(t);case"int8":return t instanceof Int8Array?t:Int8Array.from(t);case"uint16":return t instanceof Uint16Array?t:Uint16Array.from(t);case"uint32":return t instanceof Uint32Array?t:Uint32Array.from(t);case"uint8":case"bool":return t instanceof Uint8Array?t:Uint8Array.from(t);case"float32":return t instanceof Float32Array?t:Float32Array.from(t);case"float64":return t instanceof Float64Array?t:Float64Array.from(t);default:throw new Error(`TensorData type ${e} is not supported`)}}toTextureData(e,t){if(t)return t instanceof Float32Array?t:new Float32Array(t)}toEncoderType(e){return"float"}clearActiveTextures(){this.glContext.clearActiveTextures()}}},5639:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.TextureType=void 0,(r=t.TextureType||(t.TextureType={}))[r.unpacked=0]="unpacked",r[r.unpackedReversed=1]="unpackedReversed",r[r.packed=2]="packed",r[r.downloadUint8AsFloat=3]="downloadUint8AsFloat",r[r.packedLastDimension=4]="packedLastDimension"},432:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getGlChannels=t.getCoordsDataType=t.getSqueezedParams=t.squeezeInputShape=t.generateShaderFuncNameFromInputSamplerNameAtOutCoords=t.generateShaderFuncNameFromInputSamplerName=t.repeatedTry=t.getPackedShape=void 0;const n=r(7273);t.getPackedShape=function(e){const t=e.length;return e.slice(0,t-1).concat(e[t-1]/4)},t.repeatedTry=async function(e,t=(e=>0),r){return new Promise(((n,i)=>{let o=0;const s=()=>{if(e())return void n();o++;const a=t(o);null!=r&&o>=r?i():setTimeout(s,a)};s()}))},t.generateShaderFuncNameFromInputSamplerName=function(e){return(0,n.assert)(void 0!==e&&0!==e.length,(()=>"empty string found for sampler name")),"get"+e.charAt(0).toUpperCase()+e.slice(1)},t.generateShaderFuncNameFromInputSamplerNameAtOutCoords=function(e){return(0,n.assert)(void 0!==e&&0!==e.length,(()=>"empty string found for sampler name")),"get"+e.charAt(0).toUpperCase()+e.slice(1)+"AtOutCoords"},t.squeezeInputShape=function(e,t){let r=JSON.parse(JSON.stringify(e));return r=t,r},t.getSqueezedParams=function(e,t){return t.map((t=>e[t])).join(", ")},t.getCoordsDataType=function(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error(`GPU for rank ${e} is not yet supported`)},t.getGlChannels=function(e=6){return["x","y","z","w","u","v"].slice(0,e)}},3389:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createNewWebGLContext=t.createWebGLContext=void 0;const n=r(1315),i=r(3524),o={};function s(e){const t=function(){if("undefined"==typeof document){if("undefined"==typeof OffscreenCanvas)throw new TypeError("failed to create canvas: OffscreenCanvas is not supported");return new OffscreenCanvas(1,1)}const e=document.createElement("canvas");return e.width=1,e.height=1,e}();let r;const o={alpha:!1,depth:!1,antialias:!1,stencil:!1,preserveDrawingBuffer:!1,premultipliedAlpha:!1,failIfMajorPerformanceCaveat:!1};if((!e||"webgl2"===e)&&(r=t.getContext("webgl2",o),r))try{return new i.WebGLContext(r,2)}catch(e){n.Logger.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl2'. Error: ${e}`)}if((!e||"webgl"===e)&&(r=t.getContext("webgl",o)||t.getContext("experimental-webgl",o),r))try{return new i.WebGLContext(r,1)}catch(e){n.Logger.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl' or 'experimental-webgl'. Error: ${e}`)}throw new Error("WebGL is not supported")}t.createWebGLContext=function e(t){let r;t&&"webgl2"!==t||!("webgl2"in o)?t&&"webgl"!==t||!("webgl"in o)||(r=o.webgl):r=o.webgl2,r=r||s(t),t=t||1===r.version?"webgl":"webgl2";const n=r.gl;return o[t]=r,n.isContextLost()?(delete o[t],e(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),r)},t.createNewWebGLContext=s},3524:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLContext=t.linearSearchLastTrue=void 0;const s=r(8453),a=o(r(9622)),c=r(432);function u(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}t.linearSearchLastTrue=u,t.WebGLContext=class{constructor(e,t){this.frameBufferBound=!1,this.itemsToPoll=[],this.gl=e,this.version=t,this.getExtensions(),this.vertexbuffer=this.createVertexbuffer(),this.framebuffer=this.createFramebuffer(),this.queryVitalParameters()}allocateTexture(e,t,r,n){const i=this.gl,o=i.createTexture();i.bindTexture(i.TEXTURE_2D,o),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE);const s=n?r.encode(n,e*t):null;return i.texImage2D(i.TEXTURE_2D,0,r.internalFormat,e,t,0,r.format,r.textureType,s),this.checkError(),o}updateTexture(e,t,r,n,i){const o=this.gl;o.bindTexture(o.TEXTURE_2D,e);const s=n.encode(i,t*r);o.texSubImage2D(o.TEXTURE_2D,0,0,0,t,r,n.format,n.textureType,s),this.checkError()}attachFramebuffer(e,t,r){const n=this.gl;n.bindTexture(n.TEXTURE_2D,e),n.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0),this.checkError(),n.viewport(0,0,t,r),n.scissor(0,0,t,r)}readTexture(e,t,r,n,i,o){const s=this.gl;o||(o=1),this.frameBufferBound||this.attachFramebuffer(e,t,r);const a=this.getEncoder(i,o),c=a.allocate(t*r);return s.bindTexture(s.TEXTURE_2D,e),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,e,0),s.readPixels(0,0,t,r,s.RGBA,a.textureType,c),this.checkError(),a.decode(c,n)}isFramebufferReady(){return!0}getActiveTexture(){const e=this.gl;return"TEXTURE"+(e.getParameter(this.gl.ACTIVE_TEXTURE)-e.TEXTURE0)}getTextureBinding(){return this.gl.getParameter(this.gl.TEXTURE_BINDING_2D)}getFramebufferBinding(){return this.gl.getParameter(this.gl.FRAMEBUFFER_BINDING)}setVertexAttributes(e,t){const r=this.gl;r.vertexAttribPointer(e,3,r.FLOAT,!1,20,0),r.enableVertexAttribArray(e),-1!==t&&(r.vertexAttribPointer(t,2,r.FLOAT,!1,20,12),r.enableVertexAttribArray(t)),this.checkError()}createProgram(e,t){const r=this.gl,n=r.createProgram();return r.attachShader(n,e),r.attachShader(n,t),r.linkProgram(n),n}compileShader(e,t){const r=this.gl,n=r.createShader(t);if(!n)throw new Error(`createShader() returned null with type ${t}`);if(r.shaderSource(n,e),r.compileShader(n),!1===r.getShaderParameter(n,r.COMPILE_STATUS))throw new Error(`Failed to compile shader: ${r.getShaderInfoLog(n)}\nShader source:\n${e}`);return n}deleteShader(e){this.gl.deleteShader(e)}bindTextureToUniform(e,t,r){const n=this.gl;n.activeTexture(n.TEXTURE0+t),this.checkError(),n.bindTexture(n.TEXTURE_2D,e),this.checkError(),n.uniform1i(r,t),this.checkError()}draw(){this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.checkError()}checkError(){if(s.env.debug){const e=this.gl,t=e.getError();let r="";switch(t){case e.NO_ERROR:return;case e.INVALID_ENUM:r="INVALID_ENUM";break;case e.INVALID_VALUE:r="INVALID_VALUE";break;case e.INVALID_OPERATION:r="INVALID_OPERATION";break;case e.INVALID_FRAMEBUFFER_OPERATION:r="INVALID_FRAMEBUFFER_OPERATION";break;case e.OUT_OF_MEMORY:r="OUT_OF_MEMORY";break;case e.CONTEXT_LOST_WEBGL:r="CONTEXT_LOST_WEBGL";break;default:r=`Unknown WebGL Error: ${t.toString(16)}`}throw new Error(r)}}deleteTexture(e){this.gl.deleteTexture(e)}deleteProgram(e){this.gl.deleteProgram(e)}getEncoder(e,t,r=0){if(2===this.version)return new a.RedFloat32DataEncoder(this.gl,t);switch(e){case"float":return 1===r||this.isRenderFloat32Supported?new a.RGBAFloatDataEncoder(this.gl,t):new a.RGBAFloatDataEncoder(this.gl,t,this.textureHalfFloatExtension.HALF_FLOAT_OES);case"int":throw new Error("not implemented");case"byte":return new a.Uint8DataEncoder(this.gl,t);default:throw new Error(`Invalid dataType: ${e}`)}}clearActiveTextures(){const e=this.gl;for(let t=0;t<this.maxTextureImageUnits;++t)e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,null)}dispose(){if(this.disposed)return;const e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteFramebuffer(this.framebuffer),e.bindBuffer(e.ARRAY_BUFFER,null),e.deleteBuffer(this.vertexbuffer),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.finish(),this.disposed=!0}createDefaultGeometry(){return new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0])}createVertexbuffer(){const e=this.gl,t=e.createBuffer();if(!t)throw new Error("createBuffer() returned null");const r=this.createDefaultGeometry();return e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW),this.checkError(),t}createFramebuffer(){const e=this.gl.createFramebuffer();if(!e)throw new Error("createFramebuffer returned null");return e}queryVitalParameters(){const e=this.gl;if(this.isFloatTextureAttachableToFrameBuffer=this.checkFloatTextureAttachableToFrameBuffer(),this.isRenderFloat32Supported=this.checkRenderFloat32(),this.isFloat32DownloadSupported=this.checkFloat32Download(),1===this.version&&!this.textureHalfFloatExtension&&!this.isRenderFloat32Supported)throw new Error("both float32 and float16 TextureType are not supported");this.isBlendSupported=!this.isRenderFloat32Supported||this.checkFloat32Blend(),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.maxTextureImageUnits=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),this.version}getExtensions(){2===this.version?(this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float"),this.disjointTimerQueryWebgl2Extension=this.gl.getExtension("EXT_disjoint_timer_query_webgl2")):(this.textureFloatExtension=this.gl.getExtension("OES_texture_float"),this.textureHalfFloatExtension=this.gl.getExtension("OES_texture_half_float"))}checkFloatTextureAttachableToFrameBuffer(){const e=this.gl,t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);const r=2===this.version?e.RGBA32F:e.RGBA;e.texImage2D(e.TEXTURE_2D,0,r,1,1,0,e.RGBA,e.FLOAT,null);const n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0);const i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(t),e.deleteFramebuffer(n),i}checkRenderFloat32(){if(2===this.version){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension)return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Download(){if(2===this.version){if(!this.colorBufferFloatExtension)return!1}else{if(!this.textureFloatExtension)return!1;if(!this.gl.getExtension("WEBGL_color_buffer_float"))return!1}return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Blend(){const e=this.gl;let t,r,n,i,o;try{t=e.createTexture(),r=e.createFramebuffer(),e.bindTexture(e.TEXTURE_2D,t);const s=2===this.version?e.RGBA32F:e.RGBA;return e.texImage2D(e.TEXTURE_2D,0,s,1,1,0,e.RGBA,e.FLOAT,null),e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),e.enable(e.BLEND),n=e.createShader(e.VERTEX_SHADER),!!n&&(e.shaderSource(n,"void main(){}"),e.compileShader(n),i=e.createShader(e.FRAGMENT_SHADER),!!i&&(e.shaderSource(i,"precision highp float;void main(){gl_FragColor=vec4(0.5);}"),e.compileShader(i),o=e.createProgram(),!!o&&(e.attachShader(o,n),e.attachShader(o,i),e.linkProgram(o),e.useProgram(o),e.drawArrays(e.POINTS,0,1),e.getError()===e.NO_ERROR)))}finally{e.disable(e.BLEND),o&&e.deleteProgram(o),n&&e.deleteShader(n),i&&e.deleteShader(i),r&&(e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteFramebuffer(r)),t&&(e.bindTexture(e.TEXTURE_2D,null),e.deleteTexture(t))}}beginTimer(){if(2===this.version&&this.disjointTimerQueryWebgl2Extension){const e=this.gl,t=this.disjointTimerQueryWebgl2Extension,r=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,r),r}throw new Error("WebGL1 profiling currently not supported.")}endTimer(){if(2!==this.version||!this.disjointTimerQueryWebgl2Extension)throw new Error("WebGL1 profiling currently not supported");{const e=this.gl,t=this.disjointTimerQueryWebgl2Extension;e.endQuery(t.TIME_ELAPSED_EXT)}}isTimerResultAvailable(e){let t=!1,r=!1;if(2!==this.version||!this.disjointTimerQueryWebgl2Extension)throw new Error("WebGL1 profiling currently not supported");{const n=this.gl,i=this.disjointTimerQueryWebgl2Extension;t=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE),r=n.getParameter(i.GPU_DISJOINT_EXT)}return t&&!r}getTimerResult(e){let t=0;if(2!==this.version)throw new Error("WebGL1 profiling currently not supported");{const r=this.gl;t=r.getQueryParameter(e,r.QUERY_RESULT),r.deleteQuery(e)}return t/1e6}async waitForQueryAndGetTime(e){return await(0,c.repeatedTry)((()=>this.isTimerResultAvailable(e))),this.getTimerResult(e)}async createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t;const r=e,n=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),t=null===n?()=>!0:()=>{const e=r.clientWaitSync(n,0,0);return e===r.ALREADY_SIGNALED||e===r.CONDITION_SATISFIED},{query:n,isFencePassed:t}}async pollFence(e){return new Promise((t=>{this.addItemToPoll((()=>e.isFencePassed()),(()=>t()))}))}pollItems(){const e=u(this.itemsToPoll.map((e=>e.isDoneFn)));for(let t=0;t<=e;++t){const{resolveFn:e}=this.itemsToPoll[t];e()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}async addItemToPoll(e,t){this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||await(0,c.repeatedTry)((()=>(this.pollItems(),0===this.itemsToPoll.length)))}}},6496:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExecutionPlan=void 0;const n=r(1315);class i{constructor(e,t){this.op=e,this.node=t}}t.ExecutionPlan=class{constructor(e,t,r){this.graph=e,this.profiler=r,this.initialize(t)}initialize(e){this.profiler.event("session","ExecutionPlan.initialize",(()=>{const t=this.graph.getNodes();if(t.length!==e.length)throw new Error("The size of nodes and OPs do not match.");this._ops=e.map(((e,r)=>new i(e,t[r]))),this.reset(),this._starter=[],this._ops.forEach(((e,t)=>{let r=!0;for(const t of e.node.inputs)if(!this._values[t]&&-1===this.graph.getInputIndices().indexOf(t)){r=!1;break}r&&this._starter.push(t)}))}))}reset(){this._values=this.graph.getValues().map((e=>e.tensor))}async execute(e,t){return this.profiler.event("session","ExecutionPlan.execute",(async()=>{this.reset();const r=e.createInferenceHandler(),i=this.graph.getInputIndices();if(t.length!==i.length)throw new Error(`number of input tensors don't match the number of inputs to the model: actual: ${t.length} expected: ${i.length}`);t.forEach(((e,t)=>{const r=i[t];this._values[r]=e}));const o=this._starter.slice(0),s=this.graph.getValues(),a=this.graph.getNodes();let c=0;for(;c<o.length;){const e=o[c++],t=this._ops[e],i=t.node.inputs.map((e=>this._values[e]));if(-1!==i.indexOf(void 0))throw new Error(`unresolved input detected: op: ${t.node}`);const u=i;n.Logger.verbose("ExecPlan",`Runing op:${t.node.name} (${u.map(((e,r)=>`'${t.node.inputs[r]}': ${e.type}[${e.dims.join(",")}]`)).join(", ")})`);const l=await this.profiler.event("node",t.node.name,(async()=>t.op.impl(r,u,t.op.context)));if(l.length!==t.node.outputs.length)throw new Error("the size of output does not match model definition.");l.forEach(((e,r)=>{const n=t.node.outputs[r];if(this._values[n])throw new Error(`output [${n}] already has value: op:${t.node.name}`);this._values[n]=e}));const d=new Set;l.forEach(((e,r)=>{const n=t.node.outputs[r];for(const e of s[n].to){const t=a[e];let r=!0;for(const e of t.inputs)if(!this._values[e]){r=!1;break}r&&d.add(e)}})),o.push(...d)}const u=[];for(let e=0;e<this.graph.getOutputIndices().length;e++){const t=this.graph.getOutputIndices()[e],r=this._values[t];if(void 0===r)throw new Error(`required output [${t}] does not have value`);0===t?await r.getData():r.data,u.push(r)}return n.Logger.verbose("ExecPlan","disposing of inferenceHandler"),r.dispose(),u}))}}},4662:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Graph=void 0;const n=r(1446),i=r(6874),o=r(1287),s=r(9240),a=r(7273);var c=o.onnxruntime.experimental.fbs;t.Graph={from:(e,t)=>new d(e,t)};class u{constructor(e){this._from=void 0,this._to=[],this.tensor=void 0,this.type=void 0,e&&(this.type=a.ProtoUtil.tensorValueTypeFromProto(e.type.tensorType))}get from(){return this._from}get to(){return this._to}}class l{constructor(e,t){e instanceof n.onnx.NodeProto?(this.name=e.name,this.opType=e.opType,this.attributes=new i.Attribute(e.attribute)):e instanceof c.Node&&(this.name=null!=t?t:e.name(),this.opType=e.opType(),this.attributes=new i.Attribute(a.ProtoUtil.tensorAttributesFromORTFormat(e))),this.inputs=[],this.outputs=[],this.executeNode=!0}}class d{constructor(e,t){if(!e)throw new TypeError("graph is empty");this.buildGraph(e),this.transformGraph(t),this.checkIsAcyclic()}getInputIndices(){return this._allInputIndices}getInputNames(){return this._allInputNames}getOutputIndices(){return this._allOutputIndices}getOutputNames(){return this._allOutputNames}getValues(){return this._allData}getNodes(){return this._nodes}buildGraph(e){if(e instanceof n.onnx.GraphProto)this.buildGraphFromOnnxFormat(e);else{if(!(e instanceof c.Graph))throw new TypeError("Graph type is not supported.");this.buildGraphFromOrtFormat(e)}}buildGraphFromOnnxFormat(e){const t=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];const r=new Map;if(!e.input)throw new Error("missing information in graph: input");const n=[];for(const r of e.input){if(t.has(r.name))throw new Error(`duplicated input name: ${r.name}`);const e=this._allData.push(new u(r))-1;t.set(r.name,e),n.push(r.name)}if(!e.initializer)throw new Error("missing information in graph: initializer");for(const r of e.initializer){let e=t.get(r.name);if(void 0===e){const n=new u;n.type={shape:{dims:a.ProtoUtil.tensorDimsFromProto(r.dims)},tensorType:a.ProtoUtil.tensorDataTypeFromProto(r.dataType)},e=this._allData.push(n)-1,t.set(r.name,e)}this._allData[e]._from=-1,this._allData[e].tensor=s.Tensor.fromProto(r)}for(let e=0;e<this._allData.length;e++)this._allData[e].tensor||(this._allInputIndices.push(e),this._allInputNames.push(n[e]));if(!e.output)throw new Error("missing information in graph: output");for(const r of e.output){if(t.has(r.name))throw new Error(`duplicated output name: ${r.name}`);const e=this._allData.push(new u(r))-1;t.set(r.name,e),this._allOutputIndices.push(e),this._allOutputNames.push(r.name)}if(!e.node)throw new Error("missing information in graph: node");for(const t of e.node){if(!t.name)for(let e=0;;e++){const n=`unnamed_${t.opType}_${e}`;if(!r.has(n)){t.name=n;break}}if(r.has(t.name))throw new Error(`duplicated node name: ${t.name}`);const e=this._nodes.push(new l(t))-1;r.set(t.name,e)}for(let r=0;r<this._nodes.length;r++){const n=this._nodes[r],i=e.node[r];if(!i.output)throw new Error(`missing output for node: ${i.name}`);for(const e of i.output){let o=t.get(e);if(void 0===o&&(o=this._allData.push(new u)-1,t.set(e,o)),n.outputs.push(o),void 0!==this._allData[o]._from)throw new Error(`multiple nodes output to one data value: ${o}`);if(this._allData[o]._from=r,"Constant"===i.opType){if(!i.attribute||1!==i.attribute.length||!i.attribute[0].t)throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(!i.output||1!==i.output.length)throw new Error("missing output or incorrect number of outputs for this Constant operator");n.outputs.pop(),n.executeNode=!1,this._allData[o]._from=-1,this._allData[o].tensor=s.Tensor.fromProto(i.attribute[0].t)}}}for(let r=0;r<this._nodes.length;r++){const n=this._nodes[r],i=e.node[r];if(!i.input)throw new Error(`missing input for node: ${i.name}`);for(const e of i.input){const o=t.get(e);if(void 0===o){if(""===e&&3===i.input.length&&"Resize"===i.opType)continue;throw new Error(`unrecognized input '${e}' for node: ${i.name}`)}n.inputs.push(o),this._allData[o]._to.push(r)}}return!0}buildGraphFromOrtFormat(e){var t,r,n;const i=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];const o=new Map,d=[];for(let o=0;o<e.inputsLength();o++){const s=e.inputs(o);if(i.has(s))throw new Error(`duplicated input name: ${s}`);for(let o=0;o<e.nodeArgsLength();o++)if((null===(t=e.nodeArgs(o))||void 0===t?void 0:t.name())===s){const t=new u;if((null===(n=null===(r=e.nodeArgs(o))||void 0===r?void 0:r.type())||void 0===n?void 0:n.valueType())!==c.TypeInfoValue.tensor_type)throw new Error("Unexpected value type for the nodeArg.");const l=e.nodeArgs(o).type().value(new c.TensorTypeAndShape),h=a.ProtoUtil.tensorDataTypeFromProto(l.elemType()),f=l.shape(),p=[];for(let e=0;e<f.dimLength();e++)p.push(a.LongUtil.longToNumber(f.dim(e).value().dimValue()));t.type={shape:{dims:p},tensorType:h};const m=this._allData.push(t)-1;i.set(s,m),d.push(s)}}for(let t=0;t<e.initializersLength();t++){const r=e.initializers(t);let n=i.get(r.name());if(void 0===n){const e=new u,t=a.ProtoUtil.tensorDimsFromORTFormat(r),o=a.ProtoUtil.tensorDataTypeFromProto(r.dataType());e.type={shape:{dims:t},tensorType:o},n=this._allData.push(e)-1,i.set(r.name(),n)}this._allData[n]._from=-1,this._allData[n].tensor=s.Tensor.fromOrtTensor(r)}for(let e=0;e<this._allData.length;e++)this._allData[e].tensor||(this._allInputIndices.push(e),this._allInputNames.push(d[e]));for(let t=0;t<e.outputsLength();t++){const r=e.outputs(t);if(i.has(r))throw new Error(`duplicated output name: ${r}`);const n=this._allData.push(new u)-1;i.set(r,n),this._allOutputIndices.push(n),this._allOutputNames.push(r)}if(!e.nodes)throw new Error("missing information in graph: node");for(let t=0;t<e.nodesLength();t++){const r=e.nodes(t);let n=r.name();if(!n)for(let e=0;n=`unnamed_${r.opType()}_${e}`,o.has(n);e++);if(o.has(n))throw new Error(`duplicated node name: ${n}`);const i=this._nodes.push(new l(r,n))-1;o.set(n,i)}for(let t=0;t<this._nodes.length;t++){const r=this._nodes[t],n=e.nodes(t);if(null==n)throw new Error(`No node exists at index ${t}`);if(0===(null==n?void 0:n.outputsLength()))throw new Error(`missing output for node: ${n.name}`);for(let e=0;e<(null==n?void 0:n.outputsLength());e++){const o=null==n?void 0:n.outputs(e);let a=i.get(o);if(void 0===a&&(a=this._allData.push(new u)-1,i.set(o,a)),r.outputs.push(a),void 0!==this._allData[a]._from)throw new Error(`multiple nodes output to one data value: ${a}`);if(this._allData[a]._from=t,"Constant"===n.opType()){if(1!==n.attributesLength()||!n.attributes(0).t())throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(1!==n.outputsLength())throw new Error("missing output or incorrect number of outputs for this Constant operator");r.outputs.pop(),r.executeNode=!1,this._allData[a]._from=-1,this._allData[a].tensor=s.Tensor.fromOrtTensor(n.attributes(0).t())}}}for(let t=0;t<this._nodes.length;t++){const r=this._nodes[t],n=e.nodes(t);if(0===n.inputsLength())throw new Error(`missing input for node: ${n.name}`);for(let e=0;e<n.inputsLength();e++){const o=n.inputs(e),s=i.get(o);if(void 0===s)throw new Error(`unrecognized input '${o}' for node: ${n.name()}`);r.inputs.push(s),this._allData[s]._to.push(t)}}}checkIsAcyclic(){const e=new Set;this._allInputIndices.forEach((t=>{this._allData[t]._to.forEach((t=>{e.add(t)}))}));const t=Array.from(e),r=new Array(this._nodes.length).fill("white");for(;t.length>0;){const e=t.pop();"gray"===r[e]?r[e]="black":(t.push(e),r[e]="gray",this._nodes[e].outputs.forEach((n=>{const i=this._allData[n];if(void 0!==i.tensor)throw new Error("node outputs should not be initialized");if(i._from!==e)throw new Error("from property of the Value object doesn't match index of Node being processed");i._to.forEach((e=>{if("gray"===r[e])throw new Error("model graph is cyclic");"white"===r[e]&&t.push(e)}))})))}}transformGraph(e){this.removeAllIdentityNodes(),this.removeAllDropoutNodes(),this.fuseConvActivationNodes(),e&&e.transformGraph(this),this.finalizeGraph()}finalizeGraph(){let e=0;const t=new Array(this._nodes.length,0);let r=0;for(let e=0;e<this._nodes.length;e++)t[e]=r,this._nodes[e].executeNode?(r!==e&&(this._nodes[r]=this._nodes[e]),r++):this._nodes[e].outputs.forEach((e=>{this._allData[e]._from=-2}));this._nodes.splice(r,this._nodes.length-r);for(let e=0;e<this._allData.length;e++){const r=this._allData[e];void 0!==r._from&&-1!==r._from&&-2!==r._from&&(r._from=t[r._from]);for(let e=0;e<r._to.length;e++){if(!(r._to[e]>=0))throw new Error("Trying to update a removed node");r._to[e]=t[r._to[e]]}}e=0;for(let t=0;t<this._allData.length;t++)if(-2!==this._allData[t].from||-1!==this._allOutputIndices.indexOf(t+e)){if(e>0){let r=-1;void 0!==this._allData[t].from&&-1!==this._allData[t].from?(r=this._nodes[this._allData[t].from].outputs.indexOf(t+e),-1!==r&&(this._nodes[this._allData[t].from].outputs[r]=t)):(r=this._allInputIndices.indexOf(t+e),-1!==r&&(this._allInputIndices[r]=t)),this._allData[t].to.forEach((n=>{r=this._nodes[n].inputs.indexOf(t+e),-1!==r&&(this._nodes[n].inputs[r]=t)})),0===this._allData[t].to.length&&(r=this._allOutputIndices.indexOf(t+e),-1!==r&&(this._allOutputIndices[r]=t))}}else e++,this._allData.splice(t,1),t--}deleteNode(e){const t=this._nodes[e];if(t.outputs.length>1)for(let e=1;e<t.outputs.length;e++)if(this._allData[t.outputs[e]].to.length>0)throw new Error("Node deletion with more than one output connected to other nodes is not supported. ");t.executeNode=!1;const r=t.inputs[0],n=t.outputs[0],i=this._allData[n].to;for(let r=0;r<t.inputs.length;r++){const n=this._allData[t.inputs[r]].to.indexOf(e);if(-1===n)throw new Error("The Value object doesn't have the current Node in it's 'to' property ");this._allData[t.inputs[r]].to.splice(n,1)}this._allData[n]._to=[];const o=this._allOutputIndices.indexOf(n);if(-1!==o&&(this._allOutputIndices[o]=r),i&&i.length>0)for(const e of i){const t=this._nodes[e].inputs.indexOf(n);if(-1===t)throw new Error("The Node object doesn't have the output Value in it's 'inputs' property ");this._nodes[e].inputs[t]=r,this._allData[r].to.push(e)}}removeAllDropoutNodes(){let e=0;for(const t of this._nodes){if("Dropout"===t.opType){if(1!==t.inputs.length)throw new Error("Dropout nodes should only contain one input. ");if(1!==t.outputs.length&&2!==t.outputs.length)throw new Error("Dropout nodes should contain either 1 or 2 output(s)");if(2===t.outputs.length&&0!==this._allData[t.outputs[1]]._to.length)throw new Error("Dropout nodes's second output should not be referenced by other nodes");this.deleteNode(e)}e++}}removeAllIdentityNodes(){let e=0;for(const t of this._nodes)"Identity"===t.opType&&this.deleteNode(e),e++}isActivation(e){switch(e.opType){case"Relu":case"Sigmoid":case"Clip":return!0;default:return!1}}fuseConvActivationNodes(){for(const e of this._nodes)if("Conv"===e.opType){const t=this._allData[e.outputs[0]]._to;if(1===t.length&&this.isActivation(this._nodes[t[0]])){const r=this._nodes[t[0]];if("Clip"===r.opType)if(1===r.inputs.length)try{e.attributes.set("activation_params","floats",[r.attributes.getFloat("min"),r.attributes.getFloat("max")])}catch(t){e.attributes.set("activation_params","floats",[a.MIN_CLIP,a.MAX_CLIP])}else{if(!(r.inputs.length>=3&&void 0!==this._allData[r.inputs[1]].tensor&&void 0!==this._allData[r.inputs[2]].tensor))continue;e.attributes.set("activation_params","floats",[this._allData[r.inputs[1]].tensor.floatData[0],this._allData[r.inputs[2]].tensor.floatData[0]])}e.attributes.set("activation","string",r.opType),this.deleteNode(t[0])}}}}},1315:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.Profiler=t.Logger=void 0;const r={verbose:1e3,info:2e3,warning:4e3,error:5e3,fatal:6e3},n={none:new class{log(e,t,r){}},console:new class{log(e,t,r){console.log(`${this.color(e)} ${r?"[35m"+r+"[0m ":""}${t}`)}color(e){switch(e){case"verbose":return"[34;40mv[0m";case"info":return"[32mi[0m";case"warning":return"[30;43mw[0m";case"error":return"[31;40me[0m";case"fatal":return"[101mf[0m";default:throw new Error(`unsupported severity: ${e}`)}}}},i={provider:"console",minimalSeverity:"warning",logDateTime:!0,logSourceLocation:!1};let o={"":i};function s(e,t,r,n){if(void 0===t)return i=e,{verbose:s.verbose.bind(null,i),info:s.info.bind(null,i),warning:s.warning.bind(null,i),error:s.error.bind(null,i),fatal:s.fatal.bind(null,i)};if(void 0===r)a(e,t);else if("number"==typeof r&&void 0===n)a(e,t);else if("string"==typeof r&&void 0===n)a(e,r,0,t);else{if("string"!=typeof r||"number"!=typeof n)throw new TypeError("input is valid");a(e,r,0,t)}var i}function a(e,t,i,s){const a=o[s||""]||o[""];r[e]<r[a.minimalSeverity]||(a.logDateTime&&(t=`${(new Date).toISOString()}|${t}`),a.logSourceLocation,n[a.provider].log(e,t,s))}!function(e){function t(e){o={},r("",e||{})}function r(e,r){if("*"===e)t(r);else{const t=o[e]||i;o[e]={provider:r.provider||t.provider,minimalSeverity:r.minimalSeverity||t.minimalSeverity,logDateTime:void 0===r.logDateTime?t.logDateTime:r.logDateTime,logSourceLocation:void 0===r.logSourceLocation?t.logSourceLocation:r.logSourceLocation}}}e.verbose=function(t,r){e("verbose",t,r)},e.info=function(t,r){e("info",t,r)},e.warning=function(t,r){e("warning",t,r)},e.error=function(t,r){e("error",t,r)},e.fatal=function(t,r){e("fatal",t,r)},e.reset=t,e.set=r,e.setWithEnv=function(e){const t={};e.logLevel&&(t.minimalSeverity=e.logLevel),r("",t)}}(s||(s={})),t.Logger=s;class c{constructor(e,t,r,n,i,o){this.category=e,this.name=t,this.startTime=r,this.endCallback=n,this.timer=i,this.ctx=o}async end(){return this.endCallback(this)}async checkTimer(){if(void 0===this.ctx||void 0===this.timer)throw new Error("No webgl timer found");return this.ctx.endTimer(),this.ctx.waitForQueryAndGetTime(this.timer)}}class u{constructor(e,t,r,n){this.category=e,this.name=t,this.startTime=r,this.endTime=n}}t.Profiler=class{static create(e){return void 0===e?new this:new this(e.maxNumberEvents,e.flushBatchSize,e.flushIntervalInMilliseconds)}constructor(e,t,r){this._started=!1,this._flushPointer=0,this._started=!1,this._maxNumberEvents=void 0===e?1e4:e,this._flushBatchSize=void 0===t?10:t,this._flushIntervalInMilliseconds=void 0===r?5e3:r}start(){this._started=!0,this._timingEvents=[],this._flushTime=(0,t.now)(),this._flushPointer=0}stop(){for(this._started=!1;this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer])}event(e,t,r,n){const i=this._started?this.begin(e,t,n):void 0;let o=!1;const s=r();if(s&&"function"==typeof s.then)return o=!0,new Promise(((e,t)=>{s.then((async t=>{i&&await i.end(),e(t)}),(async e=>{i&&await i.end(),t(e)}))}));if(!o&&i){const e=i.end();if(e&&"function"==typeof e.then)return new Promise(((t,r)=>{e.then((()=>{t(s)}),(e=>{r(e)}))}))}return s}begin(e,r,n){if(!this._started)throw new Error("profiler is not started yet");if(void 0===n){const n=(0,t.now)();return this.flush(n),new c(e,r,n,(e=>this.endSync(e)))}{const t=n.beginTimer();return new c(e,r,0,(async e=>this.end(e)),t,n)}}async end(e){const t=await e.checkTimer();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new u(e.category,e.name,e.startTime,t)),this.flush(t))}endSync(e){const r=(0,t.now)();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new u(e.category,e.name,e.startTime,r)),this.flush(r))}logOneEvent(e){t.Logger.verbose(`Profiler.${e.category}`,`${(e.endTime-e.startTime).toFixed(2)}ms on event '${e.name}' at ${e.endTime.toFixed(2)}`)}flush(e){if(this._timingEvents.length-this._flushPointer>=this._flushBatchSize||e-this._flushTime>=this._flushIntervalInMilliseconds){for(const e=this._flushPointer;this._flushPointer<e+this._flushBatchSize&&this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer]);this._flushTime=(0,t.now)()}}get started(){return this._started}},t.now="undefined"!=typeof performance&&performance.now?()=>performance.now():Date.now},1745:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Model=void 0;const n=r(5686),i=r(1446),o=r(4662),s=r(1287),a=r(7273);var c=s.onnxruntime.experimental.fbs;t.Model=class{constructor(){}load(e,t,r){if(!r)try{return void this.loadFromOnnxFormat(e,t)}catch(e){if(void 0!==r)throw e}this.loadFromOrtFormat(e,t)}loadFromOnnxFormat(e,t){const r=i.onnx.ModelProto.decode(e);if(a.LongUtil.longToNumber(r.irVersion)<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=r.opsetImport.map((e=>({domain:e.domain,version:a.LongUtil.longToNumber(e.version)}))),this._graph=o.Graph.from(r.graph,t)}loadFromOrtFormat(e,t){const r=new n.flatbuffers.ByteBuffer(e),i=c.InferenceSession.getRootAsInferenceSession(r).model();if(a.LongUtil.longToNumber(i.irVersion())<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=[];for(let e=0;e<i.opsetImportLength();e++){const t=i.opsetImport(e);this._opsets.push({domain:null==t?void 0:t.domain(),version:a.LongUtil.longToNumber(t.version())})}this._graph=o.Graph.from(i.graph(),t)}get graph(){return this._graph}get opsets(){return this._opsets}}},6145:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FLOAT_TYPES=t.INT_TYPES=t.NUMBER_TYPES=void 0,t.NUMBER_TYPES=["float32","float64","int32","int16","int8","uint16","uint32","uint8"],t.INT_TYPES=["int32","int16","int8","uint16","uint32","uint8"],t.FLOAT_TYPES=["float32","float64"]},5881:(e,t)=>{function r(e,t){if(t.endsWith("+")){const r=Number.parseInt(t.substring(0,t.length-1),10);return!isNaN(r)&&r<=e}if(2===t.split("-").length){const r=t.split("-"),n=Number.parseInt(r[0],10),i=Number.parseInt(r[1],10);return!isNaN(n)&&!isNaN(i)&&n<=e&&e<=i}return Number.parseInt(t,10)===e}Object.defineProperty(t,"__esModule",{value:!0}),t.resolveOperator=void 0,t.resolveOperator=function(e,t,n){for(const i of n){const n=i[0],o=i[1],s=i[2],a=i[3],c=i[4];if(e.opType===n)for(const e of t)if((e.domain===o||"ai.onnx"===e.domain&&""===o)&&r(e.version,s))return{opImpl:a,opInit:c}}throw new TypeError(`cannot resolve operator '${e.opType}' with opsets: ${t.map((e=>`${e.domain||"ai.onnx"} v${e.version}`)).join(", ")}`)}},1287:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.onnxruntime=void 0;const n=r(5686);var i,o;(function(e){!function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.FLOAT=1]="FLOAT",e[e.INT=2]="INT",e[e.STRING=3]="STRING",e[e.TENSOR=4]="TENSOR",e[e.GRAPH=5]="GRAPH",e[e.FLOATS=6]="FLOATS",e[e.INTS=7]="INTS",e[e.STRINGS=8]="STRINGS",e[e.TENSORS=9]="TENSORS",e[e.GRAPHS=10]="GRAPHS",e[e.SPARSE_TENSOR=11]="SPARSE_TENSOR",e[e.SPARSE_TENSORS=12]="SPARSE_TENSORS"}(e.AttributeType||(e.AttributeType={}))})((o=(i=t.onnxruntime||(t.onnxruntime={})).experimental||(i.experimental={})).fbs||(o.fbs={})),function(e){!function(e){!function(e){!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.VALUE=1]="VALUE",e[e.PARAM=2]="PARAM"}(e.DimensionValueType||(e.DimensionValueType={}))}(e.fbs||(e.fbs={}))}(e.experimental||(e.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(e){!function(e){!function(e){!function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.FLOAT=1]="FLOAT",e[e.UINT8=2]="UINT8",e[e.INT8=3]="INT8",e[e.UINT16=4]="UINT16",e[e.INT16=5]="INT16",e[e.INT32=6]="INT32",e[e.INT64=7]="INT64",e[e.STRING=8]="STRING",e[e.BOOL=9]="BOOL",e[e.FLOAT16=10]="FLOAT16",e[e.DOUBLE=11]="DOUBLE",e[e.UINT32=12]="UINT32",e[e.UINT64=13]="UINT64",e[e.COMPLEX64=14]="COMPLEX64",e[e.COMPLEX128=15]="COMPLEX128",e[e.BFLOAT16=16]="BFLOAT16"}(e.TensorDataType||(e.TensorDataType={}))}(e.fbs||(e.fbs={}))}(e.experimental||(e.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(e){!function(e){!function(e){!function(e){e[e.Primitive=0]="Primitive",e[e.Fused=1]="Fused"}(e.NodeType||(e.NodeType={}))}(e.fbs||(e.fbs={}))}(e.experimental||(e.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(e){!function(e){!function(e){!function(e){e[e.NONE=0]="NONE",e[e.tensor_type=1]="tensor_type",e[e.sequence_type=2]="sequence_type",e[e.map_type=3]="map_type"}(e.TypeInfoValue||(e.TypeInfoValue={}))}(e.fbs||(e.fbs={}))}(e.experimental||(e.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(e){!function(t){!function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsShape(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsShape(e,t){return e.setPosition(e.position()+n.flatbuffers.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}dim(t,r){let n=this.bb.__offset(this.bb_pos,4);return n?(r||new e.experimental.fbs.Dimension).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}dimLength(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__vector_len(this.bb_pos+e):0}static startShape(e){e.startObject(1)}static addDim(e,t){e.addFieldOffset(0,t,0)}static createDimVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startDimVector(e,t){e.startVector(4,t,4)}static endShape(e){return e.endObject()}static createShape(e,t){return r.startShape(e),r.addDim(e,t),r.endShape(e)}}t.Shape=r}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(e){!function(t){!function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDimension(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDimension(e,t){return e.setPosition(e.position()+n.flatbuffers.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}value(t){let r=this.bb.__offset(this.bb_pos,4);return r?(t||new e.experimental.fbs.DimensionValue).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}denotation(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}static startDimension(e){e.startObject(2)}static addValue(e,t){e.addFieldOffset(0,t,0)}static addDenotation(e,t){e.addFieldOffset(1,t,0)}static endDimension(e){return e.endObject()}static createDimension(e,t,n){return r.startDimension(e),r.addValue(e,t),r.addDenotation(e,n),r.endDimension(e)}}t.Dimension=r}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(e){!function(t){!function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDimensionValue(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDimensionValue(e,t){return e.setPosition(e.position()+n.flatbuffers.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}dimType(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt8(this.bb_pos+t):e.experimental.fbs.DimensionValueType.UNKNOWN}dimValue(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}dimParam(e){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__string(this.bb_pos+t,e):null}static startDimensionValue(e){e.startObject(3)}static addDimType(t,r){t.addFieldInt8(0,r,e.experimental.fbs.DimensionValueType.UNKNOWN)}static addDimValue(e,t){e.addFieldInt64(1,t,e.createLong(0,0))}static addDimParam(e,t){e.addFieldOffset(2,t,0)}static endDimensionValue(e){return e.endObject()}static createDimensionValue(e,t,n,i){return r.startDimensionValue(e),r.addDimType(e,t),r.addDimValue(e,n),r.addDimParam(e,i),r.endDimensionValue(e)}}t.DimensionValue=r}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(e){!function(t){!function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsTensorTypeAndShape(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsTensorTypeAndShape(e,t){return e.setPosition(e.position()+n.flatbuffers.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}elemType(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):e.experimental.fbs.TensorDataType.UNDEFINED}shape(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new e.experimental.fbs.Shape).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}static startTensorTypeAndShape(e){e.startObject(2)}static addElemType(t,r){t.addFieldInt32(0,r,e.experimental.fbs.TensorDataType.UNDEFINED)}static addShape(e,t){e.addFieldOffset(1,t,0)}static endTensorTypeAndShape(e){return e.endObject()}static createTensorTypeAndShape(e,t,n){return r.startTensorTypeAndShape(e),r.addElemType(e,t),r.addShape(e,n),r.endTensorTypeAndShape(e)}}t.TensorTypeAndShape=r}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(e){!function(t){!function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsMapType(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsMapType(e,t){return e.setPosition(e.position()+n.flatbuffers.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}keyType(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):e.experimental.fbs.TensorDataType.UNDEFINED}valueType(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new e.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}static startMapType(e){e.startObject(2)}static addKeyType(t,r){t.addFieldInt32(0,r,e.experimental.fbs.TensorDataType.UNDEFINED)}static addValueType(e,t){e.addFieldOffset(1,t,0)}static endMapType(e){return e.endObject()}static createMapType(e,t,n){return r.startMapType(e),r.addKeyType(e,t),r.addValueType(e,n),r.endMapType(e)}}t.MapType=r}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(e){!function(t){!function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsSequenceType(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsSequenceType(e,t){return e.setPosition(e.position()+n.flatbuffers.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}elemType(t){let r=this.bb.__offset(this.bb_pos,4);return r?(t||new e.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}static startSequenceType(e){e.startObject(1)}static addElemType(e,t){e.addFieldOffset(0,t,0)}static endSequenceType(e){return e.endObject()}static createSequenceType(e,t){return r.startSequenceType(e),r.addElemType(e,t),r.endSequenceType(e)}}t.SequenceType=r}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(e){!function(e){(e.fbs||(e.fbs={})).EdgeEnd=class{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}nodeIndex(){return this.bb.readUint32(this.bb_pos)}srcArgIndex(){return this.bb.readInt32(this.bb_pos+4)}dstArgIndex(){return this.bb.readInt32(this.bb_pos+8)}static createEdgeEnd(e,t,r,n){return e.prep(4,12),e.writeInt32(n),e.writeInt32(r),e.writeInt32(t),e.offset()}}}(e.experimental||(e.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(e){!function(t){!function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsNodeEdge(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsNodeEdge(e,t){return e.setPosition(e.position()+n.flatbuffers.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}nodeIndex(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readUint32(this.bb_pos+e):0}inputEdges(t,r){let n=this.bb.__offset(this.bb_pos,6);return n?(r||new e.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+n)+12*t,this.bb):null}inputEdgesLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}outputEdges(t,r){let n=this.bb.__offset(this.bb_pos,8);return n?(r||new e.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+n)+12*t,this.bb):null}outputEdgesLength(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}static startNodeEdge(e){e.startObject(3)}static addNodeIndex(e,t){e.addFieldInt32(0,t,0)}static addInputEdges(e,t){e.addFieldOffset(1,t,0)}static startInputEdgesVector(e,t){e.startVector(12,t,4)}static addOutputEdges(e,t){e.addFieldOffset(2,t,0)}static startOutputEdgesVector(e,t){e.startVector(12,t,4)}static endNodeEdge(e){return e.endObject()}static createNodeEdge(e,t,n,i){return r.startNodeEdge(e),r.addNodeIndex(e,t),r.addInputEdges(e,n),r.addOutputEdges(e,i),r.endNodeEdge(e)}}t.NodeEdge=r}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(e){!function(t){!function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsNode(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsNode(e,t){return e.setPosition(e.position()+n.flatbuffers.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}name(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}docString(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}domain(e){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__string(this.bb_pos+t,e):null}sinceVersion(){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt32(this.bb_pos+e):0}index(){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readUint32(this.bb_pos+e):0}opType(e){let t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__string(this.bb_pos+t,e):null}type(){let t=this.bb.__offset(this.bb_pos,16);return t?this.bb.readInt32(this.bb_pos+t):e.experimental.fbs.NodeType.Primitive}executionProviderType(e){let t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__string(this.bb_pos+t,e):null}inputs(e,t){let r=this.bb.__offset(this.bb_pos,20);return r?this.bb.__string(this.bb.__vector(this.bb_pos+r)+4*e,t):null}inputsLength(){let e=this.bb.__offset(this.bb_pos,20);return e?this.bb.__vector_len(this.bb_pos+e):0}outputs(e,t){let r=this.bb.__offset(this.bb_pos,22);return r?this.bb.__string(this.bb.__vector(this.bb_pos+r)+4*e,t):null}outputsLength(){let e=this.bb.__offset(this.bb_pos,22);return e?this.bb.__vector_len(this.bb_pos+e):0}attributes(t,r){let n=this.bb.__offset(this.bb_pos,24);return n?(r||new e.experimental.fbs.Attribute).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}attributesLength(){let e=this.bb.__offset(this.bb_pos,24);return e?this.bb.__vector_len(this.bb_pos+e):0}inputArgCounts(e){let t=this.bb.__offset(this.bb_pos,26);return t?this.bb.readInt32(this.bb.__vector(this.bb_pos+t)+4*e):0}inputArgCountsLength(){let e=this.bb.__offset(this.bb_pos,26);return e?this.bb.__vector_len(this.bb_pos+e):0}inputArgCountsArray(){let e=this.bb.__offset(this.bb_pos,26);return e?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}implicitInputs(e,t){let r=this.bb.__offset(this.bb_pos,28);return r?this.bb.__string(this.bb.__vector(this.bb_pos+r)+4*e,t):null}implicitInputsLength(){let e=this.bb.__offset(this.bb_pos,28);return e?this.bb.__vector_len(this.bb_pos+e):0}static startNode(e){e.startObject(13)}static addName(e,t){e.addFieldOffset(0,t,0)}static addDocString(e,t){e.addFieldOffset(1,t,0)}static addDomain(e,t){e.addFieldOffset(2,t,0)}static addSinceVersion(e,t){e.addFieldInt32(3,t,0)}static addIndex(e,t){e.addFieldInt32(4,t,0)}static addOpType(e,t){e.addFieldOffset(5,t,0)}static addType(t,r){t.addFieldInt32(6,r,e.experimental.fbs.NodeType.Primitive)}static addExecutionProviderType(e,t){e.addFieldOffset(7,t,0)}static addInputs(e,t){e.addFieldOffset(8,t,0)}static createInputsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startInputsVector(e,t){e.startVector(4,t,4)}static addOutputs(e,t){e.addFieldOffset(9,t,0)}static createOutputsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startOutputsVector(e,t){e.startVector(4,t,4)}static addAttributes(e,t){e.addFieldOffset(10,t,0)}static createAttributesVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startAttributesVector(e,t){e.startVector(4,t,4)}static addInputArgCounts(e,t){e.addFieldOffset(11,t,0)}static createInputArgCountsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addInt32(t[r]);return e.endVector()}static startInputArgCountsVector(e,t){e.startVector(4,t,4)}static addImplicitInputs(e,t){e.addFieldOffset(12,t,0)}static createImplicitInputsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startImplicitInputsVector(e,t){e.startVector(4,t,4)}static endNode(e){return e.endObject()}static createNode(e,t,n,i,o,s,a,c,u,l,d,h,f,p){return r.startNode(e),r.addName(e,t),r.addDocString(e,n),r.addDomain(e,i),r.addSinceVersion(e,o),r.addIndex(e,s),r.addOpType(e,a),r.addType(e,c),r.addExecutionProviderType(e,u),r.addInputs(e,l),r.addOutputs(e,d),r.addAttributes(e,h),r.addInputArgCounts(e,f),r.addImplicitInputs(e,p),r.endNode(e)}}t.Node=r}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(e){!function(t){!function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsValueInfo(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsValueInfo(e,t){return e.setPosition(e.position()+n.flatbuffers.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}name(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}docString(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}type(t){let r=this.bb.__offset(this.bb_pos,8);return r?(t||new e.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}static startValueInfo(e){e.startObject(3)}static addName(e,t){e.addFieldOffset(0,t,0)}static addDocString(e,t){e.addFieldOffset(1,t,0)}static addType(e,t){e.addFieldOffset(2,t,0)}static endValueInfo(e){return e.endObject()}static createValueInfo(e,t,n,i){return r.startValueInfo(e),r.addName(e,t),r.addDocString(e,n),r.addType(e,i),r.endValueInfo(e)}}t.ValueInfo=r}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(e){!function(t){!function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsTypeInfo(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsTypeInfo(e,t){return e.setPosition(e.position()+n.flatbuffers.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}denotation(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}valueType(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):e.experimental.fbs.TypeInfoValue.NONE}value(e){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__union(e,this.bb_pos+t):null}static startTypeInfo(e){e.startObject(3)}static addDenotation(e,t){e.addFieldOffset(0,t,0)}static addValueType(t,r){t.addFieldInt8(1,r,e.experimental.fbs.TypeInfoValue.NONE)}static addValue(e,t){e.addFieldOffset(2,t,0)}static endTypeInfo(e){return e.endObject()}static createTypeInfo(e,t,n,i){return r.startTypeInfo(e),r.addDenotation(e,t),r.addValueType(e,n),r.addValue(e,i),r.endTypeInfo(e)}}t.TypeInfo=r}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(e){!function(e){!function(e){class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsOperatorSetId(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsOperatorSetId(e,r){return e.setPosition(e.position()+n.flatbuffers.SIZE_PREFIX_LENGTH),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}domain(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}version(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}static startOperatorSetId(e){e.startObject(2)}static addDomain(e,t){e.addFieldOffset(0,t,0)}static addVersion(e,t){e.addFieldInt64(1,t,e.createLong(0,0))}static endOperatorSetId(e){return e.endObject()}static createOperatorSetId(e,r,n){return t.startOperatorSetId(e),t.addDomain(e,r),t.addVersion(e,n),t.endOperatorSetId(e)}}e.OperatorSetId=t}(e.fbs||(e.fbs={}))}(e.experimental||(e.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(e){!function(t){!function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsTensor(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsTensor(e,t){return e.setPosition(e.position()+n.flatbuffers.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}name(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}docString(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}dims(e){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt64(this.bb.__vector(this.bb_pos+t)+8*e):this.bb.createLong(0,0)}dimsLength(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}dataType(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt32(this.bb_pos+t):e.experimental.fbs.TensorDataType.UNDEFINED}rawData(e){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readUint8(this.bb.__vector(this.bb_pos+t)+e):0}rawDataLength(){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}rawDataArray(){let e=this.bb.__offset(this.bb_pos,12);return e?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}stringData(e,t){let r=this.bb.__offset(this.bb_pos,14);return r?this.bb.__string(this.bb.__vector(this.bb_pos+r)+4*e,t):null}stringDataLength(){let e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__vector_len(this.bb_pos+e):0}static startTensor(e){e.startObject(6)}static addName(e,t){e.addFieldOffset(0,t,0)}static addDocString(e,t){e.addFieldOffset(1,t,0)}static addDims(e,t){e.addFieldOffset(2,t,0)}static createDimsVector(e,t){e.startVector(8,t.length,8);for(let r=t.length-1;r>=0;r--)e.addInt64(t[r]);return e.endVector()}static startDimsVector(e,t){e.startVector(8,t,8)}static addDataType(t,r){t.addFieldInt32(3,r,e.experimental.fbs.TensorDataType.UNDEFINED)}static addRawData(e,t){e.addFieldOffset(4,t,0)}static createRawDataVector(e,t){e.startVector(1,t.length,1);for(let r=t.length-1;r>=0;r--)e.addInt8(t[r]);return e.endVector()}static startRawDataVector(e,t){e.startVector(1,t,1)}static addStringData(e,t){e.addFieldOffset(5,t,0)}static createStringDataVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startStringDataVector(e,t){e.startVector(4,t,4)}static endTensor(e){return e.endObject()}static createTensor(e,t,n,i,o,s,a){return r.startTensor(e),r.addName(e,t),r.addDocString(e,n),r.addDims(e,i),r.addDataType(e,o),r.addRawData(e,s),r.addStringData(e,a),r.endTensor(e)}}t.Tensor=r}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(e){!function(t){!function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsSparseTensor(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsSparseTensor(e,t){return e.setPosition(e.position()+n.flatbuffers.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}values(t){let r=this.bb.__offset(this.bb_pos,4);return r?(t||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}indices(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}dims(e){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt64(this.bb.__vector(this.bb_pos+t)+8*e):this.bb.createLong(0,0)}dimsLength(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}static startSparseTensor(e){e.startObject(3)}static addValues(e,t){e.addFieldOffset(0,t,0)}static addIndices(e,t){e.addFieldOffset(1,t,0)}static addDims(e,t){e.addFieldOffset(2,t,0)}static createDimsVector(e,t){e.startVector(8,t.length,8);for(let r=t.length-1;r>=0;r--)e.addInt64(t[r]);return e.endVector()}static startDimsVector(e,t){e.startVector(8,t,8)}static endSparseTensor(e){return e.endObject()}static createSparseTensor(e,t,n,i){return r.startSparseTensor(e),r.addValues(e,t),r.addIndices(e,n),r.addDims(e,i),r.endSparseTensor(e)}}t.SparseTensor=r}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(e){!function(t){!function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsAttribute(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsAttribute(e,t){return e.setPosition(e.position()+n.flatbuffers.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}name(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}docString(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}type(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt32(this.bb_pos+t):e.experimental.fbs.AttributeType.UNDEFINED}f(){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readFloat32(this.bb_pos+e):0}i(){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}s(e){let t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__string(this.bb_pos+t,e):null}t(t){let r=this.bb.__offset(this.bb_pos,16);return r?(t||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}g(t){let r=this.bb.__offset(this.bb_pos,18);return r?(t||new e.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}floats(e){let t=this.bb.__offset(this.bb_pos,20);return t?this.bb.readFloat32(this.bb.__vector(this.bb_pos+t)+4*e):0}floatsLength(){let e=this.bb.__offset(this.bb_pos,20);return e?this.bb.__vector_len(this.bb_pos+e):0}floatsArray(){let e=this.bb.__offset(this.bb_pos,20);return e?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}ints(e){let t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readInt64(this.bb.__vector(this.bb_pos+t)+8*e):this.bb.createLong(0,0)}intsLength(){let e=this.bb.__offset(this.bb_pos,22);return e?this.bb.__vector_len(this.bb_pos+e):0}strings(e,t){let r=this.bb.__offset(this.bb_pos,24);return r?this.bb.__string(this.bb.__vector(this.bb_pos+r)+4*e,t):null}stringsLength(){let e=this.bb.__offset(this.bb_pos,24);return e?this.bb.__vector_len(this.bb_pos+e):0}tensors(t,r){let n=this.bb.__offset(this.bb_pos,26);return n?(r||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}tensorsLength(){let e=this.bb.__offset(this.bb_pos,26);return e?this.bb.__vector_len(this.bb_pos+e):0}graphs(t,r){let n=this.bb.__offset(this.bb_pos,28);return n?(r||new e.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}graphsLength(){let e=this.bb.__offset(this.bb_pos,28);return e?this.bb.__vector_len(this.bb_pos+e):0}static startAttribute(e){e.startObject(13)}static addName(e,t){e.addFieldOffset(0,t,0)}static addDocString(e,t){e.addFieldOffset(1,t,0)}static addType(t,r){t.addFieldInt32(2,r,e.experimental.fbs.AttributeType.UNDEFINED)}static addF(e,t){e.addFieldFloat32(3,t,0)}static addI(e,t){e.addFieldInt64(4,t,e.createLong(0,0))}static addS(e,t){e.addFieldOffset(5,t,0)}static addT(e,t){e.addFieldOffset(6,t,0)}static addG(e,t){e.addFieldOffset(7,t,0)}static addFloats(e,t){e.addFieldOffset(8,t,0)}static createFloatsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addFloat32(t[r]);return e.endVector()}static startFloatsVector(e,t){e.startVector(4,t,4)}static addInts(e,t){e.addFieldOffset(9,t,0)}static createIntsVector(e,t){e.startVector(8,t.length,8);for(let r=t.length-1;r>=0;r--)e.addInt64(t[r]);return e.endVector()}static startIntsVector(e,t){e.startVector(8,t,8)}static addStrings(e,t){e.addFieldOffset(10,t,0)}static createStringsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startStringsVector(e,t){e.startVector(4,t,4)}static addTensors(e,t){e.addFieldOffset(11,t,0)}static createTensorsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startTensorsVector(e,t){e.startVector(4,t,4)}static addGraphs(e,t){e.addFieldOffset(12,t,0)}static createGraphsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startGraphsVector(e,t){e.startVector(4,t,4)}static endAttribute(e){return e.endObject()}static createAttribute(e,t,n,i,o,s,a,c,u,l,d,h,f,p){return r.startAttribute(e),r.addName(e,t),r.addDocString(e,n),r.addType(e,i),r.addF(e,o),r.addI(e,s),r.addS(e,a),r.addT(e,c),r.addG(e,u),r.addFloats(e,l),r.addInts(e,d),r.addStrings(e,h),r.addTensors(e,f),r.addGraphs(e,p),r.endAttribute(e)}}t.Attribute=r}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(e){!function(t){!function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsGraph(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsGraph(e,t){return e.setPosition(e.position()+n.flatbuffers.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}initializers(t,r){let n=this.bb.__offset(this.bb_pos,4);return n?(r||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}initializersLength(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__vector_len(this.bb_pos+e):0}nodeArgs(t,r){let n=this.bb.__offset(this.bb_pos,6);return n?(r||new e.experimental.fbs.ValueInfo).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}nodeArgsLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}nodes(t,r){let n=this.bb.__offset(this.bb_pos,8);return n?(r||new e.experimental.fbs.Node).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}nodesLength(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}maxNodeIndex(){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readUint32(this.bb_pos+e):0}nodeEdges(t,r){let n=this.bb.__offset(this.bb_pos,12);return n?(r||new e.experimental.fbs.NodeEdge).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}nodeEdgesLength(){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}inputs(e,t){let r=this.bb.__offset(this.bb_pos,14);return r?this.bb.__string(this.bb.__vector(this.bb_pos+r)+4*e,t):null}inputsLength(){let e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__vector_len(this.bb_pos+e):0}outputs(e,t){let r=this.bb.__offset(this.bb_pos,16);return r?this.bb.__string(this.bb.__vector(this.bb_pos+r)+4*e,t):null}outputsLength(){let e=this.bb.__offset(this.bb_pos,16);return e?this.bb.__vector_len(this.bb_pos+e):0}sparseInitializers(t,r){let n=this.bb.__offset(this.bb_pos,18);return n?(r||new e.experimental.fbs.SparseTensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}sparseInitializersLength(){let e=this.bb.__offset(this.bb_pos,18);return e?this.bb.__vector_len(this.bb_pos+e):0}static startGraph(e){e.startObject(8)}static addInitializers(e,t){e.addFieldOffset(0,t,0)}static createInitializersVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startInitializersVector(e,t){e.startVector(4,t,4)}static addNodeArgs(e,t){e.addFieldOffset(1,t,0)}static createNodeArgsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startNodeArgsVector(e,t){e.startVector(4,t,4)}static addNodes(e,t){e.addFieldOffset(2,t,0)}static createNodesVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startNodesVector(e,t){e.startVector(4,t,4)}static addMaxNodeIndex(e,t){e.addFieldInt32(3,t,0)}static addNodeEdges(e,t){e.addFieldOffset(4,t,0)}static createNodeEdgesVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startNodeEdgesVector(e,t){e.startVector(4,t,4)}static addInputs(e,t){e.addFieldOffset(5,t,0)}static createInputsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startInputsVector(e,t){e.startVector(4,t,4)}static addOutputs(e,t){e.addFieldOffset(6,t,0)}static createOutputsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startOutputsVector(e,t){e.startVector(4,t,4)}static addSparseInitializers(e,t){e.addFieldOffset(7,t,0)}static createSparseInitializersVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startSparseInitializersVector(e,t){e.startVector(4,t,4)}static endGraph(e){return e.endObject()}static createGraph(e,t,n,i,o,s,a,c,u){return r.startGraph(e),r.addInitializers(e,t),r.addNodeArgs(e,n),r.addNodes(e,i),r.addMaxNodeIndex(e,o),r.addNodeEdges(e,s),r.addInputs(e,a),r.addOutputs(e,c),r.addSparseInitializers(e,u),r.endGraph(e)}}t.Graph=r}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(e){!function(t){!function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsModel(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsModel(e,t){return e.setPosition(e.position()+n.flatbuffers.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}irVersion(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}opsetImport(t,r){let n=this.bb.__offset(this.bb_pos,6);return n?(r||new e.experimental.fbs.OperatorSetId).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}opsetImportLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}producerName(e){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__string(this.bb_pos+t,e):null}producerVersion(e){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__string(this.bb_pos+t,e):null}domain(e){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__string(this.bb_pos+t,e):null}modelVersion(){let e=this.bb.__offset(this.bb_pos,14);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}docString(e){let t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__string(this.bb_pos+t,e):null}graph(t){let r=this.bb.__offset(this.bb_pos,18);return r?(t||new e.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}graphDocString(e){let t=this.bb.__offset(this.bb_pos,20);return t?this.bb.__string(this.bb_pos+t,e):null}static startModel(e){e.startObject(9)}static addIrVersion(e,t){e.addFieldInt64(0,t,e.createLong(0,0))}static addOpsetImport(e,t){e.addFieldOffset(1,t,0)}static createOpsetImportVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startOpsetImportVector(e,t){e.startVector(4,t,4)}static addProducerName(e,t){e.addFieldOffset(2,t,0)}static addProducerVersion(e,t){e.addFieldOffset(3,t,0)}static addDomain(e,t){e.addFieldOffset(4,t,0)}static addModelVersion(e,t){e.addFieldInt64(5,t,e.createLong(0,0))}static addDocString(e,t){e.addFieldOffset(6,t,0)}static addGraph(e,t){e.addFieldOffset(7,t,0)}static addGraphDocString(e,t){e.addFieldOffset(8,t,0)}static endModel(e){return e.endObject()}static createModel(e,t,n,i,o,s,a,c,u,l){return r.startModel(e),r.addIrVersion(e,t),r.addOpsetImport(e,n),r.addProducerName(e,i),r.addProducerVersion(e,o),r.addDomain(e,s),r.addModelVersion(e,a),r.addDocString(e,c),r.addGraph(e,u),r.addGraphDocString(e,l),r.endModel(e)}}t.Model=r}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(e){!function(e){!function(e){class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsKernelCreateInfos(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsKernelCreateInfos(e,r){return e.setPosition(e.position()+n.flatbuffers.SIZE_PREFIX_LENGTH),(r||new t).__init(e.readInt32(e.position())+e.position(),e)}nodeIndices(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readUint32(this.bb.__vector(this.bb_pos+t)+4*e):0}nodeIndicesLength(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__vector_len(this.bb_pos+e):0}nodeIndicesArray(){let e=this.bb.__offset(this.bb_pos,4);return e?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}kernelDefHashes(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint64(this.bb.__vector(this.bb_pos+t)+8*e):this.bb.createLong(0,0)}kernelDefHashesLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}static startKernelCreateInfos(e){e.startObject(2)}static addNodeIndices(e,t){e.addFieldOffset(0,t,0)}static createNodeIndicesVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addInt32(t[r]);return e.endVector()}static startNodeIndicesVector(e,t){e.startVector(4,t,4)}static addKernelDefHashes(e,t){e.addFieldOffset(1,t,0)}static createKernelDefHashesVector(e,t){e.startVector(8,t.length,8);for(let r=t.length-1;r>=0;r--)e.addInt64(t[r]);return e.endVector()}static startKernelDefHashesVector(e,t){e.startVector(8,t,8)}static endKernelCreateInfos(e){return e.endObject()}static createKernelCreateInfos(e,r,n){return t.startKernelCreateInfos(e),t.addNodeIndices(e,r),t.addKernelDefHashes(e,n),t.endKernelCreateInfos(e)}}e.KernelCreateInfos=t}(e.fbs||(e.fbs={}))}(e.experimental||(e.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(e){!function(t){!function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsSubGraphSessionState(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsSubGraphSessionState(e,t){return e.setPosition(e.position()+n.flatbuffers.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}graphId(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}sessionState(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new e.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}static startSubGraphSessionState(e){e.startObject(2)}static addGraphId(e,t){e.addFieldOffset(0,t,0)}static addSessionState(e,t){e.addFieldOffset(1,t,0)}static endSubGraphSessionState(e){let t=e.endObject();return e.requiredField(t,4),t}static createSubGraphSessionState(e,t,n){return r.startSubGraphSessionState(e),r.addGraphId(e,t),r.addSessionState(e,n),r.endSubGraphSessionState(e)}}t.SubGraphSessionState=r}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(e){!function(t){!function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsSessionState(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsSessionState(e,t){return e.setPosition(e.position()+n.flatbuffers.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}kernels(t){let r=this.bb.__offset(this.bb_pos,4);return r?(t||new e.experimental.fbs.KernelCreateInfos).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}subGraphSessionStates(t,r){let n=this.bb.__offset(this.bb_pos,6);return n?(r||new e.experimental.fbs.SubGraphSessionState).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}subGraphSessionStatesLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}static startSessionState(e){e.startObject(2)}static addKernels(e,t){e.addFieldOffset(0,t,0)}static addSubGraphSessionStates(e,t){e.addFieldOffset(1,t,0)}static createSubGraphSessionStatesVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startSubGraphSessionStatesVector(e,t){e.startVector(4,t,4)}static endSessionState(e){return e.endObject()}static createSessionState(e,t,n){return r.startSessionState(e),r.addKernels(e,t),r.addSubGraphSessionStates(e,n),r.endSessionState(e)}}t.SessionState=r}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(t.onnxruntime||(t.onnxruntime={})),function(e){!function(t){!function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsInferenceSession(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsInferenceSession(e,t){return e.setPosition(e.position()+n.flatbuffers.SIZE_PREFIX_LENGTH),(t||new r).__init(e.readInt32(e.position())+e.position(),e)}static bufferHasIdentifier(e){return e.__has_identifier("ORTM")}ortVersion(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}model(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new e.experimental.fbs.Model).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}sessionState(t){let r=this.bb.__offset(this.bb_pos,8);return r?(t||new e.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}static startInferenceSession(e){e.startObject(3)}static addOrtVersion(e,t){e.addFieldOffset(0,t,0)}static addModel(e,t){e.addFieldOffset(1,t,0)}static addSessionState(e,t){e.addFieldOffset(2,t,0)}static endInferenceSession(e){return e.endObject()}static finishInferenceSessionBuffer(e,t){e.finish(t,"ORTM")}static finishSizePrefixedInferenceSessionBuffer(e,t){e.finish(t,"ORTM",!0)}static createInferenceSession(e,t,n,i){return r.startInferenceSession(e),r.addOrtVersion(e,t),r.addModel(e,n),r.addSessionState(e,i),r.endInferenceSession(e)}}t.InferenceSession=r}(t.fbs||(t.fbs={}))}(e.experimental||(e.experimental={}))}(t.onnxruntime||(t.onnxruntime={}))},1723:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OnnxjsSessionHandler=void 0;const n=r(8453),i=r(9240);t.OnnxjsSessionHandler=class{constructor(e){this.session=e,this.inputNames=this.session.inputNames,this.outputNames=this.session.outputNames}async dispose(){}async run(e,t,r){const o=new Map;for(const t in e)if(Object.hasOwnProperty.call(e,t)){const r=e[t];o.set(t,new i.Tensor(r.dims,r.type,void 0,void 0,r.data))}const s=await this.session.run(o),a={};return s.forEach(((e,t)=>{a[t]=new n.Tensor(e.type,e.data,e.dims)})),a}startProfiling(){this.session.startProfiling()}endProfiling(){this.session.endProfiling()}}},6027:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Session=void 0;const n=r(7067),i=r(1296),o=r(1975),s=r(6496),a=r(1315),c=r(1745);t.Session=class{constructor(e={}){this._initialized=!1,this.backendHint=e.backendHint,this.profiler=a.Profiler.create(e.profiler),this.context={profiler:this.profiler,graphInputTypes:[],graphInputDims:[]}}get inputNames(){return this._model.graph.getInputNames()}get outputNames(){return this._model.graph.getOutputNames()}startProfiling(){this.profiler.start()}endProfiling(){this.profiler.stop()}async loadModel(e,t,r){await this.profiler.event("session","Session.loadModel",(async()=>{const s=await(0,o.resolveBackend)(this.backendHint);if(this.sessionHandler=s.createSessionHandler(this.context),this._model=new c.Model,"string"==typeof e){const t=e.endsWith(".ort");if("undefined"==typeof fetch){const r=await(0,i.promisify)(n.readFile)(e);this.initialize(r,t)}else{const r=await fetch(e),n=await r.arrayBuffer();this.initialize(new Uint8Array(n),t)}}else if(ArrayBuffer.isView(e))this.initialize(e);else{const n=new Uint8Array(e,t||0,r||e.byteLength);this.initialize(n)}}))}initialize(e,t){if(this._initialized)throw new Error("already initialized");this.profiler.event("session","Session.initialize",(()=>{const r=this.sessionHandler.transformGraph?this.sessionHandler:void 0;this._model.load(e,r,t),this.sessionHandler.onGraphInitialized&&this.sessionHandler.onGraphInitialized(this._model.graph),this.initializeOps(this._model.graph),this._executionPlan=new s.ExecutionPlan(this._model.graph,this._ops,this.profiler)})),this._initialized=!0}async run(e){if(!this._initialized)throw new Error("session not initialized yet");return this.profiler.event("session","Session.run",(async()=>{const t=this.normalizeAndValidateInputs(e),r=await this._executionPlan.execute(this.sessionHandler,t);return this.createOutput(r)}))}normalizeAndValidateInputs(e){const t=this._model.graph.getInputNames();if(Array.isArray(e)){if(e.length!==t.length)throw new Error(`incorrect input array length: expected ${t.length} but got ${e.length}`)}else{if(e.size!==t.length)throw new Error(`incorrect input map size: expected ${t.length} but got ${e.size}`);const r=new Array(e.size);let n=0;for(let i=0;i<t.length;++i){const o=e.get(t[i]);if(!o)throw new Error(`missing input tensor for: '${name}'`);r[n++]=o}e=r}if(this.context.graphInputTypes&&0!==this.context.graphInputTypes.length&&this.context.graphInputDims&&0!==this.context.graphInputDims.length)this.validateInputTensorDims(this.context.graphInputDims,e,!1);else{const t=this._model.graph.getInputIndices(),r=this._model.graph.getValues(),n=new Array(t.length);for(let i=0;i<t.length;++i){const o=r[t[i]];n[i]=o.type.shape.dims,this.context.graphInputTypes.push(o.type.tensorType),this.context.graphInputDims.push(e[i].dims)}this.validateInputTensorDims(n,e,!0)}return this.validateInputTensorTypes(this.context.graphInputTypes,e),e}validateInputTensorTypes(e,t){for(let r=0;r<t.length;r++){const n=e[r],i=t[r].type;if(n!==i)throw new Error(`input tensor[${r}] check failed: expected type '${n}' but got ${i}`)}}validateInputTensorDims(e,t,r){for(let n=0;n<t.length;n++){const i=e[n],o=t[n].dims;if(!this.compareTensorDims(i,o,r))throw new Error(`input tensor[${n}] check failed: expected shape '[${i.join(",")}]' but got [${o.join(",")}]`)}}compareTensorDims(e,t,r){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n]&&(!r||0!==e[n]))return!1;return!0}createOutput(e){const t=this._model.graph.getOutputNames();if(e.length!==t.length)throw new Error("expected number of outputs do not match number of generated outputs");const r=new Map;for(let n=0;n<t.length;++n)r.set(t[n],e[n]);return r}initializeOps(e){const t=e.getNodes();this._ops=new Array(t.length);for(let r=0;r<t.length;r++)this._ops[r]=this.sessionHandler.resolve(t[r],this._model.opsets,e)}}},9240:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Tensor=void 0;const i=r(3442),o=n(r(3720)),s=r(1446),a=r(1287),c=r(7273);var u=a.onnxruntime.experimental.fbs;class l{get data(){if(void 0===this.cache){const e=this.dataProvider(this.dataId);if(e.length!==this.size)throw new Error("Length of data provided by the Data Provider is inconsistent with the dims of this Tensor.");this.cache=e}return this.cache}get stringData(){if("string"!==this.type)throw new TypeError("data type is not string");return this.data}get integerData(){switch(this.type){case"uint8":case"int8":case"uint16":case"int16":case"int32":case"uint32":case"bool":return this.data;default:throw new TypeError("data type is not integer (uint8, int8, uint16, int16, int32, uint32, bool)")}}get floatData(){switch(this.type){case"float32":case"float64":return this.data;default:throw new TypeError("data type is not float (float32, float64)")}}get numberData(){if("string"!==this.type)return this.data;throw new TypeError("type cannot be non-number (string)")}get(e){return this.data[c.ShapeUtil.indicesToOffset(e,this.strides)]}set(e,t){this.data[c.ShapeUtil.indicesToOffset(e,this.strides)]=t}async getData(){return void 0===this.cache&&(this.cache=await this.asyncDataProvider(this.dataId)),this.cache}get strides(){return this._strides||(this._strides=c.ShapeUtil.computeStrides(this.dims)),this._strides}constructor(e,t,r,n,o,s=i.Guid.create()){this.dims=e,this.type=t,this.dataProvider=r,this.asyncDataProvider=n,this.cache=o,this.dataId=s,this.size=c.ShapeUtil.validateDimsAndCalcSize(e);const a=this.size,u=void 0===r&&void 0===n&&void 0===o;if(void 0!==o&&o.length!==a)throw new RangeError("Input dims doesn't match data length.");if("string"===t){if(!(void 0===o||Array.isArray(o)&&o.every((e=>"string"==typeof e))))throw new TypeError("cache should be a string array");u&&(this.cache=new Array(a))}else{if(void 0!==o){const e=h(t);if(!(o instanceof e))throw new TypeError(`cache should be type ${e.name}`)}if(u){const e=new ArrayBuffer(a*function(e){switch(e){case"bool":case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;case"float64":return 8;default:throw new Error(`cannot calculate sizeof() on type ${e}`)}}(t));this.cache=function(e,t){return new(h(t))(e)}(e,t)}}}static fromProto(e){if(!e)throw new Error("cannot construct Value from an empty tensor");const t=c.ProtoUtil.tensorDataTypeFromProto(e.dataType),r=c.ProtoUtil.tensorDimsFromProto(e.dims),n=new l(r,t);if("string"===t)e.stringData.forEach(((e,t)=>{n.data[t]=(0,c.decodeUtf8String)(e)}));else if(e.rawData&&"number"==typeof e.rawData.byteLength&&e.rawData.byteLength>0){const t=n.data,r=new DataView(e.rawData.buffer,e.rawData.byteOffset,e.rawData.byteLength),i=d(e.dataType),o=e.rawData.byteLength/i;if(e.rawData.byteLength%i!=0)throw new Error("invalid buffer length");if(t.length!==o)throw new Error("buffer length mismatch");for(let n=0;n<o;n++){const o=p(r,e.dataType,n*i);t[n]=o}}else{let t;switch(e.dataType){case s.onnx.TensorProto.DataType.FLOAT:t=e.floatData;break;case s.onnx.TensorProto.DataType.INT32:case s.onnx.TensorProto.DataType.INT16:case s.onnx.TensorProto.DataType.UINT16:case s.onnx.TensorProto.DataType.INT8:case s.onnx.TensorProto.DataType.UINT8:case s.onnx.TensorProto.DataType.BOOL:t=e.int32Data;break;case s.onnx.TensorProto.DataType.INT64:t=e.int64Data;break;case s.onnx.TensorProto.DataType.DOUBLE:t=e.doubleData;break;case s.onnx.TensorProto.DataType.UINT32:case s.onnx.TensorProto.DataType.UINT64:t=e.uint64Data;break;default:throw new Error("unspecific error")}if(null==t)throw new Error("failed to populate data from a tensorproto value");const r=n.data;if(r.length!==t.length)throw new Error("array length mismatch");for(let n=0;n<t.length;n++){const i=t[n];o.default.isLong(i)?r[n]=f(i,e.dataType):r[n]=i}}return n}static fromData(e,t,r){return new l(t,r,void 0,void 0,e)}static fromOrtTensor(e){if(!e)throw new Error("cannot construct Value from an empty tensor");const t=c.ProtoUtil.tensorDimsFromORTFormat(e),r=c.ProtoUtil.tensorDataTypeFromProto(e.dataType()),n=new l(t,r);if("string"===r)for(let t=0;t<e.stringDataLength();t++)n.data[t]=e.stringData(t);else if(e.rawDataArray()&&"number"==typeof e.rawDataLength()&&e.rawDataLength()>0){const t=n.data,r=new DataView(e.rawDataArray().buffer,e.rawDataArray().byteOffset,e.rawDataLength()),i=d(e.dataType()),o=e.rawDataLength()/i;if(e.rawDataLength()%i!=0)throw new Error("invalid buffer length");if(t.length!==o)throw new Error("buffer length mismatch");for(let n=0;n<o;n++){const o=p(r,e.dataType(),n*i);t[n]=o}}return n}}function d(e){switch(e){case s.onnx.TensorProto.DataType.UINT8:case s.onnx.TensorProto.DataType.INT8:case s.onnx.TensorProto.DataType.BOOL:return 1;case s.onnx.TensorProto.DataType.UINT16:case s.onnx.TensorProto.DataType.INT16:return 2;case s.onnx.TensorProto.DataType.FLOAT:case s.onnx.TensorProto.DataType.INT32:case s.onnx.TensorProto.DataType.UINT32:return 4;case s.onnx.TensorProto.DataType.INT64:case s.onnx.TensorProto.DataType.DOUBLE:case s.onnx.TensorProto.DataType.UINT64:return 8;default:throw new Error(`cannot calculate sizeof() on type ${s.onnx.TensorProto.DataType[e]}`)}}function h(e){switch(e){case"bool":case"uint8":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"uint16":return Uint16Array;case"int32":return Int32Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;default:throw new Error("unspecified error")}}function f(e,t){if(t===s.onnx.TensorProto.DataType.INT64||t===u.TensorDataType.INT64){if(e.greaterThanOrEqual(2147483648)||e.lessThan(-2147483648))throw new TypeError("int64 is not supported")}else{if(t!==s.onnx.TensorProto.DataType.UINT32&&t!==u.TensorDataType.UINT32&&t!==s.onnx.TensorProto.DataType.UINT64&&t!==u.TensorDataType.UINT64)throw new TypeError(`not a LONG type: ${s.onnx.TensorProto.DataType[t]}`);if(e.greaterThanOrEqual(4294967296)||e.lessThan(0))throw new TypeError("uint64 is not supported")}return e.toNumber()}function p(e,t,r){switch(t){case s.onnx.TensorProto.DataType.BOOL:case s.onnx.TensorProto.DataType.UINT8:return e.getUint8(r);case s.onnx.TensorProto.DataType.INT8:return e.getInt8(r);case s.onnx.TensorProto.DataType.UINT16:return e.getUint16(r,!0);case s.onnx.TensorProto.DataType.INT16:return e.getInt16(r,!0);case s.onnx.TensorProto.DataType.FLOAT:return e.getFloat32(r,!0);case s.onnx.TensorProto.DataType.INT32:return e.getInt32(r,!0);case s.onnx.TensorProto.DataType.UINT32:return e.getUint32(r,!0);case s.onnx.TensorProto.DataType.INT64:return f(o.default.fromBits(e.getUint32(r,!0),e.getUint32(r+4,!0),!1),t);case s.onnx.TensorProto.DataType.DOUBLE:return e.getFloat64(r,!0);case s.onnx.TensorProto.DataType.UINT64:return f(o.default.fromBits(e.getUint32(r,!0),e.getUint32(r+4,!0),!0),t);default:throw new Error(`cannot read from DataView for type ${s.onnx.TensorProto.DataType[t]}`)}}t.Tensor=l},7273:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.decodeUtf8String=t.MAX_CLIP=t.MIN_CLIP=t.PoolConvUtil=t.ReduceUtil=t.SplitUtil=t.MathUtil=t.ShapeUtil=t.LongUtil=t.ProtoUtil=t.GemmUtil=t.arrayCopyHelper=t.BroadcastUtil=t.MatMulUtil=t.ArrayUtil=t.assert=t.checkInputsShape=void 0;const i=r(5686),o=n(r(3720)),s=r(1446),a=r(9240);t.checkInputsShape=function(e,...t){if(!e||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].dims||e[r].dims.length!==t[r])return!1;return!0},t.assert=function(e,t){if(!e)throw new Error("string"==typeof t?t:t())},t.ArrayUtil=class{static arraysEqual(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}};class c{static preprocessInputShapes(e,t){return[1===e.length?[1,e[0]]:e,1===t.length?[t[0],1]:t]}static postprocessOutputShape(e,t,r){1===t&&e.splice(e.length-2,1),1===r&&e.pop()}static calcMatMulShape(e,t){return e[1]!==t[0]?void 0:[e[0],t[1]]}}t.MatMulUtil=c;class u{static calcShape(e,t,r=!1){const n=e.length,i=t.length;if(0===n)return t;if(0===i)return e;const o=Math.max(e.length,t.length),s=new Array(o);if(r){if(n<2||i<2)return;const r=c.calcMatMulShape([e[n-2],e[n-1]],[t[i-2],t[i-1]]);if(void 0===r)return;[s[o-2],s[o-1]]=r}for(let a=r?3:1;a<=o;a++){const r=n-a<0?1:e[n-a],c=i-a<0?1:t[i-a];if(r!==c&&r>1&&c>1)return;s[o-a]=Math.max(r,c)}return s}static index(e,t){const r=new Array(t.length);return u.fillIndex(e,t,r),r}static fillIndex(e,t,r){const n=e.length-t.length;for(let i=0;i<t.length;i++)r[i]=e[n+i]%t[i]}static calc(e,t,r,n,i){const o=u.calcShape(e.dims,t.dims);if(o){if(n&&!h.areEqual(o,e.dims))return;const s=h.size(o),c=n?e:new a.Tensor(o,i||e.type);if(0===o.length)c.set([],r(e.get([]),t.get([])));else{const n=new Array(o.length),i=new Array(e.dims.length),a=new Array(t.dims.length);let l,d=0,h=0,f=!1,p=!1;0===e.dims.length&&(d=e.get([]),f=!0),0===t.dims.length&&(h=t.get([]),p=!0);for(let m=0;m<s;m++){l=m;for(let e=o.length-1;e>=0;e--)n[e]=l%o[e],l=Math.floor(l/o[e]);f||(u.fillIndex(n,e.dims,i),d=e.get(i)),p||(u.fillIndex(n,t.dims,a),h=t.get(a)),c.set(n,r(d,h))}}return c}}static isValidBroadcast(e,t){const r=e.length,n=t.length;if(r>n)return!1;for(let i=1;i<=r;i++)if(1!==e[r-i]&&e[r-i]!==t[n-i])return!1;return!0}static getBroadcastDims(e,t){const r=e.length,n=[];for(let i=0;i<r;i++){const o=r-1-i,s=e[o]||1;(t[t.length-1-i]||1)>1&&1===s&&n.unshift(o)}return n}}t.BroadcastUtil=u,t.arrayCopyHelper=function(e,t,r,n,i){if(n<0||n>=t.length)throw new Error("sourceIndex out of bounds");if(r<0||r>=e.length)throw new Error("targetIndex out of bounds");if(n+i>t.length)throw new Error("source indices to be copied are outside bounds");if(r+i>e.length)throw new Error("target array is too small to hold result");for(let o=0;o<i;o++)e[r+o]=t[n+o]},t.GemmUtil=class{static getShapeOfGemmResult(e,t,r,n,i){if(2!==e.length||2!==r.length)throw new Error("shape need to be of size 2");let o,s,a;t?(o=e[1],s=e[0]):(o=e[0],s=e[1]);let c=-1;if(n?(a=r[0],c=1):(a=r[1],c=0),r[c]!==s)throw new Error("dimension mismatch");if(o<=0||a<=0||s<=0)throw new Error("invalid shape specified");if(i&&!u.isValidBroadcast(i,[o,a]))throw new Error("gemm: invalid bias shape for broadcast");return[o,a,s]}};class l{static tensorDataTypeFromProto(e){switch(e){case s.onnx.TensorProto.DataType.INT8:return"int8";case s.onnx.TensorProto.DataType.UINT8:return"uint8";case s.onnx.TensorProto.DataType.BOOL:return"bool";case s.onnx.TensorProto.DataType.INT16:return"int16";case s.onnx.TensorProto.DataType.UINT16:return"uint16";case s.onnx.TensorProto.DataType.INT32:return"int32";case s.onnx.TensorProto.DataType.UINT32:return"uint32";case s.onnx.TensorProto.DataType.FLOAT:return"float32";case s.onnx.TensorProto.DataType.DOUBLE:return"float64";case s.onnx.TensorProto.DataType.STRING:return"string";case s.onnx.TensorProto.DataType.INT64:return"int32";case s.onnx.TensorProto.DataType.UINT64:return"uint32";default:throw new Error(`unsupported data type: ${s.onnx.TensorProto.DataType[e]}`)}}static tensorDataTypeStringToEnum(e){switch(e){case"int8":return s.onnx.TensorProto.DataType.INT8;case"uint8":return s.onnx.TensorProto.DataType.UINT8;case"bool":return s.onnx.TensorProto.DataType.BOOL;case"int16":return s.onnx.TensorProto.DataType.INT16;case"uint16":return s.onnx.TensorProto.DataType.UINT16;case"int32":return s.onnx.TensorProto.DataType.INT32;case"uint32":return s.onnx.TensorProto.DataType.UINT32;case"float32":return s.onnx.TensorProto.DataType.FLOAT;case"float64":return s.onnx.TensorProto.DataType.DOUBLE;case"string":return s.onnx.TensorProto.DataType.STRING;case"int64":return s.onnx.TensorProto.DataType.INT64;case"uint64":return s.onnx.TensorProto.DataType.UINT64;default:throw new Error(`unsupported data type: ${e}`)}}static tensorDimsFromProto(e){return e.map((e=>o.default.isLong(e)?e.toNumber():e))}static tensorValueTypeFromProto(e){return{tensorType:l.tensorDataTypeFromProto(e.elemType),shape:{dims:l.tensorDimsFromProto(e.shape.dim.map((e=>e.dimValue)))}}}static tensorDimsFromORTFormat(e){const t=[];for(let r=0;r<e.dimsLength();r++)t.push(d.longToNumber(e.dims(r)));return t}static tensorAttributesFromORTFormat(e){const t=[];for(let r=0;r<e.attributesLength();r++)t.push(e.attributes(r));return t}}t.ProtoUtil=l;class d{static longToNumber(e,t){return o.default.isLong(e)?e.toNumber():e instanceof i.flatbuffers.Long?o.default.fromValue({low:e.low,high:e.high,unsigned:null!=t&&t}).toNumber():e}static isLong(e){return o.default.isLong(e)||e instanceof i.flatbuffers.Long}}t.LongUtil=d;class h{static size(e){return h.getSizeFromDimensionRange(e,0,e.length)}static sizeFromDimension(e,t){if(t<0||t>e.length)throw new Error(`invalid dimension of ${t} for sizeFromDimension as Tensor has ${e.length} dimensions.`);return h.getSizeFromDimensionRange(e,t,e.length)}static sizeToDimension(e,t){if(t<0||t>e.length)throw new Error(`invalid dimension of ${t} for sizeToDimension as Tensor has ${e.length} dimensions.`);return h.getSizeFromDimensionRange(e,0,t)}static getSizeFromDimensionRange(e,t,r){let n=1;for(let i=t;i<r;i++){if(e[i]<=0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains 0 or negative values in them.");n*=e[i]}return n}static computeStrides(e){const t=e.length;if(0===t)return[];if(1===t)return[1];const r=new Array(t);r[t-1]=1,r[t-2]=e[t-1];for(let n=t-3;n>=0;--n)r[n]=r[n+1]*e[n+1];return r}static transpose(e){return e.slice().reverse()}static indicesToOffset(e,t,r){void 0===r&&(r=e.length);let n=0;for(let i=0;i<r;++i)n+=t[i]*e[i];return n}static offsetToIndices(e,t){const r=t.length;if(0===r)return[];if(1===r)return[e*t[0]];const n=new Array(t.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(e/t[r]),e-=n[r]*t[r];return n[n.length-1]=e,n}static normalizeAxis(e,t){if(e<-t&&e>=t)throw new Error("unsupported axis for this operation.");return e<0?e+t:e}static normalizeAxes(e,t){return e.map((e=>this.normalizeAxis(e,t)))}static incrementIndex(e,t,r){if(0===t.length||0===e.length)throw new Error("Index incrementing unsupported for scalar Tensor");if(void 0===r)r=t.length;else if(r<=0||r>t.length)throw new Error("Incorrect axis to increment on");for(let n=r-1;n>=0&&(e[n]++,!(e[n]<t[n]));--n)e[n]=0}static calculateReshapedDims(e,t){if(0===t.length){if(0===e.length||1===h.size(e))return[];throw new Error("cannot reshape to a scalar Tensor")}const r=t.length,n=new Array(r);let i=-1,o=1;for(let s=0;s<r;s++){if(t[s]<-1)throw new Error("a dimension in shape hints cannot be less than -1");if(-1===t[s]){if(-1!==i)throw new Error("at most one dimension in shape hints can be -1");i=s}else{if(0===t[s]){if(s>=e.length)throw new Error("the dimension with value zero exceeds the dimension size of the input tensor");n[s]=e[s]}else n[s]=t[s];o*=n[s]}}const s=h.size(e);if(-1!==i){if(s%o!=0)throw new Error(`the input tensor cannot be reshaped to the requested shape. Input shape: [${e}] Output shape: [${t}]`);n[i]=s/o}else if(o!==s)throw new Error("reshapedDims and originalDims don't have matching sizes");return n}static sortBasedOnPerm(e,t){return t?t.map((t=>e[t])):e.slice().reverse()}static padShape(e,t){const r=e.length;return e.map(((e,n)=>e+t[n]+t[n+r]))}static areEqual(e,t){return e.length===t.length&&e.every(((e,r)=>e===t[r]))}static validateDimsAndCalcSize(e){if(e.length>6)throw new TypeError("Only rank 0 to 6 is supported for tensor shape.");let t=1;for(const r of e){if(!Number.isInteger(r))throw new TypeError(`Invalid shape: ${r} is not an integer`);if(r<0||r>2147483647)throw new TypeError(`Invalid shape: length ${r} is not allowed`);t*=r}return t}static flattenShape(e,t){t<0&&(t+=e.length);const r=e.reduce(((e,t)=>e*t),1),n=e.slice(t).reduce(((e,t)=>e*t),1);return[r/n,n]}static squeezeShape(e,t){const r=new Array;t=h.normalizeAxes(t,e.length);for(let n=0;n<e.length;n++){const i=t.indexOf(n)>=0;if(i&&1!==e[n])throw new Error("squeeze an axis of size different than 1");(0===t.length&&e[n]>1||t.length>0&&!i)&&r.push(e[n])}return r}static unsqueezeShape(e,t){const r=new Array(e.length+t.length);r.fill(0);for(let e=0;e<t.length;e++){const n=h.normalizeAxis(t[e],r.length);if(n>=r.length)throw new Error("'axes' has an out of range axis");if(0!==r[n])throw new Error("'axes' has a duplicate axis");r[n]=1}let n=0;for(let t=0;t<r.length;t++)0===r[t]&&(r[t]=e[n++]);if(n!==e.length)throw new Error("the unsqueezed dimension could not be established");return r}}t.ShapeUtil=h,t.MathUtil=class{static sqr(e,t,r,n,i){if(n<0||n>=t.length)throw new Error("sourceIndex out of bounds");if(r<0||r>=e.length)throw new Error("targetIndex out of bounds");if(n+i>t.length)throw new Error("source indices to be copied are outside bounds");if(r+i>e.length)throw new Error("target array is too small to hold result");for(let o=0;o<i;o++)e[r+o]+=Math.pow(t[n+o],2)}static axpy(e,t,r,n,i,o){if(n<0||n>=t.length)throw new Error("sourceIndex out of bounds");if(r<0||r>=e.length)throw new Error("targetIndex out of bounds");if(n+i>t.length)throw new Error("source indices to be copied are outside bounds");if(r+i>e.length)throw new Error("target array is too small to hold result");for(let s=0;s<i;s++)e[r+s]+=o*t[n+s]}static powx(e,t,r,n,i,o){if(n<0||n>=t.length)throw new Error("sourceIndex out of bounds");if(r<0||r>=e.length)throw new Error("targetIndex out of bounds");if(n+i>t.length)throw new Error("source indices to be copied are outside bounds");if(r+i>e.length)throw new Error("target array is too small to hold result");for(let s=0;s<i;s++)e[r+s]=Math.pow(t[n+s],o)}static mul(e,t,r,n,i){if(n<0||n>=t.length)throw new Error("sourceIndex out of bounds");if(r<0||r>=e.length)throw new Error("targetIndex out of bounds");if(n+i>t.length)throw new Error("source indices to be copied are outside bounds");if(r+i>e.length)throw new Error("target array is too small to hold result");for(let o=0;o<i;o++)e[r+o]=t[n+o]*e[r+o]}};class f{static splitShape(e,t,r,n){if(0===r.length){if(!n)throw new Error("need to know number of outputs when the 'split' attribute is not specified");f.determineSplit(e[t],n,r)}const i=[],o=[0];for(let n=0;n<r.length;++n){0!==n&&o.push(o[n-1]+r[n-1]);const s=e.slice();s[t]=r[n],i.push(s)}return[i,o]}static determineSplit(e,t,r){if(e%t!=0)throw new Error("cannot split tensor to equal sized parts");for(let n=0;n<t;++n)r.push(e/t)}}t.SplitUtil=f;class p{static calcReduce(e,t,r,n,i){const o=e.dims.slice(0);0===t.length&&o.forEach(((e,r)=>t.push(r)));const s=p.calcReduceShape(o,t,!0),c=h.size(s),l=new a.Tensor(s,e.type),d=h.computeStrides(s),f=h.computeStrides(o),m=new Array(o.length);for(let r=0;r<c;r++){const s=h.offsetToIndices(r,d);u.fillIndex(s,o,m),l.set(s,p.calcReduceByAxis(e.numberData,t,o,0,h.indicesToOffset(m,f),n,i))}return r?l:new a.Tensor(p.calcReduceShape(o,t,r),l.type,void 0,void 0,l.data,l.dataId)}static calcReduceByAxis(e,t,r,n,i,o,s){let a=0;if(n>=t.length)return o(e[i]);const c=t[n],u=c>=r.length?1:h.size(r.slice(c+1));for(let l=0;l<r[c];l++)a=0===l?p.calcReduceByAxis(e,t,r,n+1,i,o,s):s(a,p.calcReduceByAxis(e,t,r,n+1,i,o,s)),i+=u;return a}static calcReduceShape(e,t,r){const n=e.slice();for(let e=0;e<t.length;e++)n[t[e]]=r?1:0;return n.filter((e=>0!==e))}}t.ReduceUtil=p;class m{static adjustPoolAttributes(e,t,r,n,i,o){if(!e&&r.length!==t.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(e)for(let e=0;e<t.length-2;e++)e>=r.length?r.push(t[e+2]):r[e]=t[e+2];for(let e=0;e<r.length;e++)if(e<n.length){if(n[e]<0)throw new Error("strides should be greater than or equal to 1")}else n.push(1);for(let e=0;e<r.length;e++)if(e<i.length){if(i[e]<0)throw new Error("dilations should be greater than or equal to 1")}else i.push(1);for(let e=0;e<2*r.length;e++)if(e<o.length){if(o[e]<0)throw new Error("pad should be greater than or equal to 1")}else o.push(0);for(let e=0;e<r.length;e++){if(r[e]<=0)throw new Error("kernel shapes need to be greater than 0");if(o[e]>=r[e]||o[e+r.length]>=r[e])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(e,t,r,n,i,o){if(o){if(i.length!==2*(e.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(t.length!==e.length-2)throw new Error("length of strides should be the length of data dimensions");if(n.length!==e.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let s=0;s<e.length-2;s++)m.adjustPadAndReturnShape(e[s+2],t[s],r[s],n[s],i,s,s+e.length-2,o)}}static computePoolOutputShape(e,t,r,n,i,o,s){if(t.length<=0)throw new Error("input shape must be of size greater than 0");const a=[t[0],t[1]];return m.computeShapeHelper(e,t,a,r,n,i,o,s),a}static computeConvOutputShape(e,t,r,n,i,o,s){if(e.length<=0||t.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");const a=[e[0],t[0]];return m.computeShapeHelper(!1,e,a,r,n,i,o,s),a}static computeShapeHelper(e,t,r,n,i,o,s,a){if(e)for(let e=0;e<t.length-2;e++)r.push(1);else for(let e=0;e<t.length-2;e++)r.push(m.adjustPadAndReturnShape(t[e+2],n[e],i[e],o[e],s,e,e+t.length-2,a))}static adjustPadAndReturnShape(e,t,r,n,i,o,s,a){const c=r*(n-1)+1;if(!a||"NOTSET"===a)return Math.floor((e+i[o]+i[s]-c)/t+1);switch(a){case"VALID":return i[o]=0,i[s]=0,Math.floor((e-c)/t+1);case"SAME_LOWER":case"SAME_UPPER":if(1!==r)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{const r=((e+t-1)/t-1)*t+n-e;return i[o]="SAME_LOWER"===a?Math.floor((r+1)/2):Math.floor(r/2),i[s]=r-i[o],Math.floor((e+r-n)/t+1)}default:throw new Error("Unsupported AutoPad type")}}}t.PoolConvUtil=m,t.MIN_CLIP=-34028234663852886e22,t.MAX_CLIP=34028234663852886e22,t.decodeUtf8String=function(e){return(new TextDecoder).decode(e)}},3838:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WebGpuBackend=void 0;const n=r(8453),i=r(4955),o=r(7771),s=r(8510),a=r(8305);t.WebGpuBackend=class{constructor(){this.currentKernelId=null,this.commandEncoder=null,this.computePassEncoder=null,this.pendingDispatchNumber=0,this.profilingEnabled=!1}get currentKernelCustomData(){if(null===this.currentKernelId)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");let e=this.kernelCustomData.get(this.currentKernelId);return e||(e={},this.kernelCustomData.set(this.currentKernelId,e)),e}async initialize(){if(!navigator.gpu)throw new Error("WebGpuBackend: WebGPU is not available.");const e=await navigator.gpu.requestAdapter();if(!e)throw new Error("WebGpuBackend: Failed to get GPU adapter.");const t={requiredLimits:{maxComputeWorkgroupStorageSize:e.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:e.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:e.limits.maxStorageBufferBindingSize}};e.features.has("timestamp-query-inside-passes")&&"default"===n.env.webgpu.profilingMode&&(this.profilingEnabled=!0,t.requiredFeatures=["timestamp-query-inside-passes"]),this.device=await e.requestDevice(t),this.gpuDataManager=(0,o.createGpuDataManager)(this),this.programManager=new a.ProgramManager(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,this.device.onuncapturederror=e=>{e.error instanceof GPUValidationError&&console.error(`An uncaught WebGPU validation error was raised: ${e.error.message}`)},this.profilingEnabled&&(this.profilingQuerySet=this.device.createQuerySet({type:"timestamp",count:2}))}dispose(){}getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder()),this.commandEncoder}getComputePassEncoder(){return this.computePassEncoder||(this.computePassEncoder=this.getCommandEncoder().beginComputePass()),this.computePassEncoder}endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}flush(){this.endComputePass(),this.device.queue.submit([this.getCommandEncoder().finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0}run(e,t,r,n,o){if(t.length!==e.inputTypes.length)throw new Error(`Input size must be equal to ${e.inputTypes.length}.`);const s=[];for(let e=0;e<t.length;++e){const r=this.gpuDataManager.get(t[e].data);if(!r)throw new Error(`no GPU data for input: ${t[e].data}`);s[e]=r}const a=((e,t,r)=>{const n=t.map((e=>`${e.join(",")}`)).join("_"),i=r.join("_");let o=e.name;return e.cacheHint&&(o+="["+e.cacheHint+"]"),o+=":"+n+";"+i,o})(e,t.map((e=>e.dims)),s.map((e=>e.type)));let c=this.programManager.getArtifact(a);const u=c?c.programInfo:"function"==typeof e.get?e.get():e,l=0===r.length?u.outputs.map(((e,t)=>t)):r;if(l.length!==u.outputs.length)throw new Error(`Output size ${l.length} must be equal to ${u.outputs.length}.`);const d=[],h=[];for(let e=0;e<u.outputs.length;++e){if(!Number.isInteger(l[e])||l[e]<-2||l[e]>=u.outputs.length)throw new Error(`Invalid output index: ${l[e]}`);const t=-1===l[e],r=-2===l[e],i=t||r?o(u.outputs[e].dataType,u.outputs[e].dims):n(l[e],u.outputs[e].dataType,u.outputs[e].dims),s=this.gpuDataManager.get(i.data);if(!s)throw new Error(`no GPU data for output: ${i.data}`);if(t&&this.temporaryData.push(s),r){let e=this.kernelPersistentData.get(this.currentKernelId);e||(e=[],this.kernelPersistentData.set(this.currentKernelId,e)),e.push(s)}d.push(i),h.push(s)}const f=this.programManager.normalizeDispatchGroupSize(u.dispatchGroup(t));return c||(c=this.programManager.build(u,f),this.programManager.setArtifact(a,c)),(0,i.LOG_DEBUG)("info",(()=>`[ProgramManager] run "${u.name}" (key=${a}) with ${f[0]}x${f[1]}x${f[2]}`)),this.programManager.run(c,s,h,f),d}upload(e,t){this.gpuDataManager.upload(e,t)}memcpy(e,t){this.gpuDataManager.memcpy(e,t)}async download(e,t){const r=await this.gpuDataManager.download(e);t().set(new Uint8Array(r))}alloc(e){return this.gpuDataManager.create(e).id}free(e){return this.gpuDataManager.release(e)}createKernel(e,t,r){const n=s.WEBGPU_OP_RESOLVE_RULES.get(e);if(!n)throw new Error(`kernel not implemented: ${e}`);this.kernels.set(t,[e,n[0],[n[1],r]])}releaseKernel(e){const t=this.kernelPersistentData.get(e);if(t){for(const e of t)this.gpuDataManager.release(e.id);this.kernelPersistentData.delete(e)}this.kernelCustomData.delete(e),this.kernels.delete(e)}computeKernel(e,t){const r=this.kernels.get(e);if(!r)throw new Error(`kernel not created: ${e}`);const[n,o,s]=r;if(null!==this.currentKernelId)throw new Error(`kernel "${n}" is not allowed to be called recursively`);this.currentKernelId=e,s[0]&&(s[1]=s[0](s[1]),s[0]=void 0),(0,i.LOG_DEBUG)("info",(()=>`[WebGPU] Start to run kernel "${n}"...`)),this.temporaryData=[];try{return o(t,s[1]),0}catch(e){return(0,i.LOG_DEBUG)("warning",`[WebGPU] Kernel "${n}" failed. Error: ${e}`),1}finally{for(const e of this.temporaryData)this.gpuDataManager.release(e.id);this.temporaryData=[],this.currentKernelId=null}}}},7675:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const n=r(7917),i=r(3838),o=r(4955),s=r(6952);class a{constructor(e,t,r,n){this.module=e,this.dataType=t,this.data=r,this.dims=n}getFloat32Array(){return new Float32Array(this.module.HEAP8.buffer,this.data,s.ShapeUtil.size(this.dims))}reshape(e){if(s.ShapeUtil.size(e)!==s.ShapeUtil.size(this.dims))throw new Error("Invalid new shape");return new a(this.module,this.dataType,this.data,e)}}class c{get customData(){return this.backend.currentKernelCustomData}constructor(e,t,r){this.module=e,this.backend=t;const n=e.HEAPU32;let i=r>>2;this.opKernelContext=n[i++];const o=n[i++],s=[];for(let t=0;t<o;t++){const t=n[i++],r=n[i++],o=n[i++],c=[];for(let e=0;e<o;e++)c.push(n[i++]);s.push(new a(e,t,r,c))}this.inputs=s}compute(e,t){var r,i,o;const c=null!==(i=null===(r=null==t?void 0:t.inputs)||void 0===r?void 0:r.map((e=>"number"==typeof e?this.inputs[e]:e)))&&void 0!==i?i:this.inputs,u=null!==(o=null==t?void 0:t.outputs)&&void 0!==o?o:[];return this.backend.run(e,c,u,((e,t,r)=>new a(this.module,t,this.output(e,r),r)),((e,t)=>{const r=(0,n.getTensorElementSize)(e);if(!r)throw new Error(`Unsupported data type: ${e}`);const i=r*s.ShapeUtil.size(t);return new a(this.module,e,this.backend.gpuDataManager.create(i).id,t)}))}output(e,t){const r=this.module.stackSave();try{const r=this.module.stackAlloc(4*(1+t.length));let n=r>>2;this.module.HEAPU32[n++]=t.length;for(let e=0;e<t.length;e++)this.module.HEAPU32[n++]=t[e];return this.module._JsepOutput(this.opKernelContext,e,r)}finally{this.module.stackRestore(r)}}}t.init=async e=>{const t=e.jsepInit;if(t&&navigator.gpu){const r=new i.WebGpuBackend;await r.initialize(),t({backend:r},(e=>r.alloc(e)),(e=>r.free(e)),((t,n,i,s=!1)=>{if(s)(0,o.LOG_DEBUG)("verbose",(()=>`[WebGPU] jsepCopyGpuToGpu: src=${t}, dst=${n}, size=${i}`)),r.memcpy(t,n);else{(0,o.LOG_DEBUG)("verbose",(()=>`[WebGPU] jsepCopyCpuToGpu: dataOffset=${t}, gpuDataId=${n}, size=${i}`));const s=e.HEAPU8.subarray(t,t+i);r.upload(n,s)}}),(async(t,n,i)=>{(0,o.LOG_DEBUG)("verbose",(()=>`[WebGPU] jsepCopyGpuToCpu: gpuDataId=${t}, dataOffset=${n}, size=${i}`)),await r.download(t,(()=>e.HEAPU8.subarray(n,n+i)))}),((e,t,n)=>r.createKernel(e,t,n)),(e=>r.releaseKernel(e)),((t,n)=>{(0,o.LOG_DEBUG)("verbose",(()=>`[WebGPU] jsepRun: kernel=${t}, contextDataOffset=${n}`));const i=new c(e,r,n);return r.computeKernel(t,i)}))}}},4955:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LOG_DEBUG=t.LOG=void 0;const n=r(8453),i=r(7917),o=["V","I","W","E","F"];t.LOG=(e,t)=>{const r=(0,i.logLevelStringToEnum)(e);var s,a;r>=(0,i.logLevelStringToEnum)(n.env.logLevel)&&(s=r,a="function"==typeof t?t():t,console.log(`[${o[s]},${(new Date).toISOString()}]${a}`))},t.LOG_DEBUG=(...e)=>{n.env.debug&&(0,t.LOG)(...e)}},6952:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_CLIP=t.MIN_CLIP=t.GemmUtil=t.PoolConvUtil=t.ShapeUtil=t.BroadcastUtil=t.MatMulUtil=void 0;class r{static calcMatMulShape(e,t){return e[1]!==t[0]?void 0:[e[0],t[1]]}}t.MatMulUtil=r;class n{static calcShape(e,t,n=!1){const i=e.length,o=t.length;if(0===i)return t;if(0===o)return e;const s=Math.max(e.length,t.length),a=new Array(s);if(n){if(i<2||o<2)return;const n=r.calcMatMulShape([e[i-2],e[i-1]],[t[o-2],t[o-1]]);if(void 0===n)return;[a[s-2],a[s-1]]=n}for(let r=n?3:1;r<=s;r++){const n=i-r<0?1:e[i-r],c=o-r<0?1:t[o-r];if(n!==c&&n>1&&c>1)return;a[s-r]=Math.max(n,c)}return a}static isValidBroadcast(e,t){const r=e.length,n=t.length;if(r>n)return!1;for(let i=1;i<=r;i++)if(1!==e[r-i]&&e[r-i]!==t[n-i])return!1;return!0}}t.BroadcastUtil=n;class i{static size(e){return i.getSizeFromDimensionRange(e,0,e.length)}static sizeFromDimension(e,t){if(t<0||t>e.length)throw new Error(`invalid dimension of ${t} for sizeFromDimension as Tensor has ${e.length} dimensions.`);return i.getSizeFromDimensionRange(e,t,e.length)}static sizeToDimension(e,t){if(t<0||t>e.length)throw new Error(`invalid dimension of ${t} for sizeToDimension as Tensor has ${e.length} dimensions.`);return i.getSizeFromDimensionRange(e,0,t)}static getSizeFromDimensionRange(e,t,r){let n=1;for(let i=t;i<r;i++){if(e[i]<=0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains 0 or negative values in them.");n*=e[i]}return n}static computeStrides(e){const t=e.length;if(0===t)return[];if(1===t)return[1];const r=new Array(t);r[t-1]=1,r[t-2]=e[t-1];for(let n=t-3;n>=0;--n)r[n]=r[n+1]*e[n+1];return r}static normalizeAxis(e,t){if(e<-t&&e>=t)throw new Error("unsupported axis for this operation.");return e<0?e+t:e}static normalizeAxes(e,t){return e.map((r=>this.normalizeAxis(r,null!=t?t:e.length)))}static sortBasedOnPerm(e,t){return t?t.map((t=>e[t])):e.slice().reverse()}static padShape(e,t){const r=e.length;return e.map(((e,n)=>e+t[n]+t[n+r]))}static areEqual(e,t){return e.length===t.length&&e.every(((e,r)=>e===t[r]))}}t.ShapeUtil=i;class o{static adjustPoolAttributes(e,t,r,n,i,o){if(!e&&r.length!==t.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(e)for(let e=0;e<t.length-2;e++)e>=r.length?r.push(t[e+2]):r[e]=t[e+2];for(let e=0;e<r.length;e++)if(e<n.length){if(n[e]<0)throw new Error("strides should be greater than or equal to 1")}else n.push(1);for(let e=0;e<r.length;e++)if(e<i.length){if(i[e]<0)throw new Error("dilations should be greater than or equal to 1")}else i.push(1);for(let e=0;e<2*r.length;e++)if(e<o.length){if(o[e]<0)throw new Error("pad should be greater than or equal to 1")}else o.push(0);for(let e=0;e<r.length;e++){if(r[e]<=0)throw new Error("kernel shapes need to be greater than 0");if(o[e]>=r[e]||o[e+r.length]>=r[e])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(e,t,r,n,i,s,a){if(a){if(i.length!==2*(e.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(t.length!==e.length-2)throw new Error("length of strides should be the length of data dimensions");if(n.length!==e.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let c=0;c<e.length-2;c++)o.adjustPadAndReturnShape(e[c+(s?1:2)],t[c],r[c],n[c],i,c,c+e.length-2,a)}}static computePoolOutputShape(e,t,r,n,i,s,a){if(t.length<=0)throw new Error("input shape must be of size greater than 0");const c=[t[0],t[1]];return o.computeShapeHelper(e,t,c,r,n,i,s,a),c}static computeConvOutputShape(e,t,r,n,i,s,a){if(e.length<=0||t.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");const c=[e[0],t[0]];return o.computeShapeHelper(!1,e,c,r,n,i,s,a),c}static computeShapeHelper(e,t,r,n,i,s,a,c){if(e)for(let e=0;e<t.length-2;e++)r.push(1);else for(let e=0;e<t.length-2;e++)r.push(o.adjustPadAndReturnShape(t[e+2],n[e],i[e],s[e],a,e,e+t.length-2,c))}static adjustPadAndReturnShape(e,t,r,n,i,o,s,a){const c=r*(n-1)+1;if(!a||"NOTSET"===a)return Math.floor((e+i[o]+i[s]-c)/t+1);switch(a){case"VALID":return i[o]=0,i[s]=0,Math.floor((e-c)/t+1);case"SAME_LOWER":case"SAME_UPPER":if(1!==r)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{const r=((e+t-1)/t-1)*t+n-e;return i[o]="SAME_LOWER"===a?Math.floor((r+1)/2):Math.floor(r/2),i[s]=r-i[o],Math.floor((e+r-n)/t+1)}default:throw new Error("Unsupported AutoPad type")}}}t.PoolConvUtil=o,t.GemmUtil=class{static getShapeOfGemmResult(e,t,r,i,o){if(2!==e.length||2!==r.length)throw new Error("shape need to be of size 2");let s,a,c;t?(s=e[1],a=e[0]):(s=e[0],a=e[1]);let u=-1;if(i?(c=r[0],u=1):(c=r[1],u=0),r[u]!==a)throw new Error("dimension mismatch");if(s<=0||c<=0||a<=0)throw new Error("invalid shape specified");if(o&&!n.isValidBroadcast(o,[s,c]))throw new Error("gemm: invalid bias shape for broadcast");return[s,c,a]}},t.MIN_CLIP=-34028234663852886e22,t.MAX_CLIP=34028234663852886e22},387:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createAttributeWithCacheKey=void 0;class r{constructor(e){Object.assign(this,e)}get cacheKey(){return this._cacheKey||(this._cacheKey=Object.getOwnPropertyNames(this).sort().map((e=>`${this[e]}`)).join(";")),this._cacheKey}}t.createAttributeWithCacheKey=e=>new r(e)},7771:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createGpuDataManager=void 0;const n=r(4955),i=r(1163),o=e=>16*Math.ceil(e/16);let s=0;class a{constructor(e){this.backend=e,this.storageCache=new Map,this.downloadCache=new Map,this.buffersForUploadingPending=[],this.buffersPending=[]}upload(e,t){const r=t.buffer,i=t.byteOffset,s=t.byteLength,a=o(s),c=this.storageCache.get(e);if(!c)throw new Error("gpu data for uploading does not exist");if(c.originalSize!==s)throw new Error(`inconsistent data size. gpu data size=${c.originalSize}, data size=${s}`);const u=this.backend.device.createBuffer({mappedAtCreation:!0,size:a,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),l=u.getMappedRange();new Uint8Array(l).set(new Uint8Array(r,i,s)),u.unmap();const d=this.backend.getCommandEncoder();this.backend.endComputePass(),d.copyBufferToBuffer(u,0,c.gpuData.buffer,0,a),(0,n.LOG_DEBUG)("verbose",(()=>`[WebGPU] GpuDataManager.upload(id=${e})`)),this.buffersForUploadingPending.push(u)}memcpy(e,t){const r=this.storageCache.get(e);if(!r)throw new Error("source gpu data for memcpy does not exist");const n=this.storageCache.get(t);if(!n)throw new Error("destination gpu data for memcpy does not exist");if(r.originalSize!==n.originalSize)throw new Error("inconsistent source and destination gpu data size");const i=o(r.originalSize);this.backend.getCommandEncoder().copyBufferToBuffer(r.gpuData.buffer,0,n.gpuData.buffer,0,i)}create(e,t=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST){const r=o(e),a=this.backend.device.createBuffer({size:r,usage:t}),c={id:s++,type:i.GpuDataType.default,buffer:a};return this.storageCache.set(c.id,{gpuData:c,originalSize:e}),(0,n.LOG_DEBUG)("verbose",(()=>`[WebGPU] GpuDataManager.create(size=${e}) => id=${c.id}`)),c}get(e){var t;return null===(t=this.storageCache.get(e))||void 0===t?void 0:t.gpuData}release(e){const t=this.storageCache.get(e);if(!t)throw new Error("releasing data does not exist");return(0,n.LOG_DEBUG)("verbose",(()=>`[WebGPU] GpuDataManager.release(id=${e}), gpuDataId=${t.gpuData.id}`)),this.storageCache.delete(e),this.buffersPending.push(t.gpuData.buffer),this.downloadCache.get(e)&&this.downloadCache.delete(e),t.originalSize}async download(e){const t=this.downloadCache.get(e);if(t)return t.data;const r=this.storageCache.get(e);if(!r)throw new Error("data does not exist");const n=this.backend.getCommandEncoder();this.backend.endComputePass();const i=this.backend.device.createBuffer({size:r.originalSize,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});n.copyBufferToBuffer(r.gpuData.buffer,0,i,0,r.originalSize),this.backend.flush();const o=new Promise((e=>{i.mapAsync(GPUMapMode.READ).then((()=>{const t=i.getMappedRange().slice(0);i.destroy(),e(t)}))}));return this.downloadCache.set(e,{data:o}),o}refreshPendingBuffers(){for(const e of this.buffersForUploadingPending)e.destroy();for(const e of this.buffersPending)e.destroy()}}t.createGpuDataManager=(...e)=>new a(...e)},8510:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.WEBGPU_OP_RESOLVE_RULES=void 0;const s=o(r(504)),a=r(9770),c=r(4271),u=r(1522),l=o(r(5262)),d=r(2625),h=o(r(9302));t.WEBGPU_OP_RESOLVE_RULES=new Map([["Abs",[h.abs]],["Acos",[h.acos]],["Acosh",[h.acosh]],["Add",[s.add]],["Asin",[h.asin]],["Asinh",[h.asinh]],["Atan",[h.atan]],["Atanh",[h.atanh]],["AveragePool",[l.averagePool,l.parseAveragePoolAttributes]],["Ceil",[h.ceil]],["ClipV10",[h.clipV10]],["Clip",[h.clip]],["Conv",[a.conv,a.parseConvAttributes]],["Cos",[h.cos]],["Cosh",[h.cosh]],["Div",[s.div]],["Elu",[h.elu,h.parseAlphaAttributes]],["Erf",[h.erf]],["Exp",[h.exp]],["Floor",[h.floor]],["Gemm",[c.gemm,c.parseGemmAttributes]],["GlobalAveragePool",[l.globalAveragePool,l.parseGlobalAveragePoolAttributes]],["GlobalMaxPool",[l.globalMaxPool,l.parseGlobalMaxPoolAttributes]],["LeakyRelu",[h.leakyRelu,h.parseAlphaAttributes]],["MatMul",[u.matMul]],["MaxPool",[l.maxPool,l.parseMaxPoolAttributes]],["Mul",[s.mul]],["Neg",[h.neg]],["Pow",[s.pow]],["Reciprocal",[h.reciprocal]],["Relu",[h.relu]],["Sigmoid",[h.sigmoid]],["Sin",[h.sin]],["Sinh",[h.sinh]],["Sqrt",[h.sqrt]],["Sub",[s.sub]],["Tan",[h.tan]],["Tanh",[h.tanh]],["ThresholdedRelu",[h.thresholdedRelu,h.parseAlphaAttributes]],["Transpose",[d.transpose,d.parseTransposeAttributes]]])},1427:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.biasActivationSnippet=t.activationFnSnippet=t.typeSnippet=void 0,t.typeSnippet=e=>{switch(e){case 1:return"f32";case 2:return"vec2<f32>";case 3:return"vec3<f32>";case 4:return"vec4<f32>";default:throw new Error(`${e}-component is not supported.`)}},t.activationFnSnippet=(e,t=!1,r=!1,n=3)=>"",t.biasActivationSnippet=(e,t)=>`\n      ${e?"value = value + getBiasByOutputCoords(coords);":""}\n      ${t?"value = activation(value, coords);":""}\n      `},9456:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createConv2DMatMulProgramInfo=void 0;const n=r(4955),i=r(6952),o=r(1163),s=r(1427),a=r(4085),c=r(158);t.createConv2DMatMulProgramInfo=(e,t,r,u,l,d,h,f,p)=>{const m="NHWC"===r.format,g=m?e[0].dims[3]:e[0].dims[1],v=u[0],y=m?u[2]:u[3],b=m?u[1]:u[2],E=m?u[3]:u[1],w=((g%4==0||g%3==0)&&m||y%4==0&&!m)&&E%4==0,S=m?E:y*b,_=m?y*b:E,T=w?[8,8,1]:[S<=4?4:16,S>4&&_<=4?4:16,1],x=w?[4,4,1]:[S<=4?1:2,S>4&&_<=4?1:2,1],A=[Math.ceil(S/T[0]/x[0]),Math.ceil(_/T[1]/x[1]),Math.ceil(v/T[2]/x[1])];(0,n.LOG_DEBUG)("verbose",(()=>`[conv2d_mm_webgpu] dispatch = ${A}`));const I=w?m&&g%4!=0?3:4:x[0],C=T[1]*x[1],R=T[0]*x[0],k=Math.max(T[0]*I,T[1]),O=l%C==0,N=d%R==0,P=h%k==0,L=w?[I,4,4]:[1,1,1],D=[`@group(0) @binding(0) var<storage, read> x: array<${w&&4===I?"vec4<f32>":"f32"}>;`,`@group(0) @binding(1) var<storage, read> w: array<${w?"vec4<f32>":"f32"}>;`];let M=`\n      fn setOutputAtIndex(flatIndex : i32, value : ${w?"vec4<f32>":"f32"}) {\n        result[flatIndex] = ${w?"vec4<f32>":"f32"}(value);\n      }\n      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ${w?"vec4<f32>":"f32"}) {\n        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));\n        setOutputAtIndex(flatIndex ${w?"/ 4":""}, value);\n      }`;return f&&(D.push(`@group(0) @binding(2) var<storage, read> bias: array<${w?"vec4<f32>":"f32"}>;`),M+=`\n        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${w?"vec4<f32>":"f32"} {\n          return bias[coords.${m?"w":"y"}${w?"/ 4":""}];\n        }`),Object.assign(Object.assign({},t),{outputs:[{dims:u,dataType:e[0].dataType,gpuDataType:o.GpuDataType.default}],dispatchGroup:()=>({x:A[0],y:A[1],z:A[2]}),getShaderSource:()=>`\n        ${a.utilFunctions}\n        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,\n        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,\n        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };\n        ${D.join("")}\n        @group(0) @binding(${D.length}) var<storage, read_write> result: array<${w?"vec4<f32>":"f32"}>;\n        //@group(0) @binding(${D.length+1}) var<uniform> uniforms: Uniforms;\n\n        const xShape : vec4<i32> = vec4<i32>(${e[0].dims.join(",")});\n        const wShape : vec4<i32> = vec4<i32>(${e[1].dims.join(",")});\n        const outShape : vec4<i32> = vec4<i32>(${u.join(",")});\n        const outShapeStrides : vec3<i32> = vec3<i32>(${i.ShapeUtil.computeStrides(u).slice(0,3).join(",")});\n        const filterDims : vec2<i32> = vec2<i32>(${r.kernelShape[0]}, ${r.kernelShape[1]});\n        const pad : vec2<i32> = vec2<i32>(${r.pads[0]}, ${r.pads[1]});\n        const stride : vec2<i32> = vec2<i32>(${r.strides[0]}, ${r.strides[1]});\n        const dilation : vec2<i32> = vec2<i32>(${r.dilations[0]}, ${r.dilations[1]});\n        const dimAOuter : i32 = ${l};\n        const dimBOuter : i32 = ${d};\n        const dimInner : i32 = ${h};\n        ${M}\n        ${((e,t,r,n,i=!1,o,a=!1,c=4,u=4,l=4)=>{const d=e?"\n    let coord = vec4<i32>(batch, xRow, xCol, xCh);\n    ":"\n    let coord = vec4<i32>(batch, xCh, xRow, xCol);\n    ",h=e?"\n    let coords = vec4<i32>(\n      batch,\n      row / outWidth,\n      row % outWidth,\n      col);\n    ":"\n    let coords = vec4<i32>(\n      batch,\n      row,\n      col / outWidth,\n      col % outWidth);\n    ",f=e?"xShape[1]":"xShape[2]",p=e?"xShape[2]":"xShape[3]",m=e?"row":"col",g=e?"col":"row",v=`\n    let inChannels = wShape[2];\n    let outWidth = ${e?"outShape[2]":"outShape[3]"};\n    let outRow = ${m} / outWidth;\n    let outCol = ${m} % outWidth;\n\n    let WRow = ${g} / (filterDims[1] * inChannels);\n    let WCol = ${g} / inChannels % filterDims[1];\n    let xRow = outRow * stride[0] + dilation[0] * WRow - pad[0];\n    let xCol = outCol * stride[1] + dilation[1] * WCol - pad[1];\n    let xCh = ${g} % inChannels;\n    var resData = ${(0,s.typeSnippet)(c)}(0.0);\n    // The bounds checking is always needed since we use it to pad zero for\n    // the 'same' padding type.\n    if (xRow >= 0 && xRow < ${f} && xCol >= 0 && xCol < ${p}) {\n      ${d}\n      let xIndex = getIndexFromCoords4D(coord, xShape);\n      ${(e=>{switch(e){case 1:return"resData = x[xIndex];";case 3:return"resData = vec3<f32>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);";case 4:return"resData = x[xIndex / 4];";default:throw new Error(`innerElementSize ${e} is not supported.`)}})(c)}\n    }\n    return resData;`,y=e?t&&n?`\n    let col = colIn * ${c};\n    ${v}`:`\n    let col = colIn * ${c};\n    if (row < dimAOuter && col < dimInner) {\n      ${v}\n    }\n    return ${(0,s.typeSnippet)(c)}(0.0);`:n&&r?`\n    let col = colIn * ${c};\n    ${v}`:`\n    let col = colIn * ${c};\n    if (row < dimInner && col < dimBOuter) {\n      ${v}\n    }\n    return ${(0,s.typeSnippet)(c)}(0.0);`,b=`${(e=>{switch(e){case 1:return"return w[row * wShape[3] + colIn];";case 4:return"return w[row * wShape[3] / 4 + colIn];";default:throw new Error(`innerElementSize ${e} is not supported.`)}})(u)}`,E=(0,s.typeSnippet)(l),w=e?(0,s.typeSnippet)(c):(0,s.typeSnippet)(u),S=e?(0,s.typeSnippet)(u):(0,s.typeSnippet)(c);return`\n    ${(0,s.activationFnSnippet)(o,a,4===l,4)}\n    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${w} {\n      ${e?y:b}\n    }\n\n    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${S} {\n      ${e?b:y}\n    }\n\n    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ${E}) {\n      let col = colIn * ${l};\n      if (row < dimAOuter && col < dimBOuter)\n      {\n      var value = valueIn;\n      let outWidth = ${e?"outShape[2]":"outShape[3]"};\n      ${h}\n      ${(0,s.biasActivationSnippet)(i,o)}\n      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);\n      }\n    }`})(m,O,N,P,f,void 0,!1,L[0],L[1],L[2])}\n            ${w?(0,c.makeMatMulPackedVec4Source)(x,T,!m,k):(0,c.makeMatMulPackedSource)(x,T,!m,k,!1,void 0,p)}`})}},4085:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.utilFunctions=void 0,t.utilFunctions="\nfn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {\n  return dot(coords, vec4<i32>(\n      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));\n}\nfn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {\n  return dot(coords, vec4<i32>(\n    outShapeStrides.x, outShapeStrides.y, outShapeStrides.z, 1));\n}\n"},158:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeMatMulPackedSource=t.makeMatMulPackedVec4Source=void 0,t.makeMatMulPackedVec4Source=(e,t,r=!1,n=32,i=!1,o=32,s=!1)=>{const a=t[1]*e[1],c=t[0]*e[0],u=r?a:n,l=r?n:a,d=u/t[0],h=n/t[1];if((!r||4!==d||4!==e[1])&&(r||3!==d&&4!==d)||u%t[0]!=0||n%t[1]!=0||4!==e[0])throw new Error(`If transposeA ${r} is true, innerElementSize ${d} and workPerThread[1] ${e[1]} must be 4.\n      Otherwise, innerElementSize ${d} must be 3 or 4.\n  tileAWidth ${u} must be divisible by workgroupSize[0]${t[0]}. tileInner ${n} must be divisible by workgroupSize[1] ${t[1]}. colPerThread ${e[0]} must be 4.`);return`\nvar<workgroup> mm_Asub : array<array<vec${d}<f32>, ${u/d}>, ${l}>;\nvar<workgroup> mm_Bsub : array<array<vec4<f32>, ${c/e[0]}>, ${n}>;\n\nconst rowPerThread = ${e[1]};\nconst colPerThread = ${e[0]};\nconst innerElementSize = ${d};\nconst tileInner = ${n};\n\n@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})\nfn main(@builtin(local_invocation_id) localId : vec3<u32>,\n        @builtin(global_invocation_id) globalId : vec3<u32>,\n        @builtin(workgroup_id) workgroupId : vec3<u32>) {\n  let localRow = i32(localId.y);\n  let tileRow = ${s?"0":"localRow * rowPerThread"};\n  let tileCol = i32(localId.x);\n\n  let globalRow = ${s?"0":"i32(globalId.y) * rowPerThread"};\n  let globalCol = i32(globalId.x);\n  let batch = ${i?"0":"i32(globalId.z)"};\n  let globalRowStart = i32(workgroupId.y) * ${a};\n\n  let numTiles = ${i?`${Math.ceil(o/n)}`:"(dimInner - 1) / tileInner + 1"};\n  var kStart = ${i?`i32(globalId.z) * ${o}`:"0"};\n\n  var acc: array<vec4<f32>, rowPerThread>;\n\n  // Loop over shared dimension.\n  let tileRowB = localRow * ${h};\n  for (var t = 0; t < numTiles; t = t + 1) {\n      // Load one tile of A into local memory.\n      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n          let inputRow = tileRow + innerRow;\n          let inputCol = tileCol;\n          ${f=r,f?"\n        mm_Asub[inputRow][inputCol] = mm_readA(batch,\n          kStart + inputRow,\n          globalRowStart / innerElementSize + inputCol);\n        ":"\n        mm_Asub[inputRow][inputCol] = mm_readA(batch,\n          globalRow + innerRow,\n          kStart / innerElementSize + inputCol);\n        "}\n      }\n\n      // Load one tile of B into local memory.\n      for (var innerRow = 0; innerRow < ${h}; innerRow = innerRow + 1) {\n          let inputRow = tileRowB + innerRow;\n          let inputCol = tileCol;\n          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol);\n      }\n      kStart = kStart + tileInner;\n      workgroupBarrier();\n\n      // Compute acc values for a single thread.\n      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {\n          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];\n          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];\n          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];\n          ${3===d?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];"}\n\n          ${((e,t)=>e?`\n        let ACached0 = mm_Asub[k * innerElementSize][localRow];\n        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];\n        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];\n        ${3===t?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];"}\n        for (var i = 0; i < rowPerThread; i = i + 1) {\n          acc[i] = BCached0 * ACached0[i] + acc[i];\n          acc[i] = BCached1 * ACached1[i] + acc[i];\n          acc[i] = BCached2 * ACached2[i] + acc[i];\n          ${3===t?"":"acc[i] = BCached3 * ACached3[i] + acc[i];"}\n        }`:`\n        for (var i = 0; i < rowPerThread; i = i + 1) {\n          let ACached = mm_Asub[tileRow + i][k];\n          acc[i] = BCached0 * ACached.x + acc[i];\n          acc[i] = BCached1 * ACached.y + acc[i];\n          acc[i] = BCached2 * ACached.z + acc[i];\n          ${3===t?"":"acc[i] = BCached3 * ACached.w + acc[i];"}\n        }`)(r,d)}\n      }\n\n      workgroupBarrier();\n  }\n\n  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);\n  }\n}`;var f};const r=e=>e?"\n            mm_Asub[inputRow][inputCol] = mm_readA(batch,\n              kStart + inputRow,\n              globalRowStart + inputCol);\n            ":"\n            mm_Asub[inputRow][inputCol] = mm_readA(batch,\n              globalRowStart + inputRow,\n              kStart + inputCol);\n            ";t.makeMatMulPackedSource=(e,t,n=!1,i=32,o=!1,s=32,a=!1)=>{const c=e[1]*t[1],u=e[0]*t[0],l=n?c:i,d=n?i:c;if(d%t[1]!=0||l%t[0]!=0||i%t[1]!=0)throw new Error(`tileAHight ${d} must be divisible by workgroupSize[1]${t[1]}, tileAWidth ${l} must be divisible by workgroupSize[0]${t[0]}, tileInner ${i} must be divisible by workgroupSize[1]${t[1]}`);const h=d/t[1],f=l/t[0],p=i/t[1],m=a?`\n    let localRow = i32(localId.y);\n    let localCol = i32(localId.x);\n    let globalRowStart = i32(workgroupId.y) * ${c};\n    let globalColStart = i32(workgroupId.x) * ${u};\n\n    // Loop over shared dimension.\n    for (var t = 0; t < numTiles; t = t + 1) {\n      // Load one tile of A into local memory.\n      for (var inputRow = localRow; inputRow < ${d}; inputRow = inputRow + ${t[1]}) {\n        for (var inputCol = localCol; inputCol < ${l}; inputCol = inputCol + ${t[0]}) {\n          ${r(n)}\n        }\n      }\n      // Load one tile of B into local memory.\n      for (var inputRow = localRow; inputRow < ${i}; inputRow = inputRow + ${t[1]}) {\n            for (var inputCol = localCol; inputCol < ${u}; inputCol = inputCol + ${t[0]}) {\n          mm_Bsub[inputRow][inputCol] = mm_readB(batch,\n            kStart + inputRow,\n            globalColStart + inputCol);\n        }\n      }\n      kStart = kStart + tileInner;\n      workgroupBarrier();\n\n      // Compute acc values for a single thread.\n      var BCached : array<f32, colPerThread>;\n      for (var k = 0; k < tileInner; k = k + 1) {\n        for (var inner = 0; inner < colPerThread; inner = inner + 1) {\n          BCached[inner] = mm_Bsub[k][localCol + inner * ${t[0]}];\n        }\n        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n          let ACached = ${n?`mm_Asub[k][localRow + innerRow * ${t[1]}];`:`mm_Asub[localRow + innerRow * ${t[1]}][k];`}\n          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n            acc[innerRow][innerCol] = acc[innerRow][innerCol] +\n                ACached * BCached[innerCol];\n          }\n        }\n      }\n      workgroupBarrier();\n    }\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      let gRow = globalRowStart + localRow + innerRow * ${t[1]};\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        let gCol = globalColStart + localCol + innerCol * ${t[0]};\n        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);\n      }\n    }\n    `:`\nlet tileRow = i32(localId.y) * rowPerThread;\nlet tileCol = i32(localId.x) * colPerThread;\n\nlet globalRow = i32(globalId.y) * rowPerThread;\nlet globalCol = i32(globalId.x) * colPerThread;\nlet globalRowStart = i32(workgroupId.y) * ${c};\n\nlet tileRowA = i32(localId.y) * ${h};\nlet tileColA = i32(localId.x) * ${f};\nlet tileRowB = i32(localId.y) * ${p};\n// Loop over shared dimension.\nfor (var t = 0; t < numTiles; t = t + 1) {\n  // Load one tile of A into local memory.\n  for (var innerRow = 0; innerRow < ${h}; innerRow = innerRow + 1) {\n    for (var innerCol = 0; innerCol < ${f}; innerCol = innerCol + 1) {\n      let inputRow = tileRowA + innerRow;\n      let inputCol = tileColA + innerCol;\n      ${r(n)}\n    }\n  }\n\n  // Load one tile of B into local memory.\n  for (var innerRow = 0; innerRow < ${p}; innerRow = innerRow + 1) {\n    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n      let inputRow = tileRowB + innerRow;\n      let inputCol = tileCol + innerCol;\n      mm_Bsub[inputRow][inputCol] = mm_readB(batch,\n        kStart + inputRow,\n        globalCol + innerCol);\n    }\n  }\n  kStart = kStart + tileInner;\n  workgroupBarrier();\n\n  // Compute acc values for a single thread.\n  var BCached : array<f32, colPerThread>;\n  for (var k = 0; k < tileInner; k = k + 1) {\n    for (var inner = 0; inner < colPerThread; inner = inner + 1) {\n      BCached[inner] = mm_Bsub[k][tileCol + inner];\n    }\n\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      ${(e=>e?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];")(n)}\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];\n      }\n    }\n  }\n\n  workgroupBarrier();\n}\n\nfor (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n    mm_write(batch, globalRow + innerRow, globalCol + innerCol,\n        acc[innerRow][innerCol]);\n  }\n}\n`;return`\n  var<workgroup> mm_Asub : array<array<f32, ${l}>, ${d}>;\n  var<workgroup> mm_Bsub : array<array<f32, ${u}>, ${i}>;\n  const rowPerThread = ${e[1]};\n  const colPerThread = ${e[0]};\n  const tileInner = ${i};\n\n@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})\nfn main(@builtin(local_invocation_id) localId : vec3<u32>,\n        @builtin(global_invocation_id) globalId : vec3<u32>,\n        @builtin(workgroup_id) workgroupId : vec3<u32>) {\n    let batch = ${o?"0":"i32(globalId.z)"};\n    let numTiles = ${o?`${Math.ceil(s/i)}`:"(dimInner - 1) / tileInner + 1"};\n    var kStart = ${o?`i32(globalId.z) * ${s}`:"0"};\n\n    var acc : array<array<f32, colPerThread>, rowPerThread>;\n\n    // Without this initialization strange values show up in acc.\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        acc[innerRow][innerCol] = 0.0;\n      }\n    }\n    ${m}\n  }\n`}},504:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.pow=t.mul=t.div=t.add=void 0;const n=r(6952),i=r(1163),o=r(2075),s=(e,t,r,s,a)=>{const c={name:t,inputTypes:[i.GpuDataType.default,i.GpuDataType.default],cacheHint:a};return Object.assign(Object.assign({},c),{get:()=>((e,t,r,s,a,c=t.dataType)=>{var u,l;const d=!n.ShapeUtil.areEqual(t.dims,r.dims);let h=t.dims,f=n.ShapeUtil.size(t.dims),p=!1;if(d){const e=n.BroadcastUtil.calcShape(t.dims,r.dims,!1);if(!e)throw new Error("Can't perform binary op on the given tensors");h=e,f=n.ShapeUtil.size(h);let i=1;for(let e=0;e<h.length;e++){const n=null!==(u=t.dims[t.dims.length-e])&&void 0!==u?u:1;if(n!==(null!==(l=r.dims[r.dims.length-e])&&void 0!==l?l:1))break;i*=n}i%4==0&&(p=!0)}else p=!0;return Object.assign(Object.assign({},e),{getShaderSource:e=>((e,t,r,i,s,a,c,u,l="f32",d="f32",h="f32")=>{const f=n.ShapeUtil.size(i),p=Math.ceil(f/4);let m,g;"string"==typeof c?m=g=(e,t)=>`${c}((${e}),(${t}))`:"function"==typeof c?m=g=c:(m=c.scalar,g=c.vector);let v="";const y=(0,o.createIndicesHelper)("output",i);if(a){const e=e=>{const t=n.ShapeUtil.computeStrides(e),r=[];for(let n=e.length-1;n>=0;n--){const o=0===i.length?"0u":1===i.length?"(*outputIndices)":`(*outputIndices)[${n+i.length-e.length}]`;r.push(`${t[n]}u * (${o} % ${e[n]}u)`)}return r.length>0?r.join("+"):"0u"};v=`\n  ${y.o2iImpl}\n\n  fn calcOffsetA(outputIndices: ptr<function, ${y.iType}>) -> u32 {\n    return ${e(t)};\n  }\n\n  fn calcOffsetB(outputIndices: ptr<function, ${y.iType}>) -> u32 {\n    return ${e(r)};\n  }\n  `}let b;if(s)b=a?`\n      ${y.indicesVariableDeclaration("outputIndices")}\n      ${y.o2iCall("global_idx * 4u","outputIndices")}\n      let offsetA = calcOffsetA(&outputIndices);\n      let offsetB = calcOffsetB(&outputIndices);\n      outputData[global_idx] = ${g("aData[offsetA / 4u]","bData[offsetB / 4u]")};`:`outputData[global_idx] = ${g("aData[global_idx]","bData[global_idx]")};`;else{if(!a)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");const e=e=>{const t=`aData[indexA${e}][componentA${e}]`,r=`bData[indexB${e}][componentB${e}]`;return`\n      ${y.o2iCall(`global_idx * 4u + ${e}u`,"outputIndices")}\n      let offsetA${e} = calcOffsetA(&outputIndices);\n      let offsetB${e} = calcOffsetB(&outputIndices);\n      let indexA${e} = offsetA${e} / 4u;\n      let indexB${e} = offsetB${e} / 4u;\n      let componentA${e} = offsetA${e} % 4u;\n      let componentB${e} = offsetB${e} % 4u;\n      outputData[global_idx][${e}] = ${m(t,r)};`};b=`\n      ${y.indicesVariableDeclaration("outputIndices")}\n      ${e(0)}\n      ${e(1)}\n      ${e(2)}\n      ${e(3)}`}return`\n  @group(0) @binding(0) var<storage, read> aData : array<vec4<${l}>>;\n  @group(0) @binding(1) var<storage, read> bData : array<vec4<${d}>>;\n  @group(0) @binding(2) var<storage, read_write> outputData : array<vec4<${h}>>;\n\n  ${null!=u?u:""}\n  ${v}\n\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes(p)}\n    ${b}\n  }`})(e,t.dims,r.dims,h,p,d,s,a),outputs:[{dims:h,dataType:c,gpuDataType:i.GpuDataType.default}],dispatchGroup:()=>({x:Math.ceil(f/64/(p?4:1))})})})(c,e[0],e[1],r,s)})};t.add=e=>{e.compute(s(e.inputs,"Add",((e,t)=>`${e}+${t}`)))},t.div=e=>{e.compute(s(e.inputs,"Div",((e,t)=>`${e}/${t}`)))},t.mul=e=>{e.compute(s(e.inputs,"Mul",((e,t)=>`${e}*${t}`)))},t.pow=e=>{e.compute(s(e.inputs,"Pow",{scalar:(e,t)=>`pow_f32(${e},${t})`,vector:(e,t)=>`pow_vf32(${e},${t})`},"\n    fn pow_f32(a : f32, b : f32) -> f32 {\n      if (b == 0.0) {\n        return 1.0;\n      } else if (a < 0.0 && b != floor(b)) {\n        return pow(a, b); // NaN\n      }\n      return select(sign(a), 1.0, round(abs(b) % 2.0) != 1.0) * pow(abs(a), b);\n    }\n    fn pow_vf32(a : vec4<f32>, b : vec4<f32>) -> vec4<f32> {\n      // TODO: implement vectorized pow\n      return vec4<f32>(pow_f32(a.x, b.x), pow_f32(a.y, b.y), pow_f32(a.z, b.z), pow_f32(a.w, b.w));\n    }\n      "))},t.sub=e=>{e.compute(s(e.inputs,"Sub",((e,t)=>`${e}-${t}`)))}},2075:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createShaderHelper=t.createIndicesHelper=t.WORKGROUP_SIZE=void 0;const n=r(6952);t.WORKGROUP_SIZE=64,t.createIndicesHelper=(e,t)=>{const r=t.length<2?"u32":`array<u32, ${t.length}>`,i=n.ShapeUtil.computeStrides(t);let o="";for(let e=0;e<t.length-1;e++)o+=`\n    let dim${e} = current / ${i[e]}u;\n    let rest${e} = current % ${i[e]}u;\n    (*indices)[${e}] = dim${e};\n    current = rest${e};\n    `;o+=`(*indices)[${t.length-1}] = current;`;const s=t.length<2?"":`\n  fn ih_o2i_${e}(offset: u32, indices: ptr<function, ${r}>) {\n    var current = offset;\n    ${o}\n  }`,a=[];if(0===t.length)a.push("0u");else if(t.length<2)a.push("(*indices)");else for(let e=t.length-1;e>=0;e--)a.push(`${i[e]}u * ((*indices)[${e}])`);return{o2iImpl:s,o2iCall:(r,n)=>t.length<2?`${n}=${r};`:`ih_o2i_${e}(${r}, &${n});`,i2oImpl:t.length<2?"":`\n  fn ih_i2o_${e}(indices: ptr<function, ${r}>) -> u32 {\n    return ${a.join("+")};\n  }`,i2oExpression:(r,n)=>t.length<2?`(${n?"*":""}${r})`:`ih_i2o_${e}(${n?"":"&"}${r})`,indicesVariableDeclaration:(e,t)=>`var ${e}:${r}${t?`=${r}(${t.join(",")})`:""};`,iType:r}};class i{constructor(e){this.normalizedDispatchGroup=e}guardAgainstOutOfBoundsWorkgroupSizes(e){return`if (global_idx >= ${"number"==typeof e?`${e}u`:e}) { return; }`}mainStart(e=t.WORKGROUP_SIZE){const r="number"==typeof e?e:e[0],n="number"==typeof e?1:e[1],i="number"==typeof e?1:e[2],o=1===this.normalizedDispatchGroup[1]&&1===this.normalizedDispatchGroup[2];return`@compute @workgroup_size(${r}, ${n}, ${i})\n  fn main(${o?"@builtin(global_invocation_id) global_id : vec3<u32>":"@builtin(local_invocation_index) local_index : u32,\n    @builtin(workgroup_id) workgroup_id : vec3<u32>"}) {\n    ${o?"let global_idx = global_id.x;":`let global_idx = (workgroup_id.z * ${this.normalizedDispatchGroup[0]*this.normalizedDispatchGroup[1]}u +\n          workgroup_id.y * ${this.normalizedDispatchGroup[0]}u + workgroup_id.x) * ${r*n*i}u + local_index;`}\n  `}}t.createShaderHelper=e=>new i(e)},9192:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createGroupedConvProgramInfoLoader=void 0;const n=r(6952),i=r(1163),o=r(2075),s=r(9770),a=r(3997);t.createGroupedConvProgramInfoLoader=(e,t,r)=>{const c=(u=e.length>2,l=t.cacheKey,{name:"GroupedConv",inputTypes:u?[i.GpuDataType.default,i.GpuDataType.default,i.GpuDataType.default]:[i.GpuDataType.default,i.GpuDataType.default],cacheHint:l});var u,l;return Object.assign(Object.assign({},c),{get:()=>((e,t,r,c)=>{const u=e.length>2,l=u?"value += b[output_channel];":"",d=e[0].dims,h=e[1].dims,f=h[0]/r.group,p="f32",{activationFunction:m,applyActivation:g}=(0,a.getActicationSnippet)(r),v=[`@group(0) @binding(0) var<storage, read> x : array<${p}>;`,`@group(0) @binding(1) var<storage, read> w : array<${p}>;`];u&&v.push(`@group(0) @binding(2) var<storage, read> b : array<${p}>;`);const y="NHWC"===r.format,b=(0,s.calculateOutputShape)(d,h,r.dilations,r.pads,r.strides,y),E=n.ShapeUtil.size(b),w=(0,o.createIndicesHelper)("output",b),S=(0,o.createIndicesHelper)("x",d),_=(0,o.createIndicesHelper)("w",h);return Object.assign(Object.assign({},t),{outputs:[{dims:c?c(b):b,dataType:e[0].dataType,gpuDataType:i.GpuDataType.default}],getShaderSource:e=>`\n  const strides: vec2<u32> = vec2(${r.strides[0]}u, ${r.strides[1]}u);\n  const pads: vec2<u32> = vec2(${r.pads[0]}u, ${r.pads[1]}u);\n\n  ${v.join("\n")}\n  @group(0) @binding(${v.length}) var<storage, read_write> output : array<${p}>;\n\n  ${m}\n  ${w.o2iImpl}\n  ${S.i2oImpl}\n  ${_.i2oImpl}\n\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes(E)}\n\n    ${w.indicesVariableDeclaration("outputIndices")}\n    ${w.o2iCall("global_idx","outputIndices")}\n    let batch: u32 = outputIndices[0];\n    let output_channel: u32 = outputIndices[${y?3:1}];\n    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[${y?1:2}], outputIndices[${y?2:3}]) * strides - pads;\n    let group_id: u32 = output_channel / ${f}u;\n\n    var value: ${p} = ${p}(0);\n    for (var wInChannel: u32 = 0u; wInChannel < ${h[1]}u; wInChannel++) {\n      let input_channel = group_id * ${h[1]}u + wInChannel;\n      for (var wHeight: u32 = 0u; wHeight < ${h[2]}u; wHeight++) {\n        let xHeight = xRCCorner.x + wHeight * ${r.dilations[0]}u;\n\n        if (xHeight < 0u || xHeight >= ${d[y?1:2]}u) {\n          continue;\n        }\n\n        for (var wWidth: u32 = 0u; wWidth < ${h[3]}u; wWidth++) {\n          let xWidth = xRCCorner.y + wWidth * ${r.dilations[1]}u;\n          if (xWidth < 0u || xWidth >= ${d[y?2:3]}u) {\n            continue;\n          }\n\n          ${S.indicesVariableDeclaration("xIndices",y?["batch","xHeight","xWidth","input_channel"]:["batch","input_channel","xHeight","xWidth"])}\n          let xVal = x[${S.i2oExpression("xIndices")}];\n          ${_.indicesVariableDeclaration("wIndices",["output_channel","wInChannel","wHeight","wWidth"])}\n          let wVal = w[${_.i2oExpression("wIndices")}];\n          value += xVal*wVal;\n        }\n      }\n    }\n    ${l}\n    ${g}\n    output[global_idx] = value;\n  }`,dispatchGroup:()=>({x:Math.ceil(E/64)})})})(e,c,t,r)})}},9770:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.conv=t.parseConvAttributes=t.calculateOutputShape=void 0;const n=r(6952),i=r(387),o=r(9192),s=r(3822),a=r(3997),c=r(2625);t.calculateOutputShape=(e,t,r,n,i,o)=>{const s=e[0],a=e.slice(o?1:2,o?3:4),c=a.length,u=t[0],l=t.slice(2).map(((e,t)=>e+(e-1)*(r[t]-1))),d=a.map(((e,t)=>e+n[t]+n[t+c])).map(((e,t)=>Math.floor((e-l[t]+i[t])/i[t])));return d.splice(0,0,s),d.splice(o?3:1,0,u),d};const u=(0,i.createAttributeWithCacheKey)({perm:[2,3,1,0]}),l=(e,t)=>{const r=e.kernelShape.slice();for(let e=2;e<t[1].dims.length;++e)0===r[e-2]&&(r[e-2]=t[1].dims[e]);const i=e.pads.slice();n.PoolConvUtil.adjustPadsBasedOnAutoPad(t[0].dims,e.strides,e.dilations,r,i,"NHWC"===e.format,e.autoPad);const o=Object.assign({},e);return Object.assign(o,{kernelShape:r,pads:i,cacheKey:e.cacheKey}),o};t.parseConvAttributes=e=>{const t=(0,a.parseInternalActivationAttributes)(e),r=e.format,n=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],o=e.dilations,s=e.group,c=e.kernel_shape,u=e.pads,l=e.strides,d=e.w_is_const();return(0,i.createAttributeWithCacheKey)(Object.assign({autoPad:n,format:r,dilations:o,group:s,kernelShape:c,pads:u,strides:l,wIsConst:d},t))},t.conv=(e,r)=>{((e,t)=>{if(!e||2!==e.length&&3!==e.length)throw new Error("Conv requires 2 or 3 inputs");if(4!==e[0].dims.length&&3!==e[0].dims.length)throw new Error("currently only support conv 1D and 2D");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");if(e[0].dims["NHWC"===t.format?e[0].dims.length-1:1]!==e[1].dims[1]*t.group)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(3===e.length&&(1!==e[2].dims.length||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");const r=e[0].dims.length-2;if(t.dilations.length!==r)throw new Error(`dilations should be ${r}D`);if(t.strides.length!==r)throw new Error(`strides should be ${r}D`);if(t.pads.length!==2*r)throw new Error(`pads should be ${2*r}D`);if(0!==t.kernelShape.length&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(1!==e[0].dataType||1!==e[1].dataType)throw new Error("Conv input(X,W) should be float tensor");if(3===e.length&&1!==e[2].dataType)throw new Error("Conv input(bias) should be float tensor")})(e.inputs,r),3===e.inputs[0].dims.length?((e,t)=>{const r="NHWC"===t.format,n=[e.inputs[0].reshape(r?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];3===e.inputs.length&&n.push(e.inputs[2]);const i=[0,t.pads[0],0,t.pads[1]],s=[1].concat(t.strides),a=[1].concat(t.dilations),c=[1].concat(t.kernelShape),u=l(Object.assign(Object.assign({},t),{pads:i,strides:s,dilations:a,kernelShape:c}),n);e.compute((0,o.createGroupedConvProgramInfoLoader)(n,u,(e=>r?[e[0],e[2],e[3]]:[])))})(e,r):((e,r,n)=>{var i;const a=l(n,r),d=3===r.length,h="NHWC"===n.format,f=r[0].dims[h?1:2],p=r[0].dims[h?2:3],m=r[0].dims[h?3:1],g=r[1].dims[2],v=r[1].dims[3],y=(0,t.calculateOutputShape)(r[0].dims,r[1].dims,n.dilations,a.pads,n.strides,h),b=y[h?1:2],E=y[h?2:3],w=y[h?3:1];if(h&&g===f&&v===p&&"VALID"===n.autoPad||1===g&&1===v&&1===n.dilations[0]&&1===n.dilations[1]&&1===n.strides[0]&&1===n.strides[1]&&("SAME_UPPER"===n.autoPad||"SAME_LOWER"===n.autoPad||"VALID"===n.autoPad))return void e.compute((0,o.createGroupedConvProgramInfoLoader)(r,a));if(!h||1!==n.group)return void e.compute((0,o.createGroupedConvProgramInfoLoader)(r,a));const S=h?b*E:w,_=h?w:b*E,T=g*v*m,x=null!==(i=e.customData.wT)&&void 0!==i?i:e.compute(Object.assign(Object.assign({},c.transposeProgramMetadata),{cacheHint:u.cacheKey,get:()=>(0,c.createTransposeProgramInfo)(r[1],u.perm)}),{inputs:[1],outputs:[n.wIsConst?-2:-1]})[0];n.wIsConst&&!e.customData.wT&&(e.customData.wT=x);const A=[r[0],x];d&&(h||1!==r[2].dims.length?A.push(r[2]):A.push(r[2].reshape([r[2].dims[0],1,1]))),e.compute((0,s.createConv2DMatMulProgramInfoLoader)(A,a,y,S,_,T,d,!0),{inputs:A})})(e,e.inputs,r)}},3822:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createConv2DMatMulProgramInfoLoader=void 0;const n=r(1163),i=r(9456);t.createConv2DMatMulProgramInfoLoader=(e,t,r,o,s,a,c,u)=>{const l=((e,t)=>({name:"Conv2DMatMul",inputTypes:e?[n.GpuDataType.default,n.GpuDataType.default,n.GpuDataType.default]:[n.GpuDataType.default,n.GpuDataType.default],cacheHint:t}))(c,t.cacheKey);return Object.assign(Object.assign({},l),{get:()=>(0,i.createConv2DMatMulProgramInfo)(e,l,t,r,o,s,a,c,u)})}},3997:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseInternalActivationAttributes=t.getActicationSnippet=void 0;const n=r(6952);t.getActicationSnippet=e=>{switch(e.activation){case"Relu":return{activationFunction:"",applyActivation:"value = max(value, 0.0);"};case"Sigmoid":return{activationFunction:"",applyActivation:"value = (1.0 / (1.0 + exp(-value)));"};case"Clip":return{activationFunction:`const clip_min_=f32(${e.clipMin});const clip_max_=f32(${e.clipMax});`,applyActivation:"value = clamp(value, clip_min_, clip_max_);"};default:return{activationFunction:"",applyActivation:""}}},t.parseInternalActivationAttributes=e=>{const t=(null==e?void 0:e.activation)||"";if("Clip"===t){const[r,i]=(null==e?void 0:e.activation_params)||[n.MIN_CLIP,n.MAX_CLIP];return{activation:t,clipMax:i,clipMin:r,activationCacheKey:`${t}:${r},${i}`}}return{activation:t,activationCacheKey:t}}},4271:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseGemmAttributes=t.gemm=void 0;const n=r(6952),i=r(387),o=r(1163);t.gemm=(e,t)=>{(e=>{if(!e)throw new Error("Input is missing");if(e.length<2||e.length>3)throw new Error("Invaid input number.");if(3===e.length&&e[2].dims.length>2)throw new Error("Invalid input shape of C");if(1!==e[0].dataType||1!==e[1].dataType||3===e.length&&1!==e[2].dataType)throw new Error("Invalid input type.");if(e[0].dataType!==e[1].dataType||3===e.length&&e[0].dataType!==e[2].dataType)throw new Error("Input types are mismatched")})(e.inputs),e.compute(((e,t)=>{const r={name:"Gemm",inputTypes:3===e.length?[o.GpuDataType.default,o.GpuDataType.default,o.GpuDataType.default]:[o.GpuDataType.default,o.GpuDataType.default],cacheHint:t.cacheKey};return Object.assign(Object.assign({},r),{get:()=>((e,t,r)=>{const i=t[0].dims.slice(),s=t[1].dims.slice(),[a,c,u]=n.GemmUtil.getShapeOfGemmResult(i,r.transA,s,r.transB,3===t.length?t[2].dims:void 0),l=[a,c];if(!l)throw new Error("Can't use gemm on the given tensors");const d=n.ShapeUtil.size(l);let h="";r.transA&&r.transB?h="value += a[k * M + m] * b[n * K + k];":r.transA&&!r.transB?h="value += a[k * M + m] * b[k * N + n];":!r.transA&&r.transB?h="value += a[m * K + k] * b[n * K + k];":r.transA||r.transB||(h="value += a[m * K + k] * b[k * N + n];");const f="f32",p=1===r.alpha?"":"value *= alpha;",m=3===t.length?`value += beta * c[${((e,t,r)=>{if(0===r.length)return"0u";const n=1===r.length&&1!==e||2===r.length&&r[0]!==e,i=r[r.length-1]!==t;let o="0u";return n||(o+=`+ m * ${r[r.length-1]}u`),i||(o+="+n"),o})(a,c,t[2].dims)}];`:"",g=[`@group(0) @binding(0) var<storage, read> a : array<${f}>;`,`@group(0) @binding(1) var<storage, read> b : array<${f}>;`];return 3===t.length&&g.push(`@group(0) @binding(2) var<storage, read> c : array<${f}>;`),Object.assign(Object.assign({},e),{outputs:[{dims:l,dataType:t[0].dataType,gpuDataType:o.GpuDataType.default}],getShaderSource:e=>`\n  const M: u32 = ${a}u;\n  const N: u32 = ${c}u;\n  const K: u32 = ${u}u;\n  const alpha = ${f}(${r.alpha});\n  const beta = ${f}(${r.beta});\n\n  ${g.join("\n")}\n  @group(0) @binding(${t.length}) var<storage, read_write> output : array<${f}>;\n\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes(d)}\n\n    let m = global_id.x / N;\n    let n = global_id.x % N;\n\n    var value = ${f}(0);\n    for (var k: u32 = 0u; k<${u}u; k++) {\n      ${h}\n    }\n\n    ${p}\n    ${m}\n    output[global_id.x] = value;\n\n  }`,dispatchGroup:()=>({x:Math.ceil(d/64)})})})(r,e,t)})})(e.inputs,t))},t.parseGemmAttributes=e=>(0,i.createAttributeWithCacheKey)(e)},1522:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.matMul=t.createMatmulProgramInfoLoader=void 0;const n=r(6952),i=r(1163),o=r(3997);t.createMatmulProgramInfoLoader=(e,t)=>{const r=(s=e.length>2,a=t.activationCacheKey,{name:"MatMul",inputTypes:s?[i.GpuDataType.default,i.GpuDataType.default,i.GpuDataType.default]:[i.GpuDataType.default,i.GpuDataType.default],cacheHint:a});var s,a;return Object.assign(Object.assign({},r),{get:()=>((e,t,r)=>{const s=t[0].dims,a=t[1].dims,c=n.BroadcastUtil.calcShape(s,a,!0);if(!c)throw new Error("Can't use matmul on the given tensors");const u=n.ShapeUtil.size(c),l="f32",{activationFunction:d,applyActivation:h}=(0,o.getActicationSnippet)(r),f=c[c.length-2],p=s[s.length-1],m=c[c.length-1];return Object.assign(Object.assign({},e),{outputs:[{dims:c,dataType:t[0].dataType,gpuDataType:i.GpuDataType.default}],getShaderSource:e=>`\n  const M: u32 = ${f}u;\n  const N: u32 = ${m}u;\n  const K: u32 = ${p}u;\n\n  @group(0) @binding(0) var<storage, read> a : array<${l}>;\n  @group(0) @binding(1) var<storage, read> b : array<${l}>;\n  @group(0) @binding(2) var<storage, read_write> output : array<${l}>;\n\n  ${d}\n\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes(u)}\n\n    let stack = global_idx / (M * N);\n    let mn = global_idx % (M * N);\n    let n = global_idx % N;\n    let m = mn / N;\n\n    let offsetA = stack * (M * K);\n    let offsetB = stack * (K * N);\n\n    var value = ${l}(0);\n    for (var k: u32 = 0u; k<${p}u; k++) {\n      value += a[offsetA + m * K + k] * b[offsetB + k * N + n];\n    }\n    ${h}\n    output[global_idx] = value;\n  }`,dispatchGroup:()=>({x:Math.ceil(u/64)})})})(r,e,t)})},t.matMul=e=>{(e=>{if(!e||2!==e.length)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.");if(1!==e[0].dataType||1!==e[1].dataType)throw new Error("inputs should be float type")})(e.inputs),e.compute((0,t.createMatmulProgramInfoLoader)(e.inputs,{activation:"",activationCacheKey:""}))}},5262:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.globalMaxPool=t.parseGlobalMaxPoolAttributes=t.parseMaxPoolAttributes=t.maxPool=t.globalAveragePool=t.parseGlobalAveragePoolAttributes=t.averagePool=t.parseAveragePoolAttributes=void 0;const n=r(6952),i=r(387),o=r(1163),s=r(2075),a=e=>{if(!e||1!==e.length)throw new Error("Pool ops requires 1 input.");if(4!==e[0].dims.length)throw new Error("Pool ops supports 2-D inputs only for now.");if(1!==e[0].dataType)throw new Error("Invalid input type.")},c=(e,t,r)=>{const i="NHWC"===t.format,o=i?[e[0].dims[0],e[0].dims[3],e[0].dims[1],e[0].dims[2]]:e[0].dims.slice(),s=Object.hasOwnProperty.call(t,"dilations"),a=t.kernelShape.slice(),c=t.strides.slice(),u=s?t.dilations.slice():[],l=t.pads.slice();n.PoolConvUtil.adjustPoolAttributes(r,o,a,c,u,l);const d=n.PoolConvUtil.computePoolOutputShape(r,o,c,u,a,l,t.autoPad),h=Object.assign({},t);return s?Object.assign(h,{kernelShape:a,strides:c,pads:l,dilations:u,cacheKey:t.cacheKey}):Object.assign(h,{kernelShape:a,strides:c,pads:l,cacheKey:t.cacheKey}),[h,i?[d[0],d[2],d[3],d[1]]:d]},u=(e,t,r,i,o,a,c,u)=>{const l="NHWC"===i.format,d=t.length,h=n.ShapeUtil.size(r),f=(0,s.createIndicesHelper)("output",r),p=(0,s.createIndicesHelper)("x",t);if(i.kernelShape.length<=2){const r=i.kernelShape[i.kernelShape.length-1],n=i.strides[i.strides.length-1],s=i.pads[i.pads.length/2-1],m=d-(l?2:1);let g="",v="",y="";if(g=s+i.pads[i.pads.length-1]!==0?`\n              for (var i: u32 = 0u; i < ${r}u; i++) {\n                xIndices[${m}] = indices[${m}] * ${n} - ${s} + i;\n                if (xIndices[${m}] < 0 || xIndices[${m}] >= ${t[m]}) {\n                  pad++;\n                  continue;\n                }\n                let x_val = x[${p.i2oExpression("xIndices")}];\n                ${o}\n              }`:`\n              for (var i: u32 = 0u; i < ${r}u; i++) {\n                xIndices[${m}] = indices[${m}] * ${n} - ${s} + i;\n                let x_val = x[${p.i2oExpression("xIndices")}];\n                ${o}\n              }`,2===i.kernelShape.length){const e=i.kernelShape[i.kernelShape.length-2],n=i.strides[i.strides.length-2],o=i.pads[i.pads.length/2-2],s=i.pads[i.pads.length-2],a=d-(l?3:2),c=t[a];v=o+s!==0?`\n                for (var j: u32 = 0u; j < ${e}u; j++) {\n                  xIndices[${a}] = indices[${a}] * ${n} - ${o} + j;\n                  if (xIndices[${a}] < 0 || xIndices[${a}] >= ${c}) {\n                    pad+= ${r};\n                    continue;\n                  }\n              `:`\n                for (var j: u32 = 0u; j < ${e}u; j++) {\n                  xIndices[${a}] = indices[${a}] * ${n} - ${o} + j;\n                `,y="\n              }\n            "}return`\n            @group(0) @binding(0) var<storage, read> x : array<${c}>;\n            @group(0) @binding(1) var<storage, read_write> output : array<${c}>;\n\n            ${f.o2iImpl}\n            ${p.i2oImpl}\n\n            ${e.mainStart()}\n              ${e.guardAgainstOutOfBoundsWorkgroupSizes(h)}\n\n              ${f.indicesVariableDeclaration("indices")}\n              ${f.o2iCall("global_idx","indices")}\n              ${f.indicesVariableDeclaration("xIndices")}\n              ${f.o2iCall("global_idx","xIndices")}\n\n              var value: ${c} = ${c}(${u});\n              var pad = 0;\n              ${v}\n              ${g}\n              ${y}\n              ${a}\n\n              output[global_idx] = value;\n            }`}{if(l)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");const r=n.ShapeUtil.size(i.kernelShape),s=n.ShapeUtil.computeStrides(i.kernelShape),m=s.length,g=i.pads.length;let v="";return v=i.pads.reduce(((e,t)=>e+t))?`\n                if (xIndices[j] >= inputDims[j]) {\n                  pad++;\n                  isPad = true;\n                  break;\n                }\n              }\n              if (!isPad) {\n                let x_val = x[${p.i2oExpression("xIndices")}];\n                ${o}\n              }`:`\n              }\n              let x_val = x[${p.i2oExpression("xIndices")}];\n              ${o}\n            `,`\n            @group(0) @binding(0) var<storage, read> x : array<${c}>;\n            @group(0) @binding(1) var<storage, read_write> output : array<${c}>;\n\n            ${f.o2iImpl}\n            ${p.i2oImpl}\n\n            const pads = array<u32, ${g}>(${i.pads.map((e=>`${e}u`)).join(",")});\n            const inputDims = array<u32, ${d}>(${t.map((e=>`${e}u`)).join(",")});\n            const kernelStrides = array<u32, ${m}>(${s.map((e=>`${e}u`)).join(",")});\n            const strides = array<u32, ${m}>(${i.strides.map((e=>`${e}u`)).join(",")});\n\n            ${e.mainStart()}\n              ${e.guardAgainstOutOfBoundsWorkgroupSizes(h)}\n\n              ${f.indicesVariableDeclaration("indices")}\n              ${f.o2iCall("global_idx","indices")}\n              ${f.indicesVariableDeclaration("xIndices")}\n              ${f.o2iCall("global_idx","xIndices")}\n\n              var offsets: array<u32, ${m}>;\n\n              var value = ${c}(${u});\n              var pad = 0;\n              var isPad = false;\n\n              for (var i: u32 = 0u; i < ${r}u; i++) {\n                var offset = i;\n                for (var j = 0u; j < ${m-1}u; j++) {\n                  offsets[j] = offset / kernelStrides[j];\n                  offset -= offsets[j] * kernelStrides[j];\n                }\n                offsets[${m-1}] = offset;\n\n                isPad = false;\n                for (var j = ${d-m}u; j < ${d}u; j++) {\n                  xIndices[j] = indices[j] * strides[j - ${d-m}u]\n                    + offsets[j - ${d-m}u] - pads[j - 2u];\n                  ${v}\n              }\n              ${a}\n\n              output[global_idx] = value;\n            }`}},l=e=>({format:e.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],ceilMode:e.ceil_mode,kernelShape:e.kernel_shape,strides:e.strides,pads:e.pads}),d=(e,t,r,i)=>{const[s,a]=c(e,i,r),l=n.ShapeUtil.size(s.kernelShape),d="f32";let h="";return s.countIncludePad?h+=`value /= ${d}(${l});`:h+=`value /= ${d}(${l} - pad);`,Object.assign(Object.assign({},t),{outputs:[{dims:a,dataType:e[0].dataType,gpuDataType:o.GpuDataType.default}],getShaderSource:t=>u(t,e[0].dims,a,s,"value += x_val;",h,d,"0.0"),dispatchGroup:()=>({x:Math.ceil(n.ShapeUtil.size(a)/64)})})};t.parseAveragePoolAttributes=e=>{const t=0!==e.count_include_pad,r=l(e);if(0!==r.ceilMode)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");return(0,i.createAttributeWithCacheKey)(Object.assign({countIncludePad:t},r))},t.averagePool=(e,t)=>{a(e.inputs);const r={name:"AveragePool",inputTypes:[o.GpuDataType.default],cacheHint:t.cacheKey};e.compute(Object.assign(Object.assign({},r),{get:()=>d(e.inputs,r,!1,t)}))};const h={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[],cacheKey:""};t.parseGlobalAveragePoolAttributes=e=>{const t=e.format;return Object.assign(Object.assign({format:t},h),{cacheKey:t})},t.globalAveragePool=(e,t)=>{a(e.inputs);const r={name:"GlobalAveragePool",inputTypes:[o.GpuDataType.default],cacheHint:t.cacheKey};e.compute(Object.assign(Object.assign({},r),{get:()=>d(e.inputs,r,!0,t)}))};const f=(e,t,r,i)=>{const[s,a]=c(e,i,r);return Object.assign(Object.assign({},t),{outputs:[{dims:a,dataType:e[0].dataType,gpuDataType:o.GpuDataType.default}],getShaderSource:t=>u(t,e[0].dims,a,s,"\n      value = max(x_val, value);\n    ","","f32","-1e5"),dispatchGroup:()=>({x:Math.ceil(n.ShapeUtil.size(a)/64)})})};t.maxPool=(e,t)=>{a(e.inputs);const r={name:"MaxPool",inputTypes:[o.GpuDataType.default],cacheHint:t.cacheKey};e.compute(Object.assign(Object.assign({},r),{get:()=>f(e.inputs,r,!1,t)}))},t.parseMaxPoolAttributes=e=>{const t=e.storage_order,r=e.dilations,n=l(e);if(0!==t)throw new Error("column major storage order is not yet supported for MaxPool");if(0!==n.ceilMode)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");return(0,i.createAttributeWithCacheKey)(Object.assign({storageOrder:t,dilations:r},n))},t.parseGlobalMaxPoolAttributes=e=>{const t=e.format;return Object.assign(Object.assign({format:t},h),{cacheKey:t})},t.globalMaxPool=(e,t)=>{a(e.inputs);const r={name:"GlobalMaxPool",inputTypes:[o.GpuDataType.default],cacheHint:t.cacheKey};e.compute(Object.assign(Object.assign({},r),{get:()=>f(e.inputs,r,!0,t)}))}},2625:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseTransposeAttributes=t.transpose=t.createTransposeProgramInfo=t.transposeProgramMetadata=void 0;const n=r(6952),i=r(387),o=r(1163),s=r(2075);t.transposeProgramMetadata={name:"Transpose",inputTypes:[o.GpuDataType.default]};const a=(e,t)=>t&&t.length!==e.length?[...e.keys()].reverse():t;t.createTransposeProgramInfo=(e,r)=>{const i=e.dims,c=a(i,r),u=((e,t)=>n.ShapeUtil.sortBasedOnPerm(e,a(e,t)))(i,c),l=i.length,d=n.ShapeUtil.size(u),h=(0,s.createIndicesHelper)("output",u),f=(0,s.createIndicesHelper)("a",i);return Object.assign(Object.assign({},t.transposeProgramMetadata),{outputs:[{dims:u,dataType:e.dataType,gpuDataType:o.GpuDataType.default}],getShaderSource:e=>`\n  @group(0) @binding(0) var<storage, read> a : array<f32>;\n  @group(0) @binding(1) var<storage, read_write> output : array<f32>;\n\n  ${((e,t)=>{const r=[];r.push(`fn perm(a: ptr<function, array<u32, ${t}>>, i: ptr<function, array<u32, ${t}>>) {`);for(let n=0;n<t;++n)r.push(`\t(*a)[${e[n]}]=(*i)[${n}];`);return r.push("\t}"),r.join("\n")})(c,l)}\n  ${h.o2iImpl}\n  ${f.i2oImpl}\n\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes(d)}\n\n    ${h.indicesVariableDeclaration("indices")}\n    ${h.o2iCall("global_idx","indices")}\n    ${f.indicesVariableDeclaration("aIndices")}\n    perm(&aIndices, &indices);\n\n    output[global_idx] = a[${f.i2oExpression("aIndices")}];\n  }`,dispatchGroup:()=>({x:Math.ceil(d/64)})})},t.transpose=(e,r)=>{(e=>{if(!e||1!==e.length)throw new Error("Transpose requires 1 input.");if(1!==e[0].dataType)throw new Error("input should be float tensor")})(e.inputs),e.compute(Object.assign(Object.assign({},t.transposeProgramMetadata),{cacheHint:r.cacheKey,get:()=>(0,t.createTransposeProgramInfo)(e.inputs[0],r.perm)}))},t.parseTransposeAttributes=e=>(0,i.createAttributeWithCacheKey)({perm:e.perm})},9302:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.thresholdedRelu=t.tanh=t.tan=t.sqrt=t.sinh=t.sin=t.sigmoid=t.relu=t.reciprocal=t.neg=t.leakyRelu=t.floor=t.exp=t.erf=t.elu=t.parseAlphaAttributes=t.cosh=t.cos=t.ceil=t.clip=t.clipV10=t.atanh=t.atan=t.asinh=t.asin=t.acosh=t.acos=t.abs=void 0;const n=r(6952),i=r(387),o=r(1163),s=(e,t,r,i,s)=>{const a={name:t,inputTypes:[o.GpuDataType.default],cacheHint:s};return Object.assign(Object.assign({},a),{get:()=>((e,t,r,i)=>Object.assign(Object.assign({},e),{getShaderSource:e=>((e,t,r,n)=>{const i=Math.ceil(t/4);let o="";return o="string"==typeof r?`${r}(a)`:r("a"),`\n  @group(0) @binding(0) var<storage, read> inputData : array<vec4<f32>>;\n  @group(0) @binding(1) var<storage, read_write> outputData : array<vec4<f32>>;\n\n  ${null!=n?n:""}\n\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes(i)}\n\n    let a = inputData[global_idx];\n    outputData[global_idx] = ${o};\n  }`})(e,n.ShapeUtil.size(t.dims),r,i),outputs:[{dims:t.dims,dataType:t.dataType,gpuDataType:o.GpuDataType.default}],dispatchGroup:e=>({x:Math.ceil(n.ShapeUtil.size(e[0].dims)/64/4)})}))(a,e,r,i)})};t.abs=e=>{e.compute(s(e.inputs[0],"Abs","abs"))},t.acos=e=>{e.compute(s(e.inputs[0],"Acos","acos"))},t.acosh=e=>{e.compute(s(e.inputs[0],"Acosh","acosh"))},t.asin=e=>{e.compute(s(e.inputs[0],"Asin","asin"))},t.asinh=e=>{e.compute(s(e.inputs[0],"Asinh","asinh"))},t.atan=e=>{e.compute(s(e.inputs[0],"Atan","atan"))},t.atanh=e=>{e.compute(s(e.inputs[0],"Atanh","atanh"))},t.clipV10=(e,t)=>{e.compute(s(e.inputs[0],"Clip",(e=>`clamp(${e}, clip_min_, clip_max_)`),`\n    const clip_min_: vec4<f32> = vec4(f32(${t.min}));\n    const clip_max_: vec4<f32> = vec4(f32(${t.max}));\n`,t.cacheKey),{inputs:[0]})},t.clip=e=>{const r=(e=>{const t=e.length>=2?e[1].getFloat32Array()[0]:n.MIN_CLIP,r=e.length>=3?e[2].getFloat32Array()[0]:n.MAX_CLIP;return(0,i.createAttributeWithCacheKey)({min:t,max:r})})(e.inputs);(0,t.clipV10)(e,r)},t.ceil=e=>{e.compute(s(e.inputs[0],"Ceil","ceil"))},t.cos=e=>{e.compute(s(e.inputs[0],"Cos","cos"))},t.cosh=e=>{e.compute(s(e.inputs[0],"Cosh","cosh"))},t.parseAlphaAttributes=e=>(0,i.createAttributeWithCacheKey)(e),t.elu=(e,t)=>{e.compute(s(e.inputs[0],"Elu",(e=>`elu_vf32(${e})`),`\n  const elu_alpha_: f32 = f32(${t.alpha});\n\n  fn elu_f32(a: f32) -> f32 {\n  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);\n  }\n\n  fn elu_vf32(v: vec4<f32>) -> vec4<f32> {\n  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));\n  }`,t.cacheKey))},t.erf=e=>{e.compute(s(e.inputs[0],"Erf",(e=>`erf_vf32(${e})`),"\n  const r0: f32 = 0.3275911;\n  const r1: f32 = 0.254829592;\n  const r2: f32 = -0.284496736;\n  const r3: f32 = 1.421413741;\n  const r4: f32 = -1.453152027;\n  const r5: f32 = 1.061405429;\n\n  fn erf_vf32(v: vec4<f32>) -> vec4<f32> {\n    let absv = abs(v);\n    let x = 1.0 / (1.0 + r0 * absv);\n    return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));\n  }"))},t.exp=e=>{e.compute(s(e.inputs[0],"Exp","exp"))},t.floor=e=>{e.compute(s(e.inputs[0],"Floor","floor"))},t.leakyRelu=(e,t)=>{e.compute(s(e.inputs[0],"LeakyRelu",(e=>`select(leaky_relu_alpha_ * ${e}, ${e}, ${e} >= vec4<f32>(0.0))`),`const leaky_relu_alpha_: f32 = f32(${t.alpha});`,t.cacheKey))},t.neg=e=>{e.compute(s(e.inputs[0],"Neg",(e=>`-${e}`)))},t.reciprocal=e=>{e.compute(s(e.inputs[0],"Reciprocal",(e=>`1.0/${e}`)))},t.relu=e=>{e.compute(s(e.inputs[0],"Relu",(e=>`select(vec4<f32>(0.0), ${e}, ${e} > vec4<f32>(0.0))`)))},t.sigmoid=e=>{e.compute(s(e.inputs[0],"Sigmoid",(e=>`(1.0 / (1.0 + exp(-${e})))`)))},t.sin=e=>{e.compute(s(e.inputs[0],"Sin","sin"))},t.sinh=e=>{e.compute(s(e.inputs[0],"Sinh","sinh"))},t.sqrt=e=>{e.compute(s(e.inputs[0],"Sqrt","sqrt"))},t.tan=e=>{e.compute(s(e.inputs[0],"Tan","tan"))},t.tanh=e=>{e.compute(s(e.inputs[0],"Tanh","tanh"))},t.thresholdedRelu=(e,t)=>(e.compute(s(e.inputs[0],"ThresholdedRelu",(e=>`select(vec4<f32>(0.0), ${e}, ${e} > thresholded_relu_alpha_)`),`const thresholded_relu_alpha_: vec4<f32> = vec4<f32>(${t.alpha});`,t.cacheKey)),0)},8305:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProgramManager=void 0;const n=r(4955),i=r(2075);t.ProgramManager=class{constructor(e){this.backend=e,this.repo=new Map,this.attributesBound=!1}getArtifact(e){return this.repo.get(e)}setArtifact(e,t){this.repo.set(e,t)}run(e,t,r,n){const i=this.backend.device,o=this.backend.getComputePassEncoder();this.backend.profilingEnabled&&o.writeTimestamp(this.backend.profilingQuerySet,0),o.setPipeline(e.computePipeline);const s=[];for(const e of t)s.push({binding:s.length,resource:{buffer:e.buffer}});for(const e of r)s.push({binding:s.length,resource:{buffer:e.buffer}});const a=i.createBindGroup({layout:e.computePipeline.getBindGroupLayout(0),entries:s});if(o.setBindGroup(0,a),o.dispatchWorkgroups(...n),this.backend.pendingDispatchNumber++,this.backend.profilingEnabled){o.writeTimestamp(this.backend.profilingQuerySet,1);const e=this.backend.gpuDataManager.create(16,GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE),t=this.backend.gpuDataManager.create(16,GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST);this.backend.endComputePass(),this.backend.getCommandEncoder().resolveQuerySet(this.backend.profilingQuerySet,0,2,e.buffer,0),this.backend.getCommandEncoder().copyBufferToBuffer(e.buffer,0,t.buffer,0,16),this.backend.flush();const r=this.backend.currentKernelId,n=this.backend.kernels.get(r)[0];t.buffer.mapAsync(GPUMapMode.READ).then((()=>{const i=new BigUint64Array(t.buffer.getMappedRange()),o=i[0],s=i[1];t.buffer.unmap(),void 0===this.backend.profilingTimeBase&&(this.backend.profilingTimeBase=o);const a=Number(o-this.backend.profilingTimeBase),c=Number(s-this.backend.profilingTimeBase);if(!Number.isSafeInteger(a)||!Number.isSafeInteger(c))throw new RangeError("incorrect timestamp range");this.backend.gpuDataManager.release(e.id),this.backend.gpuDataManager.release(t.id),console.log(`[profiling] kernel "${r}|${n}" execution time: ${c-a} ns`)}))}this.backend.pendingDispatchNumber>=16&&this.backend.flush()}dispose(){}build(e,t){const r=this.backend.device,o=e.getShaderSource((0,i.createShaderHelper)(t)),s=r.createShaderModule({code:o});return(0,n.LOG_DEBUG)("verbose",(()=>`[WebGPU] shader code: ${o}`)),{programInfo:e,computePipeline:r.createComputePipeline({compute:{module:s,entryPoint:"main"},layout:"auto"})}}normalizeDispatchGroupSize(e){const t="number"==typeof e?e:e.x,r="number"==typeof e?1:e.y||1,n="number"==typeof e?1:e.z||1,i=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(t<=i&&r<=i&&n<=i)return[t,r,n];const o=t*r*n;let s=Math.ceil(Math.sqrt(o));if(s>i){if(s=Math.ceil(Math.cbrt(o)),s>i)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[s,s,s]}return[s,s,1]}}},1163:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.GpuDataType=void 0,(r=t.GpuDataType||(t.GpuDataType={}))[r.default=0]="default",r[r.upload=1]="upload",r[r.profile=2]="profile"},3899:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.iterateExtraOptions=void 0,t.iterateExtraOptions=(e,r,n,i)=>{if("object"==typeof e&&null!==e){if(n.has(e))throw new Error("Circular reference in options");n.add(e)}Object.entries(e).forEach((([e,o])=>{const s=r?r+e:e;if("object"==typeof o)(0,t.iterateExtraOptions)(o,s+".",n,i);else if("string"==typeof o||"number"==typeof o)i(s,o.toString());else{if("boolean"!=typeof o)throw new Error("Can't handle extra config type: "+typeof o);i(s,o?"1":"0")}}))}},9544:function(e,t,r){var n,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.endProfiling=t.run=t.releaseSession=t.createSession=t.createSessionFinalize=t.createSessionAllocate=t.initOrt=t.initWasm=void 0;const a=r(8453),c=r(7675),u=s(r(1259)),l=r(263),d=()=>!!a.env.wasm.proxy&&"undefined"!=typeof document;let h,f,p,m=!1,g=!1,v=!1;const y=[],b=[],E=[],w=[],S=[],_=[],T=()=>{if(m||!g||v||!h)throw new Error("worker not ready")},x=e=>{switch(e.data.type){case"init-wasm":m=!1,e.data.err?(v=!0,f[1](e.data.err)):(g=!0,f[0]());break;case"init-ort":e.data.err?p[1](e.data.err):p[0]();break;case"create_allocate":e.data.err?y.shift()[1](e.data.err):y.shift()[0](e.data.out);break;case"create_finalize":e.data.err?b.shift()[1](e.data.err):b.shift()[0](e.data.out);break;case"create":e.data.err?E.shift()[1](e.data.err):E.shift()[0](e.data.out);break;case"release":e.data.err?w.shift()[1](e.data.err):w.shift()[0]();break;case"run":e.data.err?S.shift()[1](e.data.err):S.shift()[0](e.data.out);break;case"end-profiling":e.data.err?_.shift()[1](e.data.err):_.shift()[0]()}},A="undefined"!=typeof document?null===(n=null===document||void 0===document?void 0:document.currentScript)||void 0===n?void 0:n.src:void 0;t.initWasm=async()=>{if(d()){if(g)return;if(m)throw new Error("multiple calls to 'initWasm()' detected.");if(v)throw new Error("previous call to 'initWasm()' failed.");return m=!0,void 0===a.env.wasm.wasmPaths&&A&&0!==A.indexOf("blob:")&&(a.env.wasm.wasmPaths=A.substr(0,+A.lastIndexOf("/")+1)),new Promise(((e,t)=>{null==h||h.terminate(),h=r(8050).Z(),h.onmessage=x,f=[e,t];const n={type:"init-wasm",in:a.env.wasm};h.postMessage(n)}))}return(0,l.initializeWebAssembly)(a.env.wasm)},t.initOrt=async(e,t)=>{if(d())return T(),new Promise(((r,n)=>{p=[r,n];const i={type:"init-ort",in:{numThreads:e,loggingLevel:t}};h.postMessage(i)}));u.initOrt(e,t),await(0,c.init)((0,l.getInstance)())},t.createSessionAllocate=async e=>d()?(T(),new Promise(((t,r)=>{y.push([t,r]);const n={type:"create_allocate",in:{model:e}};h.postMessage(n,[e.buffer])}))):u.createSessionAllocate(e),t.createSessionFinalize=async(e,t)=>d()?(T(),new Promise(((r,n)=>{b.push([r,n]);const i={type:"create_finalize",in:{modeldata:e,options:t}};h.postMessage(i)}))):u.createSessionFinalize(e,t),t.createSession=async(e,t)=>d()?(T(),new Promise(((r,n)=>{E.push([r,n]);const i={type:"create",in:{model:e,options:t}};h.postMessage(i,[e.buffer])}))):u.createSession(e,t),t.releaseSession=async e=>{if(d())return T(),new Promise(((t,r)=>{w.push([t,r]);const n={type:"release",in:e};h.postMessage(n)}));u.releaseSession(e)},t.run=async(e,t,r,n,i)=>d()?(T(),new Promise(((o,s)=>{S.push([o,s]);const a={type:"run",in:{sessionId:e,inputIndices:t,inputs:r,outputIndices:n,options:i}};h.postMessage(a,u.extractTransferableBuffers(r))}))):u.run(e,t,r,n,i),t.endProfiling=async e=>{if(d())return T(),new Promise(((t,r)=>{_.push([t,r]);const n={type:"end-profiling",in:e};h.postMessage(n)}));u.endProfiling(e)}},7918:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setRunOptions=void 0;const n=r(3899),i=r(9444),o=r(263);t.setRunOptions=e=>{const t=(0,o.getInstance)();let r=0;const s=[],a=e||{};try{if(void 0===(null==e?void 0:e.logSeverityLevel))a.logSeverityLevel=2;else if("number"!=typeof e.logSeverityLevel||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${e.logSeverityLevel}`);if(void 0===(null==e?void 0:e.logVerbosityLevel))a.logVerbosityLevel=0;else if("number"!=typeof e.logVerbosityLevel||!Number.isInteger(e.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);void 0===(null==e?void 0:e.terminate)&&(a.terminate=!1);let o=0;if(void 0!==(null==e?void 0:e.tag)&&(o=(0,i.allocWasmString)(e.tag,s)),r=t._OrtCreateRunOptions(a.logSeverityLevel,a.logVerbosityLevel,!!a.terminate,o),0===r)throw new Error("Can't create run options");return void 0!==(null==e?void 0:e.extra)&&(0,n.iterateExtraOptions)(e.extra,"",new WeakSet,((e,n)=>{const o=(0,i.allocWasmString)(e,s),a=(0,i.allocWasmString)(n,s);if(0!==t._OrtAddRunConfigEntry(r,o,a))throw new Error(`Can't set a run config entry: ${e} - ${n}`)})),[r,s]}catch(e){throw 0!==r&&t._OrtReleaseRunOptions(r),s.forEach(t._free),e}}},6640:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OnnxruntimeWebAssemblySessionHandler=void 0;const n=r(2806),i=r(8453),o=r(2850),s=r(9544),a=r(7917);let c;t.OnnxruntimeWebAssemblySessionHandler=class{async createSessionAllocate(e){const t=await fetch(e),r=await t.arrayBuffer();return(0,s.createSessionAllocate)(new Uint8Array(r))}async loadModel(e,t){if(c||(await(0,s.initOrt)(i.env.wasm.numThreads,(0,a.logLevelStringToEnum)(i.env.logLevel)),c=!0),"string"==typeof e)if("undefined"==typeof fetch){const r=await(0,o.promisify)(n.readFile)(e);[this.sessionId,this.inputNames,this.outputNames]=await(0,s.createSession)(r,t)}else{const r=await this.createSessionAllocate(e);[this.sessionId,this.inputNames,this.outputNames]=await(0,s.createSessionFinalize)(r,t)}else[this.sessionId,this.inputNames,this.outputNames]=await(0,s.createSession)(e,t)}async dispose(){return(0,s.releaseSession)(this.sessionId)}async run(e,t,r){const n=[],o=[];Object.entries(e).forEach((e=>{const t=e[0],r=e[1],i=this.inputNames.indexOf(t);if(-1===i)throw new Error(`invalid input '${t}'`);n.push(r),o.push(i)}));const a=[];Object.entries(t).forEach((e=>{const t=e[0],r=this.outputNames.indexOf(t);if(-1===r)throw new Error(`invalid output '${t}'`);a.push(r)}));const c=await(0,s.run)(this.sessionId,o,n.map((e=>[e.type,e.dims,e.data])),a,r),u={};for(let e=0;e<c.length;e++)u[this.outputNames[a[e]]]=new i.Tensor(c[e][0],c[e][2],c[e][1]);return u}startProfiling(){}endProfiling(){(0,s.endProfiling)(this.sessionId)}}},7622:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setSessionOptions=void 0;const n=r(3899),i=r(9444),o=r(263);t.setSessionOptions=e=>{var t,r,s,a;const c=(0,o.getInstance)();let u=0;const l=[],d=e||{};(e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});const t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some((e=>"webgpu"===("string"==typeof e?e:e.name)))&&(e.enableMemPattern=!1)})(d);try{const e=(e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${e}`)}})(null!==(t=d.graphOptimizationLevel)&&void 0!==t?t:"all"),h=(e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${e}`)}})(null!==(r=d.executionMode)&&void 0!==r?r:"sequential"),f="string"==typeof d.logId?(0,i.allocWasmString)(d.logId,l):0,p=null!==(s=d.logSeverityLevel)&&void 0!==s?s:2;if(!Number.isInteger(p)||p<0||p>4)throw new Error(`log serverity level is not valid: ${p}`);const m=null!==(a=d.logVerbosityLevel)&&void 0!==a?a:0;if(!Number.isInteger(m)||m<0||m>4)throw new Error(`log verbosity level is not valid: ${m}`);const g="string"==typeof d.optimizedModelFilePath?(0,i.allocWasmString)(d.optimizedModelFilePath,l):0;if(u=c._OrtCreateSessionOptions(e,!!d.enableCpuMemArena,!!d.enableMemPattern,h,!!d.enableProfiling,0,f,p,m,g),0===u)throw new Error("Can't create session options");return d.executionProviders&&((e,t,r)=>{for(const n of t){let t="string"==typeof n?n:n.name;switch(t){case"xnnpack":t="XNNPACK";break;case"webgpu":t="JS";break;case"wasm":case"cpu":continue;default:throw new Error(`not supported EP: ${t}`)}const s=(0,i.allocWasmString)(t,r);if(0!==(0,o.getInstance)()._OrtAppendExecutionProvider(e,s))throw new Error(`Can't append execution provider: ${t}`)}})(u,d.executionProviders,l),void 0!==d.extra&&(0,n.iterateExtraOptions)(d.extra,"",new WeakSet,((e,t)=>{const r=(0,i.allocWasmString)(e,l),n=(0,i.allocWasmString)(t,l);if(0!==c._OrtAddSessionConfigEntry(u,r,n))throw new Error(`Can't set a session config entry: ${e} - ${t}`)})),[u,l]}catch(e){throw 0!==u&&c._OrtReleaseSessionOptions(u),l.forEach(c._free),e}}},9444:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.allocWasmString=void 0;const n=r(263);t.allocWasmString=(e,t)=>{const r=(0,n.getInstance)(),i=r.lengthBytesUTF8(e)+1,o=r._malloc(i);return r.stringToUTF8(e,o,i),t.push(o),o}},7917:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.logLevelStringToEnum=t.tensorTypeToTypedArrayConstructor=t.getTensorElementSize=t.tensorDataTypeEnumToString=t.tensorDataTypeStringToEnum=void 0,t.tensorDataTypeStringToEnum=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${e}`)}},t.tensorDataTypeEnumToString=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${e}`)}},t.getTensorElementSize=e=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][e],t.tensorTypeToTypedArrayConstructor=e=>{switch(e){case"float32":return Float32Array;case"uint8":case"bool":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${e}`)}},t.logLevelStringToEnum=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${e}`)}}},1259:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.extractTransferableBuffers=t.endProfiling=t.run=t.releaseSession=t.createSession=t.createSessionFinalize=t.createSessionAllocate=t.initOrt=void 0;const n=r(7918),i=r(7622),o=r(9444),s=r(7917),a=r(263);t.initOrt=(e,t)=>{const r=(0,a.getInstance)()._OrtInit(e,t);if(0!==r)throw new Error(`Can't initialize onnxruntime. error code = ${r}`)};const c=new Map;t.createSessionAllocate=e=>{const t=(0,a.getInstance)(),r=t._malloc(e.byteLength);return t.HEAPU8.set(e,r),[r,e.byteLength]},t.createSessionFinalize=(e,t)=>{const r=(0,a.getInstance)();let n=0,o=0,s=[];try{if([o,s]=(0,i.setSessionOptions)(t),n=r._OrtCreateSession(e[0],e[1],o),0===n)throw new Error("Can't create a session")}finally{r._free(e[0]),0!==o&&r._OrtReleaseSessionOptions(o),s.forEach(r._free)}const u=r._OrtGetInputCount(n),l=r._OrtGetOutputCount(n),d=[],h=[],f=[],p=[];for(let e=0;e<u;e++){const t=r._OrtGetInputName(n,e);if(0===t)throw new Error("Can't get an input name");h.push(t),d.push(r.UTF8ToString(t))}for(let e=0;e<l;e++){const t=r._OrtGetOutputName(n,e);if(0===t)throw new Error("Can't get an output name");p.push(t),f.push(r.UTF8ToString(t))}return c.set(n,[n,h,p]),[n,d,f]},t.createSession=(e,r)=>{const n=(0,t.createSessionAllocate)(e);return(0,t.createSessionFinalize)(n,r)},t.releaseSession=e=>{const t=(0,a.getInstance)(),r=c.get(e);if(!r)throw new Error("invalid session id");const n=r[0],i=r[1],o=r[2];i.forEach(t._OrtFree),o.forEach(t._OrtFree),t._OrtReleaseSession(n),c.delete(e)},t.run=async(e,t,r,i,u)=>{const l=(0,a.getInstance)(),d=c.get(e);if(!d)throw new Error("invalid session id");const h=d[0],f=d[1],p=d[2],m=t.length,g=i.length;let v=0,y=[];const b=[],E=[];try{[v,y]=(0,n.setRunOptions)(u);for(let e=0;e<m;e++){const t=r[e][0],n=r[e][1],i=r[e][2];let a,c;if(Array.isArray(i)){c=4*i.length,a=l._malloc(c),E.push(a);let e=a/4;for(let t=0;t<i.length;t++){if("string"!=typeof i[t])throw new TypeError(`tensor data at index ${t} is not a string`);l.HEAPU32[e++]=(0,o.allocWasmString)(i[t],E)}}else c=i.byteLength,a=l._malloc(c),E.push(a),l.HEAPU8.set(new Uint8Array(i.buffer,i.byteOffset,c),a);const u=l.stackSave(),d=l.stackAlloc(4*n.length);try{let e=d/4;n.forEach((t=>l.HEAP32[e++]=t));const r=l._OrtCreateTensor((0,s.tensorDataTypeStringToEnum)(t),a,c,d,n.length);if(0===r)throw new Error("Can't create a tensor");b.push(r)}finally{l.stackRestore(u)}}const e=l.stackSave(),a=l.stackAlloc(4*m),c=l.stackAlloc(4*m),d=l.stackAlloc(4*g),w=l.stackAlloc(4*g);try{let e=a/4,r=c/4,n=d/4,o=w/4;for(let n=0;n<m;n++)l.HEAPU32[e++]=b[n],l.HEAPU32[r++]=f[t[n]];for(let e=0;e<g;e++)l.HEAPU32[n++]=0,l.HEAPU32[o++]=p[i[e]];let u=l._OrtRun(h,c,a,m,w,g,d,v);const y=l.jsepRunPromise;y&&void 0!==y.then&&(u=await y);const E=[];if(0===u)for(let e=0;e<g;e++){const t=l.HEAPU32[d/4+e],r=l.stackSave(),n=l.stackAlloc(16);let i,o=0;try{if(u=l._OrtGetTensorData(t,n,n+4,n+8,n+12),0!==u)throw new Error(`Can't access output tensor data. error code = ${u}`);let e=n/4;const r=l.HEAPU32[e++];o=l.HEAPU32[e++];const a=l.HEAPU32[e++],c=l.HEAPU32[e++],d=[];for(let e=0;e<c;e++)d.push(l.HEAPU32[a/4+e]);l._OrtFree(a);const h=0===d.length?1:d.reduce(((e,t)=>e*t));if(i=(0,s.tensorDataTypeEnumToString)(r),"string"===i){const e=[];let t=o/4;for(let r=0;r<h;r++){const n=l.HEAPU32[t++],i=r===h-1?void 0:l.HEAPU32[t]-n;e.push(l.UTF8ToString(n,i))}E.push([i,d,e])}else{const e=new((0,s.tensorTypeToTypedArrayConstructor)(i))(h);new Uint8Array(e.buffer,e.byteOffset,e.byteLength).set(l.HEAPU8.subarray(o,o+e.byteLength)),E.push([i,d,e])}}finally{l.stackRestore(r),"string"===i&&o&&l._free(o),l._OrtReleaseTensor(t)}}if(0===u)return E;throw new Error(`failed to call OrtRun(). error code = ${u}.`)}finally{l.stackRestore(e)}}finally{b.forEach(l._OrtReleaseTensor),E.forEach(l._free),l._OrtReleaseRunOptions(v),y.forEach(l._free)}},t.endProfiling=e=>{const t=(0,a.getInstance)(),r=c.get(e);if(!r)throw new Error("invalid session id");const n=r[0],i=t._OrtEndProfiling(n);if(0===i)throw new Error("Can't get an profile file name");t._OrtFree(i)},t.extractTransferableBuffers=e=>{const t=[];for(const r of e){const e=r[2];!Array.isArray(e)&&e.buffer&&t.push(e.buffer)}return t}},263:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.dispose=t.getInstance=t.initializeWebAssembly=void 0;const s=o(r(6449)),a=r(932),c=r(3474);let u,l=!1,d=!1,h=!1;t.initializeWebAssembly=async e=>{if(l)return Promise.resolve();if(d)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(h)throw new Error("previous call to 'initializeWebAssembly()' failed.");d=!0;const t=e.initTimeout,n=e.numThreads,i=e.simd,o=n>1&&(()=>{try{return"undefined"!=typeof SharedArrayBuffer&&("undefined"!=typeof MessageChannel&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])))}catch(e){return!1}})(),f=i&&(()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch(e){return!1}})(),p=e.wasmPaths,m="string"==typeof p?p:void 0,g=((e,t)=>t?e?"ort-wasm-simd-threaded.wasm":"ort-wasm-threaded.wasm":e?"ort-wasm-simd.wasm":"ort-wasm.wasm")(f,o),v="object"==typeof p?p[g]:void 0;let y=!1;const b=[];if(t>0&&b.push(new Promise((e=>{setTimeout((()=>{y=!0,e()}),t)}))),b.push(new Promise(((e,t)=>{const n=o?c:a,i={locateFile:(e,t)=>o&&e.endsWith(".worker.js")&&"undefined"!=typeof Blob?URL.createObjectURL(new Blob([r(4154)],{type:"text/javascript"})):e.endsWith(".wasm")?v||(null!=m?m:t)+g:t+e};if(o)if("undefined"==typeof Blob)i.mainScriptUrlOrBlob=s.join("/","ort-wasm-threaded.js");else{const e=`var ortWasmThreaded=(function(){var _scriptDir;return ${n.toString()}})();`;i.mainScriptUrlOrBlob=new Blob([e],{type:"text/javascript"})}n(i).then((t=>{d=!1,l=!0,u=t,e()}),(e=>{d=!1,h=!0,t(e)}))}))),await Promise.race(b),y)throw new Error(`WebAssembly backend initializing failed due to timeout: ${t}ms`)},t.getInstance=()=>{if(l&&u)return u;throw new Error("WebAssembly is not initialized yet.")},t.dispose=()=>{var e;!l||d||h||(d=!0,null===(e=u.PThread)||void 0===e||e.terminateAllThreads(),u=void 0,d=!1,l=!1,h=!0)}},8050:(e,t,r)=>{r.d(t,{Z:()=>o});var n=r(6614),i=r.n(n);function o(){return i()('/*!\n* ONNX Runtime Web v1.15.1\n* Copyright (c) Microsoft Corporation. All rights reserved.\n* Licensed under the MIT License.\n*/\n(()=>{var e={899:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.iterateExtraOptions=void 0,t.iterateExtraOptions=(e,n,r,a)=>{if("object"==typeof e&&null!==e){if(r.has(e))throw new Error("Circular reference in options");r.add(e)}Object.entries(e).forEach((([e,o])=>{const i=n?n+e:e;if("object"==typeof o)(0,t.iterateExtraOptions)(o,i+".",r,a);else if("string"==typeof o||"number"==typeof o)a(i,o.toString());else{if("boolean"!=typeof o)throw new Error("Can\'t handle extra config type: "+typeof o);a(i,o?"1":"0")}}))}},918:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setRunOptions=void 0;const r=n(899),a=n(444),o=n(263);t.setRunOptions=e=>{const t=(0,o.getInstance)();let n=0;const i=[],s=e||{};try{if(void 0===(null==e?void 0:e.logSeverityLevel))s.logSeverityLevel=2;else if("number"!=typeof e.logSeverityLevel||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${e.logSeverityLevel}`);if(void 0===(null==e?void 0:e.logVerbosityLevel))s.logVerbosityLevel=0;else if("number"!=typeof e.logVerbosityLevel||!Number.isInteger(e.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);void 0===(null==e?void 0:e.terminate)&&(s.terminate=!1);let o=0;if(void 0!==(null==e?void 0:e.tag)&&(o=(0,a.allocWasmString)(e.tag,i)),n=t._OrtCreateRunOptions(s.logSeverityLevel,s.logVerbosityLevel,!!s.terminate,o),0===n)throw new Error("Can\'t create run options");return void 0!==(null==e?void 0:e.extra)&&(0,r.iterateExtraOptions)(e.extra,"",new WeakSet,((e,r)=>{const o=(0,a.allocWasmString)(e,i),s=(0,a.allocWasmString)(r,i);if(0!==t._OrtAddRunConfigEntry(n,o,s))throw new Error(`Can\'t set a run config entry: ${e} - ${r}`)})),[n,i]}catch(e){throw 0!==n&&t._OrtReleaseRunOptions(n),i.forEach(t._free),e}}},622:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setSessionOptions=void 0;const r=n(899),a=n(444),o=n(263);t.setSessionOptions=e=>{var t,n,i,s;const u=(0,o.getInstance)();let c=0;const l=[],f=e||{};(e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});const t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some((e=>"webgpu"===("string"==typeof e?e:e.name)))&&(e.enableMemPattern=!1)})(f);try{const e=(e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${e}`)}})(null!==(t=f.graphOptimizationLevel)&&void 0!==t?t:"all"),p=(e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${e}`)}})(null!==(n=f.executionMode)&&void 0!==n?n:"sequential"),d="string"==typeof f.logId?(0,a.allocWasmString)(f.logId,l):0,m=null!==(i=f.logSeverityLevel)&&void 0!==i?i:2;if(!Number.isInteger(m)||m<0||m>4)throw new Error(`log serverity level is not valid: ${m}`);const g=null!==(s=f.logVerbosityLevel)&&void 0!==s?s:0;if(!Number.isInteger(g)||g<0||g>4)throw new Error(`log verbosity level is not valid: ${g}`);const h="string"==typeof f.optimizedModelFilePath?(0,a.allocWasmString)(f.optimizedModelFilePath,l):0;if(c=u._OrtCreateSessionOptions(e,!!f.enableCpuMemArena,!!f.enableMemPattern,p,!!f.enableProfiling,0,d,m,g,h),0===c)throw new Error("Can\'t create session options");return f.executionProviders&&((e,t,n)=>{for(const r of t){let t="string"==typeof r?r:r.name;switch(t){case"xnnpack":t="XNNPACK";break;case"webgpu":t="JS";break;case"wasm":case"cpu":continue;default:throw new Error(`not supported EP: ${t}`)}const i=(0,a.allocWasmString)(t,n);if(0!==(0,o.getInstance)()._OrtAppendExecutionProvider(e,i))throw new Error(`Can\'t append execution provider: ${t}`)}})(c,f.executionProviders,l),void 0!==f.extra&&(0,r.iterateExtraOptions)(f.extra,"",new WeakSet,((e,t)=>{const n=(0,a.allocWasmString)(e,l),r=(0,a.allocWasmString)(t,l);if(0!==u._OrtAddSessionConfigEntry(c,n,r))throw new Error(`Can\'t set a session config entry: ${e} - ${t}`)})),[c,l]}catch(e){throw 0!==c&&u._OrtReleaseSessionOptions(c),l.forEach(u._free),e}}},444:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.allocWasmString=void 0;const r=n(263);t.allocWasmString=(e,t)=>{const n=(0,r.getInstance)(),a=n.lengthBytesUTF8(e)+1,o=n._malloc(a);return n.stringToUTF8(e,o,a),t.push(o),o}},917:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logLevelStringToEnum=t.tensorTypeToTypedArrayConstructor=t.getTensorElementSize=t.tensorDataTypeEnumToString=t.tensorDataTypeStringToEnum=void 0,t.tensorDataTypeStringToEnum=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${e}`)}},t.tensorDataTypeEnumToString=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${e}`)}},t.getTensorElementSize=e=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][e],t.tensorTypeToTypedArrayConstructor=e=>{switch(e){case"float32":return Float32Array;case"uint8":case"bool":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${e}`)}},t.logLevelStringToEnum=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${e}`)}}},259:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extractTransferableBuffers=t.endProfiling=t.run=t.releaseSession=t.createSession=t.createSessionFinalize=t.createSessionAllocate=t.initOrt=void 0;const r=n(918),a=n(622),o=n(444),i=n(917),s=n(263);t.initOrt=(e,t)=>{const n=(0,s.getInstance)()._OrtInit(e,t);if(0!==n)throw new Error(`Can\'t initialize onnxruntime. error code = ${n}`)};const u=new Map;t.createSessionAllocate=e=>{const t=(0,s.getInstance)(),n=t._malloc(e.byteLength);return t.HEAPU8.set(e,n),[n,e.byteLength]},t.createSessionFinalize=(e,t)=>{const n=(0,s.getInstance)();let r=0,o=0,i=[];try{if([o,i]=(0,a.setSessionOptions)(t),r=n._OrtCreateSession(e[0],e[1],o),0===r)throw new Error("Can\'t create a session")}finally{n._free(e[0]),0!==o&&n._OrtReleaseSessionOptions(o),i.forEach(n._free)}const c=n._OrtGetInputCount(r),l=n._OrtGetOutputCount(r),f=[],p=[],d=[],m=[];for(let e=0;e<c;e++){const t=n._OrtGetInputName(r,e);if(0===t)throw new Error("Can\'t get an input name");p.push(t),f.push(n.UTF8ToString(t))}for(let e=0;e<l;e++){const t=n._OrtGetOutputName(r,e);if(0===t)throw new Error("Can\'t get an output name");m.push(t),d.push(n.UTF8ToString(t))}return u.set(r,[r,p,m]),[r,f,d]},t.createSession=(e,n)=>{const r=(0,t.createSessionAllocate)(e);return(0,t.createSessionFinalize)(r,n)},t.releaseSession=e=>{const t=(0,s.getInstance)(),n=u.get(e);if(!n)throw new Error("invalid session id");const r=n[0],a=n[1],o=n[2];a.forEach(t._OrtFree),o.forEach(t._OrtFree),t._OrtReleaseSession(r),u.delete(e)},t.run=async(e,t,n,a,c)=>{const l=(0,s.getInstance)(),f=u.get(e);if(!f)throw new Error("invalid session id");const p=f[0],d=f[1],m=f[2],g=t.length,h=a.length;let y=0,v=[];const b=[],w=[];try{[y,v]=(0,r.setRunOptions)(c);for(let e=0;e<g;e++){const t=n[e][0],r=n[e][1],a=n[e][2];let s,u;if(Array.isArray(a)){u=4*a.length,s=l._malloc(u),w.push(s);let e=s/4;for(let t=0;t<a.length;t++){if("string"!=typeof a[t])throw new TypeError(`tensor data at index ${t} is not a string`);l.HEAPU32[e++]=(0,o.allocWasmString)(a[t],w)}}else u=a.byteLength,s=l._malloc(u),w.push(s),l.HEAPU8.set(new Uint8Array(a.buffer,a.byteOffset,u),s);const c=l.stackSave(),f=l.stackAlloc(4*r.length);try{let e=f/4;r.forEach((t=>l.HEAP32[e++]=t));const n=l._OrtCreateTensor((0,i.tensorDataTypeStringToEnum)(t),s,u,f,r.length);if(0===n)throw new Error("Can\'t create a tensor");b.push(n)}finally{l.stackRestore(c)}}const e=l.stackSave(),s=l.stackAlloc(4*g),u=l.stackAlloc(4*g),f=l.stackAlloc(4*h),_=l.stackAlloc(4*h);try{let e=s/4,n=u/4,r=f/4,o=_/4;for(let r=0;r<g;r++)l.HEAPU32[e++]=b[r],l.HEAPU32[n++]=d[t[r]];for(let e=0;e<h;e++)l.HEAPU32[r++]=0,l.HEAPU32[o++]=m[a[e]];let c=l._OrtRun(p,u,s,g,_,h,f,y);const v=l.jsepRunPromise;v&&void 0!==v.then&&(c=await v);const w=[];if(0===c)for(let e=0;e<h;e++){const t=l.HEAPU32[f/4+e],n=l.stackSave(),r=l.stackAlloc(16);let a,o=0;try{if(c=l._OrtGetTensorData(t,r,r+4,r+8,r+12),0!==c)throw new Error(`Can\'t access output tensor data. error code = ${c}`);let e=r/4;const n=l.HEAPU32[e++];o=l.HEAPU32[e++];const s=l.HEAPU32[e++],u=l.HEAPU32[e++],f=[];for(let e=0;e<u;e++)f.push(l.HEAPU32[s/4+e]);l._OrtFree(s);const p=0===f.length?1:f.reduce(((e,t)=>e*t));if(a=(0,i.tensorDataTypeEnumToString)(n),"string"===a){const e=[];let t=o/4;for(let n=0;n<p;n++){const r=l.HEAPU32[t++],a=n===p-1?void 0:l.HEAPU32[t]-r;e.push(l.UTF8ToString(r,a))}w.push([a,f,e])}else{const e=new((0,i.tensorTypeToTypedArrayConstructor)(a))(p);new Uint8Array(e.buffer,e.byteOffset,e.byteLength).set(l.HEAPU8.subarray(o,o+e.byteLength)),w.push([a,f,e])}}finally{l.stackRestore(n),"string"===a&&o&&l._free(o),l._OrtReleaseTensor(t)}}if(0===c)return w;throw new Error(`failed to call OrtRun(). error code = ${c}.`)}finally{l.stackRestore(e)}}finally{b.forEach(l._OrtReleaseTensor),w.forEach(l._free),l._OrtReleaseRunOptions(y),v.forEach(l._free)}},t.endProfiling=e=>{const t=(0,s.getInstance)(),n=u.get(e);if(!n)throw new Error("invalid session id");const r=n[0],a=t._OrtEndProfiling(r);if(0===a)throw new Error("Can\'t get an profile file name");t._OrtFree(a)},t.extractTransferableBuffers=e=>{const t=[];for(const n of e){const e=n[2];!Array.isArray(e)&&e.buffer&&t.push(e.buffer)}return t}},263:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.dispose=t.getInstance=t.initializeWebAssembly=void 0;const i=o(n(449)),s=n(932),u=n(474);let c,l=!1,f=!1,p=!1;t.initializeWebAssembly=async e=>{if(l)return Promise.resolve();if(f)throw new Error("multiple calls to \'initializeWebAssembly()\' detected.");if(p)throw new Error("previous call to \'initializeWebAssembly()\' failed.");f=!0;const t=e.initTimeout,r=e.numThreads,a=e.simd,o=r>1&&(()=>{try{return"undefined"!=typeof SharedArrayBuffer&&("undefined"!=typeof MessageChannel&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])))}catch(e){return!1}})(),d=a&&(()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch(e){return!1}})(),m=e.wasmPaths,g="string"==typeof m?m:void 0,h=((e,t)=>t?e?"ort-wasm-simd-threaded.wasm":"ort-wasm-threaded.wasm":e?"ort-wasm-simd.wasm":"ort-wasm.wasm")(d,o),y="object"==typeof m?m[h]:void 0;let v=!1;const b=[];if(t>0&&b.push(new Promise((e=>{setTimeout((()=>{v=!0,e()}),t)}))),b.push(new Promise(((e,t)=>{const r=o?u:s,a={locateFile:(e,t)=>o&&e.endsWith(".worker.js")&&"undefined"!=typeof Blob?URL.createObjectURL(new Blob([n(154)],{type:"text/javascript"})):e.endsWith(".wasm")?y||(null!=g?g:t)+h:t+e};if(o)if("undefined"==typeof Blob)a.mainScriptUrlOrBlob=i.join("/","ort-wasm-threaded.js");else{const e=`var ortWasmThreaded=(function(){var _scriptDir;return ${r.toString()}})();`;a.mainScriptUrlOrBlob=new Blob([e],{type:"text/javascript"})}r(a).then((t=>{f=!1,l=!0,c=t,e()}),(e=>{f=!1,p=!0,t(e)}))}))),await Promise.race(b),v)throw new Error(`WebAssembly backend initializing failed due to timeout: ${t}ms`)},t.getInstance=()=>{if(l&&c)return c;throw new Error("WebAssembly is not initialized yet.")},t.dispose=()=>{var e;!l||f||p||(f=!0,null===(e=c.PThread)||void 0===e||e.terminateAllThreads(),c=void 0,f=!1,l=!1,p=!0)}},474:(e,t,n)=>{var _scriptDir,r=(_scriptDir=(_scriptDir="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(e){function t(){return P.buffer!=D&&G(P.buffer),F}function r(){return P.buffer!=D&&G(P.buffer),U}function a(){return P.buffer!=D&&G(P.buffer),I}function o(){return P.buffer!=D&&G(P.buffer),W}function i(){return P.buffer!=D&&G(P.buffer),j}var s,u,c;e=e||{},s||(s=void 0!==e?e:{}),s.ready=new Promise((function(e,t){u=e,c=t}));var l,f,p,d,m,g,h=Object.assign({},s),y="./this.program",v=(e,t)=>{throw t},b="object"==typeof window,w="function"==typeof importScripts,_="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,O=s.ENVIRONMENT_IS_PTHREAD||!1,S="";function T(e){return s.locateFile?s.locateFile(e,S):S+e}if(_){let t;S=w?n(908).dirname(S)+"/":"//",g=()=>{m||(d=n(384),m=n(908))},l=function(e,t){return g(),e=m.normalize(e),d.readFileSync(e,t?void 0:"utf8")},p=e=>((e=l(e,!0)).buffer||(e=new Uint8Array(e)),e),f=(e,t,n)=>{g(),e=m.normalize(e),d.readFile(e,(function(e,r){e?n(e):t(r.buffer)}))},1<process.argv.length&&(y=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",(function(e){if(!(e instanceof ie))throw e})),process.on("unhandledRejection",(function(e){throw e})),v=(e,t)=>{if(C)throw process.exitCode=e,t;t instanceof ie||x("exiting due to exception: "+t),process.exit(e)},s.inspect=function(){return"[Emscripten Module object]"};try{t=n(925)}catch(e){throw console.error(\'The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?\'),e}n.g.Worker=t.Worker}else(b||w)&&(w?S=globalThis.location.href:"undefined"!=typeof document&&document.currentScript&&(S=document.currentScript.src),_scriptDir&&(S=_scriptDir),S=0!==S.indexOf("blob:")?S.substr(0,S.replace(/[?#].*/,"").lastIndexOf("/")+1):"",_||(l=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},w&&(p=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),f=(e,t,n)=>{var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=()=>{200==r.status||0==r.status&&r.response?t(r.response):n()},r.onerror=n,r.send(null)}));_&&"undefined"==typeof performance&&(n.g.performance=n(953).performance);var A=console.log.bind(console),E=console.warn.bind(console);_&&(g(),A=e=>d.writeSync(1,e+"\\n"),E=e=>d.writeSync(2,e+"\\n"));var M,R=s.print||A,x=s.printErr||E;Object.assign(s,h),h=null,s.thisProgram&&(y=s.thisProgram),s.quit&&(v=s.quit),s.wasmBinary&&(M=s.wasmBinary);var C=s.noExitRuntime||!0;"object"!=typeof WebAssembly&&ne("no native wasm support detected");var P,k,D,F,U,I,W,j,H=!1,L="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function Y(e,t,n){var r=(t>>>=0)+n;for(n=t;e[n]&&!(n>=r);)++n;if(16<n-t&&e.buffer&&L)return L.decode(e.buffer instanceof SharedArrayBuffer?e.slice(t,n):e.subarray(t,n));for(r="";t<n;){var a=e[t++];if(128&a){var o=63&e[t++];if(192==(224&a))r+=String.fromCharCode((31&a)<<6|o);else{var i=63&e[t++];65536>(a=224==(240&a)?(15&a)<<12|o<<6|i:(7&a)<<18|o<<12|i<<6|63&e[t++])?r+=String.fromCharCode(a):(a-=65536,r+=String.fromCharCode(55296|a>>10,56320|1023&a))}}else r+=String.fromCharCode(a)}return r}function z(e,t){return(e>>>=0)?Y(r(),e,t):""}function B(e,t,n,r){if(!(0<r))return 0;var a=n>>>=0;r=n+r-1;for(var o=0;o<e.length;++o){var i=e.charCodeAt(o);if(55296<=i&&57343>=i&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++o)),127>=i){if(n>=r)break;t[n++>>>0]=i}else{if(2047>=i){if(n+1>=r)break;t[n++>>>0]=192|i>>6}else{if(65535>=i){if(n+2>=r)break;t[n++>>>0]=224|i>>12}else{if(n+3>=r)break;t[n++>>>0]=240|i>>18,t[n++>>>0]=128|i>>12&63}t[n++>>>0]=128|i>>6&63}t[n++>>>0]=128|63&i}}return t[n>>>0]=0,n-a}function N(e){for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);127>=r?t++:2047>=r?t+=2:55296<=r&&57343>=r?(t+=4,++n):t+=3}return t}function G(e){D=e,s.HEAP8=F=new Int8Array(e),s.HEAP16=new Int16Array(e),s.HEAP32=I=new Int32Array(e),s.HEAPU8=U=new Uint8Array(e),s.HEAPU16=new Uint16Array(e),s.HEAPU32=W=new Uint32Array(e),s.HEAPF32=new Float32Array(e),s.HEAPF64=j=new Float64Array(e)}O&&(D=s.buffer);var q=s.INITIAL_MEMORY||16777216;if(O)P=s.wasmMemory,D=s.buffer;else if(s.wasmMemory)P=s.wasmMemory;else if(!((P=new WebAssembly.Memory({initial:q/65536,maximum:65536,shared:!0})).buffer instanceof SharedArrayBuffer))throw x("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),_&&console.log("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and also use a recent version)"),Error("bad memory");P&&(D=P.buffer),q=D.byteLength,G(D);var $,V=[],J=[],Q=[];function X(){var e=s.preRun.shift();V.unshift(e)}var K,Z=0,ee=null,te=null;function ne(e){throw O?postMessage({cmd:"onAbort",arg:e}):s.onAbort&&s.onAbort(e),x(e="Aborted("+e+")"),H=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),c(e),e}function re(){return K.startsWith("data:application/octet-stream;base64,")}function ae(){var e=K;try{if(e==K&&M)return new Uint8Array(M);if(p)return p(e);throw"both async and sync fetching of the wasm failed"}catch(e){ne(e)}}K="ort-wasm-threaded.wasm",re()||(K=T(K));var oe={};function ie(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function se(e){(e=fe.La[e])||ne(),fe.Xa(e)}function ue(e){var t=fe.lb();if(!t)return 6;fe.Ra.push(t),fe.La[e.Ka]=t,t.Ka=e.Ka;var n={cmd:"run",start_routine:e.pb,arg:e.ib,pthread_ptr:e.Ka};return t.Qa=()=>{n.time=performance.now(),t.postMessage(n,e.vb)},t.loaded&&(t.Qa(),delete t.Qa),0}function ce(e){if(O)return He(1,1,e);C||(fe.qb(),s.onExit&&s.onExit(e),H=!0),v(e,new ie(e))}function le(e,t){if(!t&&O)throw de(e),"unwind";ce(e)}var fe={Oa:[],Ra:[],$a:[],La:{},Ua:function(){O&&fe.mb()},xb:function(){},mb:function(){fe.receiveObjectTransfer=fe.ob,fe.threadInitTLS=fe.Za,fe.setExitStatus=fe.Ya,C=!1},Ya:function(){},qb:function(){for(var e of Object.values(fe.La))fe.Xa(e);for(e of fe.Oa)e.terminate();fe.Oa=[]},Xa:function(e){var t=e.Ka;delete fe.La[t],fe.Oa.push(e),fe.Ra.splice(fe.Ra.indexOf(e),1),e.Ka=0,ct(t)},ob:function(){},Za:function(){fe.$a.forEach((e=>e()))},nb:function(e,t){e.onmessage=n=>{var r=(n=n.data).cmd;if(e.Ka&&(fe.kb=e.Ka),n.targetThread&&n.targetThread!=rt()){var a=fe.La[n.yb];a?a.postMessage(n,n.transferList):x(\'Internal error! Worker sent a message "\'+r+\'" to target pthread \'+n.targetThread+", but that thread no longer exists!")}else"processProxyingQueue"===r?De(n.queue):"spawnThread"===r?ue(n):"cleanupThread"===r?se(n.thread):"killThread"===r?(n=n.thread,r=fe.La[n],delete fe.La[n],r.terminate(),ct(n),fe.Ra.splice(fe.Ra.indexOf(r),1),r.Ka=0):"cancelThread"===r?fe.La[n.thread].postMessage({cmd:"cancel"}):"loaded"===r?(e.loaded=!0,t&&t(e),e.Qa&&(e.Qa(),delete e.Qa)):"print"===r?R("Thread "+n.threadId+": "+n.text):"printErr"===r?x("Thread "+n.threadId+": "+n.text):"alert"===r?alert("Thread "+n.threadId+": "+n.text):"setimmediate"===n.target?e.postMessage(n):"onAbort"===r?s.onAbort&&s.onAbort(n.arg):r&&x("worker sent an unknown command "+r);fe.kb=void 0},e.onerror=e=>{throw x("worker sent an error! "+e.filename+":"+e.lineno+": "+e.message),e},_&&(e.on("message",(function(t){e.onmessage({data:t})})),e.on("error",(function(t){e.onerror(t)})),e.on("detachedExit",(function(){}))),e.postMessage({cmd:"load",urlOrBlob:s.mainScriptUrlOrBlob||_scriptDir,wasmMemory:P,wasmModule:k})},hb:function(){var e=T("ort-wasm-threaded.worker.js");fe.Oa.push(new Worker(e))},lb:function(){return 0==fe.Oa.length&&(fe.hb(),fe.nb(fe.Oa[0])),fe.Oa.pop()}};function pe(e){for(;0<e.length;)e.shift()(s)}function de(e){if(O)return He(2,0,e);try{le(e)}catch(e){e instanceof ie||"unwind"==e||v(1,e)}}s.PThread=fe,s.establishStackSpace=function(){var e=rt(),t=a()[e+44>>2>>>0];e=a()[e+48>>2>>>0],ft(t,t-e),dt(t)};var me,ge,he=[];function ye(e){this.Pa=e-24,this.gb=function(e){o()[this.Pa+4>>2>>>0]=e},this.cb=function(e){o()[this.Pa+8>>2>>>0]=e},this.eb=function(){a()[this.Pa>>2>>>0]=0},this.bb=function(){t()[this.Pa+12>>0>>>0]=0},this.fb=function(){t()[this.Pa+13>>0>>>0]=0},this.Ua=function(e,t){this.ab(),this.gb(e),this.cb(t),this.eb(),this.bb(),this.fb()},this.ab=function(){o()[this.Pa+16>>2>>>0]=0}}function ve(e,t,n,r){return O?He(3,1,e,t,n,r):be(e,t,n,r)}function be(e,t,n,r){if("undefined"==typeof SharedArrayBuffer)return x("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var a=[];return O&&0===a.length?ve(e,t,n,r):(e={pb:n,Ka:e,ib:r,vb:a},O?(e.wb="spawnThread",postMessage(e,a),0):ue(e))}function we(e,t,n){return O?He(4,1,e,t,n):0}function _e(e,t){if(O)return He(5,1,e,t)}function Oe(e,t){if(O)return He(6,1,e,t)}function Se(e,t,n){if(O)return He(7,1,e,t,n)}function Te(e,t,n){return O?He(8,1,e,t,n):0}function Ae(e,t){if(O)return He(9,1,e,t)}function Ee(e,t,n){if(O)return He(10,1,e,t,n)}function Me(e,t,n,r){if(O)return He(11,1,e,t,n,r)}function Re(e,t,n,r){if(O)return He(12,1,e,t,n,r)}function xe(e,t,n,r){if(O)return He(13,1,e,t,n,r)}function Ce(e){if(O)return He(14,1,e)}function Pe(e,t){if(O)return He(15,1,e,t)}function ke(e,t,n){if(O)return He(16,1,e,t,n)}function De(e){Atomics.store(a(),e>>2,1),rt()&&ut(e),Atomics.compareExchange(a(),e>>2,1,0)}function Fe(e){return o()[e>>>2]+4294967296*a()[e+4>>>2]}function Ue(e,t,n,r,a,o){return O?He(17,1,e,t,n,r,a,o):-52}function Ie(e,t,n,r,a,o){if(O)return He(18,1,e,t,n,r,a,o)}function We(e){var n=N(e)+1,r=at(n);return r&&B(e,t(),r,n),r}function je(e,t,n){function r(e){return(e=e.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?e[1]:"GMT"}if(O)return He(19,1,e,t,n);var i=(new Date).getFullYear(),s=new Date(i,0,1),u=new Date(i,6,1);i=s.getTimezoneOffset();var c=u.getTimezoneOffset(),l=Math.max(i,c);a()[e>>2>>>0]=60*l,a()[t>>2>>>0]=Number(i!=c),e=r(s),t=r(u),e=We(e),t=We(t),c<i?(o()[n>>2>>>0]=e,o()[n+4>>2>>>0]=t):(o()[n>>2>>>0]=t,o()[n+4>>2>>>0]=e)}function He(e,t){var n=arguments.length-2,r=arguments;return function(e){var t=pt();return e=e(),dt(t),e}((()=>{for(var a=mt(8*n),o=a>>3,s=0;s<n;s++){var u=r[2+s];i()[o+s>>>0]=u}return st(e,n,a,t)}))}s.invokeEntryPoint=function(e,t){var n=he[e];n||(e>=he.length&&(he.length=e+1),he[e]=n=$.get(e)),e=n(t),C?fe.Ya(e):lt(e)},s.executeNotifiedProxyingQueue=De,ge=_?()=>{var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:O?()=>performance.now()-s.__performance_now_clock_drift:()=>performance.now();var Le,Ye=[],ze={};function Be(){if(!Le){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:y||"./this.program"};for(e in ze)void 0===ze[e]?delete t[e]:t[e]=ze[e];var n=[];for(e in t)n.push(e+"="+t[e]);Le=n}return Le}function Ne(e,n){if(O)return He(20,1,e,n);var r=0;return Be().forEach((function(a,i){var s=n+r;for(i=o()[e+4*i>>2>>>0]=s,s=0;s<a.length;++s)t()[i++>>0>>>0]=a.charCodeAt(s);t()[i>>0>>>0]=0,r+=a.length+1})),0}function Ge(e,t){if(O)return He(21,1,e,t);var n=Be();o()[e>>2>>>0]=n.length;var r=0;return n.forEach((function(e){r+=e.length+1})),o()[t>>2>>>0]=r,0}function qe(e){return O?He(22,1,e):52}function $e(e,t,n,r){return O?He(23,1,e,t,n,r):52}function Ve(e,t,n,r,a){return O?He(24,1,e,t,n,r,a):70}var Je=[null,[],[]];function Qe(e,t,n,a){if(O)return He(25,1,e,t,n,a);for(var i=0,s=0;s<n;s++){var u=o()[t>>2>>>0],c=o()[t+4>>2>>>0];t+=8;for(var l=0;l<c;l++){var f=r()[u+l>>>0],p=Je[e];0===f||10===f?((1===e?R:x)(Y(p,0)),p.length=0):p.push(f)}i+=c}return o()[a>>2>>>0]=i,0}function Xe(e){return 0==e%4&&(0!=e%100||0==e%400)}var Ke=[31,29,31,30,31,30,31,31,30,31,30,31],Ze=[31,28,31,30,31,30,31,31,30,31,30,31];function et(e,n,r,o){function i(e,t,n){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=n[0]+e;return e}function s(e,t){return i(e,t,"0")}function u(e,t){function n(e){return 0>e?-1:0<e?1:0}var r;return 0===(r=n(e.getFullYear()-t.getFullYear()))&&0===(r=n(e.getMonth()-t.getMonth()))&&(r=n(e.getDate()-t.getDate())),r}function c(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function l(e){var t=e.Ma;for(e=new Date(new Date(e.Na+1900,0,1).getTime());0<t;){var n=e.getMonth(),r=(Xe(e.getFullYear())?Ke:Ze)[n];if(!(t>r-e.getDate())){e.setDate(e.getDate()+t);break}t-=r-e.getDate()+1,e.setDate(1),11>n?e.setMonth(n+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1))}return n=new Date(e.getFullYear()+1,0,4),t=c(new Date(e.getFullYear(),0,4)),n=c(n),0>=u(t,e)?0>=u(n,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}var f=a()[o+40>>2>>>0];for(var p in o={tb:a()[o>>2>>>0],sb:a()[o+4>>2>>>0],Sa:a()[o+8>>2>>>0],Va:a()[o+12>>2>>>0],Ta:a()[o+16>>2>>>0],Na:a()[o+20>>2>>>0],Ja:a()[o+24>>2>>>0],Ma:a()[o+28>>2>>>0],zb:a()[o+32>>2>>>0],rb:a()[o+36>>2>>>0],ub:f?z(f):""},r=z(r),f={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})r=r.replace(new RegExp(p,"g"),f[p]);var d="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),m="January February March April May June July August September October November December".split(" ");for(p in f={"%a":function(e){return d[e.Ja].substring(0,3)},"%A":function(e){return d[e.Ja]},"%b":function(e){return m[e.Ta].substring(0,3)},"%B":function(e){return m[e.Ta]},"%C":function(e){return s((e.Na+1900)/100|0,2)},"%d":function(e){return s(e.Va,2)},"%e":function(e){return i(e.Va,2," ")},"%g":function(e){return l(e).toString().substring(2)},"%G":function(e){return l(e)},"%H":function(e){return s(e.Sa,2)},"%I":function(e){return 0==(e=e.Sa)?e=12:12<e&&(e-=12),s(e,2)},"%j":function(e){for(var t=0,n=0;n<=e.Ta-1;t+=(Xe(e.Na+1900)?Ke:Ze)[n++]);return s(e.Va+t,3)},"%m":function(e){return s(e.Ta+1,2)},"%M":function(e){return s(e.sb,2)},"%n":function(){return"\\n"},"%p":function(e){return 0<=e.Sa&&12>e.Sa?"AM":"PM"},"%S":function(e){return s(e.tb,2)},"%t":function(){return"\\t"},"%u":function(e){return e.Ja||7},"%U":function(e){return s(Math.floor((e.Ma+7-e.Ja)/7),2)},"%V":function(e){var t=Math.floor((e.Ma+7-(e.Ja+6)%7)/7);if(2>=(e.Ja+371-e.Ma-2)%7&&t++,t)53==t&&(4==(n=(e.Ja+371-e.Ma)%7)||3==n&&Xe(e.Na)||(t=1));else{t=52;var n=(e.Ja+7-e.Ma-1)%7;(4==n||5==n&&Xe(e.Na%400-1))&&t++}return s(t,2)},"%w":function(e){return e.Ja},"%W":function(e){return s(Math.floor((e.Ma+7-(e.Ja+6)%7)/7),2)},"%y":function(e){return(e.Na+1900).toString().substring(2)},"%Y":function(e){return e.Na+1900},"%z":function(e){var t=0<=(e=e.rb);return e=Math.abs(e)/60,(t?"+":"-")+String("0000"+(e/60*100+e%60)).slice(-4)},"%Z":function(e){return e.ub},"%%":function(){return"%"}},r=r.replace(/%%/g,"\\0\\0"),f)r.includes(p)&&(r=r.replace(new RegExp(p,"g"),f[p](o)));return p=function(e){var t=Array(N(e)+1);return B(e,t,0,t.length),t}(r=r.replace(/\\0\\0/g,"%")),p.length>n?0:(function(e,n){t().set(e,n>>>0)}(p,e),p.length-1)}fe.Ua();var tt=[null,ce,de,ve,we,_e,Oe,Se,Te,Ae,Ee,Me,Re,xe,Ce,Pe,ke,Ue,Ie,je,Ne,Ge,qe,$e,Ve,Qe],nt={b:function(e){return at(e+24)+24},c:function(e,t,n){throw new ye(e).Ua(t,n),e},L:function(e){ot(e,!w,1,!b),fe.Za()},l:function(e){O?postMessage({cmd:"cleanupThread",thread:e}):se(e)},D:be,i:we,R:_e,z:Oe,B:Se,T:Te,P:Ae,I:Ee,O:Me,p:Re,A:xe,x:Ce,Q:Pe,y:ke,r:function(){},j:function(){ne("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},s:function(){ne("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},q:function(){return Date.now()},E:function(){return 2097152},V:function(){return!0},F:function(e,t,n,r){if(e==t)setTimeout((()=>De(r)));else if(O)postMessage({targetThread:e,cmd:"processProxyingQueue",queue:r});else{if(!(e=fe.La[e]))return;e.postMessage({cmd:"processProxyingQueue",queue:r})}return 1},K:function(){return-1},W:function(e,t){e=new Date(1e3*Fe(e)),a()[t>>2>>>0]=e.getUTCSeconds(),a()[t+4>>2>>>0]=e.getUTCMinutes(),a()[t+8>>2>>>0]=e.getUTCHours(),a()[t+12>>2>>>0]=e.getUTCDate(),a()[t+16>>2>>>0]=e.getUTCMonth(),a()[t+20>>2>>>0]=e.getUTCFullYear()-1900,a()[t+24>>2>>>0]=e.getUTCDay(),e=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,a()[t+28>>2>>>0]=e},X:function(e,t){e=new Date(1e3*Fe(e)),a()[t>>2>>>0]=e.getSeconds(),a()[t+4>>2>>>0]=e.getMinutes(),a()[t+8>>2>>>0]=e.getHours(),a()[t+12>>2>>>0]=e.getDate(),a()[t+16>>2>>>0]=e.getMonth(),a()[t+20>>2>>>0]=e.getFullYear()-1900,a()[t+24>>2>>>0]=e.getDay();var n=new Date(e.getFullYear(),0,1),r=(e.getTime()-n.getTime())/864e5|0;a()[t+28>>2>>>0]=r,a()[t+36>>2>>>0]=-60*e.getTimezoneOffset(),r=new Date(e.getFullYear(),6,1).getTimezoneOffset(),e=0|(r!=(n=n.getTimezoneOffset())&&e.getTimezoneOffset()==Math.min(n,r)),a()[t+32>>2>>>0]=e},Y:function(e){var t=new Date(a()[e+20>>2>>>0]+1900,a()[e+16>>2>>>0],a()[e+12>>2>>>0],a()[e+8>>2>>>0],a()[e+4>>2>>>0],a()[e>>2>>>0],0),n=a()[e+32>>2>>>0],r=t.getTimezoneOffset(),o=new Date(t.getFullYear(),0,1),i=new Date(t.getFullYear(),6,1).getTimezoneOffset(),s=o.getTimezoneOffset(),u=Math.min(s,i);return 0>n?a()[e+32>>2>>>0]=Number(i!=s&&u==r):0<n!=(u==r)&&(i=Math.max(s,i),t.setTime(t.getTime()+6e4*((0<n?u:i)-r))),a()[e+24>>2>>>0]=t.getDay(),n=(t.getTime()-o.getTime())/864e5|0,a()[e+28>>2>>>0]=n,a()[e>>2>>>0]=t.getSeconds(),a()[e+4>>2>>>0]=t.getMinutes(),a()[e+8>>2>>>0]=t.getHours(),a()[e+12>>2>>>0]=t.getDate(),a()[e+16>>2>>>0]=t.getMonth(),t.getTime()/1e3|0},G:Ue,H:Ie,Z:function e(t,n,r){e.jb||(e.jb=!0,je(t,n,r))},d:function(){ne("")},m:function(){if(!_&&!w){var e="Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread";me||(me={}),me[e]||(me[e]=1,_&&(e="warning: "+e),x(e))}},w:function(){return 4294901760},f:ge,S:function(e,t,n){r().copyWithin(e>>>0,t>>>0,t+n>>>0)},g:function(){return _?n(993).cpus().length:navigator.hardwareConcurrency},J:function(e,t,n){Ye.length=t,n>>=3;for(var r=0;r<t;r++)Ye[r]=i()[n+r>>>0];return(0>e?oe[-e-1]:tt[e]).apply(null,Ye)},v:function(e){var t=r().length;if((e>>>=0)<=t||4294901760<e)return!1;for(var n=1;4>=n;n*=2){var a=t*(1+.2/n);a=Math.min(a,e+100663296);var o=Math;a=Math.max(e,a),o=o.min.call(o,4294901760,a+(65536-a%65536)%65536);e:{try{P.grow(o-D.byteLength+65535>>>16),G(P.buffer);var i=1;break e}catch(e){}i=void 0}if(i)return!0}return!1},U:function(){throw"unwind"},M:Ne,N:Ge,k:le,h:qe,o:$e,t:Ve,n:Qe,u:function e(r,a){e.Wa||(e.Wa=function(){if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var e=new Uint8Array(1);return()=>(crypto.getRandomValues(e),e[0])}if(_)try{var t=n(760);return()=>t.randomBytes(1)[0]}catch(e){}return()=>ne("randomDevice")}());for(var o=0;o<a;o++)t()[r+o>>0>>>0]=e.Wa();return 0},a:P||s.wasmMemory,C:et,e:function(e,t,n,r){return et(e,t,n,r)}};!function(){function e(e,t){s.asm=e.exports,fe.$a.push(s.asm.wa),$=s.asm.za,J.unshift(s.asm._),k=t,O||(Z--,s.monitorRunDependencies&&s.monitorRunDependencies(Z),0==Z&&(null!==ee&&(clearInterval(ee),ee=null),te&&(e=te,te=null,e())))}function t(t){e(t.instance,t.module)}function n(e){return function(){if(!M&&(b||w)){if("function"==typeof fetch&&!K.startsWith("file://"))return fetch(K,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at \'"+K+"\'";return e.arrayBuffer()})).catch((function(){return ae()}));if(f)return new Promise((function(e,t){f(K,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return ae()}))}().then((function(e){return WebAssembly.instantiate(e,r)})).then((function(e){return e})).then(e,(function(e){x("failed to asynchronously prepare wasm: "+e),ne(e)}))}var r={a:nt};if(O||(Z++,s.monitorRunDependencies&&s.monitorRunDependencies(Z)),s.instantiateWasm)try{return s.instantiateWasm(r,e)}catch(e){return x("Module.instantiateWasm callback failed with error: "+e),!1}(M||"function"!=typeof WebAssembly.instantiateStreaming||re()||K.startsWith("file://")||_||"function"!=typeof fetch?n(t):fetch(K,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,r).then(t,(function(e){return x("wasm streaming compile failed: "+e),x("falling back to ArrayBuffer instantiation"),n(t)}))}))).catch(c)}(),s.___wasm_call_ctors=function(){return(s.___wasm_call_ctors=s.asm._).apply(null,arguments)},s._OrtInit=function(){return(s._OrtInit=s.asm.$).apply(null,arguments)},s._OrtCreateSessionOptions=function(){return(s._OrtCreateSessionOptions=s.asm.aa).apply(null,arguments)},s._OrtAppendExecutionProvider=function(){return(s._OrtAppendExecutionProvider=s.asm.ba).apply(null,arguments)},s._OrtAddSessionConfigEntry=function(){return(s._OrtAddSessionConfigEntry=s.asm.ca).apply(null,arguments)},s._OrtReleaseSessionOptions=function(){return(s._OrtReleaseSessionOptions=s.asm.da).apply(null,arguments)},s._OrtCreateSession=function(){return(s._OrtCreateSession=s.asm.ea).apply(null,arguments)},s._OrtReleaseSession=function(){return(s._OrtReleaseSession=s.asm.fa).apply(null,arguments)},s._OrtGetInputCount=function(){return(s._OrtGetInputCount=s.asm.ga).apply(null,arguments)},s._OrtGetOutputCount=function(){return(s._OrtGetOutputCount=s.asm.ha).apply(null,arguments)},s._OrtGetInputName=function(){return(s._OrtGetInputName=s.asm.ia).apply(null,arguments)},s._OrtGetOutputName=function(){return(s._OrtGetOutputName=s.asm.ja).apply(null,arguments)},s._OrtFree=function(){return(s._OrtFree=s.asm.ka).apply(null,arguments)},s._OrtCreateTensor=function(){return(s._OrtCreateTensor=s.asm.la).apply(null,arguments)},s._OrtGetTensorData=function(){return(s._OrtGetTensorData=s.asm.ma).apply(null,arguments)},s._OrtReleaseTensor=function(){return(s._OrtReleaseTensor=s.asm.na).apply(null,arguments)},s._OrtCreateRunOptions=function(){return(s._OrtCreateRunOptions=s.asm.oa).apply(null,arguments)},s._OrtAddRunConfigEntry=function(){return(s._OrtAddRunConfigEntry=s.asm.pa).apply(null,arguments)},s._OrtReleaseRunOptions=function(){return(s._OrtReleaseRunOptions=s.asm.qa).apply(null,arguments)},s._OrtRun=function(){return(s._OrtRun=s.asm.ra).apply(null,arguments)},s._OrtEndProfiling=function(){return(s._OrtEndProfiling=s.asm.sa).apply(null,arguments)};var rt=s._pthread_self=function(){return(rt=s._pthread_self=s.asm.ta).apply(null,arguments)},at=s._malloc=function(){return(at=s._malloc=s.asm.ua).apply(null,arguments)};s._free=function(){return(s._free=s.asm.va).apply(null,arguments)},s.__emscripten_tls_init=function(){return(s.__emscripten_tls_init=s.asm.wa).apply(null,arguments)};var ot=s.__emscripten_thread_init=function(){return(ot=s.__emscripten_thread_init=s.asm.xa).apply(null,arguments)};s.__emscripten_thread_crashed=function(){return(s.__emscripten_thread_crashed=s.asm.ya).apply(null,arguments)};var it,st=s._emscripten_run_in_main_runtime_thread_js=function(){return(st=s._emscripten_run_in_main_runtime_thread_js=s.asm.Aa).apply(null,arguments)},ut=s.__emscripten_proxy_execute_task_queue=function(){return(ut=s.__emscripten_proxy_execute_task_queue=s.asm.Ba).apply(null,arguments)},ct=s.__emscripten_thread_free_data=function(){return(ct=s.__emscripten_thread_free_data=s.asm.Ca).apply(null,arguments)},lt=s.__emscripten_thread_exit=function(){return(lt=s.__emscripten_thread_exit=s.asm.Da).apply(null,arguments)},ft=s._emscripten_stack_set_limits=function(){return(ft=s._emscripten_stack_set_limits=s.asm.Ea).apply(null,arguments)},pt=s.stackSave=function(){return(pt=s.stackSave=s.asm.Fa).apply(null,arguments)},dt=s.stackRestore=function(){return(dt=s.stackRestore=s.asm.Ga).apply(null,arguments)},mt=s.stackAlloc=function(){return(mt=s.stackAlloc=s.asm.Ha).apply(null,arguments)};function gt(){function e(){if(!it&&(it=!0,s.calledRun=!0,!H)&&(O||pe(J),u(s),s.onRuntimeInitialized&&s.onRuntimeInitialized(),!O)){if(s.postRun)for("function"==typeof s.postRun&&(s.postRun=[s.postRun]);s.postRun.length;){var e=s.postRun.shift();Q.unshift(e)}pe(Q)}}if(!(0<Z))if(O)u(s),O||pe(J),postMessage({cmd:"loaded"});else{if(s.preRun)for("function"==typeof s.preRun&&(s.preRun=[s.preRun]);s.preRun.length;)X();pe(V),0<Z||(s.setStatus?(s.setStatus("Running..."),setTimeout((function(){setTimeout((function(){s.setStatus("")}),1),e()}),1)):e())}}if(s.___cxa_is_pointer_type=function(){return(s.___cxa_is_pointer_type=s.asm.Ia).apply(null,arguments)},s.UTF8ToString=z,s.stringToUTF8=function(e,t,n){return B(e,r(),t,n)},s.lengthBytesUTF8=N,s.keepRuntimeAlive=function(){return C},s.wasmMemory=P,s.stackSave=pt,s.stackRestore=dt,s.stackAlloc=mt,s.ExitStatus=ie,s.PThread=fe,te=function e(){it||gt(),it||(te=e)},s.preInit)for("function"==typeof s.preInit&&(s.preInit=[s.preInit]);0<s.preInit.length;)s.preInit.pop()();return gt(),e.ready});e.exports=r},932:(e,t,n)=>{var _scriptDir,r=(_scriptDir=(_scriptDir="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(e){var t,r,a;e=e||{},t||(t=void 0!==e?e:{}),t.ready=new Promise((function(e,t){r=e,a=t}));var o,i,s,u,c,l,f=Object.assign({},t),p="./this.program",d=(e,t)=>{throw t},m="object"==typeof window,g="function"==typeof importScripts,h="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,y="";h?(y=g?n(908).dirname(y)+"/":"//",l=()=>{c||(u=n(384),c=n(908))},o=function(e,t){return l(),e=c.normalize(e),u.readFileSync(e,t?void 0:"utf8")},s=e=>((e=o(e,!0)).buffer||(e=new Uint8Array(e)),e),i=(e,t,n)=>{l(),e=c.normalize(e),u.readFile(e,(function(e,r){e?n(e):t(r.buffer)}))},1<process.argv.length&&(p=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",(function(e){if(!(e instanceof $))throw e})),process.on("unhandledRejection",(function(e){throw e})),d=(e,t)=>{if(_)throw process.exitCode=e,t;t instanceof $||w("exiting due to exception: "+t),process.exit(e)},t.inspect=function(){return"[Emscripten Module object]"}):(m||g)&&(g?y=globalThis.location.href:"undefined"!=typeof document&&document.currentScript&&(y=document.currentScript.src),_scriptDir&&(y=_scriptDir),y=0!==y.indexOf("blob:")?y.substr(0,y.replace(/[?#].*/,"").lastIndexOf("/")+1):"",o=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},g&&(s=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),i=(e,t,n)=>{var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=()=>{200==r.status||0==r.status&&r.response?t(r.response):n()},r.onerror=n,r.send(null)});var v,b=t.print||console.log.bind(console),w=t.printErr||console.warn.bind(console);Object.assign(t,f),f=null,t.thisProgram&&(p=t.thisProgram),t.quit&&(d=t.quit),t.wasmBinary&&(v=t.wasmBinary);var _=t.noExitRuntime||!0;"object"!=typeof WebAssembly&&B("no native wasm support detected");var O,S,T,A,E,M,R=!1,x="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function C(e,t,n){var r=(t>>>=0)+n;for(n=t;e[n]&&!(n>=r);)++n;if(16<n-t&&e.buffer&&x)return x.decode(e.subarray(t,n));for(r="";t<n;){var a=e[t++];if(128&a){var o=63&e[t++];if(192==(224&a))r+=String.fromCharCode((31&a)<<6|o);else{var i=63&e[t++];65536>(a=224==(240&a)?(15&a)<<12|o<<6|i:(7&a)<<18|o<<12|i<<6|63&e[t++])?r+=String.fromCharCode(a):(a-=65536,r+=String.fromCharCode(55296|a>>10,56320|1023&a))}}else r+=String.fromCharCode(a)}return r}function P(e,t){return(e>>>=0)?C(A,e,t):""}function k(e,t,n,r){if(!(0<r))return 0;var a=n>>>=0;r=n+r-1;for(var o=0;o<e.length;++o){var i=e.charCodeAt(o);if(55296<=i&&57343>=i&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++o)),127>=i){if(n>=r)break;t[n++>>>0]=i}else{if(2047>=i){if(n+1>=r)break;t[n++>>>0]=192|i>>6}else{if(65535>=i){if(n+2>=r)break;t[n++>>>0]=224|i>>12}else{if(n+3>=r)break;t[n++>>>0]=240|i>>18,t[n++>>>0]=128|i>>12&63}t[n++>>>0]=128|i>>6&63}t[n++>>>0]=128|63&i}}return t[n>>>0]=0,n-a}function D(e){for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);127>=r?t++:2047>=r?t+=2:55296<=r&&57343>=r?(t+=4,++n):t+=3}return t}function F(){var e=O.buffer;S=e,t.HEAP8=T=new Int8Array(e),t.HEAP16=new Int16Array(e),t.HEAP32=E=new Int32Array(e),t.HEAPU8=A=new Uint8Array(e),t.HEAPU16=new Uint16Array(e),t.HEAPU32=M=new Uint32Array(e),t.HEAPF32=new Float32Array(e),t.HEAPF64=new Float64Array(e)}var U=[],I=[],W=[];function j(){var e=t.preRun.shift();U.unshift(e)}var H,L=0,Y=null,z=null;function B(e){throw t.onAbort&&t.onAbort(e),w(e="Aborted("+e+")"),R=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),a(e),e}function N(){return H.startsWith("data:application/octet-stream;base64,")}if(H="ort-wasm.wasm",!N()){var G=H;H=t.locateFile?t.locateFile(G,y):y+G}function q(){var e=H;try{if(e==H&&v)return new Uint8Array(v);if(s)return s(e);throw"both async and sync fetching of the wasm failed"}catch(e){B(e)}}function $(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function V(e){for(;0<e.length;)e.shift()(t)}function J(e){this.sa=e-24,this.Ia=function(e){M[this.sa+4>>2>>>0]=e},this.Ba=function(e){M[this.sa+8>>2>>>0]=e},this.Ga=function(){E[this.sa>>2>>>0]=0},this.Aa=function(){T[this.sa+12>>0>>>0]=0},this.Ha=function(){T[this.sa+13>>0>>>0]=0},this.ya=function(e,t){this.za(),this.Ia(e),this.Ba(t),this.Ga(),this.Aa(),this.Ha()},this.za=function(){M[this.sa+16>>2>>>0]=0}}function Q(e){var t=D(e)+1,n=ie(t);return n&&k(e,T,n,t),n}var X={};function K(){if(!Z){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:p||"./this.program"};for(e in X)void 0===X[e]?delete t[e]:t[e]=X[e];var n=[];for(e in t)n.push(e+"="+t[e]);Z=n}return Z}var Z,ee=[null,[],[]];function te(e){return 0==e%4&&(0!=e%100||0==e%400)}var ne=[31,29,31,30,31,30,31,31,30,31,30,31],re=[31,28,31,30,31,30,31,31,30,31,30,31];function ae(e,t,n,r){function a(e,t,n){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=n[0]+e;return e}function o(e,t){return a(e,t,"0")}function i(e,t){function n(e){return 0>e?-1:0<e?1:0}var r;return 0===(r=n(e.getFullYear()-t.getFullYear()))&&0===(r=n(e.getMonth()-t.getMonth()))&&(r=n(e.getDate()-t.getDate())),r}function s(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function u(e){var t=e.qa;for(e=new Date(new Date(e.ra+1900,0,1).getTime());0<t;){var n=e.getMonth(),r=(te(e.getFullYear())?ne:re)[n];if(!(t>r-e.getDate())){e.setDate(e.getDate()+t);break}t-=r-e.getDate()+1,e.setDate(1),11>n?e.setMonth(n+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1))}return n=new Date(e.getFullYear()+1,0,4),t=s(new Date(e.getFullYear(),0,4)),n=s(n),0>=i(t,e)?0>=i(n,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}var c=E[r+40>>2>>>0];for(var l in r={Ea:E[r>>2>>>0],Da:E[r+4>>2>>>0],ta:E[r+8>>2>>>0],va:E[r+12>>2>>>0],ua:E[r+16>>2>>>0],ra:E[r+20>>2>>>0],la:E[r+24>>2>>>0],qa:E[r+28>>2>>>0],Ja:E[r+32>>2>>>0],Ca:E[r+36>>2>>>0],Fa:c?P(c):""},n=P(n),c={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})n=n.replace(new RegExp(l,"g"),c[l]);var f="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),p="January February March April May June July August September October November December".split(" ");for(l in c={"%a":function(e){return f[e.la].substring(0,3)},"%A":function(e){return f[e.la]},"%b":function(e){return p[e.ua].substring(0,3)},"%B":function(e){return p[e.ua]},"%C":function(e){return o((e.ra+1900)/100|0,2)},"%d":function(e){return o(e.va,2)},"%e":function(e){return a(e.va,2," ")},"%g":function(e){return u(e).toString().substring(2)},"%G":function(e){return u(e)},"%H":function(e){return o(e.ta,2)},"%I":function(e){return 0==(e=e.ta)?e=12:12<e&&(e-=12),o(e,2)},"%j":function(e){for(var t=0,n=0;n<=e.ua-1;t+=(te(e.ra+1900)?ne:re)[n++]);return o(e.va+t,3)},"%m":function(e){return o(e.ua+1,2)},"%M":function(e){return o(e.Da,2)},"%n":function(){return"\\n"},"%p":function(e){return 0<=e.ta&&12>e.ta?"AM":"PM"},"%S":function(e){return o(e.Ea,2)},"%t":function(){return"\\t"},"%u":function(e){return e.la||7},"%U":function(e){return o(Math.floor((e.qa+7-e.la)/7),2)},"%V":function(e){var t=Math.floor((e.qa+7-(e.la+6)%7)/7);if(2>=(e.la+371-e.qa-2)%7&&t++,t)53==t&&(4==(n=(e.la+371-e.qa)%7)||3==n&&te(e.ra)||(t=1));else{t=52;var n=(e.la+7-e.qa-1)%7;(4==n||5==n&&te(e.ra%400-1))&&t++}return o(t,2)},"%w":function(e){return e.la},"%W":function(e){return o(Math.floor((e.qa+7-(e.la+6)%7)/7),2)},"%y":function(e){return(e.ra+1900).toString().substring(2)},"%Y":function(e){return e.ra+1900},"%z":function(e){var t=0<=(e=e.Ca);return e=Math.abs(e)/60,(t?"+":"-")+String("0000"+(e/60*100+e%60)).slice(-4)},"%Z":function(e){return e.Fa},"%%":function(){return"%"}},n=n.replace(/%%/g,"\\0\\0"),c)n.includes(l)&&(n=n.replace(new RegExp(l,"g"),c[l](r)));return l=function(e){var t=Array(D(e)+1);return k(e,t,0,t.length),t}(n=n.replace(/\\0\\0/g,"%")),l.length>t?0:(T.set(l,e>>>0),l.length-1)}var oe={a:function(e){return ie(e+24)+24},b:function(e,t,n){throw new J(e).ya(t,n),e},g:function(){return 0},I:function(){},w:function(){},y:function(){},K:function(){return 0},G:function(){},C:function(){},F:function(){},k:function(){},x:function(){},u:function(){},H:function(){},v:function(){},n:function(){},p:function(){B("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},o:function(){B("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},l:function(){return Date.now()},L:function(){return!0},M:function(e,t){e=new Date(1e3*(M[e>>>2]+4294967296*E[e+4>>>2])),E[t>>2>>>0]=e.getUTCSeconds(),E[t+4>>2>>>0]=e.getUTCMinutes(),E[t+8>>2>>>0]=e.getUTCHours(),E[t+12>>2>>>0]=e.getUTCDate(),E[t+16>>2>>>0]=e.getUTCMonth(),E[t+20>>2>>>0]=e.getUTCFullYear()-1900,E[t+24>>2>>>0]=e.getUTCDay(),E[t+28>>2>>>0]=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},N:function(e,t){e=new Date(1e3*(M[e>>>2]+4294967296*E[e+4>>>2])),E[t>>2>>>0]=e.getSeconds(),E[t+4>>2>>>0]=e.getMinutes(),E[t+8>>2>>>0]=e.getHours(),E[t+12>>2>>>0]=e.getDate(),E[t+16>>2>>>0]=e.getMonth(),E[t+20>>2>>>0]=e.getFullYear()-1900,E[t+24>>2>>>0]=e.getDay();var n=new Date(e.getFullYear(),0,1);E[t+28>>2>>>0]=(e.getTime()-n.getTime())/864e5|0,E[t+36>>2>>>0]=-60*e.getTimezoneOffset();var r=new Date(e.getFullYear(),6,1).getTimezoneOffset();n=n.getTimezoneOffset(),E[t+32>>2>>>0]=0|(r!=n&&e.getTimezoneOffset()==Math.min(n,r))},O:function(e){var t=new Date(E[e+20>>2>>>0]+1900,E[e+16>>2>>>0],E[e+12>>2>>>0],E[e+8>>2>>>0],E[e+4>>2>>>0],E[e>>2>>>0],0),n=E[e+32>>2>>>0],r=t.getTimezoneOffset(),a=new Date(t.getFullYear(),0,1),o=new Date(t.getFullYear(),6,1).getTimezoneOffset(),i=a.getTimezoneOffset(),s=Math.min(i,o);return 0>n?E[e+32>>2>>>0]=Number(o!=i&&s==r):0<n!=(s==r)&&(o=Math.max(i,o),t.setTime(t.getTime()+6e4*((0<n?s:o)-r))),E[e+24>>2>>>0]=t.getDay(),E[e+28>>2>>>0]=(t.getTime()-a.getTime())/864e5|0,E[e>>2>>>0]=t.getSeconds(),E[e+4>>2>>>0]=t.getMinutes(),E[e+8>>2>>>0]=t.getHours(),E[e+12>>2>>>0]=t.getDate(),E[e+16>>2>>>0]=t.getMonth(),t.getTime()/1e3|0},z:function(){return-52},B:function(){},m:function e(t,n,r){e.xa||(e.xa=!0,function(e,t,n){function r(e){return(e=e.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?e[1]:"GMT"}var a=(new Date).getFullYear(),o=new Date(a,0,1),i=new Date(a,6,1);a=o.getTimezoneOffset();var s=i.getTimezoneOffset();E[e>>2>>>0]=60*Math.max(a,s),E[t>>2>>>0]=Number(a!=s),e=r(o),t=r(i),e=Q(e),t=Q(t),s<a?(M[n>>2>>>0]=e,M[n+4>>2>>>0]=t):(M[n>>2>>>0]=t,M[n+4>>2>>>0]=e)}(t,n,r))},d:function(){B("")},t:function(){return 4294901760},h:h?()=>{var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:()=>performance.now(),J:function(e,t,n){A.copyWithin(e>>>0,t>>>0,t+n>>>0)},f:function(e){var t=A.length;if(4294901760<(e>>>=0))return!1;for(var n=1;4>=n;n*=2){var r=t*(1+.2/n);r=Math.min(r,e+100663296);var a=Math;r=Math.max(e,r),a=a.min.call(a,4294901760,r+(65536-r%65536)%65536);e:{try{O.grow(a-S.byteLength+65535>>>16),F();var o=1;break e}catch(e){}o=void 0}if(o)return!0}return!1},D:function(e,t){var n=0;return K().forEach((function(r,a){var o=t+n;for(a=M[e+4*a>>2>>>0]=o,o=0;o<r.length;++o)T[a++>>0>>>0]=r.charCodeAt(o);T[a>>0>>>0]=0,n+=r.length+1})),0},E:function(e,t){var n=K();M[e>>2>>>0]=n.length;var r=0;return n.forEach((function(e){r+=e.length+1})),M[t>>2>>>0]=r,0},r:function(e){_||(t.onExit&&t.onExit(e),R=!0),d(e,new $(e))},e:function(){return 52},j:function(){return 52},q:function(){return 70},i:function(e,t,n,r){for(var a=0,o=0;o<n;o++){var i=M[t>>2>>>0],s=M[t+4>>2>>>0];t+=8;for(var u=0;u<s;u++){var c=A[i+u>>>0],l=ee[e];0===c||10===c?((1===e?b:w)(C(l,0)),l.length=0):l.push(c)}a+=s}return M[r>>2>>>0]=a,0},s:function e(t,r){e.wa||(e.wa=function(){if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var e=new Uint8Array(1);return()=>(crypto.getRandomValues(e),e[0])}if(h)try{var t=n(760);return()=>t.randomBytes(1)[0]}catch(e){}return()=>B("randomDevice")}());for(var a=0;a<r;a++)T[t+a>>0>>>0]=e.wa();return 0},A:ae,c:function(e,t,n,r){return ae(e,t,n,r)}};!function(){function e(e){t.asm=e.exports,O=t.asm.P,F(),I.unshift(t.asm.Q),L--,t.monitorRunDependencies&&t.monitorRunDependencies(L),0==L&&(null!==Y&&(clearInterval(Y),Y=null),z&&(e=z,z=null,e()))}function n(t){e(t.instance)}function r(e){return function(){if(!v&&(m||g)){if("function"==typeof fetch&&!H.startsWith("file://"))return fetch(H,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at \'"+H+"\'";return e.arrayBuffer()})).catch((function(){return q()}));if(i)return new Promise((function(e,t){i(H,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return q()}))}().then((function(e){return WebAssembly.instantiate(e,o)})).then((function(e){return e})).then(e,(function(e){w("failed to asynchronously prepare wasm: "+e),B(e)}))}var o={a:oe};if(L++,t.monitorRunDependencies&&t.monitorRunDependencies(L),t.instantiateWasm)try{return t.instantiateWasm(o,e)}catch(e){return w("Module.instantiateWasm callback failed with error: "+e),!1}(v||"function"!=typeof WebAssembly.instantiateStreaming||N()||H.startsWith("file://")||h||"function"!=typeof fetch?r(n):fetch(H,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,o).then(n,(function(e){return w("wasm streaming compile failed: "+e),w("falling back to ArrayBuffer instantiation"),r(n)}))}))).catch(a)}(),t.___wasm_call_ctors=function(){return(t.___wasm_call_ctors=t.asm.Q).apply(null,arguments)},t._OrtInit=function(){return(t._OrtInit=t.asm.R).apply(null,arguments)},t._OrtCreateSessionOptions=function(){return(t._OrtCreateSessionOptions=t.asm.S).apply(null,arguments)},t._OrtAppendExecutionProvider=function(){return(t._OrtAppendExecutionProvider=t.asm.T).apply(null,arguments)},t._OrtAddSessionConfigEntry=function(){return(t._OrtAddSessionConfigEntry=t.asm.U).apply(null,arguments)},t._OrtReleaseSessionOptions=function(){return(t._OrtReleaseSessionOptions=t.asm.V).apply(null,arguments)},t._OrtCreateSession=function(){return(t._OrtCreateSession=t.asm.W).apply(null,arguments)},t._OrtReleaseSession=function(){return(t._OrtReleaseSession=t.asm.X).apply(null,arguments)},t._OrtGetInputCount=function(){return(t._OrtGetInputCount=t.asm.Y).apply(null,arguments)},t._OrtGetOutputCount=function(){return(t._OrtGetOutputCount=t.asm.Z).apply(null,arguments)},t._OrtGetInputName=function(){return(t._OrtGetInputName=t.asm._).apply(null,arguments)},t._OrtGetOutputName=function(){return(t._OrtGetOutputName=t.asm.$).apply(null,arguments)},t._OrtFree=function(){return(t._OrtFree=t.asm.aa).apply(null,arguments)},t._OrtCreateTensor=function(){return(t._OrtCreateTensor=t.asm.ba).apply(null,arguments)},t._OrtGetTensorData=function(){return(t._OrtGetTensorData=t.asm.ca).apply(null,arguments)},t._OrtReleaseTensor=function(){return(t._OrtReleaseTensor=t.asm.da).apply(null,arguments)},t._OrtCreateRunOptions=function(){return(t._OrtCreateRunOptions=t.asm.ea).apply(null,arguments)},t._OrtAddRunConfigEntry=function(){return(t._OrtAddRunConfigEntry=t.asm.fa).apply(null,arguments)},t._OrtReleaseRunOptions=function(){return(t._OrtReleaseRunOptions=t.asm.ga).apply(null,arguments)},t._OrtRun=function(){return(t._OrtRun=t.asm.ha).apply(null,arguments)},t._OrtEndProfiling=function(){return(t._OrtEndProfiling=t.asm.ia).apply(null,arguments)};var ie=t._malloc=function(){return(ie=t._malloc=t.asm.ja).apply(null,arguments)};t._free=function(){return(t._free=t.asm.ka).apply(null,arguments)};var se,ue=t.stackSave=function(){return(ue=t.stackSave=t.asm.ma).apply(null,arguments)},ce=t.stackRestore=function(){return(ce=t.stackRestore=t.asm.na).apply(null,arguments)},le=t.stackAlloc=function(){return(le=t.stackAlloc=t.asm.oa).apply(null,arguments)};function fe(){function e(){if(!se&&(se=!0,t.calledRun=!0,!R)){if(V(I),r(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),t.postRun)for("function"==typeof t.postRun&&(t.postRun=[t.postRun]);t.postRun.length;){var e=t.postRun.shift();W.unshift(e)}V(W)}}if(!(0<L)){if(t.preRun)for("function"==typeof t.preRun&&(t.preRun=[t.preRun]);t.preRun.length;)j();V(U),0<L||(t.setStatus?(t.setStatus("Running..."),setTimeout((function(){setTimeout((function(){t.setStatus("")}),1),e()}),1)):e())}}if(t.___cxa_is_pointer_type=function(){return(t.___cxa_is_pointer_type=t.asm.pa).apply(null,arguments)},t.UTF8ToString=P,t.stringToUTF8=function(e,t,n){return k(e,A,t,n)},t.lengthBytesUTF8=D,t.stackSave=ue,t.stackRestore=ce,t.stackAlloc=le,z=function e(){se||fe(),se||(z=e)},t.preInit)for("function"==typeof t.preInit&&(t.preInit=[t.preInit]);0<t.preInit.length;)t.preInit.pop()();return fe(),e.ready});e.exports=r},154:e=>{"use strict";e.exports=\'"use strict";var e={},t="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node;if(t){var r=require("worker_threads"),a=r.parentPort;a.on("message",(e=>onmessage({data:e})));var o=require("fs");Object.assign(global,{globalThis:global,require:require,Module:e,location:{href:__filename},Worker:r.Worker,importScripts:function(e){(0,eval)(o.readFileSync(e,"utf8"))},postMessage:function(e){a.postMessage(e)},performance:global.performance||{now:function(){return Date.now()}}})}var s=!1,n=[],i=function(){var e=Array.prototype.slice.call(arguments).join(" ");t?o.writeSync(2,e+"\\\\n"):console.error(e)};globalThis.alert=function(){var t=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:t,threadId:e._pthread_self()})},e.instantiateWasm=(t,r)=>{var a=new WebAssembly.Instance(e.wasmModule,t);return r(a),e.wasmModule=null,a.exports},globalThis.onunhandledrejection=e=>{throw e.reason??e},globalThis.onmessage=t=>{try{if("load"===t.data.cmd){if(e.wasmModule=t.data.wasmModule,e.wasmMemory=t.data.wasmMemory,e.buffer=e.wasmMemory.buffer,e.ENVIRONMENT_IS_PTHREAD=!0,"string"==typeof t.data.urlOrBlob)importScripts(t.data.urlOrBlob);else{var r=URL.createObjectURL(t.data.urlOrBlob);importScripts(r),URL.revokeObjectURL(r)}ortWasmThreaded(e).then((function(t){e=t}))}else if("run"===t.data.cmd){e.__performance_now_clock_drift=performance.now()-t.data.time,e.__emscripten_thread_init(t.data.pthread_ptr,0,0,1),e.establishStackSpace(),e.PThread.receiveObjectTransfer(t.data),e.PThread.threadInitTLS(),s||(n.forEach((t=>{e.executeNotifiedProxyingQueue(t)})),n=[],s=!0);try{e.invokeEntryPoint(t.data.start_routine,t.data.arg)}catch(t){if("unwind"!=t){if(!(t instanceof e.ExitStatus))throw t;e.keepRuntimeAlive()||e.__emscripten_thread_exit(t.status)}}}else"cancel"===t.data.cmd?e._pthread_self()&&e.__emscripten_thread_exit(-1):"setimmediate"===t.data.target||("processProxyingQueue"===t.data.cmd?s?e.executeNotifiedProxyingQueue(t.data.queue):n.push(t.data.queue):(i("worker.js received unknown command "+t.data.cmd),i(t.data)))}catch(t){throw i("worker.js onmessage() captured an uncaught exception: "+t),t&&t.stack&&i(t.stack),e.__emscripten_thread_crashed&&e.__emscripten_thread_crashed(),t}};\\n\'},760:()=>{},384:()=>{},993:()=>{},908:()=>{},953:()=>{},925:()=>{},449:()=>{}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{"use strict";const e=n(259),t=n(263);globalThis.onmessage=n=>{switch(n.data.type){case"init-wasm":(0,t.initializeWebAssembly)(n.data.in).then((()=>postMessage({type:"init-wasm"})),(e=>postMessage({type:"init-wasm",err:e})));break;case"init-ort":try{const{numThreads:t,loggingLevel:r}=n.data.in;(0,e.initOrt)(t,r),postMessage({type:"init-ort"})}catch(e){postMessage({type:"init-ort",err:e})}break;case"create_allocate":try{const{model:t}=n.data.in,r=(0,e.createSessionAllocate)(t);postMessage({type:"create_allocate",out:r})}catch(e){postMessage({type:"create_allocate",err:e})}break;case"create_finalize":try{const{modeldata:t,options:r}=n.data.in,a=(0,e.createSessionFinalize)(t,r);postMessage({type:"create_finalize",out:a})}catch(e){postMessage({type:"create_finalize",err:e})}break;case"create":try{const{model:t,options:r}=n.data.in,a=(0,e.createSession)(t,r);postMessage({type:"create",out:a})}catch(e){postMessage({type:"create",err:e})}break;case"release":try{const t=n.data.in;(0,e.releaseSession)(t),postMessage({type:"release"})}catch(e){postMessage({type:"release",err:e})}break;case"run":try{const{sessionId:t,inputIndices:r,inputs:a,outputIndices:o,options:i}=n.data.in;(0,e.run)(t,r,a,o,i).then((t=>{postMessage({type:"run",out:t},(0,e.extractTransferableBuffers)(t))}),(e=>{postMessage({type:"run",err:e})}))}catch(e){postMessage({type:"run",err:e})}break;case"end-profiling":try{const t=n.data.in;(0,e.endProfiling)(t),postMessage({type:"end-profiling"})}catch(e){postMessage({type:"end-profiling",err:e})}}}})()})();\n',"Worker",void 0,void 0)}},6614:e=>{e.exports=function(e,t,r,n){var i=globalThis||window;try{try{var o;try{o=new i.Blob([e])}catch(t){(o=new(i.BlobBuilder||i.WebKitBlobBuilder||i.MozBlobBuilder||i.MSBlobBuilder)).append(e),o=o.getBlob()}var s=i.URL||i.webkitURL,a=s.createObjectURL(o),c=new i[t](a,r);return s.revokeObjectURL(a),c}catch(n){return new i[t]("data:application/javascript,".concat(encodeURIComponent(e)),r)}}catch(e){if(!n)throw Error("Inline worker is not supported");return new i[t](n,r)}}},3474:(e,t,r)=>{var n,i=(n=(n="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(e){function t(){return N.buffer!=L&&Z(N.buffer),D}function i(){return N.buffer!=L&&Z(N.buffer),M}function o(){return N.buffer!=L&&Z(N.buffer),U}function s(){return N.buffer!=L&&Z(N.buffer),B}function a(){return N.buffer!=L&&Z(N.buffer),F}var c,u,l;e=e||{},c||(c=void 0!==e?e:{}),c.ready=new Promise((function(e,t){u=e,l=t}));var d,h,f,p,m,g,v=Object.assign({},c),y="./this.program",b=(e,t)=>{throw t},E="object"==typeof window,w="function"==typeof importScripts,S="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,_=c.ENVIRONMENT_IS_PTHREAD||!1,T="";function x(e){return c.locateFile?c.locateFile(e,T):T+e}if(S){let t;T=w?r(908).dirname(T)+"/":"//",g=()=>{m||(p=r(1384),m=r(908))},d=function(e,t){return g(),e=m.normalize(e),p.readFileSync(e,t?void 0:"utf8")},f=e=>((e=d(e,!0)).buffer||(e=new Uint8Array(e)),e),h=(e,t,r)=>{g(),e=m.normalize(e),p.readFile(e,(function(e,n){e?r(e):t(n.buffer)}))},1<process.argv.length&&(y=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",(function(e){if(!(e instanceof se))throw e})),process.on("unhandledRejection",(function(e){throw e})),b=(e,t)=>{if(O)throw process.exitCode=e,t;t instanceof se||k("exiting due to exception: "+t),process.exit(e)},c.inspect=function(){return"[Emscripten Module object]"};try{t=r(9925)}catch(e){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),e}r.g.Worker=t.Worker}else(E||w)&&(w?T=globalThis.location.href:"undefined"!=typeof document&&document.currentScript&&(T=document.currentScript.src),n&&(T=n),T=0!==T.indexOf("blob:")?T.substr(0,T.replace(/[?#].*/,"").lastIndexOf("/")+1):"",S||(d=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},w&&(f=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),h=(e,t,r)=>{var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=()=>{200==n.status||0==n.status&&n.response?t(n.response):r()},n.onerror=r,n.send(null)}));S&&"undefined"==typeof performance&&(r.g.performance=r(6953).performance);var A=console.log.bind(console),I=console.warn.bind(console);S&&(g(),A=e=>p.writeSync(1,e+"\n"),I=e=>p.writeSync(2,e+"\n"));var C,R=c.print||A,k=c.printErr||I;Object.assign(c,v),v=null,c.thisProgram&&(y=c.thisProgram),c.quit&&(b=c.quit),c.wasmBinary&&(C=c.wasmBinary);var O=c.noExitRuntime||!0;"object"!=typeof WebAssembly&&re("no native wasm support detected");var N,P,L,D,M,U,B,F,j=!1,V="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function H(e,t,r){var n=(t>>>=0)+r;for(r=t;e[r]&&!(r>=n);)++r;if(16<r-t&&e.buffer&&V)return V.decode(e.buffer instanceof SharedArrayBuffer?e.slice(t,r):e.subarray(t,r));for(n="";t<r;){var i=e[t++];if(128&i){var o=63&e[t++];if(192==(224&i))n+=String.fromCharCode((31&i)<<6|o);else{var s=63&e[t++];65536>(i=224==(240&i)?(15&i)<<12|o<<6|s:(7&i)<<18|o<<12|s<<6|63&e[t++])?n+=String.fromCharCode(i):(i-=65536,n+=String.fromCharCode(55296|i>>10,56320|1023&i))}}else n+=String.fromCharCode(i)}return n}function G(e,t){return(e>>>=0)?H(i(),e,t):""}function q(e,t,r,n){if(!(0<n))return 0;var i=r>>>=0;n=r+n-1;for(var o=0;o<e.length;++o){var s=e.charCodeAt(o);if(55296<=s&&57343>=s&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++o)),127>=s){if(r>=n)break;t[r++>>>0]=s}else{if(2047>=s){if(r+1>=n)break;t[r++>>>0]=192|s>>6}else{if(65535>=s){if(r+2>=n)break;t[r++>>>0]=224|s>>12}else{if(r+3>=n)break;t[r++>>>0]=240|s>>18,t[r++>>>0]=128|s>>12&63}t[r++>>>0]=128|s>>6&63}t[r++>>>0]=128|63&s}}return t[r>>>0]=0,r-i}function $(e){for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);127>=n?t++:2047>=n?t+=2:55296<=n&&57343>=n?(t+=4,++r):t+=3}return t}function Z(e){L=e,c.HEAP8=D=new Int8Array(e),c.HEAP16=new Int16Array(e),c.HEAP32=U=new Int32Array(e),c.HEAPU8=M=new Uint8Array(e),c.HEAPU16=new Uint16Array(e),c.HEAPU32=B=new Uint32Array(e),c.HEAPF32=new Float32Array(e),c.HEAPF64=F=new Float64Array(e)}_&&(L=c.buffer);var z=c.INITIAL_MEMORY||16777216;if(_)N=c.wasmMemory,L=c.buffer;else if(c.wasmMemory)N=c.wasmMemory;else if(!((N=new WebAssembly.Memory({initial:z/65536,maximum:65536,shared:!0})).buffer instanceof SharedArrayBuffer))throw k("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),S&&console.log("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and also use a recent version)"),Error("bad memory");N&&(L=N.buffer),z=L.byteLength,Z(L);var K,W=[],J=[],Y=[];function Q(){var e=c.preRun.shift();W.unshift(e)}var X,ee=0,te=null;function re(e){throw _?postMessage({cmd:"onAbort",arg:e}):c.onAbort&&c.onAbort(e),k(e="Aborted("+e+")"),j=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),l(e),e}function ne(){return X.startsWith("data:application/octet-stream;base64,")}function ie(){var e=X;try{if(e==X&&C)return new Uint8Array(C);if(f)return f(e);throw"both async and sync fetching of the wasm failed"}catch(e){re(e)}}X="ort-wasm-threaded.wasm",ne()||(X=x(X));var oe={};function se(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function ae(e){(e=de.La[e])||re(),de.Xa(e)}function ce(e){var t=de.lb();if(!t)return 6;de.Ra.push(t),de.La[e.Ka]=t,t.Ka=e.Ka;var r={cmd:"run",start_routine:e.pb,arg:e.ib,pthread_ptr:e.Ka};return t.Qa=()=>{r.time=performance.now(),t.postMessage(r,e.vb)},t.loaded&&(t.Qa(),delete t.Qa),0}function ue(e){if(_)return Fe(1,1,e);O||(de.qb(),c.onExit&&c.onExit(e),j=!0),b(e,new se(e))}function le(e,t){if(!t&&_)throw fe(e),"unwind";ue(e)}var de={Oa:[],Ra:[],$a:[],La:{},Ua:function(){_&&de.mb()},xb:function(){},mb:function(){de.receiveObjectTransfer=de.ob,de.threadInitTLS=de.Za,de.setExitStatus=de.Ya,O=!1},Ya:function(){},qb:function(){for(var e of Object.values(de.La))de.Xa(e);for(e of de.Oa)e.terminate();de.Oa=[]},Xa:function(e){var t=e.Ka;delete de.La[t],de.Oa.push(e),de.Ra.splice(de.Ra.indexOf(e),1),e.Ka=0,ut(t)},ob:function(){},Za:function(){de.$a.forEach((e=>e()))},nb:function(e,t){e.onmessage=r=>{var n=(r=r.data).cmd;if(e.Ka&&(de.kb=e.Ka),r.targetThread&&r.targetThread!=nt()){var i=de.La[r.yb];i?i.postMessage(r,r.transferList):k('Internal error! Worker sent a message "'+n+'" to target pthread '+r.targetThread+", but that thread no longer exists!")}else"processProxyingQueue"===n?Pe(r.queue):"spawnThread"===n?ce(r):"cleanupThread"===n?ae(r.thread):"killThread"===n?(r=r.thread,n=de.La[r],delete de.La[r],n.terminate(),ut(r),de.Ra.splice(de.Ra.indexOf(n),1),n.Ka=0):"cancelThread"===n?de.La[r.thread].postMessage({cmd:"cancel"}):"loaded"===n?(e.loaded=!0,t&&t(e),e.Qa&&(e.Qa(),delete e.Qa)):"print"===n?R("Thread "+r.threadId+": "+r.text):"printErr"===n?k("Thread "+r.threadId+": "+r.text):"alert"===n?alert("Thread "+r.threadId+": "+r.text):"setimmediate"===r.target?e.postMessage(r):"onAbort"===n?c.onAbort&&c.onAbort(r.arg):n&&k("worker sent an unknown command "+n);de.kb=void 0},e.onerror=e=>{throw k("worker sent an error! "+e.filename+":"+e.lineno+": "+e.message),e},S&&(e.on("message",(function(t){e.onmessage({data:t})})),e.on("error",(function(t){e.onerror(t)})),e.on("detachedExit",(function(){}))),e.postMessage({cmd:"load",urlOrBlob:c.mainScriptUrlOrBlob||n,wasmMemory:N,wasmModule:P})},hb:function(){var e=x("ort-wasm-threaded.worker.js");de.Oa.push(new Worker(e))},lb:function(){return 0==de.Oa.length&&(de.hb(),de.nb(de.Oa[0])),de.Oa.pop()}};function he(e){for(;0<e.length;)e.shift()(c)}function fe(e){if(_)return Fe(2,0,e);try{le(e)}catch(e){e instanceof se||"unwind"==e||b(1,e)}}c.PThread=de,c.establishStackSpace=function(){var e=nt(),t=o()[e+44>>2>>>0];e=o()[e+48>>2>>>0],dt(t,t-e),ft(t)};var pe,me,ge=[];function ve(e){this.Pa=e-24,this.gb=function(e){s()[this.Pa+4>>2>>>0]=e},this.cb=function(e){s()[this.Pa+8>>2>>>0]=e},this.eb=function(){o()[this.Pa>>2>>>0]=0},this.bb=function(){t()[this.Pa+12>>0>>>0]=0},this.fb=function(){t()[this.Pa+13>>0>>>0]=0},this.Ua=function(e,t){this.ab(),this.gb(e),this.cb(t),this.eb(),this.bb(),this.fb()},this.ab=function(){s()[this.Pa+16>>2>>>0]=0}}function ye(e,t,r,n){return _?Fe(3,1,e,t,r,n):be(e,t,r,n)}function be(e,t,r,n){if("undefined"==typeof SharedArrayBuffer)return k("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var i=[];return _&&0===i.length?ye(e,t,r,n):(e={pb:r,Ka:e,ib:n,vb:i},_?(e.wb="spawnThread",postMessage(e,i),0):ce(e))}function Ee(e,t,r){return _?Fe(4,1,e,t,r):0}function we(e,t){if(_)return Fe(5,1,e,t)}function Se(e,t){if(_)return Fe(6,1,e,t)}function _e(e,t,r){if(_)return Fe(7,1,e,t,r)}function Te(e,t,r){return _?Fe(8,1,e,t,r):0}function xe(e,t){if(_)return Fe(9,1,e,t)}function Ae(e,t,r){if(_)return Fe(10,1,e,t,r)}function Ie(e,t,r,n){if(_)return Fe(11,1,e,t,r,n)}function Ce(e,t,r,n){if(_)return Fe(12,1,e,t,r,n)}function Re(e,t,r,n){if(_)return Fe(13,1,e,t,r,n)}function ke(e){if(_)return Fe(14,1,e)}function Oe(e,t){if(_)return Fe(15,1,e,t)}function Ne(e,t,r){if(_)return Fe(16,1,e,t,r)}function Pe(e){Atomics.store(o(),e>>2,1),nt()&&ct(e),Atomics.compareExchange(o(),e>>2,1,0)}function Le(e){return s()[e>>>2]+4294967296*o()[e+4>>>2]}function De(e,t,r,n,i,o){return _?Fe(17,1,e,t,r,n,i,o):-52}function Me(e,t,r,n,i,o){if(_)return Fe(18,1,e,t,r,n,i,o)}function Ue(e){var r=$(e)+1,n=it(r);return n&&q(e,t(),n,r),n}function Be(e,t,r){function n(e){return(e=e.toTimeString().match(/\(([A-Za-z ]+)\)$/))?e[1]:"GMT"}if(_)return Fe(19,1,e,t,r);var i=(new Date).getFullYear(),a=new Date(i,0,1),c=new Date(i,6,1);i=a.getTimezoneOffset();var u=c.getTimezoneOffset(),l=Math.max(i,u);o()[e>>2>>>0]=60*l,o()[t>>2>>>0]=Number(i!=u),e=n(a),t=n(c),e=Ue(e),t=Ue(t),u<i?(s()[r>>2>>>0]=e,s()[r+4>>2>>>0]=t):(s()[r>>2>>>0]=t,s()[r+4>>2>>>0]=e)}function Fe(e,t){var r=arguments.length-2,n=arguments;return function(e){var t=ht();return e=e(),ft(t),e}((()=>{for(var i=pt(8*r),o=i>>3,s=0;s<r;s++){var c=n[2+s];a()[o+s>>>0]=c}return at(e,r,i,t)}))}c.invokeEntryPoint=function(e,t){var r=ge[e];r||(e>=ge.length&&(ge.length=e+1),ge[e]=r=K.get(e)),e=r(t),O?de.Ya(e):lt(e)},c.executeNotifiedProxyingQueue=Pe,me=S?()=>{var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:_?()=>performance.now()-c.__performance_now_clock_drift:()=>performance.now();var je,Ve=[],He={};function Ge(){if(!je){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:y||"./this.program"};for(e in He)void 0===He[e]?delete t[e]:t[e]=He[e];var r=[];for(e in t)r.push(e+"="+t[e]);je=r}return je}function qe(e,r){if(_)return Fe(20,1,e,r);var n=0;return Ge().forEach((function(i,o){var a=r+n;for(o=s()[e+4*o>>2>>>0]=a,a=0;a<i.length;++a)t()[o++>>0>>>0]=i.charCodeAt(a);t()[o>>0>>>0]=0,n+=i.length+1})),0}function $e(e,t){if(_)return Fe(21,1,e,t);var r=Ge();s()[e>>2>>>0]=r.length;var n=0;return r.forEach((function(e){n+=e.length+1})),s()[t>>2>>>0]=n,0}function Ze(e){return _?Fe(22,1,e):52}function ze(e,t,r,n){return _?Fe(23,1,e,t,r,n):52}function Ke(e,t,r,n,i){return _?Fe(24,1,e,t,r,n,i):70}var We=[null,[],[]];function Je(e,t,r,n){if(_)return Fe(25,1,e,t,r,n);for(var o=0,a=0;a<r;a++){var c=s()[t>>2>>>0],u=s()[t+4>>2>>>0];t+=8;for(var l=0;l<u;l++){var d=i()[c+l>>>0],h=We[e];0===d||10===d?((1===e?R:k)(H(h,0)),h.length=0):h.push(d)}o+=u}return s()[n>>2>>>0]=o,0}function Ye(e){return 0==e%4&&(0!=e%100||0==e%400)}var Qe=[31,29,31,30,31,30,31,31,30,31,30,31],Xe=[31,28,31,30,31,30,31,31,30,31,30,31];function et(e,r,n,i){function s(e,t,r){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=r[0]+e;return e}function a(e,t){return s(e,t,"0")}function c(e,t){function r(e){return 0>e?-1:0<e?1:0}var n;return 0===(n=r(e.getFullYear()-t.getFullYear()))&&0===(n=r(e.getMonth()-t.getMonth()))&&(n=r(e.getDate()-t.getDate())),n}function u(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function l(e){var t=e.Ma;for(e=new Date(new Date(e.Na+1900,0,1).getTime());0<t;){var r=e.getMonth(),n=(Ye(e.getFullYear())?Qe:Xe)[r];if(!(t>n-e.getDate())){e.setDate(e.getDate()+t);break}t-=n-e.getDate()+1,e.setDate(1),11>r?e.setMonth(r+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1))}return r=new Date(e.getFullYear()+1,0,4),t=u(new Date(e.getFullYear(),0,4)),r=u(r),0>=c(t,e)?0>=c(r,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}var d=o()[i+40>>2>>>0];for(var h in i={tb:o()[i>>2>>>0],sb:o()[i+4>>2>>>0],Sa:o()[i+8>>2>>>0],Va:o()[i+12>>2>>>0],Ta:o()[i+16>>2>>>0],Na:o()[i+20>>2>>>0],Ja:o()[i+24>>2>>>0],Ma:o()[i+28>>2>>>0],zb:o()[i+32>>2>>>0],rb:o()[i+36>>2>>>0],ub:d?G(d):""},n=G(n),d={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})n=n.replace(new RegExp(h,"g"),d[h]);var f="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),p="January February March April May June July August September October November December".split(" ");for(h in d={"%a":function(e){return f[e.Ja].substring(0,3)},"%A":function(e){return f[e.Ja]},"%b":function(e){return p[e.Ta].substring(0,3)},"%B":function(e){return p[e.Ta]},"%C":function(e){return a((e.Na+1900)/100|0,2)},"%d":function(e){return a(e.Va,2)},"%e":function(e){return s(e.Va,2," ")},"%g":function(e){return l(e).toString().substring(2)},"%G":function(e){return l(e)},"%H":function(e){return a(e.Sa,2)},"%I":function(e){return 0==(e=e.Sa)?e=12:12<e&&(e-=12),a(e,2)},"%j":function(e){for(var t=0,r=0;r<=e.Ta-1;t+=(Ye(e.Na+1900)?Qe:Xe)[r++]);return a(e.Va+t,3)},"%m":function(e){return a(e.Ta+1,2)},"%M":function(e){return a(e.sb,2)},"%n":function(){return"\n"},"%p":function(e){return 0<=e.Sa&&12>e.Sa?"AM":"PM"},"%S":function(e){return a(e.tb,2)},"%t":function(){return"\t"},"%u":function(e){return e.Ja||7},"%U":function(e){return a(Math.floor((e.Ma+7-e.Ja)/7),2)},"%V":function(e){var t=Math.floor((e.Ma+7-(e.Ja+6)%7)/7);if(2>=(e.Ja+371-e.Ma-2)%7&&t++,t)53==t&&(4==(r=(e.Ja+371-e.Ma)%7)||3==r&&Ye(e.Na)||(t=1));else{t=52;var r=(e.Ja+7-e.Ma-1)%7;(4==r||5==r&&Ye(e.Na%400-1))&&t++}return a(t,2)},"%w":function(e){return e.Ja},"%W":function(e){return a(Math.floor((e.Ma+7-(e.Ja+6)%7)/7),2)},"%y":function(e){return(e.Na+1900).toString().substring(2)},"%Y":function(e){return e.Na+1900},"%z":function(e){var t=0<=(e=e.rb);return e=Math.abs(e)/60,(t?"+":"-")+String("0000"+(e/60*100+e%60)).slice(-4)},"%Z":function(e){return e.ub},"%%":function(){return"%"}},n=n.replace(/%%/g,"\0\0"),d)n.includes(h)&&(n=n.replace(new RegExp(h,"g"),d[h](i)));return h=function(e){var t=Array($(e)+1);return q(e,t,0,t.length),t}(n=n.replace(/\0\0/g,"%")),h.length>r?0:(function(e,r){t().set(e,r>>>0)}(h,e),h.length-1)}de.Ua();var tt=[null,ue,fe,ye,Ee,we,Se,_e,Te,xe,Ae,Ie,Ce,Re,ke,Oe,Ne,De,Me,Be,qe,$e,Ze,ze,Ke,Je],rt={b:function(e){return it(e+24)+24},c:function(e,t,r){throw new ve(e).Ua(t,r),e},L:function(e){ot(e,!w,1,!E),de.Za()},l:function(e){_?postMessage({cmd:"cleanupThread",thread:e}):ae(e)},D:be,i:Ee,R:we,z:Se,B:_e,T:Te,P:xe,I:Ae,O:Ie,p:Ce,A:Re,x:ke,Q:Oe,y:Ne,r:function(){},j:function(){re("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},s:function(){re("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},q:function(){return Date.now()},E:function(){return 2097152},V:function(){return!0},F:function(e,t,r,n){if(e==t)setTimeout((()=>Pe(n)));else if(_)postMessage({targetThread:e,cmd:"processProxyingQueue",queue:n});else{if(!(e=de.La[e]))return;e.postMessage({cmd:"processProxyingQueue",queue:n})}return 1},K:function(){return-1},W:function(e,t){e=new Date(1e3*Le(e)),o()[t>>2>>>0]=e.getUTCSeconds(),o()[t+4>>2>>>0]=e.getUTCMinutes(),o()[t+8>>2>>>0]=e.getUTCHours(),o()[t+12>>2>>>0]=e.getUTCDate(),o()[t+16>>2>>>0]=e.getUTCMonth(),o()[t+20>>2>>>0]=e.getUTCFullYear()-1900,o()[t+24>>2>>>0]=e.getUTCDay(),e=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,o()[t+28>>2>>>0]=e},X:function(e,t){e=new Date(1e3*Le(e)),o()[t>>2>>>0]=e.getSeconds(),o()[t+4>>2>>>0]=e.getMinutes(),o()[t+8>>2>>>0]=e.getHours(),o()[t+12>>2>>>0]=e.getDate(),o()[t+16>>2>>>0]=e.getMonth(),o()[t+20>>2>>>0]=e.getFullYear()-1900,o()[t+24>>2>>>0]=e.getDay();var r=new Date(e.getFullYear(),0,1),n=(e.getTime()-r.getTime())/864e5|0;o()[t+28>>2>>>0]=n,o()[t+36>>2>>>0]=-60*e.getTimezoneOffset(),n=new Date(e.getFullYear(),6,1).getTimezoneOffset(),e=0|(n!=(r=r.getTimezoneOffset())&&e.getTimezoneOffset()==Math.min(r,n)),o()[t+32>>2>>>0]=e},Y:function(e){var t=new Date(o()[e+20>>2>>>0]+1900,o()[e+16>>2>>>0],o()[e+12>>2>>>0],o()[e+8>>2>>>0],o()[e+4>>2>>>0],o()[e>>2>>>0],0),r=o()[e+32>>2>>>0],n=t.getTimezoneOffset(),i=new Date(t.getFullYear(),0,1),s=new Date(t.getFullYear(),6,1).getTimezoneOffset(),a=i.getTimezoneOffset(),c=Math.min(a,s);return 0>r?o()[e+32>>2>>>0]=Number(s!=a&&c==n):0<r!=(c==n)&&(s=Math.max(a,s),t.setTime(t.getTime()+6e4*((0<r?c:s)-n))),o()[e+24>>2>>>0]=t.getDay(),r=(t.getTime()-i.getTime())/864e5|0,o()[e+28>>2>>>0]=r,o()[e>>2>>>0]=t.getSeconds(),o()[e+4>>2>>>0]=t.getMinutes(),o()[e+8>>2>>>0]=t.getHours(),o()[e+12>>2>>>0]=t.getDate(),o()[e+16>>2>>>0]=t.getMonth(),t.getTime()/1e3|0},G:De,H:Me,Z:function e(t,r,n){e.jb||(e.jb=!0,Be(t,r,n))},d:function(){re("")},m:function(){if(!S&&!w){var e="Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread";pe||(pe={}),pe[e]||(pe[e]=1,S&&(e="warning: "+e),k(e))}},w:function(){return 4294901760},f:me,S:function(e,t,r){i().copyWithin(e>>>0,t>>>0,t+r>>>0)},g:function(){return S?r(3993).cpus().length:navigator.hardwareConcurrency},J:function(e,t,r){Ve.length=t,r>>=3;for(var n=0;n<t;n++)Ve[n]=a()[r+n>>>0];return(0>e?oe[-e-1]:tt[e]).apply(null,Ve)},v:function(e){var t=i().length;if((e>>>=0)<=t||4294901760<e)return!1;for(var r=1;4>=r;r*=2){var n=t*(1+.2/r);n=Math.min(n,e+100663296);var o=Math;n=Math.max(e,n),o=o.min.call(o,4294901760,n+(65536-n%65536)%65536);e:{try{N.grow(o-L.byteLength+65535>>>16),Z(N.buffer);var s=1;break e}catch(e){}s=void 0}if(s)return!0}return!1},U:function(){throw"unwind"},M:qe,N:$e,k:le,h:Ze,o:ze,t:Ke,n:Je,u:function e(n,i){e.Wa||(e.Wa=function(){if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var e=new Uint8Array(1);return()=>(crypto.getRandomValues(e),e[0])}if(S)try{var t=r(760);return()=>t.randomBytes(1)[0]}catch(e){}return()=>re("randomDevice")}());for(var o=0;o<i;o++)t()[n+o>>0>>>0]=e.Wa();return 0},a:N||c.wasmMemory,C:et,e:function(e,t,r,n){return et(e,t,r,n)}};!function(){function e(e,t){c.asm=e.exports,de.$a.push(c.asm.wa),K=c.asm.za,J.unshift(c.asm._),P=t,_||(ee--,c.monitorRunDependencies&&c.monitorRunDependencies(ee),0==ee&&te&&(e=te,te=null,e()))}function t(t){e(t.instance,t.module)}function r(e){return function(){if(!C&&(E||w)){if("function"==typeof fetch&&!X.startsWith("file://"))return fetch(X,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+X+"'";return e.arrayBuffer()})).catch((function(){return ie()}));if(h)return new Promise((function(e,t){h(X,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return ie()}))}().then((function(e){return WebAssembly.instantiate(e,n)})).then((function(e){return e})).then(e,(function(e){k("failed to asynchronously prepare wasm: "+e),re(e)}))}var n={a:rt};if(_||(ee++,c.monitorRunDependencies&&c.monitorRunDependencies(ee)),c.instantiateWasm)try{return c.instantiateWasm(n,e)}catch(e){return k("Module.instantiateWasm callback failed with error: "+e),!1}(C||"function"!=typeof WebAssembly.instantiateStreaming||ne()||X.startsWith("file://")||S||"function"!=typeof fetch?r(t):fetch(X,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,n).then(t,(function(e){return k("wasm streaming compile failed: "+e),k("falling back to ArrayBuffer instantiation"),r(t)}))}))).catch(l)}(),c.___wasm_call_ctors=function(){return(c.___wasm_call_ctors=c.asm._).apply(null,arguments)},c._OrtInit=function(){return(c._OrtInit=c.asm.$).apply(null,arguments)},c._OrtCreateSessionOptions=function(){return(c._OrtCreateSessionOptions=c.asm.aa).apply(null,arguments)},c._OrtAppendExecutionProvider=function(){return(c._OrtAppendExecutionProvider=c.asm.ba).apply(null,arguments)},c._OrtAddSessionConfigEntry=function(){return(c._OrtAddSessionConfigEntry=c.asm.ca).apply(null,arguments)},c._OrtReleaseSessionOptions=function(){return(c._OrtReleaseSessionOptions=c.asm.da).apply(null,arguments)},c._OrtCreateSession=function(){return(c._OrtCreateSession=c.asm.ea).apply(null,arguments)},c._OrtReleaseSession=function(){return(c._OrtReleaseSession=c.asm.fa).apply(null,arguments)},c._OrtGetInputCount=function(){return(c._OrtGetInputCount=c.asm.ga).apply(null,arguments)},c._OrtGetOutputCount=function(){return(c._OrtGetOutputCount=c.asm.ha).apply(null,arguments)},c._OrtGetInputName=function(){return(c._OrtGetInputName=c.asm.ia).apply(null,arguments)},c._OrtGetOutputName=function(){return(c._OrtGetOutputName=c.asm.ja).apply(null,arguments)},c._OrtFree=function(){return(c._OrtFree=c.asm.ka).apply(null,arguments)},c._OrtCreateTensor=function(){return(c._OrtCreateTensor=c.asm.la).apply(null,arguments)},c._OrtGetTensorData=function(){return(c._OrtGetTensorData=c.asm.ma).apply(null,arguments)},c._OrtReleaseTensor=function(){return(c._OrtReleaseTensor=c.asm.na).apply(null,arguments)},c._OrtCreateRunOptions=function(){return(c._OrtCreateRunOptions=c.asm.oa).apply(null,arguments)},c._OrtAddRunConfigEntry=function(){return(c._OrtAddRunConfigEntry=c.asm.pa).apply(null,arguments)},c._OrtReleaseRunOptions=function(){return(c._OrtReleaseRunOptions=c.asm.qa).apply(null,arguments)},c._OrtRun=function(){return(c._OrtRun=c.asm.ra).apply(null,arguments)},c._OrtEndProfiling=function(){return(c._OrtEndProfiling=c.asm.sa).apply(null,arguments)};var nt=c._pthread_self=function(){return(nt=c._pthread_self=c.asm.ta).apply(null,arguments)},it=c._malloc=function(){return(it=c._malloc=c.asm.ua).apply(null,arguments)};c._free=function(){return(c._free=c.asm.va).apply(null,arguments)},c.__emscripten_tls_init=function(){return(c.__emscripten_tls_init=c.asm.wa).apply(null,arguments)};var ot=c.__emscripten_thread_init=function(){return(ot=c.__emscripten_thread_init=c.asm.xa).apply(null,arguments)};c.__emscripten_thread_crashed=function(){return(c.__emscripten_thread_crashed=c.asm.ya).apply(null,arguments)};var st,at=c._emscripten_run_in_main_runtime_thread_js=function(){return(at=c._emscripten_run_in_main_runtime_thread_js=c.asm.Aa).apply(null,arguments)},ct=c.__emscripten_proxy_execute_task_queue=function(){return(ct=c.__emscripten_proxy_execute_task_queue=c.asm.Ba).apply(null,arguments)},ut=c.__emscripten_thread_free_data=function(){return(ut=c.__emscripten_thread_free_data=c.asm.Ca).apply(null,arguments)},lt=c.__emscripten_thread_exit=function(){return(lt=c.__emscripten_thread_exit=c.asm.Da).apply(null,arguments)},dt=c._emscripten_stack_set_limits=function(){return(dt=c._emscripten_stack_set_limits=c.asm.Ea).apply(null,arguments)},ht=c.stackSave=function(){return(ht=c.stackSave=c.asm.Fa).apply(null,arguments)},ft=c.stackRestore=function(){return(ft=c.stackRestore=c.asm.Ga).apply(null,arguments)},pt=c.stackAlloc=function(){return(pt=c.stackAlloc=c.asm.Ha).apply(null,arguments)};function mt(){function e(){if(!st&&(st=!0,c.calledRun=!0,!j)&&(_||he(J),u(c),c.onRuntimeInitialized&&c.onRuntimeInitialized(),!_)){if(c.postRun)for("function"==typeof c.postRun&&(c.postRun=[c.postRun]);c.postRun.length;){var e=c.postRun.shift();Y.unshift(e)}he(Y)}}if(!(0<ee))if(_)u(c),_||he(J),postMessage({cmd:"loaded"});else{if(c.preRun)for("function"==typeof c.preRun&&(c.preRun=[c.preRun]);c.preRun.length;)Q();he(W),0<ee||(c.setStatus?(c.setStatus("Running..."),setTimeout((function(){setTimeout((function(){c.setStatus("")}),1),e()}),1)):e())}}if(c.___cxa_is_pointer_type=function(){return(c.___cxa_is_pointer_type=c.asm.Ia).apply(null,arguments)},c.UTF8ToString=G,c.stringToUTF8=function(e,t,r){return q(e,i(),t,r)},c.lengthBytesUTF8=$,c.keepRuntimeAlive=function(){return O},c.wasmMemory=N,c.stackSave=ht,c.stackRestore=ft,c.stackAlloc=pt,c.ExitStatus=se,c.PThread=de,te=function e(){st||mt(),st||(te=e)},c.preInit)for("function"==typeof c.preInit&&(c.preInit=[c.preInit]);0<c.preInit.length;)c.preInit.pop()();return mt(),e.ready});e.exports=i},932:(e,t,r)=>{var n,i=(n=(n="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(e){var t,i,o;e=e||{},t||(t=void 0!==e?e:{}),t.ready=new Promise((function(e,t){i=e,o=t}));var s,a,c,u,l,d,h=Object.assign({},t),f="./this.program",p=(e,t)=>{throw t},m="object"==typeof window,g="function"==typeof importScripts,v="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,y="";v?(y=g?r(908).dirname(y)+"/":"//",d=()=>{l||(u=r(1384),l=r(908))},s=function(e,t){return d(),e=l.normalize(e),u.readFileSync(e,t?void 0:"utf8")},c=e=>((e=s(e,!0)).buffer||(e=new Uint8Array(e)),e),a=(e,t,r)=>{d(),e=l.normalize(e),u.readFile(e,(function(e,n){e?r(e):t(n.buffer)}))},1<process.argv.length&&(f=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",(function(e){if(!(e instanceof z))throw e})),process.on("unhandledRejection",(function(e){throw e})),p=(e,t)=>{if(S)throw process.exitCode=e,t;t instanceof z||w("exiting due to exception: "+t),process.exit(e)},t.inspect=function(){return"[Emscripten Module object]"}):(m||g)&&(g?y=globalThis.location.href:"undefined"!=typeof document&&document.currentScript&&(y=document.currentScript.src),n&&(y=n),y=0!==y.indexOf("blob:")?y.substr(0,y.replace(/[?#].*/,"").lastIndexOf("/")+1):"",s=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},g&&(c=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),a=(e,t,r)=>{var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=()=>{200==n.status||0==n.status&&n.response?t(n.response):r()},n.onerror=r,n.send(null)});var b,E=t.print||console.log.bind(console),w=t.printErr||console.warn.bind(console);Object.assign(t,h),h=null,t.thisProgram&&(f=t.thisProgram),t.quit&&(p=t.quit),t.wasmBinary&&(b=t.wasmBinary);var S=t.noExitRuntime||!0;"object"!=typeof WebAssembly&&G("no native wasm support detected");var _,T,x,A,I,C,R=!1,k="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function O(e,t,r){var n=(t>>>=0)+r;for(r=t;e[r]&&!(r>=n);)++r;if(16<r-t&&e.buffer&&k)return k.decode(e.subarray(t,r));for(n="";t<r;){var i=e[t++];if(128&i){var o=63&e[t++];if(192==(224&i))n+=String.fromCharCode((31&i)<<6|o);else{var s=63&e[t++];65536>(i=224==(240&i)?(15&i)<<12|o<<6|s:(7&i)<<18|o<<12|s<<6|63&e[t++])?n+=String.fromCharCode(i):(i-=65536,n+=String.fromCharCode(55296|i>>10,56320|1023&i))}}else n+=String.fromCharCode(i)}return n}function N(e,t){return(e>>>=0)?O(A,e,t):""}function P(e,t,r,n){if(!(0<n))return 0;var i=r>>>=0;n=r+n-1;for(var o=0;o<e.length;++o){var s=e.charCodeAt(o);if(55296<=s&&57343>=s&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++o)),127>=s){if(r>=n)break;t[r++>>>0]=s}else{if(2047>=s){if(r+1>=n)break;t[r++>>>0]=192|s>>6}else{if(65535>=s){if(r+2>=n)break;t[r++>>>0]=224|s>>12}else{if(r+3>=n)break;t[r++>>>0]=240|s>>18,t[r++>>>0]=128|s>>12&63}t[r++>>>0]=128|s>>6&63}t[r++>>>0]=128|63&s}}return t[r>>>0]=0,r-i}function L(e){for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);127>=n?t++:2047>=n?t+=2:55296<=n&&57343>=n?(t+=4,++r):t+=3}return t}function D(){var e=_.buffer;T=e,t.HEAP8=x=new Int8Array(e),t.HEAP16=new Int16Array(e),t.HEAP32=I=new Int32Array(e),t.HEAPU8=A=new Uint8Array(e),t.HEAPU16=new Uint16Array(e),t.HEAPU32=C=new Uint32Array(e),t.HEAPF32=new Float32Array(e),t.HEAPF64=new Float64Array(e)}var M=[],U=[],B=[];function F(){var e=t.preRun.shift();M.unshift(e)}var j,V=0,H=null;function G(e){throw t.onAbort&&t.onAbort(e),w(e="Aborted("+e+")"),R=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),o(e),e}function q(){return j.startsWith("data:application/octet-stream;base64,")}if(j="ort-wasm.wasm",!q()){var $=j;j=t.locateFile?t.locateFile($,y):y+$}function Z(){var e=j;try{if(e==j&&b)return new Uint8Array(b);if(c)return c(e);throw"both async and sync fetching of the wasm failed"}catch(e){G(e)}}function z(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function K(e){for(;0<e.length;)e.shift()(t)}function W(e){this.sa=e-24,this.Ia=function(e){C[this.sa+4>>2>>>0]=e},this.Ba=function(e){C[this.sa+8>>2>>>0]=e},this.Ga=function(){I[this.sa>>2>>>0]=0},this.Aa=function(){x[this.sa+12>>0>>>0]=0},this.Ha=function(){x[this.sa+13>>0>>>0]=0},this.ya=function(e,t){this.za(),this.Ia(e),this.Ba(t),this.Ga(),this.Aa(),this.Ha()},this.za=function(){C[this.sa+16>>2>>>0]=0}}function J(e){var t=L(e)+1,r=se(t);return r&&P(e,x,r,t),r}var Y={};function Q(){if(!X){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:f||"./this.program"};for(e in Y)void 0===Y[e]?delete t[e]:t[e]=Y[e];var r=[];for(e in t)r.push(e+"="+t[e]);X=r}return X}var X,ee=[null,[],[]];function te(e){return 0==e%4&&(0!=e%100||0==e%400)}var re=[31,29,31,30,31,30,31,31,30,31,30,31],ne=[31,28,31,30,31,30,31,31,30,31,30,31];function ie(e,t,r,n){function i(e,t,r){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=r[0]+e;return e}function o(e,t){return i(e,t,"0")}function s(e,t){function r(e){return 0>e?-1:0<e?1:0}var n;return 0===(n=r(e.getFullYear()-t.getFullYear()))&&0===(n=r(e.getMonth()-t.getMonth()))&&(n=r(e.getDate()-t.getDate())),n}function a(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function c(e){var t=e.qa;for(e=new Date(new Date(e.ra+1900,0,1).getTime());0<t;){var r=e.getMonth(),n=(te(e.getFullYear())?re:ne)[r];if(!(t>n-e.getDate())){e.setDate(e.getDate()+t);break}t-=n-e.getDate()+1,e.setDate(1),11>r?e.setMonth(r+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1))}return r=new Date(e.getFullYear()+1,0,4),t=a(new Date(e.getFullYear(),0,4)),r=a(r),0>=s(t,e)?0>=s(r,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}var u=I[n+40>>2>>>0];for(var l in n={Ea:I[n>>2>>>0],Da:I[n+4>>2>>>0],ta:I[n+8>>2>>>0],va:I[n+12>>2>>>0],ua:I[n+16>>2>>>0],ra:I[n+20>>2>>>0],la:I[n+24>>2>>>0],qa:I[n+28>>2>>>0],Ja:I[n+32>>2>>>0],Ca:I[n+36>>2>>>0],Fa:u?N(u):""},r=N(r),u={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})r=r.replace(new RegExp(l,"g"),u[l]);var d="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),h="January February March April May June July August September October November December".split(" ");for(l in u={"%a":function(e){return d[e.la].substring(0,3)},"%A":function(e){return d[e.la]},"%b":function(e){return h[e.ua].substring(0,3)},"%B":function(e){return h[e.ua]},"%C":function(e){return o((e.ra+1900)/100|0,2)},"%d":function(e){return o(e.va,2)},"%e":function(e){return i(e.va,2," ")},"%g":function(e){return c(e).toString().substring(2)},"%G":function(e){return c(e)},"%H":function(e){return o(e.ta,2)},"%I":function(e){return 0==(e=e.ta)?e=12:12<e&&(e-=12),o(e,2)},"%j":function(e){for(var t=0,r=0;r<=e.ua-1;t+=(te(e.ra+1900)?re:ne)[r++]);return o(e.va+t,3)},"%m":function(e){return o(e.ua+1,2)},"%M":function(e){return o(e.Da,2)},"%n":function(){return"\n"},"%p":function(e){return 0<=e.ta&&12>e.ta?"AM":"PM"},"%S":function(e){return o(e.Ea,2)},"%t":function(){return"\t"},"%u":function(e){return e.la||7},"%U":function(e){return o(Math.floor((e.qa+7-e.la)/7),2)},"%V":function(e){var t=Math.floor((e.qa+7-(e.la+6)%7)/7);if(2>=(e.la+371-e.qa-2)%7&&t++,t)53==t&&(4==(r=(e.la+371-e.qa)%7)||3==r&&te(e.ra)||(t=1));else{t=52;var r=(e.la+7-e.qa-1)%7;(4==r||5==r&&te(e.ra%400-1))&&t++}return o(t,2)},"%w":function(e){return e.la},"%W":function(e){return o(Math.floor((e.qa+7-(e.la+6)%7)/7),2)},"%y":function(e){return(e.ra+1900).toString().substring(2)},"%Y":function(e){return e.ra+1900},"%z":function(e){var t=0<=(e=e.Ca);return e=Math.abs(e)/60,(t?"+":"-")+String("0000"+(e/60*100+e%60)).slice(-4)},"%Z":function(e){return e.Fa},"%%":function(){return"%"}},r=r.replace(/%%/g,"\0\0"),u)r.includes(l)&&(r=r.replace(new RegExp(l,"g"),u[l](n)));return l=function(e){var t=Array(L(e)+1);return P(e,t,0,t.length),t}(r=r.replace(/\0\0/g,"%")),l.length>t?0:(x.set(l,e>>>0),l.length-1)}var oe={a:function(e){return se(e+24)+24},b:function(e,t,r){throw new W(e).ya(t,r),e},g:function(){return 0},I:function(){},w:function(){},y:function(){},K:function(){return 0},G:function(){},C:function(){},F:function(){},k:function(){},x:function(){},u:function(){},H:function(){},v:function(){},n:function(){},p:function(){G("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},o:function(){G("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},l:function(){return Date.now()},L:function(){return!0},M:function(e,t){e=new Date(1e3*(C[e>>>2]+4294967296*I[e+4>>>2])),I[t>>2>>>0]=e.getUTCSeconds(),I[t+4>>2>>>0]=e.getUTCMinutes(),I[t+8>>2>>>0]=e.getUTCHours(),I[t+12>>2>>>0]=e.getUTCDate(),I[t+16>>2>>>0]=e.getUTCMonth(),I[t+20>>2>>>0]=e.getUTCFullYear()-1900,I[t+24>>2>>>0]=e.getUTCDay(),I[t+28>>2>>>0]=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},N:function(e,t){e=new Date(1e3*(C[e>>>2]+4294967296*I[e+4>>>2])),I[t>>2>>>0]=e.getSeconds(),I[t+4>>2>>>0]=e.getMinutes(),I[t+8>>2>>>0]=e.getHours(),I[t+12>>2>>>0]=e.getDate(),I[t+16>>2>>>0]=e.getMonth(),I[t+20>>2>>>0]=e.getFullYear()-1900,I[t+24>>2>>>0]=e.getDay();var r=new Date(e.getFullYear(),0,1);I[t+28>>2>>>0]=(e.getTime()-r.getTime())/864e5|0,I[t+36>>2>>>0]=-60*e.getTimezoneOffset();var n=new Date(e.getFullYear(),6,1).getTimezoneOffset();r=r.getTimezoneOffset(),I[t+32>>2>>>0]=0|(n!=r&&e.getTimezoneOffset()==Math.min(r,n))},O:function(e){var t=new Date(I[e+20>>2>>>0]+1900,I[e+16>>2>>>0],I[e+12>>2>>>0],I[e+8>>2>>>0],I[e+4>>2>>>0],I[e>>2>>>0],0),r=I[e+32>>2>>>0],n=t.getTimezoneOffset(),i=new Date(t.getFullYear(),0,1),o=new Date(t.getFullYear(),6,1).getTimezoneOffset(),s=i.getTimezoneOffset(),a=Math.min(s,o);return 0>r?I[e+32>>2>>>0]=Number(o!=s&&a==n):0<r!=(a==n)&&(o=Math.max(s,o),t.setTime(t.getTime()+6e4*((0<r?a:o)-n))),I[e+24>>2>>>0]=t.getDay(),I[e+28>>2>>>0]=(t.getTime()-i.getTime())/864e5|0,I[e>>2>>>0]=t.getSeconds(),I[e+4>>2>>>0]=t.getMinutes(),I[e+8>>2>>>0]=t.getHours(),I[e+12>>2>>>0]=t.getDate(),I[e+16>>2>>>0]=t.getMonth(),t.getTime()/1e3|0},z:function(){return-52},B:function(){},m:function e(t,r,n){e.xa||(e.xa=!0,function(e,t,r){function n(e){return(e=e.toTimeString().match(/\(([A-Za-z ]+)\)$/))?e[1]:"GMT"}var i=(new Date).getFullYear(),o=new Date(i,0,1),s=new Date(i,6,1);i=o.getTimezoneOffset();var a=s.getTimezoneOffset();I[e>>2>>>0]=60*Math.max(i,a),I[t>>2>>>0]=Number(i!=a),e=n(o),t=n(s),e=J(e),t=J(t),a<i?(C[r>>2>>>0]=e,C[r+4>>2>>>0]=t):(C[r>>2>>>0]=t,C[r+4>>2>>>0]=e)}(t,r,n))},d:function(){G("")},t:function(){return 4294901760},h:v?()=>{var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:()=>performance.now(),J:function(e,t,r){A.copyWithin(e>>>0,t>>>0,t+r>>>0)},f:function(e){var t=A.length;if(4294901760<(e>>>=0))return!1;for(var r=1;4>=r;r*=2){var n=t*(1+.2/r);n=Math.min(n,e+100663296);var i=Math;n=Math.max(e,n),i=i.min.call(i,4294901760,n+(65536-n%65536)%65536);e:{try{_.grow(i-T.byteLength+65535>>>16),D();var o=1;break e}catch(e){}o=void 0}if(o)return!0}return!1},D:function(e,t){var r=0;return Q().forEach((function(n,i){var o=t+r;for(i=C[e+4*i>>2>>>0]=o,o=0;o<n.length;++o)x[i++>>0>>>0]=n.charCodeAt(o);x[i>>0>>>0]=0,r+=n.length+1})),0},E:function(e,t){var r=Q();C[e>>2>>>0]=r.length;var n=0;return r.forEach((function(e){n+=e.length+1})),C[t>>2>>>0]=n,0},r:function(e){S||(t.onExit&&t.onExit(e),R=!0),p(e,new z(e))},e:function(){return 52},j:function(){return 52},q:function(){return 70},i:function(e,t,r,n){for(var i=0,o=0;o<r;o++){var s=C[t>>2>>>0],a=C[t+4>>2>>>0];t+=8;for(var c=0;c<a;c++){var u=A[s+c>>>0],l=ee[e];0===u||10===u?((1===e?E:w)(O(l,0)),l.length=0):l.push(u)}i+=a}return C[n>>2>>>0]=i,0},s:function e(t,n){e.wa||(e.wa=function(){if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var e=new Uint8Array(1);return()=>(crypto.getRandomValues(e),e[0])}if(v)try{var t=r(760);return()=>t.randomBytes(1)[0]}catch(e){}return()=>G("randomDevice")}());for(var i=0;i<n;i++)x[t+i>>0>>>0]=e.wa();return 0},A:ie,c:function(e,t,r,n){return ie(e,t,r,n)}};!function(){function e(e){t.asm=e.exports,_=t.asm.P,D(),U.unshift(t.asm.Q),V--,t.monitorRunDependencies&&t.monitorRunDependencies(V),0==V&&H&&(e=H,H=null,e())}function r(t){e(t.instance)}function n(e){return function(){if(!b&&(m||g)){if("function"==typeof fetch&&!j.startsWith("file://"))return fetch(j,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+j+"'";return e.arrayBuffer()})).catch((function(){return Z()}));if(a)return new Promise((function(e,t){a(j,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return Z()}))}().then((function(e){return WebAssembly.instantiate(e,i)})).then((function(e){return e})).then(e,(function(e){w("failed to asynchronously prepare wasm: "+e),G(e)}))}var i={a:oe};if(V++,t.monitorRunDependencies&&t.monitorRunDependencies(V),t.instantiateWasm)try{return t.instantiateWasm(i,e)}catch(e){return w("Module.instantiateWasm callback failed with error: "+e),!1}(b||"function"!=typeof WebAssembly.instantiateStreaming||q()||j.startsWith("file://")||v||"function"!=typeof fetch?n(r):fetch(j,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,i).then(r,(function(e){return w("wasm streaming compile failed: "+e),w("falling back to ArrayBuffer instantiation"),n(r)}))}))).catch(o)}(),t.___wasm_call_ctors=function(){return(t.___wasm_call_ctors=t.asm.Q).apply(null,arguments)},t._OrtInit=function(){return(t._OrtInit=t.asm.R).apply(null,arguments)},t._OrtCreateSessionOptions=function(){return(t._OrtCreateSessionOptions=t.asm.S).apply(null,arguments)},t._OrtAppendExecutionProvider=function(){return(t._OrtAppendExecutionProvider=t.asm.T).apply(null,arguments)},t._OrtAddSessionConfigEntry=function(){return(t._OrtAddSessionConfigEntry=t.asm.U).apply(null,arguments)},t._OrtReleaseSessionOptions=function(){return(t._OrtReleaseSessionOptions=t.asm.V).apply(null,arguments)},t._OrtCreateSession=function(){return(t._OrtCreateSession=t.asm.W).apply(null,arguments)},t._OrtReleaseSession=function(){return(t._OrtReleaseSession=t.asm.X).apply(null,arguments)},t._OrtGetInputCount=function(){return(t._OrtGetInputCount=t.asm.Y).apply(null,arguments)},t._OrtGetOutputCount=function(){return(t._OrtGetOutputCount=t.asm.Z).apply(null,arguments)},t._OrtGetInputName=function(){return(t._OrtGetInputName=t.asm._).apply(null,arguments)},t._OrtGetOutputName=function(){return(t._OrtGetOutputName=t.asm.$).apply(null,arguments)},t._OrtFree=function(){return(t._OrtFree=t.asm.aa).apply(null,arguments)},t._OrtCreateTensor=function(){return(t._OrtCreateTensor=t.asm.ba).apply(null,arguments)},t._OrtGetTensorData=function(){return(t._OrtGetTensorData=t.asm.ca).apply(null,arguments)},t._OrtReleaseTensor=function(){return(t._OrtReleaseTensor=t.asm.da).apply(null,arguments)},t._OrtCreateRunOptions=function(){return(t._OrtCreateRunOptions=t.asm.ea).apply(null,arguments)},t._OrtAddRunConfigEntry=function(){return(t._OrtAddRunConfigEntry=t.asm.fa).apply(null,arguments)},t._OrtReleaseRunOptions=function(){return(t._OrtReleaseRunOptions=t.asm.ga).apply(null,arguments)},t._OrtRun=function(){return(t._OrtRun=t.asm.ha).apply(null,arguments)},t._OrtEndProfiling=function(){return(t._OrtEndProfiling=t.asm.ia).apply(null,arguments)};var se=t._malloc=function(){return(se=t._malloc=t.asm.ja).apply(null,arguments)};t._free=function(){return(t._free=t.asm.ka).apply(null,arguments)};var ae,ce=t.stackSave=function(){return(ce=t.stackSave=t.asm.ma).apply(null,arguments)},ue=t.stackRestore=function(){return(ue=t.stackRestore=t.asm.na).apply(null,arguments)},le=t.stackAlloc=function(){return(le=t.stackAlloc=t.asm.oa).apply(null,arguments)};function de(){function e(){if(!ae&&(ae=!0,t.calledRun=!0,!R)){if(K(U),i(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),t.postRun)for("function"==typeof t.postRun&&(t.postRun=[t.postRun]);t.postRun.length;){var e=t.postRun.shift();B.unshift(e)}K(B)}}if(!(0<V)){if(t.preRun)for("function"==typeof t.preRun&&(t.preRun=[t.preRun]);t.preRun.length;)F();K(M),0<V||(t.setStatus?(t.setStatus("Running..."),setTimeout((function(){setTimeout((function(){t.setStatus("")}),1),e()}),1)):e())}}if(t.___cxa_is_pointer_type=function(){return(t.___cxa_is_pointer_type=t.asm.pa).apply(null,arguments)},t.UTF8ToString=N,t.stringToUTF8=function(e,t,r){return P(e,A,t,r)},t.lengthBytesUTF8=L,t.stackSave=ce,t.stackRestore=ue,t.stackAlloc=le,H=function e(){ae||de(),ae||(H=e)},t.preInit)for("function"==typeof t.preInit&&(t.preInit=[t.preInit]);0<t.preInit.length;)t.preInit.pop()();return de(),e.ready});e.exports=i},4537:e=>{e.exports=function(e,t){for(var r=new Array(arguments.length-1),n=0,i=2,o=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise((function(i,s){r[n]=function(e){if(o)if(o=!1,e)s(e);else{for(var t=new Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];i.apply(null,t)}};try{e.apply(t||null,r)}catch(e){o&&(o=!1,s(e))}}))}},7419:(e,t)=>{var r=t;r.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r};for(var n=new Array(64),i=new Array(123),o=0;o<64;)i[n[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;r.encode=function(e,t,r){for(var i,o=null,s=[],a=0,c=0;t<r;){var u=e[t++];switch(c){case 0:s[a++]=n[u>>2],i=(3&u)<<4,c=1;break;case 1:s[a++]=n[i|u>>4],i=(15&u)<<2,c=2;break;case 2:s[a++]=n[i|u>>6],s[a++]=n[63&u],c=0}a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0)}return c&&(s[a++]=n[i],s[a++]=61,1===c&&(s[a++]=61)),o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var s="invalid encoding";r.decode=function(e,t,r){for(var n,o=r,a=0,c=0;c<e.length;){var u=e.charCodeAt(c++);if(61===u&&a>1)break;if(void 0===(u=i[u]))throw Error(s);switch(a){case 0:n=u,a=1;break;case 1:t[r++]=n<<2|(48&u)>>4,n=u,a=2;break;case 2:t[r++]=(15&n)<<4|(60&u)>>2,n=u,a=3;break;case 3:t[r++]=(3&n)<<6|u,a=0}}if(1===a)throw Error(s);return r-o},r.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},9211:e=>{function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],n=0;n<r.length;)r[n].fn===t?r.splice(n,1):++n;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],n=1;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,r)}return this}},945:e=>{function t(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=128===r[3];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3]}function o(e,n,i){t[0]=e,n[i]=r[3],n[i+1]=r[2],n[i+2]=r[1],n[i+3]=r[0]}function s(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],t[0]}function a(e,n){return r[3]=e[n],r[2]=e[n+1],r[1]=e[n+2],r[0]=e[n+3],t[0]}e.writeFloatLE=n?i:o,e.writeFloatBE=n?o:i,e.readFloatLE=n?s:a,e.readFloatBE=n?a:s}():function(){function t(e,t,r,n){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,r,n);else if(isNaN(t))e(2143289344,r,n);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,r,n);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,r,n);else{var o=Math.floor(Math.log(t)/Math.LN2);e((i<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,r,n)}}function s(e,t,r){var n=e(t,r),i=2*(n>>31)+1,o=n>>>23&255,s=8388607&n;return 255===o?s?NaN:i*(1/0):0===o?1401298464324817e-60*i*s:i*Math.pow(2,o-150)*(s+8388608)}e.writeFloatLE=t.bind(null,r),e.writeFloatBE=t.bind(null,n),e.readFloatLE=s.bind(null,i),e.readFloatBE=s.bind(null,o)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=128===r[7];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3],n[i+4]=r[4],n[i+5]=r[5],n[i+6]=r[6],n[i+7]=r[7]}function o(e,n,i){t[0]=e,n[i]=r[7],n[i+1]=r[6],n[i+2]=r[5],n[i+3]=r[4],n[i+4]=r[3],n[i+5]=r[2],n[i+6]=r[1],n[i+7]=r[0]}function s(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],r[4]=e[n+4],r[5]=e[n+5],r[6]=e[n+6],r[7]=e[n+7],t[0]}function a(e,n){return r[7]=e[n],r[6]=e[n+1],r[5]=e[n+2],r[4]=e[n+3],r[3]=e[n+4],r[2]=e[n+5],r[1]=e[n+6],r[0]=e[n+7],t[0]}e.writeDoubleLE=n?i:o,e.writeDoubleBE=n?o:i,e.readDoubleLE=n?s:a,e.readDoubleBE=n?a:s}():function(){function t(e,t,r,n,i,o){var s=n<0?1:0;if(s&&(n=-n),0===n)e(0,i,o+t),e(1/n>0?0:2147483648,i,o+r);else if(isNaN(n))e(0,i,o+t),e(2146959360,i,o+r);else if(n>17976931348623157e292)e(0,i,o+t),e((s<<31|2146435072)>>>0,i,o+r);else{var a;if(n<22250738585072014e-324)e((a=n/5e-324)>>>0,i,o+t),e((s<<31|a/4294967296)>>>0,i,o+r);else{var c=Math.floor(Math.log(n)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(a=n*Math.pow(2,-c))>>>0,i,o+t),e((s<<31|c+1023<<20|1048576*a&1048575)>>>0,i,o+r)}}}function s(e,t,r,n,i){var o=e(n,i+t),s=e(n,i+r),a=2*(s>>31)+1,c=s>>>20&2047,u=4294967296*(1048575&s)+o;return 2047===c?u?NaN:a*(1/0):0===c?5e-324*a*u:a*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,r,0,4),e.writeDoubleBE=t.bind(null,n,4,0),e.readDoubleLE=s.bind(null,i,0,4),e.readDoubleBE=s.bind(null,o,4,0)}(),e}function r(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function n(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function i(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function o(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},7199:module=>{function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},6662:e=>{e.exports=function(e,t,r){var n=r||8192,i=n>>>1,o=null,s=n;return function(r){if(r<1||r>i)return e(r);s+r>n&&(o=e(n),s=0);var a=t.call(o,s,s+=r);return 7&s&&(s=1+(7|s)),a}}},4997:(e,t)=>{var r=t;r.length=function(e){for(var t=0,r=0,n=0;n<e.length;++n)(r=e.charCodeAt(n))<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},r.read=function(e,t,r){if(r-t<1)return"";for(var n,i=null,o=[],s=0;t<r;)(n=e[t++])<128?o[s++]=n:n>191&&n<224?o[s++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[s++]=55296+(n>>10),o[s++]=56320+(1023&n)):o[s++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0);return i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))},r.write=function(e,t,r){for(var n,i,o=r,s=0;s<e.length;++s)(n=e.charCodeAt(s))<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=63&n|128):55296==(64512&n)&&56320==(64512&(i=e.charCodeAt(s+1)))?(n=65536+((1023&n)<<10)+(1023&i),++s,t[r++]=n>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=63&n|128):(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=63&n|128);return r-o}},3442:(e,t)=>{t.__esModule=!0;var r=function(){function e(t){if(!t)throw new TypeError("Invalid argument; `value` has no value.");this.value=e.EMPTY,t&&e.isGuid(t)&&(this.value=t)}return e.isGuid=function(t){var r=t.toString();return t&&(t instanceof e||e.validator.test(r))},e.create=function(){return new e([e.gen(2),e.gen(1),e.gen(1),e.gen(1),e.gen(3)].join("-"))},e.createEmpty=function(){return new e("emptyguid")},e.parse=function(t){return new e(t)},e.raw=function(){return[e.gen(2),e.gen(1),e.gen(1),e.gen(1),e.gen(3)].join("-")},e.gen=function(e){for(var t="",r=0;r<e;r++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t},e.prototype.equals=function(t){return e.isGuid(t)&&this.value===t.toString()},e.prototype.isEmpty=function(){return this.value===e.EMPTY},e.prototype.toString=function(){return this.value},e.prototype.toJSON=function(){return{value:this.value}},e.validator=new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i"),e.EMPTY="00000000-0000-0000-0000-000000000000",e}();t.Guid=r},3720:e=>{e.exports=r;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function r(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function n(e){return!0===(e&&e.__isLong__)}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=n;var i={},o={};function s(e,t){var r,n,s;return t?(s=0<=(e>>>=0)&&e<256)&&(n=o[e])?n:(r=c(e,(0|e)<0?-1:0,!0),s&&(o[e]=r),r):(s=-128<=(e|=0)&&e<128)&&(n=i[e])?n:(r=c(e,e<0?-1:0,!1),s&&(i[e]=r),r)}function a(e,t){if(isNaN(e))return t?v:g;if(t){if(e<0)return v;if(e>=f)return S}else{if(e<=-p)return _;if(e+1>=p)return w}return e<0?a(-e,t).neg():c(e%h|0,e/h|0,t)}function c(e,t,n){return new r(e,t,n)}r.fromInt=s,r.fromNumber=a,r.fromBits=c;var u=Math.pow;function l(e,t,r){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return g;if("number"==typeof t?(r=t,t=!1):t=!!t,(r=r||10)<2||36<r)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return l(e.substring(1),t,r).neg();for(var i=a(u(r,8)),o=g,s=0;s<e.length;s+=8){var c=Math.min(8,e.length-s),d=parseInt(e.substring(s,s+c),r);if(c<8){var h=a(u(r,c));o=o.mul(h).add(a(d))}else o=(o=o.mul(i)).add(a(d))}return o.unsigned=t,o}function d(e,t){return"number"==typeof e?a(e,t):"string"==typeof e?l(e,t):c(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}r.fromString=l,r.fromValue=d;var h=4294967296,f=h*h,p=f/2,m=s(1<<24),g=s(0);r.ZERO=g;var v=s(0,!0);r.UZERO=v;var y=s(1);r.ONE=y;var b=s(1,!0);r.UONE=b;var E=s(-1);r.NEG_ONE=E;var w=c(-1,2147483647,!1);r.MAX_VALUE=w;var S=c(-1,-1,!0);r.MAX_UNSIGNED_VALUE=S;var _=c(0,-2147483648,!1);r.MIN_VALUE=_;var T=r.prototype;T.toInt=function(){return this.unsigned?this.low>>>0:this.low},T.toNumber=function(){return this.unsigned?(this.high>>>0)*h+(this.low>>>0):this.high*h+(this.low>>>0)},T.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(_)){var t=a(e),r=this.div(t),n=r.mul(t).sub(this);return r.toString(e)+n.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=a(u(e,6),this.unsigned),o=this,s="";;){var c=o.div(i),l=(o.sub(c.mul(i)).toInt()>>>0).toString(e);if((o=c).isZero())return l+s;for(;l.length<6;)l="0"+l;s=""+l+s}},T.getHighBits=function(){return this.high},T.getHighBitsUnsigned=function(){return this.high>>>0},T.getLowBits=function(){return this.low},T.getLowBitsUnsigned=function(){return this.low>>>0},T.getNumBitsAbs=function(){if(this.isNegative())return this.eq(_)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},T.isZero=function(){return 0===this.high&&0===this.low},T.eqz=T.isZero,T.isNegative=function(){return!this.unsigned&&this.high<0},T.isPositive=function(){return this.unsigned||this.high>=0},T.isOdd=function(){return 1==(1&this.low)},T.isEven=function(){return 0==(1&this.low)},T.equals=function(e){return n(e)||(e=d(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},T.eq=T.equals,T.notEquals=function(e){return!this.eq(e)},T.neq=T.notEquals,T.ne=T.notEquals,T.lessThan=function(e){return this.comp(e)<0},T.lt=T.lessThan,T.lessThanOrEqual=function(e){return this.comp(e)<=0},T.lte=T.lessThanOrEqual,T.le=T.lessThanOrEqual,T.greaterThan=function(e){return this.comp(e)>0},T.gt=T.greaterThan,T.greaterThanOrEqual=function(e){return this.comp(e)>=0},T.gte=T.greaterThanOrEqual,T.ge=T.greaterThanOrEqual,T.compare=function(e){if(n(e)||(e=d(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},T.comp=T.compare,T.negate=function(){return!this.unsigned&&this.eq(_)?_:this.not().add(y)},T.neg=T.negate,T.add=function(e){n(e)||(e=d(e));var t=this.high>>>16,r=65535&this.high,i=this.low>>>16,o=65535&this.low,s=e.high>>>16,a=65535&e.high,u=e.low>>>16,l=0,h=0,f=0,p=0;return f+=(p+=o+(65535&e.low))>>>16,h+=(f+=i+u)>>>16,l+=(h+=r+a)>>>16,l+=t+s,c((f&=65535)<<16|(p&=65535),(l&=65535)<<16|(h&=65535),this.unsigned)},T.subtract=function(e){return n(e)||(e=d(e)),this.add(e.neg())},T.sub=T.subtract,T.multiply=function(e){if(this.isZero())return g;if(n(e)||(e=d(e)),t)return c(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return g;if(this.eq(_))return e.isOdd()?_:g;if(e.eq(_))return this.isOdd()?_:g;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(m)&&e.lt(m))return a(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,i=65535&this.high,o=this.low>>>16,s=65535&this.low,u=e.high>>>16,l=65535&e.high,h=e.low>>>16,f=65535&e.low,p=0,v=0,y=0,b=0;return y+=(b+=s*f)>>>16,v+=(y+=o*f)>>>16,y&=65535,v+=(y+=s*h)>>>16,p+=(v+=i*f)>>>16,v&=65535,p+=(v+=o*h)>>>16,v&=65535,p+=(v+=s*l)>>>16,p+=r*f+i*h+o*l+s*u,c((y&=65535)<<16|(b&=65535),(p&=65535)<<16|(v&=65535),this.unsigned)},T.mul=T.multiply,T.divide=function(e){if(n(e)||(e=d(e)),e.isZero())throw Error("division by zero");var r,i,o;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?c((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?v:g;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return v;if(e.gt(this.shru(1)))return b;o=v}else{if(this.eq(_))return e.eq(y)||e.eq(E)?_:e.eq(_)?y:(r=this.shr(1).div(e).shl(1)).eq(g)?e.isNegative()?y:E:(i=this.sub(e.mul(r)),o=r.add(i.div(e)));if(e.eq(_))return this.unsigned?v:g;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=g}for(i=this;i.gte(e);){r=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(r)/Math.LN2),l=s<=48?1:u(2,s-48),h=a(r),f=h.mul(e);f.isNegative()||f.gt(i);)f=(h=a(r-=l,this.unsigned)).mul(e);h.isZero()&&(h=y),o=o.add(h),i=i.sub(f)}return o},T.div=T.divide,T.modulo=function(e){return n(e)||(e=d(e)),t?c((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},T.mod=T.modulo,T.rem=T.modulo,T.not=function(){return c(~this.low,~this.high,this.unsigned)},T.and=function(e){return n(e)||(e=d(e)),c(this.low&e.low,this.high&e.high,this.unsigned)},T.or=function(e){return n(e)||(e=d(e)),c(this.low|e.low,this.high|e.high,this.unsigned)},T.xor=function(e){return n(e)||(e=d(e)),c(this.low^e.low,this.high^e.high,this.unsigned)},T.shiftLeft=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?c(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):c(0,this.low<<e-32,this.unsigned)},T.shl=T.shiftLeft,T.shiftRight=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?c(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):c(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},T.shr=T.shiftRight,T.shiftRightUnsigned=function(e){if(n(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return e<32?c(this.low>>>e|t<<32-e,t>>>e,this.unsigned):c(32===e?t:t>>>e-32,0,this.unsigned)},T.shru=T.shiftRightUnsigned,T.shr_u=T.shiftRightUnsigned,T.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},T.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},T.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},T.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},T.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},r.fromBytes=function(e,t,n){return n?r.fromBytesLE(e,t):r.fromBytesBE(e,t)},r.fromBytesLE=function(e,t){return new r(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},r.fromBytesBE=function(e,t){return new r(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},1446:(e,t,r)=>{var n,i,o,s=r(2100),a=s.Reader,c=s.Writer,u=s.util,l=s.roots.default||(s.roots.default={});l.onnx=((o={}).Version=(n={},(i=Object.create(n))[n[0]="_START_VERSION"]=0,i[n[1]="IR_VERSION_2017_10_10"]=1,i[n[2]="IR_VERSION_2017_10_30"]=2,i[n[3]="IR_VERSION_2017_11_3"]=3,i[n[4]="IR_VERSION_2019_1_22"]=4,i[n[5]="IR_VERSION"]=5,i),o.AttributeProto=function(){function e(e){if(this.floats=[],this.ints=[],this.strings=[],this.tensors=[],this.graphs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.name="",e.prototype.refAttrName="",e.prototype.docString="",e.prototype.type=0,e.prototype.f=0,e.prototype.i=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.s=u.newBuffer([]),e.prototype.t=null,e.prototype.g=null,e.prototype.floats=u.emptyArray,e.prototype.ints=u.emptyArray,e.prototype.strings=u.emptyArray,e.prototype.tensors=u.emptyArray,e.prototype.graphs=u.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=c.create()),null!=e.name&&e.hasOwnProperty("name")&&t.uint32(10).string(e.name),null!=e.f&&e.hasOwnProperty("f")&&t.uint32(21).float(e.f),null!=e.i&&e.hasOwnProperty("i")&&t.uint32(24).int64(e.i),null!=e.s&&e.hasOwnProperty("s")&&t.uint32(34).bytes(e.s),null!=e.t&&e.hasOwnProperty("t")&&l.onnx.TensorProto.encode(e.t,t.uint32(42).fork()).ldelim(),null!=e.g&&e.hasOwnProperty("g")&&l.onnx.GraphProto.encode(e.g,t.uint32(50).fork()).ldelim(),null!=e.floats&&e.floats.length){t.uint32(58).fork();for(var r=0;r<e.floats.length;++r)t.float(e.floats[r]);t.ldelim()}if(null!=e.ints&&e.ints.length){for(t.uint32(66).fork(),r=0;r<e.ints.length;++r)t.int64(e.ints[r]);t.ldelim()}if(null!=e.strings&&e.strings.length)for(r=0;r<e.strings.length;++r)t.uint32(74).bytes(e.strings[r]);if(null!=e.tensors&&e.tensors.length)for(r=0;r<e.tensors.length;++r)l.onnx.TensorProto.encode(e.tensors[r],t.uint32(82).fork()).ldelim();if(null!=e.graphs&&e.graphs.length)for(r=0;r<e.graphs.length;++r)l.onnx.GraphProto.encode(e.graphs[r],t.uint32(90).fork()).ldelim();return null!=e.docString&&e.hasOwnProperty("docString")&&t.uint32(106).string(e.docString),null!=e.type&&e.hasOwnProperty("type")&&t.uint32(160).int32(e.type),null!=e.refAttrName&&e.hasOwnProperty("refAttrName")&&t.uint32(170).string(e.refAttrName),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.AttributeProto;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.name=e.string();break;case 21:n.refAttrName=e.string();break;case 13:n.docString=e.string();break;case 20:n.type=e.int32();break;case 2:n.f=e.float();break;case 3:n.i=e.int64();break;case 4:n.s=e.bytes();break;case 5:n.t=l.onnx.TensorProto.decode(e,e.uint32());break;case 6:n.g=l.onnx.GraphProto.decode(e,e.uint32());break;case 7:if(n.floats&&n.floats.length||(n.floats=[]),2==(7&i))for(var o=e.uint32()+e.pos;e.pos<o;)n.floats.push(e.float());else n.floats.push(e.float());break;case 8:if(n.ints&&n.ints.length||(n.ints=[]),2==(7&i))for(o=e.uint32()+e.pos;e.pos<o;)n.ints.push(e.int64());else n.ints.push(e.int64());break;case 9:n.strings&&n.strings.length||(n.strings=[]),n.strings.push(e.bytes());break;case 10:n.tensors&&n.tensors.length||(n.tensors=[]),n.tensors.push(l.onnx.TensorProto.decode(e,e.uint32()));break;case 11:n.graphs&&n.graphs.length||(n.graphs=[]),n.graphs.push(l.onnx.GraphProto.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!u.isString(e.name))return"name: string expected";if(null!=e.refAttrName&&e.hasOwnProperty("refAttrName")&&!u.isString(e.refAttrName))return"refAttrName: string expected";if(null!=e.docString&&e.hasOwnProperty("docString")&&!u.isString(e.docString))return"docString: string expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:}if(null!=e.f&&e.hasOwnProperty("f")&&"number"!=typeof e.f)return"f: number expected";if(null!=e.i&&e.hasOwnProperty("i")&&!(u.isInteger(e.i)||e.i&&u.isInteger(e.i.low)&&u.isInteger(e.i.high)))return"i: integer|Long expected";if(null!=e.s&&e.hasOwnProperty("s")&&!(e.s&&"number"==typeof e.s.length||u.isString(e.s)))return"s: buffer expected";if(null!=e.t&&e.hasOwnProperty("t")&&(r=l.onnx.TensorProto.verify(e.t)))return"t."+r;if(null!=e.g&&e.hasOwnProperty("g")&&(r=l.onnx.GraphProto.verify(e.g)))return"g."+r;if(null!=e.floats&&e.hasOwnProperty("floats")){if(!Array.isArray(e.floats))return"floats: array expected";for(var t=0;t<e.floats.length;++t)if("number"!=typeof e.floats[t])return"floats: number[] expected"}if(null!=e.ints&&e.hasOwnProperty("ints")){if(!Array.isArray(e.ints))return"ints: array expected";for(t=0;t<e.ints.length;++t)if(!(u.isInteger(e.ints[t])||e.ints[t]&&u.isInteger(e.ints[t].low)&&u.isInteger(e.ints[t].high)))return"ints: integer|Long[] expected"}if(null!=e.strings&&e.hasOwnProperty("strings")){if(!Array.isArray(e.strings))return"strings: array expected";for(t=0;t<e.strings.length;++t)if(!(e.strings[t]&&"number"==typeof e.strings[t].length||u.isString(e.strings[t])))return"strings: buffer[] expected"}if(null!=e.tensors&&e.hasOwnProperty("tensors")){if(!Array.isArray(e.tensors))return"tensors: array expected";for(t=0;t<e.tensors.length;++t)if(r=l.onnx.TensorProto.verify(e.tensors[t]))return"tensors."+r}if(null!=e.graphs&&e.hasOwnProperty("graphs")){if(!Array.isArray(e.graphs))return"graphs: array expected";for(t=0;t<e.graphs.length;++t){var r;if(r=l.onnx.GraphProto.verify(e.graphs[t]))return"graphs."+r}}return null},e.fromObject=function(e){if(e instanceof l.onnx.AttributeProto)return e;var t=new l.onnx.AttributeProto;switch(null!=e.name&&(t.name=String(e.name)),null!=e.refAttrName&&(t.refAttrName=String(e.refAttrName)),null!=e.docString&&(t.docString=String(e.docString)),e.type){case"UNDEFINED":case 0:t.type=0;break;case"FLOAT":case 1:t.type=1;break;case"INT":case 2:t.type=2;break;case"STRING":case 3:t.type=3;break;case"TENSOR":case 4:t.type=4;break;case"GRAPH":case 5:t.type=5;break;case"FLOATS":case 6:t.type=6;break;case"INTS":case 7:t.type=7;break;case"STRINGS":case 8:t.type=8;break;case"TENSORS":case 9:t.type=9;break;case"GRAPHS":case 10:t.type=10}if(null!=e.f&&(t.f=Number(e.f)),null!=e.i&&(u.Long?(t.i=u.Long.fromValue(e.i)).unsigned=!1:"string"==typeof e.i?t.i=parseInt(e.i,10):"number"==typeof e.i?t.i=e.i:"object"==typeof e.i&&(t.i=new u.LongBits(e.i.low>>>0,e.i.high>>>0).toNumber())),null!=e.s&&("string"==typeof e.s?u.base64.decode(e.s,t.s=u.newBuffer(u.base64.length(e.s)),0):e.s.length&&(t.s=e.s)),null!=e.t){if("object"!=typeof e.t)throw TypeError(".onnx.AttributeProto.t: object expected");t.t=l.onnx.TensorProto.fromObject(e.t)}if(null!=e.g){if("object"!=typeof e.g)throw TypeError(".onnx.AttributeProto.g: object expected");t.g=l.onnx.GraphProto.fromObject(e.g)}if(e.floats){if(!Array.isArray(e.floats))throw TypeError(".onnx.AttributeProto.floats: array expected");t.floats=[];for(var r=0;r<e.floats.length;++r)t.floats[r]=Number(e.floats[r])}if(e.ints){if(!Array.isArray(e.ints))throw TypeError(".onnx.AttributeProto.ints: array expected");for(t.ints=[],r=0;r<e.ints.length;++r)u.Long?(t.ints[r]=u.Long.fromValue(e.ints[r])).unsigned=!1:"string"==typeof e.ints[r]?t.ints[r]=parseInt(e.ints[r],10):"number"==typeof e.ints[r]?t.ints[r]=e.ints[r]:"object"==typeof e.ints[r]&&(t.ints[r]=new u.LongBits(e.ints[r].low>>>0,e.ints[r].high>>>0).toNumber())}if(e.strings){if(!Array.isArray(e.strings))throw TypeError(".onnx.AttributeProto.strings: array expected");for(t.strings=[],r=0;r<e.strings.length;++r)"string"==typeof e.strings[r]?u.base64.decode(e.strings[r],t.strings[r]=u.newBuffer(u.base64.length(e.strings[r])),0):e.strings[r].length&&(t.strings[r]=e.strings[r])}if(e.tensors){if(!Array.isArray(e.tensors))throw TypeError(".onnx.AttributeProto.tensors: array expected");for(t.tensors=[],r=0;r<e.tensors.length;++r){if("object"!=typeof e.tensors[r])throw TypeError(".onnx.AttributeProto.tensors: object expected");t.tensors[r]=l.onnx.TensorProto.fromObject(e.tensors[r])}}if(e.graphs){if(!Array.isArray(e.graphs))throw TypeError(".onnx.AttributeProto.graphs: array expected");for(t.graphs=[],r=0;r<e.graphs.length;++r){if("object"!=typeof e.graphs[r])throw TypeError(".onnx.AttributeProto.graphs: object expected");t.graphs[r]=l.onnx.GraphProto.fromObject(e.graphs[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.floats=[],r.ints=[],r.strings=[],r.tensors=[],r.graphs=[]),t.defaults){if(r.name="",r.f=0,u.Long){var n=new u.Long(0,0,!1);r.i=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.i=t.longs===String?"0":0;t.bytes===String?r.s="":(r.s=[],t.bytes!==Array&&(r.s=u.newBuffer(r.s))),r.t=null,r.g=null,r.docString="",r.type=t.enums===String?"UNDEFINED":0,r.refAttrName=""}if(null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.f&&e.hasOwnProperty("f")&&(r.f=t.json&&!isFinite(e.f)?String(e.f):e.f),null!=e.i&&e.hasOwnProperty("i")&&("number"==typeof e.i?r.i=t.longs===String?String(e.i):e.i:r.i=t.longs===String?u.Long.prototype.toString.call(e.i):t.longs===Number?new u.LongBits(e.i.low>>>0,e.i.high>>>0).toNumber():e.i),null!=e.s&&e.hasOwnProperty("s")&&(r.s=t.bytes===String?u.base64.encode(e.s,0,e.s.length):t.bytes===Array?Array.prototype.slice.call(e.s):e.s),null!=e.t&&e.hasOwnProperty("t")&&(r.t=l.onnx.TensorProto.toObject(e.t,t)),null!=e.g&&e.hasOwnProperty("g")&&(r.g=l.onnx.GraphProto.toObject(e.g,t)),e.floats&&e.floats.length){r.floats=[];for(var i=0;i<e.floats.length;++i)r.floats[i]=t.json&&!isFinite(e.floats[i])?String(e.floats[i]):e.floats[i]}if(e.ints&&e.ints.length)for(r.ints=[],i=0;i<e.ints.length;++i)"number"==typeof e.ints[i]?r.ints[i]=t.longs===String?String(e.ints[i]):e.ints[i]:r.ints[i]=t.longs===String?u.Long.prototype.toString.call(e.ints[i]):t.longs===Number?new u.LongBits(e.ints[i].low>>>0,e.ints[i].high>>>0).toNumber():e.ints[i];if(e.strings&&e.strings.length)for(r.strings=[],i=0;i<e.strings.length;++i)r.strings[i]=t.bytes===String?u.base64.encode(e.strings[i],0,e.strings[i].length):t.bytes===Array?Array.prototype.slice.call(e.strings[i]):e.strings[i];if(e.tensors&&e.tensors.length)for(r.tensors=[],i=0;i<e.tensors.length;++i)r.tensors[i]=l.onnx.TensorProto.toObject(e.tensors[i],t);if(e.graphs&&e.graphs.length)for(r.graphs=[],i=0;i<e.graphs.length;++i)r.graphs[i]=l.onnx.GraphProto.toObject(e.graphs[i],t);return null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),null!=e.type&&e.hasOwnProperty("type")&&(r.type=t.enums===String?l.onnx.AttributeProto.AttributeType[e.type]:e.type),null!=e.refAttrName&&e.hasOwnProperty("refAttrName")&&(r.refAttrName=e.refAttrName),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e.AttributeType=function(){var e={},t=Object.create(e);return t[e[0]="UNDEFINED"]=0,t[e[1]="FLOAT"]=1,t[e[2]="INT"]=2,t[e[3]="STRING"]=3,t[e[4]="TENSOR"]=4,t[e[5]="GRAPH"]=5,t[e[6]="FLOATS"]=6,t[e[7]="INTS"]=7,t[e[8]="STRINGS"]=8,t[e[9]="TENSORS"]=9,t[e[10]="GRAPHS"]=10,t}(),e}(),o.ValueInfoProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.name="",e.prototype.type=null,e.prototype.docString="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=c.create()),null!=e.name&&e.hasOwnProperty("name")&&t.uint32(10).string(e.name),null!=e.type&&e.hasOwnProperty("type")&&l.onnx.TypeProto.encode(e.type,t.uint32(18).fork()).ldelim(),null!=e.docString&&e.hasOwnProperty("docString")&&t.uint32(26).string(e.docString),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.ValueInfoProto;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.name=e.string();break;case 2:n.type=l.onnx.TypeProto.decode(e,e.uint32());break;case 3:n.docString=e.string();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!u.isString(e.name))return"name: string expected";if(null!=e.type&&e.hasOwnProperty("type")){var t=l.onnx.TypeProto.verify(e.type);if(t)return"type."+t}return null!=e.docString&&e.hasOwnProperty("docString")&&!u.isString(e.docString)?"docString: string expected":null},e.fromObject=function(e){if(e instanceof l.onnx.ValueInfoProto)return e;var t=new l.onnx.ValueInfoProto;if(null!=e.name&&(t.name=String(e.name)),null!=e.type){if("object"!=typeof e.type)throw TypeError(".onnx.ValueInfoProto.type: object expected");t.type=l.onnx.TypeProto.fromObject(e.type)}return null!=e.docString&&(t.docString=String(e.docString)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.name="",r.type=null,r.docString=""),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.type&&e.hasOwnProperty("type")&&(r.type=l.onnx.TypeProto.toObject(e.type,t)),null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),o.NodeProto=function(){function e(e){if(this.input=[],this.output=[],this.attribute=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.input=u.emptyArray,e.prototype.output=u.emptyArray,e.prototype.name="",e.prototype.opType="",e.prototype.domain="",e.prototype.attribute=u.emptyArray,e.prototype.docString="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=c.create()),null!=e.input&&e.input.length)for(var r=0;r<e.input.length;++r)t.uint32(10).string(e.input[r]);if(null!=e.output&&e.output.length)for(r=0;r<e.output.length;++r)t.uint32(18).string(e.output[r]);if(null!=e.name&&e.hasOwnProperty("name")&&t.uint32(26).string(e.name),null!=e.opType&&e.hasOwnProperty("opType")&&t.uint32(34).string(e.opType),null!=e.attribute&&e.attribute.length)for(r=0;r<e.attribute.length;++r)l.onnx.AttributeProto.encode(e.attribute[r],t.uint32(42).fork()).ldelim();return null!=e.docString&&e.hasOwnProperty("docString")&&t.uint32(50).string(e.docString),null!=e.domain&&e.hasOwnProperty("domain")&&t.uint32(58).string(e.domain),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.NodeProto;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.input&&n.input.length||(n.input=[]),n.input.push(e.string());break;case 2:n.output&&n.output.length||(n.output=[]),n.output.push(e.string());break;case 3:n.name=e.string();break;case 4:n.opType=e.string();break;case 7:n.domain=e.string();break;case 5:n.attribute&&n.attribute.length||(n.attribute=[]),n.attribute.push(l.onnx.AttributeProto.decode(e,e.uint32()));break;case 6:n.docString=e.string();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.input&&e.hasOwnProperty("input")){if(!Array.isArray(e.input))return"input: array expected";for(var t=0;t<e.input.length;++t)if(!u.isString(e.input[t]))return"input: string[] expected"}if(null!=e.output&&e.hasOwnProperty("output")){if(!Array.isArray(e.output))return"output: array expected";for(t=0;t<e.output.length;++t)if(!u.isString(e.output[t]))return"output: string[] expected"}if(null!=e.name&&e.hasOwnProperty("name")&&!u.isString(e.name))return"name: string expected";if(null!=e.opType&&e.hasOwnProperty("opType")&&!u.isString(e.opType))return"opType: string expected";if(null!=e.domain&&e.hasOwnProperty("domain")&&!u.isString(e.domain))return"domain: string expected";if(null!=e.attribute&&e.hasOwnProperty("attribute")){if(!Array.isArray(e.attribute))return"attribute: array expected";for(t=0;t<e.attribute.length;++t){var r=l.onnx.AttributeProto.verify(e.attribute[t]);if(r)return"attribute."+r}}return null!=e.docString&&e.hasOwnProperty("docString")&&!u.isString(e.docString)?"docString: string expected":null},e.fromObject=function(e){if(e instanceof l.onnx.NodeProto)return e;var t=new l.onnx.NodeProto;if(e.input){if(!Array.isArray(e.input))throw TypeError(".onnx.NodeProto.input: array expected");t.input=[];for(var r=0;r<e.input.length;++r)t.input[r]=String(e.input[r])}if(e.output){if(!Array.isArray(e.output))throw TypeError(".onnx.NodeProto.output: array expected");for(t.output=[],r=0;r<e.output.length;++r)t.output[r]=String(e.output[r])}if(null!=e.name&&(t.name=String(e.name)),null!=e.opType&&(t.opType=String(e.opType)),null!=e.domain&&(t.domain=String(e.domain)),e.attribute){if(!Array.isArray(e.attribute))throw TypeError(".onnx.NodeProto.attribute: array expected");for(t.attribute=[],r=0;r<e.attribute.length;++r){if("object"!=typeof e.attribute[r])throw TypeError(".onnx.NodeProto.attribute: object expected");t.attribute[r]=l.onnx.AttributeProto.fromObject(e.attribute[r])}}return null!=e.docString&&(t.docString=String(e.docString)),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.input=[],r.output=[],r.attribute=[]),t.defaults&&(r.name="",r.opType="",r.docString="",r.domain=""),e.input&&e.input.length){r.input=[];for(var n=0;n<e.input.length;++n)r.input[n]=e.input[n]}if(e.output&&e.output.length)for(r.output=[],n=0;n<e.output.length;++n)r.output[n]=e.output[n];if(null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.opType&&e.hasOwnProperty("opType")&&(r.opType=e.opType),e.attribute&&e.attribute.length)for(r.attribute=[],n=0;n<e.attribute.length;++n)r.attribute[n]=l.onnx.AttributeProto.toObject(e.attribute[n],t);return null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),null!=e.domain&&e.hasOwnProperty("domain")&&(r.domain=e.domain),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),o.ModelProto=function(){function e(e){if(this.opsetImport=[],this.metadataProps=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.irVersion=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.opsetImport=u.emptyArray,e.prototype.producerName="",e.prototype.producerVersion="",e.prototype.domain="",e.prototype.modelVersion=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.docString="",e.prototype.graph=null,e.prototype.metadataProps=u.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=c.create()),null!=e.irVersion&&e.hasOwnProperty("irVersion")&&t.uint32(8).int64(e.irVersion),null!=e.producerName&&e.hasOwnProperty("producerName")&&t.uint32(18).string(e.producerName),null!=e.producerVersion&&e.hasOwnProperty("producerVersion")&&t.uint32(26).string(e.producerVersion),null!=e.domain&&e.hasOwnProperty("domain")&&t.uint32(34).string(e.domain),null!=e.modelVersion&&e.hasOwnProperty("modelVersion")&&t.uint32(40).int64(e.modelVersion),null!=e.docString&&e.hasOwnProperty("docString")&&t.uint32(50).string(e.docString),null!=e.graph&&e.hasOwnProperty("graph")&&l.onnx.GraphProto.encode(e.graph,t.uint32(58).fork()).ldelim(),null!=e.opsetImport&&e.opsetImport.length)for(var r=0;r<e.opsetImport.length;++r)l.onnx.OperatorSetIdProto.encode(e.opsetImport[r],t.uint32(66).fork()).ldelim();if(null!=e.metadataProps&&e.metadataProps.length)for(r=0;r<e.metadataProps.length;++r)l.onnx.StringStringEntryProto.encode(e.metadataProps[r],t.uint32(114).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.ModelProto;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.irVersion=e.int64();break;case 8:n.opsetImport&&n.opsetImport.length||(n.opsetImport=[]),n.opsetImport.push(l.onnx.OperatorSetIdProto.decode(e,e.uint32()));break;case 2:n.producerName=e.string();break;case 3:n.producerVersion=e.string();break;case 4:n.domain=e.string();break;case 5:n.modelVersion=e.int64();break;case 6:n.docString=e.string();break;case 7:n.graph=l.onnx.GraphProto.decode(e,e.uint32());break;case 14:n.metadataProps&&n.metadataProps.length||(n.metadataProps=[]),n.metadataProps.push(l.onnx.StringStringEntryProto.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.irVersion&&e.hasOwnProperty("irVersion")&&!(u.isInteger(e.irVersion)||e.irVersion&&u.isInteger(e.irVersion.low)&&u.isInteger(e.irVersion.high)))return"irVersion: integer|Long expected";if(null!=e.opsetImport&&e.hasOwnProperty("opsetImport")){if(!Array.isArray(e.opsetImport))return"opsetImport: array expected";for(var t=0;t<e.opsetImport.length;++t)if(r=l.onnx.OperatorSetIdProto.verify(e.opsetImport[t]))return"opsetImport."+r}if(null!=e.producerName&&e.hasOwnProperty("producerName")&&!u.isString(e.producerName))return"producerName: string expected";if(null!=e.producerVersion&&e.hasOwnProperty("producerVersion")&&!u.isString(e.producerVersion))return"producerVersion: string expected";if(null!=e.domain&&e.hasOwnProperty("domain")&&!u.isString(e.domain))return"domain: string expected";if(null!=e.modelVersion&&e.hasOwnProperty("modelVersion")&&!(u.isInteger(e.modelVersion)||e.modelVersion&&u.isInteger(e.modelVersion.low)&&u.isInteger(e.modelVersion.high)))return"modelVersion: integer|Long expected";if(null!=e.docString&&e.hasOwnProperty("docString")&&!u.isString(e.docString))return"docString: string expected";if(null!=e.graph&&e.hasOwnProperty("graph")&&(r=l.onnx.GraphProto.verify(e.graph)))return"graph."+r;if(null!=e.metadataProps&&e.hasOwnProperty("metadataProps")){if(!Array.isArray(e.metadataProps))return"metadataProps: array expected";for(t=0;t<e.metadataProps.length;++t){var r;if(r=l.onnx.StringStringEntryProto.verify(e.metadataProps[t]))return"metadataProps."+r}}return null},e.fromObject=function(e){if(e instanceof l.onnx.ModelProto)return e;var t=new l.onnx.ModelProto;if(null!=e.irVersion&&(u.Long?(t.irVersion=u.Long.fromValue(e.irVersion)).unsigned=!1:"string"==typeof e.irVersion?t.irVersion=parseInt(e.irVersion,10):"number"==typeof e.irVersion?t.irVersion=e.irVersion:"object"==typeof e.irVersion&&(t.irVersion=new u.LongBits(e.irVersion.low>>>0,e.irVersion.high>>>0).toNumber())),e.opsetImport){if(!Array.isArray(e.opsetImport))throw TypeError(".onnx.ModelProto.opsetImport: array expected");t.opsetImport=[];for(var r=0;r<e.opsetImport.length;++r){if("object"!=typeof e.opsetImport[r])throw TypeError(".onnx.ModelProto.opsetImport: object expected");t.opsetImport[r]=l.onnx.OperatorSetIdProto.fromObject(e.opsetImport[r])}}if(null!=e.producerName&&(t.producerName=String(e.producerName)),null!=e.producerVersion&&(t.producerVersion=String(e.producerVersion)),null!=e.domain&&(t.domain=String(e.domain)),null!=e.modelVersion&&(u.Long?(t.modelVersion=u.Long.fromValue(e.modelVersion)).unsigned=!1:"string"==typeof e.modelVersion?t.modelVersion=parseInt(e.modelVersion,10):"number"==typeof e.modelVersion?t.modelVersion=e.modelVersion:"object"==typeof e.modelVersion&&(t.modelVersion=new u.LongBits(e.modelVersion.low>>>0,e.modelVersion.high>>>0).toNumber())),null!=e.docString&&(t.docString=String(e.docString)),null!=e.graph){if("object"!=typeof e.graph)throw TypeError(".onnx.ModelProto.graph: object expected");t.graph=l.onnx.GraphProto.fromObject(e.graph)}if(e.metadataProps){if(!Array.isArray(e.metadataProps))throw TypeError(".onnx.ModelProto.metadataProps: array expected");for(t.metadataProps=[],r=0;r<e.metadataProps.length;++r){if("object"!=typeof e.metadataProps[r])throw TypeError(".onnx.ModelProto.metadataProps: object expected");t.metadataProps[r]=l.onnx.StringStringEntryProto.fromObject(e.metadataProps[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.opsetImport=[],r.metadataProps=[]),t.defaults){if(u.Long){var n=new u.Long(0,0,!1);r.irVersion=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.irVersion=t.longs===String?"0":0;r.producerName="",r.producerVersion="",r.domain="",u.Long?(n=new u.Long(0,0,!1),r.modelVersion=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.modelVersion=t.longs===String?"0":0,r.docString="",r.graph=null}if(null!=e.irVersion&&e.hasOwnProperty("irVersion")&&("number"==typeof e.irVersion?r.irVersion=t.longs===String?String(e.irVersion):e.irVersion:r.irVersion=t.longs===String?u.Long.prototype.toString.call(e.irVersion):t.longs===Number?new u.LongBits(e.irVersion.low>>>0,e.irVersion.high>>>0).toNumber():e.irVersion),null!=e.producerName&&e.hasOwnProperty("producerName")&&(r.producerName=e.producerName),null!=e.producerVersion&&e.hasOwnProperty("producerVersion")&&(r.producerVersion=e.producerVersion),null!=e.domain&&e.hasOwnProperty("domain")&&(r.domain=e.domain),null!=e.modelVersion&&e.hasOwnProperty("modelVersion")&&("number"==typeof e.modelVersion?r.modelVersion=t.longs===String?String(e.modelVersion):e.modelVersion:r.modelVersion=t.longs===String?u.Long.prototype.toString.call(e.modelVersion):t.longs===Number?new u.LongBits(e.modelVersion.low>>>0,e.modelVersion.high>>>0).toNumber():e.modelVersion),null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),null!=e.graph&&e.hasOwnProperty("graph")&&(r.graph=l.onnx.GraphProto.toObject(e.graph,t)),e.opsetImport&&e.opsetImport.length){r.opsetImport=[];for(var i=0;i<e.opsetImport.length;++i)r.opsetImport[i]=l.onnx.OperatorSetIdProto.toObject(e.opsetImport[i],t)}if(e.metadataProps&&e.metadataProps.length)for(r.metadataProps=[],i=0;i<e.metadataProps.length;++i)r.metadataProps[i]=l.onnx.StringStringEntryProto.toObject(e.metadataProps[i],t);return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),o.StringStringEntryProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.key="",e.prototype.value="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=c.create()),null!=e.key&&e.hasOwnProperty("key")&&t.uint32(10).string(e.key),null!=e.value&&e.hasOwnProperty("value")&&t.uint32(18).string(e.value),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.StringStringEntryProto;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.key=e.string();break;case 2:n.value=e.string();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!u.isString(e.key)?"key: string expected":null!=e.value&&e.hasOwnProperty("value")&&!u.isString(e.value)?"value: string expected":null},e.fromObject=function(e){if(e instanceof l.onnx.StringStringEntryProto)return e;var t=new l.onnx.StringStringEntryProto;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=String(e.value)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.key="",r.value=""),null!=e.key&&e.hasOwnProperty("key")&&(r.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(r.value=e.value),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),o.TensorAnnotation=function(){function e(e){if(this.quantParameterTensorNames=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.tensorName="",e.prototype.quantParameterTensorNames=u.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=c.create()),null!=e.tensorName&&e.hasOwnProperty("tensorName")&&t.uint32(10).string(e.tensorName),null!=e.quantParameterTensorNames&&e.quantParameterTensorNames.length)for(var r=0;r<e.quantParameterTensorNames.length;++r)l.onnx.StringStringEntryProto.encode(e.quantParameterTensorNames[r],t.uint32(18).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.TensorAnnotation;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.tensorName=e.string();break;case 2:n.quantParameterTensorNames&&n.quantParameterTensorNames.length||(n.quantParameterTensorNames=[]),n.quantParameterTensorNames.push(l.onnx.StringStringEntryProto.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.tensorName&&e.hasOwnProperty("tensorName")&&!u.isString(e.tensorName))return"tensorName: string expected";if(null!=e.quantParameterTensorNames&&e.hasOwnProperty("quantParameterTensorNames")){if(!Array.isArray(e.quantParameterTensorNames))return"quantParameterTensorNames: array expected";for(var t=0;t<e.quantParameterTensorNames.length;++t){var r=l.onnx.StringStringEntryProto.verify(e.quantParameterTensorNames[t]);if(r)return"quantParameterTensorNames."+r}}return null},e.fromObject=function(e){if(e instanceof l.onnx.TensorAnnotation)return e;var t=new l.onnx.TensorAnnotation;if(null!=e.tensorName&&(t.tensorName=String(e.tensorName)),e.quantParameterTensorNames){if(!Array.isArray(e.quantParameterTensorNames))throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: array expected");t.quantParameterTensorNames=[];for(var r=0;r<e.quantParameterTensorNames.length;++r){if("object"!=typeof e.quantParameterTensorNames[r])throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: object expected");t.quantParameterTensorNames[r]=l.onnx.StringStringEntryProto.fromObject(e.quantParameterTensorNames[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.quantParameterTensorNames=[]),t.defaults&&(r.tensorName=""),null!=e.tensorName&&e.hasOwnProperty("tensorName")&&(r.tensorName=e.tensorName),e.quantParameterTensorNames&&e.quantParameterTensorNames.length){r.quantParameterTensorNames=[];for(var n=0;n<e.quantParameterTensorNames.length;++n)r.quantParameterTensorNames[n]=l.onnx.StringStringEntryProto.toObject(e.quantParameterTensorNames[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),o.GraphProto=function(){function e(e){if(this.node=[],this.initializer=[],this.input=[],this.output=[],this.valueInfo=[],this.quantizationAnnotation=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.node=u.emptyArray,e.prototype.name="",e.prototype.initializer=u.emptyArray,e.prototype.docString="",e.prototype.input=u.emptyArray,e.prototype.output=u.emptyArray,e.prototype.valueInfo=u.emptyArray,e.prototype.quantizationAnnotation=u.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=c.create()),null!=e.node&&e.node.length)for(var r=0;r<e.node.length;++r)l.onnx.NodeProto.encode(e.node[r],t.uint32(10).fork()).ldelim();if(null!=e.name&&e.hasOwnProperty("name")&&t.uint32(18).string(e.name),null!=e.initializer&&e.initializer.length)for(r=0;r<e.initializer.length;++r)l.onnx.TensorProto.encode(e.initializer[r],t.uint32(42).fork()).ldelim();if(null!=e.docString&&e.hasOwnProperty("docString")&&t.uint32(82).string(e.docString),null!=e.input&&e.input.length)for(r=0;r<e.input.length;++r)l.onnx.ValueInfoProto.encode(e.input[r],t.uint32(90).fork()).ldelim();if(null!=e.output&&e.output.length)for(r=0;r<e.output.length;++r)l.onnx.ValueInfoProto.encode(e.output[r],t.uint32(98).fork()).ldelim();if(null!=e.valueInfo&&e.valueInfo.length)for(r=0;r<e.valueInfo.length;++r)l.onnx.ValueInfoProto.encode(e.valueInfo[r],t.uint32(106).fork()).ldelim();if(null!=e.quantizationAnnotation&&e.quantizationAnnotation.length)for(r=0;r<e.quantizationAnnotation.length;++r)l.onnx.TensorAnnotation.encode(e.quantizationAnnotation[r],t.uint32(114).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.GraphProto;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.node&&n.node.length||(n.node=[]),n.node.push(l.onnx.NodeProto.decode(e,e.uint32()));break;case 2:n.name=e.string();break;case 5:n.initializer&&n.initializer.length||(n.initializer=[]),n.initializer.push(l.onnx.TensorProto.decode(e,e.uint32()));break;case 10:n.docString=e.string();break;case 11:n.input&&n.input.length||(n.input=[]),n.input.push(l.onnx.ValueInfoProto.decode(e,e.uint32()));break;case 12:n.output&&n.output.length||(n.output=[]),n.output.push(l.onnx.ValueInfoProto.decode(e,e.uint32()));break;case 13:n.valueInfo&&n.valueInfo.length||(n.valueInfo=[]),n.valueInfo.push(l.onnx.ValueInfoProto.decode(e,e.uint32()));break;case 14:n.quantizationAnnotation&&n.quantizationAnnotation.length||(n.quantizationAnnotation=[]),n.quantizationAnnotation.push(l.onnx.TensorAnnotation.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.node&&e.hasOwnProperty("node")){if(!Array.isArray(e.node))return"node: array expected";for(var t=0;t<e.node.length;++t)if(r=l.onnx.NodeProto.verify(e.node[t]))return"node."+r}if(null!=e.name&&e.hasOwnProperty("name")&&!u.isString(e.name))return"name: string expected";if(null!=e.initializer&&e.hasOwnProperty("initializer")){if(!Array.isArray(e.initializer))return"initializer: array expected";for(t=0;t<e.initializer.length;++t)if(r=l.onnx.TensorProto.verify(e.initializer[t]))return"initializer."+r}if(null!=e.docString&&e.hasOwnProperty("docString")&&!u.isString(e.docString))return"docString: string expected";if(null!=e.input&&e.hasOwnProperty("input")){if(!Array.isArray(e.input))return"input: array expected";for(t=0;t<e.input.length;++t)if(r=l.onnx.ValueInfoProto.verify(e.input[t]))return"input."+r}if(null!=e.output&&e.hasOwnProperty("output")){if(!Array.isArray(e.output))return"output: array expected";for(t=0;t<e.output.length;++t)if(r=l.onnx.ValueInfoProto.verify(e.output[t]))return"output."+r}if(null!=e.valueInfo&&e.hasOwnProperty("valueInfo")){if(!Array.isArray(e.valueInfo))return"valueInfo: array expected";for(t=0;t<e.valueInfo.length;++t)if(r=l.onnx.ValueInfoProto.verify(e.valueInfo[t]))return"valueInfo."+r}if(null!=e.quantizationAnnotation&&e.hasOwnProperty("quantizationAnnotation")){if(!Array.isArray(e.quantizationAnnotation))return"quantizationAnnotation: array expected";for(t=0;t<e.quantizationAnnotation.length;++t){var r;if(r=l.onnx.TensorAnnotation.verify(e.quantizationAnnotation[t]))return"quantizationAnnotation."+r}}return null},e.fromObject=function(e){if(e instanceof l.onnx.GraphProto)return e;var t=new l.onnx.GraphProto;if(e.node){if(!Array.isArray(e.node))throw TypeError(".onnx.GraphProto.node: array expected");t.node=[];for(var r=0;r<e.node.length;++r){if("object"!=typeof e.node[r])throw TypeError(".onnx.GraphProto.node: object expected");t.node[r]=l.onnx.NodeProto.fromObject(e.node[r])}}if(null!=e.name&&(t.name=String(e.name)),e.initializer){if(!Array.isArray(e.initializer))throw TypeError(".onnx.GraphProto.initializer: array expected");for(t.initializer=[],r=0;r<e.initializer.length;++r){if("object"!=typeof e.initializer[r])throw TypeError(".onnx.GraphProto.initializer: object expected");t.initializer[r]=l.onnx.TensorProto.fromObject(e.initializer[r])}}if(null!=e.docString&&(t.docString=String(e.docString)),e.input){if(!Array.isArray(e.input))throw TypeError(".onnx.GraphProto.input: array expected");for(t.input=[],r=0;r<e.input.length;++r){if("object"!=typeof e.input[r])throw TypeError(".onnx.GraphProto.input: object expected");t.input[r]=l.onnx.ValueInfoProto.fromObject(e.input[r])}}if(e.output){if(!Array.isArray(e.output))throw TypeError(".onnx.GraphProto.output: array expected");for(t.output=[],r=0;r<e.output.length;++r){if("object"!=typeof e.output[r])throw TypeError(".onnx.GraphProto.output: object expected");t.output[r]=l.onnx.ValueInfoProto.fromObject(e.output[r])}}if(e.valueInfo){if(!Array.isArray(e.valueInfo))throw TypeError(".onnx.GraphProto.valueInfo: array expected");for(t.valueInfo=[],r=0;r<e.valueInfo.length;++r){if("object"!=typeof e.valueInfo[r])throw TypeError(".onnx.GraphProto.valueInfo: object expected");t.valueInfo[r]=l.onnx.ValueInfoProto.fromObject(e.valueInfo[r])}}if(e.quantizationAnnotation){if(!Array.isArray(e.quantizationAnnotation))throw TypeError(".onnx.GraphProto.quantizationAnnotation: array expected");for(t.quantizationAnnotation=[],r=0;r<e.quantizationAnnotation.length;++r){if("object"!=typeof e.quantizationAnnotation[r])throw TypeError(".onnx.GraphProto.quantizationAnnotation: object expected");t.quantizationAnnotation[r]=l.onnx.TensorAnnotation.fromObject(e.quantizationAnnotation[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.node=[],r.initializer=[],r.input=[],r.output=[],r.valueInfo=[],r.quantizationAnnotation=[]),t.defaults&&(r.name="",r.docString=""),e.node&&e.node.length){r.node=[];for(var n=0;n<e.node.length;++n)r.node[n]=l.onnx.NodeProto.toObject(e.node[n],t)}if(null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),e.initializer&&e.initializer.length)for(r.initializer=[],n=0;n<e.initializer.length;++n)r.initializer[n]=l.onnx.TensorProto.toObject(e.initializer[n],t);if(null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),e.input&&e.input.length)for(r.input=[],n=0;n<e.input.length;++n)r.input[n]=l.onnx.ValueInfoProto.toObject(e.input[n],t);if(e.output&&e.output.length)for(r.output=[],n=0;n<e.output.length;++n)r.output[n]=l.onnx.ValueInfoProto.toObject(e.output[n],t);if(e.valueInfo&&e.valueInfo.length)for(r.valueInfo=[],n=0;n<e.valueInfo.length;++n)r.valueInfo[n]=l.onnx.ValueInfoProto.toObject(e.valueInfo[n],t);if(e.quantizationAnnotation&&e.quantizationAnnotation.length)for(r.quantizationAnnotation=[],n=0;n<e.quantizationAnnotation.length;++n)r.quantizationAnnotation[n]=l.onnx.TensorAnnotation.toObject(e.quantizationAnnotation[n],t);return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),o.TensorProto=function(){function e(e){if(this.dims=[],this.floatData=[],this.int32Data=[],this.stringData=[],this.int64Data=[],this.externalData=[],this.doubleData=[],this.uint64Data=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.dims=u.emptyArray,e.prototype.dataType=0,e.prototype.segment=null,e.prototype.floatData=u.emptyArray,e.prototype.int32Data=u.emptyArray,e.prototype.stringData=u.emptyArray,e.prototype.int64Data=u.emptyArray,e.prototype.name="",e.prototype.docString="",e.prototype.rawData=u.newBuffer([]),e.prototype.externalData=u.emptyArray,e.prototype.dataLocation=0,e.prototype.doubleData=u.emptyArray,e.prototype.uint64Data=u.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=c.create()),null!=e.dims&&e.dims.length){t.uint32(10).fork();for(var r=0;r<e.dims.length;++r)t.int64(e.dims[r]);t.ldelim()}if(null!=e.dataType&&e.hasOwnProperty("dataType")&&t.uint32(16).int32(e.dataType),null!=e.segment&&e.hasOwnProperty("segment")&&l.onnx.TensorProto.Segment.encode(e.segment,t.uint32(26).fork()).ldelim(),null!=e.floatData&&e.floatData.length){for(t.uint32(34).fork(),r=0;r<e.floatData.length;++r)t.float(e.floatData[r]);t.ldelim()}if(null!=e.int32Data&&e.int32Data.length){for(t.uint32(42).fork(),r=0;r<e.int32Data.length;++r)t.int32(e.int32Data[r]);t.ldelim()}if(null!=e.stringData&&e.stringData.length)for(r=0;r<e.stringData.length;++r)t.uint32(50).bytes(e.stringData[r]);if(null!=e.int64Data&&e.int64Data.length){for(t.uint32(58).fork(),r=0;r<e.int64Data.length;++r)t.int64(e.int64Data[r]);t.ldelim()}if(null!=e.name&&e.hasOwnProperty("name")&&t.uint32(66).string(e.name),null!=e.rawData&&e.hasOwnProperty("rawData")&&t.uint32(74).bytes(e.rawData),null!=e.doubleData&&e.doubleData.length){for(t.uint32(82).fork(),r=0;r<e.doubleData.length;++r)t.double(e.doubleData[r]);t.ldelim()}if(null!=e.uint64Data&&e.uint64Data.length){for(t.uint32(90).fork(),r=0;r<e.uint64Data.length;++r)t.uint64(e.uint64Data[r]);t.ldelim()}if(null!=e.docString&&e.hasOwnProperty("docString")&&t.uint32(98).string(e.docString),null!=e.externalData&&e.externalData.length)for(r=0;r<e.externalData.length;++r)l.onnx.StringStringEntryProto.encode(e.externalData[r],t.uint32(106).fork()).ldelim();return null!=e.dataLocation&&e.hasOwnProperty("dataLocation")&&t.uint32(112).int32(e.dataLocation),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.TensorProto;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:if(n.dims&&n.dims.length||(n.dims=[]),2==(7&i))for(var o=e.uint32()+e.pos;e.pos<o;)n.dims.push(e.int64());else n.dims.push(e.int64());break;case 2:n.dataType=e.int32();break;case 3:n.segment=l.onnx.TensorProto.Segment.decode(e,e.uint32());break;case 4:if(n.floatData&&n.floatData.length||(n.floatData=[]),2==(7&i))for(o=e.uint32()+e.pos;e.pos<o;)n.floatData.push(e.float());else n.floatData.push(e.float());break;case 5:if(n.int32Data&&n.int32Data.length||(n.int32Data=[]),2==(7&i))for(o=e.uint32()+e.pos;e.pos<o;)n.int32Data.push(e.int32());else n.int32Data.push(e.int32());break;case 6:n.stringData&&n.stringData.length||(n.stringData=[]),n.stringData.push(e.bytes());break;case 7:if(n.int64Data&&n.int64Data.length||(n.int64Data=[]),2==(7&i))for(o=e.uint32()+e.pos;e.pos<o;)n.int64Data.push(e.int64());else n.int64Data.push(e.int64());break;case 8:n.name=e.string();break;case 12:n.docString=e.string();break;case 9:n.rawData=e.bytes();break;case 13:n.externalData&&n.externalData.length||(n.externalData=[]),n.externalData.push(l.onnx.StringStringEntryProto.decode(e,e.uint32()));break;case 14:n.dataLocation=e.int32();break;case 10:if(n.doubleData&&n.doubleData.length||(n.doubleData=[]),2==(7&i))for(o=e.uint32()+e.pos;e.pos<o;)n.doubleData.push(e.double());else n.doubleData.push(e.double());break;case 11:if(n.uint64Data&&n.uint64Data.length||(n.uint64Data=[]),2==(7&i))for(o=e.uint32()+e.pos;e.pos<o;)n.uint64Data.push(e.uint64());else n.uint64Data.push(e.uint64());break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.dims&&e.hasOwnProperty("dims")){if(!Array.isArray(e.dims))return"dims: array expected";for(var t=0;t<e.dims.length;++t)if(!(u.isInteger(e.dims[t])||e.dims[t]&&u.isInteger(e.dims[t].low)&&u.isInteger(e.dims[t].high)))return"dims: integer|Long[] expected"}if(null!=e.dataType&&e.hasOwnProperty("dataType")&&!u.isInteger(e.dataType))return"dataType: integer expected";if(null!=e.segment&&e.hasOwnProperty("segment")&&(r=l.onnx.TensorProto.Segment.verify(e.segment)))return"segment."+r;if(null!=e.floatData&&e.hasOwnProperty("floatData")){if(!Array.isArray(e.floatData))return"floatData: array expected";for(t=0;t<e.floatData.length;++t)if("number"!=typeof e.floatData[t])return"floatData: number[] expected"}if(null!=e.int32Data&&e.hasOwnProperty("int32Data")){if(!Array.isArray(e.int32Data))return"int32Data: array expected";for(t=0;t<e.int32Data.length;++t)if(!u.isInteger(e.int32Data[t]))return"int32Data: integer[] expected"}if(null!=e.stringData&&e.hasOwnProperty("stringData")){if(!Array.isArray(e.stringData))return"stringData: array expected";for(t=0;t<e.stringData.length;++t)if(!(e.stringData[t]&&"number"==typeof e.stringData[t].length||u.isString(e.stringData[t])))return"stringData: buffer[] expected"}if(null!=e.int64Data&&e.hasOwnProperty("int64Data")){if(!Array.isArray(e.int64Data))return"int64Data: array expected";for(t=0;t<e.int64Data.length;++t)if(!(u.isInteger(e.int64Data[t])||e.int64Data[t]&&u.isInteger(e.int64Data[t].low)&&u.isInteger(e.int64Data[t].high)))return"int64Data: integer|Long[] expected"}if(null!=e.name&&e.hasOwnProperty("name")&&!u.isString(e.name))return"name: string expected";if(null!=e.docString&&e.hasOwnProperty("docString")&&!u.isString(e.docString))return"docString: string expected";if(null!=e.rawData&&e.hasOwnProperty("rawData")&&!(e.rawData&&"number"==typeof e.rawData.length||u.isString(e.rawData)))return"rawData: buffer expected";if(null!=e.externalData&&e.hasOwnProperty("externalData")){if(!Array.isArray(e.externalData))return"externalData: array expected";for(t=0;t<e.externalData.length;++t){var r;if(r=l.onnx.StringStringEntryProto.verify(e.externalData[t]))return"externalData."+r}}if(null!=e.dataLocation&&e.hasOwnProperty("dataLocation"))switch(e.dataLocation){default:return"dataLocation: enum value expected";case 0:case 1:}if(null!=e.doubleData&&e.hasOwnProperty("doubleData")){if(!Array.isArray(e.doubleData))return"doubleData: array expected";for(t=0;t<e.doubleData.length;++t)if("number"!=typeof e.doubleData[t])return"doubleData: number[] expected"}if(null!=e.uint64Data&&e.hasOwnProperty("uint64Data")){if(!Array.isArray(e.uint64Data))return"uint64Data: array expected";for(t=0;t<e.uint64Data.length;++t)if(!(u.isInteger(e.uint64Data[t])||e.uint64Data[t]&&u.isInteger(e.uint64Data[t].low)&&u.isInteger(e.uint64Data[t].high)))return"uint64Data: integer|Long[] expected"}return null},e.fromObject=function(e){if(e instanceof l.onnx.TensorProto)return e;var t=new l.onnx.TensorProto;if(e.dims){if(!Array.isArray(e.dims))throw TypeError(".onnx.TensorProto.dims: array expected");t.dims=[];for(var r=0;r<e.dims.length;++r)u.Long?(t.dims[r]=u.Long.fromValue(e.dims[r])).unsigned=!1:"string"==typeof e.dims[r]?t.dims[r]=parseInt(e.dims[r],10):"number"==typeof e.dims[r]?t.dims[r]=e.dims[r]:"object"==typeof e.dims[r]&&(t.dims[r]=new u.LongBits(e.dims[r].low>>>0,e.dims[r].high>>>0).toNumber())}if(null!=e.dataType&&(t.dataType=0|e.dataType),null!=e.segment){if("object"!=typeof e.segment)throw TypeError(".onnx.TensorProto.segment: object expected");t.segment=l.onnx.TensorProto.Segment.fromObject(e.segment)}if(e.floatData){if(!Array.isArray(e.floatData))throw TypeError(".onnx.TensorProto.floatData: array expected");for(t.floatData=[],r=0;r<e.floatData.length;++r)t.floatData[r]=Number(e.floatData[r])}if(e.int32Data){if(!Array.isArray(e.int32Data))throw TypeError(".onnx.TensorProto.int32Data: array expected");for(t.int32Data=[],r=0;r<e.int32Data.length;++r)t.int32Data[r]=0|e.int32Data[r]}if(e.stringData){if(!Array.isArray(e.stringData))throw TypeError(".onnx.TensorProto.stringData: array expected");for(t.stringData=[],r=0;r<e.stringData.length;++r)"string"==typeof e.stringData[r]?u.base64.decode(e.stringData[r],t.stringData[r]=u.newBuffer(u.base64.length(e.stringData[r])),0):e.stringData[r].length&&(t.stringData[r]=e.stringData[r])}if(e.int64Data){if(!Array.isArray(e.int64Data))throw TypeError(".onnx.TensorProto.int64Data: array expected");for(t.int64Data=[],r=0;r<e.int64Data.length;++r)u.Long?(t.int64Data[r]=u.Long.fromValue(e.int64Data[r])).unsigned=!1:"string"==typeof e.int64Data[r]?t.int64Data[r]=parseInt(e.int64Data[r],10):"number"==typeof e.int64Data[r]?t.int64Data[r]=e.int64Data[r]:"object"==typeof e.int64Data[r]&&(t.int64Data[r]=new u.LongBits(e.int64Data[r].low>>>0,e.int64Data[r].high>>>0).toNumber())}if(null!=e.name&&(t.name=String(e.name)),null!=e.docString&&(t.docString=String(e.docString)),null!=e.rawData&&("string"==typeof e.rawData?u.base64.decode(e.rawData,t.rawData=u.newBuffer(u.base64.length(e.rawData)),0):e.rawData.length&&(t.rawData=e.rawData)),e.externalData){if(!Array.isArray(e.externalData))throw TypeError(".onnx.TensorProto.externalData: array expected");for(t.externalData=[],r=0;r<e.externalData.length;++r){if("object"!=typeof e.externalData[r])throw TypeError(".onnx.TensorProto.externalData: object expected");t.externalData[r]=l.onnx.StringStringEntryProto.fromObject(e.externalData[r])}}switch(e.dataLocation){case"DEFAULT":case 0:t.dataLocation=0;break;case"EXTERNAL":case 1:t.dataLocation=1}if(e.doubleData){if(!Array.isArray(e.doubleData))throw TypeError(".onnx.TensorProto.doubleData: array expected");for(t.doubleData=[],r=0;r<e.doubleData.length;++r)t.doubleData[r]=Number(e.doubleData[r])}if(e.uint64Data){if(!Array.isArray(e.uint64Data))throw TypeError(".onnx.TensorProto.uint64Data: array expected");for(t.uint64Data=[],r=0;r<e.uint64Data.length;++r)u.Long?(t.uint64Data[r]=u.Long.fromValue(e.uint64Data[r])).unsigned=!0:"string"==typeof e.uint64Data[r]?t.uint64Data[r]=parseInt(e.uint64Data[r],10):"number"==typeof e.uint64Data[r]?t.uint64Data[r]=e.uint64Data[r]:"object"==typeof e.uint64Data[r]&&(t.uint64Data[r]=new u.LongBits(e.uint64Data[r].low>>>0,e.uint64Data[r].high>>>0).toNumber(!0))}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.dims=[],r.floatData=[],r.int32Data=[],r.stringData=[],r.int64Data=[],r.doubleData=[],r.uint64Data=[],r.externalData=[]),t.defaults&&(r.dataType=0,r.segment=null,r.name="",t.bytes===String?r.rawData="":(r.rawData=[],t.bytes!==Array&&(r.rawData=u.newBuffer(r.rawData))),r.docString="",r.dataLocation=t.enums===String?"DEFAULT":0),e.dims&&e.dims.length){r.dims=[];for(var n=0;n<e.dims.length;++n)"number"==typeof e.dims[n]?r.dims[n]=t.longs===String?String(e.dims[n]):e.dims[n]:r.dims[n]=t.longs===String?u.Long.prototype.toString.call(e.dims[n]):t.longs===Number?new u.LongBits(e.dims[n].low>>>0,e.dims[n].high>>>0).toNumber():e.dims[n]}if(null!=e.dataType&&e.hasOwnProperty("dataType")&&(r.dataType=e.dataType),null!=e.segment&&e.hasOwnProperty("segment")&&(r.segment=l.onnx.TensorProto.Segment.toObject(e.segment,t)),e.floatData&&e.floatData.length)for(r.floatData=[],n=0;n<e.floatData.length;++n)r.floatData[n]=t.json&&!isFinite(e.floatData[n])?String(e.floatData[n]):e.floatData[n];if(e.int32Data&&e.int32Data.length)for(r.int32Data=[],n=0;n<e.int32Data.length;++n)r.int32Data[n]=e.int32Data[n];if(e.stringData&&e.stringData.length)for(r.stringData=[],n=0;n<e.stringData.length;++n)r.stringData[n]=t.bytes===String?u.base64.encode(e.stringData[n],0,e.stringData[n].length):t.bytes===Array?Array.prototype.slice.call(e.stringData[n]):e.stringData[n];if(e.int64Data&&e.int64Data.length)for(r.int64Data=[],n=0;n<e.int64Data.length;++n)"number"==typeof e.int64Data[n]?r.int64Data[n]=t.longs===String?String(e.int64Data[n]):e.int64Data[n]:r.int64Data[n]=t.longs===String?u.Long.prototype.toString.call(e.int64Data[n]):t.longs===Number?new u.LongBits(e.int64Data[n].low>>>0,e.int64Data[n].high>>>0).toNumber():e.int64Data[n];if(null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.rawData&&e.hasOwnProperty("rawData")&&(r.rawData=t.bytes===String?u.base64.encode(e.rawData,0,e.rawData.length):t.bytes===Array?Array.prototype.slice.call(e.rawData):e.rawData),e.doubleData&&e.doubleData.length)for(r.doubleData=[],n=0;n<e.doubleData.length;++n)r.doubleData[n]=t.json&&!isFinite(e.doubleData[n])?String(e.doubleData[n]):e.doubleData[n];if(e.uint64Data&&e.uint64Data.length)for(r.uint64Data=[],n=0;n<e.uint64Data.length;++n)"number"==typeof e.uint64Data[n]?r.uint64Data[n]=t.longs===String?String(e.uint64Data[n]):e.uint64Data[n]:r.uint64Data[n]=t.longs===String?u.Long.prototype.toString.call(e.uint64Data[n]):t.longs===Number?new u.LongBits(e.uint64Data[n].low>>>0,e.uint64Data[n].high>>>0).toNumber(!0):e.uint64Data[n];if(null!=e.docString&&e.hasOwnProperty("docString")&&(r.docString=e.docString),e.externalData&&e.externalData.length)for(r.externalData=[],n=0;n<e.externalData.length;++n)r.externalData[n]=l.onnx.StringStringEntryProto.toObject(e.externalData[n],t);return null!=e.dataLocation&&e.hasOwnProperty("dataLocation")&&(r.dataLocation=t.enums===String?l.onnx.TensorProto.DataLocation[e.dataLocation]:e.dataLocation),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e.DataType=function(){var e={},t=Object.create(e);return t[e[0]="UNDEFINED"]=0,t[e[1]="FLOAT"]=1,t[e[2]="UINT8"]=2,t[e[3]="INT8"]=3,t[e[4]="UINT16"]=4,t[e[5]="INT16"]=5,t[e[6]="INT32"]=6,t[e[7]="INT64"]=7,t[e[8]="STRING"]=8,t[e[9]="BOOL"]=9,t[e[10]="FLOAT16"]=10,t[e[11]="DOUBLE"]=11,t[e[12]="UINT32"]=12,t[e[13]="UINT64"]=13,t[e[14]="COMPLEX64"]=14,t[e[15]="COMPLEX128"]=15,t[e[16]="BFLOAT16"]=16,t}(),e.Segment=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.begin=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.end=u.Long?u.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=c.create()),null!=e.begin&&e.hasOwnProperty("begin")&&t.uint32(8).int64(e.begin),null!=e.end&&e.hasOwnProperty("end")&&t.uint32(16).int64(e.end),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.TensorProto.Segment;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.begin=e.int64();break;case 2:n.end=e.int64();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.begin&&e.hasOwnProperty("begin")&&!(u.isInteger(e.begin)||e.begin&&u.isInteger(e.begin.low)&&u.isInteger(e.begin.high))?"begin: integer|Long expected":null!=e.end&&e.hasOwnProperty("end")&&!(u.isInteger(e.end)||e.end&&u.isInteger(e.end.low)&&u.isInteger(e.end.high))?"end: integer|Long expected":null},e.fromObject=function(e){if(e instanceof l.onnx.TensorProto.Segment)return e;var t=new l.onnx.TensorProto.Segment;return null!=e.begin&&(u.Long?(t.begin=u.Long.fromValue(e.begin)).unsigned=!1:"string"==typeof e.begin?t.begin=parseInt(e.begin,10):"number"==typeof e.begin?t.begin=e.begin:"object"==typeof e.begin&&(t.begin=new u.LongBits(e.begin.low>>>0,e.begin.high>>>0).toNumber())),null!=e.end&&(u.Long?(t.end=u.Long.fromValue(e.end)).unsigned=!1:"string"==typeof e.end?t.end=parseInt(e.end,10):"number"==typeof e.end?t.end=e.end:"object"==typeof e.end&&(t.end=new u.LongBits(e.end.low>>>0,e.end.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if(u.Long){var n=new u.Long(0,0,!1);r.begin=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.begin=t.longs===String?"0":0;u.Long?(n=new u.Long(0,0,!1),r.end=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.end=t.longs===String?"0":0}return null!=e.begin&&e.hasOwnProperty("begin")&&("number"==typeof e.begin?r.begin=t.longs===String?String(e.begin):e.begin:r.begin=t.longs===String?u.Long.prototype.toString.call(e.begin):t.longs===Number?new u.LongBits(e.begin.low>>>0,e.begin.high>>>0).toNumber():e.begin),null!=e.end&&e.hasOwnProperty("end")&&("number"==typeof e.end?r.end=t.longs===String?String(e.end):e.end:r.end=t.longs===String?u.Long.prototype.toString.call(e.end):t.longs===Number?new u.LongBits(e.end.low>>>0,e.end.high>>>0).toNumber():e.end),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),e.DataLocation=function(){var e={},t=Object.create(e);return t[e[0]="DEFAULT"]=0,t[e[1]="EXTERNAL"]=1,t}(),e}(),o.TensorShapeProto=function(){function e(e){if(this.dim=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.dim=u.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=c.create()),null!=e.dim&&e.dim.length)for(var r=0;r<e.dim.length;++r)l.onnx.TensorShapeProto.Dimension.encode(e.dim[r],t.uint32(10).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.TensorShapeProto;e.pos<r;){var i=e.uint32();i>>>3==1?(n.dim&&n.dim.length||(n.dim=[]),n.dim.push(l.onnx.TensorShapeProto.Dimension.decode(e,e.uint32()))):e.skipType(7&i)}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.dim&&e.hasOwnProperty("dim")){if(!Array.isArray(e.dim))return"dim: array expected";for(var t=0;t<e.dim.length;++t){var r=l.onnx.TensorShapeProto.Dimension.verify(e.dim[t]);if(r)return"dim."+r}}return null},e.fromObject=function(e){if(e instanceof l.onnx.TensorShapeProto)return e;var t=new l.onnx.TensorShapeProto;if(e.dim){if(!Array.isArray(e.dim))throw TypeError(".onnx.TensorShapeProto.dim: array expected");t.dim=[];for(var r=0;r<e.dim.length;++r){if("object"!=typeof e.dim[r])throw TypeError(".onnx.TensorShapeProto.dim: object expected");t.dim[r]=l.onnx.TensorShapeProto.Dimension.fromObject(e.dim[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.dim=[]),e.dim&&e.dim.length){r.dim=[];for(var n=0;n<e.dim.length;++n)r.dim[n]=l.onnx.TensorShapeProto.Dimension.toObject(e.dim[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e.Dimension=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t;return e.prototype.dimValue=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.dimParam="",e.prototype.denotation="",Object.defineProperty(e.prototype,"value",{get:u.oneOfGetter(t=["dimValue","dimParam"]),set:u.oneOfSetter(t)}),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=c.create()),null!=e.dimValue&&e.hasOwnProperty("dimValue")&&t.uint32(8).int64(e.dimValue),null!=e.dimParam&&e.hasOwnProperty("dimParam")&&t.uint32(18).string(e.dimParam),null!=e.denotation&&e.hasOwnProperty("denotation")&&t.uint32(26).string(e.denotation),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.TensorShapeProto.Dimension;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.dimValue=e.int64();break;case 2:n.dimParam=e.string();break;case 3:n.denotation=e.string();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";var t={};if(null!=e.dimValue&&e.hasOwnProperty("dimValue")&&(t.value=1,!(u.isInteger(e.dimValue)||e.dimValue&&u.isInteger(e.dimValue.low)&&u.isInteger(e.dimValue.high))))return"dimValue: integer|Long expected";if(null!=e.dimParam&&e.hasOwnProperty("dimParam")){if(1===t.value)return"value: multiple values";if(t.value=1,!u.isString(e.dimParam))return"dimParam: string expected"}return null!=e.denotation&&e.hasOwnProperty("denotation")&&!u.isString(e.denotation)?"denotation: string expected":null},e.fromObject=function(e){if(e instanceof l.onnx.TensorShapeProto.Dimension)return e;var t=new l.onnx.TensorShapeProto.Dimension;return null!=e.dimValue&&(u.Long?(t.dimValue=u.Long.fromValue(e.dimValue)).unsigned=!1:"string"==typeof e.dimValue?t.dimValue=parseInt(e.dimValue,10):"number"==typeof e.dimValue?t.dimValue=e.dimValue:"object"==typeof e.dimValue&&(t.dimValue=new u.LongBits(e.dimValue.low>>>0,e.dimValue.high>>>0).toNumber())),null!=e.dimParam&&(t.dimParam=String(e.dimParam)),null!=e.denotation&&(t.denotation=String(e.denotation)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.denotation=""),null!=e.dimValue&&e.hasOwnProperty("dimValue")&&("number"==typeof e.dimValue?r.dimValue=t.longs===String?String(e.dimValue):e.dimValue:r.dimValue=t.longs===String?u.Long.prototype.toString.call(e.dimValue):t.longs===Number?new u.LongBits(e.dimValue.low>>>0,e.dimValue.high>>>0).toNumber():e.dimValue,t.oneofs&&(r.value="dimValue")),null!=e.dimParam&&e.hasOwnProperty("dimParam")&&(r.dimParam=e.dimParam,t.oneofs&&(r.value="dimParam")),null!=e.denotation&&e.hasOwnProperty("denotation")&&(r.denotation=e.denotation),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),e}(),o.TypeProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t;return e.prototype.tensorType=null,e.prototype.denotation="",Object.defineProperty(e.prototype,"value",{get:u.oneOfGetter(t=["tensorType"]),set:u.oneOfSetter(t)}),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=c.create()),null!=e.tensorType&&e.hasOwnProperty("tensorType")&&l.onnx.TypeProto.Tensor.encode(e.tensorType,t.uint32(10).fork()).ldelim(),null!=e.denotation&&e.hasOwnProperty("denotation")&&t.uint32(50).string(e.denotation),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.TypeProto;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.tensorType=l.onnx.TypeProto.Tensor.decode(e,e.uint32());break;case 6:n.denotation=e.string();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.tensorType&&e.hasOwnProperty("tensorType")){var t=l.onnx.TypeProto.Tensor.verify(e.tensorType);if(t)return"tensorType."+t}return null!=e.denotation&&e.hasOwnProperty("denotation")&&!u.isString(e.denotation)?"denotation: string expected":null},e.fromObject=function(e){if(e instanceof l.onnx.TypeProto)return e;var t=new l.onnx.TypeProto;if(null!=e.tensorType){if("object"!=typeof e.tensorType)throw TypeError(".onnx.TypeProto.tensorType: object expected");t.tensorType=l.onnx.TypeProto.Tensor.fromObject(e.tensorType)}return null!=e.denotation&&(t.denotation=String(e.denotation)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.denotation=""),null!=e.tensorType&&e.hasOwnProperty("tensorType")&&(r.tensorType=l.onnx.TypeProto.Tensor.toObject(e.tensorType,t),t.oneofs&&(r.value="tensorType")),null!=e.denotation&&e.hasOwnProperty("denotation")&&(r.denotation=e.denotation),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e.Tensor=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.elemType=0,e.prototype.shape=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=c.create()),null!=e.elemType&&e.hasOwnProperty("elemType")&&t.uint32(8).int32(e.elemType),null!=e.shape&&e.hasOwnProperty("shape")&&l.onnx.TensorShapeProto.encode(e.shape,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.TypeProto.Tensor;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.elemType=e.int32();break;case 2:n.shape=l.onnx.TensorShapeProto.decode(e,e.uint32());break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.elemType&&e.hasOwnProperty("elemType")&&!u.isInteger(e.elemType))return"elemType: integer expected";if(null!=e.shape&&e.hasOwnProperty("shape")){var t=l.onnx.TensorShapeProto.verify(e.shape);if(t)return"shape."+t}return null},e.fromObject=function(e){if(e instanceof l.onnx.TypeProto.Tensor)return e;var t=new l.onnx.TypeProto.Tensor;if(null!=e.elemType&&(t.elemType=0|e.elemType),null!=e.shape){if("object"!=typeof e.shape)throw TypeError(".onnx.TypeProto.Tensor.shape: object expected");t.shape=l.onnx.TensorShapeProto.fromObject(e.shape)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.elemType=0,r.shape=null),null!=e.elemType&&e.hasOwnProperty("elemType")&&(r.elemType=e.elemType),null!=e.shape&&e.hasOwnProperty("shape")&&(r.shape=l.onnx.TensorShapeProto.toObject(e.shape,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),e}(),o.OperatorSetIdProto=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.domain="",e.prototype.version=u.Long?u.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=c.create()),null!=e.domain&&e.hasOwnProperty("domain")&&t.uint32(10).string(e.domain),null!=e.version&&e.hasOwnProperty("version")&&t.uint32(16).int64(e.version),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new l.onnx.OperatorSetIdProto;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.domain=e.string();break;case 2:n.version=e.int64();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.domain&&e.hasOwnProperty("domain")&&!u.isString(e.domain)?"domain: string expected":null!=e.version&&e.hasOwnProperty("version")&&!(u.isInteger(e.version)||e.version&&u.isInteger(e.version.low)&&u.isInteger(e.version.high))?"version: integer|Long expected":null},e.fromObject=function(e){if(e instanceof l.onnx.OperatorSetIdProto)return e;var t=new l.onnx.OperatorSetIdProto;return null!=e.domain&&(t.domain=String(e.domain)),null!=e.version&&(u.Long?(t.version=u.Long.fromValue(e.version)).unsigned=!1:"string"==typeof e.version?t.version=parseInt(e.version,10):"number"==typeof e.version?t.version=e.version:"object"==typeof e.version&&(t.version=new u.LongBits(e.version.low>>>0,e.version.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults)if(r.domain="",u.Long){var n=new u.Long(0,0,!1);r.version=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.version=t.longs===String?"0":0;return null!=e.domain&&e.hasOwnProperty("domain")&&(r.domain=e.domain),null!=e.version&&e.hasOwnProperty("version")&&("number"==typeof e.version?r.version=t.longs===String?String(e.version):e.version:r.version=t.longs===String?u.Long.prototype.toString.call(e.version):t.longs===Number?new u.LongBits(e.version.low>>>0,e.version.high>>>0).toNumber():e.version),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),o),e.exports=l},2100:(e,t,r)=>{e.exports=r(9482)},9482:(e,t,r)=>{var n=t;function i(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=r(1173),n.BufferWriter=r(3155),n.Reader=r(1408),n.BufferReader=r(593),n.util=r(9693),n.rpc=r(5994),n.roots=r(5054),n.configure=i,i()},1408:(e,t,r)=>{e.exports=c;var n,i=r(9693),o=i.LongBits,s=i.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var u,l="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},d=function(){return i.Buffer?function(e){return(c.create=function(e){return i.Buffer.isBuffer(e)?new n(e):l(e)})(e)}:l};function h(){var e=new o(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function f(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function p(){if(this.pos+8>this.len)throw a(this,8);return new o(f(this.buf,this.pos+=4),f(this.buf,this.pos+=4))}c.create=d(),c.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,c.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return u;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return u}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return f(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|f(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)},c.prototype.string=function(){var e=this.bytes();return s.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){n=e,c.create=d(),n._configure();var t=i.Long?"toLong":"toNumber";i.merge(c.prototype,{int64:function(){return h.call(this)[t](!1)},uint64:function(){return h.call(this)[t](!0)},sint64:function(){return h.call(this).zzDecode()[t](!1)},fixed64:function(){return p.call(this)[t](!0)},sfixed64:function(){return p.call(this)[t](!1)}})}},593:(e,t,r)=>{e.exports=o;var n=r(1408);(o.prototype=Object.create(n.prototype)).constructor=o;var i=r(9693);function o(e){n.call(this,e)}o._configure=function(){i.Buffer&&(o.prototype._slice=i.Buffer.prototype.slice)},o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},o._configure()},5054:e=>{e.exports={}},5994:(e,t,r)=>{t.Service=r(7948)},7948:(e,t,r)=>{e.exports=i;var n=r(9693);function i(e,t,r){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}(i.prototype=Object.create(n.EventEmitter.prototype)).constructor=i,i.prototype.rpcCall=function e(t,r,i,o,s){if(!o)throw TypeError("request must be specified");var a=this;if(!s)return n.asPromise(e,a,t,r,i,o);if(a.rpcImpl)try{return a.rpcImpl(t,r[a.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,r){if(e)return a.emit("error",e,t),s(e);if(null!==r){if(!(r instanceof i))try{r=i[a.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return a.emit("error",e,t),s(e)}return a.emit("data",r,t),s(null,r)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){s(e)}),0)}else setTimeout((function(){s(Error("already ended"))}),0)},i.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},1945:(e,t,r)=>{e.exports=i;var n=r(9693);function i(e,t){this.lo=e>>>0,this.hi=t>>>0}var o=i.zero=new i(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var s=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(e){if(0===e)return o;var t=e<0;t&&(e=-e);var r=e>>>0,n=(e-r)/4294967296>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new i(r,n)},i.from=function(e){if("number"==typeof e)return i.fromNumber(e);if(n.isString(e)){if(!n.Long)return i.fromNumber(parseInt(e,10));e=n.Long.fromString(e)}return e.low||e.high?new i(e.low>>>0,e.high>>>0):o},i.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;i.fromHash=function(e){return e===s?o:new i((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},i.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},i.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}},9693:function(e,t,r){var n=t;function i(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)void 0!==e[n[i]]&&r||(e[n[i]]=t[n[i]]);return e}function o(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&i(this,r)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}n.asPromise=r(4537),n.base64=r(7419),n.EventEmitter=r(9211),n.float=r(945),n.inquire=r(7199),n.utf8=r(4997),n.pool=r(6662),n.LongBits=r(1945),n.isNode=Boolean(void 0!==r.g&&r.g&&r.g.process&&r.g.process.versions&&r.g.process.versions.node),n.global=n.isNode&&r.g||"undefined"!=typeof window&&window||"undefined"!=typeof globalThis&&globalThis||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"==typeof e||e instanceof String},n.isObject=function(e){return e&&"object"==typeof e},n.isset=n.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"==typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var r=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))},n.merge=i,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=o,n.ProtocolError=o("ProtocolError"),n.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},n.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}},1173:(e,t,r)=>{e.exports=d;var n,i=r(9693),o=i.LongBits,s=i.base64,a=i.utf8;function c(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function u(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function d(){this.len=0,this.head=new c(u,0,0),this.tail=this.head,this.states=null}var h=function(){return i.Buffer?function(){return(d.create=function(){return new n})()}:function(){return new d}};function f(e,t,r){t[r]=255&e}function p(e,t){this.len=e,this.next=void 0,this.val=t}function m(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function g(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}d.create=h(),d.alloc=function(e){return new i.Array(e)},i.Array!==Array&&(d.alloc=i.pool(d.alloc,i.Array.prototype.subarray)),d.prototype._push=function(e,t,r){return this.tail=this.tail.next=new c(e,t,r),this.len+=t,this},p.prototype=Object.create(c.prototype),p.prototype.fn=function(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e},d.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new p((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},d.prototype.int32=function(e){return e<0?this._push(m,10,o.fromNumber(e)):this.uint32(e)},d.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},d.prototype.uint64=function(e){var t=o.from(e);return this._push(m,t.length(),t)},d.prototype.int64=d.prototype.uint64,d.prototype.sint64=function(e){var t=o.from(e).zzEncode();return this._push(m,t.length(),t)},d.prototype.bool=function(e){return this._push(f,1,e?1:0)},d.prototype.fixed32=function(e){return this._push(g,4,e>>>0)},d.prototype.sfixed32=d.prototype.fixed32,d.prototype.fixed64=function(e){var t=o.from(e);return this._push(g,4,t.lo)._push(g,4,t.hi)},d.prototype.sfixed64=d.prototype.fixed64,d.prototype.float=function(e){return this._push(i.float.writeFloatLE,4,e)},d.prototype.double=function(e){return this._push(i.float.writeDoubleLE,8,e)};var v=i.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};d.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(f,1,0);if(i.isString(e)){var r=d.alloc(t=s.length(e));s.decode(e,r,0),e=r}return this.uint32(t)._push(v,t,e)},d.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(f,1,0)},d.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new c(u,0,0),this.len=0,this},d.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(u,0,0),this.len=0),this},d.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},d.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},d._configure=function(e){n=e,d.create=h(),n._configure()}},3155:(e,t,r)=>{e.exports=o;var n=r(1173);(o.prototype=Object.create(n.prototype)).constructor=o;var i=r(9693);function o(){n.call(this)}function s(e,t,r){e.length<40?i.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}o._configure=function(){o.alloc=i._Buffer_allocUnsafe,o.writeBytesBuffer=i.Buffer&&i.Buffer.prototype instanceof Uint8Array&&"set"===i.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]}},o.prototype.bytes=function(e){i.isString(e)&&(e=i._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(o.writeBytesBuffer,t,e),this},o.prototype.string=function(e){var t=i.Buffer.byteLength(e);return this.uint32(t),t&&this._push(s,t,e),this},o._configure()},4154:e=>{e.exports='"use strict";var e={},t="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node;if(t){var r=require("worker_threads"),a=r.parentPort;a.on("message",(e=>onmessage({data:e})));var o=require("fs");Object.assign(global,{globalThis:global,require:require,Module:e,location:{href:__filename},Worker:r.Worker,importScripts:function(e){(0,eval)(o.readFileSync(e,"utf8"))},postMessage:function(e){a.postMessage(e)},performance:global.performance||{now:function(){return Date.now()}}})}var s=!1,n=[],i=function(){var e=Array.prototype.slice.call(arguments).join(" ");t?o.writeSync(2,e+"\\n"):console.error(e)};globalThis.alert=function(){var t=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:t,threadId:e._pthread_self()})},e.instantiateWasm=(t,r)=>{var a=new WebAssembly.Instance(e.wasmModule,t);return r(a),e.wasmModule=null,a.exports},globalThis.onunhandledrejection=e=>{throw e.reason??e},globalThis.onmessage=t=>{try{if("load"===t.data.cmd){if(e.wasmModule=t.data.wasmModule,e.wasmMemory=t.data.wasmMemory,e.buffer=e.wasmMemory.buffer,e.ENVIRONMENT_IS_PTHREAD=!0,"string"==typeof t.data.urlOrBlob)importScripts(t.data.urlOrBlob);else{var r=URL.createObjectURL(t.data.urlOrBlob);importScripts(r),URL.revokeObjectURL(r)}ortWasmThreaded(e).then((function(t){e=t}))}else if("run"===t.data.cmd){e.__performance_now_clock_drift=performance.now()-t.data.time,e.__emscripten_thread_init(t.data.pthread_ptr,0,0,1),e.establishStackSpace(),e.PThread.receiveObjectTransfer(t.data),e.PThread.threadInitTLS(),s||(n.forEach((t=>{e.executeNotifiedProxyingQueue(t)})),n=[],s=!0);try{e.invokeEntryPoint(t.data.start_routine,t.data.arg)}catch(t){if("unwind"!=t){if(!(t instanceof e.ExitStatus))throw t;e.keepRuntimeAlive()||e.__emscripten_thread_exit(t.status)}}}else"cancel"===t.data.cmd?e._pthread_self()&&e.__emscripten_thread_exit(-1):"setimmediate"===t.data.target||("processProxyingQueue"===t.data.cmd?s?e.executeNotifiedProxyingQueue(t.data.queue):n.push(t.data.queue):(i("worker.js received unknown command "+t.data.cmd),i(t.data)))}catch(t){throw i("worker.js onmessage() captured an uncaught exception: "+t),t&&t.stack&&i(t.stack),e.__emscripten_thread_crashed&&e.__emscripten_thread_crashed(),t}};\n'},7067:()=>{},1296:()=>{},760:()=>{},1384:()=>{},3993:()=>{},908:()=>{},6953:()=>{},9925:()=>{},2806:()=>{},6449:()=>{},2850:()=>{},5381:()=>{},5686:(e,t,r)=>{r.r(t),r.d(t,{flatbuffers:()=>n});var n={};n.Offset,n.Table,n.SIZEOF_SHORT=2,n.SIZEOF_INT=4,n.FILE_IDENTIFIER_LENGTH=4,n.SIZE_PREFIX_LENGTH=4,n.Encoding={UTF8_BYTES:1,UTF16_STRING:2},n.int32=new Int32Array(2),n.float32=new Float32Array(n.int32.buffer),n.float64=new Float64Array(n.int32.buffer),n.isLittleEndian=1===new Uint16Array(new Uint8Array([1,0]).buffer)[0],n.Long=function(e,t){this.low=0|e,this.high=0|t},n.Long.create=function(e,t){return 0==e&&0==t?n.Long.ZERO:new n.Long(e,t)},n.Long.prototype.toFloat64=function(){return(this.low>>>0)+4294967296*this.high},n.Long.prototype.equals=function(e){return this.low==e.low&&this.high==e.high},n.Long.ZERO=new n.Long(0,0),n.Builder=function(e){if(e)t=e;else var t=1024;this.bb=n.ByteBuffer.allocate(t),this.space=t,this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},n.Builder.prototype.clear=function(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},n.Builder.prototype.forceDefaults=function(e){this.force_defaults=e},n.Builder.prototype.dataBuffer=function(){return this.bb},n.Builder.prototype.asUint8Array=function(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())},n.Builder.prototype.prep=function(e,t){e>this.minalign&&(this.minalign=e);for(var r=1+~(this.bb.capacity()-this.space+t)&e-1;this.space<r+e+t;){var i=this.bb.capacity();this.bb=n.Builder.growByteBuffer(this.bb),this.space+=this.bb.capacity()-i}this.pad(r)},n.Builder.prototype.pad=function(e){for(var t=0;t<e;t++)this.bb.writeInt8(--this.space,0)},n.Builder.prototype.writeInt8=function(e){this.bb.writeInt8(this.space-=1,e)},n.Builder.prototype.writeInt16=function(e){this.bb.writeInt16(this.space-=2,e)},n.Builder.prototype.writeInt32=function(e){this.bb.writeInt32(this.space-=4,e)},n.Builder.prototype.writeInt64=function(e){this.bb.writeInt64(this.space-=8,e)},n.Builder.prototype.writeFloat32=function(e){this.bb.writeFloat32(this.space-=4,e)},n.Builder.prototype.writeFloat64=function(e){this.bb.writeFloat64(this.space-=8,e)},n.Builder.prototype.addInt8=function(e){this.prep(1,0),this.writeInt8(e)},n.Builder.prototype.addInt16=function(e){this.prep(2,0),this.writeInt16(e)},n.Builder.prototype.addInt32=function(e){this.prep(4,0),this.writeInt32(e)},n.Builder.prototype.addInt64=function(e){this.prep(8,0),this.writeInt64(e)},n.Builder.prototype.addFloat32=function(e){this.prep(4,0),this.writeFloat32(e)},n.Builder.prototype.addFloat64=function(e){this.prep(8,0),this.writeFloat64(e)},n.Builder.prototype.addFieldInt8=function(e,t,r){(this.force_defaults||t!=r)&&(this.addInt8(t),this.slot(e))},n.Builder.prototype.addFieldInt16=function(e,t,r){(this.force_defaults||t!=r)&&(this.addInt16(t),this.slot(e))},n.Builder.prototype.addFieldInt32=function(e,t,r){(this.force_defaults||t!=r)&&(this.addInt32(t),this.slot(e))},n.Builder.prototype.addFieldInt64=function(e,t,r){!this.force_defaults&&t.equals(r)||(this.addInt64(t),this.slot(e))},n.Builder.prototype.addFieldFloat32=function(e,t,r){(this.force_defaults||t!=r)&&(this.addFloat32(t),this.slot(e))},n.Builder.prototype.addFieldFloat64=function(e,t,r){(this.force_defaults||t!=r)&&(this.addFloat64(t),this.slot(e))},n.Builder.prototype.addFieldOffset=function(e,t,r){(this.force_defaults||t!=r)&&(this.addOffset(t),this.slot(e))},n.Builder.prototype.addFieldStruct=function(e,t,r){t!=r&&(this.nested(t),this.slot(e))},n.Builder.prototype.nested=function(e){if(e!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")},n.Builder.prototype.notNested=function(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")},n.Builder.prototype.slot=function(e){this.vtable[e]=this.offset()},n.Builder.prototype.offset=function(){return this.bb.capacity()-this.space},n.Builder.growByteBuffer=function(e){var t=e.capacity();if(3221225472&t)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");var r=t<<1,i=n.ByteBuffer.allocate(r);return i.setPosition(r-t),i.bytes().set(e.bytes(),r-t),i},n.Builder.prototype.addOffset=function(e){this.prep(n.SIZEOF_INT,0),this.writeInt32(this.offset()-e+n.SIZEOF_INT)},n.Builder.prototype.startObject=function(e){this.notNested(),null==this.vtable&&(this.vtable=[]),this.vtable_in_use=e;for(var t=0;t<e;t++)this.vtable[t]=0;this.isNested=!0,this.object_start=this.offset()},n.Builder.prototype.endObject=function(){if(null==this.vtable||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);for(var e=this.offset(),t=this.vtable_in_use-1;t>=0&&0==this.vtable[t];t--);for(var r=t+1;t>=0;t--)this.addInt16(0!=this.vtable[t]?e-this.vtable[t]:0);this.addInt16(e-this.object_start);var i=(r+2)*n.SIZEOF_SHORT;this.addInt16(i);var o=0,s=this.space;e:for(t=0;t<this.vtables.length;t++){var a=this.bb.capacity()-this.vtables[t];if(i==this.bb.readInt16(a)){for(var c=n.SIZEOF_SHORT;c<i;c+=n.SIZEOF_SHORT)if(this.bb.readInt16(s+c)!=this.bb.readInt16(a+c))continue e;o=this.vtables[t];break}}return o?(this.space=this.bb.capacity()-e,this.bb.writeInt32(this.space,o-e)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-e,this.offset()-e)),this.isNested=!1,e},n.Builder.prototype.finish=function(e,t,r){var i=r?n.SIZE_PREFIX_LENGTH:0;if(t){var o=t;if(this.prep(this.minalign,n.SIZEOF_INT+n.FILE_IDENTIFIER_LENGTH+i),o.length!=n.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+n.FILE_IDENTIFIER_LENGTH);for(var s=n.FILE_IDENTIFIER_LENGTH-1;s>=0;s--)this.writeInt8(o.charCodeAt(s))}this.prep(this.minalign,n.SIZEOF_INT+i),this.addOffset(e),i&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)},n.Builder.prototype.finishSizePrefixed=function(e,t){this.finish(e,t,!0)},n.Builder.prototype.requiredField=function(e,t){var r=this.bb.capacity()-e,n=r-this.bb.readInt32(r);if(0==this.bb.readInt16(n+t))throw new Error("FlatBuffers: field "+t+" must be set")},n.Builder.prototype.startVector=function(e,t,r){this.notNested(),this.vector_num_elems=t,this.prep(n.SIZEOF_INT,e*t),this.prep(r,e*t)},n.Builder.prototype.endVector=function(){return this.writeInt32(this.vector_num_elems),this.offset()},n.Builder.prototype.createString=function(e){if(e instanceof Uint8Array)var t=e;else{t=[];for(var r=0;r<e.length;){var n,i=e.charCodeAt(r++);(n=i<55296||i>=56320?i:(i<<10)+e.charCodeAt(r++)+-56613888)<128?t.push(n):(n<2048?t.push(n>>6&31|192):(n<65536?t.push(n>>12&15|224):t.push(n>>18&7|240,n>>12&63|128),t.push(n>>6&63|128)),t.push(63&n|128))}}this.addInt8(0),this.startVector(1,t.length,1),this.bb.setPosition(this.space-=t.length),r=0;for(var o=this.space,s=this.bb.bytes();r<t.length;r++)s[o++]=t[r];return this.endVector()},n.Builder.prototype.createLong=function(e,t){return n.Long.create(e,t)},n.ByteBuffer=function(e){this.bytes_=e,this.position_=0},n.ByteBuffer.allocate=function(e){return new n.ByteBuffer(new Uint8Array(e))},n.ByteBuffer.prototype.clear=function(){this.position_=0},n.ByteBuffer.prototype.bytes=function(){return this.bytes_},n.ByteBuffer.prototype.position=function(){return this.position_},n.ByteBuffer.prototype.setPosition=function(e){this.position_=e},n.ByteBuffer.prototype.capacity=function(){return this.bytes_.length},n.ByteBuffer.prototype.readInt8=function(e){return this.readUint8(e)<<24>>24},n.ByteBuffer.prototype.readUint8=function(e){return this.bytes_[e]},n.ByteBuffer.prototype.readInt16=function(e){return this.readUint16(e)<<16>>16},n.ByteBuffer.prototype.readUint16=function(e){return this.bytes_[e]|this.bytes_[e+1]<<8},n.ByteBuffer.prototype.readInt32=function(e){return this.bytes_[e]|this.bytes_[e+1]<<8|this.bytes_[e+2]<<16|this.bytes_[e+3]<<24},n.ByteBuffer.prototype.readUint32=function(e){return this.readInt32(e)>>>0},n.ByteBuffer.prototype.readInt64=function(e){return new n.Long(this.readInt32(e),this.readInt32(e+4))},n.ByteBuffer.prototype.readUint64=function(e){return new n.Long(this.readUint32(e),this.readUint32(e+4))},n.ByteBuffer.prototype.readFloat32=function(e){return n.int32[0]=this.readInt32(e),n.float32[0]},n.ByteBuffer.prototype.readFloat64=function(e){return n.int32[n.isLittleEndian?0:1]=this.readInt32(e),n.int32[n.isLittleEndian?1:0]=this.readInt32(e+4),n.float64[0]},n.ByteBuffer.prototype.writeInt8=function(e,t){this.bytes_[e]=t},n.ByteBuffer.prototype.writeUint8=function(e,t){this.bytes_[e]=t},n.ByteBuffer.prototype.writeInt16=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8},n.ByteBuffer.prototype.writeUint16=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8},n.ByteBuffer.prototype.writeInt32=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24},n.ByteBuffer.prototype.writeUint32=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24},n.ByteBuffer.prototype.writeInt64=function(e,t){this.writeInt32(e,t.low),this.writeInt32(e+4,t.high)},n.ByteBuffer.prototype.writeUint64=function(e,t){this.writeUint32(e,t.low),this.writeUint32(e+4,t.high)},n.ByteBuffer.prototype.writeFloat32=function(e,t){n.float32[0]=t,this.writeInt32(e,n.int32[0])},n.ByteBuffer.prototype.writeFloat64=function(e,t){n.float64[0]=t,this.writeInt32(e,n.int32[n.isLittleEndian?0:1]),this.writeInt32(e+4,n.int32[n.isLittleEndian?1:0])},n.ByteBuffer.prototype.getBufferIdentifier=function(){if(this.bytes_.length<this.position_+n.SIZEOF_INT+n.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");for(var e="",t=0;t<n.FILE_IDENTIFIER_LENGTH;t++)e+=String.fromCharCode(this.readInt8(this.position_+n.SIZEOF_INT+t));return e},n.ByteBuffer.prototype.__offset=function(e,t){var r=e-this.readInt32(e);return t<this.readInt16(r)?this.readInt16(r+t):0},n.ByteBuffer.prototype.__union=function(e,t){return e.bb_pos=t+this.readInt32(t),e.bb=this,e},n.ByteBuffer.prototype.__string=function(e,t){e+=this.readInt32(e);var r=this.readInt32(e),i="",o=0;if(e+=n.SIZEOF_INT,t===n.Encoding.UTF8_BYTES)return this.bytes_.subarray(e,e+r);for(;o<r;){var s,a=this.readUint8(e+o++);if(a<192)s=a;else{var c=this.readUint8(e+o++);if(a<224)s=(31&a)<<6|63&c;else{var u=this.readUint8(e+o++);s=a<240?(15&a)<<12|(63&c)<<6|63&u:(7&a)<<18|(63&c)<<12|(63&u)<<6|63&this.readUint8(e+o++)}}s<65536?i+=String.fromCharCode(s):(s-=65536,i+=String.fromCharCode(55296+(s>>10),56320+(1023&s)))}return i},n.ByteBuffer.prototype.__indirect=function(e){return e+this.readInt32(e)},n.ByteBuffer.prototype.__vector=function(e){return e+this.readInt32(e)+n.SIZEOF_INT},n.ByteBuffer.prototype.__vector_len=function(e){return this.readInt32(e+this.readInt32(e))},n.ByteBuffer.prototype.__has_identifier=function(e){if(e.length!=n.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+n.FILE_IDENTIFIER_LENGTH);for(var t=0;t<n.FILE_IDENTIFIER_LENGTH;t++)if(e.charCodeAt(t)!=this.readInt8(this.position_+n.SIZEOF_INT+t))return!1;return!0},n.ByteBuffer.prototype.createLong=function(e,t){return n.Long.create(e,t)}}},__webpack_module_cache__={};function __nested_webpack_require_668025__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__nested_webpack_require_668025__),r.exports}__nested_webpack_require_668025__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __nested_webpack_require_668025__.d(t,{a:t}),t},__nested_webpack_require_668025__.d=(e,t)=>{for(var r in t)__nested_webpack_require_668025__.o(t,r)&&!__nested_webpack_require_668025__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__nested_webpack_require_668025__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__nested_webpack_require_668025__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__nested_webpack_require_668025__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __nested_webpack_exports__=__nested_webpack_require_668025__(1057);return __nested_webpack_exports__})(),module.exports=t()})(ort_min);var __awaiter$4=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class LocalGenerator{constructor(e){this.config=e,this.last_mask_generation=0,this.last_mask=new ort_min.exports.Tensor("float32",new Float32Array(this.config.mask.output_size.height*this.config.mask.output_size.width),[1,1,this.config.mask.output_size.height,this.config.mask.output_size.width])}preprocess(e,t){const{model_rank:r,input_size:n,output_size:i}=this.config.mask,{height:o,width:s}=n,a=o*s;this.output||(this.output=new Float32Array(a*r));const c=4===r?2:0,u=e.length/4;for(let t=0;t<3;t++)for(let r=0;r<u;r++)this.output[r+t*a]=e[4*r+Math.abs(c-t)];if(4===r){const e=i.width/s,r=i.height/o;for(let n=0;n<s;n++){const c=Math.floor(n*e);for(let e=0;e<o;e++){const o=c+Math.floor(e*r)*i.width,u=n+e*s+3*a,l=255*Math.min(Math.max(t[o],0),1);this.output[u]=l}}}return this.output}getMask(e){return __awaiter$4(this,void 0,void 0,(function*(){if(!this.mask_model)throw new Error("[ladon-ts] - mask model not loaded.");if(!(Date.now()-this.last_mask_generation>this.config.mask.generation_interval_ms))return{data:this.last_mask.data,warm:!1};this.last_mask_generation=Date.now();const t=new ort_min.exports.Tensor("float32",this.preprocess(e,this.last_mask.data),[1,this.config.mask.model_rank,this.config.mask.input_size.height,this.config.mask.input_size.width]);if(4===this.config.mask.model_rank){const e=yield this.mask_model.run({input:t});this.last_mask=e.segmentation}else{const e=yield this.mask_model.run({input_image:t,prev_mask:this.last_mask});this.last_mask=e.output_mask}return{data:this.last_mask.data,warm:!0}}))}load(){return __awaiter$4(this,void 0,void 0,(function*(){this.config.wasm_uri&&(ort_min.exports.env.wasm.wasmPaths=toAbsoluteURI(this.config.wasm_uri,this.config.base_url)),ort_min.exports.env.wasm.numThreads=1;const e=yield getModelUrl(this.config);this.mask_model=yield ort_min.exports.InferenceSession.create(e,{executionProviders:["wasm"]})}))}isLoaded(){return!!this.mask_model}postRender(e){return __awaiter$4(this,void 0,void 0,(function*(){}))}destroy(){}}class NullGenerator{constructor(e){this.config=e,this.last_mask=new Float32Array(this.config.mask.output_size.height*this.config.mask.output_size.width)}getMask(e){return __awaiter$4(this,void 0,void 0,(function*(){return{data:this.last_mask,warm:!1}}))}load(){return __awaiter$4(this,void 0,void 0,(function*(){}))}isLoaded(){return!0}postRender(e){return __awaiter$4(this,void 0,void 0,(function*(){}))}destroy(){}}class WorkerGenerator{constructor(e){this.config=e,this.new_mask=!0,this.last_mask=new Float32Array(this.config.mask.output_size.height*this.config.mask.output_size.width)}getMask(e){return __awaiter$4(this,void 0,void 0,(function*(){const e={data:this.last_mask,warm:this.new_mask};return this.new_mask=!1,e}))}load(){return __awaiter$4(this,void 0,void 0,(function*(){const e=toAbsoluteURI(this.config.mask.worker_uri,this.config.base_url),t=yield(yield fetch(e,{cache:"force-cache"})).text(),r=URL.createObjectURL(new Blob([t],{type:"text/javascript"}));this.worker=new Worker(r,{type:"module"});const n=yield getModelUrl(this.config),i={base_url:this.config.base_url,input:this.config.input,mask:Object.assign(Object.assign({},this.config.mask),{model_url_resolver:n}),wasm_uri:this.config.wasm_uri,render:{type:"passthrough"}};let o;this.worker.postMessage(i);const s=new Promise((e=>{o=e}));return this.worker.onmessage=e=>{e.data.mask?(this.last_mask=e.data.mask,this.new_mask=!0):(URL.revokeObjectURL(r),o&&o())},s}))}isLoaded(){return!!this.worker}postRender(e){return __awaiter$4(this,void 0,void 0,(function*(){if(!this.worker)throw new Error("[ladon-ts] - worker is not defined.");this.worker.postMessage({image:e},[e.buffer])}))}destroy(){var e;null===(e=this.worker)||void 0===e||e.terminate()}}class WebGLRenderer{constructor(e,t){this.output_canvas=e,this.config=t,this.verts=new Float32Array([-1,-1,0,-1,1,0,1,1,0,1,1,0,1,-1,0,-1,-1,0]),this.vertex_shader_src="#version 300 es\n\nin vec4 position;\n\nvoid main() {\n    gl_Position = position;\n}\n";const r=this.output_canvas.getContext("webgl2");if(r)this.gl=r;else{const e=this.output_canvas.getContext("2d");if(!e)throw new Error("[ladon-ts] - output canvas context must be webgl2 or 2d");this.output_canvas_2d=e,this.intermediate_canvas=document.createElement("canvas"),this.intermediate_canvas.height=this.config.input.height,this.intermediate_canvas.width=this.config.input.width;const t=this.intermediate_canvas.getContext("webgl2");if(!t)throw new Error("[ladon-ts] - error getting output context webgl");this.gl=t}const n=this.gl.createTexture();if(!n)throw new Error("[ladon-ts] - error creating input texture");this.image_texture=n,this.gl.bindTexture(this.gl.TEXTURE_2D,this.image_texture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.config.input.width,this.config.input.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null),this.gl.bindTexture(this.gl.TEXTURE_2D,null);const i=this.gl.createTexture();if(!i)throw new Error("[ladon-ts] - error creating mask texture");this.mask_texture=i,this.gl.bindTexture(this.gl.TEXTURE_2D,this.mask_texture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.R32F,this.config.mask.output_size.width,this.config.mask.output_size.height,0,this.gl.RED,this.gl.FLOAT,null),this.gl.bindTexture(this.gl.TEXTURE_2D,null);const o=this.gl.createVertexArray();if(!o)throw new Error("[ladon-ts] - error creating vertex array");this.gl.bindVertexArray(o);const s=this.gl.createBuffer();if(!s)throw new Error("[ladon-ts] - error creating buffer");this.gl.bindBuffer(this.gl.ARRAY_BUFFER,s),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.verts,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(0,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(0),this.gl.viewport(0,0,this.config.input.width,this.config.input.height)}getUVCalculation(){return this.config.render.horizontal_mirror?"vec2 st = -(gl_FragCoord.xy / u_resolution) + 1.0;":"vec2 st = vec2((gl_FragCoord.x / u_resolution.x), -(gl_FragCoord.y / u_resolution.y) + 1.0);"}setSharedUniforms(e){const t=this.gl.getUniformLocation(e,"u_resolution");if(!t)throw new Error('[ladon-ts] - error finding "u_resolution" uniform');this.gl.uniform2f(t,this.config.input.width,this.config.input.height);const r=this.gl.getUniformLocation(e,"u_image");if(!r)throw new Error('[ladon-ts] - error finding "u_image" uniform');this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.image_texture),this.gl.uniform1i(r,0);const n=this.gl.getUniformLocation(e,"u_mask");n&&(this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,this.mask_texture),this.gl.uniform1i(n,1))}uploadVideoStream(e){this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.image_texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.config.input.width,this.config.input.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e)}postDraw(){this.output_canvas_2d&&this.intermediate_canvas&&this.output_canvas_2d.drawImage(this.intermediate_canvas,0,0,this.config.input.width,this.config.input.height)}}var __awaiter$3=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class BlurRenderer extends WebGLRenderer{constructor(e,t){if(super(e,t),this.output_canvas=e,this.config=t,this.fragment_shader_common=`#version 300 es\nprecision highp float;\n\n#define KERNEL_SIZE     ${this.config.render.kernel_size}\n#define HORIZONTAL      vec2(1.0, 0.0)\n#define VERTICAL        vec2(0.0, 1.0)\n#define EPSILON         0.00001\n\nout vec4 outColor;\n\nuniform sampler2D       u_image;\nuniform float           u_kernel[KERNEL_SIZE];\nuniform sampler2D       u_mask;\nuniform vec2            u_resolution;\n\n\nfloat get_mask(vec2 st) {\n    return clamp(texture(u_mask, st).r, 0.0, 1.0);\n}\n\nfloat get_inv_mask(vec2 st) {\n    return 1.0 - get_mask(st);\n}\n\nvec4 get_offset_mul(sampler2D src, vec2 uv, float weight) {\n    if (uv.x < 0.0 || uv.x > 1.0 || uv.y < 0.0 || uv.y > 1.0) {\n        return vec4(vec3(0.0), weight);\n    }\n\n    // 4th channel is masked weight value\n    return vec4(vec3(texture(src, uv).rgb * get_inv_mask(uv) * weight), get_mask(uv) * weight);\n}\n\nvec3 blur(sampler2D src, vec2 uv, vec2 direction) {\n    vec4 result = vec4(0.0);\n\n    vec2 step = (direction / u_resolution);\n    int offset = (KERNEL_SIZE - 1) / 2;\n\n    for (int i = 0; i < KERNEL_SIZE; i++) {\n        vec2 offset = step * float(i - offset);\n        result += get_offset_mul(src, uv + offset, u_kernel[i]);\n    }\n\n    if (abs(result.a - 1.0) < EPSILON) {\n        return vec3(0.0);\n    }\n\n    // redistribute weights from masked areas\n    return result.rgb * (1.0 + (result.a / (1.0 - result.a)));\n}\n`,this.fragment_shader_pass_1_src=this.fragment_shader_common+"\nvoid main() {\n    vec2 st = gl_FragCoord.xy / u_resolution;\n\n    outColor = vec4(blur(u_image, st, HORIZONTAL) * get_inv_mask(st), 1.0);\n}\n",this.fragment_shader_pass_2_src=this.fragment_shader_common+`\nuniform sampler2D   u_blur;\n\n\nvoid main() {\n    ${this.getUVCalculation()}\n\n    vec3 blurred = blur(u_blur, st, VERTICAL);\n    vec3 image = texture(u_image, st).rgb;\n    float mask = texture(u_mask, st).r;\n\n    outColor = vec4(blurred * (1.0 - mask) + image * mask, 1.0);\n}\n`,this.config.render.kernel_size%2==0)throw new Error("[ladon-ts] - kernel_size must be odd");{const e=compileShader(this.gl,this.gl.VERTEX_SHADER,this.vertex_shader_src),t=compileShader(this.gl,this.gl.FRAGMENT_SHADER,this.fragment_shader_pass_1_src);this.program_1=linkProgram(this.gl,e,t),this.gl.useProgram(this.program_1);const r=this.gl.createFramebuffer();if(!r)throw new Error("[ladon-ts] - error creating framebuffer");this.framebuffer=r;const n=this.gl.createTexture();if(!n)throw new Error("[ladon-ts] - error creating output texture");this.transfer_texture=n,this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.framebuffer),this.gl.bindTexture(this.gl.TEXTURE_2D,this.transfer_texture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.config.input.width,this.config.input.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,this.transfer_texture,0),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.setSharedUniforms(this.program_1);const i=this.gl.getUniformLocation(this.program_1,"u_kernel");if(!i)throw new Error('[ladon-ts] - error finding "u_kernel" uniform');this.gl.uniform1fv(i,this.getBlurKernel())}{const e=compileShader(this.gl,this.gl.VERTEX_SHADER,this.vertex_shader_src),t=compileShader(this.gl,this.gl.FRAGMENT_SHADER,this.fragment_shader_pass_2_src);this.program_2=linkProgram(this.gl,e,t),this.gl.useProgram(this.program_2);const r=this.gl.getUniformLocation(this.program_2,"u_blur");if(!r)throw new Error('[ladon-ts] - error finding "u_blur" uniform');this.u_blur=r,this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,this.transfer_texture),this.gl.uniform1i(this.u_blur,2),this.setSharedUniforms(this.program_2);const n=this.gl.getUniformLocation(this.program_2,"u_kernel");if(!n)throw new Error('[ladon-ts] - error finding "u_kernel" uniform');this.gl.uniform1fv(n,this.getBlurKernel())}}render(e,t){return __awaiter$3(this,void 0,void 0,(function*(){this.uploadVideoStream(e),t.warm&&(this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,this.mask_texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.R32F,this.config.mask.output_size.width,this.config.mask.output_size.height,0,this.gl.RED,this.gl.FLOAT,t.data)),this.gl.useProgram(this.program_1),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.framebuffer),this.gl.drawArrays(this.gl.TRIANGLES,0,this.verts.length/3),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.useProgram(this.program_2),this.gl.drawArrays(this.gl.TRIANGLES,0,this.verts.length/3),this.postDraw()}))}load(){return __awaiter$3(this,void 0,void 0,(function*(){}))}destroy(){}getBlurKernel(){const e=[];let t=0;for(let r=0;r<this.config.render.kernel_size;r++){let n=r-(this.config.render.kernel_size-1)/2;n=Math.exp(-Math.pow(n,2)/Math.pow(this.config.render.sigma,2)),e.push(n),t+=n}for(let r=0;r<this.config.render.kernel_size;r++)e[r]=e[r]/t;return new Float32Array(e)}}var __awaiter$2=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class PassthroughRenderer extends WebGLRenderer{constructor(e,t){super(e,t),this.output_canvas=e,this.config=t,this.fragment_shader=`#version 300 es\nprecision highp float;\n\nout vec4 outColor;\n\nuniform sampler2D       u_image;\nuniform vec2            u_resolution;\n\n\nvoid main() {\n    ${this.getUVCalculation()}\n\n    outColor = vec4(texture(u_image, st).rgb, 1.0);\n}\n`;const r=compileShader(this.gl,this.gl.VERTEX_SHADER,this.vertex_shader_src),n=compileShader(this.gl,this.gl.FRAGMENT_SHADER,this.fragment_shader);this.program=linkProgram(this.gl,r,n),this.gl.useProgram(this.program),this.setSharedUniforms(this.program)}render(e,t){return __awaiter$2(this,void 0,void 0,(function*(){this.uploadVideoStream(e),this.gl.useProgram(this.program),this.gl.drawArrays(this.gl.TRIANGLES,0,this.verts.length/3),this.postDraw()}))}load(){return __awaiter$2(this,void 0,void 0,(function*(){}))}destroy(){}}var __awaiter$1=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class ReplacementRenderer extends WebGLRenderer{constructor(e,t){super(e,t),this.output_canvas=e,this.config=t,this.fragment_shader=`#version 300 es\nprecision highp float;\n\nout vec4 outColor;\n\nuniform sampler2D       u_background;\nuniform sampler2D       u_image;\nuniform sampler2D       u_mask;\nuniform vec2            u_resolution;\n\n\nfloat get_mask(vec2 st) {\n    return clamp(texture(u_mask, st).r, 0.0, 1.0);\n}\n\nfloat get_inv_mask(vec2 st) {\n    return 1.0 - get_mask(st);\n}\n\nvoid main() {\n    ${this.getUVCalculation()}\n\n    outColor = vec4(texture(u_background, st).rgb * get_inv_mask(st) + texture(u_image, st).rgb * get_mask(st), 1.0);\n}\n`;const r=this.config.render.background.getContext("2d");if(!r)throw new Error("[ladon-ts] - could not get background canvas context 2d");this.background_canvas_ctx=r;const n=this.background_canvas_ctx.getImageData(0,0,this.config.render.background.width,this.config.render.background.height).data;if(this.config.render.kernel_size%2==0)throw new Error("[ladon-ts] - kernel_size must be odd");const i=compileShader(this.gl,this.gl.VERTEX_SHADER,this.vertex_shader_src),o=compileShader(this.gl,this.gl.FRAGMENT_SHADER,this.fragment_shader);this.program=linkProgram(this.gl,i,o),this.gl.useProgram(this.program),this.setSharedUniforms(this.program);const s=this.gl.createTexture();if(!s)throw new Error("[ladon-ts] - error creating input texture");this.background_texture=s,this.gl.bindTexture(this.gl.TEXTURE_2D,this.background_texture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.config.render.background.width,this.config.render.background.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,n),this.gl.bindTexture(this.gl.TEXTURE_2D,null);const a=this.gl.getUniformLocation(this.program,"u_background");if(!a)throw new Error('[ladon-ts] - error finding "u_background" uniform');this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,this.background_texture),this.gl.uniform1i(a,2)}render(e,t){return __awaiter$1(this,void 0,void 0,(function*(){if(this.uploadVideoStream(e),t.warm&&(this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,this.mask_texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.R32F,this.config.mask.output_size.width,this.config.mask.output_size.height,0,this.gl.RED,this.gl.FLOAT,t.data)),!this.config.render.static){const e=this.background_canvas_ctx.getImageData(0,0,this.config.render.background.width,this.config.render.background.height).data;this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,this.background_texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.config.input.width,this.config.input.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e)}this.gl.useProgram(this.program),this.gl.drawArrays(this.gl.TRIANGLES,0,this.verts.length/3),this.postDraw()}))}load(){return __awaiter$1(this,void 0,void 0,(function*(){}))}destroy(){}}var __awaiter=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};class Pipeline{constructor(e,t,r){this.input_canvas=e,this.output_canvas=t,this.config=r,this.loaded=!1;const n=this.input_canvas.getContext("2d",{alpha:!1,willReadFrequently:!0});if(!n)throw new Error("[ladon-ts] - error getting input context 2d");this.input_ctx=n}onFrame(){return __awaiter(this,void 0,void 0,(function*(){if(!this.generator||!this.renderer)throw new Error("[ladon-ts] - pipeline is not loaded.");const e=this.input_ctx.getImageData(0,0,this.config.input.width,this.config.input.height).data;let t=e;this.config.mask.input_size.width!==this.config.input.width&&(t=resizeImage(e,this.config.input.width,this.config.input.height,this.config.mask.input_size.width,this.config.mask.input_size.height));const r=yield this.generator.getMask(t);yield this.renderer.render(e,r),yield this.generator.postRender(t)}))}isLoaded(){return this.loaded}load(){return __awaiter(this,void 0,void 0,(function*(){switch(this.config.render.type){case"blur":this.renderer=new BlurRenderer(this.output_canvas,this.config);break;case"passthrough":this.renderer=new PassthroughRenderer(this.output_canvas,this.config);break;case"replacement":this.renderer=new ReplacementRenderer(this.output_canvas,this.config);break;default:throw new Error("[ladon-ts] - renderer not implemented.")}if(yield this.renderer.load(),"passthrough"===this.config.render.type)this.generator=new NullGenerator(this.config);else switch(this.config.mask.generator){case"local":this.generator=new LocalGenerator(this.config);break;case"worker":this.generator=new WorkerGenerator(this.config);break;default:throw new Error("[ladon-ts] - generator not implemented.")}yield this.generator.load(),this.loaded=!0}))}destroy(){var e,t;null===(e=this.generator)||void 0===e||e.destroy(),null===(t=this.renderer)||void 0===t||t.destroy()}}const generateUuid=()=>String(1e17*Math.random()),getOrCreateEl=(e,t,r,n=generateUuid(),i=!1)=>{const o=`web-media-effects-${e}-${n}`;let s=document.getElementById(o);return s||(s=document.createElement(e),s.id=o,s.style.bottom="0",s.style.opacity="0",s.style.position="fixed",s.style.zIndex="-2147483647",s.style.height="0px",s.style.width="0px",s.setAttribute("height",t.toString()),s.setAttribute("width",r.toString()),i&&document.body.appendChild(s)),s},getCanvasEl=(e,t,r,n)=>getOrCreateEl("canvas",e,t,r,n),getVideoEl=(e,t,r)=>getOrCreateEl("video",e,t,r);function debounce(e,t){let r;return(...n)=>{clearTimeout(r),r=setTimeout((()=>e(...n)),t)}}const isIos=()=>{var e,t,r;return Boolean(["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(null===(e=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===e?void 0:e.platform)||(null===(r=null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.userAgent)||void 0===r?void 0:r.includes("Mac"))&&"ontouchend"in(null===globalThis||void 0===globalThis?void 0:globalThis.document))},portraitMql=()=>{var e;return null===(e=null===globalThis||void 0===globalThis?void 0:globalThis.matchMedia)||void 0===e?void 0:e.call(globalThis,"(orientation: portrait)")},drawImage=(e,t)=>{const{height:r,width:n}=e,{height:i,width:o}=t,s=t.getContext("2d");null==s||s.clearRect(0,0,o,i),null==s||s.drawImage(e,0,0,n,r,0,0,o,i)},getBackgroundConfig=(e,t=!1,r=!1)=>({type:"replacement",horizontal_mirror:r,background:e,static:!t}),loadImageFromUrl=e=>new Promise(((t,r)=>{const n=new Image;n.onload=()=>{t(n)},n.onerror=e=>r(e),n.src=e,n.crossOrigin="anonymous"})),loadVideoFromUrl=e=>new Promise(((t,r)=>{const n=getOrCreateEl("video",0,0,void 0,!0);n.onloadeddata=()=>{n.height=n.videoHeight,n.width=n.videoWidth,t(n)},n.onerror=()=>r(),n.autoplay=!0,n.playsInline=!0,n.loop=!0,n.muted=!0,n.src=e,n.crossOrigin="anonymous"}));var VirtualBackgroundMode;!function(e){e.Blur="BLUR",e.Image="IMAGE",e.Video="VIDEO"}(VirtualBackgroundMode||(VirtualBackgroundMode={}));const defaultOptions=Object.freeze({mode:VirtualBackgroundMode.Blur,blurStrength:BlurStrength.STRONG,generator:"worker",quality:Quality.LOW,authToken:"",mirror:!1}),DEFAULT_FRAME_RATE=30,omitAuthToken=e=>omitKey("authToken",e);class VirtualBackgroundEffect extends BaseCameraEffect{get isReady(){var e;return!!(null===(e=this.model)||void 0===e?void 0:e.isLoaded())}get isLoaded(){return!!this.loadFuture}get frameRate(){var e;return this.options.frameRate||(null===(e=this.trackSettings)||void 0===e?void 0:e.frameRate)||DEFAULT_FRAME_RATE}constructor(e){super(),this.defaultOptions=defaultOptions,this.uniqueId=Date.now(),this.handleOrientationChange=e=>{const t=e.matches;if(!this.trackSettings)throw new Error("virtual background: unable to determine input track settings");let{height:r,width:n}=this.trackSettings;r&&n?(logger.log("virtual background: orientation change detected",{height:r,width:n}),(t&&r<n||!t&&r>n)&&([r,n]=[n,r]),logger.log("virtual background: orientation changed to "+(t?"portrait":"landscape"),{height:r,width:n}),[this.videoEl,this.inputEl,this.outputEl,this.backgroundEl].forEach((e=>{r&&(null==e||e.setAttribute("height",r.toString())),n&&(null==e||e.setAttribute("width",n.toString()))}))):logger.log("virtual background: orientation change detected but unknown height or width",{height:r,width:n})},this.options=Object.assign(Object.assign({},defaultOptions),e),logger.log("virtual background: init effect",omitAuthToken(this.options)),this.loadModel=this.loadModel.bind(this),this.handleFrame=this.handleFrame.bind(this),this.handleOrientationChange=this.handleOrientationChange.bind(this),this.handleVideoLoadedMetadata=this.handleVideoLoadedMetadata.bind(this),this.handleVideoResize=this.handleVideoResize.bind(this)}loadMediaStream(e){const t=Object.create(null,{loadMedia:{get:()=>super.loadMedia}});return __awaiter$6(this,void 0,void 0,(function*(){logger.log("virtual background: load stream",e);const[r]=e.getVideoTracks();if(!r)throw new Error("virtual background: load stream failed, no video track found");if(yield t.loadMedia.call(this,r,e),yield this.loadDomAndModel(),!this.outputStream)throw new Error("virtual background: failed to create output stream");return logger.log("virtual background: setting new track enabled state",r.enabled),this.outputStream.getVideoTracks()[0].enabled=r.enabled,this.outputStream}))}loadMediaStreamTrack(e){const t=Object.create(null,{loadMedia:{get:()=>super.loadMedia}});return __awaiter$6(this,void 0,void 0,(function*(){if(logger.log("virtual background: load track",e),t.loadMedia.call(this,e),yield this.loadDomAndModel(),!this.outputTrack)throw new Error("virtual background: failed to create output track");return this.outputTrack}))}loadDomAndModel(){var e,t,r,n;return __awaiter$6(this,void 0,void 0,(function*(){if(!this.inputStream)throw new Error("virtual background: failed to create input stream");if(!this.loadFuture){if(this.loadFuture=new Future,yield null===(e=this.disposeFuture)||void 0===e?void 0:e.promise,this.disposeFuture=new Future,this.trackSettings=null===(t=this.inputTrack)||void 0===t?void 0:t.getSettings(),this.setupDom(),this.detectQuirks(),!this.videoEl)throw new Error("virtual background: unable to create input video element");this.videoEl.srcObject=this.inputStream;const i=null===(r=this.outputEl)||void 0===r?void 0:r.captureStream(this.frameRate);this.effectTrack=null==i?void 0:i.getVideoTracks()[0],this.requestFrame=debounce(this.handleFrame,1e3/this.frameRate);try{yield this.loadModel(),null===(n=this.requestFrame)||void 0===n||n.call(this),this.loadFuture.resolve()}catch(e){throw this.loadFuture.reject(e),e}}return this.loadFuture.promise}))}createPipeline(e){return __awaiter$6(this,void 0,void 0,(function*(){return logger.log("virtual background: creating pipeline",e),new Promise((t=>{if(!this.outputEl||!this.inputEl)throw new Error("virtual background: unable to create pipeline");const r=getConfig(this.outputEl.height,this.outputEl.width,this.options.quality,this.options.generator,e,(e=>memoizedFetchSignedUrl(`ladon${e}`,this.options.authToken,this.options.env)),"https://models.intelligence.webex.com/ladon");logger.log("virtual background: pipeline created",r),t(new Pipeline(this.inputEl,this.outputEl,r))}))}))}loadModel(){var e,t;return __awaiter$6(this,void 0,void 0,(function*(){let r;switch(logger.log("virtual background: loading model with mode:",this.options.mode),this.options.mode){case VirtualBackgroundMode.Blur:if(!this.options.blurStrength)throw new Error("virtual background: missing `blurStrength` option");r=getBlurConfig(this.options.blurStrength,this.options.mirror);break;case VirtualBackgroundMode.Image:{if(!this.options.bgImageUrl)throw new Error("virtual background: missing `bgImageUrl` option");if(!this.backgroundEl)throw new Error("virtual background: missing hidden background element");const e=yield loadImageFromUrl(this.options.bgImageUrl);r=getBackgroundConfig(this.backgroundEl,!1,this.options.mirror),drawImage(e,this.backgroundEl);break}case VirtualBackgroundMode.Video:if(!this.options.bgVideoUrl)throw new Error("virtual background: missing `bgVideoUrl` option");if(!this.backgroundEl)throw new Error("virtual background: missing hidden background element");r=getBackgroundConfig(this.backgroundEl,!0,this.options.mirror),this.virtualVideoEl=yield loadVideoFromUrl(this.options.bgVideoUrl);break;default:throw new Error("virtual background: invalid options supplied to the effect")}return null===(e=this.model)||void 0===e||e.destroy(),this.model=yield this.createPipeline(r),null===(t=this.model)||void 0===t?void 0:t.load()}))}handleFrame(){var e,t;return __awaiter$6(this,void 0,void 0,(function*(){try{if(!this.videoEl)throw new Error("virtual background: missing hidden video element");if(!this.inputEl)throw new Error("virtual background: missing input canvas element");if(!this.isEnabled)return;if(!this.isReady)return;if(drawImage(this.videoEl,this.inputEl),this.options.mode===VirtualBackgroundMode.Video){if(!this.virtualVideoEl)throw new Error("virtual background: no background video element");if(!this.backgroundEl)throw new Error("virtual background: no background element");drawImage(this.virtualVideoEl,this.backgroundEl)}yield null===(e=this.model)||void 0===e?void 0:e.onFrame()}catch(e){logger.log("virtual background: issue rendering frame")}null===(t=this.requestFrame)||void 0===t||t.call(this)}))}setupDom(){if(!this.trackSettings)throw new Error("virtual background: unable to determine input track settings");const{height:e,width:t}=this.trackSettings;if(logger.log("virtual background: track settings",this.trackSettings),logger.log("virtual background: setting up dom with dimension",{height:e,width:t}),!e||!t)throw new Error(`virtual background: missing dimensions: height=${e}, width=${t})`);this.uniqueId=Date.now(),this.videoEl=getVideoEl(e,t,this.uniqueId.toString()),this.inputEl=getCanvasEl(e,t,`input-${this.uniqueId}`),this.outputEl=getCanvasEl(e,t,`output-${this.uniqueId}`,!0),this.backgroundEl=getCanvasEl(e,t,`background-${this.uniqueId}`),this.videoEl.setAttribute("autoplay",""),this.videoEl.setAttribute("playsinline",""),this.videoEl.setAttribute("muted",""),this.videoEl.addEventListener("loadedmetadata",this.handleVideoLoadedMetadata),this.videoEl.addEventListener("resize",this.handleVideoResize,!1)}detectQuirks(){var e,t;if(null===(e=this.inputEl)||void 0===e||e.getContext("2d",{willReadFrequently:!0}),null===(t=this.outputEl)||void 0===t||t.getContext("webgl2"),isIos()){const e=portraitMql();this.handleOrientationChange(e),null==e||e.addEventListener("change",this.handleOrientationChange)}}handleVideoLoadedMetadata(){var e;return __awaiter$6(this,void 0,void 0,(function*(){yield null===(e=this.videoEl)||void 0===e?void 0:e.play()}))}handleVideoResize(){var e,t;return __awaiter$6(this,void 0,void 0,(function*(){yield null===(e=this.loadFuture)||void 0===e?void 0:e.promise;const r=this.trackSettings,n=null===(t=this.inputTrack)||void 0===t?void 0:t.getSettings();((null==n?void 0:n.width)&&(null==r?void 0:r.width)&&(null==n?void 0:n.width)!==(null==r?void 0:r.width)||(null==n?void 0:n.height)&&(null==r?void 0:r.height)&&(null==n?void 0:n.height)!==(null==r?void 0:r.height))&&(logger.log("virtual background: video resize detected",{oldSettings:r,newSettings:n}),yield this.updateSize(n.width,n.height))}))}enable(){const e=Object.create(null,{enable:{get:()=>super.enable}});var t,r,n,i,o,s;return __awaiter$6(this,void 0,void 0,(function*(){if((null===(t=this.loadFuture)||void 0===t?void 0:t.state)===FutureState.Rejected)return logger.warn("virtual background: model load failed, cannot enable effect"),!1;if((null===(r=this.loadFuture)||void 0===r?void 0:r.state)===FutureState.Pending&&(yield null===(n=this.loadFuture)||void 0===n?void 0:n.promise),logger.log("virtual background: enabling effect"),this.isReady&&this.effectTrack&&this.inputTrack)try{return yield e.enable.call(this),null===(i=this.outputStream)||void 0===i||i.removeTrack(this.inputTrack),null===(o=this.outputStream)||void 0===o||o.addTrack(this.effectTrack),null===(s=this.requestFrame)||void 0===s||s.call(this),!0}catch(e){throw this.isEnabled=!1,e}return!1}))}disable(){const e=Object.create(null,{disable:{get:()=>super.disable}});var t,r,n,i,o;return __awaiter$6(this,void 0,void 0,(function*(){if((null===(t=this.loadFuture)||void 0===t?void 0:t.state)===FutureState.Rejected&&logger.warn("virtual background: model load failed, disabling effect anyway"),(null===(r=this.loadFuture)||void 0===r?void 0:r.state)===FutureState.Pending&&(yield null===(n=this.loadFuture)||void 0===n?void 0:n.promise),logger.log("virtual background: disabling effect"),this.isReady&&this.effectTrack&&this.inputTrack)try{return yield e.disable.call(this),null===(i=this.outputStream)||void 0===i||i.removeTrack(this.effectTrack),null===(o=this.outputStream)||void 0===o||o.addTrack(this.inputTrack),!0}catch(e){throw this.isEnabled=!0,e}return!1}))}dispose(){const e=Object.create(null,{dispose:{get:()=>super.dispose}});var t,r,n,i,o,s,a,c,u,l,d,h,f,p;return __awaiter$6(this,void 0,void 0,(function*(){logger.log("virtual background: disposing effect"),(null===(t=this.loadFuture)||void 0===t?void 0:t.state)===FutureState.Rejected?logger.warn("virtual background: model load failed, cleaning up resources"):(null===(r=this.loadFuture)||void 0===r?void 0:r.state)===FutureState.Pending?this.loadFuture.reject(new Error("virtual background: loading interrupted by dispose")):(null===(n=this.loadFuture)||void 0===n?void 0:n.state)===FutureState.Resolved&&(yield this.loadFuture.promise,this.emit(EffectEvent.Disposed)),yield this.disable(),yield null===(i=this.model)||void 0===i?void 0:i.destroy(),null===(o=portraitMql())||void 0===o||o.removeEventListener("change",this.handleOrientationChange),null===(s=this.videoEl)||void 0===s||s.removeEventListener("loadedmetadata",this.handleVideoLoadedMetadata),null===(a=this.videoEl)||void 0===a||a.removeEventListener("resize",this.handleVideoResize),null===(c=this.inputEl)||void 0===c||c.remove(),null===(u=this.outputEl)||void 0===u||u.remove(),null===(l=this.videoEl)||void 0===l||l.remove(),null===(d=this.backgroundEl)||void 0===d||d.remove(),null===(h=this.virtualVideoEl)||void 0===h||h.remove(),delete this.requestFrame,delete this.model,delete this.inputEl,delete this.outputEl,delete this.videoEl,delete this.backgroundEl,delete this.virtualVideoEl;try{yield e.dispose.call(this),null===(f=this.disposeFuture)||void 0===f||f.resolve()}catch(e){throw null===(p=this.disposeFuture)||void 0===p||p.reject(e),e}this.loadFuture=void 0}))}updateOptions(e){var t,r;return __awaiter$6(this,void 0,void 0,(function*(){if((null===(t=this.loadFuture)||void 0===t?void 0:t.state)===FutureState.Pending)try{yield this.loadFuture.promise}catch(e){logger.warn("virtual background: previous loading failed, continuing with update",e)}Object.keys(e).forEach((t=>{var r;this.options[t]=null!==(r=e[t])&&void 0!==r?r:this.options[t]})),logger.log("virtual background: reloading effect with updated options",omitAuthToken(this.options)),this.loadFuture=new Future;try{yield this.loadModel(),this.loadFuture.resolve(),null===(r=this.requestFrame)||void 0===r||r.call(this)}catch(e){throw this.loadFuture.reject(e),e}}))}updateSize(e,t){var r,n;return __awaiter$6(this,void 0,void 0,(function*(){if((null===(r=this.loadFuture)||void 0===r?void 0:r.state)===FutureState.Pending)try{yield this.loadFuture.promise}catch(e){logger.warn("virtual background: previous loading failed, continuing with size update",e)}this.videoEl&&(this.videoEl.width=e,this.videoEl.height=t),this.inputEl&&(this.inputEl.width=e,this.inputEl.height=t),this.outputEl&&(this.outputEl.width=e,this.outputEl.height=t),this.backgroundEl&&(this.backgroundEl.width=e,this.backgroundEl.height=t),this.trackSettings&&(this.trackSettings.width=e,this.trackSettings.height=t),logger.log("virtual background: updating size",{width:e,height:t}),this.loadFuture=new Future;try{yield this.loadModel(),this.loadFuture.resolve(),null===(n=this.requestFrame)||void 0===n||n.call(this)}catch(e){throw this.loadFuture.reject(e),e}}))}}VirtualBackgroundEffect.kind="virtual-background-effect",VirtualBackgroundEffect.BlurStrength=BlurStrength,VirtualBackgroundEffect.Quality=Quality},25512:(e,t,r)=>{var n=r(28583);e.exports=function(e){var t,r=this,i=[].slice.call(arguments);t=e&&e.hasOwnProperty("constructor")?e.constructor:function(){return r.apply(this,arguments)},n(t,r);var o=function(){this.constructor=t};return o.prototype=r.prototype,t.prototype=new o,e&&(i.unshift(t.prototype),n.apply(null,i)),t.__super__=r.prototype,t}},90765:(e,t,r)=>{var n=r(49740),i=r(25512),o=r(1469),s=r(38169),a=r(28583),c=[].slice;function u(e,t){if(t||(t={}),t.model&&(this.model=t.model),t.comparator&&(this.comparator=t.comparator),t.parent&&(this.parent=t.parent),!this.mainIndex){var r=this.model&&this.model.prototype&&this.model.prototype.idAttribute;this.mainIndex=r||"id"}this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,a({silent:!0},t))}a(u.prototype,n,{initialize:function(){},isModel:function(e){return this.model&&e instanceof this.model},add:function(e,t){return this.set(e,a({merge:!1,add:!0,remove:!1},t))},parse:function(e,t){return e},serialize:function(){return this.map((function(e){if(e.serialize)return e.serialize();var t={};return a(t,e),delete t.collection,t}))},toJSON:function(){return this.serialize()},set:function(e,t){(t=a({add:!0,remove:!0,merge:!0},t)).parse&&(e=this.parse(e,t));var r,n,i,s,c,u,l,d=!o(e);e=d?e?[e]:[]:e.slice();var h=t.at,f=this.comparator&&null==h&&!1!==t.sort,p="string"==typeof this.comparator?this.comparator:null,m=[],g=[],v={},y=t.add,b=t.merge,E=t.remove,w=!(f||!y||!E)&&[],S=this.model&&this.model.prototype||Object.prototype;for(u=0,l=e.length;u<l;u++){if(i=e[u]||{},this.isModel(i)?r=n=i:S.generateId?r=S.generateId(i):void 0===(r=i[this.mainIndex])&&this._isDerivedIndex(S)&&(r=S._derived[this.mainIndex].fn.call(i)),s=this.get(r))E&&(v[s.cid||s[this.mainIndex]]=!0),b&&(i=i===n?n.attributes:i,t.parse&&(i=s.parse(i,t)),s.set?(s.set(i,t),f&&!c&&s.hasChanged(p)&&(c=!0)):a(s,i)),e[u]=s;else if(y){if(!(n=e[u]=this._prepareModel(i,t)))continue;m.push(n),this._addReference(n,t)}(n=s||n)&&(w&&(n.isNew&&n.isNew()||!n[this.mainIndex]||!v[n.cid||n[this.mainIndex]])&&w.push(n),v[n[this.mainIndex]]=!0)}if(E){for(u=0,l=this.length;u<l;u++)v[(n=this.models[u]).cid||n[this.mainIndex]]||g.push(n);for(g.length&&this.remove(g,t),u=0,l=m.length;u<l;u++)this._index(m[u])}if(m.length||w&&w.length)if(f&&(c=!0),null!=h)for(u=0,l=m.length;u<l;u++)this.models.splice(h+u,0,m[u]);else{var _=w||m;for(u=0,l=_.length;u<l;u++)this.models.push(_[u])}if(c&&this.sort({silent:!0}),!t.silent){for(u=0,l=m.length;u<l;u++)(n=m[u]).trigger?n.trigger("add",n,this,t):this.trigger("add",n,this,t);(c||w&&w.length)&&this.trigger("sort",this,t)}return d?e[0]:e},get:function(e,t){if(null!=e){var r=this.mainIndex,n=this._indexes[t||r];return n&&(n[e]||void 0!==e[r]&&n[e[r]])||this._indexes.cid[e]||this._indexes.cid[e.cid]}},at:function(e){return this.models[e]},remove:function(e,t){var r,n,i,s,a=!o(e);for(t||(t={}),r=0,n=(e=a?[e]:c.call(e)).length;r<n;r++)(i=e[r]=this.get(e[r]))&&(this._deIndex(i),s=this.models.indexOf(i),this.models.splice(s,1),t.silent||(t.index=s,i.trigger?i.trigger("remove",i,this,t):this.trigger("remove",i,this,t)),this._removeReference(i,t));return a?e[0]:e},reset:function(e,t){t||(t={});for(var r=0,n=this.models.length;r<n;r++)this._removeReference(this.models[r],t);return t.previousModels=this.models,this._reset(),e=this.add(e,a({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},sort:function(e){var t=this;if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),"string"==typeof this.comparator?this.models.sort((function(e,r){return e.get?(e=e.get(t.comparator),r=r.get(t.comparator)):(e=e[t.comparator],r=r[t.comparator]),e>r||void 0===e?1:e<r||void 0===r?-1:0})):1===this.comparator.length?this.models.sort((function(e,r){return(e=t.comparator(e))>(r=t.comparator(r))||void 0===e?1:e<r||void 0===r?-1:0})):this.models.sort(s(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},_reset:function(){var e=c.call(this.indexes||[]),t=0;e.push(this.mainIndex),e.push("cid");var r=e.length;for(this.models=[],this._indexes={};t<r;t++)this._indexes[e[t]]={}},_prepareModel:function(e,t){if(!this.model)return e;if(this.isModel(e))return e.collection||(e.collection=this),e;(t=t?a({},t):{}).collection=this;var r=new this.model(e,t);return r.validationError?(this.trigger("invalid",this,r.validationError,t),!1):r},_deIndex:function(e,t,r){var n;if(void 0===t)for(var i in this._indexes)n=e.hasOwnProperty(i)?e[i]:e.get&&e.get(i),delete this._indexes[i][n];else{if(void 0===this._indexes[t])throw new Error("Given attribute is not an index");delete this._indexes[t][r]}},_index:function(e,t){var r;if(void 0===t)for(var n in this._indexes)null!=(r=e.hasOwnProperty(n)?e[n]:e.get&&e.get(n))&&(this._indexes[n][r]=e);else{if(void 0===this._indexes[t])throw new Error("Given attribute is not an index");(r=e[t]||e.get&&e.get(t))&&(this._indexes[t][r]=e)}},_isDerivedIndex:function(e){return!(!e||"object"!=typeof e._derived)&&Object.keys(e._derived).indexOf(this.mainIndex)>=0},_addReference:function(e,t){this._index(e),e.collection||(e.collection=this),e.on&&e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){this===e.collection&&delete e.collection,this._deIndex(e),e.off&&e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,r,n){var i=e.split(":")[0],o=e.split(":")[1];("add"!==i&&"remove"!==i||r===this)&&("destroy"===i&&this.remove(t,n),t&&"change"===i&&o&&this._indexes[o]&&(this._deIndex(t,o,t.previousAttributes()[o]),this._index(t,o)),this.trigger.apply(this,arguments))}}),Object.defineProperties(u.prototype,{length:{get:function(){return this.models.length}},isCollection:{get:function(){return!0}}});["indexOf","lastIndexOf","every","some","forEach","map","filter","reduce","reduceRight"].forEach((function(e){u.prototype[e]=function(){return this.models[e].apply(this.models,arguments)}})),u.prototype.each=u.prototype.forEach,u.extend=i,e.exports=u},49740:(e,t,r)=>{var n=r(51463),i=r(3674),o=r(41609),s=r(28583),a=r(84486),c=Array.prototype.slice,u=r(25668),l={on:function(e,t,r){return u.eventsApi(this,"on",e,[t,r])&&t?(this._events||(this._events={}),(this._events[e]||(this._events[e]=[])).push({callback:t,context:r,ctx:r||this}),this):this},once:function(e,t,r){if(!u.eventsApi(this,"once",e,[t,r])||!t)return this;var i=this,o=n((function(){i.off(e,o),t.apply(this,arguments)}));return o._callback=t,this.on(e,o,r)},off:function(e,t,r){var n,o,s,a,c,l,d,h;if(!this._events||!u.eventsApi(this,"off",e,[t,r]))return this;if(!e&&!t&&!r)return this._events=void 0,this;for(c=0,l=(a=e?[e]:i(this._events)).length;c<l;c++)if(e=a[c],s=this._events[e]){if(this._events[e]=n=[],t||r)for(d=0,h=s.length;d<h;d++)o=s[d],(t&&t!==o.callback&&t!==o.callback._callback||r&&r!==o.context)&&n.push(o);n.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=c.call(arguments,1);if(!u.eventsApi(this,"trigger",e,t))return this;var r=this._events[e],n=this._events.all;return r&&u.triggerEvents(r,t),n&&u.triggerEvents(n,arguments),this},stopListening:function(e,t,r){var n=this._listeningTo;if(!n)return this;var i=!t&&!r;r||"object"!=typeof t||(r=this),e&&((n={})[e._listenId]=e);var s=this;return a(n,(function(e,n){e.off(t,r,s),(i||o(e._events))&&delete s._listeningTo[n]})),this},createEmitter:function(e){return s(e||{},l)},listenTo:u.createListenMethod("on"),listenToOnce:u.createListenMethod("once"),listenToAndRun:function(e,t,r){return this.listenTo.apply(this,arguments),r||"object"!=typeof t||(r=this),r.apply(this),this}};l.bind=l.on,l.unbind=l.off,l.removeListener=l.off,l.removeAllListeners=l.off,l.emit=l.trigger,e.exports=l},25668:(e,t,r)=>{var n=r(73955),i=/\s+/;t.triggerEvents=function(e,t){var r,n=-1,i=e.length,o=t[0],s=t[1],a=t[2];switch(t.length){case 0:for(;++n<i;)(r=e[n]).callback.call(r.ctx);return;case 1:for(;++n<i;)(r=e[n]).callback.call(r.ctx,o);return;case 2:for(;++n<i;)(r=e[n]).callback.call(r.ctx,o,s);return;case 3:for(;++n<i;)(r=e[n]).callback.call(r.ctx,o,s,a);return;default:for(;++n<i;)(r=e[n]).callback.apply(r.ctx,t);return}},t.eventsApi=function(e,t,r,n){if(!r)return!0;if("object"==typeof r){for(var o in r)e[t].apply(e,[o,r[o]].concat(n));return!1}if(i.test(r)){for(var s=r.split(i),a=0,c=s.length;a<c;a++)e[t].apply(e,[s[a]].concat(n));return!1}return!0},t.createListenMethod=function(e){return function(t,r,i){if(!t)throw new Error("Trying to listenTo event: '"+r+"' but the target object is undefined");if((this._listeningTo||(this._listeningTo={}))[t._listenId||(t._listenId=n("l"))]=t,i||"object"!=typeof r||(i=this),"function"!=typeof t[e])throw new Error("Trying to listenTo event: '"+r+"' on object: "+t.toString()+" but it does not have an 'on' method so is unbindable");return t[e](r,i,this),this}}},65109:(e,t,r)=>{"use strict";var n=r(73955),i=r(28583),o=function(e){return i({},e)},s=r(82723),a=r(7187),c=r(2525),u=r(64721),l=r(47037),d=r(13218),h=r(47960),f=r(23560),p=r(18446),m=r(18721),g=r(58613),v=r(93386),y=r(49740),b=r(78414),E=r(72185),w=/^change:/,S=function(){};function _(e,t){t||(t={}),this.cid||(this.cid=n("state")),this._events={},this._values={},this._eventBubblingHandlerCache={},this._definition=Object.create(this._definition),t.parse&&(e=this.parse(e,t)),this.parent=t.parent,this.collection=t.collection,this._keyTree=new b,this._initCollections(),this._initChildren(),this._cache={},this._previousAttributes={},e&&this.set(e,i({silent:!0,initial:!0},t)),this._changed={},this._derived&&this._initDerived(),!1!==t.init&&this.initialize.apply(this,arguments)}function T(e,t,r,n){var i,o,s=e._definition[t]={};if(l(r))(i=e._ensureValidType(r))&&(s.type=i);else{if(Array.isArray(r)&&(r={type:(o=r)[0],required:o[1],default:o[2]}),(i=e._ensureValidType(r.type))&&(s.type=i),r.required&&(s.required=!0),r.default&&"object"==typeof r.default)throw new TypeError("The default value for "+t+" cannot be an object/array, must be a value or a function which returns a value/object/array");s.default=r.default,s.allowNull=!!r.allowNull&&r.allowNull,r.setOnce&&(s.setOnce=!0),s.required&&void 0===s.default&&!s.setOnce&&(s.default=e._getDefaultForType(i)),s.test=r.test,s.values=r.values}return n&&(s.session=!0),i||(i=l(r)?r:r.type,console.warn("Invalid data type of `"+i+"` for `"+t+"` property. Use one of the default types or define your own")),Object.defineProperty(e,t,{set:function(e){this.set(t,e)},get:function(){if(!this._values)throw Error('You may be trying to `extend` a state object with "'+t+'" which has been defined in `props` on the object being extended');var e=this._values[t],r=this._dataTypes[s.type];if(void 0!==e)return r&&r.get&&(e=r.get(e)),e;var n=g(s,"default");(this._values[t]=n,void 0!==n)&&this._getOnChangeForType(s.type)(n,e,t);return n}}),s}function x(e,t,r){(e._derived[t]={fn:f(r)?r:r.fn,cache:!1!==r.cache,depList:r.deps||[]}).depList.forEach((function(r){e._deps[r]=v(e._deps[r]||[],[t])})),Object.defineProperty(e,t,{get:function(){return this._getDerivedProperty(t)},set:function(){throw new TypeError("`"+t+"` is a derived property, it can't be set directly.")}})}i(_.prototype,y,{extraProperties:"ignore",idAttribute:"id",namespaceAttribute:"namespace",typeAttribute:"modelType",initialize:function(){return this},getId:function(){return this[this.idAttribute]},getNamespace:function(){return this[this.namespaceAttribute]},getType:function(){return this[this.typeAttribute]},isNew:function(){return null==this.getId()},escape:function(e){return a(this.get(e))},isValid:function(e){return this._validate({},i(e||{},{validate:!0}))},parse:function(e,t){return e},serialize:function(e){var t=i({props:!0},e),r=this.getAttributes(t,!0),n=function(e,t){r[t]=this[t].serialize()}.bind(this);return c(this._children,n),c(this._collections,n),r},set:function(e,t,r){var n,i,o,s,a,c,l,h,f,p,m,v,y,b,E,w,S,_=this,T=this.extraProperties;if(d(e)||null===e?(f=e,r=t):(f={})[e]=t,r=r||{},!this._validate(f,r))return!1;v=r.unset,m=r.silent,b=r.initial,n=this._changing,this._changing=!0,i=[],b?this._previousAttributes={}:n||(this._previousAttributes=this.attributes,this._changed={});for(var x=0,A=Object.keys(f),I=A.length;x<I;x++){if(o=typeof(s=f[h=A[x]]),y=this._values[h],!(a=this._definition[h])){if(this._children[h]||this._collections[h]){d(s)||(s={}),this[h].set(s,r);continue}if("ignore"===T)continue;if("reject"===T)throw new TypeError('No "'+h+'" property defined on '+(this.type||"this")+' model and extraProperties not set to "ignore" or "allow"');if("allow"===T)a=this._createPropertyDefinition(h,"any");else if(T)throw new TypeError('Invalid value for extraProperties: "'+T+'"')}if(w=this._getCompareForType(a.type),S=this._getOnChangeForType(a.type),(p=this._dataTypes[a.type])&&p.set&&(s=(c=p.set(s)).val,o=c.type),a.test&&(l=a.test.call(this,s,o)))throw new TypeError("Property '"+h+"' failed validation with error: "+l);if(void 0===s&&a.required)throw new TypeError("Required property '"+h+"' must be of type "+a.type+". Tried to set "+s);if(null===s&&a.required&&!a.allowNull)throw new TypeError("Property '"+h+"' must be of type "+a.type+" (cannot be null). Tried to set "+s);if(a.type&&"any"!==a.type&&a.type!==o&&null!=s)throw new TypeError("Property '"+h+"' must be of type "+a.type+". Tried to set "+s);if(a.values&&!u(a.values,s)){var C=g(a,"default");if(v&&void 0!==C)s=C;else if(!v||v&&void 0!==s)throw new TypeError("Property '"+h+"' must be one of values: "+a.values.join(", ")+". Tried to set "+s)}if(E=b||!w(y,s,h),a.setOnce&&void 0!==y&&E)throw new TypeError("Property '"+h+"' can only be set once.");E?(S(s,y,h),b||(this._changed[h]=s,this._previousAttributes[h]=y,v&&delete this._values[h],m||i.push({prev:y,val:s,key:h})),v||(this._values[h]=s)):delete this._changed[h]}if(i.length&&(this._pending=!0),i.forEach((function(e){_.trigger("change:"+e.key,_,e.val,r)})),n)return this;for(;this._pending;)this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},get:function(e){return this[e]},toggle:function(e){var t=this._definition[e];if("boolean"===t.type)this[e]=!this[e];else{if(!t||!t.values)throw new TypeError("Can only toggle properties that are type `boolean` or have `values` array.");this[e]=E(t.values,this[e])}return this},previousAttributes:function(){return o(this._previousAttributes)},hasChanged:function(e){return null==e?!!Object.keys(this._changed).length:m(this._derived,e)?this._derived[e].depList.some((function(e){return this.hasChanged(e)}),this):m(this._changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&o(this._changed);var t,r,n=!1,i=this._changing?this._previousAttributes:this.attributes;for(var s in e)(r=this._definition[s])&&(this._getCompareForType(r.type)(i[s],t=e[s])||((n||(n={}))[s]=t));return n},toJSON:function(){return this.serialize()},unset:function(e,t){var r=this;(e=Array.isArray(e)?e:[e]).forEach((function(e){var n,o=r._definition[e];if(o)return o.required?(n=g(o,"default"),r.set(e,n,t)):r.set(e,n,i({},t,{unset:!0}))}))},clear:function(e){var t=this;return Object.keys(this.attributes).forEach((function(r){t.unset(r,e)})),this},previous:function(e){return null!=e&&Object.keys(this._previousAttributes).length?this._previousAttributes[e]:null},_getDefaultForType:function(e){var t=this._dataTypes[e];return t&&t.default},_getCompareForType:function(e){var t=this._dataTypes[e];return t&&t.compare?t.compare.bind(this):p},_getOnChangeForType:function(e){var t=this._dataTypes[e];return t&&t.onChange?t.onChange.bind(this):S},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=i({},this.attributes,e);var r=this.validationError=this.validate(e,t)||null;return!r||(this.trigger("invalid",this,r,i(t||{},{validationError:r})),!1)},_createPropertyDefinition:function(e,t,r){return T(this,e,t,r)},_ensureValidType:function(e){return u(["string","number","boolean","array","object","date","state","any"].concat(Object.keys(this._dataTypes)),e)?e:void 0},getAttributes:function(e,t){e=i({session:!1,props:!1,derived:!1},e||{});var r,n,o={};for(var s in this._definition)n=this._definition[s],(e.session&&n.session||e.props&&!n.session)&&(r=t?this._values[s]:this[s],t&&r&&f(r.serialize)&&(r=r.serialize()),void 0===r&&(r=g(n,"default")),void 0!==r&&(o[s]=r));if(e.derived)for(var a in this._derived)o[a]=this[a];return o},_initDerived:function(){var e=this;c(this._derived,(function(t,r){var n=e._derived[r];n.deps=n.depList;var i=function(){var t=n.fn.call(e);e._cache[r]===t&&n.cache||(n.cache&&(e._previousAttributes[r]=e._cache[r]),e._cache[r]=t,e.trigger("change:"+r,e,e._cache[r]))};n.deps.forEach((function(t){e._keyTree.add(t,i)}))})),this.on("all",(function(t){w.test(t)&&e._keyTree.get(t.split(":")[1]).forEach((function(e){e()}))}),this)},_getDerivedProperty:function(e,t){return this._derived[e].cache?(!t&&this._cache.hasOwnProperty(e)||(this._cache[e]=this._derived[e].fn.apply(this)),this._cache[e]):this._derived[e].fn.apply(this)},_initCollections:function(){var e;if(this._collections)for(e in this._collections)this._safeSet(e,new this._collections[e](null,{parent:this}))},_initChildren:function(){var e;if(this._children)for(e in this._children)this._safeSet(e,new this._children[e]({},{parent:this})),this.listenTo(this[e],"all",this._getCachedEventBubblingHandler(e))},_getCachedEventBubblingHandler:function(e){return this._eventBubblingHandlerCache[e]||(this._eventBubblingHandlerCache[e]=function(t,r,n){w.test(t)?this.trigger("change:"+e+"."+t.split(":")[1],r,n):"change"===t&&this.trigger("change",this)}.bind(this)),this._eventBubblingHandlerCache[e]},_verifyRequired:function(){var e=this.attributes;for(var t in this._definition)if(this._definition[t].required&&void 0===e[t])return!1;return!0},_safeSet:function(e,t){if(e in this)throw new Error("Encountered namespace collision while setting instance property `"+e+"`");return this[e]=t,this}}),Object.defineProperties(_.prototype,{attributes:{get:function(){return this.getAttributes({props:!0,session:!0})}},all:{get:function(){return this.getAttributes({session:!0,props:!0,derived:!0})}},isState:{get:function(){return!0},set:function(){}}});var A={string:{default:function(){return""}},date:{set:function(e){var t;if(null==e)t="object";else if(h(e))t="date",e=e.valueOf();else{var r=null,n=new Date(e).valueOf();isNaN(n)&&(n=new Date(parseInt(e,10)).valueOf(),isNaN(n)&&(r=!0)),e=n,t="date",r&&(t=typeof e)}return{val:e,type:t}},get:function(e){return null==e?e:new Date(e)},default:function(){return new Date}},array:{set:function(e){return{val:e,type:Array.isArray(e)?"array":typeof e}},default:function(){return[]}},object:{set:function(e){var t=typeof e;return"object"!==t&&void 0===e&&(e=null,t="object"),{val:e,type:t}},default:function(){return{}}},state:{set:function(e){return e instanceof _||e&&e.isState?{val:e,type:"state"}:{val:e,type:typeof e}},compare:function(e,t){return e===t},onChange:function(e,t,r){t&&this.stopListening(t,"all",this._getCachedEventBubblingHandler(r)),null!=e&&this.listenTo(e,"all",this._getCachedEventBubblingHandler(r))}}};_.extend=function(e){var t,r=this;t=e&&e.hasOwnProperty("constructor")?e.constructor:function(){return r.apply(this,arguments)},i(t,r);var n=function(){this.constructor=t};if(n.prototype=r.prototype,t.prototype=new n,t.prototype._derived=i({},r.prototype._derived),t.prototype._deps=i({},r.prototype._deps),t.prototype._definition=i({},r.prototype._definition),t.prototype._collections=i({},r.prototype._collections),t.prototype._children=i({},r.prototype._children),t.prototype._dataTypes=i({},r.prototype._dataTypes||A),e)for(var o=["dataTypes","props","session","derived","collections","children"],a=0;a<arguments.length;a++){var u=arguments[a];u.dataTypes&&c(u.dataTypes,(function(e,r){t.prototype._dataTypes[r]=e})),u.props&&c(u.props,(function(e,r){T(t.prototype,r,e)})),u.session&&c(u.session,(function(e,r){T(t.prototype,r,e,!0)})),u.derived&&c(u.derived,(function(e,r){x(t.prototype,r,e)})),u.collections&&c(u.collections,(function(e,r){t.prototype._collections[r]=e})),u.children&&c(u.children,(function(e,r){t.prototype._children[r]=e})),i(t.prototype,s(u,o))}return t.__super__=r.prototype,t},e.exports=_},72185:e=>{e.exports=function(e,t){var r=e.length,n=e.indexOf(t)+1;return n>r-1&&(n=0),e[n]}},51707:(e,t,r)=>{"use strict";r.d(t,{Lr:()=>n});r(31314),r(77193);function n(){var e=setTimeout.apply(void 0,arguments);return e.unref&&e.unref(),e}},18408:(e,t,r)=>{"use strict";r.r(t),r.d(t,{BrowserDetection:()=>He,Defer:()=>v,Exception:()=>Oe,INTERNAL_US_CLUSTER_NAME:()=>J,INTERNAL_US_INTEGRATION_CLUSTER_NAME:()=>Y,SDK_EVENT:()=>Z,base64:()=>l,buildHydraMembershipId:()=>Ye,buildHydraMessageId:()=>ze,buildHydraOrgId:()=>Je,buildHydraPersonId:()=>Ke,buildHydraRoomId:()=>We,cappedDebounce:()=>f,checkRequired:()=>p,constructHydraId:()=>$e,createEventEnvelope:()=>Q,deconstructHydraId:()=>Ze,deprecated:()=>Ne,deviceType:()=>W,ensureMyIdIsAvailable:()=>X,getBrowserSerial:()=>je,getHydraClusterString:()=>Qe,getHydraFiles:()=>et,getHydraRoomType:()=>Xe,hydraTypes:()=>K,inBrowser:()=>Pe,isBuffer:()=>o,make:()=>A,makeStateDataType:()=>y,oneFlight:()=>M,patterns:()=>U,proxyEvents:()=>j,resolveWith:()=>te,retry:()=>Se,tap:()=>_e,transferEvents:()=>V,whileInFlight:()=>Te});var n=r(83031),i=r(89509);const o=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)};function s(e){return n.decode(e).toString()}function a(e){var t=e;return o(t)||(t=i.Buffer.from(t)),n.encode(t)}function c(e){return a(e)}function u(e){return s(e)}const l={fromBase64url:s,toBase64Url:a,encode:c,decode:u,validate:function(e){return n.validate(e)}};var d=r(71544),h=r.n(d);function f(e,t,r){if(!e)throw new Error("`fn` must be a function");if(!t)throw new Error("`wait` is required");if(!(r=r||{}).maxWait)throw new Error("`options.maxWait` is required");if(!r.maxCalls)throw new Error("`options.maxCalls` is required");var n,i,o=r,s=o.maxCalls,a=o.maxWait,c=0;return function(){c+=1,clearTimeout(i),i=setTimeout((function(){return u()}),t),n||(n=setTimeout((function(){return u()}),a)),c>=s&&h()(u,this,[])};function u(){clearTimeout(i),i=null,clearTimeout(n),n=null,c=0,h()(e,this,[])}}function p(e,t){e.forEach((function(e){if(!t[e])throw new Error("missing required property ".concat(e," from ").concat(t))}))}var m=r(73473),g=r.n(m);function v(){var e=this;this.promise=new(g())((function(t,r){e.resolve=t,e.reject=r}))}function y(e,t){if(!e||!t)throw new Error("missing parameter for makeStateDataType");return{dataType:{set:function(r){return r instanceof e?(r.parent=this,{val:r,type:t}):{val:r?new e(r,{parent:this}):void 0,type:t}},compare:function(e,t){return e===t},onChange:function(e,t,r){t&&this.stopListening(t,"all",this._getCachedEventBubblingHandler(r)),e&&this.listenTo(e,"all",this._getCachedEventBubblingHandler(r))}},prop:{test:function(e){return!!e&&(e.parent=this,!1)},type:t}}}var b=r(956),E=r(8167),w=r(31314),S=r(83977),_=r.n(S),T=r(89539),x=r.n(T);function A(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t.shift(),i=new(_()),o=new(_()),s=t.length>1?A.apply(void 0,t):t[0],a="(".concat([n.name].concat(t.map((function(e){return e.name}))).join(", "),")"),c=function(){function e(){(0,E.Z)(this,e);for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];i.set(this,(0,b.Z)(n,r)),o.set(this,0)}return(0,w.Z)(e,[{key:"size",get:function(){return o.get(this)}},{key:"add",value:function(){return this.set.apply(this,arguments)}},{key:"clear",value:function(){var e=i.get(this).clear();return o.set(this,0),e}},{key:"delete",value:function(e){for(var t=i.get(this),r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];if(!n.length)return t.delete(e);var a=t.get(e);if(!a)return!1;var c=a.delete.apply(a,n);return c&&o.set(this,o.get(this)-1),0===a.size&&t.delete(e),c}},{key:"get",value:function(e){var t=i.get(this);if(!t.get)return t;for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];if(!n.length)return t.get(e);var s=t.get(e);return s?s.get?s.get.apply(s,n):s:void 0}},{key:"has",value:function(){return void 0!==this.get.apply(this,arguments)}},{key:"set",value:function(){for(var e=!1,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];this.has.apply(this,r)&&(e=!0);var a=i.get(this),c=r.shift();if(!a.get)return I.apply(void 0,[a,c].concat(r)),this;var u=a.get(c);if(!u){if(!s)return I.apply(void 0,[a,c].concat(r)),this;I(a,c,u=new s)}return I.apply(void 0,[u].concat(r)),e||o.set(this,o.get(this)+1),this}},{key:"inspect",value:function(){return"Container".concat(a," {\n  ").concat(x().inspect(i.get(this),{depth:null}),"\n}")}}]),e}();return c}function I(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(e.add)e.add.apply(e,r);else if(e.set)e.set.apply(e,r);else{if(!e.push)throw new TypeError("Could not determine how to insert into the specified container");e.push.apply(e,r)}}var C=r(13682),R=r(90359),k=r.n(R),O=r(18281),N=r.n(O),P=_(),L=N(),D=new(A(P,L,L));function M(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(3===t.length)return h()(a,null,t);var n=t[0]||{},i=n.cacheFailures,o=n.cacheSuccesses,s=n.keyFactory;return a;function a(e,t,r){var n=t;return r.value=k()(r.value,(function(t){for(var r=this,a=n,c=arguments.length,u=new Array(c>1?c-1:0),l=1;l<c;l++)u[l-1]=arguments[l];s&&(a="".concat(a,"_").concat(s.apply(void 0,u)));var d=D.get(this,e,a);return d||(d=h()(t,this,u),!i&&d&&d.catch&&(d=d.catch((function(t){return D.delete(r,e,a),g().reject(t)}))),!o&&d&&d.then&&(d=d.then((function(t){return D.delete(r,e,a),t}))),D.set(this,e,a,d),d)})),"object"!==(0,C.Z)(e)||e.prototype||(e[t]=r.value),r}}const U={email:/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,containsEmails:/(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/g,uuid:/^[a-f\d]{8}(?:-[a-f\d]{4}){3}-[a-f\d]{12}$/,containsMTID:/(MTID=)[^&$#]*/g,execEmail:/[^\s]+?@[^\s]+?/,execUuid:/[a-f\d]{8}(?:-[a-f\d]{4}){3}-[a-f\d]{12}/};var B=r(1469),F=r.n(B);function j(e,t){return["on","once"].forEach((function(r){t[r]=function(){return e[r].apply(e,arguments),t}})),e}function V(e,t,r){(e=F()(e)?e:[e]).forEach((function(e){t.on&&t.on(e,(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return H.apply(void 0,[r,e].concat(n))}))}))}function H(e){var t=e.trigger||e.emit;if(!t)throw new Error("count not determine emit method");for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return h()(t,e,n)}var G=r(66250),q=r(33453),$=r.n(q),Z={INTERNAL:{WEBEX_ACTIVITY:"event:conversation.activity",ACTIVITY_FIELD:{ACTOR:"actor",OBJECT:"object",TARGET:"target"},ACTIVITY_VERB:{ACKNOWLEDGE:"acknowledge",CARD_ACTION:"cardAction",CREATE:"create",POST:"post",SHARE:"share",DELETE:"delete",ADD:"add",LEAVE:"leave",ADD_MODERATOR:"assignModerator",REMOVE_MODERATOR:"unassignModerator",LOCK:"lock",UNLOCK:"unlock",HIDE:"hide",UPDATE:"update"},ACTIVITY_TAG:{HIDDEN:"HIDDEN",ONE_ON_ONE:"ONE_ON_ONE",LOCKED:"LOCKED"}},EXTERNAL:{EVENT_TYPE:{CREATED:"created",DELETED:"deleted",UPDATED:"updated",SEEN:"seen"},OWNER:{CREATOR:"creator",ORG:"org"},STATUS:{ACTIVE:"active",DISABLED:"disabled"},SPACE_TYPE:{DIRECT:"direct",GROUP:"group"},RESOURCE:{ATTACHMENT_ACTIONS:"attachmentActions",MEMBERSHIPS:"memberships",MESSAGES:"messages",ROOMS:"rooms"},ATTACHMENTS:{CARD_CONTENT_TYPE:"application/vnd.microsoft.card.adaptive"}}},z="unable to access window.navigator.userAgent",K={ATTACHMENT_ACTION:"ATTACHMENT_ACTION",CONTENT:"CONTENT",MEMBERSHIP:"MEMBERSHIP",MESSAGE:"MESSAGE",ORGANIZATION:"ORGANIZATION",PEOPLE:"PEOPLE",ROOM:"ROOM",TEAM:"TEAM"},W={PROVISIONAL:"PROVISIONAL",WEB:"WEB"},J="urn:TEAM:us-east-2_a",Y="urn:TEAM:us-east-1_int13";function Q(e,t){return X(e).then((function(){return g().resolve({createdBy:e.internal.me.id,orgId:e.internal.me.orgId,resource:t,ownedBy:Z.EXTERNAL.OWNER.CREATOR,status:Z.EXTERNAL.STATUS.ACTIVE,created:(new Date).toISOString(),data:{}})})).catch((function(e){g().reject(new Error("Unable to get person info for ".concat(t," event envelope: ").concat(e.message)))}))}function X(e){return ee.apply(this,arguments)}function ee(){return(ee=(0,G.Z)($().mark((function e(t){return $().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("me"in t.internal)){e.next=2;break}return e.abrupt("return",g().resolve());case 2:return e.abrupt("return",t.people.get("me").then((function(e){return t.internal.me=e,g().resolve()})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e){return function(){return g().resolve(e)}}var re=r(26243),ne=r.n(re),ie=r(62680),oe=r.n(ie),se=r(95366),ae=r.n(se),ce=r(6919),ue=r.n(ce),le=r(93364),de=r.n(le),he=r(26771),fe=r.n(he),pe=r(77193),me=r(23560),ge=r.n(me),ve=r(91747),ye=r.n(ve),be=r(17187),Ee=r(25144);function we(e,t){var r=ne()(e);if(oe()){var n=oe()(e);t&&(n=n.filter((function(t){return ae()(e,t).enumerable}))),r.push.apply(r,n)}return r}function Se(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,i=t[0]||{};return i=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?we(Object(r),!0).forEach((function(t){(0,pe.Z)(e,t,r[t])})):ue()?de()(e,ue()(r)):we(Object(r)).forEach((function(t){fe()(e,t,ae()(r,t))}))}return e}({},i),ye()(i,{backoff:!0,delay:1,maxAttempts:3}),n=i.backoff?{initialDelay:i.delay,maxDelay:i.maxDelay}:{initialDelay:1,maxDelay:1},3===t.length?h()(o,null,t):o;function o(e,t,r){return r.value=k()(r.value,(function(e){for(var t=this,r=arguments.length,o=new Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];var a=new be.EventEmitter,c=new(g())((function(r,s){var c=Ee.call((function(r){var n=h()(e,t,o);return ge()(n.on)&&(n.on("progress",a.emit.bind(a,"progress")),n.on("upload-progress",a.emit.bind(a,"upload-progress")),n.on("download-progress",a.emit.bind(a,"download-progress"))),n.then((function(e){r(null,e)})).catch((function(e){e||(e=new Error("retryable method failed without providing an error object")),r(e)}))}),(function(e,t){return e?s(e):r(t)}));c.setStrategy(new Ee.ExponentialStrategy(n)),i.maxAttempts&&c.failAfter(i.maxAttempts-1),c.start()}));return c.on=function(e,t){return a.on(e,t),c},c})),"object"!==(0,C.Z)(e)||e.prototype||(e[t]=r.value),r}}function _e(e){return function(t){return new(g())((function(r){r(e(t))})).then((function(){return t})).catch((function(){return t}))}}function Te(e){return function(t,r,n){n.value=k()(n.value,(function(t){for(var r=this,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return new(g())((function(n){r[e]=!0,n(h()(t,r,i).then(_e((function(){r[e]=!1}))).catch((function(t){return r[e]=!1,g().reject(t)})))}))}))}}var xe=r(63755),Ae=r.n(xe),Ie=r(69678),Ce=r(26305),Re=r(35002);function ke(e){var t=function(){if("undefined"==typeof Reflect||!Ae())return!1;if(Ae().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Ae()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,Re.Z)(e);if(t){var i=(0,Re.Z)(this).constructor;r=Ae()(n,arguments,i)}else r=n.apply(this,arguments);return(0,Ce.Z)(this,r)}}var Oe=function(e){(0,Ie.Z)(r,e);var t=ke(r);function r(){var e,n,i;(0,E.Z)(this,r);for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];if((e=t.call.apply(t,[this].concat(s))).parse)n=(i=e).parse.apply(i,s);else if(e.constructor.parse){var c;n=(c=e.constructor).parse.apply(c,s)}return n||(n=e.constructor.defaultMessage),e.name=e.constructor.name,e.message=n,e}return(0,w.Z)(r,null,[{key:"parse",value:function(){return arguments.length<=0?void 0:arguments[0]}}]),r}((0,r(67097).Z)(Error));(0,pe.Z)(Oe,"defaultMessage","An error occurred");r(44894);const Ne=function(){return function(){}},Pe=!0;var Le=r(88306),De=r.n(Le),Me=r(51206),Ue=r.n(Me),Be=r(58908),Fe=r.n(Be),je=function(){var e;try{var t;e=null!==Fe()&&void 0!==Fe()&&null!==(t=Fe().navigator)&&void 0!==t&&t.userAgent?Ue().getParser(Fe().navigator.userAgent):{error:z}}catch(t){e={error:t.message}}return e},Ve={getOSName:function(){return r(24753).platform()},getOSVersion:function(){return r(24753).release()},getBrowserName:function(){return""},getBrowserVersion:function(){return""},isBrowser:function(){return!1}};const He=De()((function(e){var t,r;return e||null!==(t=Fe().navigator)&&void 0!==t&&t.userAgent?(r=Ue().getParser(e||Fe().navigator.userAgent),{getOSName:function(){var e;return null!==(e=null==r?void 0:r.getOSName())&&void 0!==e?e:""},getOSVersion:function(){var e;return null!==(e=null==r?void 0:r.getOSVersion())&&void 0!==e?e:""},getBrowserName:function(){var e;return null!==(e=null==r?void 0:r.getBrowserName())&&void 0!==e?e:""},getBrowserVersion:function(){var e;return null!==(e=null==r?void 0:r.getBrowserVersion())&&void 0!==e?e:""},isBrowser:function(e){return!(null==r||!r.isBrowser(e,!0))}}):Ve}));var Ge="https://api.ciscospark.com/v1",qe=function(){throw Error("parameter is required")};function $e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qe(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qe(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"us";if(!e.toUpperCase)throw Error('"type" must be a string');return e===K.PEOPLE||e===K.ORGANIZATION?c("ciscospark://us/".concat(e.toUpperCase(),"/").concat(t)):c("ciscospark://".concat(r,"/").concat(e.toUpperCase(),"/").concat(t))}function Ze(e){var t=u(e).split("/");return{id:t.pop(),type:t.pop(),cluster:t.pop()}}function ze(e,t){return $e(K.MESSAGE,e,t)}function Ke(e,t){return $e(K.PEOPLE,e,t)}function We(e,t){return $e(K.ROOM,e,t)}function Je(e,t){return $e(K.ORGANIZATION,e,t)}function Ye(e,t,r){return $e(K.MEMBERSHIP,"".concat(e,":").concat(t),r)}function Qe(e,t){var r=e.internal.services.getClusterId(t);if(r.startsWith(J)||r.startsWith(Y))return"us";var n=r.split(":");if(n.length<3)throw Error("Unable to determine cluster for convo: ".concat(t));return"".concat(n[0],":").concat(n[1],":").concat(n[2])}function Xe(e){return e.includes(Z.INTERNAL.ACTIVITY_TAG.ONE_ON_ONE)?Z.EXTERNAL.SPACE_TYPE.DIRECT:Z.EXTERNAL.SPACE_TYPE.GROUP}function et(e,t){var r=[],n=e.object.files;if(n)for(var i=n.items,o=0;o<i.length;o+=1){var s=$e(K.CONTENT,"".concat(e.id,"/").concat(o),t);r.push("".concat(Ge,"/contents/").concat(s))}return r}},18338:(e,t,r)=>{"use strict";r.d(t,{oo:()=>$,ve:()=>Q,nK:()=>J,ce:()=>De,qY:()=>Te,Of:()=>Ne,lb:()=>Pe});var n=r(47037),i=r.n(n),o=r(91747),s=r.n(o),a=r(40087),c=r.n(a),u=r(28583),l=r.n(u),d=r(39907),h=r.n(d),f=r(79873),p=r.n(f),m=r(67857),g=r.n(m),v=r(63755),y=r.n(v),b=r(8167),E=r(31314),w=r(23710),S=r(69678),_=r(26305),T=r(35002),x=r(93364),A=r.n(x),I=r(73473),C=r.n(I),R=r(13682),k=r(77193),O=r(78718),N=r.n(O),P=r(18433),L=r.n(P),D=r(8450),M=r.n(D),U=r(18408),B=r(18428),F=r.n(B),j=r(79529),V=r.n(j);function H(e){var t=function(){if("undefined"==typeof Reflect||!y())return!1;if(y().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(y()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,T.Z)(e);if(t){var i=(0,T.Z)(this).constructor;r=y()(n,arguments,i)}else r=n.apply(this,arguments);return(0,_.Z)(this,r)}}function G(e){var t=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(e),r=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(e),n=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(r),i=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(r),o=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(r),s=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(r),a=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(r),c=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(r),u=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(r),l=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(r),d=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(r),h=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(r),f=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(r),p=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(r),m=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(r),g=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(r),v=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(r),y=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(r),w=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(r),_=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(r),T=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(e),x=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(T),A=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(T),I=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(T),C=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(T),R=function(e){(0,S.Z)(r,e);var t=H(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r)}(T);F()(e,{0:t,NetworkOrCORSError:t,400:r,BadRequest:r,401:n,Unauthorized:n,402:i,PaymentRequired:i,403:o,Forbidden:o,404:s,NotFound:s,405:a,MethodNotAllowed:a,406:c,NotAcceptable:c,407:u,ProxyAuthenticationRequired:u,408:l,RequestTimeout:l,409:d,Conflict:d,410:h,Gone:h,411:f,LengthRequired:f,412:p,PreconditionFailed:p,413:m,RequestEntityTooLarge:m,414:g,RequestUriTooLong:g,415:v,UnsupportedMediaType:v,416:y,RequestRangeNotSatisfiable:y,417:w,ExpectationFailed:w,429:_,TooManyRequests:_,500:T,InternalServerError:T,501:x,NotImplemented:x,502:A,BadGateway:A,503:I,ServiceUnavailable:I,504:C,GatewayTimeout:C,505:R,HttpVersionNotSupported:R,select:function(t){if(null==t)return e;t=t.statusCode||t;var r=e[t];return r||(t="".concat(t.toString().split("").shift(),"00"),t=V()(t,10),e[t]||e)}})}function q(e){var t=function(){if("undefined"==typeof Reflect||!y())return!1;if(y().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(y()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,T.Z)(e);if(t){var i=(0,T.Z)(this).constructor;r=y()(n,arguments,i)}else r=n.apply(this,arguments);return(0,_.Z)(this,r)}}var $=function(e){(0,S.Z)(r,e);var t=q(r);function r(){return(0,b.Z)(this,r),t.apply(this,arguments)}return(0,E.Z)(r,[{key:"parse",value:function(e){var t,r=e.body;switch((0,R.Z)(r)){case"string":try{r=JSON.parse(r),t=this.parseObject(r)}catch(e){t=r}break;case"object":t=this.parseObject(r)}return t||(t=this.defaultMessage),A()(this,{body:{enumerable:!1,value:r},httpVersion:{enumerable:!1,value:e.httpVersion},headers:{enumerable:!1,value:e.headers||{}},rawHeaders:{enumerable:!1,value:e.rawHeaders||[]},trailers:{enumerable:!1,value:e.trailers||{}},rawTrailers:{enumerable:!1,value:e.rawTrailers||[]},method:{enumerable:!1,value:e.method},url:{enumerable:!1,value:e.url},statusCode:{enumerable:!1,value:e.statusCode},statusMessage:{enumerable:!1,value:e.statusMessage},socket:{enumerable:!1,value:e.socket},_res:{enumerable:!1,value:e}}),t}},{key:"parseObject",value:function(e){var t=L()(N()(e,r.errorKeys));if(0===t.length)return M()(e,null,2);var n=t[0];return"object"===(0,R.Z)(n)?this.parseObject(n):n}}]),r}(U.Exception);(0,k.Z)($,"errorKeys",["error","errorString","response","errorResponse","message","msg"]),(0,k.Z)($,"defaultMessage","An error was received while trying to fulfill the request"),G($),$.makeSubTypes=G;var Z=r(27361),z=r.n(Z),K=r(26243),W=r.n(K),J=function(){function e(t){var r=this;(0,b.Z)(this,e),t&&W()(t).forEach((function(e){var n=t[e];p()(r,e,{enumerable:!0,value:n})}))}return(0,E.Z)(e,[{key:"logOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=z()(this,"webex.logger",console);({ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}).ENABLE_VERBOSE_NETWORK_LOGGING&&t&&(t.info("/***** Interceptor ****************************************************\\"),t.info("".concat(this.constructor.name," - ").concat(M()(e,null,2))))}},{key:"onRequest",value:function(e){return C().resolve(e)}},{key:"onRequestError",value:function(e,t){return C().reject(t)}},{key:"onResponse",value:function(e,t){return C().resolve(t)}},{key:"onResponseError",value:function(e,t){return C().reject(t)}}],[{key:"create",value:function(){throw new Error("`Interceptor.create()` must be defined")}}]),e}();function Y(e){var t=function(){if("undefined"==typeof Reflect||!y())return!1;if(y().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(y()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,T.Z)(e);if(t){var i=(0,T.Z)(this).constructor;r=y()(n,arguments,i)}else r=n.apply(this,arguments);return(0,_.Z)(this,r)}}var Q=function(e){(0,S.Z)(r,e);var t=Y(r);function r(e,n){var i;(0,b.Z)(this,r),i=t.call(this,e);var o=n&&(n.error||n.ErrorConstructor)||$;return A()((0,w.Z)(i),{ErrorConstructor:{value:o}}),i}return(0,E.Z)(r,[{key:"onResponse",value:function(e,t){if(t.statusCode){if(t.statusCode<400)return C().resolve(t);if(404===t.statusCode&&t.body&&2000002===t.body.errorCode)return C().resolve(t)}return C().reject(new(this.ErrorConstructor.select(t.statusCode))(t))}}],[{key:"create",value:function(e){return new r(this,e)}}]),r}(J),X=r(17187),ee=r(27921),te=r.n(ee),re=r(85579),ne=r.n(re),ie=r(22013),oe=r.n(ie),se=r(78149),ae=r.n(se),ce=r(66250),ue=r(1469),le=r.n(ue),de=r(33453),he=r.n(de),fe=r(80129),pe=r.n(fe),me=r(58908),ge=r(27376),ve=r(4947),ye=r(47529);function be(e,t,r){var n=e;return ge(t)?(r=t,"string"==typeof e&&(n={uri:e})):n=ye(t,{uri:e}),n.callback=r,n}function Ee(e,t,r){return we(t=be(e,t,r))}function we(e){if(void 0===e.callback)throw new Error("callback argument missing");var t=!1,r=function(r,n,i){t||(t=!0,e.callback(r,n,i))};function n(){var e=void 0;if(e=c.response?c.response:c.responseText||function(e){if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;if(""===e.responseType&&!t)return e.responseXML;return null}(c),m)try{e=JSON.parse(e)}catch(e){}return e}function i(e){var t;(clearTimeout(u),e instanceof Error)||(e=e instanceof ProgressEvent?new Error("XMLHttpRequest Error: ProgressEvent: loaded=".concat(e.loaded,", total=").concat(e.total,", lengthComputable=").concat(e.lengthComputable,", target.readyState=").concat(null===(t=e.target)||void 0===t?void 0:t.readyState)):new Error(""+(e||"Unknown XMLHttpRequest Error")));return e.statusCode=0,r(e,g)}function o(){if(!a){var t;clearTimeout(u),t=e.useXDR&&void 0===c.status?200:1223===c.status?204:c.status;var i=g,o=null;return 0!==t?(i={body:n(),statusCode:t,method:d,headers:{},url:l,rawRequest:c},c.getAllResponseHeaders&&(i.headers=ve(c.getAllResponseHeaders()))):o=new Error("Internal XMLHttpRequest Error"),r(o,i,i.body)}}var s,a,c=e.xhr||null;c||(c=e.cors||e.useXDR?new Ee.XDomainRequest:new Ee.XMLHttpRequest);var u,l=e.uri||e.url,d=e.method||"GET",h=e.body||e.data,f=e.headers||{},p=!!e.sync,m=!1,g={body:void 0,headers:{},statusCode:0,method:d,url:l,rawRequest:c};if("json"in e&&!1!==e.json&&(m=!0,f.accept||f.Accept||(f.Accept="application/json"),"GET"!==d&&"HEAD"!==d&&(f["content-type"]||f["Content-Type"]||(f["Content-Type"]="application/json"),h=M()(!0===e.json?h:e.json))),c.onreadystatechange=function(){4===c.readyState&&setTimeout(o,0)},c.onload=o,c.onerror=i,c.onprogress=function(){},c.onabort=function(){a=!0},c.ontimeout=i,c.open(d,l,!p,e.username,e.password),p||(c.withCredentials=!!e.withCredentials),!p&&e.timeout>0&&(u=setTimeout((function(){if(!a){a=!0,c.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",i(e)}}),e.timeout)),c.setRequestHeader)for(s in f)f.hasOwnProperty(s)&&c.setRequestHeader(s,f[s]);else if(e.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(c.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(c),c.send(h||null),c}Ee.XMLHttpRequest=me.XMLHttpRequest||function(){},Ee.XDomainRequest="withCredentials"in new Ee.XMLHttpRequest?Ee.XMLHttpRequest:me.XDomainRequest,function(e,t){for(var r=0;r<e.length;r+=1)t(e[r])}(["get","put","post","patch","head","delete"],(function(e){Ee["delete"===e?"del":e]=function(t,r,n){return(r=be(t,r,n)).method=e.toUpperCase(),we(r)}}));const Se=Ee;var _e=r(97769);function Te(e){return xe.apply(this,arguments)}function xe(){return(xe=(0,ce.Z)(he().mark((function e(t){var r;return he().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof Blob||t instanceof ArrayBuffer||t instanceof Uint8Array){e.next=2;break}throw new Error("`detect` requires a buffer of type Blob, ArrayBuffer, or Uint8Array");case 2:if(!(t instanceof Blob)){e.next=4;break}return e.abrupt("return",t.type);case 4:return e.next=6,(0,_e.fromBuffer)(t);case 6:if(r=e.sent){e.next=9;break}return e.abrupt("return","application/octet-stream");case 9:return e.abrupt("return",r.mime);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ae(e,t){var r=void 0!==ne()&&e[oe()]||e["@@iterator"];if(!r){if(ae()(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Ie(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return te()(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ie(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}function Ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ce(e){return new(C())((function(n){var i=N()(e,"method","uri","withCredentials","headers","timeout","responseType");i.response=!0,function(e){e.xhr=new XMLHttpRequest}(i),function(e,t){e.method&&["PATCH","POST","PUT"].includes(e.method.toUpperCase())&&(e.xhr||(e.xhr=new XMLHttpRequest),e.xhr.upload.onprogress=t.upload.emit.bind(t.upload,"progress"))}(i,e),function(e,t){if(t.auth)if(t.auth.bearer)e.headers.authorization="Bearer ".concat(t.auth.bearer);else{var r=t.auth.user||t.auth.username,n=t.auth.pass||t.auth.password,i=btoa("".concat(r,":").concat(n));e.headers.Authorization="Basic ".concat(i)}}(i,e),function(e,t){t.jar&&(e.withCredentials=!0)}(i,e),function(e,t){var r={cors:!0,withCredentials:!1,timeout:0};s()(e,N()(t,W()(r)),r)}(i,e),function(e,t){"buffer"===t.responseType&&(e.responseType="arraybuffer")}(i,e),function(e,r){t.apply(this,arguments)}(i,e),function(e,t){"json"in t&&!0!==t.json||!t.body?t.form?(e.headers["Content-Type"]="application/x-www-form-urlencoded",e.body=pe().stringify(t.form),g()(e,"json")):t.formData?e.body=W()(t.formData).reduce((function(e,n){return r(e,n,t.formData[n]),e}),new FormData):(e.body=t.body,g()(e,"json")):e.json=t.body}(i,e),function(e,t){t.qs&&(e.uri+="?".concat(pe().stringify(t.qs)))}(i,e),e.logger.debug("start http ".concat(e.method?e.method:"request"," to ").concat(e.uri));var o=Se(i,(function(t,r){t&&e.logger.warn("XHR error for ".concat(e.method||"request"," to ").concat(e.uri," :"),t),r?(r.statusCode>=400?e.logger.warn("http ".concat(e.method?e.method:"request"," to ").concat(e.uri," result: ").concat(r.statusCode)):e.logger.debug("http ".concat(e.method?e.method:"request"," to ").concat(e.uri," result: ").concat(r.statusCode)),r.options=e,function(e,t){if(!t.json&&"object"!==(0,R.Z)(e.body))try{e.body=JSON.parse(e.body)}catch(e){}}(r,i),n(r)):n({statusCode:0,options:e,headers:e.headers,method:e.method,url:e.uri,body:t})}));o.onprogress=e.download.emit.bind(e.download,"progress")})).catch((function(t){return e.logger.warn(t),{statusCode:0,options:e,headers:e.headers,method:e.method,url:e.uri,body:t}}));function t(){return(t=(0,ce.Z)(he().mark((function e(t,r){return he().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.body instanceof Blob||r.body instanceof ArrayBuffer)){e.next=8;break}if(r.json=t.json=!1,e.t0=t.headers["content-type"],e.t0){e.next=7;break}return e.next=6,Te(r.body);case 6:e.t0=e.sent;case 7:t.headers["content-type"]=e.t0;case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function r(e,t,n){if(le()(n)){var i,o=Ae(n);try{for(o.s();!(i=o.n()).done;){r(e,t,i.value)}}catch(e){o.e(e)}finally{o.f()}}else(n=function(e){if(e instanceof ArrayBuffer){var t=e.type?new Blob([e],{type:e.type}):new Blob([e]);return t.filename=e.filename||e.name||"untitled",t}return e}(n)).name?(n.filename=n.name,e.append(t,n,n.name)):e.append(t,n)}}function Re(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i="on".concat(r),o="on".concat(r,"Error");return t.reduce((function(t,r){return t.then((function(t){return r.logOptions(e),r[i]?r[i](e,t):C().resolve(t)}),(function(t){return r.logOptions(e),r[o]?r[o](e,t):C().reject(t)}))}),C().resolve(n))}function ke(){return(ke=(0,ce.Z)(he().mark((function e(t){return he().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.url&&(t.uri=t.url,t.url=null),t.headers=t.headers||{},t.json?(t.headers.accept=t.headers.accept||t.headers.Accept||"application/json","GET"!==t.method&&"HEAD"!==t.method&&(t.headers["content-type"]=t.headers["content-type"]||t.headers["Content-Type"]||"application/json",t.body=M()(!0===t.json?t.body:t.json))):void 0!==t.json&&g()(t,"json"),t.download=new X.EventEmitter,t.upload=new X.EventEmitter,t.keepalive=!0,e.abrupt("return",Re(t,t.interceptors,"Request").then((function(){return t})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}r(81763),r(7520);var Oe=c()((function(e,t){if(i()(t)){var r=t;(t=arguments[2]||{}).uri=r}return["download","interceptors","logger","upload"].forEach((function(e){var r=h()(t,e);r=l()({},r,{enumerable:!1,writable:!0}),p()(t,e,r)})),s()(t,e),t.json||!1===t.json||g()(t,"json"),t.logger=t.logger||this.logger||console,function(e){return e.url&&(e.uri=e.url,e.url=null),e.headers=e.headers||{},e.download=new X.EventEmitter,e.upload=new X.EventEmitter,Re(e,e.interceptors,"Request").then((function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Ce.apply(void 0,[e].concat(r))})).then((function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Re.apply(void 0,[e,e.interceptors.slice().reverse(),"Response"].concat(r))}))}(t)})),Ne=c()((function(e,t){return["download","interceptors","logger","upload"].forEach((function(e){var r=h()(t,e);r=l()({},r,{enumerable:!1,writable:!0}),p()(t,e,r)})),s()(t,e),t.logger=t.logger||this.logger||console,function(e){return ke.apply(this,arguments)}(t)})),Pe=function(e){var t=function(e){var t=(new Date).getTime();return e.$timings=e.$timings||{},e.$timings.requestStart=t,e.$timings.networkStart=t,e}(e);return fetch(t.uri,t)},Le={json:!0,interceptors:[Q.create()]},De=Oe;Oe(Le)},68683:(e,t,r)=>{"use strict";var n=r(18721),i=r.n(n),o=r(27361),s=r.n(o),a=r(48403),c=r.n(a),u=r(73473),l=r.n(u),d=r(67857),h=r.n(d),f=(r(33317),r(94896),r(18408)),p=r(54061),m=r.n(p),g=r(64721),v=r.n(g),y=r(84486),b=r.n(y),E=r(40087),w=r.n(E),S=r(26243),_=r.n(S);function T(e){if(e.remove)e.remove();else if(e.parentElement)e.parentElement.removeChild(e);else{if(!("length"in e))throw new Error("Could not find a way to remove node");for(var t=e.length-1;t>=0;t-=1)T(e[t])}}var x=w()((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new(l())((function(e){e(A.apply(void 0,t))}))}),4);function A(e,t,r,n){if(!n||!r||!t){if(0===n.length)return n;throw new Error("`allowedTags`, `allowedStyles`, and `html` must be provided")}var i=(new DOMParser).parseFromString(n,"text/html");return N(i.body.childNodes,(function e(n){if(!P(n))return;var i=n.nodeName.toLowerCase(),o=_()(t);if(N(n.childNodes,e),v()(o,i)){var s=t[i];b()(O(n.attributes),(function(e){if(v()(s,e)){if("href"===e||"src"===e){var t=n.attributes.getNamedItem(e).value.trim().toLowerCase();0!==t.indexOf("javascript:")&&0!==t.indexOf("vbscript:")||k(n)}else if("style"===e){var i=n.attributes.getNamedItem("style").value.split(";").map((function(e){var t=R(e.split(":")[0]);return v()(r,t)?e:null})).filter((function(e){return Boolean(e)})).join(";");n.setAttribute("style",i)}}else n.removeAttribute(e)}))}else k(n)})),e(i.body),1===n.indexOf("body")?"<body>".concat(i.body.innerHTML,"</body>"):i.body.innerHTML}function I(e,t,r,n){if(!n||!r||!t){if(0===n.length)return n;throw new Error("`allowedTags`, `allowedStyles`, and `html` must be provided")}var i=(new DOMParser).parseFromString(n,"text/html");return N(i.body.childNodes,(function e(n){if(!P(n))return;N(n.childNodes,e);var i=n.nodeName.toLowerCase(),o=_()(t);if(v()(o,i)){var s=t[i];b()(O(n.attributes),(function(e){if(v()(s,e)){if("href"===e||"src"===e){var t=n.attributes.getNamedItem(e).value.toLowerCase();0!==t.indexOf("javascript:")&&0!==t.indexOf("vbscript:")||k(n)}else if("style"===e){var i=n.attributes.getNamedItem("style").value.split(";").map((function(e){var t=R(e.split(":")[0]);return v()(r,t)?e:null})).filter((function(e){return Boolean(e)})).join(";");n.setAttribute("style",i)}}else n.removeAttribute(e)}))}else!function(e){var t=document.createTextNode("<".concat(e.nodeName.toLowerCase(),">")),r=document.createTextNode("</".concat(e.nodeName.toLowerCase(),">"));e.parentNode.insertBefore(t,e);for(;e.childNodes.length>0;)e.parentNode.insertBefore(e.childNodes[0],e);e.parentNode.insertBefore(r,e),T(e)}(n)})),e(i.body),1===n.indexOf("body")?"<body>".concat(i.body.innerHTML,"</body>"):i.body.innerHTML}var C=/^\s|\s$/g;function R(e){return e.replace(C,"")}function k(e){for(;e.childNodes.length>0;)e.parentNode.insertBefore(e.childNodes[0],e);T(e)}function O(e){return m()(e,(function(e,t){return e.push(t.name),e}),[])}function N(e,t){for(var r=e.length;r>=0;r-=1)t(e[r])}function P(e){return!!e&&(void 0!==e.ownerDocument&&(1===e.nodeType&&"string"==typeof e.nodeName))}w()(A,4);var L=w()((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new(l())((function(e){e(I.apply(void 0,t))}))}),4),D=(w()(I,4),r(47683)),M=r(62680),U=r.n(M),B=r(95366),F=r.n(B),j=r(6919),V=r.n(j),H=r(93364),G=r.n(H),q=r(26771),$=r.n(q),Z=r(27921),z=r.n(Z),K=r(85579),W=r.n(K),J=r(22013),Y=r.n(J),Q=r(78149),X=r.n(Q),ee=r(14917),te=r(21882),re=r(66250),ne=r(77193);function ie(e,t){this.v=e,this.k=t}function oe(e){return new ie(e,0)}var se=r(89448),ae=r(71922);function ce(e){var t,r;function n(t,r){try{var o=e[t](r),s=o.value,a=s instanceof ie;se.resolve(a?s.v:s).then((function(r){if(a){var c="return"===t?"return":"next";if(!s.k||r.done)return n(c,r);r=e[c](r).value}i(o.done?"return":"normal",r)}),(function(e){n("throw",e)}))}catch(e){i("throw",e)}}function i(e,i){switch(e){case"return":t.resolve({value:i,done:!0});break;case"throw":t.reject(i);break;default:t.resolve({value:i,done:!1})}(t=t.next)?n(t.key,t.arg):r=null}this._invoke=function(e,i){return new se((function(o,s){var a={key:e,arg:i,resolve:o,reject:s,next:null};r?r=r.next=a:(t=r=a,n(e,i))}))},"function"!=typeof e.return&&(this.return=void 0)}ce.prototype["function"==typeof ae&&ae.asyncIterator||"@@asyncIterator"]=function(){return this},ce.prototype.next=function(e){return this._invoke("next",e)},ce.prototype.throw=function(e){return this._invoke("throw",e)},ce.prototype.return=function(e){return this._invoke("return",e)};var ue=r(44908),le=r.n(ue),de=r(78718),he=r.n(de),fe=r(82723),pe=r.n(fe),me=r(82492),ge=r.n(me),ve=r(35161),ye=r.n(ve),be=r(10928),Ee=r.n(be),we=r(47037),Se=r.n(we),_e=r(13218),Te=r.n(_e),xe=r(1469),Ae=r.n(xe),Ie=r(91747),Ce=r.n(Ie),Re=r(53888),ke=r.n(Re),Oe=r(50361),Ne=r.n(Oe),Pe=r(33453),Le=r.n(Pe),De=r(18281),Me=r.n(De),Ue=r(8450),Be=r.n(Ue),Fe=r(18428),je=r.n(Fe),Ve=r(87735),He=r(17187),Ge=r(88010),qe=r.n(Ge),$e=r(63465),Ze=r.n($e);var ze=r(18338),Ke=r(13893);r(89509).Buffer;var We=r(97301).parse;function Je(e,t){return Ye.apply(this,arguments)}function Ye(){return(Ye=(0,re.Z)(Le().mark((function e(t,r){var n,i,o,s;return Le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||"image/jpeg"!==t.type&&"image/jpeg"!==t.mimeType){e.next=5;break}return e.next=3,We(r,{translateValues:!1});case 3:(n=e.sent)&&(i=n.Orientation,o=n.ExifImageHeight,s=n.ExifImageWidth,t.orientation=i,t.exifHeight=o,t.exifWidth=s,t.image&&(t.image.orientation=i));case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Qe=r(55877),Xe=r.n(Qe),et=r(63755),tt=r.n(et),rt=r(31314),nt=r(8167),it=r(69678),ot=r(26305),st=r(35002);function at(e){var t=function(){if("undefined"==typeof Reflect||!tt())return!1;if(tt().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(tt()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,st.Z)(e);if(t){var i=(0,st.Z)(this).constructor;r=tt()(n,arguments,i)}else r=n.apply(this,arguments);return(0,ot.Z)(this,r)}}var ct=function(e){(0,it.Z)(r,e);var t=at(r);function r(){return(0,nt.Z)(this,r),t.apply(this,arguments)}return(0,rt.Z)(r)}(function(e){(0,it.Z)(r,e);var t=at(r);function r(){return(0,nt.Z)(this,r),t.apply(this,arguments)}return(0,rt.Z)(r)}(f.Exception)),ut=r(59704),lt=r.n(ut),dt=r(63105),ht=r.n(dt),ft=r(71544),pt=r.n(ft),mt=r(77446),gt=r.n(mt),vt=r(52153),yt=r.n(vt);function bt(e,t){var r=void 0!==W()&&e[Y()]||e["@@iterator"];if(!r){if(X()(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Et(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return z()(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Et(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}function Et(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wt(e,t){var r=_()(e);if(U()){var n=U()(e);t&&(n=n.filter((function(t){return F()(e,t).enumerable}))),r.push.apply(r,n)}return r}function St(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wt(Object(r),!0).forEach((function(t){(0,ne.Z)(e,t,r[t])})):V()?G()(e,V()(r)):wt(Object(r)).forEach((function(t){$()(e,t,F()(r,t))}))}return e}var _t=W()("EMITTER_SYMBOL"),Tt=W()("FILE_SYMBOL"),xt=W()("PROMISE_SYMBOL"),At=D._y.extend({getSymbols:function(){return{file:Tt,emitter:_t}},namespace:"Conversation",derived:{target:{deps:["conversation"],fn:function(){return this.conversation}}},session:{claimedFileType:"string",conversation:{required:!0,type:"object"},content:"string",clientTempId:"string",displayName:"string",enableThumbnails:{default:!0,type:"boolean"},hiddenSpaceUrl:"object",mentions:"object",spaceUrl:"object",uploads:{type:"object",default:function(){return new(Me())}}},initialize:function(e,t){pt()(D._y.prototype.initialize,this,[e,t]),e&&e.conversation&&(this.spaceUrl=l().resolve(e.conversation._spaceUrl||this._retrieveSpaceUrl("".concat(e.conversation.url,"/space")).then((function(t){return e.conversation._spaceUrl=t,t}))),this.hiddenSpaceUrl=l().resolve(e.conversation._hiddenSpaceUrl||this._retrieveSpaceUrl("".concat(e.conversation.url,"/space/hidden")).then((function(t){return e.conversation._hiddenSpaceUrl=t,t}))))},addGif:function(e,t){var r=this.uploads.get(e);return r?l().resolve():(r=St((0,ne.Z)({displayName:e.name,fileSize:e.size||e.byteLength||e.length,mimeType:e.type,url:"https://giphy.com",objectType:"file",height:e.height,width:e.width,image:{height:e.image.height,width:e.image.width,url:"https://giphy.com"}},Tt,e),he()(t,"actions")),this.uploads.set(e,r),gt().create().then((function(t){return t.loc=e.url,r.scr=t,gt().create()})).then((function(t){t.loc=e.image.url,r.image.scr=t})))},add:function(e,t){var r=this;(t=t||{}).claimedFileType=e.name.substring(e.name.lastIndexOf("."));var n=this.uploads.get(e);if(n)return n[xt];var i=new He.EventEmitter;n=St((0,ne.Z)((0,ne.Z)({displayName:e.name,fileSize:e.size||e.byteLength||e.length,mimeType:e.type,objectType:"file"},_t,i),Tt,e),he()(t,"actions")),this.uploads.set(e,n);var o=function(e,t){return e.type?(t.info("file already has type ".concat(e.type,". using existing file.type.")),l().resolve(e.type)):e.mimeType?(t.info("file already has mimeType ".concat(e.type,". using existing file.mimeType.")),l().resolve(e.mimeType)):(0,ze.qY)(e).then((function(r){return"application/x-msi"===r||"application/octet-stream"===r?(t.info("detected filetype to be ".concat(r,". Falling back to mime.lookup")),(0,Ke.getType)(e.name)):(t.info("detected filetype to be ".concat(r,". returning it")),r)}))}(e,this.logger).then((function(t){return n.mimeType=t,function(e){var t=e.file,r=e.type,n=e.thumbnailMaxWidth,i=e.thumbnailMaxHeight,o=e.enableThumbnails,s=e.logger,a=e.isAvatar;return r&&r.startsWith("image")?(t=t instanceof Blob?t:new Blob([t]),new(l())((function(e,r){var n=new Image;n.onload=function(){e(n)},n.onerror=r,n.src=URL.createObjectURL(t)})).then((function(e){var r=he()(e,"height","width");if(a){s.info("dimensions will be set for avatar image");var c=r.height>r.width?r.height:r.width;r.height=c,r.width=c}if(!o)return s.info("thumbnails not enabled"),[null,r,null];var u=function(e,t,r){var n=e.width,i=e.height;return i>n?(i>r&&(n=n*r/i,i=r),n>t&&(i=i*t/n,n=t)):(n>t&&(i=i*t/n,n=t),i>r&&(n=n*r/i,i=r)),{height:i,width:n}}(r,n,i),l=document.createElement("canvas"),d=l.getContext("2d"),h=u.width,f=u.height;t.orientation&&t.orientation>4?(l.width=f,l.height=h,u.width=f,u.height=h):(l.width=u.width,l.height=u.height),function(e,t){var r=e.width,n=e.height,i=e.ctx,o=e.img,s=e.orientation,a=e.x,c=e.y;if(t&&t.orientation&&1!==t.orientation)switch(s){case 2:i.transform(-1,0,0,1,r,0);break;case 3:i.transform(-1,0,0,-1,r,n);break;case 4:i.transform(1,0,0,-1,0,n);break;case 5:i.transform(0,1,1,0,0,0);break;case 6:i.transform(0,1,-1,0,n,0);break;case 7:i.transform(0,-1,-1,0,n,r);break;case 8:i.transform(0,-1,1,0,0,r)}i.drawImage(o,a,c,r,n)}({orientation:t&&t.orientation?t.orientation:"",img:e,x:0,y:0,width:h,height:f,ctx:d},t);for(var p=l.toDataURL("image/png").split(","),m=atob(p[1]),g=new ArrayBuffer(m.length),v=new DataView(g),y=0;y<m.length;y+=1)v.setUint8(y,m.charCodeAt(y));return[g,r,u]}))):l().resolve()}({file:e,type:t,thumbnailMaxWidth:r.config.thumbnailMaxWidth,thumbnailMaxHeight:r.config.thumbnailMaxHeight,enableThumbnails:r.enableThumbnails,logger:r.logger})})).then((function(o){var s,a=r.webex.internal.encryption.encryptBinary(e).then((function(e){var t=e.scr,i=e.cdata;return n.scr=t,l().all([i,r.spaceUrl])})).then((function(e){var n=(0,ee.Z)(e,2),o=n[0],s=n[1],a=r._upload(o,"".concat(s,"/upload_sessions"),t);return(0,f.transferEvents)("progress",a,i),a})).then((function(e){n.url=n.scr.loc=e.downloadUrl}));if(o){var c=(0,ee.Z)(o,3),u=c[0],d=c[1],h=c[2];je()(n,d),u&&h&&(n.image=h,s=r.webex.internal.encryption.encryptBinary(u).then((function(e){var t=e.scr,i=e.cdata;return n.image.scr=t,l().all([i,r.hiddenSpaceUrl])})).then((function(e){var t=(0,ee.Z)(e,2),n=t[0],i=t[1];return r._upload(n,"".concat(i,"/upload_sessions"))})).then((function(e){n.image.url=n.image.scr.loc=e.downloadUrl})))}return l().all([a,s])}));return n[xt]=o,(0,f.proxyEvents)(i,o),o},getFiles:function(){var e,t=[],r=bt(this.uploads);try{for(r.s();!(e=r.n()).done;){var n=(0,ee.Z)(e.value,1)[0];t.push(this.uploads.get(n)[Tt])}}catch(e){r.e(e)}finally{r.f()}return t},_upload:function(e,t,r){var n=e.length||e.size||e.byteLength,i=yt()(e).toString(),o=null!=r?r:{},s=o.role,a=St({fileSize:n,claimedFileType:o.claimedFileType},s&&{role:s});return this.webex.upload({uri:t,file:e,qs:{transcode:!0},phases:{initialize:{body:a},upload:{$url:function(e){return e.uploadUrl}},finalize:{$uri:function(e){return e.finishUploadUrl},body:{fileSize:n,fileHash:i}}}})},remove:function(e){return this.uploads.delete(e),l().resolve()},prepare:function(){if(!this.uploads.size)throw new Error("Cannot submit a share activity without at least one file");var e={verb:"share",object:{objectType:"content",displayName:this.object&&this.object.displayName?this.object.displayName:void 0,content:this.object&&this.object.content?this.object.content:void 0,mentions:this.object&&this.object.mentions?this.object.mentions:void 0,files:{items:[]}},clientTempId:this.clientTempId},t=[];return this.uploads.forEach((function(r){e.object.files.items.push(r),t.push(r[xt])})),e.object.contentCategory=this._determineContentCategory(e.object.files.items),l().all(t).then((function(){return e}))},_itemContainsActionWithMimeType:function(e,t){return lt()(e.map((function(e){return lt()(e.actions,{mimeType:t})})))},_determineContentCategory:function(e){if(this._itemContainsActionWithMimeType(e,"application/x-cisco-webex-whiteboard"))return"documents";var t=ht()(ye()(e,"mimeType"));if(t.length!==e.length)return"documents";var r=t[0].split("/").shift();if("video"!==r&&"image"!==r)return"documents";var n,i=bt(t);try{for(i.s();!(n=i.n()).done;){if(n.value.split("/").shift()!==r)return"documents"}}catch(e){i.e(e)}finally{i.f()}return"".concat(r,"s")},_retrieveSpaceUrl:function(e){return this.webex.request({method:"PUT",uri:e}).then((function(e){return e.body.spaceUrl}))},version:"0.0.0-next"});At.create=function(e,t,r){var n,i,o,s;if(t instanceof At)return t;null!=t&&null!==(n=t.object)&&void 0!==n&&n.files&&(s=t.object.files,h()(t.object,"files"));var a=new At(St({conversation:e},t),{parent:r});return(s=null!==(i=null===(o=s)||void 0===o?void 0:o.items)&&void 0!==i?i:s)&&s.forEach((function(e){return a.add(e)})),a};const It=At;var Ct=r(89734),Rt=r.n(Ct);function kt(e,t){var r=_()(e);if(U()){var n=U()(e);t&&(n=n.filter((function(t){return F()(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ot(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?kt(Object(r),!0).forEach((function(t){(0,ne.Z)(e,t,r[t])})):V()?G()(e,V()(r)):kt(Object(r)).forEach((function(t){$()(e,t,F()(r,t))}))}return e}var Nt="older",Pt="newer",Lt="mid",Dt="initial",Mt="REPLY",Ut="EDIT",Bt="REACTION",Ft="REACTION_SELF",jt="ROOT",Vt="CREATE",Ht="TOMBSTONE",Gt="DELETE",qt="REPLY_EDIT",$t=function(e){var t,r;return"reply"===(null===(t=e.parent)||void 0===t?void 0:t.type)?Mt:"edit"===(null===(r=e.parent)||void 0===r?void 0:r.type)?Ut:"add"===e.verb||"reactionSummary"===e.type?Bt:"reactionSelfSummary"===e.type?Ft:"create"===e.verb?Vt:"tombstone"===e.verb?Ht:"delete"===e.verb?Gt:jt},Zt=function(){return new Date((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).published).getTime()},zt=function(e,t){return Zt(e)>Zt(t)},Kt=function(e){return Rt()(e,(function(e){return Zt(e)}))},Wt=function(e){var t;return null==e||null===(t=e.parent)||void 0===t?void 0:t.id},Jt=function(e){var t=Ot({},e);return t.reaction=e.reaction||{},t.reactionSelf=e.reactionSelf||{},delete t.replies,t},Yt=function(e,t){var r=t[e.parent.id];return r&&$t(r)===Mt},Qt=function(e,t,r){return e.set(t,r)},Xt=function(e,t){return e.get(t)},er=function(e){return z()(e).map((function(e){return(0,ee.Z)(e,2)[1]}))},tr=function(){var e=new(Me()),t=new(Me()),r=new(Me()),n=new(Me()),i=function(t){var r=Wt(t),n=Xt(e,r);if(n)Qt(n,t.id,t);else{var i=new(Me());Qt(i,t.id,t),Qt(e,r,i)}},o=function(e){if(!(e.verb===Ht)){var r=Wt(e),n=Xt(t,r);n&&!zt(e,n)||Qt(t,r,e)}},s=function(e,t){var r=Wt(e),n=Xt(t,r);n&&!zt(e,n)||Qt(t,r,e)},a=function(e){s(e,r)},c=function(e){s(e,n)};return{getActivityHandlerByKey:function(e){return(0,ne.Z)((0,ne.Z)((0,ne.Z)((0,ne.Z)({},Bt,a),Ft,c),Ut,o),Mt,i)[e]},getActivityByTypeAndParentId:function(i,o){return(0,ne.Z)((0,ne.Z)((0,ne.Z)((0,ne.Z)({},Ut,Xt(t,o)),Mt,Xt(e,o)),Bt,Xt(r,o)),Ft,Xt(n,o))[i]}}},rr=function(){var e,t;return{setBookends:function(r){var n,i=Kt(r),o=Ee()(i),s=i[0];n=s,e?zt(e,n)&&(e=n):e=n,function(e){t?zt(e,t)&&(t=e):t=e}(o)},getNewestAct:function(){return t},getOldestAct:function(){return e}}},nr=function(){var e=!1,t=!1,r=!1;return{getNoMoreActs:function(){return e},checkAndSetNoMoreActs:function(n,i,o){(n===Pt&&r||(n===Nt||n===Dt)&&t||n===Lt&&i<o&&t)&&(e=!0)},checkAndSetNoNewerActs:function(e){e&&e.length||(r=!0)},checkAndSetNoOlderActs:function(e){t||$t(e)!==Vt||(t=!0)}}},ir=function(){var e=new(Me());return{addNewRoot:function(t){Qt(e,t.id,t)},getRootActivityHash:function(){return e}}},or=function(){var e=0;return function(){if((e+=1)>100)throw new Error("max fetches reached")}},sr=function(e,t){var r=t.newestPublishedDate,n=t.oldestPublishedDate,i=t.batchSize,o=t.activityToSearch,s=void 0===o?{}:o;switch(e){case Pt:return{sinceDate:r+1,lastActivityFirst:!1};case Lt:var a=$t(s);return{midDate:a===Mt||a===Ut?s.parent.published:s.published,limit:i};case Nt:return{maxDate:n-1};default:return{}}};function ar(e,t){var r=void 0!==W()&&e[Y()]||e["@@iterator"];if(!r){if(X()(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return cr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return z()(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cr(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}function cr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ur(e,t){var r=_()(e);if(U()){var n=U()(e);t&&(n=n.filter((function(t){return F()(e,t).enumerable}))),r.push.apply(r,n)}return r}function lr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ur(Object(r),!0).forEach((function(t){(0,ne.Z)(e,t,r[t])})):V()?G()(e,V()(r)):ur(Object(r)).forEach((function(t){$()(e,t,F()(r,t))}))}return e}var dr=new(Me()),hr=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.conversationsLimit&&(e={value:t.conversationsLimit,name:"conversationsLimit"}),e},fr=D._y.extend({namespace:"Conversation",getUrlFromClusterId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.cluster,r=void 0===t?"us":t,n=e.id,i=this.webex.internal.services.getServiceUrlFromClusterId({cluster:r},this.webex);return n?"".concat(i,"/conversations/").concat(n):i},acknowledge:function(e,t,r){var n=this,i=this.getConvoUrl(e),o=lr(lr({},e),{},{url:i});return Te()(t)?this.prepare(r,{verb:"acknowledge",target:this.prepareConversation(o),object:{objectType:"activity",id:t.id,url:t.url}}).then((function(e){return n.submit(e)})):l().reject(new Error("`object` must be an object"))},add:function(e,t,r){var n=this,i=this.getConvoUrl(e),o=lr(lr({},e),{},{url:i});return this.webex.internal.user.asUUID(t,{create:!0}).then((function(e){return n.prepare(r,{verb:"add",target:n.prepareConversation(o),object:{id:e,objectType:"person"},kmsMessage:{method:"create",uri:"/authorizations",resourceUri:"<KRO>",userIds:[e]}}).then((function(e){return n.submit(e)}))}))},create:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.participants&&0!==e.participants.length?l().all(e.participants.map((function(e){return t.webex.internal.user.asUUID(e,{create:!0}).catch((function(e){return r.allowPartialCreation?void 0:l().reject(e)}))}))).then((function(n){n.unshift(t.webex.internal.device.userId);var i=(n=le()(n)).filter((function(e){return e}));return e.participants=i,2!==n.length||r&&r.forceGrouped?t._createGrouped(e,r):e.participants[1]?r.skipOneOnOneFetch?t._createOneOnOne(e):t._maybeCreateOneOnOneThenPost(e,r):l().reject(new ct)})).then((function(r){return dr.set(r.id,r.url),e.files?t.webex.internal.conversation.share(r,e.files).then((function(e){return r.activities.items.push(e),r})):r})):l().reject(new Error("`params.participants` is required"))},createReactionHmac:function(e,t){return this.webex.internal.encryption.unboundedStorage.get(t.encryptionKeyUrl).then((function(r){var n=JSON.parse(r),i={k:n.jwk.k,kid:n.jwk.kid,kty:n.jwk.kty},o="".concat(Be()(i)).concat(t.id).concat(e),s=Ze().stringify(qe()(o,t.id));return l().resolve(s)}))},sendReaction:function(e,t){var r=this,n=this.getConvoUrl(e),i=lr(lr({},e),{},{url:n});return Te()(t)?this.prepare(t,{target:this.prepareConversation(i),object:he()(t,"id","url","objectType")}).then((function(e){return r.submit(e)})):l().reject(new Error("`object` must be an object"))},deleteReaction:function(e,t,r){var n={actor:{objectType:"person",id:this.webex.internal.device.userId},object:{id:t,objectType:"activity"},objectType:"activity",target:{id:e.id,objectType:"conversation"},verb:"delete"};return r&&(n.recipients={items:[{id:r,objectType:"person"}]}),this.sendReaction(e,n)},addReaction:function(e,t,r,n){var i=this;return this.createReactionHmac(t,r).then((function(o){var s={actor:{objectType:"person",id:i.webex.internal.device.userId},target:{id:e.id,objectType:"conversation"},verb:"add",objectType:"activity",parent:{type:"reaction",id:r.id},object:{objectType:"reaction2",displayName:t,hmac:o}};return n&&(s.recipients={items:[{id:n,objectType:"person"}]}),i.sendReaction(e,s)}))},delete:function(e,t,r){var n=this,i=this.getConvoUrl(e),o=lr(lr({},e),{},{url:i});if(!Te()(t))return l().reject(new Error("`object` must be an object"));var s={verb:"delete",target:this.prepareConversation(o),object:he()(t,"id","url","objectType")};return"meetingContainer"===t.object.objectType&&(s.target.kmsResourceObjectUrl=t.object.kmsResourceObjectUrl,s.kmsMessage={method:"delete",uri:"<KRO>/authorizations?".concat(Ve.stringify({authId:o.kmsResourceObjectUrl}))}),this.prepare(r,s).then((function(e){return n.submit(e)}))},download:function(e){var t,r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=Boolean(e.scr&&e.scr.key),o=new He.EventEmitter;return t=(t=i?this.webex.internal.encryption.download(e.url,e.scr,e.options):this._downloadUnencryptedFile(e.url,n)).on("progress",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o.emit.apply(o,["progress"].concat(t))})).then((function(t){return n.shouldNotAddExifData?t:Je(e,t)})).then((function(t){return r.logger.info("conversation: file downloaded"),e.displayName&&!t.name&&(t.name=e.displayName),!t.type&&e.mimeType&&(t.type=e.mimeType),t})),(0,f.proxyEvents)(o,t),t},_downloadUnencryptedFile:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};je()(t,{uri:e,responseType:"buffer"});var r=this.request(t).then((function(e){return e.body}));return(0,f.proxyEvents)(t.download,r),r},expand:function(e,t,r,n){var i={actor:n,objectType:"activity",verb:e};return n||(n=this.webex.internal.device.userId),Se()(n)&&(i.actor={objectType:"person",id:n}),t&&(i.object=t),r&&(i.target=r),i},bulkActivitiesFetch:function(e){var t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"string"==typeof n?t=n:(t=n.cluster,r=n.url);var i="bulk_activities_fetch",o={method:"POST",body:{activityUrls:e}};if(r){var s="".concat(r,"/").concat(i);je()(o,{uri:s})}else if(t){var a="".concat(this.getUrlFromClusterId({cluster:t}),"/").concat(i);je()(o,{uri:a})}else je()(o,{api:"conversation",resource:i});return this.webex.request(o).then((function(e){var t=[];return e.body.multistatus&&e.body.multistatus.forEach((function(e){"200"===e.status&&e.data&&e.data.activity&&t.push(e.data.activity)})),t}))},get:function(e){var t,r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.user;try{t=i?"":this.getConvoUrl(e)}catch(e){return l().reject(Error(e))}var o={qs:lr({uuidEntryFormat:!0,personRefresh:!0,activitiesLimit:0,includeConvWithDeletedUserUUID:!1,includeParticipants:!1},pe()(n,"id","user","url")),disableTransform:n.disableTransform};return("participantAckFilter"in n||"participantsLimit"in n)&&delete o.qs.includeParticipants,l().resolve(i?this.webex.internal.user.asUUID(i):null).then((function(e){return e?je()(o,{service:"conversation",resource:"conversations/user/".concat(e)}):o.uri=t,r.request(o)})).then((0,f.tap)((function(e){var t=e.body,n=t.id,i=t.url;r._recordUUIDs(t),dr.set(n,i)}))).then((function(e){return e.body}))},leave:function(e,t,r){var n=this,i=lr(lr({},e),{},{url:this.getConvoUrl(e)});return l().resolve().then((function(){return t||(t=n.webex.internal.device.userId),n.webex.internal.user.asUUID(t).then((function(e){return n.prepare(r,{verb:"leave",target:n.prepareConversation(i),object:{id:e,objectType:"person"},kmsMessage:{method:"delete",uri:"<KRO>/authorizations?".concat(Ve.stringify({authId:e}))}})}))})).then((function(e){return n.submit(e)}))},list:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._list({service:"conversation",resource:e.summary?"conversationsSummary":"conversations",qs:pe()(e,["deferDecrypt","summary"]),deferDecrypt:e.deferDecrypt,limit:hr(e)}).then((function(e){var t,r=ar(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;dr.set(n.id,n.url)}}catch(e){r.e(e)}finally{r.f()}return e}))},paginate:function(){var e=arguments,t=this;return(0,re.Z)(Le().mark((function r(){var n,i,o;return Le().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(n=e.length>0&&void 0!==e[0]?e[0]:{}).page){r.next=5;break}if(n.page.links&&n.page.links.next){r.next=4;break}throw new Error("No link to follow for the provided page");case 4:return r.abrupt("return",t.request({url:n.page.links.next}).then((function(e){return{page:new D.T3(e,t.webex)}})));case 5:return i=lr({personRefresh:!0,uuidEntryFormat:!0,activitiesLimit:0,participantsLimit:0,paginate:!0},pe()(n,["deferDecrypt","url"])),o={qs:i,deferDecrypt:n.deferDecrypt,limit:hr(n)},n.url?o.uri="".concat(n.url,"/conversations"):(o.service="conversation",o.resource="conversations"),r.abrupt("return",t.request(o).then((function(e){var r={page:new D.T3(e,t.webex)};return e.body&&e.body.additionalUrls&&(r.additionalUrls=e.body.additionalUrls),r})));case 9:case"end":return r.stop()}}),r)})))()},listLeft:function(e){return this._list({service:"conversation",resource:"conversations/left",qs:e,limit:hr(e)}).then((function(e){var t,r=ar(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;dr.set(n.id,n.url)}}catch(e){r.e(e)}finally{r.f()}return e}))},listActivities:function(e){return this._listActivities(je()(e,{resource:"activities"}))},listParentActivityIds:function(e,t){var r=this;return(0,re.Z)(Le().mark((function n(){var i,o;return Le().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i={method:"GET",url:"".concat(e,"/parents"),qs:t},n.next=3,r.request(i);case 3:return o=n.sent,n.abrupt("return",o.body);case 5:case"end":return n.stop()}}),n)})))()},listAllChildActivitiesByParentId:function(){var e=arguments,t=this;return(0,re.Z)(Le().mark((function r(){var n,i,o,s,a,c,u,l,d,h,f;return Le().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=(n=e.length>0&&void 0!==e[0]?e[0]:{}).conversationUrl,o=n.activityParentId,s=n.query,a=s.activityType,r.next=5,t.listChildActivitiesByParentId(i,o,a,s);case 5:c=r.sent,u=new D.T3(c,t.webex),l=(0,te.Z)(u.items);case 8:if(!u.hasNext()){r.next=16;break}return r.next=11,u.next();case 11:u=r.sent,d=ar(u);try{for(d.s();!(h=d.n()).done;)f=h.value,l.push(f)}catch(e){d.e(e)}finally{d.f()}r.next=8;break;case 16:return l.length&&Ee()(l).published<l[0].published&&l.reverse(),r.abrupt("return",l);case 18:case"end":return r.stop()}}),r)})))()},listChildActivitiesByParentId:function(e,t,r){var n=arguments,i=this;return(0,re.Z)(Le().mark((function o(){var s,a;return Le().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return s=lr(lr({},n.length>3&&void 0!==n[3]?n[3]:{}),{},{activityType:r}),a={method:"GET",url:"".concat(e,"/parents/").concat(t),qs:s},o.abrupt("return",i.request(a));case 4:case"end":return o.stop()}}),o)})))()},getReactionSummaryByParentId:function(e,t,r){var n=this;return(0,re.Z)(Le().mark((function i(){var o,s,a;return Le().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,n.request({method:"GET",url:"".concat(e,"/activities/").concat(t),qs:r});case 2:return o=i.sent,s=o.body,a=s.children?s.children.filter((function(e){return"reactionSelfSummary"===e.type||"reactionSummary"===e.type})):[],i.abrupt("return",a);case 6:case"end":return i.stop()}}),i)})))()},listMentions:function(e){return this._list({service:"conversation",resource:"mentions",qs:pe()(e,"mentions")})},muteMentions:function(e,t){return this.tag(e,{tags:["MENTION_NOTIFICATIONS_OFF"]},t)},muteMessages:function(e,t){return this.tag(e,{tags:["MESSAGE_NOTIFICATIONS_OFF"]},t)},ignore:function(e,t){return this.tag(e,{tags:["IGNORED"]},t)},cardAction:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=lr(lr({},e),{},{url:this.getConvoUrl(e)});return i.parent={id:r.id,type:"cardAction"},this.prepare(i,{verb:"cardAction",target:this.prepareConversation(o),object:lr({objectType:"submit"},t)}).then((function(e){return n.submit(e)}))},post:function(e,t,r){var n=this,i=lr(lr({},e),{},{url:this.getConvoUrl(e)});return Se()(t)&&(t={displayName:t}),this.prepare(r,{verb:"post",target:this.prepareConversation(i),object:lr({objectType:"comment"},t)}).then((function(e){return n.submit(e)}))},prepareConversation:function(e){return Ce()(he()(e,"id","url","objectType","defaultActivityEncryptionKeyUrl","kmsResourceObjectUrl"),{objectType:"conversation"})},prepare:function(e,t){var r=this;return t=t||{},e=e||{},l().resolve(e.prepare?e.prepare(t):e).then((function(n){return Ce()(n,{verb:t.verb,kmsMessage:t.kmsMessage,objectType:"activity",clientTempId:Xe().v4(),actor:r.webex.internal.device.userId}),(e.parentActivityId&&e.activityType||e.parent&&e.parent.id&&e.parent.type)&&(n.parent={id:e.parentActivityId||e.parent.id,type:e.activityType||e.parent.type}),e.recipients&&(n.recipients=e.recipients),Se()(n.actor)&&(n.actor={objectType:"person",id:n.actor}),["actor","object"].forEach((function(e){t[e]&&(n[e]=n[e]||{},Ce()(n[e],t[e]))})),t.target&&ge()(n,{target:he()(t.target,"id","url","objectType","kmsResourceObjectUrl","defaultActivityEncryptionKeyUrl")}),["object","target"].forEach((function(e){n[e]&&n[e].url&&!n[e].id&&(n[e].id=n[e].url.split("/").pop())})),["actor","object","target"].forEach((function(e){if(n[e]&&!n[e].objectType)throw new Error("`act.".concat(e,".objectType` must be defined"))})),n.object&&n.object.content&&!n.object.displayName?l().reject(new Error("Cannot submit activity object with `content` but no `displayName`")):n}))},listThreads:function(e){var t=this;return(0,re.Z)(Le().mark((function r(){return Le().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",t._list({service:"conversation",resource:"threads",qs:pe()(e,"showAllTypes")}));case 1:case"end":return r.stop()}}),r)})))()},processActivityEvent:function(e){return this.webex.transform("inbound",e).then((function(){return e}))},processInmeetingchatEvent:function(e){return this.webex.transform("inbound",e).then((function(){return e}))},removeAllMuteTags:function(e,t){return this.untag(e,{tags:["MENTION_NOTIFICATIONS_OFF","MENTION_NOTIFICATIONS_ON","MESSAGE_NOTIFICATIONS_OFF","MESSAGE_NOTIFICATIONS_ON"]},t)},makeShare:function(e,t){return It.create(e,t,this.webex)},assign:function(e,t){var r=this,n={role:"spaceAvatar"};if((t.size||t.length)>1048576)return l().reject(new Error("Room avatars must be less than 1MB"));var i=lr(lr({},e),{},{url:this.getConvoUrl(e)});return l().resolve().then((function(){var o=It.create(e,null,r.webex);return o.enableThumbnails=!1,o.add(t,n),r.prepare(o,{target:r.prepareConversation(i)})})).then((function(e){return e.verb="assign",r.submit(e)}))},getConvoUrl:function(e){var t=e.id,r=e.url,n=e.cluster,i=e.conversations,o=e.generalConversationUuid;if(o)return i.items.find((function(e){return e.id===o})).url;if(r)return r;if(t){if(n)return this.getUrlFromClusterId({cluster:n,id:t});this.logger.warn("You should be using the `url` instead of the `id` property");var s=dr.get(t);if(!s)throw Error("Could not find the `url` from the given `id`");return s}throw Error("The space needs a `url` property")},updateTypingStatus:function(e,t){if(!e.id){if(!e.url)return l().reject(new Error("conversation: could not identify conversation"));e.id=e.url.split("/").pop()}var r;r=t.typing?"status.start_typing":"status.stop_typing";var n=this.getConvoUrl(e),i={method:"POST",body:{conversationId:e.id,eventType:r},url:"".concat(n,"/").concat("status/typing")};return this.request(i)},share:function(e,t){var r=this;Ae()(t)&&(t={object:{files:t}});var n=lr(lr({},e),{},{url:this.getConvoUrl(e)});return t instanceof It||(t=It.create(n,t,this.webex)),this.prepare(t,{target:this.prepareConversation(n)}).then((function(e){return r.submit(e)}))},submit:function(e,t){var r=this,n=t||this.getConvoUrl(e.target),i="share"===e.verb?"content":"activities",o={method:"POST",body:e,qs:{personRefresh:!0},url:"".concat(n,"/").concat(i)};"share"===e.verb&&je()(o.qs,{transcode:!0,async:!1});var s=ke()(o,(function(e){var t=o.body.object.files;if(t&&e&&t.items.length>0&&e.constructor===t.items[0].scr.constructor){var r=Ne()(e);return r.toJWE=e.toJWE,r.toJSON=e.toJSON,r}}));return this.webex.trigger("user-activity"),this.request(o).then((function(e){return e.body})).catch((function(e){if(e.body&&1400087===e.body.errorCode)s.body.target.defaultActivityEncryptionKeyUrl=null,r.request(s);else{if(!e.body||1409004!==e.body.errorCode&&1400049!==e.body.errorCode)throw e;r.webex.request({method:"GET",api:"conversation",resource:"conversations/".concat(o.body.target.id)}).then((function(e){s.body.target.defaultActivityEncryptionKeyUrl=e.body.defaultActivityEncryptionkeyUrl,r.request(s)}))}}))},unassign:function(e,t){var r=this,n=lr(lr({},e),{},{url:this.getConvoUrl(e)});return this.prepare(t,{verb:"unassign",target:this.prepareConversation(n),object:{objectType:"content",files:{items:[]}}}).then((function(e){return r.submit(e)}))},unmuteMentions:function(e,t){return this.tag(e,{tags:["MENTION_NOTIFICATIONS_ON"]},t)},unmuteMessages:function(e,t){return this.tag(e,{tags:["MESSAGE_NOTIFICATIONS_ON"]},t)},unignore:function(e,t){return this.untag(e,{tags:["IGNORED"]},t)},update:function(e,t,r){var n=this;if(!Te()(t))return l().reject(new Error("`object` must be an object"));var i=lr(lr({},e),{},{url:this.getConvoUrl(e)});return this.prepare(r,{verb:"update",target:this.prepareConversation(i),object:t}).then((function(e){return n.submit(e)}))},updateKey:function(e,t,r){var n=this,i=lr(lr({},e),{},{url:this.getConvoUrl(e)});return this.get(i,{activitiesLimit:0,includeParticipants:!0}).then((function(e){return n._updateKey(e,t,r)}))},_updateKey:function(e,t,r){var n=this,i=lr(lr({},e),{},{url:this.getConvoUrl(e)});return l().resolve(t||this.webex.internal.encryption.kms.createUnboundKeys({count:1})).then((function(e){var t=Ae()(e)?e[0]:e,o={verb:"updateKey",target:n.prepareConversation(i),object:{defaultActivityEncryptionKeyUrl:t.uri,objectType:"conversation"}};return i.kmsResourceObjectUrl&&i.kmsResourceObjectUrl.startsWith("kms:")?o.kmsMessage={method:"update",resourceUri:"<KRO>",uri:t.uri}:o.kmsMessage={method:"create",uri:"/resources",userIds:ye()(i.participants.items,"id"),keyUris:[t.uri]},n.prepare(r,o).then((function(e){return n.submit(e)}))}))},_create:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request({method:"POST",service:"conversation",resource:"conversations",body:e,qs:{forceCreate:t.allowPartialCreation}}).then((function(e){return e.body}))},_createGrouped:function(e,t){return this._create(this._prepareConversationForCreation(e),t)},_createOneOnOne:function(e){var t=this._prepareConversationForCreation(e);return t.tags=["ONE_ON_ONE"],this._create(t)},getConversationUrl:function(){var e=this;this.logger.info("conversation: getting the conversation service url");var t=this.webex.internal.services.get("conversation");return t?l().resolve(t):this.webex.internal.waitForCatalog("postauth").then((function(){return e.webex.internal.services.get("conversation")})).catch((function(t){return e.logger.warn("conversation: unable to get conversation url",t.message),l().reject(t)}))},_inferConversationUrl:function(e){var t=this;return e.id?this.webex.internal.feature.getFeature("developer","web-high-availability").then((function(r){return r?t.getConversationUrl().then((function(t){return e.url="".concat(t,"/conversations/").concat(e.id),e})):e.url?l().resolve(e):t.getConversationUrl().then((function(t){return e.url="".concat(t,"/conversations/").concat(e.id),e}))})):l().resolve(e)},_listActivities:function(e){var t=e.conversationId,r=this.getConvoUrl({url:e.conversationUrl,id:t}),n=e.resource;return this._list({qs:pe()(e,"resource"),url:"".concat(r,"/").concat(n)})},listActivitiesThreadOrdered:function(e){var t=this,r=e.conversationUrl,n=e.conversationId;if(!r&&!n)throw new Error("must provide a conversation URL or conversation ID");var i=this.getConvoUrl({url:r,id:n}),o=lr(lr({},pe()(e,["conversationUrl","conversationId"])),{},{url:i}),s=lr(lr({},o),{},{queryType:Nt}),a=this._listActivitiesThreadOrdered(o),c=function(){var e=(0,re.Z)(Le().mark((function e(r){var n,i,s,c;return Le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}throw new Error("Search must be an activity object from conversation service");case 2:if(n=r.target&&r.target.url){e.next=5;break}throw new Error("Search object must have a target url!");case 5:return i=lr(lr({},o),{},{url:n,queryType:Lt,search:r}),a=t._listActivitiesThreadOrdered(i),e.next=9,a.next(i);case 9:return s=e.sent,c=s.value,e.abrupt("return",{done:!0,value:c});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=(0,re.Z)(Le().mark((function e(){var t,r,n,i,o;return Le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.next(s);case 2:return t=e.sent,r=t.value,i=(n=void 0===r?[]:r)[0]&&n[0].activity,o=i&&$t(i)!==Vt,e.abrupt("return",{done:!o,value:n});case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=(0,re.Z)(Le().mark((function e(){var t,r,n;return Le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=lr(lr({},o),{},{queryType:Pt}),e.next=3,a.next(t);case 3:return r=e.sent,n=r.value,e.abrupt("return",{done:!n.length,value:n});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{jumpToActivity:c,getNewer:l,getOlder:u}},_listActivitiesThreadOrdered:function(){var e,t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(e=Le().mark((function e(){var n,i,o,s,a,c,u,d,h,f,p,m,g,v,y,b,E,w,S,_;return Le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=r.minActivities,i=void 0===n?20:n,o=r.queryType,(s=void 0===o?Dt:o)===Pt&&(s=Dt),a=r.url,c=r.search,u=void 0===c?{}:c,d=r.includeChildren,h=rr(),f=h.setBookends,p=h.getNewestAct,m=h.getOldestAct,g=s===Dt||s===Nt?i:Math.max(10,Math.ceil(i/2)),v=g,y=tr(),b=y.getActivityHandlerByKey,E=y.getActivityByTypeAndParentId,w=sr(s,{activityToSearch:u,batchSize:v}),S=Le().mark((function e(){var r,n,o,c,h,y,S,_,T,x,A,I,C,R,k,O,N,P,L,D,M,U;return Le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=ir(),n=r.getRootActivityHash,o=r.addNewRoot,c=nr(),h=c.getNoMoreActs,y=c.checkAndSetNoMoreActs,S=c.checkAndSetNoOlderActs,_=c.checkAndSetNoNewerActs,T=function(e){return(0,ne.Z)((0,ne.Z)((0,ne.Z)((0,ne.Z)((0,ne.Z)((0,ne.Z)((0,ne.Z)({},jt,o),Mt,b(Mt)),Ut,b(Ut)),Bt,b(Bt)),Ft,b(Ft)),Ht,o),Vt,o)[e]},x=function(e){var t=$t(e);$t(e)!==Gt&&T(t)(e)},A=function(e){e.forEach((function(e){x(e),S(e)}))},I=function(e){f(e,Nt),A(e)},C=function(e){_(e),e.length&&(f(e,Pt),A(e))},R=function(e){f(e,Lt),A(e)},k=function(e){return(0,ne.Z)((0,ne.Z)((0,ne.Z)((0,ne.Z)({},Nt,I),Pt,C),Lt,R),Dt,I)[e]},O=or(),N=Le().mark((function e(){var r,o,c,h,f,b,S,_,T,x,I,C,R,N,P,L,D,M,U,B,F,j,V,H,G,q,$,Z,z,K,W,J,Y,Q,X,re,ne,ie,se,ae;return Le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(),r=lr({conversationUrl:a,limit:v,includeChildren:d},w),o=t.listActivities(r),c=[o],s!==Lt&&s!==Pt||(h={activityType:null},w.sinceDate&&(h.sinceDate=w.sinceDate),f=t.listParentActivityIds(a,h),c.push(f)),e.next=7,oe(l().all(c));case 7:if(b=e.sent,S=(0,ee.Z)(b,2),_=S[0],T=S[1],x=void 0===T?{}:T,k(s)(_),I=x.reply,C=void 0===I?[]:I,R=x.edit,N=void 0===R?[]:R,P=x.reaction,L=void 0===P?[]:P,!(C.length||N.length||L.length)){e.next=35;break}D=[],M=[],U=[],B=ar(_);try{for(B.s();!(F=B.n()).done;)j=F.value,V=j.id,H={conversationUrl:a,activityParentId:V},L.includes(V)&&D.push(t.getReactionSummaryByParentId(a,V,{activityType:"reactionSummary",includeChildren:!0})),C.includes(V)&&(H.query={activityType:"reply"},M.push(t.listAllChildActivitiesByParentId(H))),N.includes(V)&&(H.query={activityType:"edit"},U.push(t.listAllChildActivitiesByParentId(H)))}catch(e){B.e(e)}finally{B.f()}return e.next=23,oe(l().all([l().all(D),l().all(M),l().all(U)]));case 23:return G=e.sent,q=(0,ee.Z)(G,3),$=q[0],Z=q[1],z=q[2],e.next=30,oe(l().all(Z.filter((function(e){return C.includes(e.id)})).map((function(e){return t.getReactionSummaryByParentId(a,e.id,{activityType:"reactionSummary",includeChildren:!0})}))));case 30:K=e.sent,W=[].concat((0,te.Z)($),(0,te.Z)(K)),Z.forEach((function(e){return A(e)})),z.forEach((function(e){return A(e)})),W.forEach((function(e){return A(e)}));case 35:J=n(),Y=J.size,Q=ar(J.values());try{for(Q.s();!(X=Q.n()).done;)re=X.value,ne=re.id,(ie=E(Mt,ne))&&ie.size&&(Y+=ie.size||0)}catch(e){Q.e(e)}finally{Q.f()}if(!(Y>=i)){e.next=41;break}return e.abrupt("return",1);case 41:y(s,Y,v),s===Nt&&(v=i),s===Pt&&(v=g),se=Zt(m()),ae=Zt(p()),w=s===Dt?sr(Nt,{oldestPublishedDate:se,batchSize:v}):sr(s,{batchSize:v,activityToSearch:u,oldestPublishedDate:se,newestPublishedDate:ae}),s===Lt&&(v+=10);case 48:case"end":return e.stop()}}),e)}));case 11:if(h()){e.next=17;break}return e.delegateYield(N(),"t0",13);case 13:if(!e.t0){e.next=15;break}return e.abrupt("break",17);case 15:e.next=11;break;case 17:return P=[],L=function(e){var r=[],i=E(Mt,e);return i?(Kt(er(i)).forEach((function(e){var o=e.id,s=E(Ut,o),a=E(Bt,o),c=E(Ft,o),u=s||e,l=[].concat((0,te.Z)(er(n())),(0,te.Z)(er(i))).reduce((function(e,t){return e[t.id]=t,e}),{}),d=t._createParsedServerActivity(u,l),h=Jt({id:o,activity:d,reaction:a,reactionSelf:c});r.push(h)})),r):r},Kt(er(n())).forEach((function(e){var r=e.id,n=L(r),i=E(Ut,r),o=E(Bt,r),s=E(Ft,r),a=i||e,c=t._createParsedServerActivity(a,(0,ne.Z)({},r,e)),u=Jt({id:r,activity:c,reaction:o,reactionSelf:s});P.push(u),n.forEach((function(e){return P.push(e)}))})),e.next=23,P;case 23:if(!(D=e.sent)){e.next=32;break}i=D.minActivities||i,M=Zt(m()),U=Zt(p()),s=D.queryType,w=sr(s,{activityToSearch:u,oldestPublishedDate:M,newestPublishedDate:U,batchSize:v}),e.next=33;break;case 32:return e.abrupt("return",{v:void 0});case 33:case"end":return e.stop()}}),e)}));case 9:return e.delegateYield(S(),"t0",11);case 11:if(!(_=e.t0)){e.next=14;break}return e.abrupt("return",_.v);case 14:e.next=9;break;case 16:case"end":return e.stop()}}),e)})),function(){return new ce(e.apply(this,arguments))})()},_createParsedServerActivity:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=function(e,t){return e.parent&&e.parent.id&&!t[e.parent.id]}(e,t);if(r)throw new Error("activity has a parent that cannot be found in allActivitiesHash! please handle this as necessary");var n,i,o,s=function(e,t){var r=$t(e);return r===Ut&&Yt(e,t)?qt:r}(e,t);switch(s){case jt:return e;case Ut:return i=t,o=(n=e).parent,Ot(Ot({},i[o.id]),{},{id:n.id,parent:o,editParent:o,object:n.object,published:n.published});case Mt:return function(e){return Ot(Ot({},e),{},{replyParent:e.parent})}(e);case qt:return function(e,t){var r=e.parent,n=t[r.id];return Ot(Ot({},n),{},{id:e.id,parent:r,editParent:r,replyParent:n.parent,object:e.object,published:e.published})}(e,t);default:return e}},_list:function(e){var t=this;return(0,re.Z)(Le().mark((function r(){var n,i,o,s,a,c,u,d;return Le().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e.qs=lr({personRefresh:!0,uuidEntryFormat:!0,activitiesLimit:0,participantsLimit:0},e.qs),r.next=3,t.request(e);case 3:if((n=r.sent).body&&n.body.items&&0!==n.body.items.length?(i=n.body.items.slice(0),Ee()(i).published<i[0].published&&i.reverse()):i=[],!n.body.additionalUrls){r.next=14;break}if(o=0,e.limit&&(o=Math.floor((e.limit.value-i.length)/n.body.additionalUrls.length)),e.limit&&0===o){r.next=14;break}return r.next=11,l().all(n.body.additionalUrls.map((function(r){var n="".concat(r,"/").concat(e.resource),i=lr(lr({},e),{},{uri:n,url:n});return e.limit&&(i.qs[i.limit.name]=o),t.request(i)})));case 11:s=r.sent,a=ar(s);try{for(a.s();!(c=a.n()).done;)(u=c.value).body&&u.body.items&&u.body.items.length&&(d=u.body.items,Ee()(d).published<d[0].published&&d.reverse(),i=i.concat(d))}catch(e){a.e(e)}finally{a.f()}case 14:return r.next=16,l().all(i.map((function(e){return t._recordUUIDs(e)})));case 16:return r.abrupt("return",i);case 17:case"end":return r.stop()}}),r)})))()},_maybeCreateOneOnOneThenPost:function(e,t){var r=this;return this.get(Ce()({user:e.participants[1]}),je()(t,{includeConvWithDeletedUserUUID:!0,includeParticipants:!0})).then((function(t){return e.comment||e.html?r.post(t,{content:e.html,displayName:e.comment}).then((function(e){return t.activities.items.push(e),t})):t})).catch((function(t){return 404!==t.statusCode?l().reject(t):r._createOneOnOne(e)}))},_prepareConversationForCreation:function(e){var t=this,r={activities:{items:[this.expand("create")]},objectType:"conversation",kmsMessage:{method:"create",uri:"/resources",userIds:Ne()(e.participants),keyUris:[]}};return e.displayName&&(r.displayName=e.displayName),e.tags&&(r.tags=e.tags),e.participants.forEach((function(e){r.activities.items.push(t.expand("add",{objectType:"person",id:e}))})),e.comment&&r.activities.items.push(this.expand("post",{objectType:"comment",content:e.html,displayName:e.comment})),!e.isDefaultClassification&&e.classificationId&&r.activities.items.push(this.expand("update",{objectType:"classification",classificationId:e.classificationId,effectiveDate:e.effectiveDate})),e.favorite&&r.activities.items.push(this.expand("favorite",{objectType:"conversation"})),r},_recordUUIDs:function(e){var t=this;return e.participants&&e.participants.items?l().all(e.participants.items.map((function(e){return"ROOM"===e.type||"LYRA_SPACE"===e.type?l().resolve():t.webex.internal.user.recordUUID(e).catch((function(e){return t.logger.warn("Could not record uuid",e)}))}))):l().resolve(e)},version:"0.0.0-next"});["favorite","hide","lock","mute","unfavorite","unhide","unlock","unmute"].forEach((function(e){fr.prototype[e]=function(t,r){var n=this,i=this.prepareConversation(lr(lr({},t),{},{url:this.getConvoUrl(t)}));return this.prepare(r,{verb:e,object:i,target:i}).then((function(e){return n.submit(e)}))}})),["assignModerator","unassignModerator"].forEach((function(e){fr.prototype[e]=function(t,r,n){var i=this,o=lr(lr({},t),{},{url:this.getConvoUrl(t)});return l().all([o,r?this.webex.internal.user.asUUID(r):this.webex.internal.device.userId]).then((function(t){var r=(0,ee.Z)(t,2),o=r[0],s=r[1];return i.prepare(n,{verb:e,target:i.prepareConversation(o),object:{id:s,objectType:"person"}})})).then((function(e){return i.submit(e)}))}})),["setSpaceProperty","unsetSpaceProperty"].forEach((function(e){var t=e.startsWith("set")?"set":"unset";fr.prototype[e]=function(e,r,n){var i=this;if(!Se()(r))return l().reject(new Error("`tag` must be a string"));var o=lr(lr({},e),{},{url:this.getConvoUrl(e)});return this.prepare(n,{verb:t,target:this.prepareConversation(o),object:{tags:[r],objectType:"spaceProperty"}}).then((function(e){return i.submit(e)}))}})),["tag","untag"].forEach((function(e){fr.prototype[e]=function(t,r,n){var i=this;if(!Te()(r))return l().reject(new Error("`object` must be an object"));var o=this.prepareConversation(lr(lr({},t),{},{url:this.getConvoUrl(t)}));return this.prepare(n,{verb:e,target:o,object:je()(o,r)}).then((function(e){return i.submit(e)}))}}));const pr=fr;var mr=r(23560),gr=r.n(mr);function vr(e,t){var r=_()(e);if(U()){var n=U()(e);t&&(n=n.filter((function(t){return F()(e,t).enumerable}))),r.push.apply(r,n)}return r}function yr(e,t){return _()(t).map((function(r){var n=t[r];return gr()(n)?{name:r,direction:e,fn:n}:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?vr(Object(r),!0).forEach((function(t){(0,ne.Z)(e,t,r[t])})):V()?G()(e,V()(r)):vr(Object(r)).forEach((function(t){$()(e,t,F()(r,t))}))}return e}({name:r},n)}))}var br=W()("KEY"),Er=w()((function(e,t,r,n){return t.transform("encryptTextProp",e,r,n)})),wr=w()((function(e,t,r,n){return t.transform("encryptJsonProp",e,r,n)})),Sr=yr("outbound",{encryptObject:function(e,t,r){return r||(r=t,t=void 0),r&&r.objectType?!1===t?l().resolve():e.transform("encrypt".concat(c()(r.objectType)),t,r):l().resolve()},encryptReaction2:function(e,t,r){return e.transform("encryptPropDisplayName",t,r)},encryptConversation:function(e,t,r){return!1===t?l().resolve():l().resolve(t||e.webex.internal.encryption.kms.createUnboundKeys({count:1})).then((function(n){var o=Ae()(n)?n[0]:n;return i()(r,"kmsMessage.keyUris")&&!r.kmsMessage.keyUris.includes(o.uri)&&r.kmsMessage.keyUris.push(o.uri),l().all([i()(r,"activities.items")&&r.activities.items.reduce((function(t,r){return t.then((function(){return e.transform("encryptObject",o,r)}))}),l().resolve()),e.transform("encryptPropDisplayName",o,r)]).then((function(){r.encryptionKeyUrl=o.uri||o,t||(r.defaultActivityEncryptionKeyUrl=r.defaultActivityEncryptionKeyUrl||o.uri||o)}))}))},encryptActivity:function(e,t,r){var n,i,o;return"meetingContainer"===(null==r||null===(n=r.target)||void 0===n?void 0:n.objectType)&&"policies"===(null==r||null===(i=r.object)||void 0===i?void 0:i.objectType)||r.encryptionKeyUrl||"True"===(null===(o=r.object)||void 0===o?void 0:o.created)?l().resolve():e.transform("encrypt".concat(c()(r.verb),"Activity"),t,r).then((function(){return t=t||r[br],e.transform("prepareActivityKmsMessage",t,r)}))},encryptVerbActivity:function(e,t,r){return e.transform("maybeEncryptTarget",t,r).then((function(){t=t||r[br]})).then((function(){return e.transform("encryptObject",t,r.object)}))},maybeEncryptTarget:function(e,t,r){if(t)return l().resolve();if(i()(r,"target.defaultActivityEncryptionKeyUrl")&&r.target.defaultActivityEncryptionKeyUrl&&i()(r,"target.kmsResourceObjectUrl"))return r[br]=t||r.target.defaultActivityEncryptionKeyUrl,l().resolve();var n=r.target&&r.target.url;return n?e.webex.internal.conversation.get({url:n}).then((function(t){return t.defaultActivityEncryptionKeyUrl?(r.target.defaultActivityEncryptionKeyUrl||e.webex.logger.warn("plugin-conversation: downloaded conversation to determine its defaultActivityEncryptionKeyUrl; make sure to pass all encryption related properties when calling Webex.conversation methods."),r.target.kmsResourceObjectUrl||e.webex.logger.warn("plugin-conversation: downloaded conversation to determine its kmsResourceObjectUrl; make sure to pass all encryption related properties when calling Webex.conversation methods."),r[br]=r.target.defaultActivityEncryptionKeyUrl=t.defaultActivityEncryptionKeyUrl,r.target.kmsResourceObjectUrl=t.kmsResourceObjectUrl,l().resolve()):e.webex.internal.conversation.updateKey(t).then((function(e){e.kmsMessage.resource&&(r.target.kmsResourceObjectUrl=e.kmsMessage.resource.uri),r[br]=r.target.defaultActivityEncryptionKeyUrl=e.object.defaultActivityEncryptionKeyUrl}))})):l().reject(new Error("Cannot determine encryption key for activity's conversation; no key url or conversation url provided"))},prepareActivityKmsMessage:function(e,t,r){if(r.kmsMessage)if(t||"delete"!==r.verb||(t=s()(r,"target.defaultActivityEncryptionKeyUrl")),!t&&"updateKey"===r.verb&&i()(r,"object.defaultActivityEncryptionKeyUrl")&&(t=s()(r,"object.defaultActivityEncryptionKeyUrl")),!t&&"leave"===r.verb&&i()(r,"target.defaultActivityEncryptionKeyUrl")&&(t=s()(r,"target.defaultActivityEncryptionKeyUrl")),t){var n=r.target.kmsResourceObjectUrl;["uri","resourceUri"].forEach((function(e){if(r.kmsMessage[e]&&!n&&r.kmsMessage[e].includes("<KRO>"))throw new Error("encrypter: cannot determine kro");r.kmsMessage[e]&&(r.kmsMessage[e]=r.kmsMessage[e].replace("<KRO>",n),r.kmsMessage[e]=r.kmsMessage[e].replace("<KEYURL>",t.keyUrl||t))}))}else h()(r,"kmsMessage")},encryptVerbActivityWithKey:{direction:"outbound",fn:function(e,t,r){return e.transform("encryptVerbActivity",t,r).then((function(){t=t||r[br],r.encryptionKeyUrl=t.uri||t}))}},encryptAddActivity:{direction:"outbound",fn:function(e,t,r){return i()(r,"object.objectType")&&"reaction2"===r.object.objectType?e.transform("encryptVerbActivityWithKey",t,r):e.transform("encryptVerbActivity",t,r)}},encryptAssignActivity:{direction:"outbound",alias:"encryptVerbActivityWithKey"},encryptCreateActivity:{direction:"outbound",alias:"encryptVerbActivity"},encryptPostActivity:{direction:"outbound",alias:"encryptVerbActivityWithKey"},encryptShareActivity:{direction:"outbound",alias:"encryptVerbActivityWithKey"},encryptCardactionActivity:{direction:"outbound",alias:"encryptVerbActivityWithKey"},encryptUpdateActivity:{direction:"outbound",alias:"encryptVerbActivityWithKey"},encryptUpdateKeyActivity:{direction:"outbound",alias:"encryptVerbActivity"},encryptComment:function(e,t,r){return l().all([e.transform("encryptPropDisplayName",t,r),e.transform("encryptPropContent",t,r)])},encryptContent:function(e,t,r){var n=r.files.items.map((function(r){return e.transform("encryptObject",t,r)}));return n.push(e.transform("encryptPropContent",t,r)),n.push(e.transform("encryptPropDisplayName",t,r)),l().all(n)},encryptFile:function(e,t,r){return r.image&&!r.image.scr?l().reject(new Error("`file.image` must have an `scr`")):l().all([e.transform("encryptPropScr",t,r),e.transform("encryptPropDisplayName",t,r),e.transform("encryptPropContent",t,r),r.image&&e.transform("encryptPropScr",t,r.image)])},encryptSubmit:function(e,t,r){return e.transform("encryptPropInputs",t,r)},encryptImageURI:function(e,t,r){return e.transform("encryptPropLocation",t,r)},encryptPropContent:Er("content"),encryptPropDisplayName:Er("displayName"),encryptPropInputs:wr("inputs"),encryptPropLocation:Er("location"),encryptPropScr:function(e,t,r){return r.scr?e.webex.internal.encryption.encryptScr(t,r.scr).then((function(e){r.scr=e})):l().resolve()},encryptJsonProp:function(e,t,r,n){return n[t]?e.webex.internal.encryption.encryptText(r.uri||r,Be()(n[t])).then((function(e){n[t]=e})):l().resolve()},encryptTextProp:function(e,t,r,n){return n[t]?e.webex.internal.encryption.encryptText(r.uri||r,n[t]).then((function(e){n[t]=e})):l().resolve()}}),_r=r(68929),Tr=r.n(_r),xr=r(25733),Ar=r.n(xr),Ir=w()((function(e,t,r,n){return t.transform("decryptTextProp",e,r,n)})),Cr=yr("inbound",{decryptObject:function(e,t,r){return r||(r=t,t=void 0),r&&r.objectType?(!t&&r.encryptionKeyUrl&&(t=r.encryptionKeyUrl),"transcodedContent"===r.objectType?l().all(r.files.items.map((function(r){return e.transform("decryptFile",t,r)}))):e.transform("decrypt".concat(c()(r.objectType)),t,r)):l().resolve()},decryptSubmit:function(e,t,r){if(!r.inputs)return l().resolve();var n=e.webex.internal.conversation.config.decryptionFailureMessage;return e.transform("decryptPropCardItem",0,t,[r.inputs]).then((function(e){r.inputs=JSON.parse(e[0])})).catch((function(t){return e.webex.logger.warn("plugin-conversation: failed to decrypt attachmentAction.inputs: ".concat(t)),r.inputs=n,l().resolve(n)}))},decryptReaction2summary:function(e,t,r){return r.reactions?l().all(r.reactions.map((function(r){return e.transform("decryptPropDisplayName",t,r)}))):l().resolve()},decryptReaction2selfsummary:function(e,t,r){return r.reactions?l().all(r.reactions.map((function(r){return e.transform("decryptPropDisplayName",t,r)}))):l().resolve()},decryptReaction2:function(e,t,r){return e.transform("decryptPropDisplayName",t,r)},decryptThread:function(e,t){var r=[];return t.childActivities&&X()(t.childActivities)&&(r=t.childActivities.map((function(t){return e.transform("decryptObject",null,t)}))),l().all(r)},decryptMeetingcontainer:function(e,t,r){var n=[];if(r.displayName){var i=r.encryptionKeyUrl||t;n.push(e.transform("decryptPropDisplayName",i,r))}r.extensions&&r.extensions.items.filter((function(e){return"recording"===e.data.objectType})).forEach((function(t){n.push(e.transform("decryptPropTopic",t.encryptionKeyUrl,t.data))}));return l().all(n)},decryptConversation:function(e,t,r){var n=[];r.activities.items&&n.push(l().all(r.activities.items.map((function(t){return e.transform("decryptObject",null,t)}))));var i=r.encryptionKeyUrl||t,o=e.webex.internal.conversation.config.decryptionFailureMessage;return i&&(n.push(e.transform("decryptPropDisplayName",i,r).catch((function(t){e.webex.logger.warn("plugin-conversation: failed to decrypt display name of ",r.url,t),l().resolve(o)}))),n.push(e.transform("decryptPropContent",i,r))),r.avatarEncryptionKeyUrl&&n.push(e.transform("decryptObject",r.avatarEncryptionKeyUrl,r.avatar)),r.previous&&n.push(e.transform("decryptPropDisplayName",i,r.previous)),r.previousValue&&n.push(e.transform("decryptPropDisplayName",i,r.previousValue)),l().all(n)},decryptActivity:function(e,t,r){if(!(r.encryptionKeyUrl||r.object&&r.object.encryptionKeyUrl))return l().resolve(r);var n=r.encryptionKeyUrl||r.object.encryptionKeyUrl||t,i=[];return r.children&&X()(r.children)&&(i=r.children.map((function(t){return e.transform("decryptObject",n,t.activity)}))),i.push(e.transform("decryptObject",n,r.object)),l().all(i)},decryptMicroappinstance:function(e,t,r){return e.transform("decryptPropModel",t,r)},decryptComment:function(e,t,r){var n=[e.transform("decryptPropDisplayName",t,r),e.transform("decryptPropContent",t,r)];return r.cards&&X()(r.cards)&&r.cards.map((function(i,o){return n.push(e.transform("decryptPropCardItem",o,t,r.cards))})),l().all(n)},decryptContent:function(e,t,r){return"links"===r.contentCategory?e.transform("decryptContentLinks",t,r):e.transform("decryptContentFiles",t,r)},decryptContentFiles:function(e,t,r){if(!r.files||!r.files.items||!X()(r.files.items))return l().resolve();var n=r.files.items.map((function(r){return e.transform("decryptObject",t,r)}));return n.push(e.transform("decryptComment",t,r)),r.links&&r.links.items&&X()(r.links.items)&&r.links.items.forEach((function(r){return n.push(e.transform("decryptObject",t,r))})),l().all(n)},decryptContentLinks:function(e,t,r){if(!r.links||!r.links.items||!X()(r.links.items))return l().resolve();var n=r.links.items.map((function(r){return e.transform("decryptObject",t,r)}));return n.push(e.transform("decryptComment",t,r)),l().all(n)},decryptEvent:function(e,t,r){var n=[e.transform("decryptPropDisplayName",t,r)];return r.location&&5===r.location.split(".").length&&n.push(e.transform("decryptPropLocation",t,r)),l().all(n)},decryptFile:function(e,t,r){return r.encryptionKeyUrl&&r.encryptionKeyUrl!==t&&(t=r.encryptionKeyUrl),l().all([r.transcodedCollection&&l().all(r.transcodedCollection.items.map((function(r){return e.transform("decryptObject",t,r)}))),e.transform("decryptPropScr",t,r),e.transform("decryptPropDisplayName",t,r),e.transform("decryptPropContent",t,r),r.image&&e.transform("decryptPropScr",t,r.image)])},decryptLink:function(e,t,r){return l().all([e.transform("decryptPropSslr",t,r),e.transform("decryptPropDisplayName",t,r)])},decryptTranscodedContent:function(e,t,r){return l().all(r.files.items.map((function(r){return e.transform("decryptFile",t,r)})))},decryptImageURI:function(e,t,r){return e.transform("decryptPropLocation",t,r)},decryptTextProp:function(e,t,r,n){if(!n[t])return l().resolve();var i=e.webex.internal.conversation.config.decryptionFailureMessage;return e.webex.internal.encryption.decryptText(r,n[t]).then((function(r){if(e.webex.config.conversation.keepEncryptedProperties){var i=Tr()("encrypted_".concat(t));n[i]=n[t]}n[t]=r})).catch((function(r){return e.webex.logger.warn("plugin-conversation: failed to decrypt ".concat(t," "),r),n[t]=i,l().resolve(i)}))},decryptPropCardItem:function(e,t,r,n){if(!Ar()(t)||!n||!X()(n)||t<0||t>=n.length||!(n[t]instanceof String||"string"==typeof n[t]))return l().resolve();var i=e.webex.internal.conversation.config.decryptionFailureMessage;return e.webex.internal.encryption.decryptText(r,n[t]).then((function(e){n[t]=e})).catch((function(r){return e.webex.logger.warn("plugin-conversation: failed to decrypt card at ".concat(t," "),r),n[t]=i,l().resolve(i)}))},decryptPropScr:function(e,t,r){return e.webex.internal.encryption.decryptScr(t,r.scr).then((function(e){r.scr=e}))},decryptPropSslr:function(e,t,r){return e.webex.internal.encryption.decryptScr(t,r.sslr).then((function(e){r.sslr=e}))},decryptPropDisplayName:Ir("displayName"),decryptPropContent:Ir("content"),decryptPropModel:Ir("model"),decryptPropLocation:Ir("location"),decryptPropTopic:Ir("topic")});(0,D.t4)("conversation",pr,{payloadTransformer:{predicates:[{name:"transformObject",test:function(e,t){return l().resolve(i()(t,"body.objectType"))},extract:function(e){return l().resolve(e.body)}},{name:"transformObject",direction:"inbound",test:function(e,t){return l().resolve(i()(t,"activity"))},extract:function(e){return l().resolve(e.activity)}},{name:"transformObjectArray",direction:"inbound",test:function(e,t){return l().resolve(i()(t,"body.multistatus"))},extract:function(e){return l().resolve(e.body.multistatus.map((function(e){return e&&e.data&&e.data.activity})))}},{name:"normalizeConversationListAndBindDecrypters",direction:"inbound",test:function(e,t){return i()(t,"body.items[0].objectType")&&s()(t,"options.deferDecrypt")?l().resolve(!0):l().resolve(!1)},extract:function(e){return l().resolve(e.body.items)}},{name:"transformObjectArray",direction:"inbound",test:function(e,t){return i()(t,"body.items[0].objectType")?s()(t,"options.deferDecrypt")?l().resolve(!1):l().resolve(!0):l().resolve(!1)},extract:function(e){return l().resolve(e.body.items)}},{name:"transformThreadArray",direction:"inbound",test:function(e,t){return i()(t,"body.items[0].childType")&&i()(t,"body.items[0].actorId")?s()(t,"options.deferDecrypt")?l().resolve(!1):l().resolve(!0):l().resolve(!1)},extract:function(e){return l().resolve(e.body.items)}}],transforms:[{name:"normalizeConversationListAndBindDecrypters",fn:function(e,t){return l().all(t.map((function(t){return e.transform("normalizeObject",t).then((function(){return t.decrypt=function(){return h()(t,"decrypt"),e.transform("decryptObject",t)},t}))})))}},{name:"transformObjectArray",fn:function(e,t){return l().all(t.map((function(t){return e.transform("transformObject",t)})))}},{name:"transformThreadArray",fn:function(e,t){return l().all(t.map((function(t){return e.transform("transformThread",t)})))}},{name:"transformObject",direction:"outbound",fn:function(e,t){return t&&t.objectType?e.transform("normalizeObject",t).then((function(){return e.transform("encryptObject",t)})).then((function(){return e.transform("encryptKmsMessage",t)})):l().resolve()}},{name:"transformObject",direction:"inbound",fn:function(e,t){return t&&t.objectType?e.transform("decryptObject",t).then((function(){return e.transform("normalizeObject",t)})):l().resolve()}},{name:"normalizeObject",fn:function(e,t){return t&&t.objectType?l().all([e.transform("normalize".concat(c()(t.objectType)),t),e.transform("normalizePropContent",t)]):l().resolve()}},{name:"transformThread",direction:"inbound",fn:function(e,t){return t?e.transform("decryptThread",t).then((function(){return e.transform("normalizeThread",t)})):l().resolve()}},{name:"normalizePropContent",direction:"inbound",fn:function(e,t){if(!t.content)return l().resolve();var r=e.webex.config.conversation,n=r.inboundProcessFunc,i=r.allowedInboundTags,o=r.allowedInboundStyles;return x(n,i||{},o,t.content).then((function(e){t.content=e}))}},{name:"normalizePropContent",direction:"outbound",fn:function(e,t){if(!t.content)return l().resolve();var r=e.webex.config.conversation,n=r.outboundProcessFunc,i=r.allowedOutboundTags,o=r.allowedOutboundStyles;return L(n,i||{},o,t.content).then((function(e){t.content=e}))}},{name:"normalizeConversation",fn:function(e,t){return t.activities=t.activities||{},t.activities.items=t.activities.items||[],t.participants=t.participants||{},t.participants.items=t.participants.items||[],l().all([l().all(t.activities.items.map((function(t){return e.transform("normalizeObject",t)}))),l().all(t.participants.items.map((function(t){return e.transform("normalizeObject",t)})))])}},{name:"normalizeActivity",fn:function(e,t){return l().all([e.transform("normalizeObject",t.actor),e.transform("normalizeObject",t.object),e.transform("normalizeObject",t.target)])}},{name:"normalizeThread",fn:function(e,t){return l().all(t.childActivities.map((function(t){return e.transform("normalizeObject",t)})))}},{name:"normalizePerson",fn:function(e,t){var r=t.entryEmail||t.emailAddress||t.id,n=t.entryUUID||t.id;return f.patterns.email.test(r)?t.entryEmail=t.emailAddress=r.toLowerCase():(h()(t,"entryEmail"),h()(t,"emailAddress")),t.roomProperties&&(t.roomProperties.isModerator=Boolean(t.roomProperties.isModerator)),f.patterns.uuid.test(n)?(t.entryUUID=t.id=n.toLowerCase(),l().resolve(t)):r?e.webex.internal.user.asUUID(r).then((function(e){return t.entryUUID=t.id=e,t})):l().reject(new Error("cannot determine id without an `emailAddress` or `entryUUID` property"))}}].concat(Cr).concat(Sr)},config:{conversation:{allowedInboundTags:{"webex-mention":["data-object-type","data-object-id","data-object-url"]},allowedOutboundTags:{"webex-mention":["data-object-type","data-object-id","data-object-url"]},inboundProcessFunc:function(){},outboundProcessFunc:function(){},allowedInboundStyles:[],allowedOutboundStyles:[],thumbnailMaxHeight:960,thumbnailMaxWidth:640,keepEncryptedProperties:!1,decryptionFailureMessage:"This message cannot be decrypted"}}})},22899:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DeviceUrlInterceptor:()=>we,FeatureCollection:()=>J,FeatureModel:()=>W,FeaturesModel:()=>Y,config:()=>_e,constants:()=>n,default:()=>le});var n={};r.r(n),r.d(n,{CISCO_DEVICE_URL:()=>N,DEVICE_EVENTS:()=>M,DEVICE_EVENT_REGISTRATION_SUCCESS:()=>D,FEATURE_COLLECTION_DEVELOPER:()=>R,FEATURE_COLLECTION_ENTITLEMENT:()=>k,FEATURE_COLLECTION_NAMES:()=>P,FEATURE_COLLECTION_USER:()=>O,FEATURE_TYPES:()=>L});r(60996);var i=r(47683),o=r(26243),s=r.n(o),a=r(62680),c=r.n(a),u=r(6919),l=r.n(u),d=r(93364),h=r.n(d),f=r(26771),p=r.n(f),m=r(77193),g=r(2313),v=r(73473),y=r.n(v),b=r(71544),E=r.n(b),w=r(66130),S=r.n(w),_=r(95366),T=r.n(_),x=r(18408),A=r(51707);const I="JS_SDK_WDM_REGISTRATION_SUCCESSFUL",C="JS_SDK_WDM_REGISTRATION_FAILED";var R="developer",k="entitlement",O="user",N="cisco-device-url",P=[R,k,O],L={BOOLEAN:"boolean",NUMBER:"number",STRING:"string"},D="registration:success",M=[D],U=r(65109),B=r.n(U),F=r(90765),j=r.n(F),V=r(13682),H=r(13218),G=r.n(H),q=r(91747),$=r.n(q),Z=r(7520),z=r.n(Z);function K(e,t){var r=s()(e);if(c()){var n=c()(e);t&&(n=n.filter((function(t){return T()(e,t).enumerable}))),r.push.apply(r,n)}return r}const W=B().extend({idAttribute:"key",props:{key:"string",lastModified:"date",mutable:"boolean",type:"string",val:"string",value:"any"},constructor:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return $()(t,{parse:!0}),E()(B().prototype.constructor,this,[e,t])},parse:function(e){if(!e||"object"!==(0,V.Z)(e))return{};var t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?K(Object(r),!0).forEach((function(t){(0,m.Z)(e,t,r[t])})):l()?h()(e,l()(r)):K(Object(r)).forEach((function(t){p()(e,t,T()(r,t))}))}return e}({},e),r=t.val;return z()(Number(r))?"string"==typeof r&&"true"===r.toLowerCase()?(t.type=L.BOOLEAN,t.value=!0):"string"==typeof r&&"false"===r.toLowerCase()?(t.type=L.BOOLEAN,t.value=!1):(t.type=L.STRING,t.value=r):(t.type=L.NUMBER,t.value=Number(r)),t},serialize:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=E()(B().prototype.serialize,this,t);return n.lastModified&&(n.lastModified=new Date(n.lastModified).toISOString()),n},set:function(e,t,r){var n,i;return G()(e)||null===e?(n=e,i=t):((n={})[e]=t,i=r),n=this.parse(n,i),E()(B().prototype.set,this,[n,i])}});const J=j().extend({mainIndex:"key",model:W});const Y=B().extend({collections:{developer:J,entitlement:J,user:J},clear:function(e){var t=this;return s()(this.attributes).forEach((function(r){t.unset(r,e)})),s()(this._children).forEach((function(e){t[e].clear()})),s()(this._collections).forEach((function(e){t[e].reset()})),this},initialize:function(){var e=this;["change:value","add","remove"].forEach((function(t){P.forEach((function(r){e[r].on(t,(function(t,n){e.trigger("change:".concat(r),e,e[r],n)}))}))}))}});var Q=r(66250),X=r(33453),ee=r.n(X);const te=i._y.extend({idAttribute:"IpNetworkDetectorId",namespace:"Device",props:{firstIpV4:["number",!0,-1],firstIpV6:["number",!0,-1],firstMdns:["number",!0,-1],totalTime:["number",!0,-1]},derived:{supportsIpV4:{deps:["firstIpV4","firstIpV6","firstMdns","totalTime"],fn:function(){return this.firstIpV4>=0||!!(this.totalTime<0||this.receivedOnlyMDnsCandidates())&&void 0}},supportsIpV6:{deps:["firstIpV4","firstIpV6","firstMdns","totalTime"],fn:function(){return this.firstIpV6>=0||!!(this.totalTime<0||this.receivedOnlyMDnsCandidates())&&void 0}}},receivedOnlyMDnsCandidates:function(){return this.totalTime>=0&&this.firstMdns>=0&&this.firstIpV4<0&&this.firstIpV6<0},gatherLocalCandidates:function(e){var t=this;return(0,Q.Z)(ee().mark((function r(){return ee().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new(y())((function(r,n){var i=!1;t.firstIpV4=-1,t.firstIpV6=-1,t.firstMdns=-1,t.totalTime=-1;var o=performance.now(),s=function(){i||(i=!0,t.totalTime=performance.now()-o,r())};e.onicecandidate=function(e){var n;null!==(n=e.candidate)&&void 0!==n&&n.address?(e.candidate.address.endsWith(".local")?-1===t.firstMdns&&(t.firstMdns=performance.now()-o):e.candidate.address.includes(":")?-1===t.firstIpV6&&(t.firstIpV6=performance.now()-o):-1===t.firstIpV4&&(t.firstIpV4=performance.now()-o),t.firstIpV4>=0&&t.firstIpV6>=0&&r()):null===e.candidate&&s()},e.onicegatheringstatechange=function(){"complete"===e.iceGatheringState&&s()},e.createDataChannel("data"),e.createOffer().then((function(t){return e.setLocalDescription(t)})).catch((function(e){t.webex.logger.error("Failed to detect ip network version:",e),n(e)}))})));case 1:case"end":return r.stop()}}),r)})))()},detect:function(){var e=this;return(0,Q.Z)(ee().mark((function t(){var r,n;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=new RTCPeerConnection,t.next=4,e.gatherLocalCandidates(n);case 4:r=t.sent;case 5:return t.prev=5,n.close(),t.finish(5);case 8:return t.abrupt("return",r);case 9:case"end":return t.stop()}}),t,null,[[0,,5,8]])})))()},version:"0.0.0-next"});var re,ne,ie,oe,se,ae;function ce(e,t){var r=s()(e);if(c()){var n=c()(e);t&&(n=n.filter((function(t){return T()(e,t).enumerable}))),r.push.apply(r,n)}return r}function ue(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(r),!0).forEach((function(t){(0,m.Z)(e,t,r[t])})):l()?h()(e,l()(r)):ce(Object(r)).forEach((function(t){p()(e,t,T()(r,t))}))}return e}const le=i._y.extend((re=(0,i.A4)("@"),ne=(0,i.A4)("@"),ie=(0,i.A4)("@"),oe=(0,x.deprecated)("device#markUrlFailedAndGetNew(): Use services#markFailedUrl()"),se=(0,i.tJ)("@",(function(){return!this.config.ephemeral})),ae={namespace:"Device",extraProperties:"allow",idAttribute:"url",children:{features:Y,ipNetworkDetector:te},props:{clientMessagingGiphy:"string",customerCompanyName:"string",customerLogoUrl:"string",deviceType:"string",helpUrl:"string",intranetInactivityDuration:"number",intranetInactivityCheckUrl:"string",inNetworkInactivityDuration:"number",ecmEnabledForAllUsers:["boolean",!1,!1],ecmSupportedStorageProviders:["array",!1,function(){return[]}],modificationTime:"string",navigationBarColor:"string",partnerCompanyName:"string",partnerLogoUrl:"string",peopleInsightsEnabled:"boolean",reportingSiteDesc:"string",reportingSiteUrl:"string",searchEncryptionKeyUrl:"string",showSupportText:"boolean",supportProviderCompanyName:"string",supportProviderLogoUrl:"string",url:"string",userId:"string",webFileShareControl:"string",webSocketUrl:"string",whiteboardFileShareControl:"string"},derived:{registered:{deps:["url"],fn:function(){return!!this.url}}},session:{logoutTimer:"any",lastUserActivityDate:"number",isReachabilityChecked:["boolean",!1,!1],isInMeeting:"boolean",isInNetwork:"boolean"},meetingStarted:function(){this.webex.trigger("meeting started")},meetingEnded:function(){this.webex.trigger("meeting ended")},refresh:function(){var e=this;return this.logger.info("device: refreshing"),this.canRegister().then((function(){if(!e.registered)return e.logger.info("device: device not registered, registering"),e.register();var t=ue(ue({},e.serialize()),e.config.body?e.config.body:{});delete t.features,delete t.mediaCluster,delete t.etag,e.config.ephemeral&&(t.ttl=e.config.ephemeralDeviceTTL);var r=ue(ue(ue({},e.config.defaults.headers?e.config.defaults.headers:{}),e.config.headers?e.config.headers:{}),e.etag?{"If-None-Match":e.etag}:{});return e.request({method:"PUT",uri:e.url,body:t,headers:r}).then((function(t){return e.processRegistrationSuccess(t)})).catch((function(t){return 404===t.statusCode?(e.logger.info("device: refresh failed, device is not valid"),e.logger.info("device: attempting to register a new device"),e.clear(),e.register()):y().reject(t)}))}))},register:function(){var e=this;return this.logger.info("device: registering"),this.canRegister().then((function(){if(e.registered)return e.logger.info("device: device already registered, refreshing"),e.refresh();var t=ue(ue({},e.config.defaults.body?e.config.defaults.body:{}),e.config.body?e.config.body:{}),r=ue(ue({},e.config.defaults.headers?e.config.defaults.headers:{}),e.config.headers?e.config.headers:{});return e.config.ephemeral&&(t.ttl=e.config.ephemeralDeviceTTL),e.webex.internal.newMetrics.submitInternalEvent({name:"internal.register.device.request"}),e.request({method:"POST",service:"wdm",resource:"devices",body:t,headers:r}).catch((function(t){throw e.webex.internal.newMetrics.submitInternalEvent({name:"internal.register.device.response"}),t})).then((function(t){return e.webex.internal.newMetrics.submitInternalEvent({name:"internal.register.device.response"}),e.webex.internal.metrics.submitClientMetrics(I),e.processRegistrationSuccess(t)})).catch((function(t){throw e.webex.internal.metrics.submitClientMetrics(C,{fields:{error:t}}),t}))}))},unregister:function(){var e=this;return this.logger.info("device: unregistering"),this.registered?this.request({uri:this.url,method:"DELETE"}).then((function(){return e.clear()})):(this.logger.warn("device: not registered"),y().resolve())},canRegister:function(){this.logger.info("device: validating if registration can occur");var e=this.webex.internal.services;return e.waitForCatalog("postauth",this.config.canRegisterWaitDuration).then((function(){return e.get("wdm")?y().resolve():y().reject(new Error(["device: cannot register,","'wdm' service is not available from the postauth catalog"].join(" ")))}))},checkNetworkReachability:function(){var e=this;if(this.logger.info("device: checking network reachability"),this.isReachabilityChecked)return y().resolve(this.resetLogoutTimer());if(this.isReachabilityChecked=!0,!this.intranetInactivityCheckUrl)return this.isInNetwork=!1,y().resolve(this.resetLogoutTimer());return this.request({headers:{"cisco-no-http-redirect":null,"spark-user-agent":null,trackingid:null},method:"GET",uri:this.intranetInactivityCheckUrl}).then((function(){return e.isInNetwork=!0,y().resolve(e.resetLogoutTimer())})).catch((function(){return e.logger.info("device: did not reach ping endpoint"),e.logger.info("device: triggering off-network timer"),e.isInNetwork=!1,y().resolve(e.resetLogoutTimer())}))},clear:function(){this.logger.info("device: clearing registered device");for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];E()(i._y.prototype.clear,this,t)},getWebSocketUrl:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.logger.info("device: getting the current websocket url");var r=this.webex.internal.services;if(t)return this.waitForRegistration().then((function(){return r.convertUrlToPriorityHostUrl(e.webSocketUrl)})).catch((function(t){return e.logger.warn(t.message),y().reject(new Error("device: failed to get the current websocket url"))}));if(!this.registered)return y().reject(new Error("device: cannot get websocket url, device is not registered"));var n=r.convertUrlToPriorityHostUrl(this.webSocketUrl);return n?y().resolve(n):y().reject(new Error("device: failed to get the current websocket url"))},processRegistrationSuccess:function(e){var t=this;this.logger.info("device: received registration payload");var r=ue({},e.body);delete r.services,delete r.serviceHostMap;var n=(e.headers||{}).etag;if(this.etag&&n&&this.etag===n){var i=r.features;delete r.features,this.features.user.reset(i.user),this.features.entitlement.reset(i.entitlement)}if(this.set(r),this.set({etag:n}),this.config.ephemeral){this.logger.info("device: enqueuing device refresh");var o=1e3*(this.config.ephemeralDeviceTTL/2+60);this.refreshTimer=(0,A.Lr)((function(){return t.refresh()}),o)}this.trigger(D,this)},resetLogoutTimer:function(){this.logger.info("device: resetting logout timer"),clearTimeout(this.logoutTimer),this.off("change:lastUserActivityDate"),this.unset("logoutTimer"),!this.isInMeeting&&this.config.enableInactivityEnforcement&&this.isReachabilityChecked&&(this.isInNetwork?this.setLogoutTimer(this.inNetworkInactivityDuration):this.setLogoutTimer(this.intranetInactivityDuration))},setLogoutTimer:function(e){var t=this;this.logger.info("device: setting logout timer"),!e||e<=0||(this.on("change:lastUserActivityDate",(function(){t.resetLogoutTimer()})),this.logoutTimer=(0,A.Lr)((function(){t.webex.logout()}),1e3*e))},waitForRegistration:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this.logger.info("device: waiting for registration"),new(y())((function(r,n){e.registered&&r();var i=(0,A.Lr)((function(){return n(new Error("device: timeout occured while waiting for registration"))}),1e3*t);e.once(D,(function(){clearTimeout(i),r()}))}))},markUrlFailedAndGetNew:function(e){return y().resolve(this.webex.internal.services.markFailedUrl(e))},initialize:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];E()(i._y.prototype.initialize,this,r),P.forEach((function(t){e.features.on("change:".concat(t),(function(t,r,n){e.trigger("change",e,n),e.trigger("change:features",e,e.features,n)}))})),this.on("change:intranetInactivityCheckUrl",(function(){e.checkNetworkReachability()})),this.on("change:intranetInactivityDuration",(function(){e.checkNetworkReachability()})),this.on("change:inNetworkInactivityDuration",(function(){e.checkNetworkReachability()})),this.listenTo(this.webex,"user-activity",(function(){e.lastUserActivityDate=S()()})),this.listenTo(this.webex,"meeting started",(function(){e.isInMeeting=!0,e.resetLogoutTimer()})),this.listenTo(this.webex,"meeting ended",(function(){e.isInMeeting=!1,e.resetLogoutTimer()}))},version:"0.0.0-next"},(0,g.Z)(ae,"refresh",[x.oneFlight,re],T()(ae,"refresh"),ae),(0,g.Z)(ae,"register",[x.oneFlight,ne],T()(ae,"register"),ae),(0,g.Z)(ae,"unregister",[x.oneFlight,ie],T()(ae,"unregister"),ae),(0,g.Z)(ae,"markUrlFailedAndGetNew",[oe],T()(ae,"markUrlFailedAndGetNew"),ae),(0,g.Z)(ae,"initialize",[se],T()(ae,"initialize"),ae),ae));var de=r(63755),he=r.n(de),fe=r(8167),pe=r(31314),me=r(69678),ge=r(26305),ve=r(35002),ye=r(36968),be=r.n(ye);function Ee(e){var t=function(){if("undefined"==typeof Reflect||!he())return!1;if(he().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(he()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,ve.Z)(e);if(t){var i=(0,ve.Z)(this).constructor;r=he()(n,arguments,i)}else r=n.apply(this,arguments);return(0,ge.Z)(this,r)}}var we=function(e){(0,me.Z)(r,e);var t=Ee(r);function r(){return(0,fe.Z)(this,r),t.apply(this,arguments)}return(0,pe.Z)(r,[{key:"onRequest",value:function(e){var t=e.headers,r=e.service,n=e.uri,i=this.webex.internal,o=i.device,s=i.services;return!o.url||t&&N in t&&t[N]?y().resolve(e):s.waitForService({service:r,url:n}).then((function(t){var r=(s.getServiceFromUrl(t)||{}).name;return r&&!["idbroker","oauth","saml"].includes(r)&&be()(e,"headers['".concat(N,"']"),o.url),e})).catch((function(t){return t.message.match(/was not found after waiting/)?e:y().reject(t)}))}}],[{key:"create",value:function(){return new r({webex:this})}}]),r}(r(18338).nK),Se=r(34155);const _e={device:{canRegisterWaitDuration:10,defaults:{body:{name:("string"==typeof Se.title?Se.title.trim():void 0)||x.inBrowser&&"browser"||"javascript",deviceType:x.deviceType.WEB,model:"web-js-sdk",localizedModel:"webex-js-sdk",systemName:"WEBEX_JS_SDK",systemVersion:"1.0.0"}},enableInactivityEnforcement:!1,ephemeral:!1,ephemeralDeviceTTL:1800}};(0,i.t4)("device",le,{config:_e,interceptors:{DeviceUrlInterceptor:we.create},onBeforeLogout:function(){return this.unregister()}})},33317:(e,t,r)=>{"use strict";var n=r(47037),i=r.n(n),o=r(13218),s=r.n(o),a=r(18721),c=r.n(a),u=r(73473),l=r.n(u),d=(r(22899),r(21408),r(47683)),h=r(26243),f=r.n(h),p=r(62680),m=r.n(p),g=r(95366),v=r.n(g),y=r(6919),b=r.n(y),E=r(93364),w=r.n(E),S=r(26771),_=r.n(S),T=r(77193),x=r(8450),A=r.n(x),I=r(17187),C=r(8575),R=r(18408),k=r(21217),O=r.n(k),N=r(77446),P=r.n(N);function L(e){return e instanceof ArrayBuffer?l().resolve(e):e.toArrayBuffer?l().resolve(e.toArrayBuffer()):e.buffer?l().resolve(e.buffer):new(l())((function(t,r){var n=new FileReader;n.onload=function(){t(new Uint8Array(this.result))},n.onerror=r,n.readAsArrayBuffer(e)}))}var D=r(14917),M=r(2313),U=(r(82723),r(83977)),B=r.n(U),F=r(66130),j=r.n(F),V=r(87735),H=(r(89539),r(51707)),G=r(39171),q=r(55877),$=r.n(q),Z=r(85579),z=r.n(Z),K=r(63755),W=r.n(K),J=r(8167),Y=r(31314),Q=r(69678),X=r(26305),ee=r(35002),te=r(71544),re=r.n(te),ne=[405005,405006];function ie(e){var t=function(){if("undefined"==typeof Reflect||!W())return!1;if(W().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(W()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,ee.Z)(e);if(t){var i=(0,ee.Z)(this).constructor;r=W()(n,arguments,i)}else r=n.apply(this,arguments);return(0,X.Z)(this,r)}}var oe=function(e){(0,Q.Z)(r,e);var t=ie(r);function r(){return(0,J.Z)(this,r),t.apply(this,arguments)}return(0,Y.Z)(r,[{key:"parse",value:function(e){e=e.body||e,w()(this,{body:{enumerable:!1,value:e},reason:{enumerable:!1,value:e.reason},requestId:{enumerable:!1,value:e.requestId},status:{enumerable:!1,value:e.status}});var t="string"==typeof e?e:e.reason;return t||(t=this.constructor.defaultMessage),e.status&&(t+="\nKMS_RESPONSE_STATUS: ".concat(e.status)),e.requestId&&(t+="\nKMS_REQUEST_ID: ".concat(e.requestId)),e.statusCode&&(t+="\nKMS_STATUS_CODE: ".concat(e.statusCode)),e.errorCode&&(t+="\nKMS_ErrorCode: ".concat(e.errorCode)),t}}]),r}(R.Exception);(0,T.Z)(oe,"defaultMessage","An unknown error occurred while communicating with the kms. This implies we received an error response without a body.");var se=function(e){(0,Q.Z)(r,e);var t=ie(r);function r(){return(0,J.Z)(this,r),t.apply(this,arguments)}return(0,Y.Z)(r,[{key:"parse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.request,r=void 0===t?{}:t,n=e.timeout,i="The KMS did not respond within ".concat(n?"".concat(n," milliseconds"):"a timely fashion");return r&&(r.method&&r.uri&&(i+="\nKMS_REQUEST: ".concat(r.method," ").concat(r.uri)),r.requestId&&(i+="\nKMS_REQUEST_ID: ".concat(r.requestId))),i}}]),r}(oe),ae=function(e){(0,Q.Z)(r,e);var t=ie(r);function r(){return(0,J.Z)(this,r),t.apply(this,arguments)}return(0,Y.Z)(r,[{key:"parse",value:function(e){re()(d.Ff.prototype.parse,this,[e._res]);var t=e._res.body.message,r=t.reason||t;return r||(r=this.constructor.defaultMessage),this.options.url?r+="\n".concat(this.options.method," ").concat(this.options.url):this.options.uri?r+="\n".concat(this.options.method," ").concat(this.options.uri):r+="\n".concat(this.options.method," ").concat(this.options.service.toUpperCase(),"/").concat(this.options.resource),r+="\nWEBEX_TRACKING_ID: ".concat(this.options.headers.trackingid),t.status&&(r+="\nKMS_RESPONSE_STATUS: ".concat(t.status)),t.requestId&&(r+="\nKMS_REQUEST_ID: ".concat(t.requestId)),w()(this,{reason:{enumerable:!1,value:t.reason},requestId:{enumerable:!1,value:t.requestId},status:{enumerable:!1,value:t.status}}),r}}]),r}(d.Ff);(0,T.Z)(ae,"defaultMessage","An unknown error was received from a service that proxies to the KMS");var ce=z()("TIMEOUT_SYMBOL");const ue=d.mr.extend({namespace:"Encryption",processKmsMessageEvent:function(e){var t=this;return this.logger.info("kms-batcher: received kms message"),l().all(e.encryption.kmsMessages.map((function(e){return new(l())((function(r){r(t.acceptItem(e))}))})))},prepareItem:function(e){var t=this;return this.getDeferredForRequest(e).then((function(r){var n=e[ce];if(!n)throw new Error("timeout is required");var i=(0,H.Lr)((function(){t.logger.warn("kms: request timed out; request id: ".concat(e.requestId,"; timeout: ").concat(n)),t.handleItemFailure(e,new se({timeout:n,request:e}))}),n);return r.promise.then((function(){return clearTimeout(i)})),r.promise.catch((function(){return clearTimeout(i)})),e}))},prepareRequest:function(e){return this.webex.internal.encryption.kms._getKMSCluster().then((function(t){return{destination:t,kmsMessages:e.map((function(e){return e.wrapped}))}}))},submitHttpRequest:function(e){return this.logger.info("kms: batched-request-length",e.kmsMessages.length),this.webex.request({method:"POST",service:"encryption",resource:"/kms/messages",body:e})},handleHttpSuccess:function(){return l().resolve()},didItemFail:function(e){return l().resolve(e.status>=400)},handleItemSuccess:function(e){return this.getDeferredForResponse(e).then((function(t){t.resolve(e.body)}))},handleItemFailure:function(e,t){return function(e,t){405===e.status&&ne.includes(e.body.errorCode)&&t.internal.encryption.trigger("event:kms:key:revoke:encryption:failure")}(e,this.webex),this.getDeferredForResponse(e).then((function(r){r.reject(t||new oe(e.body))}))},fingerprintRequest:function(e){return l().resolve(e.requestId)},fingerprintResponse:function(e){return l().resolve(e.requestId)}});var le=r(27921),de=r.n(le),he=r(22013),fe=r.n(he),pe=r(78149),me=r.n(pe),ge=r(67097),ve=r(1469),ye=r.n(ve),be=r(80481);function Ee(e,t,r){var n;return e instanceof Object==!1?r:null!==(n=e[t])&&void 0!==n?n:r}function we(e,t=0,r=e.byteLength-t,n=!1){let i="";for(const o of new Uint8Array(e,t,r)){const e=o.toString(16).toUpperCase();1===e.length&&(i+="0"),i+=e,n&&(i+=" ")}return i.trim()}function Se(e,t,r,n){return t instanceof ArrayBuffer?t.byteLength?r<0?(e.error="Wrong parameter: inputOffset less than zero",!1):n<0?(e.error="Wrong parameter: inputLength less than zero",!1):!(t.byteLength-r-n<0)||(e.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):(e.error="Wrong parameter: inputBuffer has zero length",!1):(e.error='Wrong parameter: inputBuffer must be "ArrayBuffer"',!1)}function _e(e,t){let r=0;if(1===e.length)return e[0];for(let n=e.length-1;n>=0;n--)r+=e[e.length-1-n]*Math.pow(2,t*n);return r}function Te(e,t,r=-1){const n=r;let i=e,o=0,s=Math.pow(2,t);for(let r=1;r<8;r++){if(e<s){let e;if(n<0)e=new ArrayBuffer(r),o=r;else{if(n<r)return new ArrayBuffer(0);e=new ArrayBuffer(n),o=n}const s=new Uint8Array(e);for(let e=r-1;e>=0;e--){const r=Math.pow(2,e*t);s[o-e-1]=Math.floor(i/r),i-=s[o-e-1]*r}return e}s*=Math.pow(2,t)}return new ArrayBuffer(0)}function xe(...e){let t=0,r=0;for(const r of e)t+=r.byteLength;const n=new ArrayBuffer(t),i=new Uint8Array(n);for(const t of e)i.set(new Uint8Array(t),r),r+=t.byteLength;return n}function Ae(...e){let t=0,r=0;for(const r of e)t+=r.length;const n=new ArrayBuffer(t),i=new Uint8Array(n);for(const t of e)i.set(t,r),r+=t.length;return i}function Ie(){const e=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const t=255===e[0]&&128&e[1],r=0===e[0]&&0==(128&e[1]);(t||r)&&this.warnings.push("Needlessly long format")}const t=new ArrayBuffer(this.valueHex.byteLength),r=new Uint8Array(t);for(let e=0;e<this.valueHex.byteLength;e++)r[e]=0;r[0]=128&e[0];const n=_e(r,8),i=new ArrayBuffer(this.valueHex.byteLength),o=new Uint8Array(i);for(let t=0;t<this.valueHex.byteLength;t++)o[t]=e[t];o[0]&=127;return _e(o,8)-n}function Ce(e){const t=e<0?-1*e:e;let r=128;for(let n=1;n<8;n++){if(t<=r){if(e<0){const e=Te(r-t,8,n);return new Uint8Array(e)[0]|=128,e}let i=Te(t,8,n),o=new Uint8Array(i);if(128&o[0]){const e=i.slice(0),t=new Uint8Array(e);i=new ArrayBuffer(i.byteLength+1),o=new Uint8Array(i);for(let r=0;r<e.byteLength;r++)o[r+1]=t[r];o[0]=0}return i}r*=Math.pow(2,8)}return new ArrayBuffer(0)}function Re(e,t){if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),n=new Uint8Array(t);for(let e=0;e<r.length;e++)if(r[e]!==n[e])return!1;return!0}function ke(e,t){const r=e.toString(10);if(t<r.length)return"";const n=t-r.length,i=new Array(n);for(let e=0;e<n;e++)i[e]="0";return i.join("").concat(r)}const Oe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Ne="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=";function Pe(e,t=!1,r=!1,n=!1){let i=0,o=0,s=0,a="";const c=t?Ne:Oe;if(n){let t=0;for(let r=0;r<e.length;r++)if(0!==e.charCodeAt(r)){t=r;break}e=e.slice(t)}for(;i<e.length;){const t=e.charCodeAt(i++);i>=e.length&&(o=1);const n=e.charCodeAt(i++);i>=e.length&&(s=1);const u=e.charCodeAt(i++),l=t>>2,d=(3&t)<<4|n>>4;let h=(15&n)<<2|u>>6,f=63&u;1===o?h=f=64:1===s&&(f=64),a+=r?64===h?`${c.charAt(l)}${c.charAt(d)}`:64===f?`${c.charAt(l)}${c.charAt(d)}${c.charAt(h)}`:`${c.charAt(l)}${c.charAt(d)}${c.charAt(h)}${c.charAt(f)}`:`${c.charAt(l)}${c.charAt(d)}${c.charAt(h)}${c.charAt(f)}`}return a}function Le(e,t=!1,r=!1){const n=t?Ne:Oe;function i(e){for(let t=0;t<64;t++)if(n.charAt(t)===e)return t;return 64}function o(e){return 64===e?0:e}let s=0,a="";for(;s<e.length;){const t=i(e.charAt(s++)),r=s>=e.length?0:i(e.charAt(s++)),n=s>=e.length?0:i(e.charAt(s++)),c=s>=e.length?0:i(e.charAt(s++)),u=o(t)<<2|o(r)>>4,l=(15&o(r))<<4|o(n)>>2,d=(3&o(n))<<6|o(c);a+=String.fromCharCode(u),64!==n&&(a+=String.fromCharCode(l)),64!==c&&(a+=String.fromCharCode(d))}if(r){let e=-1;for(let t=a.length-1;t>=0;t--)if(0!==a.charCodeAt(t)){e=t;break}a=-1!==e?a.slice(0,e+1):""}return a}function De(e){let t="";const r=new Uint8Array(e);for(const e of r)t+=String.fromCharCode(e);return t}function Me(e){const t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r);for(let r=0;r<t;r++)n[r]=e.charCodeAt(r);return r}const Ue=Math.log(2);function Be(e){const t=Math.log(e)/Ue,r=Math.floor(t),n=Math.round(t);return r===n?r:n}function Fe(e,t){for(const r of t)delete e[r]}function je(){if("undefined"==typeof BigInt)throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function Ve(e){if(e.idBlock.isConstructed)for(let t=0;t<e.valueBlock.value.length;t++)Ve(e.valueBlock.value[t])&&(e.lenBlock.isIndefiniteForm=!0);return!!e.lenBlock.isIndefiniteForm}function He(e){let t=0,r=0;for(let r=0;r<e.length;r++){t+=e[r].byteLength}const n=new ArrayBuffer(t),i=new Uint8Array(n);for(let t=0;t<e.length;t++){const n=e[t];i.set(new Uint8Array(n),r),r+=n.byteLength}return n}const Ge=[new Uint8Array([1])],qe="0123456789",$e="name",Ze="valueHex",ze="isHexOnly",Ke="idBlock",We="tagClass",Je="tagNumber",Ye="isConstructed",Qe="isIndefiniteForm",Xe="optional",et="primitiveSchema",tt="value",rt="valueDate",nt="valueDec",it="",ot=new ArrayBuffer(0);class st{constructor(){this.items=[]}write(e){this.items.push(e)}final(){return He(this.items)}}class at{constructor(e={}){this.blockLength=Ee(e,"blockLength",0),this.error=Ee(e,"error",it),this.warnings=Ee(e,"warnings",[]),this.valueBeforeDecode="valueBeforeDecode"in e?e.valueBeforeDecode.slice(0):ot}static blockName(){return"baseBlock"}toJSON(){return{blockName:this.constructor.blockName(),blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:we(this.valueBeforeDecode,0,this.valueBeforeDecode.byteLength)}}}const ct=e=>class extends e{constructor(e={}){super(e),this.isHexOnly=Ee(e,ze,!1),this.valueHex=Ze in e?e.valueHex.slice(0):ot}static blockName(){return"hexBlock"}fromBER(e,t,r){if(!1===Se(this,e,t,r))return-1;return 0===new Uint8Array(e,t,r).length?(this.warnings.push("Zero buffer length"),t):(this.valueHex=e.slice(t,t+r),this.blockLength=r,t+r)}toBER(e=!1){return!0!==this.isHexOnly?(this.error='Flag "isHexOnly" is not set, abort',ot):!0===e?new ArrayBuffer(this.valueHex.byteLength):this.valueHex.slice(0)}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.blockName=this.constructor.blockName(),e.isHexOnly=this.isHexOnly,e.valueHex=we(this.valueHex,0,this.valueHex.byteLength),e}};class ut extends(ct(at)){constructor(e={}){super(),Ke in e?(this.isHexOnly=Ee(e.idBlock,ze,!1),this.valueHex=Ee(e.idBlock,Ze,ot),this.tagClass=Ee(e.idBlock,We,-1),this.tagNumber=Ee(e.idBlock,Je,-1),this.isConstructed=Ee(e.idBlock,Ye,!1)):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}static blockName(){return"identificationBlock"}toBER(e=!1){let t,r,n=0;switch(this.tagClass){case 1:n|=0;break;case 2:n|=64;break;case 3:n|=128;break;case 4:n|=192;break;default:return this.error="Unknown tag class",ot}if(this.isConstructed&&(n|=32),this.tagNumber<31&&!this.isHexOnly){if(t=new ArrayBuffer(1),r=new Uint8Array(t),!e){let e=this.tagNumber;e&=31,n|=e,r[0]=n}return t}if(!1===this.isHexOnly){const i=Te(this.tagNumber,7),o=new Uint8Array(i),s=i.byteLength;if(t=new ArrayBuffer(s+1),r=new Uint8Array(t),r[0]=31|n,!e){for(let e=0;e<s-1;e++)r[e+1]=128|o[e];r[s]=o[s-1]}return t}if(t=new ArrayBuffer(this.valueHex.byteLength+1),r=new Uint8Array(t),r[0]=31|n,!1===e){const e=new Uint8Array(this.valueHex);for(let t=0;t<e.length-1;t++)r[t+1]=128|e[t];r[this.valueHex.byteLength]=e[e.length-1]}return t}fromBER(e,t,r){if(!1===Se(this,e,t,r))return-1;const n=new Uint8Array(e,t,r);if(0===n.length)return this.error="Zero buffer length",-1;switch(192&n[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=32==(32&n[0]),this.isHexOnly=!1;const i=31&n[0];if(31!==i)this.tagNumber=i,this.blockLength=1;else{let e=1;this.valueHex=new ArrayBuffer(255);let t=255,r=new Uint8Array(this.valueHex);for(;128&n[e];){if(r[e-1]=127&n[e],e++,e>=n.length)return this.error="End of input reached before message was fully decoded",-1;if(e===t){t+=255;const e=new ArrayBuffer(t),n=new Uint8Array(e);for(let e=0;e<r.length;e++)n[e]=r[e];this.valueHex=new ArrayBuffer(t),r=new Uint8Array(this.valueHex)}}this.blockLength=e+1,r[e-1]=127&n[e];const i=new ArrayBuffer(e),o=new Uint8Array(i);for(let t=0;t<e;t++)o[t]=r[t];this.valueHex=new ArrayBuffer(e),r=new Uint8Array(this.valueHex),r.set(o),this.blockLength<=9?this.tagNumber=_e(r,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.blockName=this.constructor.blockName(),e.tagClass=this.tagClass,e.tagNumber=this.tagNumber,e.isConstructed=this.isConstructed,e}}class lt extends at{constructor(e={}){super(),"lenBlock"in e?(this.isIndefiniteForm=Ee(e.lenBlock,Qe,!1),this.longFormUsed=Ee(e.lenBlock,"longFormUsed",!1),this.length=Ee(e.lenBlock,"length",0)):(this.isIndefiniteForm=!1,this.longFormUsed=!1,this.length=0)}static blockName(){return"lengthBlock"}fromBER(e,t,r){if(!1===Se(this,e,t,r))return-1;const n=new Uint8Array(e,t,r);if(0===n.length)return this.error="Zero buffer length",-1;if(255===n[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===n[0],!0===this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&n[0]),!1===this.longFormUsed)return this.length=n[0],this.blockLength=1,t+this.blockLength;const i=127&n[0];if(i>8)return this.error="Too big integer",-1;if(i+1>n.length)return this.error="End of input reached before message was fully decoded",-1;const o=new Uint8Array(i);for(let e=0;e<i;e++)o[e]=n[e+1];return 0===o[i-1]&&this.warnings.push("Needlessly long encoded length"),this.length=_e(o,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=i+1,t+this.blockLength}toBER(e=!1){let t,r;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=128),t;if(!0===this.longFormUsed){const n=Te(this.length,8);if(n.byteLength>127)return this.error="Too big length",ot;if(t=new ArrayBuffer(n.byteLength+1),!0===e)return t;const i=new Uint8Array(n);r=new Uint8Array(t),r[0]=128|n.byteLength;for(let e=0;e<n.byteLength;e++)r[e+1]=i[e];return t}return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=this.length),t}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.blockName=this.constructor.blockName(),e.isIndefiniteForm=this.isIndefiniteForm,e.longFormUsed=this.longFormUsed,e.length=this.length,e}}class dt extends at{constructor(e={}){super(e)}static blockName(){return"valueBlock"}fromBER(e,t,r){throw TypeError('User need to make a specific function in a class which extends "ValueBlock"')}toBER(e=!1){throw TypeError('User need to make a specific function in a class which extends "ValueBlock"')}}class ht extends at{constructor(e={},t=dt){super(e),$e in e&&(this.name=e.name),Xe in e&&(this.optional=e.optional),et in e&&(this.primitiveSchema=e.primitiveSchema),this.idBlock=new ut(e),this.lenBlock=new lt(e),this.valueBlock=new t(e)}static blockName(){return"BaseBlock"}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}toBER(e=!1,t){const r=t||new st;t||Ve(this);const n=this.idBlock.toBER(e);if(r.write(n),this.lenBlock.isIndefiniteForm)r.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,r),r.write(new ArrayBuffer(2));else{const t=this.valueBlock.toBER(!0);this.lenBlock.length=t.byteLength;const n=this.lenBlock.toBER(e);r.write(n);const i=e?new ArrayBuffer(this.lenBlock.length):this.valueBlock.toBER(e);r.write(i,r)}if(!t)return r.final()}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.idBlock=this.idBlock.toJSON(),e.lenBlock=this.lenBlock.toJSON(),e.valueBlock=this.valueBlock.toJSON(),$e in this&&(e.name=this.name),Xe in this&&(e.optional=this.optional),et in this&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(){return`${this.constructor.blockName()} : ${we(this.valueBlock.valueHex)}`}}class ft extends dt{constructor(e={}){super(e),this.valueHex=Ze in e?e.valueHex.slice(0):ot,this.isHexOnly=Ee(e,ze,!0)}fromBER(e,t,r){if(!1===Se(this,e,t,r))return-1;const n=new Uint8Array(e,t,r);if(0===n.length)return this.warnings.push("Zero buffer length"),t;this.valueHex=new ArrayBuffer(n.length);const i=new Uint8Array(this.valueHex);for(let e=0;e<n.length;e++)i[e]=n[e];return this.blockLength=r,t+r}toBER(e=!1){return this.valueHex.slice(0)}static blockName(){return"PrimitiveValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.valueHex=we(this.valueHex,0,this.valueHex.byteLength),e.isHexOnly=this.isHexOnly,e}}class pt extends ht{constructor(e={}){super(e,ft),this.idBlock.isConstructed=!1}static blockName(){return"PRIMITIVE"}}class mt extends dt{constructor(e={}){super(e),this.value=Ee(e,tt,[]),this.isIndefiniteForm=Ee(e,Qe,!1)}fromBER(e,t,r){const n=t,i=r;if(!1===Se(this,e,t,r))return-1;if(0===new Uint8Array(e,t,r).length)return this.warnings.push("Zero buffer length"),t;let o=t;for(;s=this.isIndefiniteForm,a=r,(!0===s?1:a)>0;){const t=ar(e,o,r);if(-1===t.offset)return this.error=t.result.error,this.warnings.concat(t.result.warnings),-1;if(o=t.offset,this.blockLength+=t.result.blockLength,r-=t.result.blockLength,this.value.push(t.result),!0===this.isIndefiniteForm&&t.result.constructor.blockName()===yt.blockName())break}var s,a;return!0===this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.blockName()===yt.blockName()?this.value.pop():this.warnings.push("No EndOfContent block encoded")),this.valueBeforeDecode=e.slice(n,n+i),o}toBER(e=!1,t){const r=t||new st;for(let t=0;t<this.value.length;t++)this.value[t].toBER(e,r);if(!t)return r.final()}static blockName(){return"ConstructedValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}e.isIndefiniteForm=this.isIndefiniteForm,e.value=[];for(let t=0;t<this.value.length;t++)e.value.push(this.value[t].toJSON());return e}}class gt extends ht{constructor(e={}){super(e,mt),this.idBlock.isConstructed=!0}static blockName(){return"CONSTRUCTED"}fromBER(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}toString(){const e=[];for(const t of this.valueBlock.value)e.push(t.toString().split("\n").map((e=>`  ${e}`)).join("\n"));const t=3===this.idBlock.tagClass?`[${this.idBlock.tagNumber}]`:this.constructor.blockName();return e.length?`${t} :\n${e.join("\n")}`:`${t} :`}}class vt extends dt{constructor(e={}){super(e)}fromBER(e,t,r){return t}toBER(e=!1){return ot}static blockName(){return"EndOfContentValueBlock"}}class yt extends ht{constructor(e={}){super(e,vt),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}static blockName(){return"EndOfContent"}}class bt extends dt{constructor(e={}){if(super(e),this.value=Ee(e,tt,!1),this.isHexOnly=Ee(e,ze,!1),Ze in e)this.valueHex=e.valueHex.slice(0);else if(this.valueHex=new ArrayBuffer(1),!0===this.value){new Uint8Array(this.valueHex)[0]=255}}fromBER(e,t,r){if(!1===Se(this,e,t,r))return-1;const n=new Uint8Array(e,t,r);r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,this.valueHex=new ArrayBuffer(n.length);const i=new Uint8Array(this.valueHex);for(let e=0;e<n.length;e++)i[e]=n[e];return 0!==Ie.call(this)?this.value=!0:this.value=!1,this.blockLength=r,t+r}toBER(e=!1){return this.valueHex}static blockName(){return"BooleanValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.value=this.value,e.isHexOnly=this.isHexOnly,e.valueHex=we(this.valueHex,0,this.valueHex.byteLength),e}}class Et extends ht{constructor(e={}){super(e,bt),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}static blockName(){return"BOOLEAN"}toString(){return`${this.constructor.blockName()} : ${this.valueBlock.value}`}}class wt extends gt{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}static blockName(){return"SEQUENCE"}}class St extends gt{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}static blockName(){return"SET"}}class _t extends ht{constructor(e={}){super(e,at),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}static blockName(){return"NULL"}fromBER(e,t,r){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,t+r>e.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+r}toBER(e=!1,t){const r=new ArrayBuffer(2);if(!e){const e=new Uint8Array(r);e[0]=5,e[1]=0}return t&&t.write(r),r}toString(){return`${this.constructor.blockName()}`}}class Tt extends(ct(mt)){constructor(e={}){super(e),this.isConstructed=Ee(e,Ye,!1)}fromBER(e,t,r){let n=0;if(!0===this.isConstructed){if(this.isHexOnly=!1,n=mt.prototype.fromBER.call(this,e,t,r),-1===n)return n;for(let e=0;e<this.value.length;e++){const t=this.value[e].constructor.blockName();if(t===yt.blockName()){if(!0===this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(t!==xt.blockName())return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,n=super.fromBER(e,t,r),this.blockLength=r;return n}toBER(e=!1,t){if(!0===this.isConstructed)return mt.prototype.toBER.call(this,e,t);let r=new ArrayBuffer(this.valueHex.byteLength);return!0===e||0===this.valueHex.byteLength||(r=this.valueHex.slice(0)),r}static blockName(){return"OctetStringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.isConstructed=this.isConstructed,e.isHexOnly=this.isHexOnly,e.valueHex=we(this.valueHex,0,this.valueHex.byteLength),e}}class xt extends ht{constructor(e={}){super(e,Tt),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,r){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===r)return 0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){const n=e.slice(t,t+r);try{const e=cr(n);-1!==e.offset&&e.offset===r&&(this.valueBlock.value=[e.result])}catch(e){}}return super.fromBER(e,t,r)}static blockName(){return"OCTET STRING"}isEqual(e){return e instanceof xt!=!1&&JSON.stringify(this)===JSON.stringify(e)}toString(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?gt.prototype.toString.call(this):`${this.constructor.blockName()} : ${we(this.valueBlock.valueHex)}`}}class At extends(ct(mt)){constructor(e={}){super(e),this.unusedBits=Ee(e,"unusedBits",0),this.isConstructed=Ee(e,Ye,!1),this.blockLength=this.valueHex.byteLength}fromBER(e,t,r){if(0===r)return t;let n=-1;if(!0===this.isConstructed){if(n=mt.prototype.fromBER.call(this,e,t,r),-1===n)return n;for(let e=0;e<this.value.length;e++){const t=this.value[e].constructor.blockName();if(t===yt.blockName()){if(!0===this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(t!==It.blockName())return this.error="BIT STRING may consists of BIT STRINGs only",-1;if(this.unusedBits>0&&this.value[e].valueBlock.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;if(this.unusedBits=this.value[e].valueBlock.unusedBits,this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1}return n}if(!1===Se(this,e,t,r))return-1;const i=new Uint8Array(e,t,r);if(this.unusedBits=i[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const n=e.slice(t+1,t+r);try{const e=cr(n);-1!==e.offset&&e.offset===r-1&&(this.value=[e.result])}catch(e){}}this.valueHex=new ArrayBuffer(i.length-1);const o=new Uint8Array(this.valueHex);for(let e=0;e<r-1;e++)o[e]=i[e+1];return this.blockLength=i.length,t+r}toBER(e=!1,t){if(!0===this.isConstructed)return mt.prototype.toBER.call(this,e,t);if(!0===e)return new ArrayBuffer(this.valueHex.byteLength+1);if(0===this.valueHex.byteLength)return ot;const r=new Uint8Array(this.valueHex),n=new ArrayBuffer(this.valueHex.byteLength+1),i=new Uint8Array(n);i[0]=this.unusedBits;for(let e=0;e<this.valueHex.byteLength;e++)i[e+1]=r[e];return n}static blockName(){return"BitStringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.unusedBits=this.unusedBits,e.isConstructed=this.isConstructed,e.isHexOnly=this.isHexOnly,e.valueHex=we(this.valueHex,0,this.valueHex.byteLength),e}}class It extends ht{constructor(e={}){super(e,At),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}static blockName(){return"BIT STRING"}fromBER(e,t,r){return 0===r?t:(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,r))}isEqual(e){return e instanceof It!=!1&&JSON.stringify(this)===JSON.stringify(e)}toString(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return gt.prototype.toString.call(this);{const e=[],t=new Uint8Array(this.valueBlock.valueHex);for(const r of t)e.push(r.toString(2).padStart(8,"0"));return`${this.constructor.blockName()} : ${e.join("")}`}}}class Ct extends(ct(dt)){constructor(e={}){super(e),tt in e&&(this.valueDec=e.value)}set valueHex(e){this._valueHex=e.slice(0),e.byteLength>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,e.byteLength>0&&(this._valueDec=Ie.call(this)))}get valueHex(){return this._valueHex}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this._valueHex=Ce(e)}get valueDec(){return this._valueDec}fromDER(e,t,r,n=0){const i=this.fromBER(e,t,r);if(-1===i)return i;const o=new Uint8Array(this._valueHex);if(0===o[0]&&0!=(128&o[1])){const e=new ArrayBuffer(this._valueHex.byteLength-1);new Uint8Array(e).set(new Uint8Array(this._valueHex,1,this._valueHex.byteLength-1)),this._valueHex=e.slice(0)}else if(0!==n&&this._valueHex.byteLength<n){n-this._valueHex.byteLength>1&&(n=this._valueHex.byteLength+1);const e=new ArrayBuffer(n);new Uint8Array(e).set(o,n-this._valueHex.byteLength),this._valueHex=e.slice(0)}return i}toDER(e=!1){const t=new Uint8Array(this._valueHex);switch(!0){case 0!=(128&t[0]):{const e=new ArrayBuffer(this._valueHex.byteLength+1),r=new Uint8Array(e);r[0]=0,r.set(t,1),this._valueHex=e.slice(0)}break;case 0===t[0]&&0==(128&t[1]):{const e=new ArrayBuffer(this._valueHex.byteLength-1);new Uint8Array(e).set(new Uint8Array(this._valueHex,1,this._valueHex.byteLength-1)),this._valueHex=e.slice(0)}}return this.toBER(e)}fromBER(e,t,r){const n=super.fromBER(e,t,r);return-1===n?n:(this.blockLength=r,t+r)}toBER(e=!1){return this.valueHex.slice(0)}static blockName(){return"IntegerValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.valueDec=this.valueDec,e}toString(){function e(e,t){const r=new Uint8Array([0]);let n=new Uint8Array(e),i=new Uint8Array(t),o=n.slice(0);const s=o.length-1;let a=i.slice(0);const c=a.length-1;let u=0;let l=0;for(let e=c<s?s:c;e>=0;e--,l++){if(!0==l<a.length)u=o[s-l]+a[c-l]+r[0];else u=o[s-l]+r[0];if(r[0]=u/10,!0==l>=o.length)o=Ae(new Uint8Array([u%10]),o);else o[s-l]=u%10}return r[0]>0&&(o=Ae(r,o)),o.slice(0)}function t(e){if(e>=Ge.length)for(let t=Ge.length;t<=e;t++){const e=new Uint8Array([0]);let r=Ge[t-1].slice(0);for(let t=r.length-1;t>=0;t--){const n=new Uint8Array([(r[t]<<1)+e[0]]);e[0]=n[0]/10,r[t]=n[0]%10}e[0]>0&&(r=Ae(e,r)),Ge.push(r)}return Ge[e]}function r(e,t){let r=0,n=new Uint8Array(e),i=new Uint8Array(t),o=n.slice(0);const s=o.length-1;let a=i.slice(0);const c=a.length-1;let u,l=0;for(let e=c;e>=0;e--,l++)if(u=o[s-l]-a[c-l]-r,!0==u<0)r=1,o[s-l]=u+10;else r=0,o[s-l]=u;if(r>0)for(let e=s-c+1;e>=0;e--,l++){if(u=o[s-l]-r,!(u<0)){r=0,o[s-l]=u;break}r=1,o[s-l]=u+10}return o.slice()}const n=8*this._valueHex.byteLength-1;let i,o=new Uint8Array(8*this._valueHex.byteLength/3),s=0;const a=new Uint8Array(this._valueHex);let c="",u=!1;for(let u=this._valueHex.byteLength-1;u>=0;u--){i=a[u];for(let a=0;a<8;a++){if(1==(1&i))if(s===n)o=r(t(s),o),c="-";else o=e(o,t(s));s++,i>>=1}}for(let e=0;e<o.length;e++)o[e]&&(u=!0),u&&(c+=qe.charAt(o[e]));return!1===u&&(c+=qe.charAt(0)),c}}class Rt extends ht{constructor(e={}){super(e,Ct),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}static blockName(){return"INTEGER"}isEqual(e){return e instanceof Rt?this.valueBlock.isHexOnly&&e.valueBlock.isHexOnly?Re(this.valueBlock.valueHex,e.valueBlock.valueHex):this.valueBlock.isHexOnly===e.valueBlock.isHexOnly&&this.valueBlock.valueDec===e.valueBlock.valueDec:e instanceof ArrayBuffer&&Re(this.valueBlock.valueHex,e)}convertToDER(){const e=new Rt({valueHex:this.valueBlock.valueHex});return e.valueBlock.toDER(),e}convertFromDER(){const e=this.valueBlock.valueHex.byteLength%2?this.valueBlock.valueHex.byteLength+1:this.valueBlock.valueHex.byteLength,t=new Rt({valueHex:this.valueBlock.valueHex});return t.valueBlock.fromDER(t.valueBlock.valueHex,0,t.valueBlock.valueHex.byteLength,e),t}toString(){je();const e=we(this.valueBlock.valueHex),t=BigInt(`0x${e}`);return`${this.constructor.blockName()} : ${t.toString()}`}}class kt extends Rt{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}static blockName(){return"ENUMERATED"}}class Ot extends(ct(at)){constructor(e={}){super(e),this.valueDec=Ee(e,nt,-1),this.isFirstSid=Ee(e,"isFirstSid",!1)}static blockName(){return"sidBlock"}fromBER(e,t,r){if(0===r)return t;if(!1===Se(this,e,t,r))return-1;const n=new Uint8Array(e,t,r);this.valueHex=new ArrayBuffer(r);let i=new Uint8Array(this.valueHex);for(let e=0;e<r&&(i[e]=127&n[e],this.blockLength++,0!=(128&n[e]));e++);const o=new ArrayBuffer(this.blockLength),s=new Uint8Array(o);for(let e=0;e<this.blockLength;e++)s[e]=i[e];return this.valueHex=o.slice(0),i=new Uint8Array(this.valueHex),0!=(128&n[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===i[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=_e(i,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){je();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;const r=new Uint8Array(t.length/7);for(let e=0;e<r.length;e++)r[e]=parseInt(t.slice(7*e,7*e+7),2)+(e+1<r.length?128:0);this.fromBER(r.buffer,0,r.length)}toBER(e=!1){let t,r;if(this.isHexOnly){if(!0===e)return new ArrayBuffer(this.valueHex.byteLength);const n=new Uint8Array(this.valueHex);t=new ArrayBuffer(this.blockLength),r=new Uint8Array(t);for(let e=0;e<this.blockLength-1;e++)r[e]=128|n[e];return r[this.blockLength-1]=n[this.blockLength-1],t}const n=Te(this.valueDec,7);if(0===n.byteLength)return this.error="Error during encoding SID value",ot;if(t=new ArrayBuffer(n.byteLength),!1===e){const e=new Uint8Array(n);r=new Uint8Array(t);for(let t=0;t<n.byteLength-1;t++)r[t]=128|e[t];r[n.byteLength-1]=e[n.byteLength-1]}return t}toString(){let e="";if(!0===this.isHexOnly)e=we(this.valueHex,0,this.valueHex.byteLength);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.valueDec=this.valueDec,e.isFirstSid=this.isFirstSid,e}}class Nt extends dt{constructor(e={}){super(e),this.fromString(Ee(e,tt,it))}fromBER(e,t,r){let n=t;for(;r>0;){const t=new Ot;if(n=t.fromBER(e,n,r),-1===n)return this.blockLength=0,this.error=t.error,n;0===this.value.length&&(t.isFirstSid=!0),this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return n}toBER(e=!1){const t=[];for(let r=0;r<this.value.length;r++){const n=this.value[r].toBER(e);if(0===n.byteLength)return this.error=this.value[r].error,ot;t.push(n)}return He(t)}fromString(e){this.value=[];let t=0,r=0,n="",i=!1;do{if(r=e.indexOf(".",t),n=-1===r?e.substr(t):e.substr(t,r-t),t=r+1,i){const e=this.value[0];let t=0;switch(e.valueDec){case 0:break;case 1:t=40;break;case 2:t=80;break;default:return this.value=[],!1}const r=parseInt(n,10);if(isNaN(r))return!0;e.valueDec=r+t,i=!1}else{const e=new Ot;if(n>Number.MAX_SAFE_INTEGER){je();const t=BigInt(n);e.valueBigInt=t}else if(e.valueDec=parseInt(n,10),isNaN(e.valueDec))return!0;0===this.value.length&&(e.isFirstSid=!0,i=!0),this.value.push(e)}}while(-1!==r);return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let n=this.value[r].toString();0!==r&&(e=`${e}.`),t?(n=`{${n}}`,this.value[r].isFirstSid?e=`2.{${n} - 80}`:e+=n):e+=n}return e}static blockName(){return"ObjectIdentifierValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}e.value=this.toString(),e.sidArray=[];for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}class Pt extends ht{constructor(e={}){super(e,Nt),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}static blockName(){return"OBJECT IDENTIFIER"}toString(){return`${this.constructor.blockName()} : ${this.valueBlock.toString()}`}}class Lt extends(ct(at)){constructor(e={}){super(e),this.isHexOnly=!0,this.value=""}static blockName(){return"Utf8StringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.value=this.value,e}}class Dt extends ht{constructor(e={}){super(e,Lt),tt in e&&this.fromString(e.value),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}static blockName(){return"UTF8String"}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,new Uint8Array(e));try{this.valueBlock.value=decodeURIComponent(escape(this.valueBlock.value))}catch(e){this.warnings.push(`Error during "decodeURIComponent": ${e}, using raw string`)}}fromString(e){const t=unescape(encodeURIComponent(e)),r=t.length;this.valueBlock.valueHex=new ArrayBuffer(r);const n=new Uint8Array(this.valueBlock.valueHex);for(let e=0;e<r;e++)n[e]=t.charCodeAt(e);this.valueBlock.value=e}toString(){return`${this.constructor.blockName()} : ${this.valueBlock.value}`}}class Mt extends(ct(at)){constructor(e={}){super(e),this.valueDec=Ee(e,nt,-1)}static blockName(){return"relativeSidBlock"}fromBER(e,t,r){if(0===r)return t;if(!1===Se(this,e,t,r))return-1;const n=new Uint8Array(e,t,r);this.valueHex=new ArrayBuffer(r);let i=new Uint8Array(this.valueHex);for(let e=0;e<r&&(i[e]=127&n[e],this.blockLength++,0!=(128&n[e]));e++);const o=new ArrayBuffer(this.blockLength),s=new Uint8Array(o);for(let e=0;e<this.blockLength;e++)s[e]=i[e];return this.valueHex=o.slice(0),i=new Uint8Array(this.valueHex),0!=(128&n[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===i[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=_e(i,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e=!1){let t,r;if(this.isHexOnly){if(!0===e)return new ArrayBuffer(this.valueHex.byteLength);const n=new Uint8Array(this.valueHex);t=new ArrayBuffer(this.blockLength),r=new Uint8Array(t);for(let e=0;e<this.blockLength-1;e++)r[e]=128|n[e];return r[this.blockLength-1]=n[this.blockLength-1],t}const n=Te(this.valueDec,7);if(0===n.byteLength)return this.error="Error during encoding SID value",ot;if(t=new ArrayBuffer(n.byteLength),!1===e){const e=new Uint8Array(n);r=new Uint8Array(t);for(let t=0;t<n.byteLength-1;t++)r[t]=128|e[t];r[n.byteLength-1]=e[n.byteLength-1]}return t}toString(){let e="";return e=!0===this.isHexOnly?we(this.valueHex,0,this.valueHex.byteLength):this.valueDec.toString(),e}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.valueDec=this.valueDec,e}}class Ut extends dt{constructor(e={}){super(e),this.fromString(Ee(e,tt,it))}fromBER(e,t,r){let n=t;for(;r>0;){const t=new Mt;if(n=t.fromBER(e,n,r),-1===n)return this.blockLength=0,this.error=t.error,n;this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return n}toBER(e=!1){let t=[];for(let r=0;r<this.value.length;r++){const n=this.value[r].toBER(e);if(0===n.byteLength)return this.error=this.value[r].error,ot;t.push(n)}return He(t)}fromString(e){this.value=[];let t=0,r=0,n="";do{r=e.indexOf(".",t),n=-1===r?e.substr(t):e.substr(t,r-t),t=r+1;const i=new Mt;if(i.valueDec=parseInt(n,10),isNaN(i.valueDec))return!0;this.value.push(i)}while(-1!==r);return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let n=this.value[r].toString();0!==r&&(e=`${e}.`),t?(n=`{${n}}`,e+=n):e+=n}return e}static blockName(){return"RelativeObjectIdentifierValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}e.value=this.toString(),e.sidArray=[];for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}class Bt extends ht{constructor(e={}){super(e,Ut),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}static blockName(){return"RelativeObjectIdentifier"}}class Ft extends(ct(at)){constructor(e={}){super(e),this.isHexOnly=!0,this.value=""}static blockName(){return"BmpStringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.value=this.value,e}}class jt extends ht{constructor(e={}){super(e,Ft),tt in e&&this.fromString(e.value),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}static blockName(){return"BMPString"}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){const t=e.slice(0),r=new Uint8Array(t);for(let e=0;e<r.length;e+=2){const t=r[e];r[e]=r[e+1],r[e+1]=t}this.valueBlock.value=String.fromCharCode.apply(null,new Uint16Array(t))}fromString(e){const t=e.length;this.valueBlock.valueHex=new ArrayBuffer(2*t);const r=new Uint8Array(this.valueBlock.valueHex);for(let n=0;n<t;n++){const t=Te(e.charCodeAt(n),8),i=new Uint8Array(t);if(i.length>2)continue;const o=2-i.length;for(let e=i.length-1;e>=0;e--)r[2*n+e+o]=i[e]}this.valueBlock.value=e}toString(){return`${this.constructor.blockName()} : ${this.valueBlock.value}`}}class Vt extends(ct(at)){constructor(e={}){super(e),this.isHexOnly=!0,this.value=""}static blockName(){return"UniversalStringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.value=this.value,e}}class Ht extends ht{constructor(e={}){super(e,Vt),tt in e&&this.fromString(e.value),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}static blockName(){return"UniversalString"}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){const t=e.slice(0),r=new Uint8Array(t);for(let e=0;e<r.length;e+=4)r[e]=r[e+3],r[e+1]=r[e+2],r[e+2]=0,r[e+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){const t=e.length;this.valueBlock.valueHex=new ArrayBuffer(4*t);const r=new Uint8Array(this.valueBlock.valueHex);for(let n=0;n<t;n++){const t=Te(e.charCodeAt(n),8),i=new Uint8Array(t);if(i.length>4)continue;const o=4-i.length;for(let e=i.length-1;e>=0;e--)r[4*n+e+o]=i[e]}this.valueBlock.value=e}toString(){return`${this.constructor.blockName()} : ${this.valueBlock.value}`}}class Gt extends(ct(at)){constructor(e={}){super(e),this.value="",this.isHexOnly=!0}static blockName(){return"SimpleStringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.value=this.value,e}}class qt extends ht{constructor(e={}){super(e,Gt),tt in e&&this.fromString(e.value)}static blockName(){return"SIMPLESTRING"}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,new Uint8Array(e))}fromString(e){const t=e.length;this.valueBlock.valueHex=new ArrayBuffer(t);const r=new Uint8Array(this.valueBlock.valueHex);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);this.valueBlock.value=e}toString(){return`${this.constructor.blockName()} : ${this.valueBlock.value}`}}class $t extends qt{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}static blockName(){return"NumericString"}}class Zt extends qt{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}static blockName(){return"PrintableString"}}class zt extends qt{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}static blockName(){return"TeletexString"}}class Kt extends qt{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}static blockName(){return"VideotexString"}}class Wt extends qt{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}static blockName(){return"IA5String"}}class Jt extends qt{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}static blockName(){return"GraphicString"}}class Yt extends qt{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}static blockName(){return"VisibleString"}}class Qt extends qt{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}static blockName(){return"GeneralString"}}class Xt extends qt{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}static blockName(){return"CharacterString"}}class er extends Yt{constructor(e={}){if(super(e),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,tt in e){this.fromString(e.value),this.valueBlock.valueHex=new ArrayBuffer(e.value.length);const t=new Uint8Array(this.valueBlock.valueHex);for(let r=0;r<e.value.length;r++)t[r]=e.value.charCodeAt(r)}rt in e&&(this.fromDate(e.valueDate),this.valueBlock.valueHex=this.toBuffer()),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,new Uint8Array(e)))}toBuffer(){const e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){const t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi.exec(e);if(null===t)return void(this.error="Wrong input string for conversion");const r=parseInt(t[1],10);this.year=r>=50?1900+r:2e3+r,this.month=parseInt(t[2],10),this.day=parseInt(t[3],10),this.hour=parseInt(t[4],10),this.minute=parseInt(t[5],10),this.second=parseInt(t[6],10)}toString(){const e=new Array(7);return e[0]=ke(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=ke(this.month,2),e[2]=ke(this.day,2),e[3]=ke(this.hour,2),e[4]=ke(this.minute,2),e[5]=ke(this.second,2),e[6]="Z",e.join("")}static blockName(){return"UTCTime"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.year=this.year,e.month=this.month,e.day=this.day,e.hour=this.hour,e.minute=this.minute,e.second=this.second,e}}class tr extends Yt{constructor(e={}){if(super(e),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,this.millisecond=0,tt in e){this.fromString(e.value),this.valueBlock.valueHex=new ArrayBuffer(e.value.length);const t=new Uint8Array(this.valueBlock.valueHex);for(let r=0;r<e.value.length;r++)t[r]=e.value.charCodeAt(r)}rt in e&&(this.fromDate(e.valueDate),this.valueBlock.valueHex=this.toBuffer()),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,new Uint8Array(e)))}toBuffer(){const e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(e){let t,r=!1,n="",i="",o=0,s=0,a=0;if("Z"===e[e.length-1])n=e.substr(0,e.length-1),r=!0;else{const t=new Number(e[e.length-1]);if(isNaN(t.valueOf()))throw new Error("Wrong input string for conversion");n=e}if(r){if(-1!==n.indexOf("+"))throw new Error("Wrong input string for conversion");if(-1!==n.indexOf("-"))throw new Error("Wrong input string for conversion")}else{let e=1,t=n.indexOf("+"),r="";if(-1===t&&(t=n.indexOf("-"),e=-1),-1!==t){if(r=n.substr(t+1),n=n.substr(0,t),2!==r.length&&4!==r.length)throw new Error("Wrong input string for conversion");let i=new Number(r.substr(0,2));if(isNaN(i.valueOf()))throw new Error("Wrong input string for conversion");if(s=e*i,4===r.length){if(i=new Number(r.substr(2,2)),isNaN(i.valueOf()))throw new Error("Wrong input string for conversion");a=e*i}}}let c=n.indexOf(".");if(-1===c&&(c=n.indexOf(",")),-1!==c){const e=new Number(`0${n.substr(c)}`);if(isNaN(e.valueOf()))throw new Error("Wrong input string for conversion");o=e.valueOf(),i=n.substr(0,c)}else i=n;switch(!0){case 8===i.length:if(t=/(\d{4})(\d{2})(\d{2})/gi,-1!==c)throw new Error("Wrong input string for conversion");break;case 10===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})/gi,-1!==c){let e=60*o;this.minute=Math.floor(e),e=60*(e-this.minute),this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 12===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==c){let e=60*o;this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 14===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==c){const e=1e3*o;this.millisecond=Math.floor(e)}break;default:throw new Error("Wrong input string for conversion")}const u=t.exec(i);if(null===u)throw new Error("Wrong input string for conversion");for(let e=1;e<u.length;e++)switch(e){case 1:this.year=parseInt(u[e],10);break;case 2:this.month=parseInt(u[e],10);break;case 3:this.day=parseInt(u[e],10);break;case 4:this.hour=parseInt(u[e],10)+s;break;case 5:this.minute=parseInt(u[e],10)+a;break;case 6:this.second=parseInt(u[e],10);break;default:throw new Error("Wrong input string for conversion")}if(!1===r){const e=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=e.getUTCFullYear(),this.month=e.getUTCMonth(),this.day=e.getUTCDay(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}}toString(){const e=[];return e.push(ke(this.year,4)),e.push(ke(this.month,2)),e.push(ke(this.day,2)),e.push(ke(this.hour,2)),e.push(ke(this.minute,2)),e.push(ke(this.second,2)),0!==this.millisecond&&(e.push("."),e.push(ke(this.millisecond,3))),e.push("Z"),e.join("")}static blockName(){return"GeneralizedTime"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.year=this.year,e.month=this.month,e.day=this.day,e.hour=this.hour,e.minute=this.minute,e.second=this.second,e.millisecond=this.millisecond,e}}class rr extends Dt{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}static blockName(){return"DATE"}}class nr extends Dt{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}static blockName(){return"TimeOfDay"}}class ir extends Dt{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}static blockName(){return"DateTime"}}class or extends Dt{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}static blockName(){return"Duration"}}class sr extends Dt{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}static blockName(){return"TIME"}}function ar(e,t,r){const n=t;let i=new ht({},Object);const o=new at;if(!1===Se(o,e,t,r))return i.error=o.error,{offset:-1,result:i};if(0===new Uint8Array(e,t,r).length)return i.error="Zero buffer length",{offset:-1,result:i};let s=i.idBlock.fromBER(e,t,r);if(i.warnings.concat(i.idBlock.warnings),-1===s)return i.error=i.idBlock.error,{offset:-1,result:i};if(t=s,r-=i.idBlock.blockLength,s=i.lenBlock.fromBER(e,t,r),i.warnings.concat(i.lenBlock.warnings),-1===s)return i.error=i.lenBlock.error,{offset:-1,result:i};if(t=s,r-=i.lenBlock.blockLength,!1===i.idBlock.isConstructed&&!0===i.lenBlock.isIndefiniteForm)return i.error="Indefinite length form used for primitive encoding form",{offset:-1,result:i};let a=ht;if(1===i.idBlock.tagClass){if(i.idBlock.tagNumber>=37&&!1===i.idBlock.isHexOnly)return i.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:i};switch(i.idBlock.tagNumber){case 0:if(!0===i.idBlock.isConstructed&&i.lenBlock.length>0)return i.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:i};a=yt;break;case 1:a=Et;break;case 2:a=Rt;break;case 3:a=It;break;case 4:a=xt;break;case 5:a=_t;break;case 6:a=Pt;break;case 10:a=kt;break;case 12:a=Dt;break;case 13:a=Bt;break;case 14:a=sr;break;case 15:return i.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:i};case 16:a=wt;break;case 17:a=St;break;case 18:a=$t;break;case 19:a=Zt;break;case 20:a=zt;break;case 21:a=Kt;break;case 22:a=Wt;break;case 23:a=er;break;case 24:a=tr;break;case 25:a=Jt;break;case 26:a=Yt;break;case 27:a=Qt;break;case 28:a=Ht;break;case 29:a=Xt;break;case 30:a=jt;break;case 31:a=rr;break;case 32:a=nr;break;case 33:a=ir;break;case 34:a=or;break;default:{let e;e=!0===i.idBlock.isConstructed?new gt:new pt,e.idBlock=i.idBlock,e.lenBlock=i.lenBlock,e.warnings=i.warnings,i=e}}}else a=!0===i.idBlock.isConstructed?gt:pt;return i=function(e,t){if(e instanceof t)return e;const r=new t;return r.idBlock=e.idBlock,r.lenBlock=e.lenBlock,r.warnings=e.warnings,r.valueBeforeDecode=e.valueBeforeDecode.slice(0),r}(i,a),s=i.fromBER(e,t,!0===i.lenBlock.isIndefiniteForm?r:i.lenBlock.length),i.valueBeforeDecode=e.slice(n,n+i.blockLength),{offset:s,result:i}}function cr(e){if(0===e.byteLength){const e=new ht({},Object);return e.error="Input buffer has zero length",{offset:-1,result:e}}return ar(e,0,e.byteLength)}var ur=r(72043);function lr(){if("undefined"==typeof BigInt)throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function dr(e){let t=0,r=0;for(let r=0;r<e.length;r++){t+=e[r].byteLength}const n=new Uint8Array(t);for(let t=0;t<e.length;t++){const i=e[t];n.set(new Uint8Array(i),r),r+=i.byteLength}return n.buffer}function hr(e,t,r,n){return t instanceof Uint8Array?t.byteLength?r<0?(e.error="Wrong parameter: inputOffset less than zero",!1):n<0?(e.error="Wrong parameter: inputLength less than zero",!1):!(t.byteLength-r-n<0)||(e.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):(e.error="Wrong parameter: inputBuffer has zero length",!1):(e.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}class fr{constructor(){this.items=[]}write(e){this.items.push(e)}final(){return dr(this.items)}}const pr=[new Uint8Array([1])],mr="0123456789",gr="name",vr="valueHexView",yr="isHexOnly",br="idBlock",Er="tagClass",wr="tagNumber",Sr="isConstructed",_r="fromBER",Tr="toBER",xr="local",Ar="",Ir=new ArrayBuffer(0),Cr=new Uint8Array(0),Rr="EndOfContent",kr="OCTET STRING",Or="BIT STRING";function Nr(e){var t;return(t=class extends e{constructor(...e){var t;super(...e);const r=e[0]||{};this.isHexOnly=null!==(t=r.isHexOnly)&&void 0!==t&&t,this.valueHexView=r.valueHex?ur.vJ.toUint8Array(r.valueHex):Cr}get valueHex(){return this.valueHexView.slice().buffer}set valueHex(e){this.valueHexView=new Uint8Array(e)}fromBER(e,t,r){const n=e instanceof ArrayBuffer?new Uint8Array(e):e;if(!hr(this,n,t,r))return-1;const i=t+r;return this.valueHexView=n.subarray(t,i),this.valueHexView.length?(this.blockLength=r,i):(this.warnings.push("Zero buffer length"),t)}toBER(e=!1){return this.isHexOnly?e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",Ir)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:ur.ep.ToHex(this.valueHexView)}}}).NAME="hexBlock",t}class Pr{constructor({blockLength:e=0,error:t=Ar,warnings:r=[],valueBeforeDecode:n=Cr}={}){this.blockLength=e,this.error=t,this.warnings=r,this.valueBeforeDecodeView=ur.vJ.toUint8Array(n)}static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:ur.ep.ToHex(this.valueBeforeDecodeView)}}}Pr.NAME="baseBlock";class Lr extends Pr{fromBER(e,t,r){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,t){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}Lr.NAME="valueBlock";class Dr extends(Nr(Pr)){constructor({idBlock:e={}}={}){var t,r,n,i;super(),e?(this.isHexOnly=null!==(t=e.isHexOnly)&&void 0!==t&&t,this.valueHexView=e.valueHex?ur.vJ.toUint8Array(e.valueHex):Cr,this.tagClass=null!==(r=e.tagClass)&&void 0!==r?r:-1,this.tagNumber=null!==(n=e.tagNumber)&&void 0!==n?n:-1,this.isConstructed=null!==(i=e.isConstructed)&&void 0!==i&&i):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let t=0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",Ir}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){const r=new Uint8Array(1);if(!e){let e=this.tagNumber;e&=31,t|=e,r[0]=t}return r.buffer}if(!this.isHexOnly){const r=Te(this.tagNumber,7),n=new Uint8Array(r),i=r.byteLength,o=new Uint8Array(i+1);if(o[0]=31|t,!e){for(let e=0;e<i-1;e++)o[e+1]=128|n[e];o[i]=n[i-1]}return o.buffer}const r=new Uint8Array(this.valueHexView.byteLength+1);if(r[0]=31|t,!e){const e=this.valueHexView;for(let t=0;t<e.length-1;t++)r[t+1]=128|e[t];r[this.valueHexView.byteLength]=e[e.length-1]}return r.buffer}fromBER(e,t,r){const n=ur.vJ.toUint8Array(e);if(!hr(this,n,t,r))return-1;const i=n.subarray(t,t+r);if(0===i.length)return this.error="Zero buffer length",-1;switch(192&i[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=32==(32&i[0]),this.isHexOnly=!1;const o=31&i[0];if(31!==o)this.tagNumber=o,this.blockLength=1;else{let e=1,t=this.valueHexView=new Uint8Array(255),r=255;for(;128&i[e];){if(t[e-1]=127&i[e],e++,e>=i.length)return this.error="End of input reached before message was fully decoded",-1;if(e===r){r+=255;const e=new Uint8Array(r);for(let r=0;r<t.length;r++)e[r]=t[r];t=this.valueHexView=new Uint8Array(r)}}this.blockLength=e+1,t[e-1]=127&i[e];const n=new Uint8Array(e);for(let r=0;r<e;r++)n[r]=t[r];t=this.valueHexView=new Uint8Array(e),t.set(n),this.blockLength<=9?this.tagNumber=_e(t,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}Dr.NAME="identificationBlock";class Mr extends Pr{constructor({lenBlock:e={}}={}){var t,r,n;super(),this.isIndefiniteForm=null!==(t=e.isIndefiniteForm)&&void 0!==t&&t,this.longFormUsed=null!==(r=e.longFormUsed)&&void 0!==r&&r,this.length=null!==(n=e.length)&&void 0!==n?n:0}fromBER(e,t,r){const n=ur.vJ.toUint8Array(e);if(!hr(this,n,t,r))return-1;const i=n.subarray(t,t+r);if(0===i.length)return this.error="Zero buffer length",-1;if(255===i[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===i[0],this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&i[0]),!1===this.longFormUsed)return this.length=i[0],this.blockLength=1,t+this.blockLength;const o=127&i[0];if(o>8)return this.error="Too big integer",-1;if(o+1>i.length)return this.error="End of input reached before message was fully decoded",-1;const s=t+1,a=n.subarray(s,s+o);return 0===a[o-1]&&this.warnings.push("Needlessly long encoded length"),this.length=_e(a,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=o+1,t+this.blockLength}toBER(e=!1){let t,r;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=128),t;if(this.longFormUsed){const n=Te(this.length,8);if(n.byteLength>127)return this.error="Too big length",Ir;if(t=new ArrayBuffer(n.byteLength+1),e)return t;const i=new Uint8Array(n);r=new Uint8Array(t),r[0]=128|n.byteLength;for(let e=0;e<n.byteLength;e++)r[e+1]=i[e];return t}return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=this.length),t}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}Mr.NAME="lengthBlock";const Ur={};class Br extends Pr{constructor({name:e=Ar,optional:t=!1,primitiveSchema:r,...n}={},i){super(n),this.name=e,this.optional=t,r&&(this.primitiveSchema=r),this.idBlock=new Dr(n),this.lenBlock=new Mr(n),this.valueBlock=i?new i(n):new Lr(n)}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}toBER(e,t){const r=t||new fr;t||Fr(this);const n=this.idBlock.toBER(e);if(r.write(n),this.lenBlock.isIndefiniteForm)r.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,r),r.write(new ArrayBuffer(2));else{const t=this.valueBlock.toBER(e);this.lenBlock.length=t.byteLength;const n=this.lenBlock.toBER(e);r.write(n),r.write(t)}return t?Ir:r.final()}toJSON(){const e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return"ascii"===e?this.onAsciiEncoding():ur.ep.ToHex(this.toBER())}onAsciiEncoding(){return`${this.constructor.NAME} : ${ur.ep.ToHex(this.valueBlock.valueBeforeDecodeView)}`}isEqual(e){if(this===e)return!0;if(!(e instanceof this.constructor))return!1;return Re(this.toBER(),e.toBER())}}function Fr(e){if(e instanceof Ur.Constructed)for(const t of e.valueBlock.value)Fr(t)&&(e.lenBlock.isIndefiniteForm=!0);return!!e.lenBlock.isIndefiniteForm}Br.NAME="BaseBlock";class jr extends Br{constructor({value:e=Ar,...t}={},r){super(t,r),e&&this.fromString(e)}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}jr.NAME="BaseStringBlock";class Vr extends(Nr(Lr)){constructor({isHexOnly:e=!0,...t}={}){super(t),this.isHexOnly=e}}var Hr,Gr,qr,$r,Zr,zr,Kr,Wr,Jr,Yr,Qr,Xr,en,tn,rn,nn,on,sn,an,cn,un,ln,dn,hn,fn,pn,mn,gn,vn,yn,bn,En,wn;Vr.NAME="PrimitiveValueBlock";class Sn extends Br{constructor(e={}){super(e,Vr),this.idBlock.isConstructed=!1}}function _n(e,t=0,r=e.length){const n=t;let i=new Br({},Lr);const o=new Pr;if(!hr(o,e,t,r))return i.error=o.error,{offset:-1,result:i};if(!e.subarray(t,t+r).length)return i.error="Zero buffer length",{offset:-1,result:i};let s=i.idBlock.fromBER(e,t,r);if(i.idBlock.warnings.length&&i.warnings.concat(i.idBlock.warnings),-1===s)return i.error=i.idBlock.error,{offset:-1,result:i};if(t=s,r-=i.idBlock.blockLength,s=i.lenBlock.fromBER(e,t,r),i.lenBlock.warnings.length&&i.warnings.concat(i.lenBlock.warnings),-1===s)return i.error=i.lenBlock.error,{offset:-1,result:i};if(t=s,r-=i.lenBlock.blockLength,!i.idBlock.isConstructed&&i.lenBlock.isIndefiniteForm)return i.error="Indefinite length form used for primitive encoding form",{offset:-1,result:i};let a=Br;if(1===i.idBlock.tagClass){if(i.idBlock.tagNumber>=37&&!1===i.idBlock.isHexOnly)return i.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:i};switch(i.idBlock.tagNumber){case 0:if(i.idBlock.isConstructed&&i.lenBlock.length>0)return i.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:i};a=Ur.EndOfContent;break;case 1:a=Ur.Boolean;break;case 2:a=Ur.Integer;break;case 3:a=Ur.BitString;break;case 4:a=Ur.OctetString;break;case 5:a=Ur.Null;break;case 6:a=Ur.ObjectIdentifier;break;case 10:a=Ur.Enumerated;break;case 12:a=Ur.Utf8String;break;case 13:a=Ur.RelativeObjectIdentifier;break;case 14:a=Ur.TIME;break;case 15:return i.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:i};case 16:a=Ur.Sequence;break;case 17:a=Ur.Set;break;case 18:a=Ur.NumericString;break;case 19:a=Ur.PrintableString;break;case 20:a=Ur.TeletexString;break;case 21:a=Ur.VideotexString;break;case 22:a=Ur.IA5String;break;case 23:a=Ur.UTCTime;break;case 24:a=Ur.GeneralizedTime;break;case 25:a=Ur.GraphicString;break;case 26:a=Ur.VisibleString;break;case 27:a=Ur.GeneralString;break;case 28:a=Ur.UniversalString;break;case 29:a=Ur.CharacterString;break;case 30:a=Ur.BmpString;break;case 31:a=Ur.DATE;break;case 32:a=Ur.TimeOfDay;break;case 33:a=Ur.DateTime;break;case 34:a=Ur.Duration;break;default:{const e=i.idBlock.isConstructed?new Ur.Constructed:new Ur.Primitive;e.idBlock=i.idBlock,e.lenBlock=i.lenBlock,e.warnings=i.warnings,i=e}}}else a=i.idBlock.isConstructed?Ur.Constructed:Ur.Primitive;return i=function(e,t){if(e instanceof t)return e;const r=new t;return r.idBlock=e.idBlock,r.lenBlock=e.lenBlock,r.warnings=e.warnings,r.valueBeforeDecodeView=e.valueBeforeDecodeView,r}(i,a),s=i.fromBER(e,t,i.lenBlock.isIndefiniteForm?r:i.lenBlock.length),i.valueBeforeDecodeView=e.subarray(n,n+i.blockLength),{offset:s,result:i}}function Tn(e){if(!e.byteLength){const e=new Br({},Lr);return e.error="Input buffer has zero length",{offset:-1,result:e}}return _n(ur.vJ.toUint8Array(e).slice(),0,e.byteLength)}Hr=Sn,Ur.Primitive=Hr,Sn.NAME="PRIMITIVE";class xn extends Lr{constructor({value:e=[],isIndefiniteForm:t=!1,...r}={}){super(r),this.value=e,this.isIndefiniteForm=t}fromBER(e,t,r){const n=ur.vJ.toUint8Array(e);if(!hr(this,n,t,r))return-1;if(this.valueBeforeDecodeView=n.subarray(t,t+r),0===this.valueBeforeDecodeView.length)return this.warnings.push("Zero buffer length"),t;let i=t;for(;o=this.isIndefiniteForm,s=r,(o?1:s)>0;){const e=_n(n,i,r);if(-1===e.offset)return this.error=e.result.error,this.warnings.concat(e.result.warnings),-1;if(i=e.offset,this.blockLength+=e.result.blockLength,r-=e.result.blockLength,this.value.push(e.result),this.isIndefiniteForm&&e.result.constructor.NAME===Rr)break}var o,s;return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===Rr?this.value.pop():this.warnings.push("No EndOfContent block encoded")),i}toBER(e,t){const r=t||new fr;for(let t=0;t<this.value.length;t++)this.value[t].toBER(e,r);return t?Ir:r.final()}toJSON(){const e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(const t of this.value)e.value.push(t.toJSON());return e}}xn.NAME="ConstructedValueBlock";class An extends Br{constructor(e={}){super(e,xn),this.idBlock.isConstructed=!0}fromBER(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}onAsciiEncoding(){const e=[];for(const t of this.valueBlock.value)e.push(t.toString("ascii").split("\n").map((e=>`  ${e}`)).join("\n"));const t=3===this.idBlock.tagClass?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return e.length?`${t} :\n${e.join("\n")}`:`${t} :`}}Gr=An,Ur.Constructed=Gr,An.NAME="CONSTRUCTED";class In extends Lr{fromBER(e,t,r){return t}toBER(e){return Ir}}In.override="EndOfContentValueBlock";class Cn extends Br{constructor(e={}){super(e,In),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}qr=Cn,Ur.EndOfContent=qr,Cn.NAME=Rr;class Rn extends Br{constructor(e={}){super(e,Lr),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(e,t,r){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,t+r>e.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+r}toBER(e,t){const r=new ArrayBuffer(2);if(!e){const e=new Uint8Array(r);e[0]=5,e[1]=0}return t&&t.write(r),r}onAsciiEncoding(){return`${this.constructor.NAME}`}}$r=Rn,Ur.Null=$r,Rn.NAME="NULL";class kn extends(Nr(Lr)){constructor({value:e,...t}={}){super(t),t.valueHex?this.valueHexView=ur.vJ.toUint8Array(t.valueHex):this.valueHexView=new Uint8Array(1),e&&(this.value=e)}get value(){for(const e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=e?255:0}fromBER(e,t,r){const n=ur.vJ.toUint8Array(e);return hr(this,n,t,r)?(this.valueHexView=n.subarray(t,t+r),r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,Ie.call(this),this.blockLength=r,t+r):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}kn.NAME="BooleanValueBlock";class On extends Br{constructor(e={}){super(e,kn),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}}Zr=On,Ur.Boolean=Zr,On.NAME="BOOLEAN";class Nn extends(Nr(xn)){constructor({isConstructed:e=!1,...t}={}){super(t),this.isConstructed=e}fromBER(e,t,r){let n=0;if(this.isConstructed){if(this.isHexOnly=!1,n=xn.prototype.fromBER.call(this,e,t,r),-1===n)return n;for(let e=0;e<this.value.length;e++){const t=this.value[e].constructor.NAME;if(t===Rr){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(t!==kr)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,n=super.fromBER(e,t,r),this.blockLength=r;return n}toBER(e,t){return this.isConstructed?xn.prototype.toBER.call(this,e,t):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}Nn.NAME="OctetStringValueBlock";class Pn extends Br{constructor({idBlock:e={},lenBlock:t={},...r}={}){var n,i;null!==(n=r.isConstructed)&&void 0!==n||(r.isConstructed=!!(null===(i=r.value)||void 0===i?void 0:i.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},Nn),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,r){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===r)return 0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){const n=(e instanceof ArrayBuffer?new Uint8Array(e):e).subarray(t,t+r);try{if(n.byteLength){const e=_n(n,0,n.byteLength);-1!==e.offset&&e.offset===r&&(this.valueBlock.value=[e.result])}}catch(e){}}return super.fromBER(e,t,r)}onAsciiEncoding(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?An.prototype.onAsciiEncoding.call(this):`${this.constructor.NAME} : ${ur.ep.ToHex(this.valueBlock.valueHexView)}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const e=[];for(const t of this.valueBlock.value)t instanceof Pn&&e.push(t.valueBlock.valueHexView);return ur.vJ.concat(e)}}zr=Pn,Ur.OctetString=zr,Pn.NAME=kr;class Ln extends(Nr(xn)){constructor({unusedBits:e=0,isConstructed:t=!1,...r}={}){super(r),this.unusedBits=e,this.isConstructed=t,this.blockLength=this.valueHexView.byteLength}fromBER(e,t,r){if(!r)return t;let n=-1;if(this.isConstructed){if(n=xn.prototype.fromBER.call(this,e,t,r),-1===n)return n;for(const e of this.value){const t=e.constructor.NAME;if(t===Rr){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(t!==Or)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const r=e.valueBlock;if(this.unusedBits>0&&r.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=r.unusedBits}return n}const i=ur.vJ.toUint8Array(e);if(!hr(this,i,t,r))return-1;const o=i.subarray(t,t+r);if(this.unusedBits=o[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const e=o.subarray(1);try{if(e.byteLength){const t=_n(e,0,e.byteLength);-1!==t.offset&&t.offset===r-1&&(this.value=[t.result])}}catch(e){}}return this.valueHexView=o.subarray(1),this.blockLength=o.length,t+r}toBER(e,t){if(this.isConstructed)return xn.prototype.toBER.call(this,e,t);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return Ir;const r=new Uint8Array(this.valueHexView.length+1);return r[0]=this.unusedBits,r.set(this.valueHexView,1),r.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}Ln.NAME="BitStringValueBlock";class Dn extends Br{constructor({idBlock:e={},lenBlock:t={},...r}={}){var n,i;null!==(n=r.isConstructed)&&void 0!==n||(r.isConstructed=!!(null===(i=r.value)||void 0===i?void 0:i.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},Ln),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(e,t,r){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,r)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return An.prototype.onAsciiEncoding.call(this);{const e=[],t=this.valueBlock.valueHexView;for(const r of t)e.push(r.toString(2).padStart(8,"0"));const r=e.join("");return`${this.constructor.NAME} : ${r.substring(0,r.length-this.valueBlock.unusedBits)}`}}}function Mn(e,t){const r=new Uint8Array([0]),n=new Uint8Array(e),i=new Uint8Array(t);let o=n.slice(0);const s=o.length-1,a=i.slice(0),c=a.length-1;let u=0;let l=0;for(let e=c<s?s:c;e>=0;e--,l++){if(!0==l<a.length)u=o[s-l]+a[c-l]+r[0];else u=o[s-l]+r[0];if(r[0]=u/10,!0==l>=o.length)o=Ae(new Uint8Array([u%10]),o);else o[s-l]=u%10}return r[0]>0&&(o=Ae(r,o)),o}function Un(e){if(e>=pr.length)for(let t=pr.length;t<=e;t++){const e=new Uint8Array([0]);let r=pr[t-1].slice(0);for(let t=r.length-1;t>=0;t--){const n=new Uint8Array([(r[t]<<1)+e[0]]);e[0]=n[0]/10,r[t]=n[0]%10}e[0]>0&&(r=Ae(e,r)),pr.push(r)}return pr[e]}function Bn(e,t){let r=0;const n=new Uint8Array(e),i=new Uint8Array(t),o=n.slice(0),s=o.length-1,a=i.slice(0),c=a.length-1;let u,l=0;for(let e=c;e>=0;e--,l++)if(u=o[s-l]-a[c-l]-r,!0==u<0)r=1,o[s-l]=u+10;else r=0,o[s-l]=u;if(r>0)for(let e=s-c+1;e>=0;e--,l++){if(u=o[s-l]-r,!(u<0)){r=0,o[s-l]=u;break}r=1,o[s-l]=u+10}return o.slice()}Kr=Dn,Ur.BitString=Kr,Dn.NAME=Or;class Fn extends(Nr(Lr)){constructor({value:e,...t}={}){super(t),this._valueDec=0,t.valueHex&&this.setValueHex(),void 0!==e&&(this.valueDec=e)}setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=Ie.call(this)))}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this.valueHexView=new Uint8Array(Ce(e))}get valueDec(){return this._valueDec}fromDER(e,t,r,n=0){const i=this.fromBER(e,t,r);if(-1===i)return i;const o=this.valueHexView;return 0===o[0]&&0!=(128&o[1])?this.valueHexView=o.subarray(1):0!==n&&o.length<n&&(n-o.length>1&&(n=o.length+1),this.valueHexView=o.subarray(n-o.length)),i}toDER(e=!1){const t=this.valueHexView;switch(!0){case 0!=(128&t[0]):{const e=new Uint8Array(this.valueHexView.length+1);e[0]=0,e.set(t,1),this.valueHexView=e}break;case 0===t[0]&&0==(128&t[1]):this.valueHexView=this.valueHexView.subarray(1)}return this.toBER(e)}fromBER(e,t,r){const n=super.fromBER(e,t,r);return-1===n||this.setValueHex(),n}toBER(e){return e?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){const e=8*this.valueHexView.length-1;let t,r=new Uint8Array(8*this.valueHexView.length/3),n=0;const i=this.valueHexView;let o="",s=!1;for(let s=i.byteLength-1;s>=0;s--){t=i[s];for(let i=0;i<8;i++){if(1==(1&t))if(n===e)r=Bn(Un(n),r),o="-";else r=Mn(r,Un(n));n++,t>>=1}}for(let e=0;e<r.length;e++)r[e]&&(s=!0),s&&(o+=mr.charAt(r[e]));return!1===s&&(o+=mr.charAt(0)),o}}Wr=Fn,Fn.NAME="IntegerValueBlock",Object.defineProperty(Wr.prototype,"valueHex",{set:function(e){this.valueHexView=new Uint8Array(e),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});class jn extends Br{constructor(e={}){super(e,Fn),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return lr(),BigInt(this.valueBlock.toString())}static fromBigInt(e){lr();const t=BigInt(e),r=new fr,n=t.toString(16).replace(/^-/,""),i=new Uint8Array(ur.ep.FromHex(n));if(t<0){const e=new Uint8Array(i.length+(128&i[0]?1:0));e[0]|=128;const n=BigInt(`0x${ur.ep.ToHex(e)}`)+t,o=ur.vJ.toUint8Array(ur.ep.FromHex(n.toString(16)));o[0]|=128,r.write(o)}else 128&i[0]&&r.write(new Uint8Array([0])),r.write(i);return new jn({valueHex:r.final()})}convertToDER(){const e=new jn({valueHex:this.valueBlock.valueHexView});return e.valueBlock.toDER(),e}convertFromDER(){return new jn({valueHex:0===this.valueBlock.valueHexView[0]?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}Jr=jn,Ur.Integer=Jr,jn.NAME="INTEGER";class Vn extends jn{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}Yr=Vn,Ur.Enumerated=Yr,Vn.NAME="ENUMERATED";class Hn extends(Nr(Lr)){constructor({valueDec:e=-1,isFirstSid:t=!1,...r}={}){super(r),this.valueDec=e,this.isFirstSid=t}fromBER(e,t,r){if(!r)return t;const n=ur.vJ.toUint8Array(e);if(!hr(this,n,t,r))return-1;const i=n.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&i[e],this.blockLength++,0!=(128&i[e]));e++);const o=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)o[e]=this.valueHexView[e];return this.valueHexView=o,0!=(128&i[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=_e(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){lr();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;const r=new Uint8Array(t.length/7);for(let e=0;e<r.length;e++)r[e]=parseInt(t.slice(7*e,7*e+7),2)+(e+1<r.length?128:0);this.fromBER(r.buffer,0,r.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}const t=Te(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",Ir;const r=new Uint8Array(t.byteLength);if(!e){const e=new Uint8Array(t),n=t.byteLength-1;for(let t=0;t<n;t++)r[t]=128|e[t];r[n]=e[n]}return r}toString(){let e="";if(this.isHexOnly)e=ur.ep.ToHex(this.valueHexView);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}Hn.NAME="sidBlock";class Gn extends Lr{constructor({value:e=Ar,...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let n=t;for(;r>0;){const t=new Hn;if(n=t.fromBER(e,n,r),-1===n)return this.blockLength=0,this.error=t.error,n;0===this.value.length&&(t.isFirstSid=!0),this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return n}toBER(e){const t=[];for(let r=0;r<this.value.length;r++){const n=this.value[r].toBER(e);if(0===n.byteLength)return this.error=this.value[r].error,Ir;t.push(n)}return dr(t)}fromString(e){this.value=[];let t=0,r=0,n="",i=!1;do{if(r=e.indexOf(".",t),n=-1===r?e.substring(t):e.substring(t,r),t=r+1,i){const e=this.value[0];let t=0;switch(e.valueDec){case 0:break;case 1:t=40;break;case 2:t=80;break;default:return void(this.value=[])}const r=parseInt(n,10);if(isNaN(r))return;e.valueDec=r+t,i=!1}else{const e=new Hn;if(n>Number.MAX_SAFE_INTEGER){lr();const t=BigInt(n);e.valueBigInt=t}else if(e.valueDec=parseInt(n,10),isNaN(e.valueDec))return;this.value.length||(e.isFirstSid=!0,i=!0),this.value.push(e)}}while(-1!==r)}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let n=this.value[r].toString();0!==r&&(e=`${e}.`),t?(n=`{${n}}`,this.value[r].isFirstSid?e=`2.{${n} - 80}`:e+=n):e+=n}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}Gn.NAME="ObjectIdentifierValueBlock";class qn extends Br{constructor(e={}){super(e,Gn),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}Qr=qn,Ur.ObjectIdentifier=Qr,qn.NAME="OBJECT IDENTIFIER";class $n extends(Nr(Pr)){constructor({valueDec:e=0,...t}={}){super(t),this.valueDec=e}fromBER(e,t,r){if(0===r)return t;const n=ur.vJ.toUint8Array(e);if(!hr(this,n,t,r))return-1;const i=n.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&i[e],this.blockLength++,0!=(128&i[e]));e++);const o=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)o[e]=this.valueHexView[e];return this.valueHexView=o,0!=(128&i[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=_e(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}const t=Te(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",Ir;const r=new Uint8Array(t.byteLength);if(!e){const e=new Uint8Array(t),n=t.byteLength-1;for(let t=0;t<n;t++)r[t]=128|e[t];r[n]=e[n]}return r.buffer}toString(){let e="";return e=this.isHexOnly?ur.ep.ToHex(this.valueHexView):this.valueDec.toString(),e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}$n.NAME="relativeSidBlock";class Zn extends Lr{constructor({value:e=Ar,...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let n=t;for(;r>0;){const t=new $n;if(n=t.fromBER(e,n,r),-1===n)return this.blockLength=0,this.error=t.error,n;this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return n}toBER(e,t){const r=[];for(let t=0;t<this.value.length;t++){const n=this.value[t].toBER(e);if(0===n.byteLength)return this.error=this.value[t].error,Ir;r.push(n)}return dr(r)}fromString(e){this.value=[];let t=0,r=0,n="";do{r=e.indexOf(".",t),n=-1===r?e.substring(t):e.substring(t,r),t=r+1;const i=new $n;if(i.valueDec=parseInt(n,10),isNaN(i.valueDec))return!0;this.value.push(i)}while(-1!==r);return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let n=this.value[r].toString();0!==r&&(e=`${e}.`),t?(n=`{${n}}`,e+=n):e+=n}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}Zn.NAME="RelativeObjectIdentifierValueBlock";class zn extends Br{constructor(e={}){super(e,Zn),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}Xr=zn,Ur.RelativeObjectIdentifier=Xr,zn.NAME="RelativeObjectIdentifier";class Kn extends An{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}en=Kn,Ur.Sequence=en,Kn.NAME="SEQUENCE";class Wn extends An{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}}tn=Wn,Ur.Set=tn,Wn.NAME="SET";class Jn extends(Nr(Lr)){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=Ar}toJSON(){return{...super.toJSON(),value:this.value}}}Jn.NAME="StringValueBlock";class Yn extends Jn{}Yn.NAME="SimpleStringValueBlock";class Qn extends jr{constructor({...e}={}){super(e,Yn)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,ur.vJ.toUint8Array(e))}fromString(e){const t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);this.valueBlock.value=e}}Qn.NAME="SIMPLE STRING";class Xn extends Qn{fromBuffer(e){this.valueBlock.valueHexView=ur.vJ.toUint8Array(e);try{this.valueBlock.value=ur.ep.ToUtf8String(e)}catch(t){this.warnings.push(`Error during "decodeURIComponent": ${t}, using raw string`),this.valueBlock.value=ur.ep.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(ur.ep.FromUtf8String(e)),this.valueBlock.value=e}}Xn.NAME="Utf8StringValueBlock";class ei extends Xn{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}rn=ei,Ur.Utf8String=rn,ei.NAME="UTF8String";class ti extends Qn{fromBuffer(e){this.valueBlock.value=ur.ep.ToUtf16String(e),this.valueBlock.valueHexView=ur.vJ.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(ur.ep.FromUtf16String(e))}}ti.NAME="BmpStringValueBlock";class ri extends ti{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}nn=ri,Ur.BmpString=nn,ri.NAME="BMPString";class ni extends Qn{fromBuffer(e){const t=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),r=new Uint8Array(t);for(let e=0;e<r.length;e+=4)r[e]=r[e+3],r[e+1]=r[e+2],r[e+2]=0,r[e+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){const t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(4*t);for(let n=0;n<t;n++){const t=Te(e.charCodeAt(n),8),i=new Uint8Array(t);if(i.length>4)continue;const o=4-i.length;for(let e=i.length-1;e>=0;e--)r[4*n+e+o]=i[e]}this.valueBlock.value=e}}ni.NAME="UniversalStringValueBlock";class ii extends ni{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}on=ii,Ur.UniversalString=on,ii.NAME="UniversalString";class oi extends Qn{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}sn=oi,Ur.NumericString=sn,oi.NAME="NumericString";class si extends Qn{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}an=si,Ur.PrintableString=an,si.NAME="PrintableString";class ai extends Qn{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}cn=ai,Ur.TeletexString=cn,ai.NAME="TeletexString";class ci extends Qn{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}un=ci,Ur.VideotexString=un,ci.NAME="VideotexString";class ui extends Qn{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}ln=ui,Ur.IA5String=ln,ui.NAME="IA5String";class li extends Qn{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}dn=li,Ur.GraphicString=dn,li.NAME="GraphicString";class di extends Qn{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}hn=di,Ur.VisibleString=hn,di.NAME="VisibleString";class hi extends Qn{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}fn=hi,Ur.GeneralString=fn,hi.NAME="GeneralString";class fi extends Qn{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}pn=fi,Ur.CharacterString=pn,fi.NAME="CharacterString";class pi extends di{constructor({value:e,valueDate:t,...r}={}){if(super(r),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,e){this.fromString(e),this.valueBlock.valueHexView=new Uint8Array(e.length);for(let t=0;t<e.length;t++)this.valueBlock.valueHexView[t]=e.charCodeAt(t)}t&&(this.fromDate(t),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,ur.vJ.toUint8Array(e)))}toBuffer(){const e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){const t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi.exec(e);if(null===t)return void(this.error="Wrong input string for conversion");const r=parseInt(t[1],10);this.year=r>=50?1900+r:2e3+r,this.month=parseInt(t[2],10),this.day=parseInt(t[3],10),this.hour=parseInt(t[4],10),this.minute=parseInt(t[5],10),this.second=parseInt(t[6],10)}toString(e="iso"){if("iso"===e){const e=new Array(7);return e[0]=ke(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=ke(this.month,2),e[2]=ke(this.day,2),e[3]=ke(this.hour,2),e[4]=ke(this.minute,2),e[5]=ke(this.second,2),e[6]="Z",e.join("")}return super.toString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}mn=pi,Ur.UTCTime=mn,pi.NAME="UTCTime";class mi extends pi{constructor(e={}){var t;super(e),null!==(t=this.millisecond)&&void 0!==t||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(e){super.fromDate(e),this.millisecond=e.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(e){let t,r=!1,n="",i="",o=0,s=0,a=0;if("Z"===e[e.length-1])n=e.substring(0,e.length-1),r=!0;else{const t=new Number(e[e.length-1]);if(isNaN(t.valueOf()))throw new Error("Wrong input string for conversion");n=e}if(r){if(-1!==n.indexOf("+"))throw new Error("Wrong input string for conversion");if(-1!==n.indexOf("-"))throw new Error("Wrong input string for conversion")}else{let e=1,t=n.indexOf("+"),r="";if(-1===t&&(t=n.indexOf("-"),e=-1),-1!==t){if(r=n.substring(t+1),n=n.substring(0,t),2!==r.length&&4!==r.length)throw new Error("Wrong input string for conversion");let i=parseInt(r.substring(0,2),10);if(isNaN(i.valueOf()))throw new Error("Wrong input string for conversion");if(s=e*i,4===r.length){if(i=parseInt(r.substring(2,4),10),isNaN(i.valueOf()))throw new Error("Wrong input string for conversion");a=e*i}}}let c=n.indexOf(".");if(-1===c&&(c=n.indexOf(",")),-1!==c){const e=new Number(`0${n.substring(c)}`);if(isNaN(e.valueOf()))throw new Error("Wrong input string for conversion");o=e.valueOf(),i=n.substring(0,c)}else i=n;switch(!0){case 8===i.length:if(t=/(\d{4})(\d{2})(\d{2})/gi,-1!==c)throw new Error("Wrong input string for conversion");break;case 10===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})/gi,-1!==c){let e=60*o;this.minute=Math.floor(e),e=60*(e-this.minute),this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 12===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==c){let e=60*o;this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 14===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==c){const e=1e3*o;this.millisecond=Math.floor(e)}break;default:throw new Error("Wrong input string for conversion")}const u=t.exec(i);if(null===u)throw new Error("Wrong input string for conversion");for(let e=1;e<u.length;e++)switch(e){case 1:this.year=parseInt(u[e],10);break;case 2:this.month=parseInt(u[e],10);break;case 3:this.day=parseInt(u[e],10);break;case 4:this.hour=parseInt(u[e],10)+s;break;case 5:this.minute=parseInt(u[e],10)+a;break;case 6:this.second=parseInt(u[e],10);break;default:throw new Error("Wrong input string for conversion")}if(!1===r){const e=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=e.getUTCFullYear(),this.month=e.getUTCMonth(),this.day=e.getUTCDay(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}}toString(e="iso"){if("iso"===e){const e=[];return e.push(ke(this.year,4)),e.push(ke(this.month,2)),e.push(ke(this.day,2)),e.push(ke(this.hour,2)),e.push(ke(this.minute,2)),e.push(ke(this.second,2)),0!==this.millisecond&&(e.push("."),e.push(ke(this.millisecond,3))),e.push("Z"),e.join("")}return super.toString(e)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}gn=mi,Ur.GeneralizedTime=gn,mi.NAME="GeneralizedTime";class gi extends ei{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}vn=gi,Ur.DATE=vn,gi.NAME="DATE";class vi extends ei{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}yn=vi,Ur.TimeOfDay=yn,vi.NAME="TimeOfDay";class yi extends ei{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}bn=yi,Ur.DateTime=bn,yi.NAME="DateTime";class bi extends ei{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}En=bi,Ur.Duration=En,bi.NAME="Duration";class Ei extends ei{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}wn=Ei,Ur.TIME=wn,Ei.NAME="TIME";class wi{constructor({name:e=Ar,optional:t=!1}={}){this.name=e,this.optional=t}}class Si extends wi{constructor({value:e=[],...t}={}){super(t),this.value=e}}class _i extends wi{constructor({value:e=new wi,local:t=!1,...r}={}){super(r),this.value=e,this.local=t}}class Ti{constructor({data:e=Cr}={}){this.dataView=ur.vJ.toUint8Array(e)}get data(){return this.dataView.slice().buffer}set data(e){this.dataView=ur.vJ.toUint8Array(e)}fromBER(e,t,r){const n=t+r;return this.dataView=ur.vJ.toUint8Array(e).subarray(t,n),n}toBER(e){return this.dataView.slice().buffer}}function xi(e,t,r){if(r instanceof Si){for(let n=0;n<r.value.length;n++){if(xi(e,t,r.value[n]).verified)return{verified:!0,result:e}}{const e={verified:!1,result:{error:"Wrong values for Choice type"}};return r.hasOwnProperty(gr)&&(e.name=r.name),e}}if(r instanceof wi)return r.hasOwnProperty(gr)&&(e[r.name]=t),{verified:!0,result:e};if(e instanceof Object==!1)return{verified:!1,result:{error:"Wrong root object"}};if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(r instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(br in r==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(_r in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(Tr in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const n=r.idBlock.toBER(!1);if(0===n.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(-1===r.idBlock.fromBER(n,0,n.byteLength))return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(!1===r.idBlock.hasOwnProperty(Er))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagClass!==t.idBlock.tagClass)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty(wr))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagNumber!==t.idBlock.tagNumber)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty(Sr))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isConstructed!==t.idBlock.isConstructed)return{verified:!1,result:e};if(!(yr in r.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isHexOnly!==t.idBlock.isHexOnly)return{verified:!1,result:e};if(r.idBlock.isHexOnly){if(vr in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const n=r.idBlock.valueHexView,i=t.idBlock.valueHexView;if(n.length!==i.length)return{verified:!1,result:e};for(let t=0;t<n.length;t++)if(n[t]!==i[1])return{verified:!1,result:e}}if(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Ar),r.name&&(e[r.name]=t)),r instanceof Ur.Constructed){let n=0,i={verified:!1,result:{error:"Unknown error"}},o=r.valueBlock.value.length;if(o>0&&r.valueBlock.value[0]instanceof _i&&(o=t.valueBlock.value.length),0===o)return{verified:!0,result:e};if(0===t.valueBlock.value.length&&0!==r.valueBlock.value.length){let t=!0;for(let e=0;e<r.valueBlock.value.length;e++)t=t&&(r.valueBlock.value[e].optional||!1);return t?{verified:!0,result:e}:(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Ar),r.name&&delete e[r.name]),e.error="Inconsistent object length",{verified:!1,result:e})}for(let s=0;s<o;s++)if(s-n>=t.valueBlock.value.length){if(!1===r.valueBlock.value[s].optional){const t={verified:!1,result:e};return e.error="Inconsistent length between ASN.1 data and schema",r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Ar),r.name&&(delete e[r.name],t.name=r.name)),t}}else if(r.valueBlock.value[0]instanceof _i){if(i=xi(e,t.valueBlock.value[s],r.valueBlock.value[0].value),!1===i.verified){if(!r.valueBlock.value[0].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Ar),r.name&&delete e[r.name]),i;n++}if(gr in r.valueBlock.value[0]&&r.valueBlock.value[0].name.length>0){let n={};n=xr in r.valueBlock.value[0]&&r.valueBlock.value[0].local?t:e,void 0===n[r.valueBlock.value[0].name]&&(n[r.valueBlock.value[0].name]=[]),n[r.valueBlock.value[0].name].push(t.valueBlock.value[s])}}else if(i=xi(e,t.valueBlock.value[s-n],r.valueBlock.value[s]),!1===i.verified){if(!r.valueBlock.value[s].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Ar),r.name&&delete e[r.name]),i;n++}if(!1===i.verified){const t={verified:!1,result:e};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Ar),r.name&&(delete e[r.name],t.name=r.name)),t}return{verified:!0,result:e}}if(r.primitiveSchema&&vr in t.valueBlock){const n=_n(t.valueBlock.valueHexView);if(-1===n.offset){const t={verified:!1,result:n.result};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Ar),r.name&&(delete e[r.name],t.name=r.name)),t}return xi(e,n.result,r.primitiveSchema)}return{verified:!0,result:e}}class Ai{constructor(e={}){this.algorithmId=Ee(e,"algorithmId",Ai.defaultValues("algorithmId")),"algorithmParams"in e&&(this.algorithmParams=Ee(e,"algorithmParams",Ai.defaultValues("algorithmParams"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"algorithmId":return"";case"algorithmParams":return new wi;default:throw new Error(`Invalid member name for AlgorithmIdentifier class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"algorithmId":return""===t;case"algorithmParams":return t instanceof wi;default:throw new Error(`Invalid member name for AlgorithmIdentifier class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",optional:t.optional||!1,value:[new qn({name:t.algorithmIdentifier||""}),new wi({name:t.algorithmParams||"",optional:!0})]})}fromSchema(e){Fe(e,["algorithm","params"]);const t=xi(e,e,Ai.schema({names:{algorithmIdentifier:"algorithm",algorithmParams:"params"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for AlgorithmIdentifier");this.algorithmId=t.result.algorithm.valueBlock.toString(),"params"in t.result&&(this.algorithmParams=t.result.params)}toSchema(){const e=[];return e.push(new qn({value:this.algorithmId})),"algorithmParams"in this&&this.algorithmParams instanceof wi==!1&&e.push(this.algorithmParams),new Kn({value:e})}toJSON(){const e={algorithmId:this.algorithmId};return"algorithmParams"in this&&this.algorithmParams instanceof wi==!1&&(e.algorithmParams=this.algorithmParams.toJSON()),e}isEqual(e){return e instanceof Ai!=!1&&(this.algorithmId===e.algorithmId&&("algorithmParams"in this?"algorithmParams"in e&&JSON.stringify(this.algorithmParams)===JSON.stringify(e.algorithmParams):!("algorithmParams"in e)))}}class Ii{static register(e,t,r){this.namedCurves[e.toLowerCase()]=this.namedCurves[t]={name:e,id:t,size:r}}static find(e){return this.namedCurves[e.toLowerCase()]||null}}Ii.namedCurves={},Ii.register("P-256","1.2.840.10045.3.1.7",32),Ii.register("P-384","1.3.132.0.34",48),Ii.register("P-521","1.3.132.0.35",66),Ii.register("brainpoolP256r1","1.3.36.3.3.2.8.1.1.7",32),Ii.register("brainpoolP384r1","1.3.36.3.3.2.8.1.1.11",48),Ii.register("brainpoolP512r1","1.3.36.3.3.2.8.1.1.13",64);class Ci{constructor(e={}){this.x=Ee(e,"x",Ci.defaultValues("x")),this.y=Ee(e,"y",Ci.defaultValues("y")),this.namedCurve=Ee(e,"namedCurve",Ci.defaultValues("namedCurve")),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"x":case"y":return new ArrayBuffer(0);case"namedCurve":return"";default:throw new Error(`Invalid member name for ECCPublicKey class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"x":case"y":return Re(t,Ci.defaultValues(e));case"namedCurve":return""===t;default:throw new Error(`Invalid member name for ECCPublicKey class: ${e}`)}}static schema(e={}){return new Ti}fromSchema(e){if(e instanceof ArrayBuffer==!1)throw new Error("Object's schema was not verified against input data for ECPublicKey");if(4!==new Uint8Array(e)[0])throw new Error("Object's schema was not verified against input data for ECPublicKey");const t=Ii.find(this.namedCurve);if(!t)throw new Error(`Incorrect curve OID: ${this.namedCurve}`);const r=t.size;if(e.byteLength!==2*r+1)throw new Error("Object's schema was not verified against input data for ECPublicKey");this.x=e.slice(1,r+1),this.y=e.slice(1+r,2*r+1)}toSchema(){return new Ti({data:xe(new Uint8Array([4]).buffer,this.x,this.y)})}toJSON(){const e=Ii.find(this.namedCurve);return{crv:e?e.name:this.namedCurve,x:Pe(De(this.x),!0,!0,!1),y:Pe(De(this.y),!0,!0,!1)}}fromJSON(e){let t=0;if(!("crv"in e))throw new Error('Absent mandatory parameter "crv"');{const r=Ii.find(e.crv);r&&(this.namedCurve=r.id,t=r.size)}if(!("x"in e))throw new Error('Absent mandatory parameter "x"');{const r=Me(Le(e.x,!0));if(r.byteLength<t){this.x=new ArrayBuffer(t);const e=new Uint8Array(this.x),n=new Uint8Array(r);e.set(n,1)}else this.x=r.slice(0,t)}if(!("y"in e))throw new Error('Absent mandatory parameter "y"');{const r=Me(Le(e.y,!0));if(r.byteLength<t){this.y=new ArrayBuffer(t);const e=new Uint8Array(this.y),n=new Uint8Array(r);e.set(n,1)}else this.y=r.slice(0,t)}}}class Ri{constructor(e={}){this.modulus=Ee(e,"modulus",Ri.defaultValues("modulus")),this.publicExponent=Ee(e,"publicExponent",Ri.defaultValues("publicExponent")),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"modulus":case"publicExponent":return new jn;default:throw new Error(`Invalid member name for RSAPublicKey class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new jn({name:t.modulus||""}),new jn({name:t.publicExponent||""})]})}fromSchema(e){Fe(e,["modulus","publicExponent"]);const t=xi(e,e,Ri.schema({names:{modulus:"modulus",publicExponent:"publicExponent"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for RSAPublicKey");this.modulus=t.result.modulus.convertFromDER(256),this.publicExponent=t.result.publicExponent}toSchema(){return new Kn({value:[this.modulus.convertToDER(),this.publicExponent]})}toJSON(){return{n:Pe(De(this.modulus.valueBlock.valueHex),!0,!0,!0),e:Pe(De(this.publicExponent.valueBlock.valueHex),!0,!0,!0)}}fromJSON(e){if(!("n"in e))throw new Error('Absent mandatory parameter "n"');{const t=Me(Le(e.n,!0));this.modulus=new jn({valueHex:t.slice(0,Math.pow(2,Be(t.byteLength)))})}if(!("e"in e))throw new Error('Absent mandatory parameter "e"');this.publicExponent=new jn({valueHex:Me(Le(e.e,!0)).slice(0,3)})}}class ki{constructor(e={}){this.algorithm=Ee(e,"algorithm",ki.defaultValues("algorithm")),this.subjectPublicKey=Ee(e,"subjectPublicKey",ki.defaultValues("subjectPublicKey")),"parsedKey"in e&&(this.parsedKey=Ee(e,"parsedKey",ki.defaultValues("parsedKey"))),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"algorithm":return new Ai;case"subjectPublicKey":return new Dn;default:throw new Error(`Invalid member name for PublicKeyInfo class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[Ai.schema(t.algorithm||{}),new Dn({name:t.subjectPublicKey||""})]})}fromSchema(e){Fe(e,["algorithm","subjectPublicKey"]);const t=xi(e,e,ki.schema({names:{algorithm:{names:{blockName:"algorithm"}},subjectPublicKey:"subjectPublicKey"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PublicKeyInfo");switch(this.algorithm=new Ai({schema:t.result.algorithm}),this.subjectPublicKey=t.result.subjectPublicKey,this.algorithm.algorithmId){case"1.2.840.10045.2.1":if("algorithmParams"in this.algorithm&&this.algorithm.algorithmParams.constructor.blockName()===qn.blockName())try{this.parsedKey=new Ci({namedCurve:this.algorithm.algorithmParams.valueBlock.toString(),schema:this.subjectPublicKey.valueBlock.valueHex})}catch(e){}break;case"1.2.840.113549.1.1.1":{const e=Tn(this.subjectPublicKey.valueBlock.valueHex);if(-1!==e.offset)try{this.parsedKey=new Ri({schema:e.result})}catch(e){}}}}toSchema(){return new Kn({value:[this.algorithm.toSchema(),this.subjectPublicKey]})}toJSON(){if("parsedKey"in this==!1)return{algorithm:this.algorithm.toJSON(),subjectPublicKey:this.subjectPublicKey.toJSON()};const e={};switch(this.algorithm.algorithmId){case"1.2.840.10045.2.1":e.kty="EC";break;case"1.2.840.113549.1.1.1":e.kty="RSA"}const t=this.parsedKey.toJSON();for(const r of Object.keys(t))e[r]=t[r];return e}fromJSON(e){if("kty"in e){switch(e.kty.toUpperCase()){case"EC":this.parsedKey=new Ci({json:e}),this.algorithm=new Ai({algorithmId:"1.2.840.10045.2.1",algorithmParams:new qn({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new Ri({json:e}),this.algorithm=new Ai({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new Rn});break;default:throw new Error(`Invalid value for "kty" parameter: ${e.kty}`)}this.subjectPublicKey=new Dn({valueHex:this.parsedKey.toSchema().toBER(!1)})}}importKey(e){let t=Promise.resolve();const r=this;if(void 0===e)return Promise.reject("Need to provide publicKey input parameter");const n=Zi();return void 0===n?Promise.reject("Unable to create WebCrypto object"):(t=t.then((()=>n.exportKey("spki",e))),t=t.then((e=>{const t=Tn(e);try{r.fromSchema(t.result)}catch(e){return Promise.reject("Error during initializing object from schema")}}),(e=>Promise.reject(`Error during exporting public key: ${e}`))),t)}}class Oi{constructor(e={}){this.type=Ee(e,"type",Oi.defaultValues("type")),this.values=Ee(e,"values",Oi.defaultValues("values")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"type":return"";case"values":return[];default:throw new Error(`Invalid member name for Attribute class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"type":return""===t;case"values":return 0===t.length;default:throw new Error(`Invalid member name for Attribute class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new qn({name:t.type||""}),new Wn({name:t.setName||"",value:[new _i({name:t.values||"",value:new wi})]})]})}fromSchema(e){Fe(e,["type","values"]);const t=xi(e,e,Oi.schema({names:{type:"type",values:"values"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for Attribute");this.type=t.result.type.valueBlock.toString(),this.values=t.result.values}toSchema(){return new Kn({value:[new qn({value:this.type}),new Wn({value:this.values})]})}toJSON(){return{type:this.type,values:Array.from(this.values,(e=>e.toJSON()))}}}class Ni{constructor(e={}){this.version=Ee(e,"version",Ni.defaultValues("version")),this.privateKey=Ee(e,"privateKey",Ni.defaultValues("privateKey")),"namedCurve"in e&&(this.namedCurve=Ee(e,"namedCurve",Ni.defaultValues("namedCurve"))),"publicKey"in e&&(this.publicKey=Ee(e,"publicKey",Ni.defaultValues("publicKey"))),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"version":return 1;case"privateKey":return new Pn;case"namedCurve":return"";case"publicKey":return new Ci;default:throw new Error(`Invalid member name for ECCPrivateKey class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"version":return t===Ni.defaultValues(e);case"privateKey":return t.isEqual(Ni.defaultValues(e));case"namedCurve":return""===t;case"publicKey":return Ci.compareWithDefault("namedCurve",t.namedCurve)&&Ci.compareWithDefault("x",t.x)&&Ci.compareWithDefault("y",t.y);default:throw new Error(`Invalid member name for ECCPrivateKey class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new jn({name:t.version||""}),new Pn({name:t.privateKey||""}),new An({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new qn({name:t.namedCurve||""})]}),new An({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new Dn({name:t.publicKey||""})]})]})}fromSchema(e){Fe(e,["version","privateKey","namedCurve","publicKey"]);const t=xi(e,e,Ni.schema({names:{version:"version",privateKey:"privateKey",namedCurve:"namedCurve",publicKey:"publicKey"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for ECPrivateKey");if(this.version=t.result.version.valueBlock.valueDec,this.privateKey=t.result.privateKey,"namedCurve"in t.result&&(this.namedCurve=t.result.namedCurve.valueBlock.toString()),"publicKey"in t.result){const e={schema:t.result.publicKey.valueBlock.valueHex};"namedCurve"in this&&(e.namedCurve=this.namedCurve),this.publicKey=new Ci(e)}}toSchema(){const e=[new jn({value:this.version}),this.privateKey];return"namedCurve"in this&&e.push(new An({idBlock:{tagClass:3,tagNumber:0},value:[new qn({value:this.namedCurve})]})),"publicKey"in this&&e.push(new An({idBlock:{tagClass:3,tagNumber:1},value:[new Dn({valueHex:this.publicKey.toSchema().toBER(!1)})]})),new Kn({value:e})}toJSON(){if("namedCurve"in this==!1||Ni.compareWithDefault("namedCurve",this.namedCurve))throw new Error('Not enough information for making JSON: absent "namedCurve" value');let e="";switch(this.namedCurve){case"1.2.840.10045.3.1.7":e="P-256";break;case"1.3.132.0.34":e="P-384";break;case"1.3.132.0.35":e="P-521"}const t={crv:e,d:Pe(De(this.privateKey.valueBlock.valueHex),!0,!0,!1)};if("publicKey"in this){const e=this.publicKey.toJSON();t.x=e.x,t.y=e.y}return t}fromJSON(e){let t=0;if(!("crv"in e))throw new Error('Absent mandatory parameter "crv"');switch(e.crv.toUpperCase()){case"P-256":this.namedCurve="1.2.840.10045.3.1.7",t=32;break;case"P-384":this.namedCurve="1.3.132.0.34",t=48;break;case"P-521":this.namedCurve="1.3.132.0.35",t=66}if(!("d"in e))throw new Error('Absent mandatory parameter "d"');{const r=Me(Le(e.d,!0));if(r.byteLength<t){const e=new ArrayBuffer(t),n=new Uint8Array(e),i=new Uint8Array(r);n.set(i,1),this.privateKey=new Pn({valueHex:e})}else this.privateKey=new Pn({valueHex:r.slice(0,t)})}"x"in e&&"y"in e&&(this.publicKey=new Ci({json:e}))}}class Pi{constructor(e={}){this.prime=Ee(e,"prime",Pi.defaultValues("prime")),this.exponent=Ee(e,"exponent",Pi.defaultValues("exponent")),this.coefficient=Ee(e,"coefficient",Pi.defaultValues("coefficient")),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"prime":case"exponent":case"coefficient":return new jn;default:throw new Error(`Invalid member name for OtherPrimeInfo class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new jn({name:t.prime||""}),new jn({name:t.exponent||""}),new jn({name:t.coefficient||""})]})}fromSchema(e){Fe(e,["prime","exponent","coefficient"]);const t=xi(e,e,Pi.schema({names:{prime:"prime",exponent:"exponent",coefficient:"coefficient"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for OtherPrimeInfo");this.prime=t.result.prime.convertFromDER(),this.exponent=t.result.exponent.convertFromDER(),this.coefficient=t.result.coefficient.convertFromDER()}toSchema(){return new Kn({value:[this.prime.convertToDER(),this.exponent.convertToDER(),this.coefficient.convertToDER()]})}toJSON(){return{r:Pe(De(this.prime.valueBlock.valueHex),!0,!0),d:Pe(De(this.exponent.valueBlock.valueHex),!0,!0),t:Pe(De(this.coefficient.valueBlock.valueHex),!0,!0)}}fromJSON(e){if(!("r"in e))throw new Error('Absent mandatory parameter "r"');if(this.prime=new jn({valueHex:Me(Le(e.r,!0))}),!("d"in e))throw new Error('Absent mandatory parameter "d"');if(this.exponent=new jn({valueHex:Me(Le(e.d,!0))}),!("t"in e))throw new Error('Absent mandatory parameter "t"');this.coefficient=new jn({valueHex:Me(Le(e.t,!0))})}}class Li{constructor(e={}){this.version=Ee(e,"version",Li.defaultValues("version")),this.modulus=Ee(e,"modulus",Li.defaultValues("modulus")),this.publicExponent=Ee(e,"publicExponent",Li.defaultValues("publicExponent")),this.privateExponent=Ee(e,"privateExponent",Li.defaultValues("privateExponent")),this.prime1=Ee(e,"prime1",Li.defaultValues("prime1")),this.prime2=Ee(e,"prime2",Li.defaultValues("prime2")),this.exponent1=Ee(e,"exponent1",Li.defaultValues("exponent1")),this.exponent2=Ee(e,"exponent2",Li.defaultValues("exponent2")),this.coefficient=Ee(e,"coefficient",Li.defaultValues("coefficient")),"otherPrimeInfos"in e&&(this.otherPrimeInfos=Ee(e,"otherPrimeInfos",Li.defaultValues("otherPrimeInfos"))),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"version":return 0;case"modulus":case"publicExponent":case"privateExponent":case"prime1":case"prime2":case"exponent1":case"exponent2":case"coefficient":return new jn;case"otherPrimeInfos":return[];default:throw new Error(`Invalid member name for RSAPrivateKey class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new jn({name:t.version||""}),new jn({name:t.modulus||""}),new jn({name:t.publicExponent||""}),new jn({name:t.privateExponent||""}),new jn({name:t.prime1||""}),new jn({name:t.prime2||""}),new jn({name:t.exponent1||""}),new jn({name:t.exponent2||""}),new jn({name:t.coefficient||""}),new Kn({optional:!0,value:[new _i({name:t.otherPrimeInfosName||"",value:Pi.schema(t.otherPrimeInfo||{})})]})]})}fromSchema(e){Fe(e,["version","modulus","publicExponent","privateExponent","prime1","prime2","exponent1","exponent2","coefficient","otherPrimeInfos"]);const t=xi(e,e,Li.schema({names:{version:"version",modulus:"modulus",publicExponent:"publicExponent",privateExponent:"privateExponent",prime1:"prime1",prime2:"prime2",exponent1:"exponent1",exponent2:"exponent2",coefficient:"coefficient",otherPrimeInfo:{names:{blockName:"otherPrimeInfos"}}}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for RSAPrivateKey");this.version=t.result.version.valueBlock.valueDec,this.modulus=t.result.modulus.convertFromDER(256),this.publicExponent=t.result.publicExponent,this.privateExponent=t.result.privateExponent.convertFromDER(256),this.prime1=t.result.prime1.convertFromDER(128),this.prime2=t.result.prime2.convertFromDER(128),this.exponent1=t.result.exponent1.convertFromDER(128),this.exponent2=t.result.exponent2.convertFromDER(128),this.coefficient=t.result.coefficient.convertFromDER(128),"otherPrimeInfos"in t.result&&(this.otherPrimeInfos=Array.from(t.result.otherPrimeInfos,(e=>new Pi({schema:e}))))}toSchema(){const e=[];return e.push(new jn({value:this.version})),e.push(this.modulus.convertToDER()),e.push(this.publicExponent),e.push(this.privateExponent.convertToDER()),e.push(this.prime1.convertToDER()),e.push(this.prime2.convertToDER()),e.push(this.exponent1.convertToDER()),e.push(this.exponent2.convertToDER()),e.push(this.coefficient.convertToDER()),"otherPrimeInfos"in this&&e.push(new Kn({value:Array.from(this.otherPrimeInfos,(e=>e.toSchema()))})),new Kn({value:e})}toJSON(){const e={n:Pe(De(this.modulus.valueBlock.valueHex),!0,!0,!0),e:Pe(De(this.publicExponent.valueBlock.valueHex),!0,!0,!0),d:Pe(De(this.privateExponent.valueBlock.valueHex),!0,!0,!0),p:Pe(De(this.prime1.valueBlock.valueHex),!0,!0,!0),q:Pe(De(this.prime2.valueBlock.valueHex),!0,!0,!0),dp:Pe(De(this.exponent1.valueBlock.valueHex),!0,!0,!0),dq:Pe(De(this.exponent2.valueBlock.valueHex),!0,!0,!0),qi:Pe(De(this.coefficient.valueBlock.valueHex),!0,!0,!0)};return"otherPrimeInfos"in this&&(e.oth=Array.from(this.otherPrimeInfos,(e=>e.toJSON()))),e}fromJSON(e){if(!("n"in e))throw new Error('Absent mandatory parameter "n"');if(this.modulus=new jn({valueHex:Me(Le(e.n,!0,!0))}),!("e"in e))throw new Error('Absent mandatory parameter "e"');if(this.publicExponent=new jn({valueHex:Me(Le(e.e,!0,!0))}),!("d"in e))throw new Error('Absent mandatory parameter "d"');if(this.privateExponent=new jn({valueHex:Me(Le(e.d,!0,!0))}),!("p"in e))throw new Error('Absent mandatory parameter "p"');if(this.prime1=new jn({valueHex:Me(Le(e.p,!0,!0))}),!("q"in e))throw new Error('Absent mandatory parameter "q"');if(this.prime2=new jn({valueHex:Me(Le(e.q,!0,!0))}),!("dp"in e))throw new Error('Absent mandatory parameter "dp"');if(this.exponent1=new jn({valueHex:Me(Le(e.dp,!0,!0))}),!("dq"in e))throw new Error('Absent mandatory parameter "dq"');if(this.exponent2=new jn({valueHex:Me(Le(e.dq,!0,!0))}),!("qi"in e))throw new Error('Absent mandatory parameter "qi"');this.coefficient=new jn({valueHex:Me(Le(e.qi,!0,!0))}),"oth"in e&&(this.otherPrimeInfos=Array.from(e.oth,(e=>new Pi({json:e}))))}}class Di{constructor(e={}){this.version=Ee(e,"version",Di.defaultValues("version")),this.privateKeyAlgorithm=Ee(e,"privateKeyAlgorithm",Di.defaultValues("privateKeyAlgorithm")),this.privateKey=Ee(e,"privateKey",Di.defaultValues("privateKey")),"attributes"in e&&(this.attributes=Ee(e,"attributes",Di.defaultValues("attributes"))),"parsedKey"in e&&(this.parsedKey=Ee(e,"parsedKey",Di.defaultValues("parsedKey"))),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"version":return 0;case"privateKeyAlgorithm":return new Ai;case"privateKey":return new Pn;case"attributes":return[];case"parsedKey":return{};default:throw new Error(`Invalid member name for PrivateKeyInfo class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new jn({name:t.version||""}),Ai.schema(t.privateKeyAlgorithm||{}),new Pn({name:t.privateKey||""}),new An({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new _i({name:t.attributes||"",value:Oi.schema()})]})]})}fromSchema(e){Fe(e,["version","privateKeyAlgorithm","privateKey","attributes"]);const t=xi(e,e,Di.schema({names:{version:"version",privateKeyAlgorithm:{names:{blockName:"privateKeyAlgorithm"}},privateKey:"privateKey",attributes:"attributes"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PrivateKeyInfo");switch(this.version=t.result.version.valueBlock.valueDec,this.privateKeyAlgorithm=new Ai({schema:t.result.privateKeyAlgorithm}),this.privateKey=t.result.privateKey,"attributes"in t.result&&(this.attributes=Array.from(t.result.attributes,(e=>new Oi({schema:e})))),this.privateKeyAlgorithm.algorithmId){case"1.2.840.113549.1.1.1":{const e=Tn(this.privateKey.valueBlock.valueHex);-1!==e.offset&&(this.parsedKey=new Li({schema:e.result}))}break;case"1.2.840.10045.2.1":if("algorithmParams"in this.privateKeyAlgorithm&&this.privateKeyAlgorithm.algorithmParams instanceof qn){const e=Tn(this.privateKey.valueBlock.valueHex);-1!==e.offset&&(this.parsedKey=new Ni({namedCurve:this.privateKeyAlgorithm.algorithmParams.valueBlock.toString(),schema:e.result}))}}}toSchema(){const e=[new jn({value:this.version}),this.privateKeyAlgorithm.toSchema(),this.privateKey];return"attributes"in this&&e.push(new An({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.attributes,(e=>e.toSchema()))})),new Kn({value:e})}toJSON(){if("parsedKey"in this==!1){const e={version:this.version,privateKeyAlgorithm:this.privateKeyAlgorithm.toJSON(),privateKey:this.privateKey.toJSON()};return"attributes"in this&&(e.attributes=Array.from(this.attributes,(e=>e.toJSON()))),e}const e={};switch(this.privateKeyAlgorithm.algorithmId){case"1.2.840.10045.2.1":e.kty="EC";break;case"1.2.840.113549.1.1.1":e.kty="RSA"}const t=this.parsedKey.toJSON();for(const r of Object.keys(t))e[r]=t[r];return e}fromJSON(e){if("kty"in e){switch(e.kty.toUpperCase()){case"EC":this.parsedKey=new Ni({json:e}),this.privateKeyAlgorithm=new Ai({algorithmId:"1.2.840.10045.2.1",algorithmParams:new qn({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new Li({json:e}),this.privateKeyAlgorithm=new Ai({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new Rn});break;default:throw new Error(`Invalid value for "kty" parameter: ${e.kty}`)}this.privateKey=new Pn({valueHex:this.parsedKey.toSchema().toBER(!1)})}}}class Mi{constructor(e={}){if(this.contentType=Ee(e,"contentType",Mi.defaultValues("contentType")),this.contentEncryptionAlgorithm=Ee(e,"contentEncryptionAlgorithm",Mi.defaultValues("contentEncryptionAlgorithm")),"encryptedContent"in e&&(this.encryptedContent=e.encryptedContent,1===this.encryptedContent.idBlock.tagClass&&4===this.encryptedContent.idBlock.tagNumber&&!1===this.encryptedContent.idBlock.isConstructed)){const e=new Pn({idBlock:{isConstructed:!0},isConstructed:!0});let t=0,r=this.encryptedContent.valueBlock.valueHex.byteLength;for(;r>0;){const n=new Uint8Array(this.encryptedContent.valueBlock.valueHex,t,t+1024>this.encryptedContent.valueBlock.valueHex.byteLength?this.encryptedContent.valueBlock.valueHex.byteLength-t:1024),i=new ArrayBuffer(n.length),o=new Uint8Array(i);for(let e=0;e<o.length;e++)o[e]=n[e];e.valueBlock.value.push(new Pn({valueHex:i})),r-=n.length,t+=n.length}this.encryptedContent=e}"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"contentType":return"";case"contentEncryptionAlgorithm":return new Ai;case"encryptedContent":return new Pn;default:throw new Error(`Invalid member name for EncryptedContentInfo class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"contentType":return""===t;case"contentEncryptionAlgorithm":return""===t.algorithmId&&"algorithmParams"in t==!1;case"encryptedContent":return t.isEqual(Mi.defaultValues(e));default:throw new Error(`Invalid member name for EncryptedContentInfo class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new qn({name:t.contentType||""}),Ai.schema(t.contentEncryptionAlgorithm||{}),new Si({value:[new An({name:t.encryptedContent||"",idBlock:{tagClass:3,tagNumber:0},value:[new _i({value:new Pn})]}),new Sn({name:t.encryptedContent||"",idBlock:{tagClass:3,tagNumber:0}})]})]})}fromSchema(e){Fe(e,["contentType","contentEncryptionAlgorithm","encryptedContent"]);const t=xi(e,e,Mi.schema({names:{contentType:"contentType",contentEncryptionAlgorithm:{names:{blockName:"contentEncryptionAlgorithm"}},encryptedContent:"encryptedContent"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for EncryptedContentInfo");this.contentType=t.result.contentType.valueBlock.toString(),this.contentEncryptionAlgorithm=new Ai({schema:t.result.contentEncryptionAlgorithm}),"encryptedContent"in t.result&&(this.encryptedContent=t.result.encryptedContent,this.encryptedContent.idBlock.tagClass=1,this.encryptedContent.idBlock.tagNumber=4)}toSchema(){const e={isIndefiniteForm:!1},t=[];if(t.push(new qn({value:this.contentType})),t.push(this.contentEncryptionAlgorithm.toSchema()),"encryptedContent"in this){e.isIndefiniteForm=this.encryptedContent.idBlock.isConstructed;const r=this.encryptedContent;r.idBlock.tagClass=3,r.idBlock.tagNumber=0,r.lenBlock.isIndefiniteForm=this.encryptedContent.idBlock.isConstructed,t.push(r)}return new Kn({lenBlock:e,value:t})}toJSON(){const e={contentType:this.contentType,contentEncryptionAlgorithm:this.contentEncryptionAlgorithm.toJSON()};return"encryptedContent"in this&&(e.encryptedContent=this.encryptedContent.toJSON()),e}}class Ui{constructor(e={}){this.hashAlgorithm=Ee(e,"hashAlgorithm",Ui.defaultValues("hashAlgorithm")),this.maskGenAlgorithm=Ee(e,"maskGenAlgorithm",Ui.defaultValues("maskGenAlgorithm")),this.saltLength=Ee(e,"saltLength",Ui.defaultValues("saltLength")),this.trailerField=Ee(e,"trailerField",Ui.defaultValues("trailerField")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"hashAlgorithm":return new Ai({algorithmId:"1.3.14.3.2.26",algorithmParams:new Rn});case"maskGenAlgorithm":return new Ai({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:new Ai({algorithmId:"1.3.14.3.2.26",algorithmParams:new Rn}).toSchema()});case"saltLength":return 20;case"trailerField":return 1;default:throw new Error(`Invalid member name for RSASSAPSSParams class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new An({idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[Ai.schema(t.hashAlgorithm||{})]}),new An({idBlock:{tagClass:3,tagNumber:1},optional:!0,value:[Ai.schema(t.maskGenAlgorithm||{})]}),new An({idBlock:{tagClass:3,tagNumber:2},optional:!0,value:[new jn({name:t.saltLength||""})]}),new An({idBlock:{tagClass:3,tagNumber:3},optional:!0,value:[new jn({name:t.trailerField||""})]})]})}fromSchema(e){Fe(e,["hashAlgorithm","maskGenAlgorithm","saltLength","trailerField"]);const t=xi(e,e,Ui.schema({names:{hashAlgorithm:{names:{blockName:"hashAlgorithm"}},maskGenAlgorithm:{names:{blockName:"maskGenAlgorithm"}},saltLength:"saltLength",trailerField:"trailerField"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for RSASSAPSSParams");"hashAlgorithm"in t.result&&(this.hashAlgorithm=new Ai({schema:t.result.hashAlgorithm})),"maskGenAlgorithm"in t.result&&(this.maskGenAlgorithm=new Ai({schema:t.result.maskGenAlgorithm})),"saltLength"in t.result&&(this.saltLength=t.result.saltLength.valueBlock.valueDec),"trailerField"in t.result&&(this.trailerField=t.result.trailerField.valueBlock.valueDec)}toSchema(){const e=[];return this.hashAlgorithm.isEqual(Ui.defaultValues("hashAlgorithm"))||e.push(new An({idBlock:{tagClass:3,tagNumber:0},value:[this.hashAlgorithm.toSchema()]})),this.maskGenAlgorithm.isEqual(Ui.defaultValues("maskGenAlgorithm"))||e.push(new An({idBlock:{tagClass:3,tagNumber:1},value:[this.maskGenAlgorithm.toSchema()]})),this.saltLength!==Ui.defaultValues("saltLength")&&e.push(new An({idBlock:{tagClass:3,tagNumber:2},value:[new jn({value:this.saltLength})]})),this.trailerField!==Ui.defaultValues("trailerField")&&e.push(new An({idBlock:{tagClass:3,tagNumber:3},value:[new jn({value:this.trailerField})]})),new Kn({value:e})}toJSON(){const e={};return this.hashAlgorithm.isEqual(Ui.defaultValues("hashAlgorithm"))||(e.hashAlgorithm=this.hashAlgorithm.toJSON()),this.maskGenAlgorithm.isEqual(Ui.defaultValues("maskGenAlgorithm"))||(e.maskGenAlgorithm=this.maskGenAlgorithm.toJSON()),this.saltLength!==Ui.defaultValues("saltLength")&&(e.saltLength=this.saltLength),this.trailerField!==Ui.defaultValues("trailerField")&&(e.trailerField=this.trailerField),e}}class Bi{constructor(e={}){this.salt=Ee(e,"salt",Bi.defaultValues("salt")),this.iterationCount=Ee(e,"iterationCount",Bi.defaultValues("iterationCount")),"keyLength"in e&&(this.keyLength=Ee(e,"keyLength",Bi.defaultValues("keyLength"))),"prf"in e&&(this.prf=Ee(e,"prf",Bi.defaultValues("prf"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"salt":return{};case"iterationCount":return-1;case"keyLength":return 0;case"prf":return new Ai({algorithmId:"1.3.14.3.2.26",algorithmParams:new Rn});default:throw new Error(`Invalid member name for PBKDF2Params class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new Si({value:[new Pn({name:t.saltPrimitive||""}),Ai.schema(t.saltConstructed||{})]}),new jn({name:t.iterationCount||""}),new jn({name:t.keyLength||"",optional:!0}),Ai.schema(t.prf||{names:{optional:!0}})]})}fromSchema(e){Fe(e,["salt","iterationCount","keyLength","prf"]);const t=xi(e,e,Bi.schema({names:{saltPrimitive:"salt",saltConstructed:{names:{blockName:"salt"}},iterationCount:"iterationCount",keyLength:"keyLength",prf:{names:{blockName:"prf",optional:!0}}}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PBKDF2Params");this.salt=t.result.salt,this.iterationCount=t.result.iterationCount.valueBlock.valueDec,"keyLength"in t.result&&(this.keyLength=t.result.keyLength.valueBlock.valueDec),"prf"in t.result&&(this.prf=new Ai({schema:t.result.prf}))}toSchema(){const e=[];return e.push(this.salt),e.push(new jn({value:this.iterationCount})),"keyLength"in this&&Bi.defaultValues("keyLength")!==this.keyLength&&e.push(new jn({value:this.keyLength})),"prf"in this&&!1===Bi.defaultValues("prf").isEqual(this.prf)&&e.push(this.prf.toSchema()),new Kn({value:e})}toJSON(){const e={salt:this.salt.toJSON(),iterationCount:this.iterationCount};return"keyLength"in this&&Bi.defaultValues("keyLength")!==this.keyLength&&(e.keyLength=this.keyLength),"prf"in this&&!1===Bi.defaultValues("prf").isEqual(this.prf)&&(e.prf=this.prf.toJSON()),e}}class Fi{constructor(e={}){this.keyDerivationFunc=Ee(e,"keyDerivationFunc",Fi.defaultValues("keyDerivationFunc")),this.encryptionScheme=Ee(e,"encryptionScheme",Fi.defaultValues("encryptionScheme")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"keyDerivationFunc":case"encryptionScheme":return new Ai;default:throw new Error(`Invalid member name for PBES2Params class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[Ai.schema(t.keyDerivationFunc||{}),Ai.schema(t.encryptionScheme||{})]})}fromSchema(e){Fe(e,["keyDerivationFunc","encryptionScheme"]);const t=xi(e,e,Fi.schema({names:{keyDerivationFunc:{names:{blockName:"keyDerivationFunc"}},encryptionScheme:{names:{blockName:"encryptionScheme"}}}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PBES2Params");this.keyDerivationFunc=new Ai({schema:t.result.keyDerivationFunc}),this.encryptionScheme=new Ai({schema:t.result.encryptionScheme})}toSchema(){return new Kn({value:[this.keyDerivationFunc.toSchema(),this.encryptionScheme.toSchema()]})}toJSON(){return{keyDerivationFunc:this.keyDerivationFunc.toJSON(),encryptionScheme:this.encryptionScheme.toJSON()}}}function ji(e,t,r,n,i,o){let s,a;const c=[];switch(t.toUpperCase()){case"SHA-1":s=20,a=64;break;case"SHA-256":s=32,a=64;break;case"SHA-384":s=48,a=128;break;case"SHA-512":s=64,a=128;break;default:throw new Error("Unsupported hashing algorithm")}const u=new Uint8Array(n),l=new ArrayBuffer(2*n.byteLength+2),d=new Uint8Array(l);for(let e=0;e<u.length;e++)d[2*e]=0,d[2*e+1]=u[e];d[d.length-2]=0,d[d.length-1]=0,n=l.slice(0);const h=new ArrayBuffer(a),f=new Uint8Array(h);for(let e=0;e<h.byteLength;e++)f[e]=3;const p=i.byteLength,m=a*Math.ceil(p/a),g=new ArrayBuffer(m),v=new Uint8Array(g),y=new Uint8Array(i);for(let e=0;e<m;e++)v[e]=y[e%p];const b=n.byteLength,E=a*Math.ceil(b/a),w=new ArrayBuffer(E),S=new Uint8Array(w),_=new Uint8Array(n);for(let e=0;e<E;e++)S[e]=_[e%b];const T=g.byteLength+w.byteLength;let x=new ArrayBuffer(T),A=new Uint8Array(x);A.set(v),A.set(S,v.length);const I=Math.ceil((r>>3)/s);let C=Promise.resolve(x);for(let r=0;r<=I;r++){C=C.then((e=>{const t=new ArrayBuffer(h.byteLength+e.byteLength),r=new Uint8Array(t);return r.set(f),r.set(A,f.length),t}));for(let r=0;r<o;r++)C=C.then((r=>e.digest({name:t},new Uint8Array(r))));C=C.then((e=>{const t=new ArrayBuffer(a),r=new Uint8Array(t);for(let n=0;n<t.byteLength;n++)r[n]=e[n%e.length];const n=Math.ceil(p/a)+Math.ceil(b/a),i=[];let o=0,s=a;for(let e=0;e<n;e++){const e=Array.from(new Uint8Array(x.slice(o,o+s)));o+=a,o+a>x.byteLength&&(s=x.byteLength-o);let n=511;for(let i=t.byteLength-1;i>=0;i--)n>>=8,n+=r[i]+e[i],e[i]=255&n;i.push(...e)}return x=new ArrayBuffer(i.length),A=new Uint8Array(x),A.set(i),c.push(...new Uint8Array(e)),x}))}return C=C.then((()=>{const e=new ArrayBuffer(r>>3);return new Uint8Array(e).set(new Uint8Array(c).slice(0,r>>3)),e})),C}class Vi{constructor(e={}){this.crypto=Ee(e,"crypto",{}),this.subtle=Ee(e,"subtle",{}),this.name=Ee(e,"name","")}importKey(e,t,r,n,i){let o={};switch(t instanceof Uint8Array&&(t=t.buffer),e.toLowerCase()){case"raw":return this.subtle.importKey("raw",t,r,n,i);case"spki":{const e=Tn(t);if(-1===e.offset)return Promise.reject("Incorrect keyData");const s=new ki;try{s.fromSchema(e.result)}catch(e){return Promise.reject("Incorrect keyData")}switch(r.name.toUpperCase()){case"RSA-PSS":switch(r.hash.name.toUpperCase()){case"SHA-1":o.alg="PS1";break;case"SHA-256":o.alg="PS256";break;case"SHA-384":o.alg="PS384";break;case"SHA-512":o.alg="PS512";break;default:return Promise.reject(`Incorrect hash algorithm: ${r.hash.name.toUpperCase()}`)}case"RSASSA-PKCS1-V1_5":{if(i=["verify"],o.kty="RSA",o.ext=n,o.key_ops=i,"1.2.840.113549.1.1.1"!==s.algorithm.algorithmId)return Promise.reject(`Incorrect public key algorithm: ${s.algorithm.algorithmId}`);if("alg"in o==!1)switch(r.hash.name.toUpperCase()){case"SHA-1":o.alg="RS1";break;case"SHA-256":o.alg="RS256";break;case"SHA-384":o.alg="RS384";break;case"SHA-512":o.alg="RS512";break;default:return Promise.reject(`Incorrect hash algorithm: ${r.hash.name.toUpperCase()}`)}const e=s.toJSON();for(const t of Object.keys(e))o[t]=e[t]}break;case"ECDSA":i=["verify"];case"ECDH":{if(o={kty:"EC",ext:n,key_ops:i},"1.2.840.10045.2.1"!==s.algorithm.algorithmId)return Promise.reject(`Incorrect public key algorithm: ${s.algorithm.algorithmId}`);const e=s.toJSON();for(const t of Object.keys(e))o[t]=e[t]}break;case"RSA-OAEP":{if(o.kty="RSA",o.ext=n,o.key_ops=i,"safari"===this.name.toLowerCase())o.alg="RSA-OAEP";else switch(r.hash.name.toUpperCase()){case"SHA-1":o.alg="RSA-OAEP";break;case"SHA-256":o.alg="RSA-OAEP-256";break;case"SHA-384":o.alg="RSA-OAEP-384";break;case"SHA-512":o.alg="RSA-OAEP-512";break;default:return Promise.reject(`Incorrect hash algorithm: ${r.hash.name.toUpperCase()}`)}const e=s.toJSON();for(const t of Object.keys(e))o[t]=e[t]}break;case"RSAES-PKCS1-V1_5":{o.kty="RSA",o.ext=n,o.key_ops=i,o.alg="PS1";const e=s.toJSON();for(const t of Object.keys(e))o[t]=e[t]}break;default:return Promise.reject(`Incorrect algorithm name: ${r.name.toUpperCase()}`)}}break;case"pkcs8":{const e=new Di,s=Tn(t);if(-1===s.offset)return Promise.reject("Incorrect keyData");try{e.fromSchema(s.result)}catch(e){return Promise.reject("Incorrect keyData")}if("parsedKey"in e==!1)return Promise.reject("Incorrect keyData");switch(r.name.toUpperCase()){case"RSA-PSS":switch(r.hash.name.toUpperCase()){case"SHA-1":o.alg="PS1";break;case"SHA-256":o.alg="PS256";break;case"SHA-384":o.alg="PS384";break;case"SHA-512":o.alg="PS512";break;default:return Promise.reject(`Incorrect hash algorithm: ${r.hash.name.toUpperCase()}`)}case"RSASSA-PKCS1-V1_5":{if(i=["sign"],o.kty="RSA",o.ext=n,o.key_ops=i,"1.2.840.113549.1.1.1"!==e.privateKeyAlgorithm.algorithmId)return Promise.reject(`Incorrect private key algorithm: ${e.privateKeyAlgorithm.algorithmId}`);if("alg"in o==!1)switch(r.hash.name.toUpperCase()){case"SHA-1":o.alg="RS1";break;case"SHA-256":o.alg="RS256";break;case"SHA-384":o.alg="RS384";break;case"SHA-512":o.alg="RS512";break;default:return Promise.reject(`Incorrect hash algorithm: ${r.hash.name.toUpperCase()}`)}const t=e.toJSON();for(const e of Object.keys(t))o[e]=t[e]}break;case"ECDSA":i=["sign"];case"ECDH":{if(o={kty:"EC",ext:n,key_ops:i},"1.2.840.10045.2.1"!==e.privateKeyAlgorithm.algorithmId)return Promise.reject(`Incorrect algorithm: ${e.privateKeyAlgorithm.algorithmId}`);const t=e.toJSON();for(const e of Object.keys(t))o[e]=t[e]}break;case"RSA-OAEP":{if(o.kty="RSA",o.ext=n,o.key_ops=i,"safari"===this.name.toLowerCase())o.alg="RSA-OAEP";else switch(r.hash.name.toUpperCase()){case"SHA-1":o.alg="RSA-OAEP";break;case"SHA-256":o.alg="RSA-OAEP-256";break;case"SHA-384":o.alg="RSA-OAEP-384";break;case"SHA-512":o.alg="RSA-OAEP-512";break;default:return Promise.reject(`Incorrect hash algorithm: ${r.hash.name.toUpperCase()}`)}const t=e.toJSON();for(const e of Object.keys(t))o[e]=t[e]}break;case"RSAES-PKCS1-V1_5":{i=["decrypt"],o.kty="RSA",o.ext=n,o.key_ops=i,o.alg="PS1";const t=e.toJSON();for(const e of Object.keys(t))o[e]=t[e]}break;default:return Promise.reject(`Incorrect algorithm name: ${r.name.toUpperCase()}`)}}break;case"jwk":o=t;break;default:return Promise.reject(`Incorrect format: ${e}`)}return"safari"===this.name.toLowerCase()?Promise.resolve().then((()=>this.subtle.importKey("jwk",Me(JSON.stringify(o)),r,n,i))).then((e=>e),(()=>this.subtle.importKey("jwk",o,r,n,i))):this.subtle.importKey("jwk",o,r,n,i)}exportKey(e,t){let r=this.subtle.exportKey("jwk",t);switch("safari"===this.name.toLowerCase()&&(r=r.then((e=>e instanceof ArrayBuffer?JSON.parse(De(e)):e))),e.toLowerCase()){case"raw":return this.subtle.exportKey("raw",t);case"spki":r=r.then((e=>{const t=new ki;try{t.fromJSON(e)}catch(e){return Promise.reject("Incorrect key data")}return t.toSchema().toBER(!1)}));break;case"pkcs8":r=r.then((e=>{const t=new Di;try{t.fromJSON(e)}catch(e){return Promise.reject("Incorrect key data")}return t.toSchema().toBER(!1)}));break;case"jwk":break;default:return Promise.reject(`Incorrect format: ${e}`)}return r}convert(e,t,r,n,i,o){switch(e.toLowerCase()){case"raw":switch(t.toLowerCase()){case"raw":return Promise.resolve(r);case"spki":return Promise.resolve().then((()=>this.importKey("raw",r,n,i,o))).then((e=>this.exportKey("spki",e)));case"pkcs8":return Promise.resolve().then((()=>this.importKey("raw",r,n,i,o))).then((e=>this.exportKey("pkcs8",e)));case"jwk":return Promise.resolve().then((()=>this.importKey("raw",r,n,i,o))).then((e=>this.exportKey("jwk",e)));default:return Promise.reject(`Incorrect outputFormat: ${t}`)}case"spki":switch(t.toLowerCase()){case"raw":return Promise.resolve().then((()=>this.importKey("spki",r,n,i,o))).then((e=>this.exportKey("raw",e)));case"spki":return Promise.resolve(r);case"pkcs8":return Promise.reject("Impossible to convert between SPKI/PKCS8");case"jwk":return Promise.resolve().then((()=>this.importKey("spki",r,n,i,o))).then((e=>this.exportKey("jwk",e)));default:return Promise.reject(`Incorrect outputFormat: ${t}`)}case"pkcs8":switch(t.toLowerCase()){case"raw":return Promise.resolve().then((()=>this.importKey("pkcs8",r,n,i,o))).then((e=>this.exportKey("raw",e)));case"spki":return Promise.reject("Impossible to convert between SPKI/PKCS8");case"pkcs8":return Promise.resolve(r);case"jwk":return Promise.resolve().then((()=>this.importKey("pkcs8",r,n,i,o))).then((e=>this.exportKey("jwk",e)));default:return Promise.reject(`Incorrect outputFormat: ${t}`)}case"jwk":switch(t.toLowerCase()){case"raw":return Promise.resolve().then((()=>this.importKey("jwk",r,n,i,o))).then((e=>this.exportKey("raw",e)));case"spki":return Promise.resolve().then((()=>this.importKey("jwk",r,n,i,o))).then((e=>this.exportKey("spki",e)));case"pkcs8":return Promise.resolve().then((()=>this.importKey("jwk",r,n,i,o))).then((e=>this.exportKey("pkcs8",e)));case"jwk":return Promise.resolve(r);default:return Promise.reject(`Incorrect outputFormat: ${t}`)}default:return Promise.reject(`Incorrect inputFormat: ${e}`)}}encrypt(...e){return this.subtle.encrypt(...e)}decrypt(...e){return this.subtle.decrypt(...e)}sign(...e){return this.subtle.sign(...e)}verify(...e){return this.subtle.verify(...e)}digest(...e){return this.subtle.digest(...e)}generateKey(...e){return this.subtle.generateKey(...e)}deriveKey(...e){return this.subtle.deriveKey(...e)}deriveBits(...e){return this.subtle.deriveBits(...e)}wrapKey(...e){return this.subtle.wrapKey(...e)}unwrapKey(...e){return this.subtle.unwrapKey(...e)}getRandomValues(e){if("getRandomValues"in this.crypto==!1)throw new Error("No support for getRandomValues");return this.crypto.getRandomValues(e)}getAlgorithmByOID(e){switch(e){case"1.2.840.113549.1.1.1":return{name:"RSAES-PKCS1-v1_5"};case"1.2.840.113549.1.1.5":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case"1.2.840.113549.1.1.11":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"1.2.840.113549.1.1.12":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case"1.2.840.113549.1.1.13":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case"1.2.840.113549.1.1.10":return{name:"RSA-PSS"};case"1.2.840.113549.1.1.7":return{name:"RSA-OAEP"};case"1.2.840.10045.2.1":case"1.2.840.10045.4.1":return{name:"ECDSA",hash:{name:"SHA-1"}};case"1.2.840.10045.4.3.2":return{name:"ECDSA",hash:{name:"SHA-256"}};case"1.2.840.10045.4.3.3":return{name:"ECDSA",hash:{name:"SHA-384"}};case"1.2.840.10045.4.3.4":return{name:"ECDSA",hash:{name:"SHA-512"}};case"1.3.133.16.840.63.0.2":return{name:"ECDH",kdf:"SHA-1"};case"1.3.132.1.11.1":return{name:"ECDH",kdf:"SHA-256"};case"1.3.132.1.11.2":return{name:"ECDH",kdf:"SHA-384"};case"1.3.132.1.11.3":return{name:"ECDH",kdf:"SHA-512"};case"2.16.840.1.101.3.4.1.2":return{name:"AES-CBC",length:128};case"2.16.840.1.101.3.4.1.22":return{name:"AES-CBC",length:192};case"2.16.840.1.101.3.4.1.42":return{name:"AES-CBC",length:256};case"2.16.840.1.101.3.4.1.6":return{name:"AES-GCM",length:128};case"2.16.840.1.101.3.4.1.26":return{name:"AES-GCM",length:192};case"2.16.840.1.101.3.4.1.46":return{name:"AES-GCM",length:256};case"2.16.840.1.101.3.4.1.4":return{name:"AES-CFB",length:128};case"2.16.840.1.101.3.4.1.24":return{name:"AES-CFB",length:192};case"2.16.840.1.101.3.4.1.44":return{name:"AES-CFB",length:256};case"2.16.840.1.101.3.4.1.5":return{name:"AES-KW",length:128};case"2.16.840.1.101.3.4.1.25":return{name:"AES-KW",length:192};case"2.16.840.1.101.3.4.1.45":return{name:"AES-KW",length:256};case"1.2.840.113549.2.7":return{name:"HMAC",hash:{name:"SHA-1"}};case"1.2.840.113549.2.9":return{name:"HMAC",hash:{name:"SHA-256"}};case"1.2.840.113549.2.10":return{name:"HMAC",hash:{name:"SHA-384"}};case"1.2.840.113549.2.11":return{name:"HMAC",hash:{name:"SHA-512"}};case"1.2.840.113549.1.9.16.3.5":return{name:"DH"};case"1.3.14.3.2.26":return{name:"SHA-1"};case"2.16.840.1.101.3.4.2.1":return{name:"SHA-256"};case"2.16.840.1.101.3.4.2.2":return{name:"SHA-384"};case"2.16.840.1.101.3.4.2.3":return{name:"SHA-512"};case"1.2.840.113549.1.5.12":return{name:"PBKDF2"};case"1.2.840.10045.3.1.7":return{name:"P-256"};case"1.3.132.0.34":return{name:"P-384"};case"1.3.132.0.35":return{name:"P-521"}}return{}}getOIDByAlgorithm(e){let t="";switch(e.name.toUpperCase()){case"RSAES-PKCS1-V1_5":t="1.2.840.113549.1.1.1";break;case"RSASSA-PKCS1-V1_5":switch(e.hash.name.toUpperCase()){case"SHA-1":t="1.2.840.113549.1.1.5";break;case"SHA-256":t="1.2.840.113549.1.1.11";break;case"SHA-384":t="1.2.840.113549.1.1.12";break;case"SHA-512":t="1.2.840.113549.1.1.13"}break;case"RSA-PSS":t="1.2.840.113549.1.1.10";break;case"RSA-OAEP":t="1.2.840.113549.1.1.7";break;case"ECDSA":switch(e.hash.name.toUpperCase()){case"SHA-1":t="1.2.840.10045.4.1";break;case"SHA-256":t="1.2.840.10045.4.3.2";break;case"SHA-384":t="1.2.840.10045.4.3.3";break;case"SHA-512":t="1.2.840.10045.4.3.4"}break;case"ECDH":switch(e.kdf.toUpperCase()){case"SHA-1":t="1.3.133.16.840.63.0.2";break;case"SHA-256":t="1.3.132.1.11.1";break;case"SHA-384":t="1.3.132.1.11.2";break;case"SHA-512":t="1.3.132.1.11.3"}break;case"AES-CTR":case"AES-CMAC":case"CONCAT":case"HKDF":break;case"AES-CBC":switch(e.length){case 128:t="2.16.840.1.101.3.4.1.2";break;case 192:t="2.16.840.1.101.3.4.1.22";break;case 256:t="2.16.840.1.101.3.4.1.42"}break;case"AES-GCM":switch(e.length){case 128:t="2.16.840.1.101.3.4.1.6";break;case 192:t="2.16.840.1.101.3.4.1.26";break;case 256:t="2.16.840.1.101.3.4.1.46"}break;case"AES-CFB":switch(e.length){case 128:t="2.16.840.1.101.3.4.1.4";break;case 192:t="2.16.840.1.101.3.4.1.24";break;case 256:t="2.16.840.1.101.3.4.1.44"}break;case"AES-KW":switch(e.length){case 128:t="2.16.840.1.101.3.4.1.5";break;case 192:t="2.16.840.1.101.3.4.1.25";break;case 256:t="2.16.840.1.101.3.4.1.45"}break;case"HMAC":switch(e.hash.name.toUpperCase()){case"SHA-1":t="1.2.840.113549.2.7";break;case"SHA-256":t="1.2.840.113549.2.9";break;case"SHA-384":t="1.2.840.113549.2.10";break;case"SHA-512":t="1.2.840.113549.2.11"}break;case"DH":t="1.2.840.113549.1.9.16.3.5";break;case"SHA-1":t="1.3.14.3.2.26";break;case"SHA-256":t="2.16.840.1.101.3.4.2.1";break;case"SHA-384":t="2.16.840.1.101.3.4.2.2";break;case"SHA-512":t="2.16.840.1.101.3.4.2.3";break;case"PBKDF2":t="1.2.840.113549.1.5.12";break;case"P-256":t="1.2.840.10045.3.1.7";break;case"P-384":t="1.3.132.0.34";break;case"P-521":t="1.3.132.0.35"}return t}getAlgorithmParameters(e,t){let r={algorithm:{},usages:[]};switch(e.toUpperCase()){case"RSAES-PKCS1-V1_5":case"RSASSA-PKCS1-V1_5":switch(t.toLowerCase()){case"generatekey":r={algorithm:{name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["sign","verify"]};break;case"verify":case"sign":case"importkey":r={algorithm:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},usages:["verify"]};break;default:return{algorithm:{name:"RSASSA-PKCS1-v1_5"},usages:[]}}break;case"RSA-PSS":switch(t.toLowerCase()){case"sign":case"verify":r={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"},saltLength:20},usages:["sign","verify"]};break;case"generatekey":r={algorithm:{name:"RSA-PSS",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-1"}},usages:["sign","verify"]};break;case"importkey":r={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"}},usages:["verify"]};break;default:return{algorithm:{name:"RSA-PSS"},usages:[]}}break;case"RSA-OAEP":switch(t.toLowerCase()){case"encrypt":case"decrypt":r={algorithm:{name:"RSA-OAEP"},usages:["encrypt","decrypt"]};break;case"generatekey":r={algorithm:{name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"importkey":r={algorithm:{name:"RSA-OAEP",hash:{name:"SHA-256"}},usages:["encrypt"]};break;default:return{algorithm:{name:"RSA-OAEP"},usages:[]}}break;case"ECDSA":switch(t.toLowerCase()){case"generatekey":r={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["sign","verify"]};break;case"importkey":r={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["verify"]};break;case"verify":case"sign":r={algorithm:{name:"ECDSA",hash:{name:"SHA-256"}},usages:["sign"]};break;default:return{algorithm:{name:"ECDSA"},usages:[]}}break;case"ECDH":switch(t.toLowerCase()){case"exportkey":case"importkey":case"generatekey":r={algorithm:{name:"ECDH",namedCurve:"P-256"},usages:["deriveKey","deriveBits"]};break;case"derivekey":case"derivebits":r={algorithm:{name:"ECDH",namedCurve:"P-256",public:[]},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"ECDH"},usages:[]}}break;case"AES-CTR":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"AES-CTR",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":r={algorithm:{name:"AES-CTR",counter:new Uint8Array(16),length:10},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CTR"},usages:[]}}break;case"AES-CBC":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"AES-CBC",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":r={algorithm:{name:"AES-CBC",iv:this.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CBC"},usages:[]}}break;case"AES-GCM":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"AES-GCM",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":r={algorithm:{name:"AES-GCM",iv:this.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-GCM"},usages:[]}}break;case"AES-KW":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":case"wrapkey":case"unwrapkey":r={algorithm:{name:"AES-KW",length:256},usages:["wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-KW"},usages:[]}}break;case"HMAC":switch(t.toLowerCase()){case"sign":case"verify":r={algorithm:{name:"HMAC"},usages:["sign","verify"]};break;case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"HMAC",length:32,hash:{name:"SHA-256"}},usages:["sign","verify"]};break;default:return{algorithm:{name:"HMAC"},usages:[]}}break;case"HKDF":if("derivekey"!==t.toLowerCase())return{algorithm:{name:"HKDF"},usages:[]};r={algorithm:{name:"HKDF",hash:"SHA-256",salt:new Uint8Array([]),info:new Uint8Array([])},usages:["encrypt","decrypt"]};break;case"PBKDF2":if("derivekey"!==t.toLowerCase())return{algorithm:{name:"PBKDF2"},usages:[]};r={algorithm:{name:"PBKDF2",hash:{name:"SHA-256"},salt:new Uint8Array([]),iterations:1e4},usages:["encrypt","decrypt"]}}return r}getHashAlgorithm(e){let t="";switch(e.algorithmId){case"1.2.840.10045.4.1":case"1.2.840.113549.1.1.5":t="SHA-1";break;case"1.2.840.10045.4.3.2":case"1.2.840.113549.1.1.11":t="SHA-256";break;case"1.2.840.10045.4.3.3":case"1.2.840.113549.1.1.12":t="SHA-384";break;case"1.2.840.10045.4.3.4":case"1.2.840.113549.1.1.13":t="SHA-512";break;case"1.2.840.113549.1.1.10":try{const r=new Ui({schema:e.algorithmParams});if("hashAlgorithm"in r){const e=this.getAlgorithmByOID(r.hashAlgorithm.algorithmId);if("name"in e==!1)return"";t=e.name}else t="SHA-1"}catch(e){}}return t}encryptEncryptedContentInfo(e){if(e instanceof Object==!1)return Promise.reject('Parameters must have type "Object"');if("password"in e==!1)return Promise.reject('Absent mandatory parameter "password"');if("contentEncryptionAlgorithm"in e==!1)return Promise.reject('Absent mandatory parameter "contentEncryptionAlgorithm"');if("hmacHashAlgorithm"in e==!1)return Promise.reject('Absent mandatory parameter "hmacHashAlgorithm"');if("iterationCount"in e==!1)return Promise.reject('Absent mandatory parameter "iterationCount"');if("contentToEncrypt"in e==!1)return Promise.reject('Absent mandatory parameter "contentToEncrypt"');if("contentType"in e==!1)return Promise.reject('Absent mandatory parameter "contentType"');const t=this.getOIDByAlgorithm(e.contentEncryptionAlgorithm);if(""===t)return Promise.reject('Wrong "contentEncryptionAlgorithm" value');const r=this.getOIDByAlgorithm({name:"PBKDF2"});if(""===r)return Promise.reject("Can not find OID for PBKDF2");const n=this.getOIDByAlgorithm({name:"HMAC",hash:{name:e.hmacHashAlgorithm}});if(""===n)return Promise.reject(`Incorrect value for "hmacHashAlgorithm": ${e.hmacHashAlgorithm}`);let i=Promise.resolve();const o=new ArrayBuffer(16),s=new Uint8Array(o);this.getRandomValues(s);const a=new ArrayBuffer(64),c=new Uint8Array(a);this.getRandomValues(c);const u=new Uint8Array(e.contentToEncrypt),l=new Bi({salt:new Pn({valueHex:a}),iterationCount:e.iterationCount,prf:new Ai({algorithmId:n,algorithmParams:new Rn})});return i=i.then((()=>{const t=new Uint8Array(e.password);return this.importKey("raw",t,"PBKDF2",!1,["deriveKey"])}),(e=>Promise.reject(e))),i=i.then((t=>this.deriveKey({name:"PBKDF2",hash:{name:e.hmacHashAlgorithm},salt:c,iterations:e.iterationCount},t,e.contentEncryptionAlgorithm,!1,["encrypt"])),(e=>Promise.reject(e))),i=i.then((t=>this.encrypt({name:e.contentEncryptionAlgorithm.name,iv:s},t,u)),(e=>Promise.reject(e))),i=i.then((n=>{const i=new Fi({keyDerivationFunc:new Ai({algorithmId:r,algorithmParams:l.toSchema()}),encryptionScheme:new Ai({algorithmId:t,algorithmParams:new Pn({valueHex:o})})});return new Mi({contentType:e.contentType,contentEncryptionAlgorithm:new Ai({algorithmId:"1.2.840.113549.1.5.13",algorithmParams:i.toSchema()}),encryptedContent:new Pn({valueHex:n})})}),(e=>Promise.reject(e))),i}decryptEncryptedContentInfo(e){if(e instanceof Object==!1)return Promise.reject('Parameters must have type "Object"');if("password"in e==!1)return Promise.reject('Absent mandatory parameter "password"');if("encryptedContentInfo"in e==!1)return Promise.reject('Absent mandatory parameter "encryptedContentInfo"');if("1.2.840.113549.1.5.13"!==e.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId)return Promise.reject(`Unknown "contentEncryptionAlgorithm": ${e.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId}`);let t,r,n=Promise.resolve();try{t=new Fi({schema:e.encryptedContentInfo.contentEncryptionAlgorithm.algorithmParams})}catch(e){return Promise.reject('Incorrectly encoded "pbes2Parameters"')}try{r=new Bi({schema:t.keyDerivationFunc.algorithmParams})}catch(e){return Promise.reject('Incorrectly encoded "pbkdf2Params"')}const i=this.getAlgorithmByOID(t.encryptionScheme.algorithmId);if("name"in i==!1)return Promise.reject(`Incorrect OID for "contentEncryptionAlgorithm": ${t.encryptionScheme.algorithmId}`);const o=t.encryptionScheme.algorithmParams.valueBlock.valueHex,s=new Uint8Array(o),a=r.salt.valueBlock.valueHex,c=new Uint8Array(a),u=r.iterationCount;let l="SHA-1";if("prf"in r){const e=this.getAlgorithmByOID(r.prf.algorithmId);if("name"in e==!1)return Promise.reject("Incorrect OID for HMAC hash algorithm");l=e.hash.name}return n=n.then((()=>this.importKey("raw",e.password,"PBKDF2",!1,["deriveKey"])),(e=>Promise.reject(e))),n=n.then((e=>this.deriveKey({name:"PBKDF2",hash:{name:l},salt:c,iterations:u},e,i,!1,["decrypt"])),(e=>Promise.reject(e))),n=n.then((t=>{let r=new ArrayBuffer(0);if(!1===e.encryptedContentInfo.encryptedContent.idBlock.isConstructed)r=e.encryptedContentInfo.encryptedContent.valueBlock.valueHex;else for(const t of e.encryptedContentInfo.encryptedContent.valueBlock.value)r=xe(r,t.valueBlock.valueHex);return this.decrypt({name:i.name,iv:s},t,r)}),(e=>Promise.reject(e))),n}stampDataWithPassword(e){if(e instanceof Object==!1)return Promise.reject('Parameters must have type "Object"');if("password"in e==!1)return Promise.reject('Absent mandatory parameter "password"');if("hashAlgorithm"in e==!1)return Promise.reject('Absent mandatory parameter "hashAlgorithm"');if("salt"in e==!1)return Promise.reject('Absent mandatory parameter "iterationCount"');if("iterationCount"in e==!1)return Promise.reject('Absent mandatory parameter "salt"');if("contentToStamp"in e==!1)return Promise.reject('Absent mandatory parameter "contentToStamp"');let t;switch(e.hashAlgorithm.toLowerCase()){case"sha-1":t=160;break;case"sha-256":t=256;break;case"sha-384":t=384;break;case"sha-512":t=512;break;default:return Promise.reject(`Incorrect "parameters.hashAlgorithm" parameter: ${e.hashAlgorithm}`)}let r=Promise.resolve();const n={name:"HMAC",length:t,hash:{name:e.hashAlgorithm}};return r=r.then((()=>ji(this,e.hashAlgorithm,t,e.password,e.salt,e.iterationCount))),r=r.then((e=>this.importKey("raw",new Uint8Array(e),n,!1,["sign"]))),r=r.then((t=>this.sign(n,t,new Uint8Array(e.contentToStamp))),(e=>Promise.reject(e))),r}verifyDataStampedWithPassword(e){if(e instanceof Object==!1)return Promise.reject('Parameters must have type "Object"');if("password"in e==!1)return Promise.reject('Absent mandatory parameter "password"');if("hashAlgorithm"in e==!1)return Promise.reject('Absent mandatory parameter "hashAlgorithm"');if("salt"in e==!1)return Promise.reject('Absent mandatory parameter "iterationCount"');if("iterationCount"in e==!1)return Promise.reject('Absent mandatory parameter "salt"');if("contentToVerify"in e==!1)return Promise.reject('Absent mandatory parameter "contentToVerify"');if("signatureToVerify"in e==!1)return Promise.reject('Absent mandatory parameter "signatureToVerify"');let t;switch(e.hashAlgorithm.toLowerCase()){case"sha-1":t=160;break;case"sha-256":t=256;break;case"sha-384":t=384;break;case"sha-512":t=512;break;default:return Promise.reject(`Incorrect "parameters.hashAlgorithm" parameter: ${e.hashAlgorithm}`)}let r=Promise.resolve();const n={name:"HMAC",length:t,hash:{name:e.hashAlgorithm}};return r=r.then((()=>ji(this,e.hashAlgorithm,t,e.password,e.salt,e.iterationCount))),r=r.then((e=>this.importKey("raw",new Uint8Array(e),n,!1,["verify"]))),r=r.then((t=>this.verify(n,t,new Uint8Array(e.signatureToVerify),new Uint8Array(e.contentToVerify))),(e=>Promise.reject(e))),r}getSignatureParameters(e,t="SHA-1"){if(""===this.getOIDByAlgorithm({name:t}))return Promise.reject(`Unsupported hash algorithm: ${t}`);const r=new Ai,n=this.getAlgorithmParameters(e.algorithm.name,"sign");switch(n.algorithm.hash.name=t,e.algorithm.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":case"ECDSA":r.algorithmId=this.getOIDByAlgorithm(n.algorithm);break;case"RSA-PSS":{switch(t.toUpperCase()){case"SHA-256":n.algorithm.saltLength=32;break;case"SHA-384":n.algorithm.saltLength=48;break;case"SHA-512":n.algorithm.saltLength=64}const e={};if("SHA-1"!==t.toUpperCase()){const r=this.getOIDByAlgorithm({name:t});if(""===r)return Promise.reject(`Unsupported hash algorithm: ${t}`);e.hashAlgorithm=new Ai({algorithmId:r,algorithmParams:new Rn}),e.maskGenAlgorithm=new Ai({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:e.hashAlgorithm.toSchema()})}20!==n.algorithm.saltLength&&(e.saltLength=n.algorithm.saltLength);const i=new Ui(e);r.algorithmId="1.2.840.113549.1.1.10",r.algorithmParams=i.toSchema()}break;default:return Promise.reject(`Unsupported signature algorithm: ${e.algorithm.name}`)}return Promise.resolve().then((()=>({signatureAlgorithm:r,parameters:n})))}signWithPrivateKey(e,t,r){return this.sign(r.algorithm,t,new Uint8Array(e)).then((e=>("ECDSA"===r.algorithm.name&&(e=function(e){if(e.byteLength%2!=0)return new ArrayBuffer(0);const t=e.byteLength/2,r=new ArrayBuffer(t);new Uint8Array(r).set(new Uint8Array(e,0,t));const n=new jn({valueHex:r}),i=new ArrayBuffer(t);new Uint8Array(i).set(new Uint8Array(e,t,t));const o=new jn({valueHex:i});return new Kn({value:[n.convertToDER(),o.convertToDER()]}).toBER(!1)}(e)),e)),(e=>Promise.reject(`Signing error: ${e}`)))}fillPublicKeyParameters(e,t){const r={},n=this.getHashAlgorithm(t);if(""===n)return Promise.reject(`Unsupported signature algorithm: ${t.algorithmId}`);let i;i="1.2.840.113549.1.1.10"===t.algorithmId?t.algorithmId:e.algorithm.algorithmId;const o=this.getAlgorithmByOID(i);if("name"in o==="")return Promise.reject(`Unsupported public key algorithm: ${t.algorithmId}`);if(r.algorithm=this.getAlgorithmParameters(o.name,"importkey"),"hash"in r.algorithm.algorithm&&(r.algorithm.algorithm.hash.name=n),"ECDSA"===o.name){let t=!1;if("algorithmParams"in e.algorithm==!0&&"idBlock"in e.algorithm.algorithmParams&&1===e.algorithm.algorithmParams.idBlock.tagClass&&6===e.algorithm.algorithmParams.idBlock.tagNumber&&(t=!0),!1===t)return Promise.reject("Incorrect type for ECDSA public key parameters");const n=this.getAlgorithmByOID(e.algorithm.algorithmParams.valueBlock.toString());if("name"in n==!1)return Promise.reject(`Unsupported named curve algorithm: ${e.algorithm.algorithmParams.valueBlock.toString()}`);r.algorithm.algorithm.namedCurve=n.name}return r}getPublicKey(e,t,r=null){null===r&&(r=this.fillPublicKeyParameters(e,t));const n=e.toSchema().toBER(!1),i=new Uint8Array(n);return this.importKey("spki",i,r.algorithm.algorithm,!0,r.algorithm.usages)}verifyWithPublicKey(e,t,r,n,i=null){let o=Promise.resolve();if(null===i){if(""===(i=this.getHashAlgorithm(n)))return Promise.reject(`Unsupported signature algorithm: ${n.algorithmId}`);o=o.then((()=>this.getPublicKey(r,n)))}else{const e={};let t;t="1.2.840.113549.1.1.10"===n.algorithmId?n.algorithmId:r.algorithm.algorithmId;const s=this.getAlgorithmByOID(t);if("name"in s==="")return Promise.reject(`Unsupported public key algorithm: ${n.algorithmId}`);if(e.algorithm=this.getAlgorithmParameters(s.name,"importkey"),"hash"in e.algorithm.algorithm&&(e.algorithm.algorithm.hash.name=i),"ECDSA"===s.name){let t=!1;if("algorithmParams"in r.algorithm==!0&&"idBlock"in r.algorithm.algorithmParams&&1===r.algorithm.algorithmParams.idBlock.tagClass&&6===r.algorithm.algorithmParams.idBlock.tagNumber&&(t=!0),!1===t)return Promise.reject("Incorrect type for ECDSA public key parameters");const n=this.getAlgorithmByOID(r.algorithm.algorithmParams.valueBlock.toString());if("name"in n==!1)return Promise.reject(`Unsupported named curve algorithm: ${r.algorithm.algorithmParams.valueBlock.toString()}`);e.algorithm.algorithm.namedCurve=n.name}o=o.then((()=>this.getPublicKey(r,null,e)))}return o=o.then((r=>{const o=this.getAlgorithmParameters(r.algorithm.name,"verify");"hash"in o.algorithm&&(o.algorithm.hash.name=i);let s=t.valueBlock.valueHex;if("ECDSA"===r.algorithm.name){s=function(e){if(e instanceof Kn==!1)return new ArrayBuffer(0);if(2!==e.valueBlock.value.length)return new ArrayBuffer(0);if(e.valueBlock.value[0]instanceof jn==!1)return new ArrayBuffer(0);if(e.valueBlock.value[1]instanceof jn==!1)return new ArrayBuffer(0);const t=e.valueBlock.value[0].convertFromDER(),r=e.valueBlock.value[1].convertFromDER();switch(!0){case t.valueBlock.valueHex.byteLength<r.valueBlock.valueHex.byteLength:{if(r.valueBlock.valueHex.byteLength-t.valueBlock.valueHex.byteLength!=1)throw new Error("Incorrect DER integer decoding");const e=r.valueBlock.valueHex.byteLength,n=new Uint8Array(t.valueBlock.valueHex),i=new ArrayBuffer(e),o=new Uint8Array(i);return o.set(n,1),o[0]=0,xe(i,r.valueBlock.valueHex)}case t.valueBlock.valueHex.byteLength>r.valueBlock.valueHex.byteLength:{if(t.valueBlock.valueHex.byteLength-r.valueBlock.valueHex.byteLength!=1)throw new Error("Incorrect DER integer decoding");const e=t.valueBlock.valueHex.byteLength,n=new Uint8Array(r.valueBlock.valueHex),i=new ArrayBuffer(e),o=new Uint8Array(i);return o.set(n,1),o[0]=0,xe(t.valueBlock.valueHex,i)}default:if(t.valueBlock.valueHex.byteLength%2){const e=t.valueBlock.valueHex.byteLength+1,n=new Uint8Array(t.valueBlock.valueHex),i=new ArrayBuffer(e),o=new Uint8Array(i);o.set(n,1),o[0]=0;const s=new Uint8Array(r.valueBlock.valueHex),a=new ArrayBuffer(e),c=new Uint8Array(a);return c.set(s,1),c[0]=0,xe(i,a)}}return xe(t.valueBlock.valueHex,r.valueBlock.valueHex)}(Tn(s).result)}if("RSA-PSS"===r.algorithm.name){let e;try{e=new Ui({schema:n.algorithmParams})}catch(e){return Promise.reject(e)}o.algorithm.saltLength="saltLength"in e?e.saltLength:20;let t="SHA-1";if("hashAlgorithm"in e){const r=this.getAlgorithmByOID(e.hashAlgorithm.algorithmId);if("name"in r==!1)return Promise.reject(`Unrecognized hash algorithm: ${e.hashAlgorithm.algorithmId}`);t=r.name}o.algorithm.hash.name=t}return this.verify(o.algorithm,r,new Uint8Array(s),new Uint8Array(e))})),o}}var Hi=r(34155);let Gi={name:"none",crypto:null,subtle:null};function qi(e,t,n){if(void 0!==Hi&&"pid"in Hi&&void 0!==r.g&&"undefined"==typeof window){if(void 0===r.g[Hi.pid])r.g[Hi.pid]={};else if("object"!=typeof r.g[Hi.pid])throw new Error(`Name global.${Hi.pid} already exists and it is not an object`);if(void 0===r.g[Hi.pid].pkijs)r.g[Hi.pid].pkijs={};else if("object"!=typeof r.g[Hi.pid].pkijs)throw new Error(`Name global.${Hi.pid}.pkijs already exists and it is not an object`);r.g[Hi.pid].pkijs.engine={name:e,crypto:t,subtle:n}}else Gi.name!==e&&(Gi={name:e,crypto:t,subtle:n})}function $i(){if(void 0!==Hi&&"pid"in Hi&&void 0!==r.g&&"undefined"==typeof window){let e;try{e=r.g[Hi.pid].pkijs.engine}catch(e){throw new Error('Please call "setEngine" before call to "getEngine"')}return e}return Gi}function Zi(){const e=$i();if(null!==e.subtle)return e.subtle}function zi(e){return $i().subtle.getOIDByAlgorithm(e)}function Ki(e){let t=!1,r="";const n=e.trim();for(let e=0;e<n.length;e++)32===n.charCodeAt(e)?!1===t&&(t=!0):(t&&(r+=" ",t=!1),r+=n[e]);return r.toLowerCase()}function Wi(e){return $i().subtle.getAlgorithmByOID(e)}!function(){if("undefined"!=typeof self&&"crypto"in self){let e="webcrypto";const t=self.crypto;let r;if("webkitSubtle"in self.crypto){try{r=self.crypto.webkitSubtle}catch(e){r=self.crypto.subtle}e="safari"}"subtle"in self.crypto&&(r=self.crypto.subtle),Gi=void 0===r?{name:e,crypto:t,subtle:null}:{name:e,crypto:t,subtle:new Vi({name:e,crypto:self.crypto,subtle:r})}}qi(Gi.name,Gi.crypto,Gi.subtle)}();class Ji{constructor(e={}){this.type=Ee(e,"type",Ji.defaultValues("type")),this.value=Ee(e,"value",Ji.defaultValues("value")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"type":return"";case"value":return{};default:throw new Error(`Invalid member name for AttributeTypeAndValue class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new qn({name:t.type||""}),new wi({name:t.value||""})]})}static blockName(){return"AttributeTypeAndValue"}fromSchema(e){Fe(e,["type","typeValue"]);const t=xi(e,e,Ji.schema({names:{type:"type",value:"typeValue"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for AttributeTypeAndValue");this.type=t.result.type.valueBlock.toString(),this.value=t.result.typeValue}toSchema(){return new Kn({value:[new qn({value:this.type}),this.value]})}toJSON(){const e={type:this.type};return 0!==Object.keys(this.value).length?e.value=this.value.toJSON():e.value=this.value,e}isEqual(e){const t=[ei.blockName(),ri.blockName(),ii.blockName(),oi.blockName(),si.blockName(),ai.blockName(),ci.blockName(),ui.blockName(),li.blockName(),di.blockName(),hi.blockName(),fi.blockName()];if(e.constructor.blockName()===Ji.blockName()){if(this.type!==e.type)return!1;let r=[!1,!1];const n=this.value.constructor.blockName();for(const i of t)n===i&&(r[0]=!0),e.value.constructor.blockName()===i&&(r[1]=!0);if(r[0]^r[1])return!1;if(r=r[0]&&r[1],r){const t=Ki(this.value.valueBlock.value),r=Ki(e.value.valueBlock.value);if(0!==t.localeCompare(r))return!1}else if(!1===Re(this.value.valueBeforeDecode,e.value.valueBeforeDecode))return!1;return!0}return e instanceof ArrayBuffer&&Re(this.value.valueBeforeDecode,e)}}class Yi{constructor(e={}){this.typesAndValues=Ee(e,"typesAndValues",Yi.defaultValues("typesAndValues")),this.valueBeforeDecode=Ee(e,"valueBeforeDecode",Yi.defaultValues("valueBeforeDecode")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"typesAndValues":return[];case"valueBeforeDecode":return new ArrayBuffer(0);default:throw new Error(`Invalid member name for RelativeDistinguishedNames class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"typesAndValues":return 0===t.length;case"valueBeforeDecode":return 0===t.byteLength;default:throw new Error(`Invalid member name for RelativeDistinguishedNames class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new _i({name:t.repeatedSequence||"",value:new Wn({value:[new _i({name:t.repeatedSet||"",value:Ji.schema(t.typeAndValue||{})})]})})]})}fromSchema(e){Fe(e,["RDN","typesAndValues"]);const t=xi(e,e,Yi.schema({names:{blockName:"RDN",repeatedSet:"typesAndValues"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for RelativeDistinguishedNames");"typesAndValues"in t.result&&(this.typesAndValues=Array.from(t.result.typesAndValues,(e=>new Ji({schema:e})))),this.valueBeforeDecode=t.result.RDN.valueBeforeDecode}toSchema(){if(0===this.valueBeforeDecode.byteLength)return new Kn({value:[new Wn({value:Array.from(this.typesAndValues,(e=>e.toSchema()))})]});return Tn(this.valueBeforeDecode).result}toJSON(){return{typesAndValues:Array.from(this.typesAndValues,(e=>e.toJSON()))}}isEqual(e){if(e instanceof Yi){if(this.typesAndValues.length!==e.typesAndValues.length)return!1;for(const[t,r]of this.typesAndValues.entries())if(!1===r.isEqual(e.typesAndValues[t]))return!1;return!0}return e instanceof ArrayBuffer&&Re(this.valueBeforeDecode,e)}}function Qi(e={},t=!1){const r=Ee(e,"names",{});return new Kn({optional:t,value:[new An({optional:!0,idBlock:{tagClass:2,tagNumber:1},name:r.country_name||"",value:[new Si({value:[new oi,new si]})]}),new An({optional:!0,idBlock:{tagClass:2,tagNumber:2},name:r.administration_domain_name||"",value:[new Si({value:[new oi,new si]})]}),new Sn({optional:!0,idBlock:{tagClass:3,tagNumber:0},name:r.network_address||"",isHexOnly:!0}),new Sn({optional:!0,idBlock:{tagClass:3,tagNumber:1},name:r.terminal_identifier||"",isHexOnly:!0}),new An({optional:!0,idBlock:{tagClass:3,tagNumber:2},name:r.private_domain_name||"",value:[new Si({value:[new oi,new si]})]}),new Sn({optional:!0,idBlock:{tagClass:3,tagNumber:3},name:r.organization_name||"",isHexOnly:!0}),new Sn({optional:!0,name:r.numeric_user_identifier||"",idBlock:{tagClass:3,tagNumber:4},isHexOnly:!0}),new An({optional:!0,name:r.personal_name||"",idBlock:{tagClass:3,tagNumber:5},value:[new Sn({idBlock:{tagClass:3,tagNumber:0},isHexOnly:!0}),new Sn({optional:!0,idBlock:{tagClass:3,tagNumber:1},isHexOnly:!0}),new Sn({optional:!0,idBlock:{tagClass:3,tagNumber:2},isHexOnly:!0}),new Sn({optional:!0,idBlock:{tagClass:3,tagNumber:3},isHexOnly:!0})]}),new An({optional:!0,name:r.organizational_unit_names||"",idBlock:{tagClass:3,tagNumber:6},value:[new _i({value:new si})]})]})}function Xi(e=!1){return new Kn({optional:e,value:[new si,new si]})}function eo(e=!1){return new Wn({optional:e,value:[new Sn({optional:!0,idBlock:{tagClass:3,tagNumber:0},isHexOnly:!0}),new An({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new wi]})]})}class to{constructor(e={}){this.type=Ee(e,"type",to.defaultValues("type")),this.value=Ee(e,"value",to.defaultValues("value")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"type":return 9;case"value":return{};default:throw new Error(`Invalid member name for GeneralName class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"type":return t===to.defaultValues(e);case"value":return 0===Object.keys(t).length;default:throw new Error(`Invalid member name for GeneralName class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Si({value:[new An({idBlock:{tagClass:3,tagNumber:0},name:t.blockName||"",value:[new qn,new An({idBlock:{tagClass:3,tagNumber:0},value:[new wi]})]}),new Sn({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:1}}),new Sn({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:2}}),new An({idBlock:{tagClass:3,tagNumber:3},name:t.blockName||"",value:[Qi(t.builtInStandardAttributes||{},!1),Xi(!0),eo(!0)]}),new An({idBlock:{tagClass:3,tagNumber:4},name:t.blockName||"",value:[Yi.schema(t.directoryName||{})]}),new An({idBlock:{tagClass:3,tagNumber:5},name:t.blockName||"",value:[new An({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Si({value:[new ai,new si,new ii,new ei,new ri]})]}),new An({idBlock:{tagClass:3,tagNumber:1},value:[new Si({value:[new ai,new si,new ii,new ei,new ri]})]})]}),new Sn({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:6}}),new Sn({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:7}}),new Sn({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:8}})]})}fromSchema(e){Fe(e,["blockName","otherName","rfc822Name","dNSName","x400Address","directoryName","ediPartyName","uniformResourceIdentifier","iPAddress","registeredID"]);const t=xi(e,e,to.schema({names:{blockName:"blockName",otherName:"otherName",rfc822Name:"rfc822Name",dNSName:"dNSName",x400Address:"x400Address",directoryName:{names:{blockName:"directoryName"}},ediPartyName:"ediPartyName",uniformResourceIdentifier:"uniformResourceIdentifier",iPAddress:"iPAddress",registeredID:"registeredID"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for GeneralName");switch(this.type=t.result.blockName.idBlock.tagNumber,this.type){case 0:case 3:this.value=t.result.blockName;break;case 1:case 2:case 6:{const e=t.result.blockName;e.idBlock.tagClass=1,e.idBlock.tagNumber=22;const r=e.toBER(!1);this.value=Tn(r).result.valueBlock.value}break;case 4:this.value=new Yi({schema:t.result.directoryName});break;case 5:this.value=t.result.ediPartyName;break;case 7:this.value=new Pn({valueHex:t.result.blockName.valueBlock.valueHex});break;case 8:{const e=t.result.blockName;e.idBlock.tagClass=1,e.idBlock.tagNumber=6;const r=e.toBER(!1);this.value=Tn(r).result.valueBlock.toString()}}}toSchema(){switch(this.type){case 0:case 3:case 5:return new An({idBlock:{tagClass:3,tagNumber:this.type},value:[this.value]});case 1:case 2:case 6:{const e=new ui({value:this.value});return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}case 4:return new An({idBlock:{tagClass:3,tagNumber:4},value:[this.value.toSchema()]});case 7:{const e=this.value;return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}case 8:{const e=new qn({value:this.value});return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}default:return to.schema()}}toJSON(){const e={type:this.type,value:""};if("string"==typeof this.value)e.value=this.value;else try{e.value=this.value.toJSON()}catch(e){}return e}}class ro{constructor(e={}){this.accessMethod=Ee(e,"accessMethod",ro.defaultValues("accessMethod")),this.accessLocation=Ee(e,"accessLocation",ro.defaultValues("accessLocation")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"accessMethod":return"";case"accessLocation":return new to;default:throw new Error(`Invalid member name for AccessDescription class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new qn({name:t.accessMethod||""}),to.schema(t.accessLocation||{})]})}fromSchema(e){Fe(e,["accessMethod","accessLocation"]);const t=xi(e,e,ro.schema({names:{accessMethod:"accessMethod",accessLocation:{names:{blockName:"accessLocation"}}}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for AccessDescription");this.accessMethod=t.result.accessMethod.valueBlock.toString(),this.accessLocation=new to({schema:t.result.accessLocation})}toSchema(){return new Kn({value:[new qn({value:this.accessMethod}),this.accessLocation.toSchema()]})}toJSON(){return{accessMethod:this.accessMethod,accessLocation:this.accessLocation.toJSON()}}}class no{constructor(e={}){"seconds"in e&&(this.seconds=Ee(e,"seconds",no.defaultValues("seconds"))),"millis"in e&&(this.millis=Ee(e,"millis",no.defaultValues("millis"))),"micros"in e&&(this.micros=Ee(e,"micros",no.defaultValues("micros"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"seconds":case"millis":case"micros":return 0;default:throw new Error(`Invalid member name for Accuracy class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"seconds":case"millis":case"micros":return t===no.defaultValues(e);default:throw new Error(`Invalid member name for Accuracy class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",optional:!0,value:[new jn({optional:!0,name:t.seconds||""}),new Sn({name:t.millis||"",optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new Sn({name:t.micros||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){Fe(e,["seconds","millis","micros"]);const t=xi(e,e,no.schema({names:{seconds:"seconds",millis:"millis",micros:"micros"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for Accuracy");if("seconds"in t.result&&(this.seconds=t.result.seconds.valueBlock.valueDec),"millis"in t.result){const e=new jn({valueHex:t.result.millis.valueBlock.valueHex});this.millis=e.valueBlock.valueDec}if("micros"in t.result){const e=new jn({valueHex:t.result.micros.valueBlock.valueHex});this.micros=e.valueBlock.valueDec}}toSchema(){const e=[];if("seconds"in this&&e.push(new jn({value:this.seconds})),"millis"in this){const t=new jn({value:this.millis});e.push(new Sn({idBlock:{tagClass:3,tagNumber:0},valueHex:t.valueBlock.valueHex}))}if("micros"in this){const t=new jn({value:this.micros});e.push(new Sn({idBlock:{tagClass:3,tagNumber:1},valueHex:t.valueBlock.valueHex}))}return new Kn({value:e})}toJSON(){const e={};return"seconds"in this&&(e.seconds=this.seconds),"millis"in this&&(e.millis=this.millis),"micros"in this&&(e.micros=this.micros),e}}class io{constructor(e={}){this.altNames=Ee(e,"altNames",io.defaultValues("altNames")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){if("altNames"===e)return[];throw new Error(`Invalid member name for AltName class: ${e}`)}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new _i({name:t.altNames||"",value:to.schema()})]})}fromSchema(e){Fe(e,["altNames"]);const t=xi(e,e,io.schema({names:{altNames:"altNames"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for AltName");"altNames"in t.result&&(this.altNames=Array.from(t.result.altNames,(e=>new to({schema:e}))))}toSchema(){return new Kn({value:Array.from(this.altNames,(e=>e.toSchema()))})}toJSON(){return{altNames:Array.from(this.altNames,(e=>e.toJSON()))}}}class oo{constructor(e={}){this.type=Ee(e,"type",oo.defaultValues("type")),this.value=Ee(e,"value",oo.defaultValues("value")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"type":return 0;case"value":return new Date(0,0,0);default:throw new Error(`Invalid member name for Time class: ${e}`)}}static schema(e={},t=!1){const r=Ee(e,"names",{});return new Si({optional:t,value:[new pi({name:r.utcTimeName||""}),new mi({name:r.generalTimeName||""})]})}fromSchema(e){Fe(e,["utcTimeName","generalTimeName"]);const t=xi(e,e,oo.schema({names:{utcTimeName:"utcTimeName",generalTimeName:"generalTimeName"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for Time");"utcTimeName"in t.result&&(this.type=0,this.value=t.result.utcTimeName.toDate()),"generalTimeName"in t.result&&(this.type=1,this.value=t.result.generalTimeName.toDate())}toSchema(){let e={};return 0===this.type&&(e=new pi({valueDate:this.value})),1===this.type&&(e=new mi({valueDate:this.value})),e}toJSON(){return{type:this.type,value:this.value}}}class so{constructor(e={}){this.attributes=Ee(e,"attributes",so.defaultValues("attributes")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){if("attributes"===e)return[];throw new Error(`Invalid member name for SubjectDirectoryAttributes class: ${e}`)}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new _i({name:t.attributes||"",value:Oi.schema()})]})}fromSchema(e){Fe(e,["attributes"]);const t=xi(e,e,so.schema({names:{attributes:"attributes"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for SubjectDirectoryAttributes");this.attributes=Array.from(t.result.attributes,(e=>new Oi({schema:e})))}toSchema(){return new Kn({value:Array.from(this.attributes,(e=>e.toSchema()))})}toJSON(){return{attributes:Array.from(this.attributes,(e=>e.toJSON()))}}}class ao{constructor(e={}){"notBefore"in e&&(this.notBefore=Ee(e,"notBefore",ao.defaultValues("notBefore"))),"notAfter"in e&&(this.notAfter=Ee(e,"notAfter",ao.defaultValues("notAfter"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"notBefore":case"notAfter":return new Date;default:throw new Error(`Invalid member name for PrivateKeyUsagePeriod class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new Sn({name:t.notBefore||"",optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new Sn({name:t.notAfter||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){Fe(e,["notBefore","notAfter"]);const t=xi(e,e,ao.schema({names:{notBefore:"notBefore",notAfter:"notAfter"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PrivateKeyUsagePeriod");if("notBefore"in t.result){const e=new mi;e.fromBuffer(t.result.notBefore.valueBlock.valueHex),this.notBefore=e.toDate()}if("notAfter"in t.result){const e=new mi({valueHex:t.result.notAfter.valueBlock.valueHex});e.fromBuffer(t.result.notAfter.valueBlock.valueHex),this.notAfter=e.toDate()}}toSchema(){const e=[];return"notBefore"in this&&e.push(new Sn({idBlock:{tagClass:3,tagNumber:0},valueHex:new mi({valueDate:this.notBefore}).valueBlock.valueHex})),"notAfter"in this&&e.push(new Sn({idBlock:{tagClass:3,tagNumber:1},valueHex:new mi({valueDate:this.notAfter}).valueBlock.valueHex})),new Kn({value:e})}toJSON(){const e={};return"notBefore"in this&&(e.notBefore=this.notBefore),"notAfter"in this&&(e.notAfter=this.notAfter),e}}class co{constructor(e={}){this.cA=Ee(e,"cA",!1),"pathLenConstraint"in e&&(this.pathLenConstraint=Ee(e,"pathLenConstraint",0)),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){if("cA"===e)return!1;throw new Error(`Invalid member name for BasicConstraints class: ${e}`)}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new On({optional:!0,name:t.cA||""}),new jn({optional:!0,name:t.pathLenConstraint||""})]})}fromSchema(e){Fe(e,["cA","pathLenConstraint"]);const t=xi(e,e,co.schema({names:{cA:"cA",pathLenConstraint:"pathLenConstraint"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for BasicConstraints");"cA"in t.result&&(this.cA=t.result.cA.valueBlock.value),"pathLenConstraint"in t.result&&(t.result.pathLenConstraint.valueBlock.isHexOnly?this.pathLenConstraint=t.result.pathLenConstraint:this.pathLenConstraint=t.result.pathLenConstraint.valueBlock.valueDec)}toSchema(){const e=[];return this.cA!==co.defaultValues("cA")&&e.push(new On({value:this.cA})),"pathLenConstraint"in this&&(this.pathLenConstraint instanceof jn?e.push(this.pathLenConstraint):e.push(new jn({value:this.pathLenConstraint}))),new Kn({value:e})}toJSON(){const e={};return this.cA!==co.defaultValues("cA")&&(e.cA=this.cA),"pathLenConstraint"in this&&(this.pathLenConstraint instanceof jn?e.pathLenConstraint=this.pathLenConstraint.toJSON():e.pathLenConstraint=this.pathLenConstraint),e}}class uo{constructor(e={}){"distributionPoint"in e&&(this.distributionPoint=Ee(e,"distributionPoint",uo.defaultValues("distributionPoint"))),this.onlyContainsUserCerts=Ee(e,"onlyContainsUserCerts",uo.defaultValues("onlyContainsUserCerts")),this.onlyContainsCACerts=Ee(e,"onlyContainsCACerts",uo.defaultValues("onlyContainsCACerts")),"onlySomeReasons"in e&&(this.onlySomeReasons=Ee(e,"onlySomeReasons",uo.defaultValues("onlySomeReasons"))),this.indirectCRL=Ee(e,"indirectCRL",uo.defaultValues("indirectCRL")),this.onlyContainsAttributeCerts=Ee(e,"onlyContainsAttributeCerts",uo.defaultValues("onlyContainsAttributeCerts")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"distributionPoint":return[];case"onlyContainsUserCerts":case"onlyContainsCACerts":case"indirectCRL":case"onlyContainsAttributeCerts":return!1;case"onlySomeReasons":return 0;default:throw new Error(`Invalid member name for IssuingDistributionPoint class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new An({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Si({value:[new An({name:t.distributionPoint||"",idBlock:{tagClass:3,tagNumber:0},value:[new _i({name:t.distributionPointNames||"",value:to.schema()})]}),new An({name:t.distributionPoint||"",idBlock:{tagClass:3,tagNumber:1},value:Yi.schema().valueBlock.value})]})]}),new Sn({name:t.onlyContainsUserCerts||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new Sn({name:t.onlyContainsCACerts||"",optional:!0,idBlock:{tagClass:3,tagNumber:2}}),new Sn({name:t.onlySomeReasons||"",optional:!0,idBlock:{tagClass:3,tagNumber:3}}),new Sn({name:t.indirectCRL||"",optional:!0,idBlock:{tagClass:3,tagNumber:4}}),new Sn({name:t.onlyContainsAttributeCerts||"",optional:!0,idBlock:{tagClass:3,tagNumber:5}})]})}fromSchema(e){Fe(e,["distributionPoint","distributionPointNames","onlyContainsUserCerts","onlyContainsCACerts","onlySomeReasons","indirectCRL","onlyContainsAttributeCerts"]);const t=xi(e,e,uo.schema({names:{distributionPoint:"distributionPoint",distributionPointNames:"distributionPointNames",onlyContainsUserCerts:"onlyContainsUserCerts",onlyContainsCACerts:"onlyContainsCACerts",onlySomeReasons:"onlySomeReasons",indirectCRL:"indirectCRL",onlyContainsAttributeCerts:"onlyContainsAttributeCerts"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for IssuingDistributionPoint");if("distributionPoint"in t.result)switch(!0){case 0===t.result.distributionPoint.idBlock.tagNumber:this.distributionPoint=Array.from(t.result.distributionPointNames,(e=>new to({schema:e})));break;case 1===t.result.distributionPoint.idBlock.tagNumber:this.distributionPoint=new Yi({schema:new Kn({value:t.result.distributionPoint.valueBlock.value})});break;default:throw new Error("Unknown tagNumber for distributionPoint: {$asn1.result.distributionPoint.idBlock.tagNumber}")}if("onlyContainsUserCerts"in t.result){const e=new Uint8Array(t.result.onlyContainsUserCerts.valueBlock.valueHex);this.onlyContainsUserCerts=0!==e[0]}if("onlyContainsCACerts"in t.result){const e=new Uint8Array(t.result.onlyContainsCACerts.valueBlock.valueHex);this.onlyContainsCACerts=0!==e[0]}if("onlySomeReasons"in t.result){const e=new Uint8Array(t.result.onlySomeReasons.valueBlock.valueHex);this.onlySomeReasons=e[0]}if("indirectCRL"in t.result){const e=new Uint8Array(t.result.indirectCRL.valueBlock.valueHex);this.indirectCRL=0!==e[0]}if("onlyContainsAttributeCerts"in t.result){const e=new Uint8Array(t.result.onlyContainsAttributeCerts.valueBlock.valueHex);this.onlyContainsAttributeCerts=0!==e[0]}}toSchema(){const e=[];if("distributionPoint"in this){let t;this.distributionPoint instanceof Array?t=new An({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,(e=>e.toSchema()))}):(t=this.distributionPoint.toSchema(),t.idBlock.tagClass=3,t.idBlock.tagNumber=1),e.push(new An({idBlock:{tagClass:3,tagNumber:0},value:[t]}))}if(this.onlyContainsUserCerts!==uo.defaultValues("onlyContainsUserCerts")&&e.push(new Sn({idBlock:{tagClass:3,tagNumber:1},valueHex:new Uint8Array([255]).buffer})),this.onlyContainsCACerts!==uo.defaultValues("onlyContainsCACerts")&&e.push(new Sn({idBlock:{tagClass:3,tagNumber:2},valueHex:new Uint8Array([255]).buffer})),"onlySomeReasons"in this){const t=new ArrayBuffer(1);new Uint8Array(t)[0]=this.onlySomeReasons,e.push(new Sn({idBlock:{tagClass:3,tagNumber:3},valueHex:t}))}return this.indirectCRL!==uo.defaultValues("indirectCRL")&&e.push(new Sn({idBlock:{tagClass:3,tagNumber:4},valueHex:new Uint8Array([255]).buffer})),this.onlyContainsAttributeCerts!==uo.defaultValues("onlyContainsAttributeCerts")&&e.push(new Sn({idBlock:{tagClass:3,tagNumber:5},valueHex:new Uint8Array([255]).buffer})),new Kn({value:e})}toJSON(){const e={};return"distributionPoint"in this&&(this.distributionPoint instanceof Array?e.distributionPoint=Array.from(this.distributionPoint,(e=>e.toJSON())):e.distributionPoint=this.distributionPoint.toJSON()),this.onlyContainsUserCerts!==uo.defaultValues("onlyContainsUserCerts")&&(e.onlyContainsUserCerts=this.onlyContainsUserCerts),this.onlyContainsCACerts!==uo.defaultValues("onlyContainsCACerts")&&(e.onlyContainsCACerts=this.onlyContainsCACerts),"onlySomeReasons"in this&&(e.onlySomeReasons=this.onlySomeReasons),this.indirectCRL!==uo.defaultValues("indirectCRL")&&(e.indirectCRL=this.indirectCRL),this.onlyContainsAttributeCerts!==uo.defaultValues("onlyContainsAttributeCerts")&&(e.onlyContainsAttributeCerts=this.onlyContainsAttributeCerts),e}}class lo{constructor(e={}){this.names=Ee(e,"names",lo.defaultValues("names")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){if("names"===e)return[];throw new Error(`Invalid member name for GeneralNames class: ${e}`)}static schema(e={},t=!1){const r=Ee(e,"names",{});return new Kn({optional:t,name:r.blockName||"",value:[new _i({name:r.generalNames||"",value:to.schema()})]})}fromSchema(e){Fe(e,["names","generalNames"]);const t=xi(e,e,lo.schema({names:{blockName:"names",generalNames:"generalNames"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for GeneralNames");this.names=Array.from(t.result.generalNames,(e=>new to({schema:e})))}toSchema(){return new Kn({value:Array.from(this.names,(e=>e.toSchema()))})}toJSON(){return{names:Array.from(this.names,(e=>e.toJSON()))}}}class ho{constructor(e={}){this.base=Ee(e,"base",ho.defaultValues("base")),this.minimum=Ee(e,"minimum",ho.defaultValues("minimum")),"maximum"in e&&(this.maximum=Ee(e,"maximum",ho.defaultValues("maximum"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"base":return new to;case"minimum":case"maximum":return 0;default:throw new Error(`Invalid member name for GeneralSubtree class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[to.schema(t.base||{}),new An({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new jn({name:t.minimum||""})]}),new An({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new jn({name:t.maximum||""})]})]})}fromSchema(e){Fe(e,["base","minimum","maximum"]);const t=xi(e,e,ho.schema({names:{base:{names:{blockName:"base"}},minimum:"minimum",maximum:"maximum"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for GeneralSubtree");this.base=new to({schema:t.result.base}),"minimum"in t.result&&(t.result.minimum.valueBlock.isHexOnly?this.minimum=t.result.minimum:this.minimum=t.result.minimum.valueBlock.valueDec),"maximum"in t.result&&(t.result.maximum.valueBlock.isHexOnly?this.maximum=t.result.maximum:this.maximum=t.result.maximum.valueBlock.valueDec)}toSchema(){const e=[];if(e.push(this.base.toSchema()),0!==this.minimum){let t=0;t=this.minimum instanceof jn?this.minimum:new jn({value:this.minimum}),e.push(new An({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[t]}))}if("maximum"in this){let t=0;t=this.maximum instanceof jn?this.maximum:new jn({value:this.maximum}),e.push(new An({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[t]}))}return new Kn({value:e})}toJSON(){const e={base:this.base.toJSON()};return 0!==this.minimum&&("number"==typeof this.minimum?e.minimum=this.minimum:e.minimum=this.minimum.toJSON()),"maximum"in this&&("number"==typeof this.maximum?e.maximum=this.maximum:e.maximum=this.maximum.toJSON()),e}}class fo{constructor(e={}){"permittedSubtrees"in e&&(this.permittedSubtrees=Ee(e,"permittedSubtrees",fo.defaultValues("permittedSubtrees"))),"excludedSubtrees"in e&&(this.excludedSubtrees=Ee(e,"excludedSubtrees",fo.defaultValues("excludedSubtrees"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"permittedSubtrees":case"excludedSubtrees":return[];default:throw new Error(`Invalid member name for NameConstraints class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new An({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new _i({name:t.permittedSubtrees||"",value:ho.schema()})]}),new An({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new _i({name:t.excludedSubtrees||"",value:ho.schema()})]})]})}fromSchema(e){Fe(e,["permittedSubtrees","excludedSubtrees"]);const t=xi(e,e,fo.schema({names:{permittedSubtrees:"permittedSubtrees",excludedSubtrees:"excludedSubtrees"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for NameConstraints");"permittedSubtrees"in t.result&&(this.permittedSubtrees=Array.from(t.result.permittedSubtrees,(e=>new ho({schema:e})))),"excludedSubtrees"in t.result&&(this.excludedSubtrees=Array.from(t.result.excludedSubtrees,(e=>new ho({schema:e}))))}toSchema(){const e=[];return"permittedSubtrees"in this&&e.push(new An({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.permittedSubtrees,(e=>e.toSchema()))})),"excludedSubtrees"in this&&e.push(new An({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.excludedSubtrees,(e=>e.toSchema()))})),new Kn({value:e})}toJSON(){const e={};return"permittedSubtrees"in this&&(e.permittedSubtrees=Array.from(this.permittedSubtrees,(e=>e.toJSON()))),"excludedSubtrees"in this&&(e.excludedSubtrees=Array.from(this.excludedSubtrees,(e=>e.toJSON()))),e}}class po{constructor(e={}){"distributionPoint"in e&&(this.distributionPoint=Ee(e,"distributionPoint",po.defaultValues("distributionPoint"))),"reasons"in e&&(this.reasons=Ee(e,"reasons",po.defaultValues("reasons"))),"cRLIssuer"in e&&(this.cRLIssuer=Ee(e,"cRLIssuer",po.defaultValues("cRLIssuer"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"distributionPoint":case"cRLIssuer":return[];case"reasons":return new Dn;default:throw new Error(`Invalid member name for DistributionPoint class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new An({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Si({value:[new An({name:t.distributionPoint||"",optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new _i({name:t.distributionPointNames||"",value:to.schema()})]}),new An({name:t.distributionPoint||"",optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Yi.schema().valueBlock.value})]})]}),new Sn({name:t.reasons||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new An({name:t.cRLIssuer||"",optional:!0,idBlock:{tagClass:3,tagNumber:2},value:[new _i({name:t.cRLIssuerNames||"",value:to.schema()})]})]})}fromSchema(e){Fe(e,["distributionPoint","distributionPointNames","reasons","cRLIssuer","cRLIssuerNames"]);const t=xi(e,e,po.schema({names:{distributionPoint:"distributionPoint",distributionPointNames:"distributionPointNames",reasons:"reasons",cRLIssuer:"cRLIssuer",cRLIssuerNames:"cRLIssuerNames"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for DistributionPoint");"distributionPoint"in t.result&&(0===t.result.distributionPoint.idBlock.tagNumber&&(this.distributionPoint=Array.from(t.result.distributionPointNames,(e=>new to({schema:e})))),1===t.result.distributionPoint.idBlock.tagNumber&&(this.distributionPoint=new Yi({schema:new Kn({value:t.result.distributionPoint.valueBlock.value})}))),"reasons"in t.result&&(this.reasons=new Dn({valueHex:t.result.reasons.valueBlock.valueHex})),"cRLIssuer"in t.result&&(this.cRLIssuer=Array.from(t.result.cRLIssuerNames,(e=>new to({schema:e}))))}toSchema(){const e=[];if("distributionPoint"in this){let t;t=this.distributionPoint instanceof Array?new An({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,(e=>e.toSchema()))}):new An({idBlock:{tagClass:3,tagNumber:1},value:[this.distributionPoint.toSchema()]}),e.push(new An({idBlock:{tagClass:3,tagNumber:0},value:[t]}))}return"reasons"in this&&e.push(new Sn({idBlock:{tagClass:3,tagNumber:1},valueHex:this.reasons.valueBlock.valueHex})),"cRLIssuer"in this&&e.push(new An({idBlock:{tagClass:3,tagNumber:2},value:Array.from(this.cRLIssuer,(e=>e.toSchema()))})),new Kn({value:e})}toJSON(){const e={};return"distributionPoint"in this&&(this.distributionPoint instanceof Array?e.distributionPoint=Array.from(this.distributionPoint,(e=>e.toJSON())):e.distributionPoint=this.distributionPoint.toJSON()),"reasons"in this&&(e.reasons=this.reasons.toJSON()),"cRLIssuer"in this&&(e.cRLIssuer=Array.from(this.cRLIssuer,(e=>e.toJSON()))),e}}class mo{constructor(e={}){this.distributionPoints=Ee(e,"distributionPoints",mo.defaultValues("distributionPoints")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){if("distributionPoints"===e)return[];throw new Error(`Invalid member name for CRLDistributionPoints class: ${e}`)}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new _i({name:t.distributionPoints||"",value:po.schema()})]})}fromSchema(e){Fe(e,["distributionPoints"]);const t=xi(e,e,mo.schema({names:{distributionPoints:"distributionPoints"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for CRLDistributionPoints");this.distributionPoints=Array.from(t.result.distributionPoints,(e=>new po({schema:e})))}toSchema(){return new Kn({value:Array.from(this.distributionPoints,(e=>e.toSchema()))})}toJSON(){return{distributionPoints:Array.from(this.distributionPoints,(e=>e.toJSON()))}}}class go{constructor(e={}){this.policyQualifierId=Ee(e,"policyQualifierId",go.defaultValues("policyQualifierId")),this.qualifier=Ee(e,"qualifier",go.defaultValues("qualifier")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"policyQualifierId":return"";case"qualifier":return new wi;default:throw new Error(`Invalid member name for PolicyQualifierInfo class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new qn({name:t.policyQualifierId||""}),new wi({name:t.qualifier||""})]})}fromSchema(e){Fe(e,["policyQualifierId","qualifier"]);const t=xi(e,e,go.schema({names:{policyQualifierId:"policyQualifierId",qualifier:"qualifier"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PolicyQualifierInfo");this.policyQualifierId=t.result.policyQualifierId.valueBlock.toString(),this.qualifier=t.result.qualifier}toSchema(){return new Kn({value:[new qn({value:this.policyQualifierId}),this.qualifier]})}toJSON(){return{policyQualifierId:this.policyQualifierId,qualifier:this.qualifier.toJSON()}}}class vo{constructor(e={}){this.policyIdentifier=Ee(e,"policyIdentifier",vo.defaultValues("policyIdentifier")),"policyQualifiers"in e&&(this.policyQualifiers=Ee(e,"policyQualifiers",vo.defaultValues("policyQualifiers"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"policyIdentifier":return"";case"policyQualifiers":return[];default:throw new Error(`Invalid member name for PolicyInformation class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new qn({name:t.policyIdentifier||""}),new Kn({optional:!0,value:[new _i({name:t.policyQualifiers||"",value:go.schema()})]})]})}fromSchema(e){Fe(e,["policyIdentifier","policyQualifiers"]);const t=xi(e,e,vo.schema({names:{policyIdentifier:"policyIdentifier",policyQualifiers:"policyQualifiers"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PolicyInformation");this.policyIdentifier=t.result.policyIdentifier.valueBlock.toString(),"policyQualifiers"in t.result&&(this.policyQualifiers=Array.from(t.result.policyQualifiers,(e=>new go({schema:e}))))}toSchema(){const e=[];return e.push(new qn({value:this.policyIdentifier})),"policyQualifiers"in this&&e.push(new Kn({value:Array.from(this.policyQualifiers,(e=>e.toSchema()))})),new Kn({value:e})}toJSON(){const e={policyIdentifier:this.policyIdentifier};return"policyQualifiers"in this&&(e.policyQualifiers=Array.from(this.policyQualifiers,(e=>e.toJSON()))),e}}class yo{constructor(e={}){this.certificatePolicies=Ee(e,"certificatePolicies",yo.defaultValues("certificatePolicies")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){if("certificatePolicies"===e)return[];throw new Error(`Invalid member name for CertificatePolicies class: ${e}`)}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new _i({name:t.certificatePolicies||"",value:vo.schema()})]})}fromSchema(e){Fe(e,["certificatePolicies"]);const t=xi(e,e,yo.schema({names:{certificatePolicies:"certificatePolicies"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for CertificatePolicies");this.certificatePolicies=Array.from(t.result.certificatePolicies,(e=>new vo({schema:e})))}toSchema(){return new Kn({value:Array.from(this.certificatePolicies,(e=>e.toSchema()))})}toJSON(){return{certificatePolicies:Array.from(this.certificatePolicies,(e=>e.toJSON()))}}}class bo{constructor(e={}){this.issuerDomainPolicy=Ee(e,"issuerDomainPolicy",bo.defaultValues("issuerDomainPolicy")),this.subjectDomainPolicy=Ee(e,"subjectDomainPolicy",bo.defaultValues("subjectDomainPolicy")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"issuerDomainPolicy":case"subjectDomainPolicy":return"";default:throw new Error(`Invalid member name for PolicyMapping class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new qn({name:t.issuerDomainPolicy||""}),new qn({name:t.subjectDomainPolicy||""})]})}fromSchema(e){Fe(e,["issuerDomainPolicy","subjectDomainPolicy"]);const t=xi(e,e,bo.schema({names:{issuerDomainPolicy:"issuerDomainPolicy",subjectDomainPolicy:"subjectDomainPolicy"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PolicyMapping");this.issuerDomainPolicy=t.result.issuerDomainPolicy.valueBlock.toString(),this.subjectDomainPolicy=t.result.subjectDomainPolicy.valueBlock.toString()}toSchema(){return new Kn({value:[new qn({value:this.issuerDomainPolicy}),new qn({value:this.subjectDomainPolicy})]})}toJSON(){return{issuerDomainPolicy:this.issuerDomainPolicy,subjectDomainPolicy:this.subjectDomainPolicy}}}class Eo{constructor(e={}){this.mappings=Ee(e,"mappings",Eo.defaultValues("mappings")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){if("mappings"===e)return[];throw new Error(`Invalid member name for PolicyMappings class: ${e}`)}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new _i({name:t.mappings||"",value:bo.schema()})]})}fromSchema(e){Fe(e,["mappings"]);const t=xi(e,e,Eo.schema({names:{mappings:"mappings"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PolicyMappings");this.mappings=Array.from(t.result.mappings,(e=>new bo({schema:e})))}toSchema(){return new Kn({value:Array.from(this.mappings,(e=>e.toSchema()))})}toJSON(){return{mappings:Array.from(this.mappings,(e=>e.toJSON()))}}}class wo{constructor(e={}){"keyIdentifier"in e&&(this.keyIdentifier=Ee(e,"keyIdentifier",wo.defaultValues("keyIdentifier"))),"authorityCertIssuer"in e&&(this.authorityCertIssuer=Ee(e,"authorityCertIssuer",wo.defaultValues("authorityCertIssuer"))),"authorityCertSerialNumber"in e&&(this.authorityCertSerialNumber=Ee(e,"authorityCertSerialNumber",wo.defaultValues("authorityCertSerialNumber"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"keyIdentifier":return new Pn;case"authorityCertIssuer":return[];case"authorityCertSerialNumber":return new jn;default:throw new Error(`Invalid member name for AuthorityKeyIdentifier class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new Sn({name:t.keyIdentifier||"",optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new An({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new _i({name:t.authorityCertIssuer||"",value:to.schema()})]}),new Sn({name:t.authorityCertSerialNumber||"",optional:!0,idBlock:{tagClass:3,tagNumber:2}})]})}fromSchema(e){Fe(e,["keyIdentifier","authorityCertIssuer","authorityCertSerialNumber"]);const t=xi(e,e,wo.schema({names:{keyIdentifier:"keyIdentifier",authorityCertIssuer:"authorityCertIssuer",authorityCertSerialNumber:"authorityCertSerialNumber"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for AuthorityKeyIdentifier");"keyIdentifier"in t.result&&(this.keyIdentifier=new Pn({valueHex:t.result.keyIdentifier.valueBlock.valueHex})),"authorityCertIssuer"in t.result&&(this.authorityCertIssuer=Array.from(t.result.authorityCertIssuer,(e=>new to({schema:e})))),"authorityCertSerialNumber"in t.result&&(this.authorityCertSerialNumber=new jn({valueHex:t.result.authorityCertSerialNumber.valueBlock.valueHex}))}toSchema(){const e=[];return"keyIdentifier"in this&&e.push(new Sn({idBlock:{tagClass:3,tagNumber:0},valueHex:this.keyIdentifier.valueBlock.valueHex})),"authorityCertIssuer"in this&&e.push(new An({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.authorityCertIssuer,(e=>e.toSchema()))})),"authorityCertSerialNumber"in this&&e.push(new Sn({idBlock:{tagClass:3,tagNumber:2},valueHex:this.authorityCertSerialNumber.valueBlock.valueHex})),new Kn({value:e})}toJSON(){const e={};return"keyIdentifier"in this&&(e.keyIdentifier=this.keyIdentifier.toJSON()),"authorityCertIssuer"in this&&(e.authorityCertIssuer=Array.from(this.authorityCertIssuer,(e=>e.toJSON()))),"authorityCertSerialNumber"in this&&(e.authorityCertSerialNumber=this.authorityCertSerialNumber.toJSON()),e}}class So{constructor(e={}){"requireExplicitPolicy"in e&&(this.requireExplicitPolicy=Ee(e,"requireExplicitPolicy",So.defaultValues("requireExplicitPolicy"))),"inhibitPolicyMapping"in e&&(this.inhibitPolicyMapping=Ee(e,"inhibitPolicyMapping",So.defaultValues("inhibitPolicyMapping"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"requireExplicitPolicy":case"inhibitPolicyMapping":return 0;default:throw new Error(`Invalid member name for PolicyConstraints class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new Sn({name:t.requireExplicitPolicy||"",optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new Sn({name:t.inhibitPolicyMapping||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){Fe(e,["requireExplicitPolicy","inhibitPolicyMapping"]);const t=xi(e,e,So.schema({names:{requireExplicitPolicy:"requireExplicitPolicy",inhibitPolicyMapping:"inhibitPolicyMapping"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PolicyConstraints");if("requireExplicitPolicy"in t.result){const e=t.result.requireExplicitPolicy;e.idBlock.tagClass=1,e.idBlock.tagNumber=2;const r=Tn(e.toBER(!1));this.requireExplicitPolicy=r.result.valueBlock.valueDec}if("inhibitPolicyMapping"in t.result){const e=t.result.inhibitPolicyMapping;e.idBlock.tagClass=1,e.idBlock.tagNumber=2;const r=Tn(e.toBER(!1));this.inhibitPolicyMapping=r.result.valueBlock.valueDec}}toSchema(){const e=[];if("requireExplicitPolicy"in this){const t=new jn({value:this.requireExplicitPolicy});t.idBlock.tagClass=3,t.idBlock.tagNumber=0,e.push(t)}if("inhibitPolicyMapping"in this){const t=new jn({value:this.inhibitPolicyMapping});t.idBlock.tagClass=3,t.idBlock.tagNumber=1,e.push(t)}return new Kn({value:e})}toJSON(){const e={};return"requireExplicitPolicy"in this&&(e.requireExplicitPolicy=this.requireExplicitPolicy),"inhibitPolicyMapping"in this&&(e.inhibitPolicyMapping=this.inhibitPolicyMapping),e}}class _o{constructor(e={}){this.keyPurposes=Ee(e,"keyPurposes",_o.defaultValues("keyPurposes")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){if("keyPurposes"===e)return[];throw new Error(`Invalid member name for ExtKeyUsage class: ${e}`)}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new _i({name:t.keyPurposes||"",value:new qn})]})}fromSchema(e){Fe(e,["keyPurposes"]);const t=xi(e,e,_o.schema({names:{keyPurposes:"keyPurposes"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for ExtKeyUsage");this.keyPurposes=Array.from(t.result.keyPurposes,(e=>e.valueBlock.toString()))}toSchema(){return new Kn({value:Array.from(this.keyPurposes,(e=>new qn({value:e})))})}toJSON(){return{keyPurposes:Array.from(this.keyPurposes)}}}class To{constructor(e={}){this.accessDescriptions=Ee(e,"accessDescriptions",To.defaultValues("accessDescriptions")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){if("accessDescriptions"===e)return[];throw new Error(`Invalid member name for InfoAccess class: ${e}`)}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new _i({name:t.accessDescriptions||"",value:ro.schema()})]})}fromSchema(e){Fe(e,["accessDescriptions"]);const t=xi(e,e,To.schema({names:{accessDescriptions:"accessDescriptions"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for InfoAccess");this.accessDescriptions=Array.from(t.result.accessDescriptions,(e=>new ro({schema:e})))}toSchema(){return new Kn({value:Array.from(this.accessDescriptions,(e=>e.toSchema()))})}toJSON(){return{accessDescriptions:Array.from(this.accessDescriptions,(e=>e.toJSON()))}}}class xo{constructor(e={}){if("view"in e)this.fromUint8Array(e.view);else if("buffer"in e)this.fromArrayBuffer(e.buffer);else if("string"in e)this.fromString(e.string);else if("hexstring"in e)this.fromHexString(e.hexstring);else if("length"in e&&e.length>0){if(this.length=e.length,e.stub)for(let t=0;t<this._view.length;t++)this._view[t]=e.stub}else this.length=0}set buffer(e){this._buffer=e,this._view=new Uint8Array(this._buffer)}get buffer(){return this._buffer}set view(e){this._buffer=new ArrayBuffer(e.length),this._view=new Uint8Array(this._buffer),this._view.set(e)}get view(){return this._view}get length(){return this.view.byteLength}set length(e){this._buffer=new ArrayBuffer(e),this._view=new Uint8Array(this._buffer)}clear(){this._buffer=new ArrayBuffer(0),this._view=new Uint8Array(this._buffer)}fromArrayBuffer(e){this._buffer=e,this._view=new Uint8Array(this._buffer)}fromUint8Array(e){this.fromArrayBuffer(new Uint8Array(e).buffer)}fromString(e){const t=e.length;this.length=t;for(let r=0;r<t;r++)this.view[r]=e.charCodeAt(r)}toString(e=0,t=this.view.length-e){let r="";(e>=this.view.length||e<0)&&(e=0),(t>=this.view.length||t<0)&&(t=this.view.length-e);for(let n=e;n<e+t;n++)r+=String.fromCharCode(this.view[n]);return r}fromHexString(e){const t=e.length;this.buffer=new ArrayBuffer(t>>1),this.view=new Uint8Array(this.buffer);const r=new Map;r.set("0",0),r.set("1",1),r.set("2",2),r.set("3",3),r.set("4",4),r.set("5",5),r.set("6",6),r.set("7",7),r.set("8",8),r.set("9",9),r.set("A",10),r.set("a",10),r.set("B",11),r.set("b",11),r.set("C",12),r.set("c",12),r.set("D",13),r.set("d",13),r.set("E",14),r.set("e",14),r.set("F",15),r.set("f",15);let n=0,i=0;for(let o=0;o<t;o++)o%2?(i|=r.get(e.charAt(o)),this.view[n]=i,n++):i=r.get(e.charAt(o))<<4}toHexString(e=0,t=this.view.length-e){let r="";(e>=this.view.length||e<0)&&(e=0),(t>=this.view.length||t<0)&&(t=this.view.length-e);for(let n=e;n<e+t;n++){const e=this.view[n].toString(16).toUpperCase();r=r+(1==e.length?"0":"")+e}return r}copy(e=0,t=this.length-e){if(!e&&!this.length)return new xo;if(e<0||e>this.length-1)throw new Error(`Wrong start position: ${e}`);return new xo({buffer:this._buffer.slice(e,e+t)})}slice(e=0,t=this.length){if(!e&&!this.length)return new xo;if(e<0||e>this.length-1)throw new Error(`Wrong start position: ${e}`);return new xo({buffer:this._buffer.slice(e,t)})}realloc(e){const t=new ArrayBuffer(e),r=new Uint8Array(t);e>this._view.length?r.set(this._view):r.set(new Uint8Array(this._buffer,0,e)),this._buffer=t,this._view=new Uint8Array(this._buffer)}append(e){const t=this.length,r=e.length,n=e._view.subarray();this.realloc(t+r),this._view.set(n,t)}insert(e,t=0,r=this.length-t){return!(t>this.length-1)&&(r>this.length-t&&(r=this.length-t),r>e.length&&(r=e.length),r==e.length?this._view.set(e._view,t):this._view.set(e._view.subarray(0,r),t),!0)}isEqual(e){if(this.length!=e.length)return!1;for(let t=0;t<e.length;t++)if(this.view[t]!=e.view[t])return!1;return!0}isEqualView(e){if(e.length!=this.view.length)return!1;for(let t=0;t<e.length;t++)if(this.view[t]!=e[t])return!1;return!0}findPattern(e,t,r,n){const{start:i,length:o,backward:s}=this.prepareFindParameters(t,r,n),a=e.length;if(a>o)return-1;const c=[];for(let t=0;t<a;t++)c.push(e.view[t]);for(let e=0;e<=o-a;e++){let t=!0;const r=s?i-a-e:i+e;for(let e=0;e<a;e++)if(this.view[e+r]!=c[e]){t=!1;break}if(t)return s?i-a-e:i+a+e}return-1}findFirstIn(e,t,r,n){const{start:i,length:o,backward:s}=this.prepareFindParameters(t,r,n),a={id:-1,position:s?0:i+o,length:0};for(let t=0;t<e.length;t++){const r=this.findPattern(e[t],i,o,s);if(-1!=r){let n=!1;const i=e[t].length;s?r-i>=a.position-a.length&&(n=!0):r-i<=a.position-a.length&&(n=!0),n&&(a.position=r,a.id=t,a.length=i)}}return a}findAllIn(e,t,r){let{start:n,length:i}=this.prepareFindParameters(t,r);const o=[];let s={id:-1,position:n};for(;;){const t=s.position;if(s=this.findFirstIn(e,s.position,i),-1==s.id)break;i-=s.position-t,o.push({id:s.id,position:s.position})}return o}findAllPatternIn(e,t,r){const{start:n,length:i}=this.prepareFindParameters(t,r),o=[],s=e.length;if(s>i)return-1;const a=Array.from(e.view);for(let e=0;e<=i-s;e++){let t=!0;const r=n+e;for(let e=0;e<s;e++)if(this.view[e+r]!=a[e]){t=!1;break}t&&(o.push(n+s+e),e+=s-1)}return o}findFirstNotIn(e,t,r,n){let{start:i,length:o,backward:s}=this.prepareFindParameters(t,r,n);const a={left:{id:-1,position:i},right:{id:-1,position:0},value:new xo};let c=o;for(;c>0;){if(a.right=this.findFirstIn(e,s?i-o+c:i+o-c,c,s),-1==a.right.id){o=c,s?i-=o:i=a.left.position,a.value=new xo({buffer:this._buffer.slice(i,i+o)});break}if(a.right.position!=(s?a.left.position-e[a.right.id].length:a.left.position+e[a.right.id].length)){s?(i=a.right.position+e[a.right.id].length,o=a.left.position-a.right.position-e[a.right.id].length):(i=a.left.position,o=a.right.position-a.left.position-e[a.right.id].length),a.value=new xo({buffer:this._buffer.slice(i,i+o)});break}a.left=a.right,c-=e[a.right.id].length}if(s){const e=a.right;a.right=a.left,a.left=e}return a}findAllNotIn(e,t,r){let{start:n,length:i}=this.prepareFindParameters(t,r);const o=[];let s={left:{id:-1,position:n},right:{id:-1,position:n},value:new xo};do{const t=s.right.position;s=this.findFirstNotIn(e,s.right.position,i),i-=s.right.position-t,o.push({left:{id:s.left.id,position:s.left.position},right:{id:s.right.id,position:s.right.position},value:s.value})}while(-1!=s.right.id);return o}findFirstSequence(e,t,r,n){let{start:i,length:o,backward:s}=this.prepareFindParameters(t,r,n);const a=this.skipNotPatterns(e,i,o,s);if(-1==a)return{position:-1,value:new xo};const c=this.skipPatterns(e,a,o-(s?i-a:a-i),s);s?(i=c,o=a-c):(i=a,o=c-a);return{position:c,value:new xo({buffer:this._buffer.slice(i,i+o)})}}findAllSequences(e,t,r){let{start:n,length:i}=this.prepareFindParameters(t,r);const o=[];let s={position:n,value:new xo};do{const t=s.position;s=this.findFirstSequence(e,s.position,i),-1!=s.position&&(i-=s.position-t,o.push({position:s.position,value:s.value}))}while(-1!=s.position);return o}findPairedPatterns(e,t,r,n){const i=[];if(e.isEqual(t))return i;const{start:o,length:s}=this.prepareFindParameters(r,n);let a=0;const c=this.findAllPatternIn(e,o,s);if(!Array.isArray(c)||0==c.length)return i;const u=this.findAllPatternIn(t,o,s);if(!Array.isArray(u)||0==u.length)return i;for(;a<c.length&&0!=u.length;)if(c[0]!=u[0]){if(c[a]>u[0])break;for(;c[a]<u[0]&&(a++,!(a>=c.length)););i.push({left:c[a-1],right:u[0]}),c.splice(a-1,1),u.splice(0,1),a=0}else i.push({left:c[0],right:u[0]}),c.splice(0,1),u.splice(0,1);return i.sort(((e,t)=>e.left-t.left)),i}findPairedArrays(e,t,r,n){const{start:i,length:o}=this.prepareFindParameters(r,n),s=[];let a=0;const c=this.findAllIn(e,i,o);if(0==c.length)return s;const u=this.findAllIn(t,i,o);if(0==u.length)return s;for(;a<c.length&&0!=u.length;)if(c[0].position!=u[0].position){if(c[a].position>u[0].position)break;for(;c[a].position<u[0].position&&(a++,!(a>=c.length)););s.push({left:c[a-1],right:u[0]}),c.splice(a-1,1),u.splice(0,1),a=0}else s.push({left:c[0],right:u[0]}),c.splice(0,1),u.splice(0,1);return s.sort(((e,t)=>e.left.position-t.left.position)),s}replacePattern(e,t,r,n,i=null){let o,s=[];const a={status:-1,searchPatternPositions:[],replacePatternPositions:[]},{start:c,length:u}=this.prepareFindParameters(r,n);if(null==i){if(s=this.findAllIn([e],c,u),0==s.length)return a}else s=i;a.searchPatternPositions.push(...Array.from(s,(e=>e.position)));const l=e.length-t.length,d=new ArrayBuffer(this.view.length-s.length*l),h=new Uint8Array(d);for(h.set(new Uint8Array(this.buffer,0,c)),o=0;o<s.length;o++){const r=0==o?c:s[o-1].position;h.set(new Uint8Array(this.buffer,r,s[o].position-e.length-r),r-o*l),h.set(t.view,s[o].position-e.length-o*l),a.replacePatternPositions.push(s[o].position-e.length-o*l)}return o--,h.set(new Uint8Array(this.buffer,s[o].position,this.length-s[o].position),s[o].position-e.length+t.length-o*l),this.buffer=d,this.view=new Uint8Array(this.buffer),a.status=1,a}skipPatterns(e,t,r,n){const{start:i,length:o,backward:s}=this.prepareFindParameters(t,r,n);let a=i;for(let t=0;t<e.length;t++){const r=e[t].length,n=s?a-r:a;let c=!0;for(let i=0;i<r;i++)if(this.view[i+n]!=e[t].view[i]){c=!1;break}if(c)if(t=-1,s){if(a-=r,a<=0)return a}else if(a+=r,a>=i+o)return a}return a}skipNotPatterns(e,t,r,n){const{start:i,length:o,backward:s}=this.prepareFindParameters(t,r,n);let a=-1;for(let t=0;t<o;t++){for(let r=0;r<e.length;r++){const n=e[r].length,o=s?i-t-n:i+t;let c=!0;for(let t=0;t<n;t++)if(this.view[t+o]!=e[r].view[t]){c=!1;break}if(c){a=s?i-t:i+t;break}}if(-1!=a)break}return a}prepareFindParameters(e=null,t=null,r=!1){return null===e&&(e=r?this.length:0),e>this.length&&(e=this.length),r?(null===t&&(t=e),t>e&&(t=e)):(null===t&&(t=this.length-e),t>this.length-e&&(t=this.length-e)),{start:e,length:t,backward:r}}}class Ao{constructor(e={}){this._stream=new xo,this._length=0,this._start=0,this.backward=!1,this.appendBlock=0,this.prevLength=0,this.prevStart=0,this.stream="view"in e?new xo({view:e.view}):"buffer"in e?new xo({buffer:e.buffer}):"string"in e?new xo({string:e.string}):"hexstring"in e?new xo({hexstring:e.hexstring}):"stream"in e?e.stream.slice():new xo,"backward"in e&&e.backward&&(this.backward=e.backward,this._start=this.stream.length),"length"in e&&e.length>0&&(this._length=e.length),"start"in e&&e.start&&e.start>0&&(this._start=e.start),"appendBlock"in e&&e.appendBlock&&e.appendBlock>0&&(this.appendBlock=e.appendBlock)}set stream(e){this._stream=e,this.prevLength=this._length,this._length=e.length,this.prevStart=this._start,this._start=0}get stream(){return this._stream}set length(e){this.prevLength=this._length,this._length=e}get length(){return this.appendBlock?this.start:this._length}set start(e){e>this.stream.length||(this.prevStart=this._start,this.prevLength=this._length,this._length-=this.backward?this._start-e:e-this._start,this._start=e)}get start(){return this._start}get buffer(){return this._stream.buffer.slice(0,this._length)}resetPosition(){this._start=this.prevStart,this._length=this.prevLength}findPattern(e,t=null){(null==t||t>this.length)&&(t=this.length);const r=this.stream.findPattern(e,this.start,this.length,this.backward);if(-1==r)return r;if(this.backward){if(r<this.start-e.length-t)return-1}else if(r>this.start+e.length+t)return-1;return this.start=r,r}findFirstIn(e,t=null){(null==t||t>this.length)&&(t=this.length);const r=this.stream.findFirstIn(e,this.start,this.length,this.backward);if(-1==r.id)return r;if(this.backward){if(r.position<this.start-e[r.id].length-t)return{id:-1,position:this.backward?0:this.start+this.length}}else if(r.position>this.start+e[r.id].length+t)return{id:-1,position:this.backward?0:this.start+this.length};return this.start=r.position,r}findAllIn(e){const t=this.backward?this.start-this.length:this.start;return this.stream.findAllIn(e,t,this.length)}findFirstNotIn(e,t=null){(null==t||t>this._length)&&(t=this._length);const r=this._stream.findFirstNotIn(e,this._start,this._length,this.backward);if(-1==r.left.id&&-1==r.right.id)return r;if(this.backward){if(-1!=r.right.id&&r.right.position<this._start-e[r.right.id].length-t)return{left:{id:-1,position:this._start},right:{id:-1,position:0},value:new xo}}else if(-1!=r.left.id&&r.left.position>this._start+e[r.left.id].length+t)return{left:{id:-1,position:this._start},right:{id:-1,position:0},value:new xo};return this.backward?-1==r.left.id?this.start=0:this.start=r.left.position:-1==r.right.id?this.start=this._start+this._length:this.start=r.right.position,r}findAllNotIn(e){const t=this.backward?this._start-this._length:this._start;return this._stream.findAllNotIn(e,t,this._length)}findFirstSequence(e,t=null,r=null){(null==t||t>this._length)&&(t=this._length),(null==r||r>t)&&(r=t);const n=this._stream.findFirstSequence(e,this._start,t,this.backward);if(0==n.value.length)return n;if(this.backward){if(n.position<this._start-n.value.length-r)return{position:-1,value:new xo}}else if(n.position>this._start+n.value.length+r)return{position:-1,value:new xo};return this.start=n.position,n}findAllSequences(e){const t=this.backward?this.start-this.length:this.start;return this.stream.findAllSequences(e,t,this.length)}findPairedPatterns(e,t,r=null){(null==r||r>this.length)&&(r=this.length);const n=this.backward?this.start-this.length:this.start,i=this.stream.findPairedPatterns(e,t,n,this.length);if(i.length)if(this.backward){if(i[0].right<this.start-t.length-r)return[]}else if(i[0].left>this.start+e.length+r)return[];return i}findPairedArrays(e,t,r=null){(null==r||r>this.length)&&(r=this.length);const n=this.backward?this.start-this.length:this.start,i=this.stream.findPairedArrays(e,t,n,this.length);if(i.length)if(this.backward){if(i[0].right.position<this.start-t[i[0].right.id].length-r)return[]}else if(i[0].left.position>this.start+e[i[0].left.id].length+r)return[];return i}replacePattern(e,t){const r=this.backward?this.start-this.length:this.start;return this.stream.replacePattern(e,t,r,this.length)}skipPatterns(e){const t=this.stream.skipPatterns(e,this.start,this.length,this.backward);return this.start=t,t}skipNotPatterns(e){const t=this.stream.skipNotPatterns(e,this.start,this.length,this.backward);return-1==t?-1:(this.start=t,t)}append(e){this.beforeAppend(e.length),this._stream.view.set(e.view,this._start),this._length+=2*e.length,this.start=this._start+e.length,this.prevLength-=2*e.length}appendView(e){this.beforeAppend(e.length),this._stream.view.set(e,this._start),this._length+=2*e.length,this.start=this._start+e.length,this.prevLength-=2*e.length}appendChar(e){this.beforeAppend(1),this._stream.view[this._start]=e,this._length+=2,this.start=this._start+1,this.prevLength-=2}appendUint16(e){this.beforeAppend(2);const t=new Uint16Array([e]),r=new Uint8Array(t.buffer);this.stream.view[this._start]=r[1],this._stream.view[this._start+1]=r[0],this._length+=4,this.start=this._start+2,this.prevLength-=4}appendUint24(e){this.beforeAppend(3);const t=new Uint32Array([e]),r=new Uint8Array(t.buffer);this._stream.view[this._start]=r[2],this._stream.view[this._start+1]=r[1],this._stream.view[this._start+2]=r[0],this._length+=6,this.start=this._start+3,this.prevLength-=6}appendUint32(e){this.beforeAppend(4);const t=new Uint32Array([e]),r=new Uint8Array(t.buffer);this._stream.view[this._start]=r[3],this._stream.view[this._start+1]=r[2],this._stream.view[this._start+2]=r[1],this._stream.view[this._start+3]=r[0],this._length+=8,this.start=this._start+4,this.prevLength-=8}appendInt16(e){this.beforeAppend(2);const t=new Int16Array([e]),r=new Uint8Array(t.buffer);this._stream.view[this._start]=r[1],this._stream.view[this._start+1]=r[0],this._length+=4,this.start=this._start+2,this.prevLength-=4}appendInt32(e){this.beforeAppend(4);const t=new Int32Array([e]),r=new Uint8Array(t.buffer);this._stream.view[this._start]=r[3],this._stream.view[this._start+1]=r[2],this._stream.view[this._start+2]=r[1],this._stream.view[this._start+3]=r[0],this._length+=8,this.start=this._start+4,this.prevLength-=8}getBlock(e,t=!0){if(this._length<=0)return new Uint8Array(0);let r;if(this._length<e&&(e=this._length),this.backward){const t=this._stream.view.subarray(this._length-e,this._length);r=new Uint8Array(e);for(let n=0;n<e;n++)r[e-1-n]=t[n]}else r=this._stream.view.subarray(this._start,this._start+e);return t&&(this.start+=this.backward?-1*e:e),r}getUint16(e=!0){const t=this.getBlock(2,e);if(t.length<2)return 0;const r=new Uint16Array(1),n=new Uint8Array(r.buffer);return n[0]=t[1],n[1]=t[0],r[0]}getInt16(e=!0){const t=this.getBlock(2,e);if(t.length<2)return 0;const r=new Int16Array(1),n=new Uint8Array(r.buffer);return n[0]=t[1],n[1]=t[0],r[0]}getUint24(e=!0){const t=this.getBlock(3,e);if(t.length<3)return 0;const r=new Uint32Array(1),n=new Uint8Array(r.buffer);for(let e=3;e>=1;e--)n[3-e]=t[e-1];return r[0]}getUint32(e=!0){const t=this.getBlock(4,e);if(t.length<4)return 0;const r=new Uint32Array(1),n=new Uint8Array(r.buffer);for(let e=3;e>=0;e--)n[3-e]=t[e];return r[0]}getInt32(e=!0){const t=this.getBlock(4,e);if(t.length<4)return 0;const r=new Int32Array(1),n=new Uint8Array(r.buffer);for(let e=3;e>=0;e--)n[3-e]=t[e];return r[0]}beforeAppend(e){this._start+e>this._stream.length&&(e>this.appendBlock&&(this.appendBlock=e+Ao.APPEND_BLOCK),this._stream.realloc(this._stream.length+this.appendBlock))}}Ao.APPEND_BLOCK=1e3;class Io{constructor(e={}){this.version=Ee(e,"version",Io.defaultValues("version")),this.logID=Ee(e,"logID",Io.defaultValues("logID")),this.timestamp=Ee(e,"timestamp",Io.defaultValues("timestamp")),this.extensions=Ee(e,"extensions",Io.defaultValues("extensions")),this.hashAlgorithm=Ee(e,"hashAlgorithm",Io.defaultValues("hashAlgorithm")),this.signatureAlgorithm=Ee(e,"signatureAlgorithm",Io.defaultValues("signatureAlgorithm")),this.signature=Ee(e,"signature",Io.defaultValues("signature")),"schema"in e&&this.fromSchema(e.schema),"stream"in e&&this.fromStream(e.stream)}static defaultValues(e){switch(e){case"version":return 0;case"logID":case"extensions":return new ArrayBuffer(0);case"timestamp":return new Date(0);case"hashAlgorithm":case"signatureAlgorithm":return"";case"signature":return new wi;default:throw new Error(`Invalid member name for SignedCertificateTimestamp class: ${e}`)}}fromSchema(e){if(e instanceof Ti==!1)throw new Error("Object's schema was not verified against input data for SignedCertificateTimestamp");const t=new Ao({stream:new xo({buffer:e.data})});this.fromStream(t)}fromStream(e){const t=e.getUint16();if(this.version=e.getBlock(1)[0],0===this.version){this.logID=new Uint8Array(e.getBlock(32)).buffer.slice(0),this.timestamp=new Date(_e(new Uint8Array(e.getBlock(8)),8));const r=e.getUint16();switch(this.extensions=new Uint8Array(e.getBlock(r)).buffer.slice(0),e.getBlock(1)[0]){case 0:this.hashAlgorithm="none";break;case 1:this.hashAlgorithm="md5";break;case 2:this.hashAlgorithm="sha1";break;case 3:this.hashAlgorithm="sha224";break;case 4:this.hashAlgorithm="sha256";break;case 5:this.hashAlgorithm="sha384";break;case 6:this.hashAlgorithm="sha512";break;default:throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}switch(e.getBlock(1)[0]){case 0:this.signatureAlgorithm="anonymous";break;case 1:this.signatureAlgorithm="rsa";break;case 2:this.signatureAlgorithm="dsa";break;case 3:this.signatureAlgorithm="ecdsa";break;default:throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}const n=e.getUint16(),i=Tn(new Uint8Array(e.getBlock(n)).buffer.slice(0));if(-1===i.offset)throw new Error("Object's stream was not correct for SignedCertificateTimestamp");if(this.signature=i.result,t!==47+r+n)throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}}toSchema(){const e=this.toStream();return new Ti({data:e.stream.buffer})}toStream(){const e=new Ao;e.appendUint16(47+this.extensions.byteLength+this.signature.valueBeforeDecode.byteLength),e.appendChar(this.version),e.appendView(new Uint8Array(this.logID));const t=new ArrayBuffer(8),r=new Uint8Array(t),n=Te(this.timestamp.valueOf(),8);let i,o;switch(r.set(new Uint8Array(n),8-n.byteLength),e.appendView(r),e.appendUint16(this.extensions.byteLength),this.extensions.byteLength&&e.appendView(new Uint8Array(this.extensions)),this.hashAlgorithm.toLowerCase()){case"none":i=0;break;case"md5":i=1;break;case"sha1":i=2;break;case"sha224":i=3;break;case"sha256":i=4;break;case"sha384":i=5;break;case"sha512":i=6;break;default:throw new Error(`Incorrect data for hashAlgorithm: ${this.hashAlgorithm}`)}switch(e.appendChar(i),this.signatureAlgorithm.toLowerCase()){case"anonymous":o=0;break;case"rsa":o=1;break;case"dsa":o=2;break;case"ecdsa":o=3;break;default:throw new Error(`Incorrect data for signatureAlgorithm: ${this.signatureAlgorithm}`)}e.appendChar(o);const s=this.signature.toBER(!1);return e.appendUint16(s.byteLength),e.appendView(new Uint8Array(s)),e}toJSON(){return{version:this.version,logID:we(this.logID),timestamp:this.timestamp,extensions:we(this.extensions),hashAlgorithm:this.hashAlgorithm,signatureAlgorithm:this.signatureAlgorithm,signature:this.signature.toJSON()}}async verify(e,t,r=0){let n,i=Pe(De(this.logID)),o=null,s=new Ao;for(const t of e)if(t.log_id===i){o=t.key;break}if(null===o)throw new Error(`Public key not found for CT with logId: ${i}`);const a=Tn(Me(Le(o)));if(-1===a.offset)throw new Error(`Incorrect key value for CT Log with logId: ${i}`);n=new ki({schema:a.result}),s.appendChar(0),s.appendChar(0);const c=new ArrayBuffer(8),u=new Uint8Array(c),l=Te(this.timestamp.valueOf(),8);return u.set(new Uint8Array(l),8-l.byteLength),s.appendView(u),s.appendUint16(r),0===r&&s.appendUint24(t.byteLength),s.appendView(new Uint8Array(t)),s.appendUint16(this.extensions.byteLength),0!==this.extensions.byteLength&&s.appendView(new Uint8Array(this.extensions)),$i().subtle.verifyWithPublicKey(s._stream._buffer.slice(0,s._length),{valueBlock:{valueHex:this.signature.toBER(!1)}},n,{algorithmId:""},"SHA-256")}}class Co{constructor(e={}){this.timestamps=Ee(e,"timestamps",Co.defaultValues("timestamps")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){if("timestamps"===e)return[];throw new Error(`Invalid member name for SignedCertificateTimestampList class: ${e}`)}static compareWithDefault(e,t){if("timestamps"===e)return 0===t.length;throw new Error(`Invalid member name for SignedCertificateTimestampList class: ${e}`)}static schema(e={}){const t=Ee(e,"names",{});return"optional"in t==!1&&(t.optional=!1),new Pn({name:t.blockName||"SignedCertificateTimestampList",optional:t.optional})}fromSchema(e){if(e instanceof Pn==!1)throw new Error("Object's schema was not verified against input data for SignedCertificateTimestampList");const t=new Ao({stream:new xo({buffer:e.valueBlock.valueHex})});if(t.getUint16()!==t.length)throw new Error("Object's schema was not verified against input data for SignedCertificateTimestampList");for(;t.length;)this.timestamps.push(new Io({stream:t}))}toSchema(){const e=new Ao;let t=0;const r=[];for(const e of this.timestamps){const n=e.toStream();r.push(n),t+=n.stream.buffer.byteLength}e.appendUint16(t);for(const t of r)e.appendView(t.stream.view);return new Pn({valueHex:e.stream.buffer.slice(0)})}toJSON(){return{timestamps:Array.from(this.timestamps,(e=>e.toJSON()))}}}class Ro{constructor(e={}){this.templateID=Ee(e,"templateID",Ro.defaultValues("templateID")),"templateMajorVersion"in e&&(this.templateMajorVersion=Ee(e,"templateMajorVersion",Ro.defaultValues("templateMajorVersion"))),"templateMinorVersion"in e&&(this.templateMinorVersion=Ee(e,"templateMinorVersion",Ro.defaultValues("templateMinorVersion"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"templateID":return"";case"templateMajorVersion":case"templateMinorVersion":return 0;default:throw new Error(`Invalid member name for CertificateTemplate class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new qn({name:t.templateID||""}),new jn({name:t.templateMajorVersion||"",optional:!0}),new jn({name:t.templateMinorVersion||"",optional:!0})]})}fromSchema(e){Fe(e,["templateID","templateMajorVersion","templateMinorVersion"]);let t=xi(e,e,Ro.schema({names:{templateID:"templateID",templateMajorVersion:"templateMajorVersion",templateMinorVersion:"templateMinorVersion"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for CertificateTemplate");this.templateID=t.result.templateID.valueBlock.toString(),"templateMajorVersion"in t.result&&(this.templateMajorVersion=t.result.templateMajorVersion.valueBlock.valueDec),"templateMinorVersion"in t.result&&(this.templateMinorVersion=t.result.templateMinorVersion.valueBlock.valueDec)}toSchema(){const e=[];return e.push(new qn({value:this.templateID})),"templateMajorVersion"in this&&e.push(new jn({value:this.templateMajorVersion})),"templateMinorVersion"in this&&e.push(new jn({value:this.templateMinorVersion})),new Kn({value:e})}toJSON(){const e={extnID:this.templateID};return"templateMajorVersion"in this&&(e.templateMajorVersion=this.templateMajorVersion),"templateMinorVersion"in this&&(e.templateMinorVersion=this.templateMinorVersion),e}}class ko{constructor(e={}){this.certificateIndex=Ee(e,"certificateIndex",ko.defaultValues("certificateIndex")),this.keyIndex=Ee(e,"keyIndex",ko.defaultValues("keyIndex")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"certificateIndex":case"keyIndex":return 0;default:throw new Error(`Invalid member name for CAVersion class: ${e}`)}}static schema(e={}){return new jn}fromSchema(e){if(e.constructor.blockName()!==jn.blockName())throw new Error("Object's schema was not verified against input data for CAVersion");let t=e.valueBlock.valueHex.slice(0);const r=new Uint8Array(t);switch(!0){case t.byteLength<4:{const e=new ArrayBuffer(4);new Uint8Array(e).set(r,4-t.byteLength),t=e.slice(0)}break;case t.byteLength>4:{const e=new ArrayBuffer(4);new Uint8Array(e).set(r.slice(0,4)),t=e.slice(0)}}const n=t.slice(0,2),i=new Uint8Array(n);let o=i[0];i[0]=i[1],i[1]=o;const s=new Uint16Array(n);this.keyIndex=s[0];const a=t.slice(2),c=new Uint8Array(a);o=c[0],c[0]=c[1],c[1]=o;const u=new Uint16Array(a);this.certificateIndex=u[0]}toSchema(){const e=new ArrayBuffer(2);new Uint16Array(e)[0]=this.certificateIndex;const t=new Uint8Array(e);let r=t[0];t[0]=t[1],t[1]=r;const n=new ArrayBuffer(2);new Uint16Array(n)[0]=this.keyIndex;const i=new Uint8Array(n);return r=i[0],i[0]=i[1],i[1]=r,new jn({valueHex:xe(n,e)})}toJSON(){return{certificateIndex:this.certificateIndex,keyIndex:this.keyIndex}}}class Oo{constructor(e={}){this.id=Ee(e,"id",Oo.defaultValues("id")),"type"in e&&(this.type=Ee(e,"type",Oo.defaultValues("type"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"id":return"";case"type":return new Rn;default:throw new Error(`Invalid member name for QCStatement class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"id":return""===t;case"type":return t instanceof Rn;default:throw new Error(`Invalid member name for QCStatement class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new qn({name:t.id||""}),new wi({name:t.type||"",optional:!0})]})}fromSchema(e){Fe(e,["id","type"]);const t=xi(e,e,Oo.schema({names:{id:"id",type:"type"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for QCStatement");this.id=t.result.id.valueBlock.toString(),"type"in t.result&&(this.type=t.result.type)}toSchema(){const e=[new qn({value:this.id})];return"type"in this&&e.push(this.type),new Kn({value:e})}toJSON(){const e={id:this.id};return"type"in this&&(e.type=this.type.toJSON()),e}}class No{constructor(e={}){this.values=Ee(e,"values",No.defaultValues("values")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){if("values"===e)return[];throw new Error(`Invalid member name for QCStatements class: ${e}`)}static compareWithDefault(e,t){if("values"===e)return 0===t.length;throw new Error(`Invalid member name for QCStatements class: ${e}`)}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new _i({name:t.values||"",value:Oo.schema(t.value||{})})]})}fromSchema(e){Fe(e,["values"]);const t=xi(e,e,No.schema({names:{values:"values"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for QCStatements");this.values=Array.from(t.result.values,(e=>new Oo({schema:e})))}toSchema(){return new Kn({value:Array.from(this.values,(e=>e.toSchema()))})}toJSON(){return{extensions:Array.from(this.values,(e=>e.toJSON()))}}}class Po{constructor(e={}){this.extnID=Ee(e,"extnID",Po.defaultValues("extnID")),this.critical=Ee(e,"critical",Po.defaultValues("critical")),this.extnValue="extnValue"in e?new Pn({valueHex:e.extnValue}):Po.defaultValues("extnValue"),"parsedValue"in e&&(this.parsedValue=Ee(e,"parsedValue",Po.defaultValues("parsedValue"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"extnID":return"";case"critical":return!1;case"extnValue":return new Pn;case"parsedValue":return{};default:throw new Error(`Invalid member name for Extension class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new qn({name:t.extnID||""}),new On({name:t.critical||"",optional:!0}),new Pn({name:t.extnValue||""})]})}fromSchema(e){Fe(e,["extnID","critical","extnValue"]);let t=xi(e,e,Po.schema({names:{extnID:"extnID",critical:"critical",extnValue:"extnValue"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for Extension");if(this.extnID=t.result.extnID.valueBlock.toString(),"critical"in t.result&&(this.critical=t.result.critical.valueBlock.value),this.extnValue=t.result.extnValue,t=Tn(this.extnValue.valueBlock.valueHex),-1!==t.offset)switch(this.extnID){case"2.5.29.9":try{this.parsedValue=new so({schema:t.result})}catch(e){this.parsedValue=new so,this.parsedValue.parsingError="Incorrectly formated SubjectDirectoryAttributes"}break;case"2.5.29.14":case"2.5.29.15":case"2.5.29.20":case"2.5.29.27":case"2.5.29.21":case"2.5.29.24":case"2.5.29.54":case"1.3.6.1.4.1.311.20.2":case"1.3.6.1.4.1.311.21.2":this.parsedValue=t.result;break;case"2.5.29.16":try{this.parsedValue=new ao({schema:t.result})}catch(e){this.parsedValue=new ao,this.parsedValue.parsingError="Incorrectly formated PrivateKeyUsagePeriod"}break;case"2.5.29.17":case"2.5.29.18":try{this.parsedValue=new io({schema:t.result})}catch(e){this.parsedValue=new io,this.parsedValue.parsingError="Incorrectly formated AltName"}break;case"2.5.29.19":try{this.parsedValue=new co({schema:t.result})}catch(e){this.parsedValue=new co,this.parsedValue.parsingError="Incorrectly formated BasicConstraints"}break;case"2.5.29.28":try{this.parsedValue=new uo({schema:t.result})}catch(e){this.parsedValue=new uo,this.parsedValue.parsingError="Incorrectly formated IssuingDistributionPoint"}break;case"2.5.29.29":try{this.parsedValue=new lo({schema:t.result})}catch(e){this.parsedValue=new lo,this.parsedValue.parsingError="Incorrectly formated GeneralNames"}break;case"2.5.29.30":try{this.parsedValue=new fo({schema:t.result})}catch(e){this.parsedValue=new fo,this.parsedValue.parsingError="Incorrectly formated NameConstraints"}break;case"2.5.29.31":case"2.5.29.46":try{this.parsedValue=new mo({schema:t.result})}catch(e){this.parsedValue=new mo,this.parsedValue.parsingError="Incorrectly formated CRLDistributionPoints"}break;case"2.5.29.32":case"1.3.6.1.4.1.311.21.10":try{this.parsedValue=new yo({schema:t.result})}catch(e){this.parsedValue=new yo,this.parsedValue.parsingError="Incorrectly formated CertificatePolicies"}break;case"2.5.29.33":try{this.parsedValue=new Eo({schema:t.result})}catch(e){this.parsedValue=new Eo,this.parsedValue.parsingError="Incorrectly formated CertificatePolicies"}break;case"2.5.29.35":try{this.parsedValue=new wo({schema:t.result})}catch(e){this.parsedValue=new wo,this.parsedValue.parsingError="Incorrectly formated AuthorityKeyIdentifier"}break;case"2.5.29.36":try{this.parsedValue=new So({schema:t.result})}catch(e){this.parsedValue=new So,this.parsedValue.parsingError="Incorrectly formated PolicyConstraints"}break;case"2.5.29.37":try{this.parsedValue=new _o({schema:t.result})}catch(e){this.parsedValue=new _o,this.parsedValue.parsingError="Incorrectly formated ExtKeyUsage"}break;case"1.3.6.1.5.5.7.1.1":case"1.3.6.1.5.5.7.1.11":try{this.parsedValue=new To({schema:t.result})}catch(e){this.parsedValue=new To,this.parsedValue.parsingError="Incorrectly formated InfoAccess"}break;case"1.3.6.1.4.1.11129.2.4.2":try{this.parsedValue=new Co({schema:t.result})}catch(e){this.parsedValue=new Co,this.parsedValue.parsingError="Incorrectly formated SignedCertificateTimestampList"}break;case"1.3.6.1.4.1.311.21.7":try{this.parsedValue=new Ro({schema:t.result})}catch(e){this.parsedValue=new Ro,this.parsedValue.parsingError="Incorrectly formated CertificateTemplate"}break;case"1.3.6.1.4.1.311.21.1":try{this.parsedValue=new ko({schema:t.result})}catch(e){this.parsedValue=new ko,this.parsedValue.parsingError="Incorrectly formated CAVersion"}break;case"1.3.6.1.5.5.7.1.3":try{this.parsedValue=new No({schema:t.result})}catch(e){this.parsedValue=new No,this.parsedValue.parsingError="Incorrectly formated QCStatements"}}}toSchema(){const e=[];return e.push(new qn({value:this.extnID})),this.critical!==Po.defaultValues("critical")&&e.push(new On({value:this.critical})),e.push(this.extnValue),new Kn({value:e})}toJSON(){const e={extnID:this.extnID,extnValue:this.extnValue.toJSON()};return this.critical!==Po.defaultValues("critical")&&(e.critical=this.critical),"parsedValue"in this&&"toJSON"in this.parsedValue&&(e.parsedValue=this.parsedValue.toJSON()),e}}class Lo{constructor(e={}){this.extensions=Ee(e,"extensions",Lo.defaultValues("extensions")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){if("extensions"===e)return[];throw new Error(`Invalid member name for Extensions class: ${e}`)}static schema(e={},t=!1){const r=Ee(e,"names",{});return new Kn({optional:t,name:r.blockName||"",value:[new _i({name:r.extensions||"",value:Po.schema(r.extension||{})})]})}fromSchema(e){Fe(e,["extensions"]);const t=xi(e,e,Lo.schema({names:{extensions:"extensions"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for Extensions");this.extensions=Array.from(t.result.extensions,(e=>new Po({schema:e})))}toSchema(){return new Kn({value:Array.from(this.extensions,(e=>e.toSchema()))})}toJSON(){return{extensions:Array.from(this.extensions,(e=>e.toJSON()))}}}function Do(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"tbsCertificate",value:[new An({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new jn({name:t.tbsCertificateVersion||"tbsCertificate.version"})]}),new jn({name:t.tbsCertificateSerialNumber||"tbsCertificate.serialNumber"}),Ai.schema(t.signature||{names:{blockName:"tbsCertificate.signature"}}),Yi.schema(t.issuer||{names:{blockName:"tbsCertificate.issuer"}}),new Kn({name:t.tbsCertificateValidity||"tbsCertificate.validity",value:[oo.schema(t.notBefore||{names:{utcTimeName:"tbsCertificate.notBefore",generalTimeName:"tbsCertificate.notBefore"}}),oo.schema(t.notAfter||{names:{utcTimeName:"tbsCertificate.notAfter",generalTimeName:"tbsCertificate.notAfter"}})]}),Yi.schema(t.subject||{names:{blockName:"tbsCertificate.subject"}}),ki.schema(t.subjectPublicKeyInfo||{names:{blockName:"tbsCertificate.subjectPublicKeyInfo"}}),new Sn({name:t.tbsCertificateIssuerUniqueID||"tbsCertificate.issuerUniqueID",optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new Sn({name:t.tbsCertificateSubjectUniqueID||"tbsCertificate.subjectUniqueID",optional:!0,idBlock:{tagClass:3,tagNumber:2}}),new An({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[Lo.schema(t.extensions||{names:{blockName:"tbsCertificate.extensions"}})]})]})}class Mo{constructor(e={}){this.tbs=Ee(e,"tbs",Mo.defaultValues("tbs")),this.version=Ee(e,"version",Mo.defaultValues("version")),this.serialNumber=Ee(e,"serialNumber",Mo.defaultValues("serialNumber")),this.signature=Ee(e,"signature",Mo.defaultValues("signature")),this.issuer=Ee(e,"issuer",Mo.defaultValues("issuer")),this.notBefore=Ee(e,"notBefore",Mo.defaultValues("notBefore")),this.notAfter=Ee(e,"notAfter",Mo.defaultValues("notAfter")),this.subject=Ee(e,"subject",Mo.defaultValues("subject")),this.subjectPublicKeyInfo=Ee(e,"subjectPublicKeyInfo",Mo.defaultValues("subjectPublicKeyInfo")),"issuerUniqueID"in e&&(this.issuerUniqueID=Ee(e,"issuerUniqueID",Mo.defaultValues("issuerUniqueID"))),"subjectUniqueID"in e&&(this.subjectUniqueID=Ee(e,"subjectUniqueID",Mo.defaultValues("subjectUniqueID"))),"extensions"in e&&(this.extensions=Ee(e,"extensions",Mo.defaultValues("extensions"))),this.signatureAlgorithm=Ee(e,"signatureAlgorithm",Mo.defaultValues("signatureAlgorithm")),this.signatureValue=Ee(e,"signatureValue",Mo.defaultValues("signatureValue")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"tbs":case"issuerUniqueID":case"subjectUniqueID":return new ArrayBuffer(0);case"version":return 0;case"serialNumber":return new jn;case"signature":case"signatureAlgorithm":return new Ai;case"issuer":case"subject":return new Yi;case"notBefore":case"notAfter":return new oo;case"subjectPublicKeyInfo":return new ki;case"extensions":return[];case"signatureValue":return new Dn;default:throw new Error(`Invalid member name for Certificate class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[Do(t.tbsCertificate),Ai.schema(t.signatureAlgorithm||{names:{blockName:"signatureAlgorithm"}}),new Dn({name:t.signatureValue||"signatureValue"})]})}fromSchema(e){Fe(e,["tbsCertificate","tbsCertificate.extensions","tbsCertificate.version","tbsCertificate.serialNumber","tbsCertificate.signature","tbsCertificate.issuer","tbsCertificate.notBefore","tbsCertificate.notAfter","tbsCertificate.subject","tbsCertificate.subjectPublicKeyInfo","tbsCertificate.issuerUniqueID","tbsCertificate.subjectUniqueID","signatureAlgorithm","signatureValue"]);const t=xi(e,e,Mo.schema({names:{tbsCertificate:{names:{extensions:{names:{extensions:"tbsCertificate.extensions"}}}}}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for Certificate");this.tbs=t.result.tbsCertificate.valueBeforeDecode,"tbsCertificate.version"in t.result&&(this.version=t.result["tbsCertificate.version"].valueBlock.valueDec),this.serialNumber=t.result["tbsCertificate.serialNumber"],this.signature=new Ai({schema:t.result["tbsCertificate.signature"]}),this.issuer=new Yi({schema:t.result["tbsCertificate.issuer"]}),this.notBefore=new oo({schema:t.result["tbsCertificate.notBefore"]}),this.notAfter=new oo({schema:t.result["tbsCertificate.notAfter"]}),this.subject=new Yi({schema:t.result["tbsCertificate.subject"]}),this.subjectPublicKeyInfo=new ki({schema:t.result["tbsCertificate.subjectPublicKeyInfo"]}),"tbsCertificate.issuerUniqueID"in t.result&&(this.issuerUniqueID=t.result["tbsCertificate.issuerUniqueID"].valueBlock.valueHex),"tbsCertificate.subjectUniqueID"in t.result&&(this.subjectUniqueID=t.result["tbsCertificate.subjectUniqueID"].valueBlock.valueHex),"tbsCertificate.extensions"in t.result&&(this.extensions=Array.from(t.result["tbsCertificate.extensions"],(e=>new Po({schema:e})))),this.signatureAlgorithm=new Ai({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}encodeTBS(){const e=[];return"version"in this&&this.version!==Mo.defaultValues("version")&&e.push(new An({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new jn({value:this.version})]})),e.push(this.serialNumber),e.push(this.signature.toSchema()),e.push(this.issuer.toSchema()),e.push(new Kn({value:[this.notBefore.toSchema(),this.notAfter.toSchema()]})),e.push(this.subject.toSchema()),e.push(this.subjectPublicKeyInfo.toSchema()),"issuerUniqueID"in this&&e.push(new Sn({optional:!0,idBlock:{tagClass:3,tagNumber:1},valueHex:this.issuerUniqueID})),"subjectUniqueID"in this&&e.push(new Sn({optional:!0,idBlock:{tagClass:3,tagNumber:2},valueHex:this.subjectUniqueID})),"extensions"in this&&e.push(new An({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[new Kn({value:Array.from(this.extensions,(e=>e.toSchema()))})]})),new Kn({value:e})}toSchema(e=!1){let t={};if(!1===e){if(0===this.tbs.length)return Mo.schema().value[0];t=Tn(this.tbs).result}else t=this.encodeTBS();return new Kn({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){const e={tbs:we(this.tbs,0,this.tbs.byteLength),serialNumber:this.serialNumber.toJSON(),signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),notBefore:this.notBefore.toJSON(),notAfter:this.notAfter.toJSON(),subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return"version"in this&&this.version!==Mo.defaultValues("version")&&(e.version=this.version),"issuerUniqueID"in this&&(e.issuerUniqueID=we(this.issuerUniqueID,0,this.issuerUniqueID.byteLength)),"subjectUniqueID"in this&&(e.subjectUniqueID=we(this.subjectUniqueID,0,this.subjectUniqueID.byteLength)),"extensions"in this&&(e.extensions=Array.from(this.extensions,(e=>e.toJSON()))),e}getPublicKey(e=null){return $i().subtle.getPublicKey(this.subjectPublicKeyInfo,this.signatureAlgorithm,e)}getKeyHash(e="SHA-1"){const t=Zi();return void 0===t?Promise.reject("Unable to create WebCrypto object"):t.digest({name:e},new Uint8Array(this.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHex))}sign(e,t="SHA-1"){if(void 0===e)return Promise.reject("Need to provide a private key for signing");let r,n=Promise.resolve();const i=$i();return n=n.then((()=>i.subtle.getSignatureParameters(e,t))),n=n.then((e=>{r=e.parameters,this.signature=e.signatureAlgorithm,this.signatureAlgorithm=e.signatureAlgorithm})),n=n.then((()=>{this.tbs=this.encodeTBS().toBER(!1)})),n=n.then((()=>i.subtle.signWithPrivateKey(this.tbs,e,r))),n=n.then((e=>{this.signatureValue=new Dn({valueHex:e})})),n}verify(e=null){let t={};return null!==e?t=e.subjectPublicKeyInfo:this.issuer.isEqual(this.subject)&&(t=this.subjectPublicKeyInfo),t instanceof ki==!1?Promise.reject("Please provide issuer certificate as a parameter"):$i().subtle.verifyWithPublicKey(this.tbs,this.signatureValue,t,this.signatureAlgorithm)}}class Uo{constructor(e={}){this.notBeforeTime=Ee(e,"notBeforeTime",Uo.defaultValues("notBeforeTime")),this.notAfterTime=Ee(e,"notAfterTime",Uo.defaultValues("notAfterTime")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"notBeforeTime":case"notAfterTime":return new Date(0,0,0);default:throw new Error(`Invalid member name for AttCertValidityPeriod class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new mi({name:t.notBeforeTime||""}),new mi({name:t.notAfterTime||""})]})}fromSchema(e){Fe(e,["notBeforeTime","notAfterTime"]);const t=xi(e,e,Uo.schema({names:{notBeforeTime:"notBeforeTime",notAfterTime:"notAfterTime"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for AttCertValidityPeriod");this.notBeforeTime=t.result.notBeforeTime.toDate(),this.notAfterTime=t.result.notAfterTime.toDate()}toSchema(){return new Kn({value:[new mi({valueDate:this.notBeforeTime}),new mi({valueDate:this.notAfterTime})]})}toJSON(){return{notBeforeTime:this.notBeforeTime,notAfterTime:this.notAfterTime}}}class Bo{constructor(e={}){this.issuer=Ee(e,"issuer",Bo.defaultValues("issuer")),this.serialNumber=Ee(e,"serialNumber",Bo.defaultValues("serialNumber")),"issuerUID"in e&&(this.issuerUID=Ee(e,"issuerUID",Bo.defaultValues("issuerUID"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"issuer":return new lo;case"serialNumber":return new jn;case"issuerUID":return new Dn;default:throw new Error(`Invalid member name for IssuerSerial class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[lo.schema(t.issuer||{}),new jn({name:t.serialNumber||""}),new Dn({optional:!0,name:t.issuerUID||""})]})}fromSchema(e){Fe(e,["issuer","serialNumber","issuerUID"]);const t=xi(e,e,Bo.schema({names:{issuer:{names:{blockName:"issuer"}},serialNumber:"serialNumber",issuerUID:"issuerUID"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for IssuerSerial");this.issuer=new lo({schema:t.result.issuer}),this.serialNumber=t.result.serialNumber,"issuerUID"in t.result&&(this.issuerUID=t.result.issuerUID)}toSchema(){const e=new Kn({value:[this.issuer.toSchema(),this.serialNumber]});return"issuerUID"in this&&e.valueBlock.value.push(this.issuerUID),e}toJSON(){const e={issuer:this.issuer.toJSON(),serialNumber:this.serialNumber.toJSON()};return"issuerUID"in this&&(e.issuerUID=this.issuerUID.toJSON()),e}}class Fo{constructor(e={}){this.version=Ee(e,"version",Fo.defaultValues("version")),"baseCertificateID"in e&&(this.baseCertificateID=Ee(e,"baseCertificateID",Fo.defaultValues("baseCertificateID"))),"subjectName"in e&&(this.subjectName=Ee(e,"subjectName",Fo.defaultValues("subjectName"))),this.issuer=Ee(e,"issuer",Fo.defaultValues("issuer")),this.signature=Ee(e,"signature",Fo.defaultValues("signature")),this.serialNumber=Ee(e,"serialNumber",Fo.defaultValues("serialNumber")),this.attrCertValidityPeriod=Ee(e,"attrCertValidityPeriod",Fo.defaultValues("attrCertValidityPeriod")),this.attributes=Ee(e,"attributes",Fo.defaultValues("attributes")),"issuerUniqueID"in e&&(this.issuerUniqueID=Ee(e,"issuerUniqueID",Fo.defaultValues("issuerUniqueID"))),"extensions"in e&&(this.extensions=Ee(e,"extensions",Fo.defaultValues("extensions"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"version":return 0;case"baseCertificateID":return new Bo;case"subjectName":return new lo;case"issuer":return{};case"signature":return new Ai;case"serialNumber":return new jn;case"attrCertValidityPeriod":return new Uo;case"attributes":return[];case"issuerUniqueID":return new Dn;case"extensions":return new Lo;default:throw new Error(`Invalid member name for AttributeCertificateInfoV1 class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new jn({name:t.version||""}),new Si({value:[new An({name:t.baseCertificateID||"",idBlock:{tagClass:3,tagNumber:0},value:Bo.schema().valueBlock.value}),new An({name:t.subjectName||"",idBlock:{tagClass:3,tagNumber:1},value:lo.schema().valueBlock.value})]}),lo.schema({names:{blockName:t.issuer||""}}),Ai.schema(t.signature||{}),new jn({name:t.serialNumber||""}),Uo.schema(t.attrCertValidityPeriod||{}),new Kn({name:t.attributes||"",value:[new _i({value:Oi.schema()})]}),new Dn({optional:!0,name:t.issuerUniqueID||""}),Lo.schema(t.extensions||{},!0)]})}fromSchema(e){Fe(e,["version","baseCertificateID","subjectName","issuer","signature","serialNumber","attrCertValidityPeriod","attributes","issuerUniqueID","extensions"]);const t=xi(e,e,Fo.schema({names:{version:"version",baseCertificateID:"baseCertificateID",subjectName:"subjectName",issuer:"issuer",signature:{names:{blockName:"signature"}},serialNumber:"serialNumber",attrCertValidityPeriod:{names:{blockName:"attrCertValidityPeriod"}},attributes:"attributes",issuerUniqueID:"issuerUniqueID",extensions:{names:{blockName:"extensions"}}}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for AttributeCertificateInfoV1");this.version=t.result.version.valueBlock.valueDec,"baseCertificateID"in t.result&&(this.baseCertificateID=new Bo({schema:new Kn({value:t.result.baseCertificateID.valueBlock.value})})),"subjectName"in t.result&&(this.subjectName=new lo({schema:new Kn({value:t.result.subjectName.valueBlock.value})})),this.issuer=t.result.issuer,this.signature=new Ai({schema:t.result.signature}),this.serialNumber=t.result.serialNumber,this.attrCertValidityPeriod=new Uo({schema:t.result.attrCertValidityPeriod}),this.attributes=Array.from(t.result.attributes.valueBlock.value,(e=>new Oi({schema:e}))),"issuerUniqueID"in t.result&&(this.issuerUniqueID=t.result.issuerUniqueID),"extensions"in t.result&&(this.extensions=new Lo({schema:t.result.extensions}))}toSchema(){const e=new Kn({value:[new jn({value:this.version})]});return"baseCertificateID"in this&&e.valueBlock.value.push(new An({idBlock:{tagClass:3,tagNumber:0},value:this.baseCertificateID.toSchema().valueBlock.value})),"subjectName"in this&&e.valueBlock.value.push(new An({idBlock:{tagClass:3,tagNumber:1},value:this.subjectName.toSchema().valueBlock.value})),e.valueBlock.value.push(this.issuer.toSchema()),e.valueBlock.value.push(this.signature.toSchema()),e.valueBlock.value.push(this.serialNumber),e.valueBlock.value.push(this.attrCertValidityPeriod.toSchema()),e.valueBlock.value.push(new Kn({value:Array.from(this.attributes,(e=>e.toSchema()))})),"issuerUniqueID"in this&&e.valueBlock.value.push(this.issuerUniqueID),"extensions"in this&&e.valueBlock.value.push(this.extensions.toSchema()),e}toJSON(){const e={version:this.version};return"baseCertificateID"in this&&(e.baseCertificateID=this.baseCertificateID.toJSON()),"subjectName"in this&&(e.subjectName=this.subjectName.toJSON()),e.issuer=this.issuer.toJSON(),e.signature=this.signature.toJSON(),e.serialNumber=this.serialNumber.toJSON(),e.attrCertValidityPeriod=this.attrCertValidityPeriod.toJSON(),e.attributes=Array.from(this.attributes,(e=>e.toJSON())),"issuerUniqueID"in this&&(e.issuerUniqueID=this.issuerUniqueID.toJSON()),"extensions"in this&&(e.extensions=this.extensions.toJSON()),e}}class jo{constructor(e={}){this.acinfo=Ee(e,"acinfo",jo.defaultValues("acinfo")),this.signatureAlgorithm=Ee(e,"signatureAlgorithm",jo.defaultValues("signatureAlgorithm")),this.signatureValue=Ee(e,"signatureValue",jo.defaultValues("signatureValue")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"acinfo":return new Fo;case"signatureAlgorithm":return new Ai;case"signatureValue":return new Dn;default:throw new Error(`Invalid member name for AttributeCertificateV1 class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[Fo.schema(t.acinfo||{}),Ai.schema(t.signatureAlgorithm||{}),new Dn({name:t.signatureValue||""})]})}fromSchema(e){Fe(e,["acinfo","signatureValue","signatureAlgorithm"]);const t=xi(e,e,jo.schema({names:{acinfo:{names:{blockName:"acinfo"}},signatureAlgorithm:{names:{blockName:"signatureAlgorithm"}},signatureValue:"signatureValue"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for AttributeCertificateV1");this.acinfo=new Fo({schema:t.result.acinfo}),this.signatureAlgorithm=new Ai({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}toSchema(){return new Kn({value:[this.acinfo.toSchema(),this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){return{acinfo:this.acinfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()}}}class Vo{constructor(e={}){this.digestedObjectType=Ee(e,"digestedObjectType",Vo.defaultValues("digestedObjectType")),"otherObjectTypeID"in e&&(this.otherObjectTypeID=Ee(e,"otherObjectTypeID",Vo.defaultValues("otherObjectTypeID"))),this.digestAlgorithm=Ee(e,"digestAlgorithm",Vo.defaultValues("digestAlgorithm")),this.objectDigest=Ee(e,"objectDigest",Vo.defaultValues("objectDigest")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"digestedObjectType":return new Vn;case"otherObjectTypeID":return new qn;case"digestAlgorithm":return new Ai;case"objectDigest":return new Dn;default:throw new Error(`Invalid member name for ObjectDigestInfo class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new Vn({name:t.digestedObjectType||""}),new qn({optional:!0,name:t.otherObjectTypeID||""}),Ai.schema(t.digestAlgorithm||{}),new Dn({name:t.objectDigest||""})]})}fromSchema(e){Fe(e,["digestedObjectType","otherObjectTypeID","digestAlgorithm","objectDigest"]);const t=xi(e,e,Vo.schema({names:{digestedObjectType:"digestedObjectType",otherObjectTypeID:"otherObjectTypeID",digestAlgorithm:{names:{blockName:"digestAlgorithm"}},objectDigest:"objectDigest"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for ObjectDigestInfo");this.digestedObjectType=t.result.digestedObjectType,"otherObjectTypeID"in t.result&&(this.otherObjectTypeID=t.result.otherObjectTypeID),this.digestAlgorithm=new Ai({schema:t.result.digestAlgorithm}),this.objectDigest=t.result.objectDigest}toSchema(){const e=new Kn({value:[this.digestedObjectType]});return"otherObjectTypeID"in this&&e.valueBlock.value.push(this.otherObjectTypeID),e.valueBlock.value.push(this.digestAlgorithm.toSchema()),e.valueBlock.value.push(this.objectDigest),e}toJSON(){const e={digestedObjectType:this.digestedObjectType.toJSON()};return"otherObjectTypeID"in this&&(e.otherObjectTypeID=this.otherObjectTypeID.toJSON()),e.digestAlgorithm=this.digestAlgorithm.toJSON(),e.objectDigest=this.objectDigest.toJSON(),e}}class Ho{constructor(e={}){"issuerName"in e&&(this.issuerName=Ee(e,"issuerName",Ho.defaultValues("issuerName"))),"baseCertificateID"in e&&(this.baseCertificateID=Ee(e,"baseCertificateID",Ho.defaultValues("baseCertificateID"))),"objectDigestInfo"in e&&(this.objectDigestInfo=Ee(e,"objectDigestInfo",Ho.defaultValues("objectDigestInfo"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"issuerName":return new lo;case"baseCertificateID":return new Bo;case"objectDigestInfo":return new Vo;default:throw new Error(`Invalid member name for V2Form class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[lo.schema({names:{blockName:t.issuerName}},!0),new An({optional:!0,name:t.baseCertificateID||"",idBlock:{tagClass:3,tagNumber:0},value:Bo.schema().valueBlock.value}),new An({optional:!0,name:t.objectDigestInfo||"",idBlock:{tagClass:3,tagNumber:1},value:Vo.schema().valueBlock.value})]})}fromSchema(e){Fe(e,["issuerName","baseCertificateID","objectDigestInfo"]);const t=xi(e,e,Ho.schema({names:{issuerName:"issuerName",baseCertificateID:"baseCertificateID",objectDigestInfo:"objectDigestInfo"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for V2Form");"issuerName"in t.result&&(this.issuerName=new lo({schema:t.result.issuerName})),"baseCertificateID"in t.result&&(this.baseCertificateID=new Bo({schema:new Kn({value:t.result.baseCertificateID.valueBlock.value})})),"objectDigestInfo"in t.result&&(this.objectDigestInfo=new Vo({schema:new Kn({value:t.result.objectDigestInfo.valueBlock.value})}))}toSchema(){const e=new Kn;return"issuerName"in this&&e.valueBlock.value.push(this.issuerName.toSchema()),"baseCertificateID"in this&&e.valueBlock.value.push(new An({idBlock:{tagClass:3,tagNumber:0},value:this.baseCertificateID.toSchema().valueBlock.value})),"objectDigestInfo"in this&&e.valueBlock.value.push(new An({idBlock:{tagClass:3,tagNumber:1},value:this.objectDigestInfo.toSchema().valueBlock.value})),e}toJSON(){const e={};return"issuerName"in this&&(e.issuerName=this.issuerName.toJSON()),"baseCertificateID"in this&&(e.baseCertificateID=this.baseCertificateID.toJSON()),"objectDigestInfo"in this&&(e.objectDigestInfo=this.objectDigestInfo.toJSON()),e}}class Go{constructor(e={}){"baseCertificateID"in e&&(this.baseCertificateID=Ee(e,"baseCertificateID",Go.defaultValues("baseCertificateID"))),"entityName"in e&&(this.entityName=Ee(e,"entityName",Go.defaultValues("entityName"))),"objectDigestInfo"in e&&(this.objectDigestInfo=Ee(e,"objectDigestInfo",Go.defaultValues("objectDigestInfo"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"baseCertificateID":return new Bo;case"entityName":return new lo;case"objectDigestInfo":return new Vo;default:throw new Error(`Invalid member name for Holder class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new An({optional:!0,name:t.baseCertificateID||"",idBlock:{tagClass:3,tagNumber:0},value:Bo.schema().valueBlock.value}),new An({optional:!0,name:t.entityName||"",idBlock:{tagClass:3,tagNumber:1},value:lo.schema().valueBlock.value}),new An({optional:!0,name:t.objectDigestInfo||"",idBlock:{tagClass:3,tagNumber:2},value:Vo.schema().valueBlock.value})]})}fromSchema(e){Fe(e,["baseCertificateID","entityName","objectDigestInfo"]);const t=xi(e,e,Go.schema({names:{baseCertificateID:"baseCertificateID",entityName:"entityName",objectDigestInfo:"objectDigestInfo"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for Holder");"baseCertificateID"in t.result&&(this.baseCertificateID=new Bo({schema:new Kn({value:t.result.baseCertificateID.valueBlock.value})})),"entityName"in t.result&&(this.entityName=new lo({schema:new Kn({value:t.result.entityName.valueBlock.value})})),"objectDigestInfo"in t.result&&(this.objectDigestInfo=new Vo({schema:new Kn({value:t.result.objectDigestInfo.valueBlock.value})}))}toSchema(){const e=new Kn;return"baseCertificateID"in this&&e.valueBlock.value.push(new An({idBlock:{tagClass:3,tagNumber:0},value:this.baseCertificateID.toSchema().valueBlock.value})),"entityName"in this&&e.valueBlock.value.push(new An({idBlock:{tagClass:3,tagNumber:1},value:this.entityName.toSchema().valueBlock.value})),"objectDigestInfo"in this&&e.valueBlock.value.push(new An({idBlock:{tagClass:3,tagNumber:2},value:this.objectDigestInfo.toSchema().valueBlock.value})),e}toJSON(){const e={};return"baseCertificateID"in this&&(e.baseCertificateID=this.baseCertificateID.toJSON()),"entityName"in this&&(e.entityName=this.entityName.toJSON()),"objectDigestInfo"in this&&(e.objectDigestInfo=this.objectDigestInfo.toJSON()),e}}class qo{constructor(e={}){this.version=Ee(e,"version",qo.defaultValues("version")),this.holder=Ee(e,"holder",qo.defaultValues("holder")),this.issuer=Ee(e,"issuer",qo.defaultValues("issuer")),this.signature=Ee(e,"signature",qo.defaultValues("signature")),this.serialNumber=Ee(e,"serialNumber",qo.defaultValues("serialNumber")),this.attrCertValidityPeriod=Ee(e,"attrCertValidityPeriod",qo.defaultValues("attrCertValidityPeriod")),this.attributes=Ee(e,"attributes",qo.defaultValues("attributes")),"issuerUniqueID"in e&&(this.issuerUniqueID=Ee(e,"issuerUniqueID",qo.defaultValues("issuerUniqueID"))),"extensions"in e&&(this.extensions=Ee(e,"extensions",qo.defaultValues("extensions"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"version":return 1;case"holder":return new Go;case"issuer":return{};case"signature":return new Ai;case"serialNumber":return new jn;case"attrCertValidityPeriod":return new Uo;case"attributes":return[];case"issuerUniqueID":return new Dn;case"extensions":return new Lo;default:throw new Error(`Invalid member name for AttributeCertificateInfoV2 class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new jn({name:t.version||""}),Go.schema(t.holder||{}),new Si({value:[lo.schema({names:{blockName:t.issuer||""}}),new An({name:t.issuer||"",idBlock:{tagClass:3,tagNumber:0},value:Ho.schema().valueBlock.value})]}),Ai.schema(t.signature||{}),new jn({name:t.serialNumber||""}),Uo.schema(t.attrCertValidityPeriod||{}),new Kn({name:t.attributes||"",value:[new _i({value:Oi.schema()})]}),new Dn({optional:!0,name:t.issuerUniqueID||""}),Lo.schema(t.extensions||{},!0)]})}fromSchema(e){Fe(e,["version","holder","issuer","signature","serialNumber","attrCertValidityPeriod","attributes","issuerUniqueID","extensions"]);const t=xi(e,e,qo.schema({names:{version:"version",holder:{names:{blockName:"holder"}},issuer:"issuer",signature:{names:{blockName:"signature"}},serialNumber:"serialNumber",attrCertValidityPeriod:{names:{blockName:"attrCertValidityPeriod"}},attributes:"attributes",issuerUniqueID:"issuerUniqueID",extensions:{names:{blockName:"extensions"}}}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for AttributeCertificateInfoV2");if(this.version=t.result.version.valueBlock.valueDec,this.holder=new Go({schema:t.result.holder}),3!==t.result.issuer.idBlock.tagClass)throw new Error("Incorect value for 'issuer' in AttributeCertificateInfoV2");this.issuer=new Ho({schema:new Kn({value:t.result.issuer.valueBlock.value})}),this.signature=new Ai({schema:t.result.signature}),this.serialNumber=t.result.serialNumber,this.attrCertValidityPeriod=new Uo({schema:t.result.attrCertValidityPeriod}),this.attributes=Array.from(t.result.attributes.valueBlock.value,(e=>new Oi({schema:e}))),"issuerUniqueID"in t.result&&(this.issuerUniqueID=t.result.issuerUniqueID),"extensions"in t.result&&(this.extensions=new Lo({schema:t.result.extensions}))}toSchema(){const e=new Kn({value:[new jn({value:this.version}),this.holder.toSchema(),new An({idBlock:{tagClass:3,tagNumber:0},value:this.issuer.toSchema().valueBlock.value}),this.signature.toSchema(),this.serialNumber,this.attrCertValidityPeriod.toSchema(),new Kn({value:Array.from(this.attributes,(e=>e.toSchema()))})]});return"issuerUniqueID"in this&&e.valueBlock.value.push(this.issuerUniqueID),"extensions"in this&&e.valueBlock.value.push(this.extensions.toSchema()),e}toJSON(){const e={version:this.version,holder:this.holder.toJSON(),issuer:this.issuer.toJSON(),signature:this.signature.toJSON(),serialNumber:this.serialNumber.toJSON(),attrCertValidityPeriod:this.attrCertValidityPeriod.toJSON(),attributes:Array.from(this.attributes,(e=>e.toJSON()))};return"issuerUniqueID"in this&&(e.issuerUniqueID=this.issuerUniqueID.toJSON()),"extensions"in this&&(e.extensions=this.extensions.toJSON()),e}}class $o{constructor(e={}){this.acinfo=Ee(e,"acinfo",$o.defaultValues("acinfo")),this.signatureAlgorithm=Ee(e,"signatureAlgorithm",$o.defaultValues("signatureAlgorithm")),this.signatureValue=Ee(e,"signatureValue",$o.defaultValues("signatureValue")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"acinfo":return new qo;case"signatureAlgorithm":return new Ai;case"signatureValue":return new Dn;default:throw new Error(`Invalid member name for AttributeCertificateV2 class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[qo.schema(t.acinfo||{}),Ai.schema(t.signatureAlgorithm||{}),new Dn({name:t.signatureValue||""})]})}fromSchema(e){Fe(e,["acinfo","signatureAlgorithm","signatureValue"]);const t=xi(e,e,$o.schema({names:{acinfo:{names:{blockName:"acinfo"}},signatureAlgorithm:{names:{blockName:"signatureAlgorithm"}},signatureValue:"signatureValue"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for AttributeCertificateV2");this.acinfo=new qo({schema:t.result.acinfo}),this.signatureAlgorithm=new Ai({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}toSchema(){return new Kn({value:[this.acinfo.toSchema(),this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){return{acinfo:this.acinfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()}}}class Zo{constructor(e={}){this.userCertificate=Ee(e,"userCertificate",Zo.defaultValues("userCertificate")),this.revocationDate=Ee(e,"revocationDate",Zo.defaultValues("revocationDate")),"crlEntryExtensions"in e&&(this.crlEntryExtensions=Ee(e,"crlEntryExtensions",Zo.defaultValues("crlEntryExtensions"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"userCertificate":return new jn;case"revocationDate":return new oo;case"crlEntryExtensions":return new Lo;default:throw new Error(`Invalid member name for RevokedCertificate class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new jn({name:t.userCertificate||"userCertificate"}),oo.schema({names:{utcTimeName:t.revocationDate||"revocationDate",generalTimeName:t.revocationDate||"revocationDate"}}),Lo.schema({names:{blockName:t.crlEntryExtensions||"crlEntryExtensions"}},!0)]})}fromSchema(e){Fe(e,["userCertificate","revocationDate","crlEntryExtensions"]);const t=xi(e,e,Zo.schema());if(!1===t.verified)throw new Error("Object's schema was not verified against input data for RevokedCertificate");this.userCertificate=t.result.userCertificate,this.revocationDate=new oo({schema:t.result.revocationDate}),"crlEntryExtensions"in t.result&&(this.crlEntryExtensions=new Lo({schema:t.result.crlEntryExtensions}))}toSchema(){const e=[this.userCertificate,this.revocationDate.toSchema()];return"crlEntryExtensions"in this&&e.push(this.crlEntryExtensions.toSchema()),new Kn({value:e})}toJSON(){const e={userCertificate:this.userCertificate.toJSON(),revocationDate:this.revocationDate.toJSON};return"crlEntryExtensions"in this&&(e.crlEntryExtensions=this.crlEntryExtensions.toJSON()),e}}function zo(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"tbsCertList",value:[new jn({optional:!0,name:t.tbsCertListVersion||"tbsCertList.version",value:2}),Ai.schema(t.signature||{names:{blockName:"tbsCertList.signature"}}),Yi.schema(t.issuer||{names:{blockName:"tbsCertList.issuer"}}),oo.schema(t.tbsCertListThisUpdate||{names:{utcTimeName:"tbsCertList.thisUpdate",generalTimeName:"tbsCertList.thisUpdate"}}),oo.schema(t.tbsCertListNextUpdate||{names:{utcTimeName:"tbsCertList.nextUpdate",generalTimeName:"tbsCertList.nextUpdate"}},!0),new Kn({optional:!0,value:[new _i({name:t.tbsCertListRevokedCertificates||"tbsCertList.revokedCertificates",value:new Kn({value:[new jn,oo.schema(),Lo.schema({},!0)]})})]}),new An({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[Lo.schema(t.crlExtensions||{names:{blockName:"tbsCertList.extensions"}})]})]})}class Ko{constructor(e={}){this.tbs=Ee(e,"tbs",Ko.defaultValues("tbs")),this.version=Ee(e,"version",Ko.defaultValues("version")),this.signature=Ee(e,"signature",Ko.defaultValues("signature")),this.issuer=Ee(e,"issuer",Ko.defaultValues("issuer")),this.thisUpdate=Ee(e,"thisUpdate",Ko.defaultValues("thisUpdate")),"nextUpdate"in e&&(this.nextUpdate=Ee(e,"nextUpdate",Ko.defaultValues("nextUpdate"))),"revokedCertificates"in e&&(this.revokedCertificates=Ee(e,"revokedCertificates",Ko.defaultValues("revokedCertificates"))),"crlExtensions"in e&&(this.crlExtensions=Ee(e,"crlExtensions",Ko.defaultValues("crlExtensions"))),this.signatureAlgorithm=Ee(e,"signatureAlgorithm",Ko.defaultValues("signatureAlgorithm")),this.signatureValue=Ee(e,"signatureValue",Ko.defaultValues("signatureValue")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"tbs":return new ArrayBuffer(0);case"version":return 1;case"signature":case"signatureAlgorithm":return new Ai;case"issuer":return new Yi;case"thisUpdate":case"nextUpdate":return new oo;case"revokedCertificates":return[];case"crlExtensions":return new Lo;case"signatureValue":return new Dn;default:throw new Error(`Invalid member name for CertificateRevocationList class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"CertificateList",value:[zo(e),Ai.schema(t.signatureAlgorithm||{names:{blockName:"signatureAlgorithm"}}),new Dn({name:t.signatureValue||"signatureValue"})]})}fromSchema(e){Fe(e,["tbsCertList","tbsCertList.version","tbsCertList.signature","tbsCertList.issuer","tbsCertList.thisUpdate","tbsCertList.nextUpdate","tbsCertList.revokedCertificates","tbsCertList.extensions","signatureAlgorithm","signatureValue"]);const t=xi(e,e,Ko.schema());if(!1===t.verified)throw new Error("Object's schema was not verified against input data for CertificateRevocationList");this.tbs=t.result.tbsCertList.valueBeforeDecode,"tbsCertList.version"in t.result&&(this.version=t.result["tbsCertList.version"].valueBlock.valueDec),this.signature=new Ai({schema:t.result["tbsCertList.signature"]}),this.issuer=new Yi({schema:t.result["tbsCertList.issuer"]}),this.thisUpdate=new oo({schema:t.result["tbsCertList.thisUpdate"]}),"tbsCertList.nextUpdate"in t.result&&(this.nextUpdate=new oo({schema:t.result["tbsCertList.nextUpdate"]})),"tbsCertList.revokedCertificates"in t.result&&(this.revokedCertificates=Array.from(t.result["tbsCertList.revokedCertificates"],(e=>new Zo({schema:e})))),"tbsCertList.extensions"in t.result&&(this.crlExtensions=new Lo({schema:t.result["tbsCertList.extensions"]})),this.signatureAlgorithm=new Ai({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}encodeTBS(){const e=[];return this.version!==Ko.defaultValues("version")&&e.push(new jn({value:this.version})),e.push(this.signature.toSchema()),e.push(this.issuer.toSchema()),e.push(this.thisUpdate.toSchema()),"nextUpdate"in this&&e.push(this.nextUpdate.toSchema()),"revokedCertificates"in this&&e.push(new Kn({value:Array.from(this.revokedCertificates,(e=>e.toSchema()))})),"crlExtensions"in this&&e.push(new An({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.crlExtensions.toSchema()]})),new Kn({value:e})}toSchema(e=!1){let t;if(!1===e){if(0===this.tbs.length)return Ko.schema();t=Tn(this.tbs).result}else t=this.encodeTBS();return new Kn({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){const e={tbs:we(this.tbs,0,this.tbs.byteLength),signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),thisUpdate:this.thisUpdate.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return this.version!==Ko.defaultValues("version")&&(e.version=this.version),"nextUpdate"in this&&(e.nextUpdate=this.nextUpdate.toJSON()),"revokedCertificates"in this&&(e.revokedCertificates=Array.from(this.revokedCertificates,(e=>e.toJSON()))),"crlExtensions"in this&&(e.crlExtensions=this.crlExtensions.toJSON()),e}isCertificateRevoked(e){if(!1===this.issuer.isEqual(e.issuer))return!1;if("revokedCertificates"in this==!1)return!1;for(const t of this.revokedCertificates)if(t.userCertificate.isEqual(e.serialNumber))return!0;return!1}sign(e,t="SHA-1"){if(void 0===e)return Promise.reject("Need to provide a private key for signing");let r,n=Promise.resolve();const i=$i();return n=n.then((()=>i.subtle.getSignatureParameters(e,t))),n=n.then((e=>{r=e.parameters,this.signature=e.signatureAlgorithm,this.signatureAlgorithm=e.signatureAlgorithm})),n=n.then((()=>{this.tbs=this.encodeTBS().toBER(!1)})),n=n.then((()=>i.subtle.signWithPrivateKey(this.tbs,e,r))),n=n.then((e=>{this.signatureValue=new Dn({valueHex:e})})),n}verify(e={}){let t=Promise.resolve(),r=-1;const n=$i();if("issuerCertificate"in e&&(r=e.issuerCertificate.subjectPublicKeyInfo,!1===this.issuer.isEqual(e.issuerCertificate.subject)))return Promise.resolve(!1);if("publicKeyInfo"in e&&(r=e.publicKeyInfo),"subjectPublicKey"in r==!1)return Promise.reject("Issuer's certificate must be provided as an input parameter");if("crlExtensions"in this)for(const e of this.crlExtensions.extensions)if(e.critical&&"parsedValue"in e==!1)return Promise.resolve(!1);return t=t.then((()=>n.subtle.verifyWithPublicKey(this.tbs,this.signatureValue,r,this.signatureAlgorithm))),t}}class Wo{constructor(e={}){this.otherCertFormat=Ee(e,"otherCertFormat",Wo.defaultValues("otherCertFormat")),this.otherCert=Ee(e,"otherCert",Wo.defaultValues("otherCert")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"otherCertFormat":return"";case"otherCert":return new wi;default:throw new Error(`Invalid member name for OtherCertificateFormat class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new qn({name:t.otherCertFormat||"otherCertFormat"}),new wi({name:t.otherCert||"otherCert"})]})}fromSchema(e){Fe(e,["otherCertFormat","otherCert"]);const t=xi(e,e,Wo.schema());if(!1===t.verified)throw new Error("Object's schema was not verified against input data for OtherCertificateFormat");this.otherCertFormat=t.result.otherCertFormat.valueBlock.toString(),this.otherCert=t.result.otherCert}toSchema(){return new Kn({value:[new qn({value:this.otherCertFormat}),this.otherCert]})}toJSON(){const e={otherCertFormat:this.otherCertFormat};return this.otherCert instanceof wi||(e.otherCert=this.otherCert.toJSON()),e}}class Jo{constructor(e={}){this.certificates=Ee(e,"certificates",Jo.defaultValues("certificates")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){if("certificates"===e)return[];throw new Error(`Invalid member name for Attribute class: ${e}`)}static schema(e={}){const t=Ee(e,"names",{});return new Wn({name:t.blockName||"",value:[new _i({name:t.certificates||"certificates",value:new Si({value:[Mo.schema(),new An({idBlock:{tagClass:3,tagNumber:0},value:[new wi]}),new An({idBlock:{tagClass:3,tagNumber:1},value:[new Kn]}),new An({idBlock:{tagClass:3,tagNumber:2},value:$o.schema().valueBlock.value}),new An({idBlock:{tagClass:3,tagNumber:3},value:Wo.schema().valueBlock.value})]})})]})}fromSchema(e){Fe(e,["certificates"]);const t=xi(e,e,Jo.schema());if(!1===t.verified)throw new Error("Object's schema was not verified against input data for CertificateSet");this.certificates=Array.from(t.result.certificates||[],(e=>{const t=e.idBlock.tagNumber;if(1===e.idBlock.tagClass)return new Mo({schema:e});const r=new Kn({value:e.valueBlock.value});switch(t){case 1:return 1===r.valueBlock.value[0].valueBlock.value[0].valueBlock.valueDec?new $o({schema:r}):new jo({schema:r});case 2:return new $o({schema:r});case 3:return new Wo({schema:r})}return e}))}toSchema(){return new Wn({value:Array.from(this.certificates,(e=>{switch(!0){case e instanceof Mo:return e.toSchema();case e instanceof jo:return new An({idBlock:{tagClass:3,tagNumber:1},value:e.toSchema().valueBlock.value});case e instanceof $o:return new An({idBlock:{tagClass:3,tagNumber:2},value:e.toSchema().valueBlock.value});case e instanceof Wo:return new An({idBlock:{tagClass:3,tagNumber:3},value:e.toSchema().valueBlock.value})}return e}))})}toJSON(){return{certificates:Array.from(this.certificates,(e=>e.toJSON()))}}}class Yo{constructor(e={}){this.otherRevInfoFormat=Ee(e,"otherRevInfoFormat",Yo.defaultValues("otherRevInfoFormat")),this.otherRevInfo=Ee(e,"otherRevInfo",Yo.defaultValues("otherRevInfo")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"otherRevInfoFormat":return"";case"otherRevInfo":return new wi;default:throw new Error(`Invalid member name for OtherRevocationInfoFormat class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new qn({name:t.otherRevInfoFormat||"otherRevInfoFormat"}),new wi({name:t.otherRevInfo||"otherRevInfo"})]})}fromSchema(e){Fe(e,["otherRevInfoFormat","otherRevInfo"]);const t=xi(e,e,Yo.schema());if(!1===t.verified)throw new Error("Object's schema was not verified against input data for OtherRevocationInfoFormat");this.otherRevInfoFormat=t.result.otherRevInfoFormat.valueBlock.toString(),this.otherRevInfo=t.result.otherRevInfo}toSchema(){return new Kn({value:[new qn({value:this.otherRevInfoFormat}),this.otherRevInfo]})}toJSON(){const e={otherRevInfoFormat:this.otherRevInfoFormat};return this.otherRevInfo instanceof wi||(e.otherRevInfo=this.otherRevInfo.toJSON()),e}}class Qo{constructor(e={}){this.crls=Ee(e,"crls",Qo.defaultValues("crls")),this.otherRevocationInfos=Ee(e,"otherRevocationInfos",Qo.defaultValues("otherRevocationInfos")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"crls":case"otherRevocationInfos":return[];default:throw new Error(`Invalid member name for RevocationInfoChoices class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Wn({name:t.blockName||"",value:[new _i({name:t.crls||"",value:new Si({value:[Ko.schema(),new An({idBlock:{tagClass:3,tagNumber:1},value:[new qn,new wi]})]})})]})}fromSchema(e){Fe(e,["crls"]);const t=xi(e,e,Qo.schema({names:{crls:"crls"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for RevocationInfoChoices");for(const e of t.result.crls)1===e.idBlock.tagClass?this.crls.push(new Ko({schema:e})):this.otherRevocationInfos.push(new Yo({schema:e}))}toSchema(){const e=[];return e.push(...Array.from(this.crls,(e=>e.toSchema()))),e.push(...Array.from(this.otherRevocationInfos,(e=>{const t=e.toSchema();return t.idBlock.tagClass=3,t.idBlock.tagNumber=1,t}))),new Wn({value:e})}toJSON(){return{crls:Array.from(this.crls,(e=>e.toJSON())),otherRevocationInfos:Array.from(this.otherRevocationInfos,(e=>e.toJSON()))}}}class Xo{constructor(e={}){this.issuer=Ee(e,"issuer",Xo.defaultValues("issuer")),this.serialNumber=Ee(e,"serialNumber",Xo.defaultValues("serialNumber")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"issuer":return new Yi;case"serialNumber":return new jn;default:throw new Error(`Invalid member name for IssuerAndSerialNumber class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[Yi.schema(t.issuer||{}),new jn({name:t.serialNumber||""})]})}fromSchema(e){Fe(e,["issuer","serialNumber"]);const t=xi(e,e,Xo.schema({names:{issuer:{names:{blockName:"issuer"}},serialNumber:"serialNumber"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for IssuerAndSerialNumber");this.issuer=new Yi({schema:t.result.issuer}),this.serialNumber=t.result.serialNumber}toSchema(){return new Kn({value:[this.issuer.toSchema(),this.serialNumber]})}toJSON(){return{issuer:this.issuer.toJSON(),serialNumber:this.serialNumber.toJSON()}}}class es{constructor(e={}){this.hashAlgorithm=Ee(e,"hashAlgorithm",es.defaultValues("hashAlgorithm")),this.issuerNameHash=Ee(e,"issuerNameHash",es.defaultValues("issuerNameHash")),this.issuerKeyHash=Ee(e,"issuerKeyHash",es.defaultValues("issuerKeyHash")),this.serialNumber=Ee(e,"serialNumber",es.defaultValues("serialNumber")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"hashAlgorithm":return new Ai;case"issuerNameHash":case"issuerKeyHash":return new Pn;case"serialNumber":return new jn;default:throw new Error(`Invalid member name for CertID class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"hashAlgorithm":return""===t.algorithmId&&"algorithmParams"in t==!1;case"issuerNameHash":case"issuerKeyHash":case"serialNumber":return t.isEqual(es.defaultValues(e));default:throw new Error(`Invalid member name for CertID class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[Ai.schema(t.hashAlgorithmObject||{names:{blockName:t.hashAlgorithm||""}}),new Pn({name:t.issuerNameHash||""}),new Pn({name:t.issuerKeyHash||""}),new jn({name:t.serialNumber||""})]})}fromSchema(e){Fe(e,["hashAlgorithm","issuerNameHash","issuerKeyHash","serialNumber"]);const t=xi(e,e,es.schema({names:{hashAlgorithm:"hashAlgorithm",issuerNameHash:"issuerNameHash",issuerKeyHash:"issuerKeyHash",serialNumber:"serialNumber"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for CertID");this.hashAlgorithm=new Ai({schema:t.result.hashAlgorithm}),this.issuerNameHash=t.result.issuerNameHash,this.issuerKeyHash=t.result.issuerKeyHash,this.serialNumber=t.result.serialNumber}toSchema(){return new Kn({value:[this.hashAlgorithm.toSchema(),this.issuerNameHash,this.issuerKeyHash,this.serialNumber]})}toJSON(){return{hashAlgorithm:this.hashAlgorithm.toJSON(),issuerNameHash:this.issuerNameHash.toJSON(),issuerKeyHash:this.issuerKeyHash.toJSON(),serialNumber:this.serialNumber.toJSON()}}isEqual(e){return!this.hashAlgorithm.algorithmId!==e.hashAlgorithm.algorithmId&&(!1!==Re(this.issuerNameHash.valueBlock.valueHex,e.issuerNameHash.valueBlock.valueHex)&&(!1!==Re(this.issuerKeyHash.valueBlock.valueHex,e.issuerKeyHash.valueBlock.valueHex)&&!!this.serialNumber.isEqual(e.serialNumber)))}createForCertificate(e,t){let r,n=Promise.resolve();const i=Zi();if(void 0===i)return Promise.reject("Unable to create WebCrypto object");if("hashAlgorithm"in t==!1)return Promise.reject('Parameter "hashAlgorithm" is mandatory for "OCSP_REQUEST.createForCertificate"');const o=zi({name:t.hashAlgorithm});return""===o?Promise.reject(`Incorrect "hashAlgorithm": ${this.hashAlgorithm}`):(this.hashAlgorithm=new Ai({algorithmId:o,algorithmParams:new Rn}),"issuerCertificate"in t?(r=t.issuerCertificate,this.serialNumber=e.serialNumber,n=n.then((()=>i.digest({name:t.hashAlgorithm},r.subject.toSchema().toBER(!1))),(e=>Promise.reject(e))),n=n.then((e=>{this.issuerNameHash=new Pn({valueHex:e});const n=r.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHex;return i.digest({name:t.hashAlgorithm},n)}),(e=>Promise.reject(e))).then((e=>{this.issuerKeyHash=new Pn({valueHex:e})}),(e=>Promise.reject(e))),n):Promise.reject('Parameter "issuerCertificate" is mandatory for "OCSP_REQUEST.createForCertificate"'))}}class ts{constructor(e={}){this.certID=Ee(e,"certID",ts.defaultValues("certID")),this.certStatus=Ee(e,"certStatus",ts.defaultValues("certStatus")),this.thisUpdate=Ee(e,"thisUpdate",ts.defaultValues("thisUpdate")),"nextUpdate"in e&&(this.nextUpdate=Ee(e,"nextUpdate",ts.defaultValues("nextUpdate"))),"singleExtensions"in e&&(this.singleExtensions=Ee(e,"singleExtensions",ts.defaultValues("singleExtensions"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"certID":return new es;case"certStatus":return{};case"thisUpdate":case"nextUpdate":return new Date(0,0,0);case"singleExtensions":return[];default:throw new Error(`Invalid member name for SingleResponse class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"certID":return es.compareWithDefault("hashAlgorithm",t.hashAlgorithm)&&es.compareWithDefault("issuerNameHash",t.issuerNameHash)&&es.compareWithDefault("issuerKeyHash",t.issuerKeyHash)&&es.compareWithDefault("serialNumber",t.serialNumber);case"certStatus":return 0===Object.keys(t).length;case"thisUpdate":case"nextUpdate":return t===ts.defaultValues(e);default:throw new Error(`Invalid member name for SingleResponse class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[es.schema(t.certID||{}),new Si({value:[new Sn({name:t.certStatus||"",idBlock:{tagClass:3,tagNumber:0},lenBlockLength:1}),new An({name:t.certStatus||"",idBlock:{tagClass:3,tagNumber:1},value:[new mi,new An({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Vn]})]}),new Sn({name:t.certStatus||"",idBlock:{tagClass:3,tagNumber:2},lenBlock:{length:1}})]}),new mi({name:t.thisUpdate||""}),new An({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new mi({name:t.nextUpdate||""})]}),new An({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[Lo.schema(t.singleExtensions||{})]})]})}fromSchema(e){Fe(e,["certID","certStatus","thisUpdate","nextUpdate","singleExtensions"]);const t=xi(e,e,ts.schema({names:{certID:{names:{blockName:"certID"}},certStatus:"certStatus",thisUpdate:"thisUpdate",nextUpdate:"nextUpdate",singleExtensions:{names:{blockName:"singleExtensions"}}}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for SingleResponse");this.certID=new es({schema:t.result.certID}),this.certStatus=t.result.certStatus,this.thisUpdate=t.result.thisUpdate.toDate(),"nextUpdate"in t.result&&(this.nextUpdate=t.result.nextUpdate.toDate()),"singleExtensions"in t.result&&(this.singleExtensions=Array.from(t.result.singleExtensions.valueBlock.value,(e=>new Po({schema:e}))))}toSchema(){const e=[];return e.push(this.certID.toSchema()),e.push(this.certStatus),e.push(new mi({valueDate:this.thisUpdate})),"nextUpdate"in this&&e.push(new An({idBlock:{tagClass:3,tagNumber:0},value:[new mi({valueDate:this.nextUpdate})]})),"singleExtensions"in this&&e.push(new Kn({value:Array.from(this.singleExtensions,(e=>e.toSchema()))})),new Kn({value:e})}toJSON(){const e={certID:this.certID.toJSON(),certStatus:this.certStatus.toJSON(),thisUpdate:this.thisUpdate};return"nextUpdate"in this&&(e.nextUpdate=this.nextUpdate),"singleExtensions"in this&&(e.singleExtensions=Array.from(this.singleExtensions,(e=>e.toJSON()))),e}}class rs{constructor(e={}){this.tbs=Ee(e,"tbs",rs.defaultValues("tbs")),this.responderID=Ee(e,"responderID",rs.defaultValues("responderID")),this.producedAt=Ee(e,"producedAt",rs.defaultValues("producedAt")),this.responses=Ee(e,"responses",rs.defaultValues("responses")),"responseExtensions"in e&&(this.responseExtensions=Ee(e,"responseExtensions",rs.defaultValues("responseExtensions"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"tbs":return new ArrayBuffer(0);case"responderID":return{};case"producedAt":return new Date(0,0,0);case"responses":case"responseExtensions":return[];default:throw new Error(`Invalid member name for ResponseData class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"tbs":return 0===t.byteLength;case"responderID":return 0===Object.keys(t).length;case"producedAt":return t===rs.defaultValues(e);case"responses":case"responseExtensions":return 0===t.length;default:throw new Error(`Invalid member name for ResponseData class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"ResponseData",value:[new An({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new jn({name:t.version||"ResponseData.version"})]}),new Si({value:[new An({name:t.responderID||"ResponseData.responderID",idBlock:{tagClass:3,tagNumber:1},value:[Yi.schema(t.ResponseDataByName||{names:{blockName:"ResponseData.byName"}})]}),new An({name:t.responderID||"ResponseData.responderID",idBlock:{tagClass:3,tagNumber:2},value:[new Pn({name:t.ResponseDataByKey||"ResponseData.byKey"})]})]}),new mi({name:t.producedAt||"ResponseData.producedAt"}),new Kn({value:[new _i({name:"ResponseData.responses",value:ts.schema(t.response||{})})]}),new An({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[Lo.schema(t.extensions||{names:{blockName:"ResponseData.responseExtensions"}})]})]})}fromSchema(e){Fe(e,["ResponseData","ResponseData.version","ResponseData.responderID","ResponseData.producedAt","ResponseData.responses","ResponseData.responseExtensions"]);const t=xi(e,e,rs.schema());if(!1===t.verified)throw new Error("Object's schema was not verified against input data for ResponseData");this.tbs=t.result.ResponseData.valueBeforeDecode,"ResponseData.version"in t.result&&(this.version=t.result["ResponseData.version"].valueBlock.valueDec),1===t.result["ResponseData.responderID"].idBlock.tagNumber?this.responderID=new Yi({schema:t.result["ResponseData.responderID"].valueBlock.value[0]}):this.responderID=t.result["ResponseData.responderID"].valueBlock.value[0],this.producedAt=t.result["ResponseData.producedAt"].toDate(),this.responses=Array.from(t.result["ResponseData.responses"],(e=>new ts({schema:e}))),"ResponseData.responseExtensions"in t.result&&(this.responseExtensions=Array.from(t.result["ResponseData.responseExtensions"].valueBlock.value,(e=>new Po({schema:e}))))}toSchema(e=!1){let t;if(!1===e){if(0===this.tbs.length)return rs.schema();t=Tn(this.tbs).result}else{const e=[];"version"in this&&e.push(new An({idBlock:{tagClass:3,tagNumber:0},value:[new jn({value:this.version})]})),this.responderID instanceof Yi?e.push(new An({idBlock:{tagClass:3,tagNumber:1},value:[this.responderID.toSchema()]})):e.push(new An({idBlock:{tagClass:3,tagNumber:2},value:[this.responderID]})),e.push(new mi({valueDate:this.producedAt})),e.push(new Kn({value:Array.from(this.responses,(e=>e.toSchema()))})),"responseExtensions"in this&&e.push(new An({idBlock:{tagClass:3,tagNumber:1},value:[new Kn({value:Array.from(this.responseExtensions,(e=>e.toSchema()))})]})),t=new Kn({value:e})}return t}toJSON(){const e={};return"version"in this&&(e.version=this.version),"responderID"in this&&(e.responderID=this.responderID),"producedAt"in this&&(e.producedAt=this.producedAt),"responses"in this&&(e.responses=Array.from(this.responses,(e=>e.toJSON()))),"responseExtensions"in this&&(e.responseExtensions=Array.from(this.responseExtensions,(e=>e.toJSON()))),e}}class ns{constructor(e={}){this.trustedCerts=Ee(e,"trustedCerts",this.defaultValues("trustedCerts")),this.certs=Ee(e,"certs",this.defaultValues("certs")),this.crls=Ee(e,"crls",this.defaultValues("crls")),this.ocsps=Ee(e,"ocsps",this.defaultValues("ocsps")),this.checkDate=Ee(e,"checkDate",this.defaultValues("checkDate")),this.findOrigin=Ee(e,"findOrigin",this.defaultValues("findOrigin")),this.findIssuer=Ee(e,"findIssuer",this.defaultValues("findIssuer"))}static defaultFindOrigin(e,t){0===e.tbs.byteLength&&(e.tbs=e.encodeTBS());for(const r of t.certs)if(0===r.tbs.byteLength&&(r.tbs=r.encodeTBS()),Re(e.tbs,r.tbs))return"Intermediate Certificates";for(const r of t.trustedCerts)if(0===r.tbs.byteLength&&(r.tbs=r.encodeTBS()),Re(e.tbs,r.tbs))return"Trusted Certificates";return"Unknown"}async defaultFindIssuer(e,t){let r=[],n=null,i=null,o=null;if(e.subject.isEqual(e.issuer))try{if(!0===await e.verify())return[e]}catch(e){}if("extensions"in e)for(const t of e.extensions)if("2.5.29.35"===t.extnID){"keyIdentifier"in t.parsedValue?n=t.parsedValue.keyIdentifier:("authorityCertIssuer"in t.parsedValue&&(i=t.parsedValue.authorityCertIssuer),"authorityCertSerialNumber"in t.parsedValue&&(o=t.parsedValue.authorityCertSerialNumber));break}function s(t){if(null!==n&&"extensions"in t){let e=!1;for(const i of t.extensions)if("2.5.29.14"===i.extnID){e=!0,Re(i.parsedValue.valueBlock.valueHex,n.valueBlock.valueHex)&&r.push(t);break}if(e)return}let s=!1;null!==o&&(s=t.serialNumber.isEqual(o)),null!==i?t.subject.isEqual(i)&&s&&r.push(t):e.issuer.isEqual(t.subject)&&r.push(t)}for(const e of t.trustedCerts)s(e);for(const e of t.certs)s(e);for(let t=0;t<r.length;t++)try{!1===await e.verify(r[t])&&r.splice(t,1)}catch(e){r.splice(t,1)}return r}defaultValues(e){switch(e){case"trustedCerts":case"certs":case"crls":case"ocsps":return[];case"checkDate":return new Date;case"findOrigin":return ns.defaultFindOrigin;case"findIssuer":return this.defaultFindIssuer;default:throw new Error(`Invalid member name for CertificateChainValidationEngine class: ${e}`)}}async sort(e=!1){const t=[],r=this;async function n(e){const n=[],i=[],o=[];if(n.push(...t.filter((t=>e.issuer.isEqual(t.subject)))),0===n.length)return{status:1,statusMessage:"No certificate's issuers"};if(i.push(...r.crls.filter((t=>t.issuer.isEqual(e.issuer)))),0===i.length)return{status:2,statusMessage:"No CRLs for specific certificate issuer"};for(let e=0;e<i.length;e++)if(!(i[e].nextUpdate.value<r.checkDate))for(let t=0;t<n.length;t++)try{if(await i[e].verify({issuerCertificate:n[t]})){o.push({crl:i[e],certificate:n[t]});break}}catch(e){}return o.length?{status:0,statusMessage:"",result:o}:{status:3,statusMessage:"No valid CRLs found"}}async function i(e,t){const n=Wi(e.signatureAlgorithm.algorithmId);if("name"in n==!1)return 1;if("hash"in n==!1)return 1;for(let n=0;n<r.ocsps.length;n++){const i=await r.ocsps[n].getCertificateStatus(e,t);if(i.isForCertificate)return 0===i.status?0:1}return 2}async function o(e,t=!1){let r=!1,n=!1,i=!1,o=!1;if("extensions"in e){for(let t=0;t<e.extensions.length;t++){if(!0===e.extensions[t].critical&&"parsedValue"in e.extensions[t]==!1)return{result:!1,resultCode:6,resultMessage:`Unable to parse critical certificate extension: ${e.extensions[t].extnID}`};if("2.5.29.15"===e.extensions[t].extnID){i=!0;const r=new Uint8Array(e.extensions[t].parsedValue.valueBlock.valueHex);4==(4&r[0])&&(n=!0),2==(2&r[0])&&(o=!0)}"2.5.29.19"===e.extensions[t].extnID&&"cA"in e.extensions[t].parsedValue&&!0===e.extensions[t].parsedValue.cA&&(r=!0)}if(!0===n&&!1===r)return{result:!1,resultCode:3,resultMessage:'Unable to build certificate chain - using "keyCertSign" flag set without BasicConstaints'};if(!0===i&&!0===r&&!1===n)return{result:!1,resultCode:4,resultMessage:'Unable to build certificate chain - "keyCertSign" flag was not set'};if(!0===r&&!0===i&&t&&!1===o)return{result:!1,resultCode:5,resultMessage:'Unable to build certificate chain - intermediate certificate must have "cRLSign" key usage flag'}}return!1===r?{result:!1,resultCode:7,resultMessage:"Unable to build certificate chain - more than one possible end-user certificate"}:{result:!0,resultCode:0,resultMessage:""}}t.push(...r.trustedCerts),t.push(...r.certs);for(let e=0;e<t.length;e++)for(let r=0;r<t.length;r++)if(e!==r&&Re(t[e].tbs,t[r].tbs)){t.splice(r,1),e=0;break}let s;const a=[t[t.length-1]];if(s=await async function e(t){const n=[];function i(e){let t=!0;for(let r=0;r<e.length;r++){for(let n=0;n<e.length;n++)if(n!==r&&e[r]===e[n]){t=!1;break}if(!t)break}return t}const o=await r.findIssuer(t,r);if(0===o.length)throw new Error("No valid certificate paths found");for(let r=0;r<o.length;r++){if(Re(o[r].tbs,t.tbs)){n.push([o[r]]);continue}const s=await e(o[r]);for(let e=0;e<s.length;e++){const t=s[e].slice();t.splice(0,0,o[r]),i(t)?n.push(t):n.push(s[e])}}return n}(t[t.length-1]),0===s.length)return{result:!1,resultCode:60,resultMessage:"Unable to find certificate path"};for(let e=0;e<s.length;e++){let t=!1;for(let n=0;n<s[e].length;n++){const i=s[e][n];for(let e=0;e<r.trustedCerts.length;e++)if(Re(i.tbs,r.trustedCerts[e].tbs)){t=!0;break}if(t)break}t||(s.splice(e,1),e=0)}if(0===s.length)throw{result:!1,resultCode:97,resultMessage:"No valid certificate paths found"};let c=s[0].length,u=0;for(let e=0;e<s.length;e++)s[e].length<c&&(c=s[e].length,u=e);for(let e=0;e<s[u].length;e++)a.push(s[u][e]);if(s=await async function(t,s){for(let e=0;e<t.length;e++)if(t[e].notBefore.value>s||t[e].notAfter.value<s)return{result:!1,resultCode:8,resultMessage:"The certificate is either not yet valid or expired"};if(t.length<2)return{result:!1,resultCode:9,resultMessage:"Too short certificate path"};for(let e=t.length-2;e>=0;e--)if(!1===t[e].issuer.isEqual(t[e].subject)&&!1===t[e].issuer.isEqual(t[e+1].subject))return{result:!1,resultCode:10,resultMessage:"Incorrect name chaining"};if(0!==r.crls.length||0!==r.ocsps.length)for(let s=0;s<t.length-1;s++){let a=2,c={status:0,statusMessage:""};if(0!==r.ocsps.length)switch(a=await i(t[s],t[s+1]),a){case 0:continue;case 1:return{result:!1,resultCode:12,resultMessage:"One of certificates was revoked via OCSP response"}}if(0!==r.crls.length){if(c=await n(t[s]),0===c.status)for(let e=0;e<c.result.length;e++){if(c.result[e].crl.isCertificateRevoked(t[s]))return{result:!1,resultCode:12,resultMessage:"One of certificates had been revoked"};if(!1===(await o(c.result[e].certificate,!0)).result)return{result:!1,resultCode:13,resultMessage:"CRL issuer certificate is not a CA certificate or does not have crlSign flag"}}else if(!1===e)throw{result:!1,resultCode:11,resultMessage:`No revocation values found for one of certificates: ${c.statusMessage}`}}else if(2===a)return{result:!1,resultCode:11,resultMessage:"No revocation values found for one of certificates"};if(2===a&&2===c.status&&e){const e=t[s+1];let r=!1;if("extensions"in e)for(const t of e.extensions)switch(t.extnID){case"2.5.29.31":case"2.5.29.46":case"1.3.6.1.5.5.7.1.1":r=!0}if(r)throw{result:!1,resultCode:11,resultMessage:`No revocation values found for one of certificates: ${c.statusMessage}`}}}for(let e=1;e<t.length;e++){if(!1===(await o(t[e])).result)return{result:!1,resultCode:14,resultMessage:"One of intermediate certificates is not a CA certificate"}}return{result:!0}}(a,r.checkDate),!1===s.result)throw s;return a}async verify(e={}){function t(e,t){const r=Ki(e),n=Ki(t),i=r.split("."),o=n.split("."),s=i.length,a=o.length;if(0===s||0===a||s<a)return!1;for(let e=0;e<s;e++)if(0===i[e].length)return!1;for(let e=0;e<a;e++)if(0===o[e].length){if(0===e){if(1===a)return!1;continue}return!1}for(let e=0;e<a;e++)if(0!==o[a-1-e].length&&0!==i[s-1-e].localeCompare(o[a-1-e]))return!1;return!0}function r(e,r){const n=Ki(e),i=Ki(r),o=n.split("@"),s=i.split("@");if(0===o.length||0===s.length||o.length<s.length)return!1;if(1===s.length){if(t(o[1],s[0])){const e=o[1].split("."),t=s[0].split(".");return 0===t[0].length||e.length===t.length}return!1}return 0===n.localeCompare(i)}function n(e,r){let n=Ki(e);const i=Ki(r),o=n.split("/");if(i.split("/").length>1)return!1;if(o.length>1)for(let e=0;e<o.length;e++)if(o[e].length>0&&":"!==o[e].charAt(o[e].length-1)){n=o[e].split(":")[0];break}if(t(n,i)){const e=n.split("."),t=i.split(".");return 0===t[0].length||e.length===t.length}return!1}function i(e,t){const r=new Uint8Array(e.valueBlock.valueHex),n=new Uint8Array(t.valueBlock.valueHex);if(4===r.length&&8===n.length){for(let e=0;e<4;e++)if((r[e]^n[e])&n[e+4])return!1;return!0}if(16===r.length&&32===n.length){for(let e=0;e<16;e++)if((r[e]^n[e])&n[e+16])return!1;return!0}return!1}function o(e,t){if(0===e.typesAndValues.length||0===t.typesAndValues.length)return!0;if(e.typesAndValues.length<t.typesAndValues.length)return!1;let r=!0,n=0;for(let i=0;i<t.typesAndValues.length;i++){let o=!1;for(let s=n;s<e.typesAndValues.length;s++)if(o=e.typesAndValues[s].isEqual(t.typesAndValues[i]),e.typesAndValues[s].type===t.typesAndValues[i].type&&(r=r&&o),!0===o){if(0===n||n===s){n=s+1;break}return!1}if(!1===o)return!1}return 0!==n&&r}try{if(0===this.certs.length)throw"Empty certificate array";let s=!1;"passedWhenNotRevValues"in e&&(s=e.passedWhenNotRevValues);let a=[];a.push("2.5.29.32.0");let c=!1,u=!1,l=!1,d=[],h=[],f=[];"initialPolicySet"in e&&(a=e.initialPolicySet),"initialExplicitPolicy"in e&&(c=e.initialExplicitPolicy),"initialPolicyMappingInhibit"in e&&(u=e.initialPolicyMappingInhibit),"initialInhibitPolicy"in e&&(l=e.initialInhibitPolicy),"initialPermittedSubtreesSet"in e&&(d=e.initialPermittedSubtreesSet),"initialExcludedSubtreesSet"in e&&(h=e.initialExcludedSubtreesSet),"initialRequiredNameForms"in e&&(f=e.initialRequiredNameForms);let p=c,m=u,g=l;const v=new Array(3);v[0]=!1,v[1]=!1,v[2]=!1;let y=0,b=0,E=0,w=d,S=h;const _=f;let T=1;this.certs=await this.sort(s);const x=[];x.push("2.5.29.32.0");const A=[],I=new Array(this.certs.length-1);for(let e=0;e<this.certs.length-1;e++)I[e]=!0;A.push(I);const C=new Array(this.certs.length-1),R=new Array(this.certs.length-1);let k=p?this.certs.length-1:-1;for(let e=this.certs.length-2;e>=0;e--,T++)if("extensions"in this.certs[e]){for(let t=0;t<this.certs[e].extensions.length;t++){if("2.5.29.32"===this.certs[e].extensions[t].extnID){R[e]=this.certs[e].extensions[t].parsedValue;for(let t=0;t<x.length;t++)if("2.5.29.32.0"===x[t]){delete A[t][e];break}for(let r=0;r<this.certs[e].extensions[t].parsedValue.certificatePolicies.length;r++){let n=-1;for(let i=0;i<x.length;i++)if(this.certs[e].extensions[t].parsedValue.certificatePolicies[r].policyIdentifier===x[i]){n=i;break}if(-1===n){x.push(this.certs[e].extensions[t].parsedValue.certificatePolicies[r].policyIdentifier);const n=new Array(this.certs.length-1);n[e]=!0,A.push(n)}else A[n][e]=!0}}if("2.5.29.33"===this.certs[e].extensions[t].extnID){if(m)return{result:!1,resultCode:98,resultMessage:"Policy mapping prohibited"};C[e]=this.certs[e].extensions[t].parsedValue}"2.5.29.36"===this.certs[e].extensions[t].extnID&&!1===p&&(0===this.certs[e].extensions[t].parsedValue.requireExplicitPolicy?(p=!0,k=e):!1===v[0]?(v[0]=!0,y=this.certs[e].extensions[t].parsedValue.requireExplicitPolicy):y=y>this.certs[e].extensions[t].parsedValue.requireExplicitPolicy?this.certs[e].extensions[t].parsedValue.requireExplicitPolicy:y,0===this.certs[e].extensions[t].parsedValue.inhibitPolicyMapping?m=!0:!1===v[1]?(v[1]=!0,b=this.certs[e].extensions[t].parsedValue.inhibitPolicyMapping+1):b=b>this.certs[e].extensions[t].parsedValue.inhibitPolicyMapping+1?this.certs[e].extensions[t].parsedValue.inhibitPolicyMapping+1:b),"2.5.29.54"===this.certs[e].extensions[t].extnID&&!1===g&&(0===this.certs[e].extensions[t].parsedValue.valueBlock.valueDec?g=!0:!1===v[2]?(v[2]=!0,E=this.certs[e].extensions[t].parsedValue.valueBlock.valueDec):E=E>this.certs[e].extensions[t].parsedValue.valueBlock.valueDec?this.certs[e].extensions[t].parsedValue.valueBlock.valueDec:E)}if(!0===g){let t=-1;for(let e=0;e<x.length;e++)if("2.5.29.32.0"===x[e]){t=e;break}-1!==t&&delete A[0][e]}!1===p&&!0===v[0]&&(y--,0===y&&(p=!0,k=e,v[0]=!1)),!1===m&&!0===v[1]&&(b--,0===b&&(m=!0,v[1]=!1)),!1===g&&!0===v[2]&&(E--,0===E&&(g=!0,v[2]=!1))}for(let e=0;e<this.certs.length-1;e++)if(e<this.certs.length-2&&void 0!==C[e+1])for(let t=0;t<C[e+1].mappings.length;t++){if("2.5.29.32.0"===C[e+1].mappings[t].issuerDomainPolicy||"2.5.29.32.0"===C[e+1].mappings[t].subjectDomainPolicy)return{result:!1,resultCode:99,resultMessage:'The "anyPolicy" should not be a part of policy mapping scheme'};let r=-1,n=-1;for(let i=0;i<x.length;i++)x[i]===C[e+1].mappings[t].issuerDomainPolicy&&(r=i),x[i]===C[e+1].mappings[t].subjectDomainPolicy&&(n=i);void 0!==A[r][e]&&delete A[r][e];for(let i=0;i<R[e].certificatePolicies.length;i++)if(C[e+1].mappings[t].subjectDomainPolicy===R[e].certificatePolicies[i].policyIdentifier&&-1!==r&&-1!==n)for(let t=0;t<=e;t++)void 0!==A[n][t]&&(A[r][t]=!0,delete A[n][t])}for(let e=0;e<x.length;e++)if("2.5.29.32.0"===x[e])for(let t=0;t<k;t++)delete A[e][t];const O=[];for(let e=0;e<A.length;e++){let t=!0;for(let r=0;r<this.certs.length-1;r++){let n=!1;if(r<k&&"2.5.29.32.0"===x[e]&&x.length>1){t=!1;break}if(void 0===A[e][r]){if(r>=k)for(let e=0;e<x.length;e++)if("2.5.29.32.0"===x[e]){!0===A[e][r]&&(n=!0);break}if(!n){t=!1;break}}}!0===t&&O.push(x[e])}let N=[];if(1===a.length&&"2.5.29.32.0"===a[0]&&!1===p)N=a;else if(1===O.length&&"2.5.29.32.0"===O[0])N=a;else for(let e=0;e<O.length;e++)for(let t=0;t<a.length;t++)if(a[t]===O[e]||"2.5.29.32.0"===a[t]){N.push(O[e]);break}const P={result:N.length>0,resultCode:0,resultMessage:N.length>0?"":'Zero "userConstrPolicies" array, no intersections with "authConstrPolicies"',authConstrPolicies:O,userConstrPolicies:N,explicitPolicyIndicator:p,policyMappings:C,certificatePath:this.certs};if(0===N.length)return P;if(!1===P.result)return P;T=1;for(let e=this.certs.length-2;e>=0;e--,T++){let s=[],a=[],c=[];if("extensions"in this.certs[e])for(let t=0;t<this.certs[e].extensions.length;t++)"2.5.29.30"===this.certs[e].extensions[t].extnID&&("permittedSubtrees"in this.certs[e].extensions[t].parsedValue&&(a=a.concat(this.certs[e].extensions[t].parsedValue.permittedSubtrees)),"excludedSubtrees"in this.certs[e].extensions[t].parsedValue&&(c=c.concat(this.certs[e].extensions[t].parsedValue.excludedSubtrees))),"2.5.29.17"===this.certs[e].extensions[t].extnID&&(s=s.concat(this.certs[e].extensions[t].parsedValue.altNames));let u=_.length<=0;for(let t=0;t<_.length;t++)switch(_[t].base.type){case 4:if(_[t].base.value.typesAndValues.length!==this.certs[e].subject.typesAndValues.length)continue;u=!0;for(let r=0;r<this.certs[e].subject.typesAndValues.length;r++)if(this.certs[e].subject.typesAndValues[r].type!==_[t].base.value.typesAndValues[r].type){u=!1;break}if(!0===u)break}if(!1===u)throw P.result=!1,P.resultCode=21,P.resultMessage="No neccessary name form found",P;const l=[];l[0]=[],l[1]=[],l[2]=[],l[3]=[],l[4]=[];for(let e=0;e<w.length;e++)switch(w[e].base.type){case 1:l[0].push(w[e]);break;case 2:l[1].push(w[e]);break;case 4:l[2].push(w[e]);break;case 6:l[3].push(w[e]);break;case 7:l[4].push(w[e])}for(let a=0;a<5;a++){let c=!1,u=!1;const d=l[a];for(let l=0;l<d.length;l++){switch(a){case 0:if(s.length>0)for(let e=0;e<s.length;e++)1===s[e].type&&(u=!0,c=c||r(s[e].value,d[l].base.value));else for(let t=0;t<this.certs[e].subject.typesAndValues.length;t++)"1.2.840.113549.1.9.1"!==this.certs[e].subject.typesAndValues[t].type&&"0.9.2342.19200300.100.1.3"!==this.certs[e].subject.typesAndValues[t].type||(u=!0,c=c||r(this.certs[e].subject.typesAndValues[t].value.valueBlock.value,d[l].base.value));break;case 1:if(s.length>0)for(let e=0;e<s.length;e++)2===s[e].type&&(u=!0,c=c||t(s[e].value,d[l].base.value));break;case 2:u=!0,c=o(this.certs[e].subject,d[l].base.value);break;case 3:if(s.length>0)for(let e=0;e<s.length;e++)6===s[e].type&&(u=!0,c=c||n(s[e].value,d[l].base.value));break;case 4:if(s.length>0)for(let e=0;e<s.length;e++)7===s[e].type&&(u=!0,c=c||i(s[e].value,d[l].base.value))}if(c)break}if(!1===c&&d.length>0&&u)throw P.result=!1,P.resultCode=41,P.resultMessage='Failed to meet "permitted sub-trees" name constraint',P}let d=!1;for(let a=0;a<S.length;a++){switch(S[a].base.type){case 1:if(s.length>=0)for(let e=0;e<s.length;e++)1===s[e].type&&(d=d||r(s[e].value,S[a].base.value));else for(let t=0;t<this.certs[e].subject.typesAndValues.length;t++)"1.2.840.113549.1.9.1"!==this.certs[e].subject.typesAndValues[t].type&&"0.9.2342.19200300.100.1.3"!==this.certs[e].subject.typesAndValues[t].type||(d=d||r(this.certs[e].subject.typesAndValues[t].value.valueBlock.value,S[a].base.value));break;case 2:if(s.length>0)for(let e=0;e<s.length;e++)2===s[e].type&&(d=d||t(s[e].value,S[a].base.value));break;case 4:d=d||o(this.certs[e].subject,S[a].base.value);break;case 6:if(s.length>0)for(let e=0;e<s.length;e++)6===s[e].type&&(d=d||n(s[e].value,S[a].base.value));break;case 7:if(s.length>0)for(let e=0;e<s.length;e++)7===s[e].type&&(d=d||i(s[e].value,S[a].base.value))}if(d)break}if(!0===d)throw P.result=!1,P.resultCode=42,P.resultMessage='Failed to meet "excluded sub-trees" name constraint',P;w=w.concat(a),S=S.concat(c)}return P}catch(e){if(e instanceof Object){if("resultMessage"in e)return e;if("message"in e)return{result:!1,resultCode:-1,resultMessage:e.message}}return{result:!1,resultCode:-1,resultMessage:e}}}}class is{constructor(e={}){this.tbsResponseData=Ee(e,"tbsResponseData",is.defaultValues("tbsResponseData")),this.signatureAlgorithm=Ee(e,"signatureAlgorithm",is.defaultValues("signatureAlgorithm")),this.signature=Ee(e,"signature",is.defaultValues("signature")),"certs"in e&&(this.certs=Ee(e,"certs",is.defaultValues("certs"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"tbsResponseData":return new rs;case"signatureAlgorithm":return new Ai;case"signature":return new Dn;case"certs":return[];default:throw new Error(`Invalid member name for BasicOCSPResponse class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"type":{let e=rs.compareWithDefault("tbs",t.tbs)&&rs.compareWithDefault("responderID",t.responderID)&&rs.compareWithDefault("producedAt",t.producedAt)&&rs.compareWithDefault("responses",t.responses);return"responseExtensions"in t&&(e=e&&rs.compareWithDefault("responseExtensions",t.responseExtensions)),e}case"signatureAlgorithm":return""===t.algorithmId&&"algorithmParams"in t==!1;case"signature":return t.isEqual(is.defaultValues(e));case"certs":return 0===t.length;default:throw new Error(`Invalid member name for BasicOCSPResponse class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"BasicOCSPResponse",value:[rs.schema(t.tbsResponseData||{names:{blockName:"BasicOCSPResponse.tbsResponseData"}}),Ai.schema(t.signatureAlgorithm||{names:{blockName:"BasicOCSPResponse.signatureAlgorithm"}}),new Dn({name:t.signature||"BasicOCSPResponse.signature"}),new An({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Kn({value:[new _i({name:"BasicOCSPResponse.certs",value:Mo.schema(t.certs||{})})]})]})]})}fromSchema(e){Fe(e,["BasicOCSPResponse.tbsResponseData","BasicOCSPResponse.signatureAlgorithm","BasicOCSPResponse.signature","BasicOCSPResponse.certs"]);const t=xi(e,e,is.schema());if(!1===t.verified)throw new Error("Object's schema was not verified against input data for BasicOCSPResponse");this.tbsResponseData=new rs({schema:t.result["BasicOCSPResponse.tbsResponseData"]}),this.signatureAlgorithm=new Ai({schema:t.result["BasicOCSPResponse.signatureAlgorithm"]}),this.signature=t.result["BasicOCSPResponse.signature"],"BasicOCSPResponse.certs"in t.result&&(this.certs=Array.from(t.result["BasicOCSPResponse.certs"],(e=>new Mo({schema:e}))))}toSchema(){const e=[];return e.push(this.tbsResponseData.toSchema()),e.push(this.signatureAlgorithm.toSchema()),e.push(this.signature),"certs"in this&&e.push(new An({idBlock:{tagClass:3,tagNumber:0},value:[new Kn({value:Array.from(this.certs,(e=>e.toSchema()))})]})),new Kn({value:e})}toJSON(){const e={tbsResponseData:this.tbsResponseData.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signature:this.signature.toJSON()};return"certs"in this&&(e.certs=Array.from(this.certs,(e=>e.toJSON()))),e}getCertificateStatus(e,t){let r=Promise.resolve();const n={isForCertificate:!1,status:2},i={},o=[],s=[];for(const r of this.tbsResponseData.responses){const n=Wi(r.certID.hashAlgorithm.algorithmId);if("name"in n==!1)return Promise.reject(`Wrong CertID hashing algorithm: ${r.certID.hashAlgorithm.algorithmId}`);if(n.name in i==!1){i[n.name]=1;const r=new es;o.push(r),s.push(r.createForCertificate(e,{hashAlgorithm:n.name,issuerCertificate:t}))}}return r=r.then((()=>Promise.all(s))),r=r.then((()=>{for(const e of this.tbsResponseData.responses)for(const t of o)if(e.certID.isEqual(t)){n.isForCertificate=!0;try{switch(e.certStatus.idBlock.isConstructed){case!0:1===e.certStatus.idBlock.tagNumber&&(n.status=1);break;case!1:switch(e.certStatus.idBlock.tagNumber){case 0:n.status=0;break;case 2:n.status=2}}}catch(e){}return n}return n})),r}sign(e,t="SHA-1"){if(void 0===e)return Promise.reject("Need to provide a private key for signing");let r,n=Promise.resolve();const i=$i();return n=n.then((()=>i.subtle.getSignatureParameters(e,t))),n=n.then((e=>{r=e.parameters,this.signatureAlgorithm=e.signatureAlgorithm})),n=n.then((()=>{this.tbsResponseData.tbs=this.tbsResponseData.toSchema(!0).toBER(!1)})),n=n.then((()=>i.subtle.signWithPrivateKey(this.tbsResponseData.tbs,e,r))),n=n.then((e=>{this.signature=new Dn({valueHex:e})})),n}verify(e={}){let t=null,r=-1,n=Promise.resolve(),i=[];const o=this,s=$i();if("certs"in this==!1)return Promise.reject("No certificates attached to the BasicOCSPResponce");"trustedCerts"in e&&(i=e.trustedCerts);const a=Zi();if(void 0===a)return Promise.reject("Unable to create WebCrypto object");switch(!0){case this.tbsResponseData.responderID instanceof Yi:n=n.then((()=>{for(const[e,t]of o.certs.entries())if(t.subject.isEqual(o.tbsResponseData.responderID)){r=e;break}}));break;case this.tbsResponseData.responderID instanceof Pn:n=n.then((()=>Promise.all(Array.from(o.certs,(e=>a.digest({name:"sha-1"},new Uint8Array(e.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHex))))).then((e=>{for(const[t]of o.certs.entries())if(Re(e[t],o.tbsResponseData.responderID.valueBlock.valueHex)){r=t;break}}))));break;default:return Promise.reject("Wrong value for responderID")}return n=n.then((()=>-1===r?Promise.reject("Correct certificate was not found in OCSP response"):(t=this.certs[r],Promise.all(Array.from(o.certs,(e=>function(e){if(!0===e.issuer.isEqual(t.issuer)&&!0===e.serialNumber.isEqual(t.serialNumber))return null;let r=!1;for(const t of e.extensions)"2.5.29.19"===t.extnID&&"cA"in t.parsedValue&&!0===t.parsedValue.cA&&(r=!0);return r?e:null}(e)))).then((e=>{const r=[];r.push(t);for(const t of e)null!==t&&r.push(t);return new ns({certs:r,trustedCerts:i}).verify().then((e=>!0===e.result?Promise.resolve():Promise.reject("Validation of signer's certificate failed")),(e=>Promise.reject(`Validation of signer's certificate failed with error: ${e instanceof Object?e.resultMessage:e}`)))}),(e=>Promise.reject(`Error during checking certificates for CA flag: ${e}`)))))),n=n.then((()=>s.subtle.verifyWithPublicKey(this.tbsResponseData.tbs,this.signature,this.certs[r].subjectPublicKeyInfo,this.signatureAlgorithm))),n}}class os{constructor(e={}){if(this.eContentType=Ee(e,"eContentType",os.defaultValues("eContentType")),"eContent"in e&&(this.eContent=Ee(e,"eContent",os.defaultValues("eContent")),1===this.eContent.idBlock.tagClass&&4===this.eContent.idBlock.tagNumber&&!1===this.eContent.idBlock.isConstructed)){const e=new Pn({idBlock:{isConstructed:!0},isConstructed:!0});let t=0,r=this.eContent.valueBlock.valueHex.byteLength;for(;r>0;){const n=new Uint8Array(this.eContent.valueBlock.valueHex,t,t+65536>this.eContent.valueBlock.valueHex.byteLength?this.eContent.valueBlock.valueHex.byteLength-t:65536),i=new ArrayBuffer(n.length),o=new Uint8Array(i);for(let e=0;e<o.length;e++)o[e]=n[e];e.valueBlock.value.push(new Pn({valueHex:i})),r-=n.length,t+=n.length}this.eContent=e}"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"eContentType":return"";case"eContent":return new Pn;default:throw new Error(`Invalid member name for EncapsulatedContentInfo class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"eContentType":return""===t;case"eContent":return 1===t.idBlock.tagClass&&4===t.idBlock.tagNumber&&t.isEqual(os.defaultValues("eContent"));default:throw new Error(`Invalid member name for EncapsulatedContentInfo class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[new qn({name:t.eContentType||""}),new An({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new wi({name:t.eContent||""})]})]})}fromSchema(e){Fe(e,["eContentType","eContent"]);const t=xi(e,e,os.schema({names:{eContentType:"eContentType",eContent:"eContent"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for EncapsulatedContentInfo");this.eContentType=t.result.eContentType.valueBlock.toString(),"eContent"in t.result&&(this.eContent=t.result.eContent)}toSchema(){const e=[];return e.push(new qn({value:this.eContentType})),"eContent"in this&&!1===os.compareWithDefault("eContent",this.eContent)&&e.push(new An({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.eContent]})),new Kn({value:e})}toJSON(){const e={eContentType:this.eContentType};return"eContent"in this&&!1===os.compareWithDefault("eContent",this.eContent)&&(e.eContent=this.eContent.toJSON()),e}}class ss{constructor(e={}){this.hashAlgorithm=Ee(e,"hashAlgorithm",ss.defaultValues("hashAlgorithm")),this.hashedMessage=Ee(e,"hashedMessage",ss.defaultValues("hashedMessage")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"hashAlgorithm":return new Ai;case"hashedMessage":return new Pn;default:throw new Error(`Invalid member name for MessageImprint class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"hashAlgorithm":return""===t.algorithmId&&"algorithmParams"in t==!1;case"hashedMessage":return 0===t.isEqual(ss.defaultValues(e));default:throw new Error(`Invalid member name for MessageImprint class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"",value:[Ai.schema(t.hashAlgorithm||{}),new Pn({name:t.hashedMessage||""})]})}fromSchema(e){Fe(e,["hashAlgorithm","hashedMessage"]);const t=xi(e,e,ss.schema({names:{hashAlgorithm:{names:{blockName:"hashAlgorithm"}},hashedMessage:"hashedMessage"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for MessageImprint");this.hashAlgorithm=new Ai({schema:t.result.hashAlgorithm}),this.hashedMessage=t.result.hashedMessage}toSchema(){return new Kn({value:[this.hashAlgorithm.toSchema(),this.hashedMessage]})}toJSON(){return{hashAlgorithm:this.hashAlgorithm.toJSON(),hashedMessage:this.hashedMessage.toJSON()}}}class as{constructor(e={}){this.type=Ee(e,"type",as.defaultValues("type")),this.attributes=Ee(e,"attributes",as.defaultValues("attributes")),this.encodedValue=Ee(e,"encodedValue",as.defaultValues("encodedValue")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"type":return-1;case"attributes":return[];case"encodedValue":return new ArrayBuffer(0);default:throw new Error(`Invalid member name for SignedAndUnsignedAttributes class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"type":return t===as.defaultValues("type");case"attributes":return 0===t.length;case"encodedValue":return 0===t.byteLength;default:throw new Error(`Invalid member name for SignedAndUnsignedAttributes class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new An({name:t.blockName||"",optional:!0,idBlock:{tagClass:3,tagNumber:t.tagNumber},value:[new _i({name:t.attributes||"",value:Oi.schema()})]})}fromSchema(e){Fe(e,["attributes"]);const t=xi(e,e,as.schema({names:{tagNumber:this.type,attributes:"attributes"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for SignedAndUnsignedAttributes");this.type=t.result.idBlock.tagNumber,this.encodedValue=t.result.valueBeforeDecode;if(new Uint8Array(this.encodedValue)[0]=49,"attributes"in t.result!=!1)this.attributes=Array.from(t.result.attributes,(e=>new Oi({schema:e})));else if(0===this.type)throw new Error("Wrong structure of SignedUnsignedAttributes")}toSchema(){if(as.compareWithDefault("type",this.type)||as.compareWithDefault("attributes",this.attributes))throw new Error('Incorrectly initialized "SignedAndUnsignedAttributes" class');return new An({optional:!0,idBlock:{tagClass:3,tagNumber:this.type},value:Array.from(this.attributes,(e=>e.toSchema()))})}toJSON(){if(as.compareWithDefault("type",this.type)||as.compareWithDefault("attributes",this.attributes))throw new Error('Incorrectly initialized "SignedAndUnsignedAttributes" class');return{type:this.type,attributes:Array.from(this.attributes,(e=>e.toJSON()))}}}class cs{constructor(e={}){this.version=Ee(e,"version",cs.defaultValues("version")),this.sid=Ee(e,"sid",cs.defaultValues("sid")),this.digestAlgorithm=Ee(e,"digestAlgorithm",cs.defaultValues("digestAlgorithm")),"signedAttrs"in e&&(this.signedAttrs=Ee(e,"signedAttrs",cs.defaultValues("signedAttrs"))),this.signatureAlgorithm=Ee(e,"signatureAlgorithm",cs.defaultValues("signatureAlgorithm")),this.signature=Ee(e,"signature",cs.defaultValues("signature")),"unsignedAttrs"in e&&(this.unsignedAttrs=Ee(e,"unsignedAttrs",cs.defaultValues("unsignedAttrs"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"version":return 0;case"sid":return new wi;case"digestAlgorithm":case"signatureAlgorithm":return new Ai;case"signedAttrs":return new as({type:0});case"signature":return new Pn;case"unsignedAttrs":return new as({type:1});default:throw new Error(`Invalid member name for SignerInfo class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"version":return cs.defaultValues("version")===t;case"sid":return t instanceof wi;case"digestAlgorithm":return t instanceof Ai!=!1&&t.isEqual(cs.defaultValues("digestAlgorithm"));case"signedAttrs":case"signature":case"unsignedAttrs":return as.compareWithDefault("type",t.type)&&as.compareWithDefault("attributes",t.attributes)&&as.compareWithDefault("encodedValue",t.encodedValue);case"signatureAlgorithm":return t instanceof Ai!=!1&&t.isEqual(cs.defaultValues("signatureAlgorithm"));default:throw new Error(`Invalid member name for SignerInfo class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:"SignerInfo",value:[new jn({name:t.version||"SignerInfo.version"}),new Si({value:[Xo.schema(t.sid||{names:{blockName:"SignerInfo.sid"}}),new Si({value:[new An({optional:!0,name:t.sid||"SignerInfo.sid",idBlock:{tagClass:3,tagNumber:0},value:[new Pn]}),new Sn({optional:!0,name:t.sid||"SignerInfo.sid",idBlock:{tagClass:3,tagNumber:0},value:[new Pn]})]})]}),Ai.schema(t.digestAlgorithm||{names:{blockName:"SignerInfo.digestAlgorithm"}}),as.schema(t.signedAttrs||{names:{blockName:"SignerInfo.signedAttrs",tagNumber:0}}),Ai.schema(t.signatureAlgorithm||{names:{blockName:"SignerInfo.signatureAlgorithm"}}),new Pn({name:t.signature||"SignerInfo.signature"}),as.schema(t.unsignedAttrs||{names:{blockName:"SignerInfo.unsignedAttrs",tagNumber:1}})]})}fromSchema(e){Fe(e,["SignerInfo.version","SignerInfo.sid","SignerInfo.digestAlgorithm","SignerInfo.signedAttrs","SignerInfo.signatureAlgorithm","SignerInfo.signature","SignerInfo.unsignedAttrs"]);const t=xi(e,e,cs.schema());if(!1===t.verified)throw new Error("Object's schema was not verified against input data for SignerInfo");this.version=t.result["SignerInfo.version"].valueBlock.valueDec;const r=t.result["SignerInfo.sid"];1===r.idBlock.tagClass?this.sid=new Xo({schema:r}):this.sid=r,this.digestAlgorithm=new Ai({schema:t.result["SignerInfo.digestAlgorithm"]}),"SignerInfo.signedAttrs"in t.result&&(this.signedAttrs=new as({type:0,schema:t.result["SignerInfo.signedAttrs"]})),this.signatureAlgorithm=new Ai({schema:t.result["SignerInfo.signatureAlgorithm"]}),this.signature=t.result["SignerInfo.signature"],"SignerInfo.unsignedAttrs"in t.result&&(this.unsignedAttrs=new as({type:1,schema:t.result["SignerInfo.unsignedAttrs"]}))}toSchema(){if(cs.compareWithDefault("sid",this.sid))throw new Error('Incorrectly initialized "SignerInfo" class');const e=[];return e.push(new jn({value:this.version})),this.sid instanceof Xo?e.push(this.sid.toSchema()):e.push(this.sid),e.push(this.digestAlgorithm.toSchema()),"signedAttrs"in this&&!1===cs.compareWithDefault("signedAttrs",this.signedAttrs)&&e.push(this.signedAttrs.toSchema()),e.push(this.signatureAlgorithm.toSchema()),e.push(this.signature),"unsignedAttrs"in this&&!1===cs.compareWithDefault("unsignedAttrs",this.unsignedAttrs)&&e.push(this.unsignedAttrs.toSchema()),new Kn({value:e})}toJSON(){if(cs.compareWithDefault("sid",this.sid))throw new Error('Incorrectly initialized "SignerInfo" class');const e={version:this.version};return this.sid instanceof wi||(e.sid=this.sid.toJSON()),e.digestAlgorithm=this.digestAlgorithm.toJSON(),!1===cs.compareWithDefault("signedAttrs",this.signedAttrs)&&(e.signedAttrs=this.signedAttrs.toJSON()),e.signatureAlgorithm=this.signatureAlgorithm.toJSON(),e.signature=this.signature.toJSON(),!1===cs.compareWithDefault("unsignedAttrs",this.unsignedAttrs)&&(e.unsignedAttrs=this.unsignedAttrs.toJSON()),e}}class us{constructor(e={}){this.version=Ee(e,"version",us.defaultValues("version")),this.policy=Ee(e,"policy",us.defaultValues("policy")),this.messageImprint=Ee(e,"messageImprint",us.defaultValues("messageImprint")),this.serialNumber=Ee(e,"serialNumber",us.defaultValues("serialNumber")),this.genTime=Ee(e,"genTime",us.defaultValues("genTime")),"accuracy"in e&&(this.accuracy=Ee(e,"accuracy",us.defaultValues("accuracy"))),"ordering"in e&&(this.ordering=Ee(e,"ordering",us.defaultValues("ordering"))),"nonce"in e&&(this.nonce=Ee(e,"nonce",us.defaultValues("nonce"))),"tsa"in e&&(this.tsa=Ee(e,"tsa",us.defaultValues("tsa"))),"extensions"in e&&(this.extensions=Ee(e,"extensions",us.defaultValues("extensions"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"version":return 0;case"policy":return"";case"messageImprint":return new ss;case"serialNumber":case"nonce":return new jn;case"genTime":return new Date(0,0,0);case"accuracy":return new no;case"ordering":return!1;case"tsa":return new to;case"extensions":return[];default:throw new Error(`Invalid member name for TSTInfo class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"version":case"policy":case"genTime":case"ordering":return t===us.defaultValues(e);case"messageImprint":return ss.compareWithDefault("hashAlgorithm",t.hashAlgorithm)&&ss.compareWithDefault("hashedMessage",t.hashedMessage);case"serialNumber":case"nonce":return t.isEqual(us.defaultValues(e));case"accuracy":return no.compareWithDefault("seconds",t.seconds)&&no.compareWithDefault("millis",t.millis)&&no.compareWithDefault("micros",t.micros);case"tsa":return to.compareWithDefault("type",t.type)&&to.compareWithDefault("value",t.value);case"extensions":return 0===t.length;default:throw new Error(`Invalid member name for TSTInfo class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return new Kn({name:t.blockName||"TSTInfo",value:[new jn({name:t.version||"TSTInfo.version"}),new qn({name:t.policy||"TSTInfo.policy"}),ss.schema(t.messageImprint||{names:{blockName:"TSTInfo.messageImprint"}}),new jn({name:t.serialNumber||"TSTInfo.serialNumber"}),new mi({name:t.genTime||"TSTInfo.genTime"}),no.schema(t.accuracy||{names:{blockName:"TSTInfo.accuracy"}}),new On({name:t.ordering||"TSTInfo.ordering",optional:!0}),new jn({name:t.nonce||"TSTInfo.nonce",optional:!0}),new An({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[to.schema(t.tsa||{names:{blockName:"TSTInfo.tsa"}})]}),new An({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new _i({name:t.extensions||"TSTInfo.extensions",value:Po.schema(t.extension||{})})]})]})}fromSchema(e){Fe(e,["TSTInfo.version","TSTInfo.policy","TSTInfo.messageImprint","TSTInfo.serialNumber","TSTInfo.genTime","TSTInfo.accuracy","TSTInfo.ordering","TSTInfo.nonce","TSTInfo.tsa","TSTInfo.extensions"]);const t=xi(e,e,us.schema());if(!1===t.verified)throw new Error("Object's schema was not verified against input data for TSTInfo");this.version=t.result["TSTInfo.version"].valueBlock.valueDec,this.policy=t.result["TSTInfo.policy"].valueBlock.toString(),this.messageImprint=new ss({schema:t.result["TSTInfo.messageImprint"]}),this.serialNumber=t.result["TSTInfo.serialNumber"],this.genTime=t.result["TSTInfo.genTime"].toDate(),"TSTInfo.accuracy"in t.result&&(this.accuracy=new no({schema:t.result["TSTInfo.accuracy"]})),"TSTInfo.ordering"in t.result&&(this.ordering=t.result["TSTInfo.ordering"].valueBlock.value),"TSTInfo.nonce"in t.result&&(this.nonce=t.result["TSTInfo.nonce"]),"TSTInfo.tsa"in t.result&&(this.tsa=new to({schema:t.result["TSTInfo.tsa"]})),"TSTInfo.extensions"in t.result&&(this.extensions=Array.from(t.result["TSTInfo.extensions"],(e=>new Po({schema:e}))))}toSchema(){const e=[];return e.push(new jn({value:this.version})),e.push(new qn({value:this.policy})),e.push(this.messageImprint.toSchema()),e.push(this.serialNumber),e.push(new mi({valueDate:this.genTime})),"accuracy"in this&&e.push(this.accuracy.toSchema()),"ordering"in this&&e.push(new On({value:this.ordering})),"nonce"in this&&e.push(this.nonce),"tsa"in this&&e.push(new An({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.tsa.toSchema()]})),"extensions"in this&&e.push(new An({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.extensions,(e=>e.toSchema()))})),new Kn({value:e})}toJSON(){const e={version:this.version,policy:this.policy,messageImprint:this.messageImprint.toJSON(),serialNumber:this.serialNumber.toJSON(),genTime:this.genTime};return"accuracy"in this&&(e.accuracy=this.accuracy.toJSON()),"ordering"in this&&(e.ordering=this.ordering),"nonce"in this&&(e.nonce=this.nonce.toJSON()),"tsa"in this&&(e.tsa=this.tsa.toJSON()),"extensions"in this&&(e.extensions=Array.from(this.extensions,(e=>e.toJSON()))),e}verify(e={}){let t,r=Promise.resolve(),n=null,i=null;const o=Zi();if(void 0===o)return Promise.reject("Unable to create WebCrypto object");if(!("data"in e))return Promise.reject('"data" is a mandatory attribute for TST_INFO verification');if(t=e.data,"notBefore"in e&&(n=e.notBefore),"notAfter"in e&&(i=e.notAfter),null!==n&&this.genTime<n)return Promise.reject("Generation time for TSTInfo object is less than notBefore value");if(null!==i&&this.genTime>i)return Promise.reject("Generation time for TSTInfo object is more than notAfter value");const s=Wi(this.messageImprint.hashAlgorithm.algorithmId);return"name"in s==!1?Promise.reject(`Unsupported signature algorithm: ${this.messageImprint.hashAlgorithm.algorithmId}`):(r=r.then((()=>o.digest(s.name,new Uint8Array(t)))).then((e=>Re(e,this.messageImprint.hashedMessage.valueBlock.valueHex))),r)}}class ls{constructor(e={}){this.version=Ee(e,"version",ls.defaultValues("version")),this.digestAlgorithms=Ee(e,"digestAlgorithms",ls.defaultValues("digestAlgorithms")),this.encapContentInfo=Ee(e,"encapContentInfo",ls.defaultValues("encapContentInfo")),"certificates"in e&&(this.certificates=Ee(e,"certificates",ls.defaultValues("certificates"))),"crls"in e&&(this.crls=Ee(e,"crls",ls.defaultValues("crls"))),"ocsps"in e&&(this.ocsps=Ee(e,"ocsps",ls.defaultValues("ocsps"))),this.signerInfos=Ee(e,"signerInfos",ls.defaultValues("signerInfos")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"version":return 0;case"digestAlgorithms":case"certificates":case"crls":case"ocsps":case"signerInfos":return[];case"encapContentInfo":return new os;default:throw new Error(`Invalid member name for SignedData class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"version":return t===ls.defaultValues("version");case"encapContentInfo":return new os;case"digestAlgorithms":case"certificates":case"crls":case"ocsps":case"signerInfos":return 0===t.length;default:throw new Error(`Invalid member name for SignedData class: ${e}`)}}static schema(e={}){const t=Ee(e,"names",{});return"optional"in t==!1&&(t.optional=!1),new Kn({name:t.blockName||"SignedData",optional:t.optional,value:[new jn({name:t.version||"SignedData.version"}),new Wn({value:[new _i({name:t.digestAlgorithms||"SignedData.digestAlgorithms",value:Ai.schema()})]}),os.schema(t.encapContentInfo||{names:{blockName:"SignedData.encapContentInfo"}}),new An({name:t.certificates||"SignedData.certificates",optional:!0,idBlock:{tagClass:3,tagNumber:0},value:Jo.schema().valueBlock.value}),new An({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Qo.schema(t.crls||{names:{crls:"SignedData.crls"}}).valueBlock.value}),new Wn({value:[new _i({name:t.signerInfos||"SignedData.signerInfos",value:cs.schema()})]})]})}fromSchema(e){Fe(e,["SignedData.version","SignedData.digestAlgorithms","SignedData.encapContentInfo","SignedData.certificates","SignedData.crls","SignedData.signerInfos"]);const t=xi(e,e,ls.schema());if(!1===t.verified)throw new Error("Object's schema was not verified against input data for SignedData");if(this.version=t.result["SignedData.version"].valueBlock.valueDec,"SignedData.digestAlgorithms"in t.result&&(this.digestAlgorithms=Array.from(t.result["SignedData.digestAlgorithms"],(e=>new Ai({schema:e})))),this.encapContentInfo=new os({schema:t.result["SignedData.encapContentInfo"]}),"SignedData.certificates"in t.result){const e=new Jo({schema:new Wn({value:t.result["SignedData.certificates"].valueBlock.value})});this.certificates=e.certificates.slice(0)}"SignedData.crls"in t.result&&(this.crls=Array.from(t.result["SignedData.crls"],(e=>1===e.idBlock.tagClass?new Ko({schema:e}):(e.idBlock.tagClass=1,e.idBlock.tagNumber=16,new Yo({schema:e}))))),"SignedData.signerInfos"in t.result&&(this.signerInfos=Array.from(t.result["SignedData.signerInfos"],(e=>new cs({schema:e}))))}toSchema(e=!1){const t=[];if(this.certificates&&this.certificates.length&&this.certificates.some((e=>e instanceof Wo))||this.crls&&this.crls.length&&this.crls.some((e=>e instanceof Yo))?this.version=5:this.certificates&&this.certificates.length&&this.certificates.some((e=>e instanceof $o))?this.version=4:this.certificates&&this.certificates.length&&this.certificates.some((e=>e instanceof jo))||this.signerInfos.some((e=>3===e.version))||this.encapContentInfo.eContentType!==ls.ID_DATA?this.version=3:this.version=1,t.push(new jn({value:this.version})),t.push(new Wn({value:Array.from(this.digestAlgorithms,(t=>t.toSchema(e)))})),t.push(this.encapContentInfo.toSchema()),"certificates"in this){const e=new Jo({certificates:this.certificates}).toSchema();t.push(new An({idBlock:{tagClass:3,tagNumber:0},value:e.valueBlock.value}))}return"crls"in this&&t.push(new An({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.crls,(t=>{if(t instanceof Yo){const r=t.toSchema(e);return r.idBlock.tagClass=3,r.idBlock.tagNumber=1,r}return t.toSchema(e)}))})),t.push(new Wn({value:Array.from(this.signerInfos,(t=>t.toSchema(e)))})),new Kn({value:t})}toJSON(){const e={version:this.version,digestAlgorithms:Array.from(this.digestAlgorithms,(e=>e.toJSON())),encapContentInfo:this.encapContentInfo.toJSON()};return"certificates"in this&&(e.certificates=Array.from(this.certificates,(e=>e.toJSON()))),"crls"in this&&(e.crls=Array.from(this.crls,(e=>e.toJSON()))),e.signerInfos=Array.from(this.signerInfos,(e=>e.toJSON())),e}verify({signer:e=-1,data:t=new ArrayBuffer(0),trustedCerts:r=[],checkDate:n=new Date,checkChain:i=!1,extendedMode:o=!1,passedWhenNotRevValues:s=!1,findOrigin:a=null,findIssuer:c=null}={}){let u=Promise.resolve(),l=new ArrayBuffer(0),d="",h={},f=null,p=[];const m=$i(),g=Zi();if(void 0===g)return Promise.reject("Unable to create WebCrypto object");if(-1===e)return o?Promise.reject({date:n,code:1,message:"Unable to get signer index from input parameters",signatureVerified:null,signerCertificate:null,signerCertificateVerified:null}):Promise.reject("Unable to get signer index from input parameters");if("certificates"in this==!1)return o?Promise.reject({date:n,code:2,message:"No certificates attached to this signed data",signatureVerified:null,signerCertificate:null,signerCertificateVerified:null}):Promise.reject("No certificates attached to this signed data");return u=this.signerInfos[e].sid instanceof Xo?u.then((()=>{for(const t of this.certificates)if(t instanceof Mo!=!1&&t.issuer.isEqual(this.signerInfos[e].sid.issuer)&&t.serialNumber.isEqual(this.signerInfos[e].sid.serialNumber))return h=t,Promise.resolve();return o?Promise.reject({date:n,code:3,message:"Unable to find signer certificate",signatureVerified:null,signerCertificate:null,signerCertificateVerified:null}):Promise.reject("Unable to find signer certificate")})):(async()=>{try{const t=this.signerInfos[e].sid,r=t.idBlock.isConstructed?t.valueBlock.value[0].valueBlock.valueHex:t.valueBlock.valueHex;for(const e of this.certificates){if(!(e instanceof Mo))continue;if(Re(await g.digest({name:"sha-1"},new Uint8Array(e.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHex)),r)){h=e;break}}if(!h)throw new Error("Signing certificate not found")}catch(e){if(o)return Promise.reject({date:n,code:3,message:"Unable to find signer certificate",signatureVerified:null,signerCertificate:null,signerCertificateVerified:null});throw"Unable to find signer certificate"}})(),u=u.then((()=>{if("1.2.840.113549.1.9.16.1.4"===this.encapContentInfo.eContentType){if("eContent"in this.encapContentInfo==!1)return!1;const e=Tn(this.encapContentInfo.eContent.valueBlock.valueHex);let r;try{r=new us({schema:e.result})}catch(e){return!1}return n=r.genTime,f=r.serialNumber.valueBlock.valueHex,0===t.byteLength?o?Promise.reject({date:n,code:4,message:"Missed detached data input array",signatureVerified:null,signerCertificate:h,signerCertificateVerified:null}):Promise.reject("Missed detached data input array"):r.verify({data:t})}return!0})),i&&(u=u.then((e=>{if(!1===e)return!1;const t=Array.from(this.certificates.filter((e=>e instanceof Mo)),(e=>function(e){if(!0===e.issuer.isEqual(h.issuer)&&!0===e.serialNumber.isEqual(h.serialNumber))return null;let t=!1;if("extensions"in e)for(const r of e.extensions)"2.5.29.19"===r.extnID&&"cA"in r.parsedValue&&!0===r.parsedValue.cA&&(t=!0);return t?e:null}(e))),i={checkDate:n,certs:Array.from(t.filter((e=>null!==e))),trustedCerts:r};null!==c&&(i.findIssuer=c),null!==a&&(i.findOrigin=a);const u=new ns(i);if(u.certs.push(h),"crls"in this)for(const e of this.crls)"thisUpdate"in e?u.crls.push(e):"1.3.6.1.5.5.7.48.1.1"===e.otherRevInfoFormat&&u.ocsps.push(new is({schema:e.otherRevInfo}));return"ocsps"in this&&u.ocsps.push(...this.ocsps),u.verify({passedWhenNotRevValues:s}).then((e=>("certificatePath"in e&&(p=e.certificatePath),!0===e.result?Promise.resolve(!0):o?Promise.reject({date:n,code:5,message:`Validation of signer's certificate failed: ${e.resultMessage}`,signatureVerified:null,signerCertificate:h,signerCertificateVerified:!1}):Promise.reject("Validation of signer's certificate failed"))),(e=>o?Promise.reject({date:n,code:5,message:`Validation of signer's certificate failed with error: ${e instanceof Object?e.resultMessage:e}`,signatureVerified:null,signerCertificate:h,signerCertificateVerified:!1}):Promise.reject(`Validation of signer's certificate failed with error: ${e instanceof Object?e.resultMessage:e}`)))}))),u=u.then((t=>{if(!1===t)return!1;const r=Wi(this.signerInfos[e].digestAlgorithm.algorithmId);return"name"in r==!1?o?Promise.reject({date:n,code:7,message:`Unsupported signature algorithm: ${this.signerInfos[e].digestAlgorithm.algorithmId}`,signatureVerified:null,signerCertificate:h,signerCertificateVerified:!0}):Promise.reject(`Unsupported signature algorithm: ${this.signerInfos[e].digestAlgorithm.algorithmId}`):(d=r.name,!0)})),u=u.then((r=>{if(!1===r)return!1;if("eContent"in this.encapContentInfo)if(1===this.encapContentInfo.eContent.idBlock.tagClass&&4===this.encapContentInfo.eContent.idBlock.tagNumber)if(!1===this.encapContentInfo.eContent.idBlock.isConstructed)t=this.encapContentInfo.eContent.valueBlock.valueHex;else for(const e of this.encapContentInfo.eContent.valueBlock.value)t=xe(t,e.valueBlock.valueHex);else t=this.encapContentInfo.eContent.valueBlock.valueBeforeDecode;else if(0===t.byteLength)return o?Promise.reject({date:n,code:8,message:"Missed detached data input array",signatureVerified:null,signerCertificate:h,signerCertificateVerified:!0}):Promise.reject("Missed detached data input array");if("signedAttrs"in this.signerInfos[e]){let t=!1,r=!1;for(const n of this.signerInfos[e].signedAttrs.attributes)if("1.2.840.113549.1.9.3"===n.type&&(t=!0),"1.2.840.113549.1.9.4"===n.type&&(r=!0,l=n.values[0].valueBlock.valueHex),t&&r)break;if(!1===t)return o?Promise.reject({date:n,code:9,message:'Attribute "content-type" is a mandatory attribute for "signed attributes"',signatureVerified:null,signerCertificate:h,signerCertificateVerified:!0}):Promise.reject('Attribute "content-type" is a mandatory attribute for "signed attributes"');if(!1===r)return o?Promise.reject({date:n,code:10,message:'Attribute "message-digest" is a mandatory attribute for "signed attributes"',signatureVerified:null,signerCertificate:h,signerCertificateVerified:!0}):Promise.reject('Attribute "message-digest" is a mandatory attribute for "signed attributes"')}return!0})),u=u.then((r=>!1!==r&&(!("signedAttrs"in this.signerInfos[e])||g.digest(d,new Uint8Array(t))))).then((r=>!1!==r&&(!("signedAttrs"in this.signerInfos[e])||!!Re(r,l)&&(t=this.signerInfos[e].signedAttrs.encodedValue,!0)))),u=u.then((r=>!1!==r&&m.subtle.verifyWithPublicKey(t,this.signerInfos[e].signature,h.subjectPublicKeyInfo,h.signatureAlgorithm,d))),u=u.then((e=>o?{date:n,code:14,message:"",signatureVerified:e,signerCertificate:h,timestampSerial:f,signerCertificateVerified:!0,certificatePath:p}:e),(e=>o?"code"in e?Promise.reject(e):Promise.reject({date:n,code:15,message:`Error during verification: ${e.message}`,signatureVerified:null,signerCertificate:h,timestampSerial:f,signerCertificateVerified:!0}):Promise.reject(e))),u}sign(e,t,r="SHA-1",n=new ArrayBuffer(0)){if(void 0===e)return Promise.reject("Need to provide a private key for signing");let i,o=Promise.resolve();const s=$i(),a=zi({name:r});return""===a?Promise.reject(`Unsupported hash algorithm: ${r}`):(0===this.digestAlgorithms.filter((e=>e.algorithmId===a)).length&&this.digestAlgorithms.push(new Ai({algorithmId:a,algorithmParams:new Rn})),this.signerInfos[t].digestAlgorithm=new Ai({algorithmId:a,algorithmParams:new Rn}),o=o.then((()=>s.subtle.getSignatureParameters(e,r))),o=o.then((e=>{i=e.parameters,this.signerInfos[t].signatureAlgorithm=e.signatureAlgorithm})),o=o.then((()=>{if("signedAttrs"in this.signerInfos[t])if(0!==this.signerInfos[t].signedAttrs.encodedValue.byteLength)n=this.signerInfos[t].signedAttrs.encodedValue;else{n=this.signerInfos[t].signedAttrs.toSchema(!0).toBER(!1);new Uint8Array(n)[0]=49}else if("eContent"in this.encapContentInfo)if(1===this.encapContentInfo.eContent.idBlock.tagClass&&4===this.encapContentInfo.eContent.idBlock.tagNumber)if(!1===this.encapContentInfo.eContent.idBlock.isConstructed)n=this.encapContentInfo.eContent.valueBlock.valueHex;else for(const e of this.encapContentInfo.eContent.valueBlock.value)n=xe(n,e.valueBlock.valueHex);else n=this.encapContentInfo.eContent.valueBlock.valueBeforeDecode;else if(0===n.byteLength)return Promise.reject("Missed detached data input array");return Promise.resolve()})),o=o.then((()=>s.subtle.signWithPrivateKey(n,e,i))),o=o.then((e=>(this.signerInfos[t].signature=new Pn({valueHex:e}),e))),o)}}ls.ID_DATA="1.2.840.113549.1.7.1";var ds,hs;ds="undefined"!=typeof self?self:void 0,hs=function(e){if("function"!=typeof Promise)throw"Promise support required";var t=e.crypto||e.msCrypto;if(t){var r=t.subtle||t.webkitSubtle;if(r){var n=e.Crypto||t.constructor||Object,i=e.SubtleCrypto||r.constructor||Object,o=(e.CryptoKey||e.Key,e.navigator.userAgent.indexOf("Edge/")>-1),s=!!e.msCrypto&&!o,a=!t.subtle&&!!t.webkitSubtle;if(s||a){var c={KoZIhvcNAQEB:"1.2.840.113549.1.1.1"},u={"1.2.840.113549.1.1.1":"KoZIhvcNAQEB"};if(["generateKey","importKey","unwrapKey"].forEach((function(e){var n=r[e];r[e]=function(i,o,c){var u,l,b,_,T,x=[].slice.call(arguments);switch(e){case"generateKey":u=m(i),l=o,b=c;break;case"importKey":u=m(c),l=x[3],b=x[4],"jwk"===i&&((o=v(o)).alg||(o.alg=g(u)),o.key_ops||(o.key_ops="oct"!==o.kty?"d"in o?b.filter(S):b.filter(w):b.slice()),x[1]=(_=v(o),s&&(_.extractable=_.ext,delete _.ext),f(unescape(encodeURIComponent(JSON.stringify(_)))).buffer));break;case"unwrapKey":u=x[4],l=x[5],b=x[6],x[2]=c._key}if("generateKey"===e&&"HMAC"===u.name&&u.hash)return u.length=u.length||{"SHA-1":512,"SHA-256":512,"SHA-384":1024,"SHA-512":1024}[u.hash.name],r.importKey("raw",t.getRandomValues(new Uint8Array(u.length+7>>3)),u,l,b);if(a&&"generateKey"===e&&"RSASSA-PKCS1-v1_5"===u.name&&(!u.modulusLength||u.modulusLength>=2048))return(i=m(i)).name="RSAES-PKCS1-v1_5",delete i.hash,r.generateKey(i,!0,["encrypt","decrypt"]).then((function(e){return Promise.all([r.exportKey("jwk",e.publicKey),r.exportKey("jwk",e.privateKey)])})).then((function(e){return e[0].alg=e[1].alg=g(u),e[0].key_ops=b.filter(w),e[1].key_ops=b.filter(S),Promise.all([r.importKey("jwk",e[0],u,!0,e[0].key_ops),r.importKey("jwk",e[1],u,l,e[1].key_ops)])})).then((function(e){return{publicKey:e[0],privateKey:e[1]}}));if((a||s&&"SHA-1"===(u.hash||{}).name)&&"importKey"===e&&"jwk"===i&&"HMAC"===u.name&&"oct"===o.kty)return r.importKey("raw",f(h(o.k)),c,x[3],x[4]);if(a&&"importKey"===e&&("spki"===i||"pkcs8"===i))return r.importKey("jwk",function(e){var t=y(e),r=!1;t.length>2&&(r=!0,t.shift());var n={ext:!0};if("1.2.840.113549.1.1.1"!==t[0][0])throw new TypeError("Unsupported key type");var i=["n","e","d","p","q","dp","dq","qi"],o=y(t[1]);r&&o.shift();for(var s=0;s<o.length;s++)o[s][0]||(o[s]=o[s].subarray(1)),n[i[s]]=d(p(o[s]));return n.kty="RSA",n}(o),c,x[3],x[4]);if(s&&"unwrapKey"===e)return r.decrypt(x[3],c,o).then((function(e){return r.importKey(i,e,x[4],x[5],x[6])}));try{T=n.apply(r,x)}catch(e){return Promise.reject(e)}return s&&(T=new Promise((function(e,t){T.onabort=T.onerror=function(e){t(e)},T.oncomplete=function(t){e(t.target.result)}}))),T=T.then((function(e){return"HMAC"===u.name&&(u.length||(u.length=8*e.algorithm.length)),0==u.name.search("RSA")&&(u.modulusLength||(u.modulusLength=(e.publicKey||e).algorithm.modulusLength),u.publicExponent||(u.publicExponent=(e.publicKey||e).algorithm.publicExponent)),e=e.publicKey&&e.privateKey?{publicKey:new E(e.publicKey,u,l,b.filter(w)),privateKey:new E(e.privateKey,u,l,b.filter(S))}:new E(e,u,l,b)})),T}})),["exportKey","wrapKey"].forEach((function(e){var t=r[e];r[e]=function(n,i,o){var c,u=[].slice.call(arguments);switch(e){case"exportKey":u[1]=i._key;break;case"wrapKey":u[1]=i._key,u[2]=o._key}if((a||s&&"SHA-1"===(i.algorithm.hash||{}).name)&&"exportKey"===e&&"jwk"===n&&"HMAC"===i.algorithm.name&&(u[0]="raw"),!a||"exportKey"!==e||"spki"!==n&&"pkcs8"!==n||(u[0]="jwk"),s&&"wrapKey"===e)return r.exportKey(n,i).then((function(e){return"jwk"===n&&(e=f(unescape(encodeURIComponent(JSON.stringify(v(e)))))),r.encrypt(u[3],o,e)}));try{c=t.apply(r,u)}catch(e){return Promise.reject(e)}return s&&(c=new Promise((function(e,t){c.onabort=c.onerror=function(e){t(e)},c.oncomplete=function(t){e(t.target.result)}}))),"exportKey"===e&&"jwk"===n&&(c=c.then((function(e){return(a||s&&"SHA-1"===(i.algorithm.hash||{}).name)&&"HMAC"===i.algorithm.name?{kty:"oct",alg:g(i.algorithm),key_ops:i.usages.slice(),ext:!0,k:d(p(e))}:((e=v(e)).alg||(e.alg=g(i.algorithm)),e.key_ops||(e.key_ops="public"===i.type?i.usages.filter(w):"private"===i.type?i.usages.filter(S):i.usages.slice()),e)}))),!a||"exportKey"!==e||"spki"!==n&&"pkcs8"!==n||(c=c.then((function(e){return e=function(e){var t,r=[["",null]],n=!1;if("RSA"!==e.kty)throw new TypeError("Unsupported key type");for(var i=["n","e","d","p","q","dp","dq","qi"],o=[],s=0;s<i.length&&i[s]in e;s++){var a=o[s]=f(h(e[i[s]]));128&a[0]&&(o[s]=new Uint8Array(a.length+1),o[s].set(a,1))}return o.length>2&&(n=!0,o.unshift(new Uint8Array([0]))),r[0][0]="1.2.840.113549.1.1.1",t=o,r.push(new Uint8Array(b(t)).buffer),n?r.unshift(new Uint8Array([0])):r[1]={tag:3,value:r[1]},new Uint8Array(b(r)).buffer}(v(e)),e}))),c}})),["encrypt","decrypt","sign","verify"].forEach((function(e){var t=r[e];r[e]=function(n,i,o,a){if(s&&(!o.byteLength||a&&!a.byteLength))throw new Error("Empy input is not allowed");var c,u=[].slice.call(arguments),l=m(n);if(s&&"decrypt"===e&&"AES-GCM"===l.name){var d=n.tagLength>>3;u[2]=(o.buffer||o).slice(0,o.byteLength-d),n.tag=(o.buffer||o).slice(o.byteLength-d)}u[1]=i._key;try{c=t.apply(r,u)}catch(e){return Promise.reject(e)}return s&&(c=new Promise((function(t,r){c.onabort=c.onerror=function(e){r(e)},c.oncomplete=function(r){if(r=r.target.result,"encrypt"===e&&r instanceof AesGcmEncryptResult){var n=r.ciphertext,i=r.tag;(r=new Uint8Array(n.byteLength+i.byteLength)).set(new Uint8Array(n),0),r.set(new Uint8Array(i),n.byteLength),r=r.buffer}t(r)}}))),c}})),s){var l=r.digest;r.digest=function(e,t){if(!t.byteLength)throw new Error("Empy input is not allowed");var n;try{n=l.call(r,e,t)}catch(e){return Promise.reject(e)}return n=new Promise((function(e,t){n.onabort=n.onerror=function(e){t(e)},n.oncomplete=function(t){e(t.target.result)}}))},e.crypto=Object.create(t,{getRandomValues:{value:function(e){return t.getRandomValues(e)}},subtle:{value:r}}),e.CryptoKey=E}a&&(t.subtle=r,e.Crypto=n,e.SubtleCrypto=i,e.CryptoKey=E)}}}function d(e){return btoa(e).replace(/\=+$/,"").replace(/\+/g,"-").replace(/\//g,"_")}function h(e){return e=(e+="===").slice(0,-e.length%4),atob(e.replace(/-/g,"+").replace(/_/g,"/"))}function f(e){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}function p(e){return e instanceof ArrayBuffer&&(e=new Uint8Array(e)),String.fromCharCode.apply(String,e)}function m(e){var t={name:(e.name||e||"").toUpperCase().replace("V","v")};switch(t.name){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":break;case"AES-CBC":case"AES-GCM":case"AES-KW":e.length&&(t.length=e.length);break;case"HMAC":e.hash&&(t.hash=m(e.hash)),e.length&&(t.length=e.length);break;case"RSAES-PKCS1-v1_5":e.publicExponent&&(t.publicExponent=new Uint8Array(e.publicExponent)),e.modulusLength&&(t.modulusLength=e.modulusLength);break;case"RSASSA-PKCS1-v1_5":case"RSA-OAEP":e.hash&&(t.hash=m(e.hash)),e.publicExponent&&(t.publicExponent=new Uint8Array(e.publicExponent)),e.modulusLength&&(t.modulusLength=e.modulusLength);break;default:throw new SyntaxError("Bad algorithm name")}return t}function g(e){return{HMAC:{"SHA-1":"HS1","SHA-256":"HS256","SHA-384":"HS384","SHA-512":"HS512"},"RSASSA-PKCS1-v1_5":{"SHA-1":"RS1","SHA-256":"RS256","SHA-384":"RS384","SHA-512":"RS512"},"RSAES-PKCS1-v1_5":{"":"RSA1_5"},"RSA-OAEP":{"SHA-1":"RSA-OAEP","SHA-256":"RSA-OAEP-256"},"AES-KW":{128:"A128KW",192:"A192KW",256:"A256KW"},"AES-GCM":{128:"A128GCM",192:"A192GCM",256:"A256GCM"},"AES-CBC":{128:"A128CBC",192:"A192CBC",256:"A256CBC"}}[e.name][(e.hash||{}).name||e.length||""]}function v(e){(e instanceof ArrayBuffer||e instanceof Uint8Array)&&(e=JSON.parse(decodeURIComponent(escape(p(e)))));var t={kty:e.kty,alg:e.alg,ext:e.ext||e.extractable};switch(t.kty){case"oct":t.k=e.k;case"RSA":["n","e","d","p","q","dp","dq","qi","oth"].forEach((function(r){r in e&&(t[r]=e[r])}));break;default:throw new TypeError("Unsupported key type")}return t}function y(e,t){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),t||(t={pos:0,end:e.length}),t.end-t.pos<2||t.end>e.length)throw new RangeError("Malformed DER");var r,n=e[t.pos++],i=e[t.pos++];if(i>=128){if(i&=127,t.end-t.pos<i)throw new RangeError("Malformed DER");for(var o=0;i--;)o<<=8,o|=e[t.pos++];i=o}if(t.end-t.pos<i)throw new RangeError("Malformed DER");switch(n){case 2:r=e.subarray(t.pos,t.pos+=i);break;case 3:if(e[t.pos++])throw new Error("Unsupported bit string");i--;case 4:r=new Uint8Array(e.subarray(t.pos,t.pos+=i)).buffer;break;case 5:r=null;break;case 6:var s=btoa(p(e.subarray(t.pos,t.pos+=i)));if(!(s in c))throw new Error("Unsupported OBJECT ID "+s);r=c[s];break;case 48:r=[];for(var a=t.pos+i;t.pos<a;)r.push(y(e,t));break;default:throw new Error("Unsupported DER tag 0x"+n.toString(16))}return r}function b(e,t){t||(t=[]);var r=0,n=0,i=t.length+2;if(t.push(0,0),e instanceof Uint8Array){r=2,n=e.length;for(var o=0;o<n;o++)t.push(e[o])}else if(e instanceof ArrayBuffer)for(r=4,n=e.byteLength,e=new Uint8Array(e),o=0;o<n;o++)t.push(e[o]);else if(null===e)r=5,n=0;else if("string"==typeof e&&e in u){var s=f(atob(u[e]));for(r=6,n=s.length,o=0;o<n;o++)t.push(s[o])}else if(e instanceof Array){for(o=0;o<e.length;o++)b(e[o],t);r=48,n=t.length-i}else{if(!("object"==typeof e&&3===e.tag&&e.value instanceof ArrayBuffer))throw new Error("Unsupported DER value "+e);for(r=3,n=(e=new Uint8Array(e.value)).byteLength,t.push(0),o=0;o<n;o++)t.push(e[o]);n++}if(n>=128){var a=n;for(n=4,t.splice(i,0,a>>24&255,a>>16&255,a>>8&255,255&a);n>1&&!(a>>24);)a<<=8,n--;n<4&&t.splice(i,4-n),n|=128}return t.splice(i-2,2,r,n),t}function E(e,t,r,n){Object.defineProperties(this,{_key:{value:e},type:{value:e.type,enumerable:!0},extractable:{value:void 0===r?e.extractable:r,enumerable:!0},algorithm:{value:void 0===t?e.algorithm:t,enumerable:!0},usages:{value:void 0===n?e.usages:n,enumerable:!0}})}function w(e){return"verify"===e||"encrypt"===e||"wrapKey"===e}function S(e){return"sign"===e||"decrypt"===e||"unwrapKey"===e}},"function"==typeof define&&define.amd?define([],(function(){return hs(ds)})):"object"==typeof module&&module.exports?module.exports=hs(ds):hs(ds);const fs=window.crypto;var ps=r(89509);function ms(e,t){var r=void 0!==z()&&e[fe()]||e["@@iterator"];if(!r){if(me()(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return gs(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return de()(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gs(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}function gs(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vs(e){var t=function(){if("undefined"==typeof Reflect||!W())return!1;if(W().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(W()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,ee.Z)(e);if(t){var i=(0,ee.Z)(this).constructor;r=W()(n,arguments,i)}else r=n.apply(this,arguments);return(0,X.Z)(this,r)}}qi("newEngine",fs,new Vi({name:"",crypto:fs,subtle:fs.subtle}));var ys="kms:",bs=function(e){(0,Q.Z)(r,e);var t=vs(r);function r(e){var n;return(0,J.Z)(this,r),(n=t.call(this,e)).kmsError=!0,n}return(0,Y.Z)(r)}((0,ge.Z)(Error)),Es=function(e){throw new bs("INVALID KMS: ".concat(e))},ws=function(e){"string"!=typeof e&&Es("certificate needs to be a string");var t=ps.Buffer.from(e,"base64"),r=cr(new Uint8Array(t).buffer);return new Mo({schema:r.result})};const Ss=function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l().resolve().then((function(){var r;"RSA"!==t.kty&&Es("'kty' header must be '".concat("RSA","'")),r=t.kid,(0,be.isUri)(r)||Es("'kid' is not a valid URI"),(0,C.parse)(r).protocol!==ys&&Es("'kid' protocol must be '".concat(ys,"'")),ye()(t.x5c)&&t.x5c.length>0||Es("JWK does not contain a list of certificates");var n,i,o,s,a,c,u,d,h,f,p=t.x5c.map(ws);!function(e,t){var r=(0,D.Z)(e,1)[0],n=t.kid,i=(0,C.parse)(n).hostname,o=!1;if(r.extensions){var s,a=ms(r.extensions);try{for(a.s();!(s=a.n()).done;){var c=s.value;if("2.5.29.17"===c.extnID){var u,l=ms(c.parsedValue.altNames);try{for(l.s();!(u=l.n()).done&&!(o=u.value.value.toLowerCase()===i););}catch(e){l.e(e)}finally{l.f()}if(o)break}}}catch(e){a.e(e)}finally{a.f()}}if(!o){var d,h=ms(r.subject.typesAndValues);try{for(h.s();!(d=h.n()).done;){var f=d.value;if("2.5.4.3"===f.type&&(o=f.value.valueBlock.value===i))break}}catch(e){h.e(e)}finally{h.f()}}o||Es("hostname of the 1st certificate does not match 'kid'")}(p,t),n=p,i=t,o=(0,D.Z)(n,1)[0],s=i.e,a=i.n,c=O().util.base64url.encode,u=cr(o.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHex),d=new Ri({schema:u.result}),h=d.publicExponent.valueBlock.valueHex,f=d.modulus.valueBlock.valueHex,s!==c(h)&&Es("Public exponent is invalid"),a!==c(f)&&Es("Modulus is invalid");var m=e?function(e){return new ns({trustedCerts:(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).map(ws),certs:e}).verify().then((function(e){var t=e.result,r=e.resultCode,n=e.resultMessage;t||Es("Certificate Validation failed [".concat(r,"]: ").concat(n))}))}(p,e):l().resolve();return m.then((function(){return t}))}))}};var _s,Ts,xs=new(B()),As=new(B()),Is=new(B()),Cs=r(11227)("kms"),Rs=d._y.extend((_s=(0,R.oneFlight)({keyFactory:function(e){var t=e.uri,r=e.onBehalfOf;return"".concat(t,"/").concat(r)}}),Ts={namespace:"Encryption",children:{batcher:ue},bindKey:function(e){var t=this,r=e.kro,n=e.kroUri,i=e.key,o=e.keyUri;return n=n||r.uri,o=o||i.uri,this.logger.info("kms: binding key to resource"),n?o?this.request({method:"update",resourceUri:n,uri:o}).then((function(e){return t.logger.info("kms: bound key to resource"),e.key})):l().reject(new Error("`key` or `keyUri` is required")):l().reject(new Error("`kro` or `kroUri` is required"))},createResource:function(e){var t=this,r=e.userIds,n=e.keyUris,i=e.key,o=e.keys;return n=n||[],o&&(n=o.reduce((function(e,t){return e.push(t.uri),e}),n)),i&&n.push(i.uri),0===n.length?l().reject(new Error("Cannot create KMS Resource without at least one keyUri")):(this.logger.info("kms: creating resource"),this.request({method:"create",uri:"/resources",userIds:r,keyUris:n}).then((function(e){return t.logger.info("kms: created resource"),e.resource})))},addAuthorization:function(e){var t=this,r=e.userIds,n=e.authIds,i=e.kro,o=e.kroUri;return r=r||[],o=o||i.uri,n&&(r=r.concat(n)),0===r.length?l().reject(new Error("Cannot add authorization without userIds or authIds")):o?(this.logger.info("kms: adding authorization to kms resource"),this.request({method:"create",uri:"/authorizations",resourceUri:o,userIds:r}).then((function(e){return t.logger.info("kms: added authorization"),e.authorizations}))):l().reject(new Error("`kro` or `kroUri` is required"))},listAuthorizations:function(e){var t=this,r=e.kro,n=e.kroUri;return(n=n||r.uri)?this.request({method:"retrieve",uri:"".concat(n,"/authorizations")}).then((function(e){return t.logger.info("kms: retrieved authorization list"),e.authorizations})):l().reject(new Error("`kro` or `kroUri` is required"))},removeAuthorization:function(e){var t=this,r=e.authId,n=e.userId,i=e.kro,o=e.kroUri;return r=r||n,o=o||i.uri,r?o?(this.logger.info("kms: removing authorization from kms resource"),this.request({method:"delete",uri:"".concat(o,"/authorizations?").concat(V.stringify({authId:r}))}).then((function(e){return t.logger.info("kms: removed authorization"),e.authorizations}))):l().reject(new Error("`kro` or `kroUri` is required")):l().reject(new Error("Cannot remove authorization without authId"))},createUnboundKeys:function(e){var t=this,r=e.count;return this.logger.info("kms: request ".concat(r," unbound keys")),r?this.request({method:"create",uri:"/keys",count:r}).then((function(e){return t.logger.info("kms: received unbound keys"),l().all(e.keys.map(t.asKey))})):l().reject(new Error("`options.count` is required"))},fetchPublicKey:function(e){var t=this,r=e.assignedOrgId;return this.logger.info("kms: fetch public key for byok"),this.request({method:"retrieve",uri:"/publicKey",assignedOrgId:r}).then((function(e){return t.logger.info("kms: received public key"),e.publicKey}))},uploadCustomerMasterKey:function(e){var t=this,r=e.assignedOrgId,n=e.customerMasterKey,i=e.awsKms,o=void 0!==i&&i;return this.logger.info("kms: upload customer master key for byok"),this.request({method:"create",uri:o?"/awsKmsCmk":"/cmk",assignedOrgId:r,customerMasterKey:n,requestId:$().v4()}).then((function(e){return t.logger.info("kms: finish to upload customer master key"),e}))},listAllCustomerMasterKey:function(e){var t=this,r=e.assignedOrgId,n=e.awsKms,i=void 0!==n&&n;return this.logger.info("kms: get all customer master keys for byok"),this.request({method:"retrieve",uri:i?"/awsKmsCmk":"/cmk",assignedOrgId:r,requestId:$().v4()}).then((function(e){return t.logger.info("kms: finish to get all customer master keys"),e}))},changeCustomerMasterKeyState:function(e){var t=this,r=e.keyId,n=e.keyState,i=e.assignedOrgId;return this.logger.info("kms: change one customer master key state for byok"),this.request({method:"update",uri:r,keyState:n,assignedOrgId:i,requestId:$().v4()}).then((function(e){return t.logger.info("kms: finish to change the customer master key state to {}",n),e}))},deleteAllCustomerMasterKeys:function(e){var t=this,r=e.assignedOrgId,n=e.awsKms,i=void 0!==n&&n;return this.logger.info("kms: delete all customer master keys at the same time"),this.request({method:"delete",uri:i?"/awsKmsCmk":"/cmk",assignedOrgId:r,requestId:$().v4()}).then((function(e){return t.logger.info("kms: finish to delete all customer master keys"),e}))},useGlobalMasterKey:function(e){var t=this,r=e.assignedOrgId;return this.logger.info("kms: return to use global master key"),this.request({method:"update",uri:"default",keyState:"ACTIVE",assignedOrgId:r,requestId:$().v4()}).then((function(e){return t.logger.info("kms: finish to return to global master key"),e}))},fetchKey:function(e){var t=this,r=e.uri,n=e.onBehalfOf;return r?(this.logger.info("kms: fetching key"),this.request({method:"retrieve",uri:r},{onBehalfOf:n}).then((function(e){return t.logger.info("kms: fetched key"),t.asKey(e.key)}))):l().reject(new Error("`options.uri` is required"))},ping:function(){return this.request({method:"update",uri:"/ping"})},asKey:function(e){return O().JWK.asKey(e.jwk).then((function(t){return e.jwk=t,e}))},prepareRequest:function(e,t){var r=this,n="create"===e.method&&e.uri.includes("/ecdhe");return l().resolve(n?Is.get(this):this._getContext()).then((function(i){r.logger.info("kms: wrapping ".concat(n?"ephemeral key":"kms"," request"));var o=new G.Request(e),s=i;return t&&(s=r._contextOnBehalfOf(i,t)),o.wrap(s,{serverKey:n}).then((function(){return o}))}))},processKmsMessageEvent:function(e){var t=this;return this.logger.info("kms: received kms message"),l().all(e.encryption.kmsMessages.map((function(r,n){return t._isECDHEMessage(r).then((function(i){t.logger.info("kms: received ".concat(i?"ecdhe":"normal"," message"));var o=new G.Response(r);return l().resolve(i?Is.get(t):xs.get(t)).then((function(e){return o.unwrap(e)})).then((function(){0})).then((function(){e.encryption.kmsMessages[n]=o})).then((function(){return o}))}))}))).then((function(){return t.batcher.processKmsMessageEvent(e)})).catch((function(e){return t.logger.error("kms: decrypt failed",e.stack),l().reject(e)})).then((function(){return e}))},decryptKmsMessage:function(e){var t=new G.Response(e);return xs.get(this).then((function(e){return t.unwrap(e)})).then((function(){return t.body}))},_isECDHEMessage:function(e){return this._getKMSStaticPubKey().then((function(t){var r=e.split(".");return 3===r.length&&JSON.parse(O().util.base64url.decode(r[0])).kid===t.kid}))},request:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.timeout,i=r.onBehalfOf;return n=n||this.config.kmsInitialTimeout,this.webex.internal.mercury.connect().then((function(){return t.prepareRequest(e,i)})).then((function(e){return e[ce]=n,t.batcher.request(e)})).catch((function(r){if(r instanceof bs)return t.webex.trigger("client:InvalidRequestError"),l().reject(r);if(!r.statusCode&&!r.status){if(Cs("timeout ".concat(n)),(n*=2)>=t.config.ecdhMaxTimeout)return t.logger.info("kms: exceeded maximum KMS request retries"),l().reject(r);var o=2*n;return n>=t.config.kmsMaxTimeout&&o<t.config.ecdhMaxTimeout&&(t.logger.info("kms: exceeded maximum KMS request retries; negotiating new ecdh key"),xs.delete(t),n=0),t.request(e,{timeout:n,onBehalfOf:i})}return l().reject(r)}))},_getAuthorization:function(){return this.webex.credentials.getUserToken("spark:kms").then((function(e){return e.access_token}))},_getContext:function(){var e=this,t=xs.get(this);return t||(t=this._prepareContext(),xs.set(this,t),t.then((function(t){var r=t.ephemeralKey.expirationDate-j()()-3e4;(0,H.Lr)((function(){return xs.delete(e)}),r)}))),l().all([t,this._getAuthorization()]).then((function(e){var t=(0,D.Z)(e,2),r=t[0],n=t[1];return r.clientInfo.credential.bearer=n,r}))},_getKMSCluster:function(){return this.logger.info("kms: retrieving KMS cluster"),this._getKMSDetails().then((function(e){return e.kmsCluster}))},_getKMSDetails:function(){var e=this,t=As.get(this);return t||(this.logger.info("kms: fetching KMS details"),t=this.webex.request({service:"encryption",resource:"/kms/".concat(this.webex.internal.device.userId)}).then((function(t){e.logger.info("kms: fetched KMS details");var r=t.body;return r.rsaPublicKey=JSON.parse(r.rsaPublicKey),r})).catch((function(t){return e.logger.error("kms: failed to fetch KMS details",t),l().reject(t)})),As.set(this,t)),t},_getKMSStaticPubKey:function(){return this.logger.info("kms: retrieving KMS static public key"),this._getKMSDetails().then((function(e){return e.rsaPublicKey}))},_prepareContext:function(){var e=this;this.logger.info("kms: creating context");var t=new G.Context;return l().all([this._getKMSStaticPubKey().then(Ss(this.config.caroots)),this._getAuthorization()]).then((function(r){var n=(0,D.Z)(r,2),i=n[0],o=n[1];return t.clientInfo={clientId:e.webex.internal.device.url,credential:{userId:e.webex.internal.device.userId,bearer:o}},t.serverInfo={key:i},e.logger.info("kms: creating local ephemeral key"),t.createECDHKey()})).then((function(r){return t.ephemeralKey=r,Is.set(e,t),l().all([r.asKey(),e._getKMSCluster()])})).then((function(t){var r=(0,D.Z)(t,2),n=r[0],i=r[1];return e.logger.info("kms: submitting ephemeral key request"),e.request({uri:"".concat(i,"/ecdhe"),method:"create",jwk:n.toJSON()})})).then((function(r){return e.logger.info("kms: deriving final ephemeral key"),t.deriveEphemeralKey(r.key)})).then((function(r){return t.ephemeralKey=r,Is.delete(e),e.logger.info("kms: derived final ephemeral key"),t})).catch((function(t){return e.logger.error("kms: failed to negotiate ephemeral key",t),l().reject(t)}))},_contextOnBehalfOf:function(e,t){var r=new G.Context;return r.clientInfo=r.clientInfo={clientId:e.clientInfo.clientId,credential:{userId:t,onBehalfOf:t,bearer:e.clientInfo.credential.bearer}},r.serverInfo=e.serverInfo,r.ephemeralKey=e.ephemeralKey,r},version:"0.0.0-next"},(0,M.Z)(Ts,"fetchKey",[_s],v()(Ts,"fetchKey"),Ts),(0,M.Z)(Ts,"_getContext",[R.oneFlight],v()(Ts,"_getContext"),Ts),Ts));const ks=Rs;function Os(e,t){var r=f()(e);if(m()){var n=m()(e);t&&(n=n.filter((function(t){return v()(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ns(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Os(Object(r),!0).forEach((function(t){(0,T.Z)(e,t,r[t])})):b()?w()(e,b()(r)):Os(Object(r)).forEach((function(t){_()(e,t,v()(r,t))}))}return e}function Ps(e,t){return"jwk"===e?this[e].toJSON(!0):t}const Ls=d._y.extend({children:{kms:ks},namespace:"Encryption",processKmsMessageEvent:function(e){return this.kms.processKmsMessageEvent(e)},decryptBinary:function(e,t){return L(t).then((function(r){return 0===t.length||0===t.byteLength?l().reject(new Error("Attempted to decrypt zero-length buffer")):e.decrypt(r)}))},decryptScr:function(e,t,r){return this.getKey(e,r).then((function(e){return P().fromJWE(e.jwk,t)}))},decryptText:function(e,t,r){return this.getKey(e,r).then((function(e){return O().JWE.createDecrypt(e.jwk).decrypt(t).then((function(e){return e.plaintext.toString()}))}))},download:function(e,t,r){var n=this;if(!e||!t)return l().reject(new Error("`scr` and `fileUrl` are required"));var i=new I.EventEmitter,o=this._fetchDownloadUrl(e,r).then((function(e){var t={method:"GET",uri:e,responseType:"buffer"},r=n.request(t);return(0,R.transferEvents)("progress",t.download,i),r})).then((function(e){return n.decryptBinary(t,e.body)}));return(0,R.proxyEvents)(i,o),o},_fetchDownloadUrl:function(e,t){var r=this;this.logger.info("encryption: retrieving download url for encrypted file");var n={endpoints:[e]},i=C.parse(e);return i.protocol="https",i.pathname="/v1/download/endpoints",this.request({method:"POST",uri:C.format(i),body:t?Ns(Ns({},n),{},{allow:t.params.allow}):n}).then((function(t){var n=t.body.endpoints[e];return n?(r.logger.info("encryption: retrieved download url for encrypted file"),n):(r.logger.warn("encryption: could not determine download url for `fileUrl`; attempting to download `fileUrl` directly"),e)})).catch((function(t){return r.logger.warn("encryption: ".concat(t," could not determine download url for ").concat(e,"; attempting to download ").concat(e," directly")),e}))},encryptBinary:function(e){return L(e).then((function(e){return P().create().then((function(t){return t.encrypt(e).then(L).then((function(e){return{scr:t,cdata:e}}))}))}))},encryptScr:function(e,t,r){return t.loc?this.getKey(e,r).then((function(e){return t.toJWE(e.jwk)})):l().reject(new Error("Cannot encrypt `scr` without first setting `loc`"))},encryptText:function(e,t,r){var n=this;return this.getKey(e,r).then((function(e){return O().JWE.createEncrypt(n.config.joseOptions,{key:e.jwk,header:{alg:"dir"},reference:null}).final(t,"utf8")}))},getKey:function(e){var t=this,r=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).onBehalfOf;if(e.jwk)return this.kms.asKey(e);var n=e;return r&&(n+="/onBehalfOf/".concat(r)),this.unboundedStorage.get(n).then((function(e){return JSON.parse(e)})).then((function(e){return t.kms.asKey(e)})).catch((function(){return t.kms.fetchKey({uri:e,onBehalfOf:r}).then((0,R.tap)((function(e){return t.unboundedStorage.put(n,A()(e,Ps))})))}))},version:"0.0.0-next"});r(18338);(0,d.t4)("encryption",Ls,{payloadTransformer:{predicates:[{name:"encryptKmsMessage",direction:"outbound",test:function(e,t){return c()(t,"body.kmsMessage")&&s()(t.body.kmsMessage)?t.body.kmsMessage.keyUris&&0===t.body.kmsMessage.keyUris.length||t.body.kmsMessage.resourceUri&&(t.body.kmsMessage.resourceUri.includes("<KRO>")||t.body.kmsMessage.resourceUri.includes("<KEYURL>"))||t.body.kmsMessage.uri&&(t.body.kmsMessage.uri.includes("<KRO>")||t.body.kmsMessage.uri.includes("<KEYURL>"))?l().resolve(!1):l().resolve(!0):l().resolve(!1)},extract:function(e){return l().resolve(e.body)}},{name:"decryptKmsMessage",direction:"inbound",test:function(e,t){return l().resolve(c()(t,"body.kmsMessage")&&i()(t.body.kmsMessage))},extract:function(e){return l().resolve(e.body)}},{name:"decryptErrorResponse",direction:"inbound",test:function(e,t){return l().resolve(Boolean(t.body&&19e5===t.body.errorCode))},extract:function(e){return l().resolve(e)}}],transforms:[{name:"encryptKmsMessage",fn:function(e,t){return t&&t.kmsMessage?i()(t.kmsMessage)?l().resolve():e.webex.internal.encryption.kms.prepareRequest(t.kmsMessage).then((function(e){t.kmsMessage=e.wrapped})):l().resolve()}},{name:"decryptKmsMessage",fn:function(e,t){return e.webex.internal.encryption.kms.decryptKmsMessage(t.kmsMessage).then((function(e){t.kmsMessage=e}))}},{name:"decryptErrorResponse",fn:function(e,t){var r=t.body.errors.map((function(t){return e.webex.internal.encryption.kms.decryptKmsMessage(t.description).then((function(e){t.description=e}))}));return r.push(e.webex.internal.encryption.kms.decryptKmsMessage(t.body.message).then((function(e){t.body.message=e}))),l().all(r).then((function(){return l().reject(new ae(t))}))}}]},interceptors:undefined,config:{encryption:{joseOptions:{compact:!0,contentAlg:"A256GCM",protect:"*"},kmsInitialTimeout:6e3,kmsMaxTimeout:32e3,ecdhMaxTimeout:96e3,batcherWait:50,batcherMaxCalls:50,batcherMaxWait:150}}})},50819:(e,t,r)=>{"use strict";r(21408);var n=r(47683),i=r(43174),o=r.n(i),s=r(73473),a=r.n(s),c=r(71544),u=r.n(c),l=(r(22899),n._y.extend({namespace:"Feature",getFeature:function(e,t,r){if("developer"!==e&&"user"!==e&&"entitlement"!==e)return a().reject(new Error("Invalid feature keyType provided. Only `developer`, `user`, and `entitlement` feature toggles are permitted."));r=r||{};var n=this.webex.internal.device.features[e].get(t);return n?r.full?a().resolve(n.serialize()):a().resolve(n.value):a().resolve(null)},handleFeatureUpdate:function(e){if(e&&e.data){var t=e.data.featureToggle,r=t.type.toLowerCase();"user"!==r&&"developer"!==r||this.webex.internal.device.features[r].add([t],{merge:!0})}},listen:function(){this.listenTo(this.webex.internal.mercury,"event:featureToggle_update",this.handleFeatureUpdate)},setFeature:function(e,t,r){var n=this;return"developer"!==e&&"user"!==e?a().reject(new Error("Only `developer` and `user` feature toggles can be set.")):this.request({method:"POST",api:"feature",resource:"features/users/".concat(this.webex.internal.device.userId,"/").concat(e),body:{key:t,mutable:!0,val:r}}).then((function(t){return n.webex.internal.device.features[e].add(t.body,{merge:!0})}))},setBundledFeatures:function(e){var t=this;return e.forEach((function(e){e.mutable=e.mutable||"true","USER"!==e.type&&"DEV"!==e.type&&(e.type="USER")})),this.request({method:"POST",api:"feature",resource:"features/users/".concat(this.webex.internal.device.userId,"/toggles"),body:e}).then((function(e){var r=o()(e.body.featureToggles,{type:"USER"});t.webex.internal.device.features.user.add(r[0],{merge:!0}),t.webex.internal.device.features.developer.add(r[1],{merge:!0})}))},initialize:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];u()(n._y.prototype.initialize,this,t),this.listenToAndRun(this.webex,"change:internal.device.features.developer",this.trigger.bind(this,"change:developer")),this.listenToAndRun(this.webex,"change:internal.device.features.entitlement",this.trigger.bind(this,"change:entitlement")),this.listenToAndRun(this.webex,"change:internal.device.features.user",this.trigger.bind(this,"change:user"))}}));const d=l;(0,n.t4)("feature",d,{config:{feature:{}}})},21408:(e,t,r)=>{"use strict";r(22899),r(50819),r(60996);var n=r(47683),i=r(62680),o=r.n(i),s=r(6919),a=r.n(s),c=r(93364),u=r.n(c),l=r(26771),d=r.n(l),h=r(77193),f=r(14917),p=r(2313),m=r(36968),g=r.n(m),v=r(27361),y=r.n(v),b=r(68929),E=r.n(b),w=r(73473),S=r.n(w),_=r(26243),T=r.n(_),x=r(18428),A=r.n(x),I=r(67857),C=r.n(I),R=r(66130),k=r.n(R),O=r(95366),N=r.n(O),P=r(8575),L=r(18408),D=r(25144),M=r(63755),U=r.n(M),B=r(8167),F=r(31314),j=r(23710),V=r(69678),H=r(26305),G=r(35002),q=r(13218),$=r.n(q),Z=r(18721),z=r.n(Z),K=r(91747),W=r.n(K),J=r(83977),Y=r.n(J),Q=r(79873),X=r.n(Q),ee=r(79529),te=r.n(ee),re=r(8450),ne=r.n(re),ie=r(17187),oe=r(51707),se=r(55877),ae=r.n(se);function ce(e){var t=function(){if("undefined"==typeof Reflect||!U())return!1;if(U().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(U()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,G.Z)(e);if(t){var i=(0,G.Z)(this).constructor;r=U()(n,arguments,i)}else r=n.apply(this,arguments);return(0,H.Z)(this,r)}}var ue=function(e){(0,V.Z)(r,e);var t=ce(r);function r(){return(0,B.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r,[{key:"parse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return u()(this,{code:{value:e.code},reason:{value:e.reason}}),e.reason}}]),r}(L.Exception);(0,h.Z)(ue,"defaultMessage","Failed to connect to socket");var le=function(e){(0,V.Z)(r,e);var t=ce(r);function r(){return(0,B.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r)}(ue);(0,h.Z)(le,"defaultMessage","UnknownResponse is produced by IE when we receive a 4XXX. You probably want to treat this like a NotFound");var de=function(e){(0,V.Z)(r,e);var t=ce(r);function r(){return(0,B.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r)}(ue);(0,h.Z)(de,"defaultMessage","BadRequest usually implies an attempt to use service account credentials");var he=function(e){(0,V.Z)(r,e);var t=ce(r);function r(){return(0,B.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r)}(ue);(0,h.Z)(he,"defaultMessage","Please refresh your access token");var fe=function(e){(0,V.Z)(r,e);var t=ce(r);function r(){return(0,B.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r)}(ue);function pe(e){var t=function(){if("undefined"==typeof Reflect||!U())return!1;if(U().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(U()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,G.Z)(e);if(t){var i=(0,G.Z)(this).constructor;r=U()(n,arguments,i)}else r=n.apply(this,arguments);return(0,H.Z)(this,r)}}(0,h.Z)(fe,"defaultMessage","Forbidden usually implies these credentials are not entitled for Webex");var me=new(Y()),ge=function(e){(0,V.Z)(r,e);var t=pe(r);function r(){var e;return(0,B.Z)(this,r),(e=t.call(this))._domain="unknown-domain",e.onmessage=e.onmessage.bind((0,j.Z)(e)),e.onclose=e.onclose.bind((0,j.Z)(e)),e}return(0,F.Z)(r,[{key:"binaryType",get:function(){return me.get(this).binaryType}},{key:"bufferedAmount",get:function(){return me.get(this).bufferedAmount}},{key:"extensions",get:function(){return me.get(this).extensions}},{key:"protocol",get:function(){return me.get(this).protocol}},{key:"readyState",get:function(){return me.get(this).readyState}},{key:"url",get:function(){return me.get(this).url}},{key:"close",value:function(e){var t=this;return new(S())((function(r,n){var i=me.get(t);if(i){if(t.logger.info("socket,".concat(t._domain,": closing")),2===i.readyState||3===i.readyState)return t.logger.info("socket,".concat(t._domain,": already closed")),void r();if((e=e||{}).code&&1e3!==e.code&&(e.code<3e3||e.code>4999))n(new Error("`options.code` must be 1000 or between 3000 and 4999 (inclusive)"));else{e=W()(e,{code:1e3,reason:"Done"});var o=(0,oe.Lr)((function(){try{t.logger.info("socket,".concat(t._domain,": no close event received, forcing closure")),r(t.onclose({code:1e3,reason:"Done (forced)"}))}catch(e){t.logger.warn("socket,".concat(t._domain,": force-close failed"),e)}}),t.forceCloseDelay);i.onclose=function(e){t.logger.info("socket,".concat(t._domain,": close event fired"),e.code,e.reason),clearTimeout(o),t.onclose(e),r(e)},i.close(e.code,e.reason)}}else r()}))}},{key:"open",value:function(e,t){var n=this;try{this._domain=new URL(e).hostname}catch(t){this._domain=e}return new(S())((function(i,o){if(e)if(me.get(n))o(new Error("Socket#open() can only be called once per instance"));else{t=t||{},(0,L.checkRequired)(["forceCloseDelay","pingInterval","pongTimeout","token","trackingId","logger"],t),T()(t).forEach((function(e){X()(n,e,{enumerable:!1,value:t[e]})}));var s=r.getWebSocketConstructor();n.logger.info("socket,".concat(n._domain,": creating WebSocket"));var a=new s(e,[],t);a.binaryType="arraybuffer",a.onmessage=n.onmessage,a.onclose=function(e){switch(e=n._fixCloseCode(e),n.logger.info("socket,".concat(n._domain,": closed before open"),e.code,e.reason),e.code){case 1005:return o(new le(e));case 4400:return o(new de(e));case 4401:return o(new he(e));case 4403:return o(new fe(e));default:return o(new ue(e))}},a.onopen=function(){n.logger.info("socket,".concat(n._domain,": connected")),n._authorize().then((function(){n.logger.info("socket,".concat(n._domain,": authorized")),a.onclose=n.onclose,i()})).catch(o)},a.onerror=function(e){n.logger.warn("socket,".concat(n._domain,": error event fired"),e)},me.set(n,a),n.logger.info("socket,".concat(n._domain,": waiting for server"))}else o(new Error("`url` is required"))}))}},{key:"onclose",value:function(e){this.logger.info("socket,".concat(this._domain,": closed"),e.code,e.reason),clearTimeout(this.pongTimer),clearTimeout(this.pingTimer),e=this._fixCloseCode(e),this.emit("close",e),this.removeAllListeners()}},{key:"onmessage",value:function(e){try{var t=JSON.parse(e.data),r=te()(t.sequenceNumber,10);this.logger.debug("socket,".concat(this._domain,": sequence number: "),r),this.expectedSequenceNumber&&r!==this.expectedSequenceNumber&&(this.logger.debug("socket,".concat(this._domain,": sequence number mismatch indicates lost mercury message. expected: ").concat(this.expectedSequenceNumber,", actual: ").concat(r)),this.emit("sequence-mismatch",r,this.expectedSequenceNumber)),this.expectedSequenceNumber=r+1;var n={data:t};this._acknowledge(n),"pong"===t.type?this.emit("pong",n):this.emit("message",n)}catch(e){this.logger.warn("socket,".concat(this._domain,": error while receiving WebSocket message"),e)}}},{key:"send",value:function(e){var t=this;return new(S())((function(r,n){return 1!==t.readyState?n(new Error("INVALID_STATE_ERROR")):($()(e)&&(e=ne()(e)),me.get(t).send(e),r())}))}},{key:"_acknowledge",value:function(e){return e?z()(e,"data.id")?this.send({messageId:e.data.id,type:"ack"}):S().reject(new Error("`event.data.id` is required")):S().reject(new Error("`event` is required"))}},{key:"_authorize",value:function(){var e=this;return new(S())((function(t){e.logger.info("socket,".concat(e._domain,": authorizing")),e.send({id:ae().v4(),type:"authorization",data:{token:e.token},trackingId:e.trackingId,logLevelToken:e.logLevelToken});e.once("message",(function r(n){n.data.type||"mercury.buffer_state"!==n.data.data.eventType&&"mercury.registration_status"!==n.data.data.eventType||(e.removeListener("message",r),e._ping(),t())}))}))}},{key:"_fixCloseCode",value:function(e){if(1005===e.code&&e.reason)switch(e.reason.toLowerCase()){case"replaced":this.logger.info("socket,".concat(this._domain,": fixing CloseEvent code for reason: "),e.reason),e.code=4e3;break;case"authentication failed":case"authentication did not happen within the timeout window of 30000 seconds.":this.logger.info("socket,".concat(this._domain,": fixing CloseEvent code for reason: "),e.reason),e.code=1008}return e}},{key:"_ping",value:function(e){var t=this;e=e||ae().v4();var r=performance.now();return this.pongTimer=(0,oe.Lr)((function(){try{t.logger.info("socket,".concat(t._domain,": pong not receive in expected period, closing socket")),t.close({code:1e3,reason:"Pong not received"}).catch((function(e){t.logger.warn("socket,".concat(t._domain,": failed to close socket after missed pong"),e)}))}catch(e){t.logger.error("socket,".concat(t._domain,": error occurred in onPongNotReceived"),e)}}),this.pongTimeout),this.once("pong",(function(){try{clearTimeout(t.pongTimer),t.pingTimer=(0,oe.Lr)((function(){return t._ping()}),t.pingInterval)}catch(e){t.logger.error("socket,".concat(t._domain,": error occurred in scheduleNextPingAndCancelPongTimer"),e)}})),this.once("pong",(function(r){try{t.logger.debug("socket,".concat(t._domain,": pong"),r.data.id),r.data&&r.data.id!==e&&(t.logger.info("socket,".concat(t._domain,": received pong for wrong ping id, closing socket")),t.logger.debug("socket,".concat(t._domain,": expected"),e,"received",r.data.id),t.close({code:1e3,reason:"Pong mismatch"}))}catch(e){t.logger.error("socket,".concat(t._domain,": error occurred in confirmPongId"),e)}})),this.once("pong",(function(){return function(e){var r=performance.now()-e;t.logger.debug("socket,".concat(t._domain,": latency: "),r),t.emit("ping-pong-latency",r)}(r)})),this.logger.debug("socket,".concat(this._domain,": ping ").concat(e)),this.send({id:e,type:"ping"})}}],[{key:"getWebSocketConstructor",value:function(){throw new Error("Socket.getWebSocketConstructor() must be implemented in an environmentally appropriate way")}}]),r}(ie.EventEmitter);ge.getWebSocketConstructor=function(){var e;return"undefined"!=typeof WebSocket?e=WebSocket:"undefined"!=typeof MozWebSocket?e=MozWebSocket:void 0!==r.g?e=r.g.WebSocket||r.g.MozWebSocket:"undefined"!=typeof window?e=window.WebSocket||window.MozWebSocket:"undefined"!=typeof self&&(e=self.WebSocket||self.MozWebSocket),e};const ve=ge;var ye,be,Ee;function we(e,t){var r=T()(e);if(o()){var n=o()(e);t&&(n=n.filter((function(t){return N()(e,t).enumerable}))),r.push.apply(r,n)}return r}function Se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?we(Object(r),!0).forEach((function(t){(0,h.Z)(e,t,r[t])})):a()?u()(e,a()(r)):we(Object(r)).forEach((function(t){d()(e,t,N()(r,t))}))}return e}var _e=["idle","done (forced)","pong not received","pong mismatch"];const Te=n._y.extend((ye=(0,L.deprecated)("Mercury#listen(): Use Mercury#connect() instead"),be=(0,L.deprecated)("Mercury#stopListening(): Use Mercury#disconnect() instead"),Ee={namespace:"Mercury",session:{connected:{default:!1,type:"boolean"},connecting:{default:!1,type:"boolean"},socket:"object",localClusterServiceUrls:"object"},derived:{listening:{deps:["connected"],fn:function(){return this.connected}}},connect:function(e){var t=this;return this.connected?(this.logger.info("".concat(this.namespace,": already connected, will not connect again")),S().resolve()):(this.connecting=!0,S().resolve(this.webex.internal.device.registered||this.webex.internal.device.register()).then((function(){return t.logger.info("".concat(t.namespace,": connecting")),t._connectWithBackoff(e)})))},disconnect:function(){var e=this;return new(S())((function(t){e.backoffCall&&(e.logger.info("".concat(e.namespace,": aborting connection")),e.backoffCall.abort()),e.socket&&(e.socket.removeAllListeners("message"),e.once("offline",t),t(e.socket.close())),t()}))},listen:function(){return this.connect()},stopListening:function(){return this.disconnect()},processRegistrationStatusEvent:function(e){this.localClusterServiceUrls=e.localClusterServiceUrls},_applyOverrides:function(e){e&&e.headers&&T()(e.headers).forEach((function(t){g()(e,t,e.headers[t])}))},_prepareUrl:function(e){var t=this;return e||(e=this.webex.internal.device.webSocketUrl),this.webex.internal.feature.getFeature("developer","web-high-availability").then((function(r){return r?t.webex.internal.services.convertUrlToPriorityHostUrl(e):e})).then((function(t){e=t})).then((function(){return t.webex.internal.feature.getFeature("developer","web-shared-mercury")})).then((function(r){return e=P.parse(e,!0),A()(e.query,{outboundWireFormat:"text",bufferStates:!0,aliasHttpStatus:!0}),r&&(A()(e.query,{mercuryRegistrationStatus:!0,isRegistrationRefreshEnabled:!0}),C()(e.query,"bufferStates")),y()(t,"webex.config.device.ephemeral",!1)&&(e.query.multipleConnections=!0),P.format(e)}))},_attemptConnection:function(e,t){var r,n=this,i=new ve;i.on("close",(function(){return n._onclose.apply(n,arguments)})),i.on("message",(function(){return n._onmessage.apply(n,arguments)})),i.on("sequence-mismatch",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n._emit.apply(n,["sequence-mismatch"].concat(t))})),i.on("ping-pong-latency",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n._emit.apply(n,["ping-pong-latency"].concat(t))})),S().all([this._prepareUrl(e),this.webex.credentials.getUserToken()]).then((function(e){var t=(0,f.Z)(e,2),o=t[0],s=t[1];if(!n.backoffCall){var a="".concat(n.namespace,": prevent socket open when backoffCall no longer defined");return n.logger.info(a),S().reject(new Error(a))}r=o;var c={forceCloseDelay:n.config.forceCloseDelay,pingInterval:n.config.pingInterval,pongTimeout:n.config.pongTimeout,token:s.toString(),trackingId:"".concat(n.webex.sessionId,"_").concat(k()()),logger:n.logger};return n.webex.config.defaultMercuryOptions&&(n.logger.info("".concat(n.namespace,": setting custom options")),c=Se(Se({},c),n.webex.config.defaultMercuryOptions)),n.socket=i,n.logger.info("".concat(n.namespace," connection url: ").concat(o)),i.open(o,c)})).then((function(){return n.logger.info("".concat(n.namespace,": connected to mercury, success, action: connected, url: ").concat(r)),t(),n.webex.internal.feature.getFeature("developer","web-high-availability").then((function(e){return e?n.webex.internal.device.refresh():S().resolve()}))})).catch((function(e){return 1006!==e.code&&n.backoffCall&&n.backoffCall.getNumRetries()>0&&n._emit("connection_failed",e,{retries:n.backoffCall.getNumRetries()}),n.logger.info("".concat(n.namespace,": connection attempt failed"),e),e instanceof le?(n.logger.info("".concat(n.namespace,": received unknown response code, refreshing device registration")),n.webex.internal.device.refresh().then((function(){return t(e)}))):e instanceof he?(n.logger.info("".concat(n.namespace,": received authorization error, reauthorizing")),n.webex.credentials.refresh({force:!0}).then((function(){return t(e)}))):e instanceof de||e instanceof fe?(n.logger.warn("".concat(n.namespace,": received unrecoverable response from mercury")),n.backoffCall.abort(),t(e)):e instanceof ue?n.webex.internal.feature.getFeature("developer","web-high-availability").then((function(t){return t?(n.logger.info("".concat(n.namespace,": received a generic connection error, will try to connect to another datacenter. failed, action: 'failed', url: ").concat(r," error: ").concat(e.message)),n.webex.internal.services.markFailedUrl(r)):null})).then((function(){return t(e)})):t(e)})).catch((function(e){n.logger.error("".concat(n.namespace,": failed to handle connection failure"),e),t(e)}))},_connectWithBackoff:function(e){var t=this;return new(S())((function(r,n){var i;(i=D.call((function(r){t.logger.info("".concat(t.namespace,": executing connection attempt ").concat(i.getNumRetries())),t._attemptConnection(e,r)}),(function(e){return t.connecting=!1,t.backoffCall=void 0,e?(t.logger.info("".concat(t.namespace,": failed to connect after ").concat(i.getNumRetries()," retries; log statement about next retry was inaccurate; ").concat(e)),n(e)):(t.connected=!0,t._emit("online"),r())}))).setStrategy(new D.ExponentialStrategy({initialDelay:t.config.backoffTimeReset,maxDelay:t.config.backoffTimeMax})),t.config.maxRetries&&i.failAfter(t.config.maxRetries),i.on("abort",(function(){t.logger.info("".concat(t.namespace,": connection aborted")),n(new Error("Mercury Connection Aborted"))})),i.on("callback",(function(e){if(e){var r=i.getNumRetries(),n=Math.min(i.strategy_.nextBackoffDelay_,t.config.backoffTimeMax);t.logger.info("".concat(t.namespace,": failed to connect; attempting retry ").concat(r+1," in ").concat(n," ms"))}else t.logger.info("".concat(t.namespace,": connected"))})),i.start(),t.backoffCall=i}))},_emit:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];try{this.trigger.apply(this,t)}catch(e){this.logger.error("".concat(this.namespace,": error occurred in event handler"),{error:e,arguments:t})}},_getEventHandlers:function(e){var t=e.split("."),r=(0,f.Z)(t,2),n=r[0],i=r[1],o=[];if(!this.webex[n]&&!this.webex.internal[n])return o;var s=E()("process_".concat(i,"_event"));return(this.webex[n]||this.webex.internal[n])[s]&&o.push({name:s,namespace:n}),o},_onclose:function(e){try{var t=e.reason&&e.reason.toLowerCase(),r=this.socket.url;switch(this.socket.removeAllListeners(),this.unset("socket"),this.connected=!1,this._emit("offline",e),e.code){case 1003:this.logger.info("".concat(this.namespace,": Mercury service rejected last message; will not reconnect: ").concat(e.reason)),this._emit("offline.permanent",e);break;case 4e3:this.logger.info("".concat(this.namespace,": socket replaced; will not reconnect")),this._emit("offline.replaced",e);break;case 1001:case 1005:case 1006:case 1011:this.logger.info("".concat(this.namespace,": socket disconnected; reconnecting")),this._emit("offline.transient",e),this._reconnect(r);break;case 1e3:_e.includes(t)?(this.logger.info("".concat(this.namespace,": socket disconnected; reconnecting")),this._emit("offline.transient",e),this._reconnect(r)):(this.logger.info("".concat(this.namespace,": socket disconnected; will not reconnect")),this._emit("offline.permanent",e));break;default:this.logger.info("".concat(this.namespace,": socket disconnected unexpectedly; will not reconnect")),this._emit("offline.permanent",e)}}catch(e){this.logger.error("".concat(this.namespace,": error occurred in close handler"),e)}},_onmessage:function(e){var t=this,r=e.data;({ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}).ENABLE_MERCURY_LOGGING&&this.logger.debug("".concat(this.namespace,": message envelope: "),r);var n=r.data;return this._applyOverrides(n),this._getEventHandlers(n.eventType).reduce((function(e,r){return e.then((function(){var e=r.namespace,i=r.name;return new(S())((function(r){return r((t.webex[e]||t.webex.internal[e])[i](n))})).catch((function(e){return t.logger.error("".concat(t.namespace,": error occurred in autowired event handler for ").concat(n.eventType),e)}))}))}),S().resolve()).then((function(){t._emit("event",e.data);var i=n.eventType.split("."),o=(0,f.Z)(i,1)[0];o===n.eventType?t._emit("event:".concat(o),r):(t._emit("event:".concat(o),r),t._emit("event:".concat(n.eventType),r))})).catch((function(e){t.logger.error("".concat(t.namespace,": error occurred processing socket message"),e)}))},_reconnect:function(e){return this.logger.info("".concat(this.namespace,": reconnecting")),this.connect(e)},version:"0.0.0-next"},(0,p.Z)(Ee,"connect",[L.oneFlight],N()(Ee,"connect"),Ee),(0,p.Z)(Ee,"disconnect",[L.oneFlight],N()(Ee,"disconnect"),Ee),(0,p.Z)(Ee,"listen",[ye],N()(Ee,"listen"),Ee),(0,p.Z)(Ee,"stopListening",[be],N()(Ee,"stopListening"),Ee),Ee)),xe={mercury:{pingInterval:{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.MERCURY_PING_INTERVAL||15e3,pongTimeout:{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.MERCURY_PONG_TIMEOUT||14e3,backoffTimeMax:{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.MERCURY_BACKOFF_TIME_MAX||32e3,backoffTimeReset:{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.MERCURY_BACKOFF_TIME_RESET||1e3,forceCloseDelay:{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.MERCURY_FORCE_CLOSE_DELAY||2e3}};(0,n.t4)("mercury",Te,{config:xe,onBeforeLogout:function(){return this.disconnect()}})},60996:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CALL_DIAGNOSTIC_CONFIG:()=>n,CallDiagnosticUtils:()=>i,NewMetrics:()=>Dt,Utils:()=>o,config:()=>S,default:()=>Z,getOSNameInternal:()=>$});var n={};r.r(n),r.d(n,{AUTHENTICATION_FAILED_CODE:()=>Ae,BROWSER_MEDIA_ERROR_NAME_TO_CLIENT_ERROR_CODES_MAP:()=>Ze,CALL_DIAGNOSTIC_EVENT_FAILED_TO_SEND:()=>Ye,CALL_DIAGNOSTIC_LOG_IDENTIFIER:()=>xe,CLIENT_ERROR_CODE_TO_ERROR_PAYLOAD:()=>Je,DTLS_HANDSHAKE_FAILED_CLIENT_CODE:()=>Pe,ERROR_DESCRIPTIONS:()=>Ke,ICE_FAILED_WITHOUT_TURN_TLS_CLIENT_CODE:()=>De,ICE_FAILED_WITH_TURN_TLS_CLIENT_CODE:()=>Le,ICE_FAILURE_CLIENT_CODE:()=>Oe,MEETING_INFO_LOOKUP_ERROR_CLIENT_CODE:()=>Re,MISSING_ROAP_ANSWER_CLIENT_CODE:()=>Ne,NETWORK_ERROR:()=>Ie,NEW_LOCUS_ERROR_CLIENT_CODE:()=>Ce,SDP_OFFER_CREATION_ERROR_MAP:()=>ze,SERVICE_ERROR_CODES_TO_CLIENT_ERROR_CODES_MAP:()=>We,UNKNOWN_ERROR:()=>ke,WBX_APP_API_URL:()=>Me,WEBEX_SUB_SERVICE_TYPES:()=>Ue});var i={};r.r(i),r.d(i,{anonymizeIPAddress:()=>nt,clearEmptyKeysRecursively:()=>ot,extractVersionMetadata:()=>mt,generateClientErrorCodeForIceFailure:()=>gt,getBuildType:()=>ht,isBrowserMediaErrorName:()=>dt,isLocusServiceErrorCode:()=>st,isMeetingInfoServiceError:()=>at,isNetworkError:()=>ct,isSdpOfferCreationError:()=>lt,isUnauthorizedError:()=>ut,prepareDiagnosticMetricItem:()=>ft,setMetricTimings:()=>pt,userAgentToString:()=>it});var o={};r.r(o),r.d(o,{generateCommonErrorMetadata:()=>bt});r(22899);var s=r(47683),a=r(26243),c=r.n(a),u=r(62680),l=r.n(u),d=r(95366),h=r.n(d),f=r(6919),p=r.n(f),m=r(93364),g=r.n(m),v=r(26771),y=r.n(v),b=r(77193),E=r(18408),w="webex-js-sdk";const S={device:{preDiscoveryServices:{metricsServiceUrl:{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.METRICS_SERVICE_URL||"https://metrics-a.wbx2.com/metrics/api/v1",metrics:{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.METRICS_SERVICE_URL||"https://metrics-a.wbx2.com/metrics/api/v1"}},metrics:{appType:E.inBrowser?"browser":"nodejs",batcherWait:500,batcherMaxCalls:50,batcherMaxWait:1500,batcherRetryPlateau:32e3,waitForServiceTimeout:30}};var _={WINDOWS:"windows",MAC:"mac",IOS:"ios",ANDROID:"android",CHROME:"chrome",LINUX:"linux",OTHERS:"other"},T={"Chrome OS":_.CHROME,macOS:_.MAC,Windows:_.WINDOWS,iOS:_.IOS,Android:_.ANDROID,Linux:_.LINUX},x=r(14917),A=r(85579),I=r.n(A),C=r(66130),R=r.n(C),k=r(73473),O=r.n(k),N=r(71544),P=r.n(N),L=r(51707),D=I()("metric id");const M=s.mr.extend({namespace:"Metrics",prepareItem:function(e){return e.appType=e.appType||this.config.appType,e.env=e.env||null,e.time=e.time||R()(),e.version=e.version||this.webex.version,O().resolve(e)},prepareRequest:function(e){return O().resolve(e.map((function(e){return e.postTime=e.postTime||R()(),e})))},submitHttpRequest:function(e){return this.webex.request({method:"POST",service:"metrics",resource:"metrics",body:{metrics:e},waitForServiceTimeout:this.webex.config.metrics.waitForServiceTimeout})},handleHttpSuccess:function(e){var t=this;return O().all(e.options.body.metrics.map((function(e){return t.acceptItem(e)})))},handleHttpError:function(e){var t=this;return e instanceof s.Ff.NetworkOrCORSError?(this.logger.warn("metrics-batcher: received network error submitting metrics, reenqueuing payload"),O().all(e.options.body.metrics.map((function(e){return new(O())((function(r){var n=e[D].nextDelay;n<t.config.batcherRetryPlateau&&(e[D].nextDelay*=2),(0,L.Lr)((function(){r(t.rerequest(e))}),n)}))})))):P()(s.mr.prototype.handleHttpError,this,[e])},rerequest:function(e){var t=this;return O().all([this.getDeferredForRequest(e),this.prepareItem(e)]).then((function(e){var r=(0,x.Z)(e,2),n=r[0],i=r[1];t.enqueue(i).then((function(){return t.bounce()})).catch((function(e){return n.reject(e)}))}))},fingerprintRequest:function(e){return e[D]=e[D]||{nextDelay:1e3},O().resolve(e[D])},fingerprintResponse:function(e){return O().resolve(e[D])}});const U=M.extend({namespace:"Metrics",prepareItem:function(e){return O().resolve(e)},prepareRequest:function(e){return O().resolve(e)},submitHttpRequest:function(e){return this.webex.request({method:"POST",service:"metrics",resource:"clientmetrics",body:{metrics:e},waitForServiceTimeout:this.webex.config.metrics.waitForServiceTimeout})}});function B(e,t){var r=c()(e);if(l()){var n=l()(e);t&&(n=n.filter((function(t){return h()(e,t).enumerable}))),r.push.apply(r,n)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?B(Object(r),!0).forEach((function(t){(0,b.Z)(e,t,r[t])})):p()?g()(e,p()(r)):B(Object(r)).forEach((function(t){y()(e,t,h()(r,t))}))}return e}var j=(0,E.BrowserDetection)(),V=j.getOSName,H=j.getOSVersion,G=j.getBrowserName,q=j.getBrowserVersion;function $(){var e;return null!==(e=T[V()])&&void 0!==e?e:_.OTHERS}const Z=s._y.extend({children:{batcher:M,clientMetricsBatcher:U},namespace:"Metrics",submit:function(e,t){return this.batcher.request(F({key:e},t))},getClientMetricsPayload:function(e,t){if(!e)throw Error("Missing behavioral metric name. Please provide one");var r,n,i,o,s,a,c,u={metricName:e};return u.tags=F(F({},t.tags),{},{browser:G(),os:$(),domain:"undefined"!=typeof window&&window.location.hostname||"non-browser"}),u.fields=F(F({},t.fields),{},{browser_version:q(),os_version:H(),sdk_version:this.webex.version,platform:"Web",spark_user_agent:(r=this.webex,i=null!==(n=null==r?void 0:r.config)&&void 0!==n?n:{},o=i.appName,s=i.appVersion,a=i.appPlatform,c=w,o&&(c+=" ".concat(o,"/").concat(null!=s?s:"0.0")),a&&(c+=" ".concat(a)),c),client_id:this.webex.credentials.config.client_id}),u.type=t.type||this.webex.config.metrics.type,u.context=F(F({},t.context),{},{app:{version:this.webex.version},locale:"en-US",os:{name:$(),version:H()}}),t.eventPayload&&(u.eventPayload=t.eventPayload),u.timestamp=(new Date).valueOf(),u},submitClientMetrics:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=this.getClientMetricsPayload(e,t);if(r){var i={metrics:[n]};return this.postPreLoginMetric(i,r)}return this.clientMetricsBatcher.request(n)},aliasUser:function(e){return this.request({method:"POST",api:"metrics",resource:"clientmetrics",headers:{"x-prelogin-userid":e},body:{},qs:{alias:!0}})},postPreLoginMetric:function(e,t){var r=this;return this.webex.credentials.getClientToken().then((function(n){return r.request({method:"POST",api:"metrics",resource:"clientmetrics-prelogin",headers:{authorization:n.toString(),"x-prelogin-userid":t},body:e})}))},version:"0.0.0-next"});var z,K=r(63755),W=r.n(K),J=r(66250),Y=r(8167),Q=r(31314),X=r(23710),ee=r(69678),te=r(26305),re=r(35002),ne=r(33453),ie=r.n(ne),oe=r(82492),se=r.n(oe),ae=r(8450),ce=r.n(ae),ue=r(55877),le=r.n(ue),de=r(21882),he=r(13682),fe=r(41609),pe=r.n(fe),me=r(78149),ge=r.n(me),ve=r(18428),ye=r.n(ve),be=r(79529),Ee=r.n(be),we=r(93917),Se=r.n(we),_e=r(89539),Te=r.n(_e),xe="call-diagnostic-events -> ",Ae=1010,Ie=1026,Ce=4008,Re=4100,ke=9999,Oe=2004,Ne=2007,Pe=2008,Le=2010,De=2009,Me="wbxappapi",Ue={PMR:"PMR",SCHEDULED_MEETING:"ScheduledMeeting",WEBINAR:"Webinar"},Be="PermissionDeniedError",Fe="NotAllowedError",je="NotReadableError",Ve="AbortError",He="NotFoundError",Ge="OverconstrainedError",qe="SecurityError",$e="TypeError",Ze=(0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)({},Be,4032),Fe,4032),je,2729),Ve,2729),He,2729),Ge,2729),qe,2729),$e,2729),ze={GENERAL:2050,SDP_MUNGE_MISSING_CODECS:2051},Ke={UNKNOWN_CALL_FAILURE:"UnknownCallFailure",LOCUS_RATE_LIMITED_INCOMING:"LocusRateLimitedIncoming",LOCUS_RATE_LIMITED_OUTGOING:"LocusRateLimitedOutgoing",LOCUS_UNAVAILABLE:"LocusUnavailable",LOCUS_CONFLICT:"LocusConflict",TIMEOUT:"Timeout",LOCUS_INVALID_SEQUENCE_HASH:"LocusInvalidSequenceHash",AUTHENTICATION_FAILED:"AuthenticationFailed",NETWORK_ERROR:"NetworkError",UPDATE_MEDIA_FAILED:"UpdateMediaFailed",FAILED_TO_CONNECT_MEDIA:"FailedToConnectMedia",MEDIA_ENGINE_LOST:"MediaEngineLost",MEDIA_CONNECTION_LOST:"MediaConnectionLost",ICE_FAILURE:"IceFailure",MEDIA_ENGINE_HANG:"MediaEngineHang",ICE_SERVER_REJECTED:"IceServerRejected",CALL_FULL:"CallFull",ROOM_TOO_LARGE:"RoomTooLarge",GUEST_ALREADY_ADDED:"GuestAlreadyAdded",LOCUS_USER_NOT_AUTHORISED:"LocusUserNotAuthorised",CLOUDBERRY_UNAVAILABLE:"CloudberryUnavailable",ROOM_TOO_LARGE_FREE_ACCOUNT:"RoomTooLarge_FreeAccount",MEETING_INACTIVE:"MeetingInactive",MEETING_LOCKED:"MeetingLocked",MEETING_TERMINATING:"MeetingTerminating",MODERATOR_PIN_OR_GUEST_REQUIRED:"Moderator_Pin_Or_Guest_Required",MODERATOR_PIN_OR_GUEST_PIN_REQUIRED:"Moderator_Pin_Or_Guest_PIN_Required",MODERATOR_REQUIRED:"Moderator_Required",USER_NOT_MEMBER_OF_ROOM:"UserNotMemberOfRoom",NEW_LOCUS_ERROR:"NewLocusError",NETWORK_UNAVAILABLE:"NetworkUnavailable",MEETING_UNAVAILABLE:"MeetingUnavailable",MEETING_ID_INVALID:"MeetingIDInvalid",MEETING_SITE_INVALID:"MeetingSiteInvalid",LOCUS_INVALID_JOINTIME:"LocusInvalidJoinTime",LOBBY_EXPIRED:"LobbyExpired",MEDIA_CONNECTION_LOST_PAIRED:"MediaConnectionLostPaired",PHONE_NUMBER_NOT_A_NUMBER:"PhoneNumberNotANumber",PHONE_NUMBER_TOO_LONG:"PhoneNumberTooLong",INVALID_DIALABLE_KEY:"InvalidDialableKey",ONE_ON_ONE_TO_SELF_NOT_ALLOWED:"OneOnOneToSelfNotAllowed",REMOVED_PARTICIPANT:"RemovedParticipant",MEETING_LINK_NOT_FOUND:"MeetingLinkNotFound",PHONE_NUMBER_TOO_SHORT_AFTER_IDD:"PhoneNumberTooShortAfterIdd",INVALID_INVITEE_ADDRESS:"InvalidInviteeAddress",PMR_USER_ACCOUNT_LOCKED_OUT:"PMRUserAccountLockedOut",GUEST_FORBIDDEN:"GuestForbidden",PMR_ACCOUNT_SUSPENDED:"PMRAccountSuspended",EMPTY_PHONE_NUMBER_OR_COUNTRY_CODE:"EmptyPhoneNumberOrCountryCode",CONVERSATION_NOT_FOUND:"ConversationNotFound",SIP_CALLEE_BUSY:"SIPCalleeBusy",SIP_CALLEE_NOT_FOUND:"SIPCalleeNotFound",START_RECORDING_FAILED:"StartRecordingFailed",RECORDING_IN_PROGRESS_FAILED:"RecordingInProgressFailed",MEETING_INFO_LOOKUP_ERROR:"MeetingInfoLookupError",CALL_FULL_ADD_GUEST:"CallFullAddGuest",REQUIRE_WEBEX_LOGIN:"RequireWebexLogin",USER_NOT_ALLOWED_ACCESS_MEETING:"UserNotAllowedAccessMeeting",USER_NEEDS_ACTIVATION:"UserNeedsActivation",SIGN_UP_INVALID_EMAIL:"SignUpInvalidEmail",UNKNOWN_ERROR:"UnknownError",NO_MEDIA_FOUND:"NoMediaFound",STREAM_ERROR_NO_MEDIA:"StreamErrorNoMedia",CAMERA_PERMISSION_DENIED:"CameraPermissionDenied",FRAUD_DETECTION:"FraudDetection",E2EE_NOT_SUPPORTED:"E2EENotSupported",LOCUS_LOBBY_FULL_CMR:"LocusLobbyFullCMR",USER_NOT_INVITED_TO_JOIN:"UserNotInvitedToJoin",MISSING_ROAP_ANSWER:"MissingRoapAnswer",DTLS_HANDSHAKE_FAILED:"DTLSHandshakeFailed",ICE_FAILED_WITHOUT_TURN_TLS:"ICEFailedWithoutTURN_TLS",ICE_FAILED_WITH_TURN_TLS:"ICEFailedWithTURN_TLS",SDP_OFFER_CREATION_ERROR:"SdpOfferCreationError",SDP_OFFER_CREATION_ERROR_MISSING_CODEC:"SdpOfferCreationErrorMissingCodec"},We={58400:4100,99002:4100,99009:4100,58500:4100,400001:4100,403004:4005,403028:4005,403032:4005,403034:4036,403036:4005,403038:4005,403040:4100,403041:4005,403047:4101,403408:4101,403043:4005,403048:4101,403049:4101,403100:4101,403101:4036,403102:4036,403103:4036,403104:4101,404001:4101,404006:4100,423001:4005,423005:4005,423006:4005,423010:4005,423012:4005,423013:4005,429005:4100,2403001:3007,2403002:3002,2403003:3002,2403004:4001,2403018:3001,2403019:3001,2423003:4002,2423004:4003,2423005:4005,2423006:4005,2423016:4005,2423017:4005,2423018:4005,2423012:12e3,2423021:12001,2423007:4006,2403010:4007,2403014:4011,2403015:4012,2423010:4013,2400008:4016,2400011:4017,2400012:4018,2403007:4019,2401002:4020,2404002:4021,2400009:4022,2400025:4023,2423009:4024,2403022:4025,2423008:4026,2400006:4027,2400014:1006,2404001:4028,2403025:4029,2405001:4029,2409005:4029,2409062:12002,2423025:12003,100002:4102,100007:4102,100001:4103,100006:4103,100005:4103,100004:4103},Je=(z={1e3:{errorDescription:Ke.UNKNOWN_CALL_FAILURE,category:"signaling",fatal:!0,name:"locus.response"},1001:{errorDescription:Ke.LOCUS_RATE_LIMITED_INCOMING,category:"signaling",fatal:!0,name:"locus.response"},1002:{errorDescription:Ke.LOCUS_RATE_LIMITED_OUTGOING,category:"signaling",fatal:!0,name:"locus.response"},1003:{errorDescription:Ke.LOCUS_UNAVAILABLE,category:"signaling",fatal:!0,name:"locus.response"},1004:{errorDescription:Ke.LOCUS_CONFLICT,category:"signaling",fatal:!0,name:"locus.response"},1005:{errorDescription:Ke.TIMEOUT,category:"signaling",fatal:!0,name:"locus.response"},1006:{errorDescription:Ke.LOCUS_INVALID_SEQUENCE_HASH,category:"signaling",fatal:!0},1007:{errorDescription:Ke.UPDATE_MEDIA_FAILED,category:"signaling",fatal:!0}},(0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)(z,Ae,{errorDescription:Ke.AUTHENTICATION_FAILED,category:"network",fatal:!0}),1026,{errorDescription:Ke.NETWORK_ERROR,category:"network",fatal:!0}),2001,{errorDescription:Ke.FAILED_TO_CONNECT_MEDIA,category:"signaling",fatal:!0}),2002,{errorDescription:Ke.MEDIA_ENGINE_LOST,category:"signaling",fatal:!0}),2003,{errorDescription:Ke.MEDIA_CONNECTION_LOST,category:"signaling",fatal:!0}),Oe,{errorDescription:Ke.ICE_FAILURE,category:"media",fatal:!0}),2005,{errorDescription:Ke.MEDIA_ENGINE_HANG,category:"signaling",fatal:!0}),2006,{errorDescription:Ke.ICE_SERVER_REJECTED,category:"signaling",fatal:!0}),Ne,{errorDescription:Ke.MISSING_ROAP_ANSWER,category:"signaling",fatal:!0}),Pe,{errorDescription:Ke.DTLS_HANDSHAKE_FAILED,category:"media",fatal:!0}),(0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)(z,De,{errorDescription:Ke.ICE_FAILED_WITHOUT_TURN_TLS,category:"media",fatal:!0}),Le,{errorDescription:Ke.ICE_FAILED_WITH_TURN_TLS,category:"media",fatal:!0}),2050,{errorDescription:Ke.SDP_OFFER_CREATION_ERROR,category:"media",fatal:!0,shownToUser:!0}),2051,{errorDescription:Ke.SDP_OFFER_CREATION_ERROR_MISSING_CODEC,category:"expected",fatal:!0,shownToUser:!0}),3001,{errorDescription:Ke.CALL_FULL,category:"expected",fatal:!0}),3002,{errorDescription:Ke.ROOM_TOO_LARGE,category:"expected",fatal:!0}),3004,{errorDescription:Ke.GUEST_ALREADY_ADDED,category:"expected",fatal:!1}),3005,{errorDescription:Ke.LOCUS_USER_NOT_AUTHORISED,category:"expected",fatal:!0}),3006,{errorDescription:Ke.CLOUDBERRY_UNAVAILABLE,category:"expected",fatal:!0}),3007,{errorDescription:Ke.STREAM_ERROR_NO_MEDIA,category:"expected",fatal:!0}),(0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)(z,3013,{errorDescription:Ke.ROOM_TOO_LARGE_FREE_ACCOUNT,category:"expected",fatal:!1}),4001,{errorDescription:Ke.MEETING_INACTIVE,category:"expected",fatal:!0}),4002,{errorDescription:Ke.MEETING_LOCKED,category:"expected",fatal:!0,name:"locus.response"}),4003,{errorDescription:Ke.MEETING_TERMINATING,category:"expected",fatal:!0,name:"locus.leave"}),4004,{errorDescription:Ke.MODERATOR_PIN_OR_GUEST_REQUIRED,category:"expected",fatal:!1}),4005,{errorDescription:Ke.MODERATOR_PIN_OR_GUEST_PIN_REQUIRED,category:"expected",fatal:!1}),4006,{errorDescription:Ke.MODERATOR_REQUIRED,category:"expected",fatal:!1}),4007,{errorDescription:Ke.USER_NOT_MEMBER_OF_ROOM,category:"expected",fatal:!0}),4008,{errorDescription:Ke.NEW_LOCUS_ERROR,category:"signaling",fatal:!0}),4009,{errorDescription:Ke.NETWORK_UNAVAILABLE,category:"network",fatal:!0}),(0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)(z,4010,{errorDescription:Ke.MEETING_UNAVAILABLE,category:"expected",fatal:!0}),4011,{errorDescription:Ke.MEETING_ID_INVALID,category:"expected",fatal:!0}),4012,{errorDescription:Ke.MEETING_SITE_INVALID,category:"expected",fatal:!0}),4013,{errorDescription:Ke.LOCUS_INVALID_JOINTIME,category:"expected",fatal:!0}),4014,{errorDescription:Ke.LOBBY_EXPIRED,category:"expected",fatal:!0}),4015,{errorDescription:Ke.MEDIA_CONNECTION_LOST_PAIRED,category:"expected",fatal:!1}),4016,{errorDescription:Ke.PHONE_NUMBER_NOT_A_NUMBER,category:"expected",fatal:!0,name:"locus.response"}),4017,{errorDescription:Ke.PHONE_NUMBER_TOO_LONG,category:"expected",fatal:!0,name:"locus.response"}),4018,{errorDescription:Ke.INVALID_DIALABLE_KEY,category:"expected",fatal:!0,name:"locus.response"}),4019,{errorDescription:Ke.ONE_ON_ONE_TO_SELF_NOT_ALLOWED,category:"expected",fatal:!0}),(0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)(z,4020,{errorDescription:Ke.REMOVED_PARTICIPANT,category:"expected",fatal:!0}),4021,{errorDescription:Ke.MEETING_LINK_NOT_FOUND,category:"expected",fatal:!0}),4022,{errorDescription:Ke.PHONE_NUMBER_TOO_SHORT_AFTER_IDD,category:"expected",fatal:!0}),4023,{errorDescription:Ke.INVALID_INVITEE_ADDRESS,category:"expected",fatal:!0}),4024,{errorDescription:Ke.PMR_USER_ACCOUNT_LOCKED_OUT,category:"expected",fatal:!0}),4025,{errorDescription:Ke.GUEST_FORBIDDEN,category:"expected",fatal:!0}),4026,{errorDescription:Ke.PMR_ACCOUNT_SUSPENDED,category:"expected",fatal:!0}),4027,{errorDescription:Ke.EMPTY_PHONE_NUMBER_OR_COUNTRY_CODE,category:"expected",fatal:!0}),4028,{errorDescription:Ke.CONVERSATION_NOT_FOUND,category:"expected",fatal:!0}),4029,{errorDescription:Ke.START_RECORDING_FAILED,category:"expected",fatal:!0}),(0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)(z,4030,{errorDescription:Ke.RECORDING_IN_PROGRESS_FAILED,category:"expected",fatal:!0}),4032,{errorDescription:Ke.CAMERA_PERMISSION_DENIED,category:"expected",fatal:!0}),4036,{errorDescription:Ke.REQUIRE_WEBEX_LOGIN,category:"expected",fatal:!0}),5e3,{errorDescription:Ke.SIP_CALLEE_BUSY,category:"expected",fatal:!0}),5001,{errorDescription:Ke.SIP_CALLEE_NOT_FOUND,category:"expected",fatal:!0}),4100,{errorDescription:Ke.MEETING_INFO_LOOKUP_ERROR,category:"signaling",fatal:!0}),3003,{errorDescription:Ke.CALL_FULL_ADD_GUEST,category:"expected",fatal:!1}),4101,{errorDescription:Ke.USER_NOT_ALLOWED_ACCESS_MEETING,category:"expected",fatal:!0}),4102,{errorDescription:Ke.USER_NEEDS_ACTIVATION,category:"expected",fatal:!0}),4103,{errorDescription:Ke.SIGN_UP_INVALID_EMAIL,category:"expected",fatal:!0}),(0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)(z,2729,{errorDescription:Ke.NO_MEDIA_FOUND,category:"expected",fatal:!1}),9999,{errorDescription:Ke.UNKNOWN_ERROR,category:"other",fatal:!0}),12e3,{errorDescription:Ke.FRAUD_DETECTION,category:"expected",fatal:!0,name:"locus.response",shownToUser:!0}),12001,{errorDescription:Ke.LOCUS_LOBBY_FULL_CMR,category:"expected",fatal:!0,name:"locus.response",shownToUser:!0}),12002,{errorDescription:Ke.E2EE_NOT_SUPPORTED,category:"expected",fatal:!0,name:"locus.response",shownToUser:!0}),12003,{errorDescription:Ke.USER_NOT_INVITED_TO_JOIN,category:"expected",fatal:!0})),Ye="js_sdk_call_diagnostic_event_failed_to_send",Qe=(0,E.BrowserDetection)(),Xe=Qe.getOSName,et=Qe.getOSVersion,tt=Qe.getBrowserName,rt=Qe.getBrowserVersion,nt=function(e){return Se()(e,28,96)},it=function(e){var t,r,n=e.clientName,i=e.webexVersion,o=Te().format("client=%s","".concat(n));-1!==["chrome","firefox","msie","msedge","safari"].indexOf(tt().toLowerCase())&&(r=Te().format("browser=%s","".concat(tt().toLowerCase(),"/").concat(rt().split(".")[0])));var s=Te().format("os=%s","".concat(Xe(),"/").concat(et().split(".")[0]));return r&&(t="(".concat(r)),s&&(t=t?"".concat(t,"; ").concat(o,"; ").concat(s):"".concat(o,"; (").concat(s)),t?(t+=")",Te().format("webex-js-sdk/%s %s","".concat("production","-").concat(i),t)):Te().format("webex-js-sdk/%s","".concat("production","-").concat(i))},ot=function e(t){0!==c()(t).length&&c()(t).forEach((function(r){("object"===(0,he.Z)(t[r])||"string"==typeof t[r]||ge()(t[r]))&&pe()(t[r])&&delete t[r],ge()(t[r])&&(t[r]=(0,de.Z)(t[r].filter((function(e){return!!e})))),"object"===(0,he.Z)(t[r])&&e(t[r])}))},st=function(e){var t="".concat(e);return 7===t.length&&"2"===t.charAt(0)},at=function(e){var t,r,n,i;return!!(null!==(t=e.body)&&void 0!==t&&null!==(r=t.data)&&void 0!==r&&r.meetingInfo||null!==(n=e.body)&&void 0!==n&&null!==(i=n.url)&&void 0!==i&&i.includes(Me))},ct=function(e){return e instanceof s.Ff.NetworkOrCORSError},ut=function(e){return e instanceof s.Ff.Unauthorized},lt=function(e){return e.name===Ke.SDP_OFFER_CREATION_ERROR},dt=function(e){return!!Ze[e]},ht=function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||null!=e&&e.includes("localhost")||null!=e&&e.includes("127.0.0.1")?"test":"prod"},ft=function(e,t){var r,n,i,o,s,a,c,u,l={buildType:exports.getBuildType(null===(r=t.eventPayload)||void 0===r||null===(n=r.event)||void 0===n||null===(i=n.eventData)||void 0===i?void 0:i.webClientDomain,null===(o=t.eventPayload)||void 0===o||null===(s=o.event)||void 0===s||null===(a=s.eventData)||void 0===a?void 0:a.markAsTestEvent),networkType:"unknown"},d=null===(c=t.eventPayload)||void 0===c||null===(u=c.event)||void 0===u?void 0:u.name,h={},f={},p={},m=e.internal.newMetrics.callDiagnosticLatencies;switch(d){case"client.interstitial-window.launched":h.meetingInfoReqResp=m.getMeetingInfoReqResp(),h.clickToInterstitial=m.getClickToInterstitial();break;case"client.call.initiated":h.meetingInfoReqResp=m.getMeetingInfoReqResp(),h.showInterstitialTime=m.getShowInterstitialTime(),h.registerWDMDeviceJMT=m.getRegisterWDMDeviceJMT();break;case"client.locus.join.response":h.meetingInfoReqResp=m.getMeetingInfoReqResp(),h.callInitJoinReq=m.getCallInitJoinReq(),h.joinReqResp=m.getJoinReqResp(),h.joinReqSentReceived=m.getJoinRespSentReceived(),h.pageJmt=m.getPageJMT(),h.clickToInterstitial=m.getClickToInterstitial(),h.interstitialToJoinOK=m.getInterstitialToJoinOK(),h.totalJmt=m.getTotalJMT(),h.clientJmt=m.getClientJMT();break;case"client.ice.end":h.ICESetupTime=m.getICESetupTime(),h.audioICESetupTime=m.getAudioICESetupTime(),h.videoICESetupTime=m.getVideoICESetupTime(),h.shareICESetupTime=m.getShareICESetupTime();break;case"client.media.rx.start":h.localSDPGenRemoteSDPRecv=m.getLocalSDPGenRemoteSDPRecv();break;case"client.media-engine.ready":h.totalMediaJMT=m.getTotalMediaJMT(),h.interstitialToMediaOKJMT=m.getInterstitialToMediaOKJMT(),h.callInitMediaEngineReady=m.getCallInitMediaEngineReady(),h.stayLobbyTime=m.getStayLobbyTime();break;case"client.mediaquality.event":f.joinRespRxStart=m.getAudioJoinRespRxStart(),f.joinRespTxStart=m.getAudioJoinRespTxStart(),p.joinRespRxStart=m.getVideoJoinRespRxStart(),p.joinRespTxStart=m.getVideoJoinRespTxStart()}return pe()(h)||(t.eventPayload.event=se()(t.eventPayload.event,{joinTimes:h})),pe()(f)||(t.eventPayload.event=se()(t.eventPayload.event,{audioSetupDelay:f})),pe()(p)||(t.eventPayload.event=se()(t.eventPayload.event,{videoSetupDelay:p})),t.eventPayload.origin=ye()(l,t.eventPayload.origin),e.logger.log("CallDiagnosticLatencies,prepareDiagnosticMetricItem: ".concat(ce()({latencies:Object.fromEntries(m.latencyTimestamps),event:t}))),t},pt=function(e){if(e.body&&e.json){var t,r=JSON.parse(e.body),n=(new Date).toISOString();null===(t=r.metrics)||void 0===t||t.forEach((function(e){e.eventPayload&&(e.eventPayload.originTime={triggered:n,sent:n})})),e.body=ce()(r)}return e},mt=function(e){var t=e.split("."),r=(0,x.Z)(t,2),n=r[0],i=r[1];return{majorVersion:Ee()(n,10),minorVersion:Ee()(i,10)}},gt=function(e){var t=e.signalingState,r=e.iceConnectionState,n=e.turnServerUsed,i=Oe;return"have-local-offer"===t&&(i=Ne),"stable"===t&&"connected"===r&&(i=Pe),"have-local-offer"!==t&&"connected"!==r&&(i=n?Le:De),i},vt=r(73955),yt=r.n(vt),bt=function(e){return e instanceof Error?ce()({message:null==e?void 0:e.message,name:null==e?void 0:e.name,stack:null==e?void 0:e.stack}):e};const Et=M.extend({namespace:"Metrics",prepareItem:function(e){return O().resolve(ft(this.webex,e))},prepareRequest:function(e){return e.forEach((function(e){e.eventPayload.originTime=e.eventPayload.originTime||{},e.eventPayload.originTime.sent=(new Date).toISOString()})),O().resolve(e)},submitHttpRequest:function(e){var t=this,r=yt()("ca-batch-");return this.webex.request({method:"POST",service:"metrics",resource:"clientmetrics",body:{metrics:e},waitForServiceTimeout:this.webex.config.metrics.waitForServiceTimeout}).then((function(e){return t.webex.logger.log(xe,"CallDiagnosticEventsBatcher: @submitHttpRequest#".concat(r,". Request successful.")),e})).catch((function(e){return t.webex.logger.error(xe,"CallDiagnosticEventsBatcher: @submitHttpRequest#".concat(r,". Request failed:"),"error: ".concat(bt(e))),O().reject(e)}))}});function wt(e,t){var r=c()(e);if(l()){var n=l()(e);t&&(n=n.filter((function(t){return h()(e,t).enumerable}))),r.push.apply(r,n)}return r}function St(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wt(Object(r),!0).forEach((function(t){(0,b.Z)(e,t,r[t])})):p()?g()(e,p()(r)):wt(Object(r)).forEach((function(t){y()(e,t,h()(r,t))}))}return e}function _t(e){var t=function(){if("undefined"==typeof Reflect||!W())return!1;if(W().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(W()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,re.Z)(e);if(t){var i=(0,re.Z)(this).constructor;r=W()(n,arguments,i)}else r=n.apply(this,arguments);return(0,te.Z)(this,r)}}var Tt=(0,E.BrowserDetection)(),xt=Tt.getOSVersion,At=Tt.getBrowserName,It=Tt.getBrowserVersion,Ct=function(e){(0,ee.Z)(n,e);var t,r=_t(n);function n(){var e;(0,Y.Z)(this,n);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return e=r.call.apply(r,[this].concat(i)),(0,b.Z)((0,X.Z)(e),"callDiagnosticEventsBatcher",void 0),(0,b.Z)((0,X.Z)(e),"logger",void 0),(0,b.Z)((0,X.Z)(e),"hasLoggedBrowserSerial",void 0),(0,b.Z)((0,X.Z)(e),"validator",(function(e){return O().resolve({event:null==e?void 0:e.event,valid:!0})})),(0,b.Z)((0,X.Z)(e),"submitToCallDiagnosticsPreLogin",(function(t,r){var n=ft(e.webex,{eventPayload:t,type:["diagnostic-event"]});return n.eventPayload.originTime.sent=(new Date).toISOString(),e.webex.internal.newMetrics.postPreLoginMetric(n,r)})),e.logger=e.webex.logger,e.callDiagnosticEventsBatcher=new Et({},{parent:e.webex}),e}return(0,Q.Z)(n,[{key:"getCurLoginType",value:function(){return this.webex.canAuthorize?this.webex.credentials.isUnverifiedGuest?"unverified-guest":"login-ci":null}},{key:"getIsConvergedArchitectureEnabled",value:function(e){var t=e.meetingId;if(t){var r,n=this.webex.meetings.meetingCollection.get(t);return null==n||null===(r=n.meetingInfo)||void 0===r?void 0:r.enableConvergedArchitecture}}},{key:"getSubServiceType",value:function(e){if(e){var t=null==e?void 0:e.meetingInfo;if((null==t||!t.webexScheduled)&&(null==t||!t.enableEvent)&&null!=t&&t.pmr)return Ue.PMR;if(null!=t&&t.webexScheduled&&(null==t||!t.enableEvent)&&(null==t||!t.pmr))return Ue.SCHEDULED_MEETING;if(null!=t&&t.webexScheduled&&null!=t&&t.enableEvent&&(null==t||!t.pmr))return Ue.WEBINAR}}},{key:"getOrigin",value:function(e,t){var r,n,i,o,s,a,c=null===(r=this.webex.meetings.config)||void 0===r||null===(n=r.metrics)||void 0===n?void 0:n.clientType,u=null===(i=this.webex.meetings.config)||void 0===i||null===(o=i.metrics)||void 0===o?void 0:o.subClientType,l=null===(s=this.webex.meetings.config)||void 0===s||null===(a=s.metrics)||void 0===a?void 0:a.clientVersion,d="".concat(w,"/").concat(this.webex.version),h={};if(l&&(h=mt(l)),this.hasLoggedBrowserSerial||(this.logger.log(xe,"CallDiagnosticMetrics: @createClientEventObjectInMeeting => collected browser data",ce()((0,E.getBrowserSerial)())),this.hasLoggedBrowserSerial=!0),c&&u||e.clientType&&e.subClientType){var f,p,m,g,v,y,b={name:"endpoint",networkType:(null==e?void 0:e.networkType)||"unknown",userAgent:it({clientName:null===(f=this.webex.meetings)||void 0===f||null===(p=f.config)||void 0===p||null===(m=p.metrics)||void 0===m?void 0:m.clientName,webexVersion:this.webex.version}),clientInfo:St(St({clientType:(null==e?void 0:e.clientType)||c,clientVersion:l||d},h),{},{publicNetworkPrefix:nt(null===(g=this.webex.meetings.geoHintInfo)||void 0===g?void 0:g.clientAddress)||void 0,localNetworkPrefix:nt(null===(v=this.webex.meetings.meetingCollection.get(t))||void 0===v||null===(y=v.statsAnalyzer)||void 0===y?void 0:y.getLocalIpAddress())||void 0,osVersion:xt()||"unknown",subClientType:(null==e?void 0:e.subClientType)||u,os:$(),browser:At(),browserVersion:It()})};if(t){var S=this.webex.meetings.meetingCollection.get(t);null!=S&&S.environment&&(b.environment=S.environment)}return null!=e&&e.environment&&(b.environment=e.environment),null!=e&&e.newEnvironment&&(b.newEnvironment=e.newEnvironment),null!=e&&e.clientLaunchMethod&&(b.clientInfo.clientLaunchMethod=e.clientLaunchMethod),b}throw new Error("ClientType and SubClientType can't be undefined")}},{key:"getIdentifiers",value:function(e){var t,r,n,i,o,s,a,c,u,l,d,h=e.meeting,f=e.mediaConnections,p=e.correlationId,m=e.webexConferenceIdStr,g=e.globalMeetingId,v=e.preLoginId,y={correlationId:"unknown"};if(h&&(y.correlationId=h.correlationId),p&&(y.correlationId=p),this.webex.internal){var b=this.webex.internal.device;y.userId=b.userId||v,y.deviceId=b.url,y.orgId=b.orgId,y.locusUrl=this.webex.internal.services.get("locus")}(null!=h&&null!==(t=h.locusInfo)&&void 0!==t&&t.fullState&&(y.locusUrl=h.locusUrl,y.locusId=h.locusUrl&&h.locusUrl.split("/").pop(),y.locusStartTime=h.locusInfo.fullState&&h.locusInfo.fullState.lastActive),null!=h&&null!==(r=h.meetingInfo)&&void 0!==r&&r.confIdStr||null!=h&&null!==(n=h.meetingInfo)&&void 0!==n&&n.confID)&&(y.webexConferenceIdStr="".concat((null===(s=h.meetingInfo)||void 0===s?void 0:s.confIdStr)||(null===(a=h.meetingInfo)||void 0===a?void 0:a.confID)));null!=h&&null!==(i=h.meetingInfo)&&void 0!==i&&i.meetingId&&(y.globalMeetingId=null===(c=h.meetingInfo)||void 0===c?void 0:c.meetingId);null!=h&&null!==(o=h.meetingInfo)&&void 0!==o&&o.siteName&&(y.webexSiteName=null===(u=h.meetingInfo)||void 0===u?void 0:u.siteName);f&&(y.mediaAgentAlias=null==f||null===(l=f[0])||void 0===l?void 0:l.mediaAgentAlias,y.mediaAgentGroupId=null==f||null===(d=f[0])||void 0===d?void 0:d.mediaAgentGroupId);if(null!=y&&y.webexConferenceIdStr||!m||(y.webexConferenceIdStr="".concat(m)),null!=y&&y.globalMeetingId||!g||(y.globalMeetingId=g),void 0===y.correlationId)throw new Error("Identifiers initialization failed.");return y}},{key:"prepareDiagnosticEvent",value:function(e,t){var r,n=t.meetingId,i=this.getOrigin(t,n),o={eventId:le().v4(),version:1,origin:i,originTime:{triggered:(new Date).toISOString(),sent:"not_defined_yet"},senderCountryCode:null===(r=this.webex.meetings.geoHintInfo)||void 0===r?void 0:r.countryCode,event:e};return"client.mediaquality.event"!==e.name&&ot(o),o}},{key:"submitFeatureEvent",value:function(){throw Error("Not implemented")}},{key:"submitMQE",value:function(e){var t=e.name,r=e.payload,n=e.options,i=n.meetingId,o=n.mediaConnections,s=n.webexConferenceIdStr,a=n.globalMeetingId;if(!i)throw new Error("Media quality events cant be sent outside the context of a meeting. Meeting id is required.");var c=this.webex.meetings.meetingCollection.get(i);if(!c)return console.warn("Attempt to send MQE but no meeting was found...","event: ".concat(t,", meetingId: ").concat(i)),void this.webex.internal.metrics.submitClientMetrics(Ye,{fields:{meetingId:i,name:t}});var u={name:t,canProceed:!0,identifiers:this.getIdentifiers({meeting:c,mediaConnections:c.mediaConnections||o,webexConferenceIdStr:s,globalMeetingId:a}),eventData:{webClientDomain:window.location.hostname},intervals:r.intervals,sourceMetadata:{applicationSoftwareType:w,applicationSoftwareVersion:this.webex.version,mediaEngineSoftwareType:At()||"browser",mediaEngineSoftwareVersion:xt()||"unknown",startTime:(new Date).toISOString()}};u=se()(u,r);var l=this.prepareDiagnosticEvent(u,n);this.validator({type:"mqe",event:l}),this.submitToCallDiagnostics(l)}},{key:"getErrorPayloadForClientErrorCode",value:function(e){var t=e.clientErrorCode,r=e.serviceErrorCode,n=e.serviceErrorName,i=e.rawErrorMessage,o=e.payloadOverrides;if(t){var s=Je[t];if(s)return se()({fatal:!0,shownToUser:!1,name:"other",category:"other"},{errorCode:t},n?{errorData:{errorName:n}}:{},{serviceErrorCode:r},{rawErrorMessage:i},s,o||{})}}},{key:"generateClientEventErrorPayload",value:function(e){var t,r,n,i,o,s,a=e.message;if(e.name&&dt(e.name))return this.getErrorPayloadForClientErrorCode({serviceErrorCode:void 0,clientErrorCode:Ze[e.name],serviceErrorName:e.name,rawErrorMessage:a});if(lt(e)){var c,u=null===(c=e.cause)||void 0===c?void 0:c.type;return this.getErrorPayloadForClientErrorCode({serviceErrorCode:void 0,clientErrorCode:ze[u]||ze.GENERAL,serviceErrorName:e.name,rawErrorMessage:a})}var l=(null==e||null===(t=e.error)||void 0===t||null===(r=t.body)||void 0===r?void 0:r.errorCode)||(null==e||null===(n=e.body)||void 0===n?void 0:n.errorCode)||(null==e||null===(i=e.body)||void 0===i?void 0:i.code)||(null==e||null===(o=e.body)||void 0===o||null===(s=o.reason)||void 0===s?void 0:s.reasonCode);if(l){var d=We[l];if(d)return this.getErrorPayloadForClientErrorCode({clientErrorCode:d,serviceErrorCode:l,rawErrorMessage:a});if(st(l))return this.getErrorPayloadForClientErrorCode({clientErrorCode:Ce,serviceErrorCode:l,rawErrorMessage:a})}return at(e)?this.getErrorPayloadForClientErrorCode({clientErrorCode:Re,serviceErrorCode:l,rawErrorMessage:a}):ct(e)?this.getErrorPayloadForClientErrorCode({clientErrorCode:Ie,serviceErrorCode:l,payloadOverrides:e.payloadOverrides,rawErrorMessage:a}):ut(e)?this.getErrorPayloadForClientErrorCode({clientErrorCode:Ae,serviceErrorCode:l,payloadOverrides:e.payloadOverrides,rawErrorMessage:a}):this.getErrorPayloadForClientErrorCode({clientErrorCode:ke,serviceErrorCode:ke,rawErrorMessage:a})}},{key:"createClientEventObjectInMeeting",value:function(e){var t=e.name,r=e.options,n=e.errors,i=r.meetingId,o=r.mediaConnections,s=r.globalMeetingId,a=r.webexConferenceIdStr,c=this.webex.meetings.meetingCollection.get(i);return c?{name:t,canProceed:!0,identifiers:this.getIdentifiers({meeting:c,mediaConnections:(null==c?void 0:c.mediaConnections)||o,webexConferenceIdStr:a,globalMeetingId:s}),errors:n,eventData:{webClientDomain:window.location.hostname},userType:c.getCurUserType(),loginType:"loginType"in c.callStateForMetrics?c.callStateForMetrics.loginType:this.getCurLoginType(),isConvergedArchitectureEnabled:this.getIsConvergedArchitectureEnabled({meetingId:i}),webexSubServiceType:this.getSubServiceType(c)}:(console.warn("Attempt to send client event but no meeting was found...","name: ".concat(t,", meetingId: ").concat(i)),void this.webex.internal.metrics.submitClientMetrics(Ye,{fields:{meetingId:i,name:t}}))}},{key:"createClientEventObjectPreMeeting",value:function(e){var t=e.name,r=e.options,n=e.errors,i=r.correlationId,o=r.globalMeetingId,s=r.webexConferenceIdStr,a=r.preLoginId;return{name:t,errors:n,canProceed:!0,identifiers:this.getIdentifiers({correlationId:i,preLoginId:a,globalMeetingId:o,webexConferenceIdStr:s}),eventData:{webClientDomain:window.location.hostname},loginType:this.getCurLoginType()}}},{key:"prepareClientEvent",value:function(e){var t,r=e.name,n=e.payload,i=e.options,o=i.meetingId,s=i.correlationId,a=i.rawError,c=[];if(a){var u=this.generateClientEventErrorPayload(a);u&&c.push(u),this.logger.log(xe,"CallDiagnosticMetrics: @prepareClientEvent. Generated errors:","generatedError: ".concat(ce()(u)))}if(o)t=this.createClientEventObjectInMeeting({name:r,options:i,errors:c});else{if(!s)throw new Error("Not implemented");t=this.createClientEventObjectPreMeeting({name:r,options:i,errors:c})}return t=se()(t,n),this.prepareDiagnosticEvent(t,i)}},{key:"submitClientEvent",value:function(e){var t=e.name,r=e.payload,n=e.options;this.logger.log(xe,"CallDiagnosticMetrics: @submitClientEvent. Submit Client Event CA event.","name: ".concat(t));var i=this.prepareClientEvent({name:t,payload:r,options:n});return null!=n&&n.preLoginId?this.submitToCallDiagnosticsPreLogin(i,null==n?void 0:n.preLoginId):(this.validator({type:"ce",event:i}),this.submitToCallDiagnostics(i))}},{key:"submitToCallDiagnostics",value:function(e){var t={eventPayload:e,type:["diagnostic-event"]};return this.callDiagnosticEventsBatcher.request(t)}},{key:"buildClientEventFetchRequestOptions",value:(t=(0,J.Z)(ie().mark((function e(t){var r,n,i,o,s,a;return ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.name,n=t.payload,i=t.options,this.logger.log(xe,"CallDiagnosticMetrics: @buildClientEventFetchRequestOptions. Building request options object for fetch()...","name: ".concat(r)),o=this.prepareClientEvent({name:r,payload:n,options:i}),s=ft(this.webex,{eventPayload:o,type:["diagnostic-event"]}),a={method:"POST",service:"metrics",resource:"clientmetrics",body:{metrics:[s]},headers:{},waitForServiceTimeout:this.webex.internal.metrics.config.waitForServiceTimeout},i.preLoginId&&(a.headers={authorization:!1,"x-prelogin-userid":i.preLoginId},a.resource="clientmetrics-prelogin"),e.abrupt("return",this.webex.prepareFetchOptions(a));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"isServiceErrorExpected",value:function(e){var t=We[e],r=Je[t];return"expected"===(null==r?void 0:r.category)}}]),n}(s.XR),Rt=r(18281),kt=r.n(Rt);function Ot(e){var t=function(){if("undefined"==typeof Reflect||!W())return!1;if(W().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(W()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,re.Z)(e);if(t){var i=(0,re.Z)(this).constructor;r=W()(n,arguments,i)}else r=n.apply(this,arguments);return(0,te.Z)(this,r)}}var Nt=function(e){(0,ee.Z)(r,e);var t=Ot(r);function r(){var e;(0,Y.Z)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,b.Z)((0,X.Z)(e),"latencyTimestamps",void 0),(0,b.Z)((0,X.Z)(e),"precomputedLatencies",void 0),(0,b.Z)((0,X.Z)(e),"meetingId",void 0),e.latencyTimestamps=new(kt()),e.precomputedLatencies=new(kt()),e}return(0,Q.Z)(r,[{key:"clearTimestamps",value:function(){this.latencyTimestamps.clear()}},{key:"setMeetingId",value:function(e){this.meetingId=e}},{key:"getMeeting",value:function(){if(this.meetingId)return this.webex.meetings.meetingCollection.get(this.meetingId)}},{key:"saveTimestamp",value:function(e){var t=e.key,r=e.value,n=void 0===r?(new Date).getTime():r,i=e.options,o=(void 0===i?{}:i).meetingId;o&&this.setMeetingId(o),"client.media.rx.start"===t||"client.media.tx.start"===t||"internal.client.meetinginfo.request"===t||"internal.client.meetinginfo.response"===t?this.saveFirstTimestampOnly(t,n):this.latencyTimestamps.set(t,n)}},{key:"saveLatency",value:function(e,t){this.precomputedLatencies.set(e,t)}},{key:"saveFirstTimestampOnly",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(new Date).getTime();this.latencyTimestamps.has(e)||this.latencyTimestamps.set(e,t)}},{key:"getDiffBetweenTimestamps",value:function(e,t){var r=this.latencyTimestamps.get(e),n=this.latencyTimestamps.get(t);if(r&&n)return n-r}},{key:"getMeetingInfoReqResp",value:function(){return this.getDiffBetweenTimestamps("internal.client.meetinginfo.request","internal.client.meetinginfo.response")}},{key:"getShowInterstitialTime",value:function(){return this.getDiffBetweenTimestamps("client.interstitial-window.start-launch","internal.client.interstitial-window.click.joinbutton")}},{key:"getRegisterWDMDeviceJMT",value:function(){return this.getDiffBetweenTimestamps("internal.register.device.request","internal.register.device.response")}},{key:"getCallInitJoinReq",value:function(){return this.getDiffBetweenTimestamps("internal.client.interstitial-window.click.joinbutton","client.locus.join.request")}},{key:"getJoinReqResp",value:function(){return this.getDiffBetweenTimestamps("client.locus.join.request","client.locus.join.response")}},{key:"getJoinRespSentReceived",value:function(){}},{key:"getTurnDiscoveryTime",value:function(){return this.getDiffBetweenTimestamps("internal.client.add-media.turn-discovery.start","internal.client.add-media.turn-discovery.end")}},{key:"getLocalSDPGenRemoteSDPRecv",value:function(){return this.getDiffBetweenTimestamps("client.media-engine.local-sdp-generated","client.media-engine.remote-sdp-received")}},{key:"getICESetupTime",value:function(){return this.getDiffBetweenTimestamps("client.ice.start","client.ice.end")}},{key:"getAudioICESetupTime",value:function(){return this.getDiffBetweenTimestamps("client.ice.start","client.ice.end")}},{key:"getVideoICESetupTime",value:function(){return this.getDiffBetweenTimestamps("client.ice.start","client.ice.end")}},{key:"getShareICESetupTime",value:function(){return this.getDiffBetweenTimestamps("client.ice.start","client.ice.end")}},{key:"getStayLobbyTime",value:function(){return this.getDiffBetweenTimestamps("client.locus.join.response","internal.host.meeting.participant.admitted")}},{key:"getPageJMT",value:function(){return this.precomputedLatencies.get("internal.client.pageJMT")||void 0}},{key:"getClickToInterstitial",value:function(){return this.latencyTimestamps.get("internal.client.meeting.click.joinbutton")?this.getDiffBetweenTimestamps("internal.client.meeting.click.joinbutton","internal.client.meeting.interstitial-window.showed"):this.precomputedLatencies.get("internal.click.to.interstitial")||void 0}},{key:"getInterstitialToJoinOK",value:function(){return this.getDiffBetweenTimestamps("internal.client.interstitial-window.click.joinbutton","client.locus.join.response")}},{key:"getCallInitMediaEngineReady",value:function(){return this.getDiffBetweenTimestamps("internal.client.interstitial-window.click.joinbutton","client.media-engine.ready")}},{key:"getInterstitialToMediaOKJMT",value:function(){var e=this.latencyTimestamps.get("internal.client.interstitial-window.click.joinbutton"),t=this.latencyTimestamps.get("client.ice.end"),r=this.getStayLobbyTime()||0;if(e&&t)return t-e-r}},{key:"getTotalJMT",value:function(){var e=this.getClickToInterstitial(),t=this.getInterstitialToJoinOK();if(e&&t)return e+t}},{key:"getJoinConfJMT",value:function(){var e=this.getJoinReqResp(),t=this.getICESetupTime();if(e&&t)return e+t}},{key:"getTotalMediaJMT",value:function(){var e=this.getClickToInterstitial(),t=this.getInterstitialToJoinOK(),r=this.getJoinConfJMT(),n=this.getStayLobbyTime();if(e&&t&&r){var i,o=e+t+r;return null!==(i=this.getMeeting())&&void 0!==i&&i.allowMediaInLobby?o:o-n}}},{key:"getClientJMT",value:function(){var e=this.getInterstitialToJoinOK(),t=this.getJoinConfJMT();if(e&&t)return e-t}},{key:"getAudioJoinRespRxStart",value:function(){return this.getDiffBetweenTimestamps("client.locus.join.response","client.media.rx.start")}},{key:"getVideoJoinRespRxStart",value:function(){return this.getDiffBetweenTimestamps("client.locus.join.response","client.media.rx.start")}},{key:"getAudioJoinRespTxStart",value:function(){return this.getDiffBetweenTimestamps("client.locus.join.response","client.media.tx.start")}},{key:"getVideoJoinRespTxStart",value:function(){return this.getDiffBetweenTimestamps("client.locus.join.response","client.media.tx.start")}}]),r}(s._y);function Pt(e){var t=function(){if("undefined"==typeof Reflect||!W())return!1;if(W().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(W()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,re.Z)(e);if(t){var i=(0,re.Z)(this).constructor;r=W()(n,arguments,i)}else r=n.apply(this,arguments);return(0,te.Z)(this,r)}}var Lt=function(e){(0,ee.Z)(n,e);var t,r=Pt(n);function n(){var e;(0,Y.Z)(this,n);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return e=r.call.apply(r,[this].concat(i)),(0,b.Z)((0,X.Z)(e),"callDiagnosticLatencies",void 0),(0,b.Z)((0,X.Z)(e),"callDiagnosticMetrics",void 0),e.onReady(),e}return(0,Q.Z)(n,[{key:"onReady",value:function(){var e=this;this.webex.once("ready",(function(){e.callDiagnosticMetrics=new Ct({},{parent:e.webex}),e.callDiagnosticLatencies=new Nt({},{parent:e.webex})}))}},{key:"submitInternalEvent",value:function(e){var t=e.name;e.payload,e.options;"internal.reset.join.latencies"===t?this.callDiagnosticLatencies.clearTimestamps():this.callDiagnosticLatencies.saveTimestamp({key:t})}},{key:"submitBehavioralEvent",value:function(e){var t=e.name;e.payload,e.options;throw this.callDiagnosticLatencies.saveTimestamp({key:t}),new Error("Not implemented.")}},{key:"submitOperationalEvent",value:function(e){e.name,e.payload,e.options;throw new Error("Not implemented.")}},{key:"submitMQE",value:function(e){var t=e.name,r=e.payload,n=e.options;this.callDiagnosticLatencies.saveTimestamp({key:t}),this.callDiagnosticMetrics.submitMQE({name:t,payload:r,options:n})}},{key:"submitFeatureEvent",value:function(e){e.name,e.payload,e.options;throw new Error("Not implemented.")}},{key:"submitClientEvent",value:function(e){var t=e.name,r=e.payload,n=e.options;return this.callDiagnosticLatencies&&this.callDiagnosticMetrics?(this.callDiagnosticLatencies.saveTimestamp({key:t,options:{meetingId:null==n?void 0:n.meetingId}}),this.callDiagnosticMetrics.submitClientEvent({name:t,payload:r,options:n})):(this.webex.logger.log("NewMetrics: @submitClientEvent. Attempted to submit before webex.ready. Event name: ".concat(t)),O().resolve())}},{key:"postPreLoginMetric",value:function(e,t){var r=this;return this.webex.request({method:"POST",api:"metrics",resource:"clientmetrics-prelogin",headers:{authorization:!1,"x-prelogin-userid":t},body:{metrics:[e]}}).then((function(e){return r.webex.logger.log("NewMetrics: @postPreLoginMetric. Request successful."),e})).catch((function(e){return r.logger.error("NewMetrics: @postPreLoginMetric. Request failed:","err: ".concat(bt(e))),O().reject(e)}))}},{key:"clientMetricsAliasUser",value:function(e){var t=this;return this.webex.request({method:"POST",api:"metrics",resource:"clientmetrics",headers:{"x-prelogin-userid":e},body:{},qs:{alias:!0}}).then((function(e){return t.webex.logger.log("NewMetrics: @clientMetricsAliasUser. Request successful."),e})).catch((function(e){return t.logger.error("NewMetrics: @clientMetricsAliasUser. Request failed:","err: ".concat(bt(e))),O().reject(e)}))}},{key:"buildClientEventFetchRequestOptions",value:(t=(0,J.Z)(ie().mark((function e(t){var r,n,i;return ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.name,n=t.payload,i=t.options,e.abrupt("return",this.callDiagnosticMetrics.buildClientEventFetchRequestOptions({name:r,payload:n,options:i}));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"setMetricTimingsAndFetch",value:function(e){return this.webex.setTimingsAndFetch(pt(e))}},{key:"isServiceErrorExpected",value:function(e){return this.callDiagnosticMetrics.isServiceErrorExpected(e)}}]),n}(s._y);(0,b.Z)(Lt,"instance",void 0);const Dt=Lt;(0,s.t4)("metrics",Z,{config:S}),(0,s.t4)("newMetrics",Dt,{config:S})},40600:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});r(22899);var n=r(47683),i=r(66250),o=r(91747),s=r.n(o),a=r(33453),c=r.n(a),u=r(55877),l=r.n(u);const d=n._y.extend({namespace:"Support",getFeedbackUrl:function(e){return e=e||{},this.request({method:"POST",api:"conversation",resource:"users/deskFeedbackUrl",body:s()(e,{appVersion:this.config.appVersion,appType:this.config.appType,feedbackId:e.feedbackId||l().v4(),languageCode:this.config.languageCode})}).then((function(e){return e.body.url}))},getSupportUrl:function(){return this.webex.request({method:"GET",api:"conversation",resource:"users/deskSupportUrl",qs:{languageCode:this.config.languageCode}}).then((function(e){return e.body.url}))},submitLogs:function(e,t){var r,n,o=this,a=this._constructFileMetadata(e);return!t&&this.webex.logger.sdkBuffer&&this.webex.logger.clientBuffer&&this.webex.logger.buffer&&(t=this.webex.logger.formatLogs()),r=e.locusId&&e.callStart?"".concat(e.locusId,"_").concat(e.callStart,".txt"):"".concat(this.webex.sessionId,".txt"),this.webex.credentials.getUserToken().catch((function(){return o.webex.credentials.getClientToken()})).then(function(){var e=(0,i.Z)(c().mark((function e(i){var u,l,d,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u={authorization:i.toString()},l={service:"clientLogs",resource:"logs/urls"},d={service:"clientLogs",resource:"logs/meta"},h=s()(l,{file:t,shouldAttemptReauth:!1,headers:u,phases:{initialize:{body:{file:r}},upload:{$uri:function(e){return e.tempURL}},finalize:s()(d,{$body:function(e){return n=e.userId,{filename:e.logFilename,data:a,userId:o.webex.internal.device.userId||e.userId}}})}}),e.abrupt("return",o.webex.upload(h));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){return n&&!e.userId&&(e.userId=n),e}))},_constructFileMetadata:function(e){var t=["locusId","appVersion","callStart","feedbackId","correlationId","meetingId","surveySessionId","productAreaTag","issueTypeTag","locussessionid","autoupload"].map((function(t){return e[t]?{key:t,value:e[t]}:null})).filter((function(e){return Boolean(e)}));return this.webex.sessionId&&t.push({key:"trackingId",value:this.webex.sessionId}),this.webex.internal.support.config.appVersion&&t.push({key:"appVersion",value:this.webex.internal.support.config.appVersion}),this.webex.internal.device.userId&&t.push({key:"userId",value:this.webex.internal.device.userId}),this.webex.internal.device.orgId&&t.push({key:"orgId",value:this.webex.internal.device.orgId}),t},version:"0.0.0-next"}),h={device:{preDiscoveryServices:{atlasServiceUrl:"https://atlas-a.wbx2.com/admin/api/v1",atlas:"https://atlas-a.wbx2.com/admin/api/v1",clientLogs:{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.CLIENT_LOGS_SERVICE_URL||"https://client-logs-a.wbx2.com/api/v1",clientLogsServiceUrl:{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.CLIENT_LOGS_SERVICE_URL||"https://client-logs-a.wbx2.com/api/v1"}},support:{appType:"",appVersion:"",languageCode:""}};(0,n.t4)("support",d,{config:h})},94896:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>K});r(22899);var n=r(47683),i=r(26243),o=r.n(i),s=r(62680),a=r.n(s),c=r(6919),u=r.n(c),l=r(93364),d=r.n(l),h=r(26771),f=r.n(h),p=r(77193),m=r(2313),g=r(1469),v=r.n(g),y=r(73473),b=r.n(y),E=r(71544),w=r.n(E),S=r(95366),_=r.n(S),T=r(18408),x=n.mr.extend({namespace:"User",prepareItem:function(e){return b().resolve({email:e})},handleHttpSuccess:function(e){var t=this;return b().all(o()(e.body).map((function(r){return e.body[r]&&e.body[r].id?t.handleItemSuccess(r,e.body[r]):t.handleItemFailure(r,e.body[r])})))},handleItemFailure:function(e,t){return this.getDeferredForResponse(e).then((function(e){e.reject(t)}))},handleItemSuccess:function(e,t){return this.getDeferredForResponse(e).then((function(e){e.resolve(t)}))},fingerprintRequest:function(e){return b().resolve(e.email||e)},fingerprintResponse:function(e){return b().resolve(e)}}),A=x.extend({submitHttpRequest:function(e){return this.webex.request({method:"POST",service:"conversation",resource:"/users",body:e})}}),I=x.extend({submitHttpRequest:function(e){return this.webex.request({method:"POST",service:"conversation",resource:"/users",body:e,qs:{shouldCreateUsers:!0}})}});const C=n._y.extend({children:{faker:A,creator:I},request:function(e){return e.create?this.creator.request(e.email):this.faker.request(e.email)},version:"0.0.0-next"});var R=r(8167),k=r(31314),O=r(83977),N=r.n(O),P=r(18281),L=r.n(P);function D(e,t){var r=o()(e);if(a()){var n=a()(e);t&&(n=n.filter((function(t){return _()(e,t).enumerable}))),r.push.apply(r,n)}return r}function M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach((function(t){(0,p.Z)(e,t,r[t])})):u()?d()(e,u()(r)):D(Object(r)).forEach((function(t){f()(e,t,_()(r,t))}))}return e}var U,B,F,j,V,H=new(N()),G=new(N()),q=function(){function e(){(0,R.Z)(this,e),H.set(this,new(L())),G.set(this,new(L()))}return(0,k.Z)(e,[{key:"add",value:function(e){var t=this;if(!e.id)return b().reject(new Error("`user.id` is required"));if(!e.emailAddress)return b().reject(new Error("`user.emailAddress` is required"));if(!T.patterns.uuid.test(e.id))return b().reject(new Error("`user.id` does not appear to be a uuid"));if(!T.patterns.email.test(e.emailAddress))return b().reject(new Error("`user.emailAddress` does not appear to be an email address"));var r=this.getById(e.id).then((function(r){return G.get(t).set(e.id,M(M({},r),e))})).catch((function(){return G.get(t).set(e.id,M({},e))})),n=this.getByEmail(e.emailAddress).then((function(r){return H.get(t).set(e.emailAddress,M(M({},r),e))})).catch((function(){return H.get(t).set(e.emailAddress,M({},e))}));return b().all([r,n])}},{key:"get",value:function(e){return T.patterns.uuid.test(e)?this.getById(e):T.patterns.email.test(e)?this.getByEmail(e):b().reject(new Error("`id` does not appear to be a valid user identifier"))}},{key:"getById",value:function(e){var t=G.get(this).get(e);return t?b().resolve(t):b().reject(new Error("No user found by specified id"))}},{key:"getByEmail",value:function(e){var t=H.get(this).get(e);return t?b().resolve(t):b().reject(new Error("No user found by specified email address"))}}]),e}();function $(e,t){var r=o()(e);if(a()){var n=a()(e);t&&(n=n.filter((function(t){return _()(e,t).enumerable}))),r.push.apply(r,n)}return r}function Z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$(Object(r),!0).forEach((function(t){(0,p.Z)(e,t,r[t])})):u()?d()(e,u()(r)):$(Object(r)).forEach((function(t){f()(e,t,_()(r,t))}))}return e}var z=n._y.extend((U=(0,n.A4)("@"),B=(0,T.oneFlight)({keyFactory:function(e,t){return e+String(t&&t.create)}}),F=(0,n.tJ)("@"),j=(0,T.deprecated)("Use User#verify()"),V={namespace:"User",children:{batcher:C},props:{hasPassword:{default:!1,type:"boolean"}},session:{store:{default:function(){return new q},type:"any"}},activate:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!(t.verificationToken||t.confirmationCode&&t.id))return b().reject(new Error("either options.verificationToken is required or both options.confirmationCode and options.id are required"));t.scope=this.webex.config.credentials.scope;var r=Z({},t);return delete r.email,this.request({uri:this.webex.config.credentials.activationUrl,method:"POST",body:r,auth:{user:this.webex.config.credentials.client_id,pass:this.webex.config.credentials.client_secret,sendImmediately:!0}}).then((function(t){return e.webex.credentials.set({supertoken:t.body.tokenData}),t.body}))},asUUID:function(e,t){var r=this;if(!e)return b().reject(new Error("`user` is required"));if(v()(e))return b().all(e.map((function(e){return r.asUUID(e,t)})));var n=this._extractUUID(e);if((!t||!t.force)&&T.patterns.uuid.test(n))return b().resolve(n);var i=this._extractEmailAddress(e);return T.patterns.email.test(i)?this.getUUID(i,t):b().reject(new Error("Provided user object does not appear to identify a user"))},fetchUUID:function(e,t){var r=this;return this.batcher.request({email:e,create:t&&t.create}).then((function(t){return r.recordUUID(Z({emailAddress:e},t)).then((function(){return t.id}))}))},generateOTP:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.email||e.id?this.request({uri:this.webex.config.credentials.generateOtpUrl,method:"POST",body:e,auth:{user:this.webex.config.credentials.client_id,pass:this.webex.config.credentials.client_secret}}).then((function(e){return e.body})):b().reject(new Error("One of `options.email` or `options.id` is required"))},get:function(){var e=this;return this.request({service:"conversation",resource:"users"}).then((function(e){return e.body})).then((0,T.tap)((function(t){return e.recordUUID({id:t.id,emailAddress:t.email||t.emailAddress})})))},getUUID:function(e,t){var r=this;return this.store.getByEmail(e).then((function(e){return t&&t.create&&!e.userExists?b().reject(new Error("User for specified email cannot be confirmed to exist")):e.id?e.id:b().reject(new Error("No id recorded for specified user"))})).catch((function(){return r.fetchUUID(e,t)}))},initialize:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w()(n._y.prototype.initialize,this,t)},recordUUID:function(e){return e?e.id?T.patterns.uuid.test(e.id)?e.emailAddress?T.patterns.email.test(e.emailAddress)?this.store.add(e):b().reject(new Error("`user.emailAddress` must be an email address")):b().reject(new Error("`user.emailAddress` is required")):b().reject(new Error("`user.id` must be a uuid")):b().reject(new Error("`user.id` is required")):b().reject(new Error("`user` is required"))},register:function(){return this.verify.apply(this,arguments)},_setUser:function(e){var t=this;return this.webex.credentials.getUserToken().then((function(r){return t.request({uri:"".concat(t.webex.config.credentials.setPasswordUrl,"/").concat(t.webex.internal.device.userId),method:"PATCH",headers:{authorization:r.toString()},body:e})}))},setPassword:function(e){var t=this;return(e=e||{}).password?this._setUser({schemas:["urn:scim:schemas:core:1.0","urn:scim:schemas:extension:cisco:commonidentity:1.0"],password:e.password}).then((function(e){return t.hasPassword=!0,e.body})):b().reject(new Error("`options.password` is required"))},updateName:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.givenName,r=e.familyName,n=e.displayName;return t||r||n?this._setUser({schemas:["urn:scim:schemas:core:1.0","urn:scim:schemas:extension:cisco:commonidentity:1.0"],name:{givenName:t,familyName:r},displayName:n}).then((function(e){return e.body})):b().reject(new Error("One of `givenName` and `familyName` or `displayName` is required"))},update:function(e){return(e=e||{}).displayName?this.request({method:"PATCH",service:"conversation",resource:"users/user",body:e}).then((function(e){return e.body})):b().reject(new Error("`options.displayName` is required"))},validateOTP:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(t.email||t.id)&&t.oneTimePassword?(t.scope=this.webex.config.credentials.scope,this.request({uri:this.webex.config.credentials.validateOtpUrl,method:"POST",body:t,auth:{user:this.webex.config.credentials.client_id,pass:this.webex.config.credentials.client_secret}}).then((function(t){return e.webex.credentials.set({supertoken:t.body.tokenData}),t.body}))):b().reject(new Error("One of `options.email` or `options.id` and `options.oneTimePassword` are required"))},verify:function(e){var t=this,r=(e=Z(Z({},this.config.verifyDefaults),e)).email;return r?this.webex.internal.services.collectPreauthCatalog({email:r}).then((function(){return t.webex.credentials.getUserToken()})).catch((function(){return t.webex.credentials.getClientToken()})).then((function(r){return t.request({service:"atlas",resource:"users/activations",method:"POST",headers:{authorization:r.toString(),"x-prelogin-userid":e.preloginId},body:e,shouldRefreshAccessToken:!1})})).then((function(e){return(e.body.hasPassword||e.body.sso)&&(t.hasPassword=!0),e.body})):b().reject(new Error("`options.email` is required"))},getUserCI:function(e,t){if(t){var r={email:e,suppressEmail:!0};return this.verify(r).then((function(e){return b().resolve(e.userEntities)}))}return b().resolve({idBrokerUrl:this.webex.config.credentials.idbroker.url,identityUrl:this.webex.config.credentials.identity.url})},_extractUUID:function(e){return e.entryUUID||e.id||e},_extractEmailAddress:function(e){return e.email||e.emailAddress||e.entryEmail||e},version:"0.0.0-next"},(0,m.Z)(V,"activate",[U],_()(V,"activate"),V),(0,m.Z)(V,"getUUID",[B],_()(V,"getUUID"),V),(0,m.Z)(V,"initialize",[F],_()(V,"initialize"),V),(0,m.Z)(V,"register",[j],_()(V,"register"),V),V));const K=z;(0,n.t4)("user",K,{config:{device:{preDiscoveryServices:{atlasServiceUrl:"https://atlas-a.wbx2.com/admin/api/v1",atlas:"https://atlas-a.wbx2.com/admin/api/v1"}},user:{batcherWait:100,batcherMaxCalls:100,batcherMaxWait:1500,verifyDefaults:{reqId:"WEBCLIENT"}}}})},7712:(e,t,r)=>{"use strict";r.r(t),r.d(t,{EVENT_TRIGGERS:()=>b,TURN_ON_CAPTION_STATUS:()=>N,default:()=>D});var n=r(47683),i=r(63755),o=r.n(i),s=r(66250),a=r(8167),c=r(31314),u=r(23710),l=r(69678),d=r(26305),h=r(35002),f=r(77193),p=r(33453),m=r.n(p),g=r(55877),v=r.n(g),y=r(80868),b={VOICEA_ANNOUNCEMENT:"voicea:announcement",CAPTION_LANGUAGE_UPDATE:"voicea:captionLanguageUpdate",SPOKEN_LANGUAGE_UPDATE:"voicea:spokenLanguageUpdate",CAPTIONS_TURNED_ON:"voicea:captionOn",TRANSCRIBING_ON:"voicea:transcribingOn",TRANSCRIBING_OFF:"voicea:transcribingOff",NEW_CAPTION:"voicea:newCaption",EVA_COMMAND:"voicea:wxa",HIGHLIGHT_CREATED:"voicea:highlightCreated"},E="voicea.annc",w="client.annc",S="voicea.transl.req",_="voicea.transl.rsp",T="voicea.transcription",x="eva_wake",A="eva_thanks",I="eva_cancel",C="highlight_created",R="transcript_interim_results",k="transcript_final_result",O={IDLE:"idle",JOINED:"joined",JOINING:"joining"},N={IDLE:"idle",ENABLED:"enabled",SENDING:"sending"},P=function(e){var t=Math.floor(e/6e4),r=(e%6e4/1e3).toFixed(0);return"".concat(t,":").concat(+r<10?"0":"").concat(r)};function L(e){var t=function(){if("undefined"==typeof Reflect||!o())return!1;if(o().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(o()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,h.Z)(e);if(t){var i=(0,h.Z)(this).constructor;r=o()(n,arguments,i)}else r=n.apply(this,arguments);return(0,d.Z)(this,r)}}const D=function(e){(0,l.Z)(r,e);var t=L(r);function r(){var e;(0,a.Z)(this,r);for(var i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];return e=t.call.apply(t,[this].concat(o)),(0,f.Z)((0,u.Z)(e),"namespace","voicea"),(0,f.Z)((0,u.Z)(e),"seqNum",void 0),(0,f.Z)((0,u.Z)(e),"areCaptionsEnabled",void 0),(0,f.Z)((0,u.Z)(e),"hasSubscribedToEvents",!1),(0,f.Z)((0,u.Z)(e),"vmcDeviceId",void 0),(0,f.Z)((0,u.Z)(e),"announceStatus",void 0),(0,f.Z)((0,u.Z)(e),"captionStatus",void 0),(0,f.Z)((0,u.Z)(e),"eventProcessor",(function(t){switch(e.seqNum=t.sequenceNumber+1,t.data.relayType){case E:e.vmcDeviceId=t.headers.from,e.announceStatus=O.JOINED,e.processAnnouncementMessage(t.data.voiceaPayload);break;case _:e.processCaptionLanguageResponse(t.data.voiceaPayload);break;case T:e.processTranscription(t.data.voiceaPayload)}})),(0,f.Z)((0,u.Z)(e),"processTranscription",(function(t){switch(t.type){case R:y.TriggerProxy.trigger((0,u.Z)(e),{file:"voicea",function:"processTranscription"},b.NEW_CAPTION,{isFinal:!1,transcriptId:t.transcript_id,transcripts:t.transcripts});break;case k:y.TriggerProxy.trigger((0,u.Z)(e),{file:"voicea",function:"processTranscription"},b.NEW_CAPTION,{isFinal:!0,transcriptId:t.transcript_id,translations:t.translations,transcript:{csis:t.csis,text:t.transcript.text,transcriptLanguageCode:t.transcript.transcript_language_code},timestamp:P(t.transcript.end_millis)});break;case C:y.TriggerProxy.trigger((0,u.Z)(e),{file:"voicea",function:"processTranscription"},b.HIGHLIGHT_CREATED,{csis:t.highlight.csis,highlightId:t.highlight.highlight_id,text:t.highlight.transcript,highlightLabel:t.highlight.highlight_label,highlightSource:t.highlight.highlight_source,timestamp:P(t.highlight.end_millis)});break;case A:y.TriggerProxy.trigger((0,u.Z)(e),{file:"voicea",function:"processTranscription"},b.EVA_COMMAND,{isListening:!1,text:t.command_response});break;case x:case I:y.TriggerProxy.trigger((0,u.Z)(e),{file:"voicea",function:"processTranscription"},b.EVA_COMMAND,{isListening:t.type===x})}})),(0,f.Z)((0,u.Z)(e),"processCaptionLanguageResponse",(function(t){200===t.statusCode?y.TriggerProxy.trigger((0,u.Z)(e),{file:"voicea",function:"processCaptionLanguageResponse"},b.CAPTION_LANGUAGE_UPDATE,{statusCode:200}):y.TriggerProxy.trigger((0,u.Z)(e),{file:"voicea",function:"processCaptionLanguageResponse"},b.CAPTION_LANGUAGE_UPDATE,{statusCode:t.errorCode,errorMessage:t.message})})),(0,f.Z)((0,u.Z)(e),"processAnnouncementMessage",(function(t){var r,n,i,o,s,a,c={captionLanguages:null!==(r=null==t||null===(n=t.translation)||void 0===n?void 0:n.allowed_languages)&&void 0!==r?r:[],maxLanguages:null!==(i=null==t||null===(o=t.translation)||void 0===o?void 0:o.max_languages)&&void 0!==i?i:0,spokenLanguages:null!==(s=null==t||null===(a=t.ASR)||void 0===a?void 0:a.spoken_languages)&&void 0!==s?s:[]};y.TriggerProxy.trigger((0,u.Z)(e),{file:"voicea",function:"processAnnouncementMessage"},b.VOICEA_ANNOUNCEMENT,c)})),(0,f.Z)((0,u.Z)(e),"sendAnnouncement",(function(){e.announceStatus=O.JOINING,e.listenToEvents(),e.webex.internal.llm.socket.send({id:"".concat(e.seqNum),type:"publishRequest",recipients:{route:e.webex.internal.llm.getBinding()},headers:{},data:{clientPayload:{version:"v2"},eventType:"relay.event",relayType:w},trackingId:"".concat(n.vc.trackingIdPrefix,"_").concat(v().v4().toString())}),e.seqNum+=1})),(0,f.Z)((0,u.Z)(e),"setSpokenLanguage",(function(t){return e.request({method:"PUT",url:"".concat(e.webex.internal.llm.getLocusUrl(),"/controls/"),body:{transcribe:{spokenLanguage:t}}}).then((function(){y.TriggerProxy.trigger((0,u.Z)(e),{file:"voicea",function:"setSpokenLanguage"},b.SPOKEN_LANGUAGE_UPDATE,{languageCode:t})}))})),(0,f.Z)((0,u.Z)(e),"requestLanguage",(function(t){e.webex.internal.llm.isConnected()&&(e.webex.internal.llm.socket.send({id:"".concat(e.seqNum),type:"publishRequest",recipients:{route:e.webex.internal.llm.getBinding()},headers:{to:e.vmcDeviceId},data:{clientPayload:{translationLanguage:t,id:v().v4()},eventType:"relay.event",relayType:S},trackingId:"".concat(n.vc.trackingIdPrefix,"_").concat(v().v4().toString())}),e.seqNum+=1)})),(0,f.Z)((0,u.Z)(e),"requestTurnOnCaptions",(function(t){e.captionStatus=N.SENDING;var r={transcribe:{caption:!0},languageCode:t};return e.request({method:"PUT",url:"".concat(e.webex.internal.llm.getLocusUrl(),"/controls/"),body:r}).then((function(){y.TriggerProxy.trigger((0,u.Z)(e),{file:"voicea",function:"turnOnCaptions"},b.CAPTIONS_TURNED_ON),e.areCaptionsEnabled=!0,e.captionStatus=N.ENABLED,e.announce()})).catch((function(){throw e.captionStatus=N.IDLE,new Error("turn on captions fail")}))})),(0,f.Z)((0,u.Z)(e),"isAnnounceProcessing",(function(){return[O.JOINING,O.JOINED].includes(e.announceStatus)})),(0,f.Z)((0,u.Z)(e),"announce",(function(){if(!e.isAnnounceProcessing()){if(!e.webex.internal.llm.isConnected())throw new Error("voicea can not announce before llm connected");e.sendAnnouncement()}})),(0,f.Z)((0,u.Z)(e),"isCaptionProcessing",(function(){return[N.SENDING,N.ENABLED].includes(e.captionStatus)})),(0,f.Z)((0,u.Z)(e),"turnOnCaptions",function(){var t=(0,s.Z)(m().mark((function t(r){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isCaptionProcessing()){t.next=2;break}return t.abrupt("return",void 0);case 2:if(e.webex.internal.llm.isConnected()){t.next=4;break}throw new Error("can not turn on captions before llm connected");case 4:return t.abrupt("return",e.requestTurnOnCaptions(r));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),(0,f.Z)((0,u.Z)(e),"toggleTranscribing",(function(t,r){return e.request({method:"PUT",url:"".concat(e.webex.internal.llm.getLocusUrl(),"/controls/"),body:{transcribe:{transcribing:t},spokenLanguage:r}}).then((function(){if(t&&!e.areCaptionsEnabled)return e.turnOnCaptions(r)}))})),(0,f.Z)((0,u.Z)(e),"getCaptionStatus",(function(){return e.captionStatus})),(0,f.Z)((0,u.Z)(e),"getAnnounceStatus",(function(){return e.announceStatus})),e.seqNum=1,e.areCaptionsEnabled=!1,e.vmcDeviceId=void 0,e.announceStatus=O.IDLE,e.captionStatus=N.IDLE,e}return(0,c.Z)(r,[{key:"listenToEvents",value:function(){this.hasSubscribedToEvents||(this.webex.internal.llm.on("event:relay.event",this.eventProcessor),this.hasSubscribedToEvents=!0)}},{key:"deregisterEvents",value:function(){this.areCaptionsEnabled=!1,this.vmcDeviceId=void 0,this.webex.internal.llm.off("event:relay.event",this.eventProcessor),this.hasSubscribedToEvents=!1,this.announceStatus=O.IDLE,this.captionStatus=N.IDLE}}]),r}(n._y);n.t4("voicea",D,{})},63993:(e,t,r)=>{"use strict";r.r(t),r.d(t,{config:()=>ye,default:()=>ve});r(22899);var n=r(47683),i=r(66250),o=r(2313),s=r(82723),a=r.n(s),c=r(41609),u=r.n(c),l=r(50361),d=r.n(l),h=r(33453),f=r.n(h),p=r(8450),m=r.n(p),g=r(71544),v=r.n(g),y=r(18428),b=r.n(y),E=r(73473),w=r.n(E),S=r(67857),_=r.n(S),T=r(79529),x=r.n(T),A=r(95366),I=r.n(A),C=r(87735),R=r(8575),k=r(18408),O=r(55877),N=r.n(O);const P=new TextEncoder,L=new TextDecoder;function D(...e){const t=e.reduce(((e,{length:t})=>e+t),0),r=new Uint8Array(t);let n=0;return e.forEach((e=>{r.set(e,n),n+=e.length})),r}const M=e=>(e=>{let t=e;"string"==typeof t&&(t=P.encode(t));const r=[];for(let e=0;e<t.length;e+=32768)r.push(String.fromCharCode.apply(null,t.subarray(e,e+32768)));return btoa(r.join(""))})(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_");class U extends Error{static get code(){return"ERR_JOSE_GENERIC"}constructor(e){var t;super(e),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,null===(t=Error.captureStackTrace)||void 0===t||t.call(Error,this,this.constructor)}}class B extends U{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}static get code(){return"ERR_JOSE_NOT_SUPPORTED"}}class F extends U{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}static get code(){return"ERR_JWS_INVALID"}}class j extends U{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}static get code(){return"ERR_JWT_INVALID"}}Symbol.asyncIterator;const V=crypto,H=e=>e instanceof CryptoKey;V.getRandomValues.bind(V);const G=function(e,t,r,n,i){if(void 0!==i.crit&&void 0===n.crit)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!n||void 0===n.crit)return new Set;if(!Array.isArray(n.crit)||0===n.crit.length||n.crit.some((e=>"string"!=typeof e||0===e.length)))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let o;o=void 0!==r?new Map([...Object.entries(r),...t.entries()]):t;for(const t of n.crit){if(!o.has(t))throw new B(`Extension Header Parameter "${t}" is not recognized`);if(void 0===i[t])throw new e(`Extension Header Parameter "${t}" is missing`);if(o.get(t)&&void 0===n[t])throw new e(`Extension Header Parameter "${t}" MUST be integrity protected`)}return new Set(n.crit)};Symbol();const q=86400,$=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i,Z=e=>{const t=$.exec(e);if(!t)throw new TypeError("Invalid time period format");const r=parseFloat(t[1]);switch(t[2].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(r);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(60*r);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(3600*r);case"day":case"days":case"d":return Math.round(r*q);case"week":case"weeks":case"w":return Math.round(604800*r);default:return Math.round(31557600*r)}};function z(e,t="algorithm.name"){return new TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`)}function K(e,t){return e.name===t}function W(e){return parseInt(e.name.slice(4),10)}function J(e,t){if(t.length&&!t.some((t=>e.usages.includes(t)))){let e="CryptoKey does not support this operation, its usages must include ";if(t.length>2){const r=t.pop();e+=`one of ${t.join(", ")}, or ${r}.`}else 2===t.length?e+=`one of ${t[0]} or ${t[1]}.`:e+=`${t[0]}.`;throw new TypeError(e)}}function Y(e,t,...r){switch(t){case"HS256":case"HS384":case"HS512":{if(!K(e.algorithm,"HMAC"))throw z("HMAC");const r=parseInt(t.slice(2),10);if(W(e.algorithm.hash)!==r)throw z(`SHA-${r}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!K(e.algorithm,"RSASSA-PKCS1-v1_5"))throw z("RSASSA-PKCS1-v1_5");const r=parseInt(t.slice(2),10);if(W(e.algorithm.hash)!==r)throw z(`SHA-${r}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!K(e.algorithm,"RSA-PSS"))throw z("RSA-PSS");const r=parseInt(t.slice(2),10);if(W(e.algorithm.hash)!==r)throw z(`SHA-${r}`,"algorithm.hash");break}case"EdDSA":if("Ed25519"!==e.algorithm.name&&"Ed448"!==e.algorithm.name)throw z("Ed25519 or Ed448");break;case"ES256":case"ES384":case"ES512":{if(!K(e.algorithm,"ECDSA"))throw z("ECDSA");const r=function(e){switch(e){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw new Error("unreachable")}}(t);if(e.algorithm.namedCurve!==r)throw z(r,"algorithm.namedCurve");break}default:throw new TypeError("CryptoKey does not support this operation")}J(e,r)}function Q(e,t,...r){if(r.length>2){const t=r.pop();e+=`one of type ${r.join(", ")}, or ${t}.`}else 2===r.length?e+=`one of type ${r[0]} or ${r[1]}.`:e+=`of type ${r[0]}.`;return null==t?e+=` Received ${t}`:"function"==typeof t&&t.name?e+=` Received function ${t.name}`:"object"==typeof t&&null!=t&&t.constructor&&t.constructor.name&&(e+=` Received an instance of ${t.constructor.name}`),e}const X=(e,...t)=>Q("Key must be ",e,...t);function ee(e,t,...r){return Q(`Key for the ${e} algorithm must be `,t,...r)}const te=e=>H(e),re=["CryptoKey"];const ne=async(e,t,r)=>{const n=await function(e,t,r){if(H(t))return Y(t,e,r),t;if(t instanceof Uint8Array){if(!e.startsWith("HS"))throw new TypeError(X(t,...re));return V.subtle.importKey("raw",t,{hash:`SHA-${e.slice(-3)}`,name:"HMAC"},!1,[r])}throw new TypeError(X(t,...re,"Uint8Array"))}(e,t,"sign");((e,t)=>{if(e.startsWith("RS")||e.startsWith("PS")){const{modulusLength:r}=t.algorithm;if("number"!=typeof r||r<2048)throw new TypeError(`${e} requires key modulusLength to be 2048 bits or larger`)}})(e,n);const i=await V.subtle.sign(function(e,t){const r=`SHA-${e.slice(-3)}`;switch(e){case"HS256":case"HS384":case"HS512":return{hash:r,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:r,name:"RSA-PSS",saltLength:e.slice(-3)>>3};case"RS256":case"RS384":case"RS512":return{hash:r,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:r,name:"ECDSA",namedCurve:t.namedCurve};case"EdDSA":return{name:t.name};default:throw new B(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}(e,n.algorithm),n,r);return new Uint8Array(i)},ie=(...e)=>{const t=e.filter(Boolean);if(0===t.length||1===t.length)return!0;let r;for(const e of t){const t=Object.keys(e);if(r&&0!==r.size)for(const e of t){if(r.has(e))return!1;r.add(e)}else r=new Set(t)}return!0},oe=(e,t,r)=>{e.startsWith("HS")||"dir"===e||e.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(e)?((e,t)=>{if(!(t instanceof Uint8Array)){if(!te(t))throw new TypeError(ee(e,t,...re,"Uint8Array"));if("secret"!==t.type)throw new TypeError(`${re.join(" or ")} instances for symmetric algorithms must be of type "secret"`)}})(e,t):((e,t,r)=>{if(!te(t))throw new TypeError(ee(e,t,...re));if("secret"===t.type)throw new TypeError(`${re.join(" or ")} instances for asymmetric algorithms must not be of type "secret"`);if("sign"===r&&"public"===t.type)throw new TypeError(`${re.join(" or ")} instances for asymmetric algorithm signing must be of type "private"`);if("decrypt"===r&&"public"===t.type)throw new TypeError(`${re.join(" or ")} instances for asymmetric algorithm decryption must be of type "private"`);if(t.algorithm&&"verify"===r&&"private"===t.type)throw new TypeError(`${re.join(" or ")} instances for asymmetric algorithm verifying must be of type "public"`);if(t.algorithm&&"encrypt"===r&&"private"===t.type)throw new TypeError(`${re.join(" or ")} instances for asymmetric algorithm encryption must be of type "public"`)})(e,t,r)};class se{constructor(e){if(!(e instanceof Uint8Array))throw new TypeError("payload must be an instance of Uint8Array");this._payload=e}setProtectedHeader(e){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}async sign(e,t){if(!this._protectedHeader&&!this._unprotectedHeader)throw new F("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!ie(this._protectedHeader,this._unprotectedHeader))throw new F("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const r={...this._protectedHeader,...this._unprotectedHeader};let n=!0;if(G(F,new Map([["b64",!0]]),null==t?void 0:t.crit,this._protectedHeader,r).has("b64")&&(n=this._protectedHeader.b64,"boolean"!=typeof n))throw new F('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:i}=r;if("string"!=typeof i||!i)throw new F('JWS "alg" (Algorithm) Header Parameter missing or invalid');oe(i,e,"sign");let o,s=this._payload;n&&(s=P.encode(M(s))),o=this._protectedHeader?P.encode(M(JSON.stringify(this._protectedHeader))):P.encode("");const a=D(o,P.encode("."),s),c=await ne(i,e,a),u={signature:M(c),payload:""};return n&&(u.payload=L.decode(s)),this._unprotectedHeader&&(u.header=this._unprotectedHeader),this._protectedHeader&&(u.protected=L.decode(o)),u}}class ae{constructor(e){this._flattened=new se(e)}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}async sign(e,t){const r=await this._flattened.sign(e,t);if(void 0===r.payload)throw new TypeError("use the flattened module for creating JWS with b64: false");return`${r.protected}.${r.payload}.${r.signature}`}}const ce=e=>Math.floor(e.getTime()/1e3);class ue{constructor(e){if(!function(e){if("object"!=typeof(t=e)||null===t||"[object Object]"!==Object.prototype.toString.call(e))return!1;var t;if(null===Object.getPrototypeOf(e))return!0;let r=e;for(;null!==Object.getPrototypeOf(r);)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(e)===r}(e))throw new TypeError("JWT Claims Set MUST be an object");this._payload=e}setIssuer(e){return this._payload={...this._payload,iss:e},this}setSubject(e){return this._payload={...this._payload,sub:e},this}setAudience(e){return this._payload={...this._payload,aud:e},this}setJti(e){return this._payload={...this._payload,jti:e},this}setNotBefore(e){return this._payload="number"==typeof e?{...this._payload,nbf:e}:{...this._payload,nbf:ce(new Date)+Z(e)},this}setExpirationTime(e){return this._payload="number"==typeof e?{...this._payload,exp:e}:{...this._payload,exp:ce(new Date)+Z(e)},this}setIssuedAt(e){return this._payload=void 0===e?{...this._payload,iat:ce(new Date)}:{...this._payload,iat:e},this}}class le extends ue{setProtectedHeader(e){return this._protectedHeader=e,this}async sign(e,t){var r;const n=new ae(P.encode(JSON.stringify(this._payload)));if(n.setProtectedHeader(this._protectedHeader),Array.isArray(null===(r=this._protectedHeader)||void 0===r?void 0:r.crit)&&this._protectedHeader.crit.includes("b64")&&!1===this._protectedHeader.b64)throw new j("JWTs MUST NOT use unencoded payload");return n.sign(e,t)}}var de,he,fe,pe=r(34155),me="oauth2-csrf-token",ge=k.base64.encode(m()({}));const ve=n._y.extend((de=(0,k.whileInFlight)("isAuthorizing"),he=(0,k.whileInFlight)("isAuthorizing"),fe={derived:{isAuthenticating:{deps:["isAuthorizing"],fn:function(){return this.isAuthorizing}}},session:{isAuthorizing:{default:!1,type:"boolean"},ready:{default:!1,type:"boolean"}},namespace:"Credentials",initialize:function(e,t){var r=this,i=v()(n._y.prototype.initialize,this,[e,t]);if(!1===e.parse)return this.ready=!0,i;var o=R.parse(this.webex.getWindow().location.href,!0);this._checkForErrors(o);var s=o.hash;if(!s)return this.ready=!0,i;s.includes("#")&&(s=s.substr(1)),o.hash=C.parse(s),o.hash.state&&(o.hash.state=JSON.parse(k.base64.decode(o.hash.state)));var a=this._parseHash(o);return a?(this._cleanUrl(o),pe.nextTick((function(){r.webex.credentials.set({supertoken:a}),r.ready=!0})),i):i},initiateLogin:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.state=e.state||{},e.state.csrf_token=this._generateSecurityToken(),"confidential"===this.config.clientType?this.initiateAuthorizationCodeGrant(e):this.initiateImplicitGrant(e)},initiateImplicitGrant:function(e){return this.logger.info("authorization: initiating implicit grant flow"),this.webex.getWindow().location=this.webex.credentials.buildLoginUrl(b()({response_type:"token"},e)),w().resolve()},initiateAuthorizationCodeGrant:function(e){return this.logger.info("authorization: initiating authorization code grant flow"),this.webex.getWindow().location=this.webex.credentials.buildLoginUrl(b()({response_type:"code"},e)),w().resolve()},requestAccessTokenFromJwt:function(e){var t=this,r=e.jwt,n=this.webex.internal.services.get("hydra",!0);return n&&"/"!==n.slice(-1)&&(n+="/"),n=n||"https://api.ciscospark.com/v1",this.webex.request({method:"POST",uri:"".concat(n,"jwt/login"),headers:{authorization:r}}).then((function(e){var t=e.body;return{access_token:t.token,token_type:"Bearer",expires_in:t.expiresIn}})).then((function(e){t.webex.credentials.set({supertoken:e})})).then((function(){return t.webex.internal.services.initServiceCatalogs()}))},logout:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.noRedirect||(this.webex.getWindow().location=this.webex.credentials.buildLogoutUrl(e))},createJwt:function(e){return(0,i.Z)(f().mark((function t(){var r,n,i,o,s,a,c;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.issuer,n=e.secretId,i=e.displayName,o=e.expiresIn,s=Buffer.from(n,"base64"),a={sub:"guest-user-".concat(N()()),iss:r,name:i||"Guest User - ".concat(N()())},"HS256",t.prev=4,t.next=7,new le(a).setProtectedHeader({alg:"HS256"}).setExpirationTime(o).sign(s);case 7:return c=t.sent,t.abrupt("return",w().resolve({jwt:c}));case 11:return t.prev=11,t.t0=t.catch(4),t.abrupt("return",w().reject(t.t0));case 14:case"end":return t.stop()}}),t,null,[[4,11]])})))()},_checkForErrors:function(e){var t=e.query;if(t&&t.error)throw new(n.Zf.select(t.error))(t)},_cleanUrl:function(e){e=d()(e),this.webex.getWindow().history&&this.webex.getWindow().history.replaceState&&(["access_token","token_type","expires_in","refresh_token","refresh_token_expires_in"].forEach((function(t){return _()(e.hash,t)})),u()(e.hash.state)?_()(e.hash,"state"):(e.hash.state=k.base64.encode(m()(a()(e.hash.state,"csrf_token"))),e.hash.state===ge&&_()(e.hash,"state")),e.hash=C.stringify(e.hash),this.webex.getWindow().history.replaceState({},null,R.format(e)))},_generateSecurityToken:function(){this.logger.info("authorization: generating csrf token");var e=N().v4();return this.webex.getWindow().sessionStorage.setItem("oauth2-csrf-token",e),e},_parseHash:function(e){var t=d()(e.hash);if(t&&this._verifySecurityToken(t),t.access_token)return t.expires_in&&(t.expires_in=x()(t.expires_in,10)),t.refresh_token_expires_in&&(t.refresh_token_expires_in=x()(t.refresh_token_expires_in,10)),t;this.ready=!0},_verifySecurityToken:function(e){var t=this.webex.getWindow().sessionStorage.getItem(me);if(this.webex.getWindow().sessionStorage.removeItem(me),t){if(!e.state)throw new Error("Expected CSRF token ".concat(t,", but not found in redirect hash"));if(!e.state.csrf_token)throw new Error("Expected CSRF token ".concat(t,", but not found in redirect hash"));var r=e.state.csrf_token;if(r!==t)throw new Error("CSRF token ".concat(r," does not match stored token ").concat(t))}},version:"0.0.0-next"},(0,o.Z)(fe,"initiateImplicitGrant",[de],I()(fe,"initiateImplicitGrant"),fe),(0,o.Z)(fe,"initiateAuthorizationCodeGrant",[he],I()(fe,"initiateAuthorizationCodeGrant"),fe),(0,o.Z)(fe,"requestAccessTokenFromJwt",[k.oneFlight],I()(fe,"requestAccessTokenFromJwt"),fe),fe)),ye={credentials:{clientType:"public"}};(0,n.fo)("authorization",ve,{config:ye,proxies:["isAuthorizing","isAuthenticating"]})},83061:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>P,levels:()=>x});var n=r(47683),i=r(13682),o=r(21882),s=r(14917),a=r(47037),c=r.n(a),u=r(13218),l=r.n(u),d=r(1469),h=r.n(d),f=(r(18721),r(50361)),p=r.n(f),m=r(26243),g=r.n(m),v=r(43562),y=r.n(v),b=r(67857),E=r.n(b),w=r(8450),S=r.n(w),_=r(18408),T={silent:0,group:1,groupEnd:2,error:3,warn:4,log:5,info:6,debug:7,trace:8},x=g()(T).filter((function(e){return"silent"!==e})),A={error:["log"],warn:["error","log"],info:["log"],debug:["info","log"],trace:["debug","info","log"]},I="sdk",C="client",R=/[Aa]uthorization/;function k(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(t.includes(e))return e;if(t.push(e),h()(e))return e.map((function(e){return k(e,t)}));if(!l()(e)){if(c()(e)){if(_.patterns.containsEmails.test(e))return e.replace(_.patterns.containsEmails,"[REDACTED]");if(_.patterns.containsMTID.test(e))return e.replace(_.patterns.containsMTID,"$1[REDACTED]")}return e}for(var r=0,n=y()(e);r<n.length;r++){var i=(0,s.Z)(n[r],2),o=i[0],a=i[1];R.test(o)?E()(e,o):e[o]=k(a,t)}return e}var O=n._y.extend({namespace:"Logger",derived:{level:{cache:!1,fn:function(){return this.getCurrentLevel()}},client_level:{cache:!1,fn:function(){return this.getCurrentClientLevel()}}},session:{buffer:{type:"array",default:function(){return[]}},groupLevel:{type:"number",default:function(){return 0}},sdkBuffer:{type:"array",default:function(){return[]}},clientBuffer:{type:"array",default:function(){return[]}}},filter:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.map((function(e){return e instanceof Error?e:k(e=p()(e))}))},shouldPrint:function(e){return T[e]<=T[(arguments.length>1&&void 0!==arguments[1]?arguments[1]:I)===I?this.getCurrentLevel():this.getCurrentClientLevel()]},shouldBuffer:function(e){return T[e]<=(this.config.bufferLogLevel?T[this.config.bufferLogLevel]:T.info)},getCurrentLevel:function(){if(this.config.level)return this.config.level;if(x.includes("log"))return"log";var e=this.webex.internal.device&&this.webex.internal.device.features.developer.get("log-level");return e&&x.includes(e)?e:"error"},getCurrentClientLevel:function(){return this.config.clientLevel?this.config.clientLevel:this.getCurrentLevel()},formatLogs:function(){function e(e){return e[1]}var t=[],r=0,n=0;if(this.config.separateLogBuffers)for(;r<this.clientBuffer.length||n<this.sdkBuffer.length;)n<this.sdkBuffer.length&&(r>=this.clientBuffer.length||new Date(e(this.sdkBuffer[n]))<=new Date(e(this.clientBuffer[r])))?(t.push(this.sdkBuffer[n]),n+=1):r<this.clientBuffer.length&&(t.push(this.clientBuffer[r]),r+=1);else t=this.buffer;return t.join("\n")},version:"0.0.0-next"});function N(e,t,r){var s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return function(){var c,u,l=r,d=l===I?"wx-js-sdk":this.config.clientName||l;this.config.separateLogBuffers?(u=this.config.clientHistoryLength?this.config.clientHistoryLength:this.config.historyLength,c=l===I?this.sdkBuffer:this.clientBuffer):(c=this.buffer,u=this.config.historyLength);try{var h=!s&&this.shouldPrint(e,l),f=a||this.shouldBuffer(e);if(!f&&!h)return;var p=[d].concat((0,o.Z)(this.filter.apply(this,arguments))),m=p.map((function(e){if(e instanceof n.Ff)return e.toString();if("object"===(0,i.Z)(e)){var t,r=[];try{t=S()(e,(function(e,t){if("object"===(0,i.Z)(t)&&null!==t){if(r.includes(t))return;r.push(t)}return t}))}catch(r){t="Failed to stringify: ".concat(e)}return r=null,t}return e}));if(h){var g,v=_.inBrowser?m:p;0,(g=console)[t].apply(g,(0,o.Z)(v))}if(f){var y=new Date;m.unshift(y.toISOString()),m.unshift("|  ".repeat(this.groupLevel)),c.push(m),c.length>u&&c.splice(0,c.length-u),"group"===e&&(this.groupLevel+=1),"groupEnd"===e&&this.groupLevel>0&&(this.groupLevel-=1)}}catch(t){s||console.warn("failed to execute Logger#".concat(e),t)}}}x.forEach((function(e){var t=A[e],r=e;if(t)for(t=t.slice();!console[r];)r=t.pop();O.prototype["client_".concat(e)]=N(e,r,C),O.prototype[e]=N(e,r,I)})),O.prototype.client_logToBuffer=N(x.info,x.info,C,!0,!0),O.prototype.logToBuffer=N(x.info,x.info,I,!0,!0);const P=O;(0,n.fo)("logger",P,{config:{logger:{level:"log",historyLength:1e4}},replace:!0})},80868:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CONSTANTS:()=>c,DisplaySurface:()=>tf,FacingMode:()=>ef,LocalCameraStream:()=>Qh,LocalCameraStreamEventNames:()=>qh,LocalDisplayStream:()=>$t,LocalMicrophoneStream:()=>Yh,LocalMicrophoneStreamEventNames:()=>Gh,LocalStream:()=>Vt,LocalStreamEventNames:()=>Ft,LocalSystemAudioStream:()=>zt,PresetCameraConstraints:()=>rf,REACTIONS:()=>u,RemoteMedia:()=>uT,StreamEventNames:()=>St,TriggerProxy:()=>Qv,createCameraStream:()=>Kh,createDisplayStream:()=>Wh,createDisplayStreamWithAudio:()=>Jh,createMicrophoneStream:()=>zh,default:()=>Yx,getDevices:()=>ht});var n={};r.r(n),r.d(n,{DisplaySurface:()=>tf,FacingMode:()=>ef,LocalCameraStream:()=>Qh,LocalCameraStreamEventNames:()=>qh,LocalDisplayStream:()=>$t,LocalMicrophoneStream:()=>Yh,LocalMicrophoneStreamEventNames:()=>Gh,LocalStream:()=>Vt,LocalStreamEventNames:()=>Ft,LocalSystemAudioStream:()=>zt,NoiseReductionEffect:()=>Xh.ET,PresetCameraConstraints:()=>rf,RemoteStream:()=>Kt,StreamEventNames:()=>St,VirtualBackgroundEffect:()=>Xh.FW,createCameraStream:()=>Kh,createDisplayStream:()=>Wh,createDisplayStreamWithAudio:()=>Jh,createMicrophoneStream:()=>zh,getDevices:()=>ht});var i={};r.r(i),r.d(i,{fixNegotiationNeeded:()=>If,shimAddTrackRemoveTrack:()=>xf,shimAddTrackRemoveTrackWithNative:()=>Tf,shimGetDisplayMedia:()=>yf,shimGetSendersWithDtmf:()=>wf,shimGetStats:()=>Sf,shimGetUserMedia:()=>vf,shimMediaStream:()=>bf,shimOnTrack:()=>Ef,shimPeerConnection:()=>Af,shimSenderReceiverGetStats:()=>_f});var o={};r.r(o),r.d(o,{shimAddTransceiver:()=>Mf,shimCreateAnswer:()=>Ff,shimCreateOffer:()=>Bf,shimGetDisplayMedia:()=>Rf,shimGetParameters:()=>Uf,shimGetUserMedia:()=>Cf,shimOnTrack:()=>kf,shimPeerConnection:()=>Of,shimRTCDataChannel:()=>Df,shimReceiverGetStats:()=>Pf,shimRemoveStream:()=>Lf,shimSenderGetStats:()=>Nf});var s={};r.r(s),r.d(s,{shimAudioContext:()=>Kf,shimCallbacksAPI:()=>Hf,shimConstraints:()=>qf,shimCreateOfferLegacy:()=>zf,shimGetUserMedia:()=>Gf,shimLocalStreamsAPI:()=>jf,shimRTCIceServerUrls:()=>$f,shimRemoteStreamsAPI:()=>Vf,shimTrackEventTransceiver:()=>Zf});var a={};r.r(a),r.d(a,{removeExtmapAllowMixed:()=>rp,shimAddIceCandidateNullOrEmpty:()=>np,shimConnectionState:()=>tp,shimMaxMessageSize:()=>Xf,shimParameterlessSetLocalDescription:()=>ip,shimRTCIceCandidate:()=>Yf,shimRTCIceCandidateRelayProtocol:()=>Qf,shimSendThrowTypeError:()=>ep});var c={};r.r(c),r.d(c,{ALERT:()=>Sp,ALIAS:()=>_p,ALTERNATE_REDIRECT_TRUE:()=>hg,ANNOTATION:()=>sv,ANSWER:()=>Tp,API:()=>Fg,ASSIGN_ROLES_ERROR_CODES:()=>Vg,AUDIO:()=>Ep,AUDIO_STATUS:()=>wp,AVAILABLE_RESOLUTIONS:()=>Pv,BNR_STATUS:()=>Fv,BREAKOUTS:()=>av,CALENDAR:()=>Rp,CALENDAR_EVENTS:()=>jg,CALENDAR_EVENTS_API:()=>kp,CALL:()=>xp,CALL_REMOVED_REASON:()=>Kg,CLAIM:()=>Np,CMR_MEETINGS:()=>Op,COMPLETE:()=>Dp,CONNECTION_STATE:()=>iv,CONTENT:()=>Lp,CONTROLS:()=>Pp,CONVERSATION_SERVICE:()=>Eg,CONVERSATION_URL:()=>Cp,CORRELATION_ID:()=>Ap,DECLINE:()=>Fp,DEFAULT_EXCLUDED_STATS:()=>Sg,DEFAULT_GET_STATS_FILTER:()=>Hg,DEFAULT_MEETING_INFO_REQUEST_BODY:()=>Vv,DEVELOPMENT:()=>Bp,DIALER_REGEX:()=>Ng,DISPLAY_HINTS:()=>mv,EMBEDDED_APP_TYPES:()=>jv,END:()=>Jp,ENDED:()=>Vp,ERROR:()=>jp,ERROR_DICTIONARY:()=>Qg,EVENTS:()=>Jg,EVENT_TRIGGERS:()=>$g,EVENT_TYPES:()=>Zg,FLOOR_ACTION:()=>Xg,FULL_STATE:()=>ev,GATHERING:()=>Up,HECATE:()=>Hp,HOST:()=>Gp,HTTPS_PROTOCOL:()=>fg,HTTP_VERBS:()=>tv,ICE_AND_DTLS_CONNECTION_TIMEOUT:()=>kg,ICE_FAIL_TIMEOUT:()=>Cg,ICE_GATHERING_STATE:()=>rv,ICE_STATE:()=>nv,ICE_TIMEOUT:()=>Ig,INTENT_TO_JOIN:()=>Ag,INTERPRETATION:()=>cv,INTERSTITIAL_DISPLAY_HINTS:()=>gv,IPV4_REGEX:()=>Pg,IP_VERSION:()=>Hv,JOIN:()=>qp,LANGUAGE_ENGLISH:()=>ym,LAYOUT_TYPES:()=>_g,LEAVE:()=>$p,LIVE:()=>Zp,LOCAL:()=>zp,LOCAL_SHARE_ERRORS:()=>Gv,LOCI:()=>Kp,LOCUS:()=>ov,LOCUSEVENT:()=>lv,LOCUSINFO:()=>uv,LOCUS_URL:()=>Wp,MAX_RANDOM_DELAY_FOR_MEETING_INFO:()=>Yp,MEDIA:()=>tm,MEDIA_DEVICES:()=>Dv,MEDIA_PEER_CONNECTION_NAME:()=>mg,MEDIA_STATE:()=>Yg,MEDIA_TRACK_CONSTRAINT:()=>dv,MEET:()=>Xp,MEETINGINFO:()=>Qp,MEETINGNUMBER:()=>Ip,MEETINGS:()=>pg,MEETING_AUDIO_STATE_MACHINE:()=>Ev,MEETING_END_REASON:()=>fv,MEETING_ERRORS:()=>hv,MEETING_INFO_FAILURE_REASON:()=>Bv,MEETING_PERMISSION_TOKEN_REFRESH_REASON:()=>$v,MEETING_PERMISSION_TOKEN_REFRESH_THRESHOLD_IN_SEC:()=>qv,MEETING_REMOVED_REASON:()=>zg,MEETING_STATE:()=>yv,MEETING_STATE_MACHINE:()=>bv,MEETING_VIDEO_STATE_MACHINE:()=>wv,MEET_CISCO:()=>nm,MEET_CO:()=>rm,MEET_M:()=>em,MODERATOR_FALSE:()=>xg,MODERATOR_TRUE:()=>Tg,MQA_INTERVAL:()=>Lv,MQA_STATS:()=>Ov,MediaContent:()=>Iv,NETWORK_STATUS:()=>Cv,NETWORK_TYPE:()=>Rv,OFFLINE:()=>im,ONLINE:()=>om,PARTICIPANT:()=>sm,PARTICIPANT_DELTAS:()=>dg,PASSWORD_STATUS:()=>Uv,PEER_CONNECTION_STATE:()=>Sv,PROVISIONAL_TYPE_DIAL_IN:()=>am,PROVISIONAL_TYPE_DIAL_OUT:()=>cm,PSTN_STATUS:()=>Mv,QUALITY_LEVELS:()=>Nv,REACHABILITY:()=>xv,READY:()=>lm,RECONNECTION:()=>_v,RECORDING_STATE:()=>Gg,REMOTE:()=>um,RESOURCE:()=>Tv,RETRY_TIMEOUT:()=>Rg,ROAP:()=>Av,ROAP_OFFER_ANSWER_EXCHANGE_TIMEOUT:()=>Og,SELF_POLICY:()=>pv,SELF_ROLES:()=>vv,SENDRECV:()=>hm,SEND_DTMF_ENDPOINT:()=>dm,SHARE:()=>pm,SHARE_PEER_CONNECTION_NAME:()=>gg,SHARE_STATUS:()=>qg,SHARE_STOPPED_REASON:()=>Wg,SIP_URI:()=>fm,STATS:()=>kv,TYPE:()=>mm,USE_URI_LOOKUP_FALSE:()=>vg,UUID_REG:()=>Bg,VALID_EMAIL_ADDRESS:()=>Lg,VALID_PIN:()=>Ug,VALID_PMR_ADDRESS:()=>Dg,VALID_PMR_LINK:()=>Mg,VIDEO:()=>gm,VIDEO_STATUS:()=>vm,WBXAPPAPI_SERVICE:()=>wg,WEBEX_DOT_COM:()=>bg,WHITEBOARD:()=>Mp,WWW_DOT:()=>yg,_ACTIVE_:()=>Em,_ANSWER_:()=>bm,_CALL_:()=>wm,_CONFLICT_:()=>_m,_CONVERSATION_URL_:()=>Tm,_CREATED_:()=>Sm,_ERROR_:()=>xm,_FORCED_:()=>Am,_IDLE_:()=>Im,_ID_:()=>Nm,_INACTIVE_:()=>ng,_INCOMING_:()=>km,_IN_:()=>Om,_IN_LOBBY_:()=>Cm,_IN_MEETING_:()=>Rm,_JOINED_:()=>Lm,_JOIN_:()=>Pm,_LEFT_:()=>Mm,_LOCUS_ID_:()=>Dm,_MEETING_:()=>jm,_MEETING_CENTER_:()=>Vm,_MEETING_ID_:()=>Hm,_MEETING_LINK_:()=>Bm,_MEETING_UUID_:()=>Fm,_MOVED_:()=>Um,_MOVE_MEDIA_:()=>lg,_NONE_:()=>qm,_NOT_IN_MEETING_:()=>Gm,_OBSERVE_:()=>$m,_PEOPLE_:()=>zm,_PERSONAL_ROOM_:()=>Zm,_RECEIVE_ONLY_:()=>Jm,_REMOVE_:()=>Ym,_REQUESTED_:()=>Km,_RESOURCE_ROOM_:()=>Wm,_ROOM_:()=>Qm,_SEND_ONLY_:()=>rg,_SEND_RECEIVE_:()=>tg,_SIP_BRIDGE_:()=>Xm,_SIP_URI_:()=>eg,_SLIDES_:()=>ig,_S_LINE:()=>og,_UNKNOWN_:()=>ag,_USER_:()=>sg,_WAIT_:()=>ug,_WEBEX_MEETING_:()=>cg});var u={};r.r(u),r.d(u,{Reactions:()=>F_,SkinTones:()=>j_});var l=r(47683),d=r(63755),h=r.n(d),f=r(62680),p=r.n(f),m=r(95366),g=r.n(m),v=r(6919),y=r.n(v),b=r(93364),E=r.n(b),w=r(26771),S=r.n(w),_=r(21882),T=r(66250),x=r(23710),A=r(69678),I=r(26305),C=r(35002),R=r(77193),k=r(8167),O=r(31314),N=r(73473),P=r.n(N),L=r(66130),D=r.n(L),M=r(26243),U=r.n(M),B=r(18433),F=r.n(B),j=r(33453),V=r.n(j),H=(r(21408),r(68683),r(60996));function G(e,t,r,n,i,o,s){try{var a=e[o](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,i)}function q(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function s(e){G(o,n,i,s,a,"next",e)}function a(e){G(o,n,i,s,a,"throw",e)}s(void 0)}))}}function $(e){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$(e)}function Z(e){var t=function(e,t){if("object"!=$(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=$(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$(t)?t:String(t)}function z(e,t,r){return(t=Z(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(r){if("default"!==r&&!(r in e)){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})}}))})),Object.freeze(e)}function W(){}function J(){J.init.call(this)}function Y(e){return void 0===e._maxListeners?J.defaultMaxListeners:e._maxListeners}function Q(e,t,r,n){var i,o,s;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]):(o=e._events=new W,e._eventsCount=0),s){if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),!s.warned&&(i=Y(e))&&i>0&&s.length>i){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=s.length,function(e){"function"==typeof console.warn?console.warn(e):console.log(e)}(a)}}else s=o[t]=r,++e._eventsCount;return e}function X(e,t,r){var n=!1;function i(){e.removeListener(t,i),n||(n=!0,r.apply(e,arguments))}return i.listener=r,i}function ee(e){var t=this._events;if(t){var r=t[e];if("function"==typeof r)return 1;if(r)return r.length}return 0}function te(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}W.prototype=Object.create(null),J.EventEmitter=J,J.usingDomains=!1,J.prototype.domain=void 0,J.prototype._events=void 0,J.prototype._maxListeners=void 0,J.defaultMaxListeners=10,J.init=function(){this.domain=null,J.usingDomains&&undefined.active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new W,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},J.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},J.prototype.getMaxListeners=function(){return Y(this)},J.prototype.emit=function(e){var t,r,n,i,o,s,a,c="error"===e;if(s=this._events)c=c&&null==s.error;else if(!c)return!1;if(a=this.domain,c){if(t=arguments[1],!a){if(t instanceof Error)throw t;var u=new Error('Uncaught, unspecified "error" event. ('+t+")");throw u.context=t,u}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=a,t.domainThrown=!1,a.emit("error",t),!1}if(!(r=s[e]))return!1;var l="function"==typeof r;switch(n=arguments.length){case 1:!function(e,t,r){if(t)e.call(r);else for(var n=e.length,i=te(e,n),o=0;o<n;++o)i[o].call(r)}(r,l,this);break;case 2:!function(e,t,r,n){if(t)e.call(r,n);else for(var i=e.length,o=te(e,i),s=0;s<i;++s)o[s].call(r,n)}(r,l,this,arguments[1]);break;case 3:!function(e,t,r,n,i){if(t)e.call(r,n,i);else for(var o=e.length,s=te(e,o),a=0;a<o;++a)s[a].call(r,n,i)}(r,l,this,arguments[1],arguments[2]);break;case 4:!function(e,t,r,n,i,o){if(t)e.call(r,n,i,o);else for(var s=e.length,a=te(e,s),c=0;c<s;++c)a[c].call(r,n,i,o)}(r,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(n-1),o=1;o<n;o++)i[o-1]=arguments[o];!function(e,t,r,n){if(t)e.apply(r,n);else for(var i=e.length,o=te(e,i),s=0;s<i;++s)o[s].apply(r,n)}(r,l,this,i)}return!0},J.prototype.addListener=function(e,t){return Q(this,e,t,!1)},J.prototype.on=J.prototype.addListener,J.prototype.prependListener=function(e,t){return Q(this,e,t,!0)},J.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,X(this,e,t)),this},J.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,X(this,e,t)),this},J.prototype.removeListener=function(e,t){var r,n,i,o,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(n=this._events))return this;if(!(r=n[e]))return this;if(r===t||r.listener&&r.listener===t)0==--this._eventsCount?this._events=new W:(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length;o-- >0;)if(r[o]===t||r[o].listener&&r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;if(1===r.length){if(r[0]=void 0,0==--this._eventsCount)return this._events=new W,this;delete n[e]}else!function(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}(r,i);n.removeListener&&this.emit("removeListener",e,s||t)}return this},J.prototype.off=function(e,t){return this.removeListener(e,t)},J.prototype.removeAllListeners=function(e){var t,r;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=new W,this._eventsCount=0):r[e]&&(0==--this._eventsCount?this._events=new W:delete r[e]),this;if(0===arguments.length){for(var n,i=Object.keys(r),o=0;o<i.length;++o)"removeListener"!==(n=i[o])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=new W,this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},J.prototype.listeners=function(e){var t,r=this._events;return r&&(t=r[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(t):[]},J.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):ee.call(e,t)},J.prototype.listenerCount=ee,J.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var re,ne={error:1,warn:2,info:3,debug:4},ie="error",oe=(e,t)=>{ne[e]<=ne[ie]&&console.log(((e,t)=>{var{ID:r,mediaType:n,action:i,description:o,error:s}=t,a=(new Date).toISOString(),c=s?s.stack?"".concat(s.message,": ").concat(s.stack):"".concat(s):"";return"".concat(a," ").concat(e," ").concat(r||""," ").concat(n," ").concat(i," ").concat(o," ").concat(c).replace(/\s+/g," ").trim()})(e,t))},se={info:e=>oe("info",e),warn:e=>oe("warn",e),error:e=>oe("error",e),debug:e=>oe("debug",e)},ae=function(e){se[e]=t=>{var{ID:r,mediaType:n,action:i,description:o,error:s}=t;return ie=e,oe(e,{ID:r,mediaType:n,action:i,description:o,error:s})}};for(var ce of["info","warn","error","debug"])ae(ce);!function(e){e.AUDIO_INPUT="audioinput",e.AUDIO_OUTPUT="audiooutput",e.VIDEO_INPUT="videoinput"}(re||(re={}));var ue,le;!function(e){e.ENDED="ended",e.LIVE="live"}(ue||(ue={})),function(e){e.AUDIO="audio",e.VIDEO="video"}(le||(le={}));new J;var de;!function(e){e[e.MediaConnectionError=30001]="MediaConnectionError",e[e.SdpError=30002]="SdpError",e[e.IceGatheringError=30003]="IceGatheringError",e[e.SdpAnswerHandlingError=30004]="SdpAnswerHandlingError",e[e.SdpOfferCreationError=30005]="SdpOfferCreationError",e[e.SdpOfferHandlingError=30006]="SdpOfferHandlingError"}(de||(de={}));class he extends Error{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e),z(this,"code",void 0),this.name=t.name||"MediaConnectionError",this.cause=t.cause,this.code=t.code||de.MediaConnectionError}}function fe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}class pe extends he{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(r),!0).forEach((function(t){z(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({code:de.SdpError,name:"SdpError"},t))}}function me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}class ge extends pe{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?me(Object(r),!0).forEach((function(t){z(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):me(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({code:de.IceGatheringError,name:"IceGatheringError"},t))}}function ve(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}class ye extends pe{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(r),!0).forEach((function(t){z(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ve(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({code:de.SdpAnswerHandlingError,name:"SdpAnswerHandlingError"},t))}}function be(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}class Ee extends pe{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?be(Object(r),!0).forEach((function(t){z(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):be(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({code:de.SdpOfferCreationError,name:"SdpOfferCreationError"},t))}}function we(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}class Se extends pe{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?we(Object(r),!0).forEach((function(t){z(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):we(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({code:de.SdpOfferHandlingError,name:"SdpOfferHandlingError"},t))}}var _e=Object.freeze({__proto__:null,get ErrorCode(){return de},IceGatheringError:ge,MediaConnectionError:he,SdpAnswerHandlingError:ye,SdpError:pe,SdpOfferCreationError:Ee,SdpOfferHandlingError:Se});class Te extends J{}var xe=void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function Ae(){throw new Error("setTimeout has not been defined")}function Ie(){throw new Error("clearTimeout has not been defined")}var Ce=Ae,Re=Ie;function ke(e){if(Ce===setTimeout)return setTimeout(e,0);if((Ce===Ae||!Ce)&&setTimeout)return Ce=setTimeout,setTimeout(e,0);try{return Ce(e,0)}catch(t){try{return Ce.call(null,e,0)}catch(t){return Ce.call(this,e,0)}}}"function"==typeof xe.setTimeout&&(Ce=setTimeout),"function"==typeof xe.clearTimeout&&(Re=clearTimeout);var Oe,Ne=[],Pe=!1,Le=-1;function De(){Pe&&Oe&&(Pe=!1,Oe.length?Ne=Oe.concat(Ne):Le=-1,Ne.length&&Me())}function Me(){if(!Pe){var e=ke(De);Pe=!0;for(var t=Ne.length;t;){for(Oe=Ne,Ne=[];++Le<t;)Oe&&Oe[Le].run();Le=-1,t=Ne.length}Oe=null,Pe=!1,function(e){if(Re===clearTimeout)return clearTimeout(e);if((Re===Ie||!Re)&&clearTimeout)return Re=clearTimeout,clearTimeout(e);try{return Re(e)}catch(t){try{return Re.call(null,e)}catch(t){return Re.call(this,e)}}}(e)}}function Ue(e,t){this.fun=e,this.array=t}Ue.prototype.run=function(){this.fun.apply(null,this.array)};function Be(){}var Fe=Be,je=Be,Ve=Be,He=Be,Ge=Be,qe=Be,$e=Be;var Ze=xe.performance||{},ze=Ze.now||Ze.mozNow||Ze.msNow||Ze.oNow||Ze.webkitNow||function(){return(new Date).getTime()};var Ke=new Date;var We={nextTick:function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];Ne.push(new Ue(e,t)),1!==Ne.length||Pe||ke(Me)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:Fe,addListener:je,once:Ve,off:He,removeListener:Ge,removeAllListeners:qe,emit:$e,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*ze.call(Ze),r=Math.floor(t),n=Math.floor(t%1*1e9);return e&&(r-=e[0],(n-=e[1])<0&&(r--,n+=1e9)),[r,n]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-Ke)/1e3}};function Je(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(r){if("default"!==r&&!(r in e)){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})}}))})),Object.freeze(e)}function Ye(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}var Qe="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==xe?xe:"undefined"!=typeof self?self:{},Xe={exports:{}};!function(e){!function(t){var r,n={};n.VERSION="1.6.1";var i={},o=function(e,t){return function(){return t.apply(e,arguments)}},s=function(){var e,t,r=arguments,n=r[0];for(t=1;t<r.length;t++)for(e in r[t])!(e in n)&&r[t].hasOwnProperty(e)&&(n[e]=r[t][e]);return n},a=function(e,t){return{value:e,name:t}};n.TRACE=a(1,"TRACE"),n.DEBUG=a(2,"DEBUG"),n.INFO=a(3,"INFO"),n.TIME=a(4,"TIME"),n.WARN=a(5,"WARN"),n.ERROR=a(8,"ERROR"),n.OFF=a(99,"OFF");var c=function(e){this.context=e,this.setLevel(e.filterLevel),this.log=this.info};c.prototype={setLevel:function(e){e&&"value"in e&&(this.context.filterLevel=e)},getLevel:function(){return this.context.filterLevel},enabledFor:function(e){var t=this.context.filterLevel;return e.value>=t.value},trace:function(){this.invoke(n.TRACE,arguments)},debug:function(){this.invoke(n.DEBUG,arguments)},info:function(){this.invoke(n.INFO,arguments)},warn:function(){this.invoke(n.WARN,arguments)},error:function(){this.invoke(n.ERROR,arguments)},time:function(e){"string"==typeof e&&e.length>0&&this.invoke(n.TIME,[e,"start"])},timeEnd:function(e){"string"==typeof e&&e.length>0&&this.invoke(n.TIME,[e,"end"])},invoke:function(e,t){r&&this.enabledFor(e)&&r(t,s({level:e},this.context))}};var u,l=new c({filterLevel:n.OFF});(u=n).enabledFor=o(l,l.enabledFor),u.trace=o(l,l.trace),u.debug=o(l,l.debug),u.time=o(l,l.time),u.timeEnd=o(l,l.timeEnd),u.info=o(l,l.info),u.warn=o(l,l.warn),u.error=o(l,l.error),u.log=u.info,n.setHandler=function(e){r=e},n.setLevel=function(e){for(var t in l.setLevel(e),i)i.hasOwnProperty(t)&&i[t].setLevel(e)},n.getLevel=function(){return l.getLevel()},n.get=function(e){return i[e]||(i[e]=new c(s({name:e},l.context)))},n.createDefaultHandler=function(e){(e=e||{}).formatter=e.formatter||function(e,t){t.name&&e.unshift("["+t.name+"]")};var t={},r=function(e,t){Function.prototype.apply.call(e,console,t)};return"undefined"==typeof console?function(){}:function(i,o){i=Array.prototype.slice.call(i);var s,a=console.log;o.level===n.TIME?(s=(o.name?"["+o.name+"] ":"")+i[0],"start"===i[1]?console.time?console.time(s):t[s]=(new Date).getTime():console.timeEnd?console.timeEnd(s):r(a,[s+": "+((new Date).getTime()-t[s])+"ms"])):(o.level===n.WARN&&console.warn?a=console.warn:o.level===n.ERROR&&console.error?a=console.error:o.level===n.INFO&&console.info?a=console.info:o.level===n.DEBUG&&console.debug?a=console.debug:o.level===n.TRACE&&console.trace&&(a=console.trace),e.formatter(i,o),r(a,i))}},n.useDefaults=function(e){n.setLevel(e&&e.defaultLevel||n.DEBUG),n.setHandler(n.createDefaultHandler(e))},n.setDefaults=n.useDefaults,e.exports?e.exports=n:(n._prevLogger=t.Logger,n.noConflict=function(){return t.Logger=n._prevLogger,n},t.Logger=n)}(Qe)}(Xe);var et,tt,rt=Xe.exports,nt=rt.get("webrtc-core");function it(e){return Ye(this,void 0,void 0,(function*(){return navigator.mediaDevices.getUserMedia(e)}))}function ot(e){return navigator.mediaDevices.getDisplayMedia(e)}function st(){return Ye(this,void 0,void 0,(function*(){return navigator.mediaDevices.enumerateDevices()}))}function at(e){return Ye(this,void 0,void 0,(function*(){try{var t=yield function(e){return Ye(this,void 0,void 0,(function*(){var t=[];return e.includes(et.VideoInput)&&t.push(navigator.permissions.query({name:"camera"})),e.includes(et.AudioInput)&&t.push(navigator.permissions.query({name:"microphone"})),Promise.all(t)}))}(e);if(t.every((e=>"granted"===e.state)))return!0}catch(e){}try{return(yield st()).filter((t=>e.includes(t.kind))).every((e=>e.label))}catch(e){}return!1}))}function ct(e,t){return Ye(this,void 0,void 0,(function*(){try{if(!(yield at(e))){var r=yield it({audio:e.includes(et.AudioInput),video:e.includes(et.VideoInput)}),n=yield t();return r.getTracks().forEach((e=>e.stop())),n}return t()}catch(e){throw nt.error(e),new Error("Failed to ensure device permissions.")}}))}rt.useDefaults({defaultLevel:rt.DEBUG,formatter:(e,t)=>{e.unshift("[".concat(t.name,"]"))}}),(tt=et||(et={})).AudioInput="audioinput",tt.AudioOutput="audiooutput",tt.VideoInput="videoinput";var ut,lt=Object.freeze({__proto__:null,get DeviceKind(){return et},getUserMedia:it,getDisplayMedia:ot,enumerateDevices:st,setOnDeviceChangeHandler:function(e){navigator.mediaDevices.ondevicechange=e},checkDevicePermissions:at,ensureDevicePermissions:ct});!function(e){e.DEVICE_PERMISSION_DENIED="DEVICE_PERMISSION_DENIED",e.CREATE_STREAM_FAILED="CREATE_STREAM_FAILED",e.ADD_EFFECT_FAILED="ADD_EFFECT_FAILED"}(ut||(ut={}));class dt{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.type=e,this.message=t}}function ht(e){return Ye(this,void 0,void 0,(function*(){var t;try{t=yield ct([et.AudioInput,et.VideoInput],st)}catch(e){throw new dt(ut.DEVICE_PERMISSION_DENIED,"Failed to ensure device permissions")}return t.filter((t=>!e||t.kind===e))}))}var ft,{setOnDeviceChangeHandler:pt}=lt,mt={exports:{}},gt="object"==typeof Reflect?Reflect:null,vt=gt&&"function"==typeof gt.apply?gt.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};ft=gt&&"function"==typeof gt.ownKeys?gt.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var yt=Number.isNaN||function(e){return e!=e};function bt(){bt.init.call(this)}mt.exports=bt,mt.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}Nt(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&Nt(e,"error",t,r)}(e,i,{once:!0})}))},bt.EventEmitter=bt,bt.prototype._events=void 0,bt.prototype._eventsCount=0,bt.prototype._maxListeners=void 0;var Et,wt,St,_t=10;function Tt(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function xt(e){return void 0===e._maxListeners?bt.defaultMaxListeners:e._maxListeners}function At(e,t,r,n){var i,o,s,a;if(Tt(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]),void 0===s)s=o[t]=r,++e._eventsCount;else if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=xt(e))>0&&s.length>i&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,a=c,console&&console.warn&&console.warn(a)}return e}function It(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Ct(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=It.bind(n);return i.listener=r,n.wrapFn=i,i}function Rt(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):Ot(i,i.length)}function kt(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function Ot(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function Nt(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}Object.defineProperty(bt,"defaultMaxListeners",{enumerable:!0,get:function(){return _t},set:function(e){if("number"!=typeof e||e<0||yt(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");_t=e}}),bt.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},bt.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||yt(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},bt.prototype.getMaxListeners=function(){return xt(this)},bt.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var a=i[e];if(void 0===a)return!1;if("function"==typeof a)vt(a,this,t);else{var c=a.length,u=Ot(a,c);for(r=0;r<c;++r)vt(u[r],this,t)}return!0},bt.prototype.addListener=function(e,t){return At(this,e,t,!1)},bt.prototype.on=bt.prototype.addListener,bt.prototype.prependListener=function(e,t){return At(this,e,t,!0)},bt.prototype.once=function(e,t){return Tt(t),this.on(e,Ct(this,e,t)),this},bt.prototype.prependOnceListener=function(e,t){return Tt(t),this.prependListener(e,Ct(this,e,t)),this},bt.prototype.removeListener=function(e,t){var r,n,i,o,s;if(Tt(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},bt.prototype.off=bt.prototype.removeListener,bt.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},bt.prototype.listeners=function(e){return Rt(this,e,!0)},bt.prototype.rawListeners=function(e){return Rt(this,e,!1)},bt.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):kt.call(e,t)},bt.prototype.listenerCount=kt,bt.prototype.eventNames=function(){return this._eventsCount>0?ft(this._events):[]};class Pt extends mt.exports.EventEmitter{}class Lt{constructor(){this.emitter=new Pt}on(e){this.emitter.on("event",e)}once(e){this.emitter.once("event",e)}off(e){this.emitter.off("event",e)}emit(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.emitter.emit("event",...t)}}function Dt(e){return class extends e{on(e,t){this[e].on(t)}once(e,t){this[e].once(t)}off(e,t){this[e].off(t)}}}!function(e){e.MuteStateChange="mute-state-change",e.Ended="stream-ended"}(St||(St={}));Et=St.MuteStateChange,wt=St.Ended;var Mt,Ut,Bt,Ft,jt=Dt(class{constructor(e){this[Et]=new Lt,this[wt]=new Lt,this.outputStream=e,this.handleTrackMuted=this.handleTrackMuted.bind(this),this.handleTrackUnmuted=this.handleTrackUnmuted.bind(this),this.handleTrackEnded=this.handleTrackEnded.bind(this),this.addTrackHandlers(this.outputTrack)}handleTrackMuted(){this[St.MuteStateChange].emit(!0)}handleTrackUnmuted(){this[St.MuteStateChange].emit(!1)}handleTrackEnded(){this[St.Ended].emit()}addTrackHandlers(e){e.addEventListener("mute",this.handleTrackMuted),e.addEventListener("unmute",this.handleTrackUnmuted),e.addEventListener("ended",this.handleTrackEnded)}removeTrackHandlers(e){e.removeEventListener("mute",this.handleTrackMuted),e.removeEventListener("unmute",this.handleTrackUnmuted),e.removeEventListener("ended",this.handleTrackEnded)}get id(){return this.outputStream.id}get outputTrack(){return this.outputStream.getTracks()[0]}});!function(e){e.ConstraintsChange="constraints-change",e.OutputTrackChange="output-track-change",e.EffectAdded="effect-added"}(Ft||(Ft={}));Mt=Ft.ConstraintsChange,Ut=Ft.OutputTrackChange,Bt=Ft.EffectAdded;var Vt=Dt(class extends jt{constructor(e){super(e),this[Mt]=new Lt,this[Ut]=new Lt,this[Bt]=new Lt,this.effects=[],this.loadingEffects=new Map,this.inputStream=e}get inputTrack(){return this.inputStream.getTracks()[0]}handleTrackMuted(){this.inputTrack.enabled&&super.handleTrackMuted()}handleTrackUnmuted(){this.inputTrack.enabled&&super.handleTrackUnmuted()}get muted(){return!this.inputTrack.enabled||this.inputTrack.muted}setMuted(e){this.inputTrack.enabled===e&&(this.inputTrack.enabled=!e,this.inputTrack.muted||this[St.MuteStateChange].emit(e))}getSettings(){return this.inputTrack.getSettings()}get label(){return this.inputTrack.label}get readyState(){return this.inputTrack.readyState}changeOutputTrack(e){this.outputTrack.id!==e.id&&(this.inputTrack.id===this.outputTrack.id&&(this.inputStream=new MediaStream(this.inputStream)),this.outputStream.removeTrack(this.outputTrack),this.outputStream.addTrack(e),this.inputTrack.id===this.outputTrack.id&&(this.inputStream=this.outputStream),this[Ft.OutputTrackChange].emit(e))}stop(){this.inputTrack.stop(),this.outputTrack.stop(),this[St.Ended].emit()}addEffect(e){return Ye(this,void 0,void 0,(function*(){if(!this.effects.some((t=>t.id===e.id))){if(this.loadingEffects.set(e.kind,e),yield e.load(this.outputTrack),e!==this.loadingEffects.get(e.kind))throw yield e.dispose(),new dt(ut.ADD_EFFECT_FAILED,"Another effect with kind ".concat(e.kind," was added while effect ").concat(e.id," was loading, or the effects list was cleared."));this.loadingEffects.delete(e.kind);var t=t=>{var r,n=this.effects.findIndex((t=>t.id===e.id));n===this.effects.length-1?this.changeOutputTrack(t):n>=0?null===(r=this.effects[n+1])||void 0===r||r.replaceInputTrack(t):nt.error("Effect with ID ".concat(e.id," not found in effects list."))},r=()=>{e.off("track-updated",t),e.off("disposed",r)};e.on("track-updated",t),e.on("disposed",r);var n=this.effects.findIndex((t=>t.kind===e.kind));if(n>=0){var[i]=this.effects.splice(n,1,e);if(i.isEnabled){var o=0===n?this.inputTrack:this.effects[n-1].getOutputTrack();yield e.replaceInputTrack(o),yield e.enable()}yield i.dispose()}else this.effects.push(e);this[Ft.EffectAdded].emit(e)}}))}getEffectById(e){return this.effects.find((t=>t.id===e))}getEffectByKind(e){return this.effects.find((t=>t.kind===e))}getEffects(){return this.effects}toJSON(){return{muted:this.muted,label:this.label,readyState:this.readyState,inputStream:{active:this.inputStream.active,id:this.inputStream.id,enabled:this.inputTrack.enabled,muted:this.inputTrack.muted},outputStream:{active:this.outputStream.active,id:this.outputStream.id},effects:this.effects.map((e=>({id:e.id,kind:e.kind,isEnabled:e.isEnabled})))}}disposeEffects(){return Ye(this,void 0,void 0,(function*(){this.loadingEffects.clear(),this.effects.length>0&&(this.changeOutputTrack(this.inputTrack),yield Promise.all(this.effects.map((e=>e.dispose()))),this.effects=[])}))}});class Ht extends Vt{applyConstraints(e){return Ye(this,void 0,void 0,(function*(){return nt.log("Applying constraints to local track:",e),this.inputTrack.applyConstraints(e).then((()=>{this[Ft.ConstraintsChange].emit()}))}))}}class Gt extends Vt{applyConstraints(e){return Ye(this,void 0,void 0,(function*(){return nt.log("Applying constraints to local track:",e),this.inputTrack.applyConstraints(e).then((()=>{this[Ft.ConstraintsChange].emit()}))}))}get contentHint(){return this.inputTrack.contentHint}set contentHint(e){this.inputTrack.contentHint=e}getNumActiveSimulcastLayers(){var e=this.inputTrack.getSettings().height;return e<=180?1:e<=360?2:3}}class qt extends Gt{}class $t extends Gt{}class Zt extends Ht{}class zt extends Ht{}class Kt extends jt{get muted(){return!this.outputTrack.enabled}getSettings(){return this.outputTrack.getSettings()}replaceTrack(e){var t=this.outputTrack;this.removeTrackHandlers(t),this.outputStream.removeTrack(t),this.outputStream.addTrack(e),this.addTrackHandlers(e)}stop(){this.outputTrack.stop(),this[St.Ended].emit()}}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==xe||"undefined"!=typeof self&&self;function Wt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Jt={exports:{}};!function(e,t){e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=90)}({17:function(e,t,r){t.__esModule=!0,t.default=void 0;var n=r(18),i=function(){function e(){}return e.getFirstMatch=function(e,t){var r=t.match(e);return r&&r.length>0&&r[1]||""},e.getSecondMatch=function(e,t){var r=t.match(e);return r&&r.length>1&&r[2]||""},e.matchAndReturnConst=function(e,t,r){if(e.test(t))return r},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,r,n){void 0===n&&(n=!1);var i=e.getVersionPrecision(t),o=e.getVersionPrecision(r),s=Math.max(i,o),a=0,c=e.map([t,r],(function(t){var r=s-e.getVersionPrecision(t),n=t+new Array(r+1).join(".0");return e.map(n.split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));for(n&&(a=s-Math.min(i,o)),s-=1;s>=a;){if(c[0][s]>c[1][s])return 1;if(c[0][s]===c[1][s]){if(s===a)return 0;s-=1}else if(c[0][s]<c[1][s])return-1}},e.map=function(e,t){var r,n=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(r=0;r<e.length;r+=1)n.push(t(e[r]));return n},e.find=function(e,t){var r,n;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(r=0,n=e.length;r<n;r+=1){var i=e[r];if(t(i,r))return i}},e.assign=function(e){for(var t,r,n=e,i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];if(Object.assign)return Object.assign.apply(Object,[e].concat(o));var a=function(){var e=o[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach((function(t){n[t]=e[t]}))};for(t=0,r=o.length;t<r;t+=1)a();return e},e.getBrowserAlias=function(e){return n.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return n.BROWSER_MAP[e]||""},e}();t.default=i,e.exports=t.default},18:function(e,t,r){t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,r){t.__esModule=!0,t.default=void 0;var n,i=(n=r(91))&&n.__esModule?n:{default:n},o=r(18);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(){}var t,r,n;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new i.default(e,t)},e.parse=function(e){return new i.default(e).getResult()},t=e,n=[{key:"BROWSER_MAP",get:function(){return o.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return o.ENGINE_MAP}},{key:"OS_MAP",get:function(){return o.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return o.PLATFORMS_MAP}}],(r=null)&&s(t.prototype,r),n&&s(t,n),e}();t.default=a,e.exports=t.default},91:function(e,t,r){t.__esModule=!0,t.default=void 0;var n=c(r(92)),i=c(r(93)),o=c(r(94)),s=c(r(95)),a=c(r(17));function c(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=a.default.find(n.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=a.default.find(i.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=a.default.find(o.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=a.default.find(s.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return a.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,r={},n=0,i={},o=0;if(Object.keys(e).forEach((function(t){var s=e[t];"string"==typeof s?(i[t]=s,o+=1):"object"==typeof s&&(r[t]=s,n+=1)})),n>0){var s=Object.keys(r),c=a.default.find(s,(function(e){return t.isOS(e)}));if(c){var u=this.satisfies(r[c]);if(void 0!==u)return u}var l=a.default.find(s,(function(e){return t.isPlatform(e)}));if(l){var d=this.satisfies(r[l]);if(void 0!==d)return d}}if(o>0){var h=Object.keys(i),f=a.default.find(h,(function(e){return t.isBrowser(e,!0)}));if(void 0!==f)return this.compareVersion(i[f])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var r=this.getBrowserName().toLowerCase(),n=e.toLowerCase(),i=a.default.getBrowserTypeByAlias(n);return t&&i&&(n=i.toLowerCase()),n===r},t.compareVersion=function(e){var t=[0],r=e,n=!1,i=this.getBrowserVersion();if("string"==typeof i)return">"===e[0]||"<"===e[0]?(r=e.substr(1),"="===e[1]?(n=!0,r=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?r=e.substr(1):"~"===e[0]&&(n=!0,r=e.substr(1)),t.indexOf(a.default.compareVersions(i,r,n))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=u,e.exports=t.default},92:function(e,t,r){t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=/version\/(\d+(\.?_?\d+)+)/i,s=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},r=i.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},r=i.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},r=i.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},r=i.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},r=i.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},r=i.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},r=i.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},r=i.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},r=i.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},r=i.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},r=i.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},r=i.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},r=i.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},r=i.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},r=i.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return r&&(t.version=r),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},r=i.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},r=i.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},r=i.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},r=i.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},r=i.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},r=i.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},r=i.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},r=i.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},r=i.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},r=i.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},r=i.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},r=i.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t={name:"Android Browser"},r=i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},r=i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},r=i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:i.default.getFirstMatch(t,e),version:i.default.getSecondMatch(t,e)}}}];t.default=s,e.exports=t.default},93:function(e,t,r){t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=r(18),s=[{test:[/Roku\/DVP/],describe:function(e){var t=i.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:o.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=i.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=i.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),r=i.default.getWindowsVersionName(t);return{name:o.OS_MAP.Windows,version:t,versionName:r}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:o.OS_MAP.iOS},r=i.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return r&&(t.version=r),t}},{test:[/macintosh/i],describe:function(e){var t=i.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),r=i.default.getMacOSVersionName(t),n={name:o.OS_MAP.MacOS,version:t};return r&&(n.versionName=r),n}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=i.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:o.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t=i.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),r=i.default.getAndroidVersionName(t),n={name:o.OS_MAP.Android,version:t};return r&&(n.versionName=r),n}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=i.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),r={name:o.OS_MAP.WebOS};return t&&t.length&&(r.version=t),r}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=i.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||i.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||i.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:o.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=i.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=i.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:o.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:o.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=i.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.PlayStation4,version:t}}}];t.default=s,e.exports=t.default},94:function(e,t,r){t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=r(18),s=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=i.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",r={type:o.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(r.model=t),r}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),r=e.test(/like (ipod|iphone)/i);return t&&!r},describe:function(e){var t=i.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:o.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}}];t.default=s,e.exports=t.default},95:function(e,t,r){t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=r(18),s=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:o.ENGINE_MAP.Blink};var t=i.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:o.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:o.ENGINE_MAP.Trident},r=i.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:o.ENGINE_MAP.Presto},r=i.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){var t=e.test(/gecko/i),r=e.test(/like gecko/i);return t&&!r},describe:function(e){var t={name:o.ENGINE_MAP.Gecko},r=i.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:o.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:o.ENGINE_MAP.WebKit},r=i.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}}];t.default=s,e.exports=t.default}})}(Jt);var Yt,Qt,Xt=Wt(Jt.exports);!function(e){e.CHROME="Chrome",e.FIREFOX="Firefox",e.EDGE="Microsoft Edge",e.SAFARI="Safari"}(Yt||(Yt={}));class er{static getBrowserDetails(){return this.browser.getBrowser()}static getOSDetails(){return this.browser.getOS()}static getPlatformDetails(){return this.browser.getPlatform()}static getEngineDetails(){return this.browser.getEngine()}static isChrome(){return this.browser.getBrowserName()===Yt.CHROME}static isFirefox(){return this.browser.getBrowserName()===Yt.FIREFOX}static isEdge(){return this.browser.getBrowserName()===Yt.EDGE}static isSafari(){return this.browser.getBrowserName()===Yt.SAFARI}static isVersionGreaterThan(e){var t={[this.browser.getBrowserName()]:">".concat(e)};return this.browser.satisfies(t)}static isVersionGreaterThanOrEqualTo(e){var t={[this.browser.getBrowserName()]:">=".concat(e)};return this.browser.satisfies(t)}static isVersionLessThan(e){var t={[this.browser.getBrowserName()]:"<".concat(e)};return this.browser.satisfies(t)}static isVersionLessThanOrEqualTo(e){var t={[this.browser.getBrowserName()]:"<=".concat(e)};return this.browser.satisfies(t)}static isSubVersionOf(e){var t={[this.browser.getBrowserName()]:"~".concat(e)};return this.browser.satisfies(t)}}er.browser=Xt.getParser(window.navigator.userAgent),function(e){e.NOT_CAPABLE="not capable",e.CAPABLE="capable",e.UNKNOWN="unknown"}(Qt||(Qt={}));var tr,rr={exports:{}},nr="object"==typeof Reflect?Reflect:null,ir=nr&&"function"==typeof nr.apply?nr.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};tr=nr&&"function"==typeof nr.ownKeys?nr.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var or=Number.isNaN||function(e){return e!=e};function sr(){sr.init.call(this)}rr.exports=sr,rr.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}yr(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&yr(e,"error",t,r)}(e,i,{once:!0})}))},sr.EventEmitter=sr,sr.prototype._events=void 0,sr.prototype._eventsCount=0,sr.prototype._maxListeners=void 0;var ar,cr,ur=10;function lr(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function dr(e){return void 0===e._maxListeners?sr.defaultMaxListeners:e._maxListeners}function hr(e,t,r,n){var i,o,s,a;if(lr(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]),void 0===s)s=o[t]=r,++e._eventsCount;else if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=dr(e))>0&&s.length>i&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,a=c,console&&console.warn&&console.warn(a)}return e}function fr(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function pr(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=fr.bind(n);return i.listener=r,n.wrapFn=i,i}function mr(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):vr(i,i.length)}function gr(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function vr(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function yr(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}Object.defineProperty(sr,"defaultMaxListeners",{enumerable:!0,get:function(){return ur},set:function(e){if("number"!=typeof e||e<0||or(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");ur=e}}),sr.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},sr.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||or(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},sr.prototype.getMaxListeners=function(){return dr(this)},sr.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var a=i[e];if(void 0===a)return!1;if("function"==typeof a)ir(a,this,t);else{var c=a.length,u=vr(a,c);for(r=0;r<c;++r)ir(u[r],this,t)}return!0},sr.prototype.addListener=function(e,t){return hr(this,e,t,!1)},sr.prototype.on=sr.prototype.addListener,sr.prototype.prependListener=function(e,t){return hr(this,e,t,!0)},sr.prototype.once=function(e,t){return lr(t),this.on(e,pr(this,e,t)),this},sr.prototype.prependOnceListener=function(e,t){return lr(t),this.prependListener(e,pr(this,e,t)),this},sr.prototype.removeListener=function(e,t){var r,n,i,o,s;if(lr(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},sr.prototype.off=sr.prototype.removeListener,sr.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},sr.prototype.listeners=function(e){return mr(this,e,!0)},sr.prototype.rawListeners=function(e){return mr(this,e,!1)},sr.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):gr.call(e,t)},sr.prototype.listenerCount=gr,sr.prototype.eventNames=function(){return this._eventsCount>0?tr(this._events):[]};class br extends rr.exports.EventEmitter{}!function(e){e.New="New",e.Closed="Closed",e.Connected="Connected",e.Connecting="Connecting",e.Disconnected="Disconnected",e.Failed="Failed"}(ar||(ar={})),function(e){e.ConnectionStateChanged="ConnectionStateChanged"}(cr||(cr={}));class Er extends br{constructor(e){super(),this.getCurrentStatesCallback=e,this.mediaConnectionState=this.evaluateMediaConnectionState()}onConnectionStateChange(){this.handleAnyConnectionStateChange()}onIceConnectionStateChange(){this.handleAnyConnectionStateChange()}handleAnyConnectionStateChange(){var e=this.evaluateMediaConnectionState();e!==this.mediaConnectionState&&(this.mediaConnectionState=e,this.emit(cr.ConnectionStateChanged,this.mediaConnectionState))}evaluateMediaConnectionState(){var e,{connectionState:t,iceState:r}=this.getCurrentStatesCallback(),n=[t,r];return e=n.every((e=>"new"===e))?ar.New:n.some((e=>"closed"===e))?ar.Closed:n.some((e=>"failed"===e))?ar.Failed:n.some((e=>"disconnected"===e))?ar.Disconnected:n.every((e=>"connected"===e||"completed"===e))?ar.Connected:ar.Connecting,nt.log("iceConnectionState=".concat(r," connectionState=").concat(t," => ").concat(e)),e}getConnectionState(){return this.mediaConnectionState}}Er.Events=cr;var wr=!0,Sr=!0;function _r(e,t,r){var n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}function Tr(e,t,r){if(e.RTCPeerConnection){var n=e.RTCPeerConnection.prototype,i=n.addEventListener;n.addEventListener=function(e,n){if(e!==t)return i.apply(this,arguments);var o=e=>{var t=r(e);t&&(n.handleEvent?n.handleEvent(t):n(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(n,o),i.apply(this,[e,o])};var o=n.removeEventListener;n.removeEventListener=function(e,r){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(r))return o.apply(this,arguments);var n=this._eventMap[t].get(r);return this._eventMap[t].delete(r),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,n])},Object.defineProperty(n,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}}function xr(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(wr=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function Ar(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Sr=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function Ir(){if("object"==typeof window){if(wr)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function Cr(e,t){Sr&&console.warn(e+" is deprecated, please use "+t+" instead.")}function Rr(e){return"[object Object]"===Object.prototype.toString.call(e)}function kr(e){return Rr(e)?Object.keys(e).reduce((function(t,r){var n=Rr(e[r]),i=n?kr(e[r]):e[r],o=n&&!Object.keys(i).length;return void 0===i||o?t:Object.assign(t,{[r]:i})}),{}):e}function Or(e,t,r){t&&!r.has(t.id)&&(r.set(t.id,t),Object.keys(t).forEach((n=>{n.endsWith("Id")?Or(e,e.get(t[n]),r):n.endsWith("Ids")&&t[n].forEach((t=>{Or(e,e.get(t),r)}))})))}function Nr(e,t,r){var n=r?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;var o=[];return e.forEach((e=>{"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((t=>{e.forEach((r=>{r.type===n&&r.trackId===t.id&&Or(e,r,i)}))})),i}var Pr=Ir;function Lr(e,t){var r=e&&e.navigator;if(r.mediaDevices){var n=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((r=>{if("require"!==r&&"advanced"!==r&&"mediaSource"!==r){var n="object"==typeof e[r]?e[r]:{ideal:e[r]};void 0!==n.exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==n.ideal){t.optional=t.optional||[];var o={};"number"==typeof n.ideal?(o[i("min",r)]=n.ideal,t.optional.push(o),(o={})[i("max",r)]=n.ideal,t.optional.push(o)):(o[i("",r)]=n.ideal,t.optional.push(o))}void 0!==n.exact&&"number"!=typeof n.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",r)]=n.exact):["min","max"].forEach((e=>{void 0!==n[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,r)]=n[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},i=function(e,i){if(t.version>=61)return i(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){var o=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])};o((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),o(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=n(e.audio)}if(e&&"object"==typeof e.video){var s=e.video.facingMode;s=s&&("object"==typeof s?s:{ideal:s});var a,c=t.version<66;if(s&&("user"===s.exact||"environment"===s.exact||"user"===s.ideal||"environment"===s.ideal)&&(!r.mediaDevices.getSupportedConstraints||!r.mediaDevices.getSupportedConstraints().facingMode||c))if(delete e.video.facingMode,"environment"===s.exact||"environment"===s.ideal?a=["back","rear"]:"user"!==s.exact&&"user"!==s.ideal||(a=["front"]),a)return r.mediaDevices.enumerateDevices().then((t=>{var r=(t=t.filter((e=>"videoinput"===e.kind))).find((e=>a.some((t=>e.label.toLowerCase().includes(t)))));return!r&&t.length&&a.includes("back")&&(r=t[t.length-1]),r&&(e.video.deviceId=s.exact?{exact:r.deviceId}:{ideal:r.deviceId}),e.video=n(e.video),Pr("chrome: "+JSON.stringify(e)),i(e)}));e.video=n(e.video)}return Pr("chrome: "+JSON.stringify(e)),i(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(r.getUserMedia=function(e,t,n){i(e,(e=>{r.webkitGetUserMedia(e,t,(e=>{n&&n(o(e))}))}))}.bind(r),r.mediaDevices.getUserMedia){var s=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(e){return i(e,(e=>s(e).then((t=>{if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((e=>{e.stop()})),new DOMException("","NotFoundError");return t}),(e=>Promise.reject(o(e))))))}}}}function Dr(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function Mr(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",(r=>{var n;n=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===r.track.id)):{track:r.track};var i=new Event("track");i.track=r.track,i.receiver=n,i.transceiver={receiver:n},i.streams=[t.stream],this.dispatchEvent(i)})),t.stream.getTracks().forEach((r=>{var n;n=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===r.id)):{track:r};var i=new Event("track");i.track=r,i.receiver=n,i.transceiver={receiver:n},i.streams=[t.stream],this.dispatchEvent(i)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else Tr(e,"track",(e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e)))}function Ur(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){var i=r.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){n.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((e=>{this._senders.push(t(this,e))}))};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach((e=>{var t=this._senders.find((t=>t.track===e));t&&this._senders.splice(this._senders.indexOf(t),1)}))}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var s=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=s.apply(this,[]);return e.forEach((e=>e._pc=this)),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Br(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var[e,r,n]=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof e))return t.apply(this,[]);var i=function(e){var t={};return e.result().forEach((e=>{var r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((t=>{r[t]=e.stat(t)})),t[r.id]=r})),t},o=function(e){return new Map(Object.keys(e).map((t=>[t,e[t]])))};if(arguments.length>=2){return t.apply(this,[function(e){r(o(i(e)))},e])}return new Promise(((e,r)=>{t.apply(this,[function(t){e(o(i(t)))},r])})).then(r,n)}}}function Fr(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((t=>Nr(t,e.track,!0)))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var n=e.RTCPeerConnection.prototype.getReceivers;n&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=n.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),Tr(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((t=>Nr(t,e.track,!1)))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t,r,n,o=arguments[0];return this.getSenders().forEach((e=>{e.track===o&&(t?n=!0:t=e)})),this.getReceivers().forEach((e=>(e.track===o&&(r?n=!0:r=e),e.track===o))),n||t&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return i.apply(this,arguments)}}}}function jr(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((e=>this._shimmedLocalStreams[e][0]))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var n=t.apply(this,arguments);return this._shimmedLocalStreams[r.id]?-1===this._shimmedLocalStreams[r.id].indexOf(n)&&this._shimmedLocalStreams[r.id].push(n):this._shimmedLocalStreams[r.id]=[r,n],n};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")}));var t=this.getSenders();r.apply(this,arguments);var n=this.getSenders().filter((e=>-1===t.indexOf(e)));this._shimmedLocalStreams[e.id]=[e].concat(n)};var n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],n.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((t=>{var r=this._shimmedLocalStreams[t].indexOf(e);-1!==r&&this._shimmedLocalStreams[t].splice(r,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]})),i.apply(this,arguments)}}function Vr(e,t){if(e.RTCPeerConnection){if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return jr(e);var r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=r.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((e=>this._reverseStreams[e.id]))};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var r=new e.MediaStream(t.getTracks());this._streams[t.id]=r,this._reverseStreams[r.id]=t,t=r}n.apply(this,[t])};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,r){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var n=[].slice.call(arguments,1);if(1!==n.length||!n[0].getTracks().find((e=>e===t)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((e=>e.track===t)))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var i=this._streams[r.id];if(i)i.addTrack(t),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{var o=new e.MediaStream([t]);this._streams[r.id]=o,this._reverseStreams[o.id]=r,this.addStream(o)}return this.getSenders().find((e=>e.track===t))},["createOffer","createAnswer"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t],n={[t](){var e=arguments;return arguments.length&&"function"==typeof arguments[0]?r.apply(this,[t=>{var r=a(this,t);e[0].apply(null,[r])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):r.apply(this,arguments).then((e=>a(this,e)))}};e.RTCPeerConnection.prototype[t]=n[t]}));var o=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{var n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(n.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:r})}(this,arguments[0]),o.apply(this,arguments)):o.apply(this,arguments)};var s=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){var e=s.get.apply(this);return""===e.type?e:a(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");var t;if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach((r=>{this._streams[r].getTracks().find((t=>e.track===t))&&(t=this._streams[r])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function a(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{var n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(i.id,"g"),n.id)})),new RTCSessionDescription({type:t.type,sdp:r})}}function Hr(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t],n={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=n[t]}))}function Gr(e,t){Tr(e,"negotiationneeded",(e=>{var r=e.target;if(!(t.version<72||r.getConfiguration&&"plan-b"===r.getConfiguration().sdpSemantics)||"stable"===r.signalingState)return e}))}var qr=Object.freeze({__proto__:null,shimMediaStream:Dr,shimOnTrack:Mr,shimGetSendersWithDtmf:Ur,shimGetStats:Br,shimSenderReceiverGetStats:Fr,shimAddTrackRemoveTrackWithNative:jr,shimAddTrackRemoveTrack:Vr,shimPeerConnection:Hr,fixNegotiationNeeded:Gr,shimGetUserMedia:Lr,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then((t=>{var n=r.video&&r.video.width,i=r.video&&r.video.height,o=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},n&&(r.video.mandatory.maxWidth=n),i&&(r.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(r)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}});function $r(e,t){var r=e&&e.navigator,n=e&&e.MediaStreamTrack;if(r.getUserMedia=function(e,t,n){Cr("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(e).then(t,n)},!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){var i=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])},o=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(e){return"object"==typeof e&&"object"==typeof e.audio&&(e=JSON.parse(JSON.stringify(e)),i(e.audio,"autoGainControl","mozAutoGainControl"),i(e.audio,"noiseSuppression","mozNoiseSuppression")),o(e)},n&&n.prototype.getSettings){var s=n.prototype.getSettings;n.prototype.getSettings=function(){var e=s.apply(this,arguments);return i(e,"mozAutoGainControl","autoGainControl"),i(e,"mozNoiseSuppression","noiseSuppression"),e}}if(n&&n.prototype.applyConstraints){var a=n.prototype.applyConstraints;n.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"==typeof e&&(e=JSON.parse(JSON.stringify(e)),i(e,"autoGainControl","mozAutoGainControl"),i(e,"noiseSuppression","mozNoiseSuppression")),a.apply(this,[e])}}}}function Zr(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function zr(e,t){if("object"==typeof e&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t],n={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=n[t]}));var r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var[e,i,o]=arguments;return n.apply(this,[e||null]).then((e=>{if(t.version<53&&!i)try{e.forEach((e=>{e.type=r[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach(((t,n)=>{e.set(n,Object.assign({},t,{type:r[t.type]||t.type}))}))}return e})).then(i,o)}}}function Kr(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpSender.prototype))){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}}function Wr(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpReceiver.prototype))){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),Tr(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}}function Jr(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){Cr("removeStream","removeTrack"),this.getSenders().forEach((t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)}))})}function Yr(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function Qr(e){if("object"==typeof e&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1]&&arguments[1].sendEncodings;void 0===e&&(e=[]);var r=(e=[...e]).length>0;r&&e.forEach((e=>{if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var n=t.apply(this,arguments);if(r){var{sender:i}=n,o=i.getParameters();(!("encodings"in o)||1===o.encodings.length&&0===Object.keys(o.encodings[0]).length)&&(o.encodings=e,i.sendEncodings=e,this.setParametersPromises.push(i.setParameters(o).then((()=>{delete i.sendEncodings})).catch((()=>{delete i.sendEncodings}))))}return n})}}function Xr(e){if("object"==typeof e&&e.RTCRtpSender){var t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){var e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}}function en(e){if("object"==typeof e&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}}function tn(e){if("object"==typeof e&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}}var rn=Object.freeze({__proto__:null,shimOnTrack:Zr,shimPeerConnection:zr,shimSenderGetStats:Kr,shimReceiverGetStats:Wr,shimRemoveStream:Jr,shimRTCDataChannel:Yr,shimAddTransceiver:Qr,shimGetParameters:Xr,shimCreateOffer:en,shimCreateAnswer:tn,shimGetUserMedia:$r,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){var n=new DOMException("getDisplayMedia without video constraints is undefined");return n.name="NotFoundError",n.code=8,Promise.reject(n)}return!0===r.video?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)})}});function nn(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((r=>t.call(this,r,e))),e.getVideoTracks().forEach((r=>t.call(this,r,e)))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n&&n.forEach((e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);var t=this._localStreams.indexOf(e);if(-1!==t){this._localStreams.splice(t,1);var r=e.getTracks();this.getSenders().forEach((e=>{r.includes(e.track)&&this.removeTrack(e)}))}})}}function on(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach((e=>{if(this._remoteStreams||(this._remoteStreams=[]),!this._remoteStreams.includes(e)){this._remoteStreams.push(e);var t=new Event("addstream");t.stream=e,this.dispatchEvent(t)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((t=>{if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var r=new Event("addstream");r.stream=t,e.dispatchEvent(r)}}))}),t.apply(e,arguments)}}}function sn(e){if("object"==typeof e&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,r=t.createOffer,n=t.createAnswer,i=t.setLocalDescription,o=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i};var a=function(e,t,r){var n=i.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n};t.setLocalDescription=a,a=function(e,t,r){var n=o.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.setRemoteDescription=a,a=function(e,t,r){var n=s.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.addIceCandidate=a}}function an(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var r=t.mediaDevices,n=r.getUserMedia.bind(r);t.mediaDevices.getUserMedia=e=>n(cn(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,r,n){t.mediaDevices.getUserMedia(e).then(r,n)}.bind(t))}function cn(e){return e&&void 0!==e.video?Object.assign({},e,{video:kr(e.video)}):e}function un(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,r){if(e&&e.iceServers){for(var n=[],i=0;i<e.iceServers.length;i++){var o=e.iceServers[i];!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")?(Cr("RTCIceServer.url","RTCIceServer.urls"),(o=JSON.parse(JSON.stringify(o))).urls=o.url,delete o.url,n.push(o)):n.push(e.iceServers[i])}e.iceServers=n}return new t(e,r)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}}function ln(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function dn(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var r=this.getTransceivers().find((e=>"audio"===e.receiver.track.kind));!1===e.offerToReceiveAudio&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveAudio||r||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var n=this.getTransceivers().find((e=>"video"===e.receiver.track.kind));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function hn(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var fn=Object.freeze({__proto__:null,shimLocalStreamsAPI:nn,shimRemoteStreamsAPI:on,shimCallbacksAPI:sn,shimGetUserMedia:an,shimConstraints:cn,shimRTCIceServerUrls:un,shimTrackEventTransceiver:ln,shimCreateOfferLegacy:dn,shimAudioContext:hn}),pn={exports:{}};!function(e){var t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((e=>e.trim()))},t.splitSections=function(e){return e.split("\nm=").map(((e,t)=>(t>0?"m="+e:e).trim()+"\r\n"))},t.getDescription=function(e){var r=t.splitSections(e);return r&&r[0]},t.getMediaSections=function(e){var r=t.splitSections(e);return r.shift(),r},t.matchPrefix=function(e,r){return t.splitLines(e).filter((e=>0===e.indexOf(r)))},t.parseCandidate=function(e){for(var t,r={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},n=8;n<t.length;n+=2)switch(t[n]){case"raddr":r.relatedAddress=t[n+1];break;case"rport":r.relatedPort=parseInt(t[n+1],10);break;case"tcptype":r.tcpType=t[n+1];break;case"ufrag":r.ufrag=t[n+1],r.usernameFragment=t[n+1];break;default:void 0===r[t[n]]&&(r[t[n]]=t[n+1])}return r},t.writeCandidate=function(e){var t=[];t.push(e.foundation);var r=e.component;"rtp"===r?t.push(1):"rtcp"===r?t.push(2):t.push(r),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){var t=e.substr(9).split(" "),r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.channels=3===t.length?parseInt(t[2],10):1,r.numChannels=r.channels,r},t.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},t.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){for(var t,r={},n=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<n.length;i++)r[(t=n[i].trim().split("="))[0].trim()]=t[1];return r},t.writeFmtp=function(e){var t="",r=e.payloadType;if(void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var n=[];Object.keys(e.parameters).forEach((t=>{void 0!==e.parameters[t]?n.push(t+"="+e.parameters[t]):n.push(t)})),t+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){var t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((e=>{t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:parseInt(e.substr(7,t-7),10)},n=e.indexOf(":",t);return n>-1?(r.attribute=e.substr(t+1,n-t-1),r.value=e.substr(n+1)):r.attribute=e.substr(t+1),r},t.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((e=>parseInt(e,10)))}},t.getMid=function(e){var r=t.matchPrefix(e,"a=mid:")[0];if(r)return r.substr(6)},t.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,r){return{role:"auto",fingerprints:t.matchPrefix(e+r,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";return e.fingerprints.forEach((e=>{r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),r},t.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,r){return t.matchPrefix(e+r,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,r){var n=t.matchPrefix(e+r,"a=ice-ufrag:")[0],i=t.matchPrefix(e+r,"a=ice-pwd:")[0];return n&&i?{usernameFragment:n.substr(12),password:i.substr(10)}:null},t.writeIceParameters=function(e){var t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){for(var r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=t.splitLines(e)[0].split(" "),i=3;i<n.length;i++){var o=n[i],s=t.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(s){var a=t.parseRtpMap(s),c=t.matchPrefix(e,"a=fmtp:"+o+" ");switch(a.parameters=c.length?t.parseFmtp(c[0]):{},a.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(t.parseRtcpFb),r.codecs.push(a),a.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(a.name.toUpperCase())}}}return t.matchPrefix(e,"a=extmap:").forEach((e=>{r.headerExtensions.push(t.parseExtmap(e))})),r},t.writeRtpDescription=function(e,r){var n="";n+="m="+e+" ",n+=r.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=r.codecs.map((e=>void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType)).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",r.codecs.forEach((e=>{n+=t.writeRtpMap(e),n+=t.writeFmtp(e),n+=t.writeRtcpFb(e)}));var i=0;return r.codecs.forEach((e=>{e.maxptime>i&&(i=e.maxptime)})),i>0&&(n+="a=maxptime:"+i+"\r\n"),r.headerExtensions&&r.headerExtensions.forEach((e=>{n+=t.writeExtmap(e)})),n},t.parseRtpEncodingParameters=function(e){var r,n=[],i=t.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),s=-1!==i.fecMechanisms.indexOf("ULPFEC"),a=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute)),c=a.length>0&&a[0].ssrc,u=t.matchPrefix(e,"a=ssrc-group:FID").map((e=>e.substr(17).split(" ").map((e=>parseInt(e,10)))));u.length>0&&u[0].length>1&&u[0][0]===c&&(r=u[0][1]),i.codecs.forEach((e=>{if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&r&&(t.rtx={ssrc:r}),n.push(t),o&&((t=JSON.parse(JSON.stringify(t))).fec={ssrc:c,mechanism:s?"red+ulpfec":"red"},n.push(t))}})),0===n.length&&c&&n.push({ssrc:c});var l=t.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,n.forEach((e=>{e.maxBitrate=l}))),n},t.parseRtcpParameters=function(e){var r={},n=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute))[0];n&&(r.cname=n.value,r.ssrc=n.ssrc);var i=t.matchPrefix(e,"a=rtcp-rsize");r.reducedSize=i.length>0,r.compound=0===i.length;var o=t.matchPrefix(e,"a=rtcp-mux");return r.mux=o.length>0,r},t.writeRtcpParameters=function(e){var t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){var r,n=t.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(r=n[0].substr(7).split(" "))[0],track:r[1]};var i=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"msid"===e.attribute));return i.length>0?{stream:(r=i[0].value.split(" "))[0],track:r[1]}:void 0},t.parseSctpDescription=function(e){var r,n=t.parseMLine(e),i=t.matchPrefix(e,"a=max-message-size:");i.length>0&&(r=parseInt(i[0].substr(19),10)),isNaN(r)&&(r=65536);var o=t.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:n.fmt,maxMessageSize:r};var s=t.matchPrefix(e,"a=sctpmap:");if(s.length>0){var a=s[0].substr(10).split(" ");return{port:parseInt(a[0],10),protocol:a[1],maxMessageSize:r}}},t.writeSctpDescription=function(e,t){var r=[];return r="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&r.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),r.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,r,n){var i=void 0!==r?r:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||t.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,r){for(var n=t.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return r?t.getDirection(r):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){var r=t.splitLines(e)[0].substr(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}},t.parseOLine=function(e){var r=t.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var r=t.splitLines(e),n=0;n<r.length;n++)if(r[n].length<2||"="!==r[n].charAt(1))return!1;return!0},e.exports=t}(pn);var mn=pn.exports,gn=Je({__proto__:null,default:mn},[pn.exports]);function vn(e){if(!(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var r=new t(e),n=mn.parseCandidate(e.candidate),i=Object.assign(r,n);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,Tr(e,"icecandidate",(t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t)))}}function yn(e,t){if(e.RTCPeerConnection){"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){var{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;var t=mn.splitSections(e.sdp);return t.shift(),t.some((e=>{var t=mn.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){var n,i=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var r=parseInt(t[1],10);return r!=r?-1:r}(arguments[0]),o=(c=i,u=65536,"firefox"===t.browser&&(u=t.version<57?-1===c?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),u),s=function(e,r){var n=65536;"firefox"===t.browser&&57===t.version&&(n=65535);var i=mn.matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?n=parseInt(i[0].substr(19),10):"firefox"===t.browser&&-1!==r&&(n=2147483637),n}(arguments[0],i);n=0===o&&0===s?Number.POSITIVE_INFINITY:0===o||0===s?Math.max(o,s):Math.min(o,s);var a={};Object.defineProperty(a,"maxMessageSize",{get:()=>n}),this._sctp=a}var c,u;return r.apply(this,arguments)}}}function bn(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return r(e,this),e},Tr(e,"datachannel",(e=>(r(e.channel,e.target),e)))}function r(e,t){var r=e.send;e.send=function(){var n=arguments[0],i=n.length||n.size||n.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return r.apply(e,arguments)}}}function En(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((e=>{var r=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var r=new Event("connectionstatechange",e);t.dispatchEvent(r)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}}))}}function wn(e,t){if(e.RTCPeerConnection&&!("chrome"===t.browser&&t.version>=71||"safari"===t.browser&&t.version>=605)){var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){var n=t.sdp.split("\n").filter((e=>"a=extmap-allow-mixed"!==e.trim())).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return r.apply(this,arguments)}}}function Sn(e,t){if(e.RTCPeerConnection&&e.RTCPeerConnection.prototype){var r=e.RTCPeerConnection.prototype.addIceCandidate;r&&0!==r.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}}function _n(e,t){if(e.RTCPeerConnection&&e.RTCPeerConnection.prototype){var r=e.RTCPeerConnection.prototype.setLocalDescription;r&&0!==r.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){var e=arguments[0]||{};if("object"!=typeof e||e.type&&e.sdp)return r.apply(this,arguments);if(!(e={type:e.type,sdp:e.sdp}).type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}return e.sdp||"offer"!==e.type&&"answer"!==e.type?r.apply(this,[e]):("offer"===e.type?this.createOffer:this.createAnswer).apply(this).then((e=>r.apply(this,[e])))})}}var Tn,xn,An=Object.freeze({__proto__:null,shimRTCIceCandidate:vn,shimMaxMessageSize:yn,shimSendThrowTypeError:bn,shimConnectionState:En,removeExtmapAllowMixed:wn,shimAddIceCandidateNullOrEmpty:Sn,shimParameterlessSetLocalDescription:_n});!function(){var{window:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0},r=Ir,n=function(e){var t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;var{navigator:r}=e;if(r.mozGetUserMedia)t.browser="firefox",t.version=_r(r.userAgent,/Firefox\/(\d+)\./,1);else if(r.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=_r(r.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.RTCPeerConnection||!r.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=_r(r.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(e),i={browserDetails:n,commonShim:An,extractVersion:_r,disableLog:xr,disableWarnings:Ar,sdp:gn};switch(n.browser){case"chrome":if(!qr||!Hr||!t.shimChrome)return r("Chrome shim is not included in this adapter release."),i;if(null===n.version)return r("Chrome shim can not determine version, not shimming."),i;r("adapter.js shimming chrome."),i.browserShim=qr,Sn(e,n),_n(e),Lr(e,n),Dr(e),Hr(e,n),Mr(e),Vr(e,n),Ur(e),Br(e),Fr(e),Gr(e,n),vn(e),En(e),yn(e,n),bn(e),wn(e,n);break;case"firefox":if(!rn||!zr||!t.shimFirefox)return r("Firefox shim is not included in this adapter release."),i;r("adapter.js shimming firefox."),i.browserShim=rn,Sn(e,n),_n(e),$r(e,n),zr(e,n),Zr(e),Jr(e),Kr(e),Wr(e),Yr(e),Qr(e),Xr(e),en(e),tn(e),vn(e),En(e),yn(e,n),bn(e);break;case"safari":if(!fn||!t.shimSafari)return r("Safari shim is not included in this adapter release."),i;r("adapter.js shimming safari."),i.browserShim=fn,Sn(e,n),_n(e),un(e),dn(e),sn(e),nn(e),on(e),ln(e),an(e),hn(e),vn(e),yn(e,n),bn(e),wn(e,n);break;default:r("Unsupported browser!")}}({window:"undefined"==typeof window?void 0:window}),function(e){e.Audio="audio",e.Video="video"}(Tn||(Tn={})),function(e){e.IceGatheringStateChange="icegatheringstatechange",e.ConnectionStateChange="connectionstatechange"}(xn||(xn={}));class In extends br{constructor(e){super(),nt.log("PeerConnection init"),this.pc=function(e){return new RTCPeerConnection(e)}(e),this.connectionStateHandler=new Er((()=>({connectionState:this.pc.connectionState,iceState:this.pc.iceConnectionState}))),this.connectionStateHandler.on(Er.Events.ConnectionStateChanged,(e=>{this.emit(In.Events.ConnectionStateChange,e)})),this.pc.oniceconnectionstatechange=()=>this.connectionStateHandler.onIceConnectionStateChange(),this.pc.onconnectionstatechange=()=>this.connectionStateHandler.onConnectionStateChange(),this.pc.onicegatheringstatechange=e=>{this.emit(In.Events.IceGatheringStateChange,e)}}getUnderlyingRTCPeerConnection(){return this.pc}getConnectionState(){return this.connectionStateHandler.getConnectionState()}addTrack(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return this.pc.addTrack(e,...r)}addTransceiver(e,t){return this.pc.addTransceiver(e,t)}removeTrack(e){this.pc.removeTrack(e)}createDataChannel(e,t){return this.pc.createDataChannel(e,t)}createAnswer(e){return Ye(this,void 0,void 0,(function*(){return this.pc.createAnswer(e)}))}createOffer(e){return Ye(this,void 0,void 0,(function*(){return this.pc.createOffer(e)}))}setLocalDescription(e){var t;return Ye(this,void 0,void 0,(function*(){return er.isFirefox()&&(null===(t=null==e?void 0:e.sdp)||void 0===t||t.split(/(\r\n|\r|\n)/).filter((e=>e.startsWith("m"))).forEach((e=>{if(e.trim().split(" ").length<4)throw new Error("Invalid media line ".concat(e,", expected at least 4 fields"))}))),this.pc.setLocalDescription(e)}))}setRemoteDescription(e){return Ye(this,void 0,void 0,(function*(){return this.pc.setRemoteDescription(e)}))}close(){this.pc.close()}getLocalDescription(){return this.pc.localDescription}getRemoteDescription(){return this.pc.remoteDescription}getSenders(){return this.pc.getSenders()}getTransceivers(){return this.pc.getTransceivers()}getStats(e){return this.pc.getStats(e)}get iceGatheringState(){return this.pc.iceGatheringState}getCurrentConnectionType(){var e;return Ye(this,void 0,void 0,(function*(){if(!("connected"===this.pc.iceConnectionState||"completed"===this.pc.iceConnectionState))throw new Error("Ice connection is not established");var t=new Set,r=[];(yield this.pc.getStats()).forEach((e=>{var n;"candidate-pair"===e.type&&"succeeded"===(null===(n=e.state)||void 0===n?void 0:n.toLowerCase())&&t.add(e.localCandidateId),"local-candidate"===e.type&&r.push(e)}));var n=r.find((e=>t.has(e.id)));return n?n.relayProtocol?"TURN-".concat(n.relayProtocol.toUpperCase()):null===(e=n.protocol)||void 0===e?void 0:e.toUpperCase():"unknown"}))}}In.Events=xn;var Cn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==xe?xe:"undefined"!=typeof self?self:{},Rn={exports:{}};!function(e){!function(t){var r,n={};n.VERSION="1.6.1";var i={},o=function(e,t){return function(){return t.apply(e,arguments)}},s=function(){var e,t,r=arguments,n=r[0];for(t=1;t<r.length;t++)for(e in r[t])!(e in n)&&r[t].hasOwnProperty(e)&&(n[e]=r[t][e]);return n},a=function(e,t){return{value:e,name:t}};n.TRACE=a(1,"TRACE"),n.DEBUG=a(2,"DEBUG"),n.INFO=a(3,"INFO"),n.TIME=a(4,"TIME"),n.WARN=a(5,"WARN"),n.ERROR=a(8,"ERROR"),n.OFF=a(99,"OFF");var c=function(e){this.context=e,this.setLevel(e.filterLevel),this.log=this.info};c.prototype={setLevel:function(e){e&&"value"in e&&(this.context.filterLevel=e)},getLevel:function(){return this.context.filterLevel},enabledFor:function(e){var t=this.context.filterLevel;return e.value>=t.value},trace:function(){this.invoke(n.TRACE,arguments)},debug:function(){this.invoke(n.DEBUG,arguments)},info:function(){this.invoke(n.INFO,arguments)},warn:function(){this.invoke(n.WARN,arguments)},error:function(){this.invoke(n.ERROR,arguments)},time:function(e){"string"==typeof e&&e.length>0&&this.invoke(n.TIME,[e,"start"])},timeEnd:function(e){"string"==typeof e&&e.length>0&&this.invoke(n.TIME,[e,"end"])},invoke:function(e,t){r&&this.enabledFor(e)&&r(t,s({level:e},this.context))}};var u,l=new c({filterLevel:n.OFF});(u=n).enabledFor=o(l,l.enabledFor),u.trace=o(l,l.trace),u.debug=o(l,l.debug),u.time=o(l,l.time),u.timeEnd=o(l,l.timeEnd),u.info=o(l,l.info),u.warn=o(l,l.warn),u.error=o(l,l.error),u.log=u.info,n.setHandler=function(e){r=e},n.setLevel=function(e){for(var t in l.setLevel(e),i)i.hasOwnProperty(t)&&i[t].setLevel(e)},n.getLevel=function(){return l.getLevel()},n.get=function(e){return i[e]||(i[e]=new c(s({name:e},l.context)))},n.createDefaultHandler=function(e){(e=e||{}).formatter=e.formatter||function(e,t){t.name&&e.unshift("["+t.name+"]")};var t={},r=function(e,t){Function.prototype.apply.call(e,console,t)};return"undefined"==typeof console?function(){}:function(i,o){i=Array.prototype.slice.call(i);var s,a=console.log;o.level===n.TIME?(s=(o.name?"["+o.name+"] ":"")+i[0],"start"===i[1]?console.time?console.time(s):t[s]=(new Date).getTime():console.timeEnd?console.timeEnd(s):r(a,[s+": "+((new Date).getTime()-t[s])+"ms"])):(o.level===n.WARN&&console.warn?a=console.warn:o.level===n.ERROR&&console.error?a=console.error:o.level===n.INFO&&console.info?a=console.info:o.level===n.DEBUG&&console.debug?a=console.debug:o.level===n.TRACE&&console.trace&&(a=console.trace),e.formatter(i,o),r(a,i))}},n.useDefaults=function(e){n.setLevel(e&&e.defaultLevel||n.DEBUG),n.setHandler(n.createDefaultHandler(e))},n.setDefaults=n.useDefaults,e.exports?e.exports=n:(n._prevLogger=t.Logger,n.noConflict=function(){return t.Logger=n._prevLogger,n},t.Logger=n)}(Cn)}(Rn);var kn,On,Nn,Pn,Ln=Rn.exports;function Dn(){return function(e,t){return Math.floor(Math.random()*(t-e+1))+e}(0,8388607)}function Mn(e,t){return t<<8|(e===kn.Audio?0:1)}function Un(e){return[Pn.VideoMain,Pn.VideoSlides].includes(e)?kn.Video:kn.Audio}function Bn(e){return[Pn.VideoMain,Pn.AudioMain].includes(e)?On.Main:On.Slides}Ln.useDefaults({defaultLevel:Ln.DEBUG,formatter:(e,t)=>{e.unshift("[".concat(t.name,"] "))}}),function(e){e.Audio="AUDIO",e.Video="VIDEO"}(kn||(kn={})),function(e){e.Main="MAIN",e.Slides="SLIDES"}(On||(On={})),function(e){e.ActiveSpeaker="active-speaker",e.ReceiverSelected="receiver-selected"}(Nn||(Nn={})),function(e){e.VideoMain="VIDEO-MAIN",e.VideoSlides="VIDEO-SLIDES",e.AudioMain="AUDIO-MAIN",e.AudioSlides="AUDIO-SLIDES"}(Pn||(Pn={}));var Fn,jn,Vn,Hn,Gn=e=>0===e||e;function qn(e,t,r){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n+=1)if(!r(e[n],t[n]))return!1;return!0}class $n{constructor(e,t,r,n,i){this.priority=e,this.crossPriorityDuplication=t,this.crossPolicyDuplication=r,this.preferLiveVideo=n,this.namedMediaGroups=i}toString(){return"ActiveSpeakerInfo(priority=".concat(this.priority,", crossPriorityDuplication=").concat(this.crossPriorityDuplication,", crossPolicyDuplication=").concat(this.crossPolicyDuplication,", preferLiveVideo=").concat(this.preferLiveVideo,"), namedMediaGroups=").concat(this.namedMediaGroups)}}function Zn(e){return Boolean("priority"in e&&"crossPriorityDuplication"in e&&"crossPolicyDuplication"in e&&"preferLiveVideo"in e)}function zn(e,t){return e.priority===t.priority&&e.crossPriorityDuplication===t.crossPriorityDuplication&&e.crossPolicyDuplication===t.crossPolicyDuplication&&e.preferLiveVideo===t.preferLiveVideo&&function(e,t){return void 0===e||void 0===t?e===t:qn(e,t,((e,t)=>e.type===t.type&&e.value===t.value))}(e.namedMediaGroups,t.namedMediaGroups)}!function(e){e.Multistream="multistream"}(Fn||(Fn={}));class Kn{constructor(e,t){this.msgType=e,this.payload=t}static fromJson(e){return e.msgType&&e.payload?new Kn(e.msgType,e.payload):null}}!function(e){e.MediaRequest="mediaRequest",e.MediaRequestAck="mediaRequestAck",e.MediaRequestStatus="mediaRequestStatus",e.MediaRequestStatusAck="mediaRequestStatusAck",e.SourceAdvertisement="sourceAdvertisement",e.SourceAdvertisementAck="sourceAdvertisementAck",e.ActiveSpeakerNotification="activeSpeakerNotification"}(jn||(jn={}));class Wn{constructor(e,t,r){this.mediaFamily=e,this.mediaContent=t,this.payload=r}toString(){return"JmpMsg(mediaFamily=".concat(this.mediaFamily,", mediaContent=").concat(this.mediaContent,", payload=").concat(this.payload,")")}}function Jn(e){var t=e;return Boolean(t.mediaContent&&t.mediaFamily&&t.payload&&function(e){var t=e;return Boolean(t.msgType&&t.payload)}(t.payload))}class Yn{constructor(e,t){this.seqNum=e,this.requests=t}toString(){return"JmpMediaMsg(seqNum=".concat(this.seqNum,", requests=[").concat(this.requests,"])")}}class Qn{constructor(e){this.mediaRequestSeqNum=e}toString(){return"MediaRequestAckMsg(seqNum=".concat(this.mediaRequestSeqNum,")")}}function Xn(e,t){var r=Object.keys(e),n=Object.keys(t);return r.length===n.length&&r.every((r=>e[r]===t[r]))}function ei(e){var t=e;return Boolean(t.id&&function(e){var t=e;return(!t.mid||!t.ssrc)&&(Boolean(t.mid)||Boolean(t.ssrc))}(t.id)&&["no source","invalid source","live","avatar","bandwidth disabled"].includes(t.state))}class ti{constructor(e,t){this.seqNum=e,this.streamStates=t}}class ri{constructor(e){this.mediaRequestStatusSeqNum=e}toString(){return"MediaRequestStatusAckMsg(seqNum=".concat(this.mediaRequestStatusSeqNum,")")}}class ni{constructor(e,t,r,n,i){this.maxFs=e,this.maxFps=t,this.maxMbps=r,this.maxWidth=n,this.maxHeight=i}}class ii{constructor(e,t){this.payloadType=e,this.h264=t}}function oi(e,t){return e.payloadType===t.payloadType&&function(e,t){return void 0===e||void 0===t?e===t:e.maxFs===t.maxFs&&e.maxFps===t.maxFps&&e.maxMbps===t.maxMbps&&e.maxWidth===t.maxWidth&&e.maxHeight===t.maxHeight}(e.h264,t.h264)}class si{constructor(e){this.csi=e}toString(){return"ReceiverSelectedInfo(csi=".concat(this.csi,")")}}function ai(e){return Boolean(e.csi)}class ci{constructor(e,t,r,n,i){this.seqNum=e,this.numTotalSources=t,this.numLiveSources=r,this.namedMediaGroups=n,this.videoContentHint=i}toString(){return"SourceAdvertisement(seqNum=".concat(this.seqNum,", numTotalSources=").concat(this.numTotalSources,", numLiveSources=").concat(this.numLiveSources,", namedMediaGroups=").concat(this.namedMediaGroups,", videoContentHint=").concat(this.videoContentHint)}}class ui{constructor(e){this.sourceAdvertisementSeqNum=e}toString(){return"SourceAdvertisementAckMsg(sourceAdvertisementSeqNum=".concat(this.sourceAdvertisementSeqNum,")")}}class li{constructor(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];this.policy=e,this.policySpecificInfo=t,this.ids=r,this.maxPayloadBitsPerSecond=n,this.codecInfos=i}toString(){return"Request(policy=".concat(this.policy,", info=").concat(this.policySpecificInfo,", ids=[").concat(this.ids,"], maxPayloadBitsPerSecond=[").concat(this.maxPayloadBitsPerSecond,"], codecInfos=[").concat(this.codecInfos,"])")}}function di(e,t){return e.policy===t.policy&&(!!function(e,t){if(Zn(e))return!!Zn(t)&&zn(e,t);if(ai(e))return!!ai(t)&&function(e,t){return e.csi===t.csi}(e,t);throw new Error("Invalid PolicySpecificInfo")}(e.policySpecificInfo,t.policySpecificInfo)&&(!!function(e,t){return qn(e,t,Xn)}(e.ids,t.ids)&&(e.maxPayloadBitsPerSecond===t.maxPayloadBitsPerSecond&&!!function(e,t){return qn(e,t,oi)}(e.codecInfos,t.codecInfos))))}class hi{constructor(e,t,r,n,i){this.timerHandle=void 0,this.msg=e,this.numRetransmitsLeft=t,this.retransmitIntervalMs=r,this.transmitCallback=n,this.expirationCallback=i,this.scheduleTimer()}onTimer(){var e;this.numRetransmitsLeft>0?(--this.numRetransmitsLeft,this.transmitCallback(this.msg),this.scheduleTimer()):null===(e=this.expirationCallback)||void 0===e||e.call(this,this.msg)}scheduleTimer(){this.timerHandle=window.setTimeout((()=>this.onTimer()),this.retransmitIntervalMs)}cancel(){this.timerHandle&&clearTimeout(this.timerHandle),this.timerHandle=void 0}}!function(e){e.ActiveSpeaker="active-speaker",e.MediaRequestReceived="media-request-received",e.MediaRequestStatusReceived="media-request-status-received",e.SourceAdvertisementReceived="source-advertisement-received"}(Vn||(Vn={}));class fi extends J{constructor(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:250;super(),this.currMediaRequestSeqNum=1,this.currSourceAdvertisementSeqNum=1,this.currMediaRequestStatusSeqNum=1,this.txCallback=void 0,this.lastSentMediaRequest=void 0,this.lastSentMediaRequestAck=void 0,this.lastReceivedMediaRequest=void 0,this.mediaFamily=e,this.mediaContent=t,this.logger=Ln.get("JmpSession ".concat(this.mediaFamily,"-").concat(this.mediaContent)),this.maxNumRetransmits=r,this.retransmitIntervalMs=n}getLogger(){return this.logger}sendRequests(e){var t,r=new Yn(this.currMediaRequestSeqNum,e);this.lastSentMediaRequest&&function(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r+=1)if(!di(e[r],t[r]))return!1;return!0}(this.lastSentMediaRequest.msg.requests,e)?this.logger.info("Duplicate MediaRequest detected and will not be sent: ".concat(r)):(this.sendJmpMsg(jn.MediaRequest,r),null===(t=this.lastSentMediaRequest)||void 0===t||t.cancel(),this.lastSentMediaRequest=new hi(r,this.maxNumRetransmits,this.retransmitIntervalMs,(()=>{this.logger.info("Retransmitting previously sent MediaRequest..."),this.sendJmpMsg(jn.MediaRequest,r)}),(e=>{this.logger.warn("Retransmits for message expired: ".concat(e))})),this.currMediaRequestSeqNum++)}sendSourceAdvertisement(e,t,r,n){var i,o,s,a=new ci(this.currSourceAdvertisementSeqNum,e,t,r,n);this.lastSentSourceAdvertisement&&(o=this.lastSentSourceAdvertisement.msg,s=a,o.numLiveSources===s.numLiveSources&&o.numTotalSources===s.numTotalSources&&function(e,t){var r,n;if(e.length!==t.length)return!1;for(var i=0;i<e.length;i+=1){if(e[i].type!==t[i].type)return!1;if((null===(r=e[i])||void 0===r?void 0:r.value)!==(null===(n=t[i])||void 0===n?void 0:n.value))return!1}return!0}(o.namedMediaGroups||[],s.namedMediaGroups||[])&&o.videoContentHint===s.videoContentHint)?this.logger.info("Duplicate SourceAdvertisement detected and will not be sent: ",a):(this.sendJmpMsg(jn.SourceAdvertisement,a),null===(i=this.lastSentSourceAdvertisement)||void 0===i||i.cancel(),this.lastSentSourceAdvertisement=new hi(a,this.maxNumRetransmits,this.retransmitIntervalMs,(()=>{this.logger.info("Retransmitting previously sent SourceAdvertisement..."),this.sendJmpMsg(jn.SourceAdvertisement,a)}),(e=>{this.logger.warn("Retransmits for message expired: ",e)})),this.currSourceAdvertisementSeqNum++)}sendMediaRequestStatus(e){var t,r,n=e.filter((e=>{var t;return null===(t=this.lastReceivedMediaRequest)||void 0===t?void 0:t.requests.some((t=>t.ids.find((t=>Xn(t,e.id)))))})),i=new ti(this.currMediaRequestStatusSeqNum,n);(null===(t=this.lastSentMediaRequestStatus)||void 0===t?void 0:t.msg.streamStates)&&function(e,t){var r,n;if(e.length!==t.length)return!1;for(var i=0;i<e.length;i+=1){if(!Xn(e[i].id,t[i].id))return!1;if(e[i].state!==t[i].state)return!1;if((null===(r=e[i])||void 0===r?void 0:r.csi)!==(null===(n=t[i])||void 0===n?void 0:n.csi))return!1}return!0}(n,this.lastSentMediaRequestStatus.msg.streamStates)?this.logger.info("Duplicate MediaRequestStatus detected and will not be sent: ",i):(this.sendJmpMsg(jn.MediaRequestStatus,i),null===(r=this.lastSentMediaRequestStatus)||void 0===r||r.cancel(),this.lastSentMediaRequestStatus=new hi(i,this.maxNumRetransmits,this.retransmitIntervalMs,(()=>{this.logger.info("Retransmitting previously sent MediaRequestStatus..."),this.sendJmpMsg(jn.MediaRequestStatus,i)}),(e=>{this.logger.warn("Retransmits for message expired: ",e)})),this.currMediaRequestStatusSeqNum++)}receive(e){if(e.mediaContent===this.mediaContent&&e.mediaFamily===this.mediaFamily){this.logger.debug("Received JmpMsg",JSON.stringify(e));var t,{payload:r}=e;if(r.msgType===jn.MediaRequest){var n=r.payload;if(t=n,!Boolean(t.seqNum&&t.requests))return void this.logger.error("Received invalid MediaRequest:",JSON.stringify(n));this.handleIncomingMediaRequest(n)}else if(r.msgType===jn.MediaRequestAck){var i=r.payload;if(!function(e){return Boolean(e.mediaRequestSeqNum)}(i))return void this.logger.error("Received invalid MediaRequest ACK:",JSON.stringify(i));this.handleIncomingMediaRequestAck(i)}else if(r.msgType===jn.ActiveSpeakerNotification){var o=r.payload;if(!function(e){var t=e;return Boolean(t.seqNum&&t.csis)}(o))return void this.logger.info("Received invalid Active Speaker Notification:",JSON.stringify(o));this.handleIncomingActiveSpeakerNotification(o)}else if(r.msgType===jn.SourceAdvertisement){var s=r.payload;if(!function(e){var t=e;return Boolean(t.seqNum&&Gn(t.numTotalSources)&&Gn(t.numLiveSources))}(s))return void this.logger.error("Received invalid SourceAdvertisementMsg:",JSON.stringify(s));this.handleIncomingSourceAdvertisement(s)}else if(r.msgType===jn.SourceAdvertisementAck){var a=r.payload;if(!function(e){return Boolean(e.sourceAdvertisementSeqNum)}(a))return void this.logger.error("Received invalid SourceAdvertisementAckMsg:",JSON.stringify(a));this.handleIncomingSourceAdvertisementAck(a)}else if(r.msgType===jn.MediaRequestStatus){var c=r.payload;if(!function(e){var t=e;return Boolean(t.seqNum)&&t.streamStates&&t.streamStates.every((e=>ei(e)))}(c))return void this.logger.error("Received invalid MediaRequestStatusMsg:",JSON.stringify(c));this.handleIncomingMediaRequestStatus(c)}else if(r.msgType===jn.MediaRequestStatusAck){var u=r.payload;if(!function(e){return Boolean(e.mediaRequestStatusSeqNum)}(u))return void this.logger.error("Received invalid MediaRequestStatusAckMsg:",JSON.stringify(u));this.handleIncomingMediaRequestStatusAck(u)}else this.logger.error("Received unknown JmpMsg")}else this.logger.error("JmpMsg ".concat(JSON.stringify(e)," sent to incorrect JmpSession"))}setTxCallback(e){this.txCallback=e}close(){var e,t,r;this.logger.info("closing"),null===(e=this.lastSentMediaRequest)||void 0===e||e.cancel(),null===(t=this.lastSentMediaRequestStatus)||void 0===t||t.cancel(),null===(r=this.lastSentSourceAdvertisement)||void 0===r||r.cancel()}sendJmpMsg(e,t){var r,n=new Wn(this.mediaFamily,this.mediaContent,{msgType:e,payload:t}),i=new Kn(Fn.Multistream,n);null===(r=this.txCallback)||void 0===r||r.call(this,JSON.stringify(i))}handleIncomingMediaRequest(e){var t;if(this.lastReceivedMediaRequest&&e.seqNum<(null===(t=this.lastReceivedMediaRequest)||void 0===t?void 0:t.seqNum))this.logger.info("Received old MediaRequest, ignoring");else if(this.lastReceivedMediaRequest&&e.seqNum===this.lastReceivedMediaRequest.seqNum)this.lastSentMediaRequestAck?(this.logger.info("Received duplicate MediaRequest, re-sending ACK"),this.sendJmpMsg(jn.MediaRequestAck,this.lastSentMediaRequestAck)):this.logger.warn("Received duplicate MediaRequest, but there was no ACK previously sent");else{this.logger.info("Received new MediaRequest, sending ACK");var r=new Qn(e.seqNum);this.lastReceivedMediaRequest=e,this.lastSentMediaRequestAck=r,this.sendJmpMsg(jn.MediaRequestAck,r),this.emit(Vn.MediaRequestReceived,e)}}handleIncomingMediaRequestAck(e){var t,r,n;e.mediaRequestSeqNum===(null===(r=null===(t=this.lastSentMediaRequest)||void 0===t?void 0:t.msg)||void 0===r?void 0:r.seqNum)?(this.logger.info("Received ACK for last sent MediaRequest"),null===(n=this.lastSentMediaRequest)||void 0===n||n.cancel()):this.logger.info("Received ACK for old MediaRequest")}handleIncomingActiveSpeakerNotification(e){this.logger.debug("Received Active Speaker Notification:",e),this.emit(Vn.ActiveSpeaker,e)}handleIncomingSourceAdvertisement(e){if(this.lastReceivedSourceAdvertisement&&e.seqNum<this.lastReceivedSourceAdvertisement.seqNum)this.logger.info("Received old SourceAdvertisement, ignoring");else if(this.lastReceivedSourceAdvertisement&&e.seqNum===this.lastReceivedSourceAdvertisement.seqNum)this.lastSentSourceAdvertisementAck?(this.logger.info("Received duplicate SourceAdvertisement, re-sending ACK"),this.sendJmpMsg(jn.SourceAdvertisementAck,this.lastSentSourceAdvertisementAck)):this.logger.warn("Received duplicate SourceAdvertisement, but there was no ACK previously sent");else{this.logger.info("Received new SourceAdvertisement, sending ACK");var t=new ui(e.seqNum);this.lastReceivedSourceAdvertisement=e,this.lastSentSourceAdvertisementAck=t,this.sendJmpMsg(jn.SourceAdvertisementAck,t),this.emit(Vn.SourceAdvertisementReceived,e)}}handleIncomingSourceAdvertisementAck(e){var t,r,n;e.sourceAdvertisementSeqNum===(null===(r=null===(t=this.lastSentSourceAdvertisement)||void 0===t?void 0:t.msg)||void 0===r?void 0:r.seqNum)?(this.logger.info("Received ACK for last sent SourceAdvertisement"),null===(n=this.lastSentSourceAdvertisement)||void 0===n||n.cancel()):this.logger.info("Received ACK for old SourceAdvertisement")}handleIncomingMediaRequestStatus(e){if(this.lastReceivedMediaRequestStatus&&e.seqNum<this.lastReceivedMediaRequestStatus.seqNum)this.logger.info("Received old MediaRequestStatus, ignoring");else if(this.lastReceivedMediaRequestStatus&&e.seqNum===this.lastReceivedMediaRequestStatus.seqNum)this.lastSentMediaRequestStatusAck?(this.logger.info("Received duplicate MediaRequestStatus, re-sending ACK"),this.sendJmpMsg(jn.MediaRequestStatusAck,this.lastSentMediaRequestStatusAck)):this.logger.warn("Received duplicate MediaRequestStatus, but there was no ACK previously sent");else{this.logger.info("Received new MediaRequestStatus, sending ACK");var t=new ri(e.seqNum);this.lastReceivedMediaRequestStatus=e,this.lastSentMediaRequestStatusAck=t,this.sendJmpMsg(jn.MediaRequestStatusAck,t),this.emit(Vn.MediaRequestStatusReceived,e)}}handleIncomingMediaRequestStatusAck(e){var t,r,n;e.mediaRequestStatusSeqNum===(null===(r=null===(t=this.lastSentMediaRequestStatus)||void 0===t?void 0:t.msg)||void 0===r?void 0:r.seqNum)?(this.logger.info("Received ACK for last sent MediaRequestStatus"),null===(n=this.lastSentMediaRequestStatus)||void 0===n||n.cancel()):this.logger.info("Received ACK for old MediaRequestStatus")}}!function(e){e.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",e.SET_ANSWER_FAILED="SET_ANSWER_FAILED",e.OFFER_ANSWER_MISMATCH="OFFER_ANSWER_MISMATCH",e.SDP_MUNGE_FAILED="SDP_MUNGE_FAILED",e.SDP_MUNGE_MISSING_CODECS="SDP_MUNGE_MISSING_CODECS",e.INVALID_STREAM_REQUEST="INVALID_STREAM_REQUEST",e.GET_TRANSCEIVER_FAILED="GET_TRANSCEIVER_FAILED",e.GET_MAX_BITRATE_FAILED="GET_MAX_BITRATE_FAILED",e.GET_PAYLOAD_TYPE_FAILED="GET_PAYLOAD_TYPE_FAILED",e.SET_NMG_FAILED="SET_NMG_FAILED"}(Hn||(Hn={}));class pi{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.type=e,this.message=t}}var mi="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==xe?xe:"undefined"!=typeof self?self:{},gi={exports:{}};!function(e){!function(t){var r,n={};n.VERSION="1.6.1";var i={},o=function(e,t){return function(){return t.apply(e,arguments)}},s=function(){var e,t,r=arguments,n=r[0];for(t=1;t<r.length;t++)for(e in r[t])!(e in n)&&r[t].hasOwnProperty(e)&&(n[e]=r[t][e]);return n},a=function(e,t){return{value:e,name:t}};n.TRACE=a(1,"TRACE"),n.DEBUG=a(2,"DEBUG"),n.INFO=a(3,"INFO"),n.TIME=a(4,"TIME"),n.WARN=a(5,"WARN"),n.ERROR=a(8,"ERROR"),n.OFF=a(99,"OFF");var c=function(e){this.context=e,this.setLevel(e.filterLevel),this.log=this.info};c.prototype={setLevel:function(e){e&&"value"in e&&(this.context.filterLevel=e)},getLevel:function(){return this.context.filterLevel},enabledFor:function(e){var t=this.context.filterLevel;return e.value>=t.value},trace:function(){this.invoke(n.TRACE,arguments)},debug:function(){this.invoke(n.DEBUG,arguments)},info:function(){this.invoke(n.INFO,arguments)},warn:function(){this.invoke(n.WARN,arguments)},error:function(){this.invoke(n.ERROR,arguments)},time:function(e){"string"==typeof e&&e.length>0&&this.invoke(n.TIME,[e,"start"])},timeEnd:function(e){"string"==typeof e&&e.length>0&&this.invoke(n.TIME,[e,"end"])},invoke:function(e,t){r&&this.enabledFor(e)&&r(t,s({level:e},this.context))}};var u,l=new c({filterLevel:n.OFF});(u=n).enabledFor=o(l,l.enabledFor),u.trace=o(l,l.trace),u.debug=o(l,l.debug),u.time=o(l,l.time),u.timeEnd=o(l,l.timeEnd),u.info=o(l,l.info),u.warn=o(l,l.warn),u.error=o(l,l.error),u.log=u.info,n.setHandler=function(e){r=e},n.setLevel=function(e){for(var t in l.setLevel(e),i)i.hasOwnProperty(t)&&i[t].setLevel(e)},n.getLevel=function(){return l.getLevel()},n.get=function(e){return i[e]||(i[e]=new c(s({name:e},l.context)))},n.createDefaultHandler=function(e){(e=e||{}).formatter=e.formatter||function(e,t){t.name&&e.unshift("["+t.name+"]")};var t={},r=function(e,t){Function.prototype.apply.call(e,console,t)};return"undefined"==typeof console?function(){}:function(i,o){i=Array.prototype.slice.call(i);var s,a=console.log;o.level===n.TIME?(s=(o.name?"["+o.name+"] ":"")+i[0],"start"===i[1]?console.time?console.time(s):t[s]=(new Date).getTime():console.timeEnd?console.timeEnd(s):r(a,[s+": "+((new Date).getTime()-t[s])+"ms"])):(o.level===n.WARN&&console.warn?a=console.warn:o.level===n.ERROR&&console.error?a=console.error:o.level===n.INFO&&console.info?a=console.info:o.level===n.DEBUG&&console.debug?a=console.debug:o.level===n.TRACE&&console.trace&&(a=console.trace),e.formatter(i,o),r(a,i))}},n.useDefaults=function(e){n.setLevel(e&&e.defaultLevel||n.DEBUG),n.setHandler(n.createDefaultHandler(e))},n.setDefaults=n.useDefaults,e.exports?e.exports=n:(n._prevLogger=t.Logger,n.noConflict=function(){return t.Logger=n._prevLogger,n},t.Logger=n)}(mi)}(gi);var vi,yi=gi.exports,bi=yi.get("web-client-media-engine");function Ei(e,t){throw bi.error(t),new pi(e,t)}bi.setLevel(yi.DEBUG),function(e){e.H264="video/H264",e.AV1="video/AV1",e.OPUS="audio/opus"}(vi||(vi={}));var wi;!function(e){e[e.NB=12e3]="NB",e[e.WB=2e4]="WB",e[e.FB=4e4]="FB",e[e.FB_MONO_MUSIC=64e3]="FB_MONO_MUSIC",e[e.FB_STEREO_MUSIC=128e3]="FB_STEREO_MUSIC"}(wi||(wi={}));var Si=new Map([[60,99e3],[240,199e3],[576,3e5],[920,64e4],[1296,72e4],[2304,88e4],[3600,25e5],[8160,4e6]]);function _i(e,t){return Object.keys(t).every((r=>{if("clockRate"===r||"name"===r)return e[r]===t[r];if("fmtParams"===r){var n=e[r],i=t[r],o=[...n.keys()].some((e=>"level-asymmetry-allowed"===e&&"1"===i.get(e)&&"1"===n.get(e)));return[...n.keys()].every((e=>i.get(e)&&"profile-level-id"===e?function(e,t,r){var n=Number.parseInt("0x".concat(e),16),i=Number.parseInt("0x".concat(t),16),o=n>>16,s=i>>16,a=(65280&n)>>8,c=(65280&i)>>8;return(o===s&&a===c||66===o&&66===s&&(64&a)==(64&c))&&(!!r||(255&n)<=(255&i))}(n.get(e),i.get(e),o):"packetization-mode"!==e||n.get(e)===i.get(e)))}return!0}))}function Ti(e,t){return 0===t?e:Ti(t,e%t)}function xi(e,t){var r=Ti(e[0],e[1]),n=e[0]/r,i=e[1]/r;return Math.floor(Math.sqrt(16*t*16/(n*i)))*i}function Ai(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}var Ii=mi&&mi.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},Ci=mi&&mi.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},Ri=void 0,ki=function(e){return JSON.parse(JSON.stringify(e))},Oi=function e(t,r){return t===r||!(!t||!r||"object"!=typeof t||"object"!=typeof r)&&(t.constructor===r.constructor&&(Object.keys(t).length===Object.keys(r).length&&Object.keys(t).reduce((function(n,i){return!!r[i]&&(!!e(t[i],r[i])&&n)}),!0)))},Ni=function(e){return{id:e.id,tracks:e.getTracks().map((function(e){return{id:e.id,kind:e.kind,label:e.label,enabled:e.enabled,muted:e.muted,readyState:e.readyState}}))}},Pi=["type","id","timestamp"],Li=function(e,t){var r=ki(t);Object.keys(r).forEach((function(t){var n=r[t];e[t]&&Object.keys(n).forEach((function(i){Oi(n[i],e[t][i])&&!Pi.includes(i)&&delete r[t][i],function(e){return!!Object.keys(e).filter((function(e){return!Pi.includes(e)})).length}(n)||delete r[t]}))}));var n=-1/0;return Object.keys(r).forEach((function(e){var t=r[e];t.timestamp>n&&(n=t.timestamp)})),Object.keys(r).forEach((function(e){var t=r[e];t.timestamp===n&&delete t.timestamp})),r.timestamp=n,r},Di=function(e){return[JSON.stringify({value:e,type:"string",id:""})]};Ri=function(e,t,r,n){void 0===n&&(n=function(){return Promise.resolve()});var i={},o=function(e,r,n){t({timestamp:n?Math.round(n):Date.now(),name:e,payload:r})},s=window.RTCPeerConnection;if(e.addEventListener("icecandidate",(function(e){e.candidate&&o("onicecandidate",Di(JSON.stringify(e.candidate)))})),e.addEventListener("icecandidateerror",(function(e){var t=e,r=t.errorCode,n=t.errorText;o("onicecandidateerror",Di("".concat(r,": ").concat(n)))})),e.addEventListener("track",(function(e){o("ontrack",Di("".concat(e.track.kind,":").concat(e.track.id," ").concat(e.streams.map((function(e){return"stream:".concat(e.id)})).join(" "))))})),e.addEventListener("signalingstatechange",(function(){o("onsignalingstatechange",Di(e.signalingState))})),e.addEventListener("iceconnectionstatechange",(function(){o("oniceconnectionstatechange",Di(e.iceConnectionState))})),e.addEventListener("icegatheringstatechange",(function(){o("onicegatheringstatechange",Di(e.iceGatheringState))})),e.addEventListener("connectionstatechange",(function(){o("onconnectionstatechange",Di(e.connectionState))})),e.addEventListener("negotiationneeded",(function(){o("onnegotiationneeded",Di("negotiationneeded"))})),e.addEventListener("datachannel",(function(e){o("ondatachannel",Di("".concat(e.channel.id,": ").concat(e.channel.label)))})),["createDataChannel","close"].forEach((function(e){var t=s.prototype[e];t&&(s.prototype[e]=function(){return o("on".concat(e),Di(e)),t.apply(this,arguments)})})),["addStream","removeStream"].forEach((function(e){var t=s.prototype[e];t&&(s.prototype[e]=function(){var r=arguments[0],n=r.getTracks().map((function(e){return"".concat(e.kind,":").concat(e.id)})).join(",");return o("on".concat(e),Di("".concat(r.id," ").concat(n))),t.apply(this,arguments)})})),["addTrack"].forEach((function(e){var t=s.prototype[e];t&&(s.prototype[e]=function(){var r=arguments[0],n=[].slice.call(arguments,1);return o("on".concat(e),Di("".concat(r.kind,":").concat(r.id," ").concat(n.map((function(e){return"stream:".concat(e.id)})).join(";")||"-"))),t.apply(this,arguments)})})),["removeTrack"].forEach((function(e){var t=s.prototype[e];t&&(s.prototype[e]=function(){var r=arguments[0].track;return o("on".concat(e),Di(r?"".concat(r.kind,":").concat(r.id):"null")),t.apply(this,arguments)})})),["createOffer","createAnswer"].forEach((function(e){var t=s.prototype[e];t&&(s.prototype[e]=function(){var r,n=arguments;return 1===arguments.length&&"object"==typeof arguments[0]?r=arguments[0]:3===arguments.length&&"object"==typeof arguments[2]&&(r=arguments[2]),o("on".concat(e),Di(r||"")),t.apply(this,r?[r]:void 0).then((function(t){if(o("on".concat(e,"OnSuccess"),Di(t.sdp)),!(n.length>0&&"function"==typeof n[0]))return t;n[0].apply(null,[t])}),(function(t){if(o("on".concat(e,"OnFailure"),Di(t.toString())),!(n.length>1&&"function"==typeof n[1]))throw t;n[1].apply(null,[t])}))})})),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(e){var t=s.prototype[e];t&&(s.prototype[e]=function(){var r=arguments;return o("on".concat(e),Di("addIceCandidate"===e?arguments[0]:arguments[0].sdp)),t.apply(this,[arguments[0]]).then((function(){o("on".concat(e,"OnSuccess"),Di("success")),r.length>=2&&"function"==typeof r[1]&&r[1].apply(null,[])}),(function(t){if(o("on".concat(e,"OnFailure"),Di(t.toString())),!(r.length>=3&&"function"==typeof r[2]))throw t;r[2].apply(null,[t])}))})})),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){var a=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(){return o("onnavigator.mediaDevices.getUserMedia",Di(JSON.stringify(arguments[0]))),a.apply(navigator.mediaDevices,arguments).then((function(e){return o("onnavigator.mediaDevices.getUserMediaOnSuccess",Di(JSON.stringify(Ni(e)))),e}),(function(e){return o("onnavigator.mediaDevices.getUserMediaOnFailure",Di(e.name)),Promise.reject(e)}))}.bind(navigator.mediaDevices)}if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia){var c=navigator.mediaDevices.getDisplayMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getDisplayMedia=function(){return o("onnavigator.mediaDevices.getDisplayMedia",Di(JSON.stringify(arguments[0]))),c.apply(navigator.mediaDevices,arguments).then((function(e){return o("onnavigator.mediaDevices.getDisplayMediaOnSuccess",Di(JSON.stringify(Ni(e)))),e}),(function(e){return o("onnavigator.mediaDevices.getDisplayMediaOnFailure",Di(e.name)),Promise.reject(e)}))}.bind(navigator.mediaDevices)}var u=function(){return Ii(void 0,void 0,void 0,(function(){return Ci(this,(function(t){return[2,e.getStats(null).then((function(e){var t=new Map;return e.forEach((function(e,r){return t.set(r,e)})),n(t).then((function(){var e,r=function(e){if(!e.size)return e;var t={};return e.forEach((function(e,r){t[r]=e})),t}(t),n=ki(r),s=Li(i,r);return o("stats-report",(e=s,Object.keys(e).filter((function(e){return"timestamp"!==e})).map((function(t){return JSON.stringify(e[t])}))),s.timestamp!==-1/0?s.timestamp:void 0),i=n,Promise.resolve()}))}))]}))}))},l=window.setInterval((function(){"closed"!==e.signalingState?u():window.clearInterval(l)}),r);return{forceStatsReport:function(){return Ii(void 0,void 0,void 0,(function(){return Ci(this,(function(e){return[2,u()]}))}))}}};var Mi,Ui,Bi,Fi,ji,Vi,Hi="\\d+",Gi="[!#$%&'*+\\-.^_`{|}~a-zA-Z0-9]+",qi="\\S+",$i=".+";class Zi{}class zi extends Zi{constructor(e,t){super(),this.bandwidthType=e,this.bandwidth=t}static fromSdpLine(e){if(zi.regex.test(e)){var t=e.match(zi.regex),r=t[1],n=parseInt(t[2],10);return new zi(r,n)}}toSdpLine(){return"b=".concat(this.bandwidthType,":").concat(this.bandwidth)}}Mi=zi,zi.BW_TYPE_REGEX="CT|AS|TIAS",zi.regex=new RegExp("^(".concat(Mi.BW_TYPE_REGEX,"):(").concat(Hi,")"));class Ki extends Zi{constructor(e){super(),this.mids=e}static fromSdpLine(e){if(Ki.regex.test(e)){var t=e.match(Ki.regex)[1].split(" ");return new Ki(t)}}toSdpLine(){return"a=group:BUNDLE ".concat(this.mids.join(" "))}}Ki.regex=new RegExp("^group:BUNDLE (".concat($i,")"));class Wi extends Zi{constructor(e,t,r,n,i,o,s,a,c,u){super(),this.foundation=e,this.componentId=t,this.transport=r,this.priority=n,this.connectionAddress=i,this.port=o,this.candidateType=s,this.relAddr=a,this.relPort=c,this.candidateExtensions=u}static fromSdpLine(e){if(Wi.regex.test(e)){var t=e.match(Wi.regex),r=t[1],n=parseInt(t[2],10),i=t[3],o=parseInt(t[4],10),s=t[5],a=parseInt(t[6],10),c=t[7],u=t[8],l=t[9]?parseInt(t[9],10):void 0,d=t[10];return new Wi(r,n,i,o,s,a,c,u,l,d)}}toSdpLine(){var e="";return e+="a=candidate:".concat(this.foundation," ").concat(this.componentId," ").concat(this.transport," ").concat(this.priority," ").concat(this.connectionAddress," ").concat(this.port," typ ").concat(this.candidateType),this.relAddr&&(e+=" raddr ".concat(this.relAddr)),this.relPort&&(e+=" rport ".concat(this.relPort)),this.candidateExtensions&&(e+=" ".concat(this.candidateExtensions)),e}}Ui=Wi,Wi.ICE_CHARS="[a-zA-Z0-9+/]+",Wi.regex=new RegExp("^candidate:(".concat(Ui.ICE_CHARS,") (").concat(Hi,") (").concat(qi,") (").concat(Hi,") (").concat(qi,") (").concat(Hi,") typ (").concat(qi,")(?: raddr (").concat(qi,"))?(?: rport (").concat(Hi,"))?(?: (").concat($i,"))?"));class Ji extends Zi{constructor(e,t,r){super(),this.netType=e,this.addrType=t,this.ipAddr=r}static fromSdpLine(e){if(Ji.regex.test(e)){var t=e.match(Ji.regex),r=t[1],n=t[2],i=t[3];return new Ji(r,n,i)}}toSdpLine(){return"c=".concat(this.netType," ").concat(this.addrType," ").concat(this.ipAddr)}}Ji.regex=new RegExp("^(".concat(qi,") (").concat(qi,") (").concat(qi,")"));class Yi extends Zi{constructor(e){super(),this.values=e}static fromSdpLine(e){if(Yi.regex.test(e)){var t=e.match(Yi.regex)[1].split(",");return new Yi(t)}}toSdpLine(){return"a=content:".concat(this.values.join(","))}}Yi.regex=new RegExp("^content:(".concat($i,")$"));class Qi extends Zi{constructor(e){super(),this.direction=e}static fromSdpLine(e){if(Qi.regex.test(e)){var t=e.match(Qi.regex)[1];return new Qi(t)}}toSdpLine(){return"a=".concat(this.direction)}}Qi.regex=/^(sendrecv|sendonly|recvonly|inactive)$/;class Xi extends Zi{constructor(e,t,r,n){super(),this.id=e,this.uri=t,this.direction=r,this.extensionAttributes=n}static fromSdpLine(e){if(Xi.regex.test(e)){var t=e.match(Xi.regex),r=parseInt(t[1],10),n=t[2],i=t[3],o=t[4];return new Xi(r,i,n,o)}}toSdpLine(){var e="";return e+="a=extmap:".concat(this.id),this.direction&&(e+="/".concat(this.direction)),e+=" ".concat(this.uri),this.extensionAttributes&&(e+=" ".concat(this.extensionAttributes)),e}}Bi=Xi,Xi.EXTMAP_DIRECTION="sendonly|recvonly|sendrecv|inactive",Xi.regex=new RegExp("^extmap:(".concat(Hi,")(?:/(").concat(Bi.EXTMAP_DIRECTION,"))? (").concat(qi,")(?: (").concat($i,"))?"));class eo extends Zi{constructor(e){super(),this.fingerprint=e}static fromSdpLine(e){if(eo.regex.test(e)){var t=e.match(eo.regex)[1];return new eo(t)}}toSdpLine(){return"a=fingerprint:".concat(this.fingerprint)}}eo.regex=new RegExp("^fingerprint:(".concat($i,")"));class to extends Zi{constructor(e,t){super(),this.payloadType=e,this.params=t}static fromSdpLine(e){if(to.regex.test(e)){var t=e.match(to.regex),r=parseInt(t[1],10),n=t[2];return new to(r,function(e){e=e.replace(/^a=fmtp:\d+\x20/,"");var t=new Map;return/^\d+([,/-]\d+)+$/.test(e)?(t.set(e,void 0),t):(e.split(";").forEach((r=>{var n=r&&r.split("=");if(2!==n.length||!n[0]||!n[1])throw new Error("Fmtp params is invalid with ".concat(e));t.set(n[0],n[1])})),t)}(n))}}toSdpLine(){var e=Array.from(this.params.keys()).map((e=>void 0!==this.params.get(e)?"".concat(e,"=").concat(this.params.get(e)):"".concat(e))).join(";");return"a=fmtp:".concat(this.payloadType," ").concat(e)}}to.regex=new RegExp("^fmtp:(".concat(Hi,") (").concat($i,")"));class ro extends Zi{constructor(e){super(),this.options=e}static fromSdpLine(e){if(ro.regex.test(e)){var t=e.match(ro.regex)[1].split(" ");return new ro(t)}}toSdpLine(){return"a=ice-options:".concat(this.options.join(" "))}}ro.regex=new RegExp("^ice-options:(".concat($i,")$"));class no extends Zi{constructor(e){super(),this.pwd=e}static fromSdpLine(e){if(no.regex.test(e)){var t=e.match(no.regex)[1];return new no(t)}}toSdpLine(){return"a=ice-pwd:".concat(this.pwd)}}no.regex=new RegExp("^ice-pwd:(".concat(qi,")$"));class io extends Zi{constructor(e){super(),this.ufrag=e}static fromSdpLine(e){if(io.regex.test(e)){var t=e.match(io.regex)[1];return new io(t)}}toSdpLine(){return"a=ice-ufrag:".concat(this.ufrag)}}io.regex=new RegExp("^ice-ufrag:(".concat(qi,")$"));class oo extends Zi{constructor(e){super(),this.maxMessageSize=e}static fromSdpLine(e){if(oo.regex.test(e)){var t=e.match(oo.regex),r=parseInt(t[1],10);return new oo(r)}}toSdpLine(){return"a=max-message-size:".concat(this.maxMessageSize)}}oo.regex=new RegExp("^max-message-size:(".concat(Hi,")"));class so extends Zi{constructor(e,t,r,n){super(),this.type=e,this.port=t,this.protocol=r,this.formats=n}static fromSdpLine(e){if(so.regex.test(e)){var t=e.match(so.regex),r=t[1],n=parseInt(t[2],10),i=t[3],o=t[4].split(" ");return new so(r,n,i,o)}}toSdpLine(){return"m=".concat(this.type," ").concat(this.port," ").concat(this.protocol," ").concat(this.formats.join(" "))}}Fi=so,so.MEDIA_TYPE="audio|video|application",so.regex=new RegExp("^(".concat(Fi.MEDIA_TYPE,") (").concat(Hi,") (").concat(qi,") (").concat($i,")"));class ao extends Zi{constructor(e){super(),this.mid=e}static fromSdpLine(e){if(ao.regex.test(e)){var t=e.match(ao.regex)[1];return new ao(t)}}toSdpLine(){return"a=mid:".concat(this.mid)}}ao.regex=new RegExp("^mid:(".concat(qi,")$"));class co extends Zi{constructor(e,t,r,n,i,o){super(),this.username=e,this.sessionId=t,this.sessionVersion=r,this.netType=n,this.addrType=i,this.ipAddr=o}static fromSdpLine(e){if(co.regex.test(e)){var t=e.match(co.regex),r=t[1],n=t[2],i=parseInt(t[3],10),o=t[4],s=t[5],a=t[6];return new co(r,n,i,o,s,a)}}toSdpLine(){return"o=".concat(this.username," ").concat(this.sessionId," ").concat(this.sessionVersion," ").concat(this.netType," ").concat(this.addrType," ").concat(this.ipAddr)}}co.regex=new RegExp("^(".concat(qi,") (").concat(qi,") (").concat(Hi,") (").concat(qi,") (").concat(qi,") (").concat(qi,")"));class uo extends Zi{constructor(e,t,r){super(),this.id=e,this.direction=t,this.params=r}static fromSdpLine(e){if(uo.regex.test(e)){var t=e.match(uo.regex),r=t[1],n=t[2],i=t[3];return new uo(r,n,i)}}toSdpLine(){var e="";return e+="a=rid:".concat(this.id," ").concat(this.direction),this.params&&(e+=" ".concat(this.params)),e}}ji=uo,uo.RID_ID="[\\w-]+",uo.RID_DIRECTION="\\bsend\\b|\\brecv\\b",uo.regex=new RegExp("^rid:(".concat(ji.RID_ID,") (").concat(ji.RID_DIRECTION,")(?:").concat("\\s","(").concat($i,"))?"));class lo extends Zi{static fromSdpLine(e){if(lo.regex.test(e))return new lo}toSdpLine(){return"a=rtcp-mux"}}lo.regex=/^rtcp-mux$/;class ho extends Zi{constructor(e,t){super(),this.payloadType=e,this.feedback=t}static fromSdpLine(e){if(ho.regex.test(e)){var t=e.match(ho.regex),r=parseInt(t[1],10),n=t[2];return new ho(r,n)}}toSdpLine(){return"a=rtcp-fb:".concat(this.payloadType," ").concat(this.feedback)}}ho.regex=new RegExp("^rtcp-fb:(".concat(Hi,") (").concat($i,")"));class fo extends Zi{constructor(e,t,r,n){super(),this.payloadType=e,this.encodingName=t,this.clockRate=r,this.encodingParams=n}static fromSdpLine(e){if(fo.regex.test(e)){var t=e.match(fo.regex),r=parseInt(t[1],10),n=t[2],i=parseInt(t[3],10),o=t[4];return new fo(r,n,i,o)}}toSdpLine(){var e="";return e+="a=rtpmap:".concat(this.payloadType," ").concat(this.encodingName,"/").concat(this.clockRate),this.encodingParams&&(e+="/".concat(this.encodingParams)),e}}Vi=fo,fo.NON_SLASH_TOKEN="[^\\s/]+",fo.regex=new RegExp("^rtpmap:(".concat(Hi,") (").concat(Vi.NON_SLASH_TOKEN,")/(").concat(Vi.NON_SLASH_TOKEN,")(?:/(").concat(Vi.NON_SLASH_TOKEN,"))?"));class po extends Zi{constructor(e){super(),this.port=e}static fromSdpLine(e){if(po.regex.test(e)){var t=e.match(po.regex),r=parseInt(t[1],10);return new po(r)}}toSdpLine(){return"a=sctp-port:".concat(this.port)}}po.regex=new RegExp("^sctp-port:(".concat(Hi,")"));class mo extends Zi{constructor(e){super(),this.info=e}static fromSdpLine(e){if(mo.regex.test(e)){var t=e.match(mo.regex)[1];return new mo(t)}}toSdpLine(){return"i=".concat(this.info)}}mo.regex=new RegExp("(".concat($i,")"));class go extends Zi{constructor(e){super(),this.name=e}static fromSdpLine(e){if(go.regex.test(e)){var t=e.match(go.regex)[1];return new go(t)}}toSdpLine(){return"s=".concat(this.name)}}go.regex=new RegExp("^(".concat($i,")"));class vo extends Zi{constructor(e){super(),this.setup=e}static fromSdpLine(e){if(vo.regex.test(e)){var t=e.match(vo.regex)[1];return new vo(t)}}toSdpLine(){return"a=setup:".concat(this.setup)}}vo.regex=/^setup:(actpass|active|passive)$/;class yo{constructor(e,t){this.id=e,this.paused=t}toString(){return this.paused?"~".concat(this.id):this.id}}class bo{constructor(){this.layers=[]}addLayer(e){this.layers.push([e])}addLayerWithAlternatives(e){this.layers.push(e)}get length(){return this.layers.length}get(e){return this.layers[e]}static fromString(e){var t=new bo,r=e.split(";");if(1===r.length&&!r[0].trim())throw new Error("simulcast stream list empty");return r.forEach((e=>{if(!e)throw new Error("simulcast layer list empty");var r=e.split(","),n=[];r.forEach((e=>{if(!e||"~"===e)throw new Error("rid empty");var t="~"===e[0],r=t?e.substring(1):e;n.push(new yo(r,t))})),t.addLayerWithAlternatives(n)})),t}toString(){return this.layers.map((e=>e.map((e=>e.toString())).join(","))).join(";")}}class Eo extends Zi{constructor(e,t){super(),this.sendLayers=e,this.recvLayers=t}static fromSdpLine(e){if(Eo.regex.test(e)){var t,r,n=e.match(Eo.regex),i=n[3]&&n[4],o=n[1],s=bo.fromString(n[2]),a=new bo;if(i){if(o===n[3])return;a=bo.fromString(n[4])}return"send"===o?(t=s,r=a):(t=a,r=s),new Eo(t,r)}}toSdpLine(){var e="a=simulcast:";return this.sendLayers.length&&(e+="send ".concat(this.sendLayers.toString()),this.recvLayers.length&&(e+=" ")),this.recvLayers.length&&(e+="recv ".concat(this.recvLayers.toString())),e}}Eo.regex=new RegExp("^simulcast:(send|recv) (".concat(qi,")(?: (send|recv) (").concat(qi,"))?"));class wo extends Zi{constructor(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;super(),this.ssrcId=e,this.attribute=t,this.attributeValue=r,this.attributeData=n}static fromSdpLine(e){if(wo.regex.test(e)){var t=e.match(wo.regex),r=parseInt(t[1],10),n=t[2],i=t[3],o=t[4];return new wo(r,n,i,o)}}toSdpLine(){var e="a=ssrc:".concat(this.ssrcId," ").concat(this.attribute);return this.attributeValue&&(e+=":".concat(this.attributeValue)),this.attributeData&&(e+=" ".concat(this.attributeData)),e}}wo.regex=new RegExp("^ssrc:(".concat(Hi,") (").concat(Gi,")(?::(").concat(Gi,")?(?: (").concat(qi,"))?)?$"));class So extends Zi{constructor(e,t){super(),this.semantics=e,this.ssrcs=t}static fromSdpLine(e){if(So.regex.test(e)){var t=e.match(So.regex),r=t[1],n=t[2].split(" ").map((e=>parseInt(e,10)));return new So(r,n)}}toSdpLine(){return"a=ssrc-group:".concat(this.semantics," ").concat(this.ssrcs.join(" "))}}So.regex=new RegExp("^ssrc-group:(SIM|FID|FEC) ((?:".concat(Hi).concat("\\s","*)+)"));class _o extends Zi{constructor(e,t){super(),this.startTime=e,this.stopTime=t}static fromSdpLine(e){if(_o.regex.test(e)){var t=e.match(_o.regex),r=parseInt(t[1],10),n=parseInt(t[2],10);return new _o(r,n)}}toSdpLine(){return"t=".concat(this.startTime," ").concat(this.stopTime)}}_o.regex=new RegExp("^(".concat(Hi,") (").concat(Hi,")"));class To extends Zi{constructor(e){super(),this.version=e}static fromSdpLine(e){if(To.regex.test(e)){var t=e.match(To.regex),r=parseInt(t[1],10);return new To(r)}}toSdpLine(){return"v=".concat(this.version)}}To.regex=new RegExp("^(".concat(Hi,")$"));class xo extends Zi{constructor(e){super(),this.value=e}static fromSdpLine(e){var t=e.match(xo.regex)[1];return new xo(t)}toSdpLine(){return"".concat(this.value)}}xo.regex=new RegExp("(".concat($i,")"));class Ao{constructor(){this.candidates=[]}addLine(e){return e instanceof io?(this.ufrag=e,!0):e instanceof no?(this.pwd=e,!0):e instanceof ro?(this.options=e,!0):e instanceof Wi&&(this.candidates.push(e),!0)}toLines(){var e=[];return this.ufrag&&e.push(this.ufrag),this.pwd&&e.push(this.pwd),this.options&&e.push(this.options),this.candidates.forEach((t=>e.push(t))),e}}class Io{constructor(e,t,r){this.iceInfo=new Ao,this.otherLines=[],this.type=e,this.port=t,this.protocol=r}findOtherLine(e){return this.otherLines.find((t=>t instanceof e))}addLine(e){if(e instanceof Ki)throw new Error("Error: bundle group line not allowed in media description");return e instanceof zi?(this.bandwidth=e,!0):e instanceof ao?(this.mid=e.mid,!0):e instanceof eo?(this.fingerprint=e.fingerprint,!0):e instanceof vo?(this.setup=e.setup,!0):e instanceof Ji?(this.connection=e,!0):e instanceof Yi?(this.content=e,!0):this.iceInfo.addLine(e)}}class Co extends Io{constructor(e){super(e.type,e.port,e.protocol),this.fmts=[],this.fmts=e.formats}toLines(){var e=[];return e.push(new so(this.type,this.port,this.protocol,this.fmts)),this.connection&&e.push(this.connection),this.bandwidth&&e.push(this.bandwidth),e.push(...this.iceInfo.toLines()),this.fingerprint&&e.push(new eo(this.fingerprint)),this.setup&&e.push(new vo(this.setup)),this.mid&&e.push(new ao(this.mid)),this.content&&e.push(this.content),this.sctpPort&&e.push(new po(this.sctpPort)),this.maxMessageSize&&e.push(new oo(this.maxMessageSize)),e.push(...this.otherLines),e}addLine(e){if(super.addLine(e))return!0;if(e instanceof so)throw new Error("Error: tried passing a MediaLine to an existing MediaInfo");return e instanceof po?(this.sctpPort=e.port,!0):e instanceof oo?(this.maxMessageSize=e.maxMessageSize,!0):(this.otherLines.push(e),!0)}}class Ro{constructor(e){this.fmtParams=new Map,this.feedback=[],this.pt=e}addLine(e){if(e instanceof fo)return this.name=e.encodingName,this.clockRate=e.clockRate,this.encodingParams=e.encodingParams,!0;if(e instanceof to){if(this.fmtParams=new Map([...Array.from(this.fmtParams.entries()),...Array.from(e.params.entries())]),e.params.has("apt")){var t=e.params.get("apt");this.primaryCodecPt=parseInt(t,10)}return!0}return e instanceof ho&&(this.feedback.push(e.feedback),!0)}toLines(){var e=[];return this.name&&this.clockRate&&e.push(new fo(this.pt,this.name,this.clockRate,this.encodingParams)),this.feedback.forEach((t=>{e.push(new ho(this.pt,t))})),this.fmtParams.size>0&&e.push(new to(this.pt,this.fmtParams)),e}}class ko extends Io{constructor(e){super(e.type,e.port,e.protocol),this.pts=[],this.extMaps=new Map,this.rids=[],this.codecs=new Map,this.rtcpMux=!1,this.ssrcs=[],this.ssrcGroups=[],this.pts=e.formats.map((e=>parseInt(e,10))),this.pts.forEach((e=>this.codecs.set(e,new Ro(e))))}toLines(){var e=[];return e.push(new so(this.type,this.port,this.protocol,this.pts.map((e=>"".concat(e))))),this.connection&&e.push(this.connection),this.bandwidth&&e.push(this.bandwidth),e.push(...this.iceInfo.toLines()),this.fingerprint&&e.push(new eo(this.fingerprint)),this.setup&&e.push(new vo(this.setup)),this.mid&&e.push(new ao(this.mid)),this.rtcpMux&&e.push(new lo),this.content&&e.push(this.content),this.extMaps.forEach((t=>e.push(t))),this.rids.forEach((t=>e.push(t))),this.simulcast&&e.push(this.simulcast),this.direction&&e.push(new Qi(this.direction)),this.codecs.forEach((t=>e.push(...t.toLines()))),e.push(...this.ssrcs),e.push(...this.ssrcGroups),e.push(...this.otherLines),e}addLine(e){if(super.addLine(e))return!0;if(e instanceof so)throw new Error("Error: tried passing a MediaLine to an existing MediaInfo");if(e instanceof Qi)return this.direction=e.direction,!0;if(e instanceof Xi){if(this.extMaps.has(e.id))throw new Error("Tried to extension with duplicate ID: an extension already exists with ID ".concat(e.id));return this.extMaps.set(e.id,e),!0}if(e instanceof uo)return this.rids.push(e),!0;if(e instanceof lo)return this.rtcpMux=!0,!0;if(e instanceof Eo)return this.simulcast=e,!0;if(e instanceof fo||e instanceof to||e instanceof ho){var t=this.codecs.get(e.payloadType);if(!t)throw new Error("Error: got line for unknown codec: ".concat(e.toSdpLine()));return t.addLine(e),!0}return e instanceof wo?(this.ssrcs.push(e),!0):e instanceof So?(this.ssrcGroups.push(e),!0):(this.otherLines.push(e),!0)}getCodecByPt(e){return this.codecs.get(e)}removePt(e){var t=[...this.codecs.values()].filter((t=>t.primaryCodecPt===e)).map((e=>e.pt)),r=[e,...t];r.forEach((e=>{this.codecs.delete(e)})),this.pts=this.pts.filter((e=>-1===r.indexOf(e)))}addExtension(e){var{uri:t,direction:r,attributes:n,id:i}=e,o=i||(()=>{for(var e=1;this.extMaps.has(e);)e+=1;return e})();if(this.extMaps.has(o))throw new Error("Extension with ID ".concat(i," already exists"));if(0===o)throw new Error("Extension ID 0 is reserved");this.extMaps.set(o,new Xi(o,t,r,n))}}class Oo{constructor(){this.groups=[],this.otherLines=[]}addLine(e){return e instanceof To?(this.version=e,!0):e instanceof co?(this.origin=e,!0):e instanceof go?(this.sessionName=e,!0):e instanceof mo?(this.information=e,!0):e instanceof _o?(this.timing=e,!0):e instanceof Ji?(this.connection=e,!0):e instanceof zi?(this.bandwidth=e,!0):e instanceof Ki?(this.groups.push(e),!0):(this.otherLines.push(e),!0)}toLines(){var e=[];return this.version&&e.push(this.version),this.origin&&e.push(this.origin),this.sessionName&&e.push(this.sessionName),this.information&&e.push(this.information),this.connection&&e.push(this.connection),this.bandwidth&&e.push(this.bandwidth),this.timing&&e.push(this.timing),this.groups&&e.push(...this.groups),e.push(...this.otherLines),e}}class No{constructor(){this.session=new Oo,this.media=[]}get avMedia(){return this.media.filter((e=>e instanceof ko))}toString(){var e=[];return e.push(...this.session.toLines()),this.media.forEach((t=>e.push(...t.toLines()))),"".concat(e.map((e=>e.toSdpLine())).join("\r\n"),"\r\n")}}class Po{constructor(){this.parsers=new Map}addParser(e,t){var r=this.parsers.get(e)||[];r.push(t),this.parsers.set(e,r)}getParsers(e){return this.parsers.get(e)||[]}}var Lo=new class extends Po{constructor(){super(),this.addParser("v",To.fromSdpLine),this.addParser("o",co.fromSdpLine),this.addParser("c",Ji.fromSdpLine),this.addParser("i",mo.fromSdpLine),this.addParser("m",so.fromSdpLine),this.addParser("s",go.fromSdpLine),this.addParser("t",_o.fromSdpLine),this.addParser("b",zi.fromSdpLine),this.addParser("a",fo.fromSdpLine),this.addParser("a",ho.fromSdpLine),this.addParser("a",to.fromSdpLine),this.addParser("a",Qi.fromSdpLine),this.addParser("a",Xi.fromSdpLine),this.addParser("a",ao.fromSdpLine),this.addParser("a",io.fromSdpLine),this.addParser("a",no.fromSdpLine),this.addParser("a",ro.fromSdpLine),this.addParser("a",eo.fromSdpLine),this.addParser("a",vo.fromSdpLine),this.addParser("a",po.fromSdpLine),this.addParser("a",oo.fromSdpLine),this.addParser("a",lo.fromSdpLine),this.addParser("a",Ki.fromSdpLine),this.addParser("a",Yi.fromSdpLine),this.addParser("a",uo.fromSdpLine),this.addParser("a",Wi.fromSdpLine),this.addParser("a",Eo.fromSdpLine),this.addParser("a",wo.fromSdpLine),this.addParser("a",So.fromSdpLine)}};function Do(e){return e.length>2}function Mo(e){var t=function(e,t){var r=[];return e.split(/(\r\n|\r|\n)/).filter(Do).forEach((e=>{var n=e[0],i=e.slice(2),o=t.getParsers(n);for(var s of o){var a=s(i);if(a)return void r.push(a)}var c=xo.fromSdpLine(e);r.push(c)})),r}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:Lo),r=function(e){var t=new No,r=t.session;return e.forEach((e=>{if(e instanceof so){var n;if("audio"===e.type||"video"===e.type)n=new ko(e);else{if("application"!==e.type)throw new Error("Unhandled media type: ".concat(e.type));n=new Co(e)}t.media.push(n),r=n}else r.addLine(e)})),t}(t);return r}function Uo(e){!function(e,t){(e instanceof No?e.avMedia:[e]).forEach((e=>{e.codecs.forEach((e=>{e.feedback=e.feedback.filter((e=>e!==t))}))}))}(e,"transport-cc")}function Bo(e,t){var r=e instanceof No?e.avMedia:[e],n=t.map((e=>e.toLowerCase()));r.map((e=>[...e.codecs.values()].map((e=>e.name)))).flat().filter((e=>!n.includes(e.toLowerCase()))).forEach((t=>function(e,t){(e instanceof No?e.avMedia:[e]).forEach((e=>{var r=[...e.codecs.entries()].filter((e=>{var r,[,n]=e;return(null===(r=n.name)||void 0===r?void 0:r.toLowerCase())===t.toLowerCase()}));r.forEach((t=>{var[r]=t;return e.removePt(r)}))}))}(e,t)))}function Fo(e,t){var r=e instanceof No?e.media:[e],n=!1;return r.forEach((e=>{e.iceInfo.candidates=e.iceInfo.candidates.filter((e=>!!t.includes(e.transport.toLowerCase())||(n=!0,!1)))})),n}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==xe||"undefined"!=typeof self&&self;function jo(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Vo={exports:{}};!function(e,t){e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=90)}({17:function(e,t,r){t.__esModule=!0,t.default=void 0;var n=r(18),i=function(){function e(){}return e.getFirstMatch=function(e,t){var r=t.match(e);return r&&r.length>0&&r[1]||""},e.getSecondMatch=function(e,t){var r=t.match(e);return r&&r.length>1&&r[2]||""},e.matchAndReturnConst=function(e,t,r){if(e.test(t))return r},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,r,n){void 0===n&&(n=!1);var i=e.getVersionPrecision(t),o=e.getVersionPrecision(r),s=Math.max(i,o),a=0,c=e.map([t,r],(function(t){var r=s-e.getVersionPrecision(t),n=t+new Array(r+1).join(".0");return e.map(n.split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));for(n&&(a=s-Math.min(i,o)),s-=1;s>=a;){if(c[0][s]>c[1][s])return 1;if(c[0][s]===c[1][s]){if(s===a)return 0;s-=1}else if(c[0][s]<c[1][s])return-1}},e.map=function(e,t){var r,n=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(r=0;r<e.length;r+=1)n.push(t(e[r]));return n},e.find=function(e,t){var r,n;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(r=0,n=e.length;r<n;r+=1){var i=e[r];if(t(i,r))return i}},e.assign=function(e){for(var t,r,n=e,i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];if(Object.assign)return Object.assign.apply(Object,[e].concat(o));var a=function(){var e=o[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach((function(t){n[t]=e[t]}))};for(t=0,r=o.length;t<r;t+=1)a();return e},e.getBrowserAlias=function(e){return n.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return n.BROWSER_MAP[e]||""},e}();t.default=i,e.exports=t.default},18:function(e,t,r){t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,r){t.__esModule=!0,t.default=void 0;var n,i=(n=r(91))&&n.__esModule?n:{default:n},o=r(18);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(){}var t,r,n;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new i.default(e,t)},e.parse=function(e){return new i.default(e).getResult()},t=e,n=[{key:"BROWSER_MAP",get:function(){return o.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return o.ENGINE_MAP}},{key:"OS_MAP",get:function(){return o.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return o.PLATFORMS_MAP}}],(r=null)&&s(t.prototype,r),n&&s(t,n),e}();t.default=a,e.exports=t.default},91:function(e,t,r){t.__esModule=!0,t.default=void 0;var n=c(r(92)),i=c(r(93)),o=c(r(94)),s=c(r(95)),a=c(r(17));function c(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=a.default.find(n.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=a.default.find(i.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=a.default.find(o.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=a.default.find(s.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return a.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,r={},n=0,i={},o=0;if(Object.keys(e).forEach((function(t){var s=e[t];"string"==typeof s?(i[t]=s,o+=1):"object"==typeof s&&(r[t]=s,n+=1)})),n>0){var s=Object.keys(r),c=a.default.find(s,(function(e){return t.isOS(e)}));if(c){var u=this.satisfies(r[c]);if(void 0!==u)return u}var l=a.default.find(s,(function(e){return t.isPlatform(e)}));if(l){var d=this.satisfies(r[l]);if(void 0!==d)return d}}if(o>0){var h=Object.keys(i),f=a.default.find(h,(function(e){return t.isBrowser(e,!0)}));if(void 0!==f)return this.compareVersion(i[f])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var r=this.getBrowserName().toLowerCase(),n=e.toLowerCase(),i=a.default.getBrowserTypeByAlias(n);return t&&i&&(n=i.toLowerCase()),n===r},t.compareVersion=function(e){var t=[0],r=e,n=!1,i=this.getBrowserVersion();if("string"==typeof i)return">"===e[0]||"<"===e[0]?(r=e.substr(1),"="===e[1]?(n=!0,r=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?r=e.substr(1):"~"===e[0]&&(n=!0,r=e.substr(1)),t.indexOf(a.default.compareVersions(i,r,n))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=u,e.exports=t.default},92:function(e,t,r){t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=/version\/(\d+(\.?_?\d+)+)/i,s=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},r=i.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},r=i.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},r=i.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},r=i.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},r=i.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},r=i.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},r=i.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},r=i.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},r=i.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},r=i.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},r=i.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},r=i.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},r=i.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},r=i.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},r=i.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return r&&(t.version=r),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},r=i.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},r=i.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},r=i.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},r=i.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},r=i.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},r=i.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},r=i.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},r=i.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},r=i.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},r=i.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},r=i.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},r=i.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t={name:"Android Browser"},r=i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},r=i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},r=i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:i.default.getFirstMatch(t,e),version:i.default.getSecondMatch(t,e)}}}];t.default=s,e.exports=t.default},93:function(e,t,r){t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=r(18),s=[{test:[/Roku\/DVP/],describe:function(e){var t=i.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:o.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=i.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=i.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),r=i.default.getWindowsVersionName(t);return{name:o.OS_MAP.Windows,version:t,versionName:r}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:o.OS_MAP.iOS},r=i.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return r&&(t.version=r),t}},{test:[/macintosh/i],describe:function(e){var t=i.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),r=i.default.getMacOSVersionName(t),n={name:o.OS_MAP.MacOS,version:t};return r&&(n.versionName=r),n}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=i.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:o.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t=i.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),r=i.default.getAndroidVersionName(t),n={name:o.OS_MAP.Android,version:t};return r&&(n.versionName=r),n}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=i.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),r={name:o.OS_MAP.WebOS};return t&&t.length&&(r.version=t),r}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=i.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||i.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||i.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:o.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=i.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=i.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:o.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:o.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=i.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.PlayStation4,version:t}}}];t.default=s,e.exports=t.default},94:function(e,t,r){t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=r(18),s=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=i.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",r={type:o.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(r.model=t),r}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),r=e.test(/like (ipod|iphone)/i);return t&&!r},describe:function(e){var t=i.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:o.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}}];t.default=s,e.exports=t.default},95:function(e,t,r){t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=r(18),s=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:o.ENGINE_MAP.Blink};var t=i.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:o.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:o.ENGINE_MAP.Trident},r=i.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:o.ENGINE_MAP.Presto},r=i.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){var t=e.test(/gecko/i),r=e.test(/like gecko/i);return t&&!r},describe:function(e){var t={name:o.ENGINE_MAP.Gecko},r=i.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:o.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:o.ENGINE_MAP.WebKit},r=i.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}}];t.default=s,e.exports=t.default}})}(Vo);var Ho,Go,qo=jo(Vo.exports);!function(e){e.CHROME="Chrome",e.FIREFOX="Firefox",e.EDGE="Microsoft Edge",e.SAFARI="Safari"}(Ho||(Ho={}));class $o{static getBrowserDetails(){return this.browser.getBrowser()}static getOSDetails(){return this.browser.getOS()}static getPlatformDetails(){return this.browser.getPlatform()}static getEngineDetails(){return this.browser.getEngine()}static isChrome(){return this.browser.getBrowserName()===Ho.CHROME}static isFirefox(){return this.browser.getBrowserName()===Ho.FIREFOX}static isEdge(){return this.browser.getBrowserName()===Ho.EDGE}static isSafari(){return this.browser.getBrowserName()===Ho.SAFARI}static isVersionGreaterThan(e){var t={[this.browser.getBrowserName()]:">".concat(e)};return this.browser.satisfies(t)}static isVersionGreaterThanOrEqualTo(e){var t={[this.browser.getBrowserName()]:">=".concat(e)};return this.browser.satisfies(t)}static isVersionLessThan(e){var t={[this.browser.getBrowserName()]:"<".concat(e)};return this.browser.satisfies(t)}static isVersionLessThanOrEqualTo(e){var t={[this.browser.getBrowserName()]:"<=".concat(e)};return this.browser.satisfies(t)}static isSubVersionOf(e){var t={[this.browser.getBrowserName()]:"~".concat(e)};return this.browser.satisfies(t)}}$o.browser=qo.getParser(window.navigator.userAgent),function(e){e.NOT_CAPABLE="not capable",e.CAPABLE="capable",e.UNKNOWN="unknown"}(Go||(Go={}));var Zo={0:"240",1:"2304",2:"8160"};class zo extends Zi{constructor(e){super(),this.versions=e}static fromSdpLine(e){if(zo.regex.test(e)){var t=e.match(zo.regex)[1].split(",").filter((e=>e.length));return new zo(t)}}toSdpLine(){return"a=jmp:".concat(this.versions.join(","))}}zo.regex=/^jmp:((?:v\d+,?)+)/;class Ko extends Zi{constructor(e){super(),this.streamIdMode=e}static fromSdpLine(e){if(Ko.regex.test(e)){var t=e.match(Ko.regex)[1];return new Ko(t)}}toSdpLine(){return"a=jmp-stream-id-mode:".concat(this.streamIdMode)}}Ko.regex=/^jmp-stream-id-mode:(MID-RID|SSRC)$/;class Wo extends Zi{constructor(e,t){super(),this.source=e,this.csi=t}static fromSdpLine(e){if(Wo.regex.test(e)){var t=e.match(Wo.regex),r=t[1],n=t[2];return new Wo(r,n)}}toSdpLine(){var e="a=jmp-source:".concat(this.source);return this.csi&&(e+=" csi=".concat(this.csi)),e}}function Jo(e){return Array.isArray(e)?e.map((e=>Jo(e))):e instanceof Map?new Map(e):e instanceof Date?new Date(e.getTime()):e&&"object"==typeof e?Object.getOwnPropertyNames(e).reduce(((t,r)=>(Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r)),t[r]=Jo(e[r]),t)),Object.create(Object.getPrototypeOf(e))):e}function Yo(e,t){t.session.groups=e.session.groups,t.media=e.media.map((e=>{e.mid||Ei(Hn.OFFER_ANSWER_MISMATCH,"Named media groups can only be set for audio.");var r=t.media.find((t=>t.mid===e.mid));if(r)return r;e instanceof ko||Ei(Hn.OFFER_ANSWER_MISMATCH,"Answer is missing a non-AV media description for MID ".concat(e.mid,"."));var n=t.avMedia.find((t=>t.type===e.type));n||Ei(Hn.OFFER_ANSWER_MISMATCH,"Answer has no media description of type ".concat(e.type,", can't generate synthetic answer media description for MID ").concat(e.mid,"."));var i=Jo(n);return i.mid=e.mid,i.simulcast=void 0,"sendrecv"!==e.direction&&"sendonly"!==e.direction||(i.direction="recvonly"),"recvonly"===e.direction&&(i.direction="sendonly"),i}))}function Qo(e,t,r){if("max-compat"===t){var n=r.get(Pn.AudioMain),i=r.get(Pn.VideoMain),o=r.get(Pn.AudioSlides),s=r.get(Pn.VideoSlides);e.session.groups.splice(0,e.session.groups.length),n&&e.session.groups.push(new Ki(n)),i&&e.session.groups.push(new Ki(i)),o&&e.session.groups.push(new Ki(o)),s&&e.session.groups.push(new Ki(s))}}function Xo(e){0===e.iceInfo.candidates.length&&(e.addLine(new Wi("dummy1",1,"udp",3,"0.0.0.0",9,"host")),e.addLine(new Wi("dummy2",1,"tcp",2,"0.0.0.0",9,"host")),e.addLine(new Wi("dummy3",1,"udp",1,"0.0.0.0",9,"relay")))}function es(e){e.extMaps.forEach(((e,t,r)=>{/^urn:ietf:params:rtp-hdrext:sdes:(?:mid|rtp-stream-id|repaired-rtp-stream-id)$/.test(e.uri)&&r.delete(t)}))}function ts(){return Math.floor(4294967295*Math.random())+1}Wo.regex=new RegExp("^jmp-source:(".concat(qi,") (?:csi=(").concat(qi,"))")),Lo.addParser("a",zo.fromSdpLine),Lo.addParser("a",Wo.fromSdpLine),Lo.addParser("a",Ko.fromSdpLine);class rs{constructor(){this.streamIds=[],this.customCodecParameters=new Map}reset(){this.streamIds=[]}mungeLocalDescription(e,t,r,n){var i;Bo(e,["h264","opus","rtx"]),0===e.codecs.size&&Ei(Hn.SDP_MUNGE_MISSING_CODECS,"No codecs present in m-line with MID ".concat(e.mid," after filtering.")),e.bandwidth=new zi("TIAS",2e7),e.rids=[],e.simulcast=void 0,es(e),t&&function(e){var t="http://www.webrtc.org/experiments/rtp-hdrext/video-layers-allocation00";[...e.extMaps.values()].some((e=>e.uri===t))||e.addExtension({uri:t})}(e);var o=t?3:1;if(!this.streamIds.length)if(e.ssrcs.length){var s=[...new Set(e.ssrcs.map((e=>e.ssrcId)))];e.ssrcGroups.forEach((e=>{e.ssrcs.every((e=>s.includes(e)))||Ei(Hn.SDP_MUNGE_FAILED,"SSRC present in SSRC groups is missing from SSRC lines.")}));var a=e.ssrcGroups.filter((e=>"FID"===e.semantics));a.length&&a.length!==o&&Ei(Hn.SDP_MUNGE_FAILED,"Expected ".concat(o," RTX SSRC groups, got ").concat(a.length,".")),a.forEach((e=>{this.streamIds.push({ssrc:e.ssrcs[0],rtxSsrc:e.ssrcs[1]})}));var c=null===(i=e.ssrcGroups.find((e=>"SIM"===e.semantics)))||void 0===i?void 0:i.ssrcs;c?(c.length===o&&this.streamIds.every((e=>c.includes(e.ssrc)))||Ei(Hn.SDP_MUNGE_FAILED,"SSRCs in simulcast SSRC group do not match primary SSRCs in RTX SSRC groups."),this.streamIds.sort(((e,t)=>c.indexOf(e.ssrc)-c.indexOf(t.ssrc)))):a.length>1&&Ei(Hn.SDP_MUNGE_FAILED,"Multiple RTX SSRC groups but no simulcast SSRC group found."),this.streamIds.length||this.streamIds.push({ssrc:s[0]})}else[...Array(o).keys()].forEach((()=>{var e={ssrc:ts()};r&&(e.rtxSsrc=ts()),this.streamIds.push(e)}));e.ssrcs=[],e.ssrcGroups=[],this.streamIds.forEach((t=>{var n=t.ssrc;if(e.addLine(new wo(n,"cname","".concat(n,"-cname"))),e.addLine(new wo(n,"msid","-","1")),r){var i=t.rtxSsrc;e.addLine(new wo(i,"cname","".concat(n,"-cname"))),e.addLine(new wo(i,"msid","-","1")),e.addLine(new So("FID",[n,i]))}})),t&&e.addLine(new So("SIM",this.streamIds.map((e=>e.ssrc)))),function(e,t){t.forEach(((t,r)=>{[...e.codecs.values()].filter((e=>"H264"===e.name||"opus"===e.name)).forEach((e=>{null===t?e.fmtParams.delete(r):e.fmtParams.set(r,"".concat(t))}))}))}(e,this.customCodecParameters),n&&Uo(e)}mungeLocalDescriptionForRemoteServer(e,t,r){if(function(e,t){t===On.Slides&&e.addLine(new Yi(["slides"]))}(e,t),function(e,t,r){e.otherLines.find((e=>e instanceof zo))||e.addLine(new zo(["v1"])),e.otherLines.find((e=>e instanceof Wo))||e.addLine(new Wo(e.mid,t.toString())),e.otherLines.find((e=>e instanceof Ko))||e.addLine(new Ko(r))}(e,r,"SSRC"),Xo(e),"video"===e.type){var n=e.ssrcGroups.find((e=>"SIM"===e.semantics));n&&n.ssrcs.forEach(((t,r)=>{e.addLine(new wo(t,"fmtp","* max-fs=".concat(Zo[r])))}))}}mungeRemoteDescription(e){Fo(e,["udp","tcp"])&&bi.log("Some unsupported remote candidates have been removed from mid ".concat(e.mid)),[...e.codecs.values()].forEach((e=>{e.fmtParams.set("x-google-start-bitrate","60000")}))}getSenderIds(){return this.streamIds}getEncodingIndexForStreamId(e){return this.streamIds.findIndex((t=>Xn(t,e)))}setCodecParameters(e){Object.entries(e).forEach((e=>{var[t,r]=e;this.customCodecParameters.set(t,r)}))}deleteCodecParameters(e){e.forEach((e=>{this.customCodecParameters.set(e,null)}))}}var ns,is={exports:{}},os="object"==typeof Reflect?Reflect:null,ss=os&&"function"==typeof os.apply?os.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};ns=os&&"function"==typeof os.ownKeys?os.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var as=Number.isNaN||function(e){return e!=e};function cs(){cs.init.call(this)}is.exports=cs,is.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}Es(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&Es(e,"error",t,r)}(e,i,{once:!0})}))},cs.EventEmitter=cs,cs.prototype._events=void 0,cs.prototype._eventsCount=0,cs.prototype._maxListeners=void 0;var us,ls,ds=10;function hs(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function fs(e){return void 0===e._maxListeners?cs.defaultMaxListeners:e._maxListeners}function ps(e,t,r,n){var i,o,s,a;if(hs(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]),void 0===s)s=o[t]=r,++e._eventsCount;else if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=fs(e))>0&&s.length>i&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,a=c,console&&console.warn&&console.warn(a)}return e}function ms(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function gs(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=ms.bind(n);return i.listener=r,n.wrapFn=i,i}function vs(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):bs(i,i.length)}function ys(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function bs(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function Es(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}Object.defineProperty(cs,"defaultMaxListeners",{enumerable:!0,get:function(){return ds},set:function(e){if("number"!=typeof e||e<0||as(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");ds=e}}),cs.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},cs.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||as(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},cs.prototype.getMaxListeners=function(){return fs(this)},cs.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var a=i[e];if(void 0===a)return!1;if("function"==typeof a)ss(a,this,t);else{var c=a.length,u=bs(a,c);for(r=0;r<c;++r)ss(u[r],this,t)}return!0},cs.prototype.addListener=function(e,t){return ps(this,e,t,!1)},cs.prototype.on=cs.prototype.addListener,cs.prototype.prependListener=function(e,t){return ps(this,e,t,!0)},cs.prototype.once=function(e,t){return hs(t),this.on(e,gs(this,e,t)),this},cs.prototype.prependOnceListener=function(e,t){return hs(t),this.prependListener(e,gs(this,e,t)),this},cs.prototype.removeListener=function(e,t){var r,n,i,o,s;if(hs(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},cs.prototype.off=cs.prototype.removeListener,cs.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},cs.prototype.listeners=function(e){return vs(this,e,!0)},cs.prototype.rawListeners=function(e){return vs(this,e,!1)},cs.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):ys.call(e,t)},cs.prototype.listenerCount=ys,cs.prototype.eventNames=function(){return this._eventsCount>0?ns(this._events):[]};class ws extends is.exports.EventEmitter{}class Ss{constructor(){this.ssrc=ts()}getReceiverId(){return Object.assign({ssrc:this.ssrc},this.rtxSsrc?{rtxSsrc:this.rtxSsrc}:{})}mungeLocalDescription(e,t){Bo(e,["h264","opus","rtx"]),0===e.codecs.size&&Ei(Hn.SDP_MUNGE_MISSING_CODECS,"No codecs present in m-line with MID ".concat(e.mid," after filtering.")),e.bandwidth=new zi("TIAS",2e7),es(e),t&&Uo(e)}mungeRemoteDescription(e){var t;e.ssrcs.length||(e.addLine(new wo(this.ssrc,"cname","".concat(this.ssrc,"-cname"))),e.addLine(new wo(this.ssrc,"msid","-","1")),t="rtx",[...e.codecs.values()].some((e=>{var r;return(null===(r=e.name)||void 0===r?void 0:r.toLowerCase())===t.toLowerCase()}))&&(this.rtxSsrc||(this.rtxSsrc=ts()),e.addLine(new wo(this.rtxSsrc,"cname","".concat(this.ssrc,"-cname"))),e.addLine(new wo(this.rtxSsrc,"msid","-","1")),e.addLine(new So("FID",[this.ssrc,this.rtxSsrc])))),Fo(e,["udp","tcp"])&&bi.log("Some unsupported remote candidates have been removed from mid ".concat(e.mid)),[...e.codecs.values()].forEach((e=>{e.fmtParams.set("x-google-start-bitrate","60000")}))}reset(){this.ssrc=ts()}}class _s{constructor(){this.currentMid=0,this.midMap=new Map}getNextMid(e){var t=this.currentMid++,r=this.midMap.get(e)||[];return r.push("".concat(t)),this.midMap.set(e,r),"".concat(t)}allocateMidForDatachannel(){this.currentMid+=1}reset(){this.midMap=new Map,this.currentMid=0}getMidMap(){return this.midMap}}!function(e){e[e.NOT_OVERUSED=0]="NOT_OVERUSED",e[e.OVERUSED=1]="OVERUSED"}(us||(us={}));class Ts{constructor(e){this.monitors=[],this.lastOverallOveruseState=us.NOT_OVERUSED,this.isRunning=!1,this.overuseUpdateCallback=e}addMonitor(e){this.monitors.push(e),this.isRunning&&e.startMonitoring((()=>this.onMonitorOveruseUpdate()))}start(){this.isRunning=!0,this.monitors.forEach((e=>e.startMonitoring((()=>this.onMonitorOveruseUpdate()))))}stop(){this.isRunning=!1,this.monitors.forEach((e=>e.stopMonitoring()))}onMonitorOveruseUpdate(){var e=this.monitors.map((e=>e.getLastOveruseState())).some((e=>e===us.OVERUSED))?us.OVERUSED:us.NOT_OVERUSED;e!==this.lastOverallOveruseState&&(this.lastOverallOveruseState=e,this.overuseUpdateCallback(e))}}!function(e){e.MediaStarted="media-started",e.MediaStopped="media-stopped",e.MediaEnded="media-ended",e.SourceUpdate="source-update"}(ls||(ls={}));class xs extends ws{constructor(e,t){super(),this._idGetter=e,this.handleStreamMuteStateChange=this.handleStreamMuteStateChange.bind(this),this.handleStreamEnded=this.handleStreamEnded.bind(this),this._stream=new Kt(new MediaStream([t])),this._sourceState="no source",this._stream.on(St.MuteStateChange,this.handleStreamMuteStateChange),this._stream.on(St.Ended,this.handleStreamEnded)}handleStreamMuteStateChange(e){e?this.emit(ls.MediaStopped):this.emit(ls.MediaStarted)}handleStreamEnded(){this.emit(ls.MediaEnded)}_replaceTrack(e){this._stream.replaceTrack(e)}_updateSource(e,t){e===this._sourceState&&t===this._currentRxCsi||(this._sourceState=e,this._currentRxCsi=t,this.emit(ls.SourceUpdate,e,t))}close(){this._stream.off(St.MuteStateChange,this.handleStreamMuteStateChange),this._stream.off(St.Ended,this.handleStreamEnded)}get id(){return this._idGetter()}get stream(){return this._stream.outputStream}get currentRxCsi(){return this._currentRxCsi}}xs.Events=ls;class As{constructor(e,t){this.twccDisabled=!1,this._rtcRtpTransceiver=e,this.mid=t}replaceTransceiver(e){this._rtcRtpTransceiver=e}get receiver(){return this._rtcRtpTransceiver.receiver}get sender(){return this._rtcRtpTransceiver.sender}close(){this._rtcRtpTransceiver.stop()}}class Is extends As{constructor(e,t,r){super(e,t),this.munger=r,this._receiveSlot=new xs((()=>this._rtcRtpTransceiver.mid?this.munger.getReceiverId():null),this._rtcRtpTransceiver.receiver.track)}replaceTransceiver(e){super.replaceTransceiver(e),this._receiveSlot._replaceTrack(e.receiver.track)}close(){super.close(),this._receiveSlot.close()}get receiveSlot(){return this._receiveSlot}getStats(){return this.receiver.getStats()}mungeLocalDescription(e){this.munger.mungeLocalDescription(e,this.twccDisabled)}mungeRemoteDescription(e){this.munger.mungeRemoteDescription(e)}get receiverId(){return this.munger.getReceiverId()}resetSdpMunger(){this.munger.reset()}}Is.rid="1";var Cs,Rs={exports:{}},ks="object"==typeof Reflect?Reflect:null,Os=ks&&"function"==typeof ks.apply?ks.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};Cs=ks&&"function"==typeof ks.ownKeys?ks.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var Ns=Number.isNaN||function(e){return e!=e};function Ps(){Ps.init.call(this)}Rs.exports=Ps,Rs.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}Gs(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&Gs(e,"error",t,r)}(e,i,{once:!0})}))},Ps.EventEmitter=Ps,Ps.prototype._events=void 0,Ps.prototype._eventsCount=0,Ps.prototype._maxListeners=void 0;var Ls=10;function Ds(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function Ms(e){return void 0===e._maxListeners?Ps.defaultMaxListeners:e._maxListeners}function Us(e,t,r,n){var i,o,s,a;if(Ds(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]),void 0===s)s=o[t]=r,++e._eventsCount;else if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=Ms(e))>0&&s.length>i&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,a=c,console&&console.warn&&console.warn(a)}return e}function Bs(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Fs(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=Bs.bind(n);return i.listener=r,n.wrapFn=i,i}function js(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):Hs(i,i.length)}function Vs(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function Hs(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function Gs(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}Object.defineProperty(Ps,"defaultMaxListeners",{enumerable:!0,get:function(){return Ls},set:function(e){if("number"!=typeof e||e<0||Ns(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Ls=e}}),Ps.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Ps.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||Ns(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},Ps.prototype.getMaxListeners=function(){return Ms(this)},Ps.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var a=i[e];if(void 0===a)return!1;if("function"==typeof a)Os(a,this,t);else{var c=a.length,u=Hs(a,c);for(r=0;r<c;++r)Os(u[r],this,t)}return!0},Ps.prototype.addListener=function(e,t){return Us(this,e,t,!1)},Ps.prototype.on=Ps.prototype.addListener,Ps.prototype.prependListener=function(e,t){return Us(this,e,t,!0)},Ps.prototype.once=function(e,t){return Ds(t),this.on(e,Fs(this,e,t)),this},Ps.prototype.prependOnceListener=function(e,t){return Ds(t),this.prependListener(e,Fs(this,e,t)),this},Ps.prototype.removeListener=function(e,t){var r,n,i,o,s;if(Ds(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},Ps.prototype.off=Ps.prototype.removeListener,Ps.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},Ps.prototype.listeners=function(e){return js(this,e,!0)},Ps.prototype.rawListeners=function(e){return js(this,e,!1)},Ps.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):Vs.call(e,t)},Ps.prototype.listenerCount=Vs,Ps.prototype.eventNames=function(){return this._eventsCount>0?Cs(this._events):[]};class qs extends Rs.exports.EventEmitter{}class $s{constructor(){this.emitter=new qs}on(e){this.emitter.on("event",e)}once(e){this.emitter.once("event",e)}off(e){this.emitter.off("event",e)}emit(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.emitter.emit("event",...t)}}var Zs="function"==typeof queueMicrotask&&queueMicrotask,zs="function"==typeof setImmediate&&setImmediate,Ks="object"==typeof We&&"function"==typeof We.nextTick;var Ws=function(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return e((()=>t(...n)))}}(Zs?queueMicrotask:zs?setImmediate:Ks?We.nextTick:function(e){setTimeout(e,0)});function Js(e){return Xs(e)?function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r.pop();return Ys(e.apply(this,r),i)}:(t=function(t,r){var n;try{n=e.apply(this,t)}catch(e){return r(e)}if(n&&"function"==typeof n.then)return Ys(n,r);r(null,n)},function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=r.pop();return t.call(this,r,i)});var t}function Ys(e,t){return e.then((e=>{Qs(t,null,e)}),(e=>{Qs(t,e&&e.message?e:new Error(e))}))}function Qs(e,t,r){try{e(t,r)}catch(e){Ws((e=>{throw e}),e)}}function Xs(e){return"AsyncFunction"===e[Symbol.toStringTag]}function ea(e){if("function"!=typeof e)throw new Error("expected a function");return Xs(e)?Js(e):e}function ta(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;if(!t)throw new Error("arity is undefined");return function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return"function"==typeof n[t-1]?e.apply(this,n):new Promise(((r,i)=>{n[t-1]=function(e){if(e)return i(e);for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];r(n.length>1?n:n[0])},e.apply(this,n)}))}}function ra(e,t,r,n){t=t||[];var i=[],o=0,s=ea(r);return e(t,((e,t,r)=>{var n=o++;s(e,((e,t)=>{i[n]=t,r(e)}))}),(e=>{n(e,i)}))}function na(e){return e&&"number"==typeof e.length&&e.length>=0&&e.length%1==0}var ia={};function oa(e){function t(){if(null!==e){var t=e;e=null;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];t.apply(this,n)}}return Object.assign(t,e),t}function sa(e){if(na(e))return function(e){var t=-1,r=e.length;return function(){return++t<r?{value:e[t],key:t}:null}}(e);var t,r,n,i,o=function(e){return e[Symbol.iterator]&&e[Symbol.iterator]()}(e);return o?function(e){var t=-1;return function(){var r=e.next();return r.done?null:(t++,{value:r.value,key:t})}}(o):(r=(t=e)?Object.keys(t):[],n=-1,i=r.length,function e(){var o=r[++n];return"__proto__"===o?e():n<i?{value:t[o],key:o}:null})}function aa(e){return function(){if(null===e)throw new Error("Callback was already called.");var t=e;e=null;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];t.apply(this,n)}}function ca(e,t,r,n){var i=!1,o=!1,s=!1,a=0,c=0;function u(){a>=t||s||i||(s=!0,e.next().then((e=>{var{value:t,done:d}=e;if(!o&&!i){if(s=!1,d)return i=!0,void(a<=0&&n(null));a++,r(t,c,l),c++,u()}})).catch(d))}function l(e,t){if(a-=1,!o)return e?d(e):!1===e?(i=!0,void(o=!0)):t===ia||i&&a<=0?(i=!0,n(null)):void u()}function d(e){o||(s=!1,i=!0,n(e))}u()}var ua=e=>(t,r,n)=>{if(n=oa(n),e<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!t)return n(null);if("AsyncGenerator"===t[Symbol.toStringTag])return ca(t,e,r,n);if(function(e){return"function"==typeof e[Symbol.asyncIterator]}(t))return ca(t[Symbol.asyncIterator](),e,r,n);var i=sa(t),o=!1,s=!1,a=0,c=!1;function u(e,t){if(!s)if(a-=1,e)o=!0,n(e);else if(!1===e)o=!0,s=!0;else{if(t===ia||o&&a<=0)return o=!0,n(null);c||l()}}function l(){for(c=!0;a<e&&!o;){var t=i();if(null===t)return o=!0,void(a<=0&&n(null));a+=1,r(t.value,t.key,aa(u))}c=!1}l()};var la=ta((function(e,t,r,n){return ua(t)(e,ea(r),n)}),4);function da(e,t,r){r=oa(r);var n=0,i=0,{length:o}=e,s=!1;function a(e,t){!1===e&&(s=!0),!0!==s&&(e?r(e):++i!==o&&t!==ia||r(null))}for(0===o&&r(null);n<o;n++)t(e[n],n,aa(a))}function ha(e,t,r){return la(e,1/0,t,r)}var fa=ta((function(e,t,r){return(na(e)?da:ha)(e,ea(t),r)}),3);var pa=ta((function(e,t,r){return ra(fa,e,t,r)}),3);var ma=ta((function(e,t,r){return la(e,1,t,r)}),3);ta((function(e,t,r){return ra(ma,e,t,r)}),3);class ga{constructor(){this.head=this.tail=null,this.length=0}removeLink(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,e.prev=e.next=null,this.length-=1,e}empty(){for(;this.head;)this.shift();return this}insertAfter(e,t){t.prev=e,t.next=e.next,e.next?e.next.prev=t:this.tail=t,e.next=t,this.length+=1}insertBefore(e,t){t.prev=e.prev,t.next=e,e.prev?e.prev.next=t:this.head=t,e.prev=t,this.length+=1}unshift(e){this.head?this.insertBefore(this.head,e):va(this,e)}push(e){this.tail?this.insertAfter(this.tail,e):va(this,e)}shift(){return this.head&&this.removeLink(this.head)}pop(){return this.tail&&this.removeLink(this.tail)}toArray(){return[...this]}*[Symbol.iterator](){for(var e=this.head;e;)yield e.data,e=e.next}remove(e){for(var t=this.head;t;){var{next:r}=t;e(t)&&this.removeLink(t),t=r}return this}}function va(e,t){e.length=1,e.head=e.tail=t}function ya(e,t,r){if(null==t)t=1;else if(0===t)throw new RangeError("Concurrency must not be zero");var n=ea(e),i=0,o=[],s={error:[],drain:[],saturated:[],unsaturated:[],empty:[]};function a(e,t){return e?t?void(s[e]=s[e].filter((e=>e!==t))):s[e]=[]:Object.keys(s).forEach((e=>s[e]=[]))}function c(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];s[e].forEach((e=>e(...r)))}var u=!1;function l(e,t,r,n){if(null!=n&&"function"!=typeof n)throw new Error("task callback must be a function");var i,o;function s(e){if(e)return r?o(e):i();for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];if(n.length<=1)return i(n[0]);i(n)}m.started=!0;var a=m._createTaskItem(e,r?s:n||s);if(t?m._tasks.unshift(a):m._tasks.push(a),u||(u=!0,Ws((()=>{u=!1,m.process()}))),r||!n)return new Promise(((e,t)=>{i=e,o=t}))}function d(e){return function(t){i-=1;for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];for(var a=0,u=e.length;a<u;a++){var l=e[a],d=o.indexOf(l);0===d?o.shift():d>0&&o.splice(d,1),l.callback(t,...n),null!=t&&c("error",t,l.data)}i<=m.concurrency-m.buffer&&c("unsaturated"),m.idle()&&c("drain"),m.process()}}function h(e){return!(0!==e.length||!m.idle())&&(Ws((()=>c("drain"))),!0)}var f=e=>t=>{if(!t)return new Promise(((t,r)=>{!function(e,t){s[e].push((function r(){a(e,r),t(...arguments)}))}(e,((e,n)=>{if(e)return r(e);t(n)}))}));a(e),function(e,t){s[e].push(t)}(e,t)},p=!1,m={_tasks:new ga,_createTaskItem:(e,t)=>({data:e,callback:t}),*[Symbol.iterator](){yield*m._tasks[Symbol.iterator]()},concurrency:t,payload:r,buffer:t/4,started:!1,paused:!1,push(e,t){if(Array.isArray(e)){if(h(e))return;return e.map((e=>l(e,!1,!1,t)))}return l(e,!1,!1,t)},pushAsync(e,t){if(Array.isArray(e)){if(h(e))return;return e.map((e=>l(e,!1,!0,t)))}return l(e,!1,!0,t)},kill(){a(),m._tasks.empty()},unshift(e,t){if(Array.isArray(e)){if(h(e))return;return e.map((e=>l(e,!0,!1,t)))}return l(e,!0,!1,t)},unshiftAsync(e,t){if(Array.isArray(e)){if(h(e))return;return e.map((e=>l(e,!0,!0,t)))}return l(e,!0,!0,t)},remove(e){m._tasks.remove(e)},process(){if(!p){for(p=!0;!m.paused&&i<m.concurrency&&m._tasks.length;){var e=[],t=[],r=m._tasks.length;m.payload&&(r=Math.min(r,m.payload));for(var s=0;s<r;s++){var a=m._tasks.shift();e.push(a),o.push(a),t.push(a.data)}i+=1,0===m._tasks.length&&c("empty"),i===m.concurrency&&c("saturated");var u=aa(d(e));n(t,u)}p=!1}},length:()=>m._tasks.length,running:()=>i,workersList:()=>o,idle:()=>m._tasks.length+i===0,pause(){m.paused=!0},resume(){!1!==m.paused&&(m.paused=!1,Ws(m.process))}};return Object.defineProperties(m,{saturated:{writable:!1,value:f("saturated")},unsaturated:{writable:!1,value:f("unsaturated")},empty:{writable:!1,value:f("empty")},drain:{writable:!1,value:f("drain")},error:{writable:!1,value:f("error")}}),m}ta((function(e,t,r,n){n=oa(n);var i=ea(r);return ma(e,((e,r,n)=>{i(t,e,((e,r)=>{t=r,n(e)}))}),(e=>n(e,t)))}),4);var ba=ta((function(e,t,r,n){return ra(ua(t),e,r,n)}),4);var Ea=ta((function(e,t,r,n){var i=ea(r);return ba(e,t,((e,t)=>{i(e,(function(e){if(e)return t(e);for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return t(e,n)}))}),((e,t)=>{for(var r=[],i=0;i<t.length;i++)t[i]&&(r=r.concat(...t[i]));return n(e,r)}))}),4);function wa(e,t){return(r,n,i,o)=>{var s,a=!1,c=ea(i);r(n,((r,n,i)=>{c(r,((n,o)=>n||!1===n?i(n):e(o)&&!s?(a=!0,s=t(!0,r),i(null,ia)):void i()))}),(e=>{if(e)return o(e);o(null,a?s:t(!1))}))}}function Sa(e){return(t,r,n)=>e(t,n)}ta((function(e,t,r){return Ea(e,1/0,t,r)}),3),ta((function(e,t,r){return Ea(e,1,t,r)}),3),ta((function(e,t,r){return wa((e=>e),((e,t)=>t))(fa,e,t,r)}),3),ta((function(e,t,r,n){return wa((e=>e),((e,t)=>t))(ua(t),e,r,n)}),4),ta((function(e,t,r){return wa((e=>e),((e,t)=>t))(ua(1),e,t,r)}),3),ta((function(e,t,r){r=aa(r);var n,i=ea(e),o=ea(t);function s(e){if(e)return r(e);if(!1!==e){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];n=i,o(...i,a)}}function a(e,t){return e?r(e):!1!==e?t?void i(s):r(null,...n):void 0}return a(null,!0)}),3),ta((function(e,t,r){return fa(e,Sa(ea(t)),r)}),3);var _a=ta((function(e,t,r,n){return ua(t)(e,Sa(ea(r)),n)}),4);var Ta,xa=ta((function(e,t,r){return _a(e,1,t,r)}),3);function Aa(e,t,r,n){var i=new Array(t.length);e(t,((e,t,n)=>{r(e,((e,r)=>{i[t]=!!r,n(e)}))}),(e=>{if(e)return n(e);for(var r=[],o=0;o<t.length;o++)i[o]&&r.push(t[o]);n(null,r)}))}function Ia(e,t,r,n){var i=[];e(t,((e,t,n)=>{r(e,((r,o)=>{if(r)return n(r);o&&i.push({index:t,value:e}),n(r)}))}),(e=>{if(e)return n(e);n(null,i.sort(((e,t)=>e.index-t.index)).map((e=>e.value)))}))}function Ca(e,t,r,n){return(na(t)?Aa:Ia)(e,t,ea(r),n)}function Ra(e,t,r,n){var i=ea(r);return Ca(e,t,((e,t)=>{i(e,((e,r)=>{t(e,!r)}))}),n)}function ka(e,t){return Ai(this,void 0,void 0,(function*(){try{yield e(),t()}catch(e){t(e)}}))}ta((function(e,t,r){return wa((e=>!e),(e=>!e))(fa,e,t,r)}),3),ta((function(e,t,r,n){return wa((e=>!e),(e=>!e))(ua(t),e,r,n)}),4),ta((function(e,t,r){return wa((e=>!e),(e=>!e))(ma,e,t,r)}),3),ta((function(e,t,r){return Ca(fa,e,t,r)}),3),ta((function(e,t,r,n){return Ca(ua(t),e,r,n)}),4),ta((function(e,t,r){return Ca(ma,e,t,r)}),3),ta((function(e,t){var r=aa(t),n=ea(function(e){return Xs(e)?e:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r.pop(),o=!0;r.push((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];o?Ws((()=>i(...t))):i(...t)})),e.apply(this,r),o=!1}}(e));return function e(t){if(t)return r(t);!1!==t&&n(e)}()}),2),ta((function(e,t,r,n){var i=ea(r);return ba(e,t,((e,t)=>{i(e,((r,n)=>r?t(r):t(r,{key:n,val:e})))}),((e,t)=>{for(var r={},{hasOwnProperty:i}=Object.prototype,o=0;o<t.length;o++)if(t[o]){var{key:s}=t[o],{val:a}=t[o];i.call(r,s)?r[s].push(a):r[s]=[a]}return n(e,r)}))}),4),ta((function(e,t,r,n){n=oa(n);var i={},o=ea(r);return ua(t)(e,((e,t,r)=>{o(e,t,((e,n)=>{if(e)return r(e);i[t]=n,r(e)}))}),(e=>n(e,i)))}),4),Ks||zs&&setImmediate,ta(((e,t,r)=>{var n=na(t)?[]:{};e(t,((e,t,r)=>{ea(e)((function(e){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];o.length<2&&([o]=o),n[t]=o,r(e)}))}),(e=>r(e,n)))}),3),ta((function(e,t){if(t=oa(t),!Array.isArray(e))return t(new TypeError("First argument to race must be an array of functions"));if(!e.length)return t();for(var r=0,n=e.length;r<n;r++)ea(e[r])(t)}),2),ta((function(e,t,r){return Ra(fa,e,t,r)}),3),ta((function(e,t,r,n){return Ra(ua(t),e,r,n)}),4),ta((function(e,t,r){return Ra(ma,e,t,r)}),3),ta((function(e,t,r){return wa(Boolean,(e=>e))(fa,e,t,r)}),3),ta((function(e,t,r,n){return wa(Boolean,(e=>e))(ua(t),e,r,n)}),4),ta((function(e,t,r){return wa(Boolean,(e=>e))(ma,e,t,r)}),3),ta((function(e,t,r){var n=ea(t);return pa(e,((e,t)=>{n(e,((r,n)=>{if(r)return t(r);t(r,{value:e,criteria:n})}))}),((e,t)=>{if(e)return r(e);r(null,t.sort(i).map((e=>e.value)))}));function i(e,t){var r=e.criteria,n=t.criteria;return r<n?-1:r>n?1:0}}),3),ta((function(e,t){var r,n=null;return xa(e,((e,t)=>{ea(e)((function(e){if(!1===e)return t(e);for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];o.length<2?[r]=o:r=o,n=e,t(e?null:{})}))}),(()=>t(n,r)))})),ta((function(e,t,r){r=aa(r);var n=ea(t),i=ea(e),o=[];function s(e){if(e)return r(e);for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];o=n,!1!==e&&i(a)}function a(e,t){return e?r(e):!1!==e?t?void n(s):r(null,...o):void 0}return i(a)}),3),ta((function(e,t){if(t=oa(t),!Array.isArray(e))return t(new Error("First argument to waterfall must be an array of functions"));if(!e.length)return t();var r=0;function n(t){ea(e[r++])(...t,aa(i))}function i(i){if(!1!==i){for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];if(i||r===e.length)return t(i,...s);n(s)}}n([])}));class Oa{constructor(){var e,t;this.queue=(e=1,t=ea(ka),ya(((e,r)=>{t(e[0],r)}),e,1))}push(e){return this.queue.pushAsync(e)}empty(){return this.queue.empty()}}!function(e){e[e.LocalOnly=0]="LocalOnly",e[e.Remote=1]="Remote"}(Ta||(Ta={}));class Na extends As{constructor(e,t,r,n,i){super(e,t),this.rtxEnabled=!1,this.streamMuteStateChange=new $s,this.streamPublishStateChange=new $s,this.negotiationNeeded=new $s,this.namedMediaGroupsChange=new $s,this.requestedIdEncodingParamsMap=new Map,this.updateSendParametersQueue=new Oa,this.csi=r,this.direction="sendrecv",this.handleTrackChange=this.handleTrackChange.bind(this),this.handleStreamConstraintsChange=this.handleStreamConstraintsChange.bind(this),this.handleStreamMuteStateChange=this.handleStreamMuteStateChange.bind(this),this.munger=n,this.mediaType=i}replaceSenderSource(e){var t,r;return Ai(this,void 0,void 0,(function*(){var n=null!==(t=null==e?void 0:e.outputStream.getTracks()[0])&&void 0!==t?t:null;(null===(r=this.sender.track)||void 0===r?void 0:r.id)!==(null==n?void 0:n.id)&&(yield this.sender.replaceTrack(n),n?bi.log("Sender source for ".concat(this.mediaType," replaced with track ID ").concat(n.id)):bi.log("Sender source for ".concat(this.mediaType," set to null, sender stopped")))}))}handleTrackChange(){return Ai(this,void 0,void 0,(function*(){this.requested&&(yield this.replaceSenderSource(this.publishedStream))}))}handleStreamConstraintsChange(){return Ai(this,void 0,void 0,(function*(){yield this.updateSendParameters(this.requestedIdEncodingParamsMap)}))}handleStreamMuteStateChange(){this.streamMuteStateChange.emit()}get requested(){return this.requestedIdEncodingParamsMap.size>0}replaceTransceiver(e){var t=Object.create(null,{replaceTransceiver:{get:()=>super.replaceTransceiver}});return Ai(this,void 0,void 0,(function*(){t.replaceTransceiver.call(this,e),e.direction=this.direction,this.requested&&(yield this.replaceSenderSource(this.publishedStream))}))}replacePublishedStream(e){return Ai(this,void 0,void 0,(function*(){var t=this.publishedStream;null==t||t.off(Ft.OutputTrackChange,this.handleTrackChange),null==t||t.off(Ft.ConstraintsChange,this.handleStreamConstraintsChange),null==t||t.off(St.MuteStateChange,this.handleStreamMuteStateChange),this.requested&&(yield this.replaceSenderSource(e)),this.publishedStream=e,null==e||e.on(Ft.OutputTrackChange,this.handleTrackChange),null==e||e.on(Ft.ConstraintsChange,this.handleStreamConstraintsChange),null==e||e.on(St.MuteStateChange,this.handleStreamMuteStateChange),!t&&e&&!e.muted||t&&!e&&!t.muted?this.streamPublishStateChange.emit():(null==t?void 0:t.muted)!==(null==e?void 0:e.muted)&&this.streamMuteStateChange.emit()}))}setNamedMediaGroups(e){this.mediaType!==Pn.AudioMain&&Ei(Hn.SET_NMG_FAILED,"Named media groups can only be set for audio."),this.namedMediaGroups=e,this.namedMediaGroupsChange.emit()}publishStream(e){return this.replacePublishedStream(e)}unpublishStream(){return this.replacePublishedStream()}get active(){return"sendrecv"===this._rtcRtpTransceiver.direction}set active(e){this.direction=e?"sendrecv":"inactive",this._rtcRtpTransceiver.direction=this.direction,this._rtcRtpTransceiver.direction!==this._rtcRtpTransceiver.currentDirection&&this.negotiationNeeded.emit(Ta.Remote)}getStats(){return this.sender.getStats()}updateSendParameters(e){return Ai(this,void 0,void 0,(function*(){return this.updateSendParametersQueue.push((()=>Ai(this,void 0,void 0,(function*(){var t=e.size>0;this.requested!==t&&(yield this.replaceSenderSource(t?this.publishedStream:null));var r=this.sender.getParameters();r.encodings.forEach(((t,r)=>{var n,i,o=e.get(r);if(t.active=!!o,o){var{maxPayloadBitsPerSecond:s,maxFs:a,maxWidth:c,maxHeight:u}=o,l=function(e,t,r,n,i){if(e&&t&&r){var o=Math.max(t/xi([e,t],r),1);return n&&i&&(o=Math.max(e/n,t/i,o)),o}}(null===(n=this.publishedStream)||void 0===n?void 0:n.getSettings().width,null===(i=this.publishedStream)||void 0===i?void 0:i.getSettings().height,a,c,u);void 0!==s&&s>=0&&(t.maxBitrate=s),void 0!==l&&l>=1&&(t.scaleResolutionDownBy=l)}})),yield this.sender.setParameters(r),this.requestedIdEncodingParamsMap=e}))))}))}isSimulcastEnabled(){return this.sender.getParameters().encodings.length>1}mungeLocalDescription(e){this.munger.mungeLocalDescription(e,this.isSimulcastEnabled(),this.rtxEnabled,this.twccDisabled)}mungeLocalDescriptionForRemoteServer(e){this.munger.mungeLocalDescriptionForRemoteServer(e,Bn(this.mediaType),this.csi)}mungeRemoteDescription(e){this.munger.mungeRemoteDescription(e)}get senderIds(){return this.munger.getSenderIds()}get numActiveSimulcastLayers(){var e;return Un(this.mediaType)===kn.Video?null===(e=this.publishedStream)||void 0===e?void 0:e.getNumActiveSimulcastLayers():this.publishedStream?0:void 0}getEncodingIndexForStreamId(e){return this.munger.getEncodingIndexForStreamId(e)}resetSdpMunger(){this.munger.reset()}setCodecParameters(e){this.munger.setCodecParameters(e),this.negotiationNeeded.emit(Ta.LocalOnly)}deleteCodecParameters(e){this.munger.deleteCodecParameters(e),this.negotiationNeeded.emit(Ta.LocalOnly)}}class Pa{constructor(e){this.sendTransceiver=e}publishStream(e){return Ai(this,void 0,void 0,(function*(){return e===this.sendTransceiver.publishedStream?Promise.resolve():this.sendTransceiver.publishStream(e)}))}unpublishStream(){return Ai(this,void 0,void 0,(function*(){return this.sendTransceiver.publishedStream?this.sendTransceiver.unpublishStream():Promise.resolve()}))}setNamedMediaGroups(e){this.sendTransceiver.setNamedMediaGroups(e)}get active(){return this.sendTransceiver.active}set active(e){this.sendTransceiver.active=e}setCodecParameters(e){return Ai(this,void 0,void 0,(function*(){this.sendTransceiver.setCodecParameters(e)}))}deleteCodecParameters(e){return Ai(this,void 0,void 0,(function*(){this.sendTransceiver.deleteCodecParameters(e)}))}}class La{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>Ai(this,void 0,void 0,(function*(){}));this.statsGetter=e,this.statsPreProcessor=t}getStats(){return Ai(this,void 0,void 0,(function*(){var e=yield this.statsGetter(),t=new Map;return e.forEach(((e,r)=>t.set(r,e))),yield this.statsPreProcessor(t),t}))}}var Da;function Ma(e){return[Pn.VideoMain,Pn.VideoSlides].includes(e)?Tn.Video:Tn.Audio}!function(e){e.VideoSourceCountUpdate="video-source-count-update",e.AudioSourceCountUpdate="audio-source-count-update",e.ActiveSpeakerNotification="active-speaker-notification",e.ConnectionStateUpdate="connection-state-update",e.NegotiationNeeded="negotiation-needed"}(Da||(Da={}));var Ua={disableSimulcast:$o.isFirefox(),bundlePolicy:"max-compat",iceServers:void 0,disableContentSimulcast:!0,disableAudioTwcc:!0};class Ba extends ws{constructor(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.sendTransceivers=new Map,this.recvTransceivers=new Map,this.jmpSessions=new Map,this.pendingJmpTasks=[],this.metricsCallback=()=>{},this.overuseUpdateCallback=()=>{},this.midPredictor=new _s,this.offerAnswerQueue=new Oa,this.currentCreateOfferId=0,this.options=Object.assign(Object.assign({},Ua),e),bi.info("Creating multistream connection with options ".concat(JSON.stringify(this.options))),this.initializePeerConnection(),this.overuseStateManager=new Ts((e=>this.overuseUpdateCallback(e))),this.overuseStateManager.start(),this.statsManager=new La((()=>this.pc.getStats()),(e=>this.preProcessStats(e)));var t=Dn(),r=Dn(),n=this.getVideoEncodingOptions(On.Main),i=this.getVideoEncodingOptions(On.Slides);this.createSendTransceiver(Pn.VideoMain,t,n),this.createSendTransceiver(Pn.AudioMain,t),this.createSendTransceiver(Pn.VideoSlides,r,i),this.createSendTransceiver(Pn.AudioSlides,r)}initializePeerConnection(){var e;null===(e=this.pc)||void 0===e||e.close(),this.pc=new In({iceServers:this.options.iceServers,bundlePolicy:this.options.bundlePolicy}),this.pc.on(In.Events.ConnectionStateChange,(e=>this.emit(Da.ConnectionStateUpdate,e))),this.attachMetricsObserver(),this.createDataChannel()}getConnectionState(){return this.pc.getConnectionState()}getVideoEncodingOptions(e){return(e===On.Main?!this.options.disableSimulcast:!this.options.disableContentSimulcast)?[{scaleResolutionDownBy:4,active:!1},{scaleResolutionDownBy:2,active:!1},{active:!1}]:[{active:!1}]}createSendTransceiver(e,t,r){var n;try{n=this.pc.addTransceiver(Ma(e),{direction:"sendrecv",sendEncodings:r})}catch(e){throw bi.error("addTransceiver failed due to : ".concat(e)),e}var i=this.midPredictor.getNextMid(e),o=Mn(Un(e),t),s=new rs,a=new Na(n,i,o,s,e);Un(e)===kn.Video&&(a.rtxEnabled=!0,a.setCodecParameters({"max-mbps":"".concat(244800),"max-fs":"".concat(8160)})),a.twccDisabled=Un(e)===kn.Audio&&this.options.disableAudioTwcc,a.active=!1,a.streamMuteStateChange.on((()=>{this.sendSourceAdvertisement(e),this.sendMediaRequestStatus(e)})),a.streamPublishStateChange.on((()=>{this.sendSourceAdvertisement(e),this.sendMediaRequestStatus(e)})),a.negotiationNeeded.on((e=>{e===Ta.Remote?this.emit(Da.NegotiationNeeded):this.pc.getRemoteDescription()&&this.queueLocalOfferAnswer()})),a.namedMediaGroupsChange.on((()=>{this.sendSourceAdvertisement(e)})),this.sendTransceivers.set(e,a),this.createJmpSession(e)}createSendSlot(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.getSendTransceiverOrThrow(e);return r.active=t,new Pa(r)}createJmpSession(e){var t=new fi(Un(e),Bn(e));t.setTxCallback((e=>{var t;"open"===(null===(t=this.dataChannel)||void 0===t?void 0:t.readyState)?(bi.info("Sending JMP message: ".concat(e)),this.dataChannel.send(e)):bi.error("DataChannel not created or not connected. Unable to send JMP message.")}));var r=0,n=0;t.on(Vn.SourceAdvertisementReceived,(t=>{if(bi.log("SourceAdvertisement received: ".concat(JSON.stringify(t))),t.numTotalSources!==r||t.numLiveSources!==n){r=t.numTotalSources,n=t.numLiveSources;var i=Un(e)===kn.Video?Da.VideoSourceCountUpdate:Da.AudioSourceCountUpdate;this.emit(i,t.numTotalSources,t.numLiveSources,Bn(e))}else bi.log("Number of sources was unchanged, ignoring message")})),t.on(Vn.MediaRequestStatusReceived,(e=>{bi.log("MediaRequestStatus received: ".concat(JSON.stringify(e))),e.streamStates.forEach((e=>{var t=this.getReceiveSlotById(e.id);t?t._updateSource(e.state,e.csi):bi.warn("Got MediaRequestStatus for unknown receive slot: ".concat(JSON.stringify(e.id)))}))})),t.on(Vn.MediaRequestReceived,(t=>{bi.log("MediaRequest received: ".concat(JSON.stringify(t))),this.updateRequestedStreams(e,t.requests).then((()=>{Un(e)===kn.Video&&this.sendMediaRequestStatus(e)}))})),t.on(Vn.ActiveSpeaker,(e=>{this.emit(Da.ActiveSpeakerNotification,e.csis)})),this.jmpSessions.set(e,t)}updateRequestedStreams(e,t){var r=this.getSendTransceiverOrThrow(e),n=Un(e),i=new Map,o=t.filter((e=>ai(e.policySpecificInfo)));return o.length!==t.length&&bi.warn("Ignoring non-receiver-selected requests"),o.forEach((t=>{var o,s,a,{ids:c,policySpecificInfo:u,codecInfos:l,maxPayloadBitsPerSecond:d}=t;if(c.length>1&&Ei(Hn.INVALID_STREAM_REQUEST,"Stream request cannot have more than one ID."),0!==c.length)if(r.csi===u.csi){var h=c[0],f=l[0];if(r.senderIds.some((e=>Xn(h,e)))){var p=r.getEncodingIndexForStreamId(h);if(-1!==p){var m={maxPayloadBitsPerSecond:d};n===kn.Video&&(m.maxFs=null===(o=null==f?void 0:f.h264)||void 0===o?void 0:o.maxFs,m.maxWidth=null===(s=null==f?void 0:f.h264)||void 0===s?void 0:s.maxWidth,m.maxHeight=null===(a=null==f?void 0:f.h264)||void 0===a?void 0:a.maxHeight),i.set(p,m)}else bi.warn("".concat(e,": Unable to get encoding index for stream ID: ").concat(JSON.stringify(h)))}else bi.warn("".concat(e,": Unable to find matching stream ID for requested ID: ").concat(JSON.stringify(h)))}else bi.warn("csi in the StreamRequest does not match")})),r.updateSendParameters(i)}createDataChannel(){var e=this.pc.createDataChannel("datachannel",{ordered:!1,maxRetransmits:0});e.onopen=e=>{bi.info("DataChannel opened:",JSON.stringify(e)),[...this.sendTransceivers.keys()].forEach((e=>{this.sendSourceAdvertisement(e)})),bi.info("Flushing pending JMP task queue"),this.pendingJmpTasks.forEach((e=>e())),this.pendingJmpTasks=[]},e.onmessage=e=>{var t;try{t=JSON.parse(e.data)}catch(e){return void bi.error("Error parsing datachannel JSON: ".concat(e))}bi.debug("DataChannel got msg:",e.data);var r=Kn.fromJson(t);if(r){var n=r.payload;if(Jn(n)){var i,o,s=(i=n.mediaFamily,o=n.mediaContent,i===kn.Video&&o===On.Main?Pn.VideoMain:i===kn.Video&&o===On.Slides?Pn.VideoSlides:i===kn.Audio&&o===On.Main?Pn.AudioMain:Pn.AudioSlides),a=this.jmpSessions.get(s);a?a.receive(n):bi.error("Unable to find JMP session for media type ".concat(s,"."))}else bi.error("Received invalid JMP msg: ".concat(JSON.stringify(n)))}else bi.error("Received invalid datachannel message: ".concat(e))},e.onclose=e=>{bi.info("DataChannel closed:",JSON.stringify(e))},e.onerror=e=>{bi.info("DataChannel error:",JSON.stringify(e))},this.dataChannel=e}close(){this.sendTransceivers.forEach((e=>e.close())),this.recvTransceivers.forEach((e=>{e.forEach((e=>e.close()))})),this.jmpSessions.forEach((e=>e.close())),this.pc.close()}sendMediaRequestStatus(e){var t;if(Un(e)===kn.Video&&this.getSendTransceiverOrThrow(e).requested){var r=this.getVideoStreamStates(e),n=()=>{var t;null===(t=this.jmpSessions.get(e))||void 0===t||t.sendMediaRequestStatus(r)};"open"===(null===(t=this.dataChannel)||void 0===t?void 0:t.readyState)?n():this.pendingJmpTasks.push(n)}}sendSourceAdvertisement(e){var t,r,n,i=this.getSendTransceiverOrThrow(e),o=!1===(null===(t=i.publishedStream)||void 0===t?void 0:t.muted)?1:0;if(Un(e)===kn.Video){var s;if(null===this.getVideoStreamStates(e))return;i.publishedStream&&e===Pn.VideoSlides&&(s=i.publishedStream.contentHint),n=()=>{var t,r;null===(t=this.jmpSessions.get(e))||void 0===t||t.sendSourceAdvertisement(1,o,[],"motion"===(r=s)?"motion":"detail"===r?"sharpness":void 0)}}else n=()=>{var t;return null===(t=this.jmpSessions.get(e))||void 0===t?void 0:t.sendSourceAdvertisement(1,o,e===Pn.AudioMain?i.namedMediaGroups:[])};"open"===(null===(r=this.dataChannel)||void 0===r?void 0:r.readyState)?n():this.pendingJmpTasks.push(n)}getVideoStreamStates(e){var t,r=this.getSendTransceiverOrThrow(e),n=!!r.publishedStream,i=null===(t=r.publishedStream)||void 0===t?void 0:t.muted;return r.senderIds.map((e=>({id:e,state:n?i?"avatar":"live":"no source",csi:r.csi})))}createReceiveSlot(e){return Ai(this,void 0,void 0,(function*(){return new Promise((t=>{this.offerAnswerQueue.push((()=>Ai(this,void 0,void 0,(function*(){var r=this.pc.addTransceiver(Ma(e),{direction:"recvonly"}),n=this.midPredictor.getNextMid(e),i=new Ss,o=new Is(r,n,i);o.twccDisabled=Un(e)===kn.Audio&&this.options.disableAudioTwcc,this.recvTransceivers.set(e,[...this.recvTransceivers.get(e)||[],o]),this.pc.getRemoteDescription()&&(yield this.doLocalOfferAnswer()),t(o.receiveSlot)}))))}))}))}getIngressPayloadType(e,t){var r,n,i,o=t.split("/")[1],s=null===(r=this.sendTransceivers.get(e))||void 0===r?void 0:r.mid,a=Mo(null===(n=this.pc.getLocalDescription())||void 0===n?void 0:n.sdp),c=Mo(null===(i=this.pc.getRemoteDescription())||void 0===i?void 0:i.sdp).avMedia.filter((e=>s===e.mid)).map((e=>[...e.codecs.values()])).flat().filter((e=>e.name===o)),u=a.avMedia.filter((e=>s===e.mid)).map((e=>[...e.codecs.values()])).flat().filter((e=>e.name===o));c&&u&&0!==c.length&&0!==u.length||Ei(Hn.GET_PAYLOAD_TYPE_FAILED,"Sender codecs or receiver codecs is undefined or empty.");var l=c[0],d=u.find((e=>_i(l,e)));return d&&d.pt||Ei(Hn.GET_PAYLOAD_TYPE_FAILED,"Cannot find matching receiver codec for the given mediaType/mimeType."),d.pt}createOffer(){return Ai(this,void 0,void 0,(function*(){this.pc.getLocalDescription()||this.midPredictor.allocateMidForDatachannel(),this.setAnswerResolve&&(bi.info("Canceling previous offer since setAnswer was never called for it"),this.setAnswerResolve(),this.setAnswerResolve=void 0);var e=++this.currentCreateOfferId;return new Promise(((t,r)=>{this.offerAnswerQueue.push((()=>Ai(this,void 0,void 0,(function*(){var n;try{var i=yield this.pc.createOffer();i.sdp||Ei(Hn.CREATE_OFFER_FAILED,"SDP not found in offer."),i.sdp=this.preProcessLocalOffer(i.sdp),yield this.pc.setLocalDescription(i);var o=this.prepareLocalOfferForRemoteServer(null===(n=this.pc.getLocalDescription())||void 0===n?void 0:n.sdp);t({type:"offer",sdp:o}),this.currentCreateOfferId>e?bi.log("Canceling previous offer since createOffer was called while it was being created"):yield new Promise((e=>{this.setAnswerResolve=e}))}catch(e){r(e)}}))))}))}))}setAnswer(e){return Ai(this,void 0,void 0,(function*(){var t=this.preProcessRemoteAnswer(e);return this.setAnswerResolve||Ei(Hn.SET_ANSWER_FAILED,"Call to setAnswer without having previously called createOffer."),bi.info("calling this.pc.setRemoteDescription()"),this.pc.setRemoteDescription({type:"answer",sdp:t}).then((()=>Ai(this,void 0,void 0,(function*(){bi.info("this.pc.setRemoteDescription() resolved"),this.setAnswerResolve?(this.setAnswerResolve(),this.setAnswerResolve=void 0):bi.debug("setAnswerResolve function was cleared between setAnswer and result of setRemoteDescription")}))))}))}doLocalOfferAnswer(){var e;return Ai(this,void 0,void 0,(function*(){var t=yield this.pc.createOffer();t.sdp||Ei(Hn.CREATE_OFFER_FAILED,"SDP not found in offer."),t.sdp=this.preProcessLocalOffer(t.sdp),yield this.pc.setLocalDescription(t);var r=this.preProcessRemoteAnswer(null===(e=this.pc.getRemoteDescription())||void 0===e?void 0:e.sdp);return this.pc.setRemoteDescription({type:"answer",sdp:r})}))}queueLocalOfferAnswer(){return Ai(this,void 0,void 0,(function*(){return this.offerAnswerQueue.push((()=>Ai(this,void 0,void 0,(function*(){yield this.doLocalOfferAnswer()}))))}))}preProcessLocalOffer(e){var t=Mo(e);return t.avMedia.filter((e=>"recvonly"===e.direction)).forEach((e=>{this.getRecvTransceiverByMidOrThrow(e.mid).mungeLocalDescription(e)})),t.avMedia.filter((e=>"sendrecv"===e.direction||"inactive"===e.direction)).forEach((e=>{this.getSendTransceiverByMidOrThrow(e.mid).mungeLocalDescription(e)})),$o.isFirefox()&&Qo(t,this.options.bundlePolicy,this.midPredictor.getMidMap()),t.toString()}prepareLocalOfferForRemoteServer(e){var t,r,n=Mo(e);return n.avMedia.filter((e=>"sendrecv"===e.direction||"inactive"===e.direction)).forEach((e=>{this.getSendTransceiverByMidOrThrow(e.mid).mungeLocalDescriptionForRemoteServer(e)})),n.media.filter((e=>e instanceof Co)).forEach((e=>{Xo(e)})),$o.isFirefox()&&(Qo(n,this.options.bundlePolicy,this.midPredictor.getMidMap()),"max-bundle"===this.options.bundlePolicy&&n.media.forEach(((e,t)=>{t>0&&(e.port=n.media[0].port)}))),r=[],(t=n).media=t.media.filter((e=>(e instanceof Co||e instanceof ko&&"recvonly"!==e.direction)&&(r.push(e.mid),!0))),t.session.groups.forEach((e=>{e.mids=e.mids.filter((e=>r.includes(e)))})),n.toString()}preProcessRemoteAnswer(e){var t,r=Mo(e);return Yo(Mo(null===(t=this.pc.getLocalDescription())||void 0===t?void 0:t.sdp),r),r.avMedia.filter((e=>"sendonly"===e.direction)).forEach((e=>{this.getRecvTransceiverByMidOrThrow(e.mid).mungeRemoteDescription(e)})),r.avMedia.filter((e=>"sendrecv"===e.direction||"recvonly"===e.direction)).forEach((e=>{this.getSendTransceiverByMidOrThrow(e.mid).mungeRemoteDescription(e)})),r.media.filter((e=>e instanceof Co)).forEach((e=>{Fo(e,["udp","tcp"])&&bi.log("Some unsupported remote candidates have been removed from mid ".concat(e.mid))})),$o.isFirefox()&&Qo(r,this.options.bundlePolicy,this.midPredictor.getMidMap()),r.toString()}getSendTransceiverOrThrow(e){var t=this.sendTransceivers.get(e);return t||Ei(Hn.GET_TRANSCEIVER_FAILED,"Unable to find send transceiver for media type ".concat(e,".")),t}getSendTransceiverByMidOrThrow(e){var t=[...this.sendTransceivers.values()].find((t=>t.mid===e));return t||Ei(Hn.GET_TRANSCEIVER_FAILED,"Unable to find send transceiver with MID ".concat(e,".")),t}getRecvTransceiverByMidOrThrow(e){var t=[...this.recvTransceivers.values()].flat().find((t=>t.mid===e));return t||Ei(Hn.GET_TRANSCEIVER_FAILED,"Unable to find recv transceiver with MID ".concat(e,".")),t}requestMedia(e,t){var r,n=()=>{var r,n=this.jmpSessions.get(e);if(n){var i=[];t.forEach((e=>{e.receiveSlots.forEach((e=>{e.id?i.push(e.id):bi.error("Running stream request task, but ReceiveSlot ID is missing!")}))})),null===(r=this.recvTransceivers.get(e))||void 0===r||r.forEach((e=>{i.some((t=>Xn(t,e.receiveSlot.id)))||e.receiveSlot._updateSource("no source",void 0)})),n.sendRequests(t.map((e=>e._toJmpStreamRequest())))}else bi.error("Unable to find jmp session for ".concat(e))};"open"===(null===(r=this.dataChannel)||void 0===r?void 0:r.readyState)?n():this.pendingJmpTasks.push(n)}renewPeerConnection(e){e&&(this.options=Object.assign(Object.assign({},this.options),e)),bi.info("Renewing multistream connection with options ".concat(JSON.stringify(this.options))),this.midPredictor.reset(),this.initializePeerConnection();var t=Dn(),r=Dn();this.sendTransceivers.forEach(((e,n)=>{var i,o=Bn(n),s=o===On.Main?t:r,a=this.midPredictor.getNextMid(n);e.replaceTransceiver(this.pc.addTransceiver(Ma(n),{direction:"sendrecv",sendEncodings:Un(n)===kn.Video?this.getVideoEncodingOptions(o):void 0})),e.mid=a,e.csi=Mn(Un(n),s),e.resetSdpMunger(),null===(i=this.jmpSessions.get(n))||void 0===i||i.close(),this.createJmpSession(n)})),this.recvTransceivers.forEach(((e,t)=>{e.forEach((e=>{var r=this.midPredictor.getNextMid(t);e.replaceTransceiver(this.pc.addTransceiver(Ma(t),{direction:"recvonly"})),e.mid=r}))}))}getReceiveSlotById(e){return[...this.recvTransceivers.values()].flat().map((e=>e.receiveSlot)).find((t=>{var r=t.id||{};return Object.keys(r).length===Object.keys(e).length&&Object.keys(r).every((t=>Object.prototype.hasOwnProperty.call(e,t)&&r[t]===e[t]))}))}getStats(){return this.statsManager.getStats()}getTransceiverStats(){return Ai(this,void 0,void 0,(function*(){return e=this.sendTransceivers,t=this.recvTransceivers,Ai(void 0,void 0,void 0,(function*(){var r={audio:{senders:[],receivers:[]},video:{senders:[],receivers:[]},screenShareAudio:{senders:[],receivers:[]},screenShareVideo:{senders:[],receivers:[]}};return yield Promise.all([...e.entries()].map((e=>{var[t,n]=e;return Ai(void 0,void 0,void 0,(function*(){var e,i={report:yield n.getStats(),mid:n.mid,csi:n.csi,currentDirection:"sendonly",localTrackLabel:null===(e=n.publishedStream)||void 0===e?void 0:e.label};t===Pn.AudioMain&&r.audio.senders.push(i),t===Pn.VideoMain&&r.video.senders.push(i),t===Pn.AudioSlides&&r.screenShareAudio.senders.push(i),t===Pn.VideoSlides&&r.screenShareVideo.senders.push(i)}))}))),yield Promise.all([...t.entries()].map((e=>{var[t,n]=e;return Ai(void 0,void 0,void 0,(function*(){return Promise.all(n.map((e=>Ai(void 0,void 0,void 0,(function*(){var n,i,o={report:yield e.getStats(),mid:null===(n=e.receiveSlot.id)||void 0===n?void 0:n.mid,csi:e.receiveSlot.currentRxCsi,currentDirection:"recvonly",localTrackLabel:null===(i=e.receiveSlot.stream.getTracks()[0])||void 0===i?void 0:i.label};t===Pn.AudioMain&&r.audio.receivers.push(o),t===Pn.VideoMain&&r.video.receivers.push(o),t===Pn.AudioSlides&&r.screenShareAudio.receivers.push(o),t===Pn.VideoSlides&&r.screenShareVideo.receivers.push(o)})))))}))}))),r}));var e,t}))}preProcessStats(e){return Ai(this,void 0,void 0,(function*(){yield Promise.all([...this.sendTransceivers.entries()].map((t=>{var[r,n]=t;return Ai(this,void 0,void 0,(function*(){(yield n.getStats()).forEach((t=>{var i;if("outbound-rtp"===t.type){var o=e.get(t.id);o.mid=n.mid,o.csi=n.csi,o.calliopeMediaType=r;var s=null===(i=n.publishedStream)||void 0===i?void 0:i.getSettings();(null==s?void 0:s.frameRate)&&(o.targetFrameRate=null==s?void 0:s.frameRate),e.set(t.id,o)}else if("media-source"===t.type){var a=e.get(t.id);a.calliopeMediaType=r,e.set(t.id,a)}}))}))}))),yield Promise.all([...this.recvTransceivers.entries()].map((t=>{var[r,n]=t;return Ai(this,void 0,void 0,(function*(){yield Promise.all(n.map((t=>Ai(this,void 0,void 0,(function*(){(yield t.getStats()).forEach((n=>{var i;if("inbound-rtp"===n.type){var o=e.get(n.id);o.mid=null===(i=t.receiveSlot.id)||void 0===i?void 0:i.mid,o.csi=t.receiveSlot.currentRxCsi,o.calliopeMediaType=r,Object.assign(o,t.receiverId),e.set(n.id,o)}}))})))))}))})))}))}attachMetricsObserver(){this.forceStatsReport=Ri(this.pc.getUnderlyingRTCPeerConnection(),(e=>this.metricsCallback(e)),5e3,(e=>this.preProcessStats(e))).forceStatsReport}forceRtcMetricsCallback(){var e;return null===(e=this.forceStatsReport)||void 0===e?void 0:e.call(this)}setMetricsCallback(e){this.metricsCallback=e}setOveruseUpdateCallback(e){this.overuseUpdateCallback=e}getCsiByMediaType(e){var t;return null===(t=this.sendTransceivers.get(e))||void 0===t?void 0:t.csi}getAllCsis(){return{audioMain:this.getCsiByMediaType(Pn.AudioMain),audioSlides:this.getCsiByMediaType(Pn.AudioSlides),videoMain:this.getCsiByMediaType(Pn.VideoMain),videoSlides:this.getCsiByMediaType(Pn.VideoSlides)}}}class Fa{constructor(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];this.policy=e,this.policySpecificInfo=t,this.receiveSlots=r,this.maxPayloadBitsPerSecond=n,this.codecInfos=i}_toJmpStreamRequest(){return new li(this.policy,this.policySpecificInfo,this.receiveSlots.map((e=>e.id)),this.maxPayloadBitsPerSecond,this.codecInfos)}}var ja,Va,Ha,Ga,qa,$a,Za={info:function(){return console.info(...arguments)},log:function(){return console.log(...arguments)},error:function(){return console.error(...arguments)},warn:function(){return console.warn(...arguments)},trace:function(){return console.trace(...arguments)},debug:function(){return console.debug(...arguments)}},za=Za,Ka=()=>za,Wa=e=>{var t,r=Ka();t=(t,n)=>{var i=Array.from(t).map((e=>"object"==typeof e?JSON.stringify(e):e));switch(i.unshift("".concat(e||"",":[").concat(n.name,"]")),n.level.name){case"TRACE":r.trace(...i);break;case"DEBUG":r.debug(...i);break;case"INFO":r.info(...i);break;case"WARN":r.warn(...i);break;case"ERROR":r.error(...i)}},yi.setHandler(t),Ln.setHandler(t),rt.setHandler(t)},Ja=e=>e?e.stack?"".concat(e.message,": ").concat(e.stack):"".concat(e):"",Ya="\\d+",Qa="[!#$%&'*+\\-.^_`{|}~a-zA-Z0-9]+",Xa="\\S+",ec=".+";class tc{}class rc extends tc{constructor(e,t){super(),this.bandwidthType=e,this.bandwidth=t}static fromSdpLine(e){if(rc.regex.test(e)){var t=e.match(rc.regex),r=t[1],n=parseInt(t[2],10);return new rc(r,n)}}toSdpLine(){return"b=".concat(this.bandwidthType,":").concat(this.bandwidth)}}ja=rc,rc.BW_TYPE_REGEX="CT|AS|TIAS",rc.regex=new RegExp("^(".concat(ja.BW_TYPE_REGEX,"):(").concat(Ya,")"));class nc extends tc{constructor(e){super(),this.mids=e}static fromSdpLine(e){if(nc.regex.test(e)){var t=e.match(nc.regex)[1].split(" ");return new nc(t)}}toSdpLine(){return"a=group:BUNDLE ".concat(this.mids.join(" "))}}nc.regex=new RegExp("^group:BUNDLE (".concat(ec,")"));class ic extends tc{constructor(e,t,r,n,i,o,s,a,c,u){super(),this.foundation=e,this.componentId=t,this.transport=r,this.priority=n,this.connectionAddress=i,this.port=o,this.candidateType=s,this.relAddr=a,this.relPort=c,this.candidateExtensions=u}static fromSdpLine(e){if(ic.regex.test(e)){var t=e.match(ic.regex),r=t[1],n=parseInt(t[2],10),i=t[3],o=parseInt(t[4],10),s=t[5],a=parseInt(t[6],10),c=t[7],u=t[8],l=t[9]?parseInt(t[9],10):void 0,d=t[10];return new ic(r,n,i,o,s,a,c,u,l,d)}}toSdpLine(){var e="";return e+="a=candidate:".concat(this.foundation," ").concat(this.componentId," ").concat(this.transport," ").concat(this.priority," ").concat(this.connectionAddress," ").concat(this.port," typ ").concat(this.candidateType),this.relAddr&&(e+=" raddr ".concat(this.relAddr)),this.relPort&&(e+=" rport ".concat(this.relPort)),this.candidateExtensions&&(e+=" ".concat(this.candidateExtensions)),e}}Va=ic,ic.ICE_CHARS="[a-zA-Z0-9+/]+",ic.regex=new RegExp("^candidate:(".concat(Va.ICE_CHARS,") (").concat(Ya,") (").concat(Xa,") (").concat(Ya,") (").concat(Xa,") (").concat(Ya,") typ (").concat(Xa,")(?: raddr (").concat(Xa,"))?(?: rport (").concat(Ya,"))?(?: (").concat(ec,"))?"));class oc extends tc{constructor(e,t,r){super(),this.netType=e,this.addrType=t,this.ipAddr=r}static fromSdpLine(e){if(oc.regex.test(e)){var t=e.match(oc.regex),r=t[1],n=t[2],i=t[3];return new oc(r,n,i)}}toSdpLine(){return"c=".concat(this.netType," ").concat(this.addrType," ").concat(this.ipAddr)}}oc.regex=new RegExp("^(".concat(Xa,") (").concat(Xa,") (").concat(Xa,")"));class sc extends tc{constructor(e){super(),this.values=e}static fromSdpLine(e){if(sc.regex.test(e)){var t=e.match(sc.regex)[1].split(",");return new sc(t)}}toSdpLine(){return"a=content:".concat(this.values.join(","))}}sc.regex=new RegExp("^content:(".concat(ec,")$"));class ac extends tc{constructor(e){super(),this.direction=e}static fromSdpLine(e){if(ac.regex.test(e)){var t=e.match(ac.regex)[1];return new ac(t)}}toSdpLine(){return"a=".concat(this.direction)}}ac.regex=/^(sendrecv|sendonly|recvonly|inactive)$/;class cc extends tc{constructor(e,t,r,n){super(),this.id=e,this.uri=t,this.direction=r,this.extensionAttributes=n}static fromSdpLine(e){if(cc.regex.test(e)){var t=e.match(cc.regex),r=parseInt(t[1],10),n=t[2],i=t[3],o=t[4];return new cc(r,i,n,o)}}toSdpLine(){var e="";return e+="a=extmap:".concat(this.id),this.direction&&(e+="/".concat(this.direction)),e+=" ".concat(this.uri),this.extensionAttributes&&(e+=" ".concat(this.extensionAttributes)),e}}Ha=cc,cc.EXTMAP_DIRECTION="sendonly|recvonly|sendrecv|inactive",cc.regex=new RegExp("^extmap:(".concat(Ya,")(?:/(").concat(Ha.EXTMAP_DIRECTION,"))? (").concat(Xa,")(?: (").concat(ec,"))?"));class uc extends tc{constructor(e){super(),this.fingerprint=e}static fromSdpLine(e){if(uc.regex.test(e)){var t=e.match(uc.regex)[1];return new uc(t)}}toSdpLine(){return"a=fingerprint:".concat(this.fingerprint)}}uc.regex=new RegExp("^fingerprint:(".concat(ec,")"));class lc extends tc{constructor(e,t){super(),this.payloadType=e,this.params=t}static fromSdpLine(e){if(lc.regex.test(e)){var t=e.match(lc.regex),r=parseInt(t[1],10),n=t[2];return new lc(r,function(e){e=e.replace(/^a=fmtp:\d+\x20/,"");var t=new Map;return/^\d+([,/-]\d+)+$/.test(e)?(t.set(e,void 0),t):(e.split(";").forEach((r=>{var n=r&&r.split("=");if(2!==n.length||!n[0]||!n[1])throw new Error("Fmtp params is invalid with ".concat(e));t.set(n[0],n[1])})),t)}(n))}}toSdpLine(){var e=Array.from(this.params.keys()).map((e=>void 0!==this.params.get(e)?"".concat(e,"=").concat(this.params.get(e)):"".concat(e))).join(";");return"a=fmtp:".concat(this.payloadType," ").concat(e)}}lc.regex=new RegExp("^fmtp:(".concat(Ya,") (").concat(ec,")"));class dc extends tc{constructor(e){super(),this.options=e}static fromSdpLine(e){if(dc.regex.test(e)){var t=e.match(dc.regex)[1].split(" ");return new dc(t)}}toSdpLine(){return"a=ice-options:".concat(this.options.join(" "))}}dc.regex=new RegExp("^ice-options:(".concat(ec,")$"));class hc extends tc{constructor(e){super(),this.pwd=e}static fromSdpLine(e){if(hc.regex.test(e)){var t=e.match(hc.regex)[1];return new hc(t)}}toSdpLine(){return"a=ice-pwd:".concat(this.pwd)}}hc.regex=new RegExp("^ice-pwd:(".concat(Xa,")$"));class fc extends tc{constructor(e){super(),this.ufrag=e}static fromSdpLine(e){if(fc.regex.test(e)){var t=e.match(fc.regex)[1];return new fc(t)}}toSdpLine(){return"a=ice-ufrag:".concat(this.ufrag)}}fc.regex=new RegExp("^ice-ufrag:(".concat(Xa,")$"));class pc extends tc{constructor(e){super(),this.maxMessageSize=e}static fromSdpLine(e){if(pc.regex.test(e)){var t=e.match(pc.regex),r=parseInt(t[1],10);return new pc(r)}}toSdpLine(){return"a=max-message-size:".concat(this.maxMessageSize)}}pc.regex=new RegExp("^max-message-size:(".concat(Ya,")"));class mc extends tc{constructor(e,t,r,n){super(),this.type=e,this.port=t,this.protocol=r,this.formats=n}static fromSdpLine(e){if(mc.regex.test(e)){var t=e.match(mc.regex),r=t[1],n=parseInt(t[2],10),i=t[3],o=t[4].split(" ");return new mc(r,n,i,o)}}toSdpLine(){return"m=".concat(this.type," ").concat(this.port," ").concat(this.protocol," ").concat(this.formats.join(" "))}}Ga=mc,mc.MEDIA_TYPE="audio|video|application",mc.regex=new RegExp("^(".concat(Ga.MEDIA_TYPE,") (").concat(Ya,") (").concat(Xa,") (").concat(ec,")"));class gc extends tc{constructor(e){super(),this.mid=e}static fromSdpLine(e){if(gc.regex.test(e)){var t=e.match(gc.regex)[1];return new gc(t)}}toSdpLine(){return"a=mid:".concat(this.mid)}}gc.regex=new RegExp("^mid:(".concat(Xa,")$"));class vc extends tc{constructor(e,t,r,n,i,o){super(),this.username=e,this.sessionId=t,this.sessionVersion=r,this.netType=n,this.addrType=i,this.ipAddr=o}static fromSdpLine(e){if(vc.regex.test(e)){var t=e.match(vc.regex),r=t[1],n=t[2],i=parseInt(t[3],10),o=t[4],s=t[5],a=t[6];return new vc(r,n,i,o,s,a)}}toSdpLine(){return"o=".concat(this.username," ").concat(this.sessionId," ").concat(this.sessionVersion," ").concat(this.netType," ").concat(this.addrType," ").concat(this.ipAddr)}}vc.regex=new RegExp("^(".concat(Xa,") (").concat(Xa,") (").concat(Ya,") (").concat(Xa,") (").concat(Xa,") (").concat(Xa,")"));class yc extends tc{constructor(e,t,r){super(),this.id=e,this.direction=t,this.params=r}static fromSdpLine(e){if(yc.regex.test(e)){var t=e.match(yc.regex),r=t[1],n=t[2],i=t[3];return new yc(r,n,i)}}toSdpLine(){var e="";return e+="a=rid:".concat(this.id," ").concat(this.direction),this.params&&(e+=" ".concat(this.params)),e}}qa=yc,yc.RID_ID="[\\w-]+",yc.RID_DIRECTION="\\bsend\\b|\\brecv\\b",yc.regex=new RegExp("^rid:(".concat(qa.RID_ID,") (").concat(qa.RID_DIRECTION,")(?:").concat("\\s","(").concat(ec,"))?"));class bc extends tc{static fromSdpLine(e){if(bc.regex.test(e))return new bc}toSdpLine(){return"a=rtcp-mux"}}bc.regex=/^rtcp-mux$/;class Ec extends tc{constructor(e,t){super(),this.payloadType=e,this.feedback=t}static fromSdpLine(e){if(Ec.regex.test(e)){var t=e.match(Ec.regex),r=parseInt(t[1],10),n=t[2];return new Ec(r,n)}}toSdpLine(){return"a=rtcp-fb:".concat(this.payloadType," ").concat(this.feedback)}}Ec.regex=new RegExp("^rtcp-fb:(".concat(Ya,") (").concat(ec,")"));class wc extends tc{constructor(e,t,r,n){super(),this.payloadType=e,this.encodingName=t,this.clockRate=r,this.encodingParams=n}static fromSdpLine(e){if(wc.regex.test(e)){var t=e.match(wc.regex),r=parseInt(t[1],10),n=t[2],i=parseInt(t[3],10),o=t[4];return new wc(r,n,i,o)}}toSdpLine(){var e="";return e+="a=rtpmap:".concat(this.payloadType," ").concat(this.encodingName,"/").concat(this.clockRate),this.encodingParams&&(e+="/".concat(this.encodingParams)),e}}$a=wc,wc.NON_SLASH_TOKEN="[^\\s/]+",wc.regex=new RegExp("^rtpmap:(".concat(Ya,") (").concat($a.NON_SLASH_TOKEN,")/(").concat($a.NON_SLASH_TOKEN,")(?:/(").concat($a.NON_SLASH_TOKEN,"))?"));class Sc extends tc{constructor(e){super(),this.port=e}static fromSdpLine(e){if(Sc.regex.test(e)){var t=e.match(Sc.regex),r=parseInt(t[1],10);return new Sc(r)}}toSdpLine(){return"a=sctp-port:".concat(this.port)}}Sc.regex=new RegExp("^sctp-port:(".concat(Ya,")"));class _c extends tc{constructor(e){super(),this.info=e}static fromSdpLine(e){if(_c.regex.test(e)){var t=e.match(_c.regex)[1];return new _c(t)}}toSdpLine(){return"i=".concat(this.info)}}_c.regex=new RegExp("(".concat(ec,")"));class Tc extends tc{constructor(e){super(),this.name=e}static fromSdpLine(e){if(Tc.regex.test(e)){var t=e.match(Tc.regex)[1];return new Tc(t)}}toSdpLine(){return"s=".concat(this.name)}}Tc.regex=new RegExp("^(".concat(ec,")"));class xc extends tc{constructor(e){super(),this.setup=e}static fromSdpLine(e){if(xc.regex.test(e)){var t=e.match(xc.regex)[1];return new xc(t)}}toSdpLine(){return"a=setup:".concat(this.setup)}}xc.regex=/^setup:(actpass|active|passive)$/;class Ac{constructor(e,t){this.id=e,this.paused=t}toString(){return this.paused?"~".concat(this.id):this.id}}class Ic{constructor(){this.layers=[]}addLayer(e){this.layers.push([e])}addLayerWithAlternatives(e){this.layers.push(e)}get length(){return this.layers.length}get(e){return this.layers[e]}static fromString(e){var t=new Ic,r=e.split(";");if(1===r.length&&!r[0].trim())throw new Error("simulcast stream list empty");return r.forEach((e=>{if(!e)throw new Error("simulcast layer list empty");var r=e.split(","),n=[];r.forEach((e=>{if(!e||"~"===e)throw new Error("rid empty");var t="~"===e[0],r=t?e.substring(1):e;n.push(new Ac(r,t))})),t.addLayerWithAlternatives(n)})),t}toString(){return this.layers.map((e=>e.map((e=>e.toString())).join(","))).join(";")}}class Cc extends tc{constructor(e,t){super(),this.sendLayers=e,this.recvLayers=t}static fromSdpLine(e){if(Cc.regex.test(e)){var t,r,n=e.match(Cc.regex),i=n[3]&&n[4],o=n[1],s=Ic.fromString(n[2]),a=new Ic;if(i){if(o===n[3])return;a=Ic.fromString(n[4])}return"send"===o?(t=s,r=a):(t=a,r=s),new Cc(t,r)}}toSdpLine(){var e="a=simulcast:";return this.sendLayers.length&&(e+="send ".concat(this.sendLayers.toString()),this.recvLayers.length&&(e+=" ")),this.recvLayers.length&&(e+="recv ".concat(this.recvLayers.toString())),e}}Cc.regex=new RegExp("^simulcast:(send|recv) (".concat(Xa,")(?: (send|recv) (").concat(Xa,"))?"));class Rc extends tc{constructor(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;super(),this.ssrcId=e,this.attribute=t,this.attributeValue=r,this.attributeData=n}static fromSdpLine(e){if(Rc.regex.test(e)){var t=e.match(Rc.regex),r=parseInt(t[1],10),n=t[2],i=t[3],o=t[4];return new Rc(r,n,i,o)}}toSdpLine(){var e="a=ssrc:".concat(this.ssrcId," ").concat(this.attribute);return this.attributeValue&&(e+=":".concat(this.attributeValue)),this.attributeData&&(e+=" ".concat(this.attributeData)),e}}Rc.regex=new RegExp("^ssrc:(".concat(Ya,") (").concat(Qa,")(?::(").concat(Qa,")?(?: (").concat(Xa,"))?)?$"));class kc extends tc{constructor(e,t){super(),this.semantics=e,this.ssrcs=t}static fromSdpLine(e){if(kc.regex.test(e)){var t=e.match(kc.regex),r=t[1],n=t[2].split(" ").map((e=>parseInt(e,10)));return new kc(r,n)}}toSdpLine(){return"a=ssrc-group:".concat(this.semantics," ").concat(this.ssrcs.join(" "))}}kc.regex=new RegExp("^ssrc-group:(SIM|FID|FEC) ((?:".concat(Ya).concat("\\s","*)+)"));class Oc extends tc{constructor(e,t){super(),this.startTime=e,this.stopTime=t}static fromSdpLine(e){if(Oc.regex.test(e)){var t=e.match(Oc.regex),r=parseInt(t[1],10),n=parseInt(t[2],10);return new Oc(r,n)}}toSdpLine(){return"t=".concat(this.startTime," ").concat(this.stopTime)}}Oc.regex=new RegExp("^(".concat(Ya,") (").concat(Ya,")"));class Nc extends tc{constructor(e){super(),this.version=e}static fromSdpLine(e){if(Nc.regex.test(e)){var t=e.match(Nc.regex),r=parseInt(t[1],10);return new Nc(r)}}toSdpLine(){return"v=".concat(this.version)}}Nc.regex=new RegExp("^(".concat(Ya,")$"));class Pc extends tc{constructor(e){super(),this.value=e}static fromSdpLine(e){var t=e.match(Pc.regex)[1];return new Pc(t)}toSdpLine(){return"".concat(this.value)}}Pc.regex=new RegExp("(".concat(ec,")"));class Lc{constructor(){this.candidates=[]}addLine(e){return e instanceof fc?(this.ufrag=e,!0):e instanceof hc?(this.pwd=e,!0):e instanceof dc?(this.options=e,!0):e instanceof ic&&(this.candidates.push(e),!0)}toLines(){var e=[];return this.ufrag&&e.push(this.ufrag),this.pwd&&e.push(this.pwd),this.options&&e.push(this.options),this.candidates.forEach((t=>e.push(t))),e}}class Dc{constructor(e,t,r){this.iceInfo=new Lc,this.otherLines=[],this.type=e,this.port=t,this.protocol=r}findOtherLine(e){return this.otherLines.find((t=>t instanceof e))}addLine(e){if(e instanceof nc)throw new Error("Error: bundle group line not allowed in media description");return e instanceof rc?(this.bandwidth=e,!0):e instanceof gc?(this.mid=e.mid,!0):e instanceof uc?(this.fingerprint=e.fingerprint,!0):e instanceof xc?(this.setup=e.setup,!0):e instanceof oc?(this.connection=e,!0):e instanceof sc?(this.content=e,!0):this.iceInfo.addLine(e)}}class Mc extends Dc{constructor(e){super(e.type,e.port,e.protocol),this.fmts=[],this.fmts=e.formats}toLines(){var e=[];return e.push(new mc(this.type,this.port,this.protocol,this.fmts)),this.connection&&e.push(this.connection),this.bandwidth&&e.push(this.bandwidth),e.push(...this.iceInfo.toLines()),this.fingerprint&&e.push(new uc(this.fingerprint)),this.setup&&e.push(new xc(this.setup)),this.mid&&e.push(new gc(this.mid)),this.content&&e.push(this.content),this.sctpPort&&e.push(new Sc(this.sctpPort)),this.maxMessageSize&&e.push(new pc(this.maxMessageSize)),e.push(...this.otherLines),e}addLine(e){if(super.addLine(e))return!0;if(e instanceof mc)throw new Error("Error: tried passing a MediaLine to an existing MediaInfo");return e instanceof Sc?(this.sctpPort=e.port,!0):e instanceof pc?(this.maxMessageSize=e.maxMessageSize,!0):(this.otherLines.push(e),!0)}}class Uc{constructor(e){this.fmtParams=new Map,this.feedback=[],this.pt=e}addLine(e){if(e instanceof wc)return this.name=e.encodingName,this.clockRate=e.clockRate,this.encodingParams=e.encodingParams,!0;if(e instanceof lc){if(this.fmtParams=new Map([...Array.from(this.fmtParams.entries()),...Array.from(e.params.entries())]),e.params.has("apt")){var t=e.params.get("apt");this.primaryCodecPt=parseInt(t,10)}return!0}return e instanceof Ec&&(this.feedback.push(e.feedback),!0)}toLines(){var e=[];return this.name&&this.clockRate&&e.push(new wc(this.pt,this.name,this.clockRate,this.encodingParams)),this.feedback.forEach((t=>{e.push(new Ec(this.pt,t))})),this.fmtParams.size>0&&e.push(new lc(this.pt,this.fmtParams)),e}}class Bc extends Dc{constructor(e){super(e.type,e.port,e.protocol),this.pts=[],this.extMaps=new Map,this.rids=[],this.codecs=new Map,this.rtcpMux=!1,this.ssrcs=[],this.ssrcGroups=[],this.pts=e.formats.map((e=>parseInt(e,10))),this.pts.forEach((e=>this.codecs.set(e,new Uc(e))))}toLines(){var e=[];return e.push(new mc(this.type,this.port,this.protocol,this.pts.map((e=>"".concat(e))))),this.connection&&e.push(this.connection),this.bandwidth&&e.push(this.bandwidth),e.push(...this.iceInfo.toLines()),this.fingerprint&&e.push(new uc(this.fingerprint)),this.setup&&e.push(new xc(this.setup)),this.mid&&e.push(new gc(this.mid)),this.rtcpMux&&e.push(new bc),this.content&&e.push(this.content),this.extMaps.forEach((t=>e.push(t))),this.rids.forEach((t=>e.push(t))),this.simulcast&&e.push(this.simulcast),this.direction&&e.push(new ac(this.direction)),this.codecs.forEach((t=>e.push(...t.toLines()))),e.push(...this.ssrcs),e.push(...this.ssrcGroups),e.push(...this.otherLines),e}addLine(e){if(super.addLine(e))return!0;if(e instanceof mc)throw new Error("Error: tried passing a MediaLine to an existing MediaInfo");if(e instanceof ac)return this.direction=e.direction,!0;if(e instanceof cc){if(this.extMaps.has(e.id))throw new Error("Tried to extension with duplicate ID: an extension already exists with ID ".concat(e.id));return this.extMaps.set(e.id,e),!0}if(e instanceof yc)return this.rids.push(e),!0;if(e instanceof bc)return this.rtcpMux=!0,!0;if(e instanceof Cc)return this.simulcast=e,!0;if(e instanceof wc||e instanceof lc||e instanceof Ec){var t=this.codecs.get(e.payloadType);if(!t)throw new Error("Error: got line for unknown codec: ".concat(e.toSdpLine()));return t.addLine(e),!0}return e instanceof Rc?(this.ssrcs.push(e),!0):e instanceof kc?(this.ssrcGroups.push(e),!0):(this.otherLines.push(e),!0)}getCodecByPt(e){return this.codecs.get(e)}removePt(e){var t=[...this.codecs.values()].filter((t=>t.primaryCodecPt===e)).map((e=>e.pt)),r=[e,...t];r.forEach((e=>{this.codecs.delete(e)})),this.pts=this.pts.filter((e=>-1===r.indexOf(e)))}addExtension(e){var{uri:t,direction:r,attributes:n,id:i}=e,o=i||(()=>{for(var e=1;this.extMaps.has(e);)e+=1;return e})();if(this.extMaps.has(o))throw new Error("Extension with ID ".concat(i," already exists"));if(0===o)throw new Error("Extension ID 0 is reserved");this.extMaps.set(o,new cc(o,t,r,n))}}class Fc{constructor(){this.groups=[],this.otherLines=[]}addLine(e){return e instanceof Nc?(this.version=e,!0):e instanceof vc?(this.origin=e,!0):e instanceof Tc?(this.sessionName=e,!0):e instanceof _c?(this.information=e,!0):e instanceof Oc?(this.timing=e,!0):e instanceof oc?(this.connection=e,!0):e instanceof rc?(this.bandwidth=e,!0):e instanceof nc?(this.groups.push(e),!0):(this.otherLines.push(e),!0)}toLines(){var e=[];return this.version&&e.push(this.version),this.origin&&e.push(this.origin),this.sessionName&&e.push(this.sessionName),this.information&&e.push(this.information),this.connection&&e.push(this.connection),this.bandwidth&&e.push(this.bandwidth),this.timing&&e.push(this.timing),this.groups&&e.push(...this.groups),e.push(...this.otherLines),e}}class jc{constructor(){this.session=new Fc,this.media=[]}get avMedia(){return this.media.filter((e=>e instanceof Bc))}toString(){var e=[];return e.push(...this.session.toLines()),this.media.forEach((t=>e.push(...t.toLines()))),"".concat(e.map((e=>e.toSdpLine())).join("\r\n"),"\r\n")}}class Vc{constructor(){this.parsers=new Map}addParser(e,t){var r=this.parsers.get(e)||[];r.push(t),this.parsers.set(e,r)}getParsers(e){return this.parsers.get(e)||[]}}var Hc,Gc,qc,$c=new class extends Vc{constructor(){super(),this.addParser("v",Nc.fromSdpLine),this.addParser("o",vc.fromSdpLine),this.addParser("c",oc.fromSdpLine),this.addParser("i",_c.fromSdpLine),this.addParser("m",mc.fromSdpLine),this.addParser("s",Tc.fromSdpLine),this.addParser("t",Oc.fromSdpLine),this.addParser("b",rc.fromSdpLine),this.addParser("a",wc.fromSdpLine),this.addParser("a",Ec.fromSdpLine),this.addParser("a",lc.fromSdpLine),this.addParser("a",ac.fromSdpLine),this.addParser("a",cc.fromSdpLine),this.addParser("a",gc.fromSdpLine),this.addParser("a",fc.fromSdpLine),this.addParser("a",hc.fromSdpLine),this.addParser("a",dc.fromSdpLine),this.addParser("a",uc.fromSdpLine),this.addParser("a",xc.fromSdpLine),this.addParser("a",Sc.fromSdpLine),this.addParser("a",pc.fromSdpLine),this.addParser("a",bc.fromSdpLine),this.addParser("a",nc.fromSdpLine),this.addParser("a",sc.fromSdpLine),this.addParser("a",yc.fromSdpLine),this.addParser("a",ic.fromSdpLine),this.addParser("a",Cc.fromSdpLine),this.addParser("a",Rc.fromSdpLine),this.addParser("a",kc.fromSdpLine)}};function Zc(e){return e.length>2}function zc(e){var t=function(e,t){var r=[];return e.split(/(\r\n|\r|\n)/).filter(Zc).forEach((e=>{var n=e[0],i=e.slice(2),o=t.getParsers(n);for(var s of o){var a=s(i);if(a)return void r.push(a)}var c=Pc.fromSdpLine(e);r.push(c)})),r}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:$c),r=function(e){var t=new jc,r=t.session;return e.forEach((e=>{if(e instanceof mc){var n;if("audio"===e.type||"video"===e.type)n=new Bc(e);else{if("application"!==e.type)throw new Error("Unhandled media type: ".concat(e.type));n=new Mc(e)}t.media.push(n),r=n}else r.addLine(e)})),t}(t);return r}function Kc(e,t,r){return{trackOrKind:r||e,direction:t}}function Wc(e){for(var t of e.codecs.values()){var r;if("H264"===(null===(r=t.name)||void 0===r?void 0:r.toUpperCase()))return!0}return!1}class Jc extends tc{constructor(e){super(),z(this,"value",void 0),this.value=e}static fromSdpLine(){}toSdpLine(){return"a=".concat(this.value)}}function Yc(e){e.avMedia.forEach((e=>{e.extMaps.clear()}))}function Qc(e,t){var r=zc(t);return e.disableRtx&&function(e){e.avMedia.forEach((e=>{var t=[];e.codecs.forEach(((e,r)=>{"rtx"===e.name&&e.primaryCodecPt&&t.push(r)})),t.forEach((t=>e.codecs.delete(t))),e.pts=e.pts.filter((e=>!t.includes(e)))}))}(r),r.toString()}function Xc(e,t){var r=zc(t);return e.convertCLineToIPv4&&function(e){var t=e=>{"IP6"===(null==e?void 0:e.addrType)&&(e.addrType="IP4",e.ipAddr="0.0.0.0")};t(e.session.connection),e.media.forEach((e=>{t(e.connection)}))}(r),e.bandwidthLimits&&function(e,t){e.avMedia.forEach((e=>{"audio"===e.type?e.addLine(new rc("TIAS",t.audio)):"video"===e.type&&e.addLine(new rc("TIAS",t.video))}))}(r,e.bandwidthLimits),e.periodicKeyframes&&function(e,t){e.avMedia.forEach((e=>{"video"===e.type&&e.addLine(new Jc("periodic-keyframes:".concat(t)))}))}(r,e.periodicKeyframes),e.convertPort9to0&&function(e){e.media.forEach((e=>{9===e.port&&(e.port=0)}))}(r),e.addContentSlides&&function(e){var t=e.avMedia.filter((e=>"video"===e.type));2===t.length&&t[1].addLine(new sc(["slides"]))}(r),e.disableExtmap&&Yc(r),e.h264MaxFs&&function(e,t){var r={10:99,11:396,12:396,13:396,20:396,21:792,22:1620,30:1620,31:3600,32:5120,40:8192,41:8192,42:8704,50:22080,51:36864,52:36864,60:139264,61:139264,62:139264};e.avMedia.forEach((e=>{"video"===e.type&&e.codecs.forEach((e=>{var n;if("H264"===(null===(n=e.name)||void 0===n?void 0:n.toUpperCase())){var i=e.fmtParams.get("profile-level-id");if(i){var o=i.substring(0,4).toLowerCase(),s=parseInt(i.substring(4,6),16);if(!r[s])throw new Error("found unsupported h264 profile level id value in the SDP: ".concat(s));if(r[s]===t)return;if(r[s]<t)return e.fmtParams.set("max-fs","".concat(t)),void e.fmtParams.set("max-mbps","".concat(30*t));var a=Object.keys(r).reverse().find((e=>r[e]===t));if(a){var c=parseInt(a,10).toString(16);return e.fmtParams.set("profile-level-id","".concat(o).concat(c)),void e.fmtParams.set("max-mbps","".concat(30*t))}throw new Error("unsupported maxFsValue: ".concat(t))}}}))}))}(r,e.h264MaxFs),r.toString()}function eu(e,t){var r=zc(t);return e.startBitrate&&function(e,t){!function(e,t){e.avMedia.forEach((e=>{"video"===e.type&&e.codecs.forEach((e=>{var r;"H264"===(null===(r=e.name)||void 0===r?void 0:r.toUpperCase())&&t.forEach(((t,r)=>e.fmtParams.set(r,t)))}))}))}(e,new Map([["x-google-start-bitrate",t.toString()]]))}(r,e.startBitrate),e.disableExtmap&&Yc(r),function(e){e.media.forEach((e=>{e.iceInfo.candidates=e.iceInfo.candidates.filter((e=>"xtls"!==e.transport.toLowerCase()))}))}(r),r.toString()}function tu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ru(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tu(Object(r),!0).forEach((function(t){z(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e.CONNECTION_STATE_CHANGED="connectionState:changed",e.REMOTE_TRACK_ADDED="remoteTrack:added",e.ROAP_MESSAGE_TO_SEND="roap:messageToSend",e.ROAP_STARTED="roap:started",e.ROAP_FAILURE="roap:failure",e.ROAP_DONE="roap:done",e.DTMF_TONE_CHANGED="dtmfTone:changed",e.ACTIVE_SPEAKERS_CHANGED="activeSpeakers:changed",e.VIDEO_SOURCES_COUNT_CHANGED="videoSourcesCount:changed",e.AUDIO_SOURCES_COUNT_CHANGED="audioSourcesCount:changed",e.REMOTE_SDP_ANSWER_PROCESSED="remoteSdpAnswer:processed",e.REMOTE_SDP_OFFER_PROCESSED="remoteSdpOffer:processed",e.LOCAL_SDP_OFFER_GENERATED="localSdpOffer:processed",e.LOCAL_SDP_ANSWER_GENERATED="localSdpAnswer:processed"}(Hc||(Hc={})),function(e){e.AUDIO="audio",e.VIDEO="video",e.SCREENSHARE_VIDEO="screenShareVideo"}(Gc||(Gc={})),function(e){e.DOUBLECONFLICT="DOUBLECONFLICT",e.CONFLICT="CONFLICT",e.FAILED="FAILED",e.INVALID_STATE="INVALID_STATE",e.NOMATCH="NOMATCH",e.OUT_OF_ORDER="OUT_OF_ORDER",e.REFUSED="REFUSED",e.RETRY="RETRY",e.TIMEOUT="TIMEOUT"}(qc||(qc={}));var nu=[{type:"audio",kind:"audio"},{type:"video",kind:"video"},{type:"screenShareVideo",kind:"video"}];class iu extends Te{constructor(e,t,r){super(),z(this,"id",void 0),z(this,"config",void 0),z(this,"pc",void 0),z(this,"localTracks",void 0),z(this,"transceivers",void 0),z(this,"mediaDirection",void 0),z(this,"remoteQualityLevel",void 0),z(this,"mediaConnectionState",void 0),z(this,"lastEmittedMediaConnectionState",void 0),this.config=e,this.mediaDirection=ru({},t.direction),this.localTracks=ru({},t.localTracks),this.remoteQualityLevel=t.remoteQualityLevel,this.id=r||"MediaConnection",this.transceivers={},this.mediaConnectionState=ar.New,this.pc=new window.RTCPeerConnection({iceServers:this.config.iceServers,bundlePolicy:"max-compat"}),this.pc.ontrack=this.onTrack.bind(this),this.pc.oniceconnectionstatechange=this.onIceConnectionStateChange.bind(this),this.pc.onconnectionstatechange=this.onConnectionStateChange.bind(this)}log(e,t){Ka().info("".concat(this.id,":").concat(e," ").concat(t))}warn(e,t){Ka().warn("".concat(this.id,":").concat(e," ").concat(t))}error(e,t,r){Ka().error("".concat(this.id,":").concat(e," ").concat(t," ").concat(Ja(r)))}createTransceivers(){nu.forEach((e=>{var{type:t,kind:r}=e,n=t,i=t,o=Kc(r,this.mediaDirection[n],this.localTracks[n]);this.config.skipInactiveTransceivers&&"inactive"===o.direction||(this.transceivers[i]=this.pc.addTransceiver(o.trackOrKind,{direction:o.direction}))})),this.setupTransceiverListeners()}initializeTransceivers(e){if(this.pc.getTransceivers().length>0)throw this.error("initiateOffer()","SDP negotiation already started"),new Error("SDP negotiation already started");e?this.addLocalTracks():this.createTransceivers()}close(){this.pc.close(),this.pc.ontrack=null,this.pc.oniceconnectionstatechange=null,this.pc.onconnectionstatechange=null,this.pc.onicegatheringstatechange=null,this.pc.onicecandidate=null,this.pc.onicecandidateerror=null}getConfig(){return this.config}getSendReceiveOptions(){return{localTracks:this.localTracks,direction:this.mediaDirection,remoteQualityLevel:this.remoteQualityLevel}}updateRemoteQualityLevel(e){return e!==this.remoteQualityLevel&&(this.remoteQualityLevel=e,!0)}updateTransceivers(e){var t=!1;return this.mediaDirection.audio=e.direction.audio,this.mediaDirection.video=e.direction.video,this.mediaDirection.screenShareVideo=e.direction.screenShareVideo,this.identifyTransceivers(),nu.forEach((r=>{var{type:n,kind:i}=r,o=n,s=n,a=e.localTracks[o],c=this.transceivers[s];if(void 0!==a&&a!==this.localTracks[o]&&(this.localTracks[o]=a,c&&(this.log("updateTransceivers()",'replacing sender track on "'.concat(n,'" transceiver')),c.sender.replaceTrack(a))),c){var u=Kc(i,this.mediaDirection[o],this.localTracks[o]);c.direction!==u.direction&&(this.log("updateTransceivers()","updating direction to ".concat(u.direction,' on "').concat(n,'" transceiver')),c.direction=u.direction,t=!0)}})),t}updateLocalTracks(e){return this.updateTransceivers({localTracks:e,direction:ru({},this.mediaDirection)})}updateDirection(e){return this.updateTransceivers({localTracks:this.localTracks,direction:e})}update(e){var t=!1;return this.updateRemoteQualityLevel(e.remoteQualityLevel)&&(t=!0),this.updateTransceivers(e)&&(t=!0),t}getConnectionState(){return this.log("getConnectionState()","called, returning ".concat(this.mediaConnectionState)),this.mediaConnectionState}getStats(){return this.pc.getStats()}getTransceiverStats(){var e=this;return q((function*(){var t={audio:{senders:[],receivers:[]},video:{senders:[],receivers:[]},screenShareAudio:{senders:[],receivers:[]},screenShareVideo:{senders:[],receivers:[]}},r=function*(r){var n=e.transceivers[r];n&&(yield n.sender.getStats().then((e=>{var i,o;t[r].senders.push({report:e,currentDirection:n.currentDirection,localTrackLabel:null===(i=n.sender)||void 0===i||null===(o=i.track)||void 0===o?void 0:o.label})})),yield n.receiver.getStats().then((e=>{var i,o;t[r].receivers.push({report:e,currentDirection:n.currentDirection,localTrackLabel:null===(i=n.sender)||void 0===i||null===(o=i.track)||void 0===o?void 0:o.label})})))};for(var{type:n}of nu)yield*r(n);return t}))()}insertDTMF(e,t,r){if(!this.transceivers.audio)throw new Error("audio transceiver missing");if(!this.transceivers.audio.sender)throw new Error("this.transceivers.audio.sender is null");if(!this.transceivers.audio.sender.dtmf)throw new Error("this.transceivers.audio.sender.dtmf is null");this.transceivers.audio.sender.dtmf.insertDTMF(e.toUpperCase(),t,r)}setupTransceiverListeners(){var e,t;null!==(e=this.transceivers.audio)&&void 0!==e&&null!==(t=e.sender)&&void 0!==t&&t.dtmf&&(this.transceivers.audio.sender.dtmf.ontonechange=this.onToneChange.bind(this))}onToneChange(e){this.log("onToneChange()",'emitting Event.DTMF_TONE_CHANGED with tone="'.concat(e.tone,'"')),this.emit(Hc.DTMF_TONE_CHANGED,{tone:e.tone})}identifyTransceivers(){if(!this.transceivers.audio&&!this.transceivers.video&&!this.transceivers.screenShareVideo){var e=this.pc.getTransceivers();this.log("identifyTransceivers()","transceivers.length=".concat(e.length)),e.forEach(((e,t)=>{this.log("identifyTransceivers()","transceiver[".concat(t,"].mid=").concat(e.mid))})),[this.transceivers.audio,this.transceivers.video,this.transceivers.screenShareVideo]=e,this.setupTransceiverListeners()}}onTrack(e){var t,r,n,i,o,s,a,c,u,l;this.log("onTrack()","callback called: event=".concat(JSON.stringify(e)));var d="0",h="1",f="2",{track:p}=e,m=null;switch(this.identifyTransceivers(),null!==(t=e.transceiver)&&void 0!==t&&t.mid?(this.log("onTrack()","identifying track by event.transceiver.mid"),m=e.transceiver.mid):m=p.id===(null===(r=this.transceivers.audio)||void 0===r||null===(n=r.receiver)||void 0===n||null===(i=n.track)||void 0===i?void 0:i.id)?d:p.id===(null===(o=this.transceivers.video)||void 0===o||null===(s=o.receiver)||void 0===s||null===(a=s.track)||void 0===a?void 0:a.id)?h:p.id===(null===(c=this.transceivers.screenShareVideo)||void 0===c||null===(u=c.receiver)||void 0===u||null===(l=u.track)||void 0===l?void 0:l.id)?f:null,this.log("onTrack()","trackMediaID=".concat(m)),m){case d:this.log("onTrack()","emitting Event.REMOTE_TRACK_ADDED with type=AUDIO"),this.emit(Hc.REMOTE_TRACK_ADDED,{type:Gc.AUDIO,track:p});break;case h:this.log("onTrack()","emitting Event.REMOTE_TRACK_ADDED with type=VIDEO"),this.emit(Hc.REMOTE_TRACK_ADDED,{type:Gc.VIDEO,track:p});break;case f:this.log("onTrack()","emitting Event.REMOTE_TRACK_ADDED with type=SCREENSHARE_VIDEO"),this.emit(Hc.REMOTE_TRACK_ADDED,{type:Gc.SCREENSHARE_VIDEO,track:p});break;default:this.error("onTrack()","failed to match remote track media id: ".concat(m))}}addLocalTracks(){this.log("addLocalTracks()","adding tracks ".concat(JSON.stringify(this.localTracks))),this.localTracks.audio&&this.pc.addTrack(this.localTracks.audio),this.localTracks.video&&this.pc.addTrack(this.localTracks.video),this.localTracks.screenShareVideo&&this.pc.addTrack(this.localTracks.screenShareVideo)}onConnectionStateChange(){this.log("onConnectionStateChange()","callback called: connectionState=".concat(this.pc.connectionState)),this.evaluateMediaConnectionState()}onIceConnectionStateChange(){this.log("onIceConnectionStateChange()","callback called: iceConnectionState=".concat(this.pc.iceConnectionState)),this.evaluateMediaConnectionState()}evaluateMediaConnectionState(){var e=this.pc.connectionState,t=this.pc.iceConnectionState,r=[e,t];r.some((e=>"closed"===e))?this.mediaConnectionState=ar.Closed:r.some((e=>"failed"===e))?this.mediaConnectionState=ar.Failed:r.some((e=>"disconnected"===e))?this.mediaConnectionState=ar.Disconnected:r.every((e=>"connected"===e||"completed"===e))?this.mediaConnectionState=ar.Connected:this.mediaConnectionState=ar.Connecting,this.log("evaluateConnectionState","iceConnectionState=".concat(t," rtcPcConnectionState=").concat(e," => mediaConnectionState=").concat(this.mediaConnectionState)),this.lastEmittedMediaConnectionState!==this.mediaConnectionState&&(this.emit(Hc.CONNECTION_STATE_CHANGED,{state:this.mediaConnectionState}),this.lastEmittedMediaConnectionState=this.mediaConnectionState)}createSdpMungingConfig(){if(this.remoteQualityLevel){var e={LOW:1620,MEDIUM:3600,HIGH:8192};if(!e[this.remoteQualityLevel])throw new Error("invalid value for receiveOptions.remoteQualityLevel: ".concat(this.remoteQualityLevel));return this.config.sdpMunging.h264MaxFs&&this.warn("createSdpMungingConfig","conflict: both config.sdpMunging.h264MaxFs and receiveOptions.remoteQualityLevel are set, remoteQualityLevel will override the config"),ru(ru({},this.config.sdpMunging),{},{h264MaxFs:e[this.remoteQualityLevel]})}return this.config.sdpMunging}createLocalOffer(){var e=this.createSdpMungingConfig();return this.pc.createOffer().then((t=>{this.log("createLocalOffer","local SDP offer created");var r={type:t.type,sdp:Qc(e,(null==t?void 0:t.sdp)||"")};return this.pc.setLocalDescription(r)})).then((()=>this.waitForIceCandidates())).then((()=>{var t,r=Xc(e,(null===(t=this.pc.localDescription)||void 0===t?void 0:t.sdp)||"");return this.emit(Hc.LOCAL_SDP_OFFER_GENERATED),{sdp:r}})).catch((e=>{throw e instanceof ge||e instanceof pe?e:new Ee("createLocalOffer() failure: ".concat(e.message),{cause:e})}))}handleRemoteOffer(e){if(this.log("handleRemoteOffer","called"),!e)return Promise.reject(new Se("SDP missing"));var t=eu(this.config.sdpMunging,e),r=this.createSdpMungingConfig();return this.pc.setRemoteDescription(new window.RTCSessionDescription({type:"offer",sdp:t})).then((()=>this.emit(Hc.REMOTE_SDP_OFFER_PROCESSED))).then((()=>this.pc.createAnswer())).then((e=>{var t={type:e.type,sdp:Qc(r,(null==e?void 0:e.sdp)||"")};return this.pc.setLocalDescription(t)})).then((()=>this.waitForIceCandidates())).then((()=>{var e,t=Xc(r,(null===(e=this.pc.localDescription)||void 0===e?void 0:e.sdp)||"");return this.emit(Hc.LOCAL_SDP_ANSWER_GENERATED),{sdp:t}})).catch((e=>{throw e instanceof ge||e instanceof pe?e:new Se("handleRemoteOffer() failure: ".concat(e.message),{cause:e})}))}handleRemoteAnswer(e){if(this.log("handleRemoteAnswer","called"),!e)return Promise.reject(new ye("SDP answer missing"));var t=eu(this.config.sdpMunging,e);return this.pc.setRemoteDescription(new window.RTCSessionDescription({type:"answer",sdp:t})).then((e=>(this.emit(Hc.REMOTE_SDP_ANSWER_PROCESSED),e))).catch((e=>{throw new ye("handleRemoteAnswer() failure: ".concat(e.message),{cause:e})}))}waitForIceCandidates(){return new Promise(((e,t)=>{var r=performance.now(),n=!1,i=()=>{var e;return function(e,t){if(!t)return new Error("SDP is missing");var r=zc(t);for(var n of r.avMedia){if(!n.iceInfo.candidates.length)return new ge("ice candidates missing for m-line with mid=".concat(n.mid));if(!e.allowPort0&&0===n.port)return new pe("Found invalid port number 0 at m-line with mid=".concat(n.mid));if(!n.iceInfo.pwd||!n.iceInfo.ufrag)return new ge("ice ufrag and password not found for m-line with mid=".concat(n.mid));if(e.requireH264&&"video"===n.type&&!Wc(n))return new pe("H264 codec is missing for video media description with mid=".concat(n.mid))}return!1}({allowPort0:!!this.config.sdpMunging.convertPort9to0,requireH264:!!this.config.requireH264},null===(e=this.pc.localDescription)||void 0===e?void 0:e.sdp)},o=()=>{if(!n){var o=performance.now()-r;this.log("waitForIceCandidates()","checking SDP...");var s=i();s&&(this.error("waitForIceCandidates()","SDP not valid after waiting: ".concat(s.message)),t(s)),this.log("waitForIceCandidates()","It took ".concat(o," milliseconds to gather ice candidates")),n=!0,this.pc.onicegatheringstatechange=null,this.pc.onicecandidate=null,this.pc.onicecandidateerror=null,e()}};if("complete"===this.pc.iceGatheringState&&!1===i())return this.log("waitForIceCandidates()",'iceGatheringState is already "complete" and local SDP is valid'),void e();this.log("waitForIceCandidates()","waiting for ICE candidates to be gathered..."),this.pc.onicegatheringstatechange=()=>{this.log("waitForIceCandidates()","iceGatheringState changed to ".concat(this.pc.iceGatheringState)),"complete"===this.pc.iceGatheringState&&o()},this.pc.onicecandidate=e=>{var t,r;null===e.candidate?(this.log("waitForIceCandidates()","evt.candidate === null received"),o()):this.log("waitForIceCandidates()","ICE Candidate(".concat(null===(t=e.candidate)||void 0===t?void 0:t.sdpMLineIndex,"): ").concat(null===(r=e.candidate)||void 0===r?void 0:r.candidate))},this.pc.onicecandidateerror=e=>{this.warn("waitForIceCandidates()","onicecandidateerror: ".concat(e))}}))}}var ou=!0,su=!0;function au(e,t,r){var n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}function cu(e,t,r){if(e.RTCPeerConnection){var n=e.RTCPeerConnection.prototype,i=n.addEventListener;n.addEventListener=function(e,n){if(e!==t)return i.apply(this,arguments);var o=e=>{var t=r(e);t&&(n.handleEvent?n.handleEvent(t):n(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(n,o),i.apply(this,[e,o])};var o=n.removeEventListener;n.removeEventListener=function(e,r){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(r))return o.apply(this,arguments);var n=this._eventMap[t].get(r);return this._eventMap[t].delete(r),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,n])},Object.defineProperty(n,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}}function uu(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(ou=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function lu(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(su=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function du(){if("object"==typeof window){if(ou)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function hu(e,t){su&&console.warn(e+" is deprecated, please use "+t+" instead.")}function fu(e){return"[object Object]"===Object.prototype.toString.call(e)}function pu(e){return fu(e)?Object.keys(e).reduce((function(t,r){var n=fu(e[r]),i=n?pu(e[r]):e[r],o=n&&!Object.keys(i).length;return void 0===i||o?t:Object.assign(t,{[r]:i})}),{}):e}function mu(e,t,r){t&&!r.has(t.id)&&(r.set(t.id,t),Object.keys(t).forEach((n=>{n.endsWith("Id")?mu(e,e.get(t[n]),r):n.endsWith("Ids")&&t[n].forEach((t=>{mu(e,e.get(t),r)}))})))}function gu(e,t,r){var n=r?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;var o=[];return e.forEach((e=>{"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((t=>{e.forEach((r=>{r.type===n&&r.trackId===t.id&&mu(e,r,i)}))})),i}var vu=du;function yu(e,t){var r=e&&e.navigator;if(r.mediaDevices){var n=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((r=>{if("require"!==r&&"advanced"!==r&&"mediaSource"!==r){var n="object"==typeof e[r]?e[r]:{ideal:e[r]};void 0!==n.exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==n.ideal){t.optional=t.optional||[];var o={};"number"==typeof n.ideal?(o[i("min",r)]=n.ideal,t.optional.push(o),(o={})[i("max",r)]=n.ideal,t.optional.push(o)):(o[i("",r)]=n.ideal,t.optional.push(o))}void 0!==n.exact&&"number"!=typeof n.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",r)]=n.exact):["min","max"].forEach((e=>{void 0!==n[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,r)]=n[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},i=function(e,i){if(t.version>=61)return i(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){var o=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])};o((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),o(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=n(e.audio)}if(e&&"object"==typeof e.video){var s=e.video.facingMode;s=s&&("object"==typeof s?s:{ideal:s});var a,c=t.version<66;if(s&&("user"===s.exact||"environment"===s.exact||"user"===s.ideal||"environment"===s.ideal)&&(!r.mediaDevices.getSupportedConstraints||!r.mediaDevices.getSupportedConstraints().facingMode||c))if(delete e.video.facingMode,"environment"===s.exact||"environment"===s.ideal?a=["back","rear"]:"user"!==s.exact&&"user"!==s.ideal||(a=["front"]),a)return r.mediaDevices.enumerateDevices().then((t=>{var r=(t=t.filter((e=>"videoinput"===e.kind))).find((e=>a.some((t=>e.label.toLowerCase().includes(t)))));return!r&&t.length&&a.includes("back")&&(r=t[t.length-1]),r&&(e.video.deviceId=s.exact?{exact:r.deviceId}:{ideal:r.deviceId}),e.video=n(e.video),vu("chrome: "+JSON.stringify(e)),i(e)}));e.video=n(e.video)}return vu("chrome: "+JSON.stringify(e)),i(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(r.getUserMedia=function(e,t,n){i(e,(e=>{r.webkitGetUserMedia(e,t,(e=>{n&&n(o(e))}))}))}.bind(r),r.mediaDevices.getUserMedia){var s=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(e){return i(e,(e=>s(e).then((t=>{if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((e=>{e.stop()})),new DOMException("","NotFoundError");return t}),(e=>Promise.reject(o(e))))))}}}}function bu(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function Eu(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",(r=>{var n;n=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===r.track.id)):{track:r.track};var i=new Event("track");i.track=r.track,i.receiver=n,i.transceiver={receiver:n},i.streams=[t.stream],this.dispatchEvent(i)})),t.stream.getTracks().forEach((r=>{var n;n=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===r.id)):{track:r};var i=new Event("track");i.track=r,i.receiver=n,i.transceiver={receiver:n},i.streams=[t.stream],this.dispatchEvent(i)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else cu(e,"track",(e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e)))}function wu(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){var i=r.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){n.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((e=>{this._senders.push(t(this,e))}))};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach((e=>{var t=this._senders.find((t=>t.track===e));t&&this._senders.splice(this._senders.indexOf(t),1)}))}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var s=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=s.apply(this,[]);return e.forEach((e=>e._pc=this)),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Su(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var[e,r,n]=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof e))return t.apply(this,[]);var i=function(e){var t={};return e.result().forEach((e=>{var r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((t=>{r[t]=e.stat(t)})),t[r.id]=r})),t},o=function(e){return new Map(Object.keys(e).map((t=>[t,e[t]])))};if(arguments.length>=2){return t.apply(this,[function(e){r(o(i(e)))},e])}return new Promise(((e,r)=>{t.apply(this,[function(t){e(o(i(t)))},r])})).then(r,n)}}}function _u(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((t=>gu(t,e.track,!0)))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var n=e.RTCPeerConnection.prototype.getReceivers;n&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=n.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),cu(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((t=>gu(t,e.track,!1)))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t,r,n,o=arguments[0];return this.getSenders().forEach((e=>{e.track===o&&(t?n=!0:t=e)})),this.getReceivers().forEach((e=>(e.track===o&&(r?n=!0:r=e),e.track===o))),n||t&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return i.apply(this,arguments)}}}}function Tu(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((e=>this._shimmedLocalStreams[e][0]))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var n=t.apply(this,arguments);return this._shimmedLocalStreams[r.id]?-1===this._shimmedLocalStreams[r.id].indexOf(n)&&this._shimmedLocalStreams[r.id].push(n):this._shimmedLocalStreams[r.id]=[r,n],n};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")}));var t=this.getSenders();r.apply(this,arguments);var n=this.getSenders().filter((e=>-1===t.indexOf(e)));this._shimmedLocalStreams[e.id]=[e].concat(n)};var n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],n.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((t=>{var r=this._shimmedLocalStreams[t].indexOf(e);-1!==r&&this._shimmedLocalStreams[t].splice(r,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]})),i.apply(this,arguments)}}function xu(e,t){if(e.RTCPeerConnection){if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return Tu(e);var r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=r.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((e=>this._reverseStreams[e.id]))};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var r=new e.MediaStream(t.getTracks());this._streams[t.id]=r,this._reverseStreams[r.id]=t,t=r}n.apply(this,[t])};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,r){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var n=[].slice.call(arguments,1);if(1!==n.length||!n[0].getTracks().find((e=>e===t)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((e=>e.track===t)))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var i=this._streams[r.id];if(i)i.addTrack(t),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{var o=new e.MediaStream([t]);this._streams[r.id]=o,this._reverseStreams[o.id]=r,this.addStream(o)}return this.getSenders().find((e=>e.track===t))},["createOffer","createAnswer"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t],n={[t](){var e=arguments;return arguments.length&&"function"==typeof arguments[0]?r.apply(this,[t=>{var r=a(this,t);e[0].apply(null,[r])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):r.apply(this,arguments).then((e=>a(this,e)))}};e.RTCPeerConnection.prototype[t]=n[t]}));var o=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{var n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(n.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:r})}(this,arguments[0]),o.apply(this,arguments)):o.apply(this,arguments)};var s=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){var e=s.get.apply(this);return""===e.type?e:a(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");var t;if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach((r=>{this._streams[r].getTracks().find((t=>e.track===t))&&(t=this._streams[r])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function a(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{var n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(i.id,"g"),n.id)})),new RTCSessionDescription({type:t.type,sdp:r})}}function Au(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t],n={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=n[t]}))}function Iu(e,t){cu(e,"negotiationneeded",(e=>{var r=e.target;if(!(t.version<72||r.getConfiguration&&"plan-b"===r.getConfiguration().sdpSemantics)||"stable"===r.signalingState)return e}))}var Cu=Object.freeze({__proto__:null,shimMediaStream:bu,shimOnTrack:Eu,shimGetSendersWithDtmf:wu,shimGetStats:Su,shimSenderReceiverGetStats:_u,shimAddTrackRemoveTrackWithNative:Tu,shimAddTrackRemoveTrack:xu,shimPeerConnection:Au,fixNegotiationNeeded:Iu,shimGetUserMedia:yu,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then((t=>{var n=r.video&&r.video.width,i=r.video&&r.video.height,o=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},n&&(r.video.mandatory.maxWidth=n),i&&(r.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(r)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}});function Ru(e,t){var r=e&&e.navigator,n=e&&e.MediaStreamTrack;if(r.getUserMedia=function(e,t,n){hu("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(e).then(t,n)},!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){var i=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])},o=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(e){return"object"==typeof e&&"object"==typeof e.audio&&(e=JSON.parse(JSON.stringify(e)),i(e.audio,"autoGainControl","mozAutoGainControl"),i(e.audio,"noiseSuppression","mozNoiseSuppression")),o(e)},n&&n.prototype.getSettings){var s=n.prototype.getSettings;n.prototype.getSettings=function(){var e=s.apply(this,arguments);return i(e,"mozAutoGainControl","autoGainControl"),i(e,"mozNoiseSuppression","noiseSuppression"),e}}if(n&&n.prototype.applyConstraints){var a=n.prototype.applyConstraints;n.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"==typeof e&&(e=JSON.parse(JSON.stringify(e)),i(e,"autoGainControl","mozAutoGainControl"),i(e,"noiseSuppression","mozNoiseSuppression")),a.apply(this,[e])}}}}function ku(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Ou(e,t){if("object"==typeof e&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t],n={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=n[t]}));var r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var[e,i,o]=arguments;return n.apply(this,[e||null]).then((e=>{if(t.version<53&&!i)try{e.forEach((e=>{e.type=r[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach(((t,n)=>{e.set(n,Object.assign({},t,{type:r[t.type]||t.type}))}))}return e})).then(i,o)}}}function Nu(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpSender.prototype))){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}}function Pu(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpReceiver.prototype))){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),cu(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}}function Lu(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){hu("removeStream","removeTrack"),this.getSenders().forEach((t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)}))})}function Du(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function Mu(e){if("object"==typeof e&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1]&&arguments[1].sendEncodings;void 0===e&&(e=[]);var r=(e=[...e]).length>0;r&&e.forEach((e=>{if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var n=t.apply(this,arguments);if(r){var{sender:i}=n,o=i.getParameters();(!("encodings"in o)||1===o.encodings.length&&0===Object.keys(o.encodings[0]).length)&&(o.encodings=e,i.sendEncodings=e,this.setParametersPromises.push(i.setParameters(o).then((()=>{delete i.sendEncodings})).catch((()=>{delete i.sendEncodings}))))}return n})}}function Uu(e){if("object"==typeof e&&e.RTCRtpSender){var t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){var e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}}function Bu(e){if("object"==typeof e&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}}function Fu(e){if("object"==typeof e&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}}var ju=Object.freeze({__proto__:null,shimOnTrack:ku,shimPeerConnection:Ou,shimSenderGetStats:Nu,shimReceiverGetStats:Pu,shimRemoveStream:Lu,shimRTCDataChannel:Du,shimAddTransceiver:Mu,shimGetParameters:Uu,shimCreateOffer:Bu,shimCreateAnswer:Fu,shimGetUserMedia:Ru,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){var n=new DOMException("getDisplayMedia without video constraints is undefined");return n.name="NotFoundError",n.code=8,Promise.reject(n)}return!0===r.video?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)})}});function Vu(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((r=>t.call(this,r,e))),e.getVideoTracks().forEach((r=>t.call(this,r,e)))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n&&n.forEach((e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);var t=this._localStreams.indexOf(e);if(-1!==t){this._localStreams.splice(t,1);var r=e.getTracks();this.getSenders().forEach((e=>{r.includes(e.track)&&this.removeTrack(e)}))}})}}function Hu(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach((e=>{if(this._remoteStreams||(this._remoteStreams=[]),!this._remoteStreams.includes(e)){this._remoteStreams.push(e);var t=new Event("addstream");t.stream=e,this.dispatchEvent(t)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((t=>{if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var r=new Event("addstream");r.stream=t,e.dispatchEvent(r)}}))}),t.apply(e,arguments)}}}function Gu(e){if("object"==typeof e&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,r=t.createOffer,n=t.createAnswer,i=t.setLocalDescription,o=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i};var a=function(e,t,r){var n=i.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n};t.setLocalDescription=a,a=function(e,t,r){var n=o.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.setRemoteDescription=a,a=function(e,t,r){var n=s.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.addIceCandidate=a}}function qu(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var r=t.mediaDevices,n=r.getUserMedia.bind(r);t.mediaDevices.getUserMedia=e=>n($u(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,r,n){t.mediaDevices.getUserMedia(e).then(r,n)}.bind(t))}function $u(e){return e&&void 0!==e.video?Object.assign({},e,{video:pu(e.video)}):e}function Zu(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,r){if(e&&e.iceServers){for(var n=[],i=0;i<e.iceServers.length;i++){var o=e.iceServers[i];!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")?(hu("RTCIceServer.url","RTCIceServer.urls"),(o=JSON.parse(JSON.stringify(o))).urls=o.url,delete o.url,n.push(o)):n.push(e.iceServers[i])}e.iceServers=n}return new t(e,r)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}}function zu(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Ku(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var r=this.getTransceivers().find((e=>"audio"===e.receiver.track.kind));!1===e.offerToReceiveAudio&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveAudio||r||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var n=this.getTransceivers().find((e=>"video"===e.receiver.track.kind));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function Wu(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var Ju=Object.freeze({__proto__:null,shimLocalStreamsAPI:Vu,shimRemoteStreamsAPI:Hu,shimCallbacksAPI:Gu,shimGetUserMedia:qu,shimConstraints:$u,shimRTCIceServerUrls:Zu,shimTrackEventTransceiver:zu,shimCreateOfferLegacy:Ku,shimAudioContext:Wu}),Yu={exports:{}};!function(e){var t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((e=>e.trim()))},t.splitSections=function(e){return e.split("\nm=").map(((e,t)=>(t>0?"m="+e:e).trim()+"\r\n"))},t.getDescription=function(e){var r=t.splitSections(e);return r&&r[0]},t.getMediaSections=function(e){var r=t.splitSections(e);return r.shift(),r},t.matchPrefix=function(e,r){return t.splitLines(e).filter((e=>0===e.indexOf(r)))},t.parseCandidate=function(e){for(var t,r={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},n=8;n<t.length;n+=2)switch(t[n]){case"raddr":r.relatedAddress=t[n+1];break;case"rport":r.relatedPort=parseInt(t[n+1],10);break;case"tcptype":r.tcpType=t[n+1];break;case"ufrag":r.ufrag=t[n+1],r.usernameFragment=t[n+1];break;default:void 0===r[t[n]]&&(r[t[n]]=t[n+1])}return r},t.writeCandidate=function(e){var t=[];t.push(e.foundation);var r=e.component;"rtp"===r?t.push(1):"rtcp"===r?t.push(2):t.push(r),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){var t=e.substr(9).split(" "),r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.channels=3===t.length?parseInt(t[2],10):1,r.numChannels=r.channels,r},t.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},t.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){for(var t,r={},n=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<n.length;i++)r[(t=n[i].trim().split("="))[0].trim()]=t[1];return r},t.writeFmtp=function(e){var t="",r=e.payloadType;if(void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var n=[];Object.keys(e.parameters).forEach((t=>{void 0!==e.parameters[t]?n.push(t+"="+e.parameters[t]):n.push(t)})),t+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){var t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((e=>{t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:parseInt(e.substr(7,t-7),10)},n=e.indexOf(":",t);return n>-1?(r.attribute=e.substr(t+1,n-t-1),r.value=e.substr(n+1)):r.attribute=e.substr(t+1),r},t.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((e=>parseInt(e,10)))}},t.getMid=function(e){var r=t.matchPrefix(e,"a=mid:")[0];if(r)return r.substr(6)},t.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,r){return{role:"auto",fingerprints:t.matchPrefix(e+r,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";return e.fingerprints.forEach((e=>{r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),r},t.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,r){return t.matchPrefix(e+r,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,r){var n=t.matchPrefix(e+r,"a=ice-ufrag:")[0],i=t.matchPrefix(e+r,"a=ice-pwd:")[0];return n&&i?{usernameFragment:n.substr(12),password:i.substr(10)}:null},t.writeIceParameters=function(e){var t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){for(var r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=t.splitLines(e)[0].split(" "),i=3;i<n.length;i++){var o=n[i],s=t.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(s){var a=t.parseRtpMap(s),c=t.matchPrefix(e,"a=fmtp:"+o+" ");switch(a.parameters=c.length?t.parseFmtp(c[0]):{},a.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(t.parseRtcpFb),r.codecs.push(a),a.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(a.name.toUpperCase())}}}return t.matchPrefix(e,"a=extmap:").forEach((e=>{r.headerExtensions.push(t.parseExtmap(e))})),r},t.writeRtpDescription=function(e,r){var n="";n+="m="+e+" ",n+=r.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=r.codecs.map((e=>void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType)).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",r.codecs.forEach((e=>{n+=t.writeRtpMap(e),n+=t.writeFmtp(e),n+=t.writeRtcpFb(e)}));var i=0;return r.codecs.forEach((e=>{e.maxptime>i&&(i=e.maxptime)})),i>0&&(n+="a=maxptime:"+i+"\r\n"),r.headerExtensions&&r.headerExtensions.forEach((e=>{n+=t.writeExtmap(e)})),n},t.parseRtpEncodingParameters=function(e){var r,n=[],i=t.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),s=-1!==i.fecMechanisms.indexOf("ULPFEC"),a=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute)),c=a.length>0&&a[0].ssrc,u=t.matchPrefix(e,"a=ssrc-group:FID").map((e=>e.substr(17).split(" ").map((e=>parseInt(e,10)))));u.length>0&&u[0].length>1&&u[0][0]===c&&(r=u[0][1]),i.codecs.forEach((e=>{if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&r&&(t.rtx={ssrc:r}),n.push(t),o&&((t=JSON.parse(JSON.stringify(t))).fec={ssrc:c,mechanism:s?"red+ulpfec":"red"},n.push(t))}})),0===n.length&&c&&n.push({ssrc:c});var l=t.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,n.forEach((e=>{e.maxBitrate=l}))),n},t.parseRtcpParameters=function(e){var r={},n=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute))[0];n&&(r.cname=n.value,r.ssrc=n.ssrc);var i=t.matchPrefix(e,"a=rtcp-rsize");r.reducedSize=i.length>0,r.compound=0===i.length;var o=t.matchPrefix(e,"a=rtcp-mux");return r.mux=o.length>0,r},t.writeRtcpParameters=function(e){var t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){var r,n=t.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(r=n[0].substr(7).split(" "))[0],track:r[1]};var i=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"msid"===e.attribute));return i.length>0?{stream:(r=i[0].value.split(" "))[0],track:r[1]}:void 0},t.parseSctpDescription=function(e){var r,n=t.parseMLine(e),i=t.matchPrefix(e,"a=max-message-size:");i.length>0&&(r=parseInt(i[0].substr(19),10)),isNaN(r)&&(r=65536);var o=t.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:n.fmt,maxMessageSize:r};var s=t.matchPrefix(e,"a=sctpmap:");if(s.length>0){var a=s[0].substr(10).split(" ");return{port:parseInt(a[0],10),protocol:a[1],maxMessageSize:r}}},t.writeSctpDescription=function(e,t){var r=[];return r="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&r.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),r.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,r,n){var i=void 0!==r?r:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||t.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,r){for(var n=t.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return r?t.getDirection(r):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){var r=t.splitLines(e)[0].substr(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}},t.parseOLine=function(e){var r=t.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var r=t.splitLines(e),n=0;n<r.length;n++)if(r[n].length<2||"="!==r[n].charAt(1))return!1;return!0},e.exports=t}(Yu);var Qu=Yu.exports,Xu=K({__proto__:null,default:Qu},[Yu.exports]);function el(e){if(!(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var r=new t(e),n=Qu.parseCandidate(e.candidate),i=Object.assign(r,n);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,cu(e,"icecandidate",(t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t)))}}function tl(e,t){if(e.RTCPeerConnection){"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){var{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;var t=Qu.splitSections(e.sdp);return t.shift(),t.some((e=>{var t=Qu.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){var n,i=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var r=parseInt(t[1],10);return r!=r?-1:r}(arguments[0]),o=(c=i,u=65536,"firefox"===t.browser&&(u=t.version<57?-1===c?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),u),s=function(e,r){var n=65536;"firefox"===t.browser&&57===t.version&&(n=65535);var i=Qu.matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?n=parseInt(i[0].substr(19),10):"firefox"===t.browser&&-1!==r&&(n=2147483637),n}(arguments[0],i);n=0===o&&0===s?Number.POSITIVE_INFINITY:0===o||0===s?Math.max(o,s):Math.min(o,s);var a={};Object.defineProperty(a,"maxMessageSize",{get:()=>n}),this._sctp=a}var c,u;return r.apply(this,arguments)}}}function rl(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return r(e,this),e},cu(e,"datachannel",(e=>(r(e.channel,e.target),e)))}function r(e,t){var r=e.send;e.send=function(){var n=arguments[0],i=n.length||n.size||n.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return r.apply(e,arguments)}}}function nl(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((e=>{var r=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var r=new Event("connectionstatechange",e);t.dispatchEvent(r)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}}))}}function il(e,t){if(e.RTCPeerConnection&&!("chrome"===t.browser&&t.version>=71||"safari"===t.browser&&t.version>=605)){var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){var n=t.sdp.split("\n").filter((e=>"a=extmap-allow-mixed"!==e.trim())).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return r.apply(this,arguments)}}}function ol(e,t){if(e.RTCPeerConnection&&e.RTCPeerConnection.prototype){var r=e.RTCPeerConnection.prototype.addIceCandidate;r&&0!==r.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}}function sl(e,t){if(e.RTCPeerConnection&&e.RTCPeerConnection.prototype){var r=e.RTCPeerConnection.prototype.setLocalDescription;r&&0!==r.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){var e=arguments[0]||{};if("object"!=typeof e||e.type&&e.sdp)return r.apply(this,arguments);if(!(e={type:e.type,sdp:e.sdp}).type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}return e.sdp||"offer"!==e.type&&"answer"!==e.type?r.apply(this,[e]):("offer"===e.type?this.createOffer:this.createAnswer).apply(this).then((e=>r.apply(this,[e])))})}}var al=Object.freeze({__proto__:null,shimRTCIceCandidate:el,shimMaxMessageSize:tl,shimSendThrowTypeError:rl,shimConnectionState:nl,removeExtmapAllowMixed:il,shimAddIceCandidateNullOrEmpty:ol,shimParameterlessSetLocalDescription:sl});!function(){var{window:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0},r=du,n=function(e){var t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;var{navigator:r}=e;if(r.mozGetUserMedia)t.browser="firefox",t.version=au(r.userAgent,/Firefox\/(\d+)\./,1);else if(r.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=au(r.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.RTCPeerConnection||!r.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=au(r.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(e),i={browserDetails:n,commonShim:al,extractVersion:au,disableLog:uu,disableWarnings:lu,sdp:Xu};switch(n.browser){case"chrome":if(!Cu||!Au||!t.shimChrome)return r("Chrome shim is not included in this adapter release."),i;if(null===n.version)return r("Chrome shim can not determine version, not shimming."),i;r("adapter.js shimming chrome."),i.browserShim=Cu,ol(e,n),sl(e),yu(e,n),bu(e),Au(e,n),Eu(e),xu(e,n),wu(e),Su(e),_u(e),Iu(e,n),el(e),nl(e),tl(e,n),rl(e),il(e,n);break;case"firefox":if(!ju||!Ou||!t.shimFirefox)return r("Firefox shim is not included in this adapter release."),i;r("adapter.js shimming firefox."),i.browserShim=ju,ol(e,n),sl(e),Ru(e,n),Ou(e,n),ku(e),Lu(e),Nu(e),Pu(e),Du(e),Mu(e),Uu(e),Bu(e),Fu(e),el(e),nl(e),tl(e,n),rl(e);break;case"safari":if(!Ju||!t.shimSafari)return r("Safari shim is not included in this adapter release."),i;r("adapter.js shimming safari."),i.browserShim=Ju,ol(e,n),sl(e),Zu(e),Ku(e),Gu(e),Vu(e),Hu(e),zu(e),qu(e),Wu(e),el(e),tl(e,n),rl(e),il(e,n);break;default:r("Unsupported browser!")}}({window:"undefined"==typeof window?void 0:window});var cl,ul,ll=function(){return ll=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ll.apply(this,arguments)};function dl(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function hl(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function fl(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function pl(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}!function(e){e.Start="xstate.start",e.Stop="xstate.stop",e.Raise="xstate.raise",e.Send="xstate.send",e.Cancel="xstate.cancel",e.NullEvent="",e.Assign="xstate.assign",e.After="xstate.after",e.DoneState="done.state",e.DoneInvoke="done.invoke",e.Log="xstate.log",e.Init="xstate.init",e.Invoke="xstate.invoke",e.ErrorExecution="error.execution",e.ErrorCommunication="error.communication",e.ErrorPlatform="error.platform",e.ErrorCustom="xstate.error",e.Update="xstate.update",e.Pure="xstate.pure",e.Choose="xstate.choose"}(cl||(cl={})),function(e){e.Parent="#_parent",e.Internal="#_internal"}(ul||(ul={}));var ml=cl.Start,gl=cl.Stop,vl=cl.Raise,yl=cl.Send,bl=cl.Cancel,El=cl.NullEvent,wl=cl.Assign;cl.After,cl.DoneState;var Sl=cl.Log,_l=cl.Init,Tl=cl.Invoke;cl.ErrorExecution;var xl,Al=cl.ErrorPlatform,Il=cl.ErrorCustom,Cl=cl.Update,Rl=cl.Choose,kl=cl.Pure,Ol={},Nl="xstate.guard",Pl="production"===We.env.NODE_ENV;function Ll(e,t,r){void 0===r&&(r=".");var n=Ul(e,r),i=Ul(t,r);return ed(i)?!!ed(n)&&i===n:ed(n)?n in i:Object.keys(n).every((function(e){return e in i&&Ll(n[e],i[e])}))}function Dl(e){try{return ed(e)||"number"==typeof e?"".concat(e):e.type}catch(e){throw new Error("Events must be strings or objects with a string event.type property.")}}function Ml(e,t){try{return Ql(e)?e:e.toString().split(t)}catch(t){throw new Error("'".concat(e,"' is not a valid state path."))}}function Ul(e,t){return function(e){return"object"==typeof e&&"value"in e&&"context"in e&&"event"in e&&"_event"in e}(e)?e.value:Ql(e)?Bl(e):"string"!=typeof e?e:Bl(Ml(e,t))}function Bl(e){if(1===e.length)return e[0];for(var t={},r=t,n=0;n<e.length-1;n++)n===e.length-2?r[e[n]]=e[n+1]:(r[e[n]]={},r=r[e[n]]);return t}function Fl(e,t){for(var r={},n=Object.keys(e),i=0;i<n.length;i++){var o=n[i];r[o]=t(e[o],o,e,i)}return r}function jl(e,t,r){var n,i,o={};try{for(var s=hl(Object.keys(e)),a=s.next();!a.done;a=s.next()){var c=a.value,u=e[c];r(u)&&(o[c]=t(u,c,e))}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return o}var Vl=function(e){return function(t){var r,n,i=t;try{for(var o=hl(e),s=o.next();!s.done;s=o.next()){i=i[s.value]}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i}};function Hl(e){return e?ed(e)?[[e]]:Gl(Object.keys(e).map((function(t){var r=e[t];return"string"==typeof r||r&&Object.keys(r).length?Hl(e[t]).map((function(e){return[t].concat(e)})):[[t]]}))):[[]]}function Gl(e){var t;return(t=[]).concat.apply(t,pl([],fl(e),!1))}function ql(e){return Ql(e)?e:[e]}function $l(e){return void 0===e?[]:ql(e)}function Zl(e,t,r){var n,i;if(Xl(e))return e(t,r.data);var o={};try{for(var s=hl(Object.keys(e)),a=s.next();!a.done;a=s.next()){var c=a.value,u=e[c];Xl(u)?o[c]=u(t,r.data):o[c]=u}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return o}function zl(e){return e instanceof Promise||!(null===e||!Xl(e)&&"object"!=typeof e||!Xl(e.then))}function Kl(e,t){var r,n,i=fl([[],[]],2),o=i[0],s=i[1];try{for(var a=hl(e),c=a.next();!c.done;c=a.next()){var u=c.value;t(u)?o.push(u):s.push(u)}}catch(e){r={error:e}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return[o,s]}function Wl(e,t){return Fl(e.states,(function(e,r){if(e){var n=(ed(t)?void 0:t[r])||(e?e.current:void 0);if(n)return{current:n,states:Wl(e,n)}}}))}function Jl(e,t,r,n){Pl||Yl(!!e,"Attempting to update undefined context");var i=e?r.reduce((function(e,r){var i,o,s=r.assignment,a={state:n,action:r,_event:t},c={};if(Xl(s))c=s(e,t.data,a);else try{for(var u=hl(Object.keys(s)),l=u.next();!l.done;l=u.next()){var d=l.value,h=s[d];c[d]=Xl(h)?h(e,t.data,a):h}}catch(e){i={error:e}}finally{try{l&&!l.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}return Object.assign({},e,c)}),e):e;return i}var Yl=function(){};function Ql(e){return Array.isArray(e)}function Xl(e){return"function"==typeof e}function ed(e){return"string"==typeof e}function td(e,t){if(e)return ed(e)?{type:Nl,name:e,predicate:t?t[e]:void 0}:Xl(e)?{type:Nl,name:e.name,predicate:e}:e}Pl||(Yl=function(e,t){var r=e instanceof Error?e:void 0;if((r||!e)&&void 0!==console){var n=["Warning: ".concat(t)];r&&n.push(r),console.warn.apply(console,n)}});var rd=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function nd(e){return!!e&&"__xstatenode"in e}function id(e,t){return ed(e)||"number"==typeof e?ll({type:e},t):e}function od(e,t){if(!ed(e)&&"$$type"in e&&"scxml"===e.$$type)return e;var r=id(e);return ll({name:r.type,data:r,$$type:"scxml",type:"external"},t)}function sd(e,t){return ql(t).map((function(t){return void 0===t||"string"==typeof t||nd(t)?{target:t,event:e}:ll(ll({},t),{event:e})}))}function ad(e,t,r,n,i){var o=e.options.guards,s={state:i,cond:t,_event:n};if(t.type===Nl)return((null==o?void 0:o[t.name])||t.predicate)(r,n.data,s);var a=null==o?void 0:o[t.type];if(!a)throw new Error("Guard '".concat(t.type,"' is not implemented on machine '").concat(e.id,"'."));return a(r,n.data,s)}function cd(e){return"string"==typeof e?{type:e}:e}function ud(e,t,r){var n=function(){},i="object"==typeof e,o=i?e:null;return{next:((i?e.next:e)||n).bind(o),error:((i?e.error:t)||n).bind(o),complete:((i?e.complete:r)||n).bind(o)}}function ld(e,t){return"".concat(e,":invocation[").concat(t,"]")}(xl={})[rd]=function(){return this},xl[Symbol.observable]=function(){return this};var dd=od({type:_l});function hd(e,t){return t&&t[e]||void 0}function fd(e,t){var r;if(ed(e)||"number"==typeof e)r=Xl(n=hd(e,t))?{type:e,exec:n}:n||{type:e,exec:void 0};else if(Xl(e))r={type:e.name||e.toString(),exec:e};else{var n;if(Xl(n=hd(e.type,t)))r=ll(ll({},e),{exec:n});else if(n){var i=n.type||e.type;r=ll(ll(ll({},n),e),{type:i})}else r=e}return r}var pd=function(e,t){return e?(Ql(e)?e:[e]).map((function(e){return fd(e,t)})):[]};function md(e){var t=fd(e);return ll(ll({id:ed(e)?e:t.id},t),{type:t.type})}function gd(e){return ed(e)?{type:vl,event:e}:vd(e,{to:ul.Internal})}function vd(e,t){return{to:t?t.to:void 0,type:yl,event:Xl(e)?e:id(e),delay:t?t.delay:void 0,id:t&&void 0!==t.id?t.id:Xl(e)?e.name:Dl(e)}}function yd(e,t){var r="".concat(cl.DoneState,".").concat(e),n={type:r,data:t,toString:function(){return r}};return n}function bd(e,t){var r="".concat(cl.DoneInvoke,".").concat(e),n={type:r,data:t,toString:function(){return r}};return n}function Ed(e,t){var r="".concat(cl.ErrorPlatform,".").concat(e),n={type:r,data:t,toString:function(){return r}};return n}function wd(e,t,r,n,i,o,s){void 0===s&&(s=!1);var a=fl(s?[[],i]:Kl(i,(function(e){return e.type===wl})),2),c=a[0],u=a[1],l=c.length?Jl(r,n,c,t):r,d=s?[r]:void 0,h=Gl(u.map((function(r){var i;switch(r.type){case vl:return{type:vl,_event:od(r.event)};case yl:var a=function(e,t,r,n){var i,o={_event:r},s=od(Xl(e.event)?e.event(t,r.data,o):e.event);if(ed(e.delay)){var a=n&&n[e.delay];i=Xl(a)?a(t,r.data,o):a}else i=Xl(e.delay)?e.delay(t,r.data,o):e.delay;var c=Xl(e.to)?e.to(t,r.data,o):e.to;return ll(ll({},e),{to:c,_event:s,event:s.data,delay:i})}(r,l,n,e.options.delays);return Pl||Yl(!ed(r.delay)||"number"==typeof a.delay,"No delay reference for delay expression '".concat(r.delay,"' was found on machine '").concat(e.id,"'")),a.to!==ul.Internal&&(null==o||o(a,l,n)),a;case Sl:var c=function(e,t,r){return ll(ll({},e),{value:ed(e.expr)?e.expr:e.expr(t,r.data,{_event:r})})}(r,l,n);return null==o||o(c,l,n),c;case Rl:if(!(p=null===(i=r.conds.find((function(r){var i=td(r.cond,e.options.guards);return!i||ad(e,i,l,n,o?void 0:t)})))||void 0===i?void 0:i.actions))return[];var u=fl(wd(e,t,l,n,pd($l(p),e.options.actions),o,s),2),h=u[0],f=u[1];return l=f,null==d||d.push(l),h;case kl:var p;if(!(p=r.get(l,n.data)))return[];var m=fl(wd(e,t,l,n,pd($l(p),e.options.actions),o,s),2),g=m[0],v=m[1];return l=v,null==d||d.push(l),g;case gl:c=function(e,t,r){var n=Xl(e.activity)?e.activity(t,r.data):e.activity,i="string"==typeof n?{id:n}:n;return{type:cl.Stop,activity:i}}(r,l,n);return null==o||o(c,l,n),c;case wl:l=Jl(l,n,[r],o?void 0:t),null==d||d.push(l);break;default:var y=fd(r,e.options.actions),b=y.exec;if(o)o(y,l,n);else if(b&&d){var E=d.length-1;y=ll(ll({},y),{exec:function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];b.apply(void 0,pl([d[E]],fl(t),!1))}})}return y}})).filter((function(e){return!!e})));return[h,l]}var Sd=function(e,t){return t(e)};function _d(e){var t;return(t={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:e}}})[rd]=function(){return this},t}function Td(e,t,r){var n=_d(t);if(n.deferred=!0,nd(e)){var i=n.state=Sd(void 0,(function(){return(r?e.withContext(r):e).initialState}));n.getSnapshot=function(){return i}}return n}var xd=function(e){return"atomic"===e.type||"final"===e.type};function Ad(e){return Object.keys(e.states).map((function(t){return e.states[t]}))}function Id(e){return Ad(e).filter((function(e){return"history"!==e.type}))}function Cd(e){var t=[e];return xd(e)?t:t.concat(Gl(Id(e).map(Cd)))}function Rd(e,t){var r,n,i,o,s,a,c,u,l=Od(new Set(e)),d=new Set(t);try{for(var h=hl(d),f=h.next();!f.done;f=h.next())for(var p=(_=f.value).parent;p&&!d.has(p);)d.add(p),p=p.parent}catch(e){r={error:e}}finally{try{f&&!f.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}var m=Od(d);try{for(var g=hl(d),v=g.next();!v.done;v=g.next()){if("compound"!==(_=v.value).type||m.get(_)&&m.get(_).length){if("parallel"===_.type)try{for(var y=(s=void 0,hl(Id(_))),b=y.next();!b.done;b=y.next()){var E=b.value;d.has(E)||(d.add(E),l.get(E)?l.get(E).forEach((function(e){return d.add(e)})):E.initialStateNodes.forEach((function(e){return d.add(e)})))}}catch(e){s={error:e}}finally{try{b&&!b.done&&(a=y.return)&&a.call(y)}finally{if(s)throw s.error}}}else l.get(_)?l.get(_).forEach((function(e){return d.add(e)})):_.initialStateNodes.forEach((function(e){return d.add(e)}))}}catch(e){i={error:e}}finally{try{v&&!v.done&&(o=g.return)&&o.call(g)}finally{if(i)throw i.error}}try{for(var w=hl(d),S=w.next();!S.done;S=w.next()){var _;for(p=(_=S.value).parent;p&&!d.has(p);)d.add(p),p=p.parent}}catch(e){c={error:e}}finally{try{S&&!S.done&&(u=w.return)&&u.call(w)}finally{if(c)throw c.error}}return d}function kd(e,t){var r=t.get(e);if(!r)return{};if("compound"===e.type){var n=r[0];if(!n)return{};if(xd(n))return n.key}var i={};return r.forEach((function(e){i[e.key]=kd(e,t)})),i}function Od(e){var t,r,n=new Map;try{for(var i=hl(e),o=i.next();!o.done;o=i.next()){var s=o.value;n.has(s)||n.set(s,[]),s.parent&&(n.has(s.parent)||n.set(s.parent,[]),n.get(s.parent).push(s))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n}function Nd(e,t){return kd(e,Od(Rd([e],t)))}function Pd(e,t){return Array.isArray(e)?e.some((function(e){return e===t})):e instanceof Set&&e.has(t)}function Ld(e,t){return"compound"===t.type?Id(t).some((function(t){return"final"===t.type&&Pd(e,t)})):"parallel"===t.type&&Id(t).every((function(t){return Ld(e,t)}))}function Dd(e){return new Set(Gl(e.map((function(e){return e.tags}))))}function Md(e,t){if(e===t)return!0;if(void 0===e||void 0===t)return!1;if(ed(e)||ed(t))return e===t;var r=Object.keys(e),n=Object.keys(t);return r.length===n.length&&r.every((function(r){return Md(e[r],t[r])}))}var Ud=function(){function e(e){var t,r,n=this;this.actions=[],this.activities=Ol,this.meta={},this.events=[],this.value=e.value,this.context=e.context,this._event=e._event,this._sessionid=e._sessionid,this.event=this._event.data,this.historyValue=e.historyValue,this.history=e.history,this.actions=e.actions||[],this.activities=e.activities||Ol,this.meta=(void 0===(r=e.configuration)&&(r=[]),r.reduce((function(e,t){return void 0!==t.meta&&(e[t.id]=t.meta),e}),{})),this.events=e.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=e.configuration,this.transitions=e.transitions,this.children=e.children,this.done=!!e.done,this.tags=null!==(t=Array.isArray(e.tags)?new Set(e.tags):e.tags)&&void 0!==t?t:new Set,this.machine=e.machine,Object.defineProperty(this,"nextEvents",{get:function(){return function(e){return pl([],fl(new Set(Gl(pl([],fl(e.map((function(e){return e.ownEvents}))),!1)))),!1)}(n.configuration)}})}return e.from=function(t,r){return t instanceof e?t.context!==r?new e({value:t.value,context:r,_event:t._event,_sessionid:null,historyValue:t.historyValue,history:t.history,actions:[],activities:t.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):t:new e({value:t,context:r,_event:dd,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},e.create=function(t){return new e(t)},e.inert=function(t,r){if(t instanceof e){if(!t.actions.length)return t;var n=dd;return new e({value:t.value,context:r,_event:n,_sessionid:null,historyValue:t.historyValue,history:t.history,activities:t.activities,configuration:t.configuration,transitions:[],children:{}})}return e.from(t,r)},e.prototype.toStrings=function(e,t){var r=this;if(void 0===e&&(e=this.value),void 0===t&&(t="."),ed(e))return[e];var n=Object.keys(e);return n.concat.apply(n,pl([],fl(n.map((function(n){return r.toStrings(e[n],t).map((function(e){return n+t+e}))}))),!1))},e.prototype.toJSON=function(){var e=this;e.configuration,e.transitions;var t=e.tags;e.machine;var r=dl(e,["configuration","transitions","tags","machine"]);return ll(ll({},r),{tags:Array.from(t)})},e.prototype.matches=function(e){return Ll(e,this.value)},e.prototype.hasTag=function(e){return this.tags.has(e)},e.prototype.can=function(e){var t;Pl&&Yl(!!this.machine,"state.can(...) used outside of a machine-created State object; this will always return false.");var r=null===(t=this.machine)||void 0===t?void 0:t.getTransitionData(this,e);return!!(null==r?void 0:r.transitions.length)&&r.transitions.some((function(e){return void 0!==e.target||e.actions.length}))},e}(),Bd={deferEvents:!1},Fd=function(){function e(e){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=ll(ll({},Bd),e)}return e.prototype.initialize=function(e){if(this.initialized=!0,e){if(!this.options.deferEvents)return void this.schedule(e);this.process(e)}this.flushEvents()},e.prototype.schedule=function(e){if(this.initialized&&!this.processingEvent){if(0!==this.queue.length)throw new Error("Event queue should be empty when it is not processing events");this.process(e),this.flushEvents()}else this.queue.push(e)},e.prototype.clear=function(){this.queue=[]},e.prototype.flushEvents=function(){for(var e=this.queue.shift();e;)this.process(e),e=this.queue.shift()},e.prototype.process=function(e){this.processingEvent=!0;try{e()}catch(e){throw this.clear(),e}finally{this.processingEvent=!1}},e}(),jd=new Map,Vd=0,Hd=function(){return"x:".concat(Vd++)},Gd=function(e,t){return jd.set(e,t),e},qd=function(e){return jd.get(e)},$d=function(e){jd.delete(e)};function Zd(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==xe?xe:void(Pl||console.warn("XState could not find a global object in this environment. Please let the maintainers know and raise an issue here: https://github.com/statelyai/xstate/issues"))}function zd(e){if(Zd()){var t=function(){var e=Zd();if(e&&"__xstate__"in e)return e.__xstate__}();t&&t.register(e)}}function Kd(e,t){void 0===t&&(t={});var r=e.initialState,n=new Set,i=[],o=!1,s=function(e){var t;return ll(((t={subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}})[rd]=function(){return this},t),e)}({id:t.id,send:function(t){i.push(t),function(){if(!o){for(o=!0;i.length>0;){var t=i.shift();r=e.transition(r,t,a),n.forEach((function(e){return e.next(r)}))}o=!1}}()},getSnapshot:function(){return r},subscribe:function(e,t,i){var o=ud(e,t,i);return n.add(o),o.next(r),{unsubscribe:function(){n.delete(o)}}}}),a={parent:t.parent,self:s,id:t.id||"anonymous",observers:n};return r=e.start?e.start(a):r,s}var Wd,Jd={sync:!1,autoForward:!1};!function(e){e[e.NotStarted=0]="NotStarted",e[e.Running=1]="Running",e[e.Stopped=2]="Stopped"}(Wd||(Wd={}));var Yd=function(){function e(t,r){var n=this;void 0===r&&(r=e.defaultOptions),this.machine=t,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=Wd.NotStarted,this.children=new Map,this.forwardTo=new Set,this.init=this.start,this.send=function(e,t){if(Ql(e))return n.batch(e),n.state;var r=od(id(e,t));if(n.status===Wd.Stopped)return Pl||Yl(!1,'Event "'.concat(r.name,'" was sent to stopped service "').concat(n.machine.id,'". This service has already reached its final state, and will not transition.\nEvent: ').concat(JSON.stringify(r.data))),n.state;if(n.status!==Wd.Running&&!n.options.deferEvents)throw new Error('Event "'.concat(r.name,'" was sent to uninitialized service "').concat(n.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\nEvent: ').concat(JSON.stringify(r.data)));return n.scheduler.schedule((function(){n.forward(r);var e=n.nextState(r);n.update(e,r)})),n._state},this.sendTo=function(e,t){var r,i=n.parent&&(t===ul.Parent||n.parent.id===t),o=i?n.parent:ed(t)?n.children.get(t)||qd(t):(r=t)&&"function"==typeof r.send?t:void 0;if(o)"machine"in o?(n.status!==Wd.Stopped||n.parent!==o||n.state.done)&&o.send(ll(ll({},e),{name:e.name===Il?"".concat(Ed(n.id)):e.name,origin:n.sessionId})):o.send(e.data);else{if(!i)throw new Error("Unable to send event to child '".concat(t,"' from service '").concat(n.id,"'."));Pl||Yl(!1,"Service '".concat(n.id,"' has no parent: unable to send event ").concat(e.type))}},this._exec=function(e,t,r,i){void 0===i&&(i=n.machine.options.actions);var o=e.exec||hd(e.type,i),s=Xl(o)?o:o?o.exec:e.exec;if(s)try{return s(t,r.data,n.machine.config.predictableActionArguments?{action:e,_event:r}:{action:e,state:n.state,_event:r})}catch(e){throw n.parent&&n.parent.send({type:"xstate.error",data:e}),e}switch(e.type){case yl:var a=e;if("number"==typeof a.delay)return void n.defer(a);a.to?n.sendTo(a._event,a.to):n.send(a._event);break;case bl:n.cancel(e.sendId);break;case ml:if(n.status!==Wd.Running)return;var c=e.activity;if(!n.machine.config.predictableActionArguments&&!n.state.activities[c.id||c.type])break;if(c.type===cl.Invoke){var u=cd(c.src),l=n.machine.options.services?n.machine.options.services[u.type]:void 0,d=c.id,h=c.data;Pl||Yl(!("forward"in c),"`forward` property is deprecated (found in invocation of '".concat(c.src,"' in in machine '").concat(n.machine.id,"'). ")+"Please use `autoForward` instead.");var f="autoForward"in c?c.autoForward:!!c.forward;if(!l)return void(Pl||Yl(!1,"No service found for invocation '".concat(c.src,"' in machine '").concat(n.machine.id,"'.")));var p=h?Zl(h,t,r):void 0;if("string"==typeof l)return;var m=Xl(l)?l(t,r.data,{data:p,src:u,meta:c.meta}):l;if(!m)return;var g=void 0;nd(m)&&(m=p?m.withContext(p):m,g={autoForward:f}),n.spawn(m,d,g)}else n.spawnActivity(c);break;case gl:n.stopChild(e.activity.id);break;case Sl:var v=e.label,y=e.value;v?n.logger(v,y):n.logger(y);break;default:Pl||Yl(!1,"No implementation found for action type '".concat(e.type,"'"))}};var i=ll(ll({},e.defaultOptions),r),o=i.clock,s=i.logger,a=i.parent,c=i.id,u=void 0!==c?c:t.id;this.id=u,this.logger=s,this.clock=o,this.parent=a,this.options=i,this.scheduler=new Fd({deferEvents:this.options.deferEvents}),this.sessionId=Hd()}return Object.defineProperty(e.prototype,"initialState",{get:function(){var e=this;return this._initialState?this._initialState:Sd(this,(function(){return e._initialState=e.machine.initialState,e._initialState}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return Pl||Yl(this.status!==Wd.NotStarted,"Attempted to read state from uninitialized service '".concat(this.id,"'. Make sure the service is started first.")),this._state},enumerable:!1,configurable:!0}),e.prototype.execute=function(e,t){var r,n;try{for(var i=hl(e.actions),o=i.next();!o.done;o=i.next()){var s=o.value;this.exec(s,e,t)}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},e.prototype.update=function(e,t){var r,n,i,o,s,a,c,u,l=this;if(e._sessionid=this.sessionId,this._state=e,this.machine.config.predictableActionArguments&&t!==dd||!this.options.execute||this.execute(this.state),this.children.forEach((function(e){l.state.children[e.id]=e})),this.devTools&&this.devTools.send(t.data,e),e.event)try{for(var d=hl(this.eventListeners),h=d.next();!h.done;h=d.next()){(0,h.value)(e.event)}}catch(e){r={error:e}}finally{try{h&&!h.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}try{for(var f=hl(this.listeners),p=f.next();!p.done;p=f.next()){(0,p.value)(e,e.event)}}catch(e){i={error:e}}finally{try{p&&!p.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}try{for(var m=hl(this.contextListeners),g=m.next();!g.done;g=m.next()){(0,g.value)(this.state.context,this.state.history?this.state.history.context:void 0)}}catch(e){s={error:e}}finally{try{g&&!g.done&&(a=m.return)&&a.call(m)}finally{if(s)throw s.error}}if(this.state.done){var v=e.configuration.find((function(e){return"final"===e.type&&e.parent===l.machine})),y=v&&v.doneData?Zl(v.doneData,e.context,t):void 0;try{for(var b=hl(this.doneListeners),E=b.next();!E.done;E=b.next()){(0,E.value)(bd(this.id,y))}}catch(e){c={error:e}}finally{try{E&&!E.done&&(u=b.return)&&u.call(b)}finally{if(c)throw c.error}}this._stop()}},e.prototype.onTransition=function(e){return this.listeners.add(e),this.status===Wd.Running&&e(this.state,this.state.event),this},e.prototype.subscribe=function(e,t,r){var n=this,i=ud(e,t,r);this.listeners.add(i.next),this.status!==Wd.NotStarted&&i.next(this.state);var o=function e(){n.doneListeners.delete(e),n.stopListeners.delete(e),i.complete()};return this.status===Wd.Stopped?i.complete():(this.onDone(o),this.onStop(o)),{unsubscribe:function(){n.listeners.delete(i.next),n.doneListeners.delete(o),n.stopListeners.delete(o)}}},e.prototype.onEvent=function(e){return this.eventListeners.add(e),this},e.prototype.onSend=function(e){return this.sendListeners.add(e),this},e.prototype.onChange=function(e){return this.contextListeners.add(e),this},e.prototype.onStop=function(e){return this.stopListeners.add(e),this},e.prototype.onDone=function(e){return this.doneListeners.add(e),this},e.prototype.off=function(e){return this.listeners.delete(e),this.eventListeners.delete(e),this.sendListeners.delete(e),this.stopListeners.delete(e),this.doneListeners.delete(e),this.contextListeners.delete(e),this},e.prototype.start=function(e){var t=this;if(this.status===Wd.Running)return this;this.machine._init(),Gd(this.sessionId,this),this.initialized=!0,this.status=Wd.Running;var r=void 0===e?this.initialState:Sd(this,(function(){return function(e){return"object"==typeof e&&null!==e&&"value"in e&&"_event"in e}(e)?t.machine.resolveState(e):t.machine.resolveState(Ud.from(e,t.machine.context))}));return this.options.devTools&&this.attachDev(),this.scheduler.initialize((function(){t.update(r,dd)})),this},e.prototype._stop=function(){var e,t,r,n,i,o,s,a,c,u;try{for(var l=hl(this.listeners),d=l.next();!d.done;d=l.next()){var h=d.value;this.listeners.delete(h)}}catch(t){e={error:t}}finally{try{d&&!d.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}try{for(var f=hl(this.stopListeners),p=f.next();!p.done;p=f.next()){(h=p.value)(),this.stopListeners.delete(h)}}catch(e){r={error:e}}finally{try{p&&!p.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}try{for(var m=hl(this.contextListeners),g=m.next();!g.done;g=m.next()){h=g.value;this.contextListeners.delete(h)}}catch(e){i={error:e}}finally{try{g&&!g.done&&(o=m.return)&&o.call(m)}finally{if(i)throw i.error}}try{for(var v=hl(this.doneListeners),y=v.next();!y.done;y=v.next()){h=y.value;this.doneListeners.delete(h)}}catch(e){s={error:e}}finally{try{y&&!y.done&&(a=v.return)&&a.call(v)}finally{if(s)throw s.error}}if(!this.initialized)return this;this.initialized=!1,this.status=Wd.Stopped,this._initialState=void 0;try{for(var b=hl(Object.keys(this.delayedEventsMap)),E=b.next();!E.done;E=b.next()){var w=E.value;this.clock.clearTimeout(this.delayedEventsMap[w])}}catch(e){c={error:e}}finally{try{E&&!E.done&&(u=b.return)&&u.call(b)}finally{if(c)throw c.error}}this.scheduler.clear(),this.scheduler=new Fd({deferEvents:this.options.deferEvents})},e.prototype.stop=function(){var e=this,t=this.scheduler;return this._stop(),t.schedule((function(){var t=od({type:"xstate.stop"}),r=Sd(e,(function(){var r=Gl(pl([],fl(e.state.configuration),!1).sort((function(e,t){return t.order-e.order})).map((function(t){return pd(t.onExit,e.machine.options.actions)}))),n=fl(wd(e.machine,e.state,e.state.context,t,r,e.machine.config.predictableActionArguments?e._exec:void 0,e.machine.config.predictableActionArguments||e.machine.config.preserveActionOrder),2),i=n[0],o=n[1],s=new Ud({value:e.state.value,context:o,_event:t,_sessionid:e.sessionId,historyValue:void 0,history:e.state,actions:i.filter((function(e){return e.type!==vl&&(e.type!==yl||!!e.to&&e.to!==ul.Internal)})),activities:{},events:[],configuration:[],transitions:[],children:{},done:e.state.done,tags:e.state.tags,machine:e.machine});return s.changed=!0,s}));e.update(r,t),e.children.forEach((function(e){Xl(e.stop)&&e.stop()})),e.children.clear(),$d(e.sessionId)})),this},e.prototype.batch=function(e){var t=this;if(this.status===Wd.NotStarted&&this.options.deferEvents)Pl||Yl(!1,"".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'" and are deferred. Make sure .start() is called for this service.\nEvent: ').concat(JSON.stringify(event)));else if(this.status!==Wd.Running)throw new Error("".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'));this.scheduler.schedule((function(){var r,n,i=t.state,o=!1,s=[],a=function(e){var r=od(e);t.forward(r),i=Sd(t,(function(){return t.machine.transition(i,r)})),s.push.apply(s,pl([],fl(i.actions.map((function(e){return function(e,t){var r=e.exec;return ll(ll({},e),{exec:void 0!==r?function(){return r(t.context,t.event,{action:e,state:t,_event:t._event})}:void 0})}(e,i)}))),!1)),o=o||!!i.changed};try{for(var c=hl(e),u=c.next();!u.done;u=c.next()){a(u.value)}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}i.changed=o,i.actions=s,t.update(i,od(e[e.length-1]))}))},e.prototype.sender=function(e){return this.send.bind(this,e)},e.prototype._nextState=function(e){var t=this,r=od(e);if(0===r.name.indexOf(Al)&&!this.state.nextEvents.some((function(e){return 0===e.indexOf(Al)})))throw r.data.data;return Sd(this,(function(){return t.machine.transition(t.state,r,void 0,t.machine.config.predictableActionArguments?t._exec:void 0)}))},e.prototype.nextState=function(e){return this._nextState(e)},e.prototype.forward=function(e){var t,r;try{for(var n=hl(this.forwardTo),i=n.next();!i.done;i=n.next()){var o=i.value,s=this.children.get(o);if(!s)throw new Error("Unable to forward event '".concat(e,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(o,"'."));s.send(e)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},e.prototype.defer=function(e){var t=this;this.delayedEventsMap[e.id]=this.clock.setTimeout((function(){e.to?t.sendTo(e._event,e.to):t.send(e._event)}),e.delay)},e.prototype.cancel=function(e){this.clock.clearTimeout(this.delayedEventsMap[e]),delete this.delayedEventsMap[e]},e.prototype.exec=function(e,t,r){void 0===r&&(r=this.machine.options.actions),this._exec(e,t.context,t._event,r)},e.prototype.removeChild=function(e){var t;this.children.delete(e),this.forwardTo.delete(e),null===(t=this.state)||void 0===t||delete t.children[e]},e.prototype.stopChild=function(e){var t=this.children.get(e);t&&(this.removeChild(e),Xl(t.stop)&&t.stop())},e.prototype.spawn=function(e,t,r){if(this.status!==Wd.Running)return Td(e,t);if(zl(e))return this.spawnPromise(Promise.resolve(e),t);if(Xl(e))return this.spawnCallback(e,t);if(function(e){try{return"function"==typeof e.send}catch(e){return!1}}(i=e)&&"id"in i)return this.spawnActor(e,t);if(function(e){try{return"subscribe"in e&&Xl(e.subscribe)}catch(e){return!1}}(e))return this.spawnObservable(e,t);if(nd(e))return this.spawnMachine(e,ll(ll({},r),{id:t}));if(null!==(n=e)&&"object"==typeof n&&"transition"in n&&"function"==typeof n.transition)return this.spawnBehavior(e,t);throw new Error('Unable to spawn entity "'.concat(t,'" of type "').concat(typeof e,'".'));var n,i},e.prototype.spawnMachine=function(t,r){var n=this;void 0===r&&(r={});var i=new e(t,ll(ll({},this.options),{parent:this,id:r.id||t.id})),o=ll(ll({},Jd),r);o.sync&&i.onTransition((function(e){n.send(Cl,{state:e,id:i.id})}));var s=i;return this.children.set(i.id,s),o.autoForward&&this.forwardTo.add(i.id),i.onDone((function(e){n.removeChild(i.id),n.send(od(e,{origin:i.id}))})).start(),s},e.prototype.spawnBehavior=function(e,t){var r=Kd(e,{id:t,parent:this});return this.children.set(t,r),r},e.prototype.spawnPromise=function(e,t){var r,n,i=this,o=!1;e.then((function(e){o||(n=e,i.removeChild(t),i.send(od(bd(t,e),{origin:t})))}),(function(e){if(!o){i.removeChild(t);var r=Ed(t,e);try{i.send(od(r,{origin:t}))}catch(n){!function(e,t,r){if(!Pl){var n=e.stack?" Stacktrace was '".concat(e.stack,"'"):"";if(e===t)console.error("Missing onError handler for invocation '".concat(r,"', error was '").concat(e,"'.").concat(n));else{var i=t.stack?" Stacktrace was '".concat(t.stack,"'"):"";console.error("Missing onError handler and/or unhandled exception/promise rejection for invocation '".concat(r,"'. ")+"Original error: '".concat(e,"'. ").concat(n," Current error is '").concat(t,"'.").concat(i))}}}(e,n,t),i.devTools&&i.devTools.send(r,i.state),i.machine.strict&&i.stop()}}}));var s=((r={id:t,send:function(){},subscribe:function(t,r,n){var i=ud(t,r,n),o=!1;return e.then((function(e){o||(i.next(e),o||i.complete())}),(function(e){o||i.error(e)})),{unsubscribe:function(){return o=!0}}},stop:function(){o=!0},toJSON:function(){return{id:t}},getSnapshot:function(){return n}})[rd]=function(){return this},r);return this.children.set(t,s),s},e.prototype.spawnCallback=function(e,t){var r,n,i,o=this,s=!1,a=new Set,c=new Set;try{i=e((function(e){n=e,c.forEach((function(t){return t(e)})),s||o.send(od(e,{origin:t}))}),(function(e){a.add(e)}))}catch(e){this.send(Ed(t,e))}if(zl(i))return this.spawnPromise(i,t);var u=((r={id:t,send:function(e){return a.forEach((function(t){return t(e)}))},subscribe:function(e){var t=ud(e);return c.add(t.next),{unsubscribe:function(){c.delete(t.next)}}},stop:function(){s=!0,Xl(i)&&i()},toJSON:function(){return{id:t}},getSnapshot:function(){return n}})[rd]=function(){return this},r);return this.children.set(t,u),u},e.prototype.spawnObservable=function(e,t){var r,n,i=this,o=e.subscribe((function(e){n=e,i.send(od(e,{origin:t}))}),(function(e){i.removeChild(t),i.send(od(Ed(t,e),{origin:t}))}),(function(){i.removeChild(t),i.send(od(bd(t),{origin:t}))})),s=((r={id:t,send:function(){},subscribe:function(t,r,n){return e.subscribe(t,r,n)},stop:function(){return o.unsubscribe()},getSnapshot:function(){return n},toJSON:function(){return{id:t}}})[rd]=function(){return this},r);return this.children.set(t,s),s},e.prototype.spawnActor=function(e,t){return this.children.set(t,e),e},e.prototype.spawnActivity=function(e){var t=this.machine.options&&this.machine.options.activities?this.machine.options.activities[e.type]:void 0;if(t){var r=t(this.state.context,e);this.spawnEffect(e.id,r)}else Pl||Yl(!1,"No implementation found for activity '".concat(e.type,"'"))},e.prototype.spawnEffect=function(e,t){var r;this.children.set(e,((r={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:t||void 0,getSnapshot:function(){},toJSON:function(){return{id:e}}})[rd]=function(){return this},r))},e.prototype.attachDev=function(){var e=Zd();if(this.options.devTools&&e){if(e.__REDUX_DEVTOOLS_EXTENSION__){var t="object"==typeof this.options.devTools?this.options.devTools:void 0;this.devTools=e.__REDUX_DEVTOOLS_EXTENSION__.connect(ll(ll({name:this.id,autoPause:!0,stateSanitizer:function(e){return{value:e.value,context:e.context,actions:e.actions}}},t),{features:ll({jump:!1,skip:!1},t?t.features:void 0)}),this.machine),this.devTools.init(this.state)}zd(this)}},e.prototype.toJSON=function(){return{id:this.id}},e.prototype[rd]=function(){return this},e.prototype.getSnapshot=function(){return this.status===Wd.NotStarted?this.initialState:this._state},e.defaultOptions={execute:!0,deferEvents:!0,clock:{setTimeout:function(e){function t(t,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return setTimeout(e,t)})),clearTimeout:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return clearTimeout(e)}))},logger:console.log.bind(console),devTools:!1},e.interpret=Qd,e}();function Qd(e,t){return new Yd(e,t)}function Xd(e){if("string"==typeof e){var t={type:e,toString:function(){return e}};return t}return e}function eh(e){return ll(ll({type:Tl},e),{toJSON:function(){e.onDone,e.onError;var t=dl(e,["onDone","onError"]);return ll(ll({},t),{type:Tl,src:Xd(e.src)})}})}var th="",rh="*",nh={},ih=function(e){return"#"===e[0]},oh=function(){function e(t,r,n,i){var o,s=this;void 0===n&&(n="context"in t?t.context:void 0),this.config=t,this._context=n,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign({actions:{},guards:{},services:{},activities:{},delays:{}},r),this.parent=null==i?void 0:i.parent,this.key=this.config.key||(null==i?void 0:i.key)||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:"."),this.id=this.config.id||pl([this.machine.key],fl(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:null!==(o=this.config.schema)&&void 0!==o?o:{},this.description=this.config.description,Pl||Yl(!("parallel"in this.config),'The "parallel" property is deprecated and will be removed in version 4.1. '.concat(this.config.parallel?"Replace with `type: 'parallel'`":"Use `type: '".concat(this.type,"'`")," in the config for state node '").concat(this.id,"' instead.")),this.initial=this.config.initial,this.states=this.config.states?Fl(this.config.states,(function(t,r){var n,i=new e(t,{},void 0,{parent:s,key:r});return Object.assign(s.idMap,ll(((n={})[i.id]=i,n),i.idMap)),i})):nh;var a=0;!function e(t){var r,n;t.order=a++;try{for(var i=hl(Ad(t)),o=i.next();!o.done;o=i.next()){e(o.value)}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}}(this),this.history=!0===this.config.history?"shallow":this.config.history||!1,this._transient=!!this.config.always||!!this.config.on&&(Array.isArray(this.config.on)?this.config.on.some((function(e){return e.event===th})):th in this.config.on),this.strict=!!this.config.strict,this.onEntry=$l(this.config.entry||this.config.onEntry).map((function(e){return fd(e)})),this.onExit=$l(this.config.exit||this.config.onExit).map((function(e){return fd(e)})),this.meta=this.config.meta,this.doneData="final"===this.type?this.config.data:void 0,this.invoke=$l(this.config.invoke).map((function(e,t){var r,n;if(nd(e)){var i=ld(s.id,t);return s.machine.options.services=ll(((r={})[i]=e,r),s.machine.options.services),eh({src:i,id:i})}if(ed(e.src)){i=e.id||ld(s.id,t);return eh(ll(ll({},e),{id:i,src:e.src}))}if(nd(e.src)||Xl(e.src)){i=e.id||ld(s.id,t);return s.machine.options.services=ll(((n={})[i]=e.src,n),s.machine.options.services),eh(ll(ll({id:i},e),{src:i}))}var o=e.src;return eh(ll(ll({id:ld(s.id,t)},e),{src:o}))})),this.activities=$l(this.config.activities).concat(this.invoke).map((function(e){return md(e)})),this.transition=this.transition.bind(this),this.tags=$l(this.config.tags)}return e.prototype._init=function(){this.__cache.transitions||Cd(this).forEach((function(e){return e.on}))},e.prototype.withConfig=function(t,r){var n=this.options,i=n.actions,o=n.activities,s=n.guards,a=n.services,c=n.delays;return new e(this.config,{actions:ll(ll({},i),t.actions),activities:ll(ll({},o),t.activities),guards:ll(ll({},s),t.guards),services:ll(ll({},a),t.services),delays:ll(ll({},c),t.delays)},null!=r?r:this.context)},e.prototype.withContext=function(t){return new e(this.config,this.options,t)},Object.defineProperty(e.prototype,"context",{get:function(){return Xl(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:Fl(this.states,(function(e){return e.definition})),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){return this.definition},Object.defineProperty(e.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var e=this.transitions;return this.__cache.on=e.reduce((function(e,t){return e[t.eventType]=e[t.eventType]||[],e[t.eventType].push(t),e}),{})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),e.prototype.getCandidates=function(e){if(this.__cache.candidates[e])return this.__cache.candidates[e];var t=e===th,r=this.transitions.filter((function(r){var n=r.eventType===e;return t?n:n||r.eventType===rh}));return this.__cache.candidates[e]=r,r},e.prototype.getDelayedTransitions=function(){var e=this,t=this.config.after;if(!t)return[];var r=function(t,r){var n=function(e,t){var r=t?"#".concat(t):"";return"".concat(cl.After,"(").concat(e,")").concat(r)}(Xl(t)?"".concat(e.id,":delay[").concat(r,"]"):t,e.id);return e.onEntry.push(vd(n,{delay:t})),e.onExit.push({type:bl,sendId:n}),n};return(Ql(t)?t.map((function(e,t){var n=r(e.delay,t);return ll(ll({},e),{event:n})})):Gl(Object.keys(t).map((function(e,n){var i=t[e],o=ed(i)?{target:i}:i,s=isNaN(+e)?e:+e,a=r(s,n);return $l(o).map((function(e){return ll(ll({},e),{event:a,delay:s})}))})))).map((function(t){var r=t.delay;return ll(ll({},e.formatTransition(t)),{delay:r})}))},e.prototype.getStateNodes=function(e){var t,r=this;if(!e)return[];var n=e instanceof Ud?e.value:Ul(e,this.delimiter);if(ed(n)){var i=this.getStateNode(n).initial;return void 0!==i?this.getStateNodes(((t={})[n]=i,t)):[this,this.states[n]]}var o=Object.keys(n),s=[this];return s.push.apply(s,pl([],fl(Gl(o.map((function(e){return r.getStateNode(e).getStateNodes(n[e])})))),!1)),s},e.prototype.handles=function(e){var t=Dl(e);return this.events.includes(t)},e.prototype.resolveState=function(e){var t=e instanceof Ud?e:Ud.create(e),r=Array.from(Rd([],this.getStateNodes(t.value)));return new Ud(ll(ll({},t),{value:this.resolve(t.value),configuration:r,done:Ld(r,this),tags:Dd(r),machine:this.machine}))},e.prototype.transitionLeafNode=function(e,t,r){var n=this.getStateNode(e).next(t,r);return n&&n.transitions.length?n:this.next(t,r)},e.prototype.transitionCompoundNode=function(e,t,r){var n=Object.keys(e),i=this.getStateNode(n[0])._transition(e[n[0]],t,r);return i&&i.transitions.length?i:this.next(t,r)},e.prototype.transitionParallelNode=function(e,t,r){var n,i,o={};try{for(var s=hl(Object.keys(e)),a=s.next();!a.done;a=s.next()){var c=a.value,u=e[c];if(u){var l=this.getStateNode(c)._transition(u,t,r);l&&(o[c]=l)}}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}var d=Object.keys(o).map((function(e){return o[e]})),h=Gl(d.map((function(e){return e.transitions})));if(!d.some((function(e){return e.transitions.length>0})))return this.next(t,r);var f=Gl(d.map((function(e){return e.entrySet}))),p=Gl(Object.keys(o).map((function(e){return o[e].configuration})));return{transitions:h,entrySet:f,exitSet:Gl(d.map((function(e){return e.exitSet}))),configuration:p,source:t,actions:Gl(Object.keys(o).map((function(e){return o[e].actions})))}},e.prototype._transition=function(e,t,r){return ed(e)?this.transitionLeafNode(e,t,r):1===Object.keys(e).length?this.transitionCompoundNode(e,t,r):this.transitionParallelNode(e,t,r)},e.prototype.getTransitionData=function(e,t){return this._transition(e.value,e,od(t))},e.prototype.next=function(e,t){var r,n,i,o=this,s=t.name,a=[],c=[];try{for(var u=hl(this.getCandidates(s)),l=u.next();!l.done;l=u.next()){var d=l.value,h=d.cond,f=d.in,p=e.context,m=!f||(ed(f)&&ih(f)?e.matches(Ul(this.getStateNodeById(f).path,this.delimiter)):Ll(Ul(f,this.delimiter),Vl(this.path.slice(0,-2))(e.value))),g=!1;try{g=!h||ad(this.machine,h,p,t,e)}catch(e){throw new Error("Unable to evaluate guard '".concat(h.name||h.type,"' in transition for event '").concat(s,"' in state node '").concat(this.id,"':\n").concat(e.message))}if(g&&m){void 0!==d.target&&(c=d.target),a.push.apply(a,pl([],fl(d.actions),!1)),i=d;break}}}catch(e){r={error:e}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}if(i){if(!c.length)return{transitions:[i],entrySet:[],exitSet:[],configuration:e.value?[this]:[],source:e,actions:a};var v=Gl(c.map((function(t){return o.getRelativeStateNodes(t,e.historyValue)}))),y=!!i.internal,b=[];return y||c.forEach((function(e){b.push.apply(b,pl([],fl(o.getExternalReentryNodes(e)),!1))})),{transitions:[i],entrySet:b,exitSet:y?[]:[this],configuration:v,source:e,actions:a}}},e.prototype.getExternalReentryNodes=function(e){for(var t=[],r=fl(e.order>this.order?[e,this]:[this,e],2),n=r[0],i=r[1];n&&n!==i;)t.push(n),n=n.parent;return n!==i?[]:(t.push(i),t)},e.prototype.getActions=function(e,t,r,n,i,o){var s,a,c,u,l=Rd([],o?this.getStateNodes(o.value):[this]);try{for(var d=hl(e),h=d.next();!h.done;h=d.next()){Pd(l,m=h.value)&&!Pd(r.entrySet,m.parent)||r.entrySet.push(m)}}catch(e){s={error:e}}finally{try{h&&!h.done&&(a=d.return)&&a.call(d)}finally{if(s)throw s.error}}try{for(var f=hl(l),p=f.next();!p.done;p=f.next()){var m;Pd(e,m=p.value)&&!Pd(r.exitSet,m.parent)||r.exitSet.push(m)}}catch(e){c={error:e}}finally{try{p&&!p.done&&(u=f.return)&&u.call(f)}finally{if(c)throw c.error}}var g=Gl(r.entrySet.map((function(e){var t=[];if("final"!==e.type)return t;var o=e.parent;if(!o.parent)return t;t.push(yd(e.id,e.doneData),yd(o.id,e.doneData?Zl(e.doneData,n,i):void 0));var s=o.parent;return"parallel"===s.type&&Id(s).every((function(e){return Ld(r.configuration,e)}))&&t.push(yd(s.id)),t})));r.exitSet.sort((function(e,t){return t.order-e.order})),r.entrySet.sort((function(e,t){return e.order-t.order}));var v=new Set(r.entrySet),y=new Set(r.exitSet),b=fl([Gl(Array.from(v).map((function(e){return pl(pl([],fl(e.activities.map((function(e){return function(e){var t=md(e);return{type:cl.Start,activity:t,exec:void 0}}(e)}))),!1),fl(e.onEntry),!1)}))).concat(g.map(gd)),Gl(Array.from(y).map((function(e){return pl(pl([],fl(e.onExit),!1),fl(e.activities.map((function(e){return function(e){var t=Xl(e)?e:md(e);return{type:cl.Stop,activity:t,exec:void 0}}(e)}))),!1)})))],2),E=b[0],w=b[1],S=pd(w.concat(r.actions).concat(E),this.machine.options.actions);if(t){var _=pd(Gl(pl([],fl(e),!1).sort((function(e,t){return t.order-e.order})).map((function(e){return e.onExit}))),this.machine.options.actions).filter((function(e){return e.type!==vl&&(e.type!==yl||!!e.to&&e.to!==ul.Internal)}));return S.concat(_)}return S},e.prototype.transition=function(e,t,r,n){void 0===e&&(e=this.initialState);var i,o,s=od(t);if(e instanceof Ud)i=void 0===r?e:this.resolveState(Ud.from(e,r));else{var a=ed(e)?this.resolve(Bl(this.getResolvedPath(e))):this.resolve(e),c=null!=r?r:this.machine.context;i=this.resolveState(Ud.from(a,c))}if(!Pl&&s.name===rh)throw new Error("An event cannot have the wildcard type ('".concat(rh,"')"));if(this.strict&&!this.events.includes(s.name)&&(o=s.name,!/^(done|error)\./.test(o)))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(s.name,"'"));var u=this._transition(i.value,i,s)||{transitions:[],configuration:[],entrySet:[],exitSet:[],source:i,actions:[]},l=Rd([],this.getStateNodes(i.value)),d=u.configuration.length?Rd(l,u.configuration):l;return u.configuration=pl([],fl(d),!1),this.resolveTransition(u,i,i.context,n,s)},e.prototype.resolveRaisedTransition=function(e,t,r,n){var i,o=e.actions;return(e=this.transition(e,t,void 0,n))._event=r,e.event=r.data,(i=e.actions).unshift.apply(i,pl([],fl(o),!1)),e},e.prototype.resolveTransition=function(e,t,r,n,i){var o,s,a=this;void 0===i&&(i=dd);var c=e.configuration,u=!t||e.transitions.length>0,l=u?e.configuration:t?t.configuration:[],d=Ld(l,this),h=u?Nd(this.machine,c):void 0,f=t?t.historyValue?t.historyValue:e.source?this.machine.historyValue(t.value):void 0:void 0,p=this.getActions(new Set(l),d,e,r,i,t),m=t?ll({},t.activities):{};try{for(var g=hl(p),v=g.next();!v.done;v=g.next()){var y=v.value;y.type===ml?m[y.activity.id||y.activity.type]=y:y.type===gl&&(m[y.activity.id||y.activity.type]=!1)}}catch(e){o={error:e}}finally{try{v&&!v.done&&(s=g.return)&&s.call(g)}finally{if(o)throw o.error}}var b,E,w=fl(wd(this,t,r,i,p,n,this.machine.config.predictableActionArguments||this.machine.config.preserveActionOrder),2),S=w[0],_=w[1],T=fl(Kl(S,(function(e){return e.type===vl||e.type===yl&&e.to===ul.Internal})),2),x=T[0],A=T[1],I=S.filter((function(e){var t;return e.type===ml&&(null===(t=e.activity)||void 0===t?void 0:t.type)===Tl})),C=I.reduce((function(e,t){return e[t.activity.id]=function(e,t,r,n){var i,o=cd(e.src),s=null===(i=null==t?void 0:t.options.services)||void 0===i?void 0:i[o.type],a=e.data?Zl(e.data,r,n):void 0,c=s?Td(s,e.id,a):_d(e.id);return c.meta=e,c}(t.activity,a.machine,_,i),e}),t?ll({},t.children):{}),R=new Ud({value:h||t.value,context:_,_event:i,_sessionid:t?t._sessionid:null,historyValue:h?f?(b=f,E=h,{current:E,states:Wl(b,E)}):void 0:t?t.historyValue:void 0,history:!h||e.source?t:void 0,actions:h?A:[],activities:h?m:t?t.activities:{},events:[],configuration:l,transitions:e.transitions,children:C,done:d,tags:Dd(l),machine:this}),k=r!==_;R.changed=i.name===Cl||k;var O=R.history;O&&delete O.history;var N=!d&&(this._transient||c.some((function(e){return e._transient})));if(!(u||N&&i.name!==th))return R;var P=R;if(!d)for(N&&(P=this.resolveRaisedTransition(P,{type:El},i,n));x.length;){var L=x.shift();P=this.resolveRaisedTransition(P,L._event,i,n)}var D=P.changed||(O?!!P.actions.length||k||typeof O.value!=typeof P.value||!Md(P.value,O.value):void 0);return P.changed=D,P.history=O,P},e.prototype.getStateNode=function(e){if(ih(e))return this.machine.getStateNodeById(e);if(!this.states)throw new Error("Unable to retrieve child state '".concat(e,"' from '").concat(this.id,"'; no child states exist."));var t=this.states[e];if(!t)throw new Error("Child state '".concat(e,"' does not exist on '").concat(this.id,"'"));return t},e.prototype.getStateNodeById=function(e){var t=ih(e)?e.slice(1):e;if(t===this.id)return this;var r=this.machine.idMap[t];if(!r)throw new Error("Child state node '#".concat(t,"' does not exist on machine '").concat(this.id,"'"));return r},e.prototype.getStateNodeByPath=function(e){if("string"==typeof e&&ih(e))try{return this.getStateNodeById(e.slice(1))}catch(e){}for(var t=Ml(e,this.delimiter).slice(),r=this;t.length;){var n=t.shift();if(!n.length)break;r=r.getStateNode(n)}return r},e.prototype.resolve=function(e){var t,r=this;if(!e)return this.initialStateValue||nh;switch(this.type){case"parallel":return Fl(this.initialStateValue,(function(t,n){return t?r.getStateNode(n).resolve(e[n]||t):nh}));case"compound":if(ed(e)){var n=this.getStateNode(e);return"parallel"===n.type||"compound"===n.type?((t={})[e]=n.initialStateValue,t):e}return Object.keys(e).length?Fl(e,(function(e,t){return e?r.getStateNode(t).resolve(e):nh})):this.initialStateValue||{};default:return e||nh}},e.prototype.getResolvedPath=function(e){if(ih(e)){var t=this.machine.idMap[e.slice(1)];if(!t)throw new Error("Unable to find state node '".concat(e,"'"));return t.path}return Ml(e,this.delimiter)},Object.defineProperty(e.prototype,"initialStateValue",{get:function(){var e,t;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;if("parallel"===this.type)t=jl(this.states,(function(e){return e.initialStateValue||nh}),(function(e){return!("history"===e.type)}));else if(void 0!==this.initial){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));t=xd(this.states[this.initial])?this.initial:((e={})[this.initial]=this.states[this.initial].initialStateValue,e)}else t={};return this.__cache.initialStateValue=t,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),e.prototype.getInitialState=function(e,t){this._init();var r=this.getStateNodes(e);return this.resolveTransition({configuration:r,entrySet:pl([],fl(r),!1),exitSet:[],transitions:[],source:void 0,actions:[]},void 0,null!=t?t:this.machine.context,void 0)},Object.defineProperty(e.prototype,"initialState",{get:function(){var e=this.initialStateValue;if(!e)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){var e;if("history"===this.type){var t=this.config;e=ed(t.target)&&ih(t.target)?Bl(this.machine.getStateNodeById(t.target).path.slice(this.path.length-1)):t.target}return e},enumerable:!1,configurable:!0}),e.prototype.getRelativeStateNodes=function(e,t,r){return void 0===r&&(r=!0),r?"history"===e.type?e.resolveHistory(t):e.initialStateNodes:[e]},Object.defineProperty(e.prototype,"initialStateNodes",{get:function(){var e=this;return xd(this)?[this]:"compound"!==this.type||this.initial?Gl(Hl(this.initialStateValue).map((function(t){return e.getFromRelativePath(t)}))):(Pl||Yl(!1,"Compound state node '".concat(this.id,"' has no initial state.")),[this])},enumerable:!1,configurable:!0}),e.prototype.getFromRelativePath=function(e){if(!e.length)return[this];var t=fl(e),r=t[0],n=t.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(r,"' from node with no states"));var i=this.getStateNode(r);if("history"===i.type)return i.resolveHistory();if(!this.states[r])throw new Error("Child state '".concat(r,"' does not exist on '").concat(this.id,"'"));return this.states[r].getFromRelativePath(n)},e.prototype.historyValue=function(e){if(Object.keys(this.states).length)return{current:e||this.initialStateValue,states:jl(this.states,(function(t,r){if(!e)return t.historyValue();var n=ed(e)?void 0:e[r];return t.historyValue(n||t.initialStateValue)}),(function(e){return!e.history}))}},e.prototype.resolveHistory=function(e){var t=this;if("history"!==this.type)return[this];var r=this.parent;if(!e){var n=this.target;return n?Gl(Hl(n).map((function(e){return r.getFromRelativePath(e)}))):r.initialStateNodes}var i,o,s=(i=r.path,o="states",function(e){var t,r,n=e;try{for(var s=hl(i),a=s.next();!a.done;a=s.next()){var c=a.value;n=n[o][c]}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}return n})(e).current;return ed(s)?[r.getStateNode(s)]:Gl(Hl(s).map((function(e){return"deep"===t.history?r.getFromRelativePath(e):[r.states[e[0]]]})))},Object.defineProperty(e.prototype,"stateIds",{get:function(){var e=this,t=Gl(Object.keys(this.states).map((function(t){return e.states[t].stateIds})));return[this.id].concat(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"events",{get:function(){var e,t,r,n;if(this.__cache.events)return this.__cache.events;var i=this.states,o=new Set(this.ownEvents);if(i)try{for(var s=hl(Object.keys(i)),a=s.next();!a.done;a=s.next()){var c=i[a.value];if(c.states)try{for(var u=(r=void 0,hl(c.events)),l=u.next();!l.done;l=u.next()){var d=l.value;o.add("".concat(d))}}catch(e){r={error:e}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}return this.__cache.events=Array.from(o)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ownEvents",{get:function(){var e=new Set(this.transitions.filter((function(e){return!(!e.target&&!e.actions.length&&e.internal)})).map((function(e){return e.eventType})));return Array.from(e)},enumerable:!1,configurable:!0}),e.prototype.resolveTarget=function(e){var t=this;if(void 0!==e)return e.map((function(e){if(!ed(e))return e;var r=e[0]===t.delimiter;if(r&&!t.parent)return t.getStateNodeByPath(e.slice(1));var n=r?t.key+e:e;if(!t.parent)return t.getStateNodeByPath(n);try{return t.parent.getStateNodeByPath(n)}catch(e){throw new Error("Invalid transition definition for state node '".concat(t.id,"':\n").concat(e.message))}}))},e.prototype.formatTransition=function(e){var t=this,r=function(e){if(void 0!==e&&""!==e)return $l(e)}(e.target),n="internal"in e?e.internal:!r||r.some((function(e){return ed(e)&&e[0]===t.delimiter})),i=this.machine.options.guards,o=this.resolveTarget(r),s=ll(ll({},e),{actions:pd($l(e.actions)),cond:td(e.cond,i),target:o,source:this,internal:n,eventType:e.event,toJSON:function(){return ll(ll({},s),{target:s.target?s.target.map((function(e){return"#".concat(e.id)})):void 0,source:"#".concat(t.id)})}});return s},e.prototype.formatTransitions=function(){var e,t,r,n=this;if(this.config.on)if(Array.isArray(this.config.on))r=this.config.on;else{var i=this.config.on,o=rh,s=i[o],a=void 0===s?[]:s,c=dl(i,["*"]);r=Gl(Object.keys(c).map((function(e){Pl||e!==th||Yl(!1,"Empty string transition configs (e.g., `{ on: { '': ... }}`) for transient transitions are deprecated. Specify the transition in the `{ always: ... }` property instead. "+'Please check the `on` configuration for "#'.concat(n.id,'".'));var t=sd(e,c[e]);return Pl||function(e,t,r){var n=r.slice(0,-1).some((function(e){return!("cond"in e)&&!("in"in e)&&(ed(e.target)||nd(e.target))})),i=t===th?"the transient event":"event '".concat(t,"'");Yl(!n,"One or more transitions for ".concat(i," on state '").concat(e.id,"' are unreachable. ")+"Make sure that the default transition is the last one defined.")}(n,e,t),t})).concat(sd(rh,a)))}else r=[];var u=this.config.always?sd("",this.config.always):[],l=this.config.onDone?sd(String(yd(this.id)),this.config.onDone):[];Pl||Yl(!(this.config.onDone&&!this.parent),'Root nodes cannot have an ".onDone" transition. Please check the config of "'.concat(this.id,'".'));var d=Gl(this.invoke.map((function(e){var t=[];return e.onDone&&t.push.apply(t,pl([],fl(sd(String(bd(e.id)),e.onDone)),!1)),e.onError&&t.push.apply(t,pl([],fl(sd(String(Ed(e.id)),e.onError)),!1)),t}))),h=this.after,f=Gl(pl(pl(pl(pl([],fl(l),!1),fl(d),!1),fl(r),!1),fl(u),!1).map((function(e){return $l(e).map((function(e){return n.formatTransition(e)}))})));try{for(var p=hl(h),m=p.next();!m.done;m=p.next()){var g=m.value;f.push(g)}}catch(t){e={error:t}}finally{try{m&&!m.done&&(t=p.return)&&t.call(p)}finally{if(e)throw e.error}}return f},e}(),sh=!1;var ah=function(e){return{type:wl,assignment:e}};function ch(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function uh(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ch(Object(r),!0).forEach((function(t){z(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ch(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var lh=4294967294;class dh extends Te{constructor(e,t,r,n,i){super(),z(this,"id",void 0),z(this,"createLocalOfferCallback",void 0),z(this,"handleRemoteOfferCallback",void 0),z(this,"handleRemoteAnswerCallback",void 0),z(this,"stateMachine",void 0),z(this,"initiateOfferPromises",void 0),this.id=n||"ROAP",this.createLocalOfferCallback=e,this.handleRemoteOfferCallback=t,this.handleRemoteAnswerCallback=r,this.initiateOfferPromises=[];var o=function(e,t){return Pl||e.predictableActionArguments||sh||(sh=!0,console.warn("It is highly recommended to set `predictableActionArguments` to `true` when using `createMachine`. https://xstate.js.org/docs/guides/actions.html")),new oh(e,t)}({tsTypes:{},schema:{context:{},events:{},services:{}},preserveActionOrder:!0,id:"roap",initial:"idle",context:{seq:i||0,pendingLocalOffer:!1,isHandlingOfferRequest:!1,retryCounter:0,isOkInTransaction:true},states:{browserError:{onEntry:(e,t)=>{this.error("FSM","browserError state onEntry: context=".concat(JSON.stringify(e),":"),t.data),this.emit(Hc.ROAP_FAILURE,t.data)}},remoteError:{onEntry:(e,t)=>{this.log("FSM","remoteError state onEntry called, emitting Event.ROAP_FAILURE"),this.emit(Hc.ROAP_FAILURE,t.data)}},idle:{always:{cond:"isPendingLocalOffer",actions:["increaseSeq","sendStartedEvent"],target:"creatingLocalOffer"},on:{INITIATE_OFFER:{actions:["increaseSeq","sendStartedEvent"],target:"creatingLocalOffer"},REMOTE_OFFER_ARRIVED:[{cond:"isSameSeq",actions:"sendOutOfOrderError"},{actions:["updateSeq","sendStartedEvent"],target:"settingRemoteOffer"}],REMOTE_OFFER_REQUEST_ARRIVED:[{cond:"isSameSeq",actions:"sendOutOfOrderError"},{actions:["updateSeq","setOfferRequestFlag","sendStartedEvent"],target:"creatingLocalOffer"}],REMOTE_ANSWER_ARRIVED:[{cond:"isSameSeq",actions:"sendRoapOKMessage"},{actions:"sendInvalidStateError"}],REMOTE_OK_ARRIVED:{actions:"sendInvalidStateError"}}},creatingLocalOffer:{invoke:{src:"createLocalOffer",onDone:[{cond:"isPendingLocalOffer",target:"creatingLocalOffer"},{cond:"isHandlingOfferRequest",actions:["sendRoapOfferResponseMessage","resolvePendingInitiateOfferPromises"],target:"waitingForAnswer"},{actions:["sendRoapOfferMessage","resolvePendingInitiateOfferPromises"],target:"waitingForAnswer"}],onError:{actions:"rejectPendingInitiateOfferPromises",target:"browserError"}},onEntry:["resetPendingLocalOffer"],on:{INITIATE_OFFER:{actions:"enqueueNewOfferCreation"},REMOTE_OFFER_ARRIVED:[{actions:"handleGlare"}],REMOTE_OFFER_REQUEST_ARRIVED:[{cond:"isHandlingOfferRequest",actions:"ignoreDuplicate"},{actions:"handleGlare"}],REMOTE_ANSWER_ARRIVED:{actions:"sendInvalidStateError"},REMOTE_OK_ARRIVED:{actions:"sendInvalidStateError"}}},waitingForAnswer:{on:{REMOTE_ANSWER_ARRIVED:[{actions:["resetRetryCounter","updateSeq","updateIsOkInTransaction"],target:"settingRemoteAnswer"}],INITIATE_OFFER:{actions:"enqueueNewOfferCreation"},REMOTE_OFFER_ARRIVED:{actions:"handleGlare"},REMOTE_OFFER_REQUEST_ARRIVED:[{cond:"isHandlingOfferRequest",actions:"ignoreDuplicate"},{actions:"handleGlare"}],REMOTE_OK_ARRIVED:{actions:"sendInvalidStateError"},ERROR_ARRIVED:[{cond:"shouldErrorTriggerOfferRetry",actions:["increaseSeq","increaseRetryCounter"],target:"creatingLocalOffer"},{cond:"isSameSeq",target:"remoteError"}]}},settingRemoteAnswer:{invoke:{src:"handleRemoteAnswer",onDone:[{cond:"isOkInTransaction",actions:["sendRoapOKMessage","resetOfferRequestFlag","sendDoneEvent"],target:"idle"},{actions:["resetOfferRequestFlag","sendDoneEvent"],target:"idle"}],onError:{actions:"sendGenericError",target:"browserError"}},on:{INITIATE_OFFER:{actions:"enqueueNewOfferCreation"},REMOTE_OFFER_ARRIVED:{actions:"sendInvalidStateError"},REMOTE_OFFER_REQUEST_ARRIVED:{actions:"sendInvalidStateError"},REMOTE_ANSWER_ARRIVED:[{cond:"isSameSeq",actions:"ignoreDuplicate"},{actions:"sendInvalidStateError"}],REMOTE_OK_ARRIVED:{actions:"sendInvalidStateError"}}},settingRemoteOffer:{invoke:{src:"handleRemoteOffer",onDone:{actions:["resetOkInTransaction","sendRoapAnswerMessage"],target:"waitingForOK"},onError:{actions:"sendGenericError",target:"browserError"}},on:{INITIATE_OFFER:{actions:"enqueueNewOfferCreation"},REMOTE_OFFER_ARRIVED:[{cond:"isSameSeq",actions:"ignoreDuplicate"},{actions:"sendRetryAfterError"}],REMOTE_OFFER_REQUEST_ARRIVED:{actions:"sendInvalidStateError"},REMOTE_ANSWER_ARRIVED:{actions:"sendInvalidStateError"},REMOTE_OK_ARRIVED:{actions:"sendInvalidStateError"}}},waitingForOK:{on:{REMOTE_OK_ARRIVED:[{actions:["updateSeq","sendDoneEvent"],target:"idle"}],INITIATE_OFFER:{actions:"enqueueNewOfferCreation"},REMOTE_OFFER_ARRIVED:[{cond:"isSameSeq",actions:"ignoreDuplicate"},{actions:"sendInvalidStateError"}],REMOTE_OFFER_REQUEST_ARRIVED:{actions:"sendInvalidStateError"},REMOTE_ANSWER_ARRIVED:{actions:"sendInvalidStateError"},ERROR_ARRIVED:{cond:"isSameSeq",target:"remoteError"}}}}},{services:{createLocalOffer:()=>this.createLocalOfferCallback(),handleRemoteAnswer:(e,t)=>this.handleRemoteAnswerCallback(t.sdp),handleRemoteOffer:(e,t)=>this.handleRemoteOfferCallback(t.sdp)},actions:{enqueueNewOfferCreation:ah((e=>uh(uh({},e),{},{pendingLocalOffer:!0}))),resetPendingLocalOffer:ah((e=>uh(uh({},e),{},{pendingLocalOffer:!1}))),increaseSeq:ah((e=>uh(uh({},e),{},{seq:e.seq+1}))),updateSeq:ah(((e,t)=>uh(uh({},e),{},{seq:t.seq}))),increaseRetryCounter:ah((e=>uh(uh({},e),{},{retryCounter:e.retryCounter+1}))),resetRetryCounter:ah((e=>uh(uh({},e),{},{retryCounter:0}))),setOfferRequestFlag:ah((e=>uh(uh({},e),{},{isHandlingOfferRequest:!0}))),resetOfferRequestFlag:ah((e=>uh(uh({},e),{},{isHandlingOfferRequest:!1}))),handleGlare:(e,t)=>{t.tieBreaker===lh?this.sendErrorMessage(t.seq,qc.DOUBLECONFLICT):this.sendErrorMessage(t.seq,qc.CONFLICT)},sendRoapOfferMessage:(e,t)=>this.sendRoapOfferMessage(e.seq,t.data.sdp),sendRoapOfferResponseMessage:(e,t)=>this.sendRoapOfferResponseMessage(e.seq,t.data.sdp),sendRoapOKMessage:e=>this.sendRoapOkMessage(e.seq),sendRoapAnswerMessage:(e,t)=>this.sendRoapAnswerMessage(e.seq,t.data.sdp),sendStartedEvent:()=>this.sendStartedEvent(),sendDoneEvent:()=>this.sendDoneEvent(),sendGenericError:e=>this.sendErrorMessage(e.seq,qc.FAILED),sendInvalidStateError:(e,t)=>this.sendErrorMessage(t.seq,qc.INVALID_STATE),sendOutOfOrderError:(e,t)=>this.sendErrorMessage(t.seq,qc.OUT_OF_ORDER),sendRetryAfterError:(e,t)=>this.sendErrorMessage(t.seq,qc.FAILED,{retryAfter:Math.floor(11*Math.random())}),ignoreDuplicate:(e,t)=>this.log("FSM","ignoring duplicate roap message ".concat(t.type," with seq=").concat(t.seq)),resolvePendingInitiateOfferPromises:()=>this.resolvePendingInitiateOfferPromises(),rejectPendingInitiateOfferPromises:(e,t)=>this.rejectPendingInitiateOfferPromises(t.data),updateIsOkInTransaction:ah(((e,t)=>{var r;return uh(uh({},e),{},{isOkInTransaction:!(null!==(r=t.headers)&&void 0!==r&&r.includes("noOkInTransaction"))})})),resetOkInTransaction:ah((e=>uh(uh({},e),{},{isOkInTransaction:true})))},guards:{isPendingLocalOffer:e=>e.pendingLocalOffer,isHandlingOfferRequest:e=>e.isHandlingOfferRequest,isSameSeq:(e,t)=>t.seq===e.seq&&(this.log("FSM","incoming roap message seq is same as current context seq: ".concat(t.seq)),!0),shouldErrorTriggerOfferRetry:(e,t)=>{if([qc.DOUBLECONFLICT,qc.INVALID_STATE,qc.OUT_OF_ORDER,qc.RETRY].includes(t.errorType)){if(t.seq===e.seq&&e.retryCounter<2)return this.log("FSM","retryable error message received with matching seq and retryCounter ".concat(e.retryCounter," < ").concat(2)),!0;t.seq!==e.seq?this.log("FSM","ignoring error message with wrong seq: ".concat(t.seq," !== ").concat(e.seq)):this.log("FSM","reached max retries: retryCounter=".concat(e.retryCounter))}return!1},isOkInTransaction:e=>e.isOkInTransaction}});this.stateMachine=Qd(o).onTransition(((e,t)=>this.log("onTransition","state=".concat(e.value,", event=").concat(JSON.stringify(t))))).start()}log(e,t){Ka().info("".concat(this.id,":").concat(e," ").concat(t))}error(e,t,r){Ka().error("".concat(this.id,":").concat(e," ").concat(t," ").concat(Ja(r)))}sendRoapOfferMessage(e,t){this.log("sendRoapOfferMessage","emitting ROAP OFFER"),this.emit(Hc.ROAP_MESSAGE_TO_SEND,{roapMessage:{seq:e,messageType:"OFFER",sdp:t,tieBreaker:lh}})}sendRoapOfferResponseMessage(e,t){this.log("sendRoapOfferResponseMessage","emitting ROAP OFFER RESPONSE"),this.emit(Hc.ROAP_MESSAGE_TO_SEND,{roapMessage:{seq:e,messageType:"OFFER_RESPONSE",sdp:t}})}sendRoapOkMessage(e){this.log("sendRoapOkMessage","emitting ROAP OK"),this.emit(Hc.ROAP_MESSAGE_TO_SEND,{roapMessage:{seq:e,messageType:"OK"}})}sendRoapAnswerMessage(e,t){this.log("sendRoapAnswerMessage","emitting ROAP ANSWER"),this.emit(Hc.ROAP_MESSAGE_TO_SEND,{roapMessage:{seq:e,messageType:"ANSWER",sdp:t}})}sendDoneEvent(){this.log("sendDoneEvent","emitting ROAP DONE"),this.emit(Hc.ROAP_DONE)}sendStartedEvent(){this.log("sendStartedEvent","emitting ROAP STARTED"),this.emit(Hc.ROAP_STARTED)}sendErrorMessage(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{retryAfter:n}=r;this.log("sendErrorMessage","emitting ROAP ERROR (".concat(t,")")),this.emit(Hc.ROAP_MESSAGE_TO_SEND,{roapMessage:{seq:e,messageType:"ERROR",errorType:t,retryAfter:n}})}getStateMachine(){return this.stateMachine}initiateOffer(){return new Promise(((e,t)=>{this.initiateOfferPromises.push({resolve:e,reject:t}),this.stateMachine.send("INITIATE_OFFER")}))}resolvePendingInitiateOfferPromises(){for(;this.initiateOfferPromises.length>0;){var e=this.initiateOfferPromises.shift();null==e||e.resolve()}}rejectPendingInitiateOfferPromises(e){for(;this.initiateOfferPromises.length>0;){var t=this.initiateOfferPromises.shift();null==t||t.reject(e)}}validateIncomingRoapMessage(e){var t,{errorType:r,messageType:n,seq:i}=e,o=!0;return i<this.stateMachine.state.context.seq&&(o=!1,"ERROR"!==n?(t=qc.OUT_OF_ORDER,this.error("validateIncomingRoapMessage","received roap message ".concat(n," with seq too low: ").concat(i," < ").concat(this.stateMachine.state.context.seq))):this.error("validateIncomingRoapMessage","received ERROR message ".concat(r," with seq too low: ").concat(i," < ").concat(this.stateMachine.state.context.seq,", ignoring it"))),{isValid:o,errorToSend:t}}roapMessageReceived(e){var{errorCause:t,errorType:r,headers:n,messageType:i,sdp:o,seq:s,tieBreaker:a}=e,{isValid:c,errorToSend:u}=this.validateIncomingRoapMessage(e);if(c)switch(i){case"ANSWER":this.stateMachine.send("REMOTE_ANSWER_ARRIVED",{sdp:o,seq:s,headers:n});break;case"OFFER":this.stateMachine.send("REMOTE_OFFER_ARRIVED",{sdp:o,seq:s,tieBreaker:a});break;case"OFFER_REQUEST":this.stateMachine.send("REMOTE_OFFER_REQUEST_ARRIVED",{seq:s,tieBreaker:a});break;case"OK":this.stateMachine.send("REMOTE_OK_ARRIVED",{sdp:o,seq:s});break;case"ERROR":this.error("roapMessageReceived","Error received: seq=".concat(s," type=").concat(r," cause=").concat(t)),r===qc.CONFLICT&&this.error("roapMessageReceived","CONFLICT error type received - this should never happen, because we use the tieBreaker value ".concat(lh)),this.stateMachine.send("ERROR_ARRIVED",{seq:s,errorType:r});break;case"OFFER_RESPONSE":this.error("roapMessageReceived","Received unexpected OFFER_RESPONSE: seq=".concat(s));break;default:throw this.error("roapMessageReceived()","unsupported messageType: ".concat(i)),new Error("unhandled messageType")}else u&&this.sendErrorMessage(s,u)}stop(){this.stateMachine.stop()}getSeq(){return this.stateMachine.state.context.seq}}function hh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function fh(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?hh(Object(r),!0).forEach((function(t){z(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hh(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class ph extends Te{constructor(e,t,r){super(),z(this,"id",void 0),z(this,"debugId",void 0),z(this,"mediaConnection",void 0),z(this,"roap",void 0),z(this,"sdpNegotiationStarted",void 0),this.debugId=r,this.id=r||"RoapMediaConnection",this.sdpNegotiationStarted=!1,Wa(r),this.log("constructor()","config: ".concat(JSON.stringify(e),", options: ").concat(JSON.stringify(t))),this.mediaConnection=this.createMediaConnection(e,t,r),this.roap=this.createRoap(r)}log(e,t){Ka().info("".concat(this.id,":").concat(e," ").concat(t))}error(e,t,r){Ka().error("".concat(this.id,":").concat(e," ").concat(t," ").concat(Ja(r)))}forwardEvent(e,t){var r=this;e.on(t,(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];r.emit(t,...n)}))}createMediaConnection(e,t,r){var n=new iu(e,t,r);return n.on(Hc.REMOTE_TRACK_ADDED,this.onRemoteTrack.bind(this)),n.on(Hc.CONNECTION_STATE_CHANGED,this.onConnectionStateChanged.bind(this)),this.forwardEvent(n,Hc.REMOTE_SDP_ANSWER_PROCESSED),this.forwardEvent(n,Hc.REMOTE_SDP_OFFER_PROCESSED),this.forwardEvent(n,Hc.LOCAL_SDP_ANSWER_GENERATED),this.forwardEvent(n,Hc.LOCAL_SDP_OFFER_GENERATED),this.forwardEvent(n,Hc.DTMF_TONE_CHANGED),n}createRoap(e,t){var r=new dh(this.createLocalOffer.bind(this),this.handleRemoteOffer.bind(this),this.handleRemoteAnswer.bind(this),e,t);return r.on(Hc.ROAP_MESSAGE_TO_SEND,(e=>this.emit(Hc.ROAP_MESSAGE_TO_SEND,e))),r.on(Hc.ROAP_STARTED,(()=>this.emit(Hc.ROAP_STARTED))),r.on(Hc.ROAP_DONE,(()=>this.emit(Hc.ROAP_DONE))),r.on(Hc.ROAP_FAILURE,(e=>this.emit(Hc.ROAP_FAILURE,e))),r}initiateOffer(){return this.log("initiateOffer()","called"),this.sdpNegotiationStarted?(this.error("initiateOffer()","SDP negotiation already started"),Promise.reject(new Error("SDP negotiation already started"))):(this.mediaConnection.initializeTransceivers(!1),this.sdpNegotiationStarted=!0,this.roap.initiateOffer())}close(){this.log("close()","called"),this.closeMediaConnection(),this.stopRoapSession()}closeMediaConnection(){this.mediaConnection.close(),this.mediaConnection.removeAllListeners()}stopRoapSession(){this.roap.stop(),this.roap.removeAllListeners()}reconnect(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.log("reconnect()","iceServers: ".concat(JSON.stringify(e)));var r=fh(fh({},this.mediaConnection.getConfig()),{},{iceServers:e}),n=this.mediaConnection.getSendReceiveOptions(),i=this.roap.getSeq();return this.stopRoapSession(),this.closeMediaConnection(),this.sdpNegotiationStarted=!1,this.mediaConnection=this.createMediaConnection(r,n,this.debugId),this.roap=this.createRoap(this.debugId,i),t?this.initiateOffer():Promise.resolve()}updateLocalTracks(e){return this.log("updateLocalTracks()","called with ".concat(JSON.stringify(e))),this.mediaConnection.updateLocalTracks(e)?(this.log("updateLocalTracks()","triggering offer..."),this.roap.initiateOffer()):Promise.resolve()}updateDirection(e){return this.log("updateDirection()","called with ".concat(JSON.stringify(e))),this.mediaConnection.updateDirection(e)?(this.log("updateDirection()","triggering offer..."),this.roap.initiateOffer()):Promise.resolve()}updateRemoteQualityLevel(e){return this.log("updateRemoteQualityLevel()","called with ".concat(e)),this.mediaConnection.updateRemoteQualityLevel(e)?(this.log("updateRemoteQualityLevel()","triggering offer..."),this.roap.initiateOffer()):Promise.resolve()}update(e){return this.log("update()","called with ".concat(JSON.stringify(e))),this.mediaConnection.update(e)?(this.log("update()","triggering offer..."),this.roap.initiateOffer()):Promise.resolve()}getConnectionState(){return this.mediaConnection.getConnectionState()}getStats(){return this.mediaConnection.getStats()}getTransceiverStats(){return this.mediaConnection.getTransceiverStats()}insertDTMF(e,t,r){this.log("insertDTMF()",'called with tones="'.concat(e,'", duration=').concat(t,", interToneGap=").concat(r)),this.mediaConnection.insertDTMF(e,t,r)}roapMessageReceived(e){this.log("roapMessageReceived()","called with messageType=".concat(e.messageType,", seq=").concat(e.seq)),this.sdpNegotiationStarted||("OFFER"===e.messageType&&(this.sdpNegotiationStarted=!0,this.mediaConnection.initializeTransceivers(!0)),"OFFER_REQUEST"===e.messageType&&(this.sdpNegotiationStarted=!0,this.mediaConnection.initializeTransceivers(!1))),this.roap.roapMessageReceived(e)}onRemoteTrack(e){this.emit(Hc.REMOTE_TRACK_ADDED,e)}onConnectionStateChanged(e){this.emit(Hc.CONNECTION_STATE_CHANGED,e)}createLocalOffer(){return this.mediaConnection.createLocalOffer()}handleRemoteOffer(e){return this.mediaConnection.handleRemoteOffer(e)}handleRemoteAnswer(e){return this.mediaConnection.handleRemoteAnswer(e)}}function mh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}class gh extends J{constructor(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:()=>{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>{};super(),z(this,"id",void 0),z(this,"debugId",void 0),z(this,"multistreamConnection",void 0),z(this,"roap",void 0),z(this,"sdpNegotiationStarted",!1),z(this,"closeCallback",void 0),z(this,"sendMetricsCallback",void 0),this.debugId=t,this.id=t||"MultistreamRoapMediaConnection",Wa(t),this.log("constructor()","config: ".concat(JSON.stringify(e))),this.multistreamConnection=this.createMultistreamConnection(e,r),this.roap=this.createRoap(t),this.closeCallback=n,this.sendMetricsCallback=i}log(e,t){Ka().info("".concat(this.id,":").concat(e," ").concat(t))}error(e,t,r){Ka().error("".concat(this.id,":").concat(e," ").concat(t," ").concat(Ja(r)))}createMultistreamConnection(e,t){this.log("createMultistreamConnection()","called");var r=new Ba(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?mh(Object(r),!0).forEach((function(t){z(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mh(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e));return r.on(Da.ActiveSpeakerNotification,(e=>{this.emit(Hc.ACTIVE_SPEAKERS_CHANGED,e)})),r.on(Da.AudioSourceCountUpdate,((e,t,r)=>{this.emit(Hc.AUDIO_SOURCES_COUNT_CHANGED,e,t,r)})),r.on(Da.VideoSourceCountUpdate,((e,t,r)=>{this.emit(Hc.VIDEO_SOURCES_COUNT_CHANGED,e,t,r)})),r.on(Da.ConnectionStateUpdate,(e=>{this.emit(Hc.CONNECTION_STATE_CHANGED,{state:e})})),r.on(Da.NegotiationNeeded,(()=>{this.onNegotiationNeeded()})),r.setMetricsCallback(t),r}createRoap(e,t){var r=new dh(this.createLocalOffer.bind(this),this.handleRemoteOffer.bind(this),this.handleRemoteAnswer.bind(this),e,t);return r.on(Hc.ROAP_MESSAGE_TO_SEND,(e=>this.emit(Hc.ROAP_MESSAGE_TO_SEND,e))),r.on(Hc.ROAP_STARTED,(()=>this.emit(Hc.ROAP_STARTED))),r.on(Hc.ROAP_DONE,(()=>this.emit(Hc.ROAP_DONE))),r.on(Hc.ROAP_FAILURE,(e=>this.emit(Hc.ROAP_FAILURE,e))),r}onNegotiationNeeded(){return this.log("onNegotiationNeeded()","called"),this.sdpNegotiationStarted?this.roap.initiateOffer():Promise.resolve()}initiateOffer(){return this.log("initiateOffer()","called"),this.sdpNegotiationStarted?(this.error("initiateOffer()","SDP negotiation already started"),Promise.reject(new Error("SDP negotiation already started"))):(this.sdpNegotiationStarted=!0,this.roap.initiateOffer())}close(){this.log("close()","called"),this.closeMediaConnection(),this.stopRoapSession(),this.closeCallback()}forceRtcMetricsSend(){var e=this;return q((function*(){var t;yield null===(t=e.multistreamConnection)||void 0===t?void 0:t.forceRtcMetricsCallback(),e.sendMetricsCallback()}))()}closeMediaConnection(){this.multistreamConnection.close(),this.multistreamConnection.removeAllListeners()}stopRoapSession(){this.roap.stop(),this.roap.removeAllListeners()}reconnect(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.log("reconnect()","iceServers: ".concat(JSON.stringify(e)));var r=this.roap.getSeq();return this.stopRoapSession(),this.sdpNegotiationStarted=!1,this.multistreamConnection.renewPeerConnection({iceServers:e}),this.roap=this.createRoap(this.debugId,r),t?this.initiateOffer():Promise.resolve()}getConnectionState(){var e=this.multistreamConnection.getConnectionState();return this.log("getConnectionState()","called, returning ".concat(e)),e}getStats(){return this.multistreamConnection.getStats()}getTransceiverStats(){return this.multistreamConnection.getTransceiverStats()}roapMessageReceived(e){if(this.log("roapMessageReceived()","called with messageType=".concat(e.messageType,", seq=").concat(e.seq)),!this.sdpNegotiationStarted&&"OFFER"===e.messageType)throw new Error("incoming first offer is not supported by MultistreamRoapMediaConnection");this.roap.roapMessageReceived(e)}createSendSlot(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.log("createSendSlot()","called with mediaType=".concat(e,", active=").concat(t)),this.multistreamConnection.createSendSlot(e,t)}createReceiveSlot(e){return this.log("createReceiveSlot()","called"),this.multistreamConnection.createReceiveSlot(e)}requestMedia(e,t){return this.log("requestMedia()","called"),this.multistreamConnection.requestMedia(e,t)}createLocalOffer(){return this.log("createLocalOffer()","calling this.multistreamConnection.createOffer"),this.multistreamConnection.createOffer().then((e=>e.sdp?(this.emit(Hc.LOCAL_SDP_OFFER_GENERATED),{sdp:e.sdp}):Promise.reject(new Ee("empty local SDP")))).catch((e=>{throw new Ee("createLocalOffer() failure: ".concat(e.message),{cause:e})}))}handleRemoteOffer(){return Promise.reject(new Se("remote offers not supported by WCME"))}handleRemoteAnswer(e){if(this.log("handleRemoteAnswer()","called: sdp=".concat(e?"non-empty":"empty")),e){var t=eu({},e);return t=t.replace(/\r\nb=TIAS:.*\r\n/g,"\r\n"),this.log("handleRemoteAnswer()","calling this.multistreamConnection.setAnswer"),this.multistreamConnection.setAnswer(t).then((e=>(this.log("handleRemoteAnswer()","this.multistreamConnection.setAnswer resolved"),this.emit(Hc.REMOTE_SDP_ANSWER_PROCESSED),e))).catch((e=>{throw this.log("handleRemoteAnswer()","this.multistreamConnection.setAnswer failed"),new ye("handleRemoteAnswer() failure: ".concat(e.message),{cause:e})}))}return Promise.reject(new ye("empty answer"))}}var vh=_e,yh=r(42437),bh=r(44221);function Eh(){return Eh="undefined"!=typeof Reflect&&yh?yh.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,C.Z)(e)););return e}(e,t);if(n){var i=bh(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},Eh.apply(this,arguments)}var wh,Sh={exports:{}},_h="object"==typeof Reflect?Reflect:null,Th=_h&&"function"==typeof _h.apply?_h.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};wh=_h&&"function"==typeof _h.ownKeys?_h.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var xh=Number.isNaN||function(e){return e!=e};function Ah(){Ah.init.call(this)}Sh.exports=Ah,Sh.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}Bh(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&Bh(e,"error",t,r)}(e,i,{once:!0})}))},Ah.EventEmitter=Ah,Ah.prototype._events=void 0,Ah.prototype._eventsCount=0,Ah.prototype._maxListeners=void 0;var Ih,Ch,Rh=10;function kh(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function Oh(e){return void 0===e._maxListeners?Ah.defaultMaxListeners:e._maxListeners}function Nh(e,t,r,n){var i,o,s,a;if(kh(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]),void 0===s)s=o[t]=r,++e._eventsCount;else if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=Oh(e))>0&&s.length>i&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,a=c,console&&console.warn&&console.warn(a)}return e}function Ph(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Lh(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=Ph.bind(n);return i.listener=r,n.wrapFn=i,i}function Dh(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):Uh(i,i.length)}function Mh(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function Uh(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function Bh(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}Object.defineProperty(Ah,"defaultMaxListeners",{enumerable:!0,get:function(){return Rh},set:function(e){if("number"!=typeof e||e<0||xh(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Rh=e}}),Ah.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Ah.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||xh(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},Ah.prototype.getMaxListeners=function(){return Oh(this)},Ah.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var a=i[e];if(void 0===a)return!1;if("function"==typeof a)Th(a,this,t);else{var c=a.length,u=Uh(a,c);for(r=0;r<c;++r)Th(u[r],this,t)}return!0},Ah.prototype.addListener=function(e,t){return Nh(this,e,t,!1)},Ah.prototype.on=Ah.prototype.addListener,Ah.prototype.prependListener=function(e,t){return Nh(this,e,t,!0)},Ah.prototype.once=function(e,t){return kh(t),this.on(e,Lh(this,e,t)),this},Ah.prototype.prependOnceListener=function(e,t){return kh(t),this.prependListener(e,Lh(this,e,t)),this},Ah.prototype.removeListener=function(e,t){var r,n,i,o,s;if(kh(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},Ah.prototype.off=Ah.prototype.removeListener,Ah.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},Ah.prototype.listeners=function(e){return Dh(this,e,!0)},Ah.prototype.rawListeners=function(e){return Dh(this,e,!1)},Ah.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):Mh.call(e,t)},Ah.prototype.listenerCount=Mh,Ah.prototype.eventNames=function(){return this._eventsCount>0?wh(this._events):[]};class Fh extends Sh.exports.EventEmitter{}class jh{constructor(){this.emitter=new Fh}on(e){this.emitter.on("event",e)}once(e){this.emitter.once("event",e)}off(e){this.emitter.off("event",e)}emit(...e){this.emitter.emit("event",...e)}}function Vh(e){return class extends e{on(e,t){this[e].on(t)}once(e,t){this[e].once(t)}off(e,t){this[e].off(t)}}}function Hh(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var Gh=function(e){return e.ServerMuted="muted:byServer",e}({}),qh=function(e){return e.ServerMuted="muted:byServer",e}({});Ih=Gh.ServerMuted;var $h=function(e){(0,A.Z)(r,e);var t=Hh(r);function r(){var e;(0,k.Z)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,R.Z)((0,x.Z)(e),"unmuteAllowed",!0),(0,R.Z)((0,x.Z)(e),Ih,new jh),e}return(0,O.Z)(r,[{key:"setUnmuteAllowed",value:function(e){this.unmuteAllowed=e}},{key:"isUnmuteAllowed",value:function(){return this.unmuteAllowed}},{key:"setMuted",value:function(e){if(!e&&!this.isUnmuteAllowed())throw new Error("Unmute is not allowed");return Eh((0,C.Z)(r.prototype),"setMuted",this).call(this,e)}},{key:"setServerMuted",value:function(e,t){e!==this.muted&&(this.setMuted(e),this[Gh.ServerMuted].emit(e,t))}}]),r}(Zt);Ch=qh.ServerMuted;var Zh=function(e){(0,A.Z)(r,e);var t=Hh(r);function r(){var e;(0,k.Z)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,R.Z)((0,x.Z)(e),"unmuteAllowed",!0),(0,R.Z)((0,x.Z)(e),Ch,new jh),e}return(0,O.Z)(r,[{key:"setUnmuteAllowed",value:function(e){this.unmuteAllowed=e}},{key:"isUnmuteAllowed",value:function(){return this.unmuteAllowed}},{key:"setMuted",value:function(e){if(!e&&!this.isUnmuteAllowed())throw new Error("Unmute is not allowed");return Eh((0,C.Z)(r.prototype),"setMuted",this).call(this,e)}},{key:"setServerMuted",value:function(e,t){e!==this.muted&&(this.setMuted(e),this[qh.ServerMuted].emit(e,t))}}]),r}(qt),zh=function(e){return function(e,t){return Ye(this,void 0,void 0,(function*(){var r;try{r=yield it({audio:Object.assign({},t)})}catch(e){throw new dt(ut.CREATE_STREAM_FAILED,"Failed to create microphone stream: ".concat(e))}return new e(r)}))}(Yh,e)},Kh=function(e){return function(e,t){return Ye(this,void 0,void 0,(function*(){var r;try{r=yield it({video:Object.assign({},t)})}catch(e){throw new dt(ut.CREATE_STREAM_FAILED,"Failed to create camera stream: ".concat(e))}return new e(r)}))}(Qh,e)},Wh=function(){return function(e,t){return Ye(this,void 0,void 0,(function*(){var r;try{r=yield ot({video:!0})}catch(e){throw new dt(ut.CREATE_STREAM_FAILED,"Failed to create display stream: ".concat(e))}var n=new e(r);return t&&(n.contentHint=t),n}))}($t)},Jh=function(){return function(e,t,r){return Ye(this,void 0,void 0,(function*(){var n;try{n=yield ot({video:!0,audio:!0})}catch(e){throw new dt(ut.CREATE_STREAM_FAILED,"Failed to create display and system audio streams: ".concat(e))}var i=new e(new MediaStream(n.getVideoTracks()));r&&(i.contentHint=r);var o=null;return n.getAudioTracks().length>0&&(o=new t(new MediaStream(n.getAudioTracks()))),[i,o]}))}($t,zt)},Yh=Vh($h),Qh=Vh(Zh),Xh=r(16282),ef=function(e){return e.user="user",e.environment="environment",e}({}),tf=function(e){return e.browser="browser",e.monitor="monitor",e.window="window",e}({}),rf={"1080p":{frameRate:30,width:1920,height:1080},"720p":{frameRate:30,width:1280,height:720},"480p":{frameRate:30,width:640,height:480},"360p":{frameRate:30,width:640,height:360},"240p":{frameRate:30,width:320,height:240},"180p":{frameRate:30,width:320,height:180},"120p":{frameRate:30,width:160,height:120}};let nf=!0,of=!0;function sf(e,t,r){const n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}function af(e,t,r){if(!e.RTCPeerConnection)return;const n=e.RTCPeerConnection.prototype,i=n.addEventListener;n.addEventListener=function(e,n){if(e!==t)return i.apply(this,arguments);const o=e=>{const t=r(e);t&&(n.handleEvent?n.handleEvent(t):n(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(n,o),i.apply(this,[e,o])};const o=n.removeEventListener;n.removeEventListener=function(e,r){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(r))return o.apply(this,arguments);const n=this._eventMap[t].get(r);return this._eventMap[t].delete(r),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,n])},Object.defineProperty(n,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function cf(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(nf=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function uf(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(of=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function lf(){if("object"==typeof window){if(nf)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function df(e,t){of&&console.warn(e+" is deprecated, please use "+t+" instead.")}function hf(e){return"[object Object]"===Object.prototype.toString.call(e)}function ff(e){return hf(e)?Object.keys(e).reduce((function(t,r){const n=hf(e[r]),i=n?ff(e[r]):e[r],o=n&&!Object.keys(i).length;return void 0===i||o?t:Object.assign(t,{[r]:i})}),{}):e}function pf(e,t,r){t&&!r.has(t.id)&&(r.set(t.id,t),Object.keys(t).forEach((n=>{n.endsWith("Id")?pf(e,e.get(t[n]),r):n.endsWith("Ids")&&t[n].forEach((t=>{pf(e,e.get(t),r)}))})))}function mf(e,t,r){const n=r?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;const o=[];return e.forEach((e=>{"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((t=>{e.forEach((r=>{r.type===n&&r.trackId===t.id&&pf(e,r,i)}))})),i}const gf=lf;function vf(e,t){const r=e&&e.navigator;if(!r.mediaDevices)return;const n=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach((r=>{if("require"===r||"advanced"===r||"mediaSource"===r)return;const n="object"==typeof e[r]?e[r]:{ideal:e[r]};void 0!==n.exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact);const i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==n.ideal){t.optional=t.optional||[];let e={};"number"==typeof n.ideal?(e[i("min",r)]=n.ideal,t.optional.push(e),e={},e[i("max",r)]=n.ideal,t.optional.push(e)):(e[i("",r)]=n.ideal,t.optional.push(e))}void 0!==n.exact&&"number"!=typeof n.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",r)]=n.exact):["min","max"].forEach((e=>{void 0!==n[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,r)]=n[e])}))})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},i=function(e,i){if(t.version>=61)return i(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){const t=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=n(e.audio)}if(e&&"object"==typeof e.video){let o=e.video.facingMode;o=o&&("object"==typeof o?o:{ideal:o});const s=t.version<66;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!r.mediaDevices.getSupportedConstraints||!r.mediaDevices.getSupportedConstraints().facingMode||s)){let t;if(delete e.video.facingMode,"environment"===o.exact||"environment"===o.ideal?t=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(t=["front"]),t)return r.mediaDevices.enumerateDevices().then((r=>{let s=(r=r.filter((e=>"videoinput"===e.kind))).find((e=>t.some((t=>e.label.toLowerCase().includes(t)))));return!s&&r.length&&t.includes("back")&&(s=r[r.length-1]),s&&(e.video.deviceId=o.exact?{exact:s.deviceId}:{ideal:s.deviceId}),e.video=n(e.video),gf("chrome: "+JSON.stringify(e)),i(e)}))}e.video=n(e.video)}return gf("chrome: "+JSON.stringify(e)),i(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(r.getUserMedia=function(e,t,n){i(e,(e=>{r.webkitGetUserMedia(e,t,(e=>{n&&n(o(e))}))}))}.bind(r),r.mediaDevices.getUserMedia){const e=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(t){return i(t,(t=>e(t).then((e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((e=>{e.stop()})),new DOMException("","NotFoundError");return e}),(e=>Promise.reject(o(e))))))}}}function yf(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then((t=>{const n=r.video&&r.video.width,i=r.video&&r.video.height,o=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},n&&(r.video.mandatory.maxWidth=n),i&&(r.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(r)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function bf(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function Ef(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",(r=>{let n;n=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===r.track.id)):{track:r.track};const i=new Event("track");i.track=r.track,i.receiver=n,i.transceiver={receiver:n},i.streams=[t.stream],this.dispatchEvent(i)})),t.stream.getTracks().forEach((r=>{let n;n=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===r.id)):{track:r};const i=new Event("track");i.track=r,i.receiver=n,i.transceiver={receiver:n},i.streams=[t.stream],this.dispatchEvent(i)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else af(e,"track",(e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e)))}function wf(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){let i=r.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};const n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){n.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],r.apply(this,[e]),e.getTracks().forEach((e=>{this._senders.push(t(this,e))}))};const n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach((e=>{const t=this._senders.find((t=>t.track===e));t&&this._senders.splice(this._senders.indexOf(t),1)}))}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Sf(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,r,n]=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof e))return t.apply(this,[]);const i=function(e){const t={};return e.result().forEach((e=>{const r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((t=>{r[t]=e.stat(t)})),t[r.id]=r})),t},o=function(e){return new Map(Object.keys(e).map((t=>[t,e[t]])))};if(arguments.length>=2){const n=function(e){r(o(i(e)))};return t.apply(this,[n,e])}return new Promise(((e,r)=>{t.apply(this,[function(t){e(o(i(t)))},r])})).then(r,n)}}function _f(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>mf(t,e.track,!0)))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),af(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>mf(t,e.track,!1)))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,r,n;return this.getSenders().forEach((r=>{r.track===e&&(t?n=!0:t=r)})),this.getReceivers().forEach((t=>(t.track===e&&(r?n=!0:r=t),t.track===e))),n||t&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function Tf(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((e=>this._shimmedLocalStreams[e][0]))};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const n=t.apply(this,arguments);return this._shimmedLocalStreams[r.id]?-1===this._shimmedLocalStreams[r.id].indexOf(n)&&this._shimmedLocalStreams[r.id].push(n):this._shimmedLocalStreams[r.id]=[r,n],n};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")}));const t=this.getSenders();r.apply(this,arguments);const n=this.getSenders().filter((e=>-1===t.indexOf(e)));this._shimmedLocalStreams[e.id]=[e].concat(n)};const n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],n.apply(this,arguments)};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((t=>{const r=this._shimmedLocalStreams[t].indexOf(e);-1!==r&&this._shimmedLocalStreams[t].splice(r,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]})),i.apply(this,arguments)}}function xf(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return Tf(e);const r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=r.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((e=>this._reverseStreams[e.id]))};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){const r=new e.MediaStream(t.getTracks());this._streams[t.id]=r,this._reverseStreams[r.id]=t,t=r}n.apply(this,[t])};const i=e.RTCPeerConnection.prototype.removeStream;function o(e,t){let r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(i.id,"g"),n.id)})),new RTCSessionDescription({type:t.type,sdp:r})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,r){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const n=[].slice.call(arguments,1);if(1!==n.length||!n[0].getTracks().find((e=>e===t)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((e=>e.track===t)))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const i=this._streams[r.id];if(i)i.addTrack(t),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const n=new e.MediaStream([t]);this._streams[r.id]=n,this._reverseStreams[n.id]=r,this.addStream(n)}return this.getSenders().find((e=>e.track===t))},["createOffer","createAnswer"].forEach((function(t){const r=e.RTCPeerConnection.prototype[t],n={[t](){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?r.apply(this,[t=>{const r=o(this,t);e[0].apply(null,[r])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):r.apply(this,arguments).then((e=>o(this,e)))}};e.RTCPeerConnection.prototype[t]=n[t]}));const s=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){let r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(n.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:r})}(this,arguments[0]),s.apply(this,arguments)):s.apply(this,arguments)};const a=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=a.get.apply(this);return""===e.type?e:o(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach((r=>{this._streams[r].getTracks().find((t=>e.track===t))&&(t=this._streams[r])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Af(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const r=e.RTCPeerConnection.prototype[t],n={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=n[t]}))}function If(e,t){af(e,"negotiationneeded",(e=>{const r=e.target;if(!(t.version<72||r.getConfiguration&&"plan-b"===r.getConfiguration().sdpSemantics)||"stable"===r.signalingState)return e}))}function Cf(e,t){const r=e&&e.navigator,n=e&&e.MediaStreamTrack;if(r.getUserMedia=function(e,t,n){df("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(e).then(t,n)},!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){const e=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])},t=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(r){return"object"==typeof r&&"object"==typeof r.audio&&(r=JSON.parse(JSON.stringify(r)),e(r.audio,"autoGainControl","mozAutoGainControl"),e(r.audio,"noiseSuppression","mozNoiseSuppression")),t(r)},n&&n.prototype.getSettings){const t=n.prototype.getSettings;n.prototype.getSettings=function(){const r=t.apply(this,arguments);return e(r,"mozAutoGainControl","autoGainControl"),e(r,"mozNoiseSuppression","noiseSuppression"),r}}if(n&&n.prototype.applyConstraints){const t=n.prototype.applyConstraints;n.prototype.applyConstraints=function(r){return"audio"===this.kind&&"object"==typeof r&&(r=JSON.parse(JSON.stringify(r)),e(r,"autoGainControl","mozAutoGainControl"),e(r,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[r])}}}}function Rf(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===r.video?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)})}function kf(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Of(e,t){if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const r=e.RTCPeerConnection.prototype[t],n={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=n[t]}));const r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,i,o]=arguments;return n.apply(this,[e||null]).then((e=>{if(t.version<53&&!i)try{e.forEach((e=>{e.type=r[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach(((t,n)=>{e.set(n,Object.assign({},t,{type:r[t.type]||t.type}))}))}return e})).then(i,o)}}function Nf(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Pf(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),af(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Lf(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){df("removeStream","removeTrack"),this.getSenders().forEach((t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)}))})}function Df(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function Mf(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let e=arguments[1]&&arguments[1].sendEncodings;void 0===e&&(e=[]),e=[...e];const r=e.length>0;r&&e.forEach((e=>{if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const n=t.apply(this,arguments);if(r){const{sender:t}=n,r=t.getParameters();(!("encodings"in r)||1===r.encodings.length&&0===Object.keys(r.encodings[0]).length)&&(r.encodings=e,t.sendEncodings=e,this.setParametersPromises.push(t.setParameters(r).then((()=>{delete t.sendEncodings})).catch((()=>{delete t.sendEncodings}))))}return n})}function Uf(e){if("object"!=typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function Bf(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function Ff(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function jf(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((r=>t.call(this,r,e))),e.getVideoTracks().forEach((r=>t.call(this,r,e)))},e.RTCPeerConnection.prototype.addTrack=function(e,...r){return r&&r.forEach((e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const r=e.getTracks();this.getSenders().forEach((e=>{r.includes(e.track)&&this.removeTrack(e)}))})}}function Vf(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach((e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)}))})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const r=new Event("addstream");r.stream=t,e.dispatchEvent(r)}))}),t.apply(e,arguments)}}}function Hf(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,r=t.createOffer,n=t.createAnswer,i=t.setLocalDescription,o=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){const r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i};let a=function(e,t,r){const n=i.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n};t.setLocalDescription=a,a=function(e,t,r){const n=o.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.setRemoteDescription=a,a=function(e,t,r){const n=s.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.addIceCandidate=a}function Gf(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,r=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>r(qf(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,r,n){t.mediaDevices.getUserMedia(e).then(r,n)}.bind(t))}function qf(e){return e&&void 0!==e.video?Object.assign({},e,{video:ff(e.video)}):e}function $f(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,r){if(e&&e.iceServers){const t=[];for(let r=0;r<e.iceServers.length;r++){let n=e.iceServers[r];!n.hasOwnProperty("urls")&&n.hasOwnProperty("url")?(df("RTCIceServer.url","RTCIceServer.urls"),n=JSON.parse(JSON.stringify(n)),n.urls=n.url,delete n.url,t.push(n)):t.push(e.iceServers[r])}e.iceServers=t}return new t(e,r)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function Zf(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function zf(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find((e=>"audio"===e.receiver.track.kind));!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const r=this.getTransceivers().find((e=>"video"===e.receiver.track.kind));!1===e.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveVideo||r||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function Kf(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var Wf=r(57539),Jf=r.n(Wf);function Yf(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){const r=new t(e),n=Jf().parseCandidate(e.candidate),i=Object.assign(r,n);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,af(e,"icecandidate",(t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t)))}function Qf(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||af(e,"icecandidate",(e=>{if(e.candidate){const t=Jf().parseCandidate(e.candidate.candidate);"relay"===t.type&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e}))}function Xf(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;const t=Jf().splitSections(e.sdp);return t.shift(),t.some((e=>{const t=Jf().parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){const e=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const r=parseInt(t[1],10);return r!=r?-1:r}(arguments[0]),r=function(e){let r=65536;return"firefox"===t.browser&&(r=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),r}(e),n=function(e,r){let n=65536;"firefox"===t.browser&&57===t.version&&(n=65535);const i=Jf().matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?n=parseInt(i[0].substr(19),10):"firefox"===t.browser&&-1!==r&&(n=2147483637),n}(arguments[0],e);let i;i=0===r&&0===n?Number.POSITIVE_INFINITY:0===r||0===n?Math.max(r,n):Math.min(r,n);const o={};Object.defineProperty(o,"maxMessageSize",{get:()=>i}),this._sctp=o}return r.apply(this,arguments)}}function ep(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const r=e.send;e.send=function(){const n=arguments[0],i=n.length||n.size||n.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return r.apply(e,arguments)}}const r=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=r.apply(this,arguments);return t(e,this),e},af(e,"datachannel",(e=>(t(e.channel,e.target),e)))}function tp(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((e=>{const r=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const r=new Event("connectionstatechange",e);t.dispatchEvent(r)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}}))}function rp(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const r=t.sdp.split("\n").filter((e=>"a=extmap-allow-mixed"!==e.trim())).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:r}):t.sdp=r}return r.apply(this,arguments)}}function np(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const r=e.RTCPeerConnection.prototype.addIceCandidate;r&&0!==r.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function ip(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const r=e.RTCPeerConnection.prototype.setLocalDescription;r&&0!==r.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let e=arguments[0]||{};if("object"!=typeof e||e.type&&e.sdp)return r.apply(this,arguments);if(e={type:e.type,sdp:e.sdp},!e.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}if(e.sdp||"offer"!==e.type&&"answer"!==e.type)return r.apply(this,[e]);return("offer"===e.type?this.createOffer:this.createAnswer).apply(this).then((e=>r.apply(this,[e])))})}!function({window:e}={},t={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const r=lf,n=function(e){const t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;const{navigator:r}=e;if(r.mozGetUserMedia)t.browser="firefox",t.version=sf(r.userAgent,/Firefox\/(\d+)\./,1);else if(r.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=sf(r.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.RTCPeerConnection||!r.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=sf(r.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(e),c={browserDetails:n,commonShim:a,extractVersion:sf,disableLog:cf,disableWarnings:uf,sdp:Wf};switch(n.browser){case"chrome":if(!i||!Af||!t.shimChrome)return r("Chrome shim is not included in this adapter release."),c;if(null===n.version)return r("Chrome shim can not determine version, not shimming."),c;r("adapter.js shimming chrome."),c.browserShim=i,np(e,n),ip(e),vf(e,n),bf(e),Af(e,n),Ef(e),xf(e,n),wf(e),Sf(e),_f(e),If(e,n),Yf(e),Qf(e),tp(e),Xf(e,n),ep(e),rp(e,n);break;case"firefox":if(!o||!Of||!t.shimFirefox)return r("Firefox shim is not included in this adapter release."),c;r("adapter.js shimming firefox."),c.browserShim=o,np(e,n),ip(e),Cf(e,n),Of(e,n),kf(e),Lf(e),Nf(e),Pf(e),Df(e),Mf(e),Uf(e),Bf(e),Ff(e),Yf(e),tp(e),Xf(e,n),ep(e);break;case"safari":if(!s||!t.shimSafari)return r("Safari shim is not included in this adapter release."),c;r("adapter.js shimming safari."),c.browserShim=s,np(e,n),ip(e),$f(e),zf(e),Hf(e),jf(e),Vf(e),Zf(e),Gf(e),Kf(e),Yf(e),Qf(e),Xf(e,n),ep(e),rp(e,n);break;default:r("Unsupported browser!")}}({window:"undefined"==typeof window?void 0:window});var op=function(){function e(){return(0,k.Z)(this,e),(0,R.Z)(this,"webex",void 0),e.instance||(e.instance=this),e.instance}return(0,O.Z)(e,[{key:"initialSetup",value:function(e){this.webex=e}},{key:"sendBehavioralMetric",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.webex.internal.metrics.submitClientMetrics(e,{type:this.webex.config.metrics.type,fields:t,tags:r})}}]),e}();(0,R.Z)(op,"instance",void 0);const sp=new op;var ap={set:function(e){ap.verboseEvents=e.verboseEvents,ap.enable=e.enable}};const cp=ap;var up=r(18428),lp=r.n(up),dp={set:function(e){dp.meetings=lp()({},e)}};const hp=dp;var fp={logger:{info:function(e){console.error("LoggerProxy->info#NO LOGGER DEFINED")},log:function(e){console.error("LoggerProxy->log#NO LOGGER DEFINED")},error:function(e){console.error("LoggerProxy->error#NO LOGGER DEFINED")},warn:function(e){console.error("LoggerProxy->warn#NO LOGGER DEFINED")},trace:function(e){console.error("LoggerProxy->trace#NO LOGGER DEFINED")},debug:function(e){console.error("LoggerProxy->debug#NO LOGGER DEFINED")}},set:function(e){cp.enable?fp.logger=e:fp.logger={info:function(){},log:function(){},error:function(){},warn:function(){},trace:function(){},debug:function(){}}},get:function(){return fp.logger}};const pp=fp;var mp=r(55877),gp=r.n(mp),vp=function(){function e(t){(0,k.Z)(this,e),(0,R.Z)(this,"webex",void 0),this.webex=t.webex}var t;return(0,O.Z)(e,[{key:"uploadLogs",value:(t=(0,T.Z)(V().mark((function e(){var t,r,n,i,o,s,a,c,u=arguments;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(t=u.length>0&&void 0!==u[0]?u[0]:{}).feedbackId||gp().v4(),n=t.locusId,i=t.correlationId,o=t.meetingId,s=t.callStart,a=t.locussessionid,c=t.autoupload,pp.logger.info("Logs:request#uploadLogs --\x3e uploading user logs for feedbackId: ".concat(r)),e.prev=4,e.next=7,this.webex.internal.support.submitLogs({autoupload:c,locussessionid:a,feedbackId:r,locusId:n,correlationId:i,meetingId:o,callStart:s});case 7:e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(4),pp.logger.error("Logs:request#uploadLogs --\x3e uploading user logs failed",e.t0),e.abrupt("return",P().reject(e.t0));case 13:return e.abrupt("return",r);case 14:case"end":return e.stop()}}),e,this,[[4,9]])}))),function(){return t.apply(this,arguments)})}]),e}(),yp=r(67097),bp=r(18408),Ep="audio",wp="audioStatus",Sp="alert",_p="alias",Tp="answer",xp="call",Ap="correlationId",Ip="meetingNumber",Cp="conversationUrl",Rp="calendar",kp="calendarEvents",Op="cmrmeetings",Np="claim",Pp="controls",Lp="content",Dp="complete",Mp="whiteboard",Up="gathering",Bp="development",Fp="decline",jp="error",Vp="ended",Hp="hecate",Gp="host",qp="join",$p="leave",Zp="live",zp="local",Kp="loci",Wp="locusUrl",Jp="end",Yp=18e4,Qp="meetingInfo",Xp="meet",em="m",tm="media",rm="co",nm="cisco",im="offline",om="online",sm="participant",am="DIAL_IN",cm="DIAL_OUT",um="remote",lm="ready",dm="sendDtmf",hm="sendrecv",fm="sipUri",pm="share",mm="type",gm="video",vm="videoStatus",ym="en",bm="ANSWER",Em="ACTIVE",wm="CALL",Sm="CREATED",_m="CONFLICT",Tm="CONVERSATION_URL",xm="ERROR",Am="FORCED",Im="IDLE",Cm="IN_LOBBY",Rm="IN_MEETING",km="INCOMING",Om="IN",Nm="id",Pm="JOIN",Lm="JOINED",Dm="LOCUS_ID",Mm="LEFT",Um="MOVED",Bm="MEETING_LINK",Fm="MEETING_UUID",jm="MEETING",Vm="MEETING_CENTER",Hm="MEETING_ID",Gm="NOT_IN_MEETING",qm="NONE",$m="OBSERVE",Zm="PERSONAL_ROOM",zm=bp.hydraTypes.PEOPLE,Km="REQUESTED",Wm="RESOURCE_ROOM",Jm="RECVONLY",Ym="REMOVE",Qm=bp.hydraTypes.ROOM,Xm="SIP_BRIDGE",eg="SIP_URI",tg="SENDRECV",rg="SENDONLY",ng="INACTIVE",ig="SLIDES",og="s=-",sg="USER",ag="UNKNOWN",cg="WEBEX_MEETING",ug="WAIT",lg="MOVE_MEDIA",dg={TARGETS:{AUDIO:"audio",VIDEO:"video"},STATES:{DISABLED:"disabled",MUTED:"muted",UNKNOWN:"unknown",UNMUTED:"unmuted"}},hg="alternateRedirect=true",fg="https://",pg="Meetings",mg="MediaPeerConnection",gg="SharePeerConnection",vg="useUriLookup=false",yg="www.",bg="webex.com",Eg="identityLookup",wg="webex-appapi-service",Sg=["timestamp","ssrc","priority"],_g=["Single","Equal","ActivePresence","Prominent","OnePlusN"],Tg=!0,xg=!1,Ag=[2423005,2423006,2423016,2423017,2423018],Ig=2e3,Cg=3e3,Rg=3e3,kg=1e4,Og=35e3,Ng={SIP_ADDRESS:/^(sips?)?:?(?:([^\s>:@]+)(?::([^\s@>]+))?@)([\w\-.]+)(?::(\d+))?((?:;[^\s=?>;]+(?:=[^\s?;]+)?)*)(?:\?(([^\s&=>]+=[^\s&=>]+)(&[^\s&=>]+=[^\s&=>]+)*))?$/,PHONE_NUMBER:/^(?:(?:\+?1\s*(?:[.-]\s*)?)?(?:\(\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\s*\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\s*(?:[.-]\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\s*(?:[.-]\s*)?([0-9]{4})(?:\s*(?:#|x\.?|ext\.?|extension)\s*(\d+))?$/,E164_FORMAT:/^\+[1-9]\d{1,14}$/},Pg=/^(?:[0-9]{1,3}\.){3}[0-9]{1,3}|.local/g,Lg=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,Dg=/([a-z0-9][-a-z0-9, '.']{0,62})@([a-z0-9][-a-z0-9, '.']{0,62})\.webex\.com/i,Mg=/(https:\/\/)?([a-z0-9][-a-z0-9, '.']{0,62})\.webex\.com\/(meet|join)\/([a-z0-9][-a-z0-9, '.']{0,62})\/?/i,Ug=/([0-9]{4,6})/,Bg=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,Fg={CALLIOPEDISCOVERY:"calliopeDiscovery",LOCUS:"locus"},jg={CREATE:"event:calendar.meeting.create",UPDATE:"event:calendar.meeting.update",CREATE_MINIMAL:"event:calendar.meeting.create.minimal",UPDATE_MINIMAL:"event:calendar.meeting.update.minimal",DELETE:"event:calendar.meeting.delete"},Vg={ReclaimHostNotSupportedErrorCode:2400127,ReclaimHostNotAllowedErrorCode:2403135,ReclaimHostEmptyWrongKeyErrorCode:2403136,ReclaimHostIsHostAlreadyErrorCode:2409150},Hg={types:["track","transport","candidate-pair","outbound-rtp","outboundrtp","inbound-rtp","inboundrtp","remote-inbound-rtp","remote-outbound-rtp","remote-candidate","local-candidate","media-source"]},Gg={RECORDING:"recording",IDLE:"idle",PAUSED:"paused",RESUMED:"resumed"},qg={NO_SHARE:"no_share",REMOTE_SHARE_ACTIVE:"remote_share_active",LOCAL_SHARE_ACTIVE:"local_share_active",WHITEBOARD_SHARE_ACTIVE:"whiteboard_share_active"},$g={MEETINGS_READY:"meetings:ready",MEETINGS_REGISTERED:"meetings:registered",MEETINGS_UNREGISTERED:"meetings:unregistered",MEDIA_READY:"media:ready",MEDIA_STOPPED:"media:stopped",MEDIA_UPDATE:"media:update",MEDIA_CODEC_MISSING:"media:codec:missing",MEDIA_CODEC_LOADED:"media:codec:loaded",MEETING_STARTED_SHARING_LOCAL:"meeting:startedSharingLocal",MEETING_STOPPED_SHARING_LOCAL:"meeting:stoppedSharingLocal",MEETING_STARTED_SHARING_REMOTE:"meeting:startedSharingRemote",MEETING_STOPPED_SHARING_REMOTE:"meeting:stoppedSharingRemote",MEETING_UPDATE_ANNOTATION_INFO:"meeting:updateAnnotationInfo",MEETING_STARTED_SHARING_WHITEBOARD:"meeting:startedSharingWhiteboard",MEETING_STOPPED_SHARING_WHITEBOARD:"meeting:stoppedSharingWhiteboard",MEETING_MEDIA_LOCAL_STARTED:"meeting:media:local:start",MEETING_MEDIA_REMOTE_STARTED:"meeting:media:remote:start",MEETING_STARTED_RECORDING:"meeting:recording:started",MEETING_STOPPED_RECORDING:"meeting:recording:stopped",MEETING_RECEIVE_REACTIONS:"meeting:receiveReactions",MEETING_PAUSED_RECORDING:"meeting:recording:paused",MEETING_RESUMED_RECORDING:"meeting:recording:resumed",MEETING_ADDED:"meeting:added",MEETING_REMOVED:"meeting:removed",MEETING_RINGING:"meeting:ringing",MEETING_RINGING_STOP:"meeting:ringingStop",MEETING_SELF_LOBBY_WAITING:"meeting:self:lobbyWaiting",MEETING_SELF_GUEST_ADMITTED:"meeting:self:guestAdmitted",MEETING_SELF_VIDEO_MUTED_BY_OTHERS:"meeting:self:videoMutedByOthers",MEETING_SELF_VIDEO_UNMUTED_BY_OTHERS:"meeting:self:videoUnmutedByOthers",MEETING_SELF_MUTED_BY_OTHERS:"meeting:self:mutedByOthers",MEETING_SELF_UNMUTED_BY_OTHERS:"meeting:self:unmutedByOthers",MEETING_SELF_REQUESTED_TO_UNMUTE:"meeting:self:requestedToUnmute",MEETING_SELF_PHONE_AUDIO_UPDATE:"meeting:self:phoneAudioUpdate",MEETING_SELF_CANNOT_VIEW_PARTICIPANT_LIST:"meeting:self:cannotViewParticipantList",MEETING_SELF_IS_SHARING_BLOCKED:"meeting:self:isSharingBlocked",MEETING_SELF_ROLES_CHANGED:"meeting:self:rolesChanged",MEETING_CONTROLS_LAYOUT_UPDATE:"meeting:layout:update",MEETING_ENTRY_EXIT_TONE_UPDATE:"meeting:entryExitTone:update",MEETING_BREAKOUTS_UPDATE:"meeting:breakouts:update",MEETING_BREAKOUTS_CLOSING:"meeting:breakouts:closing",MEETING_BREAKOUTS_MESSAGE:"meeting:breakouts:message",MEETING_BREAKOUTS_ASK_RETURN_TO_MAIN:"meeting:breakouts:askReturnToMain",MEETING_BREAKOUTS_LEAVE:"meeting:breakouts:leave",MEETING_BREAKOUTS_ASK_FOR_HELP:"meeting:breakouts:askForHelp",MEETING_BREAKOUTS_PRE_ASSIGNMENTS_UPDATE:"meeting:breakouts:preAssignmentsUpdate",MEETING_INTERPRETATION_UPDATE:"meeting:interpretation:update",MEETING_INTERPRETATION_SUPPORT_LANGUAGES_UPDATE:"meeting:interpretation:supportLanguagesUpdate",MEETING_INTERPRETATION_HANDOFF_REQUESTS_ARRIVED:"meeting:interpretation:handoffRequestsArrived",MEMBERS_UPDATE:"members:update",MEMBERS_CLEAR:"members:clear",MEMBERS_CONTENT_UPDATE:"members:content:update",MEMBERS_HOST_UPDATE:"members:host:update",MEMBERS_SELF_UPDATE:"members:self:update",MEETING_RECONNECTION_STARTING:"meeting:reconnectionStarting",MEETING_RECONNECTION_SUCCESS:"meeting:reconnectionSuccess",MEETING_RECONNECTION_FAILURE:"meeting:reconnectionFailure",MEETING_UNLOCKED:"meeting:unlocked",MEETING_LOCKED:"meeting:locked",MEETING_INFO_AVAILABLE:"meeting:meetingInfoAvailable",MEETING_LOG_UPLOAD_SUCCESS:"meeting:logUpload:success",MEETING_LOG_UPLOAD_FAILURE:"meeting:logUpload:failure",MEETING_ACTIONS_UPDATE:"meeting:actionsUpdate",MEETING_STATE_CHANGE:"meeting:stateChange",MEETING_MEETING_CONTAINER_UPDATE:"meeting:meetingContainer:update",MEETING_EMBEDDED_APPS_UPDATE:"meeting:embeddedApps:update",MEDIA_QUALITY:"media:quality",MEETINGS_NETWORK_DISCONNECTED:"network:disconnected",MEETINGS_NETWORK_CONNECTED:"network:connected",MEETING_SELF_LEFT:"meeting:self:left",NETWORK_QUALITY:"network:quality",MEDIA_NEGOTIATED:"media:negotiated",ACTIVE_SPEAKER_CHANGED:"media:activeSpeakerChanged",REMOTE_VIDEO_SOURCE_COUNT_CHANGED:"media:remoteVideoSourceCountChanged",REMOTE_AUDIO_SOURCE_COUNT_CHANGED:"media:remoteAudioSourceCountChanged",REMOTE_MEDIA_AUDIO_CREATED:"media:remoteAudio:created",REMOTE_MEDIA_SCREEN_SHARE_AUDIO_CREATED:"media:remoteScreenShareAudio:created",REMOTE_MEDIA_VIDEO_LAYOUT_CHANGED:"media:remoteVideo:layoutChanged",MEETING_CONTROLS_MUTE_ON_ENTRY_UPDATED:"meeting:controls:mute-on-entry:updated",MEETING_CONTROLS_SHARE_CONTROL_UPDATED:"meeting:controls:share-control:updated",MEETING_CONTROLS_DISALLOW_UNMUTE_UPDATED:"meeting:controls:disallow-unmute:updated",MEETING_CONTROLS_REACTIONS_UPDATED:"meeting:controls:reactions:updated",MEETING_CONTROLS_VIEW_THE_PARTICIPANTS_LIST_UPDATED:"meeting:controls:view-the-participants-list:updated",MEETING_CONTROLS_RAISE_HAND_UPDATED:"meeting:controls:raise-hand:updated",MEETING_CONTROLS_VIDEO_UPDATED:"meeting:controls:video:updated",MEETING_LOCUS_URL_UPDATE:"meeting:locus:locusUrl:update",MEETING_STREAM_PUBLISH_STATE_CHANGED:"meeting:streamPublishStateChanged",MEETING_TRANSCRIPTION_CONNECTED:"meeting:transcription:connected",MEETING_STARTED_RECEIVING_TRANSCRIPTION:"meeting:receiveTranscription:started",MEETING_STOPPED_RECEIVING_TRANSCRIPTION:"meeting:receiveTranscription:stopped",MEETING_CAPTION_RECEIVED:"meeting:caption-received"},Zg={SELF:"self",OTHER:"other",REMOTE:"remote",REMOTE_AUDIO:"remoteAudio",REMOTE_VIDEO:"remoteVideo",REMOTE_SHARE:"remoteShare",REMOTE_SHARE_AUDIO:"remoteShareAudio",ERROR:"error"},zg={SELF_REMOVED:"SELF_REMOVED",FULLSTATE_REMOVED:"FULLSTATE_REMOVED",MEETING_INACTIVE_TERMINATING:"MEETING_INACTIVE_TERMINATING",CLIENT_LEAVE_REQUEST:"CLIENT_LEAVE_REQUEST",CLIENT_LEAVE_REQUEST_TAB_CLOSED:"CLIENT_LEAVE_REQUEST_TAB_CLOSED",USER_ENDED_SHARE_STREAMS:"USER_ENDED_SHARE_STREAMS",NO_MEETINGS_TO_SYNC:"NO_MEETINGS_TO_SYNC",MEETING_CONNECTION_FAILED:"MEETING_CONNECTION_FAILED",LOCUS_DTO_SYNC_FAILED:"LOCUS_DTO_SYNC_FAILED",MISSING_MEETING_INFO:"MISSING_MEETING_INFO"},Kg={CALL_INACTIVE:"CALL_INACTIVE",PARTNER_LEFT:"PARTNER_LEFT",SELF_LEFT:"SELF_LEFT"},Wg={SELF_STOPPED:"SELF_STOPPED",MEETING_REJOIN:"MEETING_REJOIN",MEDIA_RECONNECTION:"MEDIA_RECONNECTION",TRACK_ENDED:"TRACK_ENDED"},Jg={SELF_UNADMITTED_GUEST:"SELF_UNADMITTED_GUEST",SELF_ADMITTED_GUEST:"SELF_ADMITTED_GUEST",MEDIA_INACTIVITY:"MEDIA_INACTIVITY",CONVERSATION_URL_UPDATE:"CONVERSATION_URL_UPDATE",DESTROY_MEETING:"DESTROY_MEETING",REQUEST_UPLOAD_LOGS:"REQUEST_UPLOAD_LOGS",REMOTE_RESPONSE:"REMOTE_RESPONSE",LOCUS_INFO_UPDATE_PARTICIPANTS:"LOCUS_INFO_UPDATE_PARTICIPANTS",LOCUS_INFO_UPDATE_HOST:"LOCUS_INFO_UPDATE_HOST",LOCUS_INFO_UPDATE_MEDIA_SHARES:"LOCUS_INFO_UPDATE_MEDIA_SHARES",LOCUS_INFO_UPDATE_SELF:"LOCUS_INFO_UPDATE_SELF",LOCUS_INFO_UPDATE_URL:"LOCUS_INFO_UPDATE_URL",LOCUS_INFO_CAN_ASSIGN_HOST:"LOCUS_INFO_CAN_ASSIGN_HOST",DISCONNECT_DUE_TO_INACTIVITY:"DISCONNECT_DUE_TO_INACTIVITY"},Yg={active:"active",inactive:"inactive"},Qg={PARAMETER:{NAME:"ParameterError",MESSAGE:"The parameters passed to the function, or object properties needed in the function were null, missing where required, or otherwise incorrect.",CODE:0},INTENT_TO_JOIN:{NAME:"IntentToJoinError",MESSAGE:"The meeting is locked. This is expected behavior. Call #join again with pin and/or moderator option",CODE:1},JOIN_MEETING:{NAME:"JoinMeetingError",MESSAGE:"There was an issue joining the meeting, meeting could be in a bad state.",CODE:2},RECONNECTION:{NAME:"ReconnectionError",MESSAGE:"There was an error in the reconnection flow, the meeting may not reconnect, disconnect and dial again.",CODE:3},MEDIA:{NAME:"MediaError",MESSAGE:"There was an error with media, the meeting may not have live audio, video or share.",CODE:4},PERMISSION:{NAME:"PermissionError",MESSAGE:"Not allowed to execute the function, some properties on server, or local client state do not allow you to complete this action.",CODE:5},STATS:{NAME:"StatsError",MESSAGE:"An error occurred with getStats, stats may not continue for this data stream.",CODE:6},PASSWORD:{NAME:"PasswordError",MESSAGE:"Password is required, please use verifyPassword()",CODE:7},CAPTCHA:{NAME:"CaptchaError",MESSAGE:"Captcha is required.",CODE:8},BREAKOUT_EDIT:{NAME:"BreakoutEditLockedError",MESSAGE:"Edit lock token mismatch",CODE:9},NO_MEETING_INFO:{NAME:"NoMeetingInfo",MESSAGE:"No meeting info found for the meeting",CODE:10},RECLAIM_HOST_ROLE_NOT_SUPPORTED:{NAME:"ReclaimHostRoleNotSupported",MESSAGE:"Non converged meetings, PSTN or SIP users in converged meetings are not supported currently.",CODE:11},RECLAIM_HOST_ROLE_NOT_ALLOWED:{NAME:"ReclaimHostRoleNotAllowed",MESSAGE:"Reclaim Host Role Not Allowed For Other Participants. Participants cannot claim host role in PMR meeting, space instant meeting or escalated instant meeting. However, the original host still can reclaim host role when it manually makes another participant to be the host.",CODE:12},RECLAIM_HOST_ROLE_EMPTY_OR_WRONG_KEY:{NAME:"ReclaimHostRoleEmptyOrWrongKey",MESSAGE:"Host Key Not Specified Or Matched. The original host can reclaim the host role without entering the host key. However, any other person who claims the host role must enter the host key to get it.",CODE:13},RECLAIM_HOST_ROLE_IS_ALREADY_HOST:{NAME:"ReclaimHostRoleIsAlreadyHost",MESSAGE:"Participant Having Host Role Already. Participant who sends request to reclaim host role has already a host role.",CODE:14}},Xg={GRANTED:"GRANTED",RELEASED:"RELEASED",ACCEPTED:"ACCEPTED"},ev={INITIALIZING:"INITIALIZING",INACTIVE:"INACTIVE",ACTIVE:"ACTIVE",TERMINATING:"TERMINATING",UNKNOWN:"UNKNOWN"},tv={PUT:"PUT",POST:"POST",GET:"GET",PATCH:"PATCH",DELETE:"DELETE"},rv={NEW:"new",GATHERING:"gathering",COMPLETE:"complete"},nv={CHECKING:"checking",CONNECTED:"connected",CLOSED:"closed",COMPLETED:"completed",FAILED:"failed",DISCONNECTED:"disconnected"},iv={NEW:"new",CONNECTING:"connecting",CONNECTED:"connected",CLOSED:"closed",FAILED:"failed",DISCONNECTED:"disconnected"},ov={STATE:{INACTIVE:"INACTIVE",ENDED:"ENDED",INITIALIZING:"INITIALIZING",ACTIVE:"ACTIVE",TERMINATING:"TERMINATING"},SEQUENCE:{UN_DEF:"undef",EMPTY:"empty",DEF:"def",NA:"na",RANGE_START:"rangeStart",RANGE_END:"rangeEnd"},SYNCDEBUG:"sync_debug"},sv={ANNOTATION_ON_SHARE_SUPPORTED:"ANNOTATION_ON_SHARE_SUPPORTED"},av={STATUS:{CLOSING:"CLOSING",CLOSED:"CLOSED",PENDING:"PENDING",OPEN:"OPEN"},EVENTS:{BREAKOUTS_CLOSING:"BREAKOUTS_CLOSING",MESSAGE:"MESSAGE",MEMBERS_UPDATE:"MEMBERS_UPDATE",ASK_RETURN_TO_MAIN:"ASK_RETURN_TO_MAIN",LEAVE_BREAKOUT:"LEAVE_BREAKOUT",ASK_FOR_HELP:"ASK_FOR_HELP",PRE_ASSIGNMENTS_UPDATE:"PRE_ASSIGNMENTS_UPDATE"},SESSION_TYPES:{MAIN:"MAIN",BREAKOUT:"BREAKOUT"},SESSION_STATES:{ACTIVE:"active",ASSIGNED:"assigned",ALLOWED:"allowed",ASSIGNED_CURRENT:"assignedCurrent",REQUESTED:"requested"},BREAKOUTS_SUPPORTED:"BREAKOUTS_SUPPORTED",ACTION:{START:"START",CLOSE:"CLOSE",DELETE:"DELETE"},ERROR_CODE:{EDIT_LOCK_TOKEN_MISMATCH:201409024,EDIT_NOT_AUTHORIZED:201403007},EDIT_LOCK_STATUS:{LOCKED:"LOCKED",NOT_LOCKED:"NOT_LOCKED",UNKNOWN:"UNKNOWN"},DEFAULT_TTL:30},cv={EVENTS:{SUPPORT_LANGUAGES_UPDATE:"SUPPORT_LANGUAGES_UPDATE",HANDOFF_REQUESTS_ARRIVED:"HANDOFF_REQUESTS_ARRIVED"},ACTION_TYPE:{OFFERED:"OFFERED",ACCEPTED:"ACCEPTED",REQUESTED:"REQUESTED",DECLINED:"DECLINED"},RESOURCE_TYPE:"SiHandover"},uv={EVENTS:{CONTROLS_MEETING_LAYOUT_UPDATED:"CONTROLS_MEETING_LAYOUT_UPDATED",CONTROLS_RECORDING_UPDATED:"CONTROLS_RECORDING_UPDATED",CONTROLS_MEETING_TRANSCRIBE_UPDATED:"CONTROLS_MEETING_TRANSCRIBE_UPDATED",CONTROLS_MEETING_BREAKOUT_UPDATED:"CONTROLS_MEETING_BREAKOUT_UPDATED",CONTROLS_MEETING_CONTAINER_UPDATED:"CONTROLS_MEETING_CONTAINER_UPDATED",CONTROLS_MEETING_INTERPRETATION_UPDATED:"CONTROLS_MEETING_INTERPRETATION_UPDATED",CONTROLS_ENTRY_EXIT_TONE_UPDATED:"CONTROLS_ENTRY_EXIT_TONE_UPDATED",CONTROLS_MUTE_ON_ENTRY_CHANGED:"CONTROLS_MUTE_ON_ENTRY_CHANGED",CONTROLS_SHARE_CONTROL_CHANGED:"CONTROLS_SHARE_CONTROL_CHANGED",CONTROLS_DISALLOW_UNMUTE_CHANGED:"CONTROLS_DISALLOW_UNMUTE_CHANGED",CONTROLS_REACTIONS_CHANGED:"CONTROLS_REACTIONS_CHANGED",CONTROLS_VIEW_THE_PARTICIPANTS_LIST_CHANGED:"CONTROLS_VIEW_THE_PARTICIPANTS_LIST_CHANGED",CONTROLS_RAISE_HAND_CHANGED:"CONTROLS_RAISE_HAND_CHANGED",CONTROLS_VIDEO_CHANGED:"CONTROLS_VIDEO_CHANGED",SELF_UNADMITTED_GUEST:"SELF_UNADMITTED_GUEST",SELF_ADMITTED_GUEST:"SELF_ADMITTED_GUEST",SELF_REMOTE_VIDEO_MUTE_STATUS_UPDATED:"SELF_REMOTE_VIDEO_MUTE_STATUS_UPDATED",SELF_REMOTE_MUTE_STATUS_UPDATED:"SELF_REMOTE_MUTE_STATUS_UPDATED",LOCAL_UNMUTE_REQUESTED:"LOCAL_UNMUTE_REQUESTED",LOCAL_UNMUTE_REQUIRED:"LOCAL_UNMUTE_REQUIRED",SELF_MODERATOR_CHANGED:"SELF_MODERATOR_CHANGED",SELF_ROLES_CHANGED:"SELF_ROLES_CHANGED",MEETING_UPDATE:"MEETING_UPDATE",MEDIA_STATUS_CHANGE:"MEDIA_STATUS_CHANGE",FULL_STATE_TYPE_UPDATE:"FULL_STATE_TYPE_UPDATE",FULL_STATE_MEETING_STATE_CHANGE:"FULL_STATE_MEETING_STATE_CHANGE",MEETING_STATE_CHANGE_TO_ACTIVE:"MEETING_STATE_CHANGE_TO_ACTIVE",MEETING_INFO_UPDATED:"MEETING_INFO_UPDATED",MEETING_LOCKED:"MEETING_LOCKED",MEETING_UNLOCKED:"MEETING_UNLOCKED",SELF_OBSERVING:"SELF_OBSERVING",DISCONNECT_DUE_TO_INACTIVITY:"DISCONNECT_DUE_TO_INACTIVITY",EMBEDDED_APPS_UPDATED:"EMBEDDED_APPS_UPDATED",SELF_CANNOT_VIEW_PARTICIPANT_LIST_CHANGE:"SELF_CANNOT_VIEW_PARTICIPANT_LIST_CHANGE",SELF_IS_SHARING_BLOCKED_CHANGE:"SELF_IS_SHARING_BLOCKED_CHANGE",SELF_MEETING_BREAKOUTS_CHANGED:"SELF_MEETING_BREAKOUTS_CHANGED",SELF_MEETING_INTERPRETATION_CHANGED:"SELF_MEETING_INTERPRETATION_CHANGED",MEDIA_INACTIVITY:"MEDIA_INACTIVITY",LINKS_SERVICES:"LINKS_SERVICES"}},lv={LOCUS_MERCURY:"event:locus",CONTROLS_UPDATED:"locus.controls_updated",DIFFERENCE:"locus.difference",BREAKOUT_ROSTER:"breakout.roster",FLOOR_GRANTED:"locus.floor_granted",FLOOR_RELEASED:"locus.floor_released",MESSAGE_ROAP:"locus.message.roap",PARTICIPANT_JOIN:"locus.participant_joined",PARTICIPANT_LEFT:"locus.participant_left",PARTICIPANT_DECLINED:"locus.participant_declined",PARTICIPANT_UPDATED:"locus.participant_updated",PARTICIPANT_CONTROLS_UPDATED:"locus.participant_controls_updated",PARTICIPANT_ROLES_UPDATED:"locus.participant_roles_updated",PARTICIPANT_AUDIO_MUTED:"locus.participant_audio_muted",PARTICIPANT_AUDIO_UNMUTED:"locus.participant_audio_unmuted",PARTICIPANT_VIDEO_MUTED:"locus.participant_video_muted",PARTICIPANT_VIDEO_UNMUTED:"locus.participant_video_unmuted",RECORDING_STARTED:"locus.recording_started",RECORDING_START_FAILED:"locus.recording_start_failed",RECORDING_STOPPED:"locus.recording_stopped",SELF_CHANGED:"locus.self_changed"},dv={CURSOR:{AWLAYS:"always",MOTION:"motion",NEVER:"never"}},hv={METRICS_NOT_SERVER_OR_CLIENT_EXCEPTION:"METRICS_NOT_SERVER_OR_CLIENT_EXCEPTION",BIDIRECTIONAL_ROSTER_NOT_ALLOWED:"BIDIRECTIONAL_ROSTER_NOT_ALLOWED",INVALID_LOCUS_URL:"INVALID_LOCUS_URL",ARGUMENT_NULL_OR_EMPTY:"ARGUMENT_NULL_OR_EMPTY",INVALID_USER:"INVALID_USER",INVALID_PHONE_NUMBER_OR_COUNTRY_CODE:"INVALID_PHONE_NUMBER_OR_COUNTRY_CODE",EMPTY_PHONE_NUMBER_OR_COUNTRY_CODE:"EMPTY_PHONE_NUMBER_OR_COUNTRY_CODE",PHONE_NUMBER_INVALID_COUNTRY_CODE:"PHONE_NUMBER_INVALID_COUNTRY_CODE",PHONE_NUMBER_NOT_A_NUMBER:"PHONE_NUMBER_NOT_A_NUMBER",PHONE_NUMBER_TOO_SHORT_AFTER_IDD:"PHONE_NUMBER_TOO_SHORT_AFTER_IDD",PHONE_NUMBER_TOO_SHORT_NSN:"PHONE_NUMBER_TOO_SHORT_NSN",PHONE_NUMBER_TOO_LONG:"PHONE_NUMBER_TOO_LONG",INVALID_DIALABLE_KEY:"INVALID_DIALABLE_KEY",INVALID_MEETING_LINK:"INVALID_MEETING_LINK",INVALID_SINCE_OR_SEQUENCE_HASH_IN_REQUEST:"INVALID_SINCE_OR_SEQUENCE_HASH_IN_REQUEST",INVALID_LOCUS_ID:"INVALID_LOCUS_ID",EMPTY_SCHEDULED_MEETING_START_TIME:"EMPTY_SCHEDULED_MEETING_START_TIME",INVALID_SCHEDULED_MEETING_DURATION_MINUTES:"INVALID_SCHEDULED_MEETING_DURATION_MINUTES",INVALID_SCHEDULED_MEETING_REMINDER_DURATION_MINUTES:"INVALID_SCHEDULED_MEETING_REMINDER_DURATION_MINUTES",EMPTY_SCHEDULED_MEETING_ORGANIZER:"EMPTY_SCHEDULED_MEETING_ORGANIZER",INVALID_MEETING_ID_FORMAT:"INVALID_MEETING_ID_FORMAT",INVALID_SIP_URL_FORMAT:"INVALID_SIP_URL_FORMAT",EMPTY_INVITEE_RECORD:"EMPTY_INVITEE_RECORD",EMPTY_INVITEE_ADDRESS:"EMPTY_INVITEE_ADDRESS",DESKPHONE_NOTHING_DIALABLE_FOUND:"DESKPHONE_NOTHING_DIALABLE_FOUND",INVALID_INVITEE_ADDRESS:"INVALID_INVITEE_ADDRESS",INVALID_ATTENDEE_ID:"INVALID_ATTENDEE_ID",INVALID_IN_LOBBY:"INVALID_IN_LOBBY",MISSING_REQUESTING_PARTICIPANT_ID:"MISSING_REQUESTING_PARTICIPANT_ID",INVALID_REQUESTING_PARTICIPANT_ID:"INVALID_REQUESTING_PARTICIPANT_ID",SUPPLEMENTARY_USER_INFO_NOT_FOUND:"SUPPLEMENTARY_USER_INFO_NOT_FOUND",UNAUTHORIZED:"UNAUTHORIZED",REMOVED_PARTICIPANT:"REMOVED_PARTICIPANT",FREE_USER_MAX_PARTICIPANTS_EXCEEDED:"FREE_USER_MAX_PARTICIPANTS_EXCEEDED",PAID_USER_MAX_PARTICIPANTS_EXCEEDED:"PAID_USER_MAX_PARTICIPANTS_EXCEEDED",SERVICE_MAX_PARTICIPANTS_EXCEEDED:"SERVICE_MAX_PARTICIPANTS_EXCEEDED",INACTIVE:"INACTIVE",ONE_ON_ONE_TO_SELF_NOT_ALLOWED:"ONE_ON_ONE_TO_SELF_NOT_ALLOWED",JOIN_RESTRICTED_USER:"JOIN_RESTRICTED_USER",GET_RESTRICTED_USER:"GET_RESTRICTED_USER",JOIN_RESTRICTED_USER_NOT_IN_ROOM:"JOIN_RESTRICTED_USER_NOT_IN_ROOM",CREATE_MEDIA_RESTRICTED_USER:"CREATE_MEDIA_RESTRICTED_USER",DUPLICATE_RESOURCE_CREATION_REQUEST:"DUPLICATE_RESOURCE_CREATION_REQUEST",MEETING_NOT_FOUND:"MEETING_NOT_FOUND",NOT_WEBEX_SITE:"NOT_WEBEX_SITE",INVALID_SCHEDULED_MEETING_ORGANIZER:"INVALID_SCHEDULED_MEETING_ORGANIZER",FREE_USER_MAX_PARTICIPANTS_JOINED_EXCEEDED:"FREE_USER_MAX_PARTICIPANTS_JOINED_EXCEEDED",PAID_USER_MAX_PARTICIPANTS_JOINED_EXCEEDED:"PAID_USER_MAX_PARTICIPANTS_JOINED_EXCEEDED",SERVICE_MAX_PARTICIPANTS_ROSTER_EXCEEDED:"SERVICE_MAX_PARTICIPANTS_ROSTER_EXCEEDED",SERVICE_INITIAL_PARTICIPANTS_ROSTER_EXCEEDED:"SERVICE_INITIAL_PARTICIPANTS_ROSTER_EXCEEDED",RESOURCE_GUEST_FORBIDDEN:"RESOURCE_GUEST_FORBIDDEN",SERVICE_NO_MACHINE_OR_SERVICE_ACCOUNT:"SERVICE_NO_MACHINE_OR_SERVICE_ACCOUNT",MODERATOR_ROLE_REMOVAL_NOT_ALLOWED:"MODERATOR_ROLE_REMOVAL_NOT_ALLOWED",RECORDING_CONTROL_NOT_SUPPORTED:"RECORDING_CONTROL_NOT_SUPPORTED",HOST_PIN_LOCKED:"HOST_PIN_LOCKED",INVALID_HOST_PIN:"INVALID_HOST_PIN",REQUESTING_PARTICIPANT_NOT_MODERATOR:"REQUESTING_PARTICIPANT_NOT_MODERATOR",CONVERSATION_NOT_FOUND:"CONVERSATION_NOT_FOUND",MEETING_LINK_NOT_FOUND:"MEETING_LINK_NOT_FOUND",MEETING_INFO_NOT_FOUND:"MEETING_INFO_NOT_FOUND",SCHEDULED_MEETING_NOT_FOUND:"SCHEDULED_MEETING_NOT_FOUND",RECORDING_NOT_STARTED:"RECORDING_NOT_STARTED",RECORDING_NOT_ENABLED:"RECORDING_NOT_ENABLED",RECORDING_USER_STORAGE_FULL:"RECORDING_USER_STORAGE_FULL",RECORDING_SITE_STORAGE_FULL:"RECORDING_SITE_STORAGE_FULL",NO_SCHEDULED_MEETING:"NO_SCHEDULED_MEETING",MEETING_FULL_UPDATE_NOT_ALLOWED:"MEETING_FULL_UPDATE_NOT_ALLOWED",MODERATOR_ROLE_REMOVAL_NOT_VALID:"MODERATOR_ROLE_REMOVAL_NOT_VALID",MODERATOR_ROLE_ADDITION_NOT_VALID:"MODERATOR_ROLE_ADDITION_NOT_VALID",INVALID_CALL_START_TIME:"INVALID_CALL_START_TIME",MEETING_STARTED_UPDATE_NOT_ALLOWED:"MEETING_STARTED_UPDATE_NOT_ALLOWED",EXCEEDED_MAX_JOINED_PARTICIPANTS:"EXCEEDED_MAX_JOINED_PARTICIPANTS",EXCEEDED_SERVICE_MAX_PARTICIPANTS:"EXCEEDED_SERVICE_MAX_PARTICIPANTS",MEETING_IS_LOCKED:"MEETING_IS_LOCKED",MEETING_IS_TERMINATING:"MEETING_IS_TERMINATING",MEETING_REQUIRE_MODERATOR_PIN_INTENT:"MEETING_REQUIRE_MODERATOR_PIN_INTENT",MEETING_REQUIRE_MODERATOR_PIN:"MEETING_REQUIRE_MODERATOR_PIN",MEETING_REQUIRE_MODERATOR_ROLE:"MEETING_REQUIRE_MODERATOR_ROLE",PMR_ACCOUNT_SUSPENDED:"PMR_ACCOUNT_SUSPENDED",PMR_ACCOUNT_LOCKED:"PMR_ACCOUNT_LOCKED",INVALID_JOIN_TIME:"INVALID_JOIN_TIME",REQUIRES_WEBEX_LOGIN:"REQUIRES_WEBEX_LOGIN",TOO_MANY_REQUESTS:"TOO_MANY_REQUESTS",UNABLE_TO_LOOK_UP_DEVICE_INFORMATION:"UNABLE_TO_LOOK_UP_DEVICE_INFORMATION",UNABLE_TO_LOOK_UP_CONVERSATION:"UNABLE_TO_LOOK_UP_CONVERSATION",UNABLE_TO_LOOK_UP_CI_USER:"UNABLE_TO_LOOK_UP_CI_USER",UNABLE_TO_CREATE_CONFLUENCE:"UNABLE_TO_CREATE_CONFLUENCE",SERVICE_UNAVAILABLE:"SERVICE_UNAVAILABLE",SOCKET_TIMEOUT:"SOCKET_TIMEOUT",NO_HTTP_RESPONSE:"NO_HTTP_RESPONSE"},fv={INACTIVE:"INACTIVE",MEDIA_RELEASED:"MEDIA_RELEASED"},pv=function(e){return e.ENFORCE_VIRTUAL_BACKGROUND="enforceVirtualBackground",e.SUPPORT_LOCAL_RECORD="supportLocalRecord",e.SUPPORT_NETWORK_BASED_RECORD="supportNetworkBasedRecord",e.SUPPORT_REALTIME_CLOSE_CAPTION="supportRealtimeCloseCaption",e.SUPPORT_CHAT="supportChat",e.SUPPORT_DESKTOP_SHARE_REMOTE="supportDesktopShareRemote",e.SUPPORT_DESKTOP_SHARE="supportDesktopShare",e.SUPPORT_WHITEBOARD="supportWhiteboard",e.SUPPORT_FILE_TRANSFER="supportFileTransfer",e.SUPPORT_APP_SHARE="supportAppShare",e.SUPPORT_CAMERA_SHARE="supportCameraShare",e.SUPPORT_FILE_SHARE="supportFileShare",e.SUPPORT_ANNOTATION="supportAnnotation",e.SUPPORT_BROADCAST_MESSAGE="supportBroadcastMessage",e.SUPPORT_VIDEO="supportVideo",e.SUPPORT_HQV="supportHQV",e.SUPPORT_HDV="supportHDV",e.SUPPORT_PARTICIPANT_LIST="supportParticipantList",e.SUPPORT_VOIP="supportVoIP",e}({}),mv={ADD_GUEST:"ADD_GUEST",ROSTER_WAITING_TO_JOIN:"ROSTER_WAITING_TO_JOIN",RECORDING_CONTROL_START:"RECORDING_CONTROL_START",RECORDING_CONTROL_PAUSE:"RECORDING_CONTROL_PAUSE",RECORDING_CONTROL_STOP:"RECORDING_CONTROL_STOP",RECORDING_CONTROL_RESUME:"RECORDING_CONTROL_RESUME",LOCK_CONTROL_UNLOCK:"LOCK_CONTROL_UNLOCK",LOCK_CONTROL_LOCK:"LOCK_CONTROL_LOCK",LOCK_STATUS_LOCKED:"LOCK_STATUS_LOCKED",LOCK_STATUS_UNLOCKED:"LOCK_STATUS_UNLOCKED",RAISE_HAND:"RAISE_HAND",LOWER_ALL_HANDS:"LOWER_ALL_HANDS",LOWER_SOMEONE_ELSES_HAND:"LOWER_SOMEONE_ELSES_HAND",LEAVE_TRANSFER_HOST_END_MEETING:"LEAVE_TRANSFER_HOST_END_MEETING",LEAVE_END_MEETING:"LEAVE_END_MEETING",CAPTION_START:"CAPTION_START",CAPTION_STATUS_ACTIVE:"CAPTION_STATUS_ACTIVE",DISPLAY_REAL_TIME_TRANSLATION:"DISPLAY_REAL_TIME_TRANSLATION",ENABLE_CAPTION_PANEL:"ENABLE_CAPTION_PANEL",DISPLAY_NON_ENGLISH_ASR:"DISPLAY_NON_ENGLISH_ASR",TRANSCRIPTION_CONTROL_START:"TRANSCRIPTION_CONTROL_START",TRANSCRIPTION_CONTROL_STOP:"TRANSCRIPTION_CONTROL_STOP",SAVE_TRANSCRIPTS_ENABLED:"SAVE_TRANSCRIPTS_ENABLED",WEBEX_ASSISTANT_STATUS_ACTIVE:"WEBEX_ASSISTANT_STATUS_ACTIVE",WAITING_FOR_OTHERS:"WAITING_FOR_OTHERS",ENABLE_REACTIONS:"ENABLE_REACTIONS",DISABLE_REACTIONS:"DISABLE_REACTIONS",REACTIONS_ACTIVE:"REACTIONS_ACTIVE",REACTIONS_INACTIVE:"REACTIONS_INACTIVE",SHARE_CONTROL:"SHARE_CONTROL",ENABLE_MUTE_ON_ENTRY:"ENABLE_MUTE_ON_ENTRY",ENABLE_SHOW_DISPLAY_NAME:"ENABLE_SHOW_DISPLAY_NAME",DISABLE_SHOW_DISPLAY_NAME:"DISABLE_SHOW_DISPLAY_NAME",DISABLE_MUTE_ON_ENTRY:"DISABLE_MUTE_ON_ENTRY",ENABLE_HARD_MUTE:"ENABLE_HARD_MUTE",DISABLE_HARD_MUTE:"DISABLE_HARD_MUTE",MUTE_ALL:"MUTE_ALL",UNMUTE_ALL:"UNMUTE_ALL",PRESENTER_CONTROL:"PRESENTER_CONTROL",CAN_RENAME_SELF_AND_OBSERVED:"CAN_RENAME_SELF_AND_OBSERVED",CAN_RENAME_OTHERS:"CAN_RENAME_OTHERS",BREAKOUT_MANAGEMENT:"BREAKOUT_MANAGEMENT",BROADCAST_MESSAGE_TO_BREAKOUT:"BROADCAST_MESSAGE_TO_BREAKOUT",UCF_SUPPRESS_BREAKOUTS_SUPPORT:"UCF_SUPPRESS_BREAKOUTS_SUPPORT",DISABLE_ASK_FOR_HELP:"DISABLE_ASK_FOR_HELP",DISABLE_BREAKOUT_PREASSIGNMENTS:"DISABLE_BREAKOUT_PREASSIGNMENTS",DISABLE_LOBBY_TO_BREAKOUT:"DISABLE_LOBBY_TO_BREAKOUT",DISABLE_VIEW_THE_PARTICIPANT_LIST:"DISABLE_VIEW_THE_PARTICIPANT_LIST",ENABLE_VIEW_THE_PARTICIPANT_LIST:"ENABLE_VIEW_THE_PARTICIPANT_LIST",DISABLE_RAISE_HAND:"DISABLE_RAISE_HAND",ENABLE_RAISE_HAND:"ENABLE_RAISE_HAND",DISABLE_VIDEO:"DISABLE_VIDEO",ENABLE_VIDEO:"ENABLE_VIDEO",SHARE_FILE:"SHARE_FILE",SHARE_APPLICATION:"SHARE_APPLICATION",SHARE_CAMERA:"SHARE_CAMERA",SHARE_DESKTOP:"SHARE_DESKTOP",SHARE_CONTENT:"SHARE_CONTENT",SHARE_WHITEBOARD:"SHARE_WHITEBOARD",VOIP_IS_ENABLED:"VOIP_IS_ENABLED"},gv=[mv.VOIP_IS_ENABLED],vv={COHOST:"COHOST",MODERATOR:"MODERATOR",ATTENDEE:"ATTENDEE",PRESENTER:"PRESENTER"},yv={STATES:{IDLE:"IDLE",INCOMING:"INCOMING",DIALING:"DIALING",NOTIFIED:"NOTIFIED",DECLINED:"DECLINED",ON_GOING:"ON_GOING",JOINED:"JOINED",TERMINATING:"TERMINATING",LEFT:"LEFT",ENDED:"ENDED",ERROR:"ERROR"}},bv={TRANSITIONS:{FAIL:"fail",RING:"ring",REMOTE:"remote",JOIN:"join",DECLINE:"decline",LEAVE:"leave",END:"end",RESET:"reset"},STATES:{ERROR:"ERROR",IDLE:"IDLE",ENDED:"ENDED",DECLINED:"DECLINED",RINGING:"RINGING",JOINED:"JOINED",ANSWERED:"ANSWERED"}},Ev={TRANSITIONS:{TOGGLE:"toggle",INIT:"init"},STATES:{MUTE_SELF:"SELF_AUDIO_OFF",UNMUTE_SELF:"SELF_AUDIO_ON"}},wv={TRANSITIONS:{TOGGLE:"toggle",INIT:"init"},STATES:{MUTE_SELF:"SELF_VIDEO_OFF",UNMUTE_SELF:"SELF_VIDEO_ON"}},Sv={CLOSED:"closed",FAILED:"failed"},_v={STATE:{IN_PROGRESS:"IN_PROGRESS",COMPLETE:"COMPLETE",FAILURE:"FAILURE",DEFAULT_TRY_COUNT:0,DEFAULT_STATUS:""}},Tv={CLUSTERS:"clusters",REACHABILITY:"reachability",LOCI:"loci"},xv={localStorageResult:"reachability.result",localStorageJoinCookie:"reachability.joinCookie",namespace:"Reachability"},Av={ROAP_TYPES:{OFFER:"OFFER",ANSWER:"ANSWER",OK:"OK",ERROR:"ERROR",TURN_DISCOVERY_REQUEST:"TURN_DISCOVERY_REQUEST",TURN_DISCOVERY_RESPONSE:"TURN_DISCOVERY_RESPONSE"},ROAP_MERCURY:"event:locus.message.roap",ROAP_VERSION:"2"},Iv={main:"main",slides:"slides"},Cv={DISCONNECTED:"DISCONNECTED",RECONNECTING:"RECONNECTING",CONNECTED:"CONNECTED"},Rv={VPN:"vpn",UNKNOWN:"unknown",WIFI:"wifi",ETHERNET:"ethernet"},kv={SEND_DIRECTION:"send",RECEIVE_DIRECTION:"recv",REMOTE:"remote",LOCAL:"local"},Ov={MQA_SIZE:120,CA_TYPE:"MQA",DEFAULT_IP:"0.0.0.0",DEFAULT_SHARE_SENDER_STATS:{common:{common:{direction:"sendrecv",isMain:!1,mariFecEnabled:!1,mariQosEnabled:!1,multistreamEnabled:!1},availableBitrate:0,dtlsBitrate:0,dtlsPackets:0,fecBitrate:0,fecPackets:0,maxBitrate:0,queueDelay:0,remoteJitter:0,remoteLossRate:0,remoteReceiveRate:0,roundTripTime:0,rtcpBitrate:0,rtcpPackets:0,rtpBitrate:0,rtpPackets:0,stunBitrate:0,stunPackets:0,transportType:"UDP"},streams:[{common:{codec:"H264",duplicateSsci:0,requestedBitrate:0,requestedFrames:0,rtpPackets:0,ssci:0,transmittedBitrate:0,transmittedFrameRate:0},h264CodecProfile:"BP",localConfigurationChanges:0,remoteConfigurationChanges:0,requestedFrameSize:0,requestedKeyFrames:0,transmittedFrameSize:0,transmittedHeight:0,transmittedKeyFrames:0,transmittedWidth:0}]},intervalMetadata:{memoryUsage:{cpuBitWidth:0,mainProcessMaximumMemoryBytes:0,osBitWidth:0,processAverageMemoryUsage:0,processMaximumMemoryBytes:0,processMaximumMemoryUsage:0,systemAverageMemoryUsage:0,systemMaximumMemoryUsage:0},peerReflexiveIP:"NULL",processAverageCPU:0,processMaximumCPU:0,systemAverageCPU:0,systemMaximumCPU:0}},Nv={LOW:"LOW",MEDIUM:"MEDIUM",HIGH:"HIGH","360p":"360p","480p":"480p","720p":"720p","1080p":"1080p"},Pv={"360p":{video:{width:{max:640,ideal:640},height:{max:360,ideal:360}}},"480p":{video:{width:{max:640,ideal:640},height:{max:480,ideal:480}}},"720p":{video:{width:{max:1280,ideal:1280},height:{max:720,ideal:720}}},"1080p":{video:{width:{max:1920,ideal:1920},height:{max:1080,ideal:1080}}}},Lv=6e4,Dv={MICROPHONE:"microphone",SPEAKER:"speaker",CAMERA:"camera"},Mv={JOINED:"JOINED",CONNECTED:"CONNECTED",LEFT:"LEFT",TRANSFERRING:"TRANSFERRING",SUCCESS:"SUCCESS",UNKNOWN:""},Uv={NOT_REQUIRED:"NOT_REQUIRED",REQUIRED:"REQUIRED",UNKNOWN:"UNKNOWN",VERIFIED:"VERIFIED"},Bv={NONE:"NONE",WRONG_PASSWORD:"WRONG_PASSWORD",WRONG_CAPTCHA:"WRONG_CAPTCHA",POLICY:"POLICY",OTHER:"OTHER"},Fv={SHOULD_ENABLE:"SHOULD_ENABLE",ENABLED:"ENABLED",SHOULD_DISABLE:"SHOULD_DISABLE",NOT_ENABLED:"NOT_ENABLED"},jv={SLIDO:"SLIDO",OTHER:"OTHER"},Vv={supportHostKey:!0,supportCountryList:!0},Hv={unknown:0,only_ipv4:4,only_ipv6:6,ipv4_and_ipv6:1},Gv={DEVICE_NOT_JOINED:"Floor requested but device not yet joined",UNDEFINED:"undefined PUT",NO_MEDIA_FOR_DEVICE:"No media session found for device",NO_CONFLUENCE_ID:"Failed to request floor: 404 (null) could not find confluence id",CONTENT_SHARING_DISABLED:"Content share policies are disabled",LOCUS_PARTICIPANT_DNE:"does not exist in Locus",CONTENT_REQUEST_WHILE_PENDING_WHITEBOARD:"Content share request is not allowed while whiteboard floor request is pending"},qv=30,$v="ttl-join";function Zv(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var zv=function(e){(0,A.Z)(r,e);var t=Zv(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qg.PARAMETER.MESSAGE,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,k.Z)(this,r),e=t.call(this,n),(0,R.Z)((0,x.Z)(e),"sdkMessage",void 0),(0,R.Z)((0,x.Z)(e),"error",void 0),(0,R.Z)((0,x.Z)(e),"code",void 0),Error.captureStackTrace&&Error.captureStackTrace((0,x.Z)(e),r),e.name=Qg.PARAMETER.NAME,e.sdkMessage=n||Qg.PARAMETER.MESSAGE,e.error=i,e.code=Qg.PARAMETER.CODE,e}return(0,O.Z)(r)}((0,yp.Z)(Error)),Kv=r(89539),Wv={getEventLog:function(e){var t="";try{t=(0,Kv.inspect)(e)}catch(e){pp.logger.warn("Events:util#getEventLog --\x3e ".concat(e))}return t},getScopeLog:function(e){var t="";if(e){if(e.file&&e.function)return t+="".concat(e.file,":").concat(e.function,"->");e.file&&(t+="".concat(e.file,"->")),e.function&&(t+="".concat(e.function,"->"))}return t}};const Jv=Wv;var Yv={trigger:function(e,t,r,n){if(!e||!e.trigger)throw new zv("Instance to trigger from must be defined and have a trigger function.");return pp.logger.debug("".concat(Jv.getScopeLog(t),"event#").concat(r).concat(cp.verboseEvents?" -- ".concat(Jv.getEventLog(n)):"")),e.trigger(r,n)}};const Qv=Yv,Xv={meetings:{deviceType:bp.deviceType.WEB,mediaSettings:{pstn:!1},reconnection:{enabled:!1,autoRejoin:!0,detection:!0,iceReconnectionTimeout:1e4,maxRejoinAttempts:3},stats:{enableStatsAnalyzer:!0,autoDowngradeEnabled:!1,interval:1e3,analyzerInterval:5e3,historyMax:120,videoPacketLossRatioThreshold:9,rttThreshold:500,jitterThreshold:500},metrics:{clientName:"WEBEX_JS_SDK",clientType:"WEBEX_SDK",subClientType:"WEB_APP",mqaMetricsInterval:6e4,autoSendMQA:!0},logging:{enable:!0,verboseEvents:!0},resolution:{maxWidth:1280,maxHeight:720,idealWidth:1280,idealHeight:720},screenResolution:{maxWidth:1920,maxHeight:1080,idealWidth:1920,idealHeight:1080},bandwidth:{audio:64e3,video:4e6,startBitrate:2e3},screenFrameRate:10,videoShareFrameRate:30,aspectRatio:1.7695852534562213,autoUploadLogs:!0,enableRtx:!0,receiveTranscription:!1,enableExtmap:!1,enableAutomaticLLM:!1,installedOrgID:void 0,experimental:{enableMediaNegotiatedEvent:!1,enableUnifiedMeetings:!0,enableAdhocMeetings:!0,enableTcpReachability:!1},degradationPreferences:{maxMacroblocksLimit:8192}}};var ey=r(88306),ty=r.n(ey),ry=r(51206),ny=r.n(ry),iy=r(58908),oy=r.n(iy),sy={getOSName:function(){return r(24753).platform()},getOSVersion:function(){return r(24753).release()},getBrowserName:function(){return""},getBrowserVersion:function(){return""},isBrowser:function(){return!1}};const ay=ty()((function(e){var t,r;return e||null!==(t=oy().navigator)&&void 0!==t&&t.userAgent?(r=ny().getParser(e||oy().navigator.userAgent),{getOSName:function(){var e;return null!==(e=null==r?void 0:r.getOSName())&&void 0!==e?e:""},getOSVersion:function(){var e;return null!==(e=null==r?void 0:r.getOSVersion())&&void 0!==e?e:""},getBrowserName:function(){var e;return null!==(e=null==r?void 0:r.getBrowserName())&&void 0!==e?e:""},getBrowserVersion:function(){var e;return null!==(e=null==r?void 0:r.getBrowserVersion())&&void 0!==e?e:""},isBrowser:function(e){return!(null==r||!r.isBrowser(e,!0))}}):sy}));var cy=r(8450),uy=r.n(cy),ly="FFB51ED5-4319-4C55-8303-B1F2FCCDE231",dy=function(){function e(t,r,n){(0,k.Z)(this,e),(0,R.Z)(this,"metricsQueue",[]),(0,R.Z)(this,"intervalId",void 0),(0,R.Z)(this,"webex",void 0),(0,R.Z)(this,"meetingId",void 0),(0,R.Z)(this,"correlationId",void 0),(0,R.Z)(this,"connectionId",void 0),this.intervalId=window.setInterval(this.sendMetricsInQueue.bind(this),3e4),this.meetingId=r,this.webex=t,this.correlationId=n,this.setNewConnectionId(),setTimeout(this.sendMetricsInQueue.bind(this),5e3)}return(0,O.Z)(e,[{key:"sendMetricsInQueue",value:function(){this.metricsQueue.length&&(this.sendMetrics(),this.metricsQueue=[])}},{key:"addMetrics",value:function(e){if(e.payload.length){"stats-report"===e.name&&(e.payload=e.payload.map(this.anonymizeIp)),this.metricsQueue.push(e);try{var t=function(e){try{return e&&e[0]?JSON.parse(e[0]):null}catch(e){return null}}(e.payload);"onconnectionstatechange"===e.name&&t&&"failed"===t.value&&(this.sendMetricsInQueue(),this.setNewConnectionId())}catch(e){console.error(e)}}}},{key:"closeMetrics",value:function(){this.sendMetricsInQueue(),clearInterval(this.intervalId)}},{key:"anonymizeIp",value:function(e){var t=JSON.parse(e);return"local-candidate"!==t.type&&"remote-candidate"!==t.type||(t.ip=H.CallDiagnosticUtils.anonymizeIPAddress(t.ip)||void 0,t.address=H.CallDiagnosticUtils.anonymizeIPAddress(t.address)||void 0,t.relatedAddress=H.CallDiagnosticUtils.anonymizeIPAddress(t.relatedAddress)||void 0),uy()(t)}},{key:"setNewConnectionId",value:function(){this.connectionId=gp().v4()}},{key:"sendMetrics",value:function(){this.webex.request({method:"POST",service:"unifiedTelemetry",resource:"metric/v2",headers:{type:"webrtcMedia",appId:ly},body:{metrics:[{type:"webrtc",version:"1.1.0",userId:this.webex.internal.device.userId,meetingId:this.meetingId,correlationId:this.correlationId,connectionId:this.connectionId,data:this.metricsQueue}]}})}}]),e}();function hy(e,t){var r=U()(e);if(p()){var n=p()(e);t&&(n=n.filter((function(t){return g()(e,t).enumerable}))),r.push.apply(r,n)}return r}function fy(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?hy(Object(r),!0).forEach((function(t){(0,R.Z)(e,t,r[t])})):y()?E()(e,y()(r)):hy(Object(r)).forEach((function(t){S()(e,t,g()(r,t))}))}return e}var py=ay().isBrowser,my={getLocalMedia:function(e,t){var r=e.sendAudio,n=e.sendVideo,i=e.sendShare,o=e.sharePreferences,s=e.isSharing;return r||n?my.getMedia(r,n,t):i&&!s?my.getDisplayMedia({sendAudio:!1,sendShare:!0,sharePreferences:o},t):P().resolve(void 0)},getDirection:function(e,t,r){return t||r?e||t&&r?"sendrecv":t?"recvonly":"sendonly":"inactive"},createMediaConnection:function(e,t,r,n,i,o){var s,a,c,u,l=o.mediaProperties,d=o.remoteQualityLevel,h=o.enableRtx,f=o.enableExtmap,p=o.turnServerInfo,m=o.bundlePolicy,g=[];if(p&&g.push({urls:p.url,username:p.username||"",credential:p.password||""}),e){var v={iceServers:g};m&&(v.bundlePolicy=m);var y=new dy(r,n,i);return new gh(v,n,(function(e){return y.addMetrics(e)}),(function(){return y.closeMetrics()}),(function(){return y.sendMetricsInQueue()}))}if(!l)throw new Error("mediaProperties have to be provided for non-multistream media connections");var b=l.mediaDirection,E=l.audioStream,w=l.videoStream,S=l.shareVideoStream,_=l.shareAudioStream;return new ph({iceServers:g,skipInactiveTransceivers:!1,requireH264:!0,sdpMunging:{convertPort9to0:!1,addContentSlides:!0,bandwidthLimits:{audio:hp.meetings.bandwidth.audio,video:hp.meetings.bandwidth.video},startBitrate:hp.meetings.bandwidth.startBitrate,periodicKeyframes:20,disableExtmap:!f,disableRtx:!h}},{localTracks:{audio:null==E||null===(s=E.outputStream)||void 0===s?void 0:s.getTracks()[0],video:null==w||null===(a=w.outputStream)||void 0===a?void 0:a.getTracks()[0],screenShareVideo:null==S||null===(c=S.outputStream)||void 0===c?void 0:c.getTracks()[0],screenShareAudio:null==_||null===(u=_.outputStream)||void 0===u?void 0:u.getTracks()[0]},direction:{audio:my.getDirection(!0,b.receiveAudio,b.sendAudio),video:my.getDirection(!0,b.receiveVideo,b.sendVideo),screenShareVideo:my.getDirection(!1,b.receiveShare,b.sendShare)},remoteQualityLevel:d},t)},getDisplayMedia:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.screenResolution||{},n=t.screenFrameRate||null,i=e.sharePreferences,o=i&&i.shareConstraints,s=i&&i.highFrameRate,a=Xv.meetings,c=a.screenResolution,u=a.resolution,l=a.videoShareFrameRate,d=a.screenFrameRate,h=a.aspectRatio,f={cursor:dv.CURSOR.AWLAYS,aspectRatio:h};if(f=o?i.shareConstraints:s?fy(fy({},f),{},{frameRate:l,height:u.idealHeight,width:u.idealWidth},t.resolution):fy(fy({},f),{},{frameRate:n||d,height:r.idealHeight||c.idealHeight,width:r.idealWidth||c.idealWidth},t.screenResolution),py("firefox")){var p={audio:e.sendAudio,video:e.sendShare};return navigator.mediaDevices.getDisplayMedia({audio:e.sendAudio,video:p}).then((function(t){return e.sendShare&&t.getVideoTracks().length>0&&t.getVideoTracks()[0].applyConstraints(f),t}))}var m={video:!!e.sendShare&&f};return e.sendAudio&&py("safari")&&(m.audio=e.sendAudio),navigator.mediaDevices.getDisplayMedia(m)},getMedia:function(e,t,r){var n={ideal:r.resolution.idealWidth,max:r.resolution.maxWidth},i={ideal:r.resolution.idealHeight,max:r.resolution.maxHeight},o={audio:e,video:!!t&&(py("firefox")&&t.width&&320===t.width.max?{deviceId:t.deviceId?t.deviceId:void 0,width:320,height:180,frameRate:t.frameRate?t.frameRate:void 0,facingMode:t.facingMode?t.facingMode:void 0}:{deviceId:t.deviceId?t.deviceId:void 0,width:t.width?t.width:n,height:t.height?t.height:i,frameRate:t.frameRate?t.frameRate:void 0,facingMode:t.facingMode?t.facingMode:void 0}),fake:!1};return navigator.mediaDevices.getUserMedia(o).catch((function(e){throw pp.logger.error("".concat("Media:index#getMedia --\x3e navigator.mediaDevices.getUserMedia"," failed - ").concat(e," (").concat(e.constraint,")")),e}))},toggleStream:function(){},stopStream:function(e){return e?P().resolve().then((function(){try{e.stop()}catch(t){pp.logger.error("Media:index#stopStream --\x3e Unable to stop the stream with ready state => ".concat(e.readyState,", error: ").concat(t))}})):P().resolve()},getUserMedia:function(e,t,r,n){return my.getLocalMedia({sendAudio:!!e.sendAudio&&(t.audio||e.sendAudio),sendVideo:!!e.sendVideo&&(t.video||e.sendVideo)},n).then((function(t){return my.getLocalMedia({sendShare:e.sendShare,isSharing:e.isSharing,sharePreferences:r},n).then((function(e){return[t,e]}))}))}};const gy=my;var vy=r(27921),yy=r.n(vy),by=r(85579),Ey=r.n(by),wy=r(22013),Sy=r.n(wy),_y=r(78149),Ty=r.n(_y),xy=r(14917),Ay=r(50361),Iy=r.n(Ay);function Cy(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var Ry=function(e){(0,A.Z)(r,e);var t=Cy(r);function r(e){var n;(0,k.Z)(this,r);for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return n=t.call.apply(t,[this].concat(o)),(0,R.Z)((0,x.Z)(n),"code",void 0),n.name="WebexMeetingsError",S()((0,x.Z)(n),"code",{value:e,enumerable:!0}),n}return(0,O.Z)(r,[{key:"toString",value:function(){var e=this.message?": ".concat(this.message):"";return"".concat(this.name," ").concat(this.code).concat(e)}}]),r}((0,yp.Z)(Error));function ky(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var Oy={};var Ny=function(e){(0,A.Z)(r,e);var t=ky(r);function r(){return(0,k.Z)(this,r),t.call(this,r.CODE,"Meeting has already Ended or not Active")}return(0,O.Z)(r)}(Ry);(0,R.Z)(Ny,"CODE",30101),Oy[Ny.CODE]=Ny;var Py=function(e){(0,A.Z)(r,e);var t=ky(r);function r(){return(0,k.Z)(this,r),t.call(this,r.CODE,"User currently not in meeting. Please join a meeting before adding media.")}return(0,O.Z)(r)}(Ry);(0,R.Z)(Py,"CODE",30102),Oy[Py.CODE]=Py;var Ly=function(e){(0,A.Z)(r,e);var t=ky(r);function r(){return(0,k.Z)(this,r),t.call(this,r.CODE,"Webrtc media connection is missing, call addMedia() first")}return(0,O.Z)(r)}(Ry);(0,R.Z)(Ly,"CODE",30103),Oy[Ly.CODE]=Ly;var Dy=function(e){(0,A.Z)(r,e);var t=ky(r);function r(){return(0,k.Z)(this,r),t.call(this,r.CODE,"user is still in the lobby or not joined")}return(0,O.Z)(r)}(Ry);(0,R.Z)(Dy,"CODE",30104),Oy[Dy.CODE]=Dy;var My=function(e){(0,A.Z)(r,e);var t=ky(r);function r(){return(0,k.Z)(this,r),t.call(this,r.CODE,"Using the space ID as a destination is no longer supported. Please refer to the [migration guide](https://github.com/webex/webex-js-sdk/wiki/Migration-to-Unified-Space-Meetings) to migrate to use the meeting ID or SIP address.")}return(0,O.Z)(r)}(Ry);(0,R.Z)(My,"CODE",30105),Oy[My.CODE]=My;var Uy=function(e){(0,A.Z)(r,e);var t=ky(r);function r(){return(0,k.Z)(this,r),t.call(this,r.CODE,"iceConnection: gethering ice candidate failed")}return(0,O.Z)(r)}(Ry);(0,R.Z)(Uy,"CODE",30202),Oy[Uy.CODE]=Uy;var By=function(e){(0,A.Z)(r,e);var t=ky(r);function r(){return(0,k.Z)(this,r),t.call(this,r.CODE,"Failed to add media")}return(0,O.Z)(r)}(Ry);function Fy(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}(0,R.Z)(By,"CODE",30203),Oy[By.CODE]=By;var jy=function(e){(0,A.Z)(r,e);var t=Fy(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qg.INTENT_TO_JOIN.MESSAGE,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,k.Z)(this,r),e=t.call(this,n),(0,R.Z)((0,x.Z)(e),"code",void 0),(0,R.Z)((0,x.Z)(e),"error",void 0),(0,R.Z)((0,x.Z)(e),"joinIntentRequired",void 0),(0,R.Z)((0,x.Z)(e),"sdkMessage",void 0),e.name=Qg.INTENT_TO_JOIN.NAME,e.sdkMessage=Qg.INTENT_TO_JOIN.MESSAGE,e.error=i,e.stack=i?i.stack:(new Error).stack,e.joinIntentRequired=!0,e.code=Qg.INTENT_TO_JOIN.CODE,e}return(0,O.Z)(r)}((0,yp.Z)(Error));function Vy(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var Hy=function(e){(0,A.Z)(r,e);var t=Vy(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qg.JOIN_MEETING.MESSAGE,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(0,k.Z)(this,r),e=t.call(this,i),(0,R.Z)((0,x.Z)(e),"code",void 0),(0,R.Z)((0,x.Z)(e),"error",void 0),(0,R.Z)((0,x.Z)(e),"joinOptions",void 0),(0,R.Z)((0,x.Z)(e),"sdkMessage",void 0),e.name=Qg.JOIN_MEETING.NAME,e.sdkMessage=Qg.JOIN_MEETING.MESSAGE,e.error=o,e.stack=o?o.stack:(new Error).stack,e.joinOptions=n,e.code=Qg.JOIN_MEETING.CODE,e}return(0,O.Z)(r)}((0,yp.Z)(Error));function Gy(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var qy=function(e){(0,A.Z)(r,e);var t=Gy(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qg.PERMISSION.MESSAGE,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,k.Z)(this,r),e=t.call(this,n),(0,R.Z)((0,x.Z)(e),"code",void 0),(0,R.Z)((0,x.Z)(e),"error",void 0),(0,R.Z)((0,x.Z)(e),"sdkMessage",void 0),e.name=Qg.PERMISSION.NAME,e.sdkMessage=Qg.PERMISSION.MESSAGE,e.error=i,e.stack=i?i.stack:(new Error).stack,e.code=Qg.PERMISSION.CODE,e}return(0,O.Z)(r)}((0,yp.Z)(Error));function $y(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var Zy=function(e){(0,A.Z)(r,e);var t=$y(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qg.PASSWORD.MESSAGE,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,k.Z)(this,r),e=t.call(this,n),(0,R.Z)((0,x.Z)(e),"code",void 0),(0,R.Z)((0,x.Z)(e),"error",void 0),(0,R.Z)((0,x.Z)(e),"sdkMessage",void 0),e.name=Qg.PASSWORD.NAME,e.sdkMessage=Qg.PASSWORD.MESSAGE,e.error=i,e.stack=i?i.stack:(new Error).stack,e.code=Qg.PASSWORD.CODE,e}return(0,O.Z)(r)}((0,yp.Z)(Error));function zy(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var Ky=function(e){(0,A.Z)(r,e);var t=zy(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qg.CAPTCHA.MESSAGE,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,k.Z)(this,r),e=t.call(this,n),(0,R.Z)((0,x.Z)(e),"code",void 0),(0,R.Z)((0,x.Z)(e),"error",void 0),(0,R.Z)((0,x.Z)(e),"sdkMessage",void 0),e.name=Qg.CAPTCHA.NAME,e.sdkMessage=Qg.CAPTCHA.MESSAGE,e.error=i,e.stack=i?i.stack:(new Error).stack,e.code=Qg.CAPTCHA.CODE,e}return(0,O.Z)(r)}((0,yp.Z)(Error));function Wy(e,t){var r=void 0!==Ey()&&e[Sy()]||e["@@iterator"];if(!r){if(Ty()(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Jy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return yy()(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Jy(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}function Jy(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Yy(e,t){var r=U()(e);if(p()){var n=p()(e);t&&(n=n.filter((function(t){return g()(e,t).enumerable}))),r.push.apply(r,n)}return r}function Qy(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Yy(Object(r),!0).forEach((function(t){(0,R.Z)(e,t,r[t])})):y()?E()(e,y()(r)):Yy(Object(r)).forEach((function(t){S()(e,t,g()(r,t))}))}return e}var Xy={parseLocusJoin:function(e){var t={};return t.locus=e.body.locus,t.mediaConnections=e.body.mediaConnections,t.locusUrl=t.locus.url,t.locusId=t.locus.url.split("/").pop(),t.selfId=t.locus.self.id,t.mediaConnections.forEach((function(e){e.mediaId&&(t.mediaId=e.mediaId)})),t},remoteUpdateAudioVideo:function(e,t,r){var n=e.getWebexObject();return e?e.locusMediaRequest?(n.internal.newMetrics.submitClientEvent({name:"client.locus.media.request",options:{meetingId:e.id}}),e.locusMediaRequest.send({type:"LocalMute",selfUrl:e.selfUrl,mediaId:e.mediaId,sequence:e.locusInfo.sequence,muteOptions:{audioMuted:t,videoMuted:r}}).then((function(t){var r;return n.internal.newMetrics.submitClientEvent({name:"client.locus.media.response",options:{meetingId:e.id}}),null==t||null===(r=t.body)||void 0===r?void 0:r.locus}))):P().reject(new zv("You need a meeting with a media connection, call Meeting.addMedia() first.")):P().reject(new zv("You need a meeting object."))},hasOwner:function(e){return e&&e.owner},isOwnerSelf:function(e,t){return e===t},isPinOrGuest:function(e){var t;return(null==e||null===(t=e.body)||void 0===t?void 0:t.errorCode)&&Ag.includes(e.body.errorCode)},getIpVersion:function(e){var t=e.internal.device.ipNetworkDetector,r=t.supportsIpV4,n=t.supportsIpV6;if(!ay().isBrowser("firefox"))return r&&n?Hv.ipv4_and_ipv6:r?Hv.only_ipv4:n?Hv.only_ipv6:Hv.unknown},joinMeeting:function(e,t){var r;if(!e)return P().reject(new zv("You need a meeting object."));var n=e.getWebexObject();return n.internal.newMetrics.submitClientEvent({name:"client.locus.join.request",options:{meetingId:e.id}}),e.meetingRequest.joinMeeting({inviteeAddress:e.meetingJoinUrl||e.sipUri,meetingNumber:e.meetingNumber,deviceUrl:e.deviceUrl,locusUrl:e.locusUrl,locusClusterUrl:null===(r=e.meetingInfo)||void 0===r?void 0:r.locusClusterUrl,correlationId:e.correlationId,roapMessage:t.roapMessage,permissionToken:e.permissionToken,resourceId:t.resourceId||null,moderator:t.moderator,pin:t.pin,moveToResource:t.moveToResource,preferTranscoding:!e.isMultistream,asResourceOccupant:t.asResourceOccupant,breakoutsSupported:t.breakoutsSupported,locale:t.locale,deviceCapabilities:t.deviceCapabilities,liveAnnotationSupported:t.liveAnnotationSupported,ipVersion:Xy.getIpVersion(e.getWebexObject())}).then((function(t){return n.internal.newMetrics.submitClientEvent({name:"client.locus.join.response",payload:{trigger:"loci-update",identifiers:{trackingId:t.headers.trackingid}},options:{meetingId:e.id,mediaConnections:t.body.mediaConnections}}),Xy.parseLocusJoin(t)}))},cleanUp:function(e){return e.breakouts.cleanUp(),e.simultaneousInterpretation.cleanUp(),(e.statsAnalyzer?e.statsAnalyzer.stopAnalyzer():P().resolve()).then((function(){return e.closeRemoteStreams()})).then((function(){return e.closePeerConnections()})).then((function(){e.cleanupLocalStreams(),e.unsetRemoteStreams(),e.unsetPeerConnections(),e.reconnectionManager.cleanUp()})).then((function(){return e.stopKeepAlive()})).then((function(){return e.updateLLMConnection()}))},disconnectPhoneAudio:function(e,t){if(e.meetingState===ev.INACTIVE)return P().reject(new Ny);var r={locusUrl:e.locusUrl,selfId:e.selfId,correlationId:e.correlationId,phoneUrl:t};return e.meetingRequest.disconnectPhoneAudio(r).catch((function(t){return pp.logger.error("Meeting:util#disconnectPhoneAudio --\x3e An error occured while disconnecting phone audio in meeting ".concat(e.id,", error: ").concat(t)),P().reject(t)}))},prepareLeaveMeetingOptions:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Qy(Qy({},{locusUrl:e.locusUrl,selfId:e.selfId,correlationId:e.correlationId,resourceId:e.resourceId,deviceUrl:e.deviceUrl}),t)},leaveMeeting:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.meetingState===ev.INACTIVE)return P().reject(new Ny);if(Xy.isUserInLeftState(e.locusInfo))return P().reject(new Py);var r=Xy.prepareLeaveMeetingOptions(e,t);return e.meetingRequest.leaveMeeting(r).then((function(){return t.moveMeeting?P().resolve():Xy.cleanUp(e)})).catch((function(t){return pp.logger.error("Meeting:util#leaveMeeting --\x3e An error occured while trying to leave meeting with an id of ".concat(e.id,", error: ").concat(t)),P().reject(t)}))},declineMeeting:function(e,t){return e.meetingRequest.declineMeeting({locusUrl:e.locusUrl,deviceUrl:e.deviceUrl,reason:t})},isUserInLeftState:function(e){var t,r;return(null===(t=e.parsedLocus)||void 0===t||null===(r=t.self)||void 0===r?void 0:r.state)===Mm},isUserInIdleState:function(e){var t,r;return(null===(t=e.parsedLocus)||void 0===t||null===(r=t.self)||void 0===r?void 0:r.state)===Im},isUserInJoinedState:function(e){var t,r;return(null===(t=e.parsedLocus)||void 0===t||null===(r=t.self)||void 0===r?void 0:r.state)===Lm},isMediaEstablished:function(e){return e&&(e.audio||e.video||e.share)},joinMeetingOptions:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.getWebexObject();return e.resourceId=e.resourceId||t.resourceId,e.requiredCaptcha?P().reject(new Ky):e.passwordStatus===Uv.REQUIRED?P().reject(new Zy):(t.pin&&r.internal.newMetrics.submitClientEvent({name:"client.pin.collected",options:{meetingId:e.id}}),Xy.joinMeeting(e,t).then((function(t){return e.setLocus(t),P().resolve(t)})).catch((function(n){return Xy.isPinOrGuest(n)?(r.internal.newMetrics.submitClientEvent({name:"client.pin.prompt",options:{meetingId:e.id}}),P().reject(new jy("Error Joining Meeting",n))):(pp.logger.error("Meeting:util#joinMeetingOptions --\x3e Error joining the call, ",n),P().reject(new Hy(t,"Error Joining Meeting",n)))})))},buildLeaveFetchRequestOptions:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Xy.prepareLeaveMeetingOptions(e,t);return e.meetingRequest.buildLeaveMeetingRequestOptions(r)},getTrack:function(e){var t=null,r=null,n=null,i=null;if(!e)return{audioTrack:null,videoTrack:null};if(e.getAudioTracks&&(n=e.getAudioTracks()),e.getVideoTracks&&(i=e.getVideoTracks()),n&&n.length>0){var o=n;t=(0,xy.Z)(o,1)[0]}if(i&&i.length>0){var s=i;r=(0,xy.Z)(s,1)[0]}return{audioTrack:t,videoTrack:r}},getModeratorFromLocusInfo:function(e){return e&&e.parsedLocus&&e.parsedLocus.info&&e.parsedLocus.info&&e.parsedLocus.info.moderator},getPolicyFromLocusInfo:function(e){return e&&e.parsedLocus&&e.parsedLocus.info&&e.parsedLocus.info&&e.parsedLocus.info.policy},getUserDisplayHintsFromLocusInfo:function(e){var t,r;return(null==e||null===(t=e.parsedLocus)||void 0===t||null===(r=t.info)||void 0===r?void 0:r.userDisplayHints)||[]},canInviteNewParticipants:function(e){return e.includes(mv.ADD_GUEST)},canAdmitParticipant:function(e){return e.includes(mv.ROSTER_WAITING_TO_JOIN)},canUserLock:function(e){return e.includes(mv.LOCK_CONTROL_LOCK)&&e.includes(mv.LOCK_STATUS_UNLOCKED)},canUserUnlock:function(e){return e.includes(mv.LOCK_CONTROL_UNLOCK)&&e.includes(mv.LOCK_STATUS_LOCKED)},canUserRaiseHand:function(e){return e.includes(mv.RAISE_HAND)},canUserLowerAllHands:function(e){return e.includes(mv.LOWER_ALL_HANDS)},canUserLowerSomeoneElsesHand:function(e){return e.includes(mv.LOWER_SOMEONE_ELSES_HAND)},bothLeaveAndEndMeetingAvailable:function(e){return e.includes(mv.LEAVE_TRANSFER_HOST_END_MEETING)||e.includes(mv.LEAVE_END_MEETING)},canManageBreakout:function(e){return e.includes(mv.BREAKOUT_MANAGEMENT)},canBroadcastMessageToBreakout:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.includes(mv.BROADCAST_MESSAGE_TO_BREAKOUT)&&!!t[pv.SUPPORT_BROADCAST_MESSAGE]},isSuppressBreakoutSupport:function(e){return e.includes(mv.UCF_SUPPRESS_BREAKOUTS_SUPPORT)},canAdmitLobbyToBreakout:function(e){return!e.includes(mv.DISABLE_LOBBY_TO_BREAKOUT)},isBreakoutPreassignmentsEnabled:function(e){return!e.includes(mv.DISABLE_BREAKOUT_PREASSIGNMENTS)},canUserAskForHelp:function(e){return!e.includes(mv.DISABLE_ASK_FOR_HELP)},lockMeeting:function(e,t,r){return e&&e.canLock?t.lockMeeting({locusUrl:r,lock:!0}):P().reject(new qy("Lock not allowed, due to joined property."))},unlockMeeting:function(e,t,r){return e&&e.canUnlock?t.lockMeeting({locusUrl:r,lock:!1}):P().reject(new qy("Unlock not allowed, due to joined property."))},handleAudioLogging:function(e){var t="MeetingUtil#handleAudioLogging --\x3e";if(e){var r=e.getSettings(),n=r.deviceId;pp.logger.log(t,"deviceId = ".concat(n)),pp.logger.log(t,"settings =",uy()(r))}},handleVideoLogging:function(e){var t="MeetingUtil#handleVideoLogging --\x3e";if(e){var r=e.getSettings(),n=r.deviceId;pp.logger.log(t,"deviceId = ".concat(n)),pp.logger.log(t,"settings =",uy()(r))}},handleDeviceLogging:function(){var e="MeetingUtil#handleDeviceLogging --\x3e";(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(t){pp.logger.log(e,"deviceId = ".concat(t.deviceId)),pp.logger.log(e,"settings",uy()(t))}))},endMeetingForAll:function(e){if(e.meetingState===ev.INACTIVE)return P().reject(new Ny);var t={locusUrl:e.locusUrl};return e.meetingRequest.endMeetingForAll(t).then((function(){return Xy.cleanUp(e)})).catch((function(t){return pp.logger.error("Meeting:util#endMeetingForAll An error occured while trying to end meeting for all with an id of ".concat(e.id,", error: ").concat(t)),P().reject(t)}))},canEnableClosedCaption:function(e){return e.includes(mv.CAPTION_START)},isSaveTranscriptsEnabled:function(e){return e.includes(mv.SAVE_TRANSCRIPTS_ENABLED)},canStartTranscribing:function(e){return e.includes(mv.TRANSCRIPTION_CONTROL_START)},canStopTranscribing:function(e){return e.includes(mv.TRANSCRIPTION_CONTROL_STOP)},isClosedCaptionActive:function(e){return e.includes(mv.CAPTION_STATUS_ACTIVE)},isWebexAssistantActive:function(e){return e.includes(mv.WEBEX_ASSISTANT_STATUS_ACTIVE)},canViewCaptionPanel:function(e){return e.includes(mv.ENABLE_CAPTION_PANEL)},isRealTimeTranslationEnabled:function(e){return e.includes(mv.DISPLAY_REAL_TIME_TRANSLATION)},canSelectSpokenLanguages:function(e){return e.includes(mv.DISPLAY_NON_ENGLISH_ASR)},waitingForOthersToJoin:function(e){return e.includes(mv.WAITING_FOR_OTHERS)},canSendReactions:function(e,t){return!!t.includes(mv.REACTIONS_ACTIVE)||!t.includes(mv.REACTIONS_INACTIVE)&&e},canUserRenameSelfAndObserved:function(e){return e.includes(mv.CAN_RENAME_SELF_AND_OBSERVED)},canUserRenameOthers:function(e){return e.includes(mv.CAN_RENAME_OTHERS)},canShareWhiteBoard:function(e){return e.includes(mv.SHARE_WHITEBOARD)},addSequence:function(e,t){var r,n=null==e||null===(r=e.locusInfo)||void 0===r?void 0:r.sequence;n&&(t.sequence=n)},updateLocusWithDelta:function(e,t){var r;if(!e)return t;var n=null==t||null===(r=t.body)||void 0===r?void 0:r.locus;return n&&e.locusInfo.handleLocusDelta(n,e),t},generateBuildLocusDeltaRequestOptions:function(e){var t=new WeakRef(e);return function(e){var r=t.deref();if(!r)return e;var n=Iy()(e);return n.body||(n.body={}),Xy.addSequence(r,n.body),n}},generateLocusDeltaRequest:function(e){var t=new WeakRef(e),r=Xy.generateBuildLocusDeltaRequestOptions(e);return function(e){var n=t.deref();if(!n)return P().resolve();var i=r(e);return n.request(i).then((function(e){return Xy.updateLocusWithDelta(n,e)}))}},selfSupportsFeature:function(e,t){return!t||t[e]},parseInterpretationInfo:function(e,t){var r;if(e&&t){var n=t.simultaneousInterpretation;e.simultaneousInterpretation.updateMeetingSIEnabled(!!t.turnOnSimultaneousInterpretation,!(null==n||!n.currentSIInterpreter));var i=!(!t.turnOnSimultaneousInterpretation||null==t||null===(r=t.meetingSiteSetting)||void 0===r||!r.enableHostInterpreterControlSI);if(e.simultaneousInterpretation.updateHostSIEnabled(i),n){var o,s,a,c=Iy()(n.siLanguages),u=Wy(c);try{for(u.s();!(a=u.n()).done;){var l=a.value;d(l,"languageCode","languageName"),d(l,"languageGroupId","languageCode")}}catch(e){u.e(e)}finally{u.f()}null!==(o=e.simultaneousInterpretation)&&void 0!==o&&null!==(s=o.siLanguages)&&void 0!==s&&s.length||e.simultaneousInterpretation.updateInterpretation({siLanguages:c})}Qv.trigger(e,{file:"meeting/util",function:"parseInterpretationInfo"},$g.MEETING_INTERPRETATION_UPDATE)}function d(e,t,r){t in e&&(e[r]=e[t],delete e[t])}},getChangeMeetingFloorErrorPayload:function(e){var t={errorDescription:e,name:"locus.response",shownToUser:!1};return e.includes(Gv.UNDEFINED)?[Qy(Qy({},t),{},{fatal:!0,category:"signaling",errorCode:1100})]:e.includes(Gv.DEVICE_NOT_JOINED)?[Qy(Qy({},t),{},{fatal:!0,category:"signaling",errorCode:4050})]:e.includes(Gv.NO_MEDIA_FOR_DEVICE)?[Qy(Qy({},t),{},{fatal:!0,category:"media",errorCode:2048})]:e.includes(Gv.NO_CONFLUENCE_ID)?[Qy(Qy({},t),{},{fatal:!0,category:"signaling",errorCode:4064})]:e.includes(Gv.CONTENT_SHARING_DISABLED)?[Qy(Qy({},t),{},{fatal:!0,category:"expected",errorCode:4065})]:e.includes(Gv.LOCUS_PARTICIPANT_DNE)?[Qy(Qy({},t),{},{fatal:!0,category:"signaling",errorCode:4066})]:e.includes(Gv.CONTENT_REQUEST_WHILE_PENDING_WHITEBOARD)?[Qy(Qy({},t),{},{fatal:!0,category:"expected",errorCode:4067})]:[Qy(Qy({},t),{},{fatal:!0,category:"signaling",errorCode:1100})]}};const eb=Xy;var tb="js_sdk_meetings_registration_failed",rb="js_sdk_meetings_registration_success",nb="meetings_registration_step",ib="js_sdk_mercury_connection_failure",ob="js_sdk_mercury_connection_restored",sb="js_sdk_join_success",ab="js_sdk_join_failures",cb="js_sdk_add_media_success",ub="js_sdk_add_media_failures",lb="js_sdk_add_media_retry",db="js_sdk_roap_mercury_received",hb="js_sdk_connection_success",fb="js_sdk_connection_failures",pb="js_sdk_meeting_leave_failure",mb="js_sdk_meeting_end_for_all_failure",gb="js_sdk_meeting_end_for_all_initiated",vb="js_sdk_join_with_media_failures",yb="js_sdk_llm_connection_after_join_failure",bb="js_sdk_disconnect_due_to_inactivity",Eb="js_sdk_meeting_media_inactive",wb="js_sdk_meeting_reconnect_failures",Sb="js_sdk_meeting_max_rejoin_failure",_b="js_sdk_meeting_share_success",Tb="js_sdk_meeting_share_failures",xb="js_sdk_meeting_start_whiteboard_share_failures",Ab="js_sdk_meeting_stop_whiteboard_share_failures",Ib="js_sdk_meeting_share_video_mute_state_change",Cb="js_sdk_mute_audio_failures",Rb="js_sdk_mute_video_failures",kb="js_sdk_stop_floor_request_failures",Ob="js_sdk_add_dial_in_failure",Nb="js_sdk_add_dial_out_failure",Pb="js_sdk_update_media_failures",Lb="js_sdk_unmute_audio_failures",Db="js_sdk_unmute_video_failures",Mb="js_sdk_roap_answer_failures",Ub="js_sdk_roap_glar_condition",Bb="js_sdk_peerConnection_failures",Fb="js_sdk_invalid_ice_candidate",jb="js_sdk_upload_logs_failure",Vb="js_sdk_upload_logs_success",Hb="js_sdk_receive_transcription_failure",Gb="js_sdk_fetch_meeting_info_v1_success",qb="js_sdk_fetch_meeting_info_v1_failure",$b="js_sdk_adhoc_meeting_success",Zb="js_sdk_adhoc_meeting_failure",zb="js_sdk_verify_password_success",Kb="js_sdk_verify_password_error",Wb="js_sdk_verify_captcha_error",Jb="js_sdk_move_to_success",Yb="js_sdk_move_to_failure",Qb="js_sdk_move_from_success",Xb="js_sdk_move_from_failure",eE="js_sdk_turn_discovery_failure",tE="js_sdk_meeting_info_policy_error",rE="js_sdk_locus_delta_sync_failed",nE="js_sdk_locus_delta_ooo",iE="js_sdk_permission_token_refresh",oE="js_sdk_permission_token_refresh_error",sE="js_sdk_turn_discovery_latency",aE="js_sdk_roap_offer_to_answer_latency",cE="js_sdk_roap_http_response_missing",uE="js_sdk_turn_discovery_requires_ok",lE=r(13311),dE=r.n(lE),hE=r(47037),fE=r.n(hE),pE=function(){function e(t){if((0,k.Z)(this,e),(0,R.Z)(this,"namespace","Meetings"),(0,R.Z)(this,"propertyName",void 0),!t||!fE()(t))throw new zv("Collection expects a string to use as a property name.");this.propertyName=t,this[this.propertyName]={}}return(0,O.Z)(e,[{key:"get",value:function(e){return this[this.propertyName]&&this[this.propertyName][e]?this[this.propertyName][e]:null}},{key:"set",value:function(e,t){return this[this.propertyName][e]=t,this.get(e)}},{key:"delete",value:function(e){delete this[this.propertyName][e]}},{key:"getAll",value:function(){return this[this.propertyName]}},{key:"setAll",value:function(e){return this[this.propertyName]=e,this.getAll()}}]),e}();function mE(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var gE=function(e){(0,A.Z)(r,e);var t=mE(r);function r(){var e;return(0,k.Z)(this,r),e=t.call(this,"meetingInfos"),(0,R.Z)((0,x.Z)(e),"namespace",pg),e}return(0,O.Z)(r,[{key:"get",value:function(e){return this.meetingInfos[e]?this.meetingInfos[e]:dE()(this.meetingInfos,(function(t){return t.sipUrl===e||t.locusId===e||t.userId===e||t.meetingLink===e}))}}]),r}(pE),vE=r(8575),yE=r(50706),bE=r.n(yE),EE={extractDestination:function(e,t){var r=e;if(t===Dm){if(!e||!e.url)throw new zv("You cannot create a meeting by locus without a locus.url defined");r=e.url}return r},getParsedUrl:function(e){try{var t=vE.parse(e);return!!t&&(t.protocol||(t=vE.parse("".concat(fg).concat(e))),t)}catch(e){return pp.logger.warn("Meeting-info:util#getParsedUrl --\x3e unable to parse the URL, error: ".concat(e)),null}},isMeetingLink:function(e){var t=EE.getParsedUrl(e),r=t.hostname&&t.hostname.includes(bg),n=t.pathname&&(t.pathname.includes("/".concat(Xp))||t.pathname.includes("/".concat(em))||t.pathname.includes("/".concat(qp)));return r&&n},isConversationUrl:function(e,t){var r=t.internal.services.getClusterId(e);return!!r&&r.endsWith(Eg)},convertLinkToSip:function(e){var t,r,n=EE.getParsedUrl(e);if(!n)return null;if(n.pathname){var i=n.pathname.lastIndexOf("/");t=n.pathname.substring(i+1)}if(!t)return null;if(n.hostname){var o=n.hostname.lastIndexOf(".".concat(bg));r=n.hostname.substring(0,o).replace(yg,"")}return r?"".concat(t,"@").concat(r,".").concat(bg):null},isSipUri:function(e){return Ng.SIP_ADDRESS.exec(e)},isPhoneNumber:function(e){return Ng.PHONE_NUMBER.test(e)},getHydraId:function(e){var t=(0,bp.deconstructHydraId)(e),r=t.type,n=t.id,i=t.cluster;return n&&Bg.test(n)?r===Qm?{room:!0,destination:n,cluster:i}:r===zm?{people:!0,destination:n,cluster:i}:{}:{}},getSipUriFromHydraPersonId:function(e,t){return t.people.get(e).then((function(e){if(e.emails&&e.emails.length)return e.emails[0];throw new zv("Hydra Id Lookup was an invalid hydra person id.")})).catch((function(e){throw pp.logger.error("Meeting-info:util#MeetingInfoUtil.getSipUriFromHydraPersonId --\x3e getSipUriFromHydraPersonId ".concat(e," ")),e}))}};EE.generateOptions=function(){var e=(0,T.Z)(V().mark((function e(t){var r,n,i,o,s,a;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.destination,n=t.type,i=t.webex,!n){e.next=3;break}return e.abrupt("return",{destination:r,type:n});case 3:if(o={},s=EE.getHydraId(r),!EE.isMeetingLink(r)){e.next=11;break}pp.logger.warn("Meeting-info:util#generateOptions --\x3e WARN, use of Meeting Link is deprecated, please use a SIP URI instead"),o.type=Bm,o.destination=r,e.next=47;break;case 11:if(!EE.isSipUri(r)){e.next=16;break}o.type=eg,o.destination=r,e.next=47;break;case 16:if(!EE.isPhoneNumber(r)){e.next=21;break}o.type=eg,o.destination=r,e.next=47;break;case 21:if(!EE.isConversationUrl(r,i)){e.next=26;break}o.type=Tm,o.destination=r,e.next=47;break;case 26:if(!s.people){e.next=31;break}return o.type=eg,e.abrupt("return",EE.getSipUriFromHydraPersonId(s.destination,i).then((function(e){return o.destination=e,o.wasHydraPerson=!0,P().resolve(o)})));case 31:if(!s.room){e.next=46;break}return o.type=Tm,e.prev=33,e.next=36,i.internal.services.waitForCatalog("postauth");case 36:a=i.internal.services.getServiceUrlFromClusterId({cluster:s.cluster},i),o.destination=s.destination?"".concat(a,"/conversations/").concat(s.destination):a,e.next=44;break;case 40:throw e.prev=40,e.t0=e.catch(33),pp.logger.error("Meeting-info:util#generateOptions --\x3e ".concat(e.t0)),e.t0;case 44:e.next=47;break;case 46:throw new zv("MeetingInfo is fetched with the meeting link, SIP URI, phone number, Hydra people ID, or a conversation URL.");case 47:return e.abrupt("return",P().resolve(o));case 48:case"end":return e.stop()}}),e,null,[[33,40]])})));return function(t){return e.apply(this,arguments)}}(),EE.getResourceUrl=function(e,t){var r="/".concat(Kp,"/").concat(Qp),n=tv.GET,i=null;switch(e){case eg:case Zm:case Hm:r="/".concat(Kp,"/").concat(Qp,"/").concat(encodeURIComponent(t),"?").concat(mm,"=").concat(e,"&").concat(vg);break;case Tm:n=tv.PUT;break;case Dm:i="".concat(t,"/").concat(Qp),n=tv.PUT;break;case Bm:r="$/".concat(Kp,"/").concat(Qp,"/").concat(bE()(t),"?").concat(mm,"=").concat(Bm,"&").concat(vg)}return{uri:i,resource:r,method:n}},EE.getRequestParams=function(e,t,r,n){var i={method:e.method,api:n,resource:e.resource};return e.method===tv.GET?i.resource=i.resource.concat("&".concat(hg)):t!==Dm?(i.resource=i.resource.concat("?".concat(hg)),i.body={value:r,lookupType:t}):t===Dm&&(i={method:e.method,uri:e.uri}),i};const wE=EE;var SE=function(){function e(t){(0,k.Z)(this,e),(0,R.Z)(this,"webex",void 0),this.webex=t}return(0,O.Z)(e,[{key:"fetchMeetingInfo",value:function(e){if(!e||!e.type||!e.destination)throw new zv("MeetingInfo should be fetched with a type and destination specified, see list of valid types and their corresponding values in constants");var t=wE.getResourceUrl(e.type,e.destination),r=wE.getRequestParams(t,e.type,e.destination,Fg.LOCUS);return this.webex.request(r)}}]),e}();function _E(e,t){var r=U()(e);if(p()){var n=p()(e);t&&(n=n.filter((function(t){return g()(e,t).enumerable}))),r.push.apply(r,n)}return r}function TE(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_E(Object(r),!0).forEach((function(t){(0,R.Z)(e,t,r[t])})):y()?E()(e,y()(r)):_E(Object(r)).forEach((function(t){S()(e,t,g()(r,t))}))}return e}var xE=function(){function e(t){(0,k.Z)(this,e),(0,R.Z)(this,"meetingInfoCollection",void 0),(0,R.Z)(this,"meetingInfoRequest",void 0),(0,R.Z)(this,"webex",void 0),this.webex=t,this.meetingInfoRequest=new SE(this.webex),this.meetingInfoCollection=new gE}return(0,O.Z)(e,[{key:"getMeetingInfo",value:function(e){return this.meetingInfoCollection.get(e)}},{key:"setMeetingInfo",value:function(e,t){this.meetingInfoCollection.set(e,t)}},{key:"requestFetchInfo",value:function(e){var t=this,r=e.meetingId,n=e.sendCAevents;return r&&n&&(this.webex.internal.newMetrics.submitInternalEvent({name:"internal.client.meetinginfo.request"}),this.webex.internal.newMetrics.submitClientEvent({name:"client.meetinginfo.request",options:{meetingId:r}})),this.meetingInfoRequest.fetchMeetingInfo(e).then((function(e){var i,o,s;r&&n&&(t.webex.internal.newMetrics.submitInternalEvent({name:"internal.client.meetinginfo.response"}),t.webex.internal.newMetrics.submitClientEvent({name:"client.meetinginfo.response",payload:{identifiers:{meetingLookupUrl:null==e?void 0:e.url}},options:{meetingId:r,webexConferenceIdStr:(null==e||null===(i=e.body)||void 0===i?void 0:i.confIdStr)||(null==e||null===(o=e.body)||void 0===o?void 0:o.confID),globalMeetingId:null==e||null===(s=e.body)||void 0===s?void 0:s.meetingId}}));return e&&e.body&&t.setMeetingInfo(e.body.sipMeetingUri||e.body.meetingLink,e.body),e})).catch((function(e){return pp.logger.error("Meeting-info:index#requestFetchInfo --\x3e  ".concat(e," fetch meetingInfo")),r&&n&&(t.webex.internal.newMetrics.submitInternalEvent({name:"internal.client.meetinginfo.response"}),t.webex.internal.newMetrics.submitClientEvent({name:"client.meetinginfo.response",payload:{identifiers:{meetingLookupUrl:null==e?void 0:e.url}},options:{meetingId:r,rawError:e}})),P().reject(e)}))}},{key:"fetchInfoOptions",value:function(e,t){return wE.generateOptions({destination:e,type:t,webex:this.webex})}},{key:"fetchMeetingInfo",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{};return r!==Zm||e||(e=this.webex.internal.device.userId),this.fetchInfoOptions(wE.extractDestination(e,r),r).then((function(r){return t.requestFetchInfo(TE(TE({},r),n)).catch((function(i){return r.type===Bm?t.requestFetchInfo(TE(TE({},t.fetchInfoOptions(wE.convertLinkToSip(e),eg)),n)):P().reject(i)}))}))}}]),e}(),AE=r(91966),IE=r.n(AE);function CE(e,t){var r=U()(e);if(p()){var n=p()(e);t&&(n=n.filter((function(t){return g()(e,t).enumerable}))),r.push.apply(r,n)}return r}function RE(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?CE(Object(r),!0).forEach((function(t){(0,R.Z)(e,t,r[t])})):y()?E()(e,y()(r)):CE(Object(r)).forEach((function(t){S()(e,t,g()(r,t))}))}return e}var kE={},OE="MeetingInfo is fetched with the meeting link, SIP URI, phone number, Hydra people ID, or a conversation URL.";kE.getParsedUrl=function(e){try{var t=vE.parse(e);return!!t&&(t.protocol||(t=vE.parse("".concat(fg).concat(e))),t)}catch(e){return pp.logger.warn("Meeting-info:util#getParsedUrl --\x3e unable to parse the URL, error: ".concat(e)),null}},kE.isMeetingLink=function(e){var t=kE.getParsedUrl(e),r=t.hostname&&t.hostname.includes(bg),n=t.pathname&&(t.pathname.includes("/".concat(Xp))||t.pathname.includes("/".concat(em))||t.pathname.includes("/".concat(nm))||t.pathname.includes("/".concat(rm))||t.pathname.includes("/".concat(qp)));return r&&n},kE.isConversationUrl=function(e,t){var r=t.internal.services.getClusterId(e);return!!r&&r.endsWith(Eg)},kE.isSipUri=function(e){return Ng.SIP_ADDRESS.exec(e)},kE.isPhoneNumber=function(e){return Ng.PHONE_NUMBER.test(e)},kE.getHydraId=function(e){var t=(0,bp.deconstructHydraId)(e),r=t.type,n=t.id,i=t.cluster;return n&&Bg.test(n)?r===Qm?{room:!0,destination:n,cluster:i}:r===zm?{people:!0,destination:n,cluster:i}:{}:{}},kE.getSipUriFromHydraPersonId=function(e,t){return t.people.get(e).then((function(e){if(e.emails&&e.emails.length)return e.emails[0];throw new zv("Hydra Id Lookup was an invalid hydra person id.")})).catch((function(e){throw pp.logger.error("Meeting-info:util#MeetingInfoUtil.getSipUriFromHydraPersonId --\x3e getSipUriFromHydraPersonId ".concat(e," ")),e}))},kE.getDestinationType=function(){var e=(0,T.Z)(V().mark((function e(t){var r,n,i,o,s,a,c,u,l,d;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.type,n=t.webex,i=t.destination,r!==Zm){e.next=15;break}if(i){e.next=7;break}i={userId:n.internal.device.userId,orgId:n.internal.device.orgId},e.next=15;break;case 7:return o=Lg.test(i)?{email:i}:{id:i},e.next=10,n.people.list(o);case 10:s=e.sent,a=s.items[0],c=a.orgId,u=a.id,u=(0,bp.deconstructHydraId)(u).id,c=(0,bp.deconstructHydraId)(c).id,i={userId:u,orgId:c};case 15:if(!r){e.next=17;break}return e.abrupt("return",{destination:i,type:r});case 17:if(l={},d=n&&n.config&&n.config.meetings&&n.config.meetings.disableHydraId?null:kE.getHydraId(i),!kE.isMeetingLink(i)){e.next=25;break}pp.logger.warn("Meeting-info:util#generateOptions --\x3e WARN, use of Meeting Link is deprecated, please use a SIP URI instead"),l.type=Bm,l.destination=i,e.next=52;break;case 25:if(!kE.isSipUri(i)){e.next=30;break}l.type=eg,l.destination=i,e.next=52;break;case 30:if(!kE.isPhoneNumber(i)){e.next=35;break}l.type=eg,l.destination=i,e.next=52;break;case 35:if(!kE.isConversationUrl(i,n)){e.next=40;break}l.type=Tm,l.destination=i,e.next=52;break;case 40:if(!d||!d.people){e.next=45;break}return l.type=eg,e.abrupt("return",kE.getSipUriFromHydraPersonId(d&&d.destination,n).then((function(e){return l.destination=e,l.wasHydraPerson=!0,P().resolve(l)})));case 45:if(!d.room){e.next=50;break}throw pp.logger.error("Meeting-info:util#getDestinationType --\x3e Using the space ID as a destination is no longer supported. Please refer to the [migration guide](https://github.com/webex/webex-js-sdk/wiki/Migration-to-Unified-Space-Meetings) to migrate to use the meeting ID or SIP address."),new My;case 50:throw pp.logger.warn("Meeting-info:util#getDestinationType --\x3e ".concat(OE)),new zv("".concat(OE));case 52:return e.abrupt("return",P().resolve(l));case 53:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),kE.getRequestBody=function(e){var t,r,n=e.type,i=e.destination,o=e.password,s=e.captchaInfo,a=e.installedOrgID,c=e.locusId,u=e.extraParams,l=RE(RE({},Vv),u);switch(n){case eg:l.sipUrl=i;break;case Zm:l.userId=i.userId,l.orgId=i.orgId;break;case Hm:l.meetingKey=i;break;case Tm:l.conversationUrl=i;break;case Dm:null!==(t=i.info)&&void 0!==t&&t.webExMeetingId?l.meetingKey=i.info.webExMeetingId:null!==(r=i.info)&&void 0!==r&&r.sipUri&&(l.sipUrl=i.info.sipUri);break;case Bm:l.meetingUrl=i;break;case Fm:l.meetingUUID=i}return o&&(l.password=o),s&&(l.captchaID=s.id,l.captchaVerifyCode=s.code),a&&(l.installedOrgID=a),c&&(l.locusId=c),l},kE.getWebexSite=function(e){var t,r=null==e||null===(t=e.match(/.+@([^.]+\.[^.]+\.[^.]+)$/))||void 0===t?void 0:t[1];return["meet.webex.com","meetup.webex.com","ciscospark.com"].includes(r)?null:r},kE.getDirectMeetingInfoURI=function(e){var t,r=e.type,n=e.destination,i=null;switch(r){case eg:i=kE.getWebexSite(n);break;case Dm:i=null===(t=n.info)||void 0===t?void 0:t.webExSite}return i?"https://".concat(i,"/wbxappapi/v1/meetingInfo"):null};const NE=kE;function PE(e,t){var r=U()(e);if(p()){var n=p()(e);t&&(n=n.filter((function(t){return g()(e,t).enumerable}))),r.push.apply(r,n)}return r}function LE(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?PE(Object(r),!0).forEach((function(t){(0,R.Z)(e,t,r[t])})):y()?E()(e,y()(r)):PE(Object(r)).forEach((function(t){S()(e,t,g()(r,t))}))}return e}function DE(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var ME=[423005,423006],UE=[403049,403104,403103,403048,403102,403101],BE=function(e){(0,A.Z)(r,e);var t=DE(r);function r(e,n){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Password required. Call fetchMeetingInfo() with password argument";return(0,k.Z)(this,r),i=t.call(this,"".concat(o,", code=").concat(e)),(0,R.Z)((0,x.Z)(i),"meetingInfo",void 0),(0,R.Z)((0,x.Z)(i),"sdkMessage",void 0),(0,R.Z)((0,x.Z)(i),"wbxAppApiCode",void 0),(0,R.Z)((0,x.Z)(i),"body",void 0),i.name="MeetingInfoV2PasswordError",i.sdkMessage=o,i.stack=(new Error).stack,i.wbxAppApiCode=e,i.meetingInfo=n,i}return(0,O.Z)(r)}((0,yp.Z)(Error)),FE=function(e){(0,A.Z)(r,e);var t=DE(r);function r(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Failed starting the adhoc meeting, Please contact support team ";return(0,k.Z)(this,r),n=t.call(this,"".concat(i,", code=").concat(e)),(0,R.Z)((0,x.Z)(n),"sdkMessage",void 0),(0,R.Z)((0,x.Z)(n),"wbxAppApiCode",void 0),n.name="MeetingInfoV2AdhocMeetingError",n.sdkMessage=i,n.stack=(new Error).stack,n.wbxAppApiCode=e,n}return(0,O.Z)(r)}((0,yp.Z)(Error)),jE=function(e){(0,A.Z)(r,e);var t=DE(r);function r(e,n,i){var o;return(0,k.Z)(this,r),o=t.call(this,"".concat(i,", code=").concat(e)),(0,R.Z)((0,x.Z)(o),"meetingInfo",void 0),(0,R.Z)((0,x.Z)(o),"sdkMessage",void 0),(0,R.Z)((0,x.Z)(o),"wbxAppApiCode",void 0),o.name="MeetingInfoV2AdhocMeetingError",o.sdkMessage=i,o.stack=(new Error).stack,o.wbxAppApiCode=e,o.meetingInfo=n,o}return(0,O.Z)(r)}((0,yp.Z)(Error)),VE=function(e){(0,A.Z)(r,e);var t=DE(r);function r(e,n){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Captcha required. Call fetchMeetingInfo() with captchaInfo argument";return(0,k.Z)(this,r),i=t.call(this,"".concat(o,", code=").concat(e)),(0,R.Z)((0,x.Z)(i),"captchaInfo",void 0),(0,R.Z)((0,x.Z)(i),"isPasswordRequired",void 0),(0,R.Z)((0,x.Z)(i),"sdkMessage",void 0),(0,R.Z)((0,x.Z)(i),"wbxAppApiCode",void 0),(0,R.Z)((0,x.Z)(i),"body",void 0),i.name="MeetingInfoV2PasswordError",i.sdkMessage=o,i.stack=(new Error).stack,i.wbxAppApiCode=e,i.isPasswordRequired=ME.includes(e),i.captchaInfo=n,i}return(0,O.Z)(r)}((0,yp.Z)(Error)),HE=function(){function e(t){(0,k.Z)(this,e),(0,R.Z)(this,"webex",void 0),(0,R.Z)(this,"handlePolicyError",(function(e){var t,r,n,i,o,s;if(e.body&&UE.includes(null===(t=e.body)||void 0===t?void 0:t.code))throw sp.sendBehavioralMetric(tE,{code:null===(r=e.body)||void 0===r?void 0:r.code}),new jE(null===(n=e.body)||void 0===n?void 0:n.code,null===(i=e.body)||void 0===i||null===(o=i.data)||void 0===o?void 0:o.meetingInfo,null===(s=e.body)||void 0===s?void 0:s.message)})),this.webex=t}var t,r;return(0,O.Z)(e,[{key:"fetchInfoOptions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return NE.getDestinationType({destination:e,type:t,webex:this.webex})}},{key:"createAdhocSpaceMeeting",value:(r=(0,T.Z)(V().mark((function e(t,r){var n,i=this;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.webex.meetings.preferredWebexSite){e.next=2;break}throw Error("No preferred webex site found");case 2:return n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[];return e&&e.forEach((function(e){t.push({email:e.emailAddress,ciUserUuid:e.entryUUID})})),t},e.abrupt("return",this.webex.request({uri:t,qs:{includeParticipants:!0},disableTransform:!0}).then((function(e){var t,o=e.body,s={title:o.displayName,spaceUrl:o.url,keyUrl:o.encryptionKeyUrl,kroUrl:o.kmsResourceObjectUrl,invitees:n(null===(t=o.participants)||void 0===t?void 0:t.items),installedOrgID:r};r&&(s.installedOrgID=r);var a=i.webex.meetings.preferredWebexSite?"https://".concat(i.webex.meetings.preferredWebexSite,"/wbxappapi/v2/meetings/spaceInstant"):"";return i.webex.request({method:tv.POST,uri:a,body:s})})).then((function(e){return sp.sendBehavioralMetric($b),e})).catch((function(e){var t,r;throw i.handlePolicyError(e),sp.sendBehavioralMetric(Zb,{reason:e.message,stack:e.stack}),new FE(null===(t=e.body)||void 0===t?void 0:t.code,null===(r=e.body)||void 0===r?void 0:r.message)})));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"fetchMeetingInfo",value:(t=(0,T.Z)(V().mark((function e(t){var r,n,i,o,s,a,c,u,l,d,h,f,p,m,g,v,y=this,b=arguments;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=b.length>1&&void 0!==b[1]?b[1]:null,n=b.length>2&&void 0!==b[2]?b[2]:null,i=b.length>3&&void 0!==b[3]?b[3]:null,o=b.length>4&&void 0!==b[4]?b[4]:null,s=b.length>5&&void 0!==b[5]?b[5]:null,a=b.length>6&&void 0!==b[6]?b[6]:{},u=(c=b.length>7&&void 0!==b[7]?b[7]:{}).meetingId,l=c.sendCAevents,e.next=10,NE.getDestinationType({destination:t,type:r,webex:this.webex});case 10:if((d=e.sent).type!==Tm||!this.webex.config.meetings.experimental.enableAdhocMeetings||!this.webex.meetings.preferredWebexSite){e.next=13;break}return e.abrupt("return",this.createAdhocSpaceMeeting(d.destination,o));case 13:return e.next=15,NE.getRequestBody(LE(LE({},d),{},{password:n,captchaInfo:i,installedOrgID:o,locusId:s,extraParams:a}));case 15:if(h=e.sent,IE()(U()(h),U()(Vv)).length){e.next=20;break}throw m=new Error("Not enough information to fetch meeting info"),sp.sendBehavioralMetric(qb,{reason:m.message,destinationType:null==d?void 0:d.type,webExMeetingId:null==d||null===(f=d.info)||void 0===f?void 0:f.webExMeetingId,sipUri:null==d||null===(p=d.info)||void 0===p?void 0:p.sipUri}),m;case 20:return g={method:tv.POST,body:h},e.next=23,NE.getDirectMeetingInfoURI(d);case 23:return(v=e.sent)?g.uri=v:(g.service=wg,g.resource="meetingInfo"),u&&l&&(this.webex.internal.newMetrics.submitInternalEvent({name:"internal.client.meetinginfo.request"}),this.webex.internal.newMetrics.submitClientEvent({name:"client.meetinginfo.request",options:{meetingId:u}})),e.abrupt("return",this.webex.request(g).then((function(e){var t,r,n;return u&&l&&(y.webex.internal.newMetrics.submitInternalEvent({name:"internal.client.meetinginfo.response"}),y.webex.internal.newMetrics.submitClientEvent({name:"client.meetinginfo.response",payload:{identifiers:{meetingLookupUrl:null==e?void 0:e.url}},options:{meetingId:u,webexConferenceIdStr:(null==e||null===(t=e.body)||void 0===t?void 0:t.confIdStr)||(null==e||null===(r=e.body)||void 0===r?void 0:r.confID),globalMeetingId:null==e||null===(n=e.body)||void 0===n?void 0:n.meetingId}})),sp.sendBehavioralMetric(Gb),e})).catch((function(e){var t,r,n,i;if(u&&l&&(y.webex.internal.newMetrics.submitInternalEvent({name:"internal.client.meetinginfo.response"}),y.webex.internal.newMetrics.submitClientEvent({name:"client.meetinginfo.response",payload:{identifiers:{meetingLookupUrl:null==e?void 0:e.url}},options:{meetingId:u,rawError:e}})),403===(null==e?void 0:e.statusCode))throw y.handlePolicyError(e),sp.sendBehavioralMetric(Kb,{reason:e.message,stack:e.stack}),new BE(null===(t=e.body)||void 0===t?void 0:t.code,null===(r=e.body)||void 0===r||null===(n=r.data)||void 0===n?void 0:n.meetingInfo);if(423===(null==e?void 0:e.statusCode))throw sp.sendBehavioralMetric(Wb,{reason:e.message,stack:e.stack}),new VE(null===(i=e.body)||void 0===i?void 0:i.code,{captchaId:e.body.captchaID,verificationImageURL:e.body.verificationImageURL,verificationAudioURL:e.body.verificationAudioURL,refreshURL:e.body.refreshURL});throw sp.sendBehavioralMetric(qb,{reason:e.message,stack:e.stack}),e})));case 27:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}(),GE=r(13682),qE=r(41609),$E=r.n(qE),ZE=r(18446),zE=r.n(ZE);function KE(e){this.message=e}KE.prototype=new Error,KE.prototype.name="InvalidCharacterError";var WE="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new KE("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,n,i=0,o=0,s="";n=t.charAt(o++);~n&&(r=i%4?64*r+n:n,i++%4)?s+=String.fromCharCode(255&r>>(-2*i&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return s};function JE(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(WE(e).replace(/(.)/g,(function(e,t){var r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r})))}(t)}catch(e){return WE(t)}}function YE(e){this.message=e}YE.prototype=new Error,YE.prototype.name="InvalidTokenError";const QE=function(e,t){if("string"!=typeof e)throw new YE("Invalid token specified");var r=!0===(t=t||{}).header?0:1;try{return JSON.parse(JE(e.split(".")[r]))}catch(e){throw new YE("Invalid token specified: "+e.message)}};var XE=r(7712),ew=r(18281),tw=r.n(ew);function rw(e,t){var r=void 0!==Ey()&&e[Sy()]||e["@@iterator"];if(!r){if(Ty()(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return nw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return yy()(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nw(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}function nw(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var iw=function(e){var t,r,n=e.csisKey,i=e.meetingMembers,o=e.transcriptData,s={speakerId:"",name:""},a=!1;n&&o.speakerProxy[n]&&(s=o.speakerProxy[n]);var c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return F()(e).find((function(e){var r,n=null!==(r=e.participant.status.csis)&&void 0!==r?r:[];return t.some((function(e){return n.includes(e)}))}))}(i,[n]),u={speakerId:null!==(t=null==c?void 0:c.participant.person.id)&&void 0!==t?t:"",name:null!==(r=null==c?void 0:c.participant.person.name)&&void 0!==r?r:""};return!c||u.speakerId===s.speakerId&&u.name===s.name||(a=!0,s=u),{speaker:s,needsCaching:a}},ow=r(17187);function sw(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var aw=function(e){(0,A.Z)(r,e);var t=sw(r);function r(){return(0,k.Z)(this,r),t.apply(this,arguments)}return(0,O.Z)(r,[{key:"emit",value:function(e,t,n){return pp.logger.debug("".concat(Jv.getScopeLog(e),"event#").concat(t).concat(cp.verboseEvents?" -- ".concat(Jv.getEventLog(n)):"")),Eh((0,C.Z)(r.prototype),"emit",this).call(this,t,n)}}]),r}(r.n(ow)()),cw={audioReceive:[],audioTransmit:[],intervalMetadata:{peerReflexiveIP:"0.0.0.0",peripherals:[],processAverageCPU:0,processMaximumCPU:0,systemAverageCPU:0,systemMaximumCPU:0},networkType:"",intervalNumber:0,videoReceive:[],videoTransmit:[]},uw={common:{common:{direction:"inactive",isMain:!0,mariFecEnabled:!1,mariQosEnabled:!1,multistreamEnabled:!1},dtlsBitrate:0,dtlsPackets:0,fecBitrate:0,fecPackets:0,maxBitrate:0,mediaHopByHopLost:0,rtcpBitrate:0,rtcpPackets:0,rtpBitrate:0,rtpHopByHopLost:0,rtpPackets:0,rtpRecovered:0,rtxBitrate:0,rtxPackets:0,srtcpUnprotectErrors:0,srtpUnprotectErrors:0,stunBitrate:0,stunPackets:0,transportType:"UDP"},streams:[]},lw={common:{codec:"opus",concealedFrames:0,csi:[],maxConcealRunLength:0,optimalBitrate:0,optimalFrameRate:0,receivedBitrate:0,receivedFrameRate:0,renderedFrameRate:0,requestedBitrate:0,requestedFrameRate:0,rtpEndToEndLost:0,maxRtpJitter:0,meanRtpJitter:0,rtpPackets:0,ssci:0}},dw={common:{availableBitrate:0,common:{direction:"inactive",isMain:!0,mariFecEnabled:!1,mariQosEnabled:!1,multistreamEnabled:!1},dtlsBitrate:0,dtlsPackets:0,fecBitrate:0,fecPackets:0,maxBitrate:0,queueDelay:0,remoteJitter:0,remoteLossRate:0,remoteReceiveRate:0,roundTripTime:0,rtcpBitrate:0,rtcpPackets:0,rtpBitrate:0,rtpPackets:0,rtxBitrate:0,rtxPackets:0,stunBitrate:0,stunPackets:0,transportType:"UDP"},streams:[]},hw={common:{codec:"opus",csi:[],requestedBitrate:0,requestedFrames:0,rtpPackets:0,ssci:0,transmittedBitrate:0,transmittedFrameRate:0}},fw={common:{common:{direction:"inactive",isMain:!0,mariFecEnabled:!0,mariQosEnabled:!0,multistreamEnabled:!0},dtlsBitrate:0,dtlsPackets:0,fecBitrate:0,fecPackets:0,maxBitrate:0,mediaHopByHopLost:0,rtcpBitrate:0,rtcpPackets:0,rtpBitrate:0,rtpHopByHopLost:0,rtpPackets:0,rtpRecovered:0,rtxBitrate:0,rtxPackets:0,srtcpUnprotectErrors:0,srtpUnprotectErrors:0,stunBitrate:0,stunPackets:0,transportType:"UDP"},streams:[]},pw={common:{codec:"H264",concealedFrames:0,csi:[],maxConcealRunLength:0,optimalBitrate:0,optimalFrameRate:0,receivedBitrate:0,receivedFrameRate:0,renderedFrameRate:0,requestedBitrate:0,requestedFrameRate:0,rtpEndToEndLost:0,rtpJitter:0,rtpPackets:0,ssci:0},h264CodecProfile:"BP",isActiveSpeaker:!0,optimalFrameSize:0,receivedFrameSize:0,receivedHeight:0,receivedKeyFrames:0,receivedKeyFramesForRequest:0,receivedKeyFramesSourceChange:0,receivedKeyFramesUnknown:0,receivedWidth:0,requestedFrameSize:0,requestedKeyFrames:0},mw={common:{availableBitrate:0,common:{direction:"inactive",isMain:!0,mariFecEnabled:!1,mariQosEnabled:!1,multistreamEnabled:!1},dtlsBitrate:0,dtlsPackets:0,fecBitrate:0,fecPackets:0,maxBitrate:0,queueDelay:0,remoteJitter:0,remoteLossRate:0,remoteReceiveRate:0,roundTripTime:0,rtcpBitrate:0,rtcpPackets:0,rtpBitrate:0,rtpPackets:0,rtxBitrate:0,rtxPackets:0,stunBitrate:0,stunPackets:0,transportType:"UDP"},streams:[]},gw={common:{codec:"H264",csi:[],duplicateSsci:0,requestedBitrate:0,requestedFrames:0,rtpPackets:0,ssci:0,transmittedBitrate:0,transmittedFrameRate:0},h264CodecProfile:"BP",isAvatar:!1,isHardwareEncoded:!1,localConfigurationChanges:2,maxFrameQp:0,maxNoiseLevel:0,minRegionQp:0,remoteConfigurationChanges:0,requestedFrameSize:0,requestedKeyFrames:0,transmittedFrameSize:0,transmittedHeight:0,transmittedKeyFrames:0,transmittedKeyFramesClient:0,transmittedKeyFramesConfigurationChange:0,transmittedKeyFramesFeedback:0,transmittedKeyFramesLocalDrop:0,transmittedKeyFramesOtherLayer:0,transmittedKeyFramesPeriodic:0,transmittedKeyFramesSceneChange:0,transmittedKeyFramesStartup:0,transmittedKeyFramesUnknown:0,transmittedWidth:0};const vw={encryption:"sha-256",bandwidth:{systemBandwidth:0,sentPerSecond:0,encodedPerSecond:0,helper:{audioBytesSent:0,videoBytestSent:0},speed:0},results:{},connectionType:{systemNetworkType:"unknown",systemIpAddress:"0.0.0.0",local:{candidateType:[],transport:[],ipAddress:[],networkType:[]},remote:{candidateType:[],transport:[],ipAddress:[],networkType:[]}},resolutions:{},internal:{remote:{},candidates:{}}};var yw=r(6162),bw=r.n(yw),Ew=r(78659),ww=r.n(Ew),Sw=function(e,t,r,n){return U()(e).filter((function(e){return e.includes(r)})).reduce((function(r,i){var o,s;return r+((null===(o=e[i])||void 0===o||null===(s=o[t])||void 0===s?void 0:s[n])||0)}),0)},_w=function(e){var t,r=e.audioReceiver,n=e.statsResults,i=e.lastMqaDataSent,o=e.baseMediaType,s=kv.RECEIVE_DIRECTION,a=function(e){return Sw(i,s,o,e)},c=function(e){return Sw(n,s,o,e)},u=a("totalPacketsReceived"),l=a("totalPacketsLost"),d=a("totalBytesReceived"),h=a("fecPacketsReceived"),f=a("fecPacketsDiscarded"),p=c("totalPacketsReceived"),m=c("totalPacketsLost"),g=c("totalBytesReceived"),v=c("fecPacketsReceived"),y=c("fecPacketsDiscarded");r.common.common.direction=(null===(t=n[U()(n).find((function(e){return e.includes(o)}))])||void 0===t?void 0:t.direction)||"inactive",r.common.common.isMain=!o.includes("-share"),r.common.transportType=n.connectionType.local.transport,r.common.rtpPackets=p-u;var b=m-l;r.common.mediaHopByHopLost=b,r.common.rtpHopByHopLost=b;var E=v-h-(y-f);r.common.fecPackets=E,r.common.rtpBitrate=8*(g-d)/60||0},Tw=function(e){var t,r,n,i,o,s,a,c,u=e.audioReceiverStream,l=e.statsResults,d=e.lastMqaDataSent,h=e.mediaType,f=kv.RECEIVE_DIRECTION,p=(null===(t=d[h])||void 0===t?void 0:t[f].totalSamplesDecoded)||0,m=(null===(r=d[h])||void 0===r?void 0:r[f].totalSamplesReceived)||0,g=(null===(n=d[h])||void 0===n?void 0:n[f].concealedSamples)||0,v=(null===(i=d[h])||void 0===i?void 0:i[f].totalBytesReceived)||0,y=(null===(o=d[h])||void 0===o?void 0:o[f].fecPacketsReceived)||0,b=(null===(s=d[h])||void 0===s?void 0:s[f].fecPacketsDiscarded)||0,E=(null===(a=d[h])||void 0===a?void 0:a[f].totalPacketsReceived)||0,w=(null===(c=d[h])||void 0===c?void 0:c[f].totalPacketsLost)||0,S=l[h].csi;S&&!u.common.csi.includes(S)&&u.common.csi.push(S),u.common.rtpPackets=l[h][f].totalPacketsReceived-E||0,u.common.maxRtpJitter=1e3*bw()(l[h][f].meanRtpJitter)||0,u.common.meanRtpJitter=1e3*ww()(l[h][f].meanRtpJitter)||0,u.common.rtpJitter=u.common.maxRtpJitter;var _=l[h][f].fecPacketsReceived-y-(l[h][f].fecPacketsDiscarded-b);u.common.rtpEndToEndLost=l[h][f].totalPacketsLost-w-_||0,u.common.framesDropped=l[h][f].totalSamplesDecoded-p||0,u.common.renderedFrameRate=100*u.common.framesDropped/60||0,u.common.framesReceived=l[h][f].totalSamplesReceived-m||0,u.common.concealedFrames=l[h][f].concealedSamples-g||0,u.common.receivedBitrate=8*(l[h][f].totalBytesReceived-v)/60||0},xw=function(e){var t,r=e.audioSender,n=e.statsResults,i=e.lastMqaDataSent,o=e.baseMediaType,s=kv.SEND_DIRECTION,a=function(e){return Sw(i,s,o,e)},c=function(e){return Sw(n,s,o,e)},u=a("totalPacketsSent"),l=a("totalPacketsLostOnReceiver"),d=c("totalPacketsLostOnReceiver"),h=c("totalPacketsSent"),f=U()(n).filter((function(e){return e.includes(o)})).reduce((function(e,t){return e.concat(n[t][s].meanRemoteJitter)}),[]),p=U()(n).filter((function(e){return e.includes(o)})).reduce((function(e,t){return e.concat(n[t][s].meanRoundTripTime)}),[]);r.common.common.direction=(null===(t=n[U()(n).find((function(e){return e.includes(o)}))])||void 0===t?void 0:t.direction)||"inactive",r.common.common.isMain=!o.includes("-share"),r.common.transportType=n.connectionType.local.transport,r.common.maxRemoteJitter=1e3*bw()(f)||0,r.common.meanRemoteJitter=1e3*ww()(f)||0,r.common.rtpPackets=h-u||0,r.common.availableBitrate=Sw(n,s,o,"availableOutgoingBitrate");var m=d-l;r.common.remoteLossRate=h-u>0?100*m/(h-u):0,r.common.maxRoundTripTime=1e3*bw()(p)||0,r.common.meanRoundTripTime=1e3*ww()(p)||0,r.common.roundTripTime=r.common.maxRoundTripTime;var g=Sw(n,s,o,"totalBytesSent")-Sw(i,s,o,"totalBytesSent");r.common.rtpBitrate=g?8*g/60:0},Aw=function(e){var t,r,n,i,o=e.audioSenderStream,s=e.statsResults,a=e.lastMqaDataSent,c=e.mediaType,u=kv.SEND_DIRECTION,l=(null===(t=a[c])||void 0===t?void 0:t[u].totalBytesSent)||0,d=(null===(r=a[c])||void 0===r?void 0:r[u].totalKeyFramesEncoded)||0,h=(null===(n=a[c])||void 0===n?void 0:n[u].totalFirCount)||0,f=(null===(i=a[c])||void 0===i?void 0:i[u].totalPacketsSent)||0,p=s[c].csi;p&&!o.common.csi.includes(p)&&o.common.csi.push(p),o.common.rtpPackets=s[c][u].totalPacketsSent-f||0;var m=s[c][u].totalBytesSent-l;o.common.transmittedBitrate=m?8*m/60:0,o.transmittedKeyFrames=s[c][u].totalKeyFramesEncoded-d||0,o.requestedKeyFrames=s[c][u].totalFirCount-h||0},Iw=function(e){var t,r=e.videoReceiver,n=e.statsResults,i=e.lastMqaDataSent,o=e.baseMediaType,s=kv.RECEIVE_DIRECTION,a=function(e){return Sw(i,s,o,e)},c=function(e){return Sw(n,s,o,e)},u=a("totalPacketsReceived"),l=a("totalPacketsLost"),d=a("totalBytesReceived"),h=c("totalPacketsLost"),f=c("totalPacketsReceived"),p=c("totalBytesReceived"),m=U()(n).filter((function(e){return e.includes(o)})).reduce((function(e,t){return e.concat(n[t][s].meanRemoteJitter)}),[]);r.common.common.direction=(null===(t=n[U()(n).find((function(e){return e.includes(o)}))])||void 0===t?void 0:t.direction)||"inactive",r.common.common.isMain=!o.includes("-share"),r.common.transportType=n.connectionType.local.transport,r.common.rtpPackets=f-u||0;var g=h-l;r.common.mediaHopByHopLost=g,r.common.rtpHopByHopLost=g,r.common.maxRemoteJitter=1e3*bw()(m)||0,r.common.meanRemoteJitter=1e3*ww()(m)||0;var v=p-d;r.common.rtpBitrate=v?8*v/60:0},Cw=function(e){var t,r,n,i,o,s,a,c,u=e.videoReceiverStream,l=e.statsResults,d=e.lastMqaDataSent,h=e.mediaType,f=kv.RECEIVE_DIRECTION,p=(null===(t=d[h])||void 0===t?void 0:t[f].totalPacketsReceived)||0,m=(null===(r=d[h])||void 0===r?void 0:r[f].totalPacketsLost)||0,g=(null===(n=d[h])||void 0===n?void 0:n[f].totalBytesReceived)||0,v=(null===(i=d[h])||void 0===i?void 0:i[f].framesReceived)||0,y=(null===(o=d[h])||void 0===o?void 0:o[f].framesDecoded)||0,b=(null===(s=d[h])||void 0===s?void 0:s[f].framesDropped)||0,E=(null===(a=d[h])||void 0===a?void 0:a[f].keyFramesDecoded)||0,w=(null===(c=d[h])||void 0===c?void 0:c[f].totalPliCount)||0,S=l[h].csi;S&&!u.common.csi.includes(S)&&u.common.csi.push(S),u.common.rtpPackets=l[h][f].totalPacketsReceived-p||0;var _=l[h][f].totalPacketsLost-m||0;u.common.rtpEndToEndLost=_,u.common.rtpJitter=1e3*bw()(l[h][f].meanRemoteJitter)||0;var T=l[h][f].totalBytesReceived-g;u.common.receivedBitrate=T?8*T/60:0;var x=l[h][f].framesReceived-v,A=l[h][f].framesDecoded-y;u.common.receivedFrameRate=Math.round(x?x/60:0),u.common.renderedFrameRate=Math.round(A?A/60:0),u.common.framesDropped=l[h][f].framesDropped-b||0,u.receivedHeight=l[h][f].height||0,u.receivedWidth=l[h][f].width||0,u.receivedFrameSize=u.receivedHeight*u.receivedWidth/256,u.receivedKeyFrames=l[h][f].keyFramesDecoded-E||0,u.requestedKeyFrames=l[h][f].totalPliCount-w||0},Rw=function(e){var t,r=e.videoSender,n=e.statsResults,i=e.lastMqaDataSent,o=e.baseMediaType,s=kv.SEND_DIRECTION,a=function(e){return Sw(i,s,o,e)},c=function(e){return Sw(n,s,o,e)},u=a("totalPacketsSent"),l=a("totalBytesSent"),d=a("totalPacketsLostOnReceiver"),h=c("totalPacketsLostOnReceiver"),f=c("totalPacketsSent"),p=c("totalBytesSent"),m=c("availableOutgoingBitrate");r.common.common.direction=(null===(t=n[U()(n).find((function(e){return e.includes(o)}))])||void 0===t?void 0:t.direction)||"inactive",r.common.common.isMain=!o.includes("-share"),r.common.transportType=n.connectionType.local.transport;var g=U()(n).filter((function(e){return e.includes(o)})).reduce((function(e,t){return e.concat(n[t][s].meanRemoteJitter)}),[]),v=U()(n).filter((function(e){return e.includes(o)})).reduce((function(e,t){return e.concat(n[t][s].meanRoundTripTime)}),[]);r.common.maxRemoteJitter=1e3*bw()(g)||0,r.common.meanRemoteJitter=1e3*ww()(g)||0,r.common.rtpPackets=f-u,r.common.availableBitrate=m;var y=h-d;r.common.remoteLossRate=f-u>0?100*y/(f-u):0,r.common.maxRoundTripTime=1e3*bw()(v)||0,r.common.meanRoundTripTime=1e3*ww()(v)||0,r.common.roundTripTime=r.common.maxRoundTripTime;var b=p-l;r.common.rtpBitrate=b?8*b/60:0},kw=function(e){var t,r,n,i,o,s=e.videoSenderStream,a=e.statsResults,c=e.lastMqaDataSent,u=e.mediaType,l=kv.SEND_DIRECTION,d=(null===(t=c[u])||void 0===t?void 0:t[l].totalPacketsSent)||0,h=(null===(r=c[u])||void 0===r?void 0:r[l].totalBytesSent)||0,f=(null===(n=c[u])||void 0===n?void 0:n[l].totalKeyFramesEncoded)||0,p=(null===(i=c[u])||void 0===i?void 0:i[l].totalFirCount)||0,m=(null===(o=c[u])||void 0===o?void 0:o[l].framesSent)||0,g=a[u].csi;g&&!s.common.csi.includes(g)&&s.common.csi.push(g),s.common.rtpPackets=a[u][l].totalPacketsSent-d||0;var v=a[u][l].totalBytesSent-h;s.common.transmittedBitrate=v?8*v/60:0,s.transmittedKeyFrames=a[u][l].totalKeyFramesEncoded-f||0,s.requestedKeyFrames=a[u][l].totalFirCount-p||0;var y=a[u][l].framesSent-(m||0);s.common.transmittedFrameRate=Math.round(y?y/60:0),s.transmittedHeight=a[u][l].height||0,s.transmittedWidth=a[u][l].width||0,s.transmittedFrameSize=s.transmittedHeight*s.transmittedWidth/256};function Ow(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var Nw="MEDIA_QUALITY",Pw="LOCAL_MEDIA_STARTED",Lw="LOCAL_MEDIA_STOPPED",Dw="REMOTE_MEDIA_STARTED",Mw="REMOTE_MEDIA_STOPPED",Uw={trackLabel:"",maxPacketLossRatio:0,availableBandwidth:0,bytesSent:0,meanRemoteJitter:[],meanRoundTripTime:[]},Bw={availableBandwidth:0,bytesReceived:0,meanRtpJitter:[],meanRoundTripTime:[]},Fw=function(e){(0,A.Z)(r,e);var t=Ow(r);function r(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:vw;return(0,k.Z)(this,r),n=t.call(this),(0,R.Z)((0,x.Z)(n),"config",void 0),(0,R.Z)((0,x.Z)(n),"correlationId",void 0),(0,R.Z)((0,x.Z)(n),"lastEmittedStartStopEvent",void 0),(0,R.Z)((0,x.Z)(n),"lastMqaDataSent",void 0),(0,R.Z)((0,x.Z)(n),"lastStatsResults",void 0),(0,R.Z)((0,x.Z)(n),"meetingMediaStatus",void 0),(0,R.Z)((0,x.Z)(n),"mqaInterval",void 0),(0,R.Z)((0,x.Z)(n),"mqaSentCount",void 0),(0,R.Z)((0,x.Z)(n),"networkQualityMonitor",void 0),(0,R.Z)((0,x.Z)(n),"mediaConnection",void 0),(0,R.Z)((0,x.Z)(n),"statsInterval",void 0),(0,R.Z)((0,x.Z)(n),"statsResults",void 0),(0,R.Z)((0,x.Z)(n),"statsStarted",void 0),(0,R.Z)((0,x.Z)(n),"successfulCandidatePair",void 0),(0,R.Z)((0,x.Z)(n),"localIpAddress",void 0),(0,R.Z)((0,x.Z)(n),"receiveSlotCallback",void 0),(0,R.Z)((0,x.Z)(n),"emitStartStopEvents",(function(e,t,r,i){if("audio"!==e&&"video"!==e&&"share"!==e)throw new Error("Unsupported mediaType: ".concat(e));void 0===t&&(t=0),void 0===r&&(r=0),n.lastEmittedStartStopEvent[e]||(n.lastEmittedStartStopEvent[e]={});var o,s=i?n.lastEmittedStartStopEvent[e].local:n.lastEmittedStartStopEvent[e].remote;r-t>0?o=i?Pw:Dw:r===t&&r>0&&(o=i?Lw:Mw),o&&s!==o&&(i?n.lastEmittedStartStopEvent[e].local=o:n.lastEmittedStartStopEvent[e].remote=o,n.emit({file:"statsAnalyzer/index",function:"compareLastStatsResult"},o,{type:e}))})),(0,R.Z)((0,x.Z)(n),"extractAndSetLocalIpAddressInfoForDiagnostics",(function(e,t){var r="";if(e&&!$E()(t)){var i=t[e];i&&("host"===i.candidateType?r="".concat(i.address):"prflx"===i.candidateType&&(r=i.relayProtocol?"".concat(i.address):"".concat(i.relatedAddress)))}n.localIpAddress=r})),(0,R.Z)((0,x.Z)(n),"parseCandidate",(function(e,t,r,i){var o;if(e&&e.id&&(null===(o=n.successfulCandidatePair)||void 0===o?void 0:o.localCandidateId)===e.id){var s;e.relayProtocol?s=e.relayProtocol.toUpperCase():e.protocol&&(s=e.protocol.toUpperCase());var a=r?kv.SEND_DIRECTION:kv.RECEIVE_DIRECTION,c=i?kv.REMOTE:kv.LOCAL;n.statsResults.candidates||(n.statsResults.candidates={}),n.statsResults.candidates[e.id]={candidateType:e.candidateType,ipAddress:e.ip,relatedAddress:e.relatedAddress,relatedPort:e.relatedPort,relayProtocol:e.relayProtocol,protocol:e.protocol,address:e.address,portNumber:e.port,networkType:e.networkType,priority:e.priority,transport:s,timestamp:e.time,id:e.id,type:e.type},n.statsResults.connectionType[c].candidateType=e.candidateType,n.statsResults.connectionType[c].ipAddress=e.ipAddress,n.statsResults.connectionType[c].networkType=e.networkType===Rv.VPN?Rv.UNKNOWN:e.networkType,n.statsResults.connectionType[c].transport=s,n.statsResults[t][a].totalRoundTripTime=e.totalRoundTripTime}})),n.statsStarted=!1,n.statsResults=s,n.lastStatsResults=null,n.config=e,n.networkQualityMonitor=o,n.correlationId=e.correlationId,n.mqaSentCount=-1,n.lastMqaDataSent={},n.lastEmittedStartStopEvent={},n.receiveSlotCallback=i,n.successfulCandidatePair={},n.localIpAddress="",n}return(0,O.Z)(r,[{key:"resetStatsResults",value:function(){var e=this;U()(this.statsResults).forEach((function(t){t.includes("recv")&&(e.statsResults[t].recv.meanRtpJitter=[]),t.includes("send")&&(e.statsResults[t].send.meanRemoteJitter=[],e.statsResults[t].send.meanRoundTripTime=[])}))}},{key:"updateMediaStatus",value:function(e){this.meetingMediaStatus=e}},{key:"sendMqaData",value:function(){var e=this,t=Iy()(cw);U()(this.statsResults).forEach((function(t){e.lastMqaDataSent[t]||(e.lastMqaDataSent[t]={}),!e.lastMqaDataSent[t].send&&t.includes("-send")&&(e.lastMqaDataSent[t].send={}),!e.lastMqaDataSent[t].recv&&t.includes("-recv")&&(e.lastMqaDataSent[t].recv={})}));var r=Iy()(dw),n=Iy()(dw),i=Iy()(uw),o=Iy()(uw),s=Iy()(mw),a=Iy()(mw),c=Iy()(fw),u=Iy()(fw);xw({audioSender:r,statsResults:this.statsResults,lastMqaDataSent:this.lastMqaDataSent,baseMediaType:"audio-send"}),t.audioTransmit.push(r),xw({audioSender:n,statsResults:this.statsResults,lastMqaDataSent:this.lastMqaDataSent,baseMediaType:"audio-share-send"}),t.audioTransmit.push(n),_w({audioReceiver:i,statsResults:this.statsResults,lastMqaDataSent:this.lastMqaDataSent,baseMediaType:"audio-recv"}),t.audioReceive.push(i),_w({audioReceiver:o,statsResults:this.statsResults,lastMqaDataSent:this.lastMqaDataSent,baseMediaType:"audio-share-recv"}),t.audioReceive.push(o),Rw({videoSender:s,statsResults:this.statsResults,lastMqaDataSent:this.lastMqaDataSent,baseMediaType:"video-send"}),t.videoTransmit.push(s),Rw({videoSender:a,statsResults:this.statsResults,lastMqaDataSent:this.lastMqaDataSent,baseMediaType:"video-share-send"}),t.videoTransmit.push(a),Iw({videoReceiver:c,statsResults:this.statsResults,lastMqaDataSent:this.lastMqaDataSent,baseMediaType:"video-recv"}),t.videoReceive.push(c),Iw({videoReceiver:u,statsResults:this.statsResults,lastMqaDataSent:this.lastMqaDataSent,baseMediaType:"video-share-recv"}),t.videoReceive.push(u),U()(this.statsResults).forEach((function(r){if(r.includes("audio-send")){var n=Iy()(hw);Aw({audioSenderStream:n,statsResults:e.statsResults,lastMqaDataSent:e.lastMqaDataSent,mediaType:r}),t.audioTransmit[0].streams.push(n),e.lastMqaDataSent[r].send=Iy()(e.statsResults[r].send)}else if(r.includes("audio-share-send")){var i=Iy()(hw);Aw({audioSenderStream:i,statsResults:e.statsResults,lastMqaDataSent:e.lastMqaDataSent,mediaType:r}),t.audioTransmit[1].streams.push(i),e.lastMqaDataSent[r].send=Iy()(e.statsResults[r].send)}else if(r.includes("audio-recv")){var o=Iy()(lw);Tw({audioReceiverStream:o,statsResults:e.statsResults,lastMqaDataSent:e.lastMqaDataSent,mediaType:r}),t.audioReceive[0].streams.push(o),e.lastMqaDataSent[r].recv=Iy()(e.statsResults[r].recv)}else if(r.includes("audio-share-recv")){var s=Iy()(lw);Tw({audioReceiverStream:s,statsResults:e.statsResults,lastMqaDataSent:e.lastMqaDataSent,mediaType:r}),t.audioReceive[1].streams.push(s),e.lastMqaDataSent[r].recv=Iy()(e.statsResults[r].recv)}else if(r.includes("video-send")){var a=Iy()(gw);kw({videoSenderStream:a,statsResults:e.statsResults,lastMqaDataSent:e.lastMqaDataSent,mediaType:r}),t.videoTransmit[0].streams.push(a),e.lastMqaDataSent[r].send=Iy()(e.statsResults[r].send)}else if(r.includes("video-share-send")){var c=Iy()(gw);kw({videoSenderStream:c,statsResults:e.statsResults,lastMqaDataSent:e.lastMqaDataSent,mediaType:r}),t.videoTransmit[1].streams.push(c),e.lastMqaDataSent[r].send=Iy()(e.statsResults[r].send)}else if(r.includes("video-recv")){var u=Iy()(pw);Cw({videoReceiverStream:u,statsResults:e.statsResults,lastMqaDataSent:e.lastMqaDataSent,mediaType:r}),t.videoReceive[0].streams.push(u),e.lastMqaDataSent[r].recv=Iy()(e.statsResults[r].recv)}else if(r.includes("video-share-recv")){var l=Iy()(pw);Cw({videoReceiverStream:l,statsResults:e.statsResults,lastMqaDataSent:e.lastMqaDataSent,mediaType:r}),t.videoReceive[1].streams.push(l),e.lastMqaDataSent[r].recv=Iy()(e.statsResults[r].recv)}})),t.intervalMetadata.peerReflexiveIP=this.statsResults.connectionType.local.ipAddress,t.intervalMetadata.peripherals.push({information:ag,name:Dv.SPEAKER}),this.statsResults["audio-send"]&&t.intervalMetadata.peripherals.push({information:this.statsResults["audio-send"].trackLabel||ag,name:Dv.MICROPHONE}),this.statsResults["video-send"]&&t.intervalMetadata.peripherals.push({information:this.statsResults["video-send"].trackLabel||ag,name:Dv.CAMERA}),t.networkType=this.statsResults.connectionType.local.networkType,this.mqaSentCount+=1,t.intervalNumber=this.mqaSentCount,this.resetStatsResults(),this.emit({file:"statsAnalyzer",function:"sendMqaData"},Nw,{data:t,networkType:t.networkType})}},{key:"updateMediaConnection",value:function(e){this.mediaConnection=e}},{key:"getLocalIpAddress",value:function(){return this.localIpAddress}},{key:"startAnalyzer",value:function(e){var t=this;return this.statsStarted?P().resolve():(this.statsStarted=!0,this.mediaConnection=e,this.getStatsAndParse().then((function(){t.statsInterval=setInterval((function(){t.getStatsAndParse()}),t.config.analyzerInterval),t.sendMqaData(),t.mqaInterval=setInterval((function(){t.sendMqaData()}),Lv)})))}},{key:"stopAnalyzer",value:function(){var e=this,t=this.mqaInterval&&this.statsInterval;return this.statsInterval&&(clearInterval(this.statsInterval),this.statsInterval=void 0),this.mqaInterval&&(clearInterval(this.mqaInterval),this.mqaInterval=void 0),t?this.getStatsAndParse().then((function(){e.sendMqaData(),e.mediaConnection=null})):P().resolve()}},{key:"parseGetStatsResult",value:function(e,t,r){if(e)switch(this.statsResults[t]||(this.statsResults[t]={}),r&&!this.statsResults[t].send?this.statsResults[t].send=Iy()(Uw):r||this.statsResults[t].recv||(this.statsResults[t].recv=Iy()(Bw)),e.type){case"outbound-rtp":this.processOutboundRTPResult(e,t);break;case"inbound-rtp":this.processInboundRTPResult(e,t);break;case"remote-inbound-rtp":case"remote-outbound-rtp":this.compareSentAndReceived(e,t);break;case"remotecandidate":case"remote-candidate":this.parseCandidate(e,t,r,!0);break;case"local-candidate":this.parseCandidate(e,t,r,!1);break;case"media-source":this.parseAudioSource(e,t)}}},{key:"filterAndParseGetStatsResults",value:function(e,t,r){var n,i,o=this,s=Hg.types;(e.report.forEach((function(e){"candidate-pair"===e.type&&"succeeded"===e.state&&(o.successfulCandidatePair=e)})),e.report.forEach((function(e){s.includes(e.type)&&o.parseGetStatsResult(e,t,r)})),this.statsResults[t])&&(this.statsResults[t].direction=e.currentDirection,this.statsResults[t].trackLabel=e.localTrackLabel,this.statsResults[t].csi=e.csi,this.extractAndSetLocalIpAddressInfoForDiagnostics(null===(n=this.successfulCandidatePair)||void 0===n?void 0:n.localCandidateId,null===(i=this.statsResults)||void 0===i?void 0:i.candidates),this.successfulCandidatePair={})}},{key:"parseAudioSource",value:function(e,t){e&&t.includes("audio-send")&&(this.statsResults[t].send.audioLevel=e.audioLevel,this.statsResults[t].send.totalAudioEnergy=e.totalAudioEnergy)}},{key:"compareLastStatsResult",value:function(){var e=this;if(null!==this.lastStatsResults&&this.meetingMediaStatus){var t=function(t,r){return U()(e.statsResults).filter((function(e){return e.startsWith(t)})).reduce((function(t,n){var i;return t+((null===(i=e.statsResults[n])||void 0===i?void 0:i.recv[r])||0)}),0)},r=function(t,r){return U()(e.statsResults).filter((function(e){return e.startsWith(t)})).reduce((function(t,n){var i;return t+((null===(i=e.lastStatsResults[n])||void 0===i?void 0:i.recv[r])||0)}),0)};if(this.meetingMediaStatus.expected.sendAudio&&this.lastStatsResults["audio-send"]){var n=this.statsResults["audio-send"].send,i=this.lastStatsResults["audio-send"].send;n.totalPacketsSent===i.totalPacketsSent||0===n.totalPacketsSent?pp.logger.info("StatsAnalyzer:index#compareLastStatsResult --\x3e No audio RTP packets sent",n.totalPacketsSent):(n.totalAudioEnergy!==i.totalAudioEnergy&&0!==n.totalAudioEnergy||pp.logger.info("StatsAnalyzer:index#compareLastStatsResult --\x3e No audio Energy present",n.totalAudioEnergy),0===n.audioLevel&&pp.logger.info("StatsAnalyzer:index#compareLastStatsResult --\x3e audio level is 0 for the user")),this.emitStartStopEvents("audio",i.totalPacketsSent,n.totalPacketsSent,!0)}if(this.meetingMediaStatus.expected.receiveAudio){var o=t("audio-recv","totalPacketsReceived"),s=r("audio-recv","totalPacketsReceived"),a=t("audio-recv","totalSamplesReceived"),c=r("audio-recv","totalSamplesReceived");o===s||0===o?pp.logger.info("StatsAnalyzer:index#compareLastStatsResult --\x3e No audio RTP packets received",o):a!==c&&0!==a||pp.logger.info("StatsAnalyzer:index#compareLastStatsResult --\x3e No audio samples received",a),this.emitStartStopEvents("audio",s,o,!1)}if(this.meetingMediaStatus.expected.sendVideo&&this.lastStatsResults["video-send"]){var u=this.statsResults["video-send"].send,l=this.lastStatsResults["video-send"].send;u.totalPacketsSent===l.totalPacketsSent||0===u.totalPacketsSent?pp.logger.info("StatsAnalyzer:index#compareLastStatsResult --\x3e No video RTP packets sent",u.totalPacketsSent):(u.framesEncoded!==l.framesEncoded&&0!==u.framesEncoded||pp.logger.info("StatsAnalyzer:index#compareLastStatsResult --\x3e No video Frames Encoded",u.framesEncoded),this.statsResults["video-send"].send.framesSent!==this.lastStatsResults["video-send"].send.framesSent&&0!==this.statsResults["video-send"].send.framesSent||pp.logger.info("StatsAnalyzer:index#compareLastStatsResult --\x3e No video Frames sent",this.statsResults["video-send"].send.framesSent)),this.emitStartStopEvents("video",l.framesSent,u.framesSent,!0)}if(this.meetingMediaStatus.expected.receiveVideo){var d=t("video-recv","totalPacketsReceived"),h=r("video-recv","totalPacketsReceived"),f=t("video-recv","framesReceived"),p=r("video-recv","framesReceived"),m=t("video-recv","framesDecoded"),g=r("video-recv","framesDecoded"),v=t("video-recv","framesDropped"),y=r("video-recv","framesDropped");d===h||0===d?pp.logger.info("StatsAnalyzer:index#compareLastStatsResult --\x3e No video RTP packets received",d):(f!==p&&0!==f||pp.logger.info("StatsAnalyzer:index#compareLastStatsResult --\x3e No video frames received",f),m!==g&&0!==m||pp.logger.info("StatsAnalyzer:index#compareLastStatsResult --\x3e No video frames decoded",m),v-y>10&&pp.logger.info("StatsAnalyzer:index#compareLastStatsResult --\x3e video frames are getting dropped",v-y)),this.emitStartStopEvents("video",g,m,!1)}if(this.meetingMediaStatus.expected.sendShare&&this.lastStatsResults["video-share-send"]){var b=this.statsResults["video-share-send"].send,E=this.lastStatsResults["video-share-send"].send;b.totalPacketsSent===E.totalPacketsSent||0===b.totalPacketsSent?pp.logger.info("StatsAnalyzer:index#compareLastStatsResult --\x3e No share RTP packets sent",b.totalPacketsSent):(b.framesEncoded!==E.framesEncoded&&0!==b.framesEncoded||pp.logger.info("StatsAnalyzer:index#compareLastStatsResult --\x3e No share frames getting encoded",b.framesEncoded),this.statsResults["video-share-send"].send.framesSent!==this.lastStatsResults["video-share-send"].send.framesSent&&0!==this.statsResults["video-share-send"].send.framesSent||pp.logger.info("StatsAnalyzer:index#compareLastStatsResult --\x3e No share frames sent",this.statsResults["video-share-send"].send.framesSent))}if(this.meetingMediaStatus.expected.sendShare){var w=t("video-share-recv","totalPacketsReceived"),S=r("video-share-recv","totalPacketsReceived"),_=t("video-share-recv","framesReceived"),T=r("video-share-recv","framesReceived"),x=t("video-share-recv","framesDecoded"),A=r("video-share-recv","framesDecoded"),I=t("video-share-recv","framesDropped"),C=r("video-share-recv","framesDropped");w===S||0===w?pp.logger.info("StatsAnalyzer:index#compareLastStatsResult --\x3e No share RTP packets received",w):(_!==T&&0!==_||pp.logger.info("StatsAnalyzer:index#compareLastStatsResult --\x3e No share frames received",_),x!==A&&0!==x||pp.logger.info("StatsAnalyzer:index#compareLastStatsResult --\x3e No share frames decoded",x),I-C>10&&pp.logger.info("StatsAnalyzer:index#compareLastStatsResult --\x3e share frames are getting dropped",I-C))}}}},{key:"getStatsAndParse",value:function(){var e=this;return this.mediaConnection?this.mediaConnection&&this.mediaConnection.getConnectionState()===ar.Failed?(pp.logger.trace("StatsAnalyzer:index#getStatsAndParse --\x3e media connection is in failed state"),P().resolve()):(pp.logger.trace("StatsAnalyzer:index#getStatsAndParse --\x3e Collecting Stats"),this.mediaConnection.getTransceiverStats().then((function(t){t.video.receivers.forEach((function(t,r){return e.filterAndParseGetStatsResults(t,"video-recv-".concat(r),!1)})),t.audio.receivers.forEach((function(t,r){return e.filterAndParseGetStatsResults(t,"audio-recv-".concat(r),!1)})),t.screenShareVideo.receivers.forEach((function(t,r){return e.filterAndParseGetStatsResults(t,"video-share-recv-".concat(r),!1)})),t.screenShareAudio.receivers.forEach((function(t,r){return e.filterAndParseGetStatsResults(t,"audio-share-recv-".concat(r),!1)})),t.video.senders.forEach((function(t,r){if(r>0)throw new Error("Stats Analyzer does not support multiple senders.");e.filterAndParseGetStatsResults(t,"video-send",!0)})),t.audio.senders.forEach((function(t,r){if(r>0)throw new Error("Stats Analyzer does not support multiple senders.");e.filterAndParseGetStatsResults(t,"audio-send",!0)})),t.screenShareVideo.senders.forEach((function(t,r){if(r>0)throw new Error("Stats Analyzer does not support multiple senders.");e.filterAndParseGetStatsResults(t,"video-share-send",!0)})),t.screenShareAudio.senders.forEach((function(t,r){if(r>0)throw new Error("Stats Analyzer does not support multiple senders.");e.filterAndParseGetStatsResults(t,"audio-share-send",!0)})),e.compareLastStatsResult(),e.lastStatsResults=JSON.parse(uy()(e.statsResults)),pp.logger.trace("StatsAnalyzer:index#getStatsAndParse --\x3e Finished Collecting Stats")}))):P().resolve()}},{key:"processOutboundRTPResult",value:function(e,t){var r=kv.SEND_DIRECTION;if(e.bytesSent){e.frameWidth&&e.frameHeight&&(this.statsResults[t][r].width=e.frameWidth,this.statsResults[t][r].height=e.frameHeight,this.statsResults[t][r].framesSent=e.framesSent,this.statsResults[t][r].hugeFramesSent=e.hugeFramesSent),this.statsResults[t][r].availableBandwidth=(0).toFixed(1),this.statsResults[t][r].framesEncoded=e.framesEncoded,this.statsResults[t][r].keyFramesEncoded=e.keyFramesEncoded,this.statsResults[t][r].packetsSent=e.packetsSent,this.statsResults[t][r].totalKeyFramesEncoded=e.keyFramesEncoded,this.statsResults[t][r].totalNackCount=e.nackCount,this.statsResults[t][r].totalPliCount=e.pliCount,this.statsResults[t][r].totalPacketsSent=e.packetsSent,this.statsResults[t][r].totalFirCount=e.firCount,this.statsResults[t][r].framesSent=e.framesSent,this.statsResults[t][r].framesEncoded=e.framesEncoded,this.statsResults[t][r].encoderImplementation=e.encoderImplementation,this.statsResults[t][r].qualityLimitationReason=e.qualityLimitationReason,this.statsResults[t][r].qualityLimitationResolutionChanges=e.qualityLimitationResolutionChanges,this.statsResults[t][r].retransmittedPacketsSent=e.retransmittedPacketsSent,this.statsResults[t][r].totalBytesSent=e.bytesSent,this.statsResults[t][r].headerBytesSent=e.headerBytesSent,this.statsResults[t][r].retransmittedBytesSent=e.retransmittedBytesSent}}},{key:"processInboundRTPResult",value:function(e,t){var r=kv.RECEIVE_DIRECTION;if(e.bytesReceived){var n=0,i=this.receiveSlotCallback(e.ssrc),o=null==i?void 0:i.sourceState,s=i?'id: "'.concat(i.id||"",'"').concat(i.csi?" and csi: ".concat(i.csi):""):"";e.frameWidth&&e.frameHeight&&(this.statsResults[t][r].width=e.frameWidth,this.statsResults[t][r].height=e.frameHeight,this.statsResults[t][r].framesReceived=e.framesReceived),n=(e.bytesReceived-this.statsResults[t][r].totalBytesReceived)/1024,this.statsResults[t][r].availableBandwidth=n.toFixed(1);var a=e.packetsLost-this.statsResults[t][r].totalPacketsLost;a<0&&(a=0);var c=e.packetsReceived-this.statsResults[t][r].totalPacketsReceived;this.statsResults[t][r].totalPacketsReceived=e.packetsReceived,0===c&&i&&"live"===o&&pp.logger.info("StatsAnalyzer:index#processInboundRTPResult --\x3e No packets received for receive slot ".concat(s,". Total packets received on slot: "),e.packetsReceived),this.statsResults[t][r].currentPacketLossRatio=a>0?a/(c+a):0,this.statsResults[t][r].currentPacketLossRatio>3&&pp.logger.info("StatsAnalyzer:index#processInboundRTPResult --\x3e Packets getting lost from the receiver with slot ".concat(s),this.statsResults[t][r].currentPacketLossRatio),e.packetsLost?this.statsResults[t][r].totalPacketsLost=e.packetsLost>0?e.packetsLost:-e.packetsLost:this.statsResults[t][r].totalPacketsLost=0,this.statsResults[t][r].lastPacketReceivedTimestamp=e.lastPacketReceivedTimestamp,this.statsResults[t][r].totalNackCount=e.nackCount,this.statsResults[t][r].totalPliCount=e.pliCount,this.statsResults[t][r].framesDecoded=e.framesDecoded,this.statsResults[t][r].keyFramesDecoded=e.keyFramesDecoded,this.statsResults[t][r].decoderImplementation=e.decoderImplementation,this.statsResults[t][r].totalPacketsReceived=e.packetsReceived,this.statsResults[t][r].fecPacketsDiscarded=e.fecPacketsDiscarded,this.statsResults[t][r].fecPacketsReceived=e.fecPacketsReceived,this.statsResults[t][r].totalBytesReceived=e.bytesReceived,this.statsResults[t][r].headerBytesReceived=e.headerBytesReceived,this.statsResults[t][r].meanRtpJitter.push(e.jitter),this.statsResults[t][r].audioLevel=e.audioLevel,this.statsResults[t][r].totalAudioEnergy=e.totalAudioEnergy,this.statsResults[t][r].totalSamplesReceived=e.totalSamplesReceived||0,this.statsResults[t][r].totalSamplesDecoded=e.totalSamplesDecoded||0,this.statsResults[t][r].concealedSamples=e.concealedSamples||0}}},{key:"compareSentAndReceived",value:function(e,t){if(t&&this.statsResults[t].send){var r=t,n=e.packetsLost-this.statsResults[r].send.totalPacketsLostOnReceiver;this.statsResults[r].send.packetsLostOnReceiver=n,this.statsResults[r].send.totalPacketsLostOnReceiver=e.packetsLost,this.statsResults[r].send.meanRemoteJitter.push(e.jitter),this.statsResults[r].send.meanRoundTripTime.push(e.roundTripTime),this.statsResults[r].send.timestamp=e.timestamp,this.statsResults[r].send.ssrc=e.ssrc,this.statsResults[r].send.reportsReceived=e.reportsReceived,this.statsResults[r].send.overAllPacketLossRatio=this.statsResults[r].send.totalPacketsLostOnReceiver>0?this.statsResults[r].send.totalPacketsLostOnReceiver/this.statsResults[r].send.totalPacketsSent:0,this.statsResults[r].send.currentPacketLossRatio=this.statsResults[r].send.packetsLostOnReceiver>0?100*this.statsResults[r].send.packetsLostOnReceiver/(this.statsResults[r].send.packetsSent+this.statsResults[r].send.packetsLostOnReceiver):0,this.statsResults[r].send.maxPacketLossRatio<this.statsResults[r].send.currentPacketLossRatio&&(this.statsResults[r].send.maxPacketLossRatio=this.statsResults[r].send.currentPacketLossRatio),"remote-inbound-rtp"===e.type&&this.networkQualityMonitor.determineUplinkNetworkQuality({mediaType:r,remoteRtpResults:e,statsAnalyzerCurrentStats:this.statsResults})}}}]),r}(aw),jw=r(27392),Vw=r.n(jw);function Hw(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var Gw=function(e){(0,A.Z)(r,e);var t=Hw(r);function r(e){var n;return(0,k.Z)(this,r),n=t.call(this),(0,R.Z)((0,x.Z)(n),"config",void 0),(0,R.Z)((0,x.Z)(n),"frequencyTypes",void 0),(0,R.Z)((0,x.Z)(n),"indicatorTypes",void 0),(0,R.Z)((0,x.Z)(n),"mediaType",void 0),(0,R.Z)((0,x.Z)(n),"networkQualityScore",void 0),(0,R.Z)((0,x.Z)(n),"networkQualityStatus",void 0),n.config=e,n.indicatorTypes=Vw()({PACKETLOSS:"packetLoss",LATENCY:"latency",JITTER:"jitter"}),n.frequencyTypes=Vw()({UPLINK:"uplink",DOWNLINK:"downlink"}),n.networkQualityScore=1,n.networkQualityStatus=(0,R.Z)({},n.frequencyTypes.UPLINK,{}),n.mediaType=null,n}return(0,O.Z)(r,[{key:"emitNetworkQuality",value:function(){this.emit({file:"networkQualityMonitor",function:"emitNetworkQuality"},$g.NETWORK_QUALITY,{mediaType:this.mediaType,networkQualityScore:this.networkQualityScore})}},{key:"updateNetworkQualityStatus",value:function(){this.emitNetworkQuality(),this.networkQualityScore=1,this.mediaType=null}},{key:"determineUplinkNetworkQuality",value:function(e){var t=this,r=e.mediaType,n=e.remoteRtpResults,i=e.statsAnalyzerCurrentStats,o=1e3*n.roundTripTime,s=1e3*n.jitter,a=i[r].send.currentPacketLossRatio;this.mediaType=r;var c=this.indicatorTypes,u=c.JITTER,l=c.PACKETLOSS,d=c.LATENCY,h=this.frequencyTypes.UPLINK,f=function(e){return void 0===e?null:e};this.networkQualityStatus[h][r]||(this.networkQualityStatus[h][r]={}),this.networkQualityStatus[h][r][l]={acceptable:!(a>t.config.videoPacketLossRatioThreshold&&(t.networkQualityScore=0,1)),value:f(a)},this.networkQualityStatus[h][r][d]={acceptable:!(o>t.config.rttThreshold&&(t.networkQualityScore=0,1)),value:f(n.roundTripTime)},this.networkQualityStatus[h][r][u]={acceptable:!(s>t.config.jitterThreshold&&(t.networkQualityScore=0,1)),value:f(n.jitter)},this.updateNetworkQualityStatus()}},{key:"networkQualityStats",get:function(){var e=this.frequencyTypes.UPLINK;return this.networkQualityStatus[e]}}]),r}(aw);function qw(e,t){var r=U()(e);if(p()){var n=p()(e);t&&(n=n.filter((function(t){return g()(e,t).enumerable}))),r.push.apply(r,n)}return r}function $w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?qw(Object(r),!0).forEach((function(t){(0,R.Z)(e,t,r[t])})):y()?E()(e,y()(r)):qw(Object(r)).forEach((function(t){S()(e,t,g()(r,t))}))}return e}function Zw(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var zw=function(e){(0,A.Z)(i,e);var t,r,n=Zw(i);function i(){return(0,k.Z)(this,i),n.apply(this,arguments)}return(0,O.Z)(i,[{key:"attachReachabilityData",value:(r=(0,T.Z)(V().mark((function e(t){var r,n,i;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.webex.meetings.reachability.getReachabilityResults();case 2:return(n=e.sent)&&U()(n).length&&(t.reachability=n),e.next=6,this.webex.boundedStorage.get(xv.namespace,xv.localStorageJoinCookie).catch((function(){}));case 6:if(i=e.sent)try{r=JSON.parse(i)}catch(e){pp.logger.error("MeetingRequest#constructor --\x3e Error in parsing join cookie data: ".concat(e))}return e.abrupt("return",{localSdp:t,joinCookie:r});case 9:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"sendRoap",value:(t=(0,T.Z)(V().mark((function e(t){var r,n,i,o,s,a,c,u,l,d=this;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.roapMessage,n=t.locusSelfUrl,i=t.mediaId,o=t.meetingId,s=t.locusMediaRequest,a=t.ipVersion,i||pp.logger.info("Roap:request#sendRoap --\x3e sending empty mediaID"),s){e.next=5;break}return pp.logger.warn("Roap:request#sendRoap --\x3e locusMediaRequest unavailable, not sending roap"),e.abrupt("return",P().reject(new Error("sendRoap called when locusMediaRequest is undefined")));case 5:return e.next=7,this.attachReachabilityData({roapMessage:r});case 7:return c=e.sent,u=c.localSdp,l=c.joinCookie,pp.logger.info("Roap:request#sendRoap --\x3e ".concat(n," \n ").concat(r.messageType," \n seq:").concat(r.seq)),this.webex.internal.newMetrics.submitClientEvent({name:"client.locus.media.request",options:{meetingId:o}}),e.abrupt("return",s.send({type:"RoapMessage",selfUrl:n,joinCookie:l,mediaId:i,roapMessage:r,reachability:u.reachability,ipVersion:a}).then((function(e){d.webex.internal.newMetrics.submitClientEvent({name:"client.locus.media.response",options:{meetingId:o}});var t=e.body.mediaConnections&&e.body.mediaConnections.length>0&&e.body.mediaConnections[0];pp.logger.debug("Roap:request#sendRoap --\x3e response:".concat(uy()(t,null,2),"'\n StatusCode:'").concat(e.statusCode));var n=e.body.locus;return n.roapSeq=r.seq,$w({locus:n},t&&{mediaConnections:e.body.mediaConnections})})).catch((function(e){throw d.webex.internal.newMetrics.submitClientEvent({name:"client.locus.media.response",options:{meetingId:o,rawError:e}}),pp.logger.error("Roap:request#sendRoap --\x3e Error:".concat(uy()(e,null,2))),pp.logger.error("Roap:request#sendRoapRequest --\x3e errorBody:".concat(uy()(r,null,2)," + '\\n mediaId:'").concat(t.mediaId)),e})));case 13:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),i}(l.XR),Kw=function(){function e(t){(0,k.Z)(this,e),(0,R.Z)(this,"roapRequest",void 0),(0,R.Z)(this,"defer",void 0),(0,R.Z)(this,"turnInfo",void 0),(0,R.Z)(this,"responseTimer",void 0),this.roapRequest=t,this.turnInfo={url:"",username:"",password:""}}var t,r,n,i;return(0,O.Z)(e,[{key:"waitForTurnDiscoveryResponse",value:function(){if(!this.defer)return pp.logger.warn("Roap:turnDiscovery#waitForTurnDiscoveryResponse --\x3e TURN discovery is not in progress"),P().reject(new Error("waitForTurnDiscoveryResponse() called before sendRoapTurnDiscoveryRequest()"));var e=this.defer;return this.responseTimer=setTimeout((function(){pp.logger.warn("Roap:turnDiscovery#waitForTurnDiscoveryResponse --\x3e timeout! no response arrived within ".concat(10," seconds")),e.reject(new Error("Timed out waiting for TURN_DISCOVERY_RESPONSE"))}),1e4),pp.logger.info("Roap:turnDiscovery#waitForTurnDiscoveryResponse --\x3e waiting for TURN_DISCOVERY_RESPONSE..."),e.promise}},{key:"handleTurnDiscoveryResponse",value:function(e,t){var r=this,n=e.headers;if(this.defer){e.messageType!==Av.ROAP_TYPES.TURN_DISCOVERY_RESPONSE&&this.defer.reject(new Error("TURN_DISCOVERY_RESPONSE ".concat(t," has unexpected messageType: ").concat(uy()(e))));var i=[{headerName:"x-cisco-turn-url",field:"url"},{headerName:"x-cisco-turn-username",field:"username"},{headerName:"x-cisco-turn-password",field:"password"}],o=0;null==n||n.forEach((function(e){i.forEach((function(t){e.startsWith("".concat(t.headerName,"="))&&(r.turnInfo[t.field]=e.substring(t.headerName.length+1),o+=1)}))})),clearTimeout(this.responseTimer),this.responseTimer=void 0,o!==i.length?(pp.logger.warn("Roap:turnDiscovery#handleTurnDiscoveryResponse --\x3e missing some headers, received ".concat(t,": ").concat(uy()(n))),this.defer.reject(new Error("TURN_DISCOVERY_RESPONSE ".concat(t," missing some headers: ").concat(uy()(n))))):(pp.logger.info("Roap:turnDiscovery#handleTurnDiscoveryResponse --\x3e received a valid response ".concat(t,", url=").concat(this.turnInfo.url)),this.defer.resolve({isOkRequired:!(null!=n&&n.includes("noOkInTransaction"))}))}else pp.logger.warn("Roap:turnDiscovery#handleTurnDiscoveryResponse --\x3e unexpected TURN discovery response ".concat(t))}},{key:"handleTurnDiscoveryResponseInHttpResponse",value:(i=(0,T.Z)(V().mark((function e(t){return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.handleTurnDiscoveryResponse(t,"in http response"),e.abrupt("return",this.defer.promise);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"sendRoapTurnDiscoveryRequest",value:function(e,t){if(this.defer)return pp.logger.warn("Roap:turnDiscovery#sendRoapTurnDiscoveryRequest --\x3e already in progress"),P().resolve();this.defer=new bp.Defer;var r={messageType:Av.ROAP_TYPES.TURN_DISCOVERY_REQUEST,version:Av.ROAP_VERSION,seq:0,headers:["includeAnswerInHttpResponse","noOkInTransaction"]};return pp.logger.info("Roap:turnDiscovery#sendRoapTurnDiscoveryRequest --\x3e sending TURN_DISCOVERY_REQUEST"),this.roapRequest.sendRoap({roapMessage:r,locusSelfUrl:e.selfUrl,mediaId:t?"":e.mediaId,meetingId:e.id,locusMediaRequest:e.locusMediaRequest,ipVersion:eb.getIpVersion(e.webex)}).then((function(t){var r,n,i=t.mediaConnections;if(i&&(e.updateMediaConnections(i),null!==(n=i[0])&&void 0!==n&&n.remoteSdp)){var o=JSON.parse(i[0].remoteSdp);if(o.roapMessage){var s=o.roapMessage;r={seq:s.seq,messageType:s.messageType,errorType:s.errorType,errorCause:s.errorCause,headers:s.headers}}}return r||sp.sendBehavioralMetric(cE,{correlationId:e.correlationId,messageType:"TURN_DISCOVERY_RESPONSE",isMultistream:e.isMultistream}),r}))}},{key:"sendRoapOK",value:function(e){return pp.logger.info("Roap:turnDiscovery#sendRoapOK --\x3e sending OK"),this.roapRequest.sendRoap({roapMessage:{messageType:Av.ROAP_TYPES.OK,version:Av.ROAP_VERSION,seq:0},locusSelfUrl:e.selfUrl,mediaId:e.mediaId,meetingId:e.id,locusMediaRequest:e.locusMediaRequest})}},{key:"getSkipReason",value:(n=(0,T.Z)(V().mark((function e(t){return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.webex.meetings.reachability.isAnyPublicClusterReachable();case 2:if(!e.sent){e.next=6;break}return pp.logger.info("Roap:turnDiscovery#getSkipReason --\x3e reachability has not failed, skipping TURN discovery"),e.abrupt("return","reachability");case 6:return e.abrupt("return","");case 7:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"isSkipped",value:(r=(0,T.Z)(V().mark((function e(t){var r;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSkipReason(t);case 2:return r=e.sent,e.abrupt("return",!!r);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"doTurnDiscovery",value:(t=(0,T.Z)(V().mark((function e(t,r,n){var i,o;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=4;break}return e.next=3,this.getSkipReason(t);case 3:i=e.sent;case 4:if(!i){e.next=6;break}return e.abrupt("return",{turnServerInfo:void 0,turnDiscoverySkippedReason:i});case 6:return e.prev=6,e.next=9,this.sendRoapTurnDiscoveryRequest(t,r);case 9:if(!(o=e.sent)){e.next=16;break}return e.next=13,this.handleTurnDiscoveryResponseInHttpResponse(o);case 13:e.t0=e.sent,e.next=19;break;case 16:return e.next=18,this.waitForTurnDiscoveryResponse();case 18:e.t0=e.sent;case 19:if(!e.t0.isOkRequired){e.next=26;break}return e.next=24,this.sendRoapOK(t);case 24:pp.logger.info("Roap:turnDiscovery#doTurnDiscovery --\x3e TURN discovery response requires OK"),sp.sendBehavioralMetric(uE,{correlation_id:t.correlationId,locus_id:t.locusUrl.split("/").pop()});case 26:return this.defer=void 0,pp.logger.info("Roap:turnDiscovery#doTurnDiscovery --\x3e TURN discovery completed"),e.abrupt("return",{turnServerInfo:this.turnInfo,turnDiscoverySkippedReason:void 0});case 31:return e.prev=31,e.t1=e.catch(6),pp.logger.info("Roap:turnDiscovery#doTurnDiscovery --\x3e TURN discovery failed, continuing without TURN: ".concat(e.t1)),sp.sendBehavioralMetric(eE,{correlation_id:t.correlationId,locus_id:t.locusUrl.split("/").pop(),reason:e.t1.message,stack:e.t1.stack}),e.abrupt("return",{turnServerInfo:void 0,turnDiscoverySkippedReason:void 0});case 36:case"end":return e.stop()}}),e,this,[[6,31]])}))),function(e,r,n){return t.apply(this,arguments)})}]),e}();function Ww(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var Jw=function(e){(0,A.Z)(r,e);var t=Ww(r);function r(e,n){var i;return(0,k.Z)(this,r),i=t.call(this,{},n),(0,R.Z)((0,x.Z)(i),"attrs",void 0),(0,R.Z)((0,x.Z)(i),"lastRoapOffer",void 0),(0,R.Z)((0,x.Z)(i),"options",void 0),(0,R.Z)((0,x.Z)(i),"roapHandler",void 0),(0,R.Z)((0,x.Z)(i),"roapRequest",void 0),(0,R.Z)((0,x.Z)(i),"turnDiscovery",void 0),i.attrs=e,i.options=n,i.roapRequest=new zw({},n),i.turnDiscovery=new Kw(i.roapRequest),i}return(0,O.Z)(r,[{key:"sendRoapOK",value:function(e){var t=this;return P().resolve().then((function(){var r=t.webex.meetings.meetingCollection.getByKey("correlationId",e.correlationId),n={messageType:Av.ROAP_TYPES.OK,version:Av.ROAP_VERSION,seq:e.seq};return pp.logger.log("Roap:index#sendRoapOK --\x3e ROAP OK sending with seq ".concat(e.seq)),t.roapRequest.sendRoap({roapMessage:n,locusSelfUrl:r.selfUrl,mediaId:e.mediaId,meetingId:r.id,locusMediaRequest:r.locusMediaRequest}).then((function(){pp.logger.log("Roap:index#sendRoapOK --\x3e ROAP OK sent with seq ".concat(e.seq))}))}))}},{key:"sendRoapAnswer",value:function(e){var t=this.webex.meetings.meetingCollection.getByKey("correlationId",e.correlationId),r={messageType:Av.ROAP_TYPES.ANSWER,sdps:[e.sdp],version:Av.ROAP_VERSION,seq:e.seq};return this.roapRequest.sendRoap({roapMessage:r,locusSelfUrl:t.selfUrl,mediaId:e.mediaId,meetingId:t.id,locusMediaRequest:t.locusMediaRequest})}},{key:"sendRoapError",value:function(e){var t=this.webex.meetings.meetingCollection.getByKey("correlationId",e.correlationId),r={messageType:Av.ROAP_TYPES.ERROR,version:Av.ROAP_VERSION,errorType:e.errorType,seq:e.seq};return this.roapRequest.sendRoap({roapMessage:r,locusSelfUrl:t.selfUrl,mediaId:e.mediaId,meetingId:t.id,locusMediaRequest:t.locusMediaRequest}).then((function(){pp.logger.log("Roap:index#sendRoapError --\x3e ROAP ERROR sent with seq ".concat(e.seq))}))}},{key:"sendRoapMediaRequest",value:function(e){var t=e.meeting,r=e.seq,n=e.sdp,i=e.tieBreaker,o={messageType:Av.ROAP_TYPES.OFFER,sdps:[n],version:Av.ROAP_VERSION,seq:r,tieBreaker:i,headers:["includeAnswerInHttpResponse","noOkInTransaction"]};return this.roapRequest.sendRoap({roapMessage:o,locusSelfUrl:t.selfUrl,mediaId:t.mediaId,meetingId:t.id,preferTranscoding:!t.isMultistream,locusMediaRequest:t.locusMediaRequest,ipVersion:eb.getIpVersion(t.webex)}).then((function(e){var r,n,i=e.locus,o=e.mediaConnections;if(o&&t.updateMediaConnections(o),null!=o&&null!==(r=o[0])&&void 0!==r&&r.remoteSdp){var s=JSON.parse(o[0].remoteSdp);if(s.roapMessage){var a=s.roapMessage,c=a.seq,u=a.messageType,l=a.sdps,d=a.errorType,h=a.errorCause,f=a.headers;n={seq:c,messageType:u,sdp:l[0],errorType:d,errorCause:h,headers:f}}}return n||sp.sendBehavioralMetric(cE,{correlationId:t.correlationId,messageType:"ANSWER",isMultistream:t.isMultistream}),{locus:i,roapAnswer:n}}))}},{key:"doTurnDiscovery",value:function(e,t,r){return this.turnDiscovery.doTurnDiscovery(e,t,r)}}]),r}(l.XR),Yw=function(){function e(){(0,k.Z)(this,e),(0,R.Z)(this,"audioStream",void 0),(0,R.Z)(this,"mediaDirection",void 0),(0,R.Z)(this,"mediaSettings",void 0),(0,R.Z)(this,"webrtcMediaConnection",void 0),(0,R.Z)(this,"remoteAudioStream",void 0),(0,R.Z)(this,"remoteQualityLevel",void 0),(0,R.Z)(this,"remoteShareStream",void 0),(0,R.Z)(this,"remoteVideoStream",void 0),(0,R.Z)(this,"shareVideoStream",void 0),(0,R.Z)(this,"shareAudioStream",void 0),(0,R.Z)(this,"videoDeviceId",void 0),(0,R.Z)(this,"videoStream",void 0),(0,R.Z)(this,"namespace",pg),this.webrtcMediaConnection=null,this.mediaDirection={receiveAudio:!1,receiveVideo:!1,receiveShare:!1,sendAudio:!1,sendVideo:!1,sendShare:!1},this.videoStream=null,this.audioStream=null,this.shareVideoStream=null,this.shareAudioStream=null,this.remoteShareStream=void 0,this.remoteAudioStream=void 0,this.remoteVideoStream=void 0,this.remoteQualityLevel=Nv.HIGH,this.mediaSettings={},this.videoDeviceId=null}var t;return(0,O.Z)(e,[{key:"getVideoDeviceId",value:function(){return this.videoDeviceId||null}},{key:"setMediaDirection",value:function(e){this.mediaDirection=e}},{key:"setMediaSettings",value:function(e,t){this.mediaSettings[e]=t}},{key:"setMediaPeerConnection",value:function(e){this.webrtcMediaConnection=e}},{key:"setLocalVideoStream",value:function(e){this.videoStream=e}},{key:"setLocalAudioStream",value:function(e){this.audioStream=e}},{key:"setLocalShareVideoStream",value:function(e){this.shareVideoStream=e}},{key:"setLocalShareAudioStream",value:function(e){this.shareAudioStream=e}},{key:"setRemoteQualityLevel",value:function(e){this.remoteQualityLevel=e}},{key:"setRemoteShareStream",value:function(e){this.remoteShareStream=e}},{key:"setRemoteAudioStream",value:function(e){this.remoteAudioStream=e}},{key:"setRemoteVideoStream",value:function(e){this.remoteVideoStream=e}},{key:"setVideoDeviceId",value:function(e){this.videoDeviceId=e}},{key:"unsetPeerConnection",value:function(){this.webrtcMediaConnection=null}},{key:"unsetRemoteMedia",value:function(){this.remoteAudioStream=null,this.remoteVideoStream=null}},{key:"unsetRemoteShareStream",value:function(){this.remoteShareStream=null}},{key:"unsetRemoteStreams",value:function(){this.unsetRemoteMedia(),this.unsetRemoteShareStream()}},{key:"hasLocalShareStream",value:function(){return!(!this.shareAudioStream&&!this.shareVideoStream)}},{key:"waitForMediaConnectionConnected",value:function(){var e=this,t=function(){return e.webrtcMediaConnection.getConnectionState()===ar.Connected};return t()?P().resolve():new(P())((function(r,n){var i,o=function n(){pp.logger.log("Media:properties#waitForMediaConnectionConnected --\x3e connection state: ".concat(e.webrtcMediaConnection.getConnectionState())),t()&&(clearTimeout(i),e.webrtcMediaConnection.off(Hc.CONNECTION_STATE_CHANGED,n),r())};i=setTimeout((function(){e.webrtcMediaConnection.off(Hc.CONNECTION_STATE_CHANGED,o),n()}),kg),e.webrtcMediaConnection.on(Hc.CONNECTION_STATE_CHANGED,o)}))}},{key:"getCurrentConnectionType",value:(t=(0,T.Z)(V().mark((function e(){var t,r,n,i;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForMediaConnectionConnected();case 2:return t=[],e.prev=3,e.next=6,this.webrtcMediaConnection.getStats();case 6:e.sent.forEach((function(e){return t.push(e)})),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),pp.logger.warn("Media:properties#getCurrentConnectionType --\x3e getStats() failed: ".concat(e.t0));case 13:return r=t.filter((function(e){var t;return"candidate-pair"===e.type&&"succeeded"===(null===(t=e.state)||void 0===t?void 0:t.toLowerCase())})),n="unknown",r.some((function(e){var r,i,o=t.find((function(t){return"local-candidate"===t.type&&t.id===e.localCandidateId}));return void 0===o?(pp.logger.warn('Media:properties#getCurrentConnectionType --\x3e failed to find local candidate "'.concat(e.localCandidateId,'" in getStats() results')),!1):(r=o.relayProtocol?"TURN-".concat(o.relayProtocol.toUpperCase()):null===(i=o.protocol)||void 0===i?void 0:i.toUpperCase())?(n=r,!0):(pp.logger.warn("Media:properties#getCurrentConnectionType --\x3e missing localCandidate.protocol, candidateType=".concat(o.candidateType)),!1)})),"unknown"===n&&(i=t.filter((function(e){return"candidate-pair"===e.type})).map((function(e){return e.state})),pp.logger.warn("Media:properties#getCurrentConnectionType --\x3e all candidate pair states: ".concat(uy()(i)))),e.abrupt("return",n);case 18:case"end":return e.stop()}}),e,this,[[3,10]])}))),function(){return t.apply(this,arguments)})}]),e}(),Qw=r(84907),Xw=r.n(Qw),eS=r(55777),tS=r.n(eS),rS={create:function(e){if(!e)throw new zv("You must initialize the meeting state machine with a meeting reference.");return new(Xw())({init:bv.STATES.IDLE,transitions:[{name:bv.TRANSITIONS.RING,from:[bv.STATES.IDLE,bv.STATES.ERROR,bv.STATES.JOINED],to:bv.STATES.RINGING},{name:bv.TRANSITIONS.JOIN,from:[bv.STATES.JOINED,bv.STATES.IDLE,bv.STATES.RINGING,bv.STATES.ERROR],to:bv.STATES.JOINED},{name:bv.TRANSITIONS.REMOTE,from:[bv.STATES.JOINED,bv.STATES.ERROR],to:function(e){return e.remoteAnswered?bv.STATES.ANSWERED:e.remoteDeclined?bv.STATES.DECLINED:bv.STATES.ERROR}},{name:bv.TRANSITIONS.LEAVE,from:[bv.STATES.IDLE,bv.STATES.RINGING,bv.STATES.JOINED,bv.STATES.ANSWERED,bv.STATES.DECLINED,bv.STATES.ERROR],to:bv.STATES.ENDED},{name:bv.TRANSITIONS.END,from:[bv.STATES.IDLE,bv.STATES.RINGING,bv.STATES.JOINED,bv.STATES.ANSWERED,bv.STATES.DECLINED,bv.STATES.ERROR],to:bv.STATES.ENDED},{name:bv.TRANSITIONS.DECLINE,from:[bv.STATES.RINGING,bv.STATES.ERROR],to:bv.STATES.ENDED},{name:bv.TRANSITIONS.FAIL,from:"*",to:bv.STATES.ERROR},{name:bv.TRANSITIONS.RESET,from:"*",to:bv.STATES.IDLE}],data:{meeting:e},methods:{onRemote:function(e,t){this.meeting&&Qv.trigger(this.meeting,{file:"meeting/state",function:"onRemote"},$g.MEETING_RINGING_STOP,{id:this.meeting.id,type:t})},onRing:function(e,t){this.meeting&&Qv.trigger(this.meeting,{file:"meeting/state",function:"onRing"},$g.MEETING_RINGING,{type:t,id:this.meeting.id})},onEnterError:function(e,t){pp.logger.error("Meeting:state#onEnterError --\x3e state->onEnterError#meeting.id: ".concat(this.meeting.id," | Transition '").concat(null==e?void 0:e.transition,"' : ").concat(null==e?void 0:e.from," -> ").concat(null==e?void 0:e.to,", with error ").concat(t,". Last states: ").concat(this.history))},onAfterTransition:function(e){pp.logger.log("Meeting:state#onAfterTransition --\x3e state->onAfterTransition#meeting.id: ".concat(this.meeting.id," | Transition '").concat(e.transition,"' : ").concat(e.from," -> ").concat(e.to," executed. Last states: ").concat(this.history))}},plugins:[new(tS())({max:25})]})}};const nS=rS;var iS=function(e,t,r){return pp.logger.info("Meeting:muteState#createMuteState --\x3e ".concat(e,": creating MuteState for meeting id ").concat(null==t?void 0:t.id)),new oS(e,t,r)},oS=function(){function e(t,r,n){var i,o;if((0,k.Z)(this,e),(0,R.Z)(this,"state",void 0),(0,R.Z)(this,"type",void 0),(0,R.Z)(this,"ignoreMuteStateChange",void 0),t!==Ep&&t!==gm)throw new zv("Mute state is designed for handling audio or video only");this.type=t,this.ignoreMuteStateChange=!1,this.state={client:{enabled:n,localMute:!0},server:{localMute:!0,remoteMute:t===Ep?r.remoteMuted:null!==(i=r.remoteVideoMuted)&&void 0!==i&&i,unmuteAllowed:t===Ep?r.unmuteAllowed:null===(o=r.unmuteVideoAllowed)||void 0===o||o},syncToServerInProgress:!1}}return(0,O.Z)(e,[{key:"init",value:function(e){var t,r;this.applyUnmuteAllowedToStream(e),this.state.server.remoteMute&&this.muteLocalStream(e,this.state.server.remoteMute,"remotelyMuted");var n=this.type===Ep?null===(t=e.mediaProperties.audioStream)||void 0===t?void 0:t.muted:null===(r=e.mediaProperties.videoStream)||void 0===r?void 0:r.muted;pp.logger.info("Meeting:muteState#init --\x3e ".concat(this.type,": local stream initial mute state: ").concat(n)),this.state.client.localMute=void 0===n||n,this.applyClientStateToServer(e)}},{key:"handleLocalStreamChange",value:function(e){return this.init(e)}},{key:"enable",value:function(e,t){this.state.client.enabled=t,this.applyClientStateToServer(e)}},{key:"muteLocalStream",value:function(e,t,r){var n,i;(this.ignoreMuteStateChange=!0,this.type===Ep)?null===(n=e.mediaProperties.audioStream)||void 0===n||n.setServerMuted(t,r):null===(i=e.mediaProperties.videoStream)||void 0===i||i.setServerMuted(t,r);this.ignoreMuteStateChange=!1}},{key:"handleLocalStreamMuteStateChange",value:function(e,t){this.ignoreMuteStateChange||(pp.logger.info("Meeting:muteState#handleLocalStreamMuteStateChange --\x3e ".concat(this.type,": local stream new mute state: ").concat(t)),this.state.client.localMute=t,this.applyClientStateToServer(e))}},{key:"applyClientStateLocally",value:function(e,t){this.muteLocalStream(e,this.state.client.localMute,t)}},{key:"getClientLocalMuteState",value:function(){return!this.state.client.enabled||this.state.client.localMute}},{key:"applyClientStateToServer",value:function(e){var t=this;if(this.state.syncToServerInProgress)pp.logger.info("Meeting:muteState#applyClientStateToServer --\x3e ".concat(this.type,": request to server in progress, we need to wait for it to complete"));else{var r=this.getClientLocalMuteState(),n=r!==this.state.server.localMute,i=!r&&this.state.server.remoteMute;if(pp.logger.info("Meeting:muteState#applyClientStateToServer --\x3e ".concat(this.type,": localMuteRequiresSync: ").concat(n," (").concat(r," ?= ").concat(this.state.server.localMute,")")),pp.logger.info("Meeting:muteState#applyClientStateToServer --\x3e ".concat(this.type,": remoteMuteRequiresSync: ").concat(i)),n||i)this.state.syncToServerInProgress=!0,(n?this.sendLocalMuteRequestToServer(e):P().resolve()).then((function(){return i?t.sendRemoteMuteRequestToServer(e):P().resolve()})).then((function(){t.state.syncToServerInProgress=!1,pp.logger.info("Meeting:muteState#applyClientStateToServer --\x3e ".concat(t.type,": sync with server completed")),t.applyClientStateToServer(e)})).catch((function(r){t.state.syncToServerInProgress=!1,pp.logger.warn("Meeting:muteState#applyClientStateToServer --\x3e ".concat(t.type,": error: ").concat(r)),t.applyServerMuteToLocalStream(e,"clientRequestFailed")}));else pp.logger.info("Meeting:muteState#applyClientStateToServer --\x3e ".concat(this.type,": client state already matching server state, nothing to do"))}}},{key:"sendLocalMuteRequestToServer",value:function(e){var t=this,r=this.type===Ep?this.getClientLocalMuteState():void 0,n=this.type===gm?this.getClientLocalMuteState():void 0;return pp.logger.info("Meeting:muteState#sendLocalMuteRequestToServer --\x3e ".concat(this.type,": sending local mute (audio=").concat(r,", video=").concat(n,") to server")),eb.remoteUpdateAudioVideo(e,r,n).then((function(i){return pp.logger.info("Meeting:muteState#sendLocalMuteRequestToServer --\x3e ".concat(t.type,": local mute (audio=").concat(r,", video=").concat(n,") applied to server")),t.state.server.localMute=t.type===Ep?r:n,i&&e.locusInfo.handleLocusDelta(i,e),i})).catch((function(e){return pp.logger.warn("Meeting:muteState#sendLocalMuteRequestToServer --\x3e ".concat(t.type,": failed to apply local mute (audio=").concat(r,", video=").concat(n,") to server: ").concat(e)),P().reject(e)}))}},{key:"sendRemoteMuteRequestToServer",value:function(e){var t=this,r=this.getClientLocalMuteState();return pp.logger.info("Meeting:muteState#sendRemoteMuteRequestToServer --\x3e ".concat(this.type,": sending remote mute:").concat(r," to server")),e.members.muteMember(e.members.selfId,r,this.type===Ep).then((function(){pp.logger.info("Meeting:muteState#sendRemoteMuteRequestToServer --\x3e ".concat(t.type,": remote mute:").concat(r," applied to server")),t.state.server.remoteMute=r})).catch((function(e){return pp.logger.warn("Meeting:muteState#sendRemoteMuteRequestToServer --\x3e ".concat(t.type,": failed to apply remote mute ").concat(r," to server: ").concat(e)),P().reject(e)}))}},{key:"applyServerMuteToLocalStream",value:function(e,t){var r=this.state.server.localMute||this.state.server.remoteMute;this.muteLocalStream(e,r,t)}},{key:"applyUnmuteAllowedToStream",value:function(e){var t,r;this.type===Ep?null===(t=e.mediaProperties.audioStream)||void 0===t||t.setUnmuteAllowed(this.state.server.unmuteAllowed):null===(r=e.mediaProperties.videoStream)||void 0===r||r.setUnmuteAllowed(this.state.server.unmuteAllowed)}},{key:"handleServerRemoteMuteUpdate",value:function(e,t,r){pp.logger.info("Meeting:muteState#handleServerRemoteMuteUpdate --\x3e ".concat(this.type,": updating server remoteMute to (").concat(t,")")),void 0!==r&&(this.state.server.unmuteAllowed=r,this.applyUnmuteAllowedToStream(e)),void 0!==t&&(this.state.server.remoteMute=t,this.applyServerMuteToLocalStream(e,"remotelyMuted"))}},{key:"handleServerLocalUnmuteRequired",value:function(e){this.state.client.enabled?pp.logger.info("Meeting:muteState#handleServerLocalUnmuteRequired --\x3e ".concat(this.type,": localAudioUnmuteRequired received -> doing local unmute")):pp.logger.warn("Meeting:muteState#handleServerLocalUnmuteRequired --\x3e ".concat(this.type,": localAudioUnmuteRequired received while ").concat(this.type," is disabled -> local unmute will not result in ").concat(this.type," being sent")),this.state.server.remoteMute=!1,this.state.client.localMute=!1,this.applyClientStateLocally(e,"localUnmuteRequired"),this.applyClientStateToServer(e)}},{key:"isMuted",value:function(){return this.state.client.localMute||this.state.server.localMute||this.state.server.remoteMute}},{key:"isRemotelyMuted",value:function(){return this.state.server.remoteMute}},{key:"isUnmuteAllowed",value:function(){return this.state.server.unmuteAllowed}},{key:"isLocallyMuted",value:function(){return this.getClientLocalMuteState()}}]),e}(),sS=r(63706),aS=r.n(sS),cS=r(43562),uS=r.n(cS);function lS(e,t){var r=U()(e);if(p()){var n=p()(e);t&&(n=n.filter((function(t){return g()(e,t).enumerable}))),r.push.apply(r,n)}return r}function dS(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?lS(Object(r),!0).forEach((function(t){(0,R.Z)(e,t,r[t])})):y()?E()(e,y()(r)):lS(Object(r)).forEach((function(t){S()(e,t,g()(r,t))}))}return e}var hS={parse:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={policy:hS.parsePolicy(e),moderator:hS.parseModerator(e),coHost:hS.parseCoHost(e)},i=dS({},r?n.policy:Object.fromEntries(uS()(n.policy).filter((function(e){var t=(0,xy.Z)(e,1)[0];return gv.includes(t)}))));return t.includes(vv.COHOST)&&(i=dS(dS({},i),n.coHost)),t.includes(vv.MODERATOR)&&(i=dS(dS({},i),n.moderator)),n.userDisplayHints=U()(i),e.sipUri&&(n.sipUri=e.sipUri),e.meetingId&&(n.meetingNumber=e.meetingId),e.datachannelUrl&&(n.datachannelUrl=e.datachannelUrl),n},parseDisplayHintSection:function(e,t){var r={};return e&&e.displayHints&&e.displayHints[t]&&e.displayHints[t].length>0&&e.displayHints[t].forEach((function(e){r[e]=!0})),r},parsePolicy:function(e){return hS.parseDisplayHintSection(e,"joined")},parseModerator:function(e){return dS(dS({},hS.parseDisplayHintSection(e,"moderator")),{},(0,R.Z)({},mv.LOWER_SOMEONE_ELSES_HAND,!0))},parseCoHost:function(e){return dS(dS({},hS.parseDisplayHintSection(e,"coHost")),{},(0,R.Z)({},mv.LOWER_SOMEONE_ELSES_HAND,!0))},isLocked:function(e){return e.LOCK_STATUS_LOCKED||!1},isUnlocked:function(e){return e.LOCK_STATUS_UNLOCKED||!1},getInfos:function(e,t,r,n){var i=null;e&&(i=e);var o=t&&hS.parse(t,r,n),s={};return o&&(o.isLocked=hS.isLocked(o.policy),o.isUnlocked=hS.isUnlocked(o.policy),(i&&i.isUnlocked&&o.isLocked||!i&&o.isLocked)&&(s.isLocked=o.isLocked),(i&&i.isLocked&&o.isUnlocked||!i&&o.isUnlocked)&&(s.isUnlocked=o.isUnlocked)),{previous:i,current:o,updates:s}}};const fS=hS;var pS={parse:function(e){return{type:e.type||ev.UNKNOWN,meetingState:e.state,locked:e.locked}},getFullState:function(e,t){var r=e&&pS.parse(e),n=t&&pS.parse(t);return{previous:r,current:n,updates:{isMeetingEnded:pS.isMeetingEnded(r,n),isMeetingTerminating:pS.isMeetingTerminating(r,n),meetingTypeChangedTo:pS.isTypeChanged(r,n),meetingStateChangedTo:pS.meetingStateChange(r,n)}}},isMeetingEnded:function(e,t){return!(t.state!==ev.INACTIVE||!e||e.state!==ev.ACTIVE&&e.state!==ev.INITIALIZING&&e.state!==ev.TERMINATING)},isMeetingTerminating:function(e,t){return!(t.state!==ev.TERMINATING||!e||e.state!==ev.ACTIVE&&e.state!==ev.INITIALIZING)},isTypeChanged:function(e,t){return e&&t.type===e.type?null:t&&t.type},meetingStateChange:function(e,t){return e&&t.meetingState===e.meetingState?null:t&&t.meetingState}};const mS=pS;var gS={};gS.parse=function(e,t){if(e){var r,n=e.devices.find((function(e){return t===e.url})),i=e.devices.filter((function(e){return"PROVISIONAL"===e.deviceType}));return{remoteVideoMuted:gS.getRemoteVideoMuted(e),remoteMuted:gS.getRemoteMuted(e),unmuteAllowed:gS.getUnmuteAllowed(e),localAudioUnmuteRequested:gS.getLocalAudioUnmuteRequested(e),localAudioUnmuteRequestedTimeStamp:gS.getLocalAudioUnmuteRequestedTimeStamp(e),localAudioUnmuteRequired:gS.getLocalAudioUnmuteRequired(e),lastModified:gS.getLastModified(e),modifiedBy:gS.getModifiedBy(e),guest:e.guest,moderator:e.moderator,mediaStatus:gS.getStatus(e.status),state:e.state,joinedWith:n,pstnDevices:i,currentMediaStatus:gS.getMediaStatus(null==n?void 0:n.mediaSessions),creator:e.isCreator,selfId:e.id,selfIdentity:gS.getSelfIdentity(e),selfUrl:e.url,removed:e.removed,roles:gS.getRoles(e),isUserUnadmitted:e.state===Im&&(null==n||null===(r=n.intent)||void 0===r?void 0:r.type)===ug,layout:gS.getLayout(e),canNotViewTheParticipantList:gS.canNotViewTheParticipantList(e),isSharingBlocked:gS.isSharingBlocked(e),breakoutSessions:gS.getBreakoutSessions(e),breakout:gS.getBreakout(e),interpretation:gS.getInterpretation(e)}}return null},gS.getBreakoutSessions=function(e){var t,r;return null==e||null===(t=e.controls)||void 0===t||null===(r=t.breakout)||void 0===r?void 0:r.sessions},gS.getBreakout=function(e){var t;return null==e||null===(t=e.controls)||void 0===t?void 0:t.breakout},gS.getInterpretation=function(e){var t;return null==e||null===(t=e.controls)||void 0===t?void 0:t.interpretation},gS.getLayout=function(e){var t;return Ty()(null==e||null===(t=e.controls)||void 0===t?void 0:t.layouts)?e.controls.layouts[0].type:void 0},gS.getRoles=function(e){var t,r;return((null==e||null===(t=e.controls)||void 0===t||null===(r=t.role)||void 0===r?void 0:r.roles)||[]).reduce((function(e,t){return t.hasRole&&e.push(t.type),e}),[])},gS.canNotViewTheParticipantList=function(e){return!(null==e||!e.canNotViewTheParticipantList)},gS.isSharingBlocked=function(e){return!(null==e||!e.isSharingBlocked)},gS.getSelves=function(e,t,r){var n=e&&gS.parse(e,r),i=t&&gS.parse(t,r),o={};return o.isUserUnadmitted=gS.isUserUnadmitted(i),o.isUserAdmitted=gS.isUserAdmitted(n,i),o.isVideoMutedByOthersChanged=gS.videoMutedByOthersChanged(n,i),o.isMutedByOthersChanged=gS.mutedByOthersChanged(n,i),o.localAudioUnmuteRequestedByServer=gS.localAudioUnmuteRequestedByServer(n,i),o.localAudioUnmuteRequiredByServer=gS.localAudioUnmuteRequiredByServer(n,i),o.moderatorChanged=gS.moderatorChanged(n,i),o.isRolesChanged=gS.isRolesChanged(n,i),o.isMediaInactiveOrReleased=gS.wasMediaInactiveOrReleased(n,i),o.isUserObserving=gS.isDeviceObserving(n,i),o.layoutChanged=gS.layoutChanged(n,i),o.isMediaInactive=gS.isMediaInactive(n,i),o.audioStateChange=(null==n?void 0:n.currentMediaStatus.audio)!==i.currentMediaStatus.audio,o.videoStateChange=(null==n?void 0:n.currentMediaStatus.video)!==i.currentMediaStatus.video,o.shareStateChange=(null==n?void 0:n.currentMediaStatus.share)!==i.currentMediaStatus.share,o.canNotViewTheParticipantListChanged=(null==n?void 0:n.canNotViewTheParticipantList)!==i.canNotViewTheParticipantList,o.isSharingBlockedChanged=(null==n?void 0:n.isSharingBlocked)!==i.isSharingBlocked,o.breakoutsChanged=gS.breakoutsChanged(n,i),o.interpretationChanged=gS.interpretationChanged(n,i),{previous:n,current:i,updates:o}},gS.isJoined=function(e){return(null==e?void 0:e.state)===Lm},gS.layoutChanged=function(e,t){return(null==t?void 0:t.layout)&&(null==e?void 0:e.layout)!==(null==t?void 0:t.layout)},gS.breakoutsChanged=function(e,t){return!zE()(null==e?void 0:e.breakoutSessions,null==t?void 0:t.breakoutSessions)&&!(null==t||!t.breakout)},gS.interpretationChanged=function(e,t){return!zE()(null==e?void 0:e.interpretation,null==t?void 0:t.interpretation)&&!(null==t||!t.interpretation)},gS.isMediaInactive=function(e,t){if(e&&e.joinedWith&&e.joinedWith.mediaSessions&&t&&t.joinedWith&&t.joinedWith.mediaSessions){var r=gS.getMediaStatus(e.joinedWith.mediaSessions),n=gS.getMediaStatus(t.joinedWith.mediaSessions);return!(!r.audio||!n.audio||r.audio.state===Yg.inactive||n.audio.state!==Yg.inactive||n.audio.direction===Yg.inactive)||(!(!r.video||!n.video||r.video.state===Yg.inactive||n.video.state!==Yg.inactive||n.video.direction===Yg.inactive)||!(!r.share||!n.share||r.share.state===Yg.inactive||n.share.state!==Yg.inactive||n.share.direction===Yg.inactive))}return!1},gS.getLastModified=function(e){return e&&e.controls&&e.controls.audio&&e.controls.audio.meta&&e.controls.audio.meta.lastModified?e.controls.audio.meta.lastModified:null},gS.getModifiedBy=function(e){return e&&e.controls&&e.controls.audio&&e.controls.audio.meta&&e.controls.audio.meta.modifiedBy?e.controls.audio.meta.modifiedBy:null},gS.getSelfIdentity=function(e){return e||e.person?e.person.id:null},gS.getRemoteVideoMuted=function(e){return e&&e.controls&&e.controls.video?e.controls.video.muted:null},gS.getRemoteMuted=function(e){return e&&e.controls&&e.controls.audio?e.controls.audio.muted:null},gS.getLocalAudioUnmuteRequested=function(e){var t,r;return!(null==e||null===(t=e.controls)||void 0===t||null===(r=t.audio)||void 0===r||!r.requestedToUnmute)},gS.getLocalAudioUnmuteRequestedTimeStamp=function(e){var t,r;return Date.parse(null==e||null===(t=e.controls)||void 0===t||null===(r=t.audio)||void 0===r?void 0:r.lastModifiedRequestedToUnmute)||0},gS.getUnmuteAllowed=function(e){return e&&e.controls&&e.controls.audio?!e.controls.audio.disallowUnmute:null},gS.getLocalAudioUnmuteRequired=function(e){var t,r;return!(null==e||null===(t=e.controls)||void 0===t||null===(r=t.audio)||void 0===r||!r.localAudioUnmuteRequired)},gS.getStatus=function(e){return{audio:e.audioStatus,video:e.videoStatus,slides:e.videoSlidesStatus}},gS.wasMediaInactiveOrReleased=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return e.joinedWith&&e.joinedWith.state===Lm&&t.joinedWith&&t.joinedWith.state===Mm&&(t.joinedWith.reason===fv.INACTIVE||t.joinedWith.reason===fv.MEDIA_RELEASED)},gS.isLocusUserUnadmitted=function(e){var t,r;return e&&(null===(t=e.joinedWith)||void 0===t||null===(r=t.intent)||void 0===r?void 0:r.type)===ug&&e.state===Im},gS.isLocusUserAdmitted=function(e){var t,r;return e&&(null===(t=e.joinedWith)||void 0===t||null===(r=t.intent)||void 0===r?void 0:r.type)!==ug&&e.state===Lm},gS.isUserUnadmitted=function(e){if(!e)throw new zv("self must be defined to determine if self is unadmitted as guest.");return gS.isLocusUserUnadmitted(e)},gS.moderatorChanged=function(e,t){if(!e)return!0;if(!t)throw new zv("New self must be defined to determine if self transitioned moderator status.");return e.moderator!==t.moderator},gS.isRolesChanged=function(e,t){return!!t&&!zE()(null==e?void 0:e.roles,null==t?void 0:t.roles)},gS.isDeviceObserving=function(e,t){var r,n,i,o;return e&&(null===(r=e.joinedWith)||void 0===r||null===(n=r.intent)||void 0===n?void 0:n.type)===lg&&t&&(null===(i=t.joinedWith)||void 0===i||null===(o=i.intent)||void 0===o?void 0:o.type)===$m},gS.isUserAdmitted=function(e,t){if(!e)return!1;if(!t)throw new zv("New self must be defined to determine if self transitioned to admitted as guest.");return gS.isLocusUserUnadmitted(e)&&gS.isLocusUserAdmitted(t)},gS.videoMutedByOthersChanged=function(e,t){if(!t)throw new zv("New self must be defined to determine if self was video muted by others.");return e&&null!==e.remoteVideoMuted?e.remoteVideoMuted!==t.remoteVideoMuted:!!t.remoteVideoMuted},gS.mutedByOthersChanged=function(e,t){if(!t)throw new zv("New self must be defined to determine if self was muted by others.");return e&&null!==e.remoteMuted?null!==t.remoteMuted&&(e.remoteMuted!==t.remoteMuted||t.remoteMuted&&e.unmuteAllowed!==t.unmuteAllowed):!!t.remoteMuted},gS.localAudioUnmuteRequestedByServer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(!t)throw new zv("New self must be defined to determine if self received request to unmute.");return t.localAudioUnmuteRequested&&t.localAudioUnmuteRequestedTimeStamp>e.localAudioUnmuteRequestedTimeStamp},gS.localAudioUnmuteRequiredByServer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(!t)throw new zv("New self must be defined to determine if localAudioUnmuteRequired changed.");return!t.remoteMuted&&t.localAudioUnmuteRequired&&e.localAudioUnmuteRequired!==t.localAudioUnmuteRequired},gS.getSipUrl=function(e,t,r){return e&&t===wm?{sipUri:e.person.sipUrl||e.person.id}:{sipUri:r}},gS.getMediaStatus=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t={audio:{},video:{},share:{}};return t.audio=e.find((function(e){return e.mediaType===Ep&&e.mediaContent===Iv.main})),t.video=e.find((function(e){return e.mediaType===gm&&e.mediaContent===Iv.main})),t.share=e.find((function(e){return e.mediaType===gm&&e.mediaContent===Iv.slides})),t},gS.getReplacedBreakoutMoveId=function(e,t){if(e&&Ty()(e.devices)){var r,n=e.devices.find((function(e){return t===e.url}));if(Ty()(null==n?void 0:n.replaces))return null===(r=n.replaces[0])||void 0===r?void 0:r.breakoutMoveId}return null};const vS=gS;var yS={parse:function(e){return e?{hostId:yS.getId(e)}:null},getHosts:function(e,t){var r=e&&yS.parse(e),n=t&&yS.parse(t);return{previous:r,current:n,updates:{isNewHost:!r||!n||yS.isDifferentHosts(r.hostId,n.hostId)}}},isDifferentHosts:function(e,t){return e!==t},getId:function(e){return e?e.id:null}};const bS=yS;function ES(e,t){var r=U()(e);if(p()){var n=p()(e);t&&(n=n.filter((function(t){return g()(e,t).enumerable}))),r.push.apply(r,n)}return r}var wS={};wS.parse=function(e){var t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ES(Object(r),!0).forEach((function(t){(0,R.Z)(e,t,r[t])})):y()?E()(e,y()(r)):ES(Object(r)).forEach((function(t){S()(e,t,g()(r,t))}))}return e}({},e);return e&&e.record&&(t.record={modifiedBy:wS.getId(e),paused:!!e.record.paused&&e.record.paused,recording:e.record.recording,lastModified:e.record.meta.lastModified}),e&&e.meetingContainer&&(t.meetingContainer={meetingContainerUrl:e.meetingContainer.meetingContainerUrl}),e&&e.transcribe&&(t.transcribe={transcribing:e.transcribe.transcribing,caption:e.transcribe.caption}),e&&e.entryExitTone&&(t.entryExitTone=e.entryExitTone.enabled?e.entryExitTone.mode:null),e&&e.video&&(t.videoEnabled=e.video.enabled),null!=e&&e.muteOnEntry&&(t.muteOnEntry={enabled:e.muteOnEntry.enabled}),null!=e&&e.shareControl&&(t.shareControl={control:e.shareControl.control}),null!=e&&e.disallowUnmute&&(t.disallowUnmute={enabled:e.disallowUnmute.enabled}),null!=e&&e.reactions&&(t.reactions={enabled:e.reactions.enabled,showDisplayNameWithReactions:e.reactions.showDisplayNameWithReactions}),null!=e&&e.viewTheParticipantList&&(t.viewTheParticipantList={enabled:e.viewTheParticipantList.enabled}),null!=e&&e.raiseHand&&(t.raiseHand={enabled:e.raiseHand.enabled}),null!=e&&e.video&&(t.video={enabled:e.video.enabled}),t},wS.getControls=function(e,t){var r,n,i,o,s,a,c,u,l,d,h,f,p,m,g,v,y,b,E,w,S,_,T,x,A,I,C,R,k,O,N=wS.parse(e),P=wS.parse(t);return{previous:N,current:P,updates:{hasMuteOnEntryChanged:(null==P||null===(r=P.muteOnEntry)||void 0===r?void 0:r.enabled)!==(null==N||null===(n=N.muteOnEntry)||void 0===n?void 0:n.enabled),hasShareControlChanged:(null==P||null===(i=P.shareControl)||void 0===i?void 0:i.control)!==(null==N||null===(o=N.shareControl)||void 0===o?void 0:o.control),hasDisallowUnmuteChanged:(null==P||null===(s=P.disallowUnmute)||void 0===s?void 0:s.enabled)!==(null==N||null===(a=N.disallowUnmute)||void 0===a?void 0:a.enabled),hasReactionsChanged:(null==P||null===(c=P.reactions)||void 0===c?void 0:c.enabled)!==(null==N||null===(u=N.reactions)||void 0===u?void 0:u.enabled),hasReactionDisplayNamesChanged:(null==P||null===(l=P.reactions)||void 0===l?void 0:l.showDisplayNameWithReactions)!==(null==N||null===(d=N.reactions)||void 0===d?void 0:d.showDisplayNameWithReactions),hasViewTheParticipantListChanged:(null==P||null===(h=P.viewTheParticipantList)||void 0===h?void 0:h.enabled)!==(null==N||null===(f=N.viewTheParticipantList)||void 0===f?void 0:f.enabled),hasRaiseHandChanged:(null==P||null===(p=P.raiseHand)||void 0===p?void 0:p.enabled)!==(null==N||null===(m=N.raiseHand)||void 0===m?void 0:m.enabled),hasVideoChanged:(null==P||null===(g=P.video)||void 0===g?void 0:g.enabled)!==(null==N||null===(v=N.video)||void 0===v?void 0:v.enabled),hasRecordingPausedChanged:(null==P?void 0:P.record)&&!zE()(null==N||null===(y=N.record)||void 0===y?void 0:y.paused,P.record.paused)&&((null==N||null===(b=N.record)||void 0===b?void 0:b.recording)||(null==P||null===(E=P.record)||void 0===E?void 0:E.recording)),hasRecordingChanged:(null==P?void 0:P.record)&&!zE()(null==N||null===(w=N.record)||void 0===w?void 0:w.recording,null==P||null===(S=P.record)||void 0===S?void 0:S.recording)&&((null==N||null===(_=N.record)||void 0===_?void 0:_.recording)||(null==P||null===(T=P.record)||void 0===T?void 0:T.recording)),hasMeetingContainerChanged:(null==P?void 0:P.meetingContainer)&&!zE()(null==N||null===(x=N.meetingContainer)||void 0===x?void 0:x.meetingContainerUrl,null==P||null===(A=P.meetingContainer)||void 0===A?void 0:A.meetingContainerUrl),hasTranscribeChanged:(null==P?void 0:P.transcribe)&&!zE()(null==N||null===(I=N.transcribe)||void 0===I?void 0:I.transcribing,null==P||null===(C=P.transcribe)||void 0===C?void 0:C.transcribing)&&((null==N||null===(R=N.transcribe)||void 0===R?void 0:R.transcribing)||(null==P||null===(k=P.transcribe)||void 0===k?void 0:k.transcribing)),hasEntryExitToneChanged:!(!t.entryExitTone||zE()(null==N?void 0:N.entryExitTone,null==P?void 0:P.entryExitTone)||!(null!=N&&N.entryExitTone||null!=P&&P.entryExitTone)),hasBreakoutChanged:!zE()(null==N?void 0:N.breakout,null==P?void 0:P.breakout),hasInterpretationChanged:!zE()(null==N?void 0:N.interpretation,null==P?void 0:P.interpretation),hasVideoEnabledChanged:void 0!==(null===(O=t.video)||void 0===O?void 0:O.enabled)&&!zE()(null==N?void 0:N.videoEnabled,null==P?void 0:P.videoEnabled)}}},wS.getId=function(e){return e.record.meta?e.record.meta.modifiedBy:null},wS.isNeedReplaceMembers=function(e,t){return!(null==e||!e.breakout||null==t||!t.breakout)&&(e.breakout.groupId!==t.breakout.groupId||e.breakout.sessionId!==t.breakout.sessionId)},wS.getSessionSwitchStatus=function(e,t){var r={isReturnToMain:!1,isJoinToBreakout:!1};return null!=e&&e.breakout&&null!=t&&t.breakout?(r.isReturnToMain=e.breakout.sessionType===av.SESSION_TYPES.BREAKOUT&&t.breakout.sessionType===av.SESSION_TYPES.MAIN,r.isJoinToBreakout=e.breakout.sessionType===av.SESSION_TYPES.MAIN&&t.breakout.sessionType===av.SESSION_TYPES.BREAKOUT,r):r},wS.isMainSessionDTO=function(e){var t,r;return(null==e||null===(t=e.controls)||void 0===t||null===(r=t.breakout)||void 0===r?void 0:r.sessionType)!==av.SESSION_TYPES.BREAKOUT};const SS=wS;function _S(e,t){var r=U()(e);if(p()){var n=p()(e);t&&(n=n.filter((function(t){return g()(e,t).enumerable}))),r.push.apply(r,n)}return r}var TS={},xS=/.sli.do\//;TS.parseApp=function(e){var t,r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_S(Object(r),!0).forEach((function(t){(0,R.Z)(e,t,r[t])})):y()?E()(e,y()(r)):_S(Object(r)).forEach((function(t){S()(e,t,g()(r,t))}))}return e}({},e);r.type=jv.OTHER;var n=null===(t=r.instanceInfo)||void 0===t?void 0:t.appInstanceUrl;return n&&n.match(xS)&&(r.type=jv.SLIDO),r},TS.areSimilar=function(e,t){if(!e||!t)return e===t;if((null==e?void 0:e.length)!==(null==t?void 0:t.length))return!1;for(var r=0;r<e.length;r+=1)if(e[r].state!==t[r].state)return!1;return!0},TS.parse=function(e){return e&&e.map(TS.parseApp)};const AS=TS;var IS={parse:function(e){return e?{content:{beneficiaryId:IS.getContentBeneficiaryId(e),disposition:IS.getContentDisposition(e),annotation:IS.getContentAnnotation(e),url:IS.getContentUrl(e),shareInstanceId:IS.getShareInstanceId(e),deviceUrlSharing:IS.getContentBeneficiaryDeviceUrl(e)},whiteboard:{beneficiaryId:IS.getWhiteboardBeneficiaryId(e),disposition:IS.getWhiteboardDisposition(e),resourceUrl:IS.getWhiteboardResourceUrl(e)}}:null},getMediaShares:function(e,t){return{previous:e&&IS.parse(e),current:t&&IS.parse(t)}},getContentDisposition:function(e){var t=IS.extractContentFloor(e);return t?t.disposition:null},getWhiteboardDisposition:function(e){var t=IS.extractWhiteboardFloor(e);return t?t.disposition:null},extractContent:function(e){return e&&e.length&&e.find((function(e){return e.name===Lp}))||null},extractWhiteboard:function(e){return e&&e.length&&e.find((function(e){return e.name===Mp}))||null},extractFloor:function(e){return e?e.floor:null},extractContentFloor:function(e){var t=IS.extractContent(e);return IS.extractFloor(t)},extractWhiteboardFloor:function(e){var t=IS.extractWhiteboard(e);return IS.extractFloor(t)},getContentBeneficiaryId:function(e){var t=IS.extractContentFloor(e);return t&&t.beneficiary?t.beneficiary.id:null},getContentAnnotation:function(e){var t=IS.extractContent(e);if(t&&t.annotation)return t.annotation},getContentUrl:function(e){var t=IS.extractContent(e);if(t&&t.url)return t.url},getShareInstanceId:function(e){var t=IS.extractContent(e);if(t&&t.floor&&t.floor.shareInstanceId)return t.floor.shareInstanceId},getContentBeneficiaryDeviceUrl:function(e){var t=IS.extractContentFloor(e);return t&&t.beneficiary&&t.beneficiary.deviceUrl?t.beneficiary.deviceUrl:null},getWhiteboardBeneficiaryId:function(e){var t=IS.extractWhiteboardFloor(e);return t&&t.beneficiary?t.beneficiary.id:null},getWhiteboardResourceUrl:function(e){var t=IS.extractWhiteboard(e);return t&&t.resourceUrl?t.resourceUrl:null}};const CS=IS;var RS=r(36759),kS=r(99848);function OS(e,t){return t||(t=e.slice(0)),RS(kS(e,{raw:{value:RS(t)}}))}var NS,PS,LS,DS,MS,US,BS,FS,jS,VS,HS=function(){function e(t){(0,k.Z)(this,e),(0,R.Z)(this,"queue",void 0),(0,R.Z)(this,"compareFunc",void 0),this.queue=[],this.compareFunc=t}return(0,O.Z)(e,[{key:"clear",value:function(){this.queue=[]}},{key:"enqueue",value:function(e){var t=this,r=this.queue.findIndex((function(r){return t.compareFunc(r,e)>=0}));r>=0?this.queue.splice(r,0,e):this.queue.push(e)}},{key:"dequeue",value:function(){return 0===this.queue.length?null:this.queue.shift()}},{key:"size",value:function(){return this.queue.length}}]),e}(),GS=function(){function e(){(0,k.Z)(this,e),(0,R.Z)(this,"status",void 0),(0,R.Z)(this,"queue",void 0),(0,R.Z)(this,"workingCopy",void 0),(0,R.Z)(this,"syncTimer",void 0);this.queue=new HS((function(t,r){var n=e.loci,i=n.LT,o=n.GT,s=e.extractComparisonState;if(e.isSequenceEmpty(t))return-1;if(e.isSequenceEmpty(r))return 1;var a=s(e.compareSequence(t.baseSequence,r.baseSequence));return a===i?-1:a===o?1:0})),this.status="IDLE",this.onDeltaAction=null,this.workingCopy=null,this.syncTimer=void 0}return(0,O.Z)(e,[{key:"isNewFullLocus",value:function(t){return e.isLoci(t)?!this.workingCopy||e.compareFullDtoSequence(this.workingCopy,t)===e.loci.USE_INCOMING:(pp.logger.info("Locus-info:parser#isNewFullLocus --\x3e Ignoring non-locus object."),!1)}},{key:"isValidLocus",value:function(t){var r=!1,n=e.isLoci;return n(this.workingCopy)&&n(t)?r=!0:pp.logger.info("Locus-info:parser#processDeltaEvent --\x3e Ignoring non-locus object. workingCopy:",this.workingCopy,"newLoci:",t),r}},{key:"nextEvent",value:function(){"PAUSED"!==this.status?"BLOCKED"!==this.status?this.queue.size()>0?this.processDeltaEvent():this.status="IDLE":pp.logger.info("Locus-info:parser#nextEvent --\x3e Locus parser blocked by out-of-order delta."):pp.logger.info("Locus-info:parser#nextEvent --\x3e Locus parser paused.")}},{key:"onDeltaAction",value:function(e,t){}},{key:"onDeltaEvent",value:function(e){this.queue.enqueue(e),this.onDeltaAction&&("BLOCKED"===this.status?this.queue.size()>5?this.triggerSync("queue too big, blocked on out-of-order delta"):this.processDeltaEvent():"IDLE"===this.status&&(this.status="WORKING",this.processDeltaEvent()))}},{key:"pause",value:function(){this.status="PAUSED",pp.logger.info("Locus-info:parser#pause --\x3e Locus parser paused.")}},{key:"triggerSync",value:function(t){pp.logger.info("Locus-info:parser#triggerSync --\x3e doing sync, reason: ".concat(t)),this.stopSyncTimer(),this.pause(),this.onDeltaAction(e.loci.DESYNC,this.workingCopy)}},{key:"startSyncTimer",value:function(){var e=this;if(void 0===this.syncTimer){var t=1e4+5e3*Math.random();this.syncTimer=setTimeout((function(){e.syncTimer=void 0,e.triggerSync("timer expired, blocked on out-of-order delta")}),t)}}},{key:"stopSyncTimer",value:function(){void 0!==this.syncTimer&&(clearTimeout(this.syncTimer),this.syncTimer=void 0)}},{key:"processDeltaEvent",value:function(){var t=e.loci,r=t.DESYNC,n=t.USE_INCOMING,i=t.WAIT,o=t.LOCUS_URL_CHANGED,s=e.extractComparisonState,a=this.queue.dequeue();if(this.isValidLocus(a)){var c=e.compare(this.workingCopy,a),u=s(c);pp.logger.debug("Locus-info:parser#processDeltaEvent --\x3e Locus Debug: ".concat(c));var l=!1;switch(u){case r:this.pause();break;case n:case o:this.workingCopy=a;break;case i:this.queue.enqueue(a),l=!0}l?(this.status="BLOCKED",this.startSyncTimer()):(this.stopSyncTimer(),"BLOCKED"===this.status&&(this.status="WORKING",pp.logger.info("Locus-info:parser#processDeltaEvent --\x3e received delta that we were waiting for ".concat(e.locus2string(a),", not blocked anymore")))),this.onDeltaAction&&(pp.logger.info("Locus-info:parser#processDeltaEvent --\x3e Locus Delta ".concat(e.locus2string(a),", Action: ").concat(u)),this.onDeltaAction(u,a)),this.nextEvent()}else this.nextEvent()}},{key:"resume",value:function(){pp.logger.info("Locus-info:parser#resume --\x3e Locus parser resumed."),this.status="WORKING",this.nextEvent()}}],[{key:"locus2string",value:function(e){var t;return null!==(t=e.sequence)&&void 0!==t&&t.entries?e.sequence.entries.length?"seq=".concat(e.sequence.entries.at(-1)):"empty":"invalid"}},{key:"checkSequenceOverlap",value:function(t,r){var n=null;return t.min>r.max?n="".concat(e.loci.GT,":SO001"):t.max<r.min&&(n="".concat(e.loci.LT,":SO002")),n}},{key:"checkUnequalRanges",value:function(t,r){var n=null,i=0===t.unique.length,o=0===r.unique.length,s=t.end-t.min,a=r.end-r.min;return i&&o&&(n=s>a?"".concat(e.loci.GT,":UR001"):s<a?"".concat(e.loci.LT,":UR002"):"".concat(e.loci.EQ,":UR003")),n}},{key:"checkForUniqueEntries",value:function(t,r){var n=null,i=t.unique.length>0,o=r.unique.length>0;return i&&!o?n="".concat(e.loci.GT,":UE001"):!i&&o&&(n="".concat(e.loci.LT,":UE002")),n}},{key:"checkIfOutOfSync",value:function(t,r){var n=null,i=t.unique[0],o=r.unique[0],s=!t.start&&!t.end,a=!r.start&&!r.end,c=s&&a,u=function(e,t,r){return e.some((function(e){return t<e&&e<r}))},l=u(t.unique,r.min,r.max),d=u(r.unique,t.min,t.max);if(c||l||d){var h="".concat(+c,",").concat(+l,",").concat(+d);n="".concat(e.loci.DESYNC,":OOS001:").concat(h)}else n=i>o?"".concat(e.loci.GT,":OOS002"):"".concat(e.loci.LT,":OOS003");return n}},{key:"compare",value:function(t,r){var n=e.isSequenceEmpty,i=e.extractComparisonState,o=e.packComparisonResult;if(n(t)||n(r))return o(e.loci.USE_INCOMING,"C001");if(r.baseSequence)return o(e.compareDelta(t,r),"C002");var s=e.compareSequence(t.sequence,r.sequence);return o(e.compareToAction(i(s)),s)}},{key:"compareDelta",value:function(t,r){var n=e.loci,i=n.LT,o=n.GT,s=n.EQ,a=n.DESYNC,c=n.USE_INCOMING,u=n.WAIT,l=n.LOCUS_URL_CHANGED,d=e.extractComparisonState,h=e.packComparisonResult,f=e.compareSequence(t.sequence,r.sequence),p=d(f);if(p!==i)return h(e.compareToAction(p),f);if(r.url!==t.url)return h(l,f);switch(d(p=e.compareSequence(t.sequence,r.baseSequence))){case o:case s:p=c;break;case i:d(e.compareSequence(r.baseSequence,r.sequence))===s?p=a:(p=u,sp.sendBehavioralMetric(nE,{stack:(new Error).stack}));break;default:p=a}return h(p,f)}},{key:"compareFullDtoSequence",value:function(t,r){return e.isSequenceEmpty(t)||e.isSequenceEmpty(r)||r.sequence.entries.slice(-1)[0]>t.sequence.entries.slice(-1)[0]?e.loci.USE_INCOMING:e.loci.USE_CURRENT}},{key:"compareSequence",value:function(t,r){var n=e.getMetaData(t),i=e.getMetaData(r);n.unique=e.getUniqueSequences(n,i),i.unique=e.getUniqueSequences(i,n);for(var o=0,s=[e.checkSequenceOverlap,e.checkUnequalRanges,e.checkForUniqueEntries,e.checkIfOutOfSync];o<s.length;o++){var a=(0,s[o])(n,i);if(a)return a}return e.loci.ERROR}},{key:"compareToAction",value:function(t){var r=e.loci,n=r.DESYNC,i=r.EQ,o=r.ERROR,s=r.GT,a=r.LT,c=r.USE_CURRENT,u=r.USE_INCOMING,l=o;switch(t){case i:case s:l=c;break;case a:l=u;break;case n:l=n;break;default:pp.logger.info("Locus-info:parser#compareToAction --\x3e Error: ".concat(t," is not a recognized sequence comparison result."))}return l}},{key:"extractComparisonState",value:function(e){return e.split(":")[0]}},{key:"getMetaData",value:function(e){var t=e.entries,r=t[0],n=t.slice(-1)[0],i=e.rangeStart,o=e.rangeEnd;return{start:i,end:o,first:r,last:n,min:i||r,max:n||o,entries:t}}},{key:"getUniqueSequences",value:function(t,r){var n=IE()(t.entries,r.entries),i=r.start,o=r.end;return e.getNumbersOutOfRange(n,i,o)}},{key:"getNumbersOutOfRange",value:function(e,t,r){return e.filter((function(e){return e<t||e>r})).sort((function(e,t){return e-t}))}},{key:"isSequenceEmpty",value:function(e){var t,r=e.sequence,n=!(null!==(t=r.entries)&&void 0!==t&&t.length),i=0===r.rangeStart&&0===r.rangeEnd;return n&&i}},{key:"isLoci",value:function(e){if(!e||!e.sequence)return!1;var t=function(t){return Object.prototype.hasOwnProperty.call(e.sequence,t)};return!(!t("rangeStart")||!t("rangeEnd"))}},{key:"packComparisonResult",value:function(e,t){return"".concat(e,":").concat(t)}},{key:"getDebugMessage",value:function(t,r){var n=function(e){return e.join("").replace(/\s{2,}/g," ")},i={EQ:"".concat(e.loci.LT,": is equal (current == incoming)."),LT:"".concat(e.loci.LT,": choose right side (incoming)."),GT:"".concat(e.loci.GT,": choose left side (current).")},o={SO001:{title:"checkSequenceOverlap-001",description:n(NS||(NS=OS(["Occurs if earliest working copy sequence is more             recent than last incoming sequence."],["Occurs if earliest working copy sequence is more \\\n            recent than last incoming sequence."]))),logic:"current.min > incoming.max"},SO002:{title:"checkSequenceOverlap-002",description:n(PS||(PS=OS(["Occurs if last working copy sequence is before the           earliest incoming sequence."],["Occurs if last working copy sequence is before the \\\n          earliest incoming sequence."]))),logic:"current.max < incoming.min"},UR001:{title:"checkUnequalRanges-001",description:n(LS||(LS=OS(["Occurs if there are no unique values for both loci,           and the current working copy loci has a larger range."],["Occurs if there are no unique values for both loci, \\\n          and the current working copy loci has a larger range."]))),logic:"currentTotalRange > incomingTotalRange"},UR002:{title:"checkUnequalRanges-002",description:n(DS||(DS=OS(["Occurs if there are no unique values for both loci,           and the incoming delta loci has a larger range."],["Occurs if there are no unique values for both loci, \\\n          and the incoming delta loci has a larger range."]))),logic:"currentTotalRange < incomingTotalRange"},UR003:{title:"checkUnequalRanges-003",description:n(MS||(MS=OS(["Occurs if there are no unique values for both loci,           and with ranges either absent or of the same size, the sequences           are considered equal."],["Occurs if there are no unique values for both loci, \\\n          and with ranges either absent or of the same size, the sequences \\\n          are considered equal."]))),logic:"currentTotalRange == incomingTotalRange"},UE001:{title:"checkForUniqueEntries-001",description:n(US||(US=OS(["Occurs if current loci has unique entries and           incoming does not. Entries are considered unique if they           do not overlap with other Loci sequences or range values."],["Occurs if current loci has unique entries and \\\n          incoming does not. Entries are considered unique if they \\\n          do not overlap with other Loci sequences or range values."]))),logic:"currentIsUnique && !incomingIsUnique"},UE002:{title:"checkForUniqueEntries-002",description:n(BS||(BS=OS(["Occurs if current has no unique entries but           incoming does. Entries are considered unique if they           do not overlap with other Loci sequences or range values."],["Occurs if current has no unique entries but \\\n          incoming does. Entries are considered unique if they \\\n          do not overlap with other Loci sequences or range values."]))),logic:"!currentIsUnique && incomingIsUnique"},OOS001:{title:"checkIfOutOfSync-001",description:n(FS||(FS=OS(["Occurs if neither sequence has a range, or           if the current loci unique entries overlap the total range of the           incoming sequence, or if the incoming unique entries overlap           the total range of current sequence."],["Occurs if neither sequence has a range, or \\\n          if the current loci unique entries overlap the total range of the \\\n          incoming sequence, or if the incoming unique entries overlap \\\n          the total range of current sequence."]))),logic:"neitherSeqHasRange || currentUniqOverlap || incomingUniqOverlap"},OOS002:{title:"checkIfOutOfSync-002",description:n(jS||(jS=OS(["Occurs if the minimum value from sequences that are           unique to the current loci is greater than the minimum value from           sequences that are unique to the incoming loci."],["Occurs if the minimum value from sequences that are \\\n          unique to the current loci is greater than the minimum value from \\\n          sequences that are unique to the incoming loci."]))),logic:"currentUniqueMin > incomingUniqueMin"},OOS003:{title:"checkIfOutOfSync-003",description:n(VS||(VS=OS(["Occurs if none of the comparison rules applied.           It is a catch all."],["Occurs if none of the comparison rules applied. \\\n          It is a catch all."]))),logic:"else (catch all)"}}[t];return o.title="Debug: ".concat(o.title),o.resolution=i[r],o}}]),e}();function qS(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}(0,R.Z)(GS,"loci",{EQ:"EQUAL",GT:"GREATER_THAN",LT:"LESS_THAN",DESYNC:"DESYNC",USE_INCOMING:"USE_INCOMING",USE_CURRENT:"USE_CURRENT",WAIT:"WAIT",ERROR:"ERROR",LOCUS_URL_CHANGED:"LOCUS_URL_CHANGED"});var $S=function(e){(0,A.Z)(r,e);var t=qS(r);function r(e,n,i){var o;return(0,k.Z)(this,r),o=t.call(this),(0,R.Z)((0,x.Z)(o),"compareAndUpdateFlags",void 0),(0,R.Z)((0,x.Z)(o),"emitChange",void 0),(0,R.Z)((0,x.Z)(o),"locusParser",void 0),(0,R.Z)((0,x.Z)(o),"meetingId",void 0),(0,R.Z)((0,x.Z)(o),"parsedLocus",void 0),(0,R.Z)((0,x.Z)(o),"updateMeeting",void 0),(0,R.Z)((0,x.Z)(o),"webex",void 0),(0,R.Z)((0,x.Z)(o),"aclUrl",void 0),(0,R.Z)((0,x.Z)(o),"baseSequence",void 0),(0,R.Z)((0,x.Z)(o),"created",void 0),(0,R.Z)((0,x.Z)(o),"deltaParticipants",void 0),(0,R.Z)((0,x.Z)(o),"identities",void 0),(0,R.Z)((0,x.Z)(o),"membership",void 0),(0,R.Z)((0,x.Z)(o),"participants",void 0),(0,R.Z)((0,x.Z)(o),"participantsUrl",void 0),(0,R.Z)((0,x.Z)(o),"replaces",void 0),(0,R.Z)((0,x.Z)(o),"scheduledMeeting",void 0),(0,R.Z)((0,x.Z)(o),"sequence",void 0),(0,R.Z)((0,x.Z)(o),"controls",void 0),(0,R.Z)((0,x.Z)(o),"conversationUrl",void 0),(0,R.Z)((0,x.Z)(o),"embeddedApps",void 0),(0,R.Z)((0,x.Z)(o),"fullState",void 0),(0,R.Z)((0,x.Z)(o),"host",void 0),(0,R.Z)((0,x.Z)(o),"info",void 0),(0,R.Z)((0,x.Z)(o),"roles",void 0),(0,R.Z)((0,x.Z)(o),"mediaShares",void 0),(0,R.Z)((0,x.Z)(o),"replace",void 0),(0,R.Z)((0,x.Z)(o),"url",void 0),(0,R.Z)((0,x.Z)(o),"services",void 0),(0,R.Z)((0,x.Z)(o),"mainSessionLocusCache",void 0),o.parsedLocus={states:[]},o.webex=n,o.emitChange=!1,o.compareAndUpdateFlags={},o.meetingId=i,o.updateMeeting=e,o.locusParser=new GS,o}return(0,O.Z)(r,[{key:"doLocusSync",value:function(e){var t,r,n=this;this.locusParser.workingCopy.syncUrl?(r=this.locusParser.workingCopy.syncUrl,t=!0):(r=e.locusUrl,t=!1),pp.logger.info("Locus-info:index#doLocusSync --\x3e doing Locus sync (getting ".concat(t?"delta":"full"," DTO)")),e.meetingRequest.getLocusDTO({url:r}).catch((function(i){if(t)return pp.logger.info("Locus-info:index#doLocusSync --\x3e delta sync failed, falling back to full sync"),sp.sendBehavioralMetric(rE,{correlationId:e.correlationId,url:r,reason:i.message,errorName:i.name,stack:i.stack,code:i.code}),t=!1,e.meetingRequest.getLocusDTO({url:e.locusUrl}).catch((function(t){throw pp.logger.info("Locus-info:index#doLocusSync --\x3e fallback full sync failed, destroying the meeting"),n.webex.meetings.destroy(e,zg.LOCUS_DTO_SYNC_FAILED),t}));throw pp.logger.info("Locus-info:index#doLocusSync --\x3e fallback full sync failed, destroying the meeting"),n.webex.meetings.destroy(e,zg.LOCUS_DTO_SYNC_FAILED),i})).then((function(r){t?$E()(r.body)?pp.logger.info("Locus-info:index#doLocusSync --\x3e received empty body from syncUrl, so we already have latest Locus DTO"):e.locusInfo.handleLocusDelta(r.body,e):e.locusInfo.onFullLocus(r.body),n.locusParser.resume()}))}},{key:"applyLocusDeltaData",value:function(e,t,r){var n=GS.loci,i=n.DESYNC,o=n.USE_CURRENT,s=n.USE_INCOMING,a=n.WAIT,c=n.LOCUS_URL_CHANGED;switch(e){case s:r.locusInfo.onDeltaLocus(t);break;case o:case a:break;case i:case c:this.doLocusSync(r);break;default:pp.logger.info("Locus-info:index#applyLocusDeltaData --\x3e Unknown locus delta action: ".concat(e))}}},{key:"handleLocusDelta",value:function(e,t){var r=this;this.locusParser.onDeltaAction||(this.locusParser.onDeltaAction=function(e,n){r.applyLocusDeltaData(e,n,t)}),this.locusParser.onDeltaEvent(e)}},{key:"init",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.created=t.created||null,this.scheduledMeeting=t.meeting||null,this.participantsUrl=t.participantsUrl||null,this.replaces=t.replaces||null,this.aclUrl=t.aclUrl||null,this.baseSequence=t.baseSequence||null,this.sequence=t.sequence||null,this.membership=t.membership||null,this.identities=t.identities||null,this.participants=t.participants||null,this.deltaParticipants=[],this.updateLocusCache(t),this.updateParticipants(t.participants),this.updateConversationUrl(t.conversationUrl,t.info),this.updateControls(t.controls,t.self),this.updateLocusUrl(t.url),this.updateFullState(t.fullState),this.updateMeetingInfo(t.info),this.updateEmbeddedApps(t.embeddedApps),this.updateSelf(t.self,t.participants),this.updateHostInfo(t.host),this.updateMediaShares(t.mediaShares),this.updateServices(null===(e=t.links)||void 0===e?void 0:e.services)}},{key:"initialSetup",value:function(e){this.updateLocusCache(e),this.onFullLocus(e),this.emitChange=!0}},{key:"parse",value:function(e,t){var r=t.eventType,n=this.getTheLocusToUpdate(t.locus);switch(pp.logger.info("Locus-info:index#parse --\x3e received locus data: ".concat(r)),r){case lv.PARTICIPANT_JOIN:case lv.PARTICIPANT_LEFT:case lv.CONTROLS_UPDATED:case lv.PARTICIPANT_AUDIO_MUTED:case lv.PARTICIPANT_AUDIO_UNMUTED:case lv.PARTICIPANT_VIDEO_MUTED:case lv.PARTICIPANT_VIDEO_UNMUTED:case lv.SELF_CHANGED:case lv.PARTICIPANT_UPDATED:case lv.PARTICIPANT_CONTROLS_UPDATED:case lv.PARTICIPANT_ROLES_UPDATED:case lv.PARTICIPANT_DECLINED:case lv.FLOOR_GRANTED:case lv.FLOOR_RELEASED:this.onFullLocus(n,r);break;case lv.DIFFERENCE:default:this.handleLocusDelta(n,e)}}},{key:"emitScoped",value:function(e,t,r){return this.emit(e,t,r)}},{key:"onFullLocus",value:function(e,t){if(e||pp.logger.error("Locus-info:index#onFullLocus --\x3e object passed as argument was invalid, continuing."),this.locusParser.isNewFullLocus(e)){this.updateParticipantDeltas(e.participants),this.scheduledMeeting=e.meeting||null,this.participants=e.participants;var r=SS.isNeedReplaceMembers(this.controls,e.controls);this.updateLocusInfo(e),this.updateParticipants(e.participants,r),this.isMeetingActive(),this.handleOneOnOneEvent(t),this.updateEmbeddedApps(e.embeddedApps),this.locusParser.workingCopy=e}else pp.logger.info("Locus-info:index#onFullLocus --\x3e ignoring old full locus DTO, eventType=".concat(t))}},{key:"handleOneOnOneEvent",value:function(e){this.parsedLocus.fullState.type!==wm&&this.parsedLocus.fullState.type!==Xm||(e===lv.PARTICIPANT_DECLINED&&this.emitScoped({file:"locus-info",function:"handleOneonOneEvent"},Jg.REMOTE_RESPONSE,{remoteDeclined:!0,remoteAnswered:!1}),e===lv.PARTICIPANT_JOIN&&this.emitScoped({file:"locus-info",function:"handleOneonOneEvent"},Jg.REMOTE_RESPONSE,{remoteDeclined:!1,remoteAnswered:!0}))}},{key:"onDeltaLocus",value:function(e){var t=SS.isNeedReplaceMembers(this.controls,e.controls);this.updateLocusInfo(e),this.updateParticipants(e.participants,t),this.isMeetingActive()}},{key:"updateLocusInfo",value:function(e){var t,r,n;"MOVED"===(null===(t=e.self)||void 0===t?void 0:t.reason)&&"LEFT"===(null===(r=e.self)||void 0===r?void 0:r.state)||(this.updateControls(e.controls,e.self),this.updateConversationUrl(e.conversationUrl,e.info),this.updateCreated(e.created),this.updateFullState(e.fullState),this.updateHostInfo(e.host),this.updateMeetingInfo(e.info,e.self),this.updateMediaShares(e.mediaShares),this.updateParticipantsUrl(e.participantsUrl),this.updateReplace(e.replace),this.updateSelf(e.self,e.participants),this.updateLocusUrl(e.url),this.updateAclUrl(e.aclUrl),this.updateBasequence(e.baseSequence),this.updateSequence(e.sequence),this.updateMemberShip(e.membership),this.updateIdentifiers(e.identities),this.updateEmbeddedApps(e.embeddedApps),this.updateServices(null===(n=e.links)||void 0===n?void 0:n.services),this.compareAndUpdate())}},{key:"getLocusPartner",value:function(e,t){return e&&0!==e.length?e.find((function(r){return t&&r.identity!==t.identity&&(e.length<=2||r.type===sg&&!r.removed)}))||this.partner:null}},{key:"isMeetingActive",value:function(){if(this.parsedLocus.fullState.type===wm||this.parsedLocus.fullState.type===Xm){var e=this.getLocusPartner(this.participants,this.self);this.updateMeeting({partner:e}),this.fullState&&this.fullState.state===ov.STATE.INACTIVE?(pp.logger.warn("Locus-info:index#isMeetingActive --\x3e Call Ended, locus state is inactive."),this.webex.internal.newMetrics.submitClientEvent({name:"client.call.remote-ended",options:{meetingId:this.meetingId}}),this.emitScoped({file:"locus-info",function:"isMeetingActive"},Jg.DESTROY_MEETING,{reason:Kg.CALL_INACTIVE,shouldLeave:!1})):e.state!==yv.STATES.LEFT||!this.parsedLocus.self||this.parsedLocus.self.state!==yv.STATES.DECLINED&&this.parsedLocus.self.state!==yv.STATES.NOTIFIED&&this.parsedLocus.self.state!==yv.STATES.JOINED?!this.parsedLocus.self||this.parsedLocus.self.state!==yv.STATES.LEFT||e.state!==yv.STATES.LEFT&&e.state!==yv.STATES.DECLINED&&e.state!==yv.STATES.NOTIFIED&&e.state!==yv.STATES.IDLE||(this.webex.internal.newMetrics.submitClientEvent({name:"client.call.remote-ended",options:{meetingId:this.meetingId}}),this.emitScoped({file:"locus-info",function:"isMeetingActive"},Jg.DESTROY_MEETING,{reason:Kg.SELF_LEFT,shouldLeave:!1})):(this.webex.internal.newMetrics.submitClientEvent({name:"client.call.remote-ended",options:{meetingId:this.meetingId}}),this.emitScoped({file:"locus-info",function:"isMeetingActive"},Jg.DESTROY_MEETING,{reason:Kg.PARTNER_LEFT,shouldLeave:this.parsedLocus.self.joinedWith&&this.parsedLocus.self.joinedWith.state!==Mm}))}else this.parsedLocus.fullState.type===jm?!this.fullState||this.fullState.state!==ov.STATE.INACTIVE&&this.fullState.state!==ov.STATE.TERMINATING?this.fullState&&this.fullState.removed?(this.webex.internal.newMetrics.submitClientEvent({name:"client.call.remote-ended",options:{meetingId:this.meetingId}}),this.emitScoped({file:"locus-info",function:"isMeetingActive"},Jg.DESTROY_MEETING,{reason:zg.FULLSTATE_REMOVED,shouldLeave:!1})):this.parsedLocus.self&&this.parsedLocus.self.removed&&this.emitScoped({file:"locus-info",function:"isMeetingActive"},Jg.DESTROY_MEETING,{reason:zg.SELF_REMOVED,shouldLeave:!1}):(pp.logger.warn("Locus-info:index#isMeetingActive --\x3e Meeting is ending due to inactive or terminating"),this.webex.internal.newMetrics.submitClientEvent({name:"client.call.remote-ended",options:{meetingId:this.meetingId}}),this.emitScoped({file:"locus-info",function:"isMeetingActive"},Jg.DESTROY_MEETING,{reason:zg.MEETING_INACTIVE_TERMINATING,shouldLeave:!1})):pp.logger.warn("Locus-info:index#isMeetingActive --\x3e Meeting Type is unknown.")}},{key:"compareAndUpdate",value:function(){(this.compareAndUpdateFlags.compareSelfAndHost||this.compareAndUpdateFlags.compareHostAndSelf)&&this.compareSelfAndHost()}},{key:"compareSelfAndHost",value:function(){var e;this.parsedLocus.self.selfIdentity===(null===(e=this.parsedLocus.host)||void 0===e?void 0:e.hostId)&&this.parsedLocus.self.moderator?this.emitScoped({file:"locus-info",function:"compareSelfAndHost"},Jg.LOCUS_INFO_CAN_ASSIGN_HOST,{canAssignHost:!0}):this.emitScoped({file:"locus-info",function:"compareSelfAndHost"},Jg.LOCUS_INFO_CAN_ASSIGN_HOST,{canAssignHost:!1})}},{key:"updateParticipantDeltas",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.deltaParticipants=t.reduce((function(t,r){var n=function(e,t){return t.find((function(t){return t.person.id===e.person.id}))}(r,e.participants||[])||{},i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={audioStatus:e.audioStatus!==t.audioStatus,videoSlidesStatus:e.videoSlidesStatus!==t.videoSlidesStatus,videoStatus:e.videoStatus!==t.videoStatus};return U()(r).forEach((function(e){!0!==r[e]&&delete r[e]})),r}(n.status,r.status);return U()(i).length>0&&t.push({person:r.person,delta:i}),t}),[])}},{key:"updateParticipants",value:function(e,t){var r;this.emitScoped({file:"locus-info",function:"updateParticipants"},Jg.LOCUS_INFO_UPDATE_PARTICIPANTS,{participants:e,recordingId:this.parsedLocus.controls&&(null===(r=this.parsedLocus.controls.record)||void 0===r?void 0:r.modifiedBy),selfIdentity:this.parsedLocus.self&&this.parsedLocus.self.selfIdentity,selfId:this.parsedLocus.self&&this.parsedLocus.self.selfId,hostId:this.parsedLocus.host&&this.parsedLocus.host.hostId,isReplace:t})}},{key:"updateControls",value:function(e,t){if(e&&!zE()(this.controls,e)){this.parsedLocus.controls=SS.parse(e);var r=SS.getControls(this.controls,e),n=r.updates,i=n.hasRecordingChanged,o=n.hasRecordingPausedChanged,s=n.hasMeetingContainerChanged,a=n.hasTranscribeChanged,c=n.hasEntryExitToneChanged,u=n.hasBreakoutChanged,l=n.hasVideoEnabledChanged,d=n.hasMuteOnEntryChanged,h=n.hasShareControlChanged,f=n.hasDisallowUnmuteChanged,p=n.hasReactionsChanged,m=n.hasReactionDisplayNamesChanged,g=n.hasViewTheParticipantListChanged,v=n.hasRaiseHandChanged,y=n.hasVideoChanged,b=n.hasInterpretationChanged,E=r.current;if(d&&this.emitScoped({file:"locus-info",function:"updateControls"},uv.EVENTS.CONTROLS_MUTE_ON_ENTRY_CHANGED,{state:E.muteOnEntry}),h&&this.emitScoped({file:"locus-info",function:"updateControls"},uv.EVENTS.CONTROLS_SHARE_CONTROL_CHANGED,{state:E.shareControl}),f&&this.emitScoped({file:"locus-info",function:"updateControls"},uv.EVENTS.CONTROLS_DISALLOW_UNMUTE_CHANGED,{state:E.disallowUnmute}),(p||m)&&this.emitScoped({file:"locus-info",function:"updateControls"},uv.EVENTS.CONTROLS_REACTIONS_CHANGED,{state:E.reactions}),g&&this.emitScoped({file:"locus-info",function:"updateControls"},uv.EVENTS.CONTROLS_VIEW_THE_PARTICIPANTS_LIST_CHANGED,{state:E.viewTheParticipantList}),v&&this.emitScoped({file:"locus-info",function:"updateControls"},uv.EVENTS.CONTROLS_RAISE_HAND_CHANGED,{state:E.raiseHand}),y&&this.emitScoped({file:"locus-info",function:"updateControls"},uv.EVENTS.CONTROLS_VIDEO_CHANGED,{state:E.video}),i||o){var w=null;o?w=E.record.paused?Gg.PAUSED:E.record.recording?Gg.RESUMED:Gg.IDLE:i&&(w=E.record.recording?Gg.RECORDING:Gg.IDLE),this.emitScoped({file:"locus-info",function:"updateControls"},uv.EVENTS.CONTROLS_RECORDING_UPDATED,{state:w,modifiedBy:E.record.modifiedBy,lastModified:E.record.lastModified})}if(s){var S=E.meetingContainer.meetingContainerUrl;this.emitScoped({file:"locus-info",function:"updateControls"},uv.EVENTS.CONTROLS_MEETING_CONTAINER_UPDATED,{meetingContainerUrl:S})}if(a){var _=E.transcribe,T=_.transcribing,x=_.caption;this.emitScoped({file:"locus-info",function:"updateControls"},uv.EVENTS.CONTROLS_MEETING_TRANSCRIBE_UPDATED,{transcribing:T,caption:x})}if(u){var A=E.breakout;A.breakoutMoveId=vS.getReplacedBreakoutMoveId(t,this.webex.internal.device.url),this.emitScoped({file:"locus-info",function:"updateControls"},uv.EVENTS.CONTROLS_MEETING_BREAKOUT_UPDATED,{breakout:A})}if(b){var I=E.interpretation;this.emitScoped({file:"locus-info",function:"updateControls"},uv.EVENTS.CONTROLS_MEETING_INTERPRETATION_UPDATED,{interpretation:I})}if(c){var C=E.entryExitTone;this.updateMeeting({entryExitTone:C}),this.emitScoped({file:"locus-info",function:"updateControls"},uv.EVENTS.CONTROLS_ENTRY_EXIT_TONE_UPDATED,{entryExitTone:C})}if(l){var R=E.videoEnabled;this.updateMeeting({unmuteVideoAllowed:R}),this.emitScoped({file:"locus-info",function:"updateControls"},uv.EVENTS.SELF_REMOTE_VIDEO_MUTE_STATUS_UPDATED,{unmuteAllowed:R})}this.controls=e}}},{key:"updateConversationUrl",value:function(e,t){e&&!zE()(this.conversationUrl,e)?(this.conversationUrl=e,this.updateMeeting({conversationUrl:e})):t&&t.conversationUrl&&!zE()(this.conversationUrl,t.conversationUrl)&&(this.conversationUrl=t.conversationUrl,this.updateMeeting({conversationUrl:t.conversationUrl}))}},{key:"updateCreated",value:function(e){e&&!zE()(this.created,e)&&(this.created=e)}},{key:"updateServices",value:function(e){e&&!zE()(this.services,e)&&(this.services=e,this.emitScoped({file:"locus-info",function:"updateServices"},uv.EVENTS.LINKS_SERVICES,{services:e}))}},{key:"updateFullState",value:function(e){if(e&&!zE()(this.fullState,e)){var t=mS.getFullState(this.fullState,e);this.updateMeeting(t.current),t.updates.meetingStateChangedTo&&this.emitScoped({file:"locus-info",function:"updateFullState"},uv.EVENTS.FULL_STATE_MEETING_STATE_CHANGE,{previousState:t.previous&&t.previous.meetingState,currentState:t.current.meetingState}),t.updates.meetingTypeChangedTo&&this.emitScoped({file:"locus-info",function:"updateFullState"},uv.EVENTS.FULL_STATE_TYPE_UPDATE,{type:t.current.type}),this.parsedLocus.fullState=t.current,this.fullState=e}}},{key:"updateHostInfo",value:function(e){if(e&&!zE()(this.host,e)){var t=bS.getHosts(this.host,e);this.updateMeeting(t.current),this.parsedLocus.host=t.current,t.updates.isNewHost&&(this.compareAndUpdateFlags.compareSelfAndHost=!0,this.emitScoped({file:"locus-info",function:"updateHostInfo"},Jg.LOCUS_INFO_UPDATE_HOST,{newHost:t.current,oldHost:t.previous})),this.host=e}else this.compareAndUpdateFlags.compareSelfAndHost=!1}},{key:"updateMeetingInfo",value:function(e,t){var r,n=t?vS.getRoles(t):(null===(r=this.parsedLocus.self)||void 0===r?void 0:r.roles)||[];if(e&&!zE()(this.info,e)||n.length&&!zE()(this.roles,n)&&e){var i=vS.isJoined(t||this.parsedLocus.self),o=fS.getInfos(this.parsedLocus.info,e,n,i);o.updates.isLocked&&this.emitScoped({file:"locus-info",function:"updateMeetingInfo"},uv.EVENTS.MEETING_LOCKED,e),o.updates.isUnlocked&&this.emitScoped({file:"locus-info",function:"updateMeetingInfo"},uv.EVENTS.MEETING_UNLOCKED,e),this.info=e,this.parsedLocus.info=o.current,this.updateMeeting(o.current),this.emitScoped({file:"locus-info",function:"updateMeetingInfo"},uv.EVENTS.MEETING_INFO_UPDATED)}this.roles=n}},{key:"updateEmbeddedApps",value:function(e){if(!AS.areSimilar(this.embeddedApps,e)){var t=AS.parse(e);this.updateMeeting({embeddedApps:t}),this.emitScoped({file:"locus-info",function:"updateEmbeddedApps"},uv.EVENTS.EMBEDDED_APPS_UPDATED,t),this.embeddedApps=e}}},{key:"updateMediaShares",value:function(e){if(e&&!zE()(this.mediaShares,e)){var t=CS.getMediaShares(this.mediaShares,e);this.updateMeeting(t.current),this.parsedLocus.mediaShares=t.current,this.mediaShares=e,this.emitScoped({file:"locus-info",function:"updateMediaShares"},Jg.LOCUS_INFO_UPDATE_MEDIA_SHARES,{current:t.current,previous:t.previous})}}},{key:"updateParticipantsUrl",value:function(e){e&&!zE()(this.participantsUrl,e)&&(this.participantsUrl=e)}},{key:"updateReplace",value:function(e){e&&!zE()(this.replace,e)&&(this.replace=e)}},{key:"updateSelf",value:function(e,t){if(e&&!zE()(this.self,e)){var r=vS.getSelves(this.self,e,this.webex.internal.device.url);this.updateMeeting(r.current),this.parsedLocus.self=r.current,this.parsedLocus.states[this.parsedLocus.states.length-1]!==r.current.state&&this.parsedLocus.states.push(r.current.state);var n,i,o,s,a,c=vS.getSipUrl(this.getLocusPartner(t,e),this.parsedLocus.fullState.type,this.parsedLocus.info.sipUri);if(c.sipUri&&this.updateMeeting(c),r.updates.moderatorChanged?this.compareAndUpdateFlags.compareHostAndSelf=!0:this.compareAndUpdateFlags.compareHostAndSelf=!1,r.updates.layoutChanged&&this.emitScoped({file:"locus-info",function:"updateSelf"},uv.EVENTS.CONTROLS_MEETING_LAYOUT_UPDATED,{layout:r.current.layout}),r.updates.breakoutsChanged&&this.emitScoped({file:"locus-info",function:"updateSelf"},uv.EVENTS.SELF_MEETING_BREAKOUTS_CHANGED,{breakoutSessions:r.current.breakoutSessions}),r.updates.interpretationChanged&&this.emitScoped({file:"locus-info",function:"updateSelf"},uv.EVENTS.SELF_MEETING_INTERPRETATION_CHANGED,{interpretation:r.current.interpretation,selfParticipantId:r.current.selfId}),r.updates.isMediaInactiveOrReleased&&this.emitScoped({file:"locus-info",function:"updateSelf"},uv.EVENTS.DISCONNECT_DUE_TO_INACTIVITY,{reason:e.reason}),r.updates.moderatorChanged&&this.emitScoped({file:"locus-info",function:"updateSelf"},uv.EVENTS.SELF_MODERATOR_CHANGED,e),r.updates.isRolesChanged)this.emitScoped({file:"locus-info",function:"updateSelf"},uv.EVENTS.SELF_ROLES_CHANGED,{oldRoles:null===(n=r.previous)||void 0===n?void 0:n.roles,newRoles:null===(i=r.current)||void 0===i?void 0:i.roles});if(r.updates.isVideoMutedByOthersChanged&&this.emitScoped({file:"locus-info",function:"updateSelf"},uv.EVENTS.SELF_REMOTE_VIDEO_MUTE_STATUS_UPDATED,{muted:r.current.remoteVideoMuted}),r.updates.localAudioUnmuteRequiredByServer&&this.emitScoped({file:"locus-info",function:"updateSelf"},uv.EVENTS.LOCAL_UNMUTE_REQUIRED,{muted:r.current.remoteMuted,unmuteAllowed:r.current.unmuteAllowed}),r.updates.isMutedByOthersChanged&&this.emitScoped({file:"locus-info",function:"updateSelf"},uv.EVENTS.SELF_REMOTE_MUTE_STATUS_UPDATED,{muted:r.current.remoteMuted,unmuteAllowed:r.current.unmuteAllowed}),r.updates.localAudioUnmuteRequestedByServer&&this.emitScoped({file:"locus-info",function:"updateSelf"},uv.EVENTS.LOCAL_UNMUTE_REQUESTED,{}),r.updates.isUserUnadmitted&&this.emitScoped({file:"locus-info",function:"updateSelf"},uv.EVENTS.SELF_UNADMITTED_GUEST,e),r.updates.isUserAdmitted&&this.emitScoped({file:"locus-info",function:"updateSelf"},uv.EVENTS.SELF_ADMITTED_GUEST,e),r.updates.isMediaInactive&&this.emitScoped({file:"locus-info",function:"updateSelf"},uv.EVENTS.MEDIA_INACTIVITY,vS.getMediaStatus(e.mediaSessions)),r.updates.audioStateChange||r.updates.videoStateChange||r.updates.shareStateChange)this.emitScoped({file:"locus-info",function:"updateSelf"},uv.EVENTS.MEDIA_STATUS_CHANGE,{audioStatus:null===(o=r.current.currentMediaStatus)||void 0===o?void 0:o.audio,videoStatus:null===(s=r.current.currentMediaStatus)||void 0===s?void 0:s.video,shareStatus:null===(a=r.current.currentMediaStatus)||void 0===a?void 0:a.share});r.updates.isUserObserving&&this.emitScoped({file:"locus-info",function:"updateSelf"},uv.EVENTS.SELF_OBSERVING),r.updates.canNotViewTheParticipantListChanged&&this.emitScoped({file:"locus-info",function:"updateSelf"},uv.EVENTS.SELF_CANNOT_VIEW_PARTICIPANT_LIST_CHANGE,{canNotViewTheParticipantList:r.current.canNotViewTheParticipantList}),r.updates.isSharingBlockedChanged&&this.emitScoped({file:"locus-info",function:"updateSelf"},uv.EVENTS.SELF_IS_SHARING_BLOCKED_CHANGE,{isSharingBlocked:r.current.isSharingBlocked}),this.emitScoped({file:"locus-info",function:"updateSelf"},Jg.LOCUS_INFO_UPDATE_SELF,{oldSelf:r.previous,newSelf:r.current}),this.parsedLocus.self=r.current,this.self=e}else this.compareAndUpdateFlags.compareHostAndSelf=!1}},{key:"updateLocusUrl",value:function(e){e&&this.url!==e&&(this.url=e,this.updateMeeting({locusUrl:e}),this.emitScoped({file:"locus-info",function:"updateLocusUrl"},Jg.LOCUS_INFO_UPDATE_URL,e))}},{key:"updateAclUrl",value:function(e){e&&!zE()(this.aclUrl,e)&&(this.aclUrl=e)}},{key:"updateBasequence",value:function(e){e&&!zE()(this.baseSequence,e)&&(this.baseSequence=e)}},{key:"updateSequence",value:function(e){e&&!zE()(this.sequence,e)&&(this.sequence=e)}},{key:"updateMemberShip",value:function(e){e&&!zE()(this.membership,e)&&(this.membership=e)}},{key:"updateIdentifiers",value:function(e){e&&!zE()(this.identities,e)&&(this.identities=e)}},{key:"updateLocusCache",value:function(e){SS.isMainSessionDTO(e)&&this.updateMainSessionLocusCache(e)}},{key:"getTheLocusToUpdate",value:function(e){var t,r,n;if(SS.getSessionSwitchStatus(this.controls,null==e?void 0:e.controls).isReturnToMain&&this.mainSessionLocusCache)return Iy()(this.mainSessionLocusCache);this.mainSessionLocusCache&&SS.isMainSessionDTO(this.mainSessionLocusCache)&&([ov.STATE.ACTIVE,ov.STATE.INITIALIZING,ov.STATE.TERMINATING].includes(null===(t=this.fullState)||void 0===t?void 0:t.state)&&!(null!==(r=this.mainSessionLocusCache)&&void 0!==r&&null!==(n=r.self)&&void 0!==n&&n.removed)||this.clearMainSessionLocusCache());return e}},{key:"mergeParticipants",value:function(e,t){return t&&t.length?e&&e.length?(t.forEach((function(t){var r=e.findIndex((function(e){return e.id===t.id}));r>-1?e.splice(r,1,t):e.push(t)})),e):t:e}},{key:"updateMainSessionLocusCache",value:function(e){var t=this;if(e){var r=Iy()(e);this.mainSessionLocusCache?aS()(this.mainSessionLocusCache,r,(function(e,r,n){return"participants"===n?t.mergeParticipants(e,r):r||e})):this.mainSessionLocusCache=r}}},{key:"clearMainSessionLocusCache",value:function(){this.mainSessionLocusCache=null}}]),r}(aw);function ZS(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var zS=function(e){(0,A.Z)(r,e);var t=ZS(r);function r(){return(0,k.Z)(this,r),t.apply(this,arguments)}return(0,O.Z)(r)}((0,yp.Z)(Error));function KS(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var WS=function(e){(0,A.Z)(r,e);var t=KS(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qg.RECONNECTION.MESSAGE,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,k.Z)(this,r),e=t.call(this,n),(0,R.Z)((0,x.Z)(e),"code",void 0),(0,R.Z)((0,x.Z)(e),"error",void 0),(0,R.Z)((0,x.Z)(e),"sdkMessage",void 0),e.name=Qg.RECONNECTION.NAME,e.sdkMessage=Qg.RECONNECTION.MESSAGE,e.error=i,e.stack=i?i.stack:(new Error).stack,e.code=Qg.RECONNECTION.CODE,e}return(0,O.Z)(r)}((0,yp.Z)(Error));function JS(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var YS=function(e){(0,A.Z)(r,e);var t=JS(r);function r(){return(0,k.Z)(this,r),t.apply(this,arguments)}return(0,O.Z)(r)}((0,yp.Z)(Error)),QS=function(e){(0,A.Z)(r,e);var t=JS(r);function r(e){var n,i=e.wasSharing,o=e.error,s=void 0===o?new Error("Meeting needs to be rejoined"):o;return(0,k.Z)(this,r),n=t.call(this,s),(0,R.Z)((0,x.Z)(n),"wasSharing",void 0),n.wasSharing=i,n}return(0,O.Z)(r)}((0,yp.Z)(Error)),XS=function(){function e(t){(0,k.Z)(this,e),(0,R.Z)(this,"autoRejoinEnabled",void 0),(0,R.Z)(this,"iceState",void 0),(0,R.Z)(this,"maxRejoinAttempts",void 0),(0,R.Z)(this,"meeting",void 0),(0,R.Z)(this,"rejoinAttempts",void 0),(0,R.Z)(this,"shareStatus",void 0),(0,R.Z)(this,"status",void 0),(0,R.Z)(this,"tryCount",void 0),(0,R.Z)(this,"webex",void 0),this.iceState={disconnected:!1,resolve:function(){},timer:void 0,timeoutDuration:t.config.reconnection.iceReconnectionTimeout},this.status=_v.STATE.DEFAULT_STATUS,this.tryCount=_v.STATE.DEFAULT_TRY_COUNT,this.webex=t.webex,this.meeting=t,this.maxRejoinAttempts=t.config.reconnection.maxRejoinAttempts,this.rejoinAttempts=_v.STATE.DEFAULT_TRY_COUNT,this.autoRejoinEnabled=t.config.reconnection.autoRejoin,this.reset()}var t,r,n,i,o,s;return(0,O.Z)(e,[{key:"resetReconnectionTimer",value:function(){this.iceState.resolve(),this.iceState.resolve=function(){},this.iceState.timer&&(clearTimeout(this.iceState.timer),delete this.iceState.timer)}},{key:"iceReconnected",value:function(){this.iceState.disconnected&&(pp.logger.log("ReconnectionManager:index#iceReconnected --\x3e ice has reconnected"),this.resetReconnectionTimer(),this.iceState.disconnected=!1)}},{key:"waitForIceReconnect",value:function(){var e=this;return this.iceState.disconnected?P().resolve():(pp.logger.log("ReconnectionManager:index#waitForIceReconnect --\x3e waiting for ice reconnect"),this.iceState.disconnected=!0,new(P())((function(t,r){e.iceState.timer=setTimeout((function(){!1===e.iceState.disconnected?t():(e.iceState.disconnected=!1,r(new Error("ice reconnection did not occur in ".concat(e.iceState.timeoutDuration,"ms"))))}),e.iceState.timeoutDuration),e.iceState.resolve=t})))}},{key:"reset",value:function(){this.status=_v.STATE.DEFAULT_STATUS,this.tryCount=_v.STATE.DEFAULT_TRY_COUNT,this.rejoinAttempts=_v.STATE.DEFAULT_TRY_COUNT}},{key:"cleanUp",value:function(){this.reset()}},{key:"stopLocalShareStream",value:(s=(0,T.Z)(V().mark((function e(t){return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.meeting.unpublishStreams([this.meeting.mediaProperties.shareVideoStream,this.meeting.mediaProperties.shareAudioStream]);case 2:Qv.trigger(this.meeting,{file:"reconnection-manager/index",function:"stopLocalShareStream"},$g.MEETING_STOPPED_SHARING_LOCAL,{reason:t});case 3:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"isReconnectInProgress",value:function(){return this.status===_v.STATE.IN_PROGRESS}},{key:"setStatus",value:function(e){this.status=e}},{key:"validate",value:function(){if(this.meeting.config.reconnection.enabled){if(this.status===_v.STATE.DEFAULT_STATUS||this.status===_v.STATE.COMPLETE)return!0;throw pp.logger.info("ReconnectionManager:index#validate --\x3e Reconnection already in progress."),new zS("Reconnection already in progress.")}throw pp.logger.info("ReconnectionManager:index#validate --\x3e Reconnection is not enabled."),new WS("Reconnection is not enabled.")}},{key:"reconnect",value:(o=(0,T.Z)(V().mark((function e(){var t,r,n,i,o,s,a=arguments;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=(t=a.length>0&&void 0!==a[0]?a[0]:{}).networkDisconnect,n=void 0!==r&&r,i=t.networkRetry,o=void 0!==i&&i,pp.logger.info("ReconnectionManager:index#reconnect --\x3e Reconnection start for meeting ".concat(this.meeting.id,".")),e.prev=2,this.validate(),e.next=10;break;case 6:throw e.prev=6,e.t0=e.catch(2),pp.logger.info("ReconnectionManager:index#reconnect --\x3e Reconnection unable to begin.",e.t0),e.t0;case 10:return o||(pp.logger.info("ReconnectionManager:index#reconnect --\x3e Sending reconnect start metric."),this.webex.internal.newMetrics.submitClientEvent({name:"client.media.reconnecting",options:{meetingId:this.meeting.id}})),e.prev=11,e.next=14,this.webex.meetings.startReachability();case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(11),pp.logger.info("ReconnectionManager:index#reconnect --\x3e Reachability failed, continuing with reconnection attempt, err: ",e.t1);case 19:return e.prev=19,e.next=22,this.executeReconnection({networkDisconnect:n});case 22:return s=e.sent,e.abrupt("return",s);case 26:if(e.prev=26,e.t2=e.catch(19),!(e.t2 instanceof YS)){e.next=32;break}return pp.logger.info("ReconnectionManager:index#reconnect --\x3e Reconnection not successful, retrying."),this.status=_v.STATE.DEFAULT_STATUS,e.abrupt("return",this.reconnect({networkDisconnect:!0,networkRetry:!0}));case 32:if(pp.logger.error("ReconnectionManager:index#reconnect --\x3e Reconnection failed.",e.t2.message),pp.logger.info("ReconnectionManager:index#reconnect --\x3e Sending reconnect abort metric."),this.webex.internal.newMetrics.submitClientEvent({name:"client.call.aborted",payload:{errors:[{category:"expected",errorCode:2008,fatal:!0,name:"media-engine",shownToUser:!1}]},options:{meetingId:this.meeting.id}}),!(e.t2 instanceof QS&&this.autoRejoinEnabled)){e.next=37;break}return e.abrupt("return",this.rejoinMeeting(e.t2.wasSharing));case 37:throw e.t2;case 38:case"end":return e.stop()}}),e,this,[[2,6],[11,16],[19,26]])}))),function(){return o.apply(this,arguments)})},{key:"executeReconnection",value:(i=(0,T.Z)(V().mark((function e(t){var r,n,i,o;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.networkDisconnect,n=void 0!==r&&r,this.status=_v.STATE.IN_PROGRESS,pp.logger.info("ReconnectionManager:index#executeReconnection --\x3e Attempting to reconnect to meeting."),!(i=this.meeting.shareStatus===qg.LOCAL_SHARE_ACTIVE)){e.next=7;break}return e.next=7,this.stopLocalShareStream(Wg.MEDIA_RECONNECTION);case 7:if(!n){e.next=19;break}return e.prev=8,e.next=11,this.reconnectMercuryWebSocket();case 11:pp.logger.error("ReconnectionManager:index#executeReconnection --\x3e Websocket reconnected.",this.webex.internal.device.url),e.next=19;break;case 14:throw e.prev=14,e.t0=e.catch(8),pp.logger.error("ReconnectionManager:index#executeReconnection --\x3e Unable to reconnect to websocket, giving up."),this.status=_v.STATE.FAILURE,e.t0;case 19:if(this.webex.credentials.isUnverifiedGuest){e.next=30;break}return e.prev=20,pp.logger.info("ReconnectionManager:index#executeReconnection --\x3e Updating meeting data from server."),e.next=24,this.webex.meetings.syncMeetings({keepOnlyLocusMeetings:!1});case 24:e.next=30;break;case 26:throw e.prev=26,e.t1=e.catch(20),pp.logger.info("ReconnectionManager:index#executeReconnection --\x3e Unable to sync meetings, reconnecting.",e.t1),new YS(e.t1);case 30:if(this.meeting&&this.webex.meetings.getMeetingByType(Nm,this.meeting.id)){e.next=33;break}throw pp.logger.info("ReconnectionManager:index#executeReconnection --\x3e Meeting got deleted due to inactivity or ended remotely."),new Error("Unable to rejoin a meeting already ended or inactive.");case 33:if(pp.logger.info("ReconnectionManager:index#executeReconnection --\x3e Current state of meeting is ".concat(this.meeting.state)),this.meeting.state!==Mm){e.next=38;break}if(this.meeting.type!==wm){e.next=37;break}throw new Error("Unable to rejoin a call in LEFT state.");case 37:throw new QS({wasSharing:i});case 38:return e.prev=38,e.next=41,this.reconnectMedia();case 41:return o=e.sent,pp.logger.log("ReconnectionManager:index#executeReconnection --\x3e webRTC media connection renewed and local sdp offer sent"),e.abrupt("return",o);case 46:throw e.prev=46,e.t2=e.catch(38),pp.logger.error("ReconnectionManager:index#executeReconnection --\x3e failed to renew webRTC media connection or initiate offer"),this.status=_v.STATE.FAILURE,e.t2;case 51:case"end":return e.stop()}}),e,this,[[8,14],[20,26],[38,46]])}))),function(e){return i.apply(this,arguments)})},{key:"rejoinMeeting",value:(n=(0,T.Z)(V().mark((function e(){var t,r=arguments;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]&&r[0],e.prev=1,pp.logger.info("ReconnectionManager:index#rejoinMeeting --\x3e attemping meeting rejoin"),e.next=5,this.meeting.join({rejoin:!0});case 5:if(pp.logger.info("ReconnectionManager:index#rejoinMeeting --\x3e meeting rejoined"),!t){e.next=9;break}return e.next=9,this.stopLocalShareStream(Wg.MEETING_REJOIN);case 9:e.next=23;break;case 11:if(e.prev=11,e.t0=e.catch(1),this.rejoinAttempts+=1,!(this.rejoinAttempts<=this.maxRejoinAttempts)){e.next=19;break}pp.logger.info("ReconnectionManager:index#rejoinMeeting --\x3e Unable to rejoin meeting, attempt #".concat(this.rejoinAttempts,", retrying."),e.t0),this.rejoinMeeting(),e.next=23;break;case 19:throw pp.logger.error("ReconnectionManager:index#rejoinMeeting --\x3e Unable to rejoin meeting after max attempts.",e.t0),sp.sendBehavioralMetric(Sb,{locus_id:this.meeting.locusUrl.split("/").pop(),reason:e.t0.message,stack:e.t0.stack}),this.status=_v.STATE.FAILURE,e.t0;case 23:return e.prev=23,e.next=26,this.reconnectMedia();case 26:e.next=32;break;case 28:throw e.prev=28,e.t1=e.catch(23),pp.logger.error("ReconnectionManager:index#rejoinMeeting --\x3e Unable to reestablish media after rejoining.",e.t1),e.t1;case 32:case"end":return e.stop()}}),e,this,[[1,11],[23,28]])}))),function(){return n.apply(this,arguments)})},{key:"reconnectMedia",value:(r=(0,T.Z)(V().mark((function e(){var t,r;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pp.logger.log("ReconnectionManager:index#reconnectMedia --\x3e do turn discovery"),e.next=3,this.meeting.roap.doTurnDiscovery(this.meeting,!0,!0);case 3:return t=e.sent,r=[],t.turnServerInfo&&r.push({urls:t.turnServerInfo.url,username:t.turnServerInfo.username||"",credential:t.turnServerInfo.password||""}),pp.logger.log("ReconnectionManager:index#reconnectMedia --\x3e renew webRTC media connection and send local sdp offer"),e.next=9,this.meeting.mediaProperties.webrtcMediaConnection.reconnect(r);case 9:this.meeting.isMultistream&&F()(this.meeting.mediaRequestManagers).forEach((function(e){e.clearPreviousRequests(),e.commit()}));case 10:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"reconnectMercuryWebSocket",value:(t=(0,T.Z)(V().mark((function e(){return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pp.logger.info("ReconnectionManager:index#reconnectMercuryWebSocket --\x3e Reconnecting websocket."),!this.webex.internal.mercury.connected){e.next=13;break}return pp.logger.info("ReconnectionManager:index#reconnectMercuryWebSocket --\x3e Disconnecting existing websocket."),e.prev=3,e.next=6,this.webex.internal.mercury.disconnect();case 6:pp.logger.info("ReconnectionManager:index#reconnectMercuryWebSocket --\x3e Websocket disconnected successfully."),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(3),pp.logger.error("ReconnectionManager:index#reconnectMercuryWebSocket --\x3e Unable to disconnect from websocket, giving up.",e.t0),e.t0;case 13:return e.prev=13,pp.logger.info("ReconnectionManager:index#reconnectMercuryWebSocket --\x3e Connecting websocket."),e.next=17,this.webex.internal.mercury.connect();case 17:pp.logger.info("ReconnectionManager:index#reconnectMercuryWebSocket --\x3e Websocket connected successfully."),e.next=24;break;case 20:throw e.prev=20,e.t1=e.catch(13),pp.logger.error("ReconnectionManager:index#reconnectMercuryWebSocket --\x3e Unable to connect to websocket, giving up.",e.t1),e.t1;case 24:case"end":return e.stop()}}),e,this,[[3,9],[13,20]])}))),function(){return t.apply(this,arguments)})}]),e}(),e_=r(72818),t_=r(15297);function r_(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=t_(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(e_){var o=e_(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var n_=r(23279),i_=r.n(n_),o_=["meeting"];function s_(e,t){var r=U()(e);if(p()){var n=p()(e);t&&(n=n.filter((function(t){return g()(e,t).enumerable}))),r.push.apply(r,n)}return r}function a_(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var c_=function(e){(0,A.Z)(n,e);var t,r=a_(n);function n(e,t){var i;(0,k.Z)(this,n);var o=e.meeting,s=r_(e,o_);return i=r.call(this,s,t),(0,R.Z)((0,x.Z)(i),"changeVideoLayoutDebounced",void 0),(0,R.Z)((0,x.Z)(i),"meetingRef",void 0),(0,R.Z)((0,x.Z)(i),"locusDeltaRequest",void 0),(0,R.Z)((0,x.Z)(i),"buildLocusDeltaRequestOptions",void 0),(0,R.Z)((0,x.Z)(i),"getJoinCookie",(0,T.Z)(V().mark((function e(){var t,r;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.webex.boundedStorage.get(xv.namespace,xv.localStorageJoinCookie).catch((function(){}));case 2:if(!(t=e.sent)){e.next=13;break}if(e.prev=4,!(r=JSON.parse(t))){e.next=8;break}return e.abrupt("return",r);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),pp.logger.error("MeetingRequest#constructor --\x3e Error in parsing join cookie data: ".concat(e.t0));case 13:return e.abrupt("return",null);case 14:case"end":return e.stop()}}),e,null,[[4,10]])})))),i.locusDeltaRequest=eb.generateLocusDeltaRequest(o),i.buildLocusDeltaRequestOptions=eb.generateBuildLocusDeltaRequestOptions(o),i.changeVideoLayoutDebounced=i_()(i.changeVideoLayout,2e3,{leading:!0,trailing:!0}),i}return(0,O.Z)(n,[{key:"joinMeeting",value:(t=(0,T.Z)(V().mark((function e(t){var r,n,i,o,s,a,c,u,l,d,h,f,p,m,g,v,y,b,E,w,S,_,T,x,A;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.asResourceOccupant,n=t.inviteeAddress,i=t.meetingNumber,o=t.permissionToken,s=t.deviceUrl,a=t.locusUrl,c=t.locusClusterUrl,u=t.resourceId,l=t.correlationId,d=t.ensureConversation,h=t.moderator,f=t.pin,p=t.moveToResource,m=t.roapMessage,g=t.preferTranscoding,v=t.breakoutsSupported,y=t.locale,b=t.deviceCapabilities,E=void 0===b?[]:b,w=t.liveAnnotationSupported,S=t.ipVersion,pp.logger.info("Meeting:request#joinMeeting --\x3e Joining a meeting",l),_="",e.next=5,this.getJoinCookie();case 5:if(T=e.sent,x={asResourceOccupant:r,device:{url:s,deviceType:this.config.meetings.deviceType},usingResource:u||null,moveMediaToResource:u&&p||!1,correlationId:l,respOnlySdp:!0,allowMultiDevice:!0,ensureConversation:d||!1,supportsNativeLobby:1,clientMediaPreferences:{preferTranscoding:null==g||g,joinCookie:T,ipver:S}},v&&E.push(av.BREAKOUTS_SUPPORTED),w&&E.push(sv.ANNOTATION_ON_SHARE_SUPPORTED),this.webex.internal.device.config.installationId&&(x.device.installationId=this.webex.internal.device.config.installationId),y&&(x.locale=y),E.length&&(x.deviceCapabilities=E),this.webex.meetings.geoHintInfo&&(x.device.countryCode=this.webex.meetings.geoHintInfo.countryCode,x.device.regionCode=this.webex.meetings.geoHintInfo.regionCode,x.device.localIp=H.CallDiagnosticUtils.anonymizeIPAddress(this.webex.meetings.geoHintInfo.clientAddress)||void 0),void 0!==h&&(x.moderator=h),o&&(x.permissionToken=o),void 0!==f&&(x.pin=f),!a){e.next=20;break}_="".concat(a,"/").concat(sm),e.next=37;break;case 20:if(!n&&!i){e.next=37;break}if(e.prev=21,!c){e.next=26;break}A="https://".concat(c,"/locus/api/v1"),e.next=29;break;case 26:return e.next=28,this.webex.internal.services.waitForCatalog("postauth");case 28:A=this.webex.internal.services.get("locus");case 29:_="".concat(A,"/").concat(Kp,"/").concat(xp),x.invitee={address:n||"wbxmn:".concat(i)},e.next=37;break;case 33:throw e.prev=33,e.t0=e.catch(21),pp.logger.error("Meeting:request#joinMeeting Error Joining ".concat(n||i," --\x3e ").concat(e.t0)),e.t0;case 37:return _=_.concat("?".concat(hg)),u===n&&(x.callPreferences={requestedMedia:[ig]}),m&&(x.localMedias=m.localMedias),e.abrupt("return",this.request({method:tv.POST,uri:_,body:x}));case 41:case"end":return e.stop()}}),e,this,[[21,33]])}))),function(e){return t.apply(this,arguments)})},{key:"refreshCaptcha",value:function(e){var t=e.captchaRefreshUrl,r={captchaId:e.captchaId};return this.request({method:tv.POST,uri:t,body:r}).catch((function(e){throw pp.logger.error("Meeting:request#refreshCaptcha --\x3e Error: ".concat(e)),e}))}},{key:"dialIn",value:function(e){var t=e.locusUrl,r=e.dialInUrl,n=e.clientUrl,i=e.correlationId;pp.logger.info("Meeting:request#dialIn --\x3e Provisioning a dial in device",i);var o="".concat(t,"/").concat(sm),s={device:{deviceType:bp.deviceType.PROVISIONAL,provisionalType:am,url:r,clientUrl:n},correlationId:i};return this.locusDeltaRequest({method:tv.POST,uri:o,body:s}).catch((function(e){throw pp.logger.error("Meeting:request#dialIn --\x3e Error provisioning a dial in device, error ".concat(e)),e}))}},{key:"dialOut",value:function(e){var t=e.locusUrl,r=e.dialOutUrl,n=e.phoneNumber,i=e.clientUrl,o=e.correlationId;pp.logger.info("Meeting:request#dialOut --\x3e Provisioning a dial out device",o);var s="".concat(t,"/").concat(sm),a={device:{deviceType:bp.deviceType.PROVISIONAL,provisionalType:cm,url:r,dialoutAddress:n,clientUrl:i},correlationId:o};return this.locusDeltaRequest({method:tv.POST,uri:s,body:a}).catch((function(e){throw pp.logger.error("Meeting:request#dialOut --\x3e Error provisioning a dial out device, error ".concat(e)),e}))}},{key:"getLocusDTO",value:function(e){var t=e.url;return t?this.request({method:tv.GET,uri:t}).catch((function(e){throw pp.logger.error("Meeting:request#getLocusDTO --\x3e Error getting latest locus, error ".concat(e)),e})):P().reject()}},{key:"disconnectPhoneAudio",value:function(e){var t=e.locusUrl,r=e.phoneUrl,n=e.correlationId,i=e.selfId;pp.logger.info("Meeting:request#disconnectPhoneAudio --\x3e request phone ".concat(r," to leave"),n);var o="".concat(t,"/").concat(sm,"/").concat(i,"/").concat($p),s={device:{deviceType:bp.deviceType.PROVISIONAL,url:r},correlationId:n};return this.locusDeltaRequest({method:tv.PUT,uri:o,body:s}).catch((function(e){throw pp.logger.error("Meeting:request#disconnectPhoneAudio --\x3e Error when requesting phone ".concat(r," to leave, error ").concat(e)),e}))}},{key:"prepareLeaveMeetingRequestOptions",value:function(e){var t=e.locusUrl,r=e.selfId,n=e.deviceUrl,i=e.resourceId,o=e.correlationId,s="".concat(t,"/").concat(sm,"/").concat(r,"/").concat($p),a={device:{deviceType:this.config.meetings.deviceType,url:n},usingResource:i||null,correlationId:o};return{method:tv.PUT,uri:s,body:a}}},{key:"leaveMeeting",value:function(e){var t=e.locusUrl,r=e.selfId,n=e.deviceUrl,i=e.resourceId,o=e.correlationId;pp.logger.info("Meeting:request#leaveMeeting --\x3e Leaving a meeting",o);var s="".concat(t,"/").concat(sm,"/").concat(r,"/").concat($p),a={device:{deviceType:this.config.meetings.deviceType,url:n},usingResource:i||null,correlationId:o};return this.locusDeltaRequest({method:tv.PUT,uri:s,body:a})}},{key:"buildLeaveMeetingRequestOptions",value:function(e){return this.buildLocusDeltaRequestOptions(this.prepareLeaveMeetingRequestOptions(e))}},{key:"acknowledgeMeeting",value:function(e){var t="".concat(e.locusUrl,"/").concat(sm,"/").concat(Sp),r={device:{deviceType:this.config.meetings.deviceType,url:e.deviceUrl},correlationId:e.correlationId};return this.locusDeltaRequest({method:tv.PUT,uri:t,body:r})}},{key:"lockMeeting",value:function(e){var t="".concat(e.locusUrl,"/").concat(Pp),r={lock:{locked:e.lock}};return this.locusDeltaRequest({method:tv.PATCH,uri:t,body:r})}},{key:"declineMeeting",value:function(e){var t="".concat(e.locusUrl,"/").concat(sm,"/").concat(Fp),r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s_(Object(r),!0).forEach((function(t){(0,R.Z)(e,t,r[t])})):y()?E()(e,y()(r)):s_(Object(r)).forEach((function(t){S()(e,t,g()(r,t))}))}return e}({device:{deviceType:this.config.meetings.deviceType,url:e.deviceUrl}},e.reason&&{reason:e.reason});return this.locusDeltaRequest({method:tv.PUT,uri:t,body:r})}},{key:"changeMeetingFloor",value:function(e){var t={disposition:e.disposition};e.disposition===Xg.GRANTED&&(t={beneficiary:{url:e.personUrl,devices:[{deviceType:this.config.meetings.deviceType,url:e.deviceUrl}]},disposition:e.disposition,requester:{url:e.personUrl}});var r={floor:t,resourceUrl:e.resourceUrl};return null!=e&&e.shareInstanceId&&(r.floor.shareInstanceId=e.shareInstanceId),null!=e&&e.resourceToken&&(r.resourceToken=null==e?void 0:e.resourceToken),null!=e&&e.annotationInfo&&(r.annotation=null==e?void 0:e.annotationInfo),this.request({uri:e.uri,method:tv.PUT,body:r})}},{key:"sendDTMF",value:function(e){var t=e.locusUrl,r=e.deviceUrl,n=e.tones;return this.locusDeltaRequest({method:tv.POST,uri:"".concat(t,"/").concat(dm),body:{deviceUrl:r,dtmf:{correlationId:gp().v4(),tones:n}}})}},{key:"changeVideoLayout",value:function(e){var t=e.locusUrl,r=e.deviceUrl,n=e.layoutType,i=e.main,o=e.content;if(i&&(!i.width||!i.height))return P().reject(new Error("Both width and height must be specified. One of them is missing for main: ".concat(uy()(i))));if(o&&(!o.width||!o.height))return P().reject(new Error("Both width and height must be specified. One of them is missing for content: ".concat(uy()(o))));var s=i?{width:i.width,height:i.height}:void 0,a=o?{width:o.width,height:o.height}:void 0,c=s||a?{renderInfo:{main:s,content:a}}:void 0;return this.locusDeltaRequest({method:tv.PUT,uri:"".concat(t,"/").concat(Pp),body:{layout:{deviceUrl:r,type:n,layoutParams:c}}})}},{key:"endMeetingForAll",value:function(e){var t=e.locusUrl,r="".concat(t,"/").concat(Jp);return this.locusDeltaRequest({method:tv.POST,uri:r})}},{key:"keepAlive",value:function(e){var t=e.keepAliveUrl;return this.request({method:tv.GET,uri:t})}},{key:"sendReaction",value:function(e){var t=e.reactionChannelUrl,r=e.reaction,n=e.participantId,i=t;return this.request({method:tv.POST,uri:i,body:{sender:{participantId:n},reaction:r}})}},{key:"toggleReactions",value:function(e){var t=e.enable,r=e.locusUrl,n=e.requestingParticipantId,i="".concat(r,"/").concat(Pp);return this.locusDeltaRequest({method:tv.PUT,uri:i,body:{reactions:{enabled:t},requestingParticipantId:n}})}},{key:"getLocusStatusByUrl",value:function(e){return this.request({method:tv.GET,uri:e})}}]),n}(l.XR),u_=function(e){return e.Cohost="COHOST",e.Moderator="MODERATOR",e.Presenter="PRESENTER",e}({}),l_={canReclaimHost:function(e){if(!e)throw new zv("canReclaimHostRole could not be processed, participant is undefined.");return e.canReclaimHostRole||!1},getControlsRoles:function(e){var t,r;return null==e||null===(t=e.controls)||void 0===t||null===(r=t.role)||void 0===r?void 0:r.roles},hasRole:function(e,t){var r;return null===(r=l_.getControlsRoles(e))||void 0===r?void 0:r.some((function(e){return e.type===t&&e.hasRole}))},hasCohost:function(e){return l_.hasRole(e,u_.Cohost)||!1},hasModerator:function(e){return l_.hasRole(e,u_.Moderator)||!1},hasPresenter:function(e){return l_.hasRole(e,u_.Presenter)||!1},extractControlRoles:function(e){return{cohost:l_.hasCohost(e),moderator:l_.hasModerator(e),presenter:l_.hasPresenter(e)}},isUser:function(e){return e&&e.type===sg},isModerator:function(e){return e&&e.moderator},isGuest:function(e){return e&&e.guest},isDevice:function(e){return e&&e.type===Wm},isModeratorAssignmentProhibited:function(e){return e&&e.moderatorAssignmentNotAllowed},isSame:function(e,t){return e&&(e.id===t||e.person&&e.person.id===t)},isAssociatedSame:function(e,t){return e&&e.associatedUsers&&e.associatedUsers.some((function(e){return e.id===t||e.person&&e.person.id===t}))},isNotAdmitted:function(e,t,r){return e&&e.guest&&(e.devices&&e.devices[0]&&e.devices[0].intent&&e.devices[0].intent.type===ug&&t&&r===Cm||!r===Rm)},isAudioMuted:function(e){if(!e)throw new zv("Audio could not be processed, participant is undefined.");return l_.isMuted(e,wp,Ep)},isVideoMuted:function(e){if(!e)throw new zv("Video could not be processed, participant is undefined.");return l_.isMuted(e,vm,gm)},isHandRaised:function(e){var t,r;if(!e)throw new zv("Raise hand could not be processed, participant is undefined.");return(null===(t=e.controls)||void 0===t||null===(r=t.hand)||void 0===r?void 0:r.raised)||!1},isBreakoutsSupported:function(e){if(!e)throw new zv("Breakout support could not be processed, participant is undefined.");return!e.doesNotSupportBreakouts},isInterpretationSupported:function(e){if(!e)throw new zv("Interpretation support could not be processed, participant is undefined.");return!e.doesNotSupportSiInterpreter},isLiveAnnotationSupported:function(e){if(!e)throw new zv("LiveAnnotation support could not be processed, participant is undefined.");return!e.annotatorAssignmentNotAllowed},isMuted:function(e,t,r){var n,i,o,s=null==e||null===(n=e.controls)||void 0===n||null===(i=n[r])||void 0===i?void 0:i.muted;if(!0===s)return!0;var a=null==e||null===(o=e.status)||void 0===o?void 0:o[t];return a===Jm||a!==tg&&s},getRecordingMember:function(e){return e&&e.record&&e.record.recording&&e.record.meta?e.record.meta.modifiedBy:null},isRecording:function(e){if(!e)throw new zv("Recording could not be processed, participant is undefined.");return!(!e.controls||!e.controls.localRecord)&&e.controls.localRecord.recording},isRemovable:function(e,t,r,n){return!t&&!e&&(n!==wm&&!!r)},isMutable:function(e,t,r,n,i){return!!r&&(!n&&(i!==wm&&!(!e&&!t)))},extractStatus:function(e){return e&&e.devices&&e.devices.length?e.state===Lm?Rm:e.state===Im?e.devices&&e.devices.length>0&&e.devices.find((function(e){return e.intent&&(e.intent.type===ug||e.intent.type===$m)}))?Cm:Gm:(e.state,Gm):Gm},extractId:function(e){return e?e.id:null},extractMediaStatus:function(e){var t,r;if(!e)throw new zv("Media status could not be extracted, participant is undefined.");return{audio:null===(t=e.status)||void 0===t?void 0:t.audioStatus,video:null===(r=e.status)||void 0===r?void 0:r.videoStatus}},extractName:function(e){return e&&e.person?e.person.name:null}};const d_=l_;var h_=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,k.Z)(this,e),(0,R.Z)(this,"associatedUser",void 0),(0,R.Z)(this,"canReclaimHost",void 0),(0,R.Z)(this,"id",void 0),(0,R.Z)(this,"isAudioMuted",void 0),(0,R.Z)(this,"isContentSharing",void 0),(0,R.Z)(this,"isDevice",void 0),(0,R.Z)(this,"isGuest",void 0),(0,R.Z)(this,"isHandRaised",void 0),(0,R.Z)(this,"isHost",void 0),(0,R.Z)(this,"isInLobby",void 0),(0,R.Z)(this,"isInMeeting",void 0),(0,R.Z)(this,"isModerator",void 0),(0,R.Z)(this,"isModeratorAssignmentProhibited",void 0),(0,R.Z)(this,"isMutable",void 0),(0,R.Z)(this,"isNotAdmitted",void 0),(0,R.Z)(this,"isRecording",void 0),(0,R.Z)(this,"isRemovable",void 0),(0,R.Z)(this,"isSelf",void 0),(0,R.Z)(this,"isUser",void 0),(0,R.Z)(this,"isVideoMuted",void 0),(0,R.Z)(this,"roles",void 0),(0,R.Z)(this,"mediaStatus",void 0),(0,R.Z)(this,"name",void 0),(0,R.Z)(this,"participant",void 0),(0,R.Z)(this,"status",void 0),(0,R.Z)(this,"supportsBreakouts",void 0),(0,R.Z)(this,"supportsInterpretation",void 0),(0,R.Z)(this,"supportLiveAnnotation",void 0),(0,R.Z)(this,"type",void 0),(0,R.Z)(this,"namespace",pg),this.canReclaimHost=!1,this.participant=null,this.id=null,this.name=null,this.isAudioMuted=null,this.isVideoMuted=null,this.isHandRaised=null,this.supportsBreakouts=null,this.supportLiveAnnotation=null,this.isSelf=null,this.isHost=null,this.isGuest=null,this.isInLobby=null,this.isInMeeting=null,this.isNotAdmitted=null,this.isContentSharing=null,this.status=null,this.isDevice=null,this.isUser=null,this.associatedUser=null,this.isRecording=null,this.isMutable=null,this.isRemovable=null,this.type=null,this.isModerator=null,this.isModeratorAssignmentProhibited=null,this.roles=null,this.mediaStatus={audio:null,video:null},this.processParticipant(t),this.processParticipantOptions(t,r),this.processMember()}return(0,O.Z)(e,[{key:"processParticipant",value:function(e){this.participant=e,e&&(this.canReclaimHost=d_.canReclaimHost(e),this.id=d_.extractId(e),this.name=d_.extractName(e),this.isAudioMuted=d_.isAudioMuted(e),this.isVideoMuted=d_.isVideoMuted(e),this.isHandRaised=d_.isHandRaised(e),this.supportsBreakouts=d_.isBreakoutsSupported(e),this.supportsInterpretation=d_.isInterpretationSupported(e),this.supportLiveAnnotation=d_.isLiveAnnotationSupported(e),this.isGuest=d_.isGuest(e),this.isUser=d_.isUser(e),this.isDevice=d_.isDevice(e),this.isModerator=d_.isModerator(e),this.isModeratorAssignmentProhibited=d_.isModeratorAssignmentProhibited(e),this.processStatus(e),this.processRoles(e),this.isNotAdmitted=d_.isNotAdmitted(e,this.isGuest,this.status))}},{key:"processParticipantOptions",value:function(e,t){e&&t&&(this.processIsSelf(e,t.selfId),this.processIsHost(e,t.hostId),this.processIsContentSharing(e,t.contentSharingId),this.processType(t.type),this.processIsRecording(e,t.recordingId))}},{key:"processMember",value:function(){this.isRemovable=d_.isRemovable(this.isSelf,this.isGuest,this.isInMeeting,this.type),this.isMutable=d_.isMutable(this.isSelf,this.isDevice,this.isInMeeting,this.isAudioMuted,this.type),this.mediaStatus=d_.extractMediaStatus(this.participant)}},{key:"processStatus",value:function(e){switch(this.status=d_.extractStatus(e),this.status){case Cm:this.isInLobby=!0,this.isInMeeting=!1;break;case Rm:this.isInLobby=!1,this.isInMeeting=!0;break;default:this.isInLobby=!1,this.isInMeeting=!1}}},{key:"setIsContentSharing",value:function(e){this.isContentSharing=e}},{key:"setIsHost",value:function(e){this.isHost=e}},{key:"setIsSelf",value:function(e){this.isSelf=e}},{key:"processIsContentSharing",value:function(e,t){d_.isUser(e)?this.isContentSharing=d_.isSame(e,t):d_.isDevice(e)&&(this.isContentSharing=d_.isAssociatedSame(e,t))}},{key:"processIsRecording",value:function(e,t){this.isRecording=d_.isSame(e,t)}},{key:"processIsSelf",value:function(e,t){d_.isUser(e)?this.isSelf=d_.isSame(e,t):d_.isDevice(e)&&(this.isSelf=d_.isAssociatedSame(e,t),this.associatedUser=t)}},{key:"processIsHost",value:function(e,t){d_.isUser(e)?this.isHost=d_.isSame(e,t):d_.isDevice(e)&&(this.isHost=d_.isAssociatedSame(e,t))}},{key:"processRoles",value:function(e){this.roles=d_.extractControlRoles(e)}},{key:"processType",value:function(e){this.type=e}}]),e}();function f_(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var p_=function(e){(0,A.Z)(r,e);var t=f_(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qg.RECLAIM_HOST_ROLE_EMPTY_OR_WRONG_KEY.MESSAGE,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,k.Z)(this,r),e=t.call(this,n),(0,R.Z)((0,x.Z)(e),"sdkMessage",void 0),(0,R.Z)((0,x.Z)(e),"error",void 0),(0,R.Z)((0,x.Z)(e),"code",void 0),Error.captureStackTrace&&Error.captureStackTrace((0,x.Z)(e),r),e.name=Qg.RECLAIM_HOST_ROLE_EMPTY_OR_WRONG_KEY.NAME,e.sdkMessage=n||Qg.RECLAIM_HOST_ROLE_EMPTY_OR_WRONG_KEY.MESSAGE,e.error=i,e.code=Qg.RECLAIM_HOST_ROLE_EMPTY_OR_WRONG_KEY.CODE,e}return(0,O.Z)(r)}((0,yp.Z)(Error)),m_=function(e){(0,A.Z)(r,e);var t=f_(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qg.RECLAIM_HOST_ROLE_NOT_SUPPORTED.MESSAGE,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,k.Z)(this,r),e=t.call(this,n),(0,R.Z)((0,x.Z)(e),"sdkMessage",void 0),(0,R.Z)((0,x.Z)(e),"error",void 0),(0,R.Z)((0,x.Z)(e),"code",void 0),Error.captureStackTrace&&Error.captureStackTrace((0,x.Z)(e),r),e.name=Qg.RECLAIM_HOST_ROLE_NOT_SUPPORTED.NAME,e.sdkMessage=n||Qg.RECLAIM_HOST_ROLE_NOT_SUPPORTED.MESSAGE,e.error=i,e.code=Qg.RECLAIM_HOST_ROLE_NOT_SUPPORTED.CODE,e}return(0,O.Z)(r)}((0,yp.Z)(Error)),g_=function(e){(0,A.Z)(r,e);var t=f_(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qg.RECLAIM_HOST_ROLE_NOT_ALLOWED.MESSAGE,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,k.Z)(this,r),e=t.call(this,n),(0,R.Z)((0,x.Z)(e),"sdkMessage",void 0),(0,R.Z)((0,x.Z)(e),"error",void 0),(0,R.Z)((0,x.Z)(e),"code",void 0),Error.captureStackTrace&&Error.captureStackTrace((0,x.Z)(e),r),e.name=Qg.RECLAIM_HOST_ROLE_NOT_ALLOWED.NAME,e.sdkMessage=n||Qg.RECLAIM_HOST_ROLE_NOT_ALLOWED.MESSAGE,e.error=i,e.code=Qg.RECLAIM_HOST_ROLE_NOT_ALLOWED.CODE,e}return(0,O.Z)(r)}((0,yp.Z)(Error)),v_=function(e){(0,A.Z)(r,e);var t=f_(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qg.RECLAIM_HOST_ROLE_IS_ALREADY_HOST.MESSAGE,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,k.Z)(this,r),e=t.call(this,n),(0,R.Z)((0,x.Z)(e),"sdkMessage",void 0),(0,R.Z)((0,x.Z)(e),"error",void 0),(0,R.Z)((0,x.Z)(e),"code",void 0),Error.captureStackTrace&&Error.captureStackTrace((0,x.Z)(e),r),e.name=Qg.RECLAIM_HOST_ROLE_IS_ALREADY_HOST.NAME,e.sdkMessage=n||Qg.RECLAIM_HOST_ROLE_IS_ALREADY_HOST.MESSAGE,e.error=i,e.code=Qg.RECLAIM_HOST_ROLE_IS_ALREADY_HOST.CODE,e}return(0,O.Z)(r)}((0,yp.Z)(Error)),y_=function(){function e(){(0,k.Z)(this,e),(0,R.Z)(this,"members",void 0),(0,R.Z)(this,"namespace",pg),this.members={}}return(0,O.Z)(e,[{key:"set",value:function(e,t){this.members[e]=t}},{key:"setAll",value:function(e){this.members=e}},{key:"get",value:function(e){return this.members[e]}},{key:"getAll",value:function(){return this.members}},{key:"reset",value:function(){this.members={}}}]),e}();function b_(e,t){var r=U()(e);if(p()){var n=p()(e);t&&(n=n.filter((function(t){return g()(e,t).enumerable}))),r.push.apply(r,n)}return r}var E_={generateAddMemberOptions:function(e,t,r){return{invitee:e,locusUrl:t,alertIfActive:r}},generateAdmitMemberOptions:function(e,t){return{locusUrl:t,memberIds:e}},getAddMemberBody:function(e){return{invitees:[{address:e.invitee.emailAddress||e.invitee.email||e.invitee.phoneNumber}],alertIfActive:e.alertIfActive}},getAdmitMemberRequestBody:function(e){var t=e.memberIds,r=e.sessionLocusUrls,n={admit:{participantIds:t}};return r?function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b_(Object(r),!0).forEach((function(t){(0,R.Z)(e,t,r[t])})):y()?E()(e,y()(r)):b_(Object(r)).forEach((function(t){S()(e,t,g()(r,t))}))}return e}({authorizingLocusUrl:r.authorizingLocusUrl},n):n},getAdmitMemberRequestParams:function(e){var t=E_.getAdmitMemberRequestBody(e),r=e.locusUrl,n=e.sessionLocusUrls,i=(null==n?void 0:n.mainLocusUrl)||r,o="".concat(i,"/").concat(Pp);return{method:tv.PUT,uri:o,body:t}},getAddMemberRequestParams:function(e){var t=E_.getAddMemberBody(e);return{method:tv.PUT,uri:e.locusUrl,body:t}},isInvalidInvitee:function(e){return!e||!(e.email||e.emailAddress||e.phoneNumber)||(e.phoneNumber?!Ng.E164_FORMAT.test(e.phoneNumber):!Lg.test(e.email||e.emailAddress))},getRemoveMemberRequestParams:function(e){var t={reason:e.reason},r="".concat(e.locusUrl,"/").concat(sm,"/").concat(e.memberId,"/").concat($p);return{method:tv.PUT,uri:r,body:t}},generateTransferHostMemberOptions:function(e,t,r){return{moderator:t,locusUrl:r,memberId:e}},generateRemoveMemberOptions:function(e,t){return{reason:Am,memberId:e,locusUrl:t}},generateMuteMemberOptions:function(e,t,r,n){return{memberId:e,muted:t,locusUrl:r,isAudio:n}},generateRaiseHandMemberOptions:function(e,t,r){return{memberId:e,raised:t,locusUrl:r}},generateRoleAssignmentMemberOptions:function(e,t,r){return{memberId:e,roles:t,locusUrl:r}},generateLowerAllHandsMemberOptions:function(e,t){return{requestingParticipantId:e,locusUrl:t}},generateEditDisplayNameMemberOptions:function(e,t,r,n){return{memberId:e,requestingParticipantId:t,alias:r,locusUrl:n}},getMuteMemberRequestParams:function(e){var t=!1===e.isAudio?"video":"audio",r=(0,R.Z)({},t,{muted:e.muted}),n="".concat(e.locusUrl,"/").concat(sm,"/").concat(e.memberId,"/").concat(Pp);return{method:tv.PATCH,uri:n,body:r}},getAddedRoleShape:function(e){var t={type:e.type,hasRole:e.hasRole};return e.hostKey&&(t.hostKey=e.hostKey),t},getRoleAssignmentMemberRequestParams:function(e){var t={role:{roles:[]}};e.roles.forEach((function(e){t.role.roles.push(E_.getAddedRoleShape(e))}));var r="".concat(e.locusUrl,"/").concat(sm,"/").concat(e.memberId,"/").concat(Pp);return{method:tv.PATCH,uri:r,body:t}},getRaiseHandMemberRequestParams:function(e){var t={hand:{raised:e.raised}},r="".concat(e.locusUrl,"/").concat(sm,"/").concat(e.memberId,"/").concat(Pp);return{method:tv.PATCH,uri:r,body:t}},getLowerAllHandsMemberRequestParams:function(e){var t={hand:{raised:!1},requestingParticipantId:e.requestingParticipantId},r="".concat(e.locusUrl,"/").concat(Pp);return{method:tv.PATCH,uri:r,body:t}},editDisplayNameMemberRequestParams:function(e){var t={aliasValue:e.alias,requestingParticipantId:e.requestingParticipantId},r="".concat(e.locusUrl,"/").concat(sm,"/").concat(e.memberId,"/").concat(_p);return{method:tv.POST,uri:r,body:t}},getTransferHostToMemberRequestParams:function(e){var t={role:{moderator:e.moderator}},r="".concat(e.locusUrl,"/").concat(sm,"/").concat(e.memberId,"/").concat(Pp);return{method:tv.PATCH,uri:r,body:t}},genderateSendDTMFOptions:function(e,t,r,n){return{url:e,tones:t,memberId:r,locusUrl:n}},generateSendDTMFRequestParams:function(e){var t=e.url,r=e.tones,n=e.memberId,i=e.locusUrl,o={device:{url:t},memberId:n,dtmf:{correlationId:gp().v4(),tones:r,direction:"transmit"}},s="".concat(i,"/").concat(sm,"/").concat(n,"/").concat(dm);return{method:tv.POST,uri:s,body:o}},cancelPhoneInviteOptions:function(e,t){return{invitee:e,locusUrl:t}},generateCancelInviteRequestParams:function(e){var t={actionType:Ym,invitees:[{address:e.invitee.phoneNumber}]};return{method:tv.PUT,uri:e.locusUrl,body:t}}};const w_=E_;var S_=["meeting"];function __(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var T_=function(e){(0,A.Z)(r,e);var t=__(r);function r(e,n){var i;(0,k.Z)(this,r);var o=e.meeting,s=r_(e,S_);return i=t.call(this,s,n),(0,R.Z)((0,x.Z)(i),"namespace",pg),(0,R.Z)((0,x.Z)(i),"locusDeltaRequest",void 0),i.locusDeltaRequest=eb.generateLocusDeltaRequest(o),i}return(0,O.Z)(r,[{key:"addMembers",value:function(e){if(e&&e.invitee&&e.invitee.emailAddress&&e.invitee.email&&e.invitee.phoneNumber&&e.locusUrl)throw new zv("invitee must be passed and the associated locus url for this meeting object must be defined.");var t=w_.getAddMemberRequestParams(e);return this.locusDeltaRequest(t)}},{key:"admitMember",value:function(e){if(!e||!e.locusUrl||!e.memberIds)throw new zv("memberIds must be an array passed and the associated locus url for this meeting object must be defined.");var t=w_.getAdmitMemberRequestParams(e);return this.locusDeltaRequest(t)}},{key:"removeMember",value:function(e){if(!e||!e.locusUrl||!e.memberId)throw new zv("memberId must be defined, and the associated locus url for this meeting object must be defined.");var t=w_.getRemoveMemberRequestParams(e);return this.locusDeltaRequest(t)}},{key:"muteMember",value:function(e){if(!e||!e.locusUrl||!e.memberId)throw new zv("memberId must be defined, and the associated locus url for this meeting object must be defined.");var t=w_.getMuteMemberRequestParams(e);return this.locusDeltaRequest(t)}},{key:"assignRolesMember",value:function(e){if(!e||!e.locusUrl||!e.memberId)throw new zv("memberId must be defined, and the associated locus url for this meeting object must be defined.");var t=w_.getRoleAssignmentMemberRequestParams(e);return this.locusDeltaRequest(t)}},{key:"raiseOrLowerHandMember",value:function(e){if(!e||!e.locusUrl||!e.memberId)throw new zv("memberId must be defined, and the associated locus url for this meeting object must be defined.");var t=w_.getRaiseHandMemberRequestParams(e);return this.locusDeltaRequest(t)}},{key:"lowerAllHandsMember",value:function(e){if(!e||!e.locusUrl||!e.requestingParticipantId)throw new zv("requestingParticipantId must be defined, and the associated locus url for this meeting object must be defined.");var t=w_.getLowerAllHandsMemberRequestParams(e);return this.locusDeltaRequest(t)}},{key:"editDisplayNameMember",value:function(e){if(!e||!e.locusUrl||!e.requestingParticipantId)throw new zv("requestingParticipantId must be defined, and the associated locus url for this meeting object must be defined.");var t=w_.editDisplayNameMemberRequestParams(e);return this.locusDeltaRequest(t)}},{key:"transferHostToMember",value:function(e){if(!(e&&e.locusUrl&&e.memberId&&e.moderator))throw new zv("memberId must be defined, the associated locus url, and the moderator for this meeting object must be defined.");var t=w_.getTransferHostToMemberRequestParams(e);return this.locusDeltaRequest(t)}},{key:"sendDialPadKey",value:function(e){if(!e||!e.locusUrl||!e.memberId||!e.url||!e.tones&&0!==e.tones)throw new zv("memberId must be defined, the associated locus url, the device url and DTMF tones for this meeting object must be defined.");var t=w_.generateSendDTMFRequestParams(e);return this.locusDeltaRequest(t)}},{key:"cancelPhoneInvite",value:function(e){var t;if(!(null!=e&&null!==(t=e.invitee)&&void 0!==t&&t.phoneNumber||null!=e&&e.locusUrl))throw new zv("invitee must be passed and the associated locus url for this meeting object must be defined.");var r=w_.generateCancelInviteRequestParams(e);return this.locusDeltaRequest(r)}}]),r}(l.XR);function x_(e,t){var r=U()(e);if(p()){var n=p()(e);t&&(n=n.filter((function(t){return g()(e,t).enumerable}))),r.push.apply(r,n)}return r}function A_(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var I_=function(e){(0,A.Z)(r,e);var t=A_(r);function r(e,n){var i;return(0,k.Z)(this,r),i=t.call(this,{},n),(0,R.Z)((0,x.Z)(i),"hostId",void 0),(0,R.Z)((0,x.Z)(i),"locusUrl",void 0),(0,R.Z)((0,x.Z)(i),"mediaShareContentId",void 0),(0,R.Z)((0,x.Z)(i),"mediaShareWhiteboardId",void 0),(0,R.Z)((0,x.Z)(i),"membersCollection",void 0),(0,R.Z)((0,x.Z)(i),"membersRequest",void 0),(0,R.Z)((0,x.Z)(i),"receiveSlotManager",void 0),(0,R.Z)((0,x.Z)(i),"mediaRequestManagers",void 0),(0,R.Z)((0,x.Z)(i),"recordingId",void 0),(0,R.Z)((0,x.Z)(i),"selfId",void 0),(0,R.Z)((0,x.Z)(i),"type",void 0),(0,R.Z)((0,x.Z)(i),"namespace",pg),i.membersRequest=new T_({meeting:e.meeting},n),i.membersCollection=new y_,i.locusUrl=e.locusUrl||null,i.hostId=null,i.type=null,i.selfId=null,i.mediaShareContentId=null,i.mediaShareWhiteboardId=null,i.recordingId=null,i.receiveSlotManager=e.receiveSlotManager,i.mediaRequestManagers=e.mediaRequestManagers,i}return(0,O.Z)(r,[{key:"locusSelfUpdate",value:function(e){var t=null,r=null;if(e&&(e.newSelf&&(t=e.newSelf.id),e.oldSelf&&(r=e.oldSelf.id)),t){var n=this.membersCollection.get(t);n&&n.setIsSelf(!0)}if(r){var i=this.membersCollection.get(r);i&&i.setIsSelf(!1)}this.selfId=t,Qv.trigger(this,{file:"members",function:"locusSelfUpdate"},$g.MEMBERS_SELF_UPDATE,{activeSelfId:t,endedSelfId:r})}},{key:"locusHostUpdate",value:function(e){var t=null,r=null;if(e&&(e.newHost&&(t=e.newHost.id),e.oldHost&&(r=e.oldHost.id)),t){var n=this.membersCollection.get(t);n&&n.setIsHost(!0)}if(r){var i=this.membersCollection.get(r);i&&i.setIsHost(!1)}this.hostId=t,Qv.trigger(this,{file:"members",function:"locusHostUpdate"},$g.MEMBERS_HOST_UPDATE,{activeHostId:t,endedHostId:r})}},{key:"clearMembers",value:function(){this.membersCollection.reset(),Qv.trigger(this,{file:"members",function:"clearMembers"},$g.MEMBERS_CLEAR,{})}},{key:"locusParticipantsUpdate",value:function(e){if(e){var t;e.isReplace&&this.clearMembers();var r=this.handleLocusInfoUpdatedParticipants(e),n=this.handleMembersUpdate(r);null===(t=this.receiveSlotManager)||void 0===t||t.updateMemberIds(),Qv.trigger(this,{file:"members",function:"locusParticipantsUpdate"},$g.MEMBERS_UPDATE,{delta:r,full:n,isReplace:!!e.isReplace})}}},{key:"locusMediaSharesUpdate",value:function(e){var t,r,n,i,o=null===(t=e.current)||void 0===t?void 0:t.content,s=null===(r=e.previous)||void 0===r?void 0:r.content,a=null===(n=e.current)||void 0===n?void 0:n.whiteboard,c=null===(i=e.previous)||void 0===i?void 0:i.whiteboard,u=null,l=null;if(null!=o&&o.beneficiaryId&&(o.disposition===Xg.GRANTED&&(u=o.beneficiaryId,this.mediaShareWhiteboardId=null,this.mediaShareContentId=u),(null==s?void 0:s.disposition)===Xg.GRANTED&&(o.disposition===Xg.RELEASED?(l=o.beneficiaryId,this.mediaShareContentId=null):o.disposition===Xg.GRANTED&&o.beneficiaryId!==s.beneficiaryId&&(l=s.beneficiaryId))),null!=a&&a.beneficiaryId&&(a.disposition===Xg.GRANTED&&(u=a.beneficiaryId,this.mediaShareContentId=null,this.mediaShareWhiteboardId=u),(null==c?void 0:c.disposition)===Xg.GRANTED&&(a.disposition===Xg.RELEASED?(l=a.beneficiaryId,this.mediaShareWhiteboardId=null):a.disposition===Xg.GRANTED&&a.beneficiaryId!==c.beneficiaryId&&(l=c.beneficiaryId))),u){var d=this.membersCollection.get(u);d&&d.setIsContentSharing(!0)}if(l){var h=this.membersCollection.get(l);h&&h.setIsContentSharing(!1)}Qv.trigger(this,{file:"members",function:"locusMediaSharesUpdate"},$g.MEMBERS_CONTENT_UPDATE,{activeSharingId:u,endedSharingId:l})}},{key:"locusUrlUpdate",value:function(e){e&&this.setLocusUrl(null,e)}},{key:"locusFullStateTypeUpdate",value:function(e){e&&this.setType(e)}},{key:"handleMembersUpdate",value:function(e){return e&&(e.updated&&this.constructMembers(e.updated),e.added&&this.constructMembers(e.added)),this.membersCollection.getAll()}},{key:"constructMembers",value:function(e){var t=this;e.forEach((function(e){t.membersCollection.set(e.id,e)}))}},{key:"handleLocusInfoUpdatedParticipants",value:function(e){return this.hostId=e.hostId||this.hostId,this.selfId=e.selfId||this.selfId,this.recordingId=e.recordingId,e.participants||pp.logger.warn("Members:index#handleLocusInfoUpdatedParticipants --\x3e participants payload is missing."),this.update(e.participants)}},{key:"setLocusUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t)this.locusUrl=t;else{if(!e||!e.locusUrl&&!e.url)throw new zv("Setting locusUrl for the Members module should be done with a locus object or locusUrl");this.locusUrl=e.locusUrl||e.url}}},{key:"setHostId",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t)this.hostId=t;else{if(!e)throw new zv("Setting hostid for the Members module should be done with a locus object or hostId");this.hostId=e&&e.owner&&e.owner.info?e.owner.info:null}}},{key:"setType",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t)this.type=t;else{if(!e)throw new zv("Setting type for the Members module should be done with a fullstate object or type string");this.type=e&&e.type||null}}},{key:"setSelfId",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t)this.selfId=t;else{if(!e)throw new zv("Setting selfid for the Members module should be done with a locus object or selfId");this.selfId=e&&e.self&&e.self.person&&e.self.person.id?e.self.person.id:null}}},{key:"setMediaShareContentId",value:function(e,t){if(t)this.mediaShareContentId=t;else{if(!e)throw new zv("Setting hostid for the Members module should be done with a locus object or hostId");var r=e.mediaShares&&e.mediaShares.length&&e.mediaShares.find((function(e){return e.name===Lp}));this.mediaShareContentId=r&&r.floor&&r.floor.beneficiary&&r.floor.beneficiary.id||null}}},{key:"setMediaShareWhiteboardId",value:function(e,t){if(t)this.mediaShareWhiteboardId=t;else{if(!e)throw new zv("Setting hostid for the Members module should be done with a locus object or hostId");var r=e.mediaShares&&e.mediaShares.length&&e.mediaShares.find((function(e){return e.name===Mp}));this.mediaShareWhiteboardId=r&&r.floor&&r.floor.beneficiary&&r.floor.beneficiary.id||null}}},{key:"update",value:function(e){var t=this,r={added:[],updated:[]};return e&&e.forEach((function(e){e.hideInRoster||(t.membersCollection.get(e.id)?r.updated.push(new h_(e,{recordingId:t.recordingId,selfId:t.selfId,hostId:t.hostId,contentSharingId:t.mediaShareContentId,whiteboardSharingId:t.mediaShareWhiteboardId,type:t.type})):r.added.push(new h_(e,{recordingId:t.recordingId,selfId:t.selfId,hostId:t.hostId,contentSharingId:t.mediaShareContentId,whiteboardSharingId:t.mediaShareWhiteboardId,type:t.type})))})),r}},{key:"addMember",value:function(e,t){if(!this.locusUrl)return P().reject(new zv("The associated locus url for this meeting object must be defined."));if(w_.isInvalidInvitee(e))return P().reject(new zv("The invitee must be defined with either a valid email, emailAddress or phoneNumber property."));var r=w_.generateAddMemberOptions(e,this.locusUrl,t);return this.membersRequest.addMembers(r)}},{key:"cancelPhoneInvite",value:function(e){if(!this.locusUrl)return P().reject(new zv("The associated locus url for this meeting object must be defined."));if(w_.isInvalidInvitee(e))return P().reject(new zv("The invitee must be defined with a valid phoneNumber property."));var t=w_.cancelPhoneInviteOptions(e,this.locusUrl);return this.membersRequest.cancelPhoneInvite(t)}},{key:"admitMembers",value:function(e,t){if($E()(e))return P().reject(new zv("No member ids provided to admit."));var r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x_(Object(r),!0).forEach((function(t){(0,R.Z)(e,t,r[t])})):y()?E()(e,y()(r)):x_(Object(r)).forEach((function(t){S()(e,t,g()(r,t))}))}return e}({sessionLocusUrls:t},w_.generateAdmitMemberOptions(e,this.locusUrl));return this.membersRequest.admitMember(r)}},{key:"removeMember",value:function(e){if(!this.locusUrl)return P().reject(new zv("The associated locus url for this meeting object must be defined."));if(!e)return P().reject(new zv("The member id must be defined to remove the member."));var t=w_.generateRemoveMemberOptions(e,this.locusUrl);return this.membersRequest.removeMember(t)}},{key:"muteMember",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!this.locusUrl)return P().reject(new zv("The associated locus url for this meetings members object must be defined."));if(!e)return P().reject(new zv("The member id must be defined to mute the member."));var n=w_.generateMuteMemberOptions(e,t,this.locusUrl,r);return this.membersRequest.muteMember(n)}},{key:"assignRoles",value:function(e,t){if(!this.locusUrl)return P().reject(new zv("The associated locus url for this meetings members object must be defined."));if(!e)return P().reject(new zv("The member id must be defined to assign the roles to a member."));var r=w_.generateRoleAssignmentMemberOptions(e,t,this.locusUrl);return this.membersRequest.assignRolesMember(r).catch((function(e){var t;switch(null===(t=e.body)||void 0===t?void 0:t.errorCode){case Vg.ReclaimHostNotSupportedErrorCode:return P().reject(new m_);case Vg.ReclaimHostNotAllowedErrorCode:return P().reject(new g_);case Vg.ReclaimHostEmptyWrongKeyErrorCode:return P().reject(new p_);case Vg.ReclaimHostIsHostAlreadyErrorCode:return P().reject(new v_);default:return P().reject(e)}}))}},{key:"raiseOrLowerHand",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.locusUrl)return P().reject(new zv("The associated locus url for this meetings members object must be defined."));if(!e)return P().reject(new zv("The member id must be defined to raise/lower the hand of the member."));var r=w_.generateRaiseHandMemberOptions(e,t,this.locusUrl);return this.membersRequest.raiseOrLowerHandMember(r)}},{key:"lowerAllHands",value:function(e){if(!this.locusUrl)return P().reject(new zv("The associated locus url for this meetings members object must be defined."));if(!e)return P().reject(new zv("The requestingMemberId must be defined to lower all hands in a meeting."));var t=w_.generateLowerAllHandsMemberOptions(e,this.locusUrl);return this.membersRequest.lowerAllHandsMember(t)}},{key:"transferHostToMember",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.locusUrl)return P().reject(new zv("The associated locus url for this meetings members object must be defined."));if(!e)return P().reject(new zv("The member id must be defined to transfer host to the member."));var r=w_.generateTransferHostMemberOptions(e,t,this.locusUrl);return this.membersRequest.transferHostToMember(r)}},{key:"sendDialPadKey",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!e&&0!==e)return P().reject(new zv("DMTF tones must be passed in"));var r=this.membersCollection.get(t);if(!r)return P().reject(new zv("there is no member associated with that Id"));var n=this.locusUrl,i=r.participant.devices.find((function(e){return"SIP"===e.deviceType})),o=null==i?void 0:i.url;if(n&&o){var s=w_.genderateSendDTMFOptions(o,e,t,n);return this.membersRequest.sendDialPadKey(s)}return P().reject(new Error('Members:index#sendDialPadKey --\x3e cannot send DTMF, meeting does not have a connection to the "locus" call control service.'))}},{key:"findMemberByCsi",value:function(e){return F()(this.membersCollection.getAll()).find((function(t){var r,n;return null===(r=t.participant)||void 0===r||null===(n=r.devices)||void 0===n?void 0:n.find((function(t){var r;return null===(r=t.csis)||void 0===r?void 0:r.find((function(t){return t===e}))}))}))}},{key:"getCsisForMember",value:function(e){var t,r,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main",s=[];return null===(t=this.membersCollection.get(e))||void 0===t||null===(r=t.participant)||void 0===r||null===(n=r.devices)||void 0===n||n.forEach((function(e){if(e.mediaSessions){var t,r=null===(t=e.mediaSessions)||void 0===t?void 0:t.filter((function(e){return e.mediaType===i&&e.mediaContent===o})).map((function(e){return e.csi}));s.push.apply(s,(0,_.Z)(r))}})),s}},{key:"editDisplayName",value:function(e,t,r){if(!this.locusUrl)return P().reject(new zv("The associated locus url for this meetings members object must be defined."));if(!e)return P().reject(new zv("The member id must be defined to edit display name of the member."));var n=this.locusUrl,i=w_.generateEditDisplayNameMemberOptions(e,t,r,n);return this.membersRequest.editDisplayNameMember(i)}}]),r}(l.XR),C_={getMeetingAddedType:function(e){return e===Dm?km:Sm},handleRoapMercury:function(e,t){var r=e.data;if(r.eventType===lv.MESSAGE_ROAP){var n=t.getByKey(Ap,r.correlationId);if(n){var i=r.message,o=i.seq,s=i.messageType,a=i.tieBreaker,c=i.errorType,u=i.errorCause;if(sp.sendBehavioralMetric(db,{correlation_id:r.correlationId,seq:o,message_type:s,error_type:c,error_cause:u}),s===Av.ROAP_TYPES.TURN_DISCOVERY_RESPONSE)n.roap.turnDiscovery.handleTurnDiscoveryResponse(r.message,"from mercury");else{var l,d={seq:o,messageType:s,sdp:(null===(l=r.message.sdps)||void 0===l?void 0:l.length)>0?r.message.sdps[0]:void 0,tieBreaker:a,errorType:c,errorCause:u};n.roapMessageReceived(d)}}}},getMediaServer:function(e){var t;try{t=e.split("\r\n").find((function(e){return e.startsWith("o=")})).split(" ").shift().replace("o=","")}catch(e){t=void 0}return t},checkForCorrelationId:function(e,t){var r=[];if(t){t&&t.self&&t.self.devices&&(r=t.self.devices);var n=r.find((function(t){return t.url===e}));if(n&&n.correlationId)return n.correlationId}return!1},parseDefaultSiteFromMeetingPreferences:function(e){var t,r="";if(null!=e&&null!==(t=e.sites)&&void 0!==t&&t.length){var n=e.sites.find((function(e){return e.default}));r=n?n.siteUrl:e.sites[0].siteUrl}return r}};C_.hasH264Codec=(0,T.Z)(V().mark((function e(){var t,r;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,e.prev=1,r=new window.RTCPeerConnection,e.next=5,r.createOffer({offerToReceiveVideo:!0});case 5:e.sent.sdp.match(/^a=rtpmap:\d+\s+H264\/\d+/m)&&(t=!0),r.close(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),pp.logger.warn("Meetings:util#hasH264Codec --\x3e Error creating peerConnection for H.264 test.");case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,null,[[1,10]])}))),C_.checkH264Support=function(){var e=(0,T.Z)(V().mark((function e(t){var r,n,i,o,s,a,c,u=this;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=C_.hasH264Codec,i=(n=t||{}).firstChecked,o=n.disableNotifications,s=5e3,3e5,a=void 0===i,c=i&&D()()-i>=3e5,!o){e.next=9;break}return r(),e.abrupt("return");case 9:return e.next=11,r();case 11:if(!e.sent){e.next=15;break}return Qv.trigger(this,{file:"meetings/util",function:"checkH264Support"},$g.MEDIA_CODEC_LOADED),pp.logger.log("Meetings:util#checkH264Support --\x3e H264 codec loaded successfully."),e.abrupt("return");case 15:if(!c){e.next=18;break}return pp.logger.error("Meetings:util#checkH264Support --\x3e Timed out waiting for H264 codec to load."),e.abrupt("return");case 18:a&&(Qv.trigger(this,{file:"meetings/util",function:"checkH264Support"},$g.MEDIA_CODEC_MISSING),pp.logger.log("Meetings:util#checkH264Support --\x3e H264 codec is missing.")),window.setTimeout((function(){var e=i||D()();C_.checkH264Support.call(u,{firstChecked:e})}),s);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),C_.getThisDevice=function(e,t){var r,n;return(null==e||null===(r=e.self)||void 0===r||null===(n=r.devices)||void 0===n?void 0:n.length)>0?e.self.devices.find((function(e){return e.url===t})):null},C_.joinedOnThisDevice=function(e,t,r){var n=C_.getThisDevice(t,r);return!(!n||n.correlationId&&(null==e?void 0:e.correlationId)!==n.correlationId)&&(n.state===Lm||n.state===Mm&&n.reason===Um)},C_.isBreakoutLocusDTO=function(e){var t,r;return(null==e||null===(t=e.controls)||void 0===t||null===(r=t.breakout)||void 0===r?void 0:r.sessionType)===av.SESSION_TYPES.BREAKOUT},C_.isValidBreakoutLocus=function(e){var t,r,n=(null==e||null===(t=e.fullState)||void 0===t?void 0:t.state)===ov.STATE.INACTIVE,i=C_.isBreakoutLocusDTO(e),o=(null===(r=e.self)||void 0===r?void 0:r.state)===Lm;return i&&!n&&o};const R_=C_;var k_=function(e){return e.Start="Start",e.Stop="Stop",e.Pause="Pause",e.Resume="Resume",e}(k_||{});const O_=k_;const N_={canUserStart:function(e,t){return e.includes(mv.RECORDING_CONTROL_START)&&eb.selfSupportsFeature(pv.SUPPORT_NETWORK_BASED_RECORD,t)},canUserPause:function(e,t){return e.includes(mv.RECORDING_CONTROL_PAUSE)&&eb.selfSupportsFeature(pv.SUPPORT_NETWORK_BASED_RECORD,t)},canUserResume:function(e,t){return e.includes(mv.RECORDING_CONTROL_RESUME)&&eb.selfSupportsFeature(pv.SUPPORT_NETWORK_BASED_RECORD,t)},canUserStop:function(e,t){return e.includes(mv.RECORDING_CONTROL_STOP)&&eb.selfSupportsFeature(pv.SUPPORT_NETWORK_BASED_RECORD,t)},deriveRecordingStates:function(e){var t,r;switch(e){case O_.Start:t=!0,r=!1;break;case O_.Stop:t=!1,r=!1;break;case O_.Resume:t=!0,r=!1;break;case O_.Pause:t=!0,r=!0;break;default:throw new Error("Recording state cannot be derived from invalid action: ".concat(e))}return{recording:t,paused:r}},extractLocusId:function(e){return null==e?void 0:e.split("/").pop()}};var P_=function(e){return e.disallowUnmute="DisallowUnmute",e.muteOnEntry="MuteOnEntry",e.muted="Muted",e}(P_||{}),L_=function(e){return e.audio="audio",e.raiseHand="raiseHand",e.reactions="reactions",e.shareControl="shareControl",e.video="video",e.viewTheParticipantList="viewTheParticipantList",e}(L_||{});var D_=function(){function e(){(0,k.Z)(this,e)}return(0,O.Z)(e,null,[{key:"canSetMuteOnEntry",value:function(e){return e.includes(mv.ENABLE_MUTE_ON_ENTRY)}},{key:"canSetDisallowUnmute",value:function(e){return e.includes(mv.ENABLE_HARD_MUTE)}},{key:"canUnsetMuteOnEntry",value:function(e){return e.includes(mv.DISABLE_MUTE_ON_ENTRY)}},{key:"canUnsetDisallowUnmute",value:function(e){return e.includes(mv.DISABLE_HARD_MUTE)}},{key:"canSetMuted",value:function(e){return e.includes(mv.MUTE_ALL)}},{key:"canUnsetMuted",value:function(e){return e.includes(mv.UNMUTE_ALL)}},{key:"hasHints",value:function(e){var t=e.requiredHints,r=e.displayHints;return t.every((function(e){return r.includes(e)}))}},{key:"hasPolicies",value:function(e){var t=e.requiredPolicies,r=e.policies,n=void 0===r?{}:r;return t.every((function(e){return n[e]}))}},{key:"canUpdateAudio",value:function(t,r){var n=[];return!0===t.properties.muted&&n.push(mv.MUTE_ALL),!1===t.properties.muted&&n.push(mv.UNMUTE_ALL),!0===t.properties.disallowUnmute&&n.push(mv.ENABLE_HARD_MUTE),!1===t.properties.disallowUnmute&&n.push(mv.DISABLE_HARD_MUTE),!0===t.properties.muteOnEntry&&n.push(mv.ENABLE_MUTE_ON_ENTRY),!1===t.properties.muteOnEntry&&n.push(mv.DISABLE_MUTE_ON_ENTRY),e.hasHints({requiredHints:n,displayHints:r})}},{key:"canUpdateRaiseHand",value:function(t,r){var n=[];return!0===t.properties.enabled&&n.push(mv.ENABLE_RAISE_HAND),!1===t.properties.enabled&&n.push(mv.DISABLE_RAISE_HAND),e.hasHints({requiredHints:n,displayHints:r})}},{key:"canUpdateReactions",value:function(t,r){var n=[];return void 0!==t.properties.showDisplayNameWithReactions?(!0===t.properties.showDisplayNameWithReactions&&n.push(mv.ENABLE_SHOW_DISPLAY_NAME),!1===t.properties.showDisplayNameWithReactions&&n.push(mv.DISABLE_SHOW_DISPLAY_NAME)):(!0===t.properties.enabled&&n.push(mv.ENABLE_REACTIONS),!1===t.properties.enabled&&n.push(mv.DISABLE_REACTIONS)),e.hasHints({requiredHints:n,displayHints:r})}},{key:"canUpdateShareControl",value:function(t){return e.hasHints({requiredHints:[mv.SHARE_CONTROL],displayHints:t})}},{key:"canUpdateViewTheParticipantsList",value:function(t,r){var n=[];return!0===t.properties.enabled&&n.push(mv.ENABLE_VIEW_THE_PARTICIPANT_LIST),!1===t.properties.enabled&&n.push(mv.DISABLE_VIEW_THE_PARTICIPANT_LIST),e.hasHints({requiredHints:n,displayHints:r})}},{key:"canUpdateVideo",value:function(t,r){var n=[];return!0===t.properties.enabled&&n.push(mv.ENABLE_VIDEO),!1===t.properties.enabled&&n.push(mv.DISABLE_VIDEO),e.hasHints({requiredHints:n,displayHints:r})}},{key:"canUpdate",value:function(t,r){var n;switch(t.scope){case L_.audio:n=e.canUpdateAudio(t,r);break;case L_.raiseHand:n=e.canUpdateRaiseHand(t,r);break;case L_.reactions:n=e.canUpdateReactions(t,r);break;case L_.shareControl:n=e.canUpdateShareControl(r);break;case L_.video:n=e.canUpdateVideo(t,r);break;case L_.viewTheParticipantList:n=e.canUpdateViewTheParticipantsList(t,r);break;default:n=!1}return n}}]),e}();const M_=D_;var U_={createMediaStream:function(e){e||pp.logger.error("Media:util#createMediaStream --\x3e Tracks don't exist");var t=e.filter((function(e){return!!e}));return new MediaStream(t)}};const B_=U_;var F_={smile:{type:"smile",codepoints:"1F642",shortcodes:":slightly_smiling_face:"},sad:{type:"sad",codepoints:"1F625",shortcodes:":sad_but_relieved_face:"},wow:{type:"wow",codepoints:"1F62E",shortcodes:":open_mouth:"},haha:{type:"haha",codepoints:"1F603",shortcodes:":smiley:"},celebrate:{type:"celebrate",codepoints:"1F389",shortcodes:":party_popper:"},clap:{type:"clap",codepoints:"1F44F",shortcodes:":clap:"},thumb_up:{type:"thumb_up",codepoints:"1F44D",shortcodes:":thumbsup:"},thumb_down:{type:"thumb_down",codepoints:"1F44E",shortcodes:":thumbsdown:"},heart:{type:"heart",codepoints:"2764",shortcodes:":heart:"},fire:{type:"fire",codepoints:"1F525",shortcodes:":fire:"},prayer:{type:"prayer",codepoints:"1F64F",shortcodes:":pray:"},speed_up:{type:"speed_up",codepoints:"1F407",shortcodes:":rabbit:"},slow_down:{type:"slow_down",codepoints:"1F422",shortcodes:":turtle:"}},j_={normal:{type:"normal_skin_tone",codepoints:"",shortcodes:""},light:{type:"light_skin_tone",codepoints:"1F3FB",shortcodes:":skin-tone-2:"},medium_light:{type:"medium_light_skin_tone",codepoints:"1F3FC",shortcodes:":skin-tone-3:"},medium:{type:"medium_skin_tone",codepoints:"1F3FD",shortcodes:":skin-tone-4:"},medium_dark:{type:"medium_dark_skin_tone",codepoints:"1F3FE",shortcodes:":skin-tone-5:"},dark:{type:"dark_skin_tone",codepoints:"1F3FF",shortcodes:":skin-tone-6:"}};function V_(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function H_(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,V_(e,t,"get"))}function G_(e,t,r){return function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,V_(e,t,"set"),r),r}var q_=r(83977),$_=r.n(q_);function Z_(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}function z_(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}var K_="sourceUpdate",W_="maxFsUpdate",J_=0,Y_=new($_()),Q_=new($_()),X_=new($_()),eT=function(e){(0,A.Z)(r,e);var t=Z_(r);function r(e,n,i){var o;return(0,k.Z)(this,r),o=t.call(this),(0,R.Z)((0,x.Z)(o),"mcReceiveSlot",void 0),(0,R.Z)((0,x.Z)(o),"findMemberIdCallback",void 0),(0,R.Z)((0,x.Z)(o),"id",void 0),(0,R.Z)((0,x.Z)(o),"mediaType",void 0),z_((0,x.Z)(o),Y_,{writable:!0,value:void 0}),z_((0,x.Z)(o),Q_,{writable:!0,value:void 0}),z_((0,x.Z)(o),X_,{writable:!0,value:void 0}),J_+=1,o.findMemberIdCallback=i,o.mediaType=e,o.mcReceiveSlot=n,G_((0,x.Z)(o),X_,"no source"),o.id="r".concat(J_),o.setupEventListeners(),o}return(0,O.Z)(r,[{key:"memberId",get:function(){return H_(this,Y_)}},{key:"csi",get:function(){return H_(this,Q_)}},{key:"setMaxFs",value:function(e){this.emit({file:"meeting/receiveSlot",function:"findMemberId"},W_,{maxFs:e})}},{key:"sourceState",get:function(){return H_(this,X_)}},{key:"setupEventListeners",value:function(){var e=this,t={file:"meeting/receiveSlot",function:"setupEventListeners"};this.mcReceiveSlot.on(ls.SourceUpdate,(function(r,n){pp.logger.log("ReceiveSlot#setupEventListeners --\x3e got source update on receive slot ".concat(e.id,", mediaType=").concat(e.mediaType,", csi=").concat(n,", state=").concat(r)),G_(e,Y_,n?e.findMemberIdCallback(n):void 0),G_(e,Q_,n),G_(e,X_,r),e.emit(t,K_,{state:H_(e,X_),csi:H_(e,Q_),memberId:H_(e,Y_)})}))}},{key:"findMemberId",value:function(){void 0===H_(this,Y_)&&H_(this,Q_)&&(G_(this,Y_,this.findMemberIdCallback(H_(this,Q_))),H_(this,Y_)&&this.emit({file:"meeting/receiveSlot",function:"findMemberId"},K_,{state:H_(this,X_),csi:H_(this,Q_),memberId:H_(this,Y_)}))}},{key:"logString",get:function(){return"ReceiveSlot - ".concat(this.id,": ").concat(uy()(this.mcReceiveSlot.id))}},{key:"stream",get:function(){return this.mcReceiveSlot.stream}},{key:"wcmeReceiveSlot",get:function(){return this.mcReceiveSlot}}]),r}(aw),tT=function(){function e(t,r){(0,k.Z)(this,e),(0,R.Z)(this,"allocatedSlots",void 0),(0,R.Z)(this,"freeSlots",void 0),(0,R.Z)(this,"createSlotCallback",void 0),(0,R.Z)(this,"findMemberIdByCsiCallback",void 0),this.allocatedSlots=(0,R.Z)((0,R.Z)((0,R.Z)((0,R.Z)({},Pn.AudioMain,[]),Pn.VideoMain,[]),Pn.AudioSlides,[]),Pn.VideoSlides,[]),this.freeSlots=(0,R.Z)((0,R.Z)((0,R.Z)((0,R.Z)({},Pn.AudioMain,[]),Pn.VideoMain,[]),Pn.AudioSlides,[]),Pn.VideoSlides,[]),this.createSlotCallback=t,this.findMemberIdByCsiCallback=r}var t;return(0,O.Z)(e,[{key:"allocateSlot",value:(t=(0,T.Z)(V().mark((function e(t){var r,n,i;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.freeSlots[t].pop())){e.next=5;break}return this.allocatedSlots[t].push(r),pp.logger.log("".concat(t,": receive slot re-used: ").concat(r.id)),e.abrupt("return",r);case 5:return e.next=7,this.createSlotCallback(t);case 7:return n=e.sent,i=new eT(t,n,this.findMemberIdByCsiCallback),this.allocatedSlots[t].push(i),pp.logger.log("".concat(t,": new receive slot allocated: ").concat(i.id)),e.abrupt("return",i);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"releaseSlot",value:function(e){var t=this.allocatedSlots[e.mediaType].findIndex((function(t){return t===e}));t>=0?(this.allocatedSlots[e.mediaType].splice(t,1),this.freeSlots[e.mediaType].push(e),pp.logger.log("".concat(e.mediaType,": receive slot released: ").concat(e.id))):pp.logger.warn("ReceiveSlotManager#releaseSlot --\x3e trying to release a ".concat(e.mediaType,"} slot that is not managed by this ReceiveSlotManager"))}},{key:"reset",value:function(){this.allocatedSlots=(0,R.Z)((0,R.Z)((0,R.Z)((0,R.Z)({},Pn.AudioMain,[]),Pn.VideoMain,[]),Pn.AudioSlides,[]),Pn.VideoSlides,[]),this.freeSlots=(0,R.Z)((0,R.Z)((0,R.Z)((0,R.Z)({},Pn.AudioMain,[]),Pn.VideoMain,[]),Pn.AudioSlides,[]),Pn.VideoSlides,[])}},{key:"getStats",value:function(){var e=this,t={},r={};return U()(this.allocatedSlots).forEach((function(r){e.allocatedSlots[r].length>0&&(t[r]=e.allocatedSlots[r].length)})),U()(this.freeSlots).forEach((function(t){e.freeSlots[t].length>0&&(r[t]=e.freeSlots[t].length)})),{numAllocatedSlots:t,numFreeSlots:r}}},{key:"updateMemberIds",value:function(){var e=this;U()(this.allocatedSlots).forEach((function(t){e.allocatedSlots[t].forEach((function(e){e.findMemberId()}))}))}},{key:"findReceiveSlotBySsrc",value:function(e){return F()(this.allocatedSlots).flat().find((function(t){var r,n;return e&&(null===(r=t.wcmeReceiveSlot)||void 0===r||null===(n=r.id)||void 0===n?void 0:n.ssrc)===e}))}}]),e}(),rT=function(){function e(t){(0,k.Z)(this,e),(0,R.Z)(this,"slots",new(tw())),(0,R.Z)(this,"LoggerProxy",void 0),this.LoggerProxy=t}var t,r,n,i;return(0,O.Z)(e,[{key:"createSlot",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.slots.has(t))throw new Error("Slot for ".concat(t," already exists"));var n=e.createSendSlot(t,r);return this.slots.set(t,n),this.LoggerProxy.logger.info("SendSlotsManager->createSlot#Created slot for ".concat(t," with active ").concat(r)),n}},{key:"getSlot",value:function(e){var t=this.slots.get(e);if(!t)throw new Error("Slot for ".concat(e," does not exist"));return t}},{key:"publishStream",value:(i=(0,T.Z)(V().mark((function e(t,r){var n;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.slots.get(t)){e.next=3;break}throw new Error("Slot for ".concat(t," does not exist"));case 3:return e.next=5,n.publishStream(r);case 5:this.LoggerProxy.logger.info("SendSlotsManager->publishStream#Published stream for ".concat(t," and stream with label ").concat(r.label," and muted ").concat(r.muted));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"unpublishStream",value:(n=(0,T.Z)(V().mark((function e(t){var r;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.slots.get(t)){e.next=3;break}throw new Error("Slot for ".concat(t," does not exist"));case 3:return e.next=5,r.unpublishStream();case 5:this.LoggerProxy.logger.info("SendSlotsManager->unpublishStream#Unpublished stream for ".concat(t));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"setActive",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.slots.get(e);if(!r)throw new Error("Slot for ".concat(e," does not exist"));r.active=t,this.LoggerProxy.logger.info("SendSlotsManager->setActive#Set active for ".concat(e," to ").concat(t))}},{key:"setCodecParameters",value:(r=(0,T.Z)(V().mark((function e(t,r){var n;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.slots.get(t)){e.next=3;break}throw new Error("Slot for ".concat(t," does not exist"));case 3:return e.next=5,n.setCodecParameters(r);case 5:this.LoggerProxy.logger.info("SendSlotsManager->setCodecParameters#Set codec parameters for ".concat(t," to ").concat(r));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"deleteCodecParameters",value:(t=(0,T.Z)(V().mark((function e(t,r){var n;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.slots.get(t)){e.next=3;break}throw new Error("Slot for ".concat(t," does not exist"));case 3:return e.next=5,n.deleteCodecParameters(r);case 5:this.LoggerProxy.logger.info("SendSlotsManager->deleteCodecParameters#Deleted the following codec parameters -> ".concat(r," for ").concat(t));case 6:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})},{key:"reset",value:function(){this.slots.clear()}}]),e}(),nT=r(53888),iT=r.n(nT);function oT(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var sT={SourceUpdate:K_,Stopped:"stopped"};function aT(e){var t;switch(e){case"thumbnail":t=60;break;case"very small":t=240;break;case"small":t=920;break;case"medium":t=3600;break;case"large":case"best":t=8192;break;default:pp.logger.warn("RemoteMedia#getMaxFs --\x3e unsupported paneSize: ".concat(e,', using "medium" instead')),t=3600}return t}var cT=0,uT=function(e){(0,A.Z)(r,e);var t=oT(r);function r(e,n,i){var o;return(0,k.Z)(this,r),o=t.call(this),(0,R.Z)((0,x.Z)(o),"receiveSlot",void 0),(0,R.Z)((0,x.Z)(o),"mediaRequestManager",void 0),(0,R.Z)((0,x.Z)(o),"options",void 0),(0,R.Z)((0,x.Z)(o),"mediaRequestId",void 0),(0,R.Z)((0,x.Z)(o),"id",void 0),cT+=1,o.receiveSlot=e,o.mediaRequestManager=n,o.options=i||{},o.setupEventListeners(),o.id="RM".concat(cT,"-").concat(o.receiveSlot.id),o}return(0,O.Z)(r,[{key:"setSizeHint",value:function(e,t){var r,n;n=t<135?60:t<270?240:t<540?920:t<=720?3600:8192,null===(r=this.receiveSlot)||void 0===r||r.setMaxFs(n)}},{key:"stop",value:function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.cancelMediaRequest(t),null===(e=this.receiveSlot)||void 0===e||e.removeAllListeners(),this.receiveSlot=void 0,this.emit({file:"multistream/remoteMedia",function:"stop"},sT.Stopped,{})}},{key:"sendMediaRequest",value:function(e,t){if(this.mediaRequestId&&this.cancelMediaRequest(!1),!this.receiveSlot)throw new Error("sendMediaRequest() called on an invalidated RemoteMedia instance");this.mediaRequestId=this.mediaRequestManager.addRequest({policyInfo:{policy:"receiver-selected",csi:e},receiveSlots:[this.receiveSlot],codecInfo:this.options.resolution&&{codec:"h264",maxFs:aT(this.options.resolution)}},t)}},{key:"cancelMediaRequest",value:function(e){this.mediaRequestId&&(this.mediaRequestManager.cancelRequest(this.mediaRequestId,e),this.mediaRequestId=void 0)}},{key:"setupEventListeners",value:function(){var e=this;if(this.receiveSlot){var t={file:"multistream/remoteMedia",function:"setupEventListeners"};this.receiveSlot.on(K_,(function(r){e.emit(t,sT.SourceUpdate,r)}))}}},{key:"mediaType",get:function(){var e;return null===(e=this.receiveSlot)||void 0===e?void 0:e.mediaType}},{key:"memberId",get:function(){var e;return null===(e=this.receiveSlot)||void 0===e?void 0:e.memberId}},{key:"csi",get:function(){var e;return null===(e=this.receiveSlot)||void 0===e?void 0:e.csi}},{key:"sourceState",get:function(){var e;return null===(e=this.receiveSlot)||void 0===e?void 0:e.sourceState}},{key:"stream",get:function(){var e;return null===(e=this.receiveSlot)||void 0===e?void 0:e.stream}},{key:"getUnderlyingReceiveSlot",value:function(){return this.receiveSlot}}]),r}(aw),lT={maxFs:8192,maxFps:3e3,maxMbps:245760},dT=function(){function e(t,r){(0,k.Z)(this,e),(0,R.Z)(this,"sendMediaRequestsCallback",void 0),(0,R.Z)(this,"kind",void 0),(0,R.Z)(this,"counter",void 0),(0,R.Z)(this,"clientRequests",void 0),(0,R.Z)(this,"degradationPreferences",void 0),(0,R.Z)(this,"sourceUpdateListener",void 0),(0,R.Z)(this,"debouncedSourceUpdateListener",void 0),(0,R.Z)(this,"previousStreamRequests",[]),(0,R.Z)(this,"trimRequestsToNumOfSources",void 0),(0,R.Z)(this,"numTotalSources",void 0),(0,R.Z)(this,"numLiveSources",void 0),this.sendMediaRequestsCallback=t,this.counter=0,this.numLiveSources=0,this.numTotalSources=0,this.clientRequests={},this.degradationPreferences=r.degradationPreferences,this.kind=r.kind,this.trimRequestsToNumOfSources=r.trimRequestsToNumOfSources,this.sourceUpdateListener=this.commit.bind(this),this.debouncedSourceUpdateListener=i_()(this.sourceUpdateListener,1e3)}return(0,O.Z)(e,[{key:"setDegradationPreferences",value:function(e){this.degradationPreferences=e,this.sendRequests()}},{key:"getDegradedClientRequests",value:function(e){for(var t=this,r=[aT("best"),aT("large"),aT("medium"),aT("small"),aT("very small"),aT("thumbnail")],n=function(n){var i=0;if(F()(e).forEach((function(e){if(e.codecInfo){e.codecInfo.maxFs=Math.min(e.preferredMaxFs||lT.maxFs,e.codecInfo.maxFs||lT.maxFs,r[n]);var t=e.receiveSlots.filter((function(e){return"live"===e.sourceState}));i+=e.codecInfo.maxFs*t.length}})),i<=t.degradationPreferences.maxMacroblocksLimit)return 0!==n&&pp.logger.warn("multistream:mediaRequestManager --\x3e too many streams with high max-fs, frame size will be limited to ".concat(r[n])),1;n===r.length-1&&pp.logger.warn("multistream:mediaRequestManager --\x3e even with frame size limited to ".concat(r[n]," you are still requesting too many streams, consider reducing the number of requests"))},i=0;i<r.length&&!n(i);i+=1);}},{key:"isEqual",value:function(e,t){return uy()(e._toJmpStreamRequest())===uy()(t._toJmpStreamRequest())}},{key:"checkIsNewRequestsEqualToPrev",value:function(e){var t=this;return!$E()(this.previousStreamRequests)&&this.previousStreamRequests.length===e.length&&this.previousStreamRequests.every((function(r,n){return t.isEqual(r,e[n])}))}},{key:"getMaxPayloadBitsPerSecond",value:function(e){return"audio"===this.kind?wi.FB_MONO_MUSIC:function(e){e<60&&Ei(Hn.GET_MAX_BITRATE_FAILED,"Requested max video frame size cannot be less than 60.");var t=[...Si.keys()].sort(((e,t)=>t-e)).find((t=>e>=t));return Si.get(t)}(e.codecInfo.maxFs||lT.maxFs)}},{key:"getH264MaxMbps",value:function(e){var t=e.codecInfo.maxFps||lT.maxFps;return e.codecInfo.maxFs*t/100}},{key:"clearPreviousRequests",value:function(){this.previousStreamRequests=[]}},{key:"trimRequests",value:function(e){var t=this.getPreferLiveVideo();if(this.trimRequestsToNumOfSources&&void 0!==t){var r=t?this.numLiveSources:this.numTotalSources;F()(e).sort((function(e,t){return"receiver-selected"===e.policyInfo.policy?-1:"receiver-selected"===t.policyInfo.policy?1:t.policyInfo.priority-e.policyInfo.priority})).forEach((function(e){if("active-speaker"===e.policyInfo.policy){var t=Math.min(r,e.receiveSlots.length);e.receiveSlots.length=t,r-=t}else r-=e.receiveSlots.length;r<0&&(r=0)}))}}},{key:"getPreferLiveVideo",value:function(){var e;return F()(this.clientRequests).forEach((function(t){if("active-speaker"===t.policyInfo.policy&&(void 0===e&&(e=t.policyInfo.preferLiveVideo),t.policyInfo.preferLiveVideo!==e))throw new Error("a mix of active-speaker groups with different values for preferLiveVideo is not supported")})),e}},{key:"cloneClientRequests",value:function(){return iT()(this.clientRequests,(function(e,t){if("receiveSlots"===t)return(0,_.Z)(e)}))}},{key:"sendRequests",value:function(){var e=this,t=[],r=this.cloneClientRequests();this.trimRequests(r),this.getDegradedClientRequests(r),F()(r).forEach((function(r){r.receiveSlots.length>0&&t.push(new Fa("active-speaker"===r.policyInfo.policy?Nn.ActiveSpeaker:Nn.ReceiverSelected,"active-speaker"===r.policyInfo.policy?new $n(r.policyInfo.priority,r.policyInfo.crossPriorityDuplication,r.policyInfo.crossPolicyDuplication,r.policyInfo.preferLiveVideo):new si(r.policyInfo.csi),r.receiveSlots.map((function(e){return e.wcmeReceiveSlot})),e.getMaxPayloadBitsPerSecond(r),r.codecInfo&&[new ii(128,new ni(r.codecInfo.maxFs,r.codecInfo.maxFps||lT.maxFps,e.getH264MaxMbps(r),r.codecInfo.maxWidth,r.codecInfo.maxHeight))]))})),this.checkIsNewRequestsEqualToPrev(t)?pp.logger.info("multistream:sendRequests --\x3e detected duplicate WCME requests, skipping them... "):(this.sendMediaRequestsCallback(t),this.previousStreamRequests=t,pp.logger.info("multistream:sendRequests --\x3e media requests sent. "))}},{key:"addRequest",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n="".concat(this.counter++);this.clientRequests[n]=e;return e.handleMaxFs=function(r){var n=r.maxFs;e.preferredMaxFs=n,t.debouncedSourceUpdateListener()},e.receiveSlots.forEach((function(r){r.on(K_,t.sourceUpdateListener),r.on(W_,e.handleMaxFs)})),r&&this.commit(),n}},{key:"cancelRequest",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.clientRequests[e];null==n||n.receiveSlots.forEach((function(e){e.off(K_,t.sourceUpdateListener),e.off(W_,n.handleMaxFs)})),delete this.clientRequests[e],r&&this.commit()}},{key:"commit",value:function(){return this.sendRequests()}},{key:"reset",value:function(){this.clientRequests={},this.numTotalSources=0,this.numLiveSources=0}},{key:"setNumCurrentSources",value:function(e,t){this.numTotalSources=e,this.numLiveSources=t,this.sendRequests()}}]),e}(),hT=r(82729),fT=r.n(hT),pT=r(84486),mT=r.n(pT),gT=function(){function e(t,r,n,i){var o=this,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};(0,k.Z)(this,e),(0,R.Z)(this,"mediaRequestManager",void 0),(0,R.Z)(this,"priority",void 0),(0,R.Z)(this,"options",void 0),(0,R.Z)(this,"unpinnedRemoteMedia",void 0),(0,R.Z)(this,"mediaRequestId",void 0),(0,R.Z)(this,"pinnedRemoteMedia",void 0),this.mediaRequestManager=t,this.priority=n,this.options=s,this.unpinnedRemoteMedia=r.map((function(e){return new uT(e,o.mediaRequestManager,{resolution:o.options.resolution})})),this.pinnedRemoteMedia=[],this.sendActiveSpeakerMediaRequest(i)}return(0,O.Z)(e,[{key:"getRemoteMedia",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";return"unpinned"===e?(0,_.Z)(this.unpinnedRemoteMedia):"pinned"===e?(0,_.Z)(this.pinnedRemoteMedia):[].concat((0,_.Z)(this.unpinnedRemoteMedia),(0,_.Z)(this.pinnedRemoteMedia))}},{key:"setActiveSpeakerCsis",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];mT()(e,(function(e){var r=e.csi,n=e.remoteMedia;if(r){if(!(t.pinnedRemoteMedia.indexOf(n)>=0)){var i=t.unpinnedRemoteMedia.indexOf(n);if(!(i>=0))throw new Error("failed to pin a remote media object ".concat(n.id,", because it is not found in this remote media group"));t.unpinnedRemoteMedia.splice(i,1),t.pinnedRemoteMedia.push(n)}n.sendMediaRequest(r,!1)}else{if(!(t.unpinnedRemoteMedia.indexOf(n)>=0)){var o=t.pinnedRemoteMedia.indexOf(n);if(!(o>=0))throw new Error("failed to unpin a remote media object ".concat(n.id,", because it is not found in this remote media group"));t.pinnedRemoteMedia.splice(o,1),t.unpinnedRemoteMedia.push(n)}n.cancelMediaRequest(!1)}})),this.cancelActiveSpeakerMediaRequest(!1),this.sendActiveSpeakerMediaRequest(!1),r&&this.mediaRequestManager.commit()}},{key:"pin",value:function(e,t){var r=t||e.csi;if(!r)throw new Error("failed to pin a remote media object ".concat(e.id,", because it has no CSI set and no CSI value was given"));if(this.pinnedRemoteMedia.indexOf(e)>=0){if(r===e.csi)return void pp.logger.log("RemoteMediaGroup#pin --\x3e remote media ".concat(e.id," already pinned"))}else{var n=this.unpinnedRemoteMedia.indexOf(e);if(n<0)throw new Error("failed to pin a remote media object ".concat(e.id,", because it is not found in this remote media group"));this.unpinnedRemoteMedia.splice(n,1),this.pinnedRemoteMedia.push(e),this.cancelActiveSpeakerMediaRequest(!1),this.sendActiveSpeakerMediaRequest(!1)}e.sendMediaRequest(r,!1),this.mediaRequestManager.commit()}},{key:"unpin",value:function(e){if(this.unpinnedRemoteMedia.indexOf(e)>=0)pp.logger.log("RemoteMediaGroup#pin --\x3e remote media ".concat(e.id," already unpinned"));else{var t=this.pinnedRemoteMedia.indexOf(e);if(t<0)throw new Error("failed to unpin a remote media object ".concat(e.id,", because it is not found in this remote media group"));this.pinnedRemoteMedia.splice(t,1),this.unpinnedRemoteMedia.push(e),e.cancelMediaRequest(!1),this.cancelActiveSpeakerMediaRequest(!1),this.sendActiveSpeakerMediaRequest(!1),this.mediaRequestManager.commit()}}},{key:"isPinned",value:function(e){if(this.unpinnedRemoteMedia.indexOf(e)>=0)return!1;if(this.pinnedRemoteMedia.indexOf(e)>=0)return!0;throw new Error("remote media object ".concat(e.id," not found in the group"))}},{key:"setPreferLiveVideo",value:function(e,t){this.options.preferLiveVideo!==e&&(this.options.preferLiveVideo=e,this.sendActiveSpeakerMediaRequest(t))}},{key:"sendActiveSpeakerMediaRequest",value:function(e){var t;this.cancelActiveSpeakerMediaRequest(!1),this.mediaRequestId=this.mediaRequestManager.addRequest({policyInfo:{policy:"active-speaker",priority:this.priority,crossPriorityDuplication:!1,crossPolicyDuplication:!1,preferLiveVideo:!(null===(t=this.options)||void 0===t||!t.preferLiveVideo)},receiveSlots:this.unpinnedRemoteMedia.map((function(e){return e.getUnderlyingReceiveSlot()})),codecInfo:this.options.resolution&&{codec:"h264",maxFs:aT(this.options.resolution)}},e)}},{key:"cancelActiveSpeakerMediaRequest",value:function(e){this.mediaRequestId&&(this.mediaRequestManager.cancelRequest(this.mediaRequestId,e),this.mediaRequestId=void 0)}},{key:"stop",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.unpinnedRemoteMedia.forEach((function(e){return e.stop(!1)})),this.pinnedRemoteMedia.forEach((function(e){return e.stop(!1)})),this.cancelActiveSpeakerMediaRequest(!1),e&&this.mediaRequestManager.commit()}},{key:"includes",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";return"pinned"===t?this.pinnedRemoteMedia.includes(e):"unpinned"===t?this.unpinnedRemoteMedia.includes(e):this.unpinnedRemoteMedia.includes(e)||this.pinnedRemoteMedia.includes(e)}}]),e}();function vT(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var yT={audio:{numOfActiveSpeakerStreams:3,numOfScreenShareStreams:1},video:{preferLiveVideo:!0,initialLayoutId:"AllEqual",layouts:{AllEqual:{activeSpeakerVideoPaneGroups:[{id:"main",numPanes:9,size:"best",priority:255}]},OnePlusFive:{activeSpeakerVideoPaneGroups:[{id:"mainBigOne",numPanes:1,size:"large",priority:255},{id:"secondarySetOfSmallPanes",numPanes:5,size:"very small",priority:254}]},Single:{activeSpeakerVideoPaneGroups:[{id:"main",numPanes:1,size:"best",priority:255}]},Stage:{activeSpeakerVideoPaneGroups:[{id:"thumbnails",numPanes:6,size:"thumbnail",priority:255}],memberVideoPanes:[{id:"stage-1",size:"medium",csi:void 0},{id:"stage-2",size:"medium",csi:void 0},{id:"stage-3",size:"medium",csi:void 0},{id:"stage-4",size:"medium",csi:void 0}]},ScreenShareView:{screenShareVideo:{size:"best"},activeSpeakerVideoPaneGroups:[{id:"thumbnails",numPanes:8,size:"thumbnail",priority:255}]}}}},bT=function(e){return e.AudioCreated="AudioCreated",e.ScreenShareAudioCreated="ScreenShareAudioCreated",e.VideoLayoutChanged="VideoLayoutChanged",e}({}),ET=function(e){(0,A.Z)(l,e);var t,r,n,i,o,s,a,c,u=vT(l);function l(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:yT;return(0,k.Z)(this,l),r=u.call(this),(0,R.Z)((0,x.Z)(r),"config",void 0),(0,R.Z)((0,x.Z)(r),"started",void 0),(0,R.Z)((0,x.Z)(r),"receiveSlotManager",void 0),(0,R.Z)((0,x.Z)(r),"mediaRequestManagers",void 0),(0,R.Z)((0,x.Z)(r),"currentLayout",void 0),(0,R.Z)((0,x.Z)(r),"slots",void 0),(0,R.Z)((0,x.Z)(r),"media",void 0),(0,R.Z)((0,x.Z)(r),"receiveSlotAllocations",void 0),(0,R.Z)((0,x.Z)(r),"currentLayoutId",void 0),r.started=!1,r.config=n,r.receiveSlotManager=e,r.mediaRequestManagers=t,r.media={audio:void 0,video:{activeSpeakerGroups:{},memberPanes:{}},screenShare:{audio:void 0,video:void 0}},r.checkConfigValidity(),r.slots={audio:[],screenShare:{audio:[],video:void 0},video:{unused:[],activeSpeaker:[],receiverSelected:[]}},r.receiveSlotAllocations={activeSpeaker:{},receiverSelected:{}},pp.logger.log("RemoteMediaManager#constructor --\x3e RemoteMediaManager created with config: ".concat(uy()(r.config))),r}return(0,O.Z)(l,[{key:"checkConfigValidity",value:function(){if(!(this.config.video.initialLayoutId in this.config.video.layouts))throw new Error('invalid config: initialLayoutId "'.concat(this.config.video.initialLayoutId,"\" doesn't match any of the layouts"));F()(this.config.video.layouts).forEach((function(e){var t,r,n={},i={},o={};null===(t=e.activeSpeakerVideoPaneGroups)||void 0===t||t.forEach((function(e){if(n[e.id])throw new Error("invalid config: duplicate active speaker video pane group id: ".concat(e.id));if(n[e.id]=!0,o[e.priority])throw new Error("invalid config: multiple active speaker video pane groups have same priority: ".concat(e.priority));o[e.priority]=!0})),null===(r=e.memberVideoPanes)||void 0===r||r.forEach((function(e){if(i[e.id])throw new Error("invalid config: duplicate member video pane id: ".concat(e.id));i[e.id]=!0}))}))}},{key:"start",value:(c=(0,T.Z)(V().mark((function e(){return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.started){e.next=2;break}throw new Error("start() failure: already started");case 2:return this.started=!0,e.next=5,this.createAudioMedia();case 5:return e.next=7,this.createScreenShareReceiveSlots();case 7:return this.createScreenShareAudioMedia(),e.next=10,this.preallocateVideoReceiveSlots();case 10:return e.next=12,this.setLayout(this.config.video.initialLayoutId);case 12:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"stop",value:function(){var e,t,r=this;this.invalidateCurrentRemoteMedia({audio:!0,video:!0,screenShareAudio:!0,screenShareVideo:!0,commit:!0}),this.slots.audio.forEach((function(e){return r.receiveSlotManager.releaseSlot(e)})),this.slots.audio.length=0,this.slots.screenShare.audio.forEach((function(e){return r.receiveSlotManager.releaseSlot(e)})),this.slots.screenShare.audio.length=0,this.slots.screenShare.video&&(this.receiveSlotManager.releaseSlot(this.slots.screenShare.video),this.slots.screenShare.video=void 0),this.receiveSlotAllocations={activeSpeaker:{},receiverSelected:{}},(e=this.slots.video.unused).push.apply(e,(0,_.Z)(this.slots.video.activeSpeaker)),this.slots.video.activeSpeaker.length=0,(t=this.slots.video.unused).push.apply(t,(0,_.Z)(this.slots.video.receiverSelected)),this.slots.video.receiverSelected.length=0,this.releaseUnusedVideoSlots(),this.currentLayout=void 0,this.currentLayoutId=void 0,this.started=!1}},{key:"getRequiredNumVideoSlotsForLayout",value:function(e){var t,r;return e?((null===(t=e.activeSpeakerVideoPaneGroups)||void 0===t?void 0:t.reduce((function(e,t){return e+t.numPanes}),0))||0)+((null===(r=e.memberVideoPanes)||void 0===r?void 0:r.length)||0):0}},{key:"preallocateVideoReceiveSlots",value:(a=(0,T.Z)(V().mark((function e(){var t,r=this;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=F()(this.config.video.layouts).reduce((function(e,t){return Math.max(e,r.getRequiredNumVideoSlotsForLayout(t))}),0);case 1:if(!(this.slots.video.unused.length<t)){e.next=9;break}return e.t0=this.slots.video.unused,e.next=5,this.receiveSlotManager.allocateSlot(Pn.VideoMain);case 5:e.t1=e.sent,e.t0.push.call(e.t0,e.t1),e.next=1;break;case 9:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"setLayout",value:(s=(0,T.Z)(V().mark((function e(t){return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t in this.config.video.layouts){e.next=2;break}throw new Error('invalid layoutId: "'.concat(t,"\" doesn't match any of the configured layouts"));case 2:if(this.started){e.next=4;break}throw new Error("setLayout() called before start()");case 4:return pp.logger.log("RemoteMediaManager#setLayout --\x3e new layout selected: ".concat(t)),this.currentLayoutId=t,this.currentLayout=Iy()(this.config.video.layouts[this.currentLayoutId]),e.next=9,this.updateVideoReceiveSlots();case 9:this.updateVideoRemoteMediaObjects(),this.updateScreenShareVideoRemoteMediaObject(),this.emitVideoLayoutChangedEvent();case 12:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"getLayoutId",value:function(){return this.currentLayoutId}},{key:"setPreferLiveVideo",value:function(e){pp.logger.log("RemoteMediaManager#setPreferLiveVideo --\x3e setPreferLiveVideo is called to set preferLiveVideo to ".concat(e)),this.config.video.preferLiveVideo=e,F()(this.media.video.activeSpeakerGroups).forEach((function(t){t.setPreferLiveVideo(e,!1)})),this.mediaRequestManagers.video.commit()}},{key:"setActiveSpeakerCsis",value:function(e){F()(this.media.video.activeSpeakerGroups).forEach((function(t){var r=e.filter((function(e){var r=e.remoteMedia;return t.includes(r)}));r.length>0&&t.setActiveSpeakerCsis(r,!1)})),this.mediaRequestManagers.video.commit()}},{key:"createAudioMedia",value:(o=(0,T.Z)(V().mark((function e(){var t,r;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(!(t<this.config.audio.numOfActiveSpeakerStreams)){e.next=9;break}return e.next=4,this.receiveSlotManager.allocateSlot(Pn.AudioMain);case 4:r=e.sent,this.slots.audio.push(r);case 6:t+=1,e.next=1;break;case 9:this.media.audio=new gT(this.mediaRequestManagers.audio,this.slots.audio,255,!0),this.emit({file:"multistream/remoteMediaManager",function:"createAudioMedia"},bT.AudioCreated,this.media.audio);case 11:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"createScreenShareReceiveSlots",value:(i=(0,T.Z)(V().mark((function e(){var t,r;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(!(t<this.config.audio.numOfScreenShareStreams)){e.next=9;break}return e.next=4,this.receiveSlotManager.allocateSlot(Pn.AudioSlides);case 4:r=e.sent,this.slots.screenShare.audio.push(r);case 6:t+=1,e.next=1;break;case 9:if(!F()(this.config.video.layouts).some((function(e){return!!e.screenShareVideo}))){e.next=14;break}return e.next=13,this.receiveSlotManager.allocateSlot(Pn.VideoSlides);case 13:this.slots.screenShare.video=e.sent;case 14:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"createScreenShareAudioMedia",value:function(){this.slots.screenShare.audio.length>0&&(this.media.screenShare.audio=new gT(this.mediaRequestManagers.screenShareAudio,this.slots.screenShare.audio,255,!0),this.emit({file:"multistream/remoteMediaManager",function:"createScreenShareAudioMedia"},bT.ScreenShareAudioCreated,this.media.screenShare.audio))}},{key:"trimReceiverSelectedSlots",value:function(){var e,t,r,n={};null===(e=this.currentLayout)||void 0===e||null===(t=e.memberVideoPanes)||void 0===t||t.forEach((function(e){void 0!==e.csi&&(n[e.csi]=!0)}));var i=fT()(this.slots.video.receiverSelected,(function(e){return!1==(void 0!==(t=e.csi)&&!!n[t]);var t}));(r=this.slots.video.unused).push.apply(r,(0,_.Z)(i))}},{key:"releaseUnusedVideoSlots",value:function(){var e=this;this.slots.video.unused.forEach((function(t){return e.receiveSlotManager.releaseSlot(t)})),this.slots.video.unused.length=0}},{key:"allocateSlotsToActiveSpeakerPaneGroups",value:function(){var e,t,r,n=this;null===(e=this.currentLayout)||void 0===e||null===(t=e.activeSpeakerVideoPaneGroups)||void 0===t||null===(r=t.sort((function(e,t){return e.priority<t.priority?1:-1})))||void 0===r||r.forEach((function(e){n.receiveSlotAllocations.activeSpeaker[e.id]={slots:[]};for(var t=0;t<e.numPanes;t+=1){var r=n.slots.video.unused.shift();r&&(n.slots.video.activeSpeaker.push(r),n.receiveSlotAllocations.activeSpeaker[e.id].slots.push(r))}}))}},{key:"allocateSlotsToReceiverSelectedVideoPaneGroups",value:function(){var e,t,r=this;null===(e=this.currentLayout)||void 0===e||null===(t=e.memberVideoPanes)||void 0===t||t.forEach((function(e){var t=r.slots.video.receiverSelected.find((function(t){return t.csi===e.csi})),n=F()(r.receiveSlotAllocations.receiverSelected).includes(t);if(void 0!==e.csi&&t&&!n)r.receiveSlotAllocations.receiverSelected[e.id]=t;else{var i=r.slots.video.unused.pop();i&&(r.slots.video.receiverSelected.push(i),r.receiveSlotAllocations.receiverSelected[e.id]=i)}}))}},{key:"refillRequiredSlotsIfNeeded",value:(n=(0,T.Z)(V().mark((function e(){var t,r,n;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getRequiredNumVideoSlotsForLayout(this.currentLayout),!((r=this.slots.video.unused.length+this.slots.video.activeSpeaker.length+this.slots.video.receiverSelected.length)<t)){e.next=13;break}n=t-r;case 4:if(!(n>0)){e.next=13;break}return e.t0=this.slots.video.unused,e.next=8,this.receiveSlotManager.allocateSlot(Pn.VideoMain);case 8:e.t1=e.sent,e.t0.push.call(e.t0,e.t1),n-=1,e.next=4;break;case 13:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"trimActiveSpeakerSlots",value:function(){var e;(e=this.slots.video.unused).push.apply(e,(0,_.Z)(this.slots.video.activeSpeaker)),this.slots.video.activeSpeaker.length=0}},{key:"logMainVideoReceiveSlots",value:function(){var e="";mT()(this.receiveSlotAllocations.activeSpeaker,(function(t,r){e+="\ngroup: ".concat(r,"\n").concat(t.slots.map((function(e){return e.logString})).join(", "))})),e+="\nreceiverSelected:\n",mT()(this.receiveSlotAllocations.receiverSelected,(function(t,r){e+=" ".concat(r,": ").concat(t.logString,"\n")})),pp.logger.log("RemoteMediaManager#logMainVideoReceiveSlots --\x3e MAIN VIDEO receive slots: unused=".concat(this.slots.video.unused.length,", activeSpeaker=").concat(this.slots.video.activeSpeaker.length,", receiverSelected=").concat(this.slots.video.receiverSelected.length).concat(e))}},{key:"logMainAudioReceiveSlots",value:function(){pp.logger.log("RemoteMediaManager#logMainAudioReceiveSlots --\x3e MAIN AUDIO receive slots: ".concat(this.slots.audio.map((function(e){return e.logString})).join(", ")))}},{key:"logSlidesVideoReceiveSlots",value:function(){var e;pp.logger.log("RemoteMediaManager#logSlidesVideoReceiveSlots --\x3e SLIDES VIDEO receive slot: ".concat(null===(e=this.slots.screenShare.video)||void 0===e?void 0:e.logString))}},{key:"logSlidesAudioReceiveSlots",value:function(){pp.logger.log("RemoteMediaManager#logSlidesAudioReceiveSlots --\x3e SLIDES AUDIO receive slots: ".concat(this.slots.screenShare.audio.map((function(e){return e.logString})).join(", ")))}},{key:"logAllReceiveSlots",value:function(){this.logMainVideoReceiveSlots(),this.logMainAudioReceiveSlots(),this.logSlidesVideoReceiveSlots(),this.logSlidesAudioReceiveSlots()}},{key:"updateVideoReceiveSlots",value:(r=(0,T.Z)(V().mark((function e(){return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.trimActiveSpeakerSlots(),this.trimReceiverSelectedSlots(),e.next=4,this.refillRequiredSlotsIfNeeded();case 4:this.receiveSlotAllocations={activeSpeaker:{},receiverSelected:{}},this.allocateSlotsToActiveSpeakerPaneGroups(),this.allocateSlotsToReceiverSelectedVideoPaneGroups(),this.logMainVideoReceiveSlots(),this.releaseUnusedVideoSlots();case 9:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"updateVideoRemoteMediaObjects",value:function(){var e=this;this.invalidateCurrentRemoteMedia({audio:!1,video:!0,screenShareAudio:!1,screenShareVideo:!1,commit:!1}),this.media.video.activeSpeakerGroups={},this.media.video.memberPanes={};for(var t=function(){var t,i,o=(0,xy.Z)(n[r],2),s=o[0],a=o[1],c=null===(t=e.currentLayout)||void 0===t||null===(i=t.activeSpeakerVideoPaneGroups)||void 0===i?void 0:i.find((function(e){return e.id===s}));if(c){var u=new gT(e.mediaRequestManagers.video,a.slots,c.priority,!1,{preferLiveVideo:e.config.video.preferLiveVideo,resolution:c.size});e.media.video.activeSpeakerGroups[s]=u}else pp.logger.warn("a group id ".concat(s," from this.receiveSlotAllocations.activeSpeaker cannot be found in the current layout configuration"))},r=0,n=uS()(this.receiveSlotAllocations.activeSpeaker);r<n.length;r++)t();for(var i=function(){var t,r,n=(0,xy.Z)(s[o],2),i=n[0],a=n[1],c=null===(t=e.currentLayout)||void 0===t||null===(r=t.memberVideoPanes)||void 0===r?void 0:r.find((function(e){return e.id===i}));if(c){var u=new uT(a,e.mediaRequestManagers.video,{resolution:c.size});c.csi&&u.sendMediaRequest(c.csi,!1),e.media.video.memberPanes[i]=u}else pp.logger.warn("a pane id ".concat(i," from this.receiveSlotAllocations.receiverSelected cannot be found in the current layout configuration"))},o=0,s=uS()(this.receiveSlotAllocations.receiverSelected);o<s.length;o++)i();this.mediaRequestManagers.video.commit()}},{key:"updateScreenShareVideoRemoteMediaObject",value:function(){var e;this.invalidateCurrentRemoteMedia({audio:!1,video:!1,screenShareAudio:!1,screenShareVideo:!0,commit:!1}),this.media.screenShare.video=void 0,null!==(e=this.currentLayout)&&void 0!==e&&e.screenShareVideo&&(this.media.screenShare.video=new gT(this.mediaRequestManagers.screenShareVideo,[this.slots.screenShare.video],255,!1,{resolution:this.currentLayout.screenShareVideo.size})),this.mediaRequestManagers.screenShareVideo.commit()}},{key:"invalidateCurrentRemoteMedia",value:function(e){var t=e.audio,r=e.video,n=e.screenShareAudio,i=e.screenShareVideo,o=e.commit;t&&this.media.audio&&this.media.audio.stop(o),r&&(F()(this.media.video.activeSpeakerGroups).forEach((function(e){e.stop(!1)})),F()(this.media.video.memberPanes).forEach((function(e){e.stop(!1)})),o&&this.mediaRequestManagers.video.commit()),n&&this.media.screenShare.audio&&this.media.screenShare.audio.stop(o),i&&this.media.screenShare.video&&this.media.screenShare.video.stop(o)}},{key:"emitVideoLayoutChangedEvent",value:function(){var e;this.emit({file:"multistream/remoteMediaManager",function:"emitVideoLayoutChangedEvent"},bT.VideoLayoutChanged,{layoutId:this.currentLayoutId,activeSpeakerVideoPanes:this.media.video.activeSpeakerGroups,memberVideoPanes:this.media.video.memberPanes,screenShareVideo:null===(e=this.media.screenShare.video)||void 0===e?void 0:e.getRemoteMedia()[0]})}},{key:"setRemoteVideoCsi",value:function(e,t){if(!F()(this.media.video.memberPanes).includes(e))throw new Error("remoteMedia not found");t?e.sendMediaRequest(t,!0):e.cancelMediaRequest(!0)}},{key:"addMemberVideoPane",value:(t=(0,T.Z)(V().mark((function e(t){var r,n,i;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentLayout){e.next=2;break}throw new Error("There is no current layout selected, call start() first");case 2:if(null!==(r=this.currentLayout)&&void 0!==r&&r.memberVideoPanes||(this.currentLayout.memberVideoPanes=[]),!(t.id in this.currentLayout.memberVideoPanes)){e.next=5;break}throw new Error("duplicate pane id ".concat(t.id," - this pane already exists in current layout's memberVideoPanes"));case 5:return this.currentLayout.memberVideoPanes.push(t),e.next=8,this.receiveSlotManager.allocateSlot(Pn.VideoMain);case 8:return n=e.sent,this.slots.video.receiverSelected.push(n),i=new uT(n,this.mediaRequestManagers.video,{resolution:t.size}),t.csi&&i.sendMediaRequest(t.csi,!0),this.media.video.memberPanes[t.id]=i,e.abrupt("return",i);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"removeMemberVideoPane",value:function(e){var t,r;if(!this.currentLayout)return P().reject(new Error("There is no current layout selected, call start() first"));if(null===(t=this.currentLayout.memberVideoPanes)||void 0===t||!t.find((function(t){return t.id===e})))return pp.logger.log("RemoteMediaManager#removeMemberVideoPane --\x3e removeMemberVideoPane() called for a non-existent paneId: ".concat(e," (pane not found in currentLayout.memberVideoPanes)")),P().resolve();if(!this.media.video.memberPanes[e])return pp.logger.log("RemoteMediaManager#removeMemberVideoPane --\x3e removeMemberVideoPane() called for a non-existent paneId: ".concat(e," (pane not found in this.media.video.memberPanes)")),P().resolve();var n=this.media.video.memberPanes[e],i=n.getUnderlyingReceiveSlot();if(i){this.receiveSlotManager.releaseSlot(i);var o=this.slots.video.receiverSelected.indexOf(i);o>=0&&this.slots.video.receiverSelected.splice(o,1)}return n.stop(),delete this.media.video.memberPanes[e],null===(r=this.currentLayout.memberVideoPanes)||void 0===r||delete r[e],P().resolve()}},{key:"pinActiveSpeakerVideoPane",value:function(e,t){var r=F()(this.media.video.activeSpeakerGroups).find((function(t){return t.includes(e,"unpinned")}));if(!r)throw new Error("remoteMedia not found among the unpinned remote media from any active speaker group");r.pin(e,t)}},{key:"unpinActiveSpeakerVideoPane",value:function(e){var t=F()(this.media.video.activeSpeakerGroups).find((function(t){return t.includes(e,"pinned")}));if(!t)throw new Error("remoteMedia not found among the pinned remote media from any active speaker group");t.unpin(e)}},{key:"isPinned",value:function(e){var t=F()(this.media.video.activeSpeakerGroups).find((function(t){return t.includes(e)}));if(!t)throw new Error("remoteMedia not found among any remote media (pinned or unpinned) from any active speaker group");return t.isPinned(e)}}]),l}(aw);function wT(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var ST=function(e){(0,A.Z)(r,e);var t=wT(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qg.BREAKOUT_EDIT.MESSAGE,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,k.Z)(this,r),e=t.call(this,n),(0,R.Z)((0,x.Z)(e),"code",void 0),(0,R.Z)((0,x.Z)(e),"error",void 0),(0,R.Z)((0,x.Z)(e),"sdkMessage",void 0),e.name=Qg.BREAKOUT_EDIT.NAME,e.sdkMessage=Qg.BREAKOUT_EDIT.MESSAGE,e.error=i,e.stack=i?i.stack:(new Error).stack,e.code=Qg.BREAKOUT_EDIT.CODE,e}return(0,O.Z)(r)}((0,yp.Z)(Error)),_T=function(e,t){var r,n,i,o=null==e||null===(r=e.body)||void 0===r?void 0:r.errorCode,s=av.ERROR_CODE,a=s.EDIT_LOCK_TOKEN_MISMATCH,c=s.EDIT_NOT_AUTHORIZED;switch(o){case a:i=new ST("Edit lock token mismatch",e);break;case c:i=new ST("Not authorized to interact with edit lock",e);break;default:i=e}return pp.logger.info("".concat(t," --\x3e ").concat(null===(n=i)||void 0===n?void 0:n.message)),i};function TT(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var xT=function(e){(0,A.Z)(r,e);var t=TT(r);function r(){return(0,k.Z)(this,r),t.apply(this,arguments)}return(0,O.Z)(r,[{key:"broadcast",value:function(e){var t=e.url,r=e.message,n=e.options,i=e.groupId,o=e.sessionId,s=function(e){var t=[];return e&&(e.cohosts||e.presenters)?(e.cohosts&&t.push("COHOST"),e.presenters&&t.push("PRESENTER"),t):t}(n),a={id:i,recipientRoles:s.length?s:void 0,sessions:o?[{id:o}]:void 0};return this.request({method:tv.POST,uri:"".concat(t,"/message"),body:{message:r,groups:[a]}}).catch((function(e){if(!e.body||201409036!==e.body.errorCode||409!==e.statusCode)throw e;pp.logger.info("Breakouts#broadcast --\x3e no joined participants")}))}}]),r}(l.XR),AT={onBreakoutMoveRequest:function(e,t){AT.postMoveCallAnalyzer("client.breakout-session.move.request",e,t)},onBreakoutMoveResponse:function(e,t){AT.postMoveCallAnalyzer("client.breakout-session.move.response",e,t)},onBreakoutJoinResponse:function(e,t){AT.postMoveCallAnalyzer("client.breakout-session.join.response",e,t)},postMoveCallAnalyzer:function(e,t,r){var n,i,o;null!=t&&t.breakoutMoveId&&null!=t&&t.meeting&&null!==(n=t.meeting.meetingInfo)&&void 0!==n&&n.enableConvergedArchitecture&&r({name:e,payload:{identifiers:{breakoutMoveId:t.breakoutMoveId,breakoutSessionId:null==t||null===(i=t.currentSession)||void 0===i?void 0:i.sessionId,breakoutGroupId:null==t||null===(o=t.currentSession)||void 0===o?void 0:o.groupId}},options:{meetingId:t.meeting.id}})}};const IT=AT;var CT=l._y.extend({idAttribute:"sessionId",namespace:pg,breakoutRequest:xT,props:{active:["boolean",!1,!1],allowed:["boolean",!1,!1],assigned:["boolean",!1,!1],assignedCurrent:["boolean",!1,!1],requested:["boolean",!1,!1],current:["boolean",!1,!1],name:"string",sessionId:"string",sessionType:"string",groupId:"string",url:"string",requestedLastModifiedTime:"string"},derived:{isMain:{cache:!1,deps:["sessionType"],fn:function(){return"MAIN"===this.sessionType}}},initialize:function(){this.breakoutRequest=new xT({webex:this.webex}),this.breakoutRosterLocus=null},join:function(){var e=this;return(0,T.Z)(V().mark((function t(){var r,n,i,o,s;return V().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=gp().v4(),n=e.webex.internal.device.url,i=e.collection.parent.meetingId,o=e.webex.meetings.getMeetingByType(Nm,i),IT.onBreakoutMoveRequest({currentSession:e,meeting:o,breakoutMoveId:r},e.webex.internal.newMetrics.submitClientEvent.bind(e.webex.internal.newMetrics)),t.next=7,e.request({method:tv.POST,uri:"".concat(e.url,"/move"),body:{breakoutMoveId:r,deviceUrl:n,groupId:e.groupId,sessionId:e.sessionId}});case 7:return s=t.sent,IT.onBreakoutMoveResponse({currentSession:e,meeting:o,breakoutMoveId:r},e.webex.internal.newMetrics.submitClientEvent.bind(e.webex.internal.newMetrics)),t.abrupt("return",s);case 10:case"end":return t.stop()}}),t)})))()},leave:function(){if(this.isMain)throw new Error("Cannot leave the main session");var e=this.parent.breakouts.filter((function(e){return e.isMain}))[0];if(!e)throw new Error("Cannot leave, no main session found");return e.join()},askForHelp:function(){return this.request({method:tv.POST,uri:"".concat(this.url,"/help"),body:{groupId:this.groupId,sessionId:this.sessionId}})},initMembers:function(){var e=this.collection.parent.meetingId,t=this.webex.meetings.getMeetingByType(Nm,e);this.members=new I_({meeting:t},{parent:this.webex})},isNeedHandleRoster:function(e){var t,r,n,i,o;if(null===(t=this.breakoutRosterLocus)||void 0===t||null===(r=t.sequence)||void 0===r||null===(n=r.entries)||void 0===n||!n.length||null==e||null===(i=e.sequence)||void 0===i||null===(o=i.entries)||void 0===o||!o.length)return!0;var s=this.breakoutRosterLocus.sequence.entries[0];return e.sequence.entries[0]>s},parseRoster:function(e){this.members||this.initMembers(),this.isNeedHandleRoster(e)&&(this.breakoutRosterLocus=e,this.members.locusParticipantsUpdate(e))},broadcast:function(e,t){return this.breakoutRequest.broadcast({url:this.url,message:e,options:t,groupId:this.groupId,sessionId:this.sessionId})},version:"0.0.0-next"});const RT=CT;var kT=r(90765),OT=r.n(kT);const NT=OT().extend({model:RT,namespace:pg,mainIndex:"sessionId"});function PT(e,t){var r=U()(e);if(p()){var n=p()(e);t&&(n=n.filter((function(t){return g()(e,t).enumerable}))),r.push.apply(r,n)}return r}function LT(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?PT(Object(r),!0).forEach((function(t){(0,R.Z)(e,t,r[t])})):y()?E()(e,y()(r)):PT(Object(r)).forEach((function(t){S()(e,t,g()(r,t))}))}return e}var DT=l._y.extend({namespace:pg,breakoutRequest:xT,collections:{breakouts:NT},props:{allowBackToMain:"boolean",delayCloseTime:"number",enableBreakoutSession:"boolean",hasBreakoutPreAssignments:"boolean",groupId:"string",name:"string",sessionId:"string",sessionType:"string",startTime:"string",status:"string",url:"string",locusUrl:"string",breakoutServiceUrl:"string",mainLocusUrl:"string",groups:"array",manageGroups:"array",preAssignments:"array",editLock:"object",intervalID:"number",meetingId:"string",canManageBreakouts:"boolean"},children:{currentBreakoutSession:RT},derived:{isInMainSession:{cache:!1,deps:["sessionType"],fn:function(){return this.sessionType===av.SESSION_TYPES.MAIN}},isActiveBreakout:{cache:!1,deps:["sessionType","status"],fn:function(){return this.sessionType===av.SESSION_TYPES.BREAKOUT&&(this.status===av.STATUS.OPEN||this.status===av.STATUS.CLOSING)}},breakoutGroupId:{cache:!1,deps:["manageGroups"],fn:function(){var e;return null!==(e=this.manageGroups)&&void 0!==e&&e.length&&this.manageGroups[0].status!==av.STATUS.CLOSED?this.manageGroups[0].id:""}},breakoutStatus:{cache:!0,deps:["isInMainSession","status","groups"],fn:function(){var e,t;return this.isInMainSession?null===(e=this.groups)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.status:this.status}},shouldQueryPreAssignments:{cache:!1,deps:["canManageBreakouts","enableBreakoutSession","hasBreakoutPreAssignments"],fn:function(){return!!(this.canManageBreakouts&&this.enableBreakoutSession&&this.hasBreakoutPreAssignments)}}},initialize:function(){var e=this;this.listenTo(this,"change:breakoutStatus",(function(){e.breakoutStatus===av.STATUS.CLOSING&&e.trigger(av.EVENTS.BREAKOUTS_CLOSING)})),this.listenTo(this,"change:shouldQueryPreAssignments",(function(){e.shouldQueryPreAssignments&&!e.preAssignments&&e.queryPreAssignments()})),this.debouncedQueryRosters=i_()(this.queryRosters,10,{leading:!0,trailing:!1}),this.listenTo(this.breakouts,"add",(function(t){e.debouncedQueryRosters(),e.triggerReturnToMainEvent(t)})),this.listenTo(this.breakouts,"change:requestedLastModifiedTime",(function(t){e.triggerReturnToMainEvent(t)})),this.listenToCurrentSessionTypeChange(),this.listenToBroadcastMessages(),this.listenToBreakoutRosters(),this.listenToBreakoutHelp(),this.breakoutRequest=new xT({webex:this.webex})},cleanUp:function(){this.stopListening()},locusUrlUpdate:function(e){this.set("locusUrl",e);var t=this.isInMainSession,r=this.mainLocusUrl;!t&&r||this.set("mainLocusUrl",e)},updateCanManageBreakouts:function(e){this.set("canManageBreakouts",e)},breakoutServiceUrlUpdate:function(e){this.set("breakoutServiceUrl","".concat(e,"/breakout/"))},queryRosters:function(){var e=this;this.webex.request({uri:"".concat(this.url,"/roster"),qs:{locusUrl:btoa(this.locusUrl)}}).then((function(t){var r=t.body.rosters;null==r||r.forEach((function(t){var r=t.locus;e.handleRosterUpdate(r)})),e.trigger(av.EVENTS.MEMBERS_UPDATE)})).catch((function(e){pp.logger.error("Meeting:breakouts#queryRosters failed",e)}))},handleRosterUpdate:function(e){var t,r,n=null===(t=e.controls)||void 0===t||null===(r=t.breakout)||void 0===r?void 0:r.sessionId,i=this.breakouts.get(n);i&&i.parseRoster(e)},listenToCurrentSessionTypeChange:function(){var e=this;this.listenTo(this.currentBreakoutSession,"change:sessionType",(function(t,r){(function(e,t){return e.previous("sessionType")===av.SESSION_TYPES.BREAKOUT&&t===av.SESSION_TYPES.MAIN})(t,r)&&e.trigger(av.EVENTS.LEAVE_BREAKOUT)}))},listenToBroadcastMessages:function(){var e=this;this.listenTo(this.webex.internal.llm,"event:breakout.message",(function(t){var r=t.data,n=r.senderUserId,i=r.sentTime,o=r.message;e.trigger(av.EVENTS.MESSAGE,{senderUserId:n,sentTime:i,message:o,sessionId:e.currentBreakoutSession.sessionId})}))},listenToBreakoutRosters:function(){var e=this;this.listenTo(this.webex.internal.mercury,"event:breakout.roster",(function(t){e.handleRosterUpdate(t.data.locus),e.trigger(av.EVENTS.MEMBERS_UPDATE)}))},listenToBreakoutHelp:function(){var e=this;this.listenTo(this.webex.internal.mercury,"event:breakout.help",(function(t){var r=t.data,n=r.participant,i=r.sessionId;e.trigger(av.EVENTS.ASK_FOR_HELP,{participant:n,sessionId:i})}))},isBreakoutInProgress:function(){var e,t,r=(null===(e=this.groups)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.status)||this.status;return r===av.STATUS.OPEN||r===av.STATUS.CLOSING},isBreakoutIClosing:function(){var e,t;return((null===(e=this.groups)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.status)||this.status)===av.STATUS.CLOSING},updateBreakout:function(e){if(this.set(e),this.set("groups",e.groups),this.set("startTime",e.startTime),this.set("status",e.status),this.set("currentBreakoutSession",(0,R.Z)((0,R.Z)((0,R.Z)((0,R.Z)((0,R.Z)({sessionId:e.sessionId,groupId:e.groupId,name:e.name,current:!0,sessionType:e.sessionType,url:e.url},av.SESSION_STATES.ACTIVE,!1),av.SESSION_STATES.ALLOWED,!1),av.SESSION_STATES.ASSIGNED,!1),av.SESSION_STATES.ASSIGNED_CURRENT,!1),av.SESSION_STATES.REQUESTED,!1)),this.isBreakoutInProgress()||this.clearBreakouts(),this.currentBreakoutSession.previous("sessionId")!==this.currentBreakoutSession.sessionId||this.currentBreakoutSession.previous("groupId")!==this.currentBreakoutSession.groupId){var t=this.webex.meetings.getMeetingByType(Nm,this.meetingId);IT.onBreakoutJoinResponse({currentSession:this.currentBreakoutSession,meeting:t,breakoutMoveId:e.breakoutMoveId},this.webex.internal.newMetrics.submitClientEvent.bind(this.webex.internal.newMetrics))}},updateBreakoutSessions:function(e){var t=this,r={};this.isBreakoutIClosing()||(e.breakoutSessions&&mT()(av.SESSION_STATES,(function(t){mT()(e.breakoutSessions[t],(function(e){var n=e.sessionId;r[n]||(r[n]=e,r[n][av.SESSION_STATES.ACTIVE]=!1,r[n][av.SESSION_STATES.ASSIGNED]=!1,r[n][av.SESSION_STATES.ALLOWED]=!1,r[n][av.SESSION_STATES.ASSIGNED_CURRENT]=!1,r[n][av.SESSION_STATES.REQUESTED]=!1),r[n][t]=!0,t===av.SESSION_STATES.REQUESTED&&(r[n].requestedLastModifiedTime=e.modifiedAt)}))})),mT()(r,(function(e){e.url=t.url})),this.breakouts.set(F()(r)))},clearBreakouts:function(){this.breakouts.length>0&&this.breakouts.reset()},getMainSession:function(){if(this.isInMainSession)return this.currentBreakoutSession;var e=this.breakouts.filter((function(e){return e.isMain}))[0];if(!e)throw new Error("no main session found");return e},askAllToReturn:function(){var e=this.getMainSession();return this.webex.request({method:tv.POST,uri:"".concat(this.url,"/requestMove"),body:{groupId:e.groupId,sessionId:e.sessionId}})},broadcast:function(e,t){var r=this.breakoutGroupId;if(!r)throw new Error("Cannot broadcast, no breakout session found");return this.breakoutRequest.broadcast({url:this.url,message:e,options:t,groupId:r})},enableBreakouts:function(){return this.breakoutServiceUrl?this.webex.request({method:tv.POST,uri:this.breakoutServiceUrl,body:{locusUrl:this.locusUrl}}).catch((function(e){throw pp.logger.error("Meeting:request#touchBreakout --\x3e Error provisioning error ".concat(e)),e})):P().reject(new Error("enableBreakouts: the breakoutServiceUrl is empty"))},toggleBreakout:function(e){var t=this;return(0,T.Z)(V().mark((function r(){var n;return V().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(void 0!==t.enableBreakoutSession){r.next=10;break}return r.next=3,t.enableBreakouts();case 3:if(n=r.sent,t.updateBreakout(null==n?void 0:n.body),e){r.next=8;break}return r.next=8,t.doToggleBreakout(e);case 8:r.next=12;break;case 10:return r.next=12,t.doToggleBreakout(e);case 12:case"end":return r.stop()}}),r)})))()},doToggleBreakout:function(e){var t=LT(LT({},this.editLock&&this.editLock.token?{editlock:{token:this.editLock.token}}:{}),{enableBreakoutSession:e});return this.webex.request({method:tv.PUT,uri:this.url,body:t})},_setManageGroups:function(e){var t;null!=e&&null!==(t=e.body)&&void 0!==t&&t.groups&&this.set("manageGroups",e.body.groups)},create:function(e){var t=this;return(0,T.Z)(V().mark((function r(){var n,i,o;return V().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=LT({},e),i=LT(LT({},t.editLock&&t.editLock.token?{editlock:{token:t.editLock.token}}:{}),{groups:[n]}),r.next=4,t.webex.request({method:tv.PUT,uri:t.url,body:i}).catch((function(e){return P().reject(_T(e,"Breakouts#create"))}));case 4:return o=r.sent,t._setManageGroups(o),t._clearEditLockInfo(),r.abrupt("return",o);case 8:case"end":return r.stop()}}),r)})))()},clearSessions:function(){var e=this;return(0,T.Z)(V().mark((function t(){var r,n;return V().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=LT(LT({},e.editLock&&e.editLock.token?{editlock:{token:e.editLock.token}}:{}),{groups:[{action:av.ACTION.DELETE}]}),t.next=3,e.webex.request({method:tv.PUT,uri:e.url,body:r}).catch((function(e){return P().reject(_T(e,"Breakouts#clearSessions"))}));case 3:return n=t.sent,e._setManageGroups(n),t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)})))()},start:function(){var e=arguments,t=this;return(0,T.Z)(V().mark((function r(){var n,i,o,s,a;return V().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:{},i=av.ACTION.START,o=LT({id:t.breakoutGroupId,action:i,allowBackToMain:!1,allowToJoinLater:!1},n),s=LT(LT({},t.editLock&&t.editLock.token?{editlock:{token:t.editLock.token,refresh:!0}}:{}),{groups:[o]}),r.next=6,t.request({method:tv.PUT,uri:t.url,body:s}).catch((function(e){return P().reject(_T(e,"Breakouts#start"))}));case 6:return a=r.sent,t._setManageGroups(a),r.abrupt("return",a);case 9:case"end":return r.stop()}}),r)})))()},end:function(){var e=arguments,t=this;return(0,T.Z)(V().mark((function r(){var n,i,o,s,a,c,u;return V().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:{},i=t.delayCloseTime,o=t.breakoutGroupId,s=av.ACTION.CLOSE,a=LT({id:o,action:s,delayCloseTime:i},n),c=LT(LT({},t.editLock&&t.editLock.token?{editlock:{token:t.editLock.token,refresh:!0}}:{}),{groups:[a]}),r.next=7,t.request({method:tv.PUT,uri:t.url,body:c}).catch((function(e){return P().reject(_T(e,"Breakouts#end"))}));case 7:return u=r.sent,t._setManageGroups(u),r.abrupt("return",u);case 10:case"end":return r.stop()}}),r)})))()},update:function(e,t){var r=this;return(0,T.Z)(V().mark((function n(){var i,o,s,a;return V().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.id){n.next=2;break}return n.abrupt("return",P().reject(new Error("Missing breakout group id")));case 2:return o=LT({},e),s=LT(LT({},null!==(i=r.editLock)&&void 0!==i&&i.token?{editlock:{token:r.editLock.token,refresh:!t}}:{}),{groups:[o]}),n.next=6,r.request({method:tv.PUT,uri:r.url,body:s}).catch((function(e){return P().reject(_T(e,"Breakouts#update"))}));case 6:return a=n.sent,t&&r._clearEditLockInfo(),r._setManageGroups(a),n.abrupt("return",a);case 10:case"end":return n.stop()}}),n)})))()},getBreakout:function(e){var t=this;return(0,T.Z)(V().mark((function r(){var n,i,o;return V().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.request({method:tv.GET,uri:t.url+(e?"?editlock=".concat(e):"")});case 2:return o=r.sent,t._setManageGroups(o),e&&null!==(n=o.body)&&void 0!==n&&null!==(i=n.editlock)&&void 0!==i&&i.token&&(t.set("editLock",o.body.editlock),t.keepEditLockAlive()),r.abrupt("return",o);case 6:case"end":return r.stop()}}),r)})))()},enableAndLockBreakout:function(){var e=this;return(0,T.Z)(V().mark((function t(){return V().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.enableBreakoutSession){t.next=4;break}e.lockBreakout(),t.next=8;break;case 4:return t.next=6,e.enableBreakouts();case 6:t.sent.body&&e.lockBreakout();case 8:case"end":return t.stop()}}),t)})))()},hasBreakoutLocked:function(){return this.editLock&&this.editLock.token&&this.editLock.state===av.EDIT_LOCK_STATUS.LOCKED},lockBreakout:function(){var e=this;return(0,T.Z)(V().mark((function t(){var r,n;return V().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.editLock||!e.editLock.token){t.next=8;break}if(e.editLock.state!==av.EDIT_LOCK_STATUS.LOCKED){t.next=5;break}throw new Error("Breakout already locked");case 5:e.keepEditLockAlive();case 6:t.next=12;break;case 8:return t.next=10,e.getBreakout(!0);case 10:n=t.sent,null!==(r=n.body)&&void 0!==r&&r.editlock&&e.keepEditLockAlive();case 12:case"end":return t.stop()}}),t)})))()},keepEditLockAlive:function(){var e=this;if(this.editLock&&this.editLock.token){var t=this.editLock.ttl<30?av.DEFAULT_TTL:this.editLock.ttl;this.intervalID&&window.clearInterval(this.intervalID),this.intervalID=window.setInterval((function(){e.request({method:tv.PUT,uri:"".concat(e.url,"/editlock/").concat(e.editLock.token)}).catch((function(t){return e._clearEditLockInfo(),P().reject(_T(t,"Breakouts#keepEditLockAlive"))}))}),t/2*1e3)}},unLockEditBreakout:function(){var e=this;this.editLock&&this.editLock.token&&this.request({method:tv.DELETE,uri:"".concat(this.url,"/editlock/").concat(this.editLock.token)}).then((function(){e._clearEditLockInfo()})).catch((function(e){return P().reject(_T(e,"Breakouts#unLockEditBreakout"))}))},_clearEditLockInfo:function(){this.intervalID&&clearInterval(this.intervalID),this.set("editLock",{})},assign:function(e){var t=e.map((function(e){return{id:e.id,assigned:e.memberIds,assignedEmails:e.emails,anyoneCanJoin:!!e.anyone}})),r=LT(LT({},this.editLock&&this.editLock.token?{editlock:{token:this.editLock.token,refresh:!0}}:{}),{groups:[{id:this.breakoutGroupId,sessions:t}]});return this.request({method:tv.PUT,uri:this.url,body:r})},queryPreAssignments:function(){var e=this;this.webex.request({uri:"".concat(this.url,"/preassignments"),qs:{locusUrl:btoa(this.locusUrl)}}).then((function(t){var r;null!==(r=t.body)&&void 0!==r&&r.groups&&(e.set("preAssignments",t.body.groups),e.trigger(av.EVENTS.PRE_ASSIGNMENTS_UPDATE))})).catch((function(e){pp.logger.error("Meeting:breakouts#queryPreAssignments failed",e)}))},dynamicAssign:function(e){var t=e.map((function(e){return{id:e.id,participants:e.participants,targetState:e.targetState}})),r={groups:[{id:this.breakoutGroupId,sessions:t}],editlock:null};return this.editLock&&this.editLock.token&&(r.editlock=this.editLock),this.request({method:tv.PUT,uri:"".concat(this.url,"/dynamicAssign"),body:r})},triggerReturnToMainEvent:function(e){e.isMain&&e.requested&&this.trigger(av.EVENTS.ASK_RETURN_TO_MAIN)},version:"0.0.0-next"});const MT=DT;const UT=l._y.extend({idAttribute:"languageName",namespace:pg,props:{languageCode:"number",languageName:"string"},version:"0.0.0-next"});const BT=OT().extend({model:UT,namespace:pg,mainIndex:"languageName"});var FT=l._y.extend({namespace:pg,collections:{siLanguages:BT},props:{locusUrl:"string",approvalUrl:"string",originalLanguage:"string",sourceLanguage:"string",targetLanguage:"string",receiveLanguage:"string",order:"number",isActive:"boolean",selfParticipantId:"string",canManageInterpreters:"boolean",supportLanguages:"array",meetingSIEnabled:"boolean",hostSIEnabled:"boolean",selfIsInterpreter:"boolean"},derived:{shouldQuerySupportLanguages:{cache:!1,deps:["canManageInterpreters","hostSIEnabled"],fn:function(){return!(!this.canManageInterpreters||!this.hostSIEnabled)}}},initialize:function(){var e=this;this.listenTo(this,"change:shouldQuerySupportLanguages",(function(){e.canManageInterpreters&&!e.supportLanguages&&e.querySupportLanguages()})),this.listenToHandoffRequests()},cleanUp:function(){this.stopListening()},locusUrlUpdate:function(e){this.set("locusUrl",e)},approvalUrlUpdate:function(e){this.set("approvalUrl",e)},updateCanManageInterpreters:function(e){this.set("canManageInterpreters",e)},updateHostSIEnabled:function(e){this.set("hostSIEnabled",e)},updateMeetingSIEnabled:function(e,t){this.set("meetingSIEnabled",e),this.set("selfIsInterpreter",t)},updateInterpretation:function(e){this.siLanguages.set((null==e?void 0:e.siLanguages)||[])},updateSelfInterpretation:function(e){var t=e.interpretation,r=e.selfParticipantId,n=t||{},i=n.originalLanguage,o=n.sourceLanguage,s=n.order,a=n.isActive,c=n.targetLanguage,u=n.receiveLanguage;this.set({originalLanguage:i,sourceLanguage:o,order:s,isActive:a,targetLanguage:c,receiveLanguage:u}),this.set("selfParticipantId",r)},querySupportLanguages:function(){var e=this;return this.request({method:tv.GET,uri:"".concat(this.locusUrl,"/languages/interpretation")}).then((function(t){var r;e.set("supportLanguages",null===(r=t.body)||void 0===r?void 0:r.siLanguages),e.trigger(cv.EVENTS.SUPPORT_LANGUAGES_UPDATE)})).catch((function(e){throw pp.logger.error("Meeting:interpretation#querySupportLanguages failed",e),e}))},getInterpreters:function(){return this.request({method:tv.GET,uri:"".concat(this.locusUrl,"/interpretation/interpreters")}).catch((function(e){throw pp.logger.error("Meeting:interpretation#getInterpreters failed",e),e}))},updateInterpreters:function(e){return this.request({method:tv.PATCH,uri:"".concat(this.locusUrl,"/controls"),body:{interpretation:{interpreters:e}}}).catch((function(e){throw pp.logger.error("Meeting:interpretation#updateInterpreters failed",e),e}))},changeDirection:function(){return this.sourceLanguage&&this.targetLanguage?this.selfParticipantId?this.request({method:tv.PATCH,uri:"".concat(this.locusUrl,"/participant/").concat(this.selfParticipantId,"/controls"),body:{interpretation:{sourceLanguage:this.targetLanguage,targetLanguage:this.sourceLanguage,isActive:this.isActive,order:this.order}}}).catch((function(e){throw pp.logger.error("Meeting:interpretation#changeDirection failed",e),e})):P().reject(new Error("Missing self participant id")):P().reject(new Error("Missing sourceLanguage or targetLanguage"))},listenToHandoffRequests:function(){var e=this;this.listenTo(this.webex.internal.mercury,"event:locus.approval_request",(function(t){var r,n;if((null==t||null===(r=t.data)||void 0===r||null===(n=r.approval)||void 0===n?void 0:n.resourceType)===cv.RESOURCE_TYPE){var i,o=t.data.approval,s=o.receivers,a=o.initiator,c=o.actionType,u=o.url,l=null==s||null===(i=s[0])||void 0===i?void 0:i.participantId,d=!!l&&l===e.selfParticipantId,h=null==a?void 0:a.participantId,f=!!h&&h===e.selfParticipantId;if(!d&&!f)return;e.trigger(cv.EVENTS.HANDOFF_REQUESTS_ARRIVED,{actionType:c,isReceiver:d,isSender:f,senderId:h,receiverId:l,url:u})}}))},handoffInterpreter:function(e){return e?this.approvalUrl?this.request({method:tv.POST,uri:this.approvalUrl,body:{actionType:cv.ACTION_TYPE.OFFERED,resourceType:cv.RESOURCE_TYPE,receivers:[{participantId:e}]}}).catch((function(e){throw pp.logger.error("Meeting:interpretation#handoffInterpreter failed",e),e})):P().reject(new Error("Missing approval url")):P().reject(new Error("Missing target participant id"))},requestHandoff:function(){return this.approvalUrl?this.request({method:tv.POST,uri:this.approvalUrl,body:{actionType:cv.ACTION_TYPE.REQUESTED,resourceType:cv.RESOURCE_TYPE}}).catch((function(e){throw pp.logger.error("Meeting:interpretation#requestHandoff failed",e),e})):P().reject(new Error("Missing approval url"))},acceptRequest:function(e){return e?this.request({method:tv.PUT,uri:e,body:{actionType:cv.ACTION_TYPE.ACCEPTED}}).catch((function(e){throw pp.logger.error("Meeting:interpretation#acceptRequest failed",e),e})):P().reject(new Error("Missing the url to accept"))},declineRequest:function(e){return e?this.request({method:tv.PUT,uri:e,body:{actionType:cv.ACTION_TYPE.DECLINED}}).catch((function(e){throw pp.logger.error("Meeting:interpretation#declineRequest failed",e),e})):P().reject(new Error("Missing the url to decline"))},version:"0.0.0-next"});const jT=FT;var VT="annotation:strokeData",HT="annotation:command",GT="AnnotationOnShare",qT="annotation.client",$T="annotation_message",ZT=function(e){return e.REQUESTED="REQUESTED",e.ACCEPTED="ACCEPTED",e.DECLINED="DECLINED",e.OFFERED="OFFERED",e.CANCELED="CANCELED",e.EXPIRED="EXPIRED",e.REVOKED="REVOKED",e.CLOSED="CLOSED",e}({});function zT(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var KT=function(e){(0,A.Z)(r,e);var t=zT(r);function r(){var e;(0,k.Z)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,R.Z)((0,x.Z)(e),"namespace","annotation"),(0,R.Z)((0,x.Z)(e),"seqNum",void 0),(0,R.Z)((0,x.Z)(e),"hasSubscribedToEvents",void 0),(0,R.Z)((0,x.Z)(e),"approvalUrl",void 0),(0,R.Z)((0,x.Z)(e),"locusUrl",void 0),(0,R.Z)((0,x.Z)(e),"deviceUrl",void 0),(0,R.Z)((0,x.Z)(e),"sendAnnotationAction",function(){var t=(0,T.Z)(V().mark((function t(r,n){var i;return V().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i={actionType:r,resourceType:"AnnotationOnShare",shareInstanceId:n.shareInstanceId},null!=n&&n.toUserId&&(i.receivers=[{participantId:n.toUserId,deviceUrl:n.toDeviceUrl}]),t.abrupt("return",e.request({method:tv.POST,url:"".concat(e.approvalUrl),body:i}));case 3:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()),(0,R.Z)((0,x.Z)(e),"decryptContent",(function(t,r){return e.webex.internal.encryption.decryptText(t,r).then((function(e){return e}))})),(0,R.Z)((0,x.Z)(e),"encryptContent",(function(t,r){return e.webex.internal.encryption.encryptText(t,r).then((function(e){return e}))})),(0,R.Z)((0,x.Z)(e),"sendStrokeData",(function(t){e.webex.internal.llm.isConnected()&&e.encryptContent(t.encryptionKeyUrl,t.content).then((function(r){e.publishEncrypted(r,t)}))})),e.seqNum=1,e}return(0,O.Z)(r,[{key:"processStrokeMessage",value:function(e){var t=this,r=e.request;this.decryptContent(r.value.encryptionKeyUrl,r.value.content).then((function(n){r.value.content=n,Qv.trigger(t,{file:"annotation",function:"processStrokeMessage"},VT,{payload:e})}))}},{key:"eventCommandProcessor",value:function(e){var t,r,n,i,o;"locus.approval_request"===(null==e||null===(t=e.data)||void 0===t?void 0:t.eventType)&&(null==e||null===(r=e.data)||void 0===r||null===(n=r.approval)||void 0===n?void 0:n.resourceType)===GT&&null!=e&&null!==(i=e.data)&&void 0!==i&&null!==(o=i.approval)&&void 0!==o&&o.actionType&&Qv.trigger(this,{file:"annotation",function:"approval_request"},HT,{type:e.data.approval.actionType,payload:e.data.approval})}},{key:"eventDataProcessor",value:function(e){var t;if((null==e||null===(t=e.data)||void 0===t?void 0:t.relayType)===qT)this.processStrokeMessage(e.data)}},{key:"listenToEvents",value:function(){this.hasSubscribedToEvents||(this.webex.internal.mercury.on("event:locus.approval_request",this.eventCommandProcessor,this),this.webex.internal.llm.on("event:relay.event",this.eventDataProcessor,this),this.hasSubscribedToEvents=!0)}},{key:"locusUrlUpdate",value:function(e){this.locusUrl=e,this.listenToEvents()}},{key:"approvalUrlUpdate",value:function(e){this.approvalUrl=e}},{key:"acceptRequest",value:function(e){return this.request({method:tv.PUT,url:e.url,body:{resourceType:GT,actionType:ZT.ACCEPTED}})}},{key:"declineRequest",value:function(e){return this.request({method:tv.PUT,url:e.url,body:{resourceType:GT,actionType:ZT.DECLINED}})}},{key:"approveAnnotation",value:function(e){return this.sendAnnotationAction(ZT.REQUESTED,e)}},{key:"cancelApproveAnnotation",value:function(e,t){var r={actionType:ZT.CANCELED,resourceType:"AnnotationOnShare",shareInstanceId:e.shareInstanceId};return this.request({method:tv.PUT,url:"".concat(t.url),body:r})}},{key:"closeAnnotation",value:function(e){return this.sendAnnotationAction(ZT.CLOSED,e)}},{key:"publishEncrypted",value:function(e,t){var r={id:"".concat(this.seqNum),type:"publishRequest",recipients:{route:this.webex.internal.llm.getBinding()},headers:{to:t.toUserId},data:{eventType:"relay.event",relayType:qT,request:{value:{type:$T,content:e,deviceId:t.deviceId,seq:this.seqNum,requesterId:t.requesterId,version:t.version,shareInstanceId:t.shareInstanceId,encryptionKeyUrl:t.encryptionKeyUrl}}},trackingId:"".concat(l.vc.trackingIdPrefix,"_").concat(gp().v4().toString()),timestamp:(new Date).getTime(),sequenceNumber:this.seqNum,filterMessage:!1};this.webex.internal.llm.socket.send(r),this.seqNum+=1}}]),r}(l._y);const WT=KT;const JT=function(){function e(){(0,k.Z)(this,e),(0,R.Z)(this,"webinarInfo",void 0),(0,R.Z)(this,"namespace",pg),(0,R.Z)(this,"mainIndex","sessionId"),this.webinarInfo={}}return(0,O.Z)(e,[{key:"set",value:function(e,t){this.webinarInfo[e]=t}},{key:"get",value:function(e){return this.webinarInfo[e]}}]),e}();const YT=l._y.extend({namespace:pg,collections:{webinar:JT},props:{locusUrl:"string",webcastUrl:"string",webinarAttendeesSearchingUrl:"string",canManageWebcast:"boolean"},locusUrlUpdate:function(e){this.set("locusUrl",e)},webcastUrlUpdate:function(e){this.set("webcastUrl",e)},webinarAttendeesSearchingUrlUpdate:function(e){this.set("webinarAttendeesSearchingUrl",e)},updateCanManageWebcast:function(e){this.set("canManageWebcast",e)},version:"0.0.0-next"});var QT=(0,O.Z)((function e(){var t=this;(0,k.Z)(this,e),(0,R.Z)(this,"namespace",pg),(0,R.Z)(this,"canInviteNewParticipants",null),(0,R.Z)(this,"canAdmitParticipant",null),(0,R.Z)(this,"canLock",null),(0,R.Z)(this,"canUnlock",null),(0,R.Z)(this,"canAssignHost",null),(0,R.Z)(this,"canStartRecording",null),(0,R.Z)(this,"canPauseRecording",null),(0,R.Z)(this,"canResumeRecording",null),(0,R.Z)(this,"canStopRecording",null),(0,R.Z)(this,"canSetMuteOnEntry",null),(0,R.Z)(this,"canSetPresenter",null),(0,R.Z)(this,"canUnsetPresenter",null),(0,R.Z)(this,"canUnsetMuteOnEntry",null),(0,R.Z)(this,"canSetDisallowUnmute",null),(0,R.Z)(this,"canUnsetDisallowUnmute",null),(0,R.Z)(this,"canSetMuted",null),(0,R.Z)(this,"canUnsetMuted",null),(0,R.Z)(this,"canRaiseHand",null),(0,R.Z)(this,"canLowerAllHands",null),(0,R.Z)(this,"canLowerSomeoneElsesHand",null),(0,R.Z)(this,"bothLeaveAndEndMeetingAvailable",null),(0,R.Z)(this,"canEnableClosedCaption",null),(0,R.Z)(this,"canStartTranscribing",null),(0,R.Z)(this,"canStopTranscribing",null),(0,R.Z)(this,"isClosedCaptionActive",null),(0,R.Z)(this,"isSaveTranscriptsEnabled",null),(0,R.Z)(this,"isWebexAssistantActive",null),(0,R.Z)(this,"canViewCaptionPanel",null),(0,R.Z)(this,"isRealTimeTranslationEnabled",null),(0,R.Z)(this,"canSelectSpokenLanguages",null),(0,R.Z)(this,"waitingForOthersToJoin",null),(0,R.Z)(this,"canSendReactions",null),(0,R.Z)(this,"canManageBreakout",null),(0,R.Z)(this,"canBroadcastMessageToBreakout",null),(0,R.Z)(this,"canAdmitLobbyToBreakout",null),(0,R.Z)(this,"isBreakoutPreassignmentsEnabled",null),(0,R.Z)(this,"canUserAskForHelp",null),(0,R.Z)(this,"canUserRenameSelfAndObserved",null),(0,R.Z)(this,"canUserRenameOthers",null),(0,R.Z)(this,"canMuteAll",null),(0,R.Z)(this,"canUnmuteAll",null),(0,R.Z)(this,"canEnableHardMute",null),(0,R.Z)(this,"canDisableHardMute",null),(0,R.Z)(this,"canEnableMuteOnEntry",null),(0,R.Z)(this,"canDisableMuteOnEntry",null),(0,R.Z)(this,"canEnableReactions",null),(0,R.Z)(this,"canDisableReactions",null),(0,R.Z)(this,"canEnableReactionDisplayNames",null),(0,R.Z)(this,"canDisableReactionDisplayNames",null),(0,R.Z)(this,"canUpdateShareControl",null),(0,R.Z)(this,"canEnableViewTheParticipantsList",null),(0,R.Z)(this,"canDisableViewTheParticipantsList",null),(0,R.Z)(this,"canEnableRaiseHand",null),(0,R.Z)(this,"canDisableRaiseHand",null),(0,R.Z)(this,"canEnableVideo",null),(0,R.Z)(this,"canDisableVideo",null),(0,R.Z)(this,"canShareFile",null),(0,R.Z)(this,"canShareApplication",null),(0,R.Z)(this,"canShareCamera",null),(0,R.Z)(this,"canShareDesktop",null),(0,R.Z)(this,"canShareContent",null),(0,R.Z)(this,"canTransferFile",null),(0,R.Z)(this,"canChat",null),(0,R.Z)(this,"canDoVideo",null),(0,R.Z)(this,"canAnnotate",null),(0,R.Z)(this,"canUseVoip",null),(0,R.Z)(this,"supportHQV",null),(0,R.Z)(this,"enforceVirtualBackground",null),(0,R.Z)(this,"supportHDV",null),(0,R.Z)(this,"canShareWhiteBoard",null),(0,R.Z)(this,"get",(function(){return{canInviteNewParticipants:t.canInviteNewParticipants,canAdmitParticipant:t.canAdmitParticipant,canLock:t.canLock,canUnlock:t.canUnlock,canAssignHost:t.canAssignHost,canSetMuteOnEntry:t.canSetMuteOnEntry,canUnsetMuteOnEntry:t.canUnsetMuteOnEntry,canSetDisallowUnmute:t.canSetDisallowUnmute,canSetMuted:t.canSetMuted,canUnsetMuted:t.canUnsetMuted,canSetPresenter:t.canSetPresenter,canUnsetPresenter:t.canUnsetPresenter,canUnsetDisallowUnmute:t.canUnsetDisallowUnmute,canStartRecording:t.canStartRecording,canPauseRecording:t.canPauseRecording,canResumeRecording:t.canResumeRecording,canStopRecording:t.canStopRecording,canRaiseHand:t.canRaiseHand,canLowerAllHands:t.canLowerAllHands,canLowerSomeoneElsesHand:t.canLowerSomeoneElsesHand,bothLeaveAndEndMeetingAvailable:t.bothLeaveAndEndMeetingAvailable,canEnableClosedCaption:t.canEnableClosedCaption,canStartTranscribing:t.canStartTranscribing,canStopTranscribing:t.canStopTranscribing,isClosedCaptionActive:t.isClosedCaptionActive,isSaveTranscriptsEnabled:t.isSaveTranscriptsEnabled,isWebexAssistantActive:t.isWebexAssistantActive,canViewCaptionPanel:t.canViewCaptionPanel,isRealTimeTranslationEnabled:t.isRealTimeTranslationEnabled,canSelectSpokenLanguages:t.canSelectSpokenLanguages,waitingForOthersToJoin:t.waitingForOthersToJoin,canSendReactions:t.canSendReactions,canManageBreakout:t.canManageBreakout,canBroadcastMessageToBreakout:t.canBroadcastMessageToBreakout,canAdmitLobbyToBreakout:t.canAdmitLobbyToBreakout,isBreakoutPreassignmentsEnabled:t.isBreakoutPreassignmentsEnabled,canUserAskForHelp:t.canUserAskForHelp,canUserRenameSelfAndObserved:t.canUserRenameSelfAndObserved,canUserRenameOthers:t.canUserRenameOthers,canMuteAll:t.canMuteAll,canUnmuteAll:t.canUnmuteAll,canEnableHardMute:t.canEnableHardMute,canDisableHardMute:t.canDisableHardMute,canEnableMuteOnEntry:t.canEnableMuteOnEntry,canDisableMuteOnEntry:t.canDisableMuteOnEntry,canEnableReactions:t.canEnableReactions,canDisableReactions:t.canDisableReactions,canEnableReactionDisplayNames:t.canEnableReactionDisplayNames,canDisableReactionDisplayNames:t.canDisableReactionDisplayNames,canUpdateShareControl:t.canUpdateShareControl,canEnableViewTheParticipantsList:t.canEnableViewTheParticipantsList,canDisableViewTheParticipantsList:t.canDisableViewTheParticipantsList,canEnableRaiseHand:t.canEnableRaiseHand,canDisableRaiseHand:t.canDisableRaiseHand,canEnableVideo:t.canEnableVideo,canDisableVideo:t.canDisableVideo,canShareFile:t.canShareFile,canShareApplication:t.canShareApplication,canShareCamera:t.canShareCamera,canShareDesktop:t.canShareDesktop,canShareContent:t.canShareContent,canTransferFile:t.canTransferFile,canChat:t.canChat,canDoVideo:t.canDoVideo,canAnnotate:t.canAnnotate,canUseVoip:t.canUseVoip,enforceVirtualBackground:t.enforceVirtualBackground,supportHQV:t.supportHQV,supportHDV:t.supportHDV,canShareWhiteBoard:t.canShareWhiteBoard}})),(0,R.Z)(this,"set",(function(e){var r=t.get(),n=!1;return U()(r).forEach((function(i){var o=e[i];void 0!==o&&o!==r[i]&&(n=!0,t[i]=o)})),n}))})),XT="react",ex=function(){function e(t,r){(0,k.Z)(this,e),(0,R.Z)(this,"request",void 0),(0,R.Z)(this,"displayHints",[]),(0,R.Z)(this,"selfUserPolicies",void 0),(0,R.Z)(this,"serviceUrl",void 0),(0,R.Z)(this,"sessionId",void 0),(0,R.Z)(this,"locusUrl",void 0),(0,R.Z)(this,"locusId",void 0),this.initialize(t),this.set(r)}return(0,O.Z)(e,[{key:"initialize",value:function(e){this.request=e}},{key:"set",value:function(e){this.extract(e)}},{key:"setLocusUrl",value:function(e){this.locusUrl=e,this.locusId=N_.extractLocusId(this.locusUrl)}},{key:"setDisplayHints",value:function(e){this.displayHints=e}},{key:"setUserPolicy",value:function(e){this.selfUserPolicies=e}},{key:"setSessionId",value:function(e){this.sessionId=e}},{key:"setServiceUrl",value:function(e){this.serviceUrl=e}},{key:"getLocusUrl",value:function(){return this.locusUrl}},{key:"getLocusId",value:function(){return this.locusId}},{key:"getSessionId",value:function(){return this.sessionId}},{key:"getServiceUrl",value:function(){return this.serviceUrl}},{key:"getDisplayHints",value:function(){return this.displayHints}},{key:"extract",value:function(e){this.setServiceUrl(null==e?void 0:e.serviceUrl),this.setSessionId(null==e?void 0:e.sessionId),this.setDisplayHints(null==e?void 0:e.displayHints),this.setLocusUrl(null==e?void 0:e.locusUrl)}},{key:"recordingService",value:function(e){return this.request.request({body:{meetingInfo:{locusSessionId:this.sessionId},recording:{action:e.toLowerCase()}},uri:"".concat(this.serviceUrl,"/loci/").concat(this.locusId,"/recording"),method:tv.PUT})}},{key:"recordingControls",value:function(e){var t=N_.deriveRecordingStates(e);return pp.logger.log("RecordingController:index#recordingControls --\x3e ".concat(t)),this.request.request({uri:"".concat(this.locusUrl,"/").concat(Pp),body:{record:t},method:tv.PATCH})}},{key:"recordingFacade",value:function(e){return pp.logger.log("RecordingController:index#recordingFacade --\x3e recording action [".concat(e,"]")),null!=N_&&N_["canUser".concat(e)](this.displayHints,this.selfUserPolicies)?this.serviceUrl?this.recordingService(e):this.recordingControls(e):P().reject(new qy("".concat(e," recording not allowed, due to moderator property.")))}},{key:"startRecording",value:function(){return this.recordingFacade(O_.Start)}},{key:"stopRecording",value:function(){return this.recordingFacade(O_.Stop)}},{key:"pauseRecording",value:function(){return this.recordingFacade(O_.Pause)}},{key:"resumeRecording",value:function(){return this.recordingFacade(O_.Resume)}}]),e}(),tx=r(68929),rx=r.n(tx);function nx(e,t){var r=U()(e);if(p()){var n=p()(e);t&&(n=n.filter((function(t){return g()(e,t).enumerable}))),r.push.apply(r,n)}return r}function ix(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?nx(Object(r),!0).forEach((function(t){(0,R.Z)(e,t,r[t])})):y()?E()(e,y()(r)):nx(Object(r)).forEach((function(t){S()(e,t,g()(r,t))}))}return e}var ox=function(){function e(t,r){(0,k.Z)(this,e),(0,R.Z)(this,"request",void 0),(0,R.Z)(this,"displayHints",[]),(0,R.Z)(this,"locusUrl",void 0),this.initialize(t),this.set(r)}return(0,O.Z)(e,[{key:"initialize",value:function(e){this.request=e}},{key:"set",value:function(e){this.extract(e)}},{key:"setLocusUrl",value:function(e){this.locusUrl=e}},{key:"setDisplayHints",value:function(e){this.displayHints=e}},{key:"getLocusUrl",value:function(){return this.locusUrl}},{key:"getDisplayHints",value:function(){return this.displayHints}},{key:"extract",value:function(e){this.setDisplayHints(null==e?void 0:e.displayHints),this.setLocusUrl(null==e?void 0:e.locusUrl)}},{key:"update",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.map((function(t){if(!U()(L_).includes(t.scope))throw new Error('updating meeting control scope "'.concat(t.scope,'" is not a supported scope'));if(!M_.canUpdate(t,e.displayHints))throw new qy('updating meeting control scope "'.concat(t.scope,'" not allowed, due to moderator property.'));return(0,R.Z)({},t.scope,t.properties)})).reduce((function(t,r){return t.then((function(){return e.request.request({uri:"".concat(e.locusUrl,"/").concat(Pp),body:r,method:tv.PATCH})}))}),P().resolve())}},{key:"setControls",value:function(e){var t=this;pp.logger.log("ControlsOptionsManager:index#setControls --\x3e ".concat(uy()(e)));var r,n={},i=!1;return uS()(e).forEach((function(o){var s=(0,xy.Z)(o,2),a=s[0],c=s[1];if(i||null!=M_&&M_["".concat(c?"canSet":"canUnset").concat(a)](t.displayHints)||(r=new qy("".concat(a," [").concat(c,"] not allowed, due to moderator property."))),!r)switch(a){case P_.muted:i=!0,n.audio=n.audio?ix(ix({},n.audio),{},(0,R.Z)({},rx()(a),c)):(0,R.Z)({},rx()(a),c);break;case P_.disallowUnmute:case P_.muteOnEntry:U()(e).includes(P_.muted)?(n.audio=n.audio?ix(ix({},n.audio),{},(0,R.Z)({},rx()(a),c)):(0,R.Z)({},rx()(a),c),n.audio[rx()(a)]=c):n[rx()(a)]=(0,R.Z)({},"enabled",c);break;default:r=new qy("".concat(a," [").concat(c,"] not allowed, due to moderator property."))}})),r?P().reject(r):this.request.request({uri:"".concat(this.locusUrl,"/").concat(Pp),body:n,method:tv.PATCH})}},{key:"setMuteOnEntry",value:function(e){return this.setControls((0,R.Z)({},P_.muteOnEntry,e))}},{key:"setDisallowUnmute",value:function(e){return this.setControls((0,R.Z)({},P_.disallowUnmute,e))}},{key:"setMuteAll",value:function(e,t,r){return this.setControls((0,R.Z)((0,R.Z)((0,R.Z)({},P_.muted,e),P_.disallowUnmute,t),P_.muteOnEntry,r))}}]),e}(),sx=r(81629),ax=r.n(sx);function cx(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var ux=function(){function e(t,r,n){(0,k.Z)(this,e),(0,R.Z)(this,"request",void 0),(0,R.Z)(this,"pendingPromises",void 0),(0,R.Z)(this,"sendRequestFn",void 0),this.request=t,this.pendingPromises=[r],this.sendRequestFn=n}return(0,O.Z)(e,[{key:"getPendingPromises",value:function(){return this.pendingPromises}},{key:"addPendingPromises",value:function(e){var t;(t=this.pendingPromises).push.apply(t,(0,_.Z)(e))}},{key:"execute",value:function(){var e=this;return this.sendRequestFn(this.request).then((function(t){e.pendingPromises.forEach((function(e){return e.resolve(t)}))})).catch((function(t){e.pendingPromises.forEach((function(e){return e.reject(t)}))}))}}]),e}();function lx(e){return"RoapMessage"===e.type&&e.roapMessage.messageType===Av.ROAP_TYPES.OFFER}var dx=function(e){(0,A.Z)(r,e);var t=cx(r);function r(e,n){var i;return(0,k.Z)(this,r),i=t.call(this,{},n),(0,R.Z)((0,x.Z)(i),"config",void 0),(0,R.Z)((0,x.Z)(i),"latestAudioMuted",void 0),(0,R.Z)((0,x.Z)(i),"latestVideoMuted",void 0),(0,R.Z)((0,x.Z)(i),"isRequestInProgress",void 0),(0,R.Z)((0,x.Z)(i),"queuedRequests",void 0),(0,R.Z)((0,x.Z)(i),"confluenceState",void 0),i.isRequestInProgress=!1,i.queuedRequests=[],i.config=e,i.confluenceState="not created",i}return(0,O.Z)(r,[{key:"addToQueue",value:function(e){"LocalMute"===e.request.type&&this.queuedRequests.length>0?this.queuedRequests[0].addPendingPromises(e.getPendingPromises()):("RoapMessage"===e.request.type&&this.queuedRequests.length>0&&(this.queuedRequests=this.queuedRequests.filter((function(t){return"LocalMute"!==t.request.type||(e.addPendingPromises(t.getPendingPromises()),!1)}))),this.queuedRequests.push(e))}},{key:"executeNextQueuedRequest",value:function(){var e=this;if(!this.isRequestInProgress){var t=this.queuedRequests.shift();t&&(this.isRequestInProgress=!0,t.execute().then((function(){e.isRequestInProgress=!1,e.executeNextQueuedRequest()})))}}},{key:"getLatestMuteState",value:function(){return{audioMuted:void 0===this.latestAudioMuted||this.latestAudioMuted,videoMuted:void 0===this.latestVideoMuted||this.latestVideoMuted}}},{key:"sendHttpRequest",value:function(e){var t=this,r="".concat(e.selfUrl,"/").concat(tm),n=this.getLatestMuteState(),i=n.audioMuted,o=n.videoMuted,s={device:this.config.device,correlationId:this.config.correlationId,clientMediaPreferences:{preferTranscoding:this.config.preferTranscoding,ipver:"RoapMessage"===e.type?e.ipVersion:void 0}},a={audioMuted:i,videoMuted:o};switch(e.type){case"LocalMute":s.respOnlySdp=!0,s.usingResource=null;break;case"RoapMessage":a.roapMessage=e.roapMessage,a.reachability=e.reachability,s.clientMediaPreferences.joinCookie=e.joinCookie}return e.sequence&&(s.sequence=e.sequence),s.localMedias=[{localSdp:uy()(a),mediaId:e.mediaId}],pp.logger.info("Meeting:LocusMediaRequest#sendHttpRequest --\x3e ".concat(e.type," audioMuted=").concat(i," videoMuted=").concat(o)),lx(e)&&"not created"===this.confluenceState&&(this.confluenceState="creation in progress"),this.request({method:tv.PUT,uri:r,body:s}).then((function(r){return lx(e)&&(t.confluenceState="created"),r})).catch((function(r){throw lx(e)&&"creation in progress"===t.confluenceState&&(t.confluenceState="not created"),r}))}},{key:"send",value:function(e){var t=this;if("LocalMute"===e.type){var r=e.muteOptions,n=r.audioMuted,i=r.videoMuted;if(void 0!==n&&(this.latestAudioMuted=n),void 0!==i&&(this.latestVideoMuted=i),"not created"===this.confluenceState)return pp.logger.info("Meeting:LocusMediaRequest#send --\x3e called with LocalMute request before confluence creation"),P().resolve({})}var o=new bp.Defer,s=new ux(e,o,this.sendHttpRequest.bind(this));return this.addToQueue(s),ax()((function(){return t.executeNextQueuedRequest()})),o.promise}}]),r}(l._y);function hx(e,t){var r=void 0!==Ey()&&e[Sy()]||e["@@iterator"];if(!r){if(Ty()(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return fx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return yy()(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fx(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}function fx(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function px(e,t){var r=U()(e);if(p()){var n=p()(e);t&&(n=n.filter((function(t){return g()(e,t).enumerable}))),r.push.apply(r,n)}return r}function mx(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?px(Object(r),!0).forEach((function(t){(0,R.Z)(e,t,r[t])})):y()?E()(e,y()(r)):px(Object(r)).forEach((function(t){S()(e,t,g()(r,t))}))}return e}function gx(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}ay().isBrowser;var vx=function(e,t){var r=t.logText,n=void 0===r?"":r;return pp.logger.info("".concat(n," - sending request")),e.then((function(e){return pp.logger.info("".concat(n," - has been successfully sent")),e})).catch((function(e){throw pp.logger.error("".concat(n," - has failed: "),e),e}))},yx="TRANSCODED_MEDIA_CONNECTION",bx="SHARE_FLOOR_REQUEST",Ex="UPDATE_MEDIA",wx=function(e){return e.PENDING="floor_request_pending",e.GRANTED="floor_request_granted",e.RELEASED="floor_released",e}({}),Sx=function(e){(0,A.Z)(j,e);var t,r,n,i,o,s,a,c,u,l,d,h,f,p,m,g,v,y,b,E,w,S,_,I,C,N,L,D,M,B=gx(j);function j(e,t){var r,n,i,o,s,a,c,u,l,d;(0,k.Z)(this,j),d=B.call(this,{},t),(0,R.Z)((0,x.Z)(d),"attrs",void 0),(0,R.Z)((0,x.Z)(d),"audio",void 0),(0,R.Z)((0,x.Z)(d),"breakouts",void 0),(0,R.Z)((0,x.Z)(d),"simultaneousInterpretation",void 0),(0,R.Z)((0,x.Z)(d),"annotation",void 0),(0,R.Z)((0,x.Z)(d),"webinar",void 0),(0,R.Z)((0,x.Z)(d),"conversationUrl",void 0),(0,R.Z)((0,x.Z)(d),"callStateForMetrics",void 0),(0,R.Z)((0,x.Z)(d),"destination",void 0),(0,R.Z)((0,x.Z)(d),"destinationType",void 0),(0,R.Z)((0,x.Z)(d),"deviceUrl",void 0),(0,R.Z)((0,x.Z)(d),"hostId",void 0),(0,R.Z)((0,x.Z)(d),"id",void 0),(0,R.Z)((0,x.Z)(d),"isMultistream",void 0),(0,R.Z)((0,x.Z)(d),"locusUrl",void 0),(0,R.Z)((0,x.Z)(d),"mediaConnections",void 0),(0,R.Z)((0,x.Z)(d),"mediaId",void 0),(0,R.Z)((0,x.Z)(d),"meetingFiniteStateMachine",void 0),(0,R.Z)((0,x.Z)(d),"meetingInfo",void 0),(0,R.Z)((0,x.Z)(d),"meetingRequest",void 0),(0,R.Z)((0,x.Z)(d),"members",void 0),(0,R.Z)((0,x.Z)(d),"options",void 0),(0,R.Z)((0,x.Z)(d),"orgId",void 0),(0,R.Z)((0,x.Z)(d),"owner",void 0),(0,R.Z)((0,x.Z)(d),"partner",void 0),(0,R.Z)((0,x.Z)(d),"policy",void 0),(0,R.Z)((0,x.Z)(d),"reconnectionManager",void 0),(0,R.Z)((0,x.Z)(d),"resource",void 0),(0,R.Z)((0,x.Z)(d),"roap",void 0),(0,R.Z)((0,x.Z)(d),"roapSeq",void 0),(0,R.Z)((0,x.Z)(d),"selfUrl",void 0),(0,R.Z)((0,x.Z)(d),"sipUri",void 0),(0,R.Z)((0,x.Z)(d),"type",void 0),(0,R.Z)((0,x.Z)(d),"userId",void 0),(0,R.Z)((0,x.Z)(d),"video",void 0),(0,R.Z)((0,x.Z)(d),"callEvents",void 0),(0,R.Z)((0,x.Z)(d),"datachannelUrl",void 0),(0,R.Z)((0,x.Z)(d),"deferJoin",void 0),(0,R.Z)((0,x.Z)(d),"dialInDeviceStatus",void 0),(0,R.Z)((0,x.Z)(d),"dialInUrl",void 0),(0,R.Z)((0,x.Z)(d),"dialOutDeviceStatus",void 0),(0,R.Z)((0,x.Z)(d),"dialOutUrl",void 0),(0,R.Z)((0,x.Z)(d),"fetchMeetingInfoTimeoutId",void 0),(0,R.Z)((0,x.Z)(d),"floorGrantPending",void 0),(0,R.Z)((0,x.Z)(d),"hasJoinedOnce",void 0),(0,R.Z)((0,x.Z)(d),"hasWebsocketConnected",void 0),(0,R.Z)((0,x.Z)(d),"inMeetingActions",void 0),(0,R.Z)((0,x.Z)(d),"isLocalShareLive",void 0),(0,R.Z)((0,x.Z)(d),"isRoapInProgress",void 0),(0,R.Z)((0,x.Z)(d),"keepAliveTimerId",void 0),(0,R.Z)((0,x.Z)(d),"lastVideoLayoutInfo",void 0),(0,R.Z)((0,x.Z)(d),"locusInfo",void 0),(0,R.Z)((0,x.Z)(d),"locusMediaRequest",void 0),(0,R.Z)((0,x.Z)(d),"mediaProperties",void 0),(0,R.Z)((0,x.Z)(d),"mediaRequestManagers",void 0),(0,R.Z)((0,x.Z)(d),"meetingInfoFailureReason",void 0),(0,R.Z)((0,x.Z)(d),"meetingInfoFailureCode",void 0),(0,R.Z)((0,x.Z)(d),"meetingInfoExtraParams",void 0),(0,R.Z)((0,x.Z)(d),"networkQualityMonitor",void 0),(0,R.Z)((0,x.Z)(d),"networkStatus",void 0),(0,R.Z)((0,x.Z)(d),"passwordStatus",void 0),(0,R.Z)((0,x.Z)(d),"queuedMediaUpdates",void 0),(0,R.Z)((0,x.Z)(d),"recording",void 0),(0,R.Z)((0,x.Z)(d),"remoteMediaManager",void 0),(0,R.Z)((0,x.Z)(d),"recordingController",void 0),(0,R.Z)((0,x.Z)(d),"controlsOptionsManager",void 0),(0,R.Z)((0,x.Z)(d),"requiredCaptcha",void 0),(0,R.Z)((0,x.Z)(d),"receiveSlotManager",void 0),(0,R.Z)((0,x.Z)(d),"selfUserPolicies",void 0),(0,R.Z)((0,x.Z)(d),"enforceVBGImagesURL",void 0),(0,R.Z)((0,x.Z)(d),"shareStatus",void 0),(0,R.Z)((0,x.Z)(d),"screenShareFloorState",void 0),(0,R.Z)((0,x.Z)(d),"statsAnalyzer",void 0),(0,R.Z)((0,x.Z)(d),"transcription",void 0),(0,R.Z)((0,x.Z)(d),"updateMediaConnections",void 0),(0,R.Z)((0,x.Z)(d),"userDisplayHints",void 0),(0,R.Z)((0,x.Z)(d),"endCallInitJoinReq",void 0),(0,R.Z)((0,x.Z)(d),"endJoinReqResp",void 0),(0,R.Z)((0,x.Z)(d),"endLocalSDPGenRemoteSDPRecvDelay",void 0),(0,R.Z)((0,x.Z)(d),"joinedWith",void 0),(0,R.Z)((0,x.Z)(d),"locusId",void 0),(0,R.Z)((0,x.Z)(d),"startCallInitJoinReq",void 0),(0,R.Z)((0,x.Z)(d),"startJoinReqResp",void 0),(0,R.Z)((0,x.Z)(d),"startLocalSDPGenRemoteSDPRecvDelay",void 0),(0,R.Z)((0,x.Z)(d),"wirelessShare",void 0),(0,R.Z)((0,x.Z)(d),"guest",void 0),(0,R.Z)((0,x.Z)(d),"meetingJoinUrl",void 0),(0,R.Z)((0,x.Z)(d),"meetingNumber",void 0),(0,R.Z)((0,x.Z)(d),"meetingState",void 0),(0,R.Z)((0,x.Z)(d),"permissionToken",void 0),(0,R.Z)((0,x.Z)(d),"permissionTokenPayload",void 0),(0,R.Z)((0,x.Z)(d),"permissionTokenReceivedLocalTime",void 0),(0,R.Z)((0,x.Z)(d),"resourceId",void 0),(0,R.Z)((0,x.Z)(d),"resourceUrl",void 0),(0,R.Z)((0,x.Z)(d),"selfId",void 0),(0,R.Z)((0,x.Z)(d),"state",void 0),(0,R.Z)((0,x.Z)(d),"localAudioStreamMuteStateHandler",void 0),(0,R.Z)((0,x.Z)(d),"localVideoStreamMuteStateHandler",void 0),(0,R.Z)((0,x.Z)(d),"localOutputTrackChangeHandler",void 0),(0,R.Z)((0,x.Z)(d),"roles",void 0),(0,R.Z)((0,x.Z)(d),"environment",void 0),(0,R.Z)((0,x.Z)(d),"namespace",pg),(0,R.Z)((0,x.Z)(d),"allowMediaInLobby",void 0),(0,R.Z)((0,x.Z)(d),"localShareInstanceId",void 0),(0,R.Z)((0,x.Z)(d),"remoteShareInstanceId",void 0),(0,R.Z)((0,x.Z)(d),"turnDiscoverySkippedReason",void 0),(0,R.Z)((0,x.Z)(d),"turnServerUsed",void 0),(0,R.Z)((0,x.Z)(d),"areVoiceaEventsSetup",!1),(0,R.Z)((0,x.Z)(d),"voiceaListenerCallbacks",(0,R.Z)((0,R.Z)((0,R.Z)((0,R.Z)((0,R.Z)({},XE.EVENT_TRIGGERS.VOICEA_ANNOUNCEMENT,(function(e){d.transcription.languageOptions=e,Qv.trigger((0,x.Z)(d),{file:"meeting/index",function:"setUpVoiceaListeners"},$g.MEETING_STARTED_RECEIVING_TRANSCRIPTION,e)})),XE.EVENT_TRIGGERS.CAPTIONS_TURNED_ON,(function(){d.transcription.status=XE.TURN_ON_CAPTION_STATUS.ENABLED})),XE.EVENT_TRIGGERS.EVA_COMMAND,(function(e){var t,r=e.data;d.transcription.isListening=!!r.isListening,d.transcription.commandText=null!==(t=r.text)&&void 0!==t?t:""})),XE.EVENT_TRIGGERS.NEW_CAPTION,(function(e){!function(e){var t=e.data,r=e.meeting,n=t.transcriptId,i=r.transcription;if(t.isFinal){var o,s,a;n in i.interimCaptions&&(i.interimCaptions[n].forEach((function(e){var t=i.captions.findIndex((function(t){return t.id===e}));-1!==t&&i.captions.splice(t,1)})),delete i.interimCaptions[n]);var c=null===(o=t.transcript)||void 0===o?void 0:o.csis[0],u=iw({meetingMembers:r.members.membersCollection.members,transcriptData:i,csisKey:c}),l=u.needsCaching,d=u.speaker;l&&(i.speakerProxy[c]=d);var h={id:n,isFinal:t.isFinal,translations:t.translations,text:null===(s=t.transcript)||void 0===s?void 0:s.text,currentSpokenLanguage:null===(a=t.transcript)||void 0===a?void 0:a.transcriptLanguageCode,timestamp:t.timestamp,speaker:d};i.captions.push(h)}var f,p=t.transcripts,m=void 0===p?[]:p,g=new(tw()),v=rw(m);try{for(v.s();!(f=v.n()).done;){var y,b,E=f.value,w=E.text,S=E.transcript_language_code,_=(0,xy.Z)(E.csis,1)[0],T="".concat(null!==(y=null===(b=g.get(_))||void 0===b?void 0:b.text)&&void 0!==y?y:""," ").concat(w);g.set(_,{text:T,currentSpokenLanguage:S})}}catch(e){v.e(e)}finally{v.f()}var x,A=[],I=rw(g);try{var C=function(){var e=(0,xy.Z)(x.value,2),o=e[0],s=e[1],a=iw({meetingMembers:r.members.membersCollection.members,transcriptData:i,csisKey:o}),c=a.needsCaching,u=a.speaker;c&&(i.speakerProxy[o]=u);var l=u.speakerId,d="".concat(n,"_").concat(l),h={id:d,isFinal:t.isFinal,translations:s.translations,text:s.text,currentCaptionLanguage:s.currentSpokenLanguage,timestamp:null==s?void 0:s.timestamp,speaker:u},f=i.captions.findIndex((function(e){return e.id===d}));-1!==f&&i.captions.splice(f,1),A.push(d),i.captions.push(h)};for(I.s();!(x=I.n()).done;)C()}catch(e){I.e(e)}finally{I.f()}i.interimCaptions[n]=A}({data:e,meeting:(0,x.Z)(d)}),Qv.trigger((0,x.Z)(d),{file:"meeting/index",function:"setUpVoiceaListeners"},$g.MEETING_CAPTION_RECEIVED,{captions:d.transcription.captions,interimCaptions:d.transcription.interimCaptions})})),XE.EVENT_TRIGGERS.HIGHLIGHT_CREATED,(function(e){!function(e){var t=e.data,r=e.meeting,n=r.transcription;n.highlights||(n.highlights=[]);var i=t.csis&&t.csis.length>0?t.csis[0]:void 0,o=iw({meetingMembers:r.members.membersCollection.members,transcriptData:n,csisKey:i}),s=o.needsCaching,a=o.speaker;s&&(n.speakerProxy[i]=a);var c={id:t.highlightId,meta:{label:t.highlightLabel,source:t.highlightSource},text:t.text,timestamp:t.timestamp,speaker:a};r.transcription.highlights.push(c)}({data:e,meeting:(0,x.Z)(d)})}))),(0,R.Z)((0,x.Z)(d),"retriedWithTurnServer",void 0),(0,R.Z)((0,x.Z)(d),"sendSlotManager",new rT(pp)),(0,R.Z)((0,x.Z)(d),"deferSDPAnswer",void 0),(0,R.Z)((0,x.Z)(d),"sdpResponseTimer",void 0),(0,R.Z)((0,x.Z)(d),"hasMediaConnectionConnectedAtLeastOnce",void 0),(0,R.Z)((0,x.Z)(d),"processRelayEvent",(function(e){if(e.data.relayType===XT)if((d.config.receiveReactions||options.receiveReactions)&&d.isReactionsSupported()){var t=d.members.membersCollection.get(e.data.sender.participantId).name,r={reaction:e.data.reaction,sender:{id:e.data.sender.participantId,name:t}};Qv.trigger((0,x.Z)(d),{file:"meeting/index",function:"join"},$g.MEETING_RECEIVE_REACTIONS,r)}})),(0,R.Z)((0,x.Z)(d),"handleRoapFailure",(function(e){var t=function(e,t,r){var n,i={code:t.code,correlation_id:r,reason:t.message,stack:t.stack},o={type:(null===(n=t.cause)||void 0===n?void 0:n.name)||t.name};sp.sendBehavioralMetric(e,i,o)};e instanceof vh.SdpOfferCreationError?(t(Bb,e,d.correlationId),d.webex.internal.newMetrics.submitClientEvent({name:"client.media-engine.local-sdp-generated",payload:{canProceed:!1},options:{meetingId:d.id,rawError:e}})):e instanceof vh.SdpOfferHandlingError||e instanceof vh.SdpAnswerHandlingError?(t(Bb,e,d.correlationId),d.webex.internal.newMetrics.submitClientEvent({name:"client.media-engine.remote-sdp-received",payload:{canProceed:!1},options:{meetingId:d.id,rawError:e}})):e instanceof vh.SdpError&&(t(Fb,e,d.correlationId),d.webex.internal.newMetrics.submitClientEvent({name:"client.media-engine.local-sdp-generated",payload:{canProceed:!1},options:{meetingId:d.id,rawError:e}}))})),(0,R.Z)((0,x.Z)(d),"roapMessageReceived",(function(e){var t=R_.getMediaServer(e.sdp);d.mediaProperties.webrtcMediaConnection.roapMessageReceived(e),t&&(d.mediaProperties.webrtcMediaConnection.mediaServer=t)})),(0,R.Z)((0,x.Z)(d),"setupSdpListeners",(function(){d.mediaProperties.webrtcMediaConnection.on(Hc.REMOTE_SDP_ANSWER_PROCESSED,(function(){var e=d.webex.internal.newMetrics.callDiagnosticLatencies;d.webex.internal.newMetrics.submitClientEvent({name:"client.media-engine.remote-sdp-received",options:{meetingId:d.id}}),sp.sendBehavioralMetric(aE,{correlation_id:d.correlationId,latency:e.getLocalSDPGenRemoteSDPRecv(),meetingId:d.id}),d.deferSDPAnswer&&(d.deferSDPAnswer.resolve(),clearTimeout(d.sdpResponseTimer),d.sdpResponseTimer=void 0)})),d.mediaProperties.webrtcMediaConnection.on(Hc.LOCAL_SDP_OFFER_GENERATED,(function(){d.webex.internal.newMetrics.submitClientEvent({name:"client.media-engine.local-sdp-generated",options:{meetingId:d.id}}),d.deferSDPAnswer=new bp.Defer})),d.mediaProperties.webrtcMediaConnection.on(Hc.LOCAL_SDP_ANSWER_GENERATED,(function(){d.webex.internal.newMetrics.submitClientEvent({name:"client.media-engine.remote-sdp-received",options:{meetingId:d.id}})}))})),(0,R.Z)((0,x.Z)(d),"setupMediaConnectionListeners",(function(){d.setupSdpListeners(),d.mediaProperties.webrtcMediaConnection.on(Hc.ROAP_STARTED,(function(){d.isRoapInProgress=!0})),d.mediaProperties.webrtcMediaConnection.on(Hc.ROAP_DONE,(function(){d.mediaNegotiatedEvent(),d.isRoapInProgress=!1,d.processNextQueuedMediaUpdate()})),d.mediaProperties.webrtcMediaConnection.on(Hc.ROAP_FAILURE,d.handleRoapFailure),d.mediaProperties.webrtcMediaConnection.on(Hc.ROAP_MESSAGE_TO_SEND,(function(e){var t="Meeting:index#setupMediaConnectionListeners.ROAP_MESSAGE_TO_SEND --\x3e correlationId=".concat(d.correlationId);switch(e.roapMessage.messageType){case"OK":vx(d.roap.sendRoapOK({seq:e.roapMessage.seq,mediaId:d.mediaId,correlationId:d.correlationId}),{logText:"".concat(t," Roap OK")});break;case"OFFER":vx(d.roap.sendRoapMediaRequest({sdp:e.roapMessage.sdp,seq:e.roapMessage.seq,tieBreaker:e.roapMessage.tieBreaker,meeting:(0,x.Z)(d)}).then((function(e){var r=e.roapAnswer;r&&(pp.logger.log("".concat(t," received Roap ANSWER in http response")),d.roapMessageReceived(r))})),{logText:"".concat(t," Roap Offer")}).catch((function(){d.deferSDPAnswer.reject(),clearTimeout(d.sdpResponseTimer),d.sdpResponseTimer=void 0}));break;case"ANSWER":vx(d.roap.sendRoapAnswer({sdp:e.roapMessage.sdp,seq:e.roapMessage.seq,mediaId:d.mediaId,correlationId:d.correlationId}),{logText:"".concat(t," Roap Answer")}).catch((function(e){var t=Mb,r={correlation_id:d.correlationId,locus_id:d.locusUrl.split("/").pop(),reason:e.message,stack:e.stack},n={type:e.name};sp.sendBehavioralMetric(t,r,n)}));break;case"ERROR":e.roapMessage.errorType!==qc.CONFLICT&&e.roapMessage.errorType!==qc.DOUBLECONFLICT||sp.sendBehavioralMetric(Ub,{correlation_id:d.correlationId,locus_id:d.locusUrl.split("/").pop(),sequence:e.roapMessage.seq}),vx(d.roap.sendRoapError({seq:e.roapMessage.seq,errorType:e.roapMessage.errorType,mediaId:d.mediaId,correlationId:d.correlationId}),{logText:"".concat(t," Roap Error (").concat(e.roapMessage.errorType,")")});break;default:pp.logger.error("".concat(t," Unsupported message type: ").concat(e.roapMessage.messageType))}})),d.mediaProperties.webrtcMediaConnection.on(Hc.REMOTE_TRACK_ADDED,(function(e){if(pp.logger.log("Meeting:index#setupMediaConnectionListeners --\x3e REMOTE_TRACK_ADDED event received for webrtcMediaConnection: ".concat(uy()(e))),e.track){var t,r=e.track,n=new Kt(B_.createMediaStream([r]));switch(e.type){case Gc.AUDIO:t=Zg.REMOTE_AUDIO,d.mediaProperties.setRemoteAudioStream(n);break;case Gc.VIDEO:t=Zg.REMOTE_VIDEO,d.mediaProperties.setRemoteVideoStream(n);break;case Gc.SCREENSHARE_VIDEO:t=Zg.REMOTE_SHARE,d.mediaProperties.setRemoteShareStream(n);break;default:pp.logger.log("Meeting:index#setupMediaConnectionListeners --\x3e unexpected track")}t&&r&&Qv.trigger((0,x.Z)(d),{file:"meeting/index",function:"setupRemoteTrackListener:Event.REMOTE_TRACK_ADDED"},$g.MEDIA_READY,{type:t,stream:n.outputStream})}})),d.mediaProperties.webrtcMediaConnection.on(Hc.CONNECTION_STATE_CHANGED,(function(e){var t=function(){sp.sendBehavioralMetric(fb,{correlation_id:d.correlationId,locus_id:d.locusId,networkStatus:d.networkStatus,hasMediaConnectionConnectedAtLeastOnce:d.hasMediaConnectionConnectedAtLeastOnce}),d.hasMediaConnectionConnectedAtLeastOnce&&(d.reconnectionManager.resetReconnectionTimer(),d.reconnect({networkDisconnect:!0}),d.uploadLogs({file:"peer-connection-manager/index",function:"connectionFailed"}))};pp.logger.info("Meeting:index#setupMediaConnectionListeners --\x3e correlationId=".concat(d.correlationId," connection state changed to ").concat(e.state));var r=d.webex.internal.newMetrics.callDiagnosticLatencies;switch(e.state){case ar.Connecting:d.hasMediaConnectionConnectedAtLeastOnce||d.webex.internal.newMetrics.submitClientEvent({name:"client.ice.start",options:{meetingId:d.id}});break;case ar.Connected:d.hasMediaConnectionConnectedAtLeastOnce||d.webex.internal.newMetrics.submitClientEvent({name:"client.ice.end",payload:{canProceed:!0,icePhase:"JOIN_MEETING_FINAL"},options:{meetingId:d.id}}),sp.sendBehavioralMetric(hb,{correlation_id:d.correlationId,locus_id:d.locusId,latency:r.getICESetupTime()}),d.setNetworkStatus(Cv.CONNECTED),d.reconnectionManager.iceReconnected(),d.statsAnalyzer.startAnalyzer(d.mediaProperties.webrtcMediaConnection),d.hasMediaConnectionConnectedAtLeastOnce=!0;break;case ar.Disconnected:d.setNetworkStatus(Cv.DISCONNECTED),d.reconnectionManager.waitForIceReconnect().catch((function(){pp.logger.info("Meeting:index#setupMediaConnectionListeners --\x3e state DISCONNECTED, automatic reconnection timed out."),t()}));break;case ar.Failed:t()}})),d.mediaProperties.webrtcMediaConnection.on(Hc.ACTIVE_SPEAKERS_CHANGED,(function(e){Qv.trigger((0,x.Z)(d),{file:"meeting/index",function:"setupMediaConnectionListeners"},$g.ACTIVE_SPEAKER_CHANGED,{memberIds:e.map((function(e){var t;return null===(t=d.members.findMemberByCsi(e))||void 0===t?void 0:t.id})).filter((function(e){return void 0!==e}))})})),d.mediaProperties.webrtcMediaConnection.on(Hc.VIDEO_SOURCES_COUNT_CHANGED,(function(e,t,r){Qv.trigger((0,x.Z)(d),{file:"meeting/index",function:"setupMediaConnectionListeners"},$g.REMOTE_VIDEO_SOURCE_COUNT_CHANGED,{numTotalSources:e,numLiveSources:t,mediaContent:r}),r===On.Main&&d.mediaRequestManagers.video.setNumCurrentSources(e,t)})),d.mediaProperties.webrtcMediaConnection.on(Hc.AUDIO_SOURCES_COUNT_CHANGED,(function(e,t,r){Qv.trigger((0,x.Z)(d),{file:"meeting/index",function:"setupMediaConnectionListeners"},$g.REMOTE_AUDIO_SOURCE_COUNT_CHANGED,{numTotalSources:e,numLiveSources:t,mediaContent:r})}))})),(0,R.Z)((0,x.Z)(d),"setupStatsAnalyzerEventHandlers",(function(){d.statsAnalyzer.on(Nw,(function(e){var t;e.data.intervalMetadata.peerReflexiveIP=(null===(t=d.webex.meetings.geoHintInfo)||void 0===t?void 0:t.clientAddress)||e.data.intervalMetadata.peerReflexiveIP||Ov.DEFAULT_IP,d.webex.internal.newMetrics.submitMQE({name:"client.mediaquality.event",options:{meetingId:d.id,networkType:e.networkType},payload:{intervals:[e.data]}})})),d.statsAnalyzer.on(Pw,(function(e){Qv.trigger((0,x.Z)(d),{file:"meeting/index",function:"addMedia"},$g.MEETING_MEDIA_LOCAL_STARTED,e),d.webex.internal.newMetrics.submitClientEvent({name:"client.media.tx.start",payload:{mediaType:e.type,shareInstanceId:"share"===e.type?d.localShareInstanceId:void 0},options:{meetingId:d.id}})})),d.statsAnalyzer.on(Lw,(function(e){d.webex.internal.newMetrics.submitClientEvent({name:"client.media.tx.stop",payload:{mediaType:e.type,shareInstanceId:"share"===e.type?d.localShareInstanceId:void 0},options:{meetingId:d.id}})})),d.statsAnalyzer.on(Dw,(function(e){Qv.trigger((0,x.Z)(d),{file:"meeting/index",function:"addMedia"},$g.MEETING_MEDIA_REMOTE_STARTED,e),d.webex.internal.newMetrics.submitClientEvent({name:"client.media.rx.start",payload:{mediaType:e.type,shareInstanceId:"share"===e.type?d.remoteShareInstanceId:void 0},options:{meetingId:d.id}})})),d.statsAnalyzer.on(Mw,(function(e){d.webex.internal.newMetrics.submitClientEvent({name:"client.media.rx.stop",payload:{mediaType:e.type,shareInstanceId:"share"===e.type?d.remoteShareInstanceId:void 0},options:{meetingId:d.id}})}))})),(0,R.Z)((0,x.Z)(d),"forceSendStatsReport",function(){var e=(0,T.Z)(V().mark((function e(t){var r,n,i,o;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.callFrom,n="Meeting:index#forceSendStatsReport --\x3e called from ".concat(r," : "),e.prev=2,e.next=5,null===(i=d.mediaProperties)||void 0===i||null===(o=i.webrtcMediaConnection)||void 0===o?void 0:o.forceRtcMetricsSend();case 5:pp.logger.info("".concat(n," successfully uploaded available webrtc telemetry statistics")),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),pp.logger.error("".concat(n," failed to upload webrtc telemetry statistics: "),e.t0);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}()),(0,R.Z)((0,x.Z)(d),"mediaNegotiatedEvent",(function(){d.config.experimental.enableMediaNegotiatedEvent&&(pp.logger.info("Meeting:mediaNegotiatedEvent --\x3e Media server negotiated"),Qv.trigger((0,x.Z)(d),{file:"meeting/index",function:"mediaNegotiatedEvent"},$g.MEDIA_NEGOTIATED))})),(0,R.Z)((0,x.Z)(d),"processNextQueuedMediaUpdate",(function(){if(d.canUpdateMedia()&&d.queuedMediaUpdates.length>0){var e=d.queuedMediaUpdates.shift(),t=e.pendingPromiseResolve,r=e.pendingPromiseReject,n=e.mediaUpdateType,i=e.options;pp.logger.log("Meeting:index#processNextQueuedMediaUpdate --\x3e performing delayed media update type=".concat(n));var o=P().resolve();switch(n){case yx:o=d.updateTranscodedMediaConnection();break;case bx:o=d.requestScreenShareFloor();break;case Ex:o=d.updateMedia(i);break;default:pp.logger.error("Peer-connection-manager:index#processNextQueuedMediaUpdate --\x3e unsupported media update type ".concat(n," found in the queue"))}o.then(t,r).then((function(){return d.processNextQueuedMediaUpdate()}))}})),(0,R.Z)((0,x.Z)(d),"handleShareAudioStreamEnded",(0,T.Z)(V().mark((function e(){return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d.wirelessShare||d.mediaProperties.shareVideoStream){e.next=4;break}d.leave({reason:zg.USER_ENDED_SHARE_STREAMS}),e.next=12;break;case 4:return e.prev=4,e.next=7,d.unpublishStreams([d.mediaProperties.shareAudioStream]);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),pp.logger.log("Meeting:index#handleShareAudioStreamEnded --\x3e Error stopping share: ",e.t0);case 12:case"end":return e.stop()}}),e,null,[[4,9]])})))),(0,R.Z)((0,x.Z)(d),"handleShareVideoStreamMuteStateChange",(function(e){pp.logger.log("Meeting:index#handleShareVideoStreamMuteStateChange --\x3e Share video stream mute state changed to muted ".concat(e)),sp.sendBehavioralMetric(Ib,{correlationId:d.correlationId,muted:e})})),(0,R.Z)((0,x.Z)(d),"handleShareVideoStreamEnded",(0,T.Z)(V().mark((function e(){return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d.wirelessShare||d.mediaProperties.shareAudioStream){e.next=4;break}d.leave({reason:zg.USER_ENDED_SHARE_STREAMS}),e.next=12;break;case 4:return e.prev=4,e.next=7,d.unpublishStreams([d.mediaProperties.shareVideoStream]);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),pp.logger.log("Meeting:index#handleShareVideoStreamEnded --\x3e Error stopping share: ",e.t0);case 12:d.triggerStoppedSharing();case 13:case"end":return e.stop()}}),e,null,[[4,9]])})))),(0,R.Z)((0,x.Z)(d),"triggerStoppedSharing",(function(){d.mediaProperties.hasLocalShareStream()||Qv.trigger((0,x.Z)(d),{file:"meeting/index",function:"handleShareStreamEnded"},$g.MEETING_STOPPED_SHARING_LOCAL,{reason:Wg.TRACK_ENDED})})),(0,R.Z)((0,x.Z)(d),"clearMeetingData",(function(){d.audio=null,d.video=null,d.screenShareFloorState=wx.RELEASED,d.shareStatus===qg.LOCAL_SHARE_ACTIVE&&(d.shareStatus=qg.NO_SHARE),d.queuedMediaUpdates=[],d.transcription&&(d.stopTranscription(),d.transcription=void 0)})),(0,R.Z)((0,x.Z)(d),"startKeepAlive",(function(){var e,t;if(d.keepAliveTimerId)pp.logger.warn("Meeting:index#startKeepAlive --\x3e keepAlive not started: keepAliveTimerId already exists");else if(null!==(e=d.joinedWith)&&void 0!==e&&e.keepAliveUrl)if(null!==(t=d.joinedWith)&&void 0!==t&&t.keepAliveSecs)if(d.joinedWith.keepAliveSecs<=1)pp.logger.warn("Meeting:index#startKeepAlive --\x3e keepAlive not started: keepAliveSecs <= 1");else{var r=d.joinedWith.keepAliveUrl,n=750*(d.joinedWith.keepAliveSecs-1);d.keepAliveTimerId=setInterval((function(){d.meetingRequest.keepAlive({keepAliveUrl:r}).catch((function(e){pp.logger.warn("Meeting:index#startKeepAlive --\x3e Stopping sending keepAlives to ".concat(r," after error ").concat(e)),d.stopKeepAlive()}))}),n)}else pp.logger.warn("Meeting:index#startKeepAlive --\x3e keepAlive not started: no keepAliveSecs");else pp.logger.warn("Meeting:index#startKeepAlive --\x3e keepAlive not started: no keepAliveUrl")})),(0,R.Z)((0,x.Z)(d),"stopKeepAlive",(function(){d.keepAliveTimerId&&(clearInterval(d.keepAliveTimerId),d.keepAliveTimerId=null)})),d.attrs=e,d.options=t,d.id=gp().v4(),d.callStateForMetrics=e.callStateForMetrics||{};var h=e.correlationId||(null===(r=e.callStateForMetrics)||void 0===r?void 0:r.correlationId);return h?(pp.logger.log("Meetings:index#constructor --\x3e Initializing the meeting object with correlation id from app ".concat(h)),d.callStateForMetrics.correlationId=h):d.callStateForMetrics.correlationId=d.id,d.userId=e.userId,d.orgId=e.orgId,d.resource=e.resource,d.deviceUrl=e.deviceUrl,d.meetingInfo={},d.breakouts=new MT({meetingId:d.id},{parent:d.webex}),d.simultaneousInterpretation=new jT({},{parent:d.webex}),d.annotation=new WT({parent:d.webex}),d.webinar=new YT({},{parent:d.webex}),d.receiveSlotManager=new tT((function(e){var t;return null!==(t=d.mediaProperties)&&void 0!==t&&t.webrtcMediaConnection?d.mediaProperties.webrtcMediaConnection.createReceiveSlot(e):P().reject(new Error("Webrtc media connection is missing"))}),(function(e){var t;return null===(t=d.members.findMemberByCsi(e))||void 0===t?void 0:t.id})),d.mediaRequestManagers={audio:new dT((function(e){d.mediaProperties.webrtcMediaConnection?d.mediaProperties.webrtcMediaConnection.requestMedia(Pn.AudioMain,e):pp.logger.warn("Meeting:index#mediaRequestManager --\x3e trying to send audio media request before media connection was created")}),{degradationPreferences:d.config.degradationPreferences,kind:"audio",trimRequestsToNumOfSources:!1}),video:new dT((function(e){d.mediaProperties.webrtcMediaConnection?d.mediaProperties.webrtcMediaConnection.requestMedia(Pn.VideoMain,e):pp.logger.warn("Meeting:index#mediaRequestManager --\x3e trying to send video media request before media connection was created")}),{degradationPreferences:d.config.degradationPreferences,kind:"video",trimRequestsToNumOfSources:!0}),screenShareAudio:new dT((function(e){d.mediaProperties.webrtcMediaConnection?d.mediaProperties.webrtcMediaConnection.requestMedia(Pn.AudioSlides,e):pp.logger.warn("Meeting:index#mediaRequestManager --\x3e trying to send screenshare audio media request before media connection was created")}),{degradationPreferences:d.config.degradationPreferences,kind:"audio",trimRequestsToNumOfSources:!1}),screenShareVideo:new dT((function(e){d.mediaProperties.webrtcMediaConnection?d.mediaProperties.webrtcMediaConnection.requestMedia(Pn.VideoSlides,e):pp.logger.warn("Meeting:index#mediaRequestManager --\x3e trying to send screenshare video media request before media connection was created")}),{degradationPreferences:d.config.degradationPreferences,kind:"video",trimRequestsToNumOfSources:!1})},d.members=new I_({locusUrl:e.locus&&e.locus.url,receiveSlotManager:d.receiveSlotManager,mediaRequestManagers:d.mediaRequestManagers,meeting:(0,x.Z)(d)},{parent:d.webex}),d.roap=new Jw({},{parent:d.webex}),d.isRoapInProgress=!1,d.reconnectionManager=new XS((0,x.Z)(d)),d.audio=null,d.video=null,d.meetingFiniteStateMachine=nS.create((0,x.Z)(d)),d.conversationUrl=null,d.locusUrl=e.locus&&e.locus.url||null,d.sipUri=null,d.destination=e.destination,d.destinationType=e.destinationType,d.partner=null,d.type=null,d.owner=null,d.hostId=null,d.policy=null,d.meetingRequest=new c_({meeting:(0,x.Z)(d)},t),d.mediaConnections=null,d.isMultistream=!1,d.fetchMeetingInfoTimeoutId=null,d.updateMediaConnections=function(e){zE()(d.mediaConnections,e)||(d.mediaConnections=e.slice(-1))},d.mediaProperties=new Yw,d.inMeetingActions=new QT,d.shareStatus=qg.NO_SHARE,d.screenShareFloorState=wx.RELEASED,d.callEvents=[],d.floorGrantPending=!1,d.dialInDeviceStatus=Mv.UNKNOWN,d.dialInUrl="",d.dialOutDeviceStatus=Mv.UNKNOWN,d.dialOutUrl="",d.statsAnalyzer=null,d.networkQualityMonitor=null,d.networkStatus=void 0,d.locusInfo=new $S(d.updateMeetingObject.bind((0,x.Z)(d)),d.webex,d.id),d.recording=null,d.deferJoin=void 0,d.hasWebsocketConnected=d.webex.internal.mercury.connected,d.lastVideoLayoutInfo={layoutType:void 0,main:void 0,content:void 0},d.queuedMediaUpdates=[],d.transcription={captions:[],highlights:[],isListening:!1,commandText:"",languageOptions:{},showCaptionBox:!1,transcribingRequestStatus:"INACTIVE",isCaptioning:!1,interimCaptions:{},speakerProxy:{}},d.passwordStatus=Uv.UNKNOWN,d.requiredCaptcha=null,d.meetingInfoFailureReason=void 0,d.meetingInfoFailureCode=void 0,d.keepAliveTimerId=null,d.localShareInstanceId=null,d.remoteShareInstanceId=null,d.recordingController=new ex(d.meetingRequest,{serviceUrl:null===(n=d.locusInfo)||void 0===n||null===(i=n.links)||void 0===i||null===(o=i.services)||void 0===o||null===(s=o.record)||void 0===s?void 0:s.url,sessionId:null===(a=d.locusInfo)||void 0===a||null===(c=a.fullState)||void 0===c?void 0:c.sessionId,locusUrl:null===(u=d.locusInfo)||void 0===u?void 0:u.url,displayHints:[]}),d.controlsOptionsManager=new ox(d.meetingRequest,{locusUrl:null===(l=d.locusInfo)||void 0===l?void 0:l.url,displayHints:[]}),d.setUpLocusInfoListeners(),d.locusInfo.init(e.locus?e.locus:{}),d.hasJoinedOnce=!1,d.remoteMediaManager=null,d.localAudioStreamMuteStateHandler=function(e){d.audio.handleLocalStreamMuteStateChange((0,x.Z)(d),e)},d.localVideoStreamMuteStateHandler=function(e){d.video.handleLocalStreamMuteStateChange((0,x.Z)(d),e)},d.localOutputTrackChangeHandler=function(){d.isMultistream||d.updateTranscodedMediaConnection()},d.deferSDPAnswer=void 0,d.sdpResponseTimer=void 0,d.turnDiscoverySkippedReason=void 0,d.turnServerUsed=!1,d.retriedWithTurnServer=!1,d.hasMediaConnectionConnectedAtLeastOnce=!1,d}return(0,O.Z)(j,[{key:"getWebexObject",value:function(){return this.webex}},{key:"isJoined",value:function(){var e;return"JOINED"===(null===(e=this.joinedWith)||void 0===e?void 0:e.state)}},{key:"isLocusCall",value:function(){return"CALL"===this.type}},{key:"correlationId",get:function(){return this.callStateForMetrics.correlationId},set:function(e){this.callStateForMetrics.correlationId=e}},{key:"setMeetingInfo",value:function(e,t){this.meetingInfo=e?mx(mx({},e),{},{meetingLookupUrl:t}):null,this.meetingInfoFailureReason=Bv.NONE,this.requiredCaptcha=null,this.passwordStatus===Uv.REQUIRED||this.passwordStatus===Uv.VERIFIED?this.passwordStatus=Uv.VERIFIED:this.passwordStatus=Uv.NOT_REQUIRED,Qv.trigger(this,{file:"meetings",function:"fetchMeetingInfo"},$g.MEETING_INFO_AVAILABLE),this.updateMeetingActions()}},{key:"injectMeetingInfo",value:(M=(0,T.Z)(V().mark((function e(t,r,n){return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.prepForFetchMeetingInfo(r,"injectMeetingInfo");case 2:this.parseMeetingInfo(t,this.destination),this.setMeetingInfo(t,n);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return M.apply(this,arguments)})},{key:"prepForFetchMeetingInfo",value:function(e,t){var r=e.password,n=void 0===r?null:r,i=e.captchaCode,o=void 0===i?null:i,s=e.extraParams,a=void 0===s?{}:s;return this.fetchMeetingInfoTimeoutId&&(clearTimeout(this.fetchMeetingInfoTimeoutId),this.fetchMeetingInfoTimeoutId=void 0),o&&!this.requiredCaptcha?P().reject(new Error("".concat(t,"() called with captchaCode when captcha was not required"))):n&&this.passwordStatus!==Uv.REQUIRED&&this.passwordStatus!==Uv.UNKNOWN?P().reject(new Error("".concat(t,"() called with password when password was not required"))):(this.meetingInfoExtraParams=Iy()(a),P().resolve())}},{key:"fetchMeetingInfoInternal",value:(D=(0,T.Z)(V().mark((function e(t){var r,n,i,o,s,a,c,u,l,d,h,f,p,m;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.destination,n=t.destinationType,i=t.password,o=void 0===i?null:i,s=t.captchaCode,a=void 0===s?null:s,c=t.extraParams,u=void 0===c?{}:c,l=t.sendCAevents,d=void 0!==l&&l,e.prev=1,h=a?{code:a,id:this.requiredCaptcha.captchaId}:null,e.next=5,this.attrs.meetingInfoProvider.fetchMeetingInfo(r,n,o,h,this.config.installedOrgID,this.locusId,u,{meetingId:this.id,sendCAevents:d});case 5:return f=e.sent,this.parseMeetingInfo(null==f?void 0:f.body,this.destination,null==f?void 0:f.errors),this.setMeetingInfo(null==f?void 0:f.body,null==f?void 0:f.url),e.abrupt("return",P().resolve());case 11:if(e.prev=11,e.t0=e.catch(1),this.updateMeetingActions(),!(e.t0 instanceof jE)){e.next=21;break}throw this.meetingInfoFailureReason=Bv.POLICY,this.meetingInfoFailureCode=e.t0.wbxAppApiCode,e.t0.meetingInfo&&(this.meetingInfo=e.t0.meetingInfo),new qy;case 21:if(!(e.t0 instanceof BE)){e.next=33;break}if(pp.logger.info("Meeting:index#fetchMeetingInfo --\x3e Info Unable to fetch meeting info for ".concat(this.destination," - password required (code=").concat(null===e.t0||void 0===e.t0||null===(p=e.t0.body)||void 0===p?void 0:p.code,").")),e.t0.meetingInfo&&(this.meetingInfo=e.t0.meetingInfo,this.meetingNumber=e.t0.meetingInfo.meetingNumber),this.meetingInfoFailureCode=e.t0.wbxAppApiCode,this.passwordStatus=Uv.REQUIRED,this.meetingInfoFailureReason=Bv.WRONG_PASSWORD,!this.requiredCaptcha){e.next=30;break}return e.next=30,this.refreshCaptcha();case 30:throw new Zy;case 33:if(!(e.t0 instanceof VE)){e.next=42;break}throw pp.logger.info("Meeting:index#fetchMeetingInfo --\x3e Info Unable to fetch meeting info for ".concat(this.destination," - captcha required (code=").concat(null===e.t0||void 0===e.t0||null===(m=e.t0.body)||void 0===m?void 0:m.code,").")),this.meetingInfoFailureReason=this.requiredCaptcha?Bv.WRONG_CAPTCHA:Bv.WRONG_PASSWORD,this.meetingInfoFailureCode=e.t0.wbxAppApiCode,e.t0.isPasswordRequired&&(this.passwordStatus=Uv.REQUIRED),this.requiredCaptcha=e.t0.captchaInfo,new Ky;case 42:throw this.meetingInfoFailureReason=Bv.OTHER,e.t0;case 44:case"end":return e.stop()}}),e,this,[[1,11]])}))),function(e){return D.apply(this,arguments)})},{key:"refreshPermissionToken",value:(L=(0,T.Z)(V().mark((function e(t){var r,n,i,o,s,a,c,u;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(r=this.meetingInfo)&&void 0!==r&&r.permissionToken){e.next=3;break}return pp.logger.info("Meeting:index#refreshPermissionToken --\x3e cannot refresh the permission token, because we don't have it (reason=".concat(t,")")),e.abrupt("return");case 3:return n=this.destinationType===Tm&&this.config.experimental.enableAdhocMeetings&&this.webex.meetings.preferredWebexSite,i=n?this.meetingInfo.meetingJoinUrl:this.destination,o=n?Bm:this.destinationType,s=this.getPermissionTokenExpiryInfo(),a=null==s?void 0:s.timeLeft,c=null==s?void 0:s.expiryTime,u=null==s?void 0:s.currentTime,pp.logger.info("Meeting:index#refreshPermissionToken --\x3e refreshing permission token, destinationType=".concat(o,", timeLeft=").concat(a,", permissionTokenExpiry=").concat(c,", currentTimestamp=").concat(u,",reason=").concat(t)),sp.sendBehavioralMetric(iE,{correlationId:this.correlationId,timeLeft:a,expiryTime:c,currentTime:u,reason:t,destinationType:o}),e.prev=12,e.next=15,this.fetchMeetingInfoInternal({destination:i,destinationType:o,extraParams:mx(mx({},this.meetingInfoExtraParams),{},{permissionToken:this.meetingInfo.permissionToken}),sendCAevents:!0});case 15:e.next=22;break;case 17:throw e.prev=17,e.t0=e.catch(12),pp.logger.info("Meeting:index#refreshPermissionToken --\x3e failed to refresh the permission token:",e.t0),sp.sendBehavioralMetric(oE,{correlationId:this.correlationId,reason:e.t0.message,stack:e.t0.stack}),e.t0;case 22:case"end":return e.stop()}}),e,this,[[12,17]])}))),function(e){return L.apply(this,arguments)})},{key:"fetchMeetingInfo",value:(N=(0,T.Z)(V().mark((function e(t){return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.prepForFetchMeetingInfo(t,"fetchMeetingInfo");case 2:return e.abrupt("return",this.fetchMeetingInfoInternal(mx({destination:this.destination,destinationType:this.destinationType},t)));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return N.apply(this,arguments)})},{key:"verifyPassword",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.fetchMeetingInfo({password:e,captchaCode:t,sendCAevents:n}).then((function(){return sp.sendBehavioralMetric(zb),{isPasswordValid:!0,requiredCaptcha:null,failureReason:Bv.NONE}})).catch((function(e){if(e instanceof Zy||e instanceof Ky)return{isPasswordValid:r.passwordStatus===Uv.VERIFIED,requiredCaptcha:r.requiredCaptcha,failureReason:r.meetingInfoFailureReason};throw e}))}},{key:"refreshCaptcha",value:function(){var e=this;if(!this.requiredCaptcha)return P().reject(new Error("There is no captcha to refresh"));var t=new URL(this.requiredCaptcha.refreshURL).hostname;return this.meetingRequest.refreshCaptcha({captchaRefreshUrl:"".concat(this.requiredCaptcha.refreshURL,"&siteFullName=").concat(t),captchaId:this.requiredCaptcha.captchaId}).then((function(t){e.requiredCaptcha.captchaId=t.body.captchaID,e.requiredCaptcha.verificationImageURL=t.body.verificationImageURL,e.requiredCaptcha.verificationAudioURL=t.body.verificationAudioURL})).catch((function(t){throw pp.logger.error("Meeting:index#refreshCaptcha --\x3e Error Unable to refresh captcha for ".concat(e.destination," - ").concat(t)),t}))}},{key:"postMetrics",value:function(e){this.webex.internal.newMetrics.submitClientEvent({name:e,options:{meetingId:this.id}})}},{key:"setUpLocusInfoListeners",value:function(){this.setUpLocusInfoSelfListener(),this.setUpLocusInfoMeetingListener(),this.setUpLocusServicesListener(),this.setUpLocusFullStateListener(),this.setUpLocusUrlListener(),this.setUpLocusHostListener(),this.setUpLocusSelfListener(),this.setUpLocusParticipantsListener(),this.setupLocusControlsListener(),this.setUpLocusMediaSharesListener(),this.setUpLocusEmbeddedAppsListener(),this.setUpLocusInfoMeetingInfoListener(),this.setUpLocusInfoAssignHostListener(),this.setUpLocusInfoMediaInactiveListener(),this.setUpBreakoutsListener(),this.setUpInterpretationListener()}},{key:"setUpBreakoutsListener",value:function(){var e=this;this.breakouts.on(av.EVENTS.BREAKOUTS_CLOSING,(function(){Qv.trigger(e,{file:"meeting/index",function:"setUpBreakoutsListener"},$g.MEETING_BREAKOUTS_CLOSING)})),this.breakouts.on(av.EVENTS.MESSAGE,(function(t){Qv.trigger(e,{file:"meeting/index",function:"setUpBreakoutsListener"},$g.MEETING_BREAKOUTS_MESSAGE,t)})),this.breakouts.on(av.EVENTS.MEMBERS_UPDATE,(function(){Qv.trigger(e,{file:"meeting/index",function:"setUpBreakoutsListener"},$g.MEETING_BREAKOUTS_UPDATE)})),this.breakouts.on(av.EVENTS.ASK_RETURN_TO_MAIN,(function(){e.isJoined()&&Qv.trigger(e,{file:"meeting/index",function:"setUpBreakoutsListener"},$g.MEETING_BREAKOUTS_ASK_RETURN_TO_MAIN)})),this.breakouts.on(av.EVENTS.LEAVE_BREAKOUT,(function(){Qv.trigger(e,{file:"meeting/index",function:"setUpBreakoutsListener"},$g.MEETING_BREAKOUTS_LEAVE)})),this.breakouts.on(av.EVENTS.ASK_FOR_HELP,(function(t){Qv.trigger(e,{file:"meeting/index",function:"setUpBreakoutsListener"},$g.MEETING_BREAKOUTS_ASK_FOR_HELP,t)})),this.breakouts.on(av.EVENTS.PRE_ASSIGNMENTS_UPDATE,(function(){Qv.trigger(e,{file:"meeting/index",function:"setUpBreakoutsListener"},$g.MEETING_BREAKOUTS_PRE_ASSIGNMENTS_UPDATE)}))}},{key:"setUpInterpretationListener",value:function(){var e=this;this.simultaneousInterpretation.on(cv.EVENTS.SUPPORT_LANGUAGES_UPDATE,(function(){Qv.trigger(e,{file:"meeting/index",function:"setUpInterpretationListener"},$g.MEETING_INTERPRETATION_SUPPORT_LANGUAGES_UPDATE)})),this.simultaneousInterpretation.on(cv.EVENTS.HANDOFF_REQUESTS_ARRIVED,(function(t){Qv.trigger(e,{file:"meeting/index",function:"setUpInterpretationListener"},$g.MEETING_INTERPRETATION_HANDOFF_REQUESTS_ARRIVED,t)}))}},{key:"setUpVoiceaListeners",value:function(){this.webex.internal.voicea.listenToEvents(),this.webex.internal.voicea.on(XE.EVENT_TRIGGERS.VOICEA_ANNOUNCEMENT,this.voiceaListenerCallbacks[XE.EVENT_TRIGGERS.VOICEA_ANNOUNCEMENT]),this.webex.internal.voicea.on(XE.EVENT_TRIGGERS.CAPTIONS_TURNED_ON,this.voiceaListenerCallbacks[XE.EVENT_TRIGGERS.CAPTIONS_TURNED_ON]),this.webex.internal.voicea.on(XE.EVENT_TRIGGERS.EVA_COMMAND,this.voiceaListenerCallbacks[XE.EVENT_TRIGGERS.EVA_COMMAND]),this.webex.internal.voicea.on(XE.EVENT_TRIGGERS.NEW_CAPTION,this.voiceaListenerCallbacks[XE.EVENT_TRIGGERS.NEW_CAPTION]),this.webex.internal.voicea.on(XE.EVENT_TRIGGERS.HIGHLIGHT_CREATED,this.voiceaListenerCallbacks[XE.EVENT_TRIGGERS.HIGHLIGHT_CREATED]),this.areVoiceaEventsSetup=!0}},{key:"setUpLocusInfoMediaInactiveListener",value:function(){var e=this;this.locusInfo.on(Jg.DISCONNECT_DUE_TO_INACTIVITY,(function(t){sp.sendBehavioralMetric(bb,{correlation_id:e.correlationId,locus_id:e.locusId}),Qv.trigger(e,{file:"meeting/index",function:"setUpLocusInfoMediaInactiveListener"},Jg.REQUEST_UPLOAD_LOGS,e),pp.logger.error("Meeting:index#setUpLocusInfoMediaInactiveListener --\x3e Meeting disconnected due to inactivity: ".concat(t.reason)),e.config.reconnection.autoRejoin?e.reconnect():Qv.trigger(e,{file:"meeting/index",function:"setUpLocusInfoMediaInactiveListener"},$g.MEETING_SELF_LEFT,t.reason)}))}},{key:"setUpLocusInfoAssignHostListener",value:function(){var e=this;this.locusInfo.on(Jg.LOCUS_INFO_CAN_ASSIGN_HOST,(function(t){e.inMeetingActions.set({canAssignHost:t.canAssignHost})&&Qv.trigger(e,{file:"meeting/index",function:"setUpLocusInfoAssignHostListener"},$g.MEETING_ACTIONS_UPDATE,e.inMeetingActions.get())}))}},{key:"setUpLocusFullStateListener",value:function(){var e=this;this.locusInfo.on(uv.EVENTS.FULL_STATE_MEETING_STATE_CHANGE,(function(t){Qv.trigger(e,{file:"meeting/index",function:"setUpLocusFullStateListener"},$g.MEETING_STATE_CHANGE,{payload:t})})),this.locusInfo.on(uv.EVENTS.FULL_STATE_TYPE_UPDATE,(function(t){e.members.locusFullStateTypeUpdate(t)}))}},{key:"setNetworkStatus",value:function(e){e===Cv.DISCONNECTED?Qv.trigger(this,{file:"meeting/index",function:"setNetworkStatus"},$g.MEETINGS_NETWORK_DISCONNECTED):e===Cv.CONNECTED&&this.networkStatus===Cv.DISCONNECTED&&Qv.trigger(this,{file:"meeting/index",function:"setNetworkStatus"},$g.MEETINGS_NETWORK_CONNECTED),this.networkStatus=e}},{key:"setUpLocusSelfListener",value:function(){var e=this;this.locusInfo.on(Jg.LOCUS_INFO_UPDATE_SELF,(function(t){e.members.locusSelfUpdate(t),e.pstnUpdate(t),e.requestScreenShareFloorIfPending()}))}},{key:"pstnUpdate",value:function(e){var t=this;if(this.locusInfo.self){var r,n,i=null===(r=e.newSelf)||void 0===r?void 0:r.pstnDevices.find((function(e){return e.url===t.dialInUrl})),o=null===(n=e.newSelf)||void 0===n?void 0:n.pstnDevices.find((function(e){return e.url===t.dialOutUrl})),s=!1;if(i){var a,c=null!==(a=i.dialingStatus)&&void 0!==a?a:i.state;c!==this.dialInDeviceStatus&&(this.dialInDeviceStatus=c,s=!0)}if(o){var u,l=null!==(u=o.dialingStatus)&&void 0!==u?u:o.state;l!==this.dialOutDeviceStatus&&(this.dialOutDeviceStatus=l,s=!0)}s&&Qv.trigger(this,{file:"meeting/index",function:"setUpLocusSelfListener"},$g.MEETING_SELF_PHONE_AUDIO_UPDATE,{dialIn:{status:this.dialInDeviceStatus,attendeeId:null==i?void 0:i.attendeeId},dialOut:{status:this.dialOutDeviceStatus,attendeeId:null==o?void 0:o.attendeeId,reason:null==o?void 0:o.reason}})}}},{key:"setUpLocusHostListener",value:function(){var e=this;this.locusInfo.on(Jg.LOCUS_INFO_UPDATE_HOST,(function(t){e.members.locusHostUpdate(t)}))}},{key:"setUpLocusParticipantsListener",value:function(){var e=this;this.locusInfo.on(Jg.LOCUS_INFO_UPDATE_PARTICIPANTS,(function(t){e.members.locusParticipantsUpdate(t)}))}},{key:"setupLocusControlsListener",value:function(){var e=this;this.locusInfo.on(uv.EVENTS.CONTROLS_RECORDING_UPDATED,(function(t){var r,n=t.state,i=t.modifiedBy,o=t.lastModified;switch(n){case Gg.RECORDING:r=$g.MEETING_STARTED_RECORDING;break;case Gg.IDLE:r=$g.MEETING_STOPPED_RECORDING;break;case Gg.PAUSED:r=$g.MEETING_PAUSED_RECORDING;break;case Gg.RESUMED:r=$g.MEETING_RESUMED_RECORDING;break;default:r=null}e.recording={state:n===Gg.RESUMED?Gg.RECORDING:n,modifiedBy:i,lastModified:o},Qv.trigger(e,{file:"meeting/index",function:"setupLocusControlsListener"},r,e.recording)})),this.locusInfo.on(uv.EVENTS.CONTROLS_MEETING_CONTAINER_UPDATED,(function(t){var r=t.meetingContainerUrl;Qv.trigger(e,{file:"meeting/index",function:"setupLocusControlsListener"},$g.MEETING_MEETING_CONTAINER_UPDATE,{meetingContainerUrl:r})})),this.locusInfo.on(uv.EVENTS.CONTROLS_MEETING_TRANSCRIBE_UPDATED,(function(t){var r=t.caption,n=t.transcribing;e.isJoined()&&(n&&!e.transcription?e.startTranscription():!n&&e.transcription&&Qv.trigger(e,{file:"meeting/index",function:"setupLocusControlsListener"},$g.MEETING_STOPPED_RECEIVING_TRANSCRIPTION,{caption:r,transcribing:n}))})),this.locusInfo.on(uv.EVENTS.CONTROLS_MEETING_BREAKOUT_UPDATED,(function(t){var r=t.breakout;e.breakouts.updateBreakout(r),Qv.trigger(e,{file:"meeting/index",function:"setupLocusControlsListener"},$g.MEETING_BREAKOUTS_UPDATE)})),this.locusInfo.on(uv.EVENTS.CONTROLS_MEETING_INTERPRETATION_UPDATED,(function(t){var r=t.interpretation;e.simultaneousInterpretation.updateInterpretation(r),Qv.trigger(e,{file:"meeting/index",function:"setupLocusControlsListener"},$g.MEETING_INTERPRETATION_UPDATE)})),this.locusInfo.on(uv.EVENTS.CONTROLS_ENTRY_EXIT_TONE_UPDATED,(function(t){var r=t.entryExitTone;Qv.trigger(e,{file:"meeting/index",function:"setupLocusControlsListener"},$g.MEETING_ENTRY_EXIT_TONE_UPDATE,{entryExitTone:r})})),this.locusInfo.on(uv.EVENTS.CONTROLS_MUTE_ON_ENTRY_CHANGED,(function(t){var r=t.state;Qv.trigger(e,{file:"meeting/index",function:"setupLocusControlsListener"},$g.MEETING_CONTROLS_MUTE_ON_ENTRY_UPDATED,{state:r})})),this.locusInfo.on(uv.EVENTS.CONTROLS_SHARE_CONTROL_CHANGED,(function(t){var r=t.state;Qv.trigger(e,{file:"meeting/index",function:"setupLocusControlsListener"},$g.MEETING_CONTROLS_SHARE_CONTROL_UPDATED,{state:r})})),this.locusInfo.on(uv.EVENTS.CONTROLS_DISALLOW_UNMUTE_CHANGED,(function(t){var r=t.state;Qv.trigger(e,{file:"meeting/index",function:"setupLocusControlsListener"},$g.MEETING_CONTROLS_DISALLOW_UNMUTE_UPDATED,{state:r})})),this.locusInfo.on(uv.EVENTS.CONTROLS_REACTIONS_CHANGED,(function(t){var r=t.state;Qv.trigger(e,{file:"meeting/index",function:"setupLocusControlsListener"},$g.MEETING_CONTROLS_REACTIONS_UPDATED,{state:r})})),this.locusInfo.on(uv.EVENTS.CONTROLS_VIEW_THE_PARTICIPANTS_LIST_CHANGED,(function(t){var r=t.state;Qv.trigger(e,{file:"meeting/index",function:"setupLocusControlsListener"},$g.MEETING_CONTROLS_VIEW_THE_PARTICIPANTS_LIST_UPDATED,{state:r})})),this.locusInfo.on(uv.EVENTS.CONTROLS_RAISE_HAND_CHANGED,(function(t){var r=t.state;Qv.trigger(e,{file:"meeting/index",function:"setupLocusControlsListener"},$g.MEETING_CONTROLS_RAISE_HAND_UPDATED,{state:r})})),this.locusInfo.on(uv.EVENTS.CONTROLS_VIDEO_CHANGED,(function(t){var r=t.state;Qv.trigger(e,{file:"meeting/index",function:"setupLocusControlsListener"},$g.MEETING_CONTROLS_VIDEO_UPDATED,{state:r})}))}},{key:"triggerAnnotationInfoEvent",value:function(e,t){null!=e&&e.annotation&&!zE()(null==e?void 0:e.annotation,null==t?void 0:t.annotation)&&Qv.trigger(this.webex.meetings,{file:"meeting/index",function:"triggerAnnotationInfoEvent"},$g.MEETING_UPDATE_ANNOTATION_INFO,{annotationInfo:null==e?void 0:e.annotation,meetingId:this.id})}},{key:"setUpLocusMediaSharesListener",value:function(){var e=this;this.locusInfo.on(Jg.LOCUS_INFO_UPDATE_MEDIA_SHARES,function(){var t=(0,T.Z)(V().mark((function t(r){var n,i,o,s,a,c,u,l,d,h,f;return V().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=r.current,s=o.content,a=o.whiteboard,c=null===(n=r.previous)||void 0===n?void 0:n.content,u=null===(i=r.previous)||void 0===i?void 0:i.whiteboard,e.triggerAnnotationInfoEvent(s,c),s.beneficiaryId!==(null==c?void 0:c.beneficiaryId)||s.disposition!==(null==c?void 0:c.disposition)||s.deviceUrlSharing!==c.deviceUrlSharing||a.beneficiaryId!==(null==u?void 0:u.beneficiaryId)||a.disposition!==(null==u?void 0:u.disposition)||a.resourceUrl!==(null==u?void 0:u.resourceUrl)){t.next=6;break}return t.abrupt("return");case 6:if(l=e.shareStatus,e.selfId!==s.beneficiaryId&&s.disposition===Xg.GRANTED?l=qg.REMOTE_SHARE_ACTIVE:e.selfId===s.beneficiaryId&&s.disposition===Xg.GRANTED&&s.deviceUrlSharing===e.deviceUrl?l=qg.LOCAL_SHARE_ACTIVE:e.selfId===s.beneficiaryId&&s.disposition===Xg.GRANTED&&s.deviceUrlSharing!==e.deviceUrl?l=qg.REMOTE_SHARE_ACTIVE:a.disposition===Xg.GRANTED?l=qg.WHITEBOARD_SHARE_ACTIVE:(c&&s.disposition===Xg.RELEASED||null===s.disposition)&&(u&&a.disposition===Xg.RELEASED||null===a.disposition)&&(l=qg.NO_SHARE),l===e.shareStatus){t.next=45;break}d=e.shareStatus,e.shareStatus=l,t.t0=d,t.next=t.t0===qg.REMOTE_SHARE_ACTIVE?14:t.t0===qg.LOCAL_SHARE_ACTIVE?16:t.t0===qg.WHITEBOARD_SHARE_ACTIVE?18:t.t0===qg.NO_SHARE?20:21;break;case 14:return Qv.trigger(e,{file:"meetings/index",function:"remoteShare"},$g.MEETING_STOPPED_SHARING_REMOTE),t.abrupt("break",22);case 16:return Qv.trigger(e,{file:"meeting/index",function:"localShare"},$g.MEETING_STOPPED_SHARING_LOCAL,{reason:Wg.SELF_STOPPED}),t.abrupt("break",22);case 18:return Qv.trigger(e,{file:"meeting/index",function:"stopWhiteboardShare"},$g.MEETING_STOPPED_SHARING_WHITEBOARD),t.abrupt("break",22);case 20:case 21:return t.abrupt("break",22);case 22:t.t1=l,t.next=t.t1===qg.REMOTE_SHARE_ACTIVE?25:t.t1===qg.LOCAL_SHARE_ACTIVE?34:t.t1===qg.WHITEBOARD_SHARE_ACTIVE?37:t.t1===qg.NO_SHARE?40:41;break;case 25:if(h=function(){e.remoteShareInstanceId=s.shareInstanceId,Qv.trigger(e,{file:"meetings/index",function:"remoteShare"},$g.MEETING_STARTED_SHARING_REMOTE,{memberId:s.beneficiaryId,url:s.url,shareInstanceId:e.remoteShareInstanceId,annotationInfo:s.annotation})},t.prev=26,null===(f=e.mediaProperties.mediaDirection)||void 0===f||!f.sendShare||d!==qg.LOCAL_SHARE_ACTIVE){t.next=30;break}return t.next=30,e.unpublishStreams([e.mediaProperties.shareVideoStream,e.mediaProperties.shareAudioStream]);case 30:return t.prev=30,h(),t.finish(30);case 33:return t.abrupt("break",42);case 34:return Qv.trigger(e,{file:"meeting/index",function:"share"},$g.MEETING_STARTED_SHARING_LOCAL),e.webex.internal.newMetrics.submitClientEvent({name:"client.share.floor-granted.local",payload:{mediaType:"share",shareInstanceId:e.localShareInstanceId},options:{meetingId:e.id}}),t.abrupt("break",42);case 37:return Qv.trigger(e,{file:"meeting/index",function:"startWhiteboardShare"},$g.MEETING_STARTED_SHARING_WHITEBOARD,{resourceUrl:a.resourceUrl,memberId:a.beneficiaryId}),e.webex.internal.newMetrics.submitClientEvent({name:"client.share.floor-granted.local",payload:{mediaType:"whiteboard"},options:{meetingId:e.id}}),t.abrupt("break",42);case 40:case 41:return t.abrupt("break",42);case 42:e.members.locusMediaSharesUpdate(r),t.next=46;break;case 45:l===qg.REMOTE_SHARE_ACTIVE?(e.remoteShareInstanceId=s.shareInstanceId,Qv.trigger(e,{file:"meetings/index",function:"remoteShare"},$g.MEETING_STARTED_SHARING_REMOTE,{memberId:s.beneficiaryId,url:s.url,shareInstanceId:e.remoteShareInstanceId,annotationInfo:s.annotation}),e.members.locusMediaSharesUpdate(r)):l===qg.WHITEBOARD_SHARE_ACTIVE&&(Qv.trigger(e,{file:"meeting/index",function:"startWhiteboardShare"},$g.MEETING_STARTED_SHARING_WHITEBOARD,{resourceUrl:a.resourceUrl,memberId:a.beneficiaryId}),e.webex.internal.newMetrics.submitClientEvent({name:"client.share.floor-granted.local",payload:{mediaType:"whiteboard"},options:{meetingId:e.id}}),e.members.locusMediaSharesUpdate(r));case 46:case"end":return t.stop()}}),t,null,[[26,,30,33]])})));return function(e){return t.apply(this,arguments)}}())}},{key:"setUpLocusUrlListener",value:function(){var e=this;this.locusInfo.on(Jg.LOCUS_INFO_UPDATE_URL,(function(t){var r;e.members.locusUrlUpdate(t),e.breakouts.locusUrlUpdate(t),e.simultaneousInterpretation.locusUrlUpdate(t),e.annotation.locusUrlUpdate(t),e.locusUrl=t,e.locusId=null===(r=e.locusUrl)||void 0===r?void 0:r.split("/").pop(),e.recordingController.setLocusUrl(e.locusUrl),e.controlsOptionsManager.setLocusUrl(e.locusUrl),e.webinar.locusUrlUpdate(t),Qv.trigger(e,{file:"meeting/index",function:"setUpLocusSelfListener"},$g.MEETING_LOCUS_URL_UPDATE,{locusUrl:t})}))}},{key:"setUpLocusServicesListener",value:function(){var e=this;this.locusInfo.on(uv.EVENTS.LINKS_SERVICES,(function(t){var r,n,i,o,s,a,c,u,l,d,h,f,p,m;e.recordingController.setServiceUrl(null==t||null===(r=t.services)||void 0===r||null===(n=r.record)||void 0===n?void 0:n.url),e.recordingController.setSessionId(null===(i=e.locusInfo)||void 0===i||null===(o=i.fullState)||void 0===o?void 0:o.sessionId),e.breakouts.breakoutServiceUrlUpdate(null==t||null===(s=t.services)||void 0===s||null===(a=s.breakout)||void 0===a?void 0:a.url),e.annotation.approvalUrlUpdate(null==t||null===(c=t.services)||void 0===c||null===(u=c.approval)||void 0===u?void 0:u.url),e.simultaneousInterpretation.approvalUrlUpdate(null==t||null===(l=t.services)||void 0===l||null===(d=l.approval)||void 0===d?void 0:d.url),e.webinar.webcastUrlUpdate(null==t||null===(h=t.services)||void 0===h||null===(f=h.webcast)||void 0===f?void 0:f.url),e.webinar.webinarAttendeesSearchingUrlUpdate(null==t||null===(p=t.services)||void 0===p||null===(m=p.webinarAttendeesSearching)||void 0===m?void 0:m.url)}))}},{key:"setUpLocusInfoMeetingInfoListener",value:function(){var e=this;this.locusInfo.on(uv.EVENTS.MEETING_LOCKED,(function(t){t&&Qv.trigger(e,{file:"meeting/index",function:"setUpLocusInfoMeetingInfoListener"},$g.MEETING_LOCKED,{payload:t})})),this.locusInfo.on(uv.EVENTS.MEETING_UNLOCKED,(function(t){t&&Qv.trigger(e,{file:"meeting/index",function:"setUpLocusInfoMeetingInfoListener"},$g.MEETING_UNLOCKED,{payload:t})})),this.locusInfo.on(uv.EVENTS.MEETING_INFO_UPDATED,(function(){e.updateMeetingActions(),e.recordingController.setDisplayHints(e.userDisplayHints),e.recordingController.setUserPolicy(e.selfUserPolicies),e.controlsOptionsManager.setDisplayHints(e.userDisplayHints),e.handleDataChannelUrlChange(e.datachannelUrl)}))}},{key:"handleDataChannelUrlChange",value:function(e){e&&this.config.enableAutomaticLLM&&this.updateLLMConnection()}},{key:"setUpLocusEmbeddedAppsListener",value:function(){var e=this;this.locusInfo.on(uv.EVENTS.EMBEDDED_APPS_UPDATED,(function(t){t&&Qv.trigger(e,{file:"meeting/index",function:"setUpLocusEmbeddedAppsListener"},$g.MEETING_EMBEDDED_APPS_UPDATE,t)}))}},{key:"setUpLocusInfoSelfListener",value:function(){var e=this;this.locusInfo.on(uv.EVENTS.LOCAL_UNMUTE_REQUIRED,(function(t){e.audio&&(e.audio.handleServerLocalUnmuteRequired(e),Qv.trigger(e,{file:"meeting/index",function:"setUpLocusInfoSelfListener"},$g.MEETING_SELF_UNMUTED_BY_OTHERS,{payload:t}))})),this.locusInfo.on(uv.EVENTS.SELF_REMOTE_VIDEO_MUTE_STATUS_UPDATED,(function(t){if(t){var r,n;if(e.video)t.muted=null!==(r=t.muted)&&void 0!==r?r:e.video.isRemotelyMuted(),t.unmuteAllowed=null!==(n=t.unmuteAllowed)&&void 0!==n?n:e.video.isUnmuteAllowed(),e.video.handleServerRemoteMuteUpdate(e,t.muted,t.unmuteAllowed);Qv.trigger(e,{file:"meeting/index",function:"setUpLocusInfoSelfListener"},t.muted?$g.MEETING_SELF_VIDEO_MUTED_BY_OTHERS:$g.MEETING_SELF_VIDEO_UNMUTED_BY_OTHERS,{payload:t})}})),this.locusInfo.on(uv.EVENTS.SELF_REMOTE_MUTE_STATUS_UPDATED,(function(t){var r;t&&(e.audio&&e.audio.handleServerRemoteMuteUpdate(e,t.muted,t.unmuteAllowed),!t.muted&&null!==(r=e.audio)&&void 0!==r&&r.isMuted()||Qv.trigger(e,{file:"meeting/index",function:"setUpLocusInfoSelfListener"},t.muted?$g.MEETING_SELF_MUTED_BY_OTHERS:$g.MEETING_SELF_UNMUTED_BY_OTHERS,{payload:t}))})),this.locusInfo.on(uv.EVENTS.LOCAL_UNMUTE_REQUESTED,(function(t){Qv.trigger(e,{file:"meeting/index",function:"setUpLocusInfoSelfListener"},$g.MEETING_SELF_REQUESTED_TO_UNMUTE,{payload:t})})),this.locusInfo.on(uv.EVENTS.SELF_UNADMITTED_GUEST,(function(t){t&&(e.startKeepAlive(),Qv.trigger(e,{file:"meeting/index",function:"setUpLocusInfoSelfListener"},$g.MEETING_SELF_LOBBY_WAITING,{payload:t}),e.webex.internal.newMetrics.submitClientEvent({name:"client.lobby.entered",options:{meetingId:e.id}}))})),this.locusInfo.on(uv.EVENTS.SELF_ADMITTED_GUEST,function(){var t=(0,T.Z)(V().mark((function t(r){return V().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.stopKeepAlive(),r&&(Qv.trigger(e,{file:"meeting/index",function:"setUpLocusInfoSelfListener"},$g.MEETING_SELF_GUEST_ADMITTED,{payload:r}),e.webex.internal.newMetrics.submitClientEvent({name:"client.lobby.exited",options:{meetingId:e.id}}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.locusInfo.on(uv.EVENTS.MEDIA_INACTIVITY,(function(){sp.sendBehavioralMetric(Eb,{correlation_id:e.correlationId,locus_id:e.locusId}),e.reconnect()})),this.locusInfo.on(uv.EVENTS.MEDIA_STATUS_CHANGE,(function(t){var r,n,i,o,s,a,c,u;e.statsAnalyzer&&e.statsAnalyzer.updateMediaStatus({actual:t,expected:{sendAudio:(null===(r=e.mediaProperties.mediaDirection)||void 0===r?void 0:r.sendAudio)&&!(null!==(n=e.audio)&&void 0!==n&&n.isMuted()),sendVideo:(null===(i=e.mediaProperties.mediaDirection)||void 0===i?void 0:i.sendVideo)&&!(null!==(o=e.video)&&void 0!==o&&o.isMuted()),sendShare:null===(s=e.mediaProperties.mediaDirection)||void 0===s?void 0:s.sendShare,receiveAudio:null===(a=e.mediaProperties.mediaDirection)||void 0===a?void 0:a.receiveAudio,receiveVideo:null===(c=e.mediaProperties.mediaDirection)||void 0===c?void 0:c.receiveVideo,receiveShare:null===(u=e.mediaProperties.mediaDirection)||void 0===u?void 0:u.receiveShare}})})),this.locusInfo.on(uv.EVENTS.SELF_CANNOT_VIEW_PARTICIPANT_LIST_CHANGE,(function(t){Qv.trigger(e,{file:"meeting/index",function:"setUpLocusInfoSelfListener"},$g.MEETING_SELF_CANNOT_VIEW_PARTICIPANT_LIST,{payload:t})})),this.locusInfo.on(uv.EVENTS.SELF_MEETING_BREAKOUTS_CHANGED,(function(t){e.breakouts.updateBreakoutSessions(t),Qv.trigger(e,{file:"meeting/index",function:"setUpLocusInfoSelfListener"},$g.MEETING_BREAKOUTS_UPDATE)})),this.locusInfo.on(uv.EVENTS.SELF_MEETING_INTERPRETATION_CHANGED,(function(t){e.simultaneousInterpretation.updateSelfInterpretation(t),Qv.trigger(e,{file:"meeting/index",function:"setUpLocusInfoSelfListener"},$g.MEETING_INTERPRETATION_UPDATE)})),this.locusInfo.on(uv.EVENTS.SELF_ROLES_CHANGED,(function(t){var r,n,i,o,s=(null===(r=t.newRoles)||void 0===r?void 0:r.includes(vv.MODERATOR))||(null===(n=t.newRoles)||void 0===n?void 0:n.includes(vv.COHOST));e.breakouts.updateCanManageBreakouts(s),e.simultaneousInterpretation.updateCanManageInterpreters(null===(i=t.newRoles)||void 0===i?void 0:i.includes(vv.MODERATOR)),e.webinar.updateCanManageWebcast(null===(o=t.newRoles)||void 0===o?void 0:o.includes(vv.MODERATOR)),Qv.trigger(e,{file:"meeting/index",function:"setUpLocusInfoSelfListener"},$g.MEETING_SELF_ROLES_CHANGED,{payload:t})})),this.locusInfo.on(uv.EVENTS.SELF_IS_SHARING_BLOCKED_CHANGE,(function(t){Qv.trigger(e,{file:"meeting/index",function:"setUpLocusInfoSelfListener"},$g.MEETING_SELF_IS_SHARING_BLOCKED,{payload:t})}))}},{key:"setUpLocusInfoMeetingListener",value:function(){var e=this;this.locusInfo.on(Jg.REMOTE_RESPONSE,(function(t){e.meetingFiniteStateMachine.remote(t),t.remoteDeclined&&e.leave({reason:t.reason}).then((function(){pp.logger.info("Meeting:index#setUpLocusInfoMeetingListener --\x3e REMOTE_RESPONSE. Attempting to leave meeting.")})).catch((function(t){pp.logger.error("Meeting:index#setUpLocusInfoMeetingListener --\x3e REMOTE_RESPONSE. Issue with leave for meeting, meeting still in collection: ".concat(e,", error: ").concat(t))}))})),this.locusInfo.on(Jg.DESTROY_MEETING,function(){var t=(0,T.Z)(V().mark((function t(r){return V().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.wirelessShare){t.next=7;break}if(!e.mediaProperties.shareVideoStream){t.next=4;break}return t.next=4,e.setLocalShareVideoStream(void 0);case 4:if(!e.mediaProperties.shareAudioStream){t.next=7;break}return t.next=7,e.setLocalShareAudioStream(void 0);case 7:if(!r.shouldLeave){t.next=19;break}return t.prev=8,t.next=11,e.leave({reason:r.reason});case 11:pp.logger.warn("Meeting:index#setUpLocusInfoMeetingListener --\x3e DESTROY_MEETING. The meeting has been left, but has not been destroyed, you should see a later event for leave."),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(8),pp.logger.error("Meeting:index#setUpLocusInfoMeetingListener --\x3e DESTROY_MEETING. Issue with leave for meeting, meeting still in collection: ".concat(e,", error: ").concat(t.t0));case 17:t.next=22;break;case 19:pp.logger.info("Meeting:index#setUpLocusInfoMeetingListener --\x3e MEETING_REMOVED_REASON",r.reason),eb.cleanUp(e),Qv.trigger(e,{file:"meeting/index",function:"setUpLocusInfoMeetingListener"},Jg.DESTROY_MEETING,{reason:r.reason,meetingId:e.id});case 22:case"end":return t.stop()}}),t,null,[[8,14]])})));return function(e){return t.apply(this,arguments)}}())}},{key:"updateMeetingObject",value:function(e){var t=this;e&&U()(e).length&&U()(e).forEach((function(r){t[r]=e[r]}))}},{key:"invite",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.members.addMember(e,t)}},{key:"cancelPhoneInvite",value:function(e){return this.members.cancelPhoneInvite(e)}},{key:"admit",value:function(e,t){var r=t;if(!r){var n=this.breakouts,i=n.locusUrl,o=n.mainLocusUrl;i&&o&&(r={authorizingLocusUrl:i,mainLocusUrl:o})}return this.members.admitMembers(e,r)}},{key:"remove",value:function(e){return this.members.removeMember(e)}},{key:"mute",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.members.muteMember(e,t)}},{key:"transfer",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.members.transferHostToMember(e,t)}},{key:"getMembers",value:function(){return this.members}},{key:"parseMeetingInfo",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if(r&&(t="object"===(0,GE.Z)(r)?r:void 0),t||e&&!((null==n?void 0:n.length)>0)){var i,o,s,a,c,u,l;if(this.conversationUrl=(null===(i=t)||void 0===i?void 0:i.conversationUrl)||(null==e?void 0:e.conversationUrl)||this.conversationUrl,this.locusUrl=(null===(o=t)||void 0===o?void 0:o.url)||(null==e?void 0:e.locusUrl)||this.locusUrl,this.setSipUri(this.config.experimental.enableUnifiedMeetings?(null===(s=t)||void 0===s?void 0:s.info.sipUri)||(null==e?void 0:e.sipUrl):(null===(a=t)||void 0===a?void 0:a.info.sipUri)||(null==e?void 0:e.sipMeetingUri)||this.sipUri),this.config.experimental.enableUnifiedMeetings)this.meetingNumber=(null===(l=t)||void 0===l?void 0:l.info.webExMeetingId)||(null==e?void 0:e.meetingNumber),this.meetingJoinUrl=null==e?void 0:e.meetingJoinUrl;this.owner=(null===(c=t)||void 0===c?void 0:c.info.owner)||(null==e?void 0:e.owner)||(null==e?void 0:e.hostId)||this.owner,this.permissionToken=null==e?void 0:e.permissionToken,this.setPermissionTokenPayload(null==e?void 0:e.permissionToken),this.setSelfUserPolicies(),this.environment=(null===(u=t)||void 0===u?void 0:u.info.channel)||(null==e?void 0:e.channel)}eb.parseInterpretationInfo(this,e)}},{key:"arePolicyRestrictionsSupported",value:function(){return!!this.selfUserPolicies&&!$E()(this.meetingInfo)}},{key:"updateMeetingActions",value:function(){var e,t,r,n,i,o,s=!1;s=this.inMeetingActions.set({canUseVoip:!0===(null===(e=this.meetingInfo)||void 0===e?void 0:e.supportVoIP)&&M_.hasPolicies({requiredPolicies:[pv.SUPPORT_VOIP],policies:this.selfUserPolicies})||!this.arePolicyRestrictionsSupported(),canDoVideo:M_.hasPolicies({requiredPolicies:[pv.SUPPORT_VIDEO],policies:this.selfUserPolicies})&&!(null===(t=this.meetingInfo)||void 0===t||!t.video)||!this.arePolicyRestrictionsSupported(),supportHDV:M_.hasPolicies({requiredPolicies:[pv.SUPPORT_HDV],policies:this.selfUserPolicies})&&(null===(r=this.meetingInfo)||void 0===r||null===(n=r.video)||void 0===n?void 0:n.supportHDV)||!this.arePolicyRestrictionsSupported(),enforceVirtualBackground:M_.hasPolicies({requiredPolicies:[pv.ENFORCE_VIRTUAL_BACKGROUND],policies:this.selfUserPolicies})&&this.arePolicyRestrictionsSupported(),supportHQV:M_.hasPolicies({requiredPolicies:[pv.SUPPORT_HQV],policies:this.selfUserPolicies})&&(null===(i=this.meetingInfo)||void 0===i||null===(o=i.video)||void 0===o?void 0:o.supportHQV)||!this.arePolicyRestrictionsSupported()}),void 0!==this.userDisplayHints&&(s=this.inMeetingActions.set({canInviteNewParticipants:eb.canInviteNewParticipants(this.userDisplayHints),canAdmitParticipant:eb.canAdmitParticipant(this.userDisplayHints),canLock:eb.canUserLock(this.userDisplayHints),canUnlock:eb.canUserUnlock(this.userDisplayHints),canShareWhiteBoard:eb.canShareWhiteBoard(this.userDisplayHints),canSetDisallowUnmute:M_.canSetDisallowUnmute(this.userDisplayHints),canUnsetDisallowUnmute:M_.canUnsetDisallowUnmute(this.userDisplayHints),canSetMuteOnEntry:M_.canSetMuteOnEntry(this.userDisplayHints),canUnsetMuteOnEntry:M_.canUnsetMuteOnEntry(this.userDisplayHints),canSetMuted:M_.canSetMuted(this.userDisplayHints),canUnsetMuted:M_.canUnsetMuted(this.userDisplayHints),canStartRecording:N_.canUserStart(this.userDisplayHints,this.selfUserPolicies),canStopRecording:N_.canUserStop(this.userDisplayHints,this.selfUserPolicies),canPauseRecording:N_.canUserPause(this.userDisplayHints,this.selfUserPolicies),canResumeRecording:N_.canUserResume(this.userDisplayHints,this.selfUserPolicies),canRaiseHand:eb.canUserRaiseHand(this.userDisplayHints),canLowerAllHands:eb.canUserLowerAllHands(this.userDisplayHints),canLowerSomeoneElsesHand:eb.canUserLowerSomeoneElsesHand(this.userDisplayHints),bothLeaveAndEndMeetingAvailable:eb.bothLeaveAndEndMeetingAvailable(this.userDisplayHints),canEnableClosedCaption:eb.canEnableClosedCaption(this.userDisplayHints),canStartTranscribing:eb.canStartTranscribing(this.userDisplayHints),canStopTranscribing:eb.canStopTranscribing(this.userDisplayHints),isClosedCaptionActive:eb.isClosedCaptionActive(this.userDisplayHints),isSaveTranscriptsEnabled:eb.isSaveTranscriptsEnabled(this.userDisplayHints),isWebexAssistantActive:eb.isWebexAssistantActive(this.userDisplayHints),canViewCaptionPanel:eb.canViewCaptionPanel(this.userDisplayHints),isRealTimeTranslationEnabled:eb.isRealTimeTranslationEnabled(this.userDisplayHints),canSelectSpokenLanguages:eb.canSelectSpokenLanguages(this.userDisplayHints),waitingForOthersToJoin:eb.waitingForOthersToJoin(this.userDisplayHints),canSendReactions:eb.canSendReactions(this.inMeetingActions.canSendReactions,this.userDisplayHints),canManageBreakout:eb.canManageBreakout(this.userDisplayHints),canBroadcastMessageToBreakout:eb.canBroadcastMessageToBreakout(this.userDisplayHints,this.selfUserPolicies),canAdmitLobbyToBreakout:eb.canAdmitLobbyToBreakout(this.userDisplayHints),isBreakoutPreassignmentsEnabled:eb.isBreakoutPreassignmentsEnabled(this.userDisplayHints),canUserAskForHelp:eb.canUserAskForHelp(this.userDisplayHints),canUserRenameSelfAndObserved:eb.canUserRenameSelfAndObserved(this.userDisplayHints),canUserRenameOthers:eb.canUserRenameOthers(this.userDisplayHints),canMuteAll:M_.hasHints({requiredHints:[mv.MUTE_ALL],displayHints:this.userDisplayHints}),canUnmuteAll:M_.hasHints({requiredHints:[mv.UNMUTE_ALL],displayHints:this.userDisplayHints}),canEnableHardMute:M_.hasHints({requiredHints:[mv.ENABLE_HARD_MUTE],displayHints:this.userDisplayHints}),canDisableHardMute:M_.hasHints({requiredHints:[mv.DISABLE_HARD_MUTE],displayHints:this.userDisplayHints}),canEnableMuteOnEntry:M_.hasHints({requiredHints:[mv.ENABLE_MUTE_ON_ENTRY],displayHints:this.userDisplayHints}),canDisableMuteOnEntry:M_.hasHints({requiredHints:[mv.DISABLE_MUTE_ON_ENTRY],displayHints:this.userDisplayHints}),canEnableReactions:M_.hasHints({requiredHints:[mv.ENABLE_REACTIONS],displayHints:this.userDisplayHints}),canDisableReactions:M_.hasHints({requiredHints:[mv.DISABLE_REACTIONS],displayHints:this.userDisplayHints}),canEnableReactionDisplayNames:M_.hasHints({requiredHints:[mv.ENABLE_SHOW_DISPLAY_NAME],displayHints:this.userDisplayHints}),canDisableReactionDisplayNames:M_.hasHints({requiredHints:[mv.DISABLE_SHOW_DISPLAY_NAME],displayHints:this.userDisplayHints}),canUpdateShareControl:M_.hasHints({requiredHints:[mv.SHARE_CONTROL],displayHints:this.userDisplayHints}),canEnableViewTheParticipantsList:M_.hasHints({requiredHints:[mv.ENABLE_VIEW_THE_PARTICIPANT_LIST],displayHints:this.userDisplayHints}),canDisableViewTheParticipantsList:M_.hasHints({requiredHints:[mv.DISABLE_VIEW_THE_PARTICIPANT_LIST],displayHints:this.userDisplayHints}),canEnableRaiseHand:M_.hasHints({requiredHints:[mv.ENABLE_RAISE_HAND],displayHints:this.userDisplayHints}),canDisableRaiseHand:M_.hasHints({requiredHints:[mv.DISABLE_RAISE_HAND],displayHints:this.userDisplayHints}),canEnableVideo:M_.hasHints({requiredHints:[mv.ENABLE_VIDEO],displayHints:this.userDisplayHints}),canDisableVideo:M_.hasHints({requiredHints:[mv.DISABLE_VIDEO],displayHints:this.userDisplayHints}),canShareFile:M_.hasHints({requiredHints:[mv.SHARE_FILE],displayHints:this.userDisplayHints})&&M_.hasPolicies({requiredPolicies:[pv.SUPPORT_FILE_SHARE],policies:this.selfUserPolicies})||!this.arePolicyRestrictionsSupported,canTransferFile:M_.hasPolicies({requiredPolicies:[pv.SUPPORT_FILE_TRANSFER],policies:this.selfUserPolicies}),canChat:M_.hasPolicies({requiredPolicies:[pv.SUPPORT_CHAT],policies:this.selfUserPolicies}),canShareApplication:M_.hasHints({requiredHints:[mv.SHARE_APPLICATION],displayHints:this.userDisplayHints})&&M_.hasPolicies({requiredPolicies:[pv.SUPPORT_APP_SHARE],policies:this.selfUserPolicies})||!this.arePolicyRestrictionsSupported(),canShareCamera:M_.hasHints({requiredHints:[mv.SHARE_CAMERA],displayHints:this.userDisplayHints})&&M_.hasPolicies({requiredPolicies:[pv.SUPPORT_CAMERA_SHARE],policies:this.selfUserPolicies}),canShareDesktop:M_.hasHints({requiredHints:[mv.SHARE_DESKTOP],displayHints:this.userDisplayHints})&&M_.hasPolicies({requiredPolicies:[pv.SUPPORT_DESKTOP_SHARE],policies:this.selfUserPolicies})||!this.arePolicyRestrictionsSupported(),canShareContent:M_.hasHints({requiredHints:[mv.SHARE_CONTENT],displayHints:this.userDisplayHints})||!this.arePolicyRestrictionsSupported(),canAnnotate:M_.hasPolicies({requiredPolicies:[pv.SUPPORT_ANNOTATION],policies:this.selfUserPolicies})})||s),s&&Qv.trigger(this,{file:"meeting/index",function:"updateMeetingActions"},$g.MEETING_ACTIONS_UPDATE,this.inMeetingActions.get())}},{key:"setSelfUserPolicies",value:function(){var e,t,r,n;this.selfUserPolicies=null===(e=this.permissionTokenPayload)||void 0===e||null===(t=e.permission)||void 0===t?void 0:t.userPolicies,this.enforceVBGImagesURL=null===(r=this.permissionTokenPayload)||void 0===r||null===(n=r.permission)||void 0===n?void 0:n.enforceVBGImagesURL}},{key:"setPermissionTokenPayload",value:function(e){this.permissionTokenPayload=QE(e),this.permissionTokenReceivedLocalTime=(new Date).getTime()}},{key:"setSipUri",value:function(e){this.sipUri=e}},{key:"setLocus",value:function(e){var t=e.locus||e;this.mediaConnections=e.mediaConnections,this.locusUrl=e.locusUrl||e.url,this.locusId=e.locusId,this.selfId=e.selfId,this.mediaId=e.mediaId,this.hostId=t.host?t.host.id:this.hostId,this.locusInfo.initialSetup(t)}},{key:"uploadLogs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{file:"meeting/index",function:"uploadLogs"};Qv.trigger(this,e,Jg.REQUEST_UPLOAD_LOGS,this)}},{key:"unsetRemoteStreams",value:function(){this.mediaProperties.unsetRemoteStreams()}},{key:"closeRemoteStream",value:function(){pp.logger.warn("Meeting:index#closeRemoteStream --\x3e [DEPRECATION WARNING]: closeRemoteStream has been deprecated after v1.89.3"),this.closeRemoteStreams()}},{key:"closeRemoteStreams",value:function(){var e=this,t=this.mediaProperties,r=t.remoteAudioStream,n=t.remoteVideoStream,i=t.remoteShareStream,o=function(t,r){return gy.stopStream(t).then((function(){var t;t=r,Qv.trigger(e,{file:"meeting/index",function:"closeRemoteStreams"},$g.MEDIA_STOPPED,{type:t})}))};return P().all([o(r,Zg.REMOTE_AUDIO),o(n,Zg.REMOTE_VIDEO),o(i,Zg.REMOTE_SHARE)])}},{key:"setLocalAudioStream",value:(C=(0,T.Z)(V().mark((function e(t){var r;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(r=this.mediaProperties.audioStream)||r.off(St.MuteStateChange,this.localAudioStreamMuteStateHandler),null==r||r.off(Ft.OutputTrackChange,this.localOutputTrackChangeHandler),this.mediaProperties.setLocalAudioStream(t),this.audio.handleLocalStreamChange(this),null==t||t.on(St.MuteStateChange,this.localAudioStreamMuteStateHandler),null==t||t.on(Ft.OutputTrackChange,this.localOutputTrackChangeHandler),this.isMultistream&&t){e.next=10;break}return e.next=10,this.unpublishStream(Pn.AudioMain,r);case 10:return e.next=12,this.publishStream(Pn.AudioMain,this.mediaProperties.audioStream);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return C.apply(this,arguments)})},{key:"setLocalVideoStream",value:(I=(0,T.Z)(V().mark((function e(t){var r;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(r=this.mediaProperties.videoStream)||r.off(St.MuteStateChange,this.localVideoStreamMuteStateHandler),null==r||r.off(Ft.OutputTrackChange,this.localOutputTrackChangeHandler),this.mediaProperties.setLocalVideoStream(t),this.video.handleLocalStreamChange(this),null==t||t.on(St.MuteStateChange,this.localVideoStreamMuteStateHandler),null==t||t.on(Ft.OutputTrackChange,this.localOutputTrackChangeHandler),this.isMultistream&&t){e.next=10;break}return e.next=10,this.unpublishStream(Pn.VideoMain,r);case 10:return e.next=12,this.publishStream(Pn.VideoMain,this.mediaProperties.videoStream);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return I.apply(this,arguments)})},{key:"setLocalShareVideoStream",value:(_=(0,T.Z)(V().mark((function e(t){var r;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(r=this.mediaProperties.shareVideoStream)||r.off(St.MuteStateChange,this.handleShareVideoStreamMuteStateChange),null==r||r.off(St.Ended,this.handleShareVideoStreamEnded),null==r||r.off(Ft.OutputTrackChange,this.localOutputTrackChangeHandler),this.mediaProperties.setLocalShareVideoStream(t),null==t||t.on(St.MuteStateChange,this.handleShareVideoStreamMuteStateChange),null==t||t.on(St.Ended,this.handleShareVideoStreamEnded),null==t||t.on(Ft.OutputTrackChange,this.localOutputTrackChangeHandler),this.mediaProperties.mediaDirection.sendShare=this.mediaProperties.hasLocalShareStream(),this.isMultistream&&t){e.next=12;break}return e.next=12,this.unpublishStream(Pn.VideoSlides,r);case 12:return e.next=14,this.publishStream(Pn.VideoSlides,this.mediaProperties.shareVideoStream);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return _.apply(this,arguments)})},{key:"setLocalShareAudioStream",value:(S=(0,T.Z)(V().mark((function e(t){var r;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(r=this.mediaProperties.shareAudioStream)||r.off(St.Ended,this.handleShareAudioStreamEnded),null==r||r.off(Ft.OutputTrackChange,this.localOutputTrackChangeHandler),this.mediaProperties.setLocalShareAudioStream(t),null==t||t.on(St.Ended,this.handleShareAudioStreamEnded),null==t||t.on(Ft.OutputTrackChange,this.localOutputTrackChangeHandler),this.mediaProperties.mediaDirection.sendShare=this.mediaProperties.hasLocalShareStream(),this.isMultistream&&t){e.next=10;break}return e.next=10,this.unpublishStream(Pn.AudioSlides,r);case 10:return e.next=12,this.publishStream(Pn.AudioSlides,this.mediaProperties.shareAudioStream);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return S.apply(this,arguments)})},{key:"emitPublishStateChangeEvent",value:function(e){var t=e.functionName,r=e.isPublished,n=e.mediaType,i=e.stream;Qv.trigger(this,{file:"meeting/index",function:t},$g.MEETING_STREAM_PUBLISH_STATE_CHANGED,{isPublished:r,mediaType:n,stream:i})}},{key:"cleanupLocalStreams",value:function(){var e=this.mediaProperties,t=e.audioStream,r=e.videoStream,n=e.shareAudioStream,i=e.shareVideoStream;null==t||t.off(St.MuteStateChange,this.localAudioStreamMuteStateHandler),null==t||t.off(Ft.OutputTrackChange,this.localOutputTrackChangeHandler),null==r||r.off(St.MuteStateChange,this.localVideoStreamMuteStateHandler),null==r||r.off(Ft.OutputTrackChange,this.localOutputTrackChangeHandler),null==n||n.off(St.Ended,this.handleShareAudioStreamEnded),null==n||n.off(Ft.OutputTrackChange,this.localOutputTrackChangeHandler),null==i||i.off(St.MuteStateChange,this.handleShareVideoStreamMuteStateChange),null==i||i.off(St.Ended,this.handleShareVideoStreamEnded),null==i||i.off(Ft.OutputTrackChange,this.localOutputTrackChangeHandler),this.mediaProperties.setLocalAudioStream(void 0),this.mediaProperties.setLocalVideoStream(void 0),this.mediaProperties.setLocalShareAudioStream(void 0),this.mediaProperties.setLocalShareVideoStream(void 0),this.mediaProperties.mediaDirection.sendAudio=!1,this.mediaProperties.mediaDirection.sendVideo=!1,this.mediaProperties.mediaDirection.sendShare=!1,t&&this.emitPublishStateChangeEvent({functionName:"cleanupLocalStreams",isPublished:!1,mediaType:Pn.AudioMain,stream:t}),r&&this.emitPublishStateChangeEvent({functionName:"cleanupLocalStreams",isPublished:!1,mediaType:Pn.VideoMain,stream:r}),i&&this.emitPublishStateChangeEvent({functionName:"cleanupLocalStreams",isPublished:!1,mediaType:Pn.VideoSlides,stream:i}),n&&this.emitPublishStateChangeEvent({functionName:"cleanupLocalStreams",isPublished:!1,mediaType:Pn.AudioSlides,stream:n})}},{key:"setMercuryListener",value:function(){var e=this;this.webex.internal.mercury.on(om,(function(){pp.logger.info("Meeting:index#setMercuryListener --\x3e Web socket online"),e.hasWebsocketConnected||(e.webex.internal.newMetrics.submitClientEvent({name:"client.mercury.connection.restored",options:{meetingId:e.id}}),sp.sendBehavioralMetric(ob,{correlation_id:e.correlationId})),e.hasWebsocketConnected=!0})),this.webex.internal.mercury.on(im,(function(){pp.logger.error("Meeting:index#setMercuryListener --\x3e Web socket offline"),e.webex.internal.newMetrics.submitClientEvent({name:"client.mercury.connection.lost",options:{meetingId:e.id}}),sp.sendBehavioralMetric(ib,{correlation_id:e.correlationId})}))}},{key:"closePeerConnections",value:function(){return this.locusMediaRequest=void 0,this.mediaProperties.webrtcMediaConnection&&(this.remoteMediaManager&&(this.remoteMediaManager.stop(),this.remoteMediaManager=null),F()(this.mediaRequestManagers).forEach((function(e){return e.reset()})),this.receiveSlotManager.reset(),this.mediaProperties.webrtcMediaConnection.close(),this.sendSlotManager.reset(),this.setNetworkStatus(void 0)),this.audio=null,this.video=null,P().resolve()}},{key:"unsetPeerConnections",value:function(){this.mediaProperties.unsetPeerConnection(),this.config.reconnection.detection&&(this.webex.internal.mercury.off(om),this.webex.internal.mercury.off(im))}},{key:"setCorrelationId",value:function(e){this.callStateForMetrics.correlationId=e}},{key:"updateCallStateForMetrics",value:function(e){this.callStateForMetrics=mx(mx({},this.callStateForMetrics),e)}},{key:"enqueueScreenShareFloorRequest",value:function(){return this.screenShareFloorState=wx.PENDING,this.enqueueMediaUpdate(bx)}},{key:"muteAudio",value:function(){var e=this;return eb.isUserInJoinedState(this.locusInfo)?this.mediaId?this.audio?vx(this.audio.handleClientRequest(this,!0).then((function(){eb.handleAudioLogging(e.mediaProperties.audioStream),e.webex.internal.newMetrics.submitClientEvent({name:"client.muted",payload:{trigger:"user-interaction",mediaType:"audio"},options:{meetingId:e.id}})})).catch((function(t){throw sp.sendBehavioralMetric(Cb,{correlation_id:e.correlationId,locus_id:e.locusUrl.split("/").pop(),reason:t.message,stack:t.stack}),t})),{logText:"Meeting:index#muteAudio --\x3e correlationId=".concat(this.correlationId," muting audio")}):P().reject(new zv("no audio control associated to the meeting")):P().reject(new Ly):P().reject(new Py)}},{key:"unmuteAudio",value:function(){var e=this;return eb.isUserInJoinedState(this.locusInfo)?this.mediaId?this.audio?vx(this.audio.handleClientRequest(this,!1).then((function(){eb.handleAudioLogging(e.mediaProperties.audioStream),e.webex.internal.newMetrics.submitClientEvent({name:"client.unmuted",payload:{trigger:"user-interaction",mediaType:"audio"},options:{meetingId:e.id}})})).catch((function(t){throw sp.sendBehavioralMetric(Lb,{correlation_id:e.correlationId,locus_id:e.locusUrl.split("/").pop(),reason:t.message,stack:t.stack}),t})),{logText:"Meeting:index#unmuteAudio --\x3e correlationId=".concat(this.correlationId," unmuting audio")}):P().reject(new zv("no audio control associated to the meeting")):P().reject(new Ly):P().reject(new Py)}},{key:"muteVideo",value:function(){var e=this;return eb.isUserInJoinedState(this.locusInfo)?this.mediaId?this.video?vx(this.video.handleClientRequest(this,!0).then((function(){eb.handleVideoLogging(e.mediaProperties.videoStream),e.webex.internal.newMetrics.submitClientEvent({name:"client.muted",payload:{trigger:"user-interaction",mediaType:"video"},options:{meetingId:e.id}})})).catch((function(t){throw sp.sendBehavioralMetric(Rb,{correlation_id:e.correlationId,locus_id:e.locusUrl.split("/").pop(),reason:t.message,stack:t.stack}),t})),{logText:"Meeting:index#muteVideo --\x3e correlationId=".concat(this.correlationId," muting video")}):P().reject(new zv("no video control associated to the meeting")):P().reject(new Ly):P().reject(new Py)}},{key:"unmuteVideo",value:function(){var e=this;return eb.isUserInJoinedState(this.locusInfo)?this.mediaId?this.video?vx(this.video.handleClientRequest(this,!1).then((function(){eb.handleVideoLogging(e.mediaProperties.videoStream),e.webex.internal.newMetrics.submitClientEvent({name:"client.unmuted",payload:{trigger:"user-interaction",mediaType:"video"},options:{meetingId:e.id}})})).catch((function(t){throw sp.sendBehavioralMetric(Db,{correlation_id:e.correlationId,locus_id:e.locusUrl.split("/").pop(),reason:t.message,stack:t.stack}),t})),{logText:"Meeting:index#unmuteVideo --\x3e correlationId=".concat(this.correlationId," unmuting video")}):P().reject(new zv("no audio control associated to the meeting")):P().reject(new Ly):P().reject(new Py)}},{key:"joinWithMedia",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.mediaOptions,n=t.joinOptions;return null!=r&&r.allowMediaInLobby?(pp.logger.info("Meeting:index#joinWithMedia called"),this.join(n).then((function(t){return e.addMedia(r).then((function(e){return{join:t,media:e}}))})).catch((function(t){return pp.logger.error("Meeting:index#joinWithMedia --\x3e ",t),sp.sendBehavioralMetric(vb,{correlation_id:e.correlationId,locus_id:e.locusUrl.split("/").pop(),reason:t.message,stack:t.stack},{type:t.name}),P().reject(t)}))):P().reject(new zv("joinWithMedia() can only be used with allowMediaInLobby set to true"))}},{key:"reconnect",value:function(e){var t=this;if(pp.logger.log("Meeting:index#reconnect --\x3e attempting to reconnect meeting ".concat(this.id)),!this.reconnectionManager||!this.reconnectionManager.reconnect)return P().reject(new zv("Cannot reconnect, ReconnectionManager must first be defined."));if(!eb.isMediaEstablished(this.currentMediaStatus))return P().reject(new zv("Cannot reconnect, Media has not established to reconnect"));try{pp.logger.info("Meeting:index#reconnect --\x3e Validating reconnect ability."),this.reconnectionManager.validate()}catch(e){return e instanceof zS?pp.logger.info("Meeting:index#reconnect --\x3e Unable to reconnect, reconnection in progress."):pp.logger.log("Meeting:index#reconnect --\x3e Unable to reconnect.",e),P().resolve()}return Qv.trigger(this,{file:"meeting/index",function:"reconnect"},$g.MEETING_RECONNECTION_STARTING),this.reconnectionManager.reconnect(e).then((function(){return t.waitForRemoteSDPAnswer()})).then((function(){return t.waitForMediaConnectionConnected()})).then((function(){Qv.trigger(t,{file:"meeting/index",function:"reconnect"},$g.MEETING_RECONNECTION_SUCCESS),pp.logger.log("Meeting:index#reconnect --\x3e Meeting reconnect success"),t.webex.internal.newMetrics.submitClientEvent({name:"client.media.recovered",payload:{recoveredBy:"new"},options:{meetingId:t.id}}),t.reconnectionManager.setStatus(_v.STATE.COMPLETE)})).catch((function(e){return Qv.trigger(t,{file:"meeting/index",function:"reconnect"},$g.MEETING_RECONNECTION_FAILURE,{error:new WS("Reconnection failure event",e)}),pp.logger.error("Meeting:index#reconnect --\x3e Meeting reconnect failed",e),sp.sendBehavioralMetric(wb,{correlation_id:t.correlationId,locus_id:t.locusUrl.split("/").pop(),reason:e.message,stack:e.stack}),t.uploadLogs({file:"meeting/index",function:"reconnect"}),P().reject(new WS("Reconnection failure event",e))})).finally((function(){t.reconnectionManager.reset()}))}},{key:"isTranscriptionSupported",value:function(){var e;return!(null===(e=this.locusInfo.controls.transcribe)||void 0===e||!e.transcribing)||(pp.logger.error("Meeting:index#isTranscriptionSupported --\x3e Webex Assistant is not enabled/supported"),!1)}},{key:"isReactionsSupported",value:function(){var e,t;return!(null===(e=this.locusInfo)||void 0===e||null===(t=e.controls)||void 0===t||!t.reactions.enabled)||(pp.logger.error("Meeting:index#isReactionsSupported --\x3e Reactions is not supported"),!1)}},{key:"setCaptionLanguage",value:function(e){var t=this;return new(P())((function(r,n){t.isTranscriptionSupported()||(pp.logger.error("Meeting:index#setCaptionLanguage --\x3e Webex Assistant is not enabled/supported"),n(new Error("Webex Assistant is not enabled/supported")));try{t.webex.internal.voicea.on(XE.EVENT_TRIGGERS.CAPTION_LANGUAGE_UPDATE,(function i(o){t.webex.internal.voicea.off(XE.EVENT_TRIGGERS.CAPTION_LANGUAGE_UPDATE,i),200===o.statusCode?(t.transcription.languageOptions=mx(mx({},t.transcription.languageOptions),{},{currentCaptionLanguage:e}),r(e)):n(o)})),t.webex.internal.voicea.requestLanguage(e)}catch(e){pp.logger.error("Meeting:index#setCaptionLanguage --\x3e ".concat(e)),n(e)}}))}},{key:"setSpokenLanguage",value:function(e){var t=this;return new(P())((function(r,n){t.isTranscriptionSupported()||(pp.logger.error("Meeting:index#setCaptionLanguage --\x3e Webex Assistant is not enabled/supported"),n(new Error("Webex Assistant is not enabled/supported")));try{t.webex.internal.voicea.on(XE.EVENT_TRIGGERS.SPOKEN_LANGUAGE_UPDATE,(function e(i){t.webex.internal.voicea.off(XE.EVENT_TRIGGERS.SPOKEN_LANGUAGE_UPDATE,e);var o=i.languageCode;o?(t.transcription.languageOptions=mx(mx({},t.transcription.languageOptions),{},{currentSpokenLanguage:o}),r(o)):n(i)})),t.webex.internal.voicea.setSpokenLanguage(e)}catch(e){pp.logger.error("Meeting:index#setSpokenLanguage --\x3e ".concat(e)),n(e)}}))}},{key:"startTranscription",value:(w=(0,T.Z)(V().mark((function e(t){return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isJoined()){e.next=15;break}if(pp.logger.info("Meeting:index#startTranscription --\x3e Attempting to enable transcription!"),e.prev=2,this.areVoiceaEventsSetup||this.setUpVoiceaListeners(),"host"!==this.getCurUserType()){e.next=7;break}return e.next=7,this.webex.internal.voicea.toggleTranscribing(!0,null==t?void 0:t.spokenLanguage);case 7:e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),pp.logger.error("Meeting:index#startTranscription --\x3e ".concat(e.t0)),sp.sendBehavioralMetric(Hb,{correlation_id:this.correlationId,reason:e.t0.message,stack:e.t0.stack});case 13:e.next=17;break;case 15:throw pp.logger.error("Meeting:index#startTranscription --\x3e meeting joined : ".concat(this.isJoined())),new Error("Meeting is not joined");case 17:case"end":return e.stop()}}),e,this,[[2,9]])}))),function(e){return w.apply(this,arguments)})},{key:"stopTranscription",value:function(){this.transcription&&(this.webex.internal.voicea.off(XE.EVENT_TRIGGERS.VOICEA_ANNOUNCEMENT,this.voiceaListenerCallbacks[XE.EVENT_TRIGGERS.VOICEA_ANNOUNCEMENT]),this.webex.internal.voicea.off(XE.EVENT_TRIGGERS.CAPTIONS_TURNED_ON,this.voiceaListenerCallbacks[XE.EVENT_TRIGGERS.CAPTIONS_TURNED_ON]),this.webex.internal.voicea.off(XE.EVENT_TRIGGERS.EVA_COMMAND,this.voiceaListenerCallbacks[XE.EVENT_TRIGGERS.EVA_COMMAND]),this.webex.internal.voicea.off(XE.EVENT_TRIGGERS.NEW_CAPTION,this.voiceaListenerCallbacks[XE.EVENT_TRIGGERS.NEW_CAPTION]),this.webex.internal.voicea.off(XE.EVENT_TRIGGERS.HIGHLIGHT_CREATED,this.voiceaListenerCallbacks[XE.EVENT_TRIGGERS.HIGHLIGHT_CREATED]),this.areVoiceaEventsSetup=!1,this.triggerStopReceivingTranscriptionEvent())}},{key:"triggerStopReceivingTranscriptionEvent",value:function(){pp.logger.info("\n      Meeting:index#stopReceivingTranscription --\x3e\n      closed voicea event listeners successfully."),Qv.trigger(this,{file:"meeting/index",function:"triggerStopReceivingTranscriptionEvent"},$g.MEETING_STOPPED_RECEIVING_TRANSCRIPTION)}},{key:"join",value:(E=(0,T.Z)(V().mark((function e(){var t,r,n,i,o,s,a,c,u,l=this,d=arguments;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.length>0&&void 0!==d[0]?d[0]:{},this.webex.meetings.registered){e.next=6;break}return r="Meeting:index#join --\x3e Device not registered",n=new Error(r),pp.logger.error(r),e.abrupt("return",P().reject(n));case 6:if(!this.deferJoin){e.next=8;break}return e.abrupt("return",this.deferJoin);case 8:if(this.deferJoin=new(P())((function(e,t){i=t,o=e})),t.correlationId&&(this.setCorrelationId(t.correlationId),pp.logger.log("Meeting:index#join --\x3e Using a new correlation id from app ".concat(this.correlationId))),this.hasJoinedOnce?t.correlationId||(pp.logger.log("Meeting:index#join --\x3e Generating a new correlation id for meeting ".concat(this.id)),pp.logger.log("Meeting:index#join --\x3e Previous correlation id ".concat(this.correlationId)),this.setCorrelationId(gp().v4()),pp.logger.log("Meeting:index#join --\x3e New correlation id ".concat(this.correlationId))):this.hasJoinedOnce=!0,t.rejoin&&this.meetingFiniteStateMachine.reset(),this.webex.internal.newMetrics.submitClientEvent({name:"client.call.initiated",payload:{trigger:this.callStateForMetrics.joinTrigger||"user-interaction",isRoapCallEnabled:!0,pstnAudioType:null==t?void 0:t.pstnAudioType},options:{meetingId:this.id}}),pp.logger.log("Meeting:index#join --\x3e Joining a meeting"),this.meetingFiniteStateMachine.state===bv.STATES.ENDED&&this.meetingFiniteStateMachine.reset(),this.meetingFiniteStateMachine.state!==bv.STATES.RINGING&&this.meetingFiniteStateMachine.ring(Pm),t.resourceId&&this.destination&&t.resourceId===this.destination&&(this.wirelessShare=!0),!t.meetingQuality){e.next=36;break}if("string"!=typeof t.meetingQuality){e.next=27;break}if(Nv[t.meetingQuality]){e.next=26;break}return s="Meeting:index#join --\x3e ".concat(t.meetingQuality," not defined"),a=new Error(s),pp.logger.error(s),i(a),this.deferJoin=void 0,e.abrupt("return",P().reject(a));case 26:this.mediaProperties.setRemoteQualityLevel(t.meetingQuality);case 27:if("object"!==(0,GE.Z)(t.meetingQuality)){e.next=36;break}if(Nv[t.meetingQuality.remote]){e.next=35;break}return c="Meeting:index#join --\x3e ".concat(t.meetingQuality.remote," not defined"),pp.logger.error(c),u=new Error(c),i(u),this.deferJoin=void 0,e.abrupt("return",P().reject(new Error(c)));case 35:t.meetingQuality.remote&&this.mediaProperties.setRemoteQualityLevel(t.meetingQuality.remote);case 36:return this.isMultistream=!!t.enableMultistream,e.prev=37,e.next=40,this.checkAndRefreshPermissionToken(qv,$v);case 40:e.next=51;break;case 42:if(e.prev=42,e.t0=e.catch(37),pp.logger.error("Meeting:index#join --\x3e Failed to refresh permission token:",e.t0),!(e.t0 instanceof Ky||e.t0 instanceof Zy||e.t0 instanceof qy)){e.next=51;break}return this.meetingFiniteStateMachine.fail(e.t0),Qv.trigger(this,{file:"meeting/index",function:"join"},Jg.REQUEST_UPLOAD_LOGS,this),i(e.t0),this.deferJoin=void 0,e.abrupt("return",P().reject(e.t0));case 51:return e.abrupt("return",eb.joinMeetingOptions(this,t).then((function(e){return l.meetingFiniteStateMachine.join(),pp.logger.log("Meeting:index#join --\x3e Success"),sp.sendBehavioralMetric(sb,{correlation_id:l.correlationId}),o(e),l.deferJoin=void 0,e})).catch((function(e){var t,r;return l.meetingFiniteStateMachine.fail(e),pp.logger.error("Meeting:index#join --\x3e Failed",e),l.webex.internal.newMetrics.submitClientEvent({name:"client.locus.join.response",payload:{identifiers:{meetingLookupUrl:null===(t=l.meetingInfo)||void 0===t?void 0:t.meetingLookupUrl}},options:{meetingId:l.id,rawError:e}}),sp.sendBehavioralMetric(ab,{correlation_id:l.correlationId,reason:null===(r=e.error)||void 0===r?void 0:r.message,stack:e.stack}),Qv.trigger(l,{file:"meeting/index",function:"join"},Jg.REQUEST_UPLOAD_LOGS,l),i(e),l.deferJoin=void 0,P().reject(e)})).then((function(e){return l.config.enableAutomaticLLM&&l.updateLLMConnection().catch((function(e){pp.logger.error("Meeting:index#join --\x3e Transcription Socket Connection Failed",e),sp.sendBehavioralMetric(yb,{correlation_id:l.correlationId,reason:null==e?void 0:e.message,stack:e.stack})})).then((function(){pp.logger.info("Meeting:index#join --\x3e Transcription Socket Connection Success"),Qv.trigger(l,{file:"meeting/index",function:"join"},$g.MEETING_TRANSCRIPTION_CONNECTED,void 0)})),e})));case 52:case"end":return e.stop()}}),e,this,[[37,42]])}))),function(){return E.apply(this,arguments)})},{key:"updateLLMConnection",value:(b=(0,T.Z)(V().mark((function e(){var t,r,n,i,o,s=this;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.locusInfo,r=t.url,n=t.info,i=(void 0===n?{}:n).datachannelUrl,o=this.isJoined(),!this.webex.internal.llm.isConnected()){e.next=8;break}if(r!==this.webex.internal.llm.getLocusUrl()||!o){e.next=5;break}return e.abrupt("return",void 0);case 5:return e.next=7,this.webex.internal.llm.disconnectLLM();case 7:this.webex.internal.llm.off("event:relay.event",this.processRelayEvent);case 8:if(o){e.next=10;break}return e.abrupt("return",void 0);case 10:return e.abrupt("return",this.webex.internal.llm.registerAndConnect(r,i).then((function(e){return s.webex.internal.llm.off("event:relay.event",s.processRelayEvent),s.webex.internal.llm.on("event:relay.event",s.processRelayEvent),pp.logger.info("Meeting:index#updateLLMConnection --\x3e enabled to receive relay events!"),P().resolve(e)})));case 11:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"usePhoneAudio",value:function(e){return e?this.dialOutPstn(e):this.dialInPstn()}},{key:"isPhoneProvisioned",value:function(e){return[Mv.JOINED,Mv.CONNECTED,Mv.SUCCESS].includes(e)}},{key:"dialInPstn",value:function(){var e=this;if(this.isPhoneProvisioned(this.dialInDeviceStatus))return P().resolve();var t=this.correlationId,r=this.locusUrl;return this.dialInUrl||(this.dialInUrl="dialin:///".concat(gp().v4())),this.meetingRequest.dialIn({correlationId:t,dialInUrl:this.dialInUrl,locusUrl:r,clientUrl:this.deviceUrl}).catch((function(t){var n;return sp.sendBehavioralMetric(Ob,{correlation_id:e.correlationId,dial_in_url:e.dialInUrl,locus_id:r.split("/").pop(),client_url:e.deviceUrl,reason:null===(n=t.error)||void 0===n?void 0:n.message,stack:t.stack}),P().reject(t)}))}},{key:"dialOutPstn",value:function(e){var t=this;if(this.isPhoneProvisioned(this.dialOutDeviceStatus))return P().resolve();var r=this.correlationId,n=this.locusUrl;return this.dialOutUrl||(this.dialOutUrl="dialout:///".concat(gp().v4())),this.meetingRequest.dialOut({correlationId:r,dialOutUrl:this.dialOutUrl,phoneNumber:e,locusUrl:n,clientUrl:this.deviceUrl}).catch((function(e){var r;return sp.sendBehavioralMetric(Nb,{correlation_id:t.correlationId,dial_out_url:t.dialOutUrl,locus_id:n.split("/").pop(),client_url:t.deviceUrl,reason:null===(r=e.error)||void 0===r?void 0:r.message,stack:e.stack}),P().reject(e)}))}},{key:"disconnectPhoneAudio",value:function(){return P().all([this.isPhoneProvisioned(this.dialInDeviceStatus)?eb.disconnectPhoneAudio(this,this.dialInUrl):P().resolve(),this.isPhoneProvisioned(this.dialOutDeviceStatus)?eb.disconnectPhoneAudio(this,this.dialOutUrl):P().resolve()])}},{key:"moveTo",value:function(e){var t=this;if(!e)throw new zv("Cannot move call without a resourceId.");return this.webex.internal.newMetrics.submitClientEvent({name:"client.media.capabilities",payload:{mediaCapabilities:{rx:{audio:!1,share:!0,share_audio:!1,video:!1,whiteboard:!1},tx:{audio:!1,share:!1,share_audio:!1,video:!1,whiteboard:!1}}},options:{meetingId:this.id}}),this.webex.internal.newMetrics.submitClientEvent({name:"client.call.move-media",options:{meetingId:this.id}}),this.locusInfo.once(uv.EVENTS.SELF_OBSERVING,(0,T.Z)(V().mark((function e(){var r;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.screenShareFloorState!==wx.GRANTED){e.next=4;break}return e.next=4,t.releaseScreenShareFloor();case 4:return r={mediaDirection:{sendVideo:!1,receiveVideo:!1,sendAudio:!1,receiveAudio:!1,sendShare:!1,receiveShare:!0}},t.cleanupLocalStreams(),t.mediaProperties.setMediaDirection(r.mediaDirection),t.mediaProperties.unsetRemoteMedia(),e.next=10,t.reconnectionManager.reconnectMedia(r).then((function(){sp.sendBehavioralMetric(Jb)}));case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),pp.logger.error("Meeting:index#moveTo --\x3e Failed to moveTo resourceId",e.t0),sp.sendBehavioralMetric(Yb,{correlation_id:t.correlationId,locus_id:t.locusUrl.split("/").pop(),reason:e.t0.message,stack:e.t0.stack});case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))),pp.logger.info("Meeting:index#moveTo --\x3e Initated moved to using resourceId",e),eb.joinMeetingOptions(this,{resourceId:e,moveToResource:!0}).then((function(){t.meetingFiniteStateMachine.join()})).catch((function(e){return t.meetingFiniteStateMachine.fail(e),sp.sendBehavioralMetric(Yb,{correlation_id:t.correlationId,locus_id:t.locusUrl.split("/").pop(),reason:e.message,stack:e.stack}),pp.logger.error("Meeting:index#moveTo --\x3e Failed to moveTo resourceId",e),P().reject(e)}))}},{key:"moveFrom",value:function(e){var t=this;if(!e)throw new zv("Cannot move call without a resourceId.");var r=this.correlationId;return this.webex.internal.newMetrics.submitClientEvent({name:"client.call.move-media",options:{meetingId:this.id}}),eb.joinMeetingOptions(this).then((function(){return eb.leaveMeeting(t,{resourceId:e,correlationId:r,moveMeeting:!0}).then((function(){t.resourceId="",sp.sendBehavioralMetric(Qb)}))})).catch((function(e){return t.meetingFiniteStateMachine.fail(e),sp.sendBehavioralMetric(Xb,{correlation_id:t.correlationId,locus_id:t.locusUrl.split("/").pop(),reason:e.message,stack:e.stack}),pp.logger.error("Meeting:index#moveTo --\x3e Failed to moveTo resourceId",e),P().reject(e)}))}},{key:"getMediaConnectionDebugId",value:function(){return"MC-".concat(this.id.substring(0,4))}},{key:"createMediaConnection",value:(y=(0,T.Z)(V().mark((function e(t,r){var n,i,o,s;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=gy.createMediaConnection(this.isMultistream,this.getMediaConnectionDebugId(),this.webex,this.id,this.correlationId,{mediaProperties:this.mediaProperties,remoteQualityLevel:this.mediaProperties.remoteQualityLevel,enableRtx:this.config.enableRtx,enableExtmap:this.config.enableExtmap,turnServerInfo:t,bundlePolicy:r}),this.mediaProperties.setMediaPeerConnection(n),this.setupMediaConnectionListeners(),this.isMultistream&&(i=this.mediaProperties.mediaDirection.sendAudio||this.mediaProperties.mediaDirection.receiveAudio,o=this.mediaProperties.mediaDirection.sendVideo||this.mediaProperties.mediaDirection.receiveVideo,s=this.mediaProperties.mediaDirection.sendShare||this.mediaProperties.mediaDirection.receiveShare,this.sendSlotManager.createSlot(n,Pn.VideoMain,o),this.sendSlotManager.createSlot(n,Pn.AudioMain,i),this.sendSlotManager.createSlot(n,Pn.VideoSlides,s),this.sendSlotManager.createSlot(n,Pn.AudioSlides,s)),!this.mediaProperties.audioStream){e.next=7;break}return e.next=7,this.publishStream(Pn.AudioMain,this.mediaProperties.audioStream);case 7:if(!this.mediaProperties.videoStream){e.next=10;break}return e.next=10,this.publishStream(Pn.VideoMain,this.mediaProperties.videoStream);case 10:if(!this.mediaProperties.shareVideoStream){e.next=13;break}return e.next=13,this.publishStream(Pn.VideoSlides,this.mediaProperties.shareVideoStream);case 13:if(!this.isMultistream||!this.mediaProperties.shareAudioStream){e.next=16;break}return e.next=16,this.publishStream(Pn.AudioSlides,this.mediaProperties.shareAudioStream);case 16:return e.abrupt("return",n);case 17:case"end":return e.stop()}}),e,this)}))),function(e,t){return y.apply(this,arguments)})},{key:"forwardEvent",value:function(e,t,r){var n=this;e.on(t,(function(e){return Qv.trigger(n,{file:"meetings",function:"addMedia"},r,e)}))}},{key:"setUpLocalStreamReferences",value:(v=(0,T.Z)(V().mark((function e(t){var r,n,i;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=[],null!=t&&t.microphone&&i.push(this.setLocalAudioStream(t.microphone)),null!=t&&t.camera&&i.push(this.setLocalVideoStream(t.camera)),null!=t&&null!==(r=t.screenShare)&&void 0!==r&&r.video&&i.push(this.setLocalShareVideoStream(t.screenShare.video)),null!=t&&null!==(n=t.screenShare)&&void 0!==n&&n.audio&&i.push(this.setLocalShareAudioStream(t.screenShare.audio)),e.prev=5,e.next=8,P().all(i);case 8:e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(5),pp.logger.error("Meeting:index#addMedia():setUpLocalStreamReferences --\x3e Error , ",e.t0),e.t0;case 14:case"end":return e.stop()}}),e,this,[[5,10]])}))),function(e){return v.apply(this,arguments)})},{key:"waitForMediaConnectionConnected",value:(g=(0,T.Z)(V().mark((function e(){var t,r,n,i,o,s,a,c,u,l,d,h,f,p;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.mediaProperties.waitForMediaConnectionConnected();case 3:e.next=9;break;case 5:throw e.prev=5,e.t0=e.catch(0),this.hasMediaConnectionConnectedAtLeastOnce||this.webex.internal.newMetrics.submitClientEvent({name:"client.ice.end",payload:{canProceed:!this.turnServerUsed,icePhase:this.turnServerUsed?"JOIN_MEETING_FINAL":"JOIN_MEETING_RETRY",errors:[this.webex.internal.newMetrics.callDiagnosticMetrics.getErrorPayloadForClientErrorCode({clientErrorCode:H.CallDiagnosticUtils.generateClientErrorCodeForIceFailure({signalingState:(null===(t=this.mediaProperties.webrtcMediaConnection)||void 0===t||null===(r=t.multistreamConnection)||void 0===r||null===(n=r.pc)||void 0===n||null===(i=n.pc)||void 0===i?void 0:i.signalingState)||(null===(o=this.mediaProperties.webrtcMediaConnection)||void 0===o||null===(s=o.mediaConnection)||void 0===s||null===(a=s.pc)||void 0===a?void 0:a.signalingState)||"unknown",iceConnectionState:(null===(c=this.mediaProperties.webrtcMediaConnection)||void 0===c||null===(u=c.multistreamConnection)||void 0===u||null===(l=u.pc)||void 0===l||null===(d=l.pc)||void 0===d?void 0:d.iceConnectionState)||(null===(h=this.mediaProperties.webrtcMediaConnection)||void 0===h||null===(f=h.mediaConnection)||void 0===f||null===(p=f.pc)||void 0===p?void 0:p.iceConnectionState)||"unknown",turnServerUsed:this.turnServerUsed})})]},options:{meetingId:this.id}}),new Error("Timed out waiting for media connection to be connected, correlationId=".concat(this.correlationId));case 9:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(){return g.apply(this,arguments)})},{key:"createStatsAnalyzer",value:function(){var e=this;this.config.stats.enableStatsAnalyzer&&(this.networkQualityMonitor=new Gw(this.config.stats),this.statsAnalyzer=new Fw(this.config.stats,(function(t){return e.receiveSlotManager.findReceiveSlotBySsrc(t)}),this.networkQualityMonitor),this.setupStatsAnalyzerEventHandlers(),this.networkQualityMonitor.on($g.NETWORK_QUALITY,this.sendNetworkQualityEvent.bind(this)))}},{key:"waitForRemoteSDPAnswer",value:(m=(0,T.Z)(V().mark((function e(){var t,r;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="Meeting:index#addMedia():waitForRemoteSDPAnswer --\x3e",this.deferSDPAnswer){e.next=4;break}return pp.logger.warn("".concat(t," offer not created yet")),e.abrupt("return",P().reject(new Error("waitForRemoteSDPAnswer() called before local sdp offer created")));case 4:return r=this.deferSDPAnswer,this.sdpResponseTimer=setTimeout((function(){pp.logger.warn("".concat(t," timeout! no REMOTE SDP ANSWER received within ").concat(Og/1e3," seconds")),r.reject(new Error("Timed out waiting for REMOTE SDP ANSWER"))}),Og),pp.logger.info("".concat(t," waiting for REMOTE SDP ANSWER...")),e.abrupt("return",r.promise);case 8:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"retryEstablishMediaConnectionWithForcedTurnDiscovery",value:(p=(0,T.Z)(V().mark((function e(t,r){var n;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="Meeting:index#addMedia():retryEstablishMediaConnectionWithForcedTurnDiscovery --\x3e",e.prev=1,e.next=4,this.establishMediaConnection(t,r,!0);case 4:e.next=10;break;case 6:throw e.prev=6,e.t0=e.catch(1),pp.logger.error("".concat(n," retry with TURN-TLS failed, media connection unable to connect, "),e.t0),e.t0;case 10:case"end":return e.stop()}}),e,this,[[1,6]])}))),function(e,t){return p.apply(this,arguments)})},{key:"retryWithForcedTurnDiscovery",value:(f=(0,T.Z)(V().mark((function e(t,r){var n;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.retriedWithTurnServer=!0,n="Meeting:index#addMedia():retryWithForcedTurnDiscovery --\x3e",e.next=4,this.cleanUpBeforeRetryWithTurnServer();case 4:if(sp.sendBehavioralMetric(lb,{correlation_id:this.correlationId,state:this.state,meetingState:this.meetingState,reason:"forcingTurnTls"}),this.state!==yv.STATES.LEFT){e.next=9;break}return pp.logger.info("".concat(n," meeting state was LEFT after first attempt to establish media connection. Attempting to rejoin. ")),e.next=9,this.join({rejoin:!0});case 9:return e.next=11,this.retryEstablishMediaConnectionWithForcedTurnDiscovery(t,r);case 11:case"end":return e.stop()}}),e,this)}))),function(e,t){return f.apply(this,arguments)})},{key:"handleWaitForMediaConnectionConnectedError",value:(h=(0,T.Z)(V().mark((function e(t,r,n){var i;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i="Meeting:index#addMedia():handleWaitForMediaConnectionConnectedError --\x3e",this.turnServerUsed){e.next=7;break}return pp.logger.info("".concat(i," error waiting for media to connect on UDP, TCP, retrying using TURN-TLS, "),t),e.next=5,this.retryWithForcedTurnDiscovery(r,n);case 5:e.next=9;break;case 7:throw pp.logger.error("".concat(i," error waiting for media to connect using UDP, TCP and TURN-TLS"),t),new By;case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return h.apply(this,arguments)})},{key:"establishMediaConnection",value:(d=(0,T.Z)(V().mark((function e(t,r,n){var i,o,s,a,c,u;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="Meeting:index#addMedia():establishMediaConnection --\x3e",o=this.webex.internal.newMetrics.callDiagnosticLatencies,s=this.retriedWithTurnServer,e.prev=3,this.webex.internal.newMetrics.submitInternalEvent({name:"internal.client.add-media.turn-discovery.start"}),e.next=7,this.roap.doTurnDiscovery(this,s,n);case 7:return a=e.sent,this.turnDiscoverySkippedReason=null==a?void 0:a.turnDiscoverySkippedReason,this.turnServerUsed=!this.turnDiscoverySkippedReason,this.webex.internal.newMetrics.submitInternalEvent({name:"internal.client.add-media.turn-discovery.end"}),c=a.turnServerInfo,this.turnServerUsed&&c&&sp.sendBehavioralMetric(sE,{correlation_id:this.correlationId,latency:o.getTurnDiscoveryTime(),turnServerUsed:this.turnServerUsed,retriedWithTurnServer:this.retriedWithTurnServer}),e.next=15,this.createMediaConnection(c,r);case 15:if(u=e.sent,pp.logger.info("".concat(i," media connection created")),!this.isMultistream){e.next=24;break}return this.remoteMediaManager=new ET(this.receiveSlotManager,this.mediaRequestManagers,t),this.forwardEvent(this.remoteMediaManager,bT.AudioCreated,$g.REMOTE_MEDIA_AUDIO_CREATED),this.forwardEvent(this.remoteMediaManager,bT.ScreenShareAudioCreated,$g.REMOTE_MEDIA_SCREEN_SHARE_AUDIO_CREATED),this.forwardEvent(this.remoteMediaManager,bT.VideoLayoutChanged,$g.REMOTE_MEDIA_VIDEO_LAYOUT_CHANGED),e.next=24,this.remoteMediaManager.start();case 24:return e.next=26,u.initiateOffer();case 26:return e.next=28,this.waitForRemoteSDPAnswer();case 28:this.handleMediaLogging(this.mediaProperties),e.next=35;break;case 31:throw e.prev=31,e.t0=e.catch(3),pp.logger.error("".concat(i," error establishing media connection, "),e.t0),e.t0;case 35:return e.prev=35,e.next=38,this.waitForMediaConnectionConnected();case 38:e.next=44;break;case 40:return e.prev=40,e.t1=e.catch(35),e.next=44,this.handleWaitForMediaConnectionConnectedError(e.t1,t,r);case 44:case"end":return e.stop()}}),e,this,[[3,31],[35,40]])}))),function(e,t,r){return d.apply(this,arguments)})},{key:"cleanUpOnAddMediaFailure",value:(l=(0,T.Z)(V().mark((function e(){return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.statsAnalyzer){e.next=3;break}return e.next=3,this.statsAnalyzer.stopAnalyzer();case 3:return this.statsAnalyzer=null,e.next=6,this.forceSendStatsReport({callFrom:"addMedia"});case 6:this.mediaProperties.webrtcMediaConnection&&(this.closePeerConnections(),this.unsetPeerConnections());case 7:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"cleanUpBeforeRetryWithTurnServer",value:(u=(0,T.Z)(V().mark((function e(){return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.forceSendStatsReport({callFrom:"cleanUpBeforeRetryWithTurnServer"});case 2:this.mediaProperties.webrtcMediaConnection&&(this.remoteMediaManager&&(this.remoteMediaManager.stop(),this.remoteMediaManager=null),F()(this.mediaRequestManagers).forEach((function(e){return e.reset()})),this.receiveSlotManager.reset(),this.mediaProperties.webrtcMediaConnection.close(),this.sendSlotManager.reset(),this.mediaProperties.unsetPeerConnection());case 3:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"addMedia",value:(c=(0,T.Z)(V().mark((function e(){var t,r,n,i,o,s,a,c,u,l,d,h,f,p,m,g,v,y,b,E,w,S,_,T,x,A,I,C,R,k,O,N,P,L,D,M,U,B,F,H,G,q=arguments;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=q.length>0&&void 0!==q[0]?q[0]:{},this.retriedWithTurnServer=!1,this.hasMediaConnectionConnectedAtLeastOnce=!1,i="Meeting:index#addMedia --\x3e",pp.logger.info("".concat(i," called with: ").concat(uy()(n))),!0===n.allowMediaInLobby||this.meetingState===ev.ACTIVE){e.next=7;break}throw new Ny;case 7:if(!eb.isUserInLeftState(this.locusInfo)){e.next=9;break}throw new Py;case 9:if(o=n.localStreams,s=n.audioEnabled,a=void 0===s||s,c=n.videoEnabled,u=void 0===c||c,l=n.shareAudioEnabled,d=void 0===l||l,h=n.shareVideoEnabled,f=void 0===h||h,p=n.remoteMediaManagerConfig,m=n.bundlePolicy,g=n.allowMediaInLobby,this.allowMediaInLobby=null==n?void 0:n.allowMediaInLobby,!this.isUserUnadmitted||this.wirelessShare||g){e.next=13;break}throw new Dy;case 13:return this.webex.internal.newMetrics.submitClientEvent({name:"client.media.capabilities",payload:{mediaCapabilities:{rx:{audio:!1,share:!1,share_audio:!1,video:!1,whiteboard:!1},tx:{audio:!1,share:!1,share_audio:!1,video:!1,whiteboard:!1}}},options:{meetingId:this.id}}),this.mediaProperties.setMediaDirection({sendAudio:a,sendVideo:u,sendShare:!1,receiveAudio:a,receiveVideo:u,receiveShare:d||f}),this.locusMediaRequest=new dx({correlationId:this.correlationId,device:{url:this.deviceUrl,deviceType:this.config.deviceType,countryCode:null===(t=this.webex.meetings.geoHintInfo)||void 0===t?void 0:t.countryCode,regionCode:null===(r=this.webex.meetings.geoHintInfo)||void 0===r?void 0:r.regionCode},preferTranscoding:!this.isMultistream},{parent:this.webex}),this.audio=iS(Ep,this,a),this.video=iS(gm,this,u),e.prev=18,e.next=21,this.setUpLocalStreamReferences(o);case 21:return this.setMercuryListener(),this.createStatsAnalyzer(),e.next=25,this.establishMediaConnection(p,m,!1);case 25:return e.next=27,j.handleDeviceLogging();case 27:if(!this.mediaProperties.hasLocalShareStream()){e.next=30;break}return e.next=30,this.enqueueScreenShareFloorRequest();case 30:return e.next=32,this.mediaProperties.getCurrentConnectionType();case 32:return y=e.sent,e.next=35,this.webex.meetings.reachability.getReachabilityMetrics();case 35:b=e.sent,sp.sendBehavioralMetric(cb,mx({correlation_id:this.correlationId,locus_id:this.locusUrl.split("/").pop(),connectionType:y,isMultistream:this.isMultistream,retriedWithTurnServer:this.retriedWithTurnServer},b)),this.webex.internal.newMetrics.submitClientEvent({name:"client.media-engine.ready",options:{meetingId:this.id}}),pp.logger.info("".concat(i," successfully established media connection, type=").concat(y)),null===(v=this.remoteMediaManager)||void 0===v||v.logAllReceiveSlots(),e.next=54;break;case 42:return e.prev=42,e.t0=e.catch(18),pp.logger.error("".concat(i," failed to establish media connection: "),e.t0),e.next=47,this.webex.meetings.reachability.getReachabilityMetrics();case 47:return G=e.sent,sp.sendBehavioralMetric(ub,mx({correlation_id:this.correlationId,locus_id:this.locusUrl.split("/").pop(),reason:e.t0.message,stack:e.t0.stack,code:e.t0.code,turnDiscoverySkippedReason:this.turnDiscoverySkippedReason,turnServerUsed:this.turnServerUsed,retriedWithTurnServer:this.retriedWithTurnServer,isMultistream:this.isMultistream,signalingState:(null===(E=this.mediaProperties.webrtcMediaConnection)||void 0===E||null===(w=E.multistreamConnection)||void 0===w||null===(S=w.pc)||void 0===S||null===(_=S.pc)||void 0===_?void 0:_.signalingState)||(null===(T=this.mediaProperties.webrtcMediaConnection)||void 0===T||null===(x=T.mediaConnection)||void 0===x||null===(A=x.pc)||void 0===A?void 0:A.signalingState)||"unknown",connectionState:(null===(I=this.mediaProperties.webrtcMediaConnection)||void 0===I||null===(C=I.multistreamConnection)||void 0===C||null===(R=C.pc)||void 0===R||null===(k=R.pc)||void 0===k?void 0:k.connectionState)||(null===(O=this.mediaProperties.webrtcMediaConnection)||void 0===O||null===(N=O.mediaConnection)||void 0===N||null===(P=N.pc)||void 0===P?void 0:P.connectionState)||"unknown",iceConnectionState:(null===(L=this.mediaProperties.webrtcMediaConnection)||void 0===L||null===(D=L.multistreamConnection)||void 0===D||null===(M=D.pc)||void 0===M||null===(U=M.pc)||void 0===U?void 0:U.iceConnectionState)||(null===(B=this.mediaProperties.webrtcMediaConnection)||void 0===B||null===(F=B.mediaConnection)||void 0===F||null===(H=F.pc)||void 0===H?void 0:H.iceConnectionState)||"unknown"},G)),e.next=51,this.cleanUpOnAddMediaFailure();case 51:throw Qv.trigger(this,{file:"meeting/index",function:"addMedia"},Jg.REQUEST_UPLOAD_LOGS,this),e.t0 instanceof vh.SdpError&&this.leave({reason:zg.MEETING_CONNECTION_FAILED}),e.t0;case 54:case"end":return e.stop()}}),e,this,[[18,42]])}))),function(){return c.apply(this,arguments)})},{key:"canUpdateMedia",value:function(){return!this.isRoapInProgress}},{key:"enqueueMediaUpdate",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.canUpdateMedia();return new(P())((function(i,o){var s={pendingPromiseResolve:i,pendingPromiseReject:o,mediaUpdateType:e,options:r};pp.logger.log("Meeting:index#enqueueMediaUpdate --\x3e enqueuing media update type=".concat(e)),t.queuedMediaUpdates.push(s),n&&t.processNextQueuedMediaUpdate()}))}},{key:"updateMedia",value:(a=(0,T.Z)(V().mark((function e(t){var r,n,i,o;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.checkMediaConnection(),r=t.audioEnabled,n=t.videoEnabled,i=t.shareAudioEnabled,o=t.shareVideoEnabled,pp.logger.log("Meeting:index#updateMedia --\x3e called with options=".concat(uy()(t))),this.canUpdateMedia()){e.next=5;break}return e.abrupt("return",this.enqueueMediaUpdate(Ex,t));case 5:if(!this.isMultistream){e.next=10;break}if(void 0===i&&void 0===o){e.next=8;break}throw new Error("toggling shareAudioEnabled or shareVideoEnabled in a multistream meeting is not supported, to control receiving screen share call meeting.remoteMediaManager.setLayout() with appropriate layout");case 8:e.next=12;break;case 10:if(void 0===i){e.next=12;break}throw new Error("toggling shareAudioEnabled in a transcoded meeting is not supported as of now");case 12:if(void 0!==r&&(this.mediaProperties.mediaDirection.sendAudio=r,this.mediaProperties.mediaDirection.receiveAudio=r,this.audio.enable(this,r),this.isMultistream&&this.sendSlotManager.setActive(Pn.AudioMain,r)),void 0!==n&&(this.mediaProperties.mediaDirection.sendVideo=n,this.mediaProperties.mediaDirection.receiveVideo=n,this.video.enable(this,n),this.isMultistream&&this.sendSlotManager.setActive(Pn.VideoMain,n)),void 0===i&&void 0===o||(this.mediaProperties.mediaDirection.receiveShare=!(!i&&!o)),this.isMultistream){e.next=18;break}return e.next=18,this.updateTranscodedMediaConnection();case 18:return e.abrupt("return",void 0);case 19:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"acknowledge",value:function(e){var t=this;return e?e===km?this.meetingRequest.acknowledgeMeeting({locusUrl:this.locusUrl,deviceUrl:this.deviceUrl,correlationId:this.correlationId}).then((function(e){return P().resolve(e)})).then((function(r){return t.meetingFiniteStateMachine.ring(e),t.webex.internal.newMetrics.submitClientEvent({name:"client.alert.displayed",options:{meetingId:t.id}}),P().resolve({response:r})})):P().resolve({message:"noop"}):P().reject(new zv("Type must be set to acknowledge the meeting."))}},{key:"decline",value:function(e){var t=this;return eb.declineMeeting(this,e).then((function(e){return t.meetingFiniteStateMachine.decline(),P().resolve(e)})).catch((function(e){return t.meetingFiniteStateMachine.fail(e),P().reject(e)}))}},{key:"buildLeaveFetchRequestOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=eb.buildLeaveFetchRequestOptions(this,e);return this.webex.prepareFetchOptions(t)}},{key:"leave",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.reason||zg.CLIENT_LEAVE_REQUEST;this.webex.internal.newMetrics.submitInternalEvent({name:"internal.reset.join.latencies"});var n=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.webex.internal.newMetrics.submitClientEvent({name:"client.call.leave",payload:mx({trigger:"user-interaction",canProceed:!1,leaveReason:t.clientEventLeaveReason},r),options:{meetingId:e.id}})};return pp.logger.log("Meeting:index#leave --\x3e Leaving a meeting"),eb.leaveMeeting(this,t).then((function(i){return n(),e.meetingFiniteStateMachine.leave(),e.clearMeetingData(),Qv.trigger(e,{file:"meeting/index",function:"leave"},Jg.REQUEST_UPLOAD_LOGS,e),(e.wirelessShare||e.guest)&&Qv.trigger(e,{file:"meeting/index",function:"leave"},Jg.DESTROY_MEETING,{reason:t.reason,meetingId:e.id}),pp.logger.log("Meeting:index#leave --\x3e LEAVE REASON ",r),i})).catch((function(t){return n({errors:[{fatal:!1,errorDescription:t.message,category:"signaling",errorCode:1e3,name:"client.leave",shownToUser:!1}]}),e.meetingFiniteStateMachine.fail(t),pp.logger.error("Meeting:index#leave --\x3e Failed to leave ",t),Qv.trigger(e,{file:"meeting/index",function:"leave"},Jg.REQUEST_UPLOAD_LOGS,e),sp.sendBehavioralMetric(pb,{correlation_id:e.correlationId,locus_id:e.locusUrl.split("/").pop(),reason:t.message,stack:t.stack,code:t.code}),P().reject(t)}))}},{key:"startWhiteboardShare",value:function(e,t){var r=this,n=this.locusInfo.mediaShares.find((function(e){return"whiteboard"===e.name}));if(!e)return P().reject(new zv("Cannot share without channelUrl."));if(n){this.webex.internal.newMetrics.submitClientEvent({name:"client.share.initiated",payload:{mediaType:"whiteboard"},options:{meetingId:this.id}});var i={disposition:Xg.GRANTED,personUrl:this.locusInfo.self.url,deviceUrl:this.deviceUrl,uri:n.url,resourceUrl:e};return t&&(i.resourceToken=t),this.meetingRequest.changeMeetingFloor(i).then((function(){return r.screenShareFloorState=wx.RELEASED,P().resolve()})).catch((function(t){return pp.logger.error("Meeting:index#startWhiteboardShare --\x3e Error ",t),sp.sendBehavioralMetric(xb,{correlation_id:r.correlationId,locus_id:r.locusUrl.split("/").pop(),reason:t.message,stack:t.stack,board:{channelUrl:e}}),P().reject(t)}))}return P().reject(new zv("Cannot share without whiteboard."))}},{key:"stopWhiteboardShare",value:function(e){var t=this,r=this.locusInfo.mediaShares.find((function(e){return"whiteboard"===e.name}));return r?(this.webex.internal.newMetrics.submitClientEvent({name:"client.share.stopped",payload:{mediaType:"whiteboard"},options:{meetingId:this.id}}),this.meetingRequest.changeMeetingFloor({disposition:Xg.RELEASED,personUrl:this.locusInfo.self.url,deviceUrl:this.deviceUrl,uri:r.url}).catch((function(r){return pp.logger.error("Meeting:index#stopWhiteboardShare --\x3e Error ",r),sp.sendBehavioralMetric(Ab,{correlation_id:t.correlationId,locus_id:t.locusUrl.split("/").pop(),reason:r.message,stack:r.stack,board:{channelUrl:e}}),P().reject(r)})).finally((function(){}))):P().reject(new zv("Cannot stop share without whiteboard."))}},{key:"requestScreenShareFloor",value:function(){var e=this;if(!this.mediaProperties.hasLocalShareStream()||!this.mediaProperties.mediaDirection.sendShare)return pp.logger.log("Meeting:index#requestScreenShareFloor --\x3e NOT requesting floor, because we don't have the share stream anymore (shareStream=".concat(this.mediaProperties.shareVideoStream?"yes":"no",", sendShare=").concat(this.mediaProperties.mediaDirection.sendShare,")")),this.screenShareFloorState=wx.RELEASED,P().resolve({});if(this.state===yv.STATES.JOINED){this.screenShareFloorState=wx.PENDING;var t=this.locusInfo.mediaShares.find((function(e){return e.name===Lp}));return t&&this.shareStatus!==qg.LOCAL_SHARE_ACTIVE?(this.webex.internal.newMetrics.submitClientEvent({name:"client.share.floor-grant.request",payload:{mediaType:"share",shareInstanceId:this.localShareInstanceId},options:{meetingId:this.id}}),this.meetingRequest.changeMeetingFloor({disposition:Xg.GRANTED,personUrl:this.locusInfo.self.url,deviceUrl:this.deviceUrl,uri:t.url,resourceUrl:this.resourceUrl,shareInstanceId:this.localShareInstanceId}).then((function(){return e.screenShareFloorState=wx.GRANTED,sp.sendBehavioralMetric(_b,{correlation_id:e.correlationId,locus_id:e.locusUrl.split("/").pop()}),P().resolve()})).catch((function(t){return pp.logger.error("Meeting:index#share --\x3e Error ",t),sp.sendBehavioralMetric(Tb,{correlation_id:e.correlationId,locus_id:e.locusUrl.split("/").pop(),reason:t.message,stack:t.stack}),e.webex.internal.newMetrics.submitClientEvent({name:"client.share.floor-granted.local",payload:{mediaType:"share",errors:eb.getChangeMeetingFloorErrorPayload(t.message),shareInstanceId:e.localShareInstanceId},options:{meetingId:e.id}}),e.screenShareFloorState=wx.RELEASED,P().reject(t)}))):t?P().resolve():(this.screenShareFloorState=wx.RELEASED,P().reject(new zv("Cannot share without content.")))}return this.floorGrantPending=!0,P().resolve({})}},{key:"requestScreenShareFloorIfPending",value:function(){var e=this;this.floorGrantPending&&this.state===yv.STATES.JOINED&&this.requestScreenShareFloor().then((function(){e.floorGrantPending=!1}))}},{key:"releaseScreenShareFloor",value:function(){var e,t=this,r=this.locusInfo.mediaShares.find((function(e){return e.name===Lp}));return this.screenShareFloorState===wx.RELEASED?P().resolve():(this.screenShareFloorState=wx.RELEASED,r?(this.webex.internal.newMetrics.submitClientEvent({name:"client.share.stopped",payload:{mediaType:"share",shareInstanceId:this.localShareInstanceId},options:{meetingId:this.id}}),(null===(e=r.floor)||void 0===e?void 0:e.beneficiary.id)!==this.selfId?P().resolve():this.meetingRequest.changeMeetingFloor({disposition:Xg.RELEASED,personUrl:this.locusInfo.self.url,deviceUrl:this.deviceUrl,uri:r.url,resourceUrl:this.resourceUrl,shareInstanceId:this.localShareInstanceId}).catch((function(e){return pp.logger.error("Meeting:index#releaseScreenShareFloor --\x3e Error ",e),sp.sendBehavioralMetric(kb,{correlation_id:t.correlationId,locus_id:t.locusUrl.split("/").pop(),reason:e.message,stack:e.stack}),P().reject(e)}))):P().resolve())}},{key:"startRecording",value:function(){return this.recordingController.startRecording()}},{key:"setMuteOnEntry",value:function(e){return this.controlsOptionsManager.setMuteOnEntry(e)}},{key:"setDisallowUnmute",value:function(e){return this.controlsOptionsManager.setDisallowUnmute(e)}},{key:"setMuteAll",value:function(e,t,r){return this.controlsOptionsManager.setMuteAll(e,t,r)}},{key:"stopRecording",value:function(){return this.recordingController.stopRecording()}},{key:"pauseRecording",value:function(){return this.recordingController.pauseRecording()}},{key:"resumeRecording",value:function(){return this.recordingController.resumeRecording()}},{key:"lockMeeting",value:function(){return eb.lockMeeting(this.inMeetingActions,this.meetingRequest,this.locusUrl)}},{key:"unlockMeeting",value:function(){return eb.unlockMeeting(this.inMeetingActions,this.meetingRequest,this.locusUrl)}},{key:"rejectWithErrorLog",value:function(e){return pp.logger.error(e),P().reject(new Error(e))}},{key:"sendDTMF",value:function(e){return this.locusInfo&&this.locusInfo.self?this.locusInfo.self.enableDTMF?this.meetingRequest.sendDTMF({locusUrl:this.locusInfo.self.url,deviceUrl:this.deviceUrl,tones:e}):this.rejectWithErrorLog("Meeting:index#sendDTMF --\x3e cannot send DTMF, meeting does not have DTMF enabled"):this.rejectWithErrorLog('Meeting:index#sendDTMF --\x3e cannot send DTMF, meeting does not have a connection to the "locus" call control service. Have you joined?')}},{key:"changeVideoLayout",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.main,i=r.content,o=this.mediaProperties,s=o.mediaDirection,a=o.remoteShareStream,c=o.remoteVideoStream,u=Iy()(this.lastVideoLayoutInfo);if(!0!==s.receiveVideo||!c)return this.rejectWithErrorLog("Meeting:index#changeVideoLayout --\x3e cannot change video layout, you are not recieving any video/share stream");if(e){if(!_g.includes(e))return this.rejectWithErrorLog("Meeting:index#changeVideoLayout --\x3e cannot change video layout, invalid layoutType received.");u.layoutType=e}if(n){var l=Math.round(n.width),d=Math.round(n.height);(!this.lastVideoLayoutInfo.main||Math.abs(this.lastVideoLayoutInfo.main.height-d)>2||Math.abs(this.lastVideoLayoutInfo.main.width-l)>2)&&(u.main={width:l,height:d})}if(i){if(!this.mediaProperties.mediaDirection.receiveShare||!a)return this.rejectWithErrorLog("Meeting:index#changeVideoLayout --\x3e unable to send renderInfo for content, you are not receiving remote share");var h=Math.round(i.width),f=Math.round(i.height);(!this.lastVideoLayoutInfo.content||Math.abs(this.lastVideoLayoutInfo.content.height-f)>2||Math.abs(this.lastVideoLayoutInfo.content.width-h)>2)&&(u.content={width:h,height:f})}return zE()(u,this.lastVideoLayoutInfo)?P().resolve():(this.lastVideoLayoutInfo=Iy()(u),this.locusInfo.once(uv.EVENTS.CONTROLS_MEETING_LAYOUT_UPDATED,(function(e){Qv.trigger(t,{file:"meeting/index",function:"changeVideoLayout"},$g.MEETING_CONTROLS_LAYOUT_UPDATE,{layout:e.layout})})),this.meetingRequest.changeVideoLayoutDebounced({locusUrl:this.locusInfo.self.url,deviceUrl:this.deviceUrl,layoutType:e,main:u.main,content:u.content}).catch((function(e){return pp.logger.error("Meeting:index#changeVideoLayout --\x3e Error ",e),P().reject(e)})))}},{key:"setRemoteQualityLevel",value:function(e){return pp.logger.log("Meeting:index#setRemoteQualityLevel --\x3e Setting quality to ".concat(e)),Nv[e]?this.mediaProperties.mediaDirection.receiveAudio||this.mediaProperties.mediaDirection.receiveVideo?e===this.mediaProperties.remoteQualityLevel?(pp.logger.warn("Meeting:index#setRemoteQualityLevel --\x3e Quality already set to ".concat(e)),P().resolve()):(this.mediaProperties.setRemoteQualityLevel(e),this.updateTranscodedMediaConnection()):this.rejectWithErrorLog("Meeting:index#setRemoteQualityLevel --\x3e unable to change remote quality, receiveVideo and receiveAudio is disabled"):this.rejectWithErrorLog("Meeting:index#setRemoteQualityLevel --\x3e ".concat(e," not defined"))}},{key:"sendNetworkQualityEvent",value:function(e){Qv.trigger(this,{file:"meeting/index",function:"addMedia"},$g.NETWORK_QUALITY,{networkQualityScore:e.networkQualityScore,mediaType:e.mediaType})}},{key:"handleMediaLogging",value:function(e){eb.handleVideoLogging(e.videoStream),eb.handleAudioLogging(e.audioStream)}},{key:"getCurUserType",value:function(){var e=this.roles;if(e){if(e.includes(vv.MODERATOR))return"host";if(e.includes(vv.COHOST))return"cohost";if(e.includes(vv.PRESENTER))return"presenter";if(e.includes(vv.ATTENDEE))return"attendee"}return null}},{key:"endMeetingForAll",value:function(){var e=this;return this.webex.internal.newMetrics.submitClientEvent({name:"client.call.leave",payload:{trigger:"user-interaction",canProceed:!1},options:{meetingId:this.id}}),pp.logger.log("Meeting:index#endMeetingForAll --\x3e End meeting for All"),sp.sendBehavioralMetric(gb,{correlation_id:this.correlationId,locus_id:this.locusId}),eb.endMeetingForAll(this).then((function(t){return e.meetingFiniteStateMachine.end(),e.clearMeetingData(),Qv.trigger(e,{file:"meeting/index",function:"endMeetingForAll"},Jg.REQUEST_UPLOAD_LOGS,e),t})).catch((function(t){return e.meetingFiniteStateMachine.fail(t),pp.logger.error("Meeting:index#endMeetingForAll --\x3e Failed to end meeting ",t),Qv.trigger(e,{file:"meeting/index",function:"endMeetingForAll"},Jg.REQUEST_UPLOAD_LOGS,e),sp.sendBehavioralMetric(mb,{correlation_id:e.correlationId,locus_id:e.locusUrl.split("/").pop(),reason:t.message,stack:t.stack,code:t.code}),P().reject(t)}))}},{key:"sendReaction",value:function(e,t){var r,n,i,o=null===(r=this.locusInfo)||void 0===r||null===(n=r.controls)||void 0===n||null===(i=n.reactions)||void 0===i?void 0:i.reactionChannelUrl,s=this.members.selfId,a=F_[e];if(!a)return P().reject(new Error("".concat(e," is not a valid reaction.")));var c=j_[t]||j_.normal,u=mx(mx({},a),{},{tone:c});return o?this.meetingRequest.sendReaction({reactionChannelUrl:o,reaction:u,participantId:s}):P().reject(new Error("Error sending reaction, service url not found."))}},{key:"toggleReactions",value:function(e){var t,r,n,i=null===(t=this.locusInfo)||void 0===t||null===(r=t.controls)||void 0===r||null===(n=r.reactions)||void 0===n?void 0:n.enabled;return i&&e||!i&&!e?P().resolve("Reactions are already ".concat(i?"enabled":"disabled",".")):this.meetingRequest.toggleReactions({enable:e,locusUrl:this.locusUrl,requestingParticipantId:this.members.selfId})}},{key:"checkMediaConnection",value:function(){var e;if(null===(e=this.mediaProperties)||void 0===e||!e.webrtcMediaConnection)throw new Ly}},{key:"enableMusicMode",value:(s=(0,T.Z)(V().mark((function e(t){return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.checkMediaConnection(),this.isMultistream){e.next=3;break}throw new Error("enableMusicMode() only supported with multistream");case 3:if(!t){e.next=8;break}return e.next=6,this.sendSlotManager.setCodecParameters(Pn.AudioMain,{maxaveragebitrate:"64000",maxplaybackrate:"48000"});case 6:e.next=10;break;case 8:return e.next=10,this.sendSlotManager.deleteCodecParameters(Pn.AudioMain,["maxaveragebitrate","maxplaybackrate"]);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"updateTranscodedMediaConnection",value:function(){var e,t,r,n,i,o,s,a,c=this,u="Meeting:index#updateTranscodedMediaConnection --\x3e";return pp.logger.info("".concat(u," starting")),this.canUpdateMedia()?this.mediaProperties.webrtcMediaConnection.update({localTracks:{audio:(null===(e=this.mediaProperties.audioStream)||void 0===e||null===(t=e.outputStream)||void 0===t?void 0:t.getTracks()[0])||null,video:(null===(r=this.mediaProperties.videoStream)||void 0===r||null===(n=r.outputStream)||void 0===n?void 0:n.getTracks()[0])||null,screenShareVideo:(null===(i=this.mediaProperties.shareVideoStream)||void 0===i||null===(o=i.outputStream)||void 0===o?void 0:o.getTracks()[0])||null,screenShareAudio:(null===(s=this.mediaProperties.shareAudioStream)||void 0===s||null===(a=s.outputStream)||void 0===a?void 0:a.getTracks()[0])||null},direction:{audio:gy.getDirection(!0,this.mediaProperties.mediaDirection.receiveAudio,this.mediaProperties.mediaDirection.sendAudio),video:gy.getDirection(!0,this.mediaProperties.mediaDirection.receiveVideo,this.mediaProperties.mediaDirection.sendVideo),screenShareVideo:gy.getDirection(!1,this.mediaProperties.mediaDirection.receiveShare,this.mediaProperties.mediaDirection.sendShare)},remoteQualityLevel:this.mediaProperties.remoteQualityLevel}).then((function(){pp.logger.info("".concat(u," done"))})).catch((function(e){throw pp.logger.error("".concat(u," Error: "),e),sp.sendBehavioralMetric(Pb,{correlation_id:c.correlationId,locus_id:c.locusUrl.split("/").pop(),reason:e.message,stack:e.stack}),e})):this.enqueueMediaUpdate(yx)}},{key:"publishStream",value:(o=(0,T.Z)(V().mark((function e(t,r){return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:if(!this.mediaProperties.webrtcMediaConnection){e.next=7;break}if(!this.isMultistream||!this.mediaProperties.webrtcMediaConnection){e.next=6;break}return e.next=6,this.sendSlotManager.publishStream(t,r);case 6:this.emitPublishStateChangeEvent({isPublished:!0,mediaType:t,stream:r,functionName:"publishStream"});case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"unpublishStream",value:(i=(0,T.Z)(V().mark((function e(t,r){return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:if(!this.isMultistream||!this.mediaProperties.webrtcMediaConnection){e.next=5;break}return e.next=5,this.sendSlotManager.unpublishStream(t);case 5:this.emitPublishStateChangeEvent({isPublished:!1,mediaType:t,stream:r,functionName:"unpublishStream"});case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"publishStreams",value:(n=(0,T.Z)(V().mark((function e(t){var r,n,i,o,s,a;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.checkMediaConnection(),t.microphone||t.camera||null!==(r=t.screenShare)&&void 0!==r&&r.audio||null!==(n=t.screenShare)&&void 0!==n&&n.video){e.next=3;break}return e.abrupt("return");case 3:if(s=!1,!this.isMultistream||null===(i=t.screenShare)||void 0===i||!i.audio){e.next=8;break}return e.next=7,this.setLocalShareAudioStream(t.screenShare.audio);case 7:s=this.screenShareFloorState===wx.RELEASED;case 8:if(null===(o=t.screenShare)||void 0===o||!o.video){e.next=12;break}return e.next=11,this.setLocalShareVideoStream(null===(a=t.screenShare)||void 0===a?void 0:a.video);case 11:s=this.screenShareFloorState===wx.RELEASED;case 12:if(!t.microphone){e.next=15;break}return e.next=15,this.setLocalAudioStream(t.microphone);case 15:if(!t.camera){e.next=18;break}return e.next=18,this.setLocalVideoStream(t.camera);case 18:if(this.isMultistream){e.next=21;break}return e.next=21,this.updateTranscodedMediaConnection();case 21:if(!s){e.next=26;break}return this.localShareInstanceId=gp().v4(),this.webex.internal.newMetrics.submitClientEvent({name:"client.share.initiated",payload:{mediaType:"share",shareInstanceId:this.localShareInstanceId},options:{meetingId:this.id}}),e.next=26,this.enqueueScreenShareFloorRequest();case 26:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"unpublishStreams",value:(r=(0,T.Z)(V().mark((function e(t){var r,n,i,o;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.checkMediaConnection(),r=[],n=hx(t.filter((function(e){return!!e})));try{for(n.s();!(i=n.n()).done;)(o=i.value)===this.mediaProperties.shareAudioStream&&r.push(this.setLocalShareAudioStream(void 0)),o===this.mediaProperties.shareVideoStream&&r.push(this.setLocalShareVideoStream(void 0)),o===this.mediaProperties.audioStream&&r.push(this.setLocalAudioStream(void 0)),o===this.mediaProperties.videoStream&&r.push(this.setLocalVideoStream(void 0))}catch(e){n.e(e)}finally{n.f()}return this.isMultistream||r.push(this.updateTranscodedMediaConnection()),e.next=7,P().all(r);case 7:if(!this.mediaProperties.hasLocalShareStream())try{this.releaseScreenShareFloor()}catch(e){}case 8:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"getPermissionTokenExpiryInfo",value:function(){if(this.permissionTokenPayload){var e=Number(this.permissionTokenPayload.exp),t=Number(this.permissionTokenPayload.iat),r=this.permissionTokenReceivedLocalTime-t,n=(new Date).getTime();return{timeLeft:(e-(n-r))/1e3,expiryTime:e,currentTime:n}}}},{key:"checkAndRefreshPermissionToken",value:function(e,t){var r,n=null===(r=this.getPermissionTokenExpiryInfo())||void 0===r?void 0:r.timeLeft;return void 0!==n&&n<=e?this.refreshPermissionToken(t):P().resolve()}}],[{key:"handleDeviceLogging",value:(t=(0,T.Z)(V().mark((function e(){var t;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ht();case 3:t=e.sent,eb.handleDeviceLogging(t),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])}))),function(){return t.apply(this,arguments)})}]),j}(l.XR),_x={getClaimPmrLink:function(e){var t=Dg.test(e);return t?e:(t=e.match(Mg))?"".concat(t[4],"@").concat(t[2],".").concat(bg):null},getClaimPmrPin:function(e){return Ug.test(e)?e:null},getClaimedRequestParams:function(e,t,r){return{method:tv.POST,api:Hp,resource:"/".concat(Op,"/").concat(Np),body:{userId:r.userId,passcode:t,preferred:r.preferred,meetingAddress:e}}}};const Tx=_x;function xx(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var Ax=function(e){(0,A.Z)(r,e);var t=xx(r);function r(){var e;(0,k.Z)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,R.Z)((0,x.Z)(e),"namespace",pg),e}return(0,O.Z)(r,[{key:"claimPmr",value:function(e){if(!(e&&e.userId&&e.passcode&&e.meetingAddress&&e.preferred))throw new zv("Claiming a PMR should be done with userId, passcode, preferred, and meetingAddress in options.");var t=Tx.getClaimPmrPin(e.passcode);if(!t)return P().reject(new zv("The host pin provided was of an invalid format"));var r=Tx.getClaimPmrLink(e.meetingAddress);if(!r)return P().reject(new zv("The PMR link provided was of an invalid format"));var n=Tx.getClaimedRequestParams(r,t,e);return this.request(n)}}]),r}(l.XR);function Ix(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var Cx=function(e){(0,A.Z)(r,e);var t=Ix(r);function r(e,n){var i;return(0,k.Z)(this,r),i=t.call(this,{},n),(0,R.Z)((0,x.Z)(i),"link",void 0),(0,R.Z)((0,x.Z)(i),"meetingInfo",void 0),(0,R.Z)((0,x.Z)(i),"name",void 0),(0,R.Z)((0,x.Z)(i),"personalMeetingRoomRequest",void 0),(0,R.Z)((0,x.Z)(i),"pmr",void 0),(0,R.Z)((0,x.Z)(i),"sipUri",void 0),(0,R.Z)((0,x.Z)(i),"userId",void 0),(0,R.Z)((0,x.Z)(i),"meetingLink",void 0),(0,R.Z)((0,x.Z)(i),"number",void 0),(0,R.Z)((0,x.Z)(i),"namespace",pg),i.pmr=null,i.sipUri=null,i.link=null,i.userId=null,i.name=null,i.meetingInfo=e.meetingInfo,i.personalMeetingRoomRequest=new Ax({},n),i}return(0,O.Z)(r,[{key:"claim",value:function(e,t){var r=this,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i={userId:this.webex.internal.device.userId,passcode:t,meetingAddress:e,preferred:n};return this.personalMeetingRoomRequest.claimPmr(i).then((function(e){return e&&e.body?(r.set(e.body),e.body):P().reject(new zv("No PMR body provided. PMR values not updated."))}))}},{key:"set",value:function(e){this.pmr=e,this.sipUri=e.sipMeetingUri,this.meetingLink=e.webExMeetingLink||e.meetingLink,this.userId=e.owner,this.name=e.meetingName,this.number=e.meetingNumber}},{key:"get",value:function(){var e=this,t={type:Zm};return this.meetingInfo.fetchMeetingInfo(t).then((function(t){return t&&t.body&&t.body.isPmr?(e.set(t.body),t.body):P().reject(new TypeError("The PMR requested is NOT a PMR. PMR values not set."))}))}}]),r}(l.XR),Rx=r(66604),kx=r.n(Rx);const Ox=(0,O.Z)((function e(t){var r=this;(0,k.Z)(this,e),(0,R.Z)(this,"webex",void 0),(0,R.Z)(this,"getClusters",(function(e){return r.webex.request({method:tv.GET,shouldRefreshAccessToken:!1,api:Fg.CALLIOPEDISCOVERY,resource:Tv.CLUSTERS,qs:{JCSupport:1,ipver:e}}).then((function(t){var r=t.body,n=r.clusters,i=r.joinCookie;return U()(n).forEach((function(e){var r,i;n[e].isVideoMesh=!(null===(r=t.body.clusterClasses)||void 0===r||null===(i=r.hybridMedia)||void 0===i||!i.includes(e))})),pp.logger.log("Reachability:request#getClusters --\x3e get clusters (ipver=".concat(e,") successful:").concat(uy()(n))),{clusters:n,joinCookie:i}}))})),(0,R.Z)(this,"remoteSDPForClusters",(function(e){return r.webex.request({method:tv.POST,shouldRefreshAccessToken:!1,api:Fg.CALLIOPEDISCOVERY,resource:Tv.REACHABILITY,body:{offers:e}}).then((function(e){return pp.logger.log("Reachability:request#remoteSDPForClusters --\x3e Remote SDPs got succcessfully"),e.body}))})),this.webex=t}));function Nx(e,t){var r=new URL(e);if("stun:"!==r.protocol)throw new Error("Not a STUN URL: ".concat(e));return r.protocol="turn:","tcp"===t&&r.searchParams.append("transport","tcp"),r.toString()}var Px=function(){function e(t,r){(0,k.Z)(this,e),(0,R.Z)(this,"numUdpUrls",void 0),(0,R.Z)(this,"numTcpUrls",void 0),(0,R.Z)(this,"result",void 0),(0,R.Z)(this,"pc",void 0),(0,R.Z)(this,"defer",void 0),(0,R.Z)(this,"startTimestamp",void 0),(0,R.Z)(this,"isVideoMesh",void 0),(0,R.Z)(this,"name",void 0),this.name=t,this.isVideoMesh=r.isVideoMesh,this.numUdpUrls=r.udp.length,this.numTcpUrls=r.tcp.length,this.pc=this.createPeerConnection(r),this.defer=new bp.Defer,this.result={udp:{result:"untested"},tcp:{result:"untested"},xtls:{result:"untested"}}}var t;return(0,O.Z)(e,[{key:"getElapsedTime",value:function(){return Math.round(performance.now()-this.startTimestamp)}},{key:"buildPeerConnectionConfig",value:function(e){var t=e.udp.map((function(e){return{username:"",credential:"",urls:[e]}})),r=e.tcp.map((function(e){return{username:"webexturnreachuser",credential:"webexturnreachpwd",urls:[Nx(e,"tcp")]}}));return{iceServers:[].concat((0,_.Z)(t),(0,_.Z)(r)),iceCandidatePoolSize:0,iceTransportPolicy:"all"}}},{key:"createPeerConnection",value:function(e){try{var t=this.buildPeerConnectionConfig(e);return new RTCPeerConnection(t)}catch(e){return void pp.logger.warn("Reachability:index#createPeerConnection --\x3e Error creating peerConnection:",e)}}},{key:"getResult",value:function(){return this.result}},{key:"closePeerConnection",value:function(){this.pc&&(this.pc.onicecandidate=null,this.pc.onicegatheringstatechange=null,this.pc.close())}},{key:"finishReachabilityCheck",value:function(){this.defer.resolve()}},{key:"addPublicIP",value:function(e,t){var r=this.result[e];t&&(r.clientMediaIPs?r.clientMediaIPs.includes(t)||r.clientMediaIPs.push(t):r.clientMediaIPs=[t])}},{key:"registerIceGatheringStateChangeListener",value:function(){var e=this;this.pc.onicegatheringstatechange=function(){var t=rv.COMPLETE;e.pc.iceConnectionState===t&&(e.closePeerConnection(),e.finishReachabilityCheck())}}},{key:"haveWeGotAllResults",value:function(){var e=this;return["udp","tcp"].every((function(t){return"reachable"===e.result[t].result||"untested"===e.result[t].result}))}},{key:"storeLatencyResult",value:function(e,t){var r=this.result[e];void 0===r.latencyInMilliseconds&&(pp.logger.log("Reachability:index#storeLatencyResult --\x3e Successfully reached ".concat(this.name," over ").concat(e,": ").concat(t,"ms")),r.latencyInMilliseconds=t,r.result="reachable")}},{key:"registerIceCandidateListener",value:function(){var e=this;this.pc.onicecandidate=function(t){var r="srflx",n="relay";t.candidate&&(t.candidate.type===r&&(e.storeLatencyResult("udp",e.getElapsedTime()),e.addPublicIP("udp",t.candidate.address)),t.candidate.type===n&&e.storeLatencyResult("tcp",e.getElapsedTime()),e.haveWeGotAllResults()&&(e.closePeerConnection(),e.finishReachabilityCheck()))}}},{key:"start",value:(t=(0,T.Z)(V().mark((function e(){var t;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.pc){e.next=3;break}return pp.logger.warn("Reachability:ClusterReachability#start --\x3e Error: peerConnection is undefined"),e.abrupt("return",this.result);case 3:return this.result.udp={result:this.numUdpUrls>0?"unreachable":"untested"},this.result.tcp={result:this.numTcpUrls>0?"unreachable":"untested"},e.prev=5,e.next=8,this.pc.createOffer({offerToReceiveAudio:!0});case 8:return t=e.sent,this.startTimestamp=performance.now(),this.pc.setLocalDescription(t),e.next=13,this.gatherIceCandidates();case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),pp.logger.warn("Reachability:ClusterReachability#start --\x3e Error: ",e.t0);case 18:return e.abrupt("return",this.result);case 19:case"end":return e.stop()}}),e,this,[[5,15]])}))),function(){return t.apply(this,arguments)})},{key:"gatherIceCandidates",value:function(){var e=this,t=this.isVideoMesh?1e3:3e3;return this.registerIceGatheringStateChangeListener(),this.registerIceCandidateListener(),setTimeout((function(){var t=iv.CLOSED;e.pc.connectionState!==t&&(e.closePeerConnection(),e.finishReachabilityCheck())}),t),this.defer.promise}}]),e}(),Lx=function(){function e(t){(0,k.Z)(this,e),(0,R.Z)(this,"namespace",xv.namespace),(0,R.Z)(this,"webex",void 0),(0,R.Z)(this,"reachabilityRequest",void 0),(0,R.Z)(this,"clusterReachability",void 0),this.webex=t,this.reachabilityRequest=new Ox(this.webex),this.clusterReachability={}}var t,r,n,i,o;return(0,O.Z)(e,[{key:"gatherReachability",value:(o=(0,T.Z)(V().mark((function e(){var t,r,n,i;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.reachabilityRequest.getClusters(eb.getIpVersion(this.webex));case 3:return t=e.sent,r=t.clusters,n=t.joinCookie,e.next=8,this.performReachabilityChecks(r);case 8:return i=e.sent,e.next=11,this.webex.boundedStorage.put(this.namespace,xv.localStorageResult,uy()(i));case 11:return e.next=13,this.webex.boundedStorage.put(this.namespace,xv.localStorageJoinCookie,uy()(n));case 13:return pp.logger.log("Reachability:index#gatherReachability --\x3e Reachability checks completed"),e.abrupt("return",i);case 17:return e.prev=17,e.t0=e.catch(0),pp.logger.error("Reachability:index#gatherReachability --\x3e Error:",e.t0),e.abrupt("return",{});case 21:case"end":return e.stop()}}),e,this,[[0,17]])}))),function(){return o.apply(this,arguments)})},{key:"getReachabilityMetrics",value:(i=(0,T.Z)(V().mark((function e(){var t,r,n,i;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={reachability_public_udp_success:0,reachability_public_udp_failed:0,reachability_public_tcp_success:0,reachability_public_tcp_failed:0,reachability_vmn_udp_success:0,reachability_vmn_udp_failed:0,reachability_vmn_tcp_success:0,reachability_vmn_tcp_failed:0},r=function(e,r){if(r.udp&&"untested"!==r.udp.result){var n="reachable"===r.udp.result?"success":"failed";t["reachability_".concat(e,"_udp_").concat(n)]+=1}if(r.tcp&&"untested"!==r.tcp.result){var i="reachable"===r.tcp.result?"success":"failed";t["reachability_".concat(e,"_tcp_").concat(i)]+=1}},e.prev=2,e.next=5,this.webex.boundedStorage.get(xv.namespace,xv.localStorageResult);case 5:n=e.sent,i=JSON.parse(n),F()(i).forEach((function(e){r(e.isVideoMesh?"vmn":"public",e)})),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),pp.logger.warn("Roap:request#getReachabilityMetrics --\x3e Error parsing reachability data: ",e.t0);case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this,[[2,10]])}))),function(){return i.apply(this,arguments)})},{key:"mapTransportResultToBackendDataFormat",value:function(e){for(var t={},r=0,n=uS()(e);r<n.length;r++){var i=(0,xy.Z)(n[r],2),o=i[0],s=i[1];switch(o){case"result":switch(s){case"reachable":t.reachable="true";break;case"unreachable":t.reachable="false";break;case"untested":t.untested="true"}break;case"latencyInMilliseconds":t.latencyInMilliseconds=s.toString();break;default:t[o]=s}}return t}},{key:"getReachabilityResults",value:(n=(0,T.Z)(V().mark((function e(){var t,r,n,i=this;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.webex.boundedStorage.get(xv.namespace,xv.localStorageResult);case 3:r=e.sent,n=JSON.parse(r),t=kx()(n,(function(e){return{udp:i.mapTransportResultToBackendDataFormat(e.udp||{result:"untested"}),tcp:i.mapTransportResultToBackendDataFormat(e.tcp||{result:"untested"}),xtls:i.mapTransportResultToBackendDataFormat(e.xtls||{result:"untested"})}})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),pp.logger.warn("Roap:request#attachReachabilityData --\x3e Error parsing reachability data: ",e.t0);case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return n.apply(this,arguments)})},{key:"isAnyPublicClusterReachable",value:(r=(0,T.Z)(V().mark((function e(){var t,r,n;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,e.next=3,this.webex.boundedStorage.get(this.namespace,xv.localStorageResult).catch((function(){}));case 3:if(r=e.sent)try{n=JSON.parse(r),t=F()(n).some((function(e){var t,r;return!e.isVideoMesh&&("reachable"===(null===(t=e.udp)||void 0===t?void 0:t.result)||"reachable"===(null===(r=e.tcp)||void 0===r?void 0:r.result))}))}catch(e){pp.logger.error("Roap:request#attachReachabilityData --\x3e Error in parsing reachability data: ".concat(e))}return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"getUnreachableClusters",value:function(){var e=[];return uS()(this.clusterReachability).forEach((function(t){var r=(0,xy.Z)(t,2),n=r[0],i=r[1].getResult();"unreachable"===i.udp.result&&e.push({name:n,protocol:"udp"}),"unreachable"===i.tcp.result&&e.push({name:n,protocol:"tcp"})})),e}},{key:"logUnreachableClusters",value:function(){this.getUnreachableClusters().forEach((function(e){var t=e.name,r=e.protocol;pp.logger.log("Reachability:index#logUnreachableClusters --\x3e failed to reach ".concat(t," over ").concat(r))}))}},{key:"performReachabilityChecks",value:(t=(0,T.Z)(V().mark((function e(t){var r,n,i=this;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={},t&&U()(t).length){e.next=3;break}return e.abrupt("return",P().resolve(r));case 3:return pp.logger.log("Reachability:index#performReachabilityChecks --\x3e doing UDP".concat(this.webex.config.meetings.experimental.enableTcpReachability?" and TCP":""," reachability checks")),n=U()(t).map((function(e){var n=t[e];return i.webex.config.meetings.experimental.enableTcpReachability&&!n.isVideoMesh||(n.tcp=[]),i.clusterReachability[e]=new Px(e,n),i.clusterReachability[e].start().then((function(t){r[e]=t,r[e].isVideoMesh=n.isVideoMesh}))})),e.next=7,P().all(n);case 7:return this.logUnreachableClusters(),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();function Dx(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var Mx=function(e){(0,A.Z)(r,e);var t=Dx(r);function r(){return(0,k.Z)(this,r),t.apply(this,arguments)}return(0,O.Z)(r,[{key:"getActiveMeetings",value:function(){var e=this;return this.request({api:Fg.LOCUS,resource:Tv.LOCI}).then((function(t){return e.determineRedirections(t.body)})).catch((function(e){throw pp.logger.error("Meetings:request#getActiveMeetings --\x3e failed to get locus details, ".concat(e)),new Error(e)}))}},{key:"fetchGeoHint",value:function(){return this.webex.internal.services.fetchClientRegionInfo()}},{key:"getMeetingPreferences",value:function(){return this.webex.internal.services.getMeetingPreferences()}},{key:"determineRedirections",value:function(e){var t=this;return e.remoteLocusClusterUrls&&e.remoteLocusClusterUrls.length?P().all(e.remoteLocusClusterUrls.map((function(r){return t.request({method:tv.GET,url:r,runWhitelistedDomains:!0}).then((function(t){return e.loci=e.loci.concat(t.body.loci),e.locusUrls=e.locusUrls.concat(t.body.locusUrls),P().resolve(e)})).catch((function(e){throw pp.logger.error("Meetings:request#determineRedirections --\x3e failed to get locus details from url: ".concat(r,", reason: ").concat(e)),new Error(e)}))}))).then((function(){return P().resolve(e)})):P().resolve(e)}}]),r}(l.XR);function Ux(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var Bx=function(e){(0,A.Z)(r,e);var t=Ux(r);function r(){return(0,k.Z)(this,r),t.call(this,"meetings")}return(0,O.Z)(r,[{key:"set",value:function(e){return this.meetings[e.id]=e,this.meetings[e.id]}},{key:"getByKey",value:function(e,t){return e&&t?dE()(this.meetings,(function(r){return r[e]===t})):null}},{key:"getActiveBreakoutLocus",value:function(e){return e?dE()(this.meetings,(function(t){var r,n;return(null===(r=t.breakouts)||void 0===r?void 0:r.url)===e&&(null===(n=t.breakouts)||void 0===n?void 0:n.isActiveBreakout)})):null}},{key:"getActiveWebrtcMeeting",value:function(){return dE()(this.meetings,(function(e){return e.mediaProperties.webrtcMediaConnection}))}}]),r}(pE);function Fx(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var jx,Vx=function(e){(0,A.Z)(r,e);var t=Fx(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qg.NO_MEETING_INFO.MESSAGE,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,k.Z)(this,r),e=t.call(this,n),(0,R.Z)((0,x.Z)(e),"code",void 0),(0,R.Z)((0,x.Z)(e),"error",void 0),(0,R.Z)((0,x.Z)(e),"sdkMessage",void 0),e.name=Qg.NO_MEETING_INFO.NAME,e.sdkMessage=Qg.NO_MEETING_INFO.MESSAGE,e.error=i,e.stack=i?i.stack:(new Error).stack,e.code=Qg.NO_MEETING_INFO.CODE,e}return(0,O.Z)(r)}((0,yp.Z)(Error));function Hx(e,t){var r=U()(e);if(p()){var n=p()(e);t&&(n=n.filter((function(t){return g()(e,t).enumerable}))),r.push.apply(r,n)}return r}function Gx(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Hx(Object(r),!0).forEach((function(t){(0,R.Z)(e,t,r[t])})):y()?E()(e,y()(r)):Hx(Object(r)).forEach((function(t){S()(e,t,g()(r,t))}))}return e}function qx(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var $x=function(){function e(){(0,k.Z)(this,e)}return(0,O.Z)(e,[{key:"info",value:function(){var e;(e=pp.logger).info.apply(e,arguments)}},{key:"log",value:function(){var e;(e=pp.logger).log.apply(e,arguments)}},{key:"error",value:function(){var e;(e=pp.logger).error.apply(e,arguments)}},{key:"warn",value:function(){var e;(e=pp.logger).warn.apply(e,arguments)}},{key:"trace",value:function(){var e;(e=pp.logger).trace.apply(e,arguments)}},{key:"debug",value:function(){var e;(e=pp.logger).debug.apply(e,arguments)}}]),e}(),Zx=function(e){(0,A.Z)(i,e);var t,r=qx(i);function i(){var e;(0,k.Z)(this,i);for(var t=arguments.length,o=new Array(t),s=0;s<t;s++)o[s]=arguments[s];return e=r.call.apply(r,[this].concat(o)),(0,R.Z)((0,x.Z)(e),"loggerRequest",void 0),(0,R.Z)((0,x.Z)(e),"media",void 0),(0,R.Z)((0,x.Z)(e),"meetingCollection",void 0),(0,R.Z)((0,x.Z)(e),"personalMeetingRoom",void 0),(0,R.Z)((0,x.Z)(e),"preferredWebexSite",void 0),(0,R.Z)((0,x.Z)(e),"reachability",void 0),(0,R.Z)((0,x.Z)(e),"registered",void 0),(0,R.Z)((0,x.Z)(e),"request",void 0),(0,R.Z)((0,x.Z)(e),"geoHintInfo",void 0),(0,R.Z)((0,x.Z)(e),"meetingInfo",void 0),(0,R.Z)((0,x.Z)(e),"mediaHelpers",void 0),(0,R.Z)((0,x.Z)(e),"breakoutLocusForHandleLater",void 0),(0,R.Z)((0,x.Z)(e),"namespace",pg),(0,R.Z)((0,x.Z)(e),"createNoiseReductionEffect",function(){var t=(0,T.Z)(V().mark((function t(r){var n;return V().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.webex.credentials.supertoken.access_token,t.abrupt("return",new Xh.ET(Gx({authToken:n},r)));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),(0,R.Z)((0,x.Z)(e),"createVirtualBackgroundEffect",function(){var t=(0,T.Z)(V().mark((function t(r){var n;return V().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.webex.credentials.supertoken.access_token,t.abrupt("return",new Xh.FW(Gx({authToken:n},r)));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.mediaHelpers=n,e.request=new Mx({},{parent:e.webex}),e.loggerRequest=new vp({webex:e.webex}),e.meetingCollection=new Bx,e.personalMeetingRoom=null,e.reachability=new Lx(e.webex),e.registered=!1,e.preferredWebexSite="",e.media={getUserMedia:gy.getUserMedia},e.onReady(),e}return(0,O.Z)(i,[{key:"isNeedHandleMainLocus",value:function(e,t){var r,n,i,o,s,a,c,u=null===(r=t.controls)||void 0===r||null===(n=r.breakout)||void 0===n?void 0:n.url,l=this.meetingCollection.getActiveBreakoutLocus(u),d=(null==t||null===(i=t.self)||void 0===i?void 0:i.state)===Lm,h=(null==t||null===(o=t.self)||void 0===o?void 0:o.state)===Mm&&(null==t||null===(s=t.self)||void 0===s?void 0:s.reason)===Um,f=R_.getThisDevice(t,this.webex.internal.device.url),p=(null==f?void 0:f.state)===Mm&&(null==f?void 0:f.reason)===Um,m=R_.joinedOnThisDevice(e,t,this.webex.internal.device.url),g=(null==l||null===(a=l.joinedWith)||void 0===a?void 0:a.correlationId)&&l.joinedWith.correlationId===(null==e?void 0:e.correlationId);if(d&&m){if(pp.logger.log("Meetings:index#isNeedHandleMainLocus --\x3e self this device shown as JOINED in the main session"),null!=l&&l.joinedWith&&f){var v,y,b=(null===(v=l.joinedWith.replaces)||void 0===v?void 0:v.length)>0?l.joinedWith.replaces[0].replaceAt:"",E=(null===(y=f.replaces)||void 0===y?void 0:y.length)>0?f.replaces[0].replaceAt:"";if(b&&E&&b>E)return pp.logger.log("Meetings:index#isNeedHandleMainLocus --\x3e this is expired main joined status locus_dto replacedAt ".concat(E," bo replacedAt ").concat(b)),!1}return!0}return g?(pp.logger.log("Meetings:index#isNeedHandleMainLocus --\x3e there is active breakout session and joined on this device, and don't need to handle main session: ".concat(u)),!1):h&&(null!=t&&null!==(c=t.self)&&void 0!==c&&c.removed||p)?(pp.logger.log("Meetings:index#isNeedHandleMainLocus --\x3e self moved main locus with self removed status or with device resource moved, not need to handle"),!1):d&&p?(pp.logger.log("Meetings:index#isNeedHandleMainLocus --\x3e self device left&moved in main locus with self joined status, not need to handle"),!1):(pp.logger.log("Meetings:index#isNeedHandleMainLocus --\x3e this is a normal main session locusDTO update case"),!0)}},{key:"isNeedHandleLocusDTO",value:function(e,t){if(t){var r,n,i,o,s=R_.isBreakoutLocusDTO(t),a=(null==t||null===(r=t.self)||void 0===r?void 0:r.state)===Mm&&(null==t||null===(n=t.self)||void 0===n?void 0:n.reason)===Um;return e?s?!a:this.isNeedHandleMainLocus(e,t):s?(pp.logger.log("Meetings:index#isNeedHandleLocusDTO --\x3e the first breakout session locusDTO active status: ".concat(null===(i=t.fullState)||void 0===i?void 0:i.active)),(null===(o=t.self)||void 0===o?void 0:o.state)===Lm):this.isNeedHandleMainLocus(e,t)}return!0}},{key:"getCorrespondingMeetingByLocus",value:function(e){var t,r,n;return this.meetingCollection.getByKey(Wp,e.locusUrl)||this.meetingCollection.getByKey(Ap,R_.checkForCorrelationId(this.webex.internal.device.url,e.locus))||this.meetingCollection.getByKey(fm,e.locus.self&&e.locus.self.callbackInfo&&e.locus.self.callbackInfo.callbackAddress)||(null!==(t=e.locus.info)&&void 0!==t&&t.isUnifiedSpaceMeeting?void 0:this.meetingCollection.getByKey(Cp,e.locus.conversationUrl))||this.meetingCollection.getByKey(Ip,null===(r=e.locus)||void 0===r||null===(n=r.info)||void 0===n?void 0:n.webExMeetingId)}},{key:"handleLocusEvent",value:function(e){var t,r,n=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this.getCorrespondingMeetingByLocus(e);if(!o&&(null===(t=e.locus)||void 0===t||null===(r=t.replaces)||void 0===r?void 0:r.length)>0&&(o=this.meetingCollection.getByKey(Wp,e.locus.replaces[e.locus.replaces.length-1].locusUrl)),o&&!R_.isBreakoutLocusDTO(e.locus)&&o.locusInfo.updateMainSessionLocusCache(e.locus),this.isNeedHandleLocusDTO(o,e.locus))if(o)o.locusInfo.parse(o,e);else{if(e.locus&&e.locus.fullState&&e.locus.fullState.state===ov.STATE.INACTIVE)return void pp.logger.warn("Meetings:index#handleLocusEvent --\x3e Locus event received for meeting, after it was ended.");if(e.locus&&e.locus.self&&e.locus.self.state===Mm&&!0===e.locus.self.removed)return void pp.logger.warn("Meetings:index#handleLocusEvent --\x3e Locus event received for meeting, after it was ended.");this.create(e.locus,Dm,i).then((function(t){(o=t).locusInfo.initialSetup(e.locus),n.checkHandleBreakoutLocus(e.locus)})).catch((function(e){pp.logger.error(e)})).finally((function(){n.getMeetingByType(Nm,o.id)?(n.webex.internal.newMetrics.submitClientEvent({name:"client.call.remote-started",payload:{trigger:"mercury-event"},options:{meetingId:o.id}}),Qv.trigger(n,{file:"meetings",function:"handleLocusEvent"},$g.MEETING_ADDED,{meeting:o,type:o.type===jm?Pm:km})):pp.logger.warn("Meetings:index#handleLocusEvent --\x3e Created and destroyed meeting object before sending an event")}))}else pp.logger.log("Meetings:index#handleLocusEvent --\x3e doesn't need to process locus event")}},{key:"handleLocusMercury",value:function(e){var t=e.data,r=t.eventType;r&&r!==lv.MESSAGE_ROAP&&this.handleLocusEvent(t,!0)}},{key:"handleMercuryOffline",value:function(){Qv.trigger(this,{file:"meetings/index",function:"handleMercuryOffline"},$g.MEETINGS_NETWORK_DISCONNECTED)}},{key:"listenForEvents",value:function(){var e=this;this.webex.internal.mercury.on(lv.LOCUS_MERCURY,(function(t){e.handleLocusMercury(t)})),this.webex.internal.mercury.on(Av.ROAP_MERCURY,(function(t){R_.handleRoapMercury(t,e.meetingCollection)})),this.webex.internal.mercury.on(om,(function(){e.syncMeetings({keepOnlyLocusMeetings:!1})})),this.webex.internal.mercury.on(im,(function(){e.handleMercuryOffline()}))}},{key:"stopListeningForEvents",value:function(){this.webex.internal.mercury.off(lv.LOCUS_MERCURY),this.webex.internal.mercury.off(Av.ROAP_MERCURY),this.webex.internal.mercury.off(om)}},{key:"onReady",value:function(){var e=this;this.webex.once(lm,(function(){hp.set(e.config),cp.set(e.config.logging),pp.set(e.webex.logger),jx=new $x,za=jx||Za,Wa(),e.meetingInfo=e.config.experimental.enableUnifiedMeetings?new HE(e.webex):new xE(e.webex),e.personalMeetingRoom=new Cx({meetingInfo:e.meetingInfo},{parent:e.webex}),Qv.trigger(e,{file:"meetings",function:"onReady"},$g.MEETINGS_READY),R_.checkH264Support({disableNotifications:!0}),sp.initialSetup(e.webex)}))}},{key:"_toggleUnifiedMeetings",value:function(e){var t,r;"boolean"==typeof e&&(null===(t=this.config)||void 0===t||null===(r=t.experimental)||void 0===r?void 0:r.enableUnifiedMeetings)!==e&&(this.config.experimental.enableUnifiedMeetings=e,this.meetingInfo=e?new HE(this.webex):new xE(this.webex))}},{key:"_toggleAdhocMeetings",value:function(e){var t,r;"boolean"==typeof e&&(null===(t=this.config)||void 0===t||null===(r=t.experimental)||void 0===r?void 0:r.enableAdhocMeetings)!==e&&(this.config.experimental.enableAdhocMeetings=e)}},{key:"_toggleTcpReachability",value:function(e){"boolean"==typeof e&&this.config.experimental.enableTcpReachability!==e&&(this.config.experimental.enableTcpReachability=e)}},{key:"register",value:function(){var e=this;return sp.sendBehavioralMetric(nb,{step:"[sdk] begin registration"}),this.webex.canAuthorize?this.registered?(pp.logger.info("Meetings:index#register --\x3e INFO, Meetings plugin already registered"),sp.sendBehavioralMetric(nb,{step:"[sdk] already registered"}),P().resolve()):(sp.sendBehavioralMetric(nb,{step:"[sdk] begin Promise.all()"}),P().all([this.fetchUserPreferredWebexSite(),this.getGeoHint(),this.startReachability().catch((function(e){pp.logger.error("Meetings:index#register --\x3e GDM error, ".concat(e.message))})),this.webex.internal.device.register().then((function(){return pp.logger.info("Meetings:index#register --\x3e INFO, Device registered ".concat(e.webex.internal.device.url))})).then((function(){return e.webex.internal.mercury.connect()})),R_.checkH264Support.call(this)]).then((function(){sp.sendBehavioralMetric(nb,{step:"[sdk] end Promise.all()"}),e.listenForEvents(),Qv.trigger(e,{file:"meetings",function:"register"},$g.MEETINGS_REGISTERED),sp.sendBehavioralMetric(nb,{step:"[sdk] registration complete, triggered MEETINGS_REGISTERED event"}),e.registered=!0,sp.sendBehavioralMetric(rb)})).catch((function(e){return pp.logger.error("Meetings:index#register --\x3e ERROR, Unable to register, ".concat(e.message)),sp.sendBehavioralMetric(tb,{reason:e.message,stack:e.stack}),P().reject(e)}))):(pp.logger.error("Meetings:index#register --\x3e ERROR, Unable to register, SDK cannot authorize"),sp.sendBehavioralMetric(nb,{step:"[sdk] cannot authorize"}),P().reject(new Error("SDK cannot authorize")))}},{key:"unregister",value:function(){var e=this;return this.registered?(this.stopListeningForEvents(),this.webex.internal.mercury.disconnect().then((function(){return e.webex.internal.device.unregister()})).then((function(){Qv.trigger(e,{file:"meetings",function:"unregister"},$g.MEETINGS_UNREGISTERED),e.registered=!1}))):(pp.logger.info("Meetings:index#unregister --\x3e INFO, Meetings plugin already unregistered"),P().resolve())}},{key:"uploadLogs",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return pp.logger.info("Meetings:index#uploadLogs --\x3e uploading logs"),this.loggerRequest.uploadLogs(t).then((function(r){return pp.logger.info("Meetings:index#uploadLogs --\x3e Upload logs for meeting completed.",r),sp.sendBehavioralMetric(Vb,t),Qv.trigger(e,{file:"meetings",function:"uploadLogs"},$g.MEETING_LOG_UPLOAD_SUCCESS,{meetingId:t.meetingId,details:r}),r})).catch((function(r){pp.logger.error("Meetings:index#uploadLogs --\x3e Unable to upload logs for meeting",r),Qv.trigger(e,{file:"meetings",function:"uploadLogs"},$g.MEETING_LOG_UPLOAD_FAILURE,{meetingId:t.meetingId,reason:r}),sp.sendBehavioralMetric(jb,Gx(Gx({},t),{},{reason:r.message,stack:r.stack,code:r.code}))}))}},{key:"getReachability",value:function(){return this.reachability}},{key:"startReachability",value:function(){return this.getReachability().gatherReachability()}},{key:"getGeoHint",value:function(){var e=this;return this.request.fetchGeoHint().then((function(t){e.geoHintInfo=t}))}},{key:"fetchUserPreferredWebexSite",value:function(){var e=this;return this.request.getMeetingPreferences().then((function(t){return t&&(e.preferredWebexSite=R_.parseDefaultSiteFromMeetingPreferences(t)),e.preferredWebexSite?P().resolve():e.webex.internal.user.get().then((function(t){var r,n,i=null==t||null===(r=t.userPreferences)||void 0===r||null===(n=r.userPreferencesItems)||void 0===n?void 0:n.preferredWebExSite;if(!i)throw new Error("site not found");e.preferredWebexSite=i})).catch((function(){pp.logger.error("Failed to fetch preferred site from user - no site will be set")}))}))}},{key:"getPersonalMeetingRoom",value:function(){return this.personalMeetingRoom}},{key:"destroy",value:function(e,t){eb.cleanUp(e),this.meetingCollection.delete(e.id),Qv.trigger(this,{file:"meetings",function:"destroy"},$g.MEETING_REMOVED,{meetingId:e.id,reason:t})}},{key:"create",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:void 0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:void 0;return o&&(a=Gx(Gx({},a||{}),{},{correlationId:o})),this.meetingInfo.fetchInfoOptions(e,r).catch((function(e){if(pp.logger.error("Meetings:index#create --\x3e ERROR, unable to determine info options: ".concat(e.message)),e instanceof My)throw new My})).then((function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=o.destination||e,d=null;if(r===Tm||o.type===Tm){var h=t.meetingCollection.getByKey(Cp,l);if(h)!h.locusInfo.scheduledMeeting&&(d=h)}return d||(d=t.meetingCollection.getByKey(fm,l)),d?(d.setCallStateForMetrics(a),P().resolve(d)):t.createMeeting(l,r,n,i,a,s,c,u).then((function(e){return e&&e.on?(e.on(Jg.DESTROY_MEETING,(function(r){var n,i,o,s,a,c;t.config.autoUploadLogs?t.uploadLogs({callStart:null===(n=e.locusInfo)||void 0===n||null===(i=n.fullState)||void 0===i?void 0:i.lastActive,locussessionid:null===(o=e.locusInfo)||void 0===o||null===(s=o.fullState)||void 0===s?void 0:s.sessionId,correlationId:e.correlationId,feedbackId:e.correlationId,locusId:e.locusId,meetingId:null===(a=e.locusInfo)||void 0===a||null===(c=a.info)||void 0===c?void 0:c.webExMeetingId,autoupload:!0}).then((function(){return t.destroy(e,r.reason)})):t.destroy(e,r.reason)})),e.on(Jg.REQUEST_UPLOAD_LOGS,(function(e){var r,n,i,o,s,a;t.config.autoUploadLogs&&t.uploadLogs({callStart:null==e||null===(r=e.locusInfo)||void 0===r||null===(n=r.fullState)||void 0===n?void 0:n.lastActive,locussessionid:null==e||null===(i=e.locusInfo)||void 0===i||null===(o=i.fullState)||void 0===o?void 0:o.sessionId,correlationId:e.correlationId,feedbackId:e.correlationId,locusId:e.locusId,meetingId:null===(s=e.locusInfo)||void 0===s||null===(a=s.info)||void 0===a?void 0:a.webExMeetingId,autoupload:!0})}))):pp.logger.error("Meetings:index#create --\x3e ERROR, meeting does not have on method, will not be destroyed, meeting cleanup impossible for meeting: ".concat(d)),P().resolve(e)}))}))}},{key:"createMeeting",value:(t=(0,T.Z)(V().mark((function e(t){var r,n,i,o,s,a,c,u,l,d,h,f,p,m,g,v,y,b,E,w=arguments;return V().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=w.length>1&&void 0!==w[1]?w[1]:null,n=w.length>2&&void 0!==w[2]&&w[2],i=w.length>3&&void 0!==w[3]?w[3]:{},o=w.length>4&&void 0!==w[4]?w[4]:void 0,s=w.length>5&&void 0!==w[5]&&w[5],a=w.length>6&&void 0!==w[6]?w[6]:void 0,c=w.length>7&&void 0!==w[7]?w[7]:void 0,u=new Sx({userId:this.webex.internal.device.userId,deviceUrl:this.webex.internal.device.url,orgId:this.webex.internal.device.orgId,locus:r===Dm?t:null,meetingInfoProvider:this.meetingInfo,destination:t,destinationType:r,callStateForMetrics:o},{parent:this.webex}),this.meetingCollection.set(u),e.prev=9,d=0,t.meeting&&(h=t.meeting.startTime,f=new Date(h),p=f.getTime(),m=p-D()(),g=Math.max(Math.min(m,Yp),0),d=Math.round(Math.random()*g)),v=!(null===(l=t.fullState)||void 0===l||!l.active),y=this.config.experimental.enableUnifiedMeetings,b={extraParams:i,sendCAevents:!(null==o||!o.correlationId)},!a){e.next=19;break}u.injectMeetingInfo(a,b,c),e.next=26;break;case 19:if(!(y&&!v&&n&&d>0)){e.next=24;break}u.fetchMeetingInfoTimeoutId=setTimeout((function(){return u.fetchMeetingInfo(b)}),d),u.parseMeetingInfo(void 0,t),e.next=26;break;case 24:return e.next=26,u.fetchMeetingInfo(b);case 26:e.next=38;break;case 28:if(e.prev=28,e.t0=e.catch(9),e.t0 instanceof Ky||e.t0 instanceof Zy||e.t0 instanceof qy){e.next=37;break}if(pp.logger.info("Meetings:index#createMeeting --\x3e Info Unable to fetch meeting info for ".concat(t,".")),!s){e.next=36;break}throw pp.logger.info("Meetings:index#createMeeting --\x3e Destroying meeting due to missing meeting info."),this.destroy(u,zg.MISSING_MEETING_INFO),new Vx;case 36:pp.logger.info("Meetings:index#createMeeting --\x3e Info assuming this destination is a 1:1 or wireless share");case 37:pp.logger.debug("Meetings:index#createMeeting --\x3e Debug ".concat(e.t0," fetching /meetingInfo for creation."));case 38:return e.prev=38,r!==Dm&&(u.sipUri||u.setSipUri(t),E=R_.getMeetingAddedType(r),Qv.trigger(this,{file:"meetings",function:"createMeeting"},$g.MEETING_ADDED,{meeting:u,type:E})),e.finish(38);case 41:return e.abrupt("return",u);case 42:case"end":return e.stop()}}),e,this,[[9,28,38,41]])}))),function(e){return t.apply(this,arguments)})},{key:"getMeetingByType",value:function(e,t){return this.meetingCollection.getByKey(e,t)}},{key:"getAllMeetings",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.meetingCollection.getAll(e)}},{key:"syncMeetings",value:function(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).keepOnlyLocusMeetings,r=void 0===t||t;return this.request.getActiveMeetings().then((function(t){var n=[];null!=t&&t.loci&&t.loci.length>0&&e.sortLocusArrayToUpdate(t.loci).forEach((function(t){n.push(t.url),e.handleLocusEvent({locus:t,locusUrl:t.url})}));var i=e.meetingCollection.getAll();if(U()(i).length>0)for(var o=0,s=F()(i);o<s.length;o++){var a=s[o],c=a.locusUrl;!r&&!c||n.includes(c)||e.destroy(a,zg.NO_MEETINGS_TO_SYNC)}})).catch((function(e){throw pp.logger.error("Meetings:index#syncMeetings --\x3e failed to sync meetings, ".concat(e)),new Error(e)}))}},{key:"sortLocusArrayToUpdate",value:function(e){var t=this,r=e.filter((function(e){return!R_.isBreakoutLocusDTO(e)})),n=e.filter((function(e){return R_.isValidBreakoutLocus(e)}));this.breakoutLocusForHandleLater=[];var i=(0,_.Z)(r);return n.forEach((function(e){var n=r.find((function(t){var r,n,i,o;return(null===(r=t.controls)||void 0===r||null===(n=r.breakout)||void 0===n?void 0:n.url)===(null===(i=e.controls)||void 0===i||null===(o=i.breakout)||void 0===o?void 0:o.url)})),o=t.getCorrespondingMeetingByLocus({locus:e,locusUrl:e.url});n&&!o?t.breakoutLocusForHandleLater.push(e):i.push(e)})),i}},{key:"checkHandleBreakoutLocus",value:function(e){if(e&&this.breakoutLocusForHandleLater&&this.breakoutLocusForHandleLater.length&&!R_.isBreakoutLocusDTO(e)){var t=this.breakoutLocusForHandleLater.findIndex((function(t){var r,n,i,o;return(null===(r=t.controls)||void 0===r||null===(n=r.breakout)||void 0===n?void 0:n.url)===(null===(i=e.controls)||void 0===i||null===(o=i.breakout)||void 0===o?void 0:o.url)}));if(!(t<0)){var r=this.breakoutLocusForHandleLater[t];this.handleLocusEvent({locus:r,locusUrl:r.url}),this.breakoutLocusForHandleLater.splice(t,1)}}}},{key:"getScheduledMeetings",value:function(){return this.meetingCollection.getAll({scheduled:!0})}},{key:"getLogger",value:function(){return pp.get()}},{key:"getActiveWebrtcMeeting",value:function(){return this.meetingCollection.getActiveWebrtcMeeting()}}]),i}(l._y),zx=r(18338);function Kx(e){var t=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(h()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,C.Z)(e);if(t){var i=(0,C.Z)(this).constructor;r=h()(n,arguments,i)}else r=n.apply(this,arguments);return(0,I.Z)(this,r)}}var Wx=new($_()),Jx=function(e){(0,A.Z)(r,e);var t=Kx(r);function r(){return(0,k.Z)(this,r),t.apply(this,arguments)}return(0,O.Z)(r,[{key:"onResponseError",value:function(e,t){if((503===t.statusCode||429===t.statusCode)&&e.uri.includes("locus")){var r=Wx.get(this),n=e.headers["retry-after"]||2e3;return r?(Wx.set(this,!1),P().reject(e)):(Wx.set(this,!0),this.handleRetryRequestLocusServiceError(e,n))}return P().reject(t)}},{key:"handleRetryRequestLocusServiceError",value:function(e,t){var r=this;return new(P())((function(n,i){var o=setTimeout((function(){clearTimeout(o),r.webex.request({method:e.method,uri:e.uri,body:e.body}).then(n).catch(i)}),t)}))}}],[{key:"create",value:function(){return new r({webex:this})}}]),r}(zx.nK);(0,l.fo)("meetings",Zx,{config:Xv,interceptors:{LocusRetryStatusInterceptor:Jx.create}});const Yx=Zx},16023:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var n=r(47683),i=r(2313),o=r(73473),s=r.n(o),a=r(78149),c=r.n(a),u=r(95366),l=r.n(u),d=r(18408);const h=n.mr.extend({namespace:"People",handleHttpSuccess:function(e){var t=this,r=e.body.items.map((function(e){return t.handleItemSuccess(e.id,e)}));return e.body.notFoundIds&&r.concat(e.body.notFoundIds.map((function(e){return t.handleItemFailure(e)}))),s().all(r)},handleItemFailure:function(e){return this.getDeferredForResponse(e).then((function(t){t.reject(e)}))},handleItemSuccess:function(e,t){return this.getDeferredForResponse(e).then((function(e){e.resolve(t)}))},fingerprintRequest:function(e){var t=this.webex.people.inferPersonIdFromUuid(e);return s().resolve(t)},fingerprintResponse:function(e){return s().resolve(e)},prepareRequest:function(e){return s().resolve(e.join())},submitHttpRequest:function(e){return this.webex.request({service:"hydra",resource:"people/?id=".concat(e,"&showAllTypes=").concat(this.config.showAllTypes)})}});var f;const p=n._y.extend((f={namespace:"People",children:{batcher:h},get:function(e){if(!e)return s().reject(new Error("A person with an id is required"));if("me"===e)return this._getMe();var t=e.personId||e.id||e;return this.batcher.request(t)},list:function(e){var t=this;if(c()(e)){var r=e;return s().all(r.map((function(e){return t.batcher.request(e)})))}return this.request({service:"hydra",resource:"people",qs:e}).then((function(e){return new n.T3(e,t.webex)}))},inferPersonIdFromUuid:function(e){try{if(d.base64.decode(e).includes("ciscospark://"))return e}catch(e){}return d.base64.encode("ciscospark://us/PEOPLE/".concat(e))},_getMe:function(){return this.webex.request({service:"hydra",resource:"people/me"}).then((function(e){return e.body}))},version:"0.0.0-next"},(0,i.Z)(f,"_getMe",[d.oneFlight],l()(f,"_getMe"),f),f));(0,n.fo)("people",p,{config:{people:{batcherWait:100,batcherMaxCalls:10,batcherMaxWait:1500,showAllTypes:!1}}})},47683:(e,t,r)=>{"use strict";r.d(t,{mr:()=>Jn,t8:()=>ve,dR:()=>$,T3:()=>ei,XR:()=>Wn,Ff:()=>It,_y:()=>ye,vc:()=>zt,ZP:()=>sr,Zf:()=>Cr,tJ:()=>Z,t4:()=>cr,fo:()=>ar,A4:()=>J});var n=r(82723),i=r.n(n),o=r(13218),s=r.n(o),a=r(50361),c=r.n(a),u=r(26243),l=r.n(u),d=r(71544),h=r.n(d),f=r(73473),p=r.n(f),m=r(89539),g=r.n(m),v=r(65109),y=r.n(v),b=r(77193),E=r(13682),w=r(21882),S=r(90359),_=r.n(S),T=r(58613),x=r.n(T),A=r(6557),I=r.n(A),C=r(23279),R=r.n(C),k=r(40087),O=r.n(k),N=r(18281),P=r.n(N),L=r(90487),D=r.n(L),M=r(18408),U=r(63755),B=r.n(U),F=r(31314),j=r(8167),V=r(69678),H=r(26305),G=r(35002);function q(e){var t=function(){if("undefined"==typeof Reflect||!B())return!1;if(B().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(B()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,G.Z)(e);if(t){var i=(0,G.Z)(this).constructor;r=B()(n,arguments,i)}else r=n.apply(this,arguments);return(0,H.Z)(this,r)}}var $=function(e){(0,V.Z)(r,e);var t=q(r);function r(){return(0,j.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r)}(function(e){(0,V.Z)(r,e);var t=q(r);function r(){return(0,j.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r)}(M.Exception));function Z(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(3===t.length)return Z("@").apply(void 0,t);var n=t[0],i=t[1];return function(e,t,r){if("initialize"!==t)throw new TypeError("@persist can only currently be applied to AmpersandState objects or their derivatives and must be applied to the initialize method");r.value=_()(r.value,(function(e){for(var t=this,r=arguments.length,o=new Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];var a=h()(e,this,o),c="@"===n?"change":"change:".concat(n);return this.on(c,R()((function(){return!i||h().apply(Reflect,[i,t].concat(o))?"@"===n?t.boundedStorage.put(n,t):t.boundedStorage.put(n,t[n]):p().resolve()}),0)),a})),X(e,t)}}var z=P(),K=D(),W=new((0,M.make)(z,z,K));function J(e){if(!e)throw new Error("`key` is required");return function(t,r,n){return W.add(t,r,e),n.value=_()(n.value,(function(e){for(var n=this,i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];var a=W.get(t,r);return p().all((0,w.Z)(a).map((function(e){return n.boundedStorage.waitFor(e)}))).then((function(){return h()(e,n,o)}))})),"object"!==(0,E.Z)(t)||t.prototype||(t[r]=n.value),X(t,r),n}}var Y=new(D());var Q=new(D());function X(e,t){var r=function(e){return e.namespace?e.namespace:e}(e);if(!Y.has(r)){if(Y.add(r),e.initialize)return void(e.initialize=_()(e.initialize,(function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];var o=h()(e,this,r);return h()(n,this,r),o})));e.initialize=n}function n(){var r=this,n=this.getNamespace();this.webex.initialize=_()(this.webex.initialize||I(),(function(i){var o=this;Q.add(n);for(var s=arguments.length,a=new Array(s>1?s-1:0),c=1;c<s;c++)a[c-1]=arguments[c];h()(i,this,a);var u=O()((function(e,t){o.logger.debug("storage:(".concat(n,"): got `").concat(e,"` for first time")),"@"===e?r.parent.set((0,b.Z)({},n.toLowerCase(),t)):x()(r[e],"isState")?r[e].set(t):r.set(e,t),o.logger.debug("storage:(".concat(n,"): set `").concat(e,"` for first time"))})),l=O()((function(e,t){return t instanceof $?(o.logger.debug("storage(".concat(n,"): no data for `").concat(e,"`, continuing")),p().resolve()):(o.logger.error("storage(".concat(n,"): failed to init `").concat(e,"`"),t),p().reject(t))})),d=W.get(e,t),f=[];d.forEach((function(e){f.push(o.boundedStorage.get(n,e).then(u(e)).catch(l(e)))})),p().all(f).then((function(){Q.delete(n),0===Q.size&&(o.loaded=!0)}))}))}}var ee=r(2313),te=r(83977),re=r.n(te),ne=r(95366),ie=r.n(ne),oe=r(18428),se=r.n(oe),ae=r(49740),ce=r.n(ae),ue=new(re());function le(e,t){var r,n,i=(r=(0,M.oneFlight)({keyFactory:function(e){return e}}),n=function(){function r(){(0,j.Z)(this,r),t.logger.debug("webex-store: constructing ".concat(e,"Storage")),ue.set(this,new(P()))}return(0,F.Z)(r,[{key:"adapter",get:function(){return t.config.storage["".concat(e,"Adapter")]}},{key:"bindings",get:function(){return ue.get(this)}},{key:"clear",value:function(){var e=[];return this.bindings.forEach((function(t){e.push(t.clear())})),p().all(e)}},{key:"del",value:function(e,r){return t.logger.debug("webex-store: removing ".concat(e,":").concat(r)),this._getBinding(e).then((function(e){return e.del(r)}))}},{key:"get",value:function(e,r){return t.logger.debug("webex-store: retrieving ".concat(e,":").concat(r)),this._getBinding(e).then((function(e){return e.get(r)}))}},{key:"put",value:function(e,r,n){return void 0===n?this.del(e,r):(t.logger.debug("webex-store: setting ".concat(e,":").concat(r)),this._getBinding(e).then((function(e){return e.put(r,n.serialize?n.serialize():n)})).then((function(){return n})))}},{key:"_getBinding",value:function(e){var r=this;return new(p())((function(n){t.logger.debug("storage: getting binding for `".concat(e,"`"));var i=r.bindings.get(e);return i?(t.logger.debug("storage: found binding for `".concat(e,"`")),n(i)):n(r.adapter.bind(e,{logger:t.logger}).then((function(n){return t.logger.debug("storage: made binding for `".concat(e,"`")),r.bindings.set(e,n),n})))}))}}]),r}(),(0,ee.Z)(n.prototype,"_getBinding",[r],ie()(n.prototype,"_getBinding"),n.prototype),n);return se()(i.prototype,ce()),new i}var de=r(1469),he=r.n(de),fe=new(re());function pe(e){if(!s()(e))return e;var t=e.serialize?e.serialize():e;return l()(t).forEach((function(e){var r=t[e];he()(r)?0===r.length?t[e]=void 0:t[e]=r.map(pe):s()(r)&&l()(r).forEach((function(e){r[e]=pe(r[e])}))})),l()(t).reduce((function(e,r){return e&&!t[r]}),!0)?void 0:t}function me(e,t){var r,n,i=(r=(0,M.oneFlight)({keyFactory:function(e){return"initValue-".concat(e)}}),n=function(){function r(){(0,j.Z)(this,r),fe.set(this,new(P()))}return(0,F.Z)(r,[{key:"clear",value:function(){return t.webex["".concat(e,"Storage")].del(t.getNamespace())}},{key:"del",value:function(){for(var r,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(r=t.webex["".concat(e,"Storage")]).del.apply(r,[t.getNamespace()].concat(i))}},{key:"get",value:function(r){var n=fe.get(this).get(r);return n||(n=new M.Defer,fe.get(this).set(r,n)),t.webex["".concat(e,"Storage")].get(t.getNamespace(),r).then((function(e){return n.resolve(),e}))}},{key:"put",value:function(r,n){return t.webex["".concat(e,"Storage")].put(t.getNamespace(),r,pe(n))}},{key:"waitFor",value:function(e){t.logger.debug("plugin-storage(".concat(t.getNamespace(),"): waiting to init key `").concat(e,"`"));var r=fe.get(this).get(e);return r?(t.logger.debug("plugin-storage(".concat(t.getNamespace(),"): already inited `").concat(e,"`")),r.promise):(t.logger.debug("plugin-storage(".concat(t.getNamespace(),"): initing `").concat(e,"`")),this.initValue(e))}},{key:"initValue",value:function(r){var n=new M.Defer;return fe.get(this).set(r,n),t.webex["".concat(e,"Storage")].get(t.getNamespace(),r).then((function(e){t.logger.debug("plugin-storage(".concat(t.getNamespace(),"): got `").concat(r,"` for first time")),"@"===r?t.parent.set(e):x()(t[r],"isState")?t[r].set(e):t.set(r,e),t.logger.debug("plugin-storage(".concat(t.getNamespace(),"): set `").concat(r,"` for first time")),n.resolve(),t.logger.debug("plugin-storage(".concat(t.getNamespace(),"): inited `").concat(r,"`"))})).catch((function(e){return e instanceof $?(t.logger.debug("plugin-storage(".concat(t.getNamespace(),"): no data for `").concat(r,"`, continuing")),n.resolve()):(t.logger.warn("plugin-storage(".concat(t.getNamespace(),"): failed to init `").concat(r,"`"),e),n.reject(e))})),n.promise}}]),r}(),(0,ee.Z)(n.prototype,"initValue",[r],ie()(n.prototype,"initValue"),n.prototype),n);return new i}function ge(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t=t||{},!e)return p().reject(new Error("`namespace` is required"));if(!t.logger)return p().reject(new Error("`options.logger` is required"));var r=t.logger,n=new(P())([["@",{}]]);return t.data&&l()(t.data).forEach((function(e){n.set(e,t.data[e])})),r.debug("memory-store-adapter: returning binding"),p().resolve({clear:function(){return r.debug("memory-store-adapter: clearing the binding"),p().resolve(n.clear())},del:function(e){return r.debug("memory-store-adapter: deleting `".concat(e,"`")),p().resolve(n.delete(e))},get:function(e){r.debug("memory-store-adapter: reading `".concat(e,"`"));var t=n.get(e);return void 0===t?p().reject(new $):p().resolve(t)},put:function(e,t){return r.debug("memory-store-adapter: writing `".concat(e,"`")),p().resolve(n.set(e,t))}})}const ve={bind:ge,preload:function(e){return{bind:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e[t]&&(r.data=e[t]),ge(t,r)}}}};const ye=y().extend({derived:{boundedStorage:{deps:[],fn:function(){return me("bounded",this)}},unboundedStorage:{deps:[],fn:function(){return me("unbounded",this)}},config:{cache:!1,deps:["webex","webex.config"],fn:function(){if(this.webex&&this.webex.config){var e=this.getNamespace();return e?this.webex.config[e.toLowerCase()]:this.webex.config}return{}}},logger:{deps:["webex","webex.logger"],fn:function(){return this.webex.logger||console}},webex:{deps:["parent"],fn:function(){if(!this.parent&&!this.collection)throw new Error("Cannot determine `this.webex` without `this.parent` or `this.collection`. Please initialize `this` via `children` or `collection` or set `this.parent` manually");for(var e=this;e.parent||e.collection;)e=e.parent||e.collection;return e}}},session:{parent:{type:"any"},ready:{default:!0,type:"boolean"}},clear:function(e){var t=this;return l()(this.attributes).forEach((function(r){"parent"!==r&&t.unset(r,e)})),l()(this._children).forEach((function(e){t[e].clear()})),l()(this._collections).forEach((function(e){t[e].reset()})),this},initialize:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];h()(y().prototype.initialize,this,r),this._dataTypes=c()(this._dataTypes),l()(this._dataTypes).forEach((function(t){e._dataTypes[t].set&&(e._dataTypes[t].set=e._dataTypes[t].set.bind(e))})),this.on("change",(function(t,r){e.parent&&e.parent.trigger("change:".concat(e.getNamespace().toLowerCase()),e.parent,e,r)}))},inspect:function(e){return g().inspect(i()(this.serialize({props:!0,session:!0,derived:!0}),"boundedStorage","unboundedStorage","config","logger","webex","parent"),{depth:e})},request:function(){var e;return(e=this.webex).request.apply(e,arguments)},upload:function(){var e;return(e=this.webex).upload.apply(e,arguments)},when:function(e){for(var t=this,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];if(n&&n.length>0)throw new Error("#when() does not accept a callback, you must attach to its promise");return new(p())((function(r){t.once(e,(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r(t)}))}))},_filterSetParameters:function(e,t,r){var n;return s()(e)||null===e?(n=e,r=t):(n={})[e]=t,[n,r=r||{}]}});var be=r(62680),Ee=r.n(be),we=r(6919),Se=r.n(we),_e=r(93364),Te=r.n(_e),xe=r(26771),Ae=r.n(xe),Ie=r(66250),Ce=r(98601),Re=r.n(Ce),ke=r(36968),Oe=r.n(ke),Ne=r(82492),Pe=r.n(Ne),Le=r(10928),De=r.n(Le),Me=r(47037),Ue=r.n(Me),Be=r(23560),Fe=r.n(Be),je=r(27361),Ve=r.n(je),He=r(66913),Ge=r.n(He),qe=r(33453),$e=r.n(qe),Ze=r(8450),ze=r.n(Ze),Ke=r(67857),We=r.n(Ke),Je=r(17187),Ye=r(18338),Qe=r(55877),Xe=r.n(Qe);function et(e){var t=function(){if("undefined"==typeof Reflect||!B())return!1;if(B().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(B()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,G.Z)(e);if(t){var i=(0,G.Z)(this).constructor;r=B()(n,arguments,i)}else r=n.apply(this,arguments);return(0,H.Z)(this,r)}}var tt=function(e){(0,V.Z)(r,e);var t=et(r);function r(){return(0,j.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r,[{key:"onRequest",value:function(e){var t=this;return e.headers=e.headers||{},"authorization"in e.headers||"auth"in e?(e.headers.authorization||We()(e.headers,"authorization"),p().resolve(e)):this.requiresCredentials(e).then((function(r){return r?t.webex.credentials.getUserToken().then((function(t){return e.headers.authorization=t.toString(),e})):e}))}},{key:"requiresCredentials",value:function(e){var t=this;if(!1===e.addAuthHeader)return p().resolve(!1);if(!this.webex.internal.services)return p().resolve(!1);var r=this.webex.internal.services,n=(r.getServiceFromUrl(e.uri||"")||{}).name,i=e.resource,o=e.uri,s=e.service||e.api;return s&&"u2c"===s||n&&"u2c"===n?i&&i.includes("limited")||o&&o.includes("limited")?p().resolve(!1):p().resolve(!0):r.validateDomains&&r.hasAllowedDomains()&&o&&r.isAllowedDomainUrl(o)?p().resolve(!0):r.waitForService({name:s,url:o}).then((function(e){return!!r.getServiceFromUrl(e)})).catch((function(e){return t.webex.logger.warn("auth-interceptor: failed to validate service exists in catalog",e),!1}))}},{key:"onResponseError",value:function(e,t){var r=this;return this.shouldAttemptReauth(t,e).then((function(n){return n&&(r.webex.logger.info("auth: received 401, attempting to reauthenticate"),t.options.headers&&We()(t.options.headers,"authorization"),r.webex.credentials.canRefresh)?r.webex.credentials.refresh().then((function(){return r.replay(e)})):p().reject(t)}))}},{key:"replay",value:function(e){return e.replayCount?e.replayCount+=1:e.replayCount=1,e.replayCount>this.webex.config.maxAuthenticationReplays?(this.webex.logger.error("auth: failed after ".concat(this.webex.config.maxAuthenticationReplays," replay attempts")),p().reject(new Error("Failed after ".concat(this.webex.config.maxAuthenticationReplays," replay attempts")))):(this.webex.logger.info("auth: replaying request ".concat(e.replayCount," time")),this.webex.request(e))}},{key:"shouldAttemptReauth",value:function(e,t){return t&&!1===t.shouldRefreshAccessToken?p().resolve(!1):401===e.statusCode?p().resolve(!0):p().resolve(!1)}}],[{key:"create",value:function(){return new r({webex:this})}}]),r}(Ye.nK),rt=r(66130),nt=r.n(rt);function it(e){var t=function(){if("undefined"==typeof Reflect||!B())return!1;if(B().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(B()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,G.Z)(e);if(t){var i=(0,G.Z)(this).constructor;r=B()(n,arguments,i)}else r=n.apply(this,arguments);return(0,H.Z)(this,r)}}var ot=function(e){(0,V.Z)(r,e);var t=it(r);function r(){return(0,j.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r,[{key:"onRequest",value:function(e){return e.$timings=e.$timings||{},e.$timings.networkStart=nt()(),e}},{key:"onResponse",value:function(e,t){return e.$timings.networkEnd=nt()(),t}},{key:"onResponseError",value:function(e,t){return e.$timings.networkEnd=nt()(),p().reject(t)}}],[{key:"create",value:function(e){return new r(this,e)}}]),r}(Ye.nK);function st(e){var t=function(){if("undefined"==typeof Reflect||!B())return!1;if(B().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(B()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,G.Z)(e);if(t){var i=(0,G.Z)(this).constructor;r=B()(n,arguments,i)}else r=n.apply(this,arguments);return(0,H.Z)(this,r)}}var at=function(e){(0,V.Z)(r,e);var t=st(r);function r(){return(0,j.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r,[{key:"onRequest",value:function(e){return e.noTransform?e:this.webex.transform("outbound",e)}},{key:"onResponse",value:function(e,t){return e.disableTransform?t:this.webex.transform("inbound",t)}},{key:"onResponseError",value:function(e,t){return this.webex.transform("inbound",t).then((function(e){return p().reject(e||t)}))}}],[{key:"create",value:function(){return new r({webex:this})}}]),r}(Ye.nK),ct=r(66678),ut=r.n(ct);function lt(e){var t=function(){if("undefined"==typeof Reflect||!B())return!1;if(B().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(B()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,G.Z)(e);if(t){var i=(0,G.Z)(this).constructor;r=B()(n,arguments,i)}else r=n.apply(this,arguments);return(0,H.Z)(this,r)}}var dt="cisco-no-http-redirect",ht="cisco-location",ft=function(e){(0,V.Z)(r,e);var t=lt(r);function r(){return(0,j.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r,[{key:"onRequest",value:function(e){return e&&e.uri&&"string"==typeof e.uri&&(e.uri.includes("https://idbroker")||e.uri.includes(this.webex.config.credentials.samlUrl)||e.uri.includes(this.webex.config.credentials.tokenUrl)||e.uri.includes(this.webex.config.credentials.authorizeUrl))?e:dt in e.headers?(e.headers[dt]||We()(e.headers,dt),e):(e.headers[dt]=!0,e.$redirectCount=e.$redirectCount||0,e)}},{key:"onResponse",value:function(e,t){if(t.headers&&t.headers[ht])return(e=ut()(e)).uri=t.headers[ht],e.$redirectCount+=1,e.$redirectCount>this.webex.config.maxAppLevelRedirects?p().reject(new Error("Maximum redirects exceeded")):this.webex.request(e);if(t.headers&&t.body&&2000002===t.body.errorCode&&t.body.location){if(e=ut()(e),this.webex.logger.warn("redirect: url redirects needed from",e.uri),t.options&&t.options.qs){var r=t.body.location.split("?");e.uri=r[0]}else e.uri=t.body.location;return this.webex.logger.warn("redirect: url redirects needed to",e.uri),e.$redirectCount+=1,e.$redirectCount>this.webex.config.maxLocusRedirects?p().reject(new Error("Maximum redirects exceeded")):this.webex.request(e)}return t}}],[{key:"create",value:function(){return new r({webex:this})}}]),r}(Ye.nK);function pt(e){var t=function(){if("undefined"==typeof Reflect||!B())return!1;if(B().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(B()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,G.Z)(e);if(t){var i=(0,G.Z)(this).constructor;r=B()(n,arguments,i)}else r=n.apply(this,arguments);return(0,H.Z)(this,r)}}var mt=function(e){(0,V.Z)(r,e);var t=pt(r);function r(){return(0,j.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r,[{key:"onRequest",value:function(e){var t=Ve()(this,"webex.logger",console);try{this.webex.trigger("request:start",e)}catch(e){t.warn("event handler for request:start failed ",e)}return p().resolve(e)}},{key:"onRequestError",value:function(e,t){var r=Ve()(this,"webex.logger",console);try{this.webex.trigger("request:end",e,t),this.webex.trigger("request:failure",e,t)}catch(e){r.warn("event handler for request:end failed ",e)}return p().reject(t)}},{key:"onResponse",value:function(e,t){var r=Ve()(this,"webex.logger",console);try{this.webex.trigger("request:success",t.options,t)}catch(e){r.warn("event handler for request:success failed ",e)}return p().resolve(t)}},{key:"onResponseError",value:function(e,t){var r=Ve()(this,"webex.logger",console);try{this.webex.trigger("request:end",e,t),this.webex.trigger("request:failure",e,t)}catch(e){r.warn("event handler for request:failure failed ",e)}return p().reject(t)}}],[{key:"create",value:function(){return new r({webex:this})}}]),r}(Ye.nK),gt=r(18721),vt=r.n(gt);function yt(e){var t=function(){if("undefined"==typeof Reflect||!B())return!1;if(B().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(B()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,G.Z)(e);if(t){var i=(0,G.Z)(this).constructor;r=B()(n,arguments,i)}else r=n.apply(this,arguments);return(0,H.Z)(this,r)}}var bt=function(e){(0,V.Z)(r,e);var t=yt(r);function r(){return(0,j.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r,[{key:"onRequest",value:function(e){var t=Ve()(this,"webex.logger",console);t.info("/**********************************************************************\\ "),t.info("Request:",e.method||"GET",e.uri),t.info("WEBEX_TRACKINGID: ",Ve()(e,"headers.trackingid")),vt()(e,"headers.x-trans-id")&&t.info("X-Trans-ID: ",Ve()(e,"headers.x-trans-id"));var r=new Date;if({ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.ENABLE_VERBOSE_NETWORK_LOGGING){t.info("timestamp (start): ",r.getTime(),r.toISOString());try{e.body&&e.body.length&&!he()(e.body)&&!Ue()(e.body)?t.info("Request Options:",g().inspect(i()(e,"body"),{depth:null})):t.info("Request Options:",g().inspect(e,{depth:null}))}catch(e){t.warn("Could not stringify request options:",e)}}return p().resolve(e)}},{key:"onRequestError",value:function(e,t){this.onRequest(e);var r=Ve()(this,"webex.logger",console);return r.error("Request Failed: ",t.stack),r.info("\\**********************************************************************/"),p().reject(t)}}],[{key:"create",value:function(){return new r({webex:this})}}]),r}(Ye.nK);function Et(e){var t=function(){if("undefined"==typeof Reflect||!B())return!1;if(B().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(B()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,G.Z)(e);if(t){var i=(0,G.Z)(this).constructor;r=B()(n,arguments,i)}else r=n.apply(this,arguments);return(0,H.Z)(this,r)}}var wt=function(e){(0,V.Z)(r,e);var t=Et(r);function r(){return(0,j.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r,[{key:"onRequest",value:function(e){return e.$timings=e.$timings||{},e.$timings.requestStart=nt()(),e}},{key:"onRequestError",value:function(e){return e.$timings.requestEnd=e.$timings.requestFail=nt()(),p().reject(e)}},{key:"onResponse",value:function(e,t){return e.$timings.requestEnd=nt()(),p().resolve(t)}},{key:"onResponseError",value:function(e,t){return e.$timings.requestEnd=e.$timings.requestFail=nt()(),p().reject(t)}}],[{key:"create",value:function(e){return new r(this,e)}}]),r}(Ye.nK);function St(e){var t=function(){if("undefined"==typeof Reflect||!B())return!1;if(B().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(B()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,G.Z)(e);if(t){var i=(0,G.Z)(this).constructor;r=B()(n,arguments,i)}else r=n.apply(this,arguments);return(0,H.Z)(this,r)}}var _t=function(e){(0,V.Z)(r,e);var t=St(r);function r(){return(0,j.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r,[{key:"onResponse",value:function(e,t){var r=new Date;this.printResponseHeader(e,t);var n=Ve()(this,"webex.logger",console);if({ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.ENABLE_VERBOSE_NETWORK_LOGGING)if(n.info("timestamp (end): ",r.getTime(),r.toISOString()),"string"==typeof t.body||(0,M.isBuffer)(t.body))n.info("Response: ","Not printed, it`s probably a file");else if("object"===(0,E.Z)(t.body))try{n.info("Response: ",g().inspect(i()(t.body,"features"),{depth:null}))}catch(e){n.info("Response: ","[Not Serializable]",e)}return n.info("\\**********************************************************************/"),t}},{key:"onResponseError",value:function(e,t){var r=new Date;this.printResponseHeader(e,t);var n=Ve()(this,"webex.logger",console);if({ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.ENABLE_VERBOSE_NETWORK_LOGGING){n.info("timestamp (end): ",r.getTime(),r.toISOString());try{n.error("Response: ",g().inspect(t.body,{depth:null}))}catch(e){n.error("Response: ",t.body)}}return n.info("\\**********************************************************************/"),p().reject(t)}},{key:"printResponseHeader",value:function(e,t){var r=Ve()(this,"webex.logger",console);r.info("Status Code:",t.statusCode),r.info("WEBEX_TRACKINGID:",Ve()(e,"headers.trackingid")||Ve()(t,"headers.trackingid")),r.info("Network duration:",e.$timings.networkEnd-e.$timings.networkStart),r.info("Processing duration:",e.$timings.requestEnd-e.$timings.requestStart)}}],[{key:"create",value:function(){return new r({webex:this})}}]),r}(Ye.nK),Tt=r(79873),xt=r.n(Tt);function At(e){var t=function(){if("undefined"==typeof Reflect||!B())return!1;if(B().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(B()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,G.Z)(e);if(t){var i=(0,G.Z)(this).constructor;r=B()(n,arguments,i)}else r=n.apply(this,arguments);return(0,H.Z)(this,r)}}var It=function(e){(0,V.Z)(r,e);var t=At(r);function r(){return(0,j.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r,[{key:"parse",value:function(e){var t=h()(Ye.oo.prototype.parse,this,[e]);return xt()(this,"options",{enumerable:!1,value:e.options}),this.options.url?t+="\n".concat(this.options.method," ").concat(this.options.url):this.options.uri?t+="\n".concat(this.options.method," ").concat(this.options.uri):t+="\n".concat(this.options.method," ").concat(this.options.service.toUpperCase(),"/").concat(this.options.resource),t+="\nWEBEX_TRACKING_ID: ".concat(this.options.headers.trackingid),this.options.headers&&this.options.headers["x-trans-id"]&&(t+="\nX-Trans-Id: ".concat(this.options.headers["x-trans-id"])),this.headers["retry-after"]&&(xt()(this,"retryAfter",{enumerable:!0,value:this.headers["retry-after"],writeable:!1}),t+="\nRETRY-AFTER: ".concat(this.retryAfter)),t+="\n"}}]),r}(Ye.oo);Ye.oo.makeSubTypes(It);var Ct=function(e){(0,V.Z)(r,e);var t=At(r);function r(){return(0,j.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r)}(Ye.oo.BadRequest);Ye.oo[429]=Ct,Ye.oo.TooManyRequests=Ct;var Rt=r(23710);function kt(e){var t=function(){if("undefined"==typeof Reflect||!B())return!1;if(B().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(B()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,G.Z)(e);if(t){var i=(0,G.Z)(this).constructor;r=B()(n,arguments,i)}else r=n.apply(this,arguments);return(0,H.Z)(this,r)}}var Ot=new(re()),Nt=function(e){(0,V.Z)(r,e);var t=kt(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,j.Z)(this,r);var i=Ve()(n,"webex.config.appName"),o=Ve()(n,"webex.config.appVersion")||"0.0";return e=t.call(this,n),i?Ot.set((0,Rt.Z)(e),"".concat(i,"/").concat(o)):Ot.set((0,Rt.Z)(e),"@webex/http-core"),e}return(0,F.Z)(r,[{key:"onRequest",value:function(e){return M.inBrowser?e:(e.headers=e.headers||{},"user-agent"in e.headers&&e.headers["spark-user-agent"]||(e.headers["user-agent"]=Ot.get(this)),e)}}],[{key:"create",value:function(){return new r({webex:this})}}]),r}(Ye.nK);function Pt(e){var t=function(){if("undefined"==typeof Reflect||!B())return!1;if(B().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(B()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,G.Z)(e);if(t){var i=(0,G.Z)(this).constructor;r=B()(n,arguments,i)}else r=n.apply(this,arguments);return(0,H.Z)(this,r)}}var Lt=new(re()),Dt=function(e){(0,V.Z)(r,e);var t=Pt(r);function r(){return(0,j.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r,[{key:"sequence",get:function(){var e=Lt.get(this)||0;return e+=1,Lt.set(this,e),e}},{key:"onRequest",value:function(e){if(e.headers=e.headers||{},"trackingid"in e.headers)return e.headers.trackingid||We()(e.headers,"trackingid"),e;if(this.requiresTrackingId(e)&&(e.headers.trackingid="".concat(this.webex.sessionId,"_").concat(this.sequence)),e.headers.trackingid&&e.replayCount){var t=e.headers.trackingid.split("+");t[1]=e.replayCount,e.headers.trackingid=t.join("+")}return e}},{key:"requiresTrackingId",value:function(e){return!e.headers.trackingid}}],[{key:"create",value:function(){return new r({webex:this})}}]),r}(Ye.nK);function Mt(e){var t=function(){if("undefined"==typeof Reflect||!B())return!1;if(B().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(B()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,G.Z)(e);if(t){var i=(0,G.Z)(this).constructor;r=B()(n,arguments,i)}else r=n.apply(this,arguments);return(0,H.Z)(this,r)}}var Ut=new(re()),Bt=function(e){(0,V.Z)(r,e);var t=Mt(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,j.Z)(this,r);var i=Ve()(n,"webex.webex",!1)?"webex":"webex-js-sdk",o=Ve()(n,"webex.version","development");return e=t.call(this,n),Ut.set((0,Rt.Z)(e),"".concat(i,"/").concat(o," (").concat(M.inBrowser?"web":"node",")")),e}return(0,F.Z)(r,[{key:"onRequest",value:function(e){var t,r;e.headers=e.headers||{};var n=null!==(t=null===(r=this.webex)||void 0===r?void 0:r.config)&&void 0!==t?t:{},i=n.appName,o=n.appVersion,s=n.appPlatform,a="".concat(Ut.get(this));return i&&(a+=" ".concat(i,"/").concat(null!=o?o:"0.0")),s&&(a+=" ".concat(s)),e.uri&&e.uri.includes("https://idbroker")||e.uri&&(e.uri.includes(this.webex.config.credentials.samlUrl)||e.uri.includes(this.webex.config.credentials.tokenUrl)||e.uri.includes(this.webex.config.credentials.authorizeUrl))?e:"spark-user-agent"in e.headers?(e.headers["spark-user-agent"]||We()(e.headers,"spark-user-agent"),e):(e.headers["spark-user-agent"]=a,e)}}],[{key:"create",value:function(){return new r({webex:this})}}]),r}(Ye.nK);function Ft(e){var t=function(){if("undefined"==typeof Reflect||!B())return!1;if(B().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(B()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,G.Z)(e);if(t){var i=(0,G.Z)(this).constructor;r=B()(n,arguments,i)}else r=n.apply(this,arguments);return(0,H.Z)(this,r)}}var jt=new(re()),Vt=/.*(idbroker|identity)(bts)?.ciscospark.com\/([^/]+)/,Ht=function(e){(0,V.Z)(r,e);var t=Ft(r);function r(){var e;(0,j.Z)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),jt.set((0,Rt.Z)(e),new(P())),e}return(0,F.Z)(r,[{key:"onRequest",value:function(e){return this.isRateLimited(e.uri)?p().reject(new Error("API rate limited ".concat(e.uri))):p().resolve(e)}},{key:"onResponseError",value:function(e,t){return 429===t.statusCode&&(e.uri.includes("idbroker")||e.uri.includes("identity"))&&this.setRateLimitExpiry(e.uri,this.extractRetryAfterTime(e)),p().reject(t)}},{key:"extractRetryAfterTime",value:function(e){var t=1e3,r=e.headers["retry-after"]||null;return null===r||r<=0?6e4:r>3600?36e5:r*t}},{key:"setRateLimitExpiry",value:function(e,t){var r=this.getApiName(e);if(!r)return!1;var n=(new Date).getTime()+t;return jt.get(this).set(r,n)}},{key:"getRateLimitStatus",value:function(e){var t=this.getApiName(e);if(!t)return!1;var r=(new Date).getTime(),n=jt.get(this);return void 0!==n.get(t)&&r<n.get(t)}},{key:"getApiName",value:function(e){if(!e)return null;var t=e.match(Vt);return t?t[2]:null}},{key:"isRateLimited",value:function(e){return!(!e||!e.includes("idbroker")&&!e.includes("identity"))&&this.getRateLimitStatus(e)}}],[{key:"create",value:function(){return new r({webex:this})}}]),r}(Ye.nK);function Gt(e){var t=function(){if("undefined"==typeof Reflect||!B())return!1;if(B().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(B()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,G.Z)(e);if(t){var i=(0,G.Z)(this).constructor;r=B()(n,arguments,i)}else r=n.apply(this,arguments);return(0,H.Z)(this,r)}}var qt=function(e){(0,V.Z)(r,e);var t=Gt(r);function r(){return(0,j.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r,[{key:"onResponseError",value:function(e,t){if(451===t.statusCode){var r=this.webex.internal.device,n=["Received `HTTP 451 Unavailable For Legal Reasons`, ","discarding credentials and device registration"].join("");r&&this.webex.internal.device.clear(),this.webex.credentials.clear(),this.webex.logger.info(n)}return p().reject(t)}}],[{key:"create",value:function(){return new r({webex:this})}}]),r}(Ye.nK);function $t(e){var t=function(){if("undefined"==typeof Reflect||!B())return!1;if(B().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(B()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,G.Z)(e);if(t){var i=(0,G.Z)(this).constructor;r=B()(n,arguments,i)}else r=n.apply(this,arguments);return(0,H.Z)(this,r)}}var Zt=function(e){(0,V.Z)(r,e);var t=$t(r);function r(){return(0,j.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r,[{key:"onRequest",value:function(e){var t=this.webex.config.defaultRequestOptions;return t?(l()(t).forEach((function(r){l()(e).includes(r)||(e[r]=t[r])})),e):e}}],[{key:"create",value:function(){return new r({webex:this})}}]),r}(Ye.nK);const zt={maxAppLevelRedirects:10,maxLocusRedirects:5,maxAuthenticationReplays:1,maxReconnectAttempts:1,onBeforeLogout:[],trackingIdPrefix:"webex-js-sdk",trackingIdSuffix:"",AlternateLogger:void 0,credentials:new(y().extend({extraProperties:"allow",props:{idbroker:["object",!1,function(){return{url:"https://idbroker.webex.com"}}],identity:["object",!1,function(){return{url:"https://identity.webex.com"}}],authorizationString:["string",!1,{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.WEBEX_AUTHORIZATION_STRING||{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.AUTHORIZATION_STRING],authorizeUrl:["string",!1,{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.WEBEX_AUTHORIZE_URL||"".concat("https://idbroker.webex.com","/idb/oauth2/v1/authorize")],client_id:["string",!1,{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.WEBEX_CLIENT_ID||{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.COMMON_IDENTITY_CLIENT_ID||{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.CLIENT_ID],client_secret:["string",!1,{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.WEBEX_CLIENT_SECRET||{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.COMMON_IDENTITY_CLIENT_SECRET||{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.CLIENT_SECRET],redirect_uri:["string",!1,{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.WEBEX_REDIRECT_URI||{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.COMMON_IDENTITY_REDIRECT_URI||{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.REDIRECT_URI],scope:["string",!1,{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.WEBEX_SCOPE||{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.WEBEX_SCOPES||{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.COMMON_IDENTITY_SCOPE||{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.SCOPE],cisService:["string",!1,"webex"]},derived:{activationUrl:{deps:["idbroker.url"],fn:function(){return"".concat(this.idbroker.url||"https://idbroker.webex.com","/idb/token/v1/actions/UserActivation/invoke")},cache:!1},generateOtpUrl:{deps:["idbroker.url"],fn:function(){return"".concat(this.idbroker.url||"https://idbroker.webex.com","/idb/token/v1/actions/UserOTP/Generate/invoke")},cache:!1},validateOtpUrl:{deps:["idbroker.url"],fn:function(){return"".concat(this.idbroker.url||"https://idbroker.webex.com","/idb/token/v1/actions/UserOTP/Validate/invoke")},cache:!1},tokenUrl:{deps:["idbroker.url"],fn:function(){return{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.TOKEN_URL||"".concat(this.idbroker.url,"/idb/oauth2/v1/access_token")},cache:!1},revokeUrl:{deps:["idbroker.url"],fn:function(){return{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.REVOKE_URL||"".concat(this.idbroker.url,"/idb/oauth2/v1/revoke")},cache:!1},logoutUrl:{deps:["idbroker.url"],fn:function(){return"".concat(this.idbroker.url,"/idb/oauth2/v1/logout")},cache:!1},setPasswordUrl:{deps:["identity.url"],fn:function(){return"".concat(this.identity.url||"https://identity.webex.com","/identity/scim/v1/Users")},cache:!1}}})),fedramp:{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.ENABLE_FEDRAMP||!1,services:{discovery:{hydra:"https://api.ciscospark.com/v1",u2c:"https://u2c.wbx2.com/u2c/api/v1"},validateDomains:!0,servicesNotNeedValidation:["webex-appapi-service"],allowedDomains:["wbx2.com","ciscospark.com","webex.com","webexapis.com","broadcloudpbx.com","broadcloud.eu","broadcloud.com.au","broadcloudpbx.net"]},device:{preDiscoveryServices:{hydra:"https://api.ciscospark.com/v1",hydraServiceUrl:"https://api.ciscospark.com/v1"},validateDomains:!0},metrics:{type:["behavioral","operational"]},payloadTransformer:{predicates:[],transforms:[]},storage:{boundedAdapter:ve,unboundedAdapter:ve}};var Kt=r(93386),Wt=r.n(Kt);function Jt(e,t,r){(e._derived[t]={fn:Fe()(r)?r:r.fn,cache:!1!==r.cache,depList:r.deps||[]}).depList.forEach((function(r){e._deps[r]=Wt()(e._deps[r]||[],[t])})),xt()(e,t,{get:function(){return this._getDerivedProperty(t)},set:function(){throw new TypeError("`".concat(t,"` is a derived property, it can't be set directly."))}})}const Yt=y().extend({derived:{ready:{deps:[],fn:function(){var e=this;return l()(this._children).reduce((function(t,r){return t&&e[r]&&!1!==e[r].ready}),!0)}}},inspect:function(e){return g().inspect(this.serialize({props:!0,session:!0,derived:!0}),{depth:e})}});var Qt,Xt=r(34155);function er(e,t){var r=l()(e);if(Ee()){var n=Ee()(e);t&&(n=n.filter((function(t){return ie()(e,t).enumerable}))),r.push.apply(r,n)}return r}function tr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?er(Object(r),!0).forEach((function(t){(0,b.Z)(e,t,r[t])})):Se()?Te()(e,Se()(r)):er(Object(r)).forEach((function(t){Ae()(e,t,ie()(r,t))}))}return e}var rr={WebexTrackingIdInterceptor:Dt.create,RequestEventInterceptor:mt.create,RateLimitInterceptor:Ht.create,RequestLoggerInterceptor:{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.ENABLE_NETWORK_LOGGING||{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.ENABLE_VERBOSE_NETWORK_LOGGING?bt.create:void 0,ResponseLoggerInterceptor:{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.ENABLE_NETWORK_LOGGING||{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.ENABLE_VERBOSE_NETWORK_LOGGING?_t.create:void 0,RequestTimingInterceptor:wt.create,ServiceInterceptor:void 0,UserAgentInterceptor:Nt.create,WebexUserAgentInterceptor:Bt.create,AuthInterceptor:tt.create,KmsDryErrorInterceptor:void 0,PayloadTransformerInterceptor:at.create,ConversationInterceptor:void 0,RedirectInterceptor:ft.create,HttpStatusInterceptor:function(){return Ye.ve.create({error:It})},NetworkTimingInterceptor:ot.create,EmbargoInterceptor:qt.create,DefaultOptionsInterceptor:Zt.create},nr=["ResponseLoggerInterceptor","RequestTimingInterceptor","RequestEventInterceptor","WebexTrackingIdInterceptor","RateLimitInterceptor"],ir=["HttpStatusInterceptor","NetworkTimingInterceptor","EmbargoInterceptor","RequestLoggerInterceptor","RateLimitInterceptor"],or=y().extend((Qt={version:"undefined",children:{internal:Yt},constructor:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return"string"==typeof e?e={credentials:{supertoken:{access_token:e}}}:(["credentials.authorization","authorization","credentials.supertoken.supertoken","supertoken","access_token","credentials.authorization.supertoken"].forEach((function(t){var r=Ve()(e,t);r&&(Re()(e,t),Oe()(e,"credentials.supertoken",r))})),["credentials","credentials.authorization"].forEach((function(t){var r=Ve()(e,t);"string"==typeof r&&(Re()(e,t),Oe()(e,"credentials.supertoken",r))})),"string"==typeof Ve()(e,"credentials.access_token")&&(Oe()(e,"credentials.access_token",this.bearerValidator(Ve()(e,"credentials.access_token").trim())),Oe()(e,"credentials.supertoken",e.credentials))),h()(y(),this,[e,t])},derived:{boundedStorage:{deps:[],fn:function(){return le("bounded",this)}},unboundedStorage:{deps:[],fn:function(){return le("unbounded",this)}},ready:{deps:["loaded","internal.ready"],fn:function(){var e=this;return this.loaded&&l()(this._children).reduce((function(t,r){return t&&e[r]&&!1!==e[r].ready}),!0)}}},session:{config:{type:"object"},loaded:{default:!1,type:"boolean"},request:{setOnce:!0,type:"any"},sessionId:{setOnce:!0,type:"string"}},refresh:function(){var e;return(e=this.credentials).refresh.apply(e,arguments)},transform:function(e,t){var r=this,n=this.config.payloadTransformer.predicates.filter((function(t){return!t.direction||t.direction===e})),i={webex:this};return p().all(n.map((function(e){return e.test(i,t).then((function(r){if(r)return e.extract(t).then((function(t){return{name:e.name,target:t}}))}))}))).then((function(t){return t.filter((function(e){return Boolean(e)})).reduce((function(t,n){var i=n.name,o=n.target,s=n.alias;return t.then((function(){return s?r.applyNamedTransform(e,s,o):r.applyNamedTransform(e,i,o)}))}),p().resolve())})).then((function(){return t}))},applyNamedTransform:function(e,t,r){for(var n=this,i=arguments.length,o=new Array(i>3?i-3:0),s=3;s<i;s++)o[s-3]=arguments[s];return Ue()(t)&&(o.unshift(r),r=t,t={webex:this,transform:function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return n.applyNamedTransform.apply(n,[e,t].concat(i))}}),t.webex.config.payloadTransformer.transforms.filter((function(t){return t.name===r&&(!t.direction||t.direction===e)})).reduce((function(e,r){return e.then((function(){var e;return r.alias?(e=t).transform.apply(e,[r.alias].concat(o)):p().resolve(r.fn.apply(r,[t].concat(o)))}))}),p().resolve()).then((function(){return De()(o)}))},getWindow:function(){return window},initialize:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=Pe()({},zt,t.config),this.trigger("change:config");var r=function t(){e.loaded&&(e.trigger("loaded"),e.stopListening(e,"change:loaded",t))};Xt.nextTick((function(){e.listenToAndRun(e,"change:loaded",r)}));var n=function t(){e.ready&&(e.trigger("ready"),e.stopListening(e,"change:ready",t))};Xt.nextTick((function(){e.listenToAndRun(e,"change:ready",n)})),l()(this.constructor.prototype._children).forEach((function(t){e.listenTo(e[t],"change",(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];n.unshift("change:".concat(t)),e.trigger.apply(e,n)}))}));var i=function(t,r){var n=rr[r];return Fe()(n)?(t.push(h()(n,e,[])),t):t},o=[];o=nr.reduce(i,o),o=l()(rr).filter((function(e){return!(nr.includes(e)||ir.includes(e))})).reduce(i,o),o=ir.reduce(i,o),this.request=(0,Ye.ce)({json:!0,interceptors:o}),this.prepareFetchOptions=(0,Ye.Of)({json:!0,interceptors:o}),this.setTimingsAndFetch=Ye.lb;var s="".concat(Ve()(this,"config.trackingIdPrefix","webex-js-sdk"),"_").concat(Ve()(this,"config.trackingIdBase",Xe().v4()));Ve()(this,"config.trackingIdSuffix")&&(s+="_".concat(Ve()(this,"config.trackingIdSuffix"))),this.sessionId=s},setConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=Pe()({},this.config,e)},bearerValidator:function(e){return e.includes("Bearer")&&e.split(" ").length-1==0?(console.warn("Your access token does not have a space between 'Bearer' and the token, please add a space to it or replace it with this already fixed version:\n\n".concat(e.replace("Bearer","Bearer ").replace(/\s+/g," "))),console.info("Tip: You don't need to add 'Bearer' to the access_token field. The token by itself is fine"),e.replace("Bearer","Bearer ").replace(/\s+/g," ")):e.split(" ").length-1>1?(console.warn("Your access token has ".concat(e.split(" ").length-2," too many spaces, please use this format:\n\n").concat(e.replace(/\s+/g," "))),console.info("Tip: You don't need to add 'Bearer' to the access_token field, the token by itself is fine"),e.replace(/\s+/g," ")):e.replace(/\s+/g," ")},inspect:function(e){return g().inspect(i()(this.serialize({props:!0,session:!0,derived:!0}),"boundedStorage","unboundedStorage","request","config"),{depth:e})},logout:function(e){for(var t=this,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var o=this.credentials.supertoken&&(this.credentials.supertoken.refresh_token||this.credentials.supertoken.access_token);return e=se()({token:o},e),this.config.onBeforeLogout.reverse().reduce((function(r,i){var o=i.plugin,s=i.fn;return r.then((function(){return p().resolve(h()(s,t[o]||t.internal[o],[e].concat(n))).catch((function(e){t.logger.warn("onBeforeLogout from plugin ".concat(o,": failed"),e)}))}))}),p().resolve()).then((function(){return p().all([t.boundedStorage.clear(),t.unboundedStorage.clear()])})).then((function(){var e;return(e=t.credentials).invalidate.apply(e,n)})).then((function(){var r;return t.authorization&&t.authorization.logout&&(r=t.authorization).logout.apply(r,[e].concat(n))})).then((function(){return t.trigger("client:logout")}))},measure:function(){var e;return this.metrics?(e=this.metrics).sendUnstructured.apply(e,arguments):p().resolve()},upload:function(e){var t=this;return(0,Ie.Z)($e().mark((function r(){var n,o;return $e().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.file){r.next=2;break}return r.abrupt("return",p().reject(new Error("`options.file` is required")));case 2:return e.phases=e.phases||{},e.phases.initialize=e.phases.initialize||{},e.phases.upload=e.phases.upload||{},e.phases.finalize=e.phases.finalize||{},Ge()(e.phases.initialize,{method:"POST",body:{uploadProtocol:"content-length"}},i()(e,"file","phases")),Ge()(e.phases.upload,{method:"PUT",json:!1,withCredentials:!1,body:e.file,headers:{"x-trans-id":Xe().v4(),authorization:void 0}}),Ge()(e.phases.finalize,{method:"POST"},i()(e,"file","phases")),n=new Je.EventEmitter,o=t._uploadPhaseInitialize(e).then((function(){var r=t._uploadPhaseUpload(e);return(0,M.transferEvents)("progress",r,n),r})).then((function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return t._uploadPhaseFinalize.apply(t,[e].concat(n))})).then((function(e){return tr(tr({},e.body),e.headers)})),(0,M.proxyEvents)(n,o),r.abrupt("return",o);case 13:case"end":return r.stop()}}),r)})))()},_uploadPhaseInitialize:function(e){var t=this;return this.logger.debug("client: initiating upload session"),this.request(e.phases.initialize).then((function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];var o=1024*(n[0].body.fileUploadSizeLimit||2048)*1024,s=e.file.byteLength;return o&&o<s?t._uploadAbortSession.apply(t,[s].concat(n)):t._uploadApplySession.apply(t,[e].concat(n))})).then((function(e){return t.logger.debug("client: initiated upload session"),e}))},_uploadAbortSession:function(e,t){var r=this;return this.logger.debug("client: deleting uploaded file"),this.request({method:"DELETE",url:t.body.url,headers:t.options.headers}).then((function(){r.logger.debug("client: deleting uploaded file complete");var n={currentFileSizeInBytes:e,fileUploadSizeLimitInMB:t.body.fileUploadSizeLimit||2048,message:"file-upload-size-limit-enabled"};return p().reject(new Error("".concat(ze()(n))))}))},_uploadApplySession:function(e,t){var r=t.body;["upload","finalize"].reduce((function(e,t){return e[t]=l()(e[t]).reduce((function(e,t){return t.startsWith("$")&&(e[t.substr(1)]=e[t](r),We()(e,t)),e}),e[t]),e}),e.phases)},_uploadPhaseUpload:function(e){var t=this;this.logger.debug("client: uploading file");var r=this.request(e.phases.upload).then((function(e){return t.logger.debug("client: uploaded file"),e}));return(0,M.proxyEvents)(e.phases.upload.upload,r),r},_uploadPhaseFinalize:function(e){var t=this;return this.logger.debug("client: finalizing upload session"),this.request(e.phases.finalize).then((function(e){return t.logger.debug("client: finalized upload session"),e}))}},(0,ee.Z)(Qt,"_uploadPhaseUpload",[M.retry],ie()(Qt,"_uploadPhaseUpload"),Qt),Qt));or.version="undefined",function(e,t,r){e.registerPlugin=function(n,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.prototype._children[n]||o.replace){if(e.prototype._children[n]=i,o.proxies)throw new Error("Proxies are not currently supported for private plugins");if(o.interceptors&&l()(o.interceptors).forEach((function(e){r[e]=o.interceptors[e]})),o.config&&Pe()(t,o.config),vt()(o,"payloadTransformer.predicates")&&(t.payloadTransformer.predicates=t.payloadTransformer.predicates.concat(Ve()(o,"payloadTransformer.predicates"))),vt()(o,"payloadTransformer.transforms")&&(t.payloadTransformer.transforms=t.payloadTransformer.transforms.concat(Ve()(o,"payloadTransformer.transforms"))),o.onBeforeLogout)t.onBeforeLogout=t.onBeforeLogout||[],(he()(o.onBeforeLogout)?o.onBeforeLogout:[o.onBeforeLogout]).forEach((function(e){return t.onBeforeLogout.push({plugin:n,fn:e})}));if(i.prototype._definition&&i.prototype._definition.ready){var s=e.prototype._derived.ready,a=s.fn,c={deps:s.depList.concat("".concat(n,".ready")),fn:a};!function(e,t,r){var n=e._derived[t]={fn:Fe()(r)?r:r.fn,cache:!1!==r.cache,depList:r.deps||[]};n.depList.forEach((function(r){e._deps[r]=Wt()(e._deps[r]||[],[t])})),xt()(e,t,{get:function(){return this._getDerivedProperty(t)},set:function(){throw new TypeError("`".concat(t,"` is a derived property, it can't be set directly."))}})}(e.prototype,"ready",c)}}}}(Yt,zt,rr),function(e,t,r){e.registerPlugin=function(n,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.prototype._children[n]||o.replace){if(e.prototype._children[n]=i,o.proxies&&o.proxies.forEach((function(t){Jt(e.prototype,t,{deps:["".concat(n,".").concat(t)],fn:function(){return this[n][t]}})})),o.interceptors&&l()(o.interceptors).forEach((function(e){r[e]=o.interceptors[e]})),o.config&&Pe()(t,o.config),vt()(o,"payloadTransformer.predicates")&&(t.payloadTransformer.predicates=t.payloadTransformer.predicates.concat(Ve()(o,"payloadTransformer.predicates"))),vt()(o,"payloadTransformer.transforms")&&(t.payloadTransformer.transforms=t.payloadTransformer.transforms.concat(Ve()(o,"payloadTransformer.transforms"))),o.onBeforeLogout)t.onBeforeLogout=t.onBeforeLogout||[],(he()(o.onBeforeLogout)?o.onBeforeLogout:[o.onBeforeLogout]).forEach((function(e){return t.onBeforeLogout.push({plugin:n,fn:e})}));if(i.prototype._definition&&i.prototype._definition.ready){var s=e.prototype._derived.ready,a=s.fn,c={deps:s.depList.concat("".concat(n,".ready")),fn:a};Jt(e.prototype,"ready",c)}}}}(or,zt,rr);const sr=or;function ar(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};or.registerPlugin(e,t,r)}function cr(e,t,r){Yt.registerPlugin(e,t,r)}var ur={error:["log"],warn:["error","log"],info:["log"],debug:["info","log"],trace:["debug","info","log"]};function lr(e){var t=ur[e];if(t)for(t=t.slice();!console[e];)e=t.pop();return function(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=console)[e].apply(t,n)}}var dr=ye.extend({namespace:"Logger",error:lr("error"),warn:lr("warn"),log:lr("log"),info:lr("info"),debug:lr("debug"),trace:lr("trace"),version:"0.0.0-next"});ar("logger",dr);var hr=r(41609),fr=r.n(hr),pr=r(87735),mr=r(8575),gr=r(49704),vr=r.n(gr),yr=r(51707);function br(e){var t=function(){if("undefined"==typeof Reflect||!B())return!1;if(B().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(B()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,G.Z)(e);if(t){var i=(0,G.Z)(this).constructor;r=B()(n,arguments,i)}else r=n.apply(this,arguments);return(0,H.Z)(this,r)}}var Er=function(e){(0,V.Z)(r,e);var t=br(r);function r(){return(0,j.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r,[{key:"parse",value:function(e){var t=e.body||e;return Te()(this,{error:{enumerable:!0,value:t.error},errorDescription:{enumerable:!0,value:t.error_description},errorUri:{enumerable:!0,value:t.error_uri},res:{enumerable:!1,value:e}}),this.errorDescription}}]),r}(M.Exception),wr=function(e){(0,V.Z)(r,e);var t=br(r);function r(){return(0,j.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r)}(Er),Sr=function(e){(0,V.Z)(r,e);var t=br(r);function r(){return(0,j.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r)}(Er),_r=function(e){(0,V.Z)(r,e);var t=br(r);function r(){return(0,j.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r)}(Er),Tr=function(e){(0,V.Z)(r,e);var t=br(r);function r(){return(0,j.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r)}(Er),xr=function(e){(0,V.Z)(r,e);var t=br(r);function r(){return(0,j.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r)}(Er),Ar=function(e){(0,V.Z)(r,e);var t=br(r);function r(){return(0,j.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r)}(Er),Ir={OAuthError:Er,InvalidRequestError:wr,InvalidClientError:Sr,InvalidGrantError:_r,UnauthorizedClientError:Tr,UnsupportGrantTypeError:xr,InvalidScopeError:Ar,invalid_request:wr,invalid_client:Sr,invalid_grant:_r,unauthorized_client:Tr,unsupported_grant_type:xr,invalid_scope:Ar,select:function(e){return Ir[e]||Er}};const Cr=Ir;var Rr=r(91966),kr=r.n(Rr),Or=r(78149),Nr=r.n(Or),Pr=" ";function Lr(e){return e?e.split(Pr).sort().join(Pr):""}function Dr(e,t){if(!t)return"";var r=Nr()(e)?e:[e];return t.split(Pr).filter((function(e){return!r.includes(e)})).sort().join(Pr)}function Mr(e,t){var r,n,i=null!==(r=null==e?void 0:e.split(Pr))&&void 0!==r?r:[],o=null!==(n=null==t?void 0:t.split(Pr))&&void 0!==n?n:[];return kr()(i,o).sort().join(Pr)}var Ur,Br,Fr=r(14917),jr=r(78718),Vr=r.n(jr);function Hr(e,t){var r=l()(e);if(Ee()){var n=Ee()(e);t&&(n=n.filter((function(t){return ie()(e,t).enumerable}))),r.push.apply(r,n)}return r}function Gr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Hr(Object(r),!0).forEach((function(t){(0,b.Z)(e,t,r[t])})):Se()?Te()(e,Se()(r)):Hr(Object(r)).forEach((function(t){Ae()(e,t,ie()(r,t))}))}return e}function qr(e){if(400!==e.statusCode)return p().reject(e);var t=Cr.select(e.body.error);return t===Er&&e instanceof It?p().reject(e):t?p().reject(new t(e._res||e)):p().reject(e)}var $r=ye.extend((Ur=(0,M.oneFlight)({keyFactory:function(e){return e}}),Br={derived:{canAuthorize:{deps:["access_token","isExpired"],fn:function(){return!!this.access_token&&!this.isExpired}},canDownscope:{deps:["canAuthorize"],fn:function(){return this.canAuthorize&&!!this.config.client_id}},canRefresh:{deps:["refresh_token"],fn:function(){return M.inBrowser?!!this.refresh_token&&!!this.config.refreshCallback:!!this.refresh_token&&!!this.config.client_secret}},isExpired:{deps:["expires","_isExpired"],fn:function(){return!!this.expires&&this._isExpired}},_string:{deps:["access_token","token_type"],fn:function(){return this.access_token&&this.token_type?"".concat(this.token_type," ").concat(this.access_token):""}}},namespace:"Credentials",props:{scope:"string",access_token:"string",expires:"number",expires_in:"number",refresh_token:"string",refresh_token_expires:"number",refresh_token_expires_in:"number",token_type:{default:"Bearer",type:"string"}},session:{_isExpired:{default:!1,type:"boolean"},previousToken:{type:"state"}},downscope:function(e){var t=this;return this.logger.info("token: downscoping token to ".concat(e)),this.isExpired?(this.logger.info("token: request received to downscope expired access_token"),p().reject(new Error("cannot downscope expired access token"))):this.canDownscope?""!==Mr(e,this.config.scope)?p().reject(new Error("new scope (".concat(e,") is not subset of the available scopes (").concat(this.config.scope,")"))):(e&&(e=Lr(e)),e===Lr(this.config.scope)?p().reject(new Error("token: scope reduction requires a reduced scope")):this.webex.request({method:"POST",uri:this.config.tokenUrl,addAuthHeader:!1,form:{grant_type:"urn:cisco:oauth:grant-type:scope-reduction",token:this.access_token,scope:e,client_id:this.config.client_id,self_contained_token:!0}}).then((function(r){return t.logger.info("token: downscoped token to ".concat(e)),new $r(se()(r.body,{scope:e}),{parent:t.parent})}))):(this.config.client_id?this.logger.info("token: request received to downscope invalid access_token"):this.logger.trace("token: cannot downscope without client_id"),p().reject(new Error("cannot downscope access token")))},initialize:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(h()(ye.prototype.initialize,this,[t,r]),"string"==typeof t&&(this.access_token=t),!this.access_token)throw new Error("`access_token` is required");this.expires&&(this.expires<nt()()?this._isExpired=!0:(0,yr.Lr)((function(){e._isExpired=!0}),this.expires-nt()()))},refresh:function(){var e,t=this;if(!this.canRefresh)throw new Error("Not enough information available to refresh this access token");if(M.inBrowser){if(!this.config.refreshCallback)throw new Error("Cannot refresh access token without refreshCallback");e=p().resolve(this.config.refreshCallback(this.webex,this))}return(e||this.webex.request({method:"POST",uri:this.config.tokenUrl,form:{grant_type:"refresh_token",redirect_uri:this.config.redirect_uri,refresh_token:this.refresh_token},auth:{user:this.config.client_id,pass:this.config.client_secret,sendImmediately:!0},shouldRefreshAccessToken:!1}).then((function(e){return e.body}))).then((function(e){if(!e)throw new Error("token: refreshCallback() did not produce an object");return e.refresh_token||se()(e,Vr()(t,"refresh_token","refresh_token_expires","refresh_token_expires_in")),t.access_token===e.access_token?(t.logger.error("token: new token matches current token"),p().reject(new Error("new token matches current token"))):(t.previousToken&&(t.previousToken.revoke(),t.unset("previousToken")),e.previousToken=t,e.scope=t.scope,new $r(e,{parent:t.parent}))})).catch(qr)},revoke:function(){var e=this;return this.isExpired?(this.logger.info("token: already expired, not making making revocation request"),p().resolve()):this.canAuthorize?this.config.client_secret?(this.logger.info("token: revoking access token"),this.webex.request({method:"POST",uri:this.config.revokeUrl,form:{token:this.access_token,token_type_hint:"access_token"},auth:{user:this.config.client_id,pass:this.config.client_secret,sendImmediately:!0},shouldRefreshAccessToken:!1}).then((function(){e.unset(["access_token","expires","expires_in","token_type"]),e.logger.info("token: access token revoked")})).catch(qr)):(this.logger.info("token: no client secret available, not making revocation request"),p().resolve()):(this.logger.info("token: no longer valid, not making revocation request"),p().resolve())},set:function(){var e=this._filterSetParameters.apply(this,arguments),t=(0,Fr.Z)(e,2),r=t[0],n=t[1];if(!r.token_type&&r.access_token&&r.access_token.includes(" ")){var i=r.access_token.split(" "),o=(0,Fr.Z)(i,2),s=o[0],a=o[1];r=Gr(Gr({},r),{},{access_token:a,token_type:s})}var c=nt()();return!r.expires&&r.expires_in&&(r.expires=c+1e3*r.expires_in),!r.refresh_token_expires&&r.refresh_token_expires_in&&(r.refresh_token_expires=c+1e3*r.refresh_token_expires_in),r.scope&&(r.scope=Lr(r.scope)),h()(ye.prototype.set,this,[r,n])},toString:function(){if(!this._string)throw new Error("cannot stringify Token");return this._string},validate:function(){throw new Error("Token#validate() must not be used in production")},version:"0.0.0-next"},(0,ee.Z)(Br,"downscope",[Ur],ie()(Br,"downscope"),Br),(0,ee.Z)(Br,"refresh",[M.oneFlight],ie()(Br,"refresh"),Br),(0,ee.Z)(Br,"revoke",[M.oneFlight],ie()(Br,"revoke"),Br),Br));const Zr=$r;var zr=r(90765);const Kr=r.n(zr)().extend({mainIndex:"scope",model:Zr,namespace:"Credentials"});var Wr,Jr,Yr,Qr,Xr,en,tn,rn="JS_SDK_CREDENTIALS_DOWNSCOPE_FAILED",nn="JS_SDK_CREDENTIALS_TOKEN_REFRESH_SCOPE_MISMATCH";function on(e,t){var r=l()(e);if(Ee()){var n=Ee()(e);t&&(n=n.filter((function(t){return ie()(e,t).enumerable}))),r.push.apply(r,n)}return r}function sn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?on(Object(r),!0).forEach((function(t){(0,b.Z)(e,t,r[t])})):Se()?Te()(e,Se()(r)):on(Object(r)).forEach((function(t){Ae()(e,t,ie()(r,t))}))}return e}ar("credentials",ye.extend((Wr=(0,M.oneFlight)({keyFactory:function(e){return e}}),Jr=J("@"),Yr=Z("@"),Qr=J("@"),Xr=(0,M.whileInFlight)("isRefreshing"),en=J("@"),tn={collections:{userTokens:Kr},dataTypes:{token:(0,M.makeStateDataType)(Zr,"token").dataType},derived:{canAuthorize:{deps:["supertoken","supertoken.canAuthorize","canRefresh"],fn:function(){return Boolean(this.supertoken&&this.supertoken.canAuthorize||this.canRefresh)}},canRefresh:{deps:["supertoken","supertoken.canRefresh"],fn:function(){return!!this.config.jwtRefreshCallback||Boolean(this.supertoken&&this.supertoken.canRefresh)}},isUnverifiedGuest:{deps:["supertoken"],fn:function(){var e=!1;try{e="guest"===JSON.parse(M.base64.decode(this.supertoken.access_token.split(".")[1])).user_type}catch(e){}return e}}},props:{supertoken:(0,M.makeStateDataType)(Zr,"token").prop},namespace:"Credentials",session:{isRefreshing:{default:!1,type:"boolean"},ready:{default:!1,type:"boolean"},refreshTimer:{default:void 0,type:"any"}},buildLoginUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clientType:"public"};if(e.state&&!s()(e.state))throw new Error("if specified, `options.state` must be an object");return e.client_id=this.config.client_id,e.redirect_uri=this.config.redirect_uri,e.scope=this.config.scope,(e=c()(e)).response_type||(e.response_type="public"===e.clientType?"token":"code"),We()(e,"clientType"),e.state&&(fr()(e.state)?delete e.state:e.state=M.base64.toBase64Url(ze()(e.state))),"".concat(this.config.authorizeUrl,"?").concat(pr.stringify(e))},getOrgId:function(){this.logger.info("credentials: attempting to retrieve the OrgId from token");try{return this.logger.info("credentials: trying to extract OrgId from JWT"),this.extractOrgIdFromJWT(this.supertoken.access_token)}catch(t){this.logger.info("credentials: could not extract OrgId from JWT"),this.logger.info("credentials: attempting to extract OrgId from user token");try{var e;return this.extractOrgIdFromUserToken(null===(e=this.supertoken)||void 0===e?void 0:e.access_token)}catch(e){throw this.logger.info("credentials: could not extract OrgId from user token"),e}}},extractOrgIdFromJWT:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=vr().decode(e);if(!t)throw new Error("unable to extract the OrgId from the provided JWT");if(!t.realm)throw new Error("the provided JWT does not contain an OrgId");return t.realm},extractOrgIdFromUserToken:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split("_");if(3!==e.length)throw new Error("the provided token is not a valid format");return e[2]},buildLogoutUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"".concat(this.config.logoutUrl,"?").concat(pr.stringify(sn({cisService:this.config.service,goto:this.config.redirect_uri},e)))},calcRefreshTimeout:function(e){return Math.floor((Math.floor(4*Math.random())+6)/10*e)},constructor:function(){var e=this;this._dataTypes=c()(this._dataTypes),l()(this._dataTypes).forEach((function(t){e._dataTypes[t].set&&(e._dataTypes[t].set=e._dataTypes[t].set.bind(e))}));for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];h()(ye,this,r)},downscope:function(e){var t=this;return this.supertoken.downscope(e).catch((function(r){var n,i=null!==(n=null==r?void 0:r.body)&&void 0!==n?n:r;return t.logger.warn('credentials: failed to downscope supertoken to "'.concat(e,'"'),i),t.logger.trace("credentials: falling back to supertoken for ".concat(e)),t.webex.internal.metrics.submitClientMetrics(rn,{fields:{requestedScope:e,failReason:i}}),p().resolve(new Zr(sn({scope:e},t.supertoken.serialize())),{parent:t})}))},getClientToken:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.logger.info("credentials: requesting client credentials grant"),this.webex.request({method:"POST",uri:t.uri||this.config.tokenUrl,form:{grant_type:"client_credentials",scope:t.scope||"webexsquare:admin",self_contained_token:!0},auth:{user:this.config.client_id,pass:this.config.client_secret,sendImmediately:!0},shouldRefreshAccessToken:!1}).then((function(t){return new Zr(t.body,{parent:e})})).catch((function(e){if(400!==e.statusCode)return p().reject(e);var t=Cr.select(e.body.error);return p().reject(new t(e._res||e))}))},getUserToken:function(e){var t=this;return p().resolve(!this.isRefreshing||new(p())((function(e){t.logger.info("credentials: token refresh inflight; delaying getUserToken until refresh completes"),t.once("change:isRefreshing",(function(){t.logger.info("credentials: token refresh complete; reinvoking getUserToken"),e()}))}))).then((function(){if(!t.canAuthorize)return t.logger.info("credentials: cannot produce an access token from current state"),p().reject(new Error("Current state cannot produce an access token"));if(e||(e=Dr("spark:kms",t.supertoken.scope)),(e=Lr(e))===Lr(t.supertoken.scope))return p().resolve(t.supertoken);var r=t.userTokens.get(e);return r&&r.access_token?p().resolve(r):t.downscope(e).then((0,M.tap)((function(e){return t.userTokens.add(e)})))}))},initialize:function(e,t){var r=this;e&&("string"==typeof e&&(this.supertoken=e),e.access_token&&(this.supertoken=e),e.authorization&&(e.authorization.supertoken?this.supertoken=e.authorization.supertoken:this.supertoken=e.authorization),this.supertoken&&this.supertoken.expires&&this.scheduleRefresh(this.supertoken.expires)),h()(ye.prototype.initialize,this,[e,t]),this.listenToOnce(this.parent,"change:config",(function(){if(r.config.authorizationString){var e=mr.parse(r.config.authorizationString,!0);r.config.client_id=e.query.client_id,r.config.redirect_uri=e.query.redirect_uri,r.config.scope=e.query.scope,r.config.authorizeUrl=e.href.substr(0,e.href.indexOf("?"))}})),this.webex.once("loaded",(function(){r.ready=!0}))},invalidate:function(){this.logger.info("credentials: invalidating tokens"),this.refreshTimer&&(clearTimeout(this.refreshTimer),this.unset("refreshTimer"));try{this.unset("supertoken")}catch(e){this.logger.warn("credentials: failed to clear supertoken",e)}for(;this.userTokens.models.length;)try{this.userTokens.remove(this.userTokens.models[0])}catch(e){this.logger.warn("credentials: failed to remove user token",e)}return this.logger.info("credentials: finished removing tokens"),p().resolve()},refresh:function(){var e=this;this.logger.info("credentials: refresh requested");var t=this.supertoken,r=ut()(this.userTokens.models);return this.config.jwtRefreshCallback?this.config.jwtRefreshCallback(this.webex).then((function(t){return e.webex.authorization.requestAccessTokenFromJwt({jwt:t})})):(this.webex.internal.services&&this.webex.internal.services.updateCredentialsConfig(),t.refresh().catch((function(t){if(t instanceof Er){for(e.unset("supertoken");e.userTokens.models.length;)try{e.userTokens.remove(e.userTokens.models[0])}catch(t){e.logger.warn("credentials: failed to remove user token",t)}e.webex.trigger("client:InvalidRequestError")}return p().reject(t)})).then((function(t){e.refreshTimer&&(clearTimeout(e.refreshTimer),e.unset("refreshTimer")),e.supertoken=t;var n=Mr(e.config.scope,t.scope);return""!==n&&(e.logger.warn('credentials: "'.concat(n,'" scope(s) are invalid because not listed in the supertoken, they will be excluded from user token requests.')),e.webex.internal.metrics.submitClientMetrics(nn,{fields:{invalidScopes:n}})),p().all(r.map((function(r){var n=Dr(Mr(r.scope,t.scope),r.scope);return e.downscope(n).then((function(t){return e.logger.info("credentials: revoking token for ".concat(r.scope)),r.revoke().catch((function(t){e.logger.warn("credentials: failed to revoke user token",t)})).then((function(){e.userTokens.remove(r.scope),e.userTokens.add(t)}))}))})))})).then((function(){e.scheduleRefresh(e.supertoken.expires)})))},scheduleRefresh:function(e){var t=this,r=e-nt()();if(r>0){var n=this.calcRefreshTimeout(r);this.refreshTimer=(0,yr.Lr)((function(){return t.refresh()}),n)}else this.refresh()},version:"0.0.0-next"},(0,ee.Z)(tn,"getUserToken",[Wr,Jr],ie()(tn,"getUserToken"),tn),(0,ee.Z)(tn,"initialize",[Yr],ie()(tn,"initialize"),tn),(0,ee.Z)(tn,"invalidate",[M.oneFlight,Qr],ie()(tn,"invalidate"),tn),(0,ee.Z)(tn,"refresh",[M.oneFlight,Xr,en],ie()(tn,"refresh"),tn),tn)),{proxies:["canAuthorize","canRefresh"]});var an=["discovery","limited","signin","postauth","custom"],cn="SERVICE_CATALOGS_ENUM_TYPES_STRING",un="SERVICE_CATALOGS_ENUM_TYPES_NUMBER",ln=r(52153),dn=r.n(ln);const hn="JS_SDK_SERVICE_NOT_FOUND";var fn=r(27921),pn=r.n(fn),mn=r(85579),gn=r.n(mn),vn=r(22013),yn=r.n(vn);const bn=y().extend({namespace:"ServiceUrl",props:{defaultUrl:["string",!0,void 0],hosts:["array",!1,function(){return[]}],name:["string",!0,void 0]},_generateHostUrl:function(e){var t=mr.parse(this.defaultUrl);return t.host="".concat(e).concat(t.port?":".concat(t.port):""),mr.format(t)},_getHostUrls:function(){var e=this;return this.hosts.map((function(t){return{url:e._generateHostUrl(t.host),priority:t.priority}}))},_getPriorityHostUrl:function(e){if(0===this.hosts.length)return this.defaultUrl;var t=e?this.hosts.filter((function(t){return t.id===e})):this.hosts.filter((function(e){return e.homeCluster})),r=t.filter((function(e){return!e.failed}));return t=0===r.length?t.map((function(e){return e.failed=!1,e})):r,this._generateHostUrl(t.reduce((function(e,t){return e.priority>t.priority||!e.homeCluster?t:e}),{}).host)},failHost:function(e){if(e===this.defaultUrl)return!0;var t=mr.parse(e).hostname,r=this.hosts.find((function(e){return e.host===t}));return r&&(r.failed=!0),void 0!==r},get:function(e,t){return e?this._getPriorityHostUrl(t):this.defaultUrl}});function En(e,t){var r=l()(e);if(Ee()){var n=Ee()(e);t&&(n=n.filter((function(t){return ie()(e,t).enumerable}))),r.push.apply(r,n)}return r}function wn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?En(Object(r),!0).forEach((function(t){(0,b.Z)(e,t,r[t])})):Se()?Te()(e,Se()(r)):En(Object(r)).forEach((function(t){Ae()(e,t,ie()(r,t))}))}return e}function Sn(e,t){var r=void 0!==gn()&&e[yn()]||e["@@iterator"];if(!r){if(Nr()(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return _n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return pn()(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _n(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}function _n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Tn=y().extend({namespace:"ServiceCatalog",props:{serviceGroups:["object",!0,function(){return{discovery:[],override:[],preauth:[],postauth:[],signin:[]}}],status:["object",!0,function(){return{discovery:{ready:!1,collecting:!1},override:{ready:!1,collecting:!1},preauth:{ready:!1,collecting:!1},postauth:{ready:!1,collecting:!1},signin:{ready:!1,collecting:!1}}}],isReady:["boolean",!1,!1],allowedDomains:["array",!1,function(){return[]}]},_getUrl:function(e,t){return("string"==typeof t?this.serviceGroups[t]||[]:[].concat((0,w.Z)(this.serviceGroups.override),(0,w.Z)(this.serviceGroups.postauth),(0,w.Z)(this.serviceGroups.signin),(0,w.Z)(this.serviceGroups.preauth),(0,w.Z)(this.serviceGroups.discovery))).find((function(t){return t.name===e}))},_listServiceUrls:function(){return[].concat((0,w.Z)(this.serviceGroups.override),(0,w.Z)(this.serviceGroups.postauth),(0,w.Z)(this.serviceGroups.signin),(0,w.Z)(this.serviceGroups.preauth),(0,w.Z)(this.serviceGroups.discovery))},_loadServiceUrls:function(e,t){var r=this;return t.forEach((function(t){r._getUrl(t.name,e)||r.serviceGroups[e].push(t)})),this},_unloadServiceUrls:function(e,t){var r,n=this;return t.forEach((function(t){(r=n._getUrl(t.name,e))&&n.serviceGroups[e].splice(n.serviceGroups[e].indexOf(r),1)})),this},clean:function(){this.serviceGroups.preauth.length=0,this.serviceGroups.signin.length=0,this.serviceGroups.postauth.length=0,this.status.preauth={ready:!1},this.status.signin={ready:!1},this.status.postauth={ready:!1}},findClusterId:function(e){for(var t,r=mr.parse(e),n=0,i=l()(this.serviceGroups);n<i.length;n++){var o,s=i[n],a=Sn(this.serviceGroups[s]);try{for(a.s();!(o=a.n()).done;){var c=o.value;t=mr.parse(c.defaultUrl);var u,d=Sn(c.hosts);try{for(d.s();!(u=d.n()).done;){var h=u.value;if(r.hostname===h.host&&h.id)return h.id}}catch(e){d.e(e)}finally{d.f()}if(t.hostname===r.hostname&&c.hosts.length>0){var f,p=Sn(c.hosts);try{for(p.s();!(f=p.n()).done;){var m=f.value;if(m.homeCluster)return m.id}}catch(e){p.e(e)}finally{p.f()}return c.hosts[0].id}}}catch(e){a.e(e)}finally{a.f()}}},findServiceFromClusterId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.clusterId,r=e.priorityHost,n=void 0===r||r,i=e.serviceGroup,o=("string"==typeof i?this.serviceGroups[i]||[]:[].concat((0,w.Z)(this.serviceGroups.override),(0,w.Z)(this.serviceGroups.postauth),(0,w.Z)(this.serviceGroups.signin),(0,w.Z)(this.serviceGroups.preauth),(0,w.Z)(this.serviceGroups.discovery))).find((function(e){return e.hosts.find((function(e){return e.id===t}))}));if(o)return{name:o.name,url:o.get(n,t)}},findServiceUrlFromUrl:function(e){var t=mr.parse(e);return[].concat((0,w.Z)(this.serviceGroups.discovery),(0,w.Z)(this.serviceGroups.preauth),(0,w.Z)(this.serviceGroups.signin),(0,w.Z)(this.serviceGroups.postauth),(0,w.Z)(this.serviceGroups.override)).find((function(e){return t.hostname===mr.parse(e.defaultUrl).hostname||!!e.hosts.find((function(e){return e.host===t.hostname}))}))},findAllowedDomain:function(e){var t=mr.parse(e);if(t.host)return this.allowedDomains.find((function(e){return t.host.includes(e)}))},get:function(e,t,r){var n=this._getUrl(e,r);return n?n.get(t):void 0},getAllowedDomains:function(){return(0,w.Z)(this.allowedDomains)},list:function(e,t){var r={},n="string"==typeof t?this.serviceGroups[t]||[]:[].concat((0,w.Z)(this.serviceGroups.discovery),(0,w.Z)(this.serviceGroups.preauth),(0,w.Z)(this.serviceGroups.signin),(0,w.Z)(this.serviceGroups.postauth),(0,w.Z)(this.serviceGroups.override));return n&&n.forEach((function(t){r[t.name]=t.get(e)})),r},markFailedUrl:function(e,t){var r=this,n=this._getUrl(l()(this.list()).find((function(t){return r._getUrl(t).failHost(e)})));if(n)return t?n.get(!1):n.get(!0)},setAllowedDomains:function(e){this.allowedDomains=(0,w.Z)(e)},updateServiceUrls:function(e,t){var r=this,n=this.serviceGroups[e].filter((function(e){return t.every((function(t){return t.name!==e.name}))}));return this._unloadServiceUrls(e,n),t.forEach((function(t){var n=r._getUrl(t.name,e);n?(n.defaultUrl=t.defaultUrl,n.hosts=t.hosts||[]):r._loadServiceUrls(e,[new bn(wn({},t))])})),this.status[e].ready=!0,this.trigger(e),this},waitForCatalog:function(e,t){var r=this;return new(p())((function(n,i){r.status[e].ready&&n();var o=setTimeout((function(){return i(new Error("services: timeout occured while waiting for '".concat(e,"' catalog to populate")))}),1e3*("number"==typeof t&&t>=0?t:60));r.once(e,(function(){clearTimeout(o),n()}))}))}});const xn=Tn;var An=function(){function e(t){(0,j.Z)(this,e),e.validate(t),this.catalog=t.catalog,this.default=t.defaultUri,this.hostGroup=t.hostGroup,this.id=t.id,this.priority=t.priority,this.uri=t.uri,this.failed=!1,this.replaced=!1}return(0,F.Z)(e,[{key:"active",get:function(){return!this.failed&&!this.replaced}},{key:"local",get:function(){return this.default.includes(this.hostGroup)}},{key:"service",get:function(){return this.id.split(":")[3]}},{key:"url",get:function(){var e=mr.parse(this.default);return e.host="".concat(this.uri).concat(e.port?":".concat(e.port):""),mr.format(e)}},{key:"setStatus",value:function(e){var t=e.failed,r=e.replaced;return void 0!==t&&(this.failed=t),void 0!==r&&(this.replaced=r),this}}],[{key:"polyGenerate",value:function(t){var r=t.catalog,n=t.name,i=t.url;return new e({catalog:r,defaultUri:i,hostGroup:mr.parse(i).host,id:n?"poly-head:poly-group:poly-cluster:".concat(n):void 0,priority:1,uri:mr.parse(i).host})}},{key:"validate",value:function(e){var t=e.catalog,r=e.defaultUri,n=e.hostGroup,i=e.id,o=e.priority,s=e.uri,a=function(e){throw new Error("service-host: invalid constructor parameters, ".concat(e))};an.includes(t)||a("'catalog' must be a string"),"string"!=typeof r&&a("'defaultUri' must be a string"),"string"!=typeof n&&a("'hostGroup' must be a string"),"string"==typeof i&&4===i.split(":").length||a("'id' must be a string that contains 3 ':' characters"),"number"!=typeof o&&a("'priority' must be a number"),"string"!=typeof s&&a("'uri' must be a string")}}]),e}();function In(e,t){var r=l()(e);if(Ee()){var n=Ee()(e);t&&(n=n.filter((function(t){return ie()(e,t).enumerable}))),r.push.apply(r,n)}return r}function Cn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?In(Object(r),!0).forEach((function(t){(0,b.Z)(e,t,r[t])})):Se()?Te()(e,Se()(r)):In(Object(r)).forEach((function(t){Ae()(e,t,ie()(r,t))}))}return e}var Rn=function(){function e(){(0,j.Z)(this,e),this.hosts=[]}return(0,F.Z)(e,[{key:"map",get:function(){return this.find({active:!0,local:!0,priority:!0}).reduce((function(e,t){var r={};return r[t.service]=t.url,Cn(Cn({},e),r)}),{})}},{key:"clear",value:function(e){var t=this.find(e);return this.hosts=this.hosts.filter((function(e){return!t.includes(e)})),t}},{key:"failed",value:function(e){var t=this.find(e);return t.forEach((function(e){e.setStatus({failed:!0})})),t}},{key:"filterActive",value:function(e){return"boolean"==typeof e?this.hosts.filter((function(t){return t.active===e})):(0,w.Z)(this.hosts)}},{key:"filterCatalog",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=(Nr()(t)?t:[t]).map((function(t){return e.mapCatalogName({id:t,type:cn})||t}));return r.length>0?this.hosts.filter((function(e){return r.includes(e.catalog)})):(0,w.Z)(this.hosts)}},{key:"filterCluster",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=Nr()(e)?e:[e];return t.length>0?this.hosts.filter((function(e){return t.includes(e.id)})):(0,w.Z)(this.hosts)}},{key:"filterLocal",value:function(e){return"boolean"==typeof e?this.hosts.filter((function(t){return t.local===e})):(0,w.Z)(this.hosts)}},{key:"filterPriority",value:function(t){return t?this.hosts.reduce((function(t,r){if(!r.active)return t;var n=t.find((function(e){return e.hostGroup===r.hostGroup}));return n?((e.mapCatalogName({id:n.catalog,type:un})<e.mapCatalogName({id:r.catalog,type:un})||n.priority<r.priority)&&(t.splice(t.indexOf(n,1)),t.push(r)),t):(t.push(r),t)}),[]):(0,w.Z)(this.hosts)}},{key:"filterService",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=Nr()(e)?e:[e];return t.length>0?this.hosts.filter((function(e){return t.includes(e.service)})):(0,w.Z)(this.hosts)}},{key:"filterUrl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=Nr()(e)?e:[e];return t.length>0?this.hosts.filter((function(e){return t.includes(e.url)})):(0,w.Z)(this.hosts)}},{key:"find",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.active,n=t.catalog,i=t.cluster,o=t.local,s=t.priority,a=t.service,c=t.url;return this.hosts.filter((function(t){return e.filterActive(r).includes(t)&&e.filterCatalog(n).includes(t)&&e.filterCluster(i).includes(t)&&e.filterLocal(o).includes(t)&&e.filterPriority(s).includes(t)&&e.filterService(a).includes(t)&&e.filterUrl(c).includes(t)}))}},{key:"load",value:function(){var t,r=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter((function(t){return!!e.mapCatalogName({id:t.catalog,type:cn})}));return(t=this.hosts).push.apply(t,(0,w.Z)(r.map((function(e){return new An(e)})))),this}},{key:"replaced",value:function(e){var t=this.find(e);return t.forEach((function(e){e.setStatus({replaced:!0})})),t}},{key:"reset",value:function(e){var t=this.find(e);return t.forEach((function(e){e.setStatus({failed:!1})})),t}}],[{key:"mapCatalogName",value:function(e){var t=e.id,r=e.type;if("number"==typeof t){if(r===un)return void 0!==an[t]?t:void 0;if(r===cn)return an[t]}if("string"==typeof t){if(r===cn)return an.includes(t)?t:void 0;if(r===un)return an.includes(t)?an.indexOf(t):void 0}}},{key:"mapRemoteCatalog",value:function(t){var r=t.catalog,n=t.hostCatalog,i=t.serviceLinks,o=e.mapCatalogName({id:r,type:cn});if(!an.includes(o))throw new Error("service-catalogs: '".concat(r,"' is not a valid catalog"));return l()(n).reduce((function(e,t){return e.push.apply(e,(0,w.Z)(n[t].map((function(e){return{catalog:o,defaultUri:i[e.id.split(":")[3]],hostGroup:t,id:e.id,priority:e.priority,uri:e.host}})))),e}),[])}}]),e}(),kn=function(){function e(){var t=this;(0,j.Z)(this,e),an.forEach((function(r){t[r]=e.generateCatalogState()}))}return(0,F.Z)(e,[{key:"setCollecting",value:function(e,t){this[e]&&(this[e].collecting=t)}},{key:"setReady",value:function(e,t){this[e]&&(this[e].ready=t)}}],[{key:"generateCatalogState",value:function(){return{collecting:!1,ready:!1}}}]),e}();const On={hydra:"https://api-usgov.webex.com/v1",u2c:"https://u2c.gov.ciscospark.com/u2c/api/v1"};function Nn(e,t){var r=l()(e);if(Ee()){var n=Ee()(e);t&&(n=n.filter((function(t){return ie()(e,t).enumerable}))),r.push.apply(r,n)}return r}function Pn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Nn(Object(r),!0).forEach((function(t){(0,b.Z)(e,t,r[t])})):Se()?Te()(e,Se()(r)):Nn(Object(r)).forEach((function(t){Ae()(e,t,ie()(r,t))}))}return e}var Ln=/(?:^\/)|(?:\/$)/,Dn={ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.WEBEX_CONVERSATION_CLUSTER_SERVICE||"identityLookup",Mn={ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.WEBEX_CONVERSATION_DEFAULT_CLUSTER||"".concat("urn:TEAM:us-east-2_a",":").concat(Dn),Un=ye.extend({namespace:"Services",registries:new(re()),states:new(re()),props:{validateDomains:["boolean",!1,!0]},_catalogs:new(re()),_serviceUrls:null,_hostCatalog:null,getRegistry:function(){return this.registries.get(this.webex)},getState:function(){return this.states.get(this.webex)},_getCatalog:function(){return this._catalogs.get(this.webex)},get:function(e,t,r){return this._getCatalog().get(e,t,r)},hasService:function(e){return!!this.get(e)},hasAllowedDomains:function(){return this._getCatalog().getAllowedDomains().length>0},list:function(e,t){return this._getCatalog().list(e,t)},markFailedUrl:function(e,t){return this._getCatalog().markFailedUrl(e,t)},_updateServiceUrls:function(e){this._serviceUrls=Pn(Pn({},this._serviceUrls),e)},_updateHostCatalog:function(e){this._hostCatalog=Pn(Pn({},this._hostCatalog),e)},updateServices:function(){var e,t,r=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.from,o=n.query,s=n.token,a=n.forceRefresh,c=this._getCatalog();switch(i){case"limited":t="preauth";break;case"signin":t="signin";break;default:t="postauth"}if(c.status[t].collecting)return this.waitForCatalog(t);if(c.status[t].collecting=!0,"preauth"===t){var u=o&&l()(o)[0];if(!["email","emailhash","userId","orgId","mode"].includes(u))return p().reject(new Error("a query param of email, emailhash, userId, orgId, or mode is required"))}if("preauth"===t||"signin"===t){var d=l()(o)[0];e={},"email"===d&&o.email?e.emailhash=dn()(o.email.toLowerCase()).toString():e[d]=o[d]}return this._fetchNewServiceHostmap({from:i,token:s,query:e,forceRefresh:a}).then((function(e){c.updateServiceUrls(t,e),r.updateCredentialsConfig(),c.status[t].collecting=!1})).catch((function(e){return c.status[t].collecting=!1,p().reject(e)}))},validateUser:function(e){var t=this,r=e.email,n=e.reqId,i=void 0===n?"WEBCLIENT":n,o=e.forceRefresh,s=void 0!==o&&o,a=e.activationOptions,c=void 0===a?{}:a,u=e.preloginUserId;if(this.logger.info("services: validating a user"),!r)return p().reject(new Error("`email` is required"));if(this.webex.credentials.canAuthorize)return this.updateServices({forceRefresh:s}).then((function(){return t.webex.credentials.getUserToken()})).then((function(e){return t.sendUserActivation({email:r,reqId:i,token:e.toString(),activationOptions:c,preloginUserId:u})})).then((function(e){return{activated:!0,exists:!0,details:"user is authorized via a user token",user:e}}));var l,d=this.webex.credentials.config,h=d.client_id,f=d.client_secret;return h&&f?this.collectPreauthCatalog({email:r}).then((function(){var e=t.get("idbroker",!0);return t.webex.credentials.getClientToken({uri:"".concat(e,"idb/oauth2/v1/access_token"),scope:"webexsquare:admin webexsquare:get_conversation Identity:SCIM"})})).then((function(e){return l=e.toString(),t.collectSigninCatalog({email:r,token:l,forceRefresh:s})})).catch((function(e){return{exists:"NotFound"!==e.name,activated:!1,details:"NotFound"!==e.name?"user exists but is not activated":"user does not exist and is not activated"}})).then((function(e){return p().all([e||{activated:!0,exists:!0,details:"user exists and is activated"},t.sendUserActivation({email:r,reqId:i,token:l,activationOptions:c,preloginUserId:u})])})).then((function(e){var t=(0,Fr.Z)(e,2),r=t[0],n=t[1];return Pn(Pn({},r),{},{user:n})})).catch((function(e){var t={statusCode:e.statusCode,responseText:e.body&&e.body.message,body:e.body};return p().reject(t)})):p().reject(new Error("client authentication details are not available"))},getMeetingPreferences:function(){var e=this;return this.request({method:"GET",service:"hydra",resource:"meetingPreferences"}).then((function(t){return e.logger.info("services: received user region info"),t.body})).catch((function(t){e.logger.info("services: was not able to fetch user login information",t)}))},fetchClientRegionInfo:function(){var e=this;return this.request({uri:"https://ds.ciscospark.com/v1/region",addAuthHeader:!1,headers:{"spark-user-agent":null},timeout:5e3}).then((function(t){return e.logger.info("services: received user region info"),t.body})).catch((function(t){e.logger.info("services: was not able to get user region info",t)}))},sendUserActivation:function(e){var t,r,n=this,i=e.email,o=e.reqId,s=e.token,a=e.activationOptions,c=e.preloginUserId;return this.logger.info("services: sending user activation request"),this.fetchClientRegionInfo().then((function(e){return e&&(t=e.countryCode,r=e.timezone),n.request({service:"license",resource:"users/activations",method:"POST",headers:{accept:"application/json",authorization:s,"x-prelogin-userid":c},body:Pn({email:i,reqId:o,countryCode:t,timeZone:r},a),shouldRefreshAccessToken:!1})})).then((function(e){return e.body})).catch((function(e){return p().reject(e)}))},collectPreauthCatalog:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?this.updateServices({from:"limited",query:e,forceRefresh:t}):this.updateServices({from:"limited",query:{mode:"DEFAULT_BY_PROXIMITY"},forceRefresh:t})},collectSigninCatalog:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.email,r=e.token,n=e.forceRefresh;return t?r?this.updateServices({from:"signin",query:{email:t},token:r,forceRefresh:n}):p().reject(new Error("`token` is required")):p().reject(new Error("`email` is required"))},updateCredentialsConfig:function(){var e=this.list(!0),t=e.idbroker,r=e.identity;if(t&&r){var n=this.webex.config.credentials,i=n.authorizationString,o=n.authorizeUrl;this.webex.config.credentials.authorizeUrl=i?o:"".concat(t.replace(Ln,""),"/idb/oauth2/v1/authorize"),this.webex.setConfig({credentials:{idbroker:{url:t.replace(Ln,"")},identity:{url:r.replace(Ln,"")}}})}},waitForCatalog:function(e,t){var r=this._getCatalog(),n=this.webex.credentials.supertoken;return"postauth"===e&&n&&n.access_token&&!r.status.postauth.collecting&&!r.status.postauth.ready?r.status.preauth.ready?this.updateServices():this.initServiceCatalogs():r.waitForCatalog(e,t)},waitForService:function(e){var t=this,r=e.name,n=e.timeout,i=void 0===n?5:n,o=e.url,s=this.webex.config.services,a=this._getCatalog();if(s.servicesNotNeedValidation.find((function(e){return e===r})))return p().resolve(this._serviceUrls[r]);var c=this.get(r,!0),u=this.getServiceFromUrl(o);return c||u?p().resolve(c||u.priorityUrl):a.isReady?o?p().resolve(o):(this.webex.internal.metrics.submitClientMetrics(hn,{fields:{service_name:r}}),p().reject(new Error("services: service '".concat(r,"' was not found in any of the catalogs")))):new(p())((function(e,n){p().all(["preauth","signin","postauth"].map((function(n){return s=n,a.waitForCatalog(s,i).then((function(){var n=t.get(r,!0),i=t.getServiceFromUrl(o);(n||i)&&e(n||i.priorityUrl)})).catch((function(){}));var s}))).then((function(){t.webex.internal.metrics.submitClientMetrics(hn,{fields:{service_name:r}}),n(new Error("services: service '".concat(r,"' was not found after waiting")))}))}))},_formatReceivedHostmap:function(e){this._updateHostCatalog(e.hostCatalog);var t=l()(e.hostCatalog).reduce((function(t,r){var n;if(0===e.hostCatalog[r].length)return t;var i=e.hostCatalog[r][0].id.split(":")[3],o=e.serviceLinks[i],s=t.find((function(e){return e.name===i}));return s||(s={name:i,defaultUrl:o,defaultHost:mr.parse(o).hostname,hosts:[]},t.push(s)),(n=s.hosts).push.apply(n,[{host:r,ttl:-1,priority:10,id:e.hostCatalog[r][0].id,homeCluster:s.defaultHost===r}].concat((0,w.Z)(e.hostCatalog[r].map((function(e){return Pn(Pn({},e),{},{homeCluster:s.defaultHost===r})}))))),t}),[]);return l()(e.serviceLinks).forEach((function(r){t.find((function(e){return e.name===r}))||t.push({name:r,defaultUrl:e.serviceLinks[r],defaultHost:mr.parse(e.serviceLinks[r]).hostname,hosts:[]})})),this._updateServiceUrls(e.serviceLinks),this._updateHostCatalog(e.hostCatalog),t},getClusterId:function(e){return this._getCatalog().findClusterId(e)},getServiceFromClusterId:function(e){return this._getCatalog().findServiceFromClusterId(e)},getServiceUrlFromClusterId:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).cluster,t=void 0===e?"us":e,r="us"===t?Mn:t;r.split(":").length<4&&(r="".concat(t,":").concat(Dn));var n=(this.getServiceFromClusterId({clusterId:r})||{}).url;if(!n)throw Error("Could not find service for cluster [".concat(t,"]"));return n},getServiceFromUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this._getCatalog().findServiceUrlFromUrl(e);if(t)return{name:t.name,priorityUrl:t.get(!0),defaultUrl:t.get()}},isServiceUrl:function(e){return!!this._getCatalog().findServiceUrlFromUrl(e)},isAllowedDomainUrl:function(e){return!!this._getCatalog().findAllowedDomain(e)},convertUrlToPriorityHostUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.getServiceFromUrl(e);if(!t)throw Error("No service associated with url: [".concat(e,"]"));return e.replace(t.defaultUrl,t.priorityUrl)},_fetchNewServiceHostmap:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.from,n=t.query,i=t.token,o=t.forceRefresh,s=r?"/".concat(r,"/catalog"):"/catalog",a=Pn(Pn({},n),{},{format:"hostmap"});o&&(a.timestamp=(new Date).getTime());var c={method:"GET",service:"u2c",resource:s,qs:a};return i&&(c.headers={authorization:i}),this.request(c).then((function(t){var r=t.body;return e._formatReceivedHostmap(r)}))},initConfig:function(){var e=this._getCatalog(),t=this.webex.config,r=t.services,n=t.fedramp;if(r){if(n&&(r.discovery=On),r.discovery){var i=l()(r.discovery).map((function(e){return{name:e,defaultUrl:r.discovery[e]}}));e.updateServiceUrls("discovery",i)}if(r.override){var o=l()(r.override).map((function(e){return{name:e,defaultUrl:r.override[e]}}));e.updateServiceUrls("override",o)}r.allowedDomains&&e.setAllowedDomains(r.allowedDomains),this.validateDomains=r.validateDomains}},initServiceCatalogs:function(){var e=this;this.logger.info("services: initializing initial service catalogs");var t=this.webex.credentials;return p().resolve().then((function(){return t.getOrgId()})).then((function(t){return e.collectPreauthCatalog({orgId:t})})).then((function(){return t.canAuthorize?e.updateServices().catch((function(){return e.logger.warn("services: cannot retrieve postauth catalog")})):p().resolve()}))},initialize:function(){var e=this,t=new xn,r=new Rn,n=new kn;this._catalogs.set(this.webex,t),this.registries.set(this.webex,r),this.states.set(this.webex,n),this.listenToOnce(this.webex,"change:config",(function(){e.initConfig()})),this.listenToOnce(this.webex,"ready",(function(){var r=e.webex.credentials.supertoken;if(r&&r.access_token)e.initServiceCatalogs().then((function(){t.isReady=!0})).catch((function(t){return e.logger.error("services: failed to init initial services, ".concat(t.message))}));else{var n=e.webex.config.email;e.collectPreauthCatalog(n?{email:n}:void 0)}}))},version:"0.0.0-next"});const Bn=Un;function Fn(e){var t=function(){if("undefined"==typeof Reflect||!B())return!1;if(B().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(B()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,G.Z)(e);if(t){var i=(0,G.Z)(this).constructor;r=B()(n,arguments,i)}else r=n.apply(this,arguments);return(0,H.Z)(this,r)}}var jn=function(e){(0,V.Z)(r,e);var t=Fn(r);function r(){return(0,j.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r,[{key:"onResponseError",value:function(e,t){if((t instanceof It.InternalServerError||t instanceof It.BadGateway||t instanceof It.ServiceUnavailable)&&e.uri){var r=this.webex.internal.device.features.developer.get("web-high-availability");if(r&&r.value)return this.webex.internal.metrics.submitClientMetrics("web-ha",{fields:{success:!1},tags:{action:"failed",error:t.message,url:e.uri}}),p().resolve(this.webex.internal.services.markFailedUrl(e.uri)).then((function(){return p().reject(t)}))}return p().reject(t)}}],[{key:"create",value:function(){return new r({webex:this})}}]),r}(Ye.nK);function Vn(e){var t=function(){if("undefined"==typeof Reflect||!B())return!1;if(B().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(B()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,G.Z)(e);if(t){var i=(0,G.Z)(this).constructor;r=B()(n,arguments,i)}else r=n.apply(this,arguments);return(0,H.Z)(this,r)}}var Hn=/(?:^\/)|(?:\/$)/,Gn=function(e){(0,V.Z)(r,e);var t=Vn(r);function r(){return(0,j.Z)(this,r),t.apply(this,arguments)}return(0,F.Z)(r,[{key:"onRequest",value:function(e){var t=this;if(e.uri)return e;this.normalizeOptions(e),this.validateOptions(e);var r=this.webex.internal.services,n=e.service,i=e.resource,o=e.waitForServiceTimeout;return r.waitForService({name:n,timeout:o}).then((function(r){return e.uri=t.generateUri(r,i),e})).catch((function(){return p().reject(new Error("service-interceptor: '".concat(n,"' is not a known service")))}))}},{key:"generateUri",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=e.replace(Hn,""),n=t.replace(Hn,"");return"".concat(r,"/").concat(n)}},{key:"normalizeOptions",value:function(e){e.api&&(e.service=e.service||e.api,delete e.api)}},{key:"validateOptions",value:function(e){if(!e.resource)throw new Error("a `resource` parameter is required");if(!e.service)throw new Error("a valid 'service' parameter is required")}}],[{key:"create",value:function(){return new r({webex:this})}}]),r}(Ye.nK);cr("services",Bn,{interceptors:{ServiceInterceptor:Gn.create,ServerErrorInterceptor:jn.create}});var qn=r(82624);var $n,Zn,zn=r(44894),Kn=new(re()),Wn=($n=function(){function e(){var t,r,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,j.Z)(this,e),t=this,r="ready",i=this,(n=Zn)&&qn(t,r,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(i):void 0});var a=o.webex||s.parent;if(!a)throw new Error("One of `attrs.webex` or `options.parent` must be supplied when initializing a StatelessWebexPlugin");for(;a.parent||a.collection;)a=a.parent||a.collection;Kn.set(this,a)}return(0,F.Z)(e,[{key:"config",get:function(){var e=this.getNamespace?this.getNamespace():this.namespace;return e?(e=e.toLowerCase(),this.webex.config[e]):this.webex.config}},{key:"logger",get:function(){return this.webex.logger}},{key:"webex",get:function(){return Kn.get(this)}},{key:"request",value:function(){var e;return(e=this.webex).request.apply(e,arguments)}},{key:"upload",value:function(){var e;return(e=this.webex).upload.apply(e,arguments)}}]),e}(),Zn=(0,ee.Z)($n.prototype,"ready",[zn.OT],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),$n);se()(Wn.prototype,ce());const Jn=ye.extend({session:{deferreds:{type:"object",default:function(){return new(P())}},queue:{type:"array",default:function(){return[]}}},derived:{bounce:{fn:function(){var e=this;return(0,M.cappedDebounce)((function(){return e.executeQueue.apply(e,arguments)}),this.config.batcherWait,{maxCalls:this.config.batcherMaxCalls,maxWait:this.config.batcherMaxWait})}}},request:function(e){var t=this,r=new M.Defer;return this.fingerprintRequest(e).then((function(n){t.deferreds.has(n)?r.resolve(t.deferreds.get(n).promise):(t.deferreds.set(n,r),t.prepareItem(e).then((function(e){r.promise=r.promise.then((0,M.tap)((function(){return t.deferreds.delete(n)}))).catch((function(e){return t.deferreds.delete(n),p().reject(e)})),t.enqueue(e).then((function(){return t.bounce()})).catch((function(e){return r.reject(e)}))})).catch((function(e){return r.reject(e)})))})).catch((function(e){return r.reject(e)})),r.promise},enqueue:function(e){return this.queue.push(e),p().resolve()},prepareItem:function(e){return p().resolve(e)},executeQueue:function(){var e=this,t=this.queue.splice(0,this.config.batcherMaxCalls);return new(p())((function(r){r(e.prepareRequest(t).then((function(t){return e.submitHttpRequest(t).then((function(t){return e.handleHttpSuccess(t)}))})).catch((function(r){return r instanceof It?e.handleHttpError(r):p().all(t.map((function(t){return e.getDeferredForRequest(t).then((function(e){e.reject(r)}))})))})))})).catch((function(t){return e.logger.error(t),p().reject(t)}))},prepareRequest:function(e){return p().resolve(e)},submitHttpRequest:function(e){throw new Error("request() must be implemented")},handleHttpSuccess:function(e){var t=this;return p().all((e.body&&e.body.items||e.body).map((function(e){return t.acceptItem(e)})))},handleHttpError:function(e){var t=this;return e instanceof It&&vt()(e,"options.body.map")?p().all(e.options.body.map((function(r){return t.getDeferredForRequest(r).then((function(t){t.reject(e)}))}))):(this.logger.error("http error handler called without a WebexHttpError object",e),p().reject(e))},acceptItem:function(e){var t=this;return this.didItemFail(e).then((function(r){return r?t.handleItemFailure(e):t.handleItemSuccess(e)}))},didItemFail:function(e){return p().resolve(!1)},handleItemFailure:function(e){return this.getDeferredForResponse(e).then((function(t){t.reject(e)}))},handleItemSuccess:function(e){return this.getDeferredForResponse(e).then((function(t){t.resolve(e)}))},getDeferredForRequest:function(e){var t=this;return this.fingerprintRequest(e).then((function(e){var r=t.deferreds.get(e);if(!r)throw new Error("Could not find pending request for received response");return r}))},getDeferredForResponse:function(e){var t=this;return this.fingerprintResponse(e).then((function(e){var r=t.deferreds.get(e);if(!r)throw new Error("Could not find pending request for received response");return r}))},fingerprintRequest:function(e){throw new Error("fingerprintRequest() must be implemented")},fingerprintResponse:function(e){throw new Error("fingerprintResponse() must be implemented")},version:"0.0.0-next"});var Yn=new(re()),Qn=new(re()),Xn=new(re()),ei=function(e){function t(e,r){return(0,j.Z)(this,t),Yn.set(this,e.body.items),Qn.set(this,t.parseLinkHeaders(e.headers.link)),Xn.set(this,r),this}return(0,F.Z)(t,[{key:"items",get:function(){return Yn.get(this)}},{key:"length",get:function(){return this.items.length}},{key:"links",get:function(){return Qn.get(this)}},{key:"webex",get:function(){return Xn.get(this)}},{key:"next",value:function(){return this.getLink("next")}},{key:"hasNext",value:function(){return this.hasLink("next")}},{key:"previous",value:function(){return this.getLink("previous")}},{key:"hasPrevious",value:function(){return this.hasLink("previous")}},{key:"getLink",value:function(e){var r=this;return this.webex.request({uri:this.links[e]}).then((function(e){return new t(e,r.webex)}))}},{key:"hasLink",value:function(e){return Boolean(this.links[e])}},{key:e,value:function(){var e=this,t=-1;return{next:function(){return(t+=1)<e.length?{value:e.items[t]}:{done:!0}}}}}],[{key:"parseLinkHeaders",value:function(e){return e?(e=Nr()(e)?e:[e]).reduce((function(e,t){var r=(t=t.split(";"))[0].replace("<","").replace(">","");return e[t[1].split("=")[1].replace(/"/g,"")]=r,e}),{}):{}}}]),t}(yn())},90579:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>v});var n=r(47683),i=r(8167),o=r(31314),s=r(83977),a=r.n(s),c=r(8450),u=r.n(c),l=r(73473),d=r.n(l),h=r(67857),f=r.n(h),p=new(a()),m=new(a());const g={boundedAdapter:new(function(){function e(t){(0,i.Z)(this,e),this.Bound=function(){function e(t,r){(0,i.Z)(this,e),p.set(this,t),m.set(this,r.logger)}return(0,o.Z)(e,[{key:"_getRawData",value:function(){var e=localStorage.getItem(t);return e?JSON.parse(e):{}}},{key:"_load",value:function(){return this._getRawData()[p.get(this)]||{}}},{key:"_save",value:function(e){var r=this._getRawData();r[p.get(this)]=e,localStorage.setItem(t,u()(r))}},{key:"clear",value:function(){return m.get(this).info("local-storage-store-adapter: clearing localStorage"),d().resolve(localStorage.removeItem(t))}},{key:"del",value:function(e){var t=this;return new(d())((function(r){m.get(t).info("local-storage-store-adapter: deleting `".concat(e,"`"));var n=t._load();f()(n,e),t._save(n),r()}))}},{key:"get",value:function(e){var t=this;return new(d())((function(r,i){m.get(t).debug("local-storage-store-adapter: reading `".concat(e,"`"));var o=t._load()[e];return void 0!==o?r(o):i(new n.dR("No value found for ".concat(e)))}))}},{key:"put",value:function(e,t){var r=this;return new(d())((function(n){m.get(r).debug("local-storage-store-adapter: writing `".concat(e,"`"));var i=r._load();i[e]=t,r._save(i),n()}))}}]),e}()}return(0,o.Z)(e,[{key:"bind",value:function(e,t){return t=t||{},e?t.logger?(t.logger.debug("local-storage-store-adapter: returning binding"),d().resolve(new this.Bound(e,t))):d().reject(new Error("`options.logger` is required")):d().reject(new Error("`namespace` is required"))}}]),e}())("webex"),unboundedAdapter:n.t8},v={hydra:"https://api.ciscospark.com/v1",hydraServiceUrl:"https://api.ciscospark.com/v1",credentials:{clientType:"confidential"},device:{validateDomains:!0,ephemeral:!0},storage:{boundedAdapter:g,unboundedAdapter:g}}},82239:(e,t,r)=>{r.g._babelPolyfill||r(26981),r(63993),r(83061),r(18408),r(80868),r(22899),r(60996),r(40600),r(94896),r(7712),r(16023);var n=r(82492),i=r(47683).ZP,o=r(90579),s=i.extend({webex:!0,version:"undefined"});s.init=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.config=n({sdkType:"meetings",meetings:{disableHydraId:!0}},o,e.config),new s(e)},e.exports=s},25144:(e,t,r)=>{var n=r(61070),i=r(33217),o=r(98433),s=r(4220);e.exports.Backoff=n,e.exports.FunctionCall=s,e.exports.FibonacciStrategy=o,e.exports.ExponentialStrategy=i,e.exports.fibonacci=function(e){return new n(new o(e))},e.exports.exponential=function(e){return new n(new i(e))},e.exports.call=function(e,t,r){var n=Array.prototype.slice.call(arguments);return e=n[0],t=n.slice(1,n.length-1),r=n[n.length-1],new s(e,t,r)}},61070:(e,t,r)=>{var n=r(17187),i=r(3814);function o(e){n.EventEmitter.call(this),this.backoffStrategy_=e,this.maxNumberOfRetry_=-1,this.backoffNumber_=0,this.backoffDelay_=0,this.timeoutID_=-1,this.handlers={backoff:this.onBackoff_.bind(this)}}r(89539).inherits(o,n.EventEmitter),o.prototype.failAfter=function(e){i.checkArgument(e>0,"Expected a maximum number of retry greater than 0 but got %s.",e),this.maxNumberOfRetry_=e},o.prototype.backoff=function(e){i.checkState(-1===this.timeoutID_,"Backoff in progress."),this.backoffNumber_===this.maxNumberOfRetry_?(this.emit("fail",e),this.reset()):(this.backoffDelay_=this.backoffStrategy_.next(),this.timeoutID_=setTimeout(this.handlers.backoff,this.backoffDelay_),this.emit("backoff",this.backoffNumber_,this.backoffDelay_,e))},o.prototype.onBackoff_=function(){this.timeoutID_=-1,this.emit("ready",this.backoffNumber_,this.backoffDelay_),this.backoffNumber_++},o.prototype.reset=function(){this.backoffNumber_=0,this.backoffStrategy_.reset(),clearTimeout(this.timeoutID_),this.timeoutID_=-1},e.exports=o},4220:(e,t,r)=>{var n=r(17187),i=r(3814),o=r(89539),s=r(61070),a=r(98433);function c(e,t,r){n.EventEmitter.call(this),i.checkIsFunction(e,"Expected fn to be a function."),i.checkIsArray(t,"Expected args to be an array."),i.checkIsFunction(r,"Expected callback to be a function."),this.function_=e,this.arguments_=t,this.callback_=r,this.lastResult_=[],this.numRetries_=0,this.backoff_=null,this.strategy_=null,this.failAfter_=-1,this.retryPredicate_=c.DEFAULT_RETRY_PREDICATE_,this.state_=c.State_.PENDING}o.inherits(c,n.EventEmitter),c.State_={PENDING:0,RUNNING:1,COMPLETED:2,ABORTED:3},c.DEFAULT_RETRY_PREDICATE_=function(e){return!0},c.prototype.isPending=function(){return this.state_==c.State_.PENDING},c.prototype.isRunning=function(){return this.state_==c.State_.RUNNING},c.prototype.isCompleted=function(){return this.state_==c.State_.COMPLETED},c.prototype.isAborted=function(){return this.state_==c.State_.ABORTED},c.prototype.setStrategy=function(e){return i.checkState(this.isPending(),"FunctionCall in progress."),this.strategy_=e,this},c.prototype.retryIf=function(e){return i.checkState(this.isPending(),"FunctionCall in progress."),this.retryPredicate_=e,this},c.prototype.getLastResult=function(){return this.lastResult_.concat()},c.prototype.getNumRetries=function(){return this.numRetries_},c.prototype.failAfter=function(e){return i.checkState(this.isPending(),"FunctionCall in progress."),this.failAfter_=e,this},c.prototype.abort=function(){this.isCompleted()||this.isAborted()||(this.isRunning()&&this.backoff_.reset(),this.state_=c.State_.ABORTED,this.lastResult_=[new Error("Backoff aborted.")],this.emit("abort"),this.doCallback_())},c.prototype.start=function(e){i.checkState(!this.isAborted(),"FunctionCall is aborted."),i.checkState(this.isPending(),"FunctionCall already started.");var t=this.strategy_||new a;this.backoff_=e?e(t):new s(t),this.backoff_.on("ready",this.doCall_.bind(this,!0)),this.backoff_.on("fail",this.doCallback_.bind(this)),this.backoff_.on("backoff",this.handleBackoff_.bind(this)),this.failAfter_>0&&this.backoff_.failAfter(this.failAfter_),this.state_=c.State_.RUNNING,this.doCall_(!1)},c.prototype.doCall_=function(e){e&&this.numRetries_++;var t=["call"].concat(this.arguments_);n.EventEmitter.prototype.emit.apply(this,t);var r=this.handleFunctionCallback_.bind(this);this.function_.apply(null,this.arguments_.concat(r))},c.prototype.doCallback_=function(){this.callback_.apply(null,this.lastResult_)},c.prototype.handleFunctionCallback_=function(){if(!this.isAborted()){var e=Array.prototype.slice.call(arguments);this.lastResult_=e,n.EventEmitter.prototype.emit.apply(this,["callback"].concat(e));var t=e[0];t&&this.retryPredicate_(t)?this.backoff_.backoff(t):(this.state_=c.State_.COMPLETED,this.doCallback_())}},c.prototype.handleBackoff_=function(e,t,r){this.emit("backoff",e,t,r)},e.exports=c},33217:(e,t,r)=>{var n=r(89539),i=r(3814),o=r(99618);function s(e){o.call(this,e),this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay(),this.factor_=s.DEFAULT_FACTOR,e&&void 0!==e.factor&&(i.checkArgument(e.factor>1,"Exponential factor should be greater than 1 but got %s.",e.factor),this.factor_=e.factor)}n.inherits(s,o),s.DEFAULT_FACTOR=2,s.prototype.next_=function(){return this.backoffDelay_=Math.min(this.nextBackoffDelay_,this.getMaxDelay()),this.nextBackoffDelay_=this.backoffDelay_*this.factor_,this.backoffDelay_},s.prototype.reset_=function(){this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay()},e.exports=s},98433:(e,t,r)=>{var n=r(89539),i=r(99618);function o(e){i.call(this,e),this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay()}n.inherits(o,i),o.prototype.next_=function(){var e=Math.min(this.nextBackoffDelay_,this.getMaxDelay());return this.nextBackoffDelay_+=this.backoffDelay_,this.backoffDelay_=e,e},o.prototype.reset_=function(){this.nextBackoffDelay_=this.getInitialDelay(),this.backoffDelay_=0},e.exports=o},99618:(e,t,r)=>{r(17187),r(89539);function n(e){return null!=e}function i(e){if(n((e=e||{}).initialDelay)&&e.initialDelay<1)throw new Error("The initial timeout must be greater than 0.");if(n(e.maxDelay)&&e.maxDelay<1)throw new Error("The maximal timeout must be greater than 0.");if(this.initialDelay_=e.initialDelay||100,this.maxDelay_=e.maxDelay||1e4,this.maxDelay_<=this.initialDelay_)throw new Error("The maximal backoff delay must be greater than the initial backoff delay.");if(n(e.randomisationFactor)&&(e.randomisationFactor<0||e.randomisationFactor>1))throw new Error("The randomisation factor must be between 0 and 1.");this.randomisationFactor_=e.randomisationFactor||0}i.prototype.getMaxDelay=function(){return this.maxDelay_},i.prototype.getInitialDelay=function(){return this.initialDelay_},i.prototype.next=function(){var e=this.next_(),t=1+Math.random()*this.randomisationFactor_;return Math.round(e*t)},i.prototype.next_=function(){throw new Error("BackoffStrategy.next_() unimplemented.")},i.prototype.reset=function(){this.reset_()},i.prototype.reset_=function(){throw new Error("BackoffStrategy.reset_() unimplemented.")},e.exports=i},79742:(e,t)=>{"use strict";t.byteLength=function(e){var t=a(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,o=a(e),s=o[0],c=o[1],u=new i(function(e,t,r){return 3*(t+r)/4-r}(0,s,c)),l=0,d=c>0?s-4:s;for(r=0;r<d;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;2===c&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,u[l++]=255&t);1===c&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t);return u},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],s=16383,a=0,u=n-i;a<u;a+=s)o.push(c(e,a,a+s>u?u:a+s));1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return o.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)r[s]=o[s],n[o.charCodeAt(s)]=s;function a(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function c(e,t,n){for(var i,o,s=[],a=t;a<n;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return s.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},82240:(e,t,r)=>{"use strict";var n=r(31518);function i(e,t){return void 0===t&&(t="utf8"),Buffer.isBuffer(e)?s(e.toString("base64")):s(Buffer.from(e,t).toString("base64"))}function o(e){return e=e.toString(),n.default(e).replace(/\-/g,"+").replace(/_/g,"/")}function s(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}var a=i;a.encode=i,a.decode=function(e,t){return void 0===t&&(t="utf8"),Buffer.from(o(e),"base64").toString(t)},a.toBase64=o,a.fromBase64=s,a.toBuffer=function(e){return Buffer.from(o(e),"base64")},t.default=a},31518:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.length,r=t%4;if(!r)return e;var n=t,i=4-r,o=t+i,s=Buffer.alloc(o);for(s.write(e);i--;)s.write("=",n++);return s.toString()}},45772:(e,t,r)=>{e.exports=r(82240).default,e.exports.default=e.exports},51206:function(e){e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=90)}({17:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n=r(18),i=function(){function e(){}return e.getFirstMatch=function(e,t){var r=t.match(e);return r&&r.length>0&&r[1]||""},e.getSecondMatch=function(e,t){var r=t.match(e);return r&&r.length>1&&r[2]||""},e.matchAndReturnConst=function(e,t,r){if(e.test(t))return r},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,r,n){void 0===n&&(n=!1);var i=e.getVersionPrecision(t),o=e.getVersionPrecision(r),s=Math.max(i,o),a=0,c=e.map([t,r],(function(t){var r=s-e.getVersionPrecision(t),n=t+new Array(r+1).join(".0");return e.map(n.split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));for(n&&(a=s-Math.min(i,o)),s-=1;s>=a;){if(c[0][s]>c[1][s])return 1;if(c[0][s]===c[1][s]){if(s===a)return 0;s-=1}else if(c[0][s]<c[1][s])return-1}},e.map=function(e,t){var r,n=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(r=0;r<e.length;r+=1)n.push(t(e[r]));return n},e.find=function(e,t){var r,n;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(r=0,n=e.length;r<n;r+=1){var i=e[r];if(t(i,r))return i}},e.assign=function(e){for(var t,r,n=e,i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];if(Object.assign)return Object.assign.apply(Object,[e].concat(o));var a=function(){var e=o[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach((function(t){n[t]=e[t]}))};for(t=0,r=o.length;t<r;t+=1)a();return e},e.getBrowserAlias=function(e){return n.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return n.BROWSER_MAP[e]||""},e}();t.default=i,e.exports=t.default},18:function(e,t,r){"use strict";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,i=(n=r(91))&&n.__esModule?n:{default:n},o=r(18);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(){}var t,r,n;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new i.default(e,t)},e.parse=function(e){return new i.default(e).getResult()},t=e,n=[{key:"BROWSER_MAP",get:function(){return o.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return o.ENGINE_MAP}},{key:"OS_MAP",get:function(){return o.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return o.PLATFORMS_MAP}}],(r=null)&&s(t.prototype,r),n&&s(t,n),e}();t.default=a,e.exports=t.default},91:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n=c(r(92)),i=c(r(93)),o=c(r(94)),s=c(r(95)),a=c(r(17));function c(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=a.default.find(n.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=a.default.find(i.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=a.default.find(o.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=a.default.find(s.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return a.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,r={},n=0,i={},o=0;if(Object.keys(e).forEach((function(t){var s=e[t];"string"==typeof s?(i[t]=s,o+=1):"object"==typeof s&&(r[t]=s,n+=1)})),n>0){var s=Object.keys(r),c=a.default.find(s,(function(e){return t.isOS(e)}));if(c){var u=this.satisfies(r[c]);if(void 0!==u)return u}var l=a.default.find(s,(function(e){return t.isPlatform(e)}));if(l){var d=this.satisfies(r[l]);if(void 0!==d)return d}}if(o>0){var h=Object.keys(i),f=a.default.find(h,(function(e){return t.isBrowser(e,!0)}));if(void 0!==f)return this.compareVersion(i[f])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var r=this.getBrowserName().toLowerCase(),n=e.toLowerCase(),i=a.default.getBrowserTypeByAlias(n);return t&&i&&(n=i.toLowerCase()),n===r},t.compareVersion=function(e){var t=[0],r=e,n=!1,i=this.getBrowserVersion();if("string"==typeof i)return">"===e[0]||"<"===e[0]?(r=e.substr(1),"="===e[1]?(n=!0,r=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?r=e.substr(1):"~"===e[0]&&(n=!0,r=e.substr(1)),t.indexOf(a.default.compareVersions(i,r,n))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=u,e.exports=t.default},92:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=/version\/(\d+(\.?_?\d+)+)/i,s=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},r=i.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},r=i.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},r=i.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},r=i.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},r=i.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},r=i.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},r=i.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},r=i.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},r=i.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},r=i.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},r=i.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},r=i.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},r=i.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},r=i.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},r=i.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return r&&(t.version=r),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},r=i.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},r=i.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},r=i.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},r=i.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},r=i.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},r=i.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},r=i.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},r=i.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},r=i.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},r=i.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},r=i.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},r=i.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t={name:"Android Browser"},r=i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},r=i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},r=i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:i.default.getFirstMatch(t,e),version:i.default.getSecondMatch(t,e)}}}];t.default=s,e.exports=t.default},93:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=r(18),s=[{test:[/Roku\/DVP/],describe:function(e){var t=i.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:o.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=i.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=i.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),r=i.default.getWindowsVersionName(t);return{name:o.OS_MAP.Windows,version:t,versionName:r}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:o.OS_MAP.iOS},r=i.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return r&&(t.version=r),t}},{test:[/macintosh/i],describe:function(e){var t=i.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),r=i.default.getMacOSVersionName(t),n={name:o.OS_MAP.MacOS,version:t};return r&&(n.versionName=r),n}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=i.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:o.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t=i.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),r=i.default.getAndroidVersionName(t),n={name:o.OS_MAP.Android,version:t};return r&&(n.versionName=r),n}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=i.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),r={name:o.OS_MAP.WebOS};return t&&t.length&&(r.version=t),r}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=i.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||i.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||i.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:o.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=i.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=i.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:o.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:o.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=i.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.PlayStation4,version:t}}}];t.default=s,e.exports=t.default},94:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=r(18),s=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=i.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",r={type:o.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(r.model=t),r}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),r=e.test(/like (ipod|iphone)/i);return t&&!r},describe:function(e){var t=i.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:o.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}}];t.default=s,e.exports=t.default},95:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=r(18),s=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:o.ENGINE_MAP.Blink};var t=i.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:o.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:o.ENGINE_MAP.Trident},r=i.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:o.ENGINE_MAP.Presto},r=i.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){var t=e.test(/gecko/i),r=e.test(/like gecko/i);return t&&!r},describe:function(e){var t={name:o.ENGINE_MAP.Gecko},r=i.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:o.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:o.ENGINE_MAP.WebKit},r=i.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}}];t.default=s,e.exports=t.default}})},50706:e=>{!function(){"use strict";e.exports=function(e){return(e instanceof Buffer?e:Buffer.from(e.toString(),"binary")).toString("base64")}}()},88500:(e,t,r)=>{"use strict";var n=r(48764).Buffer,i=r(48764).SlowBuffer;function o(e,t){if(!n.isBuffer(e)||!n.isBuffer(t))return!1;if(e.length!==t.length)return!1;for(var r=0,i=0;i<e.length;i++)r|=e[i]^t[i];return 0===r}e.exports=o,o.install=function(){n.prototype.equal=i.prototype.equal=function(e){return o(this,e)}};var s=n.prototype.equal,a=i.prototype.equal;o.restore=function(){n.prototype.equal=s,i.prototype.equal=a}},48764:(e,t,r)=>{"use strict";const n=r(79742),i=r(80645),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50;const s=2147483647;function a(e){if(e>s)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,c.prototype),t}function c(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return d(e)}return u(e,t,r)}function u(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!c.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|m(e,t);let n=a(r);const i=n.write(e,t);i!==r&&(n=n.slice(0,i));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(W(e,Uint8Array)){const t=new Uint8Array(e);return f(t.buffer,t.byteOffset,t.byteLength)}return h(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(W(e,ArrayBuffer)||e&&W(e.buffer,ArrayBuffer))return f(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(W(e,SharedArrayBuffer)||e&&W(e.buffer,SharedArrayBuffer)))return f(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return c.from(n,t,r);const i=function(e){if(c.isBuffer(e)){const t=0|p(e.length),r=a(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||J(e.length)?a(0):h(e);if("Buffer"===e.type&&Array.isArray(e.data))return h(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return c.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function d(e){return l(e),a(e<0?0:0|p(e))}function h(e){const t=e.length<0?0:0|p(e.length),r=a(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function f(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,c.prototype),n}function p(e){if(e>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function m(e,t){if(c.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||W(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return Z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return z(e).length;default:if(i)return n?-1:Z(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return k(this,t,r);case"utf8":case"utf-8":return A(this,t,r);case"ascii":return C(this,t,r);case"latin1":case"binary":return R(this,t,r);case"base64":return x(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function v(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function y(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),J(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=c.from(t,n)),c.isBuffer(t))return 0===t.length?-1:b(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):b(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function b(e,t,r,n,i){let o,s=1,a=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,r/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){let n=-1;for(o=r;o<a;o++)if(u(e,o)===u(t,-1===n?0:o-n)){if(-1===n&&(n=o),o-n+1===c)return n*s}else-1!==n&&(o-=o-n),n=-1}else for(r+c>a&&(r=a-c),o=r;o>=0;o--){let r=!0;for(let n=0;n<c;n++)if(u(e,o+n)!==u(t,n)){r=!1;break}if(r)return o}return-1}function E(e,t,r,n){r=Number(r)||0;const i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;const o=t.length;let s;for(n>o/2&&(n=o/2),s=0;s<n;++s){const n=parseInt(t.substr(2*s,2),16);if(J(n))return s;e[r+s]=n}return s}function w(e,t,r,n){return K(Z(t,e.length-r),e,r,n)}function S(e,t,r,n){return K(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function _(e,t,r,n){return K(z(t),e,r,n)}function T(e,t,r,n){return K(function(e,t){let r,n,i;const o=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function x(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function A(e,t,r){r=Math.min(e.length,r);const n=[];let i=t;for(;i<r;){const t=e[i];let o=null,s=t>239?4:t>223?3:t>191?2:1;if(i+s<=r){let r,n,a,c;switch(s){case 1:t<128&&(o=t);break;case 2:r=e[i+1],128==(192&r)&&(c=(31&t)<<6|63&r,c>127&&(o=c));break;case 3:r=e[i+1],n=e[i+2],128==(192&r)&&128==(192&n)&&(c=(15&t)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:r=e[i+1],n=e[i+2],a=e[i+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),i+=s}return function(e){const t=e.length;if(t<=I)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=I));return r}(n)}t.kMaxLength=s,c.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(e,t,r){return u(e,t,r)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(e,t,r){return function(e,t,r){return l(e),e<=0?a(e):void 0!==t?"string"==typeof r?a(e).fill(t,r):a(e).fill(t):a(e)}(e,t,r)},c.allocUnsafe=function(e){return d(e)},c.allocUnsafeSlow=function(e){return d(e)},c.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==c.prototype},c.compare=function(e,t){if(W(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),W(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=c.allocUnsafe(t);let i=0;for(r=0;r<e.length;++r){let t=e[r];if(W(t,Uint8Array))i+t.length>n.length?(c.isBuffer(t)||(t=c.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else{if(!c.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,i)}i+=t.length}return n},c.byteLength=m,c.prototype._isBuffer=!0,c.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)v(this,t,t+1);return this},c.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},c.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},c.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?A(this,0,e):g.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){let e="";const r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},o&&(c.prototype[o]=c.prototype.inspect),c.prototype.compare=function(e,t,r,n,i){if(W(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;let o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0);const a=Math.min(o,s),u=this.slice(n,i),l=e.slice(t,r);for(let e=0;e<a;++e)if(u[e]!==l[e]){o=u[e],s=l[e];break}return o<s?-1:s<o?1:0},c.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},c.prototype.indexOf=function(e,t,r){return y(this,e,t,r,!0)},c.prototype.lastIndexOf=function(e,t,r){return y(this,e,t,r,!1)},c.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return E(this,e,t,r);case"utf8":case"utf-8":return w(this,e,t,r);case"ascii":case"latin1":case"binary":return S(this,e,t,r);case"base64":return _(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const I=4096;function C(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function R(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function k(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=t;n<r;++n)i+=Y[e[n]];return i}function O(e,t,r){const n=e.slice(t,r);let i="";for(let e=0;e<n.length-1;e+=2)i+=String.fromCharCode(n[e]+256*n[e+1]);return i}function N(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function P(e,t,r,n,i,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function L(e,t,r,n,i){H(t,n,i,e,r,7);let o=Number(t&BigInt(4294967295));e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,r}function D(e,t,r,n,i){H(t,n,i,e,r,7);let o=Number(t&BigInt(4294967295));e[r+7]=o,o>>=8,e[r+6]=o,o>>=8,e[r+5]=o,o>>=8,e[r+4]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=s,s>>=8,e[r+2]=s,s>>=8,e[r+1]=s,s>>=8,e[r]=s,r+8}function M(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function U(e,t,r,n,o){return t=+t,r>>>=0,o||M(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function B(e,t,r,n,o){return t=+t,r>>>=0,o||M(e,0,r,8),i.write(e,t,r,n,52,8),r+8}c.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,c.prototype),n},c.prototype.readUintLE=c.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||N(e,t,this.length);let n=this[e],i=1,o=0;for(;++o<t&&(i*=256);)n+=this[e+o]*i;return n},c.prototype.readUintBE=c.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||N(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},c.prototype.readUint8=c.prototype.readUInt8=function(e,t){return e>>>=0,t||N(e,1,this.length),this[e]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(e,t){return e>>>=0,t||N(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(e,t){return e>>>=0,t||N(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(e,t){return e>>>=0,t||N(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(e,t){return e>>>=0,t||N(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readBigUInt64LE=Q((function(e){G(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))})),c.prototype.readBigUInt64BE=Q((function(e){G(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),c.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||N(e,t,this.length);let n=this[e],i=1,o=0;for(;++o<t&&(i*=256);)n+=this[e+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},c.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||N(e,t,this.length);let n=t,i=1,o=this[e+--n];for(;n>0&&(i*=256);)o+=this[e+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return e>>>=0,t||N(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){e>>>=0,t||N(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(e,t){e>>>=0,t||N(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(e,t){return e>>>=0,t||N(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return e>>>=0,t||N(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readBigInt64LE=Q((function(e){G(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),c.prototype.readBigInt64BE=Q((function(e){G(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),c.prototype.readFloatLE=function(e,t){return e>>>=0,t||N(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return e>>>=0,t||N(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return e>>>=0,t||N(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return e>>>=0,t||N(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){P(this,e,t,r,Math.pow(2,8*r)-1,0)}let i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){P(this,e,t,r,Math.pow(2,8*r)-1,0)}let i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},c.prototype.writeUint8=c.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,1,255,0),this[t]=255&e,t+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigUInt64LE=Q((function(e,t=0){return L(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeBigUInt64BE=Q((function(e,t=0){return D(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);P(this,e,t,r,n-1,-n)}let i=0,o=1,s=0;for(this[t]=255&e;++i<r&&(o*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+r},c.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);P(this,e,t,r,n-1,-n)}let i=r-1,o=1,s=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+r},c.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},c.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigInt64LE=Q((function(e,t=0){return L(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeBigInt64BE=Q((function(e,t=0){return D(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeFloatLE=function(e,t,r){return U(this,e,t,!0,r)},c.prototype.writeFloatBE=function(e,t,r){return U(this,e,t,!1,r)},c.prototype.writeDoubleLE=function(e,t,r){return B(this,e,t,!0,r)},c.prototype.writeDoubleBE=function(e,t,r){return B(this,e,t,!1,r)},c.prototype.copy=function(e,t,r,n){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},c.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{const o=c.isBuffer(e)?e:c.from(e,n),s=o.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=o[i%s]}return this};const F={};function j(e,t,r){F[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function V(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function H(e,t,r,n,i,o){if(e>r||e<t){const n="bigint"==typeof t?"n":"";let i;throw i=o>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(o+1)}${n}`:`>= -(2${n} ** ${8*(o+1)-1}${n}) and < 2 ** ${8*(o+1)-1}${n}`:`>= ${t}${n} and <= ${r}${n}`,new F.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,r){G(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||q(t,e.length-(r+1))}(n,i,o)}function G(e,t){if("number"!=typeof e)throw new F.ERR_INVALID_ARG_TYPE(t,"number",e)}function q(e,t,r){if(Math.floor(e)!==e)throw G(e,r),new F.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new F.ERR_BUFFER_OUT_OF_BOUNDS;throw new F.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}j("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),j("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),j("ERR_OUT_OF_RANGE",(function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=V(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=V(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n}),RangeError);const $=/[^+/0-9A-Za-z-_]/g;function Z(e,t){let r;t=t||1/0;const n=e.length;let i=null;const o=[];for(let s=0;s<n;++s){if(r=e.charCodeAt(s),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function z(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace($,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function K(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function W(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function J(e){return e!=e}const Y=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function Q(e){return"undefined"==typeof BigInt?X:e}function X(){throw new Error("BigInt not supported")}},21924:(e,t,r)=>{"use strict";var n=r(40210),i=r(55559),o=i(n("String.prototype.indexOf"));e.exports=function(e,t){var r=n(e,!!t);return"function"==typeof r&&o(e,".prototype.")>-1?i(r):r}},55559:(e,t,r)=>{"use strict";var n=r(58612),i=r(40210),o=r(67771),s=i("%TypeError%"),a=i("%Function.prototype.apply%"),c=i("%Function.prototype.call%"),u=i("%Reflect.apply%",!0)||n.call(c,a),l=i("%Object.defineProperty%",!0),d=i("%Math.max%");if(l)try{l({},"a",{value:1})}catch(e){l=null}e.exports=function(e){if("function"!=typeof e)throw new s("a function is required");var t=u(n,c,arguments);return o(t,1+d(0,e.length-(arguments.length-1)),!0)};var h=function(){return u(n,a,arguments)};l?l(e.exports,"apply",{value:h}):e.exports.apply=h},44894:(e,t,r)=>{"use strict";r.d(t,{OT:()=>I});var n=Object.defineProperty;function i(e,t,r){var i=r.configurable,o=r.enumerable,s=r.initializer,a=r.value;return{configurable:i,enumerable:o,get:function(){if(this!==e){var r=s?s.call(this):a;return n(this,t,{configurable:i,enumerable:o,writable:!0,value:r}),r}},set:E(t)}}function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return v(i,t)}var s,a,c,u,l,d,h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function f(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function p(e,t,r,n,i){var o={};return Object.keys(n).forEach((function(e){o[e]=n[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}function m(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var g=Object.defineProperty;Object.getOwnPropertyDescriptor,Object.getOwnPropertyNames,Object.getOwnPropertySymbols;function v(e,t){return function(e){if(!e||!e.hasOwnProperty)return!1;for(var t=["value","initializer","get","set"],r=0,n=t.length;r<n;r++)if(e.hasOwnProperty(t[r]))return!0;return!1}(t[t.length-1])?e.apply(void 0,m(t).concat([[]])):function(){return e.apply(void 0,m(Array.prototype.slice.call(arguments)).concat([t]))}}var y=(s=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),f(this,"debounceTimeoutIds",a,this),f(this,"throttleTimeoutIds",c,this),f(this,"throttlePreviousTimestamps",u,this),f(this,"throttleTrailingArgs",l,this),f(this,"profileLastRan",d,this)},a=p(s.prototype,"debounceTimeoutIds",[o],{enumerable:!0,initializer:function(){return{}}}),c=p(s.prototype,"throttleTimeoutIds",[o],{enumerable:!0,initializer:function(){return{}}}),u=p(s.prototype,"throttlePreviousTimestamps",[o],{enumerable:!0,initializer:function(){return{}}}),l=p(s.prototype,"throttleTrailingArgs",[o],{enumerable:!0,initializer:function(){return null}}),d=p(s.prototype,"profileLastRan",[o],{enumerable:!0,initializer:function(){return null}}),s),b="function"==typeof Symbol?Symbol("__core_decorators__"):"__core_decorators__";function E(e){return function(t){return Object.defineProperty(this,e,{configurable:!0,writable:!0,enumerable:!0,value:t}),t}}function w(e,t){return e.bind?e.bind(t):function(){return e.apply(t,arguments)}}var S="object"===("undefined"==typeof console?"undefined":h(console))&&console&&"function"==typeof console.warn?w(console.warn,console):function(){};var _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var x=/^function ([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?(\([^\)]*\))[\s\S]+$/;!function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parentKlass=t,this.childKlass=r,this.parentDescriptor=n,this.childDescriptor=i}T(e,[{key:"_getTopic",value:function(e){return void 0===e?null:"value"in e?e.value:"get"in e?e.get:"set"in e?e.set:void 0}},{key:"_extractTopicSignature",value:function(e){return"function"===(void 0===e?"undefined":_(e))?this._extractFunctionSignature(e):this.key}},{key:"_extractFunctionSignature",value:function(e){var t=this;return e.toString().replace(x,(function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.key)+arguments[2]}))}},{key:"key",get:function(){return this.childDescriptor.key}},{key:"parentNotation",get:function(){return this.parentKlass.constructor.name+"#"+this.parentPropertySignature}},{key:"childNotation",get:function(){return this.childKlass.constructor.name+"#"+this.childPropertySignature}},{key:"parentTopic",get:function(){return this._getTopic(this.parentDescriptor)}},{key:"childTopic",get:function(){return this._getTopic(this.childDescriptor)}},{key:"parentPropertySignature",get:function(){return this._extractTopicSignature(this.parentTopic)}},{key:"childPropertySignature",get:function(){return this._extractTopicSignature(this.childTopic)}}]),T(e,[{key:"assert",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!0!==e&&this.error("{child} does not properly override {parent}"+t)}},{key:"error",value:function(e){var t=this;throw e=e.replace("{parent}",(function(e){return t.parentNotation})).replace("{child}",(function(e){return t.childNotation})),new SyntaxError(e)}}])}();Object.assign;Object.assign,"function"==typeof Symbol&&Symbol.iterator;Object.assign;Object.defineProperty,Object.getPrototypeOf;function A(e,t,r){return r.writable=!1,r}function I(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return v(A,t)}Object.assign;Object.assign;Object.defineProperty;"function"==typeof Symbol&&Symbol.iterator,Object.defineProperty,Object.getPrototypeOf;Object.assign;var C={};console.time&&console.time.bind(console),console.timeEnd&&console.timeEnd.bind(console);Object.assign,Object.getPrototypeOf,Object.getOwnPropertyDescriptor;var R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},k=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},O={profile:console.profile?w(console.profile,console):function(){},profileEnd:console.profileEnd?w(console.profileEnd,console):function(){},warn:S};function N(e,t,r,n){var i=k(n,3),o=i[0],s=void 0===o?null:o,a=i[1],c=void 0!==a&&a,u=i[2],l=void 0===u?O:u;if(!P.__enabled)return P.__warned||(l.warn("console.profile is not supported. All @profile decorators are disabled."),P.__warned=!0),r;var d=r.value;if(null===s&&(s=e.constructor.name+"."+t),"function"!=typeof d)throw new SyntaxError("@profile can only be used on functions, not: "+d);return R({},r,{value:function(){var e,t=Date.now(),r=(!1===(e=this).hasOwnProperty(b)&&g(e,b,{value:new y}),e[b]);(!0===c&&!r.profileLastRan||!1===c||"number"==typeof c&&t-r.profileLastRan>c||"function"==typeof c&&c.apply(this,arguments))&&(l.profile(s),r.profileLastRan=t);try{return d.apply(this,arguments)}finally{l.profileEnd(s)}}})}function P(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return v(N,t)}P.__enabled=!!console.profile,P.__warned=!1;Object.defineProperty,Object.getOwnPropertyDescriptor},78249:function(e,t,r){var n;e.exports=(n=n||function(e,t){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&void 0!==r.g&&r.g.crypto&&(n=r.g.crypto),!n)try{n=r(42480)}catch(e){}var i=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function e(){}return function(t){var r;return e.prototype=t,r=new e,e.prototype=null,r}}(),s={},a=s.lib={},c=a.Base={extend:function(e){var t=o(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},u=a.WordArray=c.extend({init:function(e,r){e=this.words=e||[],this.sigBytes=r!=t?r:4*e.length},toString:function(e){return(e||d).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,i=e.sigBytes;if(this.clamp(),n%4)for(var o=0;o<i;o++){var s=r[o>>>2]>>>24-o%4*8&255;t[n+o>>>2]|=s<<24-(n+o)%4*8}else for(var a=0;a<i;a+=4)t[n+a>>>2]=r[a>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=c.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(i());return new u.init(t,e)}}),l=s.enc={},d=l.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new u.init(r,t/2)}},h=l.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(o))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new u.init(r,t)}},f=l.Utf8={stringify:function(e){try{return decodeURIComponent(escape(h.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return h.parse(unescape(encodeURIComponent(e)))}},p=a.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r,n=this._data,i=n.words,o=n.sigBytes,s=this.blockSize,a=o/(4*s),c=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*s,l=e.min(4*c,o);if(c){for(var d=0;d<c;d+=s)this._doProcessBlock(i,d);r=i.splice(0,c),n.sigBytes-=l}return new u.init(r,l)},clone:function(){var e=c.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),m=(a.Hasher=p.extend({cfg:c.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new m.HMAC.init(e,r).finalize(t)}}}),s.algo={});return s}(Math),n)},63465:function(e,t,r){var n;e.exports=(n=r(78249),n.enc.Hex)},88010:function(e,t,r){var n;e.exports=(n=r(78249),r(52153),r(89824),n.HmacSHA256)},89824:function(e,t,r){var n,i,o,s;e.exports=(n=r(78249),o=(i=n).lib.Base,s=i.enc.Utf8,void(i.algo.HMAC=o.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=s.parse(t));var r=e.blockSize,n=4*r;t.sigBytes>n&&(t=e.finalize(t)),t.clamp();for(var i=this._oKey=t.clone(),o=this._iKey=t.clone(),a=i.words,c=o.words,u=0;u<r;u++)a[u]^=1549556828,c[u]^=909522486;i.sigBytes=o.sigBytes=n,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,r=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(r))}})))},52153:function(e,t,r){var n;e.exports=(n=r(78249),function(e){var t=n,r=t.lib,i=r.WordArray,o=r.Hasher,s=t.algo,a=[],c=[];!function(){function t(t){for(var r=e.sqrt(t),n=2;n<=r;n++)if(!(t%n))return!1;return!0}function r(e){return 4294967296*(e-(0|e))|0}for(var n=2,i=0;i<64;)t(n)&&(i<8&&(a[i]=r(e.pow(n,.5))),c[i]=r(e.pow(n,1/3)),i++),n++}();var u=[],l=s.SHA256=o.extend({_doReset:function(){this._hash=new i.init(a.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],i=r[1],o=r[2],s=r[3],a=r[4],l=r[5],d=r[6],h=r[7],f=0;f<64;f++){if(f<16)u[f]=0|e[t+f];else{var p=u[f-15],m=(p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3,g=u[f-2],v=(g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10;u[f]=m+u[f-7]+v+u[f-16]}var y=n&i^n&o^i&o,b=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),E=h+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&l^~a&d)+c[f]+u[f];h=d,d=l,l=a,a=s+E|0,s=o,o=i,i=n,n=E+(b+y)|0}r[0]=r[0]+n|0,r[1]=r[1]+i|0,r[2]=r[2]+o|0,r[3]=r[3]+s|0,r[4]=r[4]+a|0,r[5]=r[5]+l|0,r[6]=r[6]+d|0,r[7]=r[7]+h|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return r[i>>>5]|=128<<24-i%32,r[14+(i+64>>>9<<4)]=e.floor(n/4294967296),r[15+(i+64>>>9<<4)]=n,t.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=o._createHelper(l),t.HmacSHA256=o._createHmacHelper(l)}(Math),n.SHA256)},59435:e=>{var t=1e3,r=60*t,n=60*r,i=24*n,o=7*i,s=365.25*i;function a(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}e.exports=function(e,c){c=c||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!a)return;var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*s;case"weeks":case"week":case"w":return c*o;case"days":case"day":case"d":return c*i;case"hours":case"hour":case"hrs":case"hr":case"h":return c*n;case"minutes":case"minute":case"mins":case"min":case"m":return c*r;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===u&&isFinite(e))return c.long?function(e){var o=Math.abs(e);if(o>=i)return a(e,o,i,"day");if(o>=n)return a(e,o,n,"hour");if(o>=r)return a(e,o,r,"minute");if(o>=t)return a(e,o,t,"second");return e+" ms"}(e):function(e){var o=Math.abs(e);if(o>=i)return Math.round(e/i)+"d";if(o>=n)return Math.round(e/n)+"h";if(o>=r)return Math.round(e/r)+"m";if(o>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},11227:(e,t,r)=>{var n=r(34155);t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(i=n))})),t.splice(i,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==n&&"env"in n&&(e="");return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(82447)(t);const{formatters:i}=e.exports;i.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},82447:(e,t,r)=>{e.exports=function(e){function t(e){let r,i,o,s=null;function a(...e){if(!a.enabled)return;const n=a,i=Number(new Date),o=i-(r||i);n.diff=o,n.prev=r,n.curr=i,r=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,i)=>{if("%%"===r)return"%";s++;const o=t.formatters[i];if("function"==typeof o){const t=e[s];r=o.call(n,t),e.splice(s,1),s--}return r})),t.formatArgs.call(n,e);(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o),set:e=>{s=e}}),"function"==typeof t.init&&t.init(a),a}function n(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(59435),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},12296:(e,t,r)=>{"use strict";var n=r(31044)(),i=r(40210),o=n&&i("%Object.defineProperty%",!0);if(o)try{o({},"a",{value:1})}catch(e){o=!1}var s=i("%SyntaxError%"),a=i("%TypeError%"),c=r(27296);e.exports=function(e,t,r){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new a("`obj` must be an object or a function`");if("string"!=typeof t&&"symbol"!=typeof t)throw new a("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new a("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new a("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new a("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new a("`loose`, if provided, must be a boolean");var n=arguments.length>3?arguments[3]:null,i=arguments.length>4?arguments[4]:null,u=arguments.length>5?arguments[5]:null,l=arguments.length>6&&arguments[6],d=!!c&&c(e,t);if(o)o(e,t,{configurable:null===u&&d?d.configurable:!u,enumerable:null===n&&d?d.enumerable:!n,value:r,writable:null===i&&d?d.writable:!i});else{if(!l&&(n||i||u))throw new s("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");e[t]=r}}},35015:(e,t,r)=>{"use strict";var n=r(89509).Buffer,i=r(6972),o=128;function s(e){if(n.isBuffer(e))return e;if("string"==typeof e)return n.from(e,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function a(e,t,r){for(var n=0;t+n<r&&0===e[t+n];)++n;return e[t+n]>=o&&--n,n}e.exports={derToJose:function(e,t){e=s(e);var r=i(t),a=r+1,c=e.length,u=0;if(48!==e[u++])throw new Error('Could not find expected "seq"');var l=e[u++];if(l===(1|o)&&(l=e[u++]),c-u<l)throw new Error('"seq" specified length of "'+l+'", only "'+(c-u)+'" remaining');if(2!==e[u++])throw new Error('Could not find expected "int" for "r"');var d=e[u++];if(c-u-2<d)throw new Error('"r" specified length of "'+d+'", only "'+(c-u-2)+'" available');if(a<d)throw new Error('"r" specified length of "'+d+'", max of "'+a+'" is acceptable');var h=u;if(u+=d,2!==e[u++])throw new Error('Could not find expected "int" for "s"');var f=e[u++];if(c-u!==f)throw new Error('"s" specified length of "'+f+'", expected "'+(c-u)+'"');if(a<f)throw new Error('"s" specified length of "'+f+'", max of "'+a+'" is acceptable');var p=u;if((u+=f)!==c)throw new Error('Expected to consume entire buffer, but "'+(c-u)+'" bytes remain');var m=r-d,g=r-f,v=n.allocUnsafe(m+d+g+f);for(u=0;u<m;++u)v[u]=0;e.copy(v,u,h+Math.max(-m,0),h+d);for(var y=u=r;u<y+g;++u)v[u]=0;return e.copy(v,u,p+Math.max(-g,0),p+f),v=(v=v.toString("base64")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},joseToDer:function(e,t){e=s(e);var r=i(t),c=e.length;if(c!==2*r)throw new TypeError('"'+t+'" signatures must be "'+2*r+'" bytes, saw "'+c+'"');var u=a(e,0,r),l=a(e,r,e.length),d=r-u,h=r-l,f=2+d+1+1+h,p=f<o,m=n.allocUnsafe((p?2:3)+f),g=0;return m[g++]=48,p?m[g++]=f:(m[g++]=1|o,m[g++]=255&f),m[g++]=2,m[g++]=d,u<0?(m[g++]=0,g+=e.copy(m,g,0,r)):g+=e.copy(m,g,u,r),m[g++]=2,m[g++]=h,l<0?(m[g++]=0,e.copy(m,g,r)):e.copy(m,g,r+l),m}}},6972:e=>{"use strict";function t(e){return(e/8|0)+(e%8==0?0:1)}var r={ES256:t(256),ES384:t(384),ES512:t(521)};e.exports=function(e){var t=r[e];if(t)return t;throw new Error('Unknown algorithm "'+e+'"')}},82702:function(e,t,r){var n=r(34155);e.exports=function(){"use strict";function e(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}function t(e){return"function"==typeof e}var i=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=0,s=void 0,a=void 0,c=function(e,t){w[o]=e,w[o+1]=t,2===(o+=2)&&(a?a(S):T())};function u(e){a=e}function l(e){c=e}var d="undefined"!=typeof window?window:void 0,h=d||{},f=h.MutationObserver||h.WebKitMutationObserver,p="undefined"==typeof self&&void 0!==n&&"[object process]"==={}.toString.call(n),m="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function g(){return function(){return n.nextTick(S)}}function v(){return void 0!==s?function(){s(S)}:E()}function y(){var e=0,t=new f(S),r=document.createTextNode("");return t.observe(r,{characterData:!0}),function(){r.data=e=++e%2}}function b(){var e=new MessageChannel;return e.port1.onmessage=S,function(){return e.port2.postMessage(0)}}function E(){var e=setTimeout;return function(){return e(S,1)}}var w=new Array(1e3);function S(){for(var e=0;e<o;e+=2)(0,w[e])(w[e+1]),w[e]=void 0,w[e+1]=void 0;o=0}function _(){try{var e=Function("return this")().require("vertx");return s=e.runOnLoop||e.runOnContext,v()}catch(e){return E()}}var T=void 0;function x(e,t){var r=this,n=new this.constructor(C);void 0===n[I]&&K(n);var i=r._state;if(i){var o=arguments[i-1];c((function(){return q(i,n,o,r._result)}))}else H(r,n,e,t);return n}function A(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var r=new t(C);return B(r,e),r}T=p?g():f?y():m?b():void 0===d?_():E();var I=Math.random().toString(36).substring(2);function C(){}var R=void 0,k=1,O=2;function N(){return new TypeError("You cannot resolve a promise with itself")}function P(){return new TypeError("A promises callback cannot return that same promise.")}function L(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}function D(e,t,r){c((function(e){var n=!1,i=L(r,t,(function(r){n||(n=!0,t!==r?B(e,r):j(e,r))}),(function(t){n||(n=!0,V(e,t))}),"Settle: "+(e._label||" unknown promise"));!n&&i&&(n=!0,V(e,i))}),e)}function M(e,t){t._state===k?j(e,t._result):t._state===O?V(e,t._result):H(t,void 0,(function(t){return B(e,t)}),(function(t){return V(e,t)}))}function U(e,r,n){r.constructor===e.constructor&&n===x&&r.constructor.resolve===A?M(e,r):void 0===n?j(e,r):t(n)?D(e,r,n):j(e,r)}function B(t,r){if(t===r)V(t,N());else if(e(r)){var n=void 0;try{n=r.then}catch(e){return void V(t,e)}U(t,r,n)}else j(t,r)}function F(e){e._onerror&&e._onerror(e._result),G(e)}function j(e,t){e._state===R&&(e._result=t,e._state=k,0!==e._subscribers.length&&c(G,e))}function V(e,t){e._state===R&&(e._state=O,e._result=t,c(F,e))}function H(e,t,r,n){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+k]=r,i[o+O]=n,0===o&&e._state&&c(G,e)}function G(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,i=void 0,o=e._result,s=0;s<t.length;s+=3)n=t[s],i=t[s+r],n?q(r,n,i,o):i(o);e._subscribers.length=0}}function q(e,r,n,i){var o=t(n),s=void 0,a=void 0,c=!0;if(o){try{s=n(i)}catch(e){c=!1,a=e}if(r===s)return void V(r,P())}else s=i;r._state!==R||(o&&c?B(r,s):!1===c?V(r,a):e===k?j(r,s):e===O&&V(r,s))}function $(e,t){try{t((function(t){B(e,t)}),(function(t){V(e,t)}))}catch(t){V(e,t)}}var Z=0;function z(){return Z++}function K(e){e[I]=Z++,e._state=void 0,e._result=void 0,e._subscribers=[]}function W(){return new Error("Array Methods must be provided an Array")}var J=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(C),this.promise[I]||K(this.promise),i(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?j(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&j(this.promise,this._result))):V(this.promise,W())}return e.prototype._enumerate=function(e){for(var t=0;this._state===R&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===A){var i=void 0,o=void 0,s=!1;try{i=e.then}catch(e){s=!0,o=e}if(i===x&&e._state!==R)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(r===re){var a=new r(C);s?V(a,o):U(a,e,i),this._willSettleAt(a,t)}else this._willSettleAt(new r((function(t){return t(e)})),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===R&&(this._remaining--,e===O?V(n,r):this._result[t]=r),0===this._remaining&&j(n,this._result)},e.prototype._willSettleAt=function(e,t){var r=this;H(e,void 0,(function(e){return r._settledAt(k,t,e)}),(function(e){return r._settledAt(O,t,e)}))},e}();function Y(e){return new J(this,e).promise}function Q(e){var t=this;return i(e)?new t((function(r,n){for(var i=e.length,o=0;o<i;o++)t.resolve(e[o]).then(r,n)})):new t((function(e,t){return t(new TypeError("You must pass an array to race."))}))}function X(e){var t=new this(C);return V(t,e),t}function ee(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function te(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var re=function(){function e(t){this[I]=z(),this._result=this._state=void 0,this._subscribers=[],C!==t&&("function"!=typeof t&&ee(),this instanceof e?$(this,t):te())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var r=this,n=r.constructor;return t(e)?r.then((function(t){return n.resolve(e()).then((function(){return t}))}),(function(t){return n.resolve(e()).then((function(){throw t}))})):r.then(e,e)},e}();function ne(){var e=void 0;if(void 0!==r.g)e=r.g;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=re}return re.prototype.then=x,re.all=Y,re.race=Q,re.resolve=A,re.reject=X,re._setScheduler=u,re._setAsap=l,re._asap=c,re.polyfill=ne,re.Promise=re,re}()},17187:e=>{"use strict";var t,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}m(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&m(e,"error",t,r)}(e,i,{once:!0})}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function u(e,t,r,n){var i,o,s,u;if(a(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]),void 0===s)s=o[t]=r,++e._eventsCount;else if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=c(e))>0&&s.length>i&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,u=l,console&&console.warn&&console.warn(u)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=l.bind(n);return i.listener=r,n.wrapFn=i,i}function h(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):p(i,i.length)}function f(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function p(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function m(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)n(c,this,t);else{var u=c.length,l=p(c,u);for(r=0;r<u;++r)n(l[r],this,t)}return!0},o.prototype.addListener=function(e,t){return u(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return u(this,e,t,!0)},o.prototype.once=function(e,t){return a(t),this.on(e,d(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,d(this,e,t)),this},o.prototype.removeListener=function(e,t){var r,n,i,o,s;if(a(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},o.prototype.listeners=function(e){return h(this,e,!0)},o.prototype.rawListeners=function(e){return h(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},o.prototype.listenerCount=f,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},97301:function(e,t,r){var n=r(34155);!function(e){"use strict";function t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let i="undefined"!=typeof self?self:r.g;var o="undefined"!=typeof navigator,s=o&&"undefined"==typeof HTMLImageElement,a=!(void 0===r.g||void 0===n||!n.versions||!n.versions.node);let c=i.Buffer,u=i.BigInt;var l=!!c;function d(e){return f(e)?void 0:e}const h=e=>void 0!==e;function f(e){return void 0===e||(e instanceof Map?0===e.size:0===Object.values(e).filter(h).length)}function p(e){let t=new Error(e);throw delete t.stack,t}function m(e){return""===(e=function(e){for(;e.endsWith("\0");)e=e.slice(0,-1);return e}(e).trim())?void 0:e}function g(e){let t=function(e){let t=0;return e.ifd0.enabled&&(t+=1024),e.exif.enabled&&(t+=2048),e.makerNote&&(t+=2048),e.userComment&&(t+=1024),e.gps.enabled&&(t+=512),e.interop.enabled&&(t+=100),e.ifd1.enabled&&(t+=1024),t+2048}(e);return e.jfif.enabled&&(t+=50),e.xmp.enabled&&(t+=2e4),e.iptc.enabled&&(t+=14e3),e.icc.enabled&&(t+=6e3),t}const v="undefined"!=typeof TextDecoder?new TextDecoder("utf-8"):void 0;function y(e){return v?v.decode(e):l?Buffer.from(e).toString("utf8"):decodeURIComponent(escape(String.fromCharCode.apply(null,e)))}class b{static from(e,t){return e instanceof this&&e.le===t?e:new b(e,void 0,void 0,t)}constructor(e,t=0,r,n){if("boolean"==typeof n&&(this.le=n),Array.isArray(e)&&(e=new Uint8Array(e)),0===e)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){void 0===r&&(r=e.byteLength-t);let n=new DataView(e,t,r);this._swapDataView(n)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof b){void 0===r&&(r=e.byteLength-t),(t+=e.byteOffset)+r>e.byteOffset+e.byteLength&&p("Creating view outside of available memory in ArrayBuffer");let n=new DataView(e.buffer,t,r);this._swapDataView(n)}else if("number"==typeof e){let t=new DataView(new ArrayBuffer(e));this._swapDataView(t)}else p("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,r=b){return e instanceof DataView||e instanceof b?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||p("BufferView.set(): Invalid data argument."),this.toUint8().set(e,t),new r(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new b(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return y(this.getUint8Array(e,t))}getUnicodeString(e=0,t=this.byteLength){const r=[];for(let n=0;n<t&&e+n<this.byteLength;n+=2)r.push(this.getUint16(e+n));return r.map((e=>String.fromCharCode(e))).join("")}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,r){switch(t){case 1:return this.getUint8(e,r);case 2:return this.getUint16(e,r);case 4:return this.getUint32(e,r);case 8:return this.getUint64&&this.getUint64(e,r)}}getUint(e,t,r){switch(t){case 8:return this.getUint8(e,r);case 16:return this.getUint16(e,r);case 32:return this.getUint32(e,r);case 64:return this.getUint64&&this.getUint64(e,r)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}}function E(e,t){p("".concat(e," '").concat(t,"' was not loaded, try using full build of exifr."))}class w extends Map{constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||E(this.kind,e),t&&(e in t||function(e,t){p("Unknown ".concat(e," '").concat(t,"'."))}(this.kind,e),t[e].enabled||E(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}}var S=new w("file parser"),_=new w("segment parser"),T=new w("file reader");function x(e,t){return(r=e).startsWith("data:")||r.length>1e4?I(e,t,"base64"):o?A(e,t,"url",C):a?I(e,t,"fs"):void p("Invalid input argument");var r}async function A(e,t,r,n){return T.has(r)?I(e,t,r):n?async function(e,t){let r=await t(e);return new b(r)}(e,n):void p("Parser ".concat(r," is not loaded"))}async function I(e,t,r){let n=new(T.get(r))(e,t);return await n.read(),n}async function C(e){return fetch(e).then((e=>e.arrayBuffer()))}async function R(e){return new Promise(((t,r)=>{let n=new FileReader;n.onloadend=()=>t(n.result||new ArrayBuffer),n.onerror=r,n.readAsArrayBuffer(e)}))}class k extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}}function O(e,t,r){let n=new k;for(let[e,t]of r)n.set(e,t);if(Array.isArray(t))for(let r of t)e.set(r,n);else e.set(t,n);return n}function N(e,t,r){let n,i=e.get(t);for(n of r)i.set(n[0],n[1])}const P=new Map,L=new Map,D=new Map,M=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],U=["jfif","xmp","icc","iptc"],B=["tiff",...U],F=["ifd0","ifd1","exif","gps","interop"],j=[...B,...F],V=["makerNote","userComment"],H=["translateKeys","translateValues","reviveValues","multiSegment"],G=[...H,"sanitize","mergeOutput"];class q{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class $ extends q{get needed(){return this.enabled||this.deps.size>0}constructor(e,r,n,i){if(super(),t(this,"enabled",!1),t(this,"skip",new Set),t(this,"pick",new Set),t(this,"deps",new Set),t(this,"translateKeys",!1),t(this,"translateValues",!1),t(this,"reviveValues",!1),this.key=e,this.enabled=r,this.parse=this.enabled,this.applyInheritables(i),this.canBeFiltered=F.includes(e),this.canBeFiltered&&(this.dict=P.get(e)),void 0!==n)if(Array.isArray(n))this.parse=this.enabled=!0,this.canBeFiltered&&n.length>0&&this.translateTagSet(n,this.pick);else if("object"==typeof n){if(this.enabled=!0,this.parse=!1!==n.parse,this.canBeFiltered){let{pick:e,skip:t}=n;e&&e.length>0&&this.translateTagSet(e,this.pick),t&&t.length>0&&this.translateTagSet(t,this.skip)}this.applyInheritables(n)}else!0===n||!1===n?this.parse=this.enabled=n:p("Invalid options argument: ".concat(n))}applyInheritables(e){let t,r;for(t of H)r=e[t],void 0!==r&&(this[t]=r)}translateTagSet(e,t){if(this.dict){let r,n,{tagKeys:i,tagValues:o}=this.dict;for(r of e)"string"==typeof r?(n=o.indexOf(r),-1===n&&(n=i.indexOf(Number(r))),-1!==n&&t.add(Number(i[n]))):t.add(r)}else for(let r of e)t.add(r)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,Y(this.pick,this.deps)):this.enabled&&this.pick.size>0&&Y(this.pick,this.deps)}}var Z={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},z=new Map;class K extends q{static useCached(e){let t=z.get(e);return void 0!==t||(t=new this(e),z.set(e,t)),t}constructor(e){super(),!0===e?this.setupFromTrue():void 0===e?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):"object"==typeof e?this.setupFromObject(e):p("Invalid options argument ".concat(e)),void 0===this.firstChunkSize&&(this.firstChunkSize=o?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of M)this[e]=Z[e];for(e of G)this[e]=Z[e];for(e of V)this[e]=Z[e];for(e of j)this[e]=new $(e,Z[e],void 0,this)}setupFromTrue(){let e;for(e of M)this[e]=Z[e];for(e of G)this[e]=Z[e];for(e of V)this[e]=!0;for(e of j)this[e]=new $(e,!0,void 0,this)}setupFromArray(e){let t;for(t of M)this[t]=Z[t];for(t of G)this[t]=Z[t];for(t of V)this[t]=Z[t];for(t of j)this[t]=new $(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,F)}setupFromObject(e){let t;for(t of(F.ifd0=F.ifd0||F.image,F.ifd1=F.ifd1||F.thumbnail,Object.assign(this,e),M))this[t]=J(e[t],Z[t]);for(t of G)this[t]=J(e[t],Z[t]);for(t of V)this[t]=J(e[t],Z[t]);for(t of B)this[t]=new $(t,Z[t],e[t],this);for(t of F)this[t]=new $(t,Z[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,F,j),!0===e.tiff?this.batchEnableWithBool(F,!0):!1===e.tiff?this.batchEnableWithUserValue(F,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,F):"object"==typeof e.tiff&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,F)}batchEnableWithBool(e,t){for(let r of e)this[r].enabled=t}batchEnableWithUserValue(e,t){for(let r of e){let e=t[r];this[r].enabled=!1!==e&&void 0!==e}}setupGlobalFilters(e,t,r,n=r){if(e&&e.length){for(let e of n)this[e].enabled=!1;let t=W(e,r);for(let[e,r]of t)Y(this[e].pick,r),this[e].enabled=!0}else if(t&&t.length){let e=W(t,r);for(let[t,r]of e)Y(this[t].skip,r)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:r,iptc:n,icc:i}=this;this.makerNote?t.deps.add(37500):t.skip.add(37500),this.userComment?t.deps.add(37510):t.skip.add(37510),r.enabled||e.skip.add(700),n.enabled||e.skip.add(33723),i.enabled||e.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:r,interop:n}=this;n.needed&&(t.deps.add(40965),e.deps.add(40965)),t.needed&&e.deps.add(34665),r.needed&&e.deps.add(34853),this.tiff.enabled=F.some((e=>!0===this[e].enabled))||this.makerNote||this.userComment;for(let e of F)this[e].finalizeFilters()}get onlyTiff(){return!U.map((e=>this[e].enabled)).some((e=>!0===e))&&this.tiff.enabled}checkLoadedPlugins(){for(let e of B)this[e].enabled&&!_.has(e)&&E("segment parser",e)}}function W(e,t){let r,n,i,o,s=[];for(i of t){for(o of(r=P.get(i),n=[],r))(e.includes(o[0])||e.includes(o[1]))&&n.push(o[0]);n.length&&s.push([i,n])}return s}function J(e,t){return void 0!==e?e:void 0!==t?t:void 0}function Y(e,t){for(let r of t)e.add(r)}t(K,"default",Z);class Q{constructor(e){t(this,"parsers",{}),this.options=K.useCached(e)}setup(){if(this.fileParser)return;let{file:e}=this,t=e.getUint16(0);for(let[r,n]of S)if(n.canHandle(e,t))return this.fileParser=new n(this.options,this.file,this.parsers),e[r]=!0;p("Unknown file format")}async read(e){this.file=await function(e,t){return"string"==typeof e?x(e,t):o&&!s&&e instanceof HTMLImageElement?x(e.src,t):e instanceof Uint8Array||e instanceof ArrayBuffer||e instanceof DataView?new b(e):o&&e instanceof Blob?A(e,t,"blob",R):void p("Invalid input argument")}(e,this.options)}async parse(){this.setup(),await this.fileParser.parse();let e={},t=[],r=Object.values(this.parsers).map((async r=>{let n;if(this.options.silentErrors){try{n=await r.parse()}catch(e){t.push(e)}t.push(...r.errors)}else n=await r.parse();r.assignToOutput(e,n)}));return await Promise.all(r),this.options.silentErrors&&t.length>0&&(e.errors=t),this.file.close&&this.file.close(),d(e)}async extractThumbnail(){this.setup();let{options:e,file:t}=this,r=_.get("tiff",e);var n;if(t.tiff?n={start:0,type:"tiff"}:t.jpeg&&(n=await this.fileParser.getOrFindSegment("tiff")),void 0===n)return;let i=await this.fileParser.ensureSegmentChunk(n),o=this.parsers.tiff=new r(i,e,t),s=await o.extractThumbnail();return t.close&&t.close(),s}}async function X(e,t){let r=new Q(t);return await r.read(e),r.parse()}var ee=Object.freeze({__proto__:null,parse:X,Exifr:Q,fileParsers:S,segmentParsers:_,fileReaders:T,tagKeys:P,tagValues:L,tagRevivers:D,createDictionary:O,extendDictionary:N,fetchUrlAsArrayBuffer:C,readBlobAsArrayBuffer:R,chunkedProps:M,otherSegments:U,segments:B,tiffBlocks:F,segmentsAndBlocks:j,tiffExtractables:V,inheritables:H,allFormatters:G,Options:K});class te{constructor(e,r,n){t(this,"ensureSegmentChunk",(async e=>{let t=e.start,r=e.size||65536;if(this.file.chunked)if(this.file.available(t,r))e.chunk=this.file.subarray(t,r);else try{e.chunk=await this.file.readChunk(t,r)}catch(t){p("Couldn't read segment: ".concat(JSON.stringify(e),". ").concat(t.message))}else this.file.byteLength>t+r?e.chunk=this.file.subarray(t,r):void 0===e.size?e.chunk=this.file.subarray(t):p("Segment unreachable: "+JSON.stringify(e));return e.chunk})),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=r,this.parsers=n}createParser(e,t){let r=new(_.get(e))(t,this.options,this.file);return this.parsers[e]=r}}class re{static findPosition(e,t){let r=e.getUint16(t+2)+2,n="function"==typeof this.headerLength?this.headerLength(e,t,r):this.headerLength,i=t+n,o=r-n;return{offset:t,length:r,headerLength:n,start:i,size:o,end:i+o}}static parse(e,t={}){return new this(e,new K({[this.type]:t})).parse()}normalizeInput(e){return e instanceof b?e:new b(e)}constructor(e,r={},n){t(this,"errors",[]),t(this,"raw",new Map),t(this,"handleError",(e=>{if(!this.options.silentErrors)throw e;this.errors.push(e.message)})),this.chunk=this.normalizeInput(e),this.file=n,this.type=this.constructor.type,this.globalOptions=this.options=r,this.localOptions=r[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let r=D.get(t),n=L.get(t),i=P.get(t),o=this.options[t],s=o.reviveValues&&!!r,a=o.translateValues&&!!n,c=o.translateKeys&&!!i,u={};for(let[t,o]of e)s&&r.has(t)?o=r.get(t)(o):a&&n.has(t)&&(o=this.translateValue(o,n.get(t))),c&&i.has(t)&&(t=i.get(t)||t),u[t]=o;return u}translateValue(e,t){return t[e]||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,r){if(this.globalOptions.mergeOutput)return Object.assign(e,r);e[t]?Object.assign(e[t],r):e[t]=r}}function ne(e){return 192===e||194===e||196===e||219===e||221===e||218===e||254===e}function ie(e){return e>=224&&e<=239}function oe(e,t){for(let[r,n]of _)if(n.canHandle(e,t))return r}t(re,"headerLength",4),t(re,"type",void 0),t(re,"multiSegment",!1),t(re,"canHandle",(()=>!1));class se extends te{constructor(...e){super(...e),t(this,"appSegments",[]),t(this,"jpegSegments",[]),t(this,"unknownSegments",[])}static canHandle(e,t){return 65496===t}async parse(){await this.findAppSegments(),await this.readSegments(),this.mergeMultiSegments(),this.createParsers()}async readSegments(){let e=this.appSegments.map(this.ensureSegmentChunk);await Promise.all(e)}setupSegmentFinderArgs(e){!0===e?(this.findAll=!0,this.wanted=new Set(_.keyList())):(e=void 0===e?_.keyList().filter((e=>this.options[e].enabled)):e.filter((e=>this.options[e].enabled&&_.has(e))),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:r,findAll:n,wanted:i,remaining:o}=this;if(!n&&this.file.chunked&&(n=Array.from(i).some((e=>{let t=_.get(e),r=this.options[e];return t.multiSegment&&r.multiSegment})),n&&await this.file.readWhole()),e=this._findAppSegments(e,r.byteLength,n,i,o),!this.options.onlyTiff&&r.chunked){let t=!1;for(;o.size>0&&!t&&(r.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:n}=r,i=this.appSegments.some((e=>!this.file.available(e.offset||e.start,e.length||e.size)));if(t=e>n&&!i?!await r.readNextChunk(e):!await r.readNextChunk(n),void 0===(e=this._findAppSegments(e,r.byteLength)))return}}}_findAppSegments(e,t){t-=2;let r,n,i,o,s,a,{file:c,findAll:u,wanted:l,remaining:d,options:h}=this;for(;e<t;e++)if(255===c.getUint8(e))if(r=c.getUint8(e+1),ie(r)){if(n=c.getUint16(e+2),i=oe(c,e),i&&l.has(i)&&(o=_.get(i),s=o.findPosition(c,e),a=h[i],s.type=i,this.appSegments.push(s),!u&&(o.multiSegment&&a.multiSegment?(this.unfinishedMultiSegment=s.chunkNumber<s.chunkCount,this.unfinishedMultiSegment||d.delete(i)):d.delete(i),0===d.size)))break;h.recordUnknownSegments&&(s=re.findPosition(c,e),s.marker=r,this.unknownSegments.push(s)),e+=n+1}else if(ne(r)){if(n=c.getUint16(e+2),218===r&&!1!==h.stopAfterSos)return;h.recordJpegSegments&&this.jpegSegments.push({offset:e,length:n,marker:r}),e+=n+1}return e}mergeMultiSegments(){if(!this.appSegments.some((e=>e.multiSegment)))return;let e=function(e,t){let r,n,i,o=new Map;for(let s=0;s<e.length;s++)r=e[s],n=r[t],o.has(n)?i=o.get(n):o.set(n,i=[]),i.push(r);return Array.from(o)}(this.appSegments,"type");this.mergedAppSegments=e.map((([e,t])=>{let r=_.get(e,this.options);return r.handleMultiSegments?{type:e,chunk:r.handleMultiSegments(t)}:t[0]}))}async createParsers(){let e=this.mergedAppSegments||this.appSegments;for(let t of e){let{type:e,chunk:r}=t;if(!this.options[e].enabled)continue;let n=this.parsers[e];if(n&&n.append);else if(!n){let t=new(_.get(e,this.options))(r,this.options,this.file);this.parsers[e]=t}}}getSegment(e){return this.appSegments.find((t=>t.type===e))}async getOrFindSegment(e){let t=this.getSegment(e);return void 0===t&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}}t(se,"type","jpeg"),S.set("jpeg",se);const ae=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class ce extends re{parseHeader(){var e=this.chunk.getUint16();18761===e?this.le=!0:19789===e&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,r=new Map){let{pick:n,skip:i}=this.options[t];n=new Set(n);let o=n.size>0,s=0===i.size,a=this.chunk.getUint16(e);e+=2;for(let c=0;c<a;c++){let a=this.chunk.getUint16(e);if(o){if(n.has(a)&&(r.set(a,this.parseTag(e,a,t)),n.delete(a),0===n.size))break}else!s&&i.has(a)||r.set(a,this.parseTag(e,a,t));e+=12}return r}parseTag(e,t,r){let{chunk:n}=this,i=n.getUint16(e+2),o=n.getUint32(e+4),s=ae[i];if(s*o<=4?e+=8:e=n.getUint32(e+8),(i<1||i>13)&&p("Invalid TIFF value type. block: ".concat(r.toUpperCase(),", tag: ").concat(t.toString(16),", type: ").concat(i,", offset ").concat(e)),e>n.byteLength&&p("Invalid TIFF value offset. block: ".concat(r.toUpperCase(),", tag: ").concat(t.toString(16),", type: ").concat(i,", offset ").concat(e," is outside of chunk size ").concat(n.byteLength)),1===i)return n.getUint8Array(e,o);if(2===i)return m(n.getString(e,o));if(7===i)return n.getUint8Array(e,o);if(1===o)return this.parseTagValue(i,e);{let t=new(function(e){switch(e){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:case 10:default:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 11:return Float32Array;case 12:return Float64Array}}(i))(o),r=s;for(let n=0;n<o;n++)t[n]=this.parseTagValue(i,e),e+=r;return t}}parseTagValue(e,t){let{chunk:r}=this;switch(e){case 1:return r.getUint8(t);case 3:return r.getUint16(t);case 4:case 13:return r.getUint32(t);case 5:return r.getUint32(t)/r.getUint32(t+4);case 6:return r.getInt8(t);case 8:return r.getInt16(t);case 9:return r.getInt32(t);case 10:return r.getInt32(t)/r.getInt32(t+4);case 11:return r.getFloat(t);case 12:return r.getDouble(t);default:p("Invalid tiff type ".concat(e))}}}class ue extends ce{static canHandle(e,t){return 225===e.getUint8(t+1)&&1165519206===e.getUint32(t+4)&&0===e.getUint16(t+8)}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let t=this[e]();return void 0!==t.catch&&(t=t.catch(this.handleError)),t}findIfd0Offset(){void 0===this.ifd0Offset&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(void 0===this.ifd1Offset){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let r=new Map;return this[t]=r,this.parseTags(e,t,r),r}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&p("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&p("IFD0 offset points to outside of file.\nthis.ifd0Offset: ".concat(this.ifd0Offset,", file.byteLength: ").concat(e.byteLength)),e.tiff&&await e.ensureChunk(this.ifd0Offset,g(this.options));let t=this.parseBlock(this.ifd0Offset,"ifd0");return 0!==t.size?(this.exifOffset=t.get(34665),this.interopOffset=t.get(40965),this.gpsOffset=t.get(34853),this.xmp=t.get(700),this.iptc=t.get(33723),this.icc=t.get(34675),this.options.sanitize&&(t.delete(34665),t.delete(40965),t.delete(34853),t.delete(700),t.delete(33723),t.delete(34675)),t):void 0}async parseExifBlock(){if(this.exif)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.exifOffset)return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,g(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get(40965)),this.makerNote=e.get(37500),this.userComment=e.get(37510),this.options.sanitize&&(e.delete(40965),e.delete(37500),e.delete(37510)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let r=e.get(t);r&&1===r.length&&e.set(t,r[0])}async parseGpsBlock(){if(this.gps)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.gpsOffset)return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",le(...e.get(2),e.get(1))),e.set("longitude",le(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),void 0!==this.interopOffset||this.exif||await this.parseExifBlock(),void 0!==this.interopOffset))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),void 0===this.ifd1)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,r,n={};for(t of F)if(e=this[t],!f(e))if(r=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if("ifd1"===t)continue;Object.assign(n,r)}else n[t]=r;return this.makerNote&&(n.makerNote=this.makerNote),this.userComment&&(n.userComment=this.userComment),n}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[r,n]of Object.entries(t))this.assignObjectToOutput(e,r,n)}}function le(e,t,r,n){var i=e+t/60+r/3600;return"S"!==n&&"W"!==n||(i*=-1),i}t(ue,"type","tiff"),t(ue,"headerLength",10),_.set("tiff",ue);var de=Object.freeze({__proto__:null,default:ee,parse:X,Exifr:Q,fileParsers:S,segmentParsers:_,fileReaders:T,tagKeys:P,tagValues:L,tagRevivers:D,createDictionary:O,extendDictionary:N,fetchUrlAsArrayBuffer:C,readBlobAsArrayBuffer:R,chunkedProps:M,otherSegments:U,segments:B,tiffBlocks:F,segmentsAndBlocks:j,tiffExtractables:V,inheritables:H,allFormatters:G,Options:K});const he={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},fe=Object.assign({},he,{firstChunkSize:4e4,gps:[1,2,3,4]}),pe=Object.assign({},he,{firstChunkSize:4e4,ifd0:[274]}),me=Object.assign({},he,{tiff:!1,ifd1:!0,mergeOutput:!1});async function ge(e){let t=new Q(me);await t.read(e);let r=await t.extractThumbnail();return r&&l?c.from(r):r}async function ve(e){let t=await this.thumbnail(e);if(void 0!==t){let e=new Blob([t]);return URL.createObjectURL(e)}}async function ye(e){let t=new Q(fe);await t.read(e);let r=await t.parse();if(r&&r.gps){let{latitude:e,longitude:t}=r.gps;return{latitude:e,longitude:t}}}async function be(e){let t=new Q(pe);await t.read(e);let r=await t.parse();if(r&&r.ifd0)return r.ifd0[274]}const Ee={1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}};if(e.rotateCanvas=!0,e.rotateCss=!0,"object"==typeof navigator){let t=navigator.userAgent;if(t.includes("iPad")||t.includes("iPhone")){let[r,n,i]=t.match(/OS (\d+)_(\d+)/),o=Number(n)+.1*Number(i);e.rotateCanvas=o<13.4,e.rotateCss=!1}if(t.includes("Chrome/")){let[r,n]=t.match(/Chrome\/(\d+)/);Number(n)>=81&&(e.rotateCanvas=e.rotateCss=!1)}else if(t.includes("Firefox/")){let[r,n]=t.match(/Firefox\/(\d+)/);Number(n)>=77&&(e.rotateCanvas=e.rotateCss=!1)}}async function we(t){let r=await be(t);return Object.assign({canvas:e.rotateCanvas,css:e.rotateCss},Ee[r])}class Se extends b{constructor(...e){super(...e),t(this,"ranges",new _e),0!==this.byteLength&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,r){if(0===e&&0===this.byteLength&&r){let e=new DataView(r.buffer||r,r.byteOffset,r.byteLength);this._swapDataView(e)}else{let r=e+t;if(r>this.byteLength){let{dataView:e}=this._extend(r);this._swapDataView(e)}}}_extend(e){let t;t=l?c.allocUnsafe(e):new Uint8Array(e);let r=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:r}}subarray(e,t,r=!1){return t=t||this._lengthToEnd(e),r&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,r=!1){r&&this._tryExtend(t,e.byteLength,e);let n=super.set(e,t);return this.ranges.add(t,n.byteLength),n}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}}class _e{constructor(){t(this,"list",[])}get length(){return this.list.length}add(e,t,r=0){let n=e+t,i=this.list.filter((t=>Te(e,t.offset,n)||Te(e,t.end,n)));if(i.length>0){e=Math.min(e,...i.map((e=>e.offset))),n=Math.max(n,...i.map((e=>e.end))),t=n-e;let r=i.shift();r.offset=e,r.length=t,r.end=n,this.list=this.list.filter((e=>!i.includes(e)))}else this.list.push({offset:e,length:t,end:n})}available(e,t){let r=e+t;return this.list.some((t=>t.offset<=e&&r<=t.end))}}function Te(e,t,r){return e<=t&&t<=r}class xe extends Se{constructor(e,r){super(0),t(this,"chunksRead",0),this.input=e,this.options=r}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,r=await this.readChunk(e,t);return!!r&&r.byteLength===t}async readChunk(e,t){if(this.chunksRead++,0!==(t=this.safeWrapAddress(e,t)))return this._readChunk(e,t)}safeWrapAddress(e,t){return void 0!==this.size&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(0!==this.ranges.list.length)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return void 0!==this.size&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}T.set("blob",class extends xe{async readWhole(){this.chunked=!1;let e=await R(this.input);this._swapArrayBuffer(e)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(e,t){let r=t?e+t:void 0,n=this.input.slice(e,r),i=await R(n);return this.set(i,e,!0)}});var Ae=Object.freeze({__proto__:null,default:de,parse:X,Exifr:Q,fileParsers:S,segmentParsers:_,fileReaders:T,tagKeys:P,tagValues:L,tagRevivers:D,createDictionary:O,extendDictionary:N,fetchUrlAsArrayBuffer:C,readBlobAsArrayBuffer:R,chunkedProps:M,otherSegments:U,segments:B,tiffBlocks:F,segmentsAndBlocks:j,tiffExtractables:V,inheritables:H,allFormatters:G,Options:K,disableAllOptions:he,gpsOnlyOptions:fe,orientationOnlyOptions:pe,thumbnailOnlyOptions:me,thumbnail:ge,thumbnailUrl:ve,gps:ye,orientation:be,rotations:Ee,get rotateCanvas(){return e.rotateCanvas},get rotateCss(){return e.rotateCss},rotation:we});T.set("url",class extends xe{async readWhole(){this.chunked=!1;let e=await C(this.input);this._swapArrayBuffer(e)}async _readChunk(e,t){let r=t?e+t-1:void 0,n={};(e||r)&&(n.range="bytes=".concat([e,r].join("-")));let i=await fetch(this.input,{headers:n}),o=await i.arrayBuffer(),s=o.byteLength;if(416!==i.status)return s!==t&&(this.size=e+s),this.set(o,e,!0)}}),b.prototype.getUint64=function(e){let t=this.getUint32(e),r=this.getUint32(e+4);return t<1048575?t<<32|r:void 0!==typeof u?(console.warn("Using BigInt because of type 64uint but JS can only handle 53b numbers."),u(t)<<u(32)|u(r)):void p("Trying to read 64b value but JS can only handle 53b numbers.")};class Ie extends te{parseBoxes(e=0){let t=[];for(;e<this.file.byteLength-4;){let r=this.parseBoxHead(e);if(t.push(r),0===r.length)break;e+=r.length}return t}parseSubBoxes(e){e.boxes=this.parseBoxes(e.start)}findBox(e,t){return void 0===e.boxes&&this.parseSubBoxes(e),e.boxes.find((e=>e.kind===t))}parseBoxHead(e){let t=this.file.getUint32(e),r=this.file.getString(e+4,4),n=e+8;return 1===t&&(t=this.file.getUint64(e+8),n+=8),{offset:e,length:t,kind:r,start:n}}parseBoxFullHead(e){let t=this.file.getUint32(e.start);e.version=t>>24,e.start+=4}}class Ce extends Ie{static canHandle(e){if(0!==e.getUint16(0))return!1;let t=e.getUint16(2);if(t>50)return!1;let r=16,n=[];for(;r<t;)n.push(e.getString(r,4)),r+=4;return n.includes("heic")}async parse(){let e=this.file.getUint32(0),t=this.parseBoxHead(e);for(;"meta"!==t.kind;)e+=t.length,t=this.parseBoxHead(e);await this.file.ensureChunk(t.offset,t.length),this.parseBoxFullHead(t),this.parseSubBoxes(t),this.options.icc.enabled&&await this.findIcc(t),this.options.tiff.enabled&&await this.findExif(t)}async registerSegment(e,t,r){await this.file.ensureChunk(t,r);let n=this.file.subarray(t,r);this.createParser(e,n)}async findIcc(e){let t=this.findBox(e,"iprp");if(void 0===t)return;let r=this.findBox(t,"ipco");if(void 0===r)return;let n=this.findBox(r,"colr");void 0!==n&&await this.registerSegment("icc",n.offset+12,n.length)}async findExif(e){let t=this.findBox(e,"iinf");if(void 0===t)return;let r=this.findBox(e,"iloc");if(void 0===r)return;let n=this.findExifLocIdInIinf(t),i=this.findExtentInIloc(r,n);if(void 0===i)return;let[o,s]=i;await this.file.ensureChunk(o,s);let a=4+this.file.getUint32(o);o+=a,s-=a,await this.registerSegment("tiff",o,s)}findExifLocIdInIinf(e){this.parseBoxFullHead(e);let t,r,n,i,o=e.start,s=this.file.getUint16(o);for(o+=2;s--;){if(t=this.parseBoxHead(o),this.parseBoxFullHead(t),r=t.start,t.version>=2&&(n=3===t.version?4:2,i=this.file.getString(r+n+2,4),"Exif"===i))return this.file.getUintBytes(r,n);o+=t.length}}get8bits(e){let t=this.file.getUint8(e);return[t>>4,15&t]}findExtentInIloc(e,t){this.parseBoxFullHead(e);let r=e.start,[n,i]=this.get8bits(r++),[o,s]=this.get8bits(r++),a=2===e.version?4:2,c=1===e.version||2===e.version?2:0,u=s+n+i,l=2===e.version?4:2,d=this.file.getUintBytes(r,l);for(r+=l;d--;){let e=this.file.getUintBytes(r,a);r+=a+c+2+o;let l=this.file.getUint16(r);if(r+=2,e===t)return l>1&&console.warn("ILOC box has more than one extent but we're only processing one\nPlease create an issue at https://github.com/MikeKovarik/exifr with this file"),[this.file.getUintBytes(r+s,n),this.file.getUintBytes(r+s+n,i)];r+=l*u}}}t(Ce,"type","heic"),S.set("heic",Ce),O(P,["ifd0","ifd1"],[[256,"ImageWidth"],[257,"ImageHeight"],[258,"BitsPerSample"],[259,"Compression"],[262,"PhotometricInterpretation"],[270,"ImageDescription"],[271,"Make"],[272,"Model"],[273,"StripOffsets"],[274,"Orientation"],[277,"SamplesPerPixel"],[278,"RowsPerStrip"],[279,"StripByteCounts"],[282,"XResolution"],[283,"YResolution"],[284,"PlanarConfiguration"],[296,"ResolutionUnit"],[301,"TransferFunction"],[305,"Software"],[306,"ModifyDate"],[315,"Artist"],[316,"HostComputer"],[317,"Predictor"],[318,"WhitePoint"],[319,"PrimaryChromaticities"],[513,"ThumbnailOffset"],[514,"ThumbnailLength"],[529,"YCbCrCoefficients"],[530,"YCbCrSubSampling"],[531,"YCbCrPositioning"],[532,"ReferenceBlackWhite"],[700,"ApplicationNotes"],[33432,"Copyright"],[33723,"IPTC"],[34665,"ExifIFD"],[34675,"ICC"],[34853,"GpsIFD"],[330,"SubIFD"],[40965,"InteropIFD"],[40091,"XPTitle"],[40092,"XPComment"],[40093,"XPAuthor"],[40094,"XPKeywords"],[40095,"XPSubject"]]),O(P,"exif",[[33434,"ExposureTime"],[33437,"FNumber"],[34850,"ExposureProgram"],[34852,"SpectralSensitivity"],[34855,"ISO"],[34858,"TimeZoneOffset"],[34859,"SelfTimerMode"],[34864,"SensitivityType"],[34865,"StandardOutputSensitivity"],[34866,"RecommendedExposureIndex"],[34867,"ISOSpeed"],[34868,"ISOSpeedLatitudeyyy"],[34869,"ISOSpeedLatitudezzz"],[36864,"ExifVersion"],[36867,"DateTimeOriginal"],[36868,"CreateDate"],[36873,"GooglePlusUploadCode"],[36880,"OffsetTime"],[36881,"OffsetTimeOriginal"],[36882,"OffsetTimeDigitized"],[37121,"ComponentsConfiguration"],[37122,"CompressedBitsPerPixel"],[37377,"ShutterSpeedValue"],[37378,"ApertureValue"],[37379,"BrightnessValue"],[37380,"ExposureCompensation"],[37381,"MaxApertureValue"],[37382,"SubjectDistance"],[37383,"MeteringMode"],[37384,"LightSource"],[37385,"Flash"],[37386,"FocalLength"],[37393,"ImageNumber"],[37394,"SecurityClassification"],[37395,"ImageHistory"],[37396,"SubjectArea"],[37500,"MakerNote"],[37510,"UserComment"],[37520,"SubSecTime"],[37521,"SubSecTimeOriginal"],[37522,"SubSecTimeDigitized"],[37888,"AmbientTemperature"],[37889,"Humidity"],[37890,"Pressure"],[37891,"WaterDepth"],[37892,"Acceleration"],[37893,"CameraElevationAngle"],[40960,"FlashpixVersion"],[40961,"ColorSpace"],[40962,"ExifImageWidth"],[40963,"ExifImageHeight"],[40964,"RelatedSoundFile"],[41483,"FlashEnergy"],[41486,"FocalPlaneXResolution"],[41487,"FocalPlaneYResolution"],[41488,"FocalPlaneResolutionUnit"],[41492,"SubjectLocation"],[41493,"ExposureIndex"],[41495,"SensingMethod"],[41728,"FileSource"],[41729,"SceneType"],[41730,"CFAPattern"],[41985,"CustomRendered"],[41986,"ExposureMode"],[41987,"WhiteBalance"],[41988,"DigitalZoomRatio"],[41989,"FocalLengthIn35mmFormat"],[41990,"SceneCaptureType"],[41991,"GainControl"],[41992,"Contrast"],[41993,"Saturation"],[41994,"Sharpness"],[41996,"SubjectDistanceRange"],[42016,"ImageUniqueID"],[42032,"OwnerName"],[42033,"SerialNumber"],[42034,"LensInfo"],[42035,"LensMake"],[42036,"LensModel"],[42037,"LensSerialNumber"],[42080,"CompositeImage"],[42081,"CompositeImageCount"],[42082,"CompositeImageExposureTimes"],[42240,"Gamma"],[59932,"Padding"],[59933,"OffsetSchema"],[65e3,"OwnerName"],[65001,"SerialNumber"],[65002,"Lens"],[65100,"RawFile"],[65101,"Converter"],[65102,"WhiteBalance"],[65105,"Exposure"],[65106,"Shadows"],[65107,"Brightness"],[65108,"Contrast"],[65109,"Saturation"],[65110,"Sharpness"],[65111,"Smoothness"],[65112,"MoireFilter"],[40965,"InteropIFD"]]),O(P,"gps",[[0,"GPSVersionID"],[1,"GPSLatitudeRef"],[2,"GPSLatitude"],[3,"GPSLongitudeRef"],[4,"GPSLongitude"],[5,"GPSAltitudeRef"],[6,"GPSAltitude"],[7,"GPSTimeStamp"],[8,"GPSSatellites"],[9,"GPSStatus"],[10,"GPSMeasureMode"],[11,"GPSDOP"],[12,"GPSSpeedRef"],[13,"GPSSpeed"],[14,"GPSTrackRef"],[15,"GPSTrack"],[16,"GPSImgDirectionRef"],[17,"GPSImgDirection"],[18,"GPSMapDatum"],[19,"GPSDestLatitudeRef"],[20,"GPSDestLatitude"],[21,"GPSDestLongitudeRef"],[22,"GPSDestLongitude"],[23,"GPSDestBearingRef"],[24,"GPSDestBearing"],[25,"GPSDestDistanceRef"],[26,"GPSDestDistance"],[27,"GPSProcessingMethod"],[28,"GPSAreaInformation"],[29,"GPSDateStamp"],[30,"GPSDifferential"],[31,"GPSHPositioningError"]]),O(L,["ifd0","ifd1"],[[274,{1:"Horizontal (normal)",2:"Mirror horizontal",3:"Rotate 180",4:"Mirror vertical",5:"Mirror horizontal and rotate 270 CW",6:"Rotate 90 CW",7:"Mirror horizontal and rotate 90 CW",8:"Rotate 270 CW"}],[296,{1:"None",2:"inches",3:"cm"}]]);let Re=O(L,"exif",[[34850,{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"}],[37121,{0:"-",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}],[37383,{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"}],[37384,{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"}],[37385,{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"}],[41495,{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"}],[41728,{1:"Film Scanner",2:"Reflection Print Scanner",3:"Digital Camera"}],[41729,{1:"Directly photographed"}],[41985,{0:"Normal",1:"Custom",2:"HDR (no original saved)",3:"HDR (original saved)",4:"Original (for HDR)",6:"Panorama",7:"Portrait HDR",8:"Portrait"}],[41986,{0:"Auto",1:"Manual",2:"Auto bracket"}],[41987,{0:"Auto",1:"Manual"}],[41990,{0:"Standard",1:"Landscape",2:"Portrait",3:"Night",4:"Other"}],[41991,{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"}],[41996,{0:"Unknown",1:"Macro",2:"Close",3:"Distant"}],[42080,{0:"Unknown",1:"Not a Composite Image",2:"General Composite Image",3:"Composite Image Captured While Shooting"}]]);const ke={1:"No absolute unit of measurement",2:"Inch",3:"Centimeter"};Re.set(37392,ke),Re.set(41488,ke);const Oe={0:"Normal",1:"Low",2:"High"};function Ne(e){let t=Array.from(e).slice(1);return t[1]>15&&(t=t.map((e=>String.fromCharCode(e)))),"0"!==t[2]&&0!==t[2]||t.pop(),t.join(".")}function Pe(e){if("string"==typeof e){var[t,r,n,i,o,s]=e.trim().split(/[-: ]/g).map(Number),a=new Date(t,r-1,n);return Number.isNaN(i)||Number.isNaN(o)||Number.isNaN(s)||(a.setHours(i),a.setMinutes(o),a.setSeconds(s)),Number.isNaN(+a)?e:a}}function Le(e){if("string"==typeof e)return e;let t=[];if(0===e[1]&&0===e[e.length-1])for(let r=0;r<e.length;r+=2)t.push(De(e[r+1],e[r]));else for(let r=0;r<e.length;r+=2)t.push(De(e[r],e[r+1]));return m(String.fromCodePoint(...t))}function De(e,t){return e<<8|t}Re.set(41992,Oe),Re.set(41993,Oe),Re.set(41994,Oe),O(D,["ifd0","ifd1"],[[50827,function(e){return"string"!=typeof e?y(e):e}],[306,Pe],[40091,Le],[40092,Le],[40093,Le],[40094,Le],[40095,Le]]),O(D,"exif",[[40960,Ne],[36864,Ne],[36867,Pe],[36868,Pe]]),O(D,"gps",[[0,e=>Array.from(e).join(".")],[7,e=>Array.from(e).join(":")]]);class Me extends re{static canHandle(e,t){return 225===e.getUint8(t+1)&&1752462448===e.getUint32(t+4)&&"http://ns.adobe.com/"===e.getString(t+4,20)}static headerLength(e,t){return"http://ns.adobe.com/xmp/extension/"===e.getString(t+4,34)?79:33}static findPosition(e,t){let r=super.findPosition(e,t);return r.multiSegment=r.extended=79===r.headerLength,r.multiSegment?(r.chunkCount=e.getUint8(t+72),r.chunkNumber=e.getUint8(t+76),0!==e.getUint8(t+77)&&r.chunkNumber++):(r.chunkCount=1/0,r.chunkNumber=-1),r}static handleMultiSegments(e){return e.map((e=>e.chunk.getString())).join("")}normalizeInput(e){return"string"==typeof e?e:e.getString&&e.getString()}parse(e=this.chunk){if(!this.localOptions.parse)return e;e=function(e){let t={"rdf:li":1,"rdf:Seq":1,"rdf:Bag":1,"rdf:Alt":1};return e.replace($e,((e,r,n)=>"<"===r?"".concat(e,"#").concat(t[n]++):"".concat(e,"#").concat(--t[n])))}(e);let t=Be.findAll(e,"rdf","Description");0===t.length&&t.push(new Be("rdf","Description",void 0,e));let r,n={};for(let e of t)for(let t of e.properties)r=He(t.ns,n),Fe(t,r);return function(e){let t;for(let r in e)t=e[r]=d(e[r]),void 0===t&&delete e[r];return d(e)}(n)}assignToOutput(e,t){if(this.localOptions.parse)for(let[r,n]of Object.entries(t))switch(r){case"tiff":this.assignObjectToOutput(e,"ifd0",n);break;case"exif":this.assignObjectToOutput(e,"exif",n);break;case"xmlns":break;default:this.assignObjectToOutput(e,r,n)}else e.xmp=t}}t(Me,"type","xmp"),t(Me,"multiSegment",!0),_.set("xmp",Me);class Ue{static findAll(e){return Ge(e,/([a-zA-Z0-9-]+):([a-zA-Z0-9-]+)=("[^"]*"|'[^']*')/gm).map(Ue.unpackMatch)}static unpackMatch(e){let t=e[1],r=e[2],n=e[3].slice(1,-1);return n=qe(n),new Ue(t,r,n)}constructor(e,t,r){this.ns=e,this.name=t,this.value=r}serialize(){return this.value}}class Be{static findAll(e,t,r){if(void 0!==t||void 0!==r){t=t||"[\\w\\d-]+",r=r||"[\\w\\d-]+";var n=new RegExp("<(".concat(t,"):(").concat(r,")(#\\d+)?((\\s+?[\\w\\d-:]+=(\"[^\"]*\"|'[^']*'))*\\s*)(\\/>|>([\\s\\S]*?)<\\/\\1:\\2\\3>)"),"gm")}else n=/<([\w\d-]+):([\w\d-]+)(#\d+)?((\s+?[\w\d-:]+=("[^"]*"|'[^']*'))*\s*)(\/>|>([\s\S]*?)<\/\1:\2\3>)/gm;return Ge(e,n).map(Be.unpackMatch)}static unpackMatch(e){let t=e[1],r=e[2],n=e[4],i=e[8];return new Be(t,r,n,i)}constructor(e,t,r,n){this.ns=e,this.name=t,this.attrString=r,this.innerXml=n,this.attrs=Ue.findAll(r),this.children=Be.findAll(n),this.value=0===this.children.length?qe(n):void 0,this.properties=[...this.attrs,...this.children]}get isPrimitive(){return void 0!==this.value&&0===this.attrs.length&&0===this.children.length}get isListContainer(){return 1===this.children.length&&this.children[0].isList}get isList(){let{ns:e,name:t}=this;return"rdf"===e&&("Seq"===t||"Bag"===t||"Alt"===t)}get isListItem(){return"rdf"===this.ns&&"li"===this.name}serialize(){if(0===this.properties.length&&void 0===this.value)return;if(this.isPrimitive)return this.value;if(this.isListContainer)return this.children[0].serialize();if(this.isList)return Ve(this.children.map(je));if(this.isListItem&&1===this.children.length&&0===this.attrs.length)return this.children[0].serialize();let e={};for(let t of this.properties)Fe(t,e);return void 0!==this.value&&(e.value=this.value),d(e)}}function Fe(e,t){let r=e.serialize();void 0!==r&&(t[e.name]=r)}var je=e=>e.serialize(),Ve=e=>1===e.length?e[0]:e,He=(e,t)=>t[e]?t[e]:t[e]={};function Ge(e,t){let r,n=[];if(!e)return n;for(;null!==(r=t.exec(e));)n.push(r);return n}function qe(e){if(function(e){return null==e||"null"===e||"undefined"===e||""===e||""===e.trim()}(e))return;let t=Number(e);if(!Number.isNaN(t))return t;let r=e.toLowerCase();return"true"===r||"false"!==r&&e.trim()}const $e=/(<|\/)(rdf:li|rdf:Seq|rdf:Bag|rdf:Alt)/g;e.Exifr=Q,e.Options=K,e.allFormatters=G,e.chunkedProps=M,e.createDictionary=O,e.default=Ae,e.disableAllOptions=he,e.extendDictionary=N,e.fetchUrlAsArrayBuffer=C,e.fileParsers=S,e.fileReaders=T,e.gps=ye,e.gpsOnlyOptions=fe,e.inheritables=H,e.orientation=be,e.orientationOnlyOptions=pe,e.otherSegments=U,e.parse=X,e.readBlobAsArrayBuffer=R,e.rotation=we,e.rotations=Ee,e.segmentParsers=_,e.segments=B,e.segmentsAndBlocks=j,e.tagKeys=P,e.tagRevivers=D,e.tagValues=L,e.thumbnail=ge,e.thumbnailOnlyOptions=me,e.thumbnailUrl=ve,e.tiffBlocks=F,e.tiffExtractables=V,Object.defineProperty(e,"__esModule",{value:!0})}(t)},40001:(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";const Token=__webpack_require__(83416),strtok3=__webpack_require__(35849),{stringToBytes,tarHeaderChecksumMatches,uint32SyncSafeToken}=__webpack_require__(76188),supported=__webpack_require__(49898),minimumBytes=4100;async function fromStream(e){const t=await strtok3.fromStream(e);try{return await fromTokenizer(t)}finally{await t.close()}}async function fromBuffer(e){if(!(e instanceof Uint8Array||e instanceof ArrayBuffer||Buffer.isBuffer(e)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof e}\``);const t=e instanceof Buffer?e:Buffer.from(e);if(!(t&&t.length>1))return;return fromTokenizer(strtok3.fromBuffer(t))}function _check(e,t,r){r={offset:0,...r};for(const[n,i]of t.entries())if(r.mask){if(i!==(r.mask[n]&e[n+r.offset]))return!1}else if(i!==e[n+r.offset])return!1;return!0}async function fromTokenizer(e){try{return _fromTokenizer(e)}catch(e){if(!(e instanceof strtok3.EndOfStreamError))throw e}}async function _fromTokenizer(e){let t=Buffer.alloc(minimumBytes);const r=(e,r)=>_check(t,e,r),n=(e,t)=>r(stringToBytes(e),t);if(e.fileInfo.size||(e.fileInfo.size=Number.MAX_SAFE_INTEGER),await e.peekBuffer(t,{length:12,mayBeLess:!0}),r([66,77]))return{ext:"bmp",mime:"image/bmp"};if(r([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(r([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(r([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(r([37,33]))return await e.peekBuffer(t,{length:24,mayBeLess:!0}),n("PS-Adobe-",{offset:2})&&n(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(r([31,160])||r([31,157]))return{ext:"Z",mime:"application/x-compress"};if(r([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(r([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(r([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(r([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(n("ID3")){await e.ignore(6);const i=await e.readToken(uint32SyncSafeToken);return e.position+i>e.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await e.ignore(i),fromTokenizer(e))}if(n("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((67===t[0]||70===t[0])&&r([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(r([71,73,70]))return{ext:"gif",mime:"image/gif"};if(n("FLIF"))return{ext:"flif",mime:"image/flif"};if(n("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(n("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(n("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(n("FORM"))return{ext:"aif",mime:"audio/aiff"};if(n("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(r([80,75,3,4])){try{for(;e.position+30<e.fileInfo.size;){await e.readBuffer(t,{length:30});const o={compressedSize:t.readUInt32LE(18),uncompressedSize:t.readUInt32LE(22),filenameLength:t.readUInt16LE(26),extraFieldLength:t.readUInt16LE(28)};if(o.filename=await e.readToken(new Token.StringType(o.filenameLength,"utf-8")),await e.ignore(o.extraFieldLength),"META-INF/mozilla.rsa"===o.filename)return{ext:"xpi",mime:"application/x-xpinstall"};if(o.filename.endsWith(".rels")||o.filename.endsWith(".xml")){switch(o.filename.split("/")[0]){case"_rels":default:break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}}if(o.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(o.filename.startsWith("3D/")&&o.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if("mimetype"===o.filename&&o.compressedSize===o.uncompressedSize){switch(await e.readToken(new Token.StringType(o.compressedSize,"utf-8"))){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"}}}if(0===o.compressedSize){let s=-1;for(;s<0&&e.position<e.fileInfo.size;)await e.peekBuffer(t,{mayBeLess:!0}),s=t.indexOf("504B0304",0,"hex"),await e.ignore(s>=0?s:t.length)}else await e.ignore(o.compressedSize)}}catch(a){if(!(a instanceof strtok3.EndOfStreamError))throw a}return{ext:"zip",mime:"application/zip"}}if(n("OggS")){await e.ignore(28);const c=Buffer.alloc(8);return await e.readBuffer(c),_check(c,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:_check(c,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:_check(c,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:_check(c,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:_check(c,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:_check(c,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(r([80,75])&&(3===t[2]||5===t[2]||7===t[2])&&(4===t[3]||6===t[3]||8===t[3]))return{ext:"zip",mime:"application/zip"};if(n("ftyp",{offset:4})&&0!=(96&t[8])){const u=t.toString("binary",8,12).replace("\0"," ").trim();switch(u){case"avif":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return u.startsWith("3g")?u.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(n("MThd"))return{ext:"mid",mime:"audio/midi"};if(n("wOFF")&&(r([0,1,0,0],{offset:4})||n("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(n("wOF2")&&(r([0,1,0,0],{offset:4})||n("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(r([212,195,178,161])||r([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(n("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(n("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(n("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(r([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(n("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(n("%PDF")){await e.ignore(1350);const l=10485760,d=Buffer.alloc(Math.min(l,e.fileInfo.size));return await e.readBuffer(d,{mayBeLess:!0}),d.includes(Buffer.from("AIPrivateData"))?{ext:"ai",mime:"application/postscript"}:{ext:"pdf",mime:"application/pdf"}}if(r([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(r([73,73,42,0]))return n("CR",{offset:8})?{ext:"cr2",mime:"image/x-canon-cr2"}:r([28,0,254,0],{offset:8})||r([31,0,11,0],{offset:8})?{ext:"nef",mime:"image/x-nikon-nef"}:r([8,0,0,0],{offset:4})&&(r([45,0,254,0],{offset:8})||r([39,0,254,0],{offset:8}))?{ext:"dng",mime:"image/x-adobe-dng"}:(t=Buffer.alloc(24),await e.peekBuffer(t),(r([16,251,134,1],{offset:4})||r([8,0,0,0],{offset:4}))&&r([0,254,0,4,0,1,0,0,0,1,0,0,0,3,1],{offset:9})?{ext:"arw",mime:"image/x-sony-arw"}:{ext:"tif",mime:"image/tiff"});if(r([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(n("MAC "))return{ext:"ape",mime:"audio/ape"};if(r([26,69,223,163])){async function h(){const t=await e.peekNumber(Token.UINT8);let r=128,n=0;for(;0==(t&r)&&0!==r;)++n,r>>=1;const i=Buffer.alloc(n+1);return await e.readBuffer(i),i}async function f(){const e=await h(),t=await h();t[0]^=128>>t.length-1;const r=Math.min(6,t.length);return{id:e.readUIntBE(0,e.length),len:t.readUIntBE(t.length-r,r)}}async function p(t,r){for(;r>0;){const t=await f();if(17026===t.id)return e.readToken(new Token.StringType(t.len,"utf-8"));await e.ignore(t.len),--r}}const m=await f();switch(await p(0,m.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(r([82,73,70,70])){if(r([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(r([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(r([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(n("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(r([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(n("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(n("MSCF")||n("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(r([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(r([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(r([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(r([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(n("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(n("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(r([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(n("IMPM"))return{ext:"it",mime:"audio/x-it"};if(n("-lh0-",{offset:2})||n("-lh1-",{offset:2})||n("-lh2-",{offset:2})||n("-lh3-",{offset:2})||n("-lh4-",{offset:2})||n("-lh5-",{offset:2})||n("-lh6-",{offset:2})||n("-lh7-",{offset:2})||n("-lzs-",{offset:2})||n("-lz4-",{offset:2})||n("-lz5-",{offset:2})||n("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(r([0,0,1,186])){if(r([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(r([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(n("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(r([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(n("<?xml "))return{ext:"xml",mime:"application/xml"};if(r([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(r([82,97,114,33,26,7])&&(0===t[6]||1===t[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(n("solid "))return{ext:"stl",mime:"model/stl"};if(n("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(n("!<arch>")){await e.ignore(8);return"debian-binary"===await e.readToken(new Token.StringType(13,"ascii"))?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"}}if(r([137,80,78,71,13,10,26,10])){async function g(){return{length:await e.readToken(Token.INT32_BE),type:await e.readToken(new Token.StringType(4,"binary"))}}await e.ignore(8);do{const v=await g();if(v.length<0)return;switch(v.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await e.ignore(v.length+4)}}while(e.position+8<e.fileInfo.size);return{ext:"png",mime:"image/png"}}if(r([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(r([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(r([102,114,101,101],{offset:4})||r([109,100,97,116],{offset:4})||r([109,111,111,118],{offset:4})||r([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(r([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(n("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(r([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(r([48,38,178,117,142,102,207,17,166,217])){async function y(){const t=Buffer.alloc(16);return await e.readBuffer(t),{id:t,size:Number(await e.readToken(Token.UINT64_LE))}}for(await e.ignore(30);e.position+24<e.fileInfo.size;){const b=await y();let E=b.size-24;if(_check(b.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const w=Buffer.alloc(16);if(E-=await e.readBuffer(w),_check(w,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(_check(w,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await e.ignore(E)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(r([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((r([126,16,4])||r([126,24,4]))&&r([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(r([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(r([0,0,0,12,106,80,32,32,13,10,135,10])){await e.ignore(20);switch(await e.readToken(new Token.StringType(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}}if(r([255,10])||r([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(r([0,0,1,186])||r([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(r([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(r([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(r([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(r([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await e.peekBuffer(t,{length:Math.min(256,e.fileInfo.size),mayBeLess:!0}),n("BEGIN:")){if(n("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(n("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(n("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(n("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(n("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(r([4,0,0,0])&&t.length>=16){const S=t.readUInt32LE(12);if(S>12&&t.length>=S+16)try{const _=t.slice(16,S+16).toString();if(JSON.parse(_).files)return{ext:"asar",mime:"application/x-asar"}}catch(T){}}if(r([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(n("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(r([71],{offset:4})&&(r([71],{offset:192})||r([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(r([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(r([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(r([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(r([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(r([76,80],{offset:34})&&(r([0,0,1],{offset:8})||r([1,0,2],{offset:8})||r([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(r([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await e.peekBuffer(t,{length:Math.min(512,e.fileInfo.size),mayBeLess:!0}),tarHeaderChecksumMatches(t))return{ext:"tar",mime:"application/x-tar"};if(r([255,254,255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0]))return{ext:"skp",mime:"application/vnd.sketchup.skp"};if(n("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(t.length>=2&&r([255,224],{offset:0,mask:[255,224]})){if(r([16],{offset:1,mask:[22]}))return r([8],{offset:1,mask:[8]}),{ext:"aac",mime:"audio/aac"};if(r([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(r([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(r([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}const stream=readableStream=>new Promise(((resolve,reject)=>{const stream=eval("require")("stream");readableStream.on("error",reject),readableStream.once("readable",(async()=>{const e=new stream.PassThrough;let t;t=stream.pipeline?stream.pipeline(readableStream,e,(()=>{})):readableStream.pipe(e);const r=readableStream.read(minimumBytes)||readableStream.read()||Buffer.alloc(0);try{const t=await fromBuffer(r);e.fileType=t}catch(e){reject(e)}resolve(t)}))})),fileType={fromStream,fromTokenizer,fromBuffer,stream};Object.defineProperty(fileType,"extensions",{get:()=>new Set(supported.extensions)}),Object.defineProperty(fileType,"mimeTypes",{get:()=>new Set(supported.mimeTypes)}),module.exports=fileType},97769:(e,t,r)=>{"use strict";const n=r(26597),i=r(40001);const o={fromFile:async function(e){const t=await n.fromFile(e);try{return await i.fromTokenizer(t)}finally{await t.close()}}};Object.assign(o,i),Object.defineProperty(o,"extensions",{get:()=>i.extensions}),Object.defineProperty(o,"mimeTypes",{get:()=>i.mimeTypes}),e.exports=o},49898:e=>{"use strict";e.exports={extensions:["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf"],mimeTypes:["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/vnd.wave","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd"]}},76188:(e,t)=>{"use strict";t.stringToBytes=e=>[...e].map((e=>e.charCodeAt(0))),t.tarHeaderChecksumMatches=(e,t=0)=>{const r=parseInt(e.toString("utf8",148,154).replace(/\0.*$/,"").trim(),8);if(isNaN(r))return!1;let n=256;for(let r=t;r<t+148;r++)n+=e[r];for(let r=t+156;r<t+512;r++)n+=e[r];return r===n},t.uint32SyncSafeToken={get:(e,t)=>127&e[t+3]|e[t+2]<<7|e[t+1]<<14|e[t]<<21,len:4}},94029:(e,t,r)=>{"use strict";var n=r(95320),i=Object.prototype.toString,o=Object.prototype.hasOwnProperty;e.exports=function(e,t,r){if(!n(t))throw new TypeError("iterator must be a function");var s;arguments.length>=3&&(s=r),"[object Array]"===i.call(e)?function(e,t,r){for(var n=0,i=e.length;n<i;n++)o.call(e,n)&&(null==r?t(e[n],n,e):t.call(r,e[n],n,e))}(e,t,s):"string"==typeof e?function(e,t,r){for(var n=0,i=e.length;n<i;n++)null==r?t(e.charAt(n),n,e):t.call(r,e.charAt(n),n,e)}(e,t,s):function(e,t,r){for(var n in e)o.call(e,n)&&(null==r?t(e[n],n,e):t.call(r,e[n],n,e))}(e,t,s)}},17648:e=>{"use strict";var t=Object.prototype.toString,r=Math.max,n=function(e,t){for(var r=[],n=0;n<e.length;n+=1)r[n]=e[n];for(var i=0;i<t.length;i+=1)r[i+e.length]=t[i];return r};e.exports=function(e){var i=this;if("function"!=typeof i||"[object Function]"!==t.apply(i))throw new TypeError("Function.prototype.bind called on incompatible "+i);for(var o,s=function(e,t){for(var r=[],n=t||0,i=0;n<e.length;n+=1,i+=1)r[i]=e[n];return r}(arguments,1),a=r(0,i.length-s.length),c=[],u=0;u<a;u++)c[u]="$"+u;if(o=Function("binder","return function ("+function(e,t){for(var r="",n=0;n<e.length;n+=1)r+=e[n],n+1<e.length&&(r+=t);return r}(c,",")+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof o){var t=i.apply(this,n(s,arguments));return Object(t)===t?t:this}return i.apply(e,n(s,arguments))})),i.prototype){var l=function(){};l.prototype=i.prototype,o.prototype=new l,l.prototype=null}return o}},58612:(e,t,r)=>{"use strict";var n=r(17648);e.exports=Function.prototype.bind||n},40210:(e,t,r)=>{"use strict";var n,i=SyntaxError,o=Function,s=TypeError,a=function(e){try{return o('"use strict"; return ('+e+").constructor;")()}catch(e){}},c=Object.getOwnPropertyDescriptor;if(c)try{c({},"")}catch(e){c=null}var u=function(){throw new s},l=c?function(){try{return u}catch(e){try{return c(arguments,"callee").get}catch(e){return u}}}():u,d=r(41405)(),h=r(28185)(),f=Object.getPrototypeOf||(h?function(e){return e.__proto__}:null),p={},m="undefined"!=typeof Uint8Array&&f?f(Uint8Array):n,g={"%AggregateError%":"undefined"==typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":d&&f?f([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":p,"%AsyncGenerator%":p,"%AsyncGeneratorFunction%":p,"%AsyncIteratorPrototype%":p,"%Atomics%":"undefined"==typeof Atomics?n:Atomics,"%BigInt%":"undefined"==typeof BigInt?n:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?n:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?n:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":o,"%GeneratorFunction%":p,"%Int8Array%":"undefined"==typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":d&&f?f(f([][Symbol.iterator]())):n,"%JSON%":"object"==typeof JSON?JSON:n,"%Map%":"undefined"==typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&d&&f?f((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?n:Promise,"%Proxy%":"undefined"==typeof Proxy?n:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&d&&f?f((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":d&&f?f(""[Symbol.iterator]()):n,"%Symbol%":d?Symbol:n,"%SyntaxError%":i,"%ThrowTypeError%":l,"%TypedArray%":m,"%TypeError%":s,"%Uint8Array%":"undefined"==typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?n:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?n:WeakSet};if(f)try{null.error}catch(e){var v=f(f(e));g["%Error.prototype%"]=v}var y=function e(t){var r;if("%AsyncFunction%"===t)r=a("async function () {}");else if("%GeneratorFunction%"===t)r=a("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=a("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var i=e("%AsyncGenerator%");i&&f&&(r=f(i.prototype))}return g[t]=r,r},b={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},E=r(58612),w=r(48824),S=E.call(Function.call,Array.prototype.concat),_=E.call(Function.apply,Array.prototype.splice),T=E.call(Function.call,String.prototype.replace),x=E.call(Function.call,String.prototype.slice),A=E.call(Function.call,RegExp.prototype.exec),I=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,C=/\\(\\)?/g,R=function(e,t){var r,n=e;if(w(b,n)&&(n="%"+(r=b[n])[0]+"%"),w(g,n)){var o=g[n];if(o===p&&(o=y(n)),void 0===o&&!t)throw new s("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:o}}throw new i("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new s('"allowMissing" argument must be a boolean');if(null===A(/^%?[^%]*%?$/,e))throw new i("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=function(e){var t=x(e,0,1),r=x(e,-1);if("%"===t&&"%"!==r)throw new i("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new i("invalid intrinsic syntax, expected opening `%`");var n=[];return T(e,I,(function(e,t,r,i){n[n.length]=r?T(i,C,"$1"):t||e})),n}(e),n=r.length>0?r[0]:"",o=R("%"+n+"%",t),a=o.name,u=o.value,l=!1,d=o.alias;d&&(n=d[0],_(r,S([0,1],d)));for(var h=1,f=!0;h<r.length;h+=1){var p=r[h],m=x(p,0,1),v=x(p,-1);if(('"'===m||"'"===m||"`"===m||'"'===v||"'"===v||"`"===v)&&m!==v)throw new i("property names with quotes must have matching quotes");if("constructor"!==p&&f||(l=!0),w(g,a="%"+(n+="."+p)+"%"))u=g[a];else if(null!=u){if(!(p in u)){if(!t)throw new s("base intrinsic for "+e+" exists, but the property is not available.");return}if(c&&h+1>=r.length){var y=c(u,p);u=(f=!!y)&&"get"in y&&!("originalValue"in y.get)?y.get:u[p]}else f=w(u,p),u=u[p];f&&!l&&(g[a]=u)}}return u}},58908:(e,t,r)=>{var n;n="undefined"!=typeof window?window:void 0!==r.g?r.g:"undefined"!=typeof self?self:{},e.exports=n},27296:(e,t,r)=>{"use strict";var n=r(40210)("%Object.getOwnPropertyDescriptor%",!0);if(n)try{n([],"length")}catch(e){n=null}e.exports=n},31044:(e,t,r)=>{"use strict";var n=r(40210)("%Object.defineProperty%",!0),i=function(){if(n)try{return n({},"a",{value:1}),!0}catch(e){return!1}return!1};i.hasArrayLengthDefineBug=function(){if(!i())return null;try{return 1!==n([],"length",{value:1}).length}catch(e){return!0}},e.exports=i},28185:e=>{"use strict";var t={foo:{}},r=Object;e.exports=function(){return{__proto__:t}.foo===t.foo&&!({__proto__:null}instanceof r)}},41405:(e,t,r)=>{"use strict";var n="undefined"!=typeof Symbol&&Symbol,i=r(55419);e.exports=function(){return"function"==typeof n&&("function"==typeof Symbol&&("symbol"==typeof n("foo")&&("symbol"==typeof Symbol("bar")&&i())))}},55419:e=>{"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(e,t);if(42!==i.value||!0!==i.enumerable)return!1}return!0}},96410:(e,t,r)=>{"use strict";var n=r(55419);e.exports=function(){return n()&&!!Symbol.toStringTag}},48824:(e,t,r)=>{"use strict";var n=Function.prototype.call,i=Object.prototype.hasOwnProperty,o=r(58612);e.exports=o.call(n,i)},80645:(e,t)=>{t.read=function(e,t,r,n,i){var o,s,a=8*i-n-1,c=(1<<a)-1,u=c>>1,l=-7,d=r?i-1:0,h=r?-1:1,f=e[t+d];for(d+=h,o=f&(1<<-l)-1,f>>=-l,l+=a;l>0;o=256*o+e[t+d],d+=h,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=n;l>0;s=256*s+e[t+d],d+=h,l-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),o-=u}return(f?-1:1)*s*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var s,a,c,u=8*o-i-1,l=(1<<u)-1,d=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,p=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+d>=1?h/c:h*Math.pow(2,1-d))*c>=2&&(s++,c/=2),s+d>=l?(a=0,s=l):s+d>=1?(a=(t*c-1)*Math.pow(2,i),s+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;e[r+f]=255&a,f+=p,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;e[r+f]=255&s,f+=p,s/=256,u-=8);e[r+f-p]|=128*m}},35717:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},93917:e=>{var t=function(e){if(!e.match(/^([0-9]{1,3}\.){3}[0-9]{1,3}$/))return!1;var t=e.split(".");for(let e of t){if(Number(e)>255)return!1}return!0},r=function(e,t=8){if("::"===(e=e.toLowerCase()))return!0;if(!e.match(/^([0-9a-f]{0,4}:?){2,8}$/))return!1;if(":"===e[e.length-1]&&":"!==e[e.length-2])return!1;if(e.split("::").length>2)return!1;if(1===e.split("::").length&&e.split(":").length!==t)return!1;if(2===e.split("::").length){var r=e.split("::")[1];r=r.split(":");for(let e=0;e<r.length-1;e++)if(""===r[e])return!1}return!0},n=function(e){var[n,i]=d(e);return r(n,6)&&t(i)},i=function(e,t,r="0"){for(;e.length<t;)e+=r;return e},o=function(e,t,r="0"){for(;e.length<t;)e=r+e;return e},s=function(e,t){for(var r=[];e.length>0;){var n=e.substring(0,t);r.push(n),e=e.substring(t)}return r},a=function(e){return Number(e).toString(2)},c=function(e){return parseInt(e,2)},u=function(e){return e.split(".").map((e=>o(a(e),8))).join("")},l=function(e){return e.toString(16)},d=function(e){var t=e.lastIndexOf(":"),r=e.substring(0,t),n=e.substring(t+1);return":"===r[r.length-1]&&(r+=":"),[r,n]},h=function(e){var[t,r]=d(e),[n,i]=t.split("::");for(n=n.split(":"),i=void 0!==i?i.split(":"):[];n.length+i.length<6;)n.push("0");var s=n.concat(i);for(let e=0;e<s.length;e++)0===s[e].length&&(s[e]="0");return s.map((e=>parseInt(e,16))).map((e=>o(a(e),16))).join("")+u(r)},f=function(e){return s(e,8).map(c).join(".")},p=function(e){var t=function(e){var t=e.split(":"),r=0,n=null,i=!1,o=0,s=null;for(let e=0;e<t.length;e++)i?"0"===t[e]?o++:(o>r&&(r=o,n=s),i=!1,o=0,s=null):"0"===t[e]&&(i=!0,o=1,s=e);return null!==s&&o>r&&(r=o,n=s),r<2?e:t.slice(0,n).join(":")+"::"+t.slice(n+r).join(":")}(s(e,16).map(c).map(l).join(":"));return t},m=function(e,t){var r=function(e){var[t,r]=e.split("::");for(t=t.split(":"),r=void 0!==r?r.split(":"):[];t.length+r.length<8;)t.push("0");var n=t.concat(r);for(let e=0;e<n.length;e++)0===n[e].length&&(n[e]="0");return n.map((e=>parseInt(e,16))).map((e=>o(a(e),16))).join("")}(e),n=r.substring(0,t),s=i(n,128);return p(s)},g=function(e,t){var r,n,o,s,a,c,u=h(e).substring(0,t),l=i(u,128);return n=(r=l).substring(0,96),o=r.substring(96),s=p(n),a=f(o),":"!==(c=s)[c.length-1]&&(c+=":"),c+a};e.exports=function(e,o=24,s=24){if("string"!=typeof e)return null;var a=function(e){return t(e)?"IPv4":r(e)?"IPv6":n(e)?"IPv6_4":"None"}(e=e.trim().toLowerCase());return"IPv4"===a?function(e,t){var r=u(e).substring(0,t),n=i(r,32);return f(n)}(e,o):"IPv6"===a?m(e,s):"IPv6_4"===a?function(e){return n(e)&&(!h(e).substring(0,96).includes("1")||!h(e).substring(0,80).includes("1")&&!h(e).substring(80,96).includes("0"))}(e)?g(e,o+96):g(e,s):null}},82584:(e,t,r)=>{"use strict";var n=r(96410)(),i=r(21924)("Object.prototype.toString"),o=function(e){return!(n&&e&&"object"==typeof e&&Symbol.toStringTag in e)&&"[object Arguments]"===i(e)},s=function(e){return!!o(e)||null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==i(e)&&"[object Function]"===i(e.callee)},a=function(){return o(arguments)}();o.isLegacyArguments=s,e.exports=a?o:s},95320:e=>{"use strict";var t,r,n=Function.prototype.toString,i="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof i&&"function"==typeof Object.defineProperty)try{t=Object.defineProperty({},"length",{get:function(){throw r}}),r={},i((function(){throw 42}),null,t)}catch(e){e!==r&&(i=null)}else i=null;var o=/^\s*class\b/,s=function(e){try{var t=n.call(e);return o.test(t)}catch(e){return!1}},a=function(e){try{return!s(e)&&(n.call(e),!0)}catch(e){return!1}},c=Object.prototype.toString,u="function"==typeof Symbol&&!!Symbol.toStringTag,l=!(0 in[,]),d=function(){return!1};if("object"==typeof document){var h=document.all;c.call(h)===c.call(document.all)&&(d=function(e){if((l||!e)&&(void 0===e||"object"==typeof e))try{var t=c.call(e);return("[object HTMLAllCollection]"===t||"[object HTML document.all class]"===t||"[object HTMLCollection]"===t||"[object Object]"===t)&&null==e("")}catch(e){}return!1})}e.exports=i?function(e){if(d(e))return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;try{i(e,null,t)}catch(e){if(e!==r)return!1}return!s(e)&&a(e)}:function(e){if(d(e))return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if(u)return a(e);if(s(e))return!1;var t=c.call(e);return!("[object Function]"!==t&&"[object GeneratorFunction]"!==t&&!/^\[object HTML/.test(t))&&a(e)}},27376:e=>{e.exports=function(e){if(!e)return!1;var r=t.call(e);return"[object Function]"===r||"function"==typeof e&&"[object RegExp]"!==r||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)};var t=Object.prototype.toString},48662:(e,t,r)=>{"use strict";var n,i=Object.prototype.toString,o=Function.prototype.toString,s=/^\s*(?:function)?\*/,a=r(96410)(),c=Object.getPrototypeOf;e.exports=function(e){if("function"!=typeof e)return!1;if(s.test(o.call(e)))return!0;if(!a)return"[object GeneratorFunction]"===i.call(e);if(!c)return!1;if(void 0===n){var t=function(){if(!a)return!1;try{return Function("return function*() {}")()}catch(e){}}();n=!!t&&c(t)}return c(e)===n}},85692:(e,t,r)=>{"use strict";var n=r(86430);e.exports=function(e){return!!n(e)}},55777:function(e){var t;t=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.i=function(e){return e},r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){"use strict";function n(e){if(0===e.length)return e;var t,r,n=e.split(/[_-]/);if(1===n.length&&n[0][0].toLowerCase()===n[0][0])return e;for(r=n[0].toLowerCase(),t=1;t<n.length;t++)r=r+n[t].charAt(0).toUpperCase()+n[t].substring(1).toLowerCase();return r}n.prepended=function(e,t){return e+(t=n(t))[0].toUpperCase()+t.substring(1)},e.exports=n},function(e,t,r){"use strict";var n=r(0);e.exports=function(e){var t=n((e=e||{}).name||e.past||"history"),r=n(e.future||"future"),i=n.prepended("clear",t),o=n.prepended(t,"back"),s=n.prepended(t,"forward"),a=n.prepended("can",o),c=n.prepended("can",s),u=e.max,l={configure:function(e){e.addTransitionLifecycleNames(o),e.addTransitionLifecycleNames(s)},init:function(e){e[t]=[],e[r]=[]},lifecycle:function(e,n){"onEnterState"===n.event&&(e[t].push(n.to),u&&e[t].length>u&&e[t].shift(),n.transition!==o&&n.transition!==s&&(e[r].length=0))},methods:{},properties:{}};return l.methods[i]=function(){this[t].length=0,this[r].length=0},l.properties[a]={get:function(){return this[t].length>1}},l.properties[c]={get:function(){return this[r].length>0}},l.methods[o]=function(){if(!this[a])throw Error("no history");var e=this[t].pop(),n=this[t].pop();this[r].push(e),this._fsm.transit(o,e,n,[])},l.methods[s]=function(){if(!this[c])throw Error("no history");var e=this.state,t=this[r].pop();this._fsm.transit(s,e,t,[])},l}}])},e.exports=t()},84907:function(e){var t;t=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.i=function(e){return e},r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(e,t,r){"use strict";e.exports=function(e,t){var r,n,i;for(r=1;r<arguments.length;r++)for(i in n=arguments[r])n.hasOwnProperty(i)&&(e[i]=n[i]);return e}},function(e,t,r){"use strict";var n=r(0);e.exports={build:function(e,t){var r,i,o,s=t.plugins;for(r=0,i=s.length;r<i;r++)(o=s[r]).methods&&n(e,o.methods),o.properties&&Object.defineProperties(e,o.properties)},hook:function(e,t,r){var n,i,o,s,a=e.config.plugins,c=[e.context];for(r&&(c=c.concat(r)),n=0,i=a.length;n<i;n++)s=a[n],(o=a[n][t])&&o.apply(s,c)}}},function(e,t,r){"use strict";function n(e){if(0===e.length)return e;var t,r,n=e.split(/[_-]/);if(1===n.length&&n[0][0].toLowerCase()===n[0][0])return e;for(r=n[0].toLowerCase(),t=1;t<n.length;t++)r=r+n[t].charAt(0).toUpperCase()+n[t].substring(1).toLowerCase();return r}n.prepended=function(e,t){return e+(t=n(t))[0].toUpperCase()+t.substring(1)},e.exports=n},function(e,t,r){"use strict";var n=r(0),i=r(2);function o(e,t){e=e||{},this.options=e,this.defaults=t.defaults,this.states=[],this.transitions=[],this.map={},this.lifecycle=this.configureLifecycle(),this.init=this.configureInitTransition(e.init),this.data=this.configureData(e.data),this.methods=this.configureMethods(e.methods),this.map[this.defaults.wildcard]={},this.configureTransitions(e.transitions||[]),this.plugins=this.configurePlugins(e.plugins,t.plugin)}n(o.prototype,{addState:function(e){this.map[e]||(this.states.push(e),this.addStateLifecycleNames(e),this.map[e]={})},addStateLifecycleNames:function(e){this.lifecycle.onEnter[e]=i.prepended("onEnter",e),this.lifecycle.onLeave[e]=i.prepended("onLeave",e),this.lifecycle.on[e]=i.prepended("on",e)},addTransition:function(e){this.transitions.indexOf(e)<0&&(this.transitions.push(e),this.addTransitionLifecycleNames(e))},addTransitionLifecycleNames:function(e){this.lifecycle.onBefore[e]=i.prepended("onBefore",e),this.lifecycle.onAfter[e]=i.prepended("onAfter",e),this.lifecycle.on[e]=i.prepended("on",e)},mapTransition:function(e){var t=e.name,r=e.from,n=e.to;return this.addState(r),"function"!=typeof n&&this.addState(n),this.addTransition(t),this.map[r][t]=e,e},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(e){return"string"==typeof e?this.mapTransition(n({},this.defaults.init,{to:e,active:!0})):"object"==typeof e?this.mapTransition(n({},this.defaults.init,e,{active:!0})):(this.addState(this.defaults.init.from),this.defaults.init)},configureData:function(e){return"function"==typeof e?e:"object"==typeof e?function(){return e}:function(){return{}}},configureMethods:function(e){return e||{}},configurePlugins:function(e,t){var r,n,i;for(r=0,n=(e=e||[]).length;r<n;r++)"function"==typeof(i=e[r])&&(e[r]=i=i()),i.configure&&i.configure(this);return e},configureTransitions:function(e){var t,r,n,i,o,s=this.defaults.wildcard;for(r=0;r<e.length;r++)for(n=e[r],i=Array.isArray(n.from)?n.from:[n.from||s],o=n.to||s,t=0;t<i.length;t++)this.mapTransition({name:n.name,from:i[t],to:o})},transitionFor:function(e,t){var r=this.defaults.wildcard;return this.map[e][t]||this.map[r][t]},transitionsFor:function(e){var t=this.defaults.wildcard;return Object.keys(this.map[e]).concat(Object.keys(this.map[t]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}}),e.exports=o},function(e,t,r){var n=r(0),i=r(6),o=r(1),s=[null,[]];function a(e,t){this.context=e,this.config=t,this.state=t.init.from,this.observers=[e]}n(a.prototype,{init:function(e){if(n(this.context,this.config.data.apply(this.context,e)),o.hook(this,"init"),this.config.init.active)return this.fire(this.config.init.name,[])},is:function(e){return Array.isArray(e)?e.indexOf(this.state)>=0:this.state===e},isPending:function(){return this.pending},can:function(e){return!this.isPending()&&!!this.seek(e)},cannot:function(e){return!this.can(e)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(e,t){var r=this.config.defaults.wildcard,n=this.config.transitionFor(this.state,e),i=n&&n.to;return"function"==typeof i?i.apply(this.context,t):i===r?this.state:i},fire:function(e,t){return this.transit(e,this.state,this.seek(e,t),t)},transit:function(e,t,r,n){var i=this.config.lifecycle,o=this.config.options.observeUnchangedState||t!==r;return r?this.isPending()?this.context.onPendingTransition(e,t,r):(this.config.addState(r),this.beginTransit(),n.unshift({transition:e,from:t,to:r,fsm:this.context}),this.observeEvents([this.observersForEvent(i.onBefore.transition),this.observersForEvent(i.onBefore[e]),o?this.observersForEvent(i.onLeave.state):s,o?this.observersForEvent(i.onLeave[t]):s,this.observersForEvent(i.on.transition),o?["doTransit",[this]]:s,o?this.observersForEvent(i.onEnter.state):s,o?this.observersForEvent(i.onEnter[r]):s,o?this.observersForEvent(i.on[r]):s,this.observersForEvent(i.onAfter.transition),this.observersForEvent(i.onAfter[e]),this.observersForEvent(i.on[e])],n)):this.context.onInvalidTransition(e,t,r)},beginTransit:function(){this.pending=!0},endTransit:function(e){return this.pending=!1,e},failTransit:function(e){throw this.pending=!1,e},doTransit:function(e){this.state=e.to},observe:function(e){if(2===e.length){var t={};t[e[0]]=e[1],this.observers.push(t)}else this.observers.push(e[0])},observersForEvent:function(e){for(var t,r=0,n=this.observers.length,i=[];r<n;r++)(t=this.observers[r])[e]&&i.push(t);return[e,i,!0]},observeEvents:function(e,t,r,n){if(0===e.length)return this.endTransit(void 0===n||n);var i=e[0][0],s=e[0][1],a=e[0][2];if(t[0].event=i,i&&a&&i!==r&&o.hook(this,"lifecycle",t),0===s.length)return e.shift(),this.observeEvents(e,t,i,n);var c=s.shift(),u=c[i].apply(c,t);return u&&"function"==typeof u.then?u.then(this.observeEvents.bind(this,e,t,i)).catch(this.failTransit.bind(this)):!1===u?this.endTransit(!1):this.observeEvents(e,t,i,u)},onInvalidTransition:function(e,t,r){throw new i("transition is invalid in current state",e,t,r,this.state)},onPendingTransition:function(e,t,r){throw new i("transition is invalid while previous transition is still in progress",e,t,r,this.state)}}),e.exports=a},function(e,t,r){"use strict";var n=r(0),i=r(2),o=r(1),s=r(3),a=r(4),c={is:function(e){return this._fsm.is(e)},can:function(e){return this._fsm.can(e)},cannot:function(e){return this._fsm.cannot(e)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(e,t,r){return this._fsm.onInvalidTransition(e,t,r)},onPendingTransition:function(e,t,r){return this._fsm.onPendingTransition(e,t,r)}},u={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(e){throw Error("use transitions to change state")}}};function l(e){return d(this||{},e)}function d(e,t){return h(e,new s(t,l)),e._fsm(),e}function h(e,t){if("object"!=typeof e||Array.isArray(e))throw Error("StateMachine can only be applied to objects");o.build(e,t),Object.defineProperties(e,u),n(e,c),n(e,t.methods),t.allTransitions().forEach((function(t){e[i(t)]=function(){return this._fsm.fire(t,[].slice.call(arguments))}})),e._fsm=function(){this._fsm=new a(this,t),this._fsm.init(arguments)}}l.version="3.0.1",l.factory=function(){var e,t;"function"==typeof arguments[0]?(e=arguments[0],t=arguments[1]||{}):(e=function(){this._fsm.apply(this,arguments)},t=arguments[0]||{});var r=new s(t,l);return h(e.prototype,r),e.prototype._fsm.config=r,e},l.apply=d,l.defaults={wildcard:"*",init:{name:"init",from:"none"}},e.exports=l},function(e,t,r){"use strict";e.exports=function(e,t,r,n,i){this.message=e,this.transition=t,this.from=r,this.to=n,this.current=i}}])},e.exports=t()},97626:(e,t,r)=>{var n=r(40158);e.exports=function(e,t){t=t||{};var r=n.decode(e,t);if(!r)return null;var i=r.payload;if("string"==typeof i)try{var o=JSON.parse(i);null!==o&&"object"==typeof o&&(i=o)}catch(e){}return!0===t.complete?{header:r.header,payload:i,signature:r.signature}:i}},49704:(e,t,r)=>{e.exports={decode:r(97626),verify:r(17030),sign:r(22506),JsonWebTokenError:r(58619),NotBeforeError:r(71826),TokenExpiredError:r(2340)}},58619:e=>{var t=function(e,t){Error.call(this,e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=e,t&&(this.inner=t)};(t.prototype=Object.create(Error.prototype)).constructor=t,e.exports=t},71826:(e,t,r)=>{var n=r(58619),i=function(e,t){n.call(this,e),this.name="NotBeforeError",this.date=t};(i.prototype=Object.create(n.prototype)).constructor=i,e.exports=i},2340:(e,t,r)=>{var n=r(58619),i=function(e,t){n.call(this,e),this.name="TokenExpiredError",this.expiredAt=t};(i.prototype=Object.create(n.prototype)).constructor=i,e.exports=i},85599:(e,t,r)=>{var n=r(34155);const i=r(81249);e.exports=i.satisfies(n.version,">=15.7.0")},14964:(e,t,r)=>{var n=r(34155),i=r(81249);e.exports=i.satisfies(n.version,"^6.12.0 || >=8.0.0")},91564:(e,t,r)=>{var n=r(34155);const i=r(81249);e.exports=i.satisfies(n.version,">=16.9.0")},68034:(e,t,r)=>{var n=r(57824);e.exports=function(e,t){var r=t||Math.floor(Date.now()/1e3);if("string"==typeof e){var i=n(e);if(void 0===i)return;return Math.floor(r+i/1e3)}return"number"==typeof e?r+e:void 0}},47566:(e,t,r)=>{const n=r(85599),i=r(91564),o={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},s={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};e.exports=function(e,t){if(!e||!t)return;const r=t.asymmetricKeyType;if(!r)return;const a=o[r];if(!a)throw new Error(`Unknown key type "${r}".`);if(!a.includes(e))throw new Error(`"alg" parameter for "${r}" key type must be one of: ${a.join(", ")}.`);if(n)switch(r){case"ec":const r=t.asymmetricKeyDetails.namedCurve,n=s[e];if(r!==n)throw new Error(`"alg" parameter "${e}" requires curve "${n}".`);break;case"rsa-pss":if(i){const r=parseInt(e.slice(-3),10),{hashAlgorithm:n,mgf1HashAlgorithm:i,saltLength:o}=t.asymmetricKeyDetails;if(n!==`sha${r}`||i!==n)throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${e}.`);if(void 0!==o&&o>r>>3)throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${e}.`)}}}},22506:(e,t,r)=>{const n=r(68034),i=r(14964),o=r(47566),s=r(40158),a=r(28922),c=r(48094),u=r(55928),l=r(23126),d=r(8146),h=r(25751),f=r(38917),{KeyObject:p,createSecretKey:m,createPrivateKey:g}=r(66507),v=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];i&&v.splice(3,0,"PS256","PS384","PS512");const y={expiresIn:{isValid:function(e){return u(e)||h(e)&&e},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(e){return u(e)||h(e)&&e},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(e){return h(e)||Array.isArray(e)},message:'"audience" must be a string or array'},algorithm:{isValid:a.bind(null,v),message:'"algorithm" must be a valid string enum value'},header:{isValid:d,message:'"header" must be an object'},encoding:{isValid:h,message:'"encoding" must be a string'},issuer:{isValid:h,message:'"issuer" must be a string'},subject:{isValid:h,message:'"subject" must be a string'},jwtid:{isValid:h,message:'"jwtid" must be a string'},noTimestamp:{isValid:c,message:'"noTimestamp" must be a boolean'},keyid:{isValid:h,message:'"keyid" must be a string'},mutatePayload:{isValid:c,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:c,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:c,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},b={iat:{isValid:l,message:'"iat" should be a number of seconds'},exp:{isValid:l,message:'"exp" should be a number of seconds'},nbf:{isValid:l,message:'"nbf" should be a number of seconds'}};function E(e,t,r,n){if(!d(r))throw new Error('Expected "'+n+'" to be a plain object.');Object.keys(r).forEach((function(i){const o=e[i];if(o){if(!o.isValid(r[i]))throw new Error(o.message)}else if(!t)throw new Error('"'+i+'" is not allowed in "'+n+'"')}))}const w={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},S=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];e.exports=function(e,t,r,i){"function"==typeof r?(i=r,r={}):r=r||{};const a="object"==typeof e&&!Buffer.isBuffer(e),c=Object.assign({alg:r.algorithm||"HS256",typ:a?"JWT":void 0,kid:r.keyid},r.header);function u(e){if(i)return i(e);throw e}if(!t&&"none"!==r.algorithm)return u(new Error("secretOrPrivateKey must have a value"));if(null!=t&&!(t instanceof p))try{t=g(t)}catch(e){try{t=m("string"==typeof t?Buffer.from(t):t)}catch(e){return u(new Error("secretOrPrivateKey is not valid key material"))}}if(c.alg.startsWith("HS")&&"secret"!==t.type)return u(new Error(`secretOrPrivateKey must be a symmetric key when using ${c.alg}`));if(/^(?:RS|PS|ES)/.test(c.alg)){if("private"!==t.type)return u(new Error(`secretOrPrivateKey must be an asymmetric key when using ${c.alg}`));if(!r.allowInsecureKeySizes&&!c.alg.startsWith("ES")&&void 0!==t.asymmetricKeyDetails&&t.asymmetricKeyDetails.modulusLength<2048)return u(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${c.alg}`))}if(void 0===e)return u(new Error("payload is required"));if(a){try{!function(e){E(b,!0,e,"payload")}(e)}catch(e){return u(e)}r.mutatePayload||(e=Object.assign({},e))}else{const t=S.filter((function(e){return void 0!==r[e]}));if(t.length>0)return u(new Error("invalid "+t.join(",")+" option for "+typeof e+" payload"))}if(void 0!==e.exp&&void 0!==r.expiresIn)return u(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(void 0!==e.nbf&&void 0!==r.notBefore)return u(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{!function(e){E(y,!1,e,"options")}(r)}catch(e){return u(e)}if(!r.allowInvalidAsymmetricKeyTypes)try{o(c.alg,t)}catch(e){return u(e)}const l=e.iat||Math.floor(Date.now()/1e3);if(r.noTimestamp?delete e.iat:a&&(e.iat=l),void 0!==r.notBefore){try{e.nbf=n(r.notBefore,l)}catch(e){return u(e)}if(void 0===e.nbf)return u(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(void 0!==r.expiresIn&&"object"==typeof e){try{e.exp=n(r.expiresIn,l)}catch(e){return u(e)}if(void 0===e.exp)return u(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(w).forEach((function(t){const n=w[t];if(void 0!==r[t]){if(void 0!==e[n])return u(new Error('Bad "options.'+t+'" option. The payload already has an "'+n+'" property.'));e[n]=r[t]}}));const d=r.encoding||"utf8";if("function"!=typeof i){let n=s.sign({header:c,payload:e,secret:t,encoding:d});if(!r.allowInsecureKeySizes&&/^(?:RS|PS)/.test(c.alg)&&n.length<256)throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${c.alg}`);return n}i=i&&f(i),s.createSign({header:c,privateKey:t,payload:e,encoding:d}).once("error",i).once("done",(function(e){if(!r.allowInsecureKeySizes&&/^(?:RS|PS)/.test(c.alg)&&e.length<256)return i(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${c.alg}`));i(null,e)}))}},17030:(e,t,r)=>{const n=r(58619),i=r(71826),o=r(2340),s=r(97626),a=r(68034),c=r(47566),u=r(14964),l=r(40158),{KeyObject:d,createSecretKey:h,createPublicKey:f}=r(66507),p=["RS256","RS384","RS512"],m=["ES256","ES384","ES512"],g=["RS256","RS384","RS512"],v=["HS256","HS384","HS512"];u&&(p.splice(p.length,0,"PS256","PS384","PS512"),g.splice(g.length,0,"PS256","PS384","PS512")),e.exports=function(e,t,r,u){let y;if("function"!=typeof r||u||(u=r,r={}),r||(r={}),r=Object.assign({},r),y=u||function(e,t){if(e)throw e;return t},r.clockTimestamp&&"number"!=typeof r.clockTimestamp)return y(new n("clockTimestamp must be a number"));if(void 0!==r.nonce&&("string"!=typeof r.nonce||""===r.nonce.trim()))return y(new n("nonce must be a non-empty string"));if(void 0!==r.allowInvalidAsymmetricKeyTypes&&"boolean"!=typeof r.allowInvalidAsymmetricKeyTypes)return y(new n("allowInvalidAsymmetricKeyTypes must be a boolean"));const b=r.clockTimestamp||Math.floor(Date.now()/1e3);if(!e)return y(new n("jwt must be provided"));if("string"!=typeof e)return y(new n("jwt must be a string"));const E=e.split(".");if(3!==E.length)return y(new n("jwt malformed"));let w;try{w=s(e,{complete:!0})}catch(e){return y(e)}if(!w)return y(new n("invalid token"));const S=w.header;let _;if("function"==typeof t){if(!u)return y(new n("verify must be called asynchronous if secret or public key is provided as a callback"));_=t}else _=function(e,r){return r(null,t)};return _(S,(function(t,s){if(t)return y(new n("error in secret or public key callback: "+t.message));const u=""!==E[2].trim();if(!u&&s)return y(new n("jwt signature is required"));if(u&&!s)return y(new n("secret or public key must be provided"));if(!u&&!r.algorithms)return y(new n('please specify "none" in "algorithms" to verify unsigned tokens'));if(null!=s&&!(s instanceof d))try{s=f(s)}catch(e){try{s=h("string"==typeof s?Buffer.from(s):s)}catch(e){return y(new n("secretOrPublicKey is not valid key material"))}}if(r.algorithms||("secret"===s.type?r.algorithms=v:["rsa","rsa-pss"].includes(s.asymmetricKeyType)?r.algorithms=g:"ec"===s.asymmetricKeyType?r.algorithms=m:r.algorithms=p),-1===r.algorithms.indexOf(w.header.alg))return y(new n("invalid algorithm"));if(S.alg.startsWith("HS")&&"secret"!==s.type)return y(new n(`secretOrPublicKey must be a symmetric key when using ${S.alg}`));if(/^(?:RS|PS|ES)/.test(S.alg)&&"public"!==s.type)return y(new n(`secretOrPublicKey must be an asymmetric key when using ${S.alg}`));if(!r.allowInvalidAsymmetricKeyTypes)try{c(S.alg,s)}catch(e){return y(e)}let _;try{_=l.verify(e,w.header.alg,s)}catch(e){return y(e)}if(!_)return y(new n("invalid signature"));const T=w.payload;if(void 0!==T.nbf&&!r.ignoreNotBefore){if("number"!=typeof T.nbf)return y(new n("invalid nbf value"));if(T.nbf>b+(r.clockTolerance||0))return y(new i("jwt not active",new Date(1e3*T.nbf)))}if(void 0!==T.exp&&!r.ignoreExpiration){if("number"!=typeof T.exp)return y(new n("invalid exp value"));if(b>=T.exp+(r.clockTolerance||0))return y(new o("jwt expired",new Date(1e3*T.exp)))}if(r.audience){const e=Array.isArray(r.audience)?r.audience:[r.audience];if(!(Array.isArray(T.aud)?T.aud:[T.aud]).some((function(t){return e.some((function(e){return e instanceof RegExp?e.test(t):e===t}))})))return y(new n("jwt audience invalid. expected: "+e.join(" or ")))}if(r.issuer){if("string"==typeof r.issuer&&T.iss!==r.issuer||Array.isArray(r.issuer)&&-1===r.issuer.indexOf(T.iss))return y(new n("jwt issuer invalid. expected: "+r.issuer))}if(r.subject&&T.sub!==r.subject)return y(new n("jwt subject invalid. expected: "+r.subject));if(r.jwtid&&T.jti!==r.jwtid)return y(new n("jwt jwtid invalid. expected: "+r.jwtid));if(r.nonce&&T.nonce!==r.nonce)return y(new n("jwt nonce invalid. expected: "+r.nonce));if(r.maxAge){if("number"!=typeof T.iat)return y(new n("iat required when maxAge is specified"));const e=a(r.maxAge,T.iat);if(void 0===e)return y(new n('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(b>=e+(r.clockTolerance||0))return y(new o("maxAge exceeded",new Date(1e3*e)))}if(!0===r.complete){const e=w.signature;return y(null,{header:S,payload:T,signature:e})}return y(null,T)}))}},54178:(e,t,r)=>{var n=r(88500),i=r(89509).Buffer,o=r(86035),s=r(35015),a=r(89539),c="secret must be a string or buffer",u="key must be a string or a buffer",l="key must be a string, a buffer or an object",d="function"==typeof o.createPublicKey;function h(e){if(!i.isBuffer(e)&&"string"!=typeof e){if(!d)throw g(u);if("object"!=typeof e)throw g(u);if("string"!=typeof e.type)throw g(u);if("string"!=typeof e.asymmetricKeyType)throw g(u);if("function"!=typeof e.export)throw g(u)}}function f(e){if(!i.isBuffer(e)&&"string"!=typeof e&&"object"!=typeof e)throw g(l)}function p(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function m(e){var t=4-(e=e.toString()).length%4;if(4!==t)for(var r=0;r<t;++r)e+="=";return e.replace(/\-/g,"+").replace(/_/g,"/")}function g(e){var t=[].slice.call(arguments,1),r=a.format.bind(a,e).apply(null,t);return new TypeError(r)}function v(e){var t;return t=e,i.isBuffer(t)||"string"==typeof t||(e=JSON.stringify(e)),e}function y(e){return function(t,r){!function(e){if(!i.isBuffer(e)){if("string"==typeof e)return e;if(!d)throw g(c);if("object"!=typeof e)throw g(c);if("secret"!==e.type)throw g(c);if("function"!=typeof e.export)throw g(c)}}(r),t=v(t);var n=o.createHmac("sha"+e,r);return p((n.update(t),n.digest("base64")))}}function b(e){return function(t,r,o){var s=y(e)(t,o);return n(i.from(r),i.from(s))}}function E(e){return function(t,r){f(r),t=v(t);var n=o.createSign("RSA-SHA"+e);return p((n.update(t),n.sign(r,"base64")))}}function w(e){return function(t,r,n){h(n),t=v(t),r=m(r);var i=o.createVerify("RSA-SHA"+e);return i.update(t),i.verify(n,r,"base64")}}function S(e){return function(t,r){f(r),t=v(t);var n=o.createSign("RSA-SHA"+e);return p((n.update(t),n.sign({key:r,padding:o.constants.RSA_PKCS1_PSS_PADDING,saltLength:o.constants.RSA_PSS_SALTLEN_DIGEST},"base64")))}}function _(e){return function(t,r,n){h(n),t=v(t),r=m(r);var i=o.createVerify("RSA-SHA"+e);return i.update(t),i.verify({key:n,padding:o.constants.RSA_PKCS1_PSS_PADDING,saltLength:o.constants.RSA_PSS_SALTLEN_DIGEST},r,"base64")}}function T(e){var t=E(e);return function(){var r=t.apply(null,arguments);return r=s.derToJose(r,"ES"+e)}}function x(e){var t=w(e);return function(r,n,i){return n=s.joseToDer(n,"ES"+e).toString("base64"),t(r,n,i)}}function A(){return function(){return""}}function I(){return function(e,t){return""===t}}d&&(u+=" or a KeyObject",c+="or a KeyObject"),e.exports=function(e){var t={hs:y,rs:E,ps:S,es:T,none:A},r={hs:b,rs:w,ps:_,es:x,none:I},n=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!n)throw g('"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".',e);var i=(n[1]||n[3]).toLowerCase(),o=n[2];return{sign:t[i](o),verify:r[i](o)}}},40158:(e,t,r)=>{var n=r(48952),i=r(43079);t.ALGORITHMS=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"],t.sign=n.sign,t.verify=i.verify,t.decode=i.decode,t.isValid=i.isValid,t.createSign=function(e){return new n(e)},t.createVerify=function(e){return new i(e)}},97006:(e,t,r)=>{var n=r(34155),i=r(89509).Buffer,o=r(42830);function s(e){if(this.buffer=null,this.writable=!0,this.readable=!0,!e)return this.buffer=i.alloc(0),this;if("function"==typeof e.pipe)return this.buffer=i.alloc(0),e.pipe(this),this;if(e.length||"object"==typeof e)return this.buffer=e,this.writable=!1,n.nextTick(function(){this.emit("end",e),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof e+")")}r(89539).inherits(s,o),s.prototype.write=function(e){this.buffer=i.concat([this.buffer,i.from(e)]),this.emit("data",e)},s.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1},e.exports=s},48952:(e,t,r)=>{var n=r(89509).Buffer,i=r(97006),o=r(54178),s=r(42830),a=r(32010),c=r(89539);function u(e,t){return n.from(e,t).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function l(e){var t=e.header,r=e.payload,n=e.secret||e.privateKey,i=e.encoding,s=o(t.alg),l=function(e,t,r){r=r||"utf8";var n=u(a(e),"binary"),i=u(a(t),r);return c.format("%s.%s",n,i)}(t,r,i),d=s.sign(l,n);return c.format("%s.%s",l,d)}function d(e){var t=e.secret||e.privateKey||e.key,r=new i(t);this.readable=!0,this.header=e.header,this.encoding=e.encoding,this.secret=this.privateKey=this.key=r,this.payload=new i(e.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}c.inherits(d,s),d.prototype.sign=function(){try{var e=l({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},d.sign=l,e.exports=d},32010:(e,t,r)=>{var n=r(48764).Buffer;e.exports=function(e){return"string"==typeof e?e:"number"==typeof e||n.isBuffer(e)?e.toString():JSON.stringify(e)}},43079:(e,t,r)=>{var n=r(89509).Buffer,i=r(97006),o=r(54178),s=r(42830),a=r(32010),c=r(89539),u=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function l(e){if(function(e){return"[object Object]"===Object.prototype.toString.call(e)}(e))return e;try{return JSON.parse(e)}catch(e){return}}function d(e){var t=e.split(".",1)[0];return l(n.from(t,"base64").toString("binary"))}function h(e){return e.split(".")[2]}function f(e){return u.test(e)&&!!d(e)}function p(e,t,r){if(!t){var n=new Error("Missing algorithm parameter for jws.verify");throw n.code="MISSING_ALGORITHM",n}var i=h(e=a(e)),s=function(e){return e.split(".",2).join(".")}(e);return o(t).verify(s,i,r)}function m(e,t){if(t=t||{},!f(e=a(e)))return null;var r=d(e);if(!r)return null;var i=function(e,t){t=t||"utf8";var r=e.split(".")[1];return n.from(r,"base64").toString(t)}(e);return("JWT"===r.typ||t.json)&&(i=JSON.parse(i,t.encoding)),{header:r,payload:i,signature:h(e)}}function g(e){var t=(e=e||{}).secret||e.publicKey||e.key,r=new i(t);this.readable=!0,this.algorithm=e.algorithm,this.encoding=e.encoding,this.secret=this.publicKey=this.key=r,this.signature=new i(e.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}c.inherits(g,s),g.prototype.verify=function(){try{var e=p(this.signature.buffer,this.algorithm,this.key.buffer),t=m(this.signature.buffer,this.encoding);return this.emit("done",e,t),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},g.decode=m,g.isValid=f,g.verify=p,e.exports=g},78414:e=>{var t=Array.prototype.slice;function r(e){if("object"!=typeof(e=e||{}))throw new TypeError("Options must be an object");this.storage={},this.separator=e.separator||"."}r.prototype.add=function(e,t){(this.storage[e]||(this.storage[e]=[])).push(t)},r.prototype.remove=function(e){var t,r;for(t in this.storage)(r=this.storage[t]).some((function(t,n){if(t===e)return r.splice(n,1),!0}))},r.prototype.get=function(e){var t,r=[];for(t in this.storage)e&&e!==t&&0!==t.indexOf(e+this.separator)||(r=r.concat(this.storage[t]));return r},r.prototype.getGrouped=function(e){var r,n={};for(r in this.storage)e&&e!==r&&0!==r.indexOf(e+this.separator)||(n[r]=t.call(this.storage[r]));return n},r.prototype.getAll=function(e){var r,n={};for(r in this.storage)e!==r&&0!==r.indexOf(e+this.separator)||(n[r]=t.call(this.storage[r]));return n},r.prototype.run=function(e,r){var n=t.call(arguments,2);this.get(e).forEach((function(e){e.apply(r||this,n)}))},e.exports=r},43962:e=>{e.exports=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}},39871:e=>{e.exports=function(e,t){for(var r=-1,n=e.length;++r<n&&!1!==t(e[r],r,e););return e}},64842:(e,t,r)=>{var n=r(33589),i=r(44799);e.exports=function(e,t){return null==t?e:n(t,i(t),e)}},59713:(e,t,r)=>{var n=r(43962),i=r(39871),o=r(64842),s=r(30563),a=r(53778),c=r(44799),u="[object Arguments]",l="[object Boolean]",d="[object Date]",h="[object Function]",f="[object Number]",p="[object Object]",m="[object RegExp]",g="[object String]",v="[object ArrayBuffer]",y="[object Float32Array]",b="[object Float64Array]",E="[object Int8Array]",w="[object Int16Array]",S="[object Int32Array]",_="[object Uint8Array]",T="[object Uint8ClampedArray]",x="[object Uint16Array]",A="[object Uint32Array]",I=/\w*$/,C={};C[u]=C["[object Array]"]=C[v]=C[l]=C[d]=C[y]=C[b]=C[E]=C[w]=C[S]=C[f]=C[p]=C[m]=C[g]=C[_]=C[T]=C[x]=C[A]=!0,C["[object Error]"]=C[h]=C["[object Map]"]=C["[object Set]"]=C["[object WeakMap]"]=!1;var R=Object.prototype,k=R.hasOwnProperty,O=R.toString,N=r.g.ArrayBuffer,P=r.g.Uint8Array;function L(e,t){return s(e,t,c)}function D(e){var t=new N(e.byteLength);return new P(t).set(new P(e)),t}e.exports=function e(t,r,s,c,R,N,P){var M;if(s&&(M=R?s(t,c,R):s(t)),void 0!==M)return M;if(!function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(t))return t;var U=a(t);if(U){if(M=function(e){var t=e.length,r=new e.constructor(t);t&&"string"==typeof e[0]&&k.call(e,"index")&&(r.index=e.index,r.input=e.input);return r}(t),!r)return n(t,M)}else{var B=O.call(t),F=B==h;if(B!=p&&B!=u&&(!F||R))return C[B]?function(e,t,r){var n=e.constructor;switch(t){case v:return D(e);case l:case d:return new n(+e);case y:case b:case E:case w:case S:case _:case T:case x:case A:var i=e.buffer;return new n(r?D(i):i,e.byteOffset,e.length);case f:case g:return new n(e);case m:var o=new n(e.source,I.exec(e));o.lastIndex=e.lastIndex}return o}(t,B,r):R?t:{};if(M=function(e){var t=e.constructor;"function"==typeof t&&t instanceof t||(t=Object);return new t}(F?{}:t),!r)return o(M,t)}N||(N=[]),P||(P=[]);for(var j=N.length;j--;)if(N[j]==t)return P[j];return N.push(t),P.push(M),(U?i:L)(t,(function(n,i){M[i]=e(n,r,s,i,t,N,P)})),M}},33589:e=>{e.exports=function(e,t,r){r||(r={});for(var n=-1,i=t.length;++n<i;){var o=t[n];r[o]=e[o]}return r}},30563:e=>{var t,r=function(e,r,n){for(var i=-1,o=Object(e),s=n(e),a=s.length;a--;){var c=s[t?a:++i];if(!1===r(o[c],c,o))break}return e};e.exports=r},79773:e=>{function t(e){return e}e.exports=function(e,r,n){if("function"!=typeof e)return t;if(void 0===r)return e;switch(n){case 1:return function(t){return e.call(r,t)};case 3:return function(t,n,i){return e.call(r,t,n,i)};case 4:return function(t,n,i,o){return e.call(r,t,n,i,o)};case 5:return function(t,n,i,o,s){return e.call(r,t,n,i,o,s)}}return function(){return e.apply(r,arguments)}}},73649:e=>{var t="[object Function]",r=/^\[object .+?Constructor\]$/;var n=Object.prototype,i=Function.prototype.toString,o=n.hasOwnProperty,s=n.toString,a=RegExp("^"+i.call(o).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e,n){var o=null==e?void 0:e[n];return function(e){if(null==e)return!1;if(function(e){return function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(e)&&s.call(e)==t}(e))return a.test(i.call(e));return function(e){return!!e&&"object"==typeof e}(e)&&r.test(e)}(o)?o:void 0}},62516:e=>{var t=/^\d+$/,r=9007199254740991;var n,i=(n="length",function(e){return null==e?void 0:e[n]});function o(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}(i(e))}e.exports=function(e,n,i){if(!function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(i))return!1;var s=typeof n;if("number"==s?o(i)&&function(e,n){return e="number"==typeof e||t.test(e)?+e:-1,n=null==n?r:n,e>-1&&e%1==0&&e<n}(n,i.length):"string"==s&&n in i){var a=i[n];return e==e?e===a:a!=a}return!1}},33543:(e,t,r)=>{var n=r(59713),i=r(79773),o=r(62516);e.exports=function(e,t,r,s){return t&&"boolean"!=typeof t&&o(e,t,r)?t=!1:"function"==typeof t&&(s=r,r=t,t=!1),"function"==typeof r?n(e,t,i(r,s,3)):n(e,t)}},28922:e=>{var t=1/0,r=9007199254740991,n=17976931348623157e292,i=NaN,o="[object Arguments]",s="[object Function]",a="[object GeneratorFunction]",c="[object String]",u="[object Symbol]",l=/^\s+|\s+$/g,d=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,f=/^0o[0-7]+$/i,p=/^(?:0|[1-9]\d*)$/,m=parseInt;function g(e){return e!=e}function v(e,t){return function(e,t){for(var r=-1,n=e?e.length:0,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}(t,(function(t){return e[t]}))}var y,b,E=Object.prototype,w=E.hasOwnProperty,S=E.toString,_=E.propertyIsEnumerable,T=(y=Object.keys,b=Object,function(e){return y(b(e))}),x=Math.max;function A(e,t){var r=R(e)||function(e){return function(e){return N(e)&&k(e)}(e)&&w.call(e,"callee")&&(!_.call(e,"callee")||S.call(e)==o)}(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],n=r.length,i=!!n;for(var s in e)!t&&!w.call(e,s)||i&&("length"==s||C(s,n))||r.push(s);return r}function I(e){if(r=(t=e)&&t.constructor,n="function"==typeof r&&r.prototype||E,t!==n)return T(e);var t,r,n,i=[];for(var o in Object(e))w.call(e,o)&&"constructor"!=o&&i.push(o);return i}function C(e,t){return!!(t=null==t?r:t)&&("number"==typeof e||p.test(e))&&e>-1&&e%1==0&&e<t}var R=Array.isArray;function k(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}(e.length)&&!function(e){var t=O(e)?S.call(e):"";return t==s||t==a}(e)}function O(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function N(e){return!!e&&"object"==typeof e}e.exports=function(e,r,o,s){var a;e=k(e)?e:(a=e)?v(a,function(e){return k(e)?A(e):I(e)}(a)):[],o=o&&!s?function(e){var r=function(e){if(!e)return 0===e?e:0;if(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||N(e)&&S.call(e)==u}(e))return i;if(O(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=O(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(l,"");var r=h.test(e);return r||f.test(e)?m(e.slice(2),r?2:8):d.test(e)?i:+e}(e),e===t||e===-t){return(e<0?-1:1)*n}return e==e?e:0}(e),o=r%1;return r==r?o?r-o:r:0}(o):0;var p=e.length;return o<0&&(o=x(p+o,0)),function(e){return"string"==typeof e||!R(e)&&N(e)&&S.call(e)==c}(e)?o<=p&&e.indexOf(r,o)>-1:!!p&&function(e,t,r){if(t!=t)return function(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1}(e,g,r);for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}(e,r,o)>-1}},35757:e=>{var t=9007199254740991,r="[object Function]",n="[object GeneratorFunction]",i=Object.prototype,o=i.hasOwnProperty,s=i.toString,a=i.propertyIsEnumerable;e.exports=function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&function(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=t}(e.length)&&!function(e){var t=function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(e)?s.call(e):"";return t==r||t==n}(e)}(e)}(e)&&o.call(e,"callee")&&(!a.call(e,"callee")||"[object Arguments]"==s.call(e))}},53778:e=>{var t="[object Function]",r=/^\[object .+?Constructor\]$/;function n(e){return!!e&&"object"==typeof e}var i,o,s,a=Object.prototype,c=Function.prototype.toString,u=a.hasOwnProperty,l=a.toString,d=RegExp("^"+c.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),h=(o="isArray",function(e){return null!=e&&(function(e){return function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(e)&&l.call(e)==t}(e)?d.test(c.call(e)):n(e)&&r.test(e))}(s=null==(i=Array)?void 0:i[o])?s:void 0);var f=h||function(e){return n(e)&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&"[object Array]"==l.call(e)};e.exports=f},48094:e=>{var t=Object.prototype.toString;e.exports=function(e){return!0===e||!1===e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Boolean]"==t.call(e)}},55928:e=>{var t=1/0,r=17976931348623157e292,n=NaN,i="[object Symbol]",o=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,c=/^0o[0-7]+$/i,u=parseInt,l=Object.prototype.toString;function d(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=function(e){return"number"==typeof e&&e==function(e){var h=function(e){if(!e)return 0===e?e:0;if(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&l.call(e)==i}(e))return n;if(d(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=d(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var r=a.test(e);return r||c.test(e)?u(e.slice(2),r?2:8):s.test(e)?n:+e}(e),e===t||e===-t){return(e<0?-1:1)*r}return e==e?e:0}(e),f=h%1;return h==h?f?h-f:h:0}(e)}},23126:e=>{var t=Object.prototype.toString;e.exports=function(e){return"number"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Number]"==t.call(e)}},8146:e=>{var t,r,n=Function.prototype,i=Object.prototype,o=n.toString,s=i.hasOwnProperty,a=o.call(Object),c=i.toString,u=(t=Object.getPrototypeOf,r=Object,function(e){return t(r(e))});e.exports=function(e){if(!function(e){return!!e&&"object"==typeof e}(e)||"[object Object]"!=c.call(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e))return!1;var t=u(e);if(null===t)return!0;var r=s.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&o.call(r)==a}},25751:e=>{var t=Object.prototype.toString,r=Array.isArray;e.exports=function(e){return"string"==typeof e||!r(e)&&function(e){return!!e&&"object"==typeof e}(e)&&"[object String]"==t.call(e)}},44799:(e,t,r)=>{var n=r(73649),i=r(35757),o=r(53778),s=/^\d+$/,a=Object.prototype.hasOwnProperty,c=n(Object,"keys"),u=9007199254740991;var l,d=(l="length",function(e){return null==e?void 0:e[l]});function h(e,t){return e="number"==typeof e||s.test(e)?+e:-1,t=null==t?u:t,e>-1&&e%1==0&&e<t}function f(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=u}function p(e){for(var t=function(e){if(null==e)return[];m(e)||(e=Object(e));var t=e.length;t=t&&f(t)&&(o(e)||i(e))&&t||0;var r=e.constructor,n=-1,s="function"==typeof r&&r.prototype===e,c=Array(t),u=t>0;for(;++n<t;)c[n]=n+"";for(var l in e)u&&h(l,t)||"constructor"==l&&(s||!a.call(e,l))||c.push(l);return c}(e),r=t.length,n=r&&e.length,s=!!n&&f(n)&&(o(e)||i(e)),c=-1,u=[];++c<r;){var l=t[c];(s&&h(l,n)||a.call(e,l))&&u.push(l)}return u}function m(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var g=c?function(e){var t,r=null==e?void 0:e.constructor;return"function"==typeof r&&r.prototype===e||"function"!=typeof e&&(null!=(t=e)&&f(d(t)))?p(e):m(e)?c(e):[]}:p;e.exports=g},38917:e=>{var t="Expected a function",r=1/0,n=17976931348623157e292,i=NaN,o="[object Symbol]",s=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,u=/^0o[0-7]+$/i,l=parseInt,d=Object.prototype.toString;function h(e,h){var p;if("function"!=typeof h)throw new TypeError(t);return e=function(e){var t=function(e){if(!e)return 0===e?e:0;if(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&d.call(e)==o}(e))return i;if(f(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=f(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var r=c.test(e);return r||u.test(e)?l(e.slice(2),r?2:8):a.test(e)?i:+e}(e),e===r||e===-r){return(e<0?-1:1)*n}return e==e?e:0}(e),h=t%1;return t==t?h?t-h:t:0}(e),function(){return--e>0&&(p=h.apply(this,arguments)),e<=1&&(h=void 0),p}}function f(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=function(e){return h(2,e)}},18552:(e,t,r)=>{var n=r(10852)(r(55639),"DataView");e.exports=n},1989:(e,t,r)=>{var n=r(51789),i=r(80401),o=r(57667),s=r(21327),a=r(81866);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=s,c.prototype.set=a,e.exports=c},96425:(e,t,r)=>{var n=r(3118),i=r(9435);function o(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}o.prototype=n(i.prototype),o.prototype.constructor=o,e.exports=o},38407:(e,t,r)=>{var n=r(27040),i=r(14125),o=r(82117),s=r(67518),a=r(54705);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=s,c.prototype.set=a,e.exports=c},7548:(e,t,r)=>{var n=r(3118),i=r(9435);function o(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}o.prototype=n(i.prototype),o.prototype.constructor=o,e.exports=o},57071:(e,t,r)=>{var n=r(10852)(r(55639),"Map");e.exports=n},83369:(e,t,r)=>{var n=r(24785),i=r(11285),o=r(96e3),s=r(49916),a=r(95265);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=s,c.prototype.set=a,e.exports=c},53818:(e,t,r)=>{var n=r(10852)(r(55639),"Promise");e.exports=n},58525:(e,t,r)=>{var n=r(10852)(r(55639),"Set");e.exports=n},88668:(e,t,r)=>{var n=r(83369),i=r(90619),o=r(72385);function s(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new n;++t<r;)this.add(e[t])}s.prototype.add=s.prototype.push=i,s.prototype.has=o,e.exports=s},46384:(e,t,r)=>{var n=r(38407),i=r(37465),o=r(63779),s=r(67599),a=r(44758),c=r(34309);function u(e){var t=this.__data__=new n(e);this.size=t.size}u.prototype.clear=i,u.prototype.delete=o,u.prototype.get=s,u.prototype.has=a,u.prototype.set=c,e.exports=u},62705:(e,t,r)=>{var n=r(55639).Symbol;e.exports=n},11149:(e,t,r)=>{var n=r(55639).Uint8Array;e.exports=n},70577:(e,t,r)=>{var n=r(10852)(r(55639),"WeakMap");e.exports=n},96874:e=>{e.exports=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}},44174:e=>{e.exports=function(e,t,r,n){for(var i=-1,o=null==e?0:e.length;++i<o;){var s=e[i];t(n,s,r(s),e)}return n}},77412:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}},34963:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var s=e[r];t(s,r,e)&&(o[i++]=s)}return o}},47443:(e,t,r)=>{var n=r(42118);e.exports=function(e,t){return!!(null==e?0:e.length)&&n(e,t,0)>-1}},1196:e=>{e.exports=function(e,t,r){for(var n=-1,i=null==e?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1}},14636:(e,t,r)=>{var n=r(22545),i=r(35694),o=r(1469),s=r(44144),a=r(65776),c=r(36719),u=Object.prototype.hasOwnProperty;e.exports=function(e,t){var r=o(e),l=!r&&i(e),d=!r&&!l&&s(e),h=!r&&!l&&!d&&c(e),f=r||l||d||h,p=f?n(e.length,String):[],m=p.length;for(var g in e)!t&&!u.call(e,g)||f&&("length"==g||d&&("offset"==g||"parent"==g)||h&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||a(g,m))||p.push(g);return p}},29932:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}},62488:e=>{e.exports=function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}},62663:e=>{e.exports=function(e,t,r,n){var i=-1,o=null==e?0:e.length;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r}},82908:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}},44286:e=>{e.exports=function(e){return e.split("")}},49029:e=>{var t=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;e.exports=function(e){return e.match(t)||[]}},86556:(e,t,r)=>{var n=r(89465),i=r(77813);e.exports=function(e,t,r){(void 0!==r&&!i(e[t],r)||void 0===r&&!(t in e))&&n(e,t,r)}},34865:(e,t,r)=>{var n=r(89465),i=r(77813),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,r){var s=e[t];o.call(e,t)&&i(s,r)&&(void 0!==r||t in e)||n(e,t,r)}},18470:(e,t,r)=>{var n=r(77813);e.exports=function(e,t){for(var r=e.length;r--;)if(n(e[r][0],t))return r;return-1}},81119:(e,t,r)=>{var n=r(89881);e.exports=function(e,t,r,i){return n(e,(function(e,n,o){t(i,e,r(e),o)})),i}},44037:(e,t,r)=>{var n=r(98363),i=r(3674);e.exports=function(e,t){return e&&n(t,i(t),e)}},63886:(e,t,r)=>{var n=r(98363),i=r(81704);e.exports=function(e,t){return e&&n(t,i(t),e)}},89465:(e,t,r)=>{var n=r(38777);e.exports=function(e,t,r){"__proto__"==t&&n?n(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}},29750:e=>{e.exports=function(e,t,r){return e==e&&(void 0!==r&&(e=e<=r?e:r),void 0!==t&&(e=e>=t?e:t)),e}},85990:(e,t,r)=>{var n=r(46384),i=r(77412),o=r(34865),s=r(44037),a=r(63886),c=r(64626),u=r(278),l=r(18805),d=r(1911),h=r(58234),f=r(46904),p=r(64160),m=r(43824),g=r(29148),v=r(38517),y=r(1469),b=r(44144),E=r(56688),w=r(13218),S=r(72928),_=r(3674),T=r(81704),x="[object Arguments]",A="[object Function]",I="[object Object]",C={};C[x]=C["[object Array]"]=C["[object ArrayBuffer]"]=C["[object DataView]"]=C["[object Boolean]"]=C["[object Date]"]=C["[object Float32Array]"]=C["[object Float64Array]"]=C["[object Int8Array]"]=C["[object Int16Array]"]=C["[object Int32Array]"]=C["[object Map]"]=C["[object Number]"]=C[I]=C["[object RegExp]"]=C["[object Set]"]=C["[object String]"]=C["[object Symbol]"]=C["[object Uint8Array]"]=C["[object Uint8ClampedArray]"]=C["[object Uint16Array]"]=C["[object Uint32Array]"]=!0,C["[object Error]"]=C[A]=C["[object WeakMap]"]=!1,e.exports=function e(t,r,R,k,O,N){var P,L=1&r,D=2&r,M=4&r;if(R&&(P=O?R(t,k,O,N):R(t)),void 0!==P)return P;if(!w(t))return t;var U=y(t);if(U){if(P=m(t),!L)return u(t,P)}else{var B=p(t),F=B==A||"[object GeneratorFunction]"==B;if(b(t))return c(t,L);if(B==I||B==x||F&&!O){if(P=D||F?{}:v(t),!L)return D?d(t,a(P,t)):l(t,s(P,t))}else{if(!C[B])return O?t:{};P=g(t,B,L)}}N||(N=new n);var j=N.get(t);if(j)return j;N.set(t,P),S(t)?t.forEach((function(n){P.add(e(n,r,R,n,t,N))})):E(t)&&t.forEach((function(n,i){P.set(i,e(n,r,R,i,t,N))}));var V=U?void 0:(M?D?f:h:D?T:_)(t);return i(V||t,(function(n,i){V&&(n=t[i=n]),o(P,i,e(n,r,R,i,t,N))})),P}},3118:(e,t,r)=>{var n=r(13218),i=Object.create,o=function(){function e(){}return function(t){if(!n(t))return{};if(i)return i(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();e.exports=o},38845:e=>{e.exports=function(e,t,r){if("function"!=typeof e)throw new TypeError("Expected a function");return setTimeout((function(){e.apply(void 0,r)}),t)}},20731:(e,t,r)=>{var n=r(88668),i=r(47443),o=r(1196),s=r(29932),a=r(7518),c=r(74757);e.exports=function(e,t,r,u){var l=-1,d=i,h=!0,f=e.length,p=[],m=t.length;if(!f)return p;r&&(t=s(t,a(r))),u?(d=o,h=!1):t.length>=200&&(d=c,h=!1,t=new n(t));e:for(;++l<f;){var g=e[l],v=null==r?g:r(g);if(g=u||0!==g?g:0,h&&v==v){for(var y=m;y--;)if(t[y]===v)continue e;p.push(g)}else d(t,v,u)||p.push(g)}return p}},89881:(e,t,r)=>{var n=r(47816),i=r(99291)(n);e.exports=i},56029:(e,t,r)=>{var n=r(33448);e.exports=function(e,t,r){for(var i=-1,o=e.length;++i<o;){var s=e[i],a=t(s);if(null!=a&&(void 0===c?a==a&&!n(a):r(a,c)))var c=a,u=s}return u}},87157:(e,t,r)=>{var n=r(40554),i=r(88958);e.exports=function(e,t,r,o){var s=e.length;for((r=n(r))<0&&(r=-r>s?0:s+r),(o=void 0===o||o>s?s:n(o))<0&&(o+=s),o=r>o?0:i(o);r<o;)e[r++]=t;return e}},80760:(e,t,r)=>{var n=r(89881);e.exports=function(e,t){var r=[];return n(e,(function(e,n,i){t(e,n,i)&&r.push(e)})),r}},41848:e=>{e.exports=function(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1}},21078:(e,t,r)=>{var n=r(62488),i=r(37285);e.exports=function e(t,r,o,s,a){var c=-1,u=t.length;for(o||(o=i),a||(a=[]);++c<u;){var l=t[c];r>0&&o(l)?r>1?e(l,r-1,o,s,a):n(a,l):s||(a[a.length]=l)}return a}},28483:(e,t,r)=>{var n=r(25063)();e.exports=n},47816:(e,t,r)=>{var n=r(28483),i=r(3674);e.exports=function(e,t){return e&&n(e,t,i)}},97786:(e,t,r)=>{var n=r(71811),i=r(40327);e.exports=function(e,t){for(var r=0,o=(t=n(t,e)).length;null!=e&&r<o;)e=e[i(t[r++])];return r&&r==o?e:void 0}},68866:(e,t,r)=>{var n=r(62488),i=r(1469);e.exports=function(e,t,r){var o=t(e);return i(e)?o:n(o,r(e))}},44239:(e,t,r)=>{var n=r(62705),i=r(89607),o=r(2333),s=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":s&&s in Object(e)?i(e):o(e)}},53325:e=>{e.exports=function(e,t){return e>t}},78565:e=>{var t=Object.prototype.hasOwnProperty;e.exports=function(e,r){return null!=e&&t.call(e,r)}},13:e=>{e.exports=function(e,t){return null!=e&&t in Object(e)}},42118:(e,t,r)=>{var n=r(41848),i=r(62722),o=r(42351);e.exports=function(e,t,r){return t==t?o(e,t,r):n(e,i,r)}},47556:(e,t,r)=>{var n=r(88668),i=r(47443),o=r(1196),s=r(29932),a=r(7518),c=r(74757),u=Math.min;e.exports=function(e,t,r){for(var l=r?o:i,d=e[0].length,h=e.length,f=h,p=Array(h),m=1/0,g=[];f--;){var v=e[f];f&&t&&(v=s(v,a(t))),m=u(v.length,m),p[f]=!r&&(t||d>=120&&v.length>=120)?new n(f&&v):void 0}v=e[0];var y=-1,b=p[0];e:for(;++y<d&&g.length<m;){var E=v[y],w=t?t(E):E;if(E=r||0!==E?E:0,!(b?c(b,w):l(g,w,r))){for(f=h;--f;){var S=p[f];if(!(S?c(S,w):l(e[f],w,r)))continue e}b&&b.push(w),g.push(E)}}return g}},9454:(e,t,r)=>{var n=r(44239),i=r(37005);e.exports=function(e){return i(e)&&"[object Arguments]"==n(e)}},41761:(e,t,r)=>{var n=r(44239),i=r(37005);e.exports=function(e){return i(e)&&"[object Date]"==n(e)}},90939:(e,t,r)=>{var n=r(2492),i=r(37005);e.exports=function e(t,r,o,s,a){return t===r||(null==t||null==r||!i(t)&&!i(r)?t!=t&&r!=r:n(t,r,o,s,e,a))}},2492:(e,t,r)=>{var n=r(46384),i=r(67114),o=r(18351),s=r(16096),a=r(64160),c=r(1469),u=r(44144),l=r(36719),d="[object Arguments]",h="[object Array]",f="[object Object]",p=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,m,g,v){var y=c(e),b=c(t),E=y?h:a(e),w=b?h:a(t),S=(E=E==d?f:E)==f,_=(w=w==d?f:w)==f,T=E==w;if(T&&u(e)){if(!u(t))return!1;y=!0,S=!1}if(T&&!S)return v||(v=new n),y||l(e)?i(e,t,r,m,g,v):o(e,t,E,r,m,g,v);if(!(1&r)){var x=S&&p.call(e,"__wrapped__"),A=_&&p.call(t,"__wrapped__");if(x||A){var I=x?e.value():e,C=A?t.value():t;return v||(v=new n),g(I,C,r,m,v)}}return!!T&&(v||(v=new n),s(e,t,r,m,g,v))}},25588:(e,t,r)=>{var n=r(64160),i=r(37005);e.exports=function(e){return i(e)&&"[object Map]"==n(e)}},2958:(e,t,r)=>{var n=r(46384),i=r(90939);e.exports=function(e,t,r,o){var s=r.length,a=s,c=!o;if(null==e)return!a;for(e=Object(e);s--;){var u=r[s];if(c&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++s<a;){var l=(u=r[s])[0],d=e[l],h=u[1];if(c&&u[2]){if(void 0===d&&!(l in e))return!1}else{var f=new n;if(o)var p=o(d,h,l,e,t,f);if(!(void 0===p?i(h,d,3,o,f):p))return!1}}return!0}},62722:e=>{e.exports=function(e){return e!=e}},28458:(e,t,r)=>{var n=r(23560),i=r(37724),o=r(13218),s=r(80346),a=/^\[object .+?Constructor\]$/,c=Function.prototype,u=Object.prototype,l=c.toString,d=u.hasOwnProperty,h=RegExp("^"+l.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!o(e)||i(e))&&(n(e)?h:a).test(s(e))}},29221:(e,t,r)=>{var n=r(64160),i=r(37005);e.exports=function(e){return i(e)&&"[object Set]"==n(e)}},38749:(e,t,r)=>{var n=r(44239),i=r(41780),o=r(37005),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=function(e){return o(e)&&i(e.length)&&!!s[n(e)]}},67206:(e,t,r)=>{var n=r(91573),i=r(16432),o=r(6557),s=r(1469),a=r(39601);e.exports=function(e){return"function"==typeof e?e:null==e?o:"object"==typeof e?s(e)?i(e[0],e[1]):n(e):a(e)}},280:(e,t,r)=>{var n=r(25726),i=r(86916),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return i(e);var t=[];for(var r in Object(e))o.call(e,r)&&"constructor"!=r&&t.push(r);return t}},10313:(e,t,r)=>{var n=r(13218),i=r(25726),o=r(33498),s=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return o(e);var t=i(e),r=[];for(var a in e)("constructor"!=a||!t&&s.call(e,a))&&r.push(a);return r}},9435:e=>{e.exports=function(){}},69199:(e,t,r)=>{var n=r(89881),i=r(98612);e.exports=function(e,t){var r=-1,o=i(e)?Array(e.length):[];return n(e,(function(e,n,i){o[++r]=t(e,n,i)})),o}},91573:(e,t,r)=>{var n=r(2958),i=r(1499),o=r(42634);e.exports=function(e){var t=i(e);return 1==t.length&&t[0][2]?o(t[0][0],t[0][1]):function(r){return r===e||n(r,e,t)}}},16432:(e,t,r)=>{var n=r(90939),i=r(27361),o=r(79095),s=r(15403),a=r(89162),c=r(42634),u=r(40327);e.exports=function(e,t){return s(e)&&a(t)?c(u(e),t):function(r){var s=i(r,e);return void 0===s&&s===t?o(r,e):n(t,s,3)}}},49787:(e,t,r)=>{var n=r(67762);e.exports=function(e,t){var r=null==e?0:e.length;return r?n(e,t)/r:NaN}},42980:(e,t,r)=>{var n=r(46384),i=r(86556),o=r(28483),s=r(59783),a=r(13218),c=r(81704),u=r(36390);e.exports=function e(t,r,l,d,h){t!==r&&o(r,(function(o,c){if(h||(h=new n),a(o))s(t,r,c,l,e,d,h);else{var f=d?d(u(t,c),o,c+"",t,r,h):void 0;void 0===f&&(f=o),i(t,c,f)}}),c)}},59783:(e,t,r)=>{var n=r(86556),i=r(64626),o=r(77133),s=r(278),a=r(38517),c=r(35694),u=r(1469),l=r(29246),d=r(44144),h=r(23560),f=r(13218),p=r(68630),m=r(36719),g=r(36390),v=r(59881);e.exports=function(e,t,r,y,b,E,w){var S=g(e,r),_=g(t,r),T=w.get(_);if(T)n(e,r,T);else{var x=E?E(S,_,r+"",e,t,w):void 0,A=void 0===x;if(A){var I=u(_),C=!I&&d(_),R=!I&&!C&&m(_);x=_,I||C||R?u(S)?x=S:l(S)?x=s(S):C?(A=!1,x=i(_,!0)):R?(A=!1,x=o(_,!0)):x=[]:p(_)||c(_)?(x=S,c(S)?x=v(S):f(S)&&!h(S)||(x=a(_))):A=!1}A&&(w.set(_,x),b(x,_,y,E,w),w.delete(_)),n(e,r,x)}}},82689:(e,t,r)=>{var n=r(29932),i=r(97786),o=r(67206),s=r(69199),a=r(71131),c=r(7518),u=r(85022),l=r(6557),d=r(1469);e.exports=function(e,t,r){t=t.length?n(t,(function(e){return d(e)?function(t){return i(t,1===e.length?e[0]:e)}:e})):[l];var h=-1;t=n(t,c(o));var f=s(e,(function(e,r,i){return{criteria:n(t,(function(t){return t(e)})),index:++h,value:e}}));return a(f,(function(e,t){return u(e,t,r)}))}},25970:(e,t,r)=>{var n=r(63012),i=r(79095);e.exports=function(e,t){return n(e,t,(function(t,r){return i(e,r)}))}},63012:(e,t,r)=>{var n=r(97786),i=r(10611),o=r(71811);e.exports=function(e,t,r){for(var s=-1,a=t.length,c={};++s<a;){var u=t[s],l=n(e,u);r(l,u)&&i(c,o(u,e),l)}return c}},40371:e=>{e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},79152:(e,t,r)=>{var n=r(97786);e.exports=function(e){return function(t){return n(t,e)}}},18674:e=>{e.exports=function(e){return function(t){return null==e?void 0:e[t]}}},15742:(e,t,r)=>{var n=r(57406),i=r(65776),o=Array.prototype.splice;e.exports=function(e,t){for(var r=e?t.length:0,s=r-1;r--;){var a=t[r];if(r==s||a!==c){var c=a;i(a)?o.call(e,a,1):n(e,a)}}return e}},10107:e=>{e.exports=function(e,t,r,n,i){return i(e,(function(e,i,o){r=n?(n=!1,e):t(r,e,i,o)})),r}},5976:(e,t,r)=>{var n=r(6557),i=r(45357),o=r(30061);e.exports=function(e,t){return o(i(e,t,n),e+"")}},10611:(e,t,r)=>{var n=r(34865),i=r(71811),o=r(65776),s=r(13218),a=r(40327);e.exports=function(e,t,r,c){if(!s(e))return e;for(var u=-1,l=(t=i(t,e)).length,d=l-1,h=e;null!=h&&++u<l;){var f=a(t[u]),p=r;if("__proto__"===f||"constructor"===f||"prototype"===f)return e;if(u!=d){var m=h[f];void 0===(p=c?c(m,f,h):void 0)&&(p=s(m)?m:o(t[u+1])?[]:{})}n(h,f,p),h=h[f]}return e}},28045:(e,t,r)=>{var n=r(6557),i=r(89250),o=i?function(e,t){return i.set(e,t),e}:n;e.exports=o},56560:(e,t,r)=>{var n=r(75703),i=r(38777),o=r(6557),s=i?function(e,t){return i(e,"toString",{configurable:!0,enumerable:!1,value:n(t),writable:!0})}:o;e.exports=s},14259:e=>{e.exports=function(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(i);++n<i;)o[n]=e[n+t];return o}},5076:(e,t,r)=>{var n=r(89881);e.exports=function(e,t){var r;return n(e,(function(e,n,i){return!(r=t(e,n,i))})),!!r}},71131:e=>{e.exports=function(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}},67762:e=>{e.exports=function(e,t){for(var r,n=-1,i=e.length;++n<i;){var o=t(e[n]);void 0!==o&&(r=void 0===r?o:r+o)}return r}},22545:e=>{e.exports=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}},80531:(e,t,r)=>{var n=r(62705),i=r(29932),o=r(1469),s=r(33448),a=n?n.prototype:void 0,c=a?a.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(o(t))return i(t,e)+"";if(s(t))return c?c.call(t):"";var r=t+"";return"0"==r&&1/t==-Infinity?"-0":r}},27561:(e,t,r)=>{var n=r(67990),i=/^\s+/;e.exports=function(e){return e?e.slice(0,n(e)+1).replace(i,""):e}},7518:e=>{e.exports=function(e){return function(t){return e(t)}}},45652:(e,t,r)=>{var n=r(88668),i=r(47443),o=r(1196),s=r(74757),a=r(23593),c=r(21814);e.exports=function(e,t,r){var u=-1,l=i,d=e.length,h=!0,f=[],p=f;if(r)h=!1,l=o;else if(d>=200){var m=t?null:a(e);if(m)return c(m);h=!1,l=s,p=new n}else p=t?[]:f;e:for(;++u<d;){var g=e[u],v=t?t(g):g;if(g=r||0!==g?g:0,h&&v==v){for(var y=p.length;y--;)if(p[y]===v)continue e;t&&p.push(v),f.push(g)}else l(p,v,r)||(p!==f&&p.push(v),f.push(g))}return f}},57406:(e,t,r)=>{var n=r(71811),i=r(10928),o=r(40292),s=r(40327);e.exports=function(e,t){return t=n(t,e),null==(e=o(e,t))||delete e[s(i(t))]}},47415:(e,t,r)=>{var n=r(29932);e.exports=function(e,t){return n(t,(function(t){return e[t]}))}},74757:e=>{e.exports=function(e,t){return e.has(t)}},24387:(e,t,r)=>{var n=r(29246);e.exports=function(e){return n(e)?e:[]}},54290:(e,t,r)=>{var n=r(6557);e.exports=function(e){return"function"==typeof e?e:n}},71811:(e,t,r)=>{var n=r(1469),i=r(15403),o=r(55514),s=r(79833);e.exports=function(e,t){return n(e)?e:i(e,t)?[e]:o(s(e))}},40180:(e,t,r)=>{var n=r(14259);e.exports=function(e,t,r){var i=e.length;return r=void 0===r?i:r,!t&&r>=i?e:n(e,t,r)}},74318:(e,t,r)=>{var n=r(11149);e.exports=function(e){var t=new e.constructor(e.byteLength);return new n(t).set(new n(e)),t}},64626:(e,t,r)=>{e=r.nmd(e);var n=r(55639),i=t&&!t.nodeType&&t,o=i&&e&&!e.nodeType&&e,s=o&&o.exports===i?n.Buffer:void 0,a=s?s.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=a?a(r):new e.constructor(r);return e.copy(n),n}},57157:(e,t,r)=>{var n=r(74318);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}},93147:e=>{var t=/\w*$/;e.exports=function(e){var r=new e.constructor(e.source,t.exec(e));return r.lastIndex=e.lastIndex,r}},40419:(e,t,r)=>{var n=r(62705),i=n?n.prototype:void 0,o=i?i.valueOf:void 0;e.exports=function(e){return o?Object(o.call(e)):{}}},77133:(e,t,r)=>{var n=r(74318);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}},26393:(e,t,r)=>{var n=r(33448);e.exports=function(e,t){if(e!==t){var r=void 0!==e,i=null===e,o=e==e,s=n(e),a=void 0!==t,c=null===t,u=t==t,l=n(t);if(!c&&!l&&!s&&e>t||s&&a&&u&&!c&&!l||i&&a&&u||!r&&u||!o)return 1;if(!i&&!s&&!l&&e<t||l&&r&&o&&!i&&!s||c&&r&&o||!a&&o||!u)return-1}return 0}},85022:(e,t,r)=>{var n=r(26393);e.exports=function(e,t,r){for(var i=-1,o=e.criteria,s=t.criteria,a=o.length,c=r.length;++i<a;){var u=n(o[i],s[i]);if(u)return i>=c?u:u*("desc"==r[i]?-1:1)}return e.index-t.index}},52157:e=>{var t=Math.max;e.exports=function(e,r,n,i){for(var o=-1,s=e.length,a=n.length,c=-1,u=r.length,l=t(s-a,0),d=Array(u+l),h=!i;++c<u;)d[c]=r[c];for(;++o<a;)(h||o<s)&&(d[n[o]]=e[o]);for(;l--;)d[c++]=e[o++];return d}},14054:e=>{var t=Math.max;e.exports=function(e,r,n,i){for(var o=-1,s=e.length,a=-1,c=n.length,u=-1,l=r.length,d=t(s-c,0),h=Array(d+l),f=!i;++o<d;)h[o]=e[o];for(var p=o;++u<l;)h[p+u]=r[u];for(;++a<c;)(f||o<s)&&(h[p+n[a]]=e[o++]);return h}},278:e=>{e.exports=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}},98363:(e,t,r)=>{var n=r(34865),i=r(89465);e.exports=function(e,t,r,o){var s=!r;r||(r={});for(var a=-1,c=t.length;++a<c;){var u=t[a],l=o?o(r[u],e[u],u,r,e):void 0;void 0===l&&(l=e[u]),s?i(r,u,l):n(r,u,l)}return r}},18805:(e,t,r)=>{var n=r(98363),i=r(99551);e.exports=function(e,t){return n(e,i(e),t)}},1911:(e,t,r)=>{var n=r(98363),i=r(51442);e.exports=function(e,t){return n(e,i(e),t)}},14429:(e,t,r)=>{var n=r(55639)["__core-js_shared__"];e.exports=n},97991:e=>{e.exports=function(e,t){for(var r=e.length,n=0;r--;)e[r]===t&&++n;return n}},55189:(e,t,r)=>{var n=r(44174),i=r(81119),o=r(67206),s=r(1469);e.exports=function(e,t){return function(r,a){var c=s(r)?n:i,u=t?t():{};return c(r,e,o(a,2),u)}}},21463:(e,t,r)=>{var n=r(5976),i=r(16612);e.exports=function(e){return n((function(t,r){var n=-1,o=r.length,s=o>1?r[o-1]:void 0,a=o>2?r[2]:void 0;for(s=e.length>3&&"function"==typeof s?(o--,s):void 0,a&&i(r[0],r[1],a)&&(s=o<3?void 0:s,o=1),t=Object(t);++n<o;){var c=r[n];c&&e(t,c,n,s)}return t}))}},99291:(e,t,r)=>{var n=r(98612);e.exports=function(e,t){return function(r,i){if(null==r)return r;if(!n(r))return e(r,i);for(var o=r.length,s=t?o:-1,a=Object(r);(t?s--:++s<o)&&!1!==i(a[s],s,a););return r}}},25063:e=>{e.exports=function(e){return function(t,r,n){for(var i=-1,o=Object(t),s=n(t),a=s.length;a--;){var c=s[e?a:++i];if(!1===r(o[c],c,o))break}return t}}},22402:(e,t,r)=>{var n=r(71774),i=r(55639);e.exports=function(e,t,r){var o=1&t,s=n(e);return function t(){return(this&&this!==i&&this instanceof t?s:e).apply(o?r:this,arguments)}}},98805:(e,t,r)=>{var n=r(40180),i=r(62689),o=r(83140),s=r(79833);e.exports=function(e){return function(t){t=s(t);var r=i(t)?o(t):void 0,a=r?r[0]:t.charAt(0),c=r?n(r,1).join(""):t.slice(1);return a[e]()+c}}},35393:(e,t,r)=>{var n=r(62663),i=r(53816),o=r(58748),s=RegExp("['’]","g");e.exports=function(e){return function(t){return n(o(i(t).replace(s,"")),e,"")}}},71774:(e,t,r)=>{var n=r(3118),i=r(13218);e.exports=function(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=n(e.prototype),o=e.apply(r,t);return i(o)?o:r}}},46347:(e,t,r)=>{var n=r(96874),i=r(71774),o=r(86935),s=r(94487),a=r(20893),c=r(46460),u=r(55639);e.exports=function(e,t,r){var l=i(e);return function i(){for(var d=arguments.length,h=Array(d),f=d,p=a(i);f--;)h[f]=arguments[f];var m=d<3&&h[0]!==p&&h[d-1]!==p?[]:c(h,p);return(d-=m.length)<r?s(e,t,o,i.placeholder,void 0,h,m,void 0,void 0,r-d):n(this&&this!==u&&this instanceof i?l:e,this,h)}}},67740:(e,t,r)=>{var n=r(67206),i=r(98612),o=r(3674);e.exports=function(e){return function(t,r,s){var a=Object(t);if(!i(t)){var c=n(r,3);t=o(t),r=function(e){return c(a[e],e,a)}}var u=e(t,r,s);return u>-1?a[c?t[u]:u]:void 0}}},86935:(e,t,r)=>{var n=r(52157),i=r(14054),o=r(97991),s=r(71774),a=r(94487),c=r(20893),u=r(90451),l=r(46460),d=r(55639);e.exports=function e(t,r,h,f,p,m,g,v,y,b){var E=128&r,w=1&r,S=2&r,_=24&r,T=512&r,x=S?void 0:s(t);return function A(){for(var I=arguments.length,C=Array(I),R=I;R--;)C[R]=arguments[R];if(_)var k=c(A),O=o(C,k);if(f&&(C=n(C,f,p,_)),m&&(C=i(C,m,g,_)),I-=O,_&&I<b){var N=l(C,k);return a(t,r,e,A.placeholder,h,C,N,v,y,b-I)}var P=w?h:this,L=S?P[t]:t;return I=C.length,v?C=u(C,v):T&&I>1&&C.reverse(),E&&y<I&&(C.length=y),this&&this!==d&&this instanceof A&&(L=x||s(L)),L.apply(P,C)}}},84375:(e,t,r)=>{var n=r(96874),i=r(71774),o=r(55639);e.exports=function(e,t,r,s){var a=1&t,c=i(e);return function t(){for(var i=-1,u=arguments.length,l=-1,d=s.length,h=Array(d+u),f=this&&this!==o&&this instanceof t?c:e;++l<d;)h[l]=s[l];for(;u--;)h[l++]=arguments[++i];return n(f,a?r:this,h)}}},94487:(e,t,r)=>{var n=r(86528),i=r(258),o=r(69255);e.exports=function(e,t,r,s,a,c,u,l,d,h){var f=8&t;t|=f?32:64,4&(t&=~(f?64:32))||(t&=-4);var p=[e,t,a,f?c:void 0,f?u:void 0,f?void 0:c,f?void 0:u,l,d,h],m=r.apply(void 0,p);return n(e)&&i(m,p),m.placeholder=s,o(m,e,t)}},23593:(e,t,r)=>{var n=r(58525),i=r(50308),o=r(21814),s=n&&1/o(new n([,-0]))[1]==1/0?function(e){return new n(e)}:i;e.exports=s},97727:(e,t,r)=>{var n=r(28045),i=r(22402),o=r(46347),s=r(86935),a=r(84375),c=r(66833),u=r(63833),l=r(258),d=r(69255),h=r(40554),f=Math.max;e.exports=function(e,t,r,p,m,g,v,y){var b=2&t;if(!b&&"function"!=typeof e)throw new TypeError("Expected a function");var E=p?p.length:0;if(E||(t&=-97,p=m=void 0),v=void 0===v?v:f(h(v),0),y=void 0===y?y:h(y),E-=m?m.length:0,64&t){var w=p,S=m;p=m=void 0}var _=b?void 0:c(e),T=[e,t,r,p,m,w,S,g,v,y];if(_&&u(T,_),e=T[0],t=T[1],r=T[2],p=T[3],m=T[4],!(y=T[9]=void 0===T[9]?b?0:e.length:f(T[9]-E,0))&&24&t&&(t&=-25),t&&1!=t)x=8==t||16==t?o(e,t,y):32!=t&&33!=t||m.length?s.apply(void 0,T):a(e,t,r,p);else var x=i(e,t,r);return d((_?n:l)(x,T),e,t)}},92052:(e,t,r)=>{var n=r(42980),i=r(13218);e.exports=function e(t,r,o,s,a,c){return i(t)&&i(r)&&(c.set(r,t),n(t,r,void 0,e,c),c.delete(r)),t}},60696:(e,t,r)=>{var n=r(68630);e.exports=function(e){return n(e)?void 0:e}},69389:(e,t,r)=>{var n=r(18674)({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"});e.exports=n},38777:(e,t,r)=>{var n=r(10852),i=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=i},67114:(e,t,r)=>{var n=r(88668),i=r(82908),o=r(74757);e.exports=function(e,t,r,s,a,c){var u=1&r,l=e.length,d=t.length;if(l!=d&&!(u&&d>l))return!1;var h=c.get(e),f=c.get(t);if(h&&f)return h==t&&f==e;var p=-1,m=!0,g=2&r?new n:void 0;for(c.set(e,t),c.set(t,e);++p<l;){var v=e[p],y=t[p];if(s)var b=u?s(y,v,p,t,e,c):s(v,y,p,e,t,c);if(void 0!==b){if(b)continue;m=!1;break}if(g){if(!i(t,(function(e,t){if(!o(g,t)&&(v===e||a(v,e,r,s,c)))return g.push(t)}))){m=!1;break}}else if(v!==y&&!a(v,y,r,s,c)){m=!1;break}}return c.delete(e),c.delete(t),m}},18351:(e,t,r)=>{var n=r(62705),i=r(11149),o=r(77813),s=r(67114),a=r(68776),c=r(21814),u=n?n.prototype:void 0,l=u?u.valueOf:void 0;e.exports=function(e,t,r,n,u,d,h){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!d(new i(e),new i(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var f=a;case"[object Set]":var p=1&n;if(f||(f=c),e.size!=t.size&&!p)return!1;var m=h.get(e);if(m)return m==t;n|=2,h.set(e,t);var g=s(f(e),f(t),n,u,d,h);return h.delete(e),g;case"[object Symbol]":if(l)return l.call(e)==l.call(t)}return!1}},16096:(e,t,r)=>{var n=r(58234),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,o,s,a){var c=1&r,u=n(e),l=u.length;if(l!=n(t).length&&!c)return!1;for(var d=l;d--;){var h=u[d];if(!(c?h in t:i.call(t,h)))return!1}var f=a.get(e),p=a.get(t);if(f&&p)return f==t&&p==e;var m=!0;a.set(e,t),a.set(t,e);for(var g=c;++d<l;){var v=e[h=u[d]],y=t[h];if(o)var b=c?o(y,v,h,t,e,a):o(v,y,h,e,t,a);if(!(void 0===b?v===y||s(v,y,r,o,a):b)){m=!1;break}g||(g="constructor"==h)}if(m&&!g){var E=e.constructor,w=t.constructor;E==w||!("constructor"in e)||!("constructor"in t)||"function"==typeof E&&E instanceof E&&"function"==typeof w&&w instanceof w||(m=!1)}return a.delete(e),a.delete(t),m}},89464:(e,t,r)=>{var n=r(18674)({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});e.exports=n},99021:(e,t,r)=>{var n=r(85564),i=r(45357),o=r(30061);e.exports=function(e){return o(i(e,void 0,n),e+"")}},31957:(e,t,r)=>{var n="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g;e.exports=n},58234:(e,t,r)=>{var n=r(68866),i=r(99551),o=r(3674);e.exports=function(e){return n(e,o,i)}},46904:(e,t,r)=>{var n=r(68866),i=r(51442),o=r(81704);e.exports=function(e){return n(e,o,i)}},66833:(e,t,r)=>{var n=r(89250),i=r(50308),o=n?function(e){return n.get(e)}:i;e.exports=o},97658:(e,t,r)=>{var n=r(52060),i=Object.prototype.hasOwnProperty;e.exports=function(e){for(var t=e.name+"",r=n[t],o=i.call(n,t)?r.length:0;o--;){var s=r[o],a=s.func;if(null==a||a==e)return s.name}return t}},20893:e=>{e.exports=function(e){return e.placeholder}},45050:(e,t,r)=>{var n=r(37019);e.exports=function(e,t){var r=e.__data__;return n(t)?r["string"==typeof t?"string":"hash"]:r.map}},1499:(e,t,r)=>{var n=r(89162),i=r(3674);e.exports=function(e){for(var t=i(e),r=t.length;r--;){var o=t[r],s=e[o];t[r]=[o,s,n(s)]}return t}},10852:(e,t,r)=>{var n=r(28458),i=r(47801);e.exports=function(e,t){var r=i(e,t);return n(r)?r:void 0}},85924:(e,t,r)=>{var n=r(5569)(Object.getPrototypeOf,Object);e.exports=n},89607:(e,t,r)=>{var n=r(62705),i=Object.prototype,o=i.hasOwnProperty,s=i.toString,a=n?n.toStringTag:void 0;e.exports=function(e){var t=o.call(e,a),r=e[a];try{e[a]=void 0;var n=!0}catch(e){}var i=s.call(e);return n&&(t?e[a]=r:delete e[a]),i}},99551:(e,t,r)=>{var n=r(34963),i=r(70479),o=Object.prototype.propertyIsEnumerable,s=Object.getOwnPropertySymbols,a=s?function(e){return null==e?[]:(e=Object(e),n(s(e),(function(t){return o.call(e,t)})))}:i;e.exports=a},51442:(e,t,r)=>{var n=r(62488),i=r(85924),o=r(99551),s=r(70479),a=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)n(t,o(e)),e=i(e);return t}:s;e.exports=a},64160:(e,t,r)=>{var n=r(18552),i=r(57071),o=r(53818),s=r(58525),a=r(70577),c=r(44239),u=r(80346),l="[object Map]",d="[object Promise]",h="[object Set]",f="[object WeakMap]",p="[object DataView]",m=u(n),g=u(i),v=u(o),y=u(s),b=u(a),E=c;(n&&E(new n(new ArrayBuffer(1)))!=p||i&&E(new i)!=l||o&&E(o.resolve())!=d||s&&E(new s)!=h||a&&E(new a)!=f)&&(E=function(e){var t=c(e),r="[object Object]"==t?e.constructor:void 0,n=r?u(r):"";if(n)switch(n){case m:return p;case g:return l;case v:return d;case y:return h;case b:return f}return t}),e.exports=E},47801:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},58775:e=>{var t=/\{\n\/\* \[wrapped with (.+)\] \*/,r=/,? & /;e.exports=function(e){var n=e.match(t);return n?n[1].split(r):[]}},222:(e,t,r)=>{var n=r(71811),i=r(35694),o=r(1469),s=r(65776),a=r(41780),c=r(40327);e.exports=function(e,t,r){for(var u=-1,l=(t=n(t,e)).length,d=!1;++u<l;){var h=c(t[u]);if(!(d=null!=e&&r(e,h)))break;e=e[h]}return d||++u!=l?d:!!(l=null==e?0:e.length)&&a(l)&&s(h,l)&&(o(e)||i(e))}},62689:e=>{var t=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return t.test(e)}},93157:e=>{var t=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;e.exports=function(e){return t.test(e)}},51789:(e,t,r)=>{var n=r(94536);e.exports=function(){this.__data__=n?n(null):{},this.size=0}},80401:e=>{e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},57667:(e,t,r)=>{var n=r(94536),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(n){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return i.call(t,e)?t[e]:void 0}},21327:(e,t,r)=>{var n=r(94536),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return n?void 0!==t[e]:i.call(t,e)}},81866:(e,t,r)=>{var n=r(94536);e.exports=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=n&&void 0===t?"__lodash_hash_undefined__":t,this}},43824:e=>{var t=Object.prototype.hasOwnProperty;e.exports=function(e){var r=e.length,n=new e.constructor(r);return r&&"string"==typeof e[0]&&t.call(e,"index")&&(n.index=e.index,n.input=e.input),n}},29148:(e,t,r)=>{var n=r(74318),i=r(57157),o=r(93147),s=r(40419),a=r(77133);e.exports=function(e,t,r){var c=e.constructor;switch(t){case"[object ArrayBuffer]":return n(e);case"[object Boolean]":case"[object Date]":return new c(+e);case"[object DataView]":return i(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return a(e,r);case"[object Map]":case"[object Set]":return new c;case"[object Number]":case"[object String]":return new c(e);case"[object RegExp]":return o(e);case"[object Symbol]":return s(e)}}},38517:(e,t,r)=>{var n=r(3118),i=r(85924),o=r(25726);e.exports=function(e){return"function"!=typeof e.constructor||o(e)?{}:n(i(e))}},83112:e=>{var t=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;e.exports=function(e,r){var n=r.length;if(!n)return e;var i=n-1;return r[i]=(n>1?"& ":"")+r[i],r=r.join(n>2?", ":" "),e.replace(t,"{\n/* [wrapped with "+r+"] */\n")}},37285:(e,t,r)=>{var n=r(62705),i=r(35694),o=r(1469),s=n?n.isConcatSpreadable:void 0;e.exports=function(e){return o(e)||i(e)||!!(s&&e&&e[s])}},65776:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,r){var n=typeof e;return!!(r=null==r?9007199254740991:r)&&("number"==n||"symbol"!=n&&t.test(e))&&e>-1&&e%1==0&&e<r}},16612:(e,t,r)=>{var n=r(77813),i=r(98612),o=r(65776),s=r(13218);e.exports=function(e,t,r){if(!s(r))return!1;var a=typeof t;return!!("number"==a?i(r)&&o(t,r.length):"string"==a&&t in r)&&n(r[t],e)}},15403:(e,t,r)=>{var n=r(1469),i=r(33448),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.exports=function(e,t){if(n(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!i(e))||(s.test(e)||!o.test(e)||null!=t&&e in Object(t))}},37019:e=>{e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},86528:(e,t,r)=>{var n=r(96425),i=r(66833),o=r(97658),s=r(8111);e.exports=function(e){var t=o(e),r=s[t];if("function"!=typeof r||!(t in n.prototype))return!1;if(e===r)return!0;var a=i(r);return!!a&&e===a[0]}},37724:(e,t,r)=>{var n,i=r(14429),o=(n=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";e.exports=function(e){return!!o&&o in e}},25726:e=>{var t=Object.prototype;e.exports=function(e){var r=e&&e.constructor;return e===("function"==typeof r&&r.prototype||t)}},89162:(e,t,r)=>{var n=r(13218);e.exports=function(e){return e==e&&!n(e)}},27040:e=>{e.exports=function(){this.__data__=[],this.size=0}},14125:(e,t,r)=>{var n=r(18470),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,r=n(t,e);return!(r<0)&&(r==t.length-1?t.pop():i.call(t,r,1),--this.size,!0)}},82117:(e,t,r)=>{var n=r(18470);e.exports=function(e){var t=this.__data__,r=n(t,e);return r<0?void 0:t[r][1]}},67518:(e,t,r)=>{var n=r(18470);e.exports=function(e){return n(this.__data__,e)>-1}},54705:(e,t,r)=>{var n=r(18470);e.exports=function(e,t){var r=this.__data__,i=n(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}},24785:(e,t,r)=>{var n=r(1989),i=r(38407),o=r(57071);e.exports=function(){this.size=0,this.__data__={hash:new n,map:new(o||i),string:new n}}},11285:(e,t,r)=>{var n=r(45050);e.exports=function(e){var t=n(this,e).delete(e);return this.size-=t?1:0,t}},96e3:(e,t,r)=>{var n=r(45050);e.exports=function(e){return n(this,e).get(e)}},49916:(e,t,r)=>{var n=r(45050);e.exports=function(e){return n(this,e).has(e)}},95265:(e,t,r)=>{var n=r(45050);e.exports=function(e,t){var r=n(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}},68776:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}},42634:e=>{e.exports=function(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}},24523:(e,t,r)=>{var n=r(88306);e.exports=function(e){var t=n(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}},63833:(e,t,r)=>{var n=r(52157),i=r(14054),o=r(46460),s="__lodash_placeholder__",a=128,c=Math.min;e.exports=function(e,t){var r=e[1],u=t[1],l=r|u,d=l<131,h=u==a&&8==r||u==a&&256==r&&e[7].length<=t[8]||384==u&&t[7].length<=t[8]&&8==r;if(!d&&!h)return e;1&u&&(e[2]=t[2],l|=1&r?0:4);var f=t[3];if(f){var p=e[3];e[3]=p?n(p,f,t[4]):f,e[4]=p?o(e[3],s):t[4]}return(f=t[5])&&(p=e[5],e[5]=p?i(p,f,t[6]):f,e[6]=p?o(e[5],s):t[6]),(f=t[7])&&(e[7]=f),u&a&&(e[8]=null==e[8]?t[8]:c(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=l,e}},89250:(e,t,r)=>{var n=r(70577),i=n&&new n;e.exports=i},94536:(e,t,r)=>{var n=r(10852)(Object,"create");e.exports=n},86916:(e,t,r)=>{var n=r(5569)(Object.keys,Object);e.exports=n},33498:e=>{e.exports=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}},31167:(e,t,r)=>{e=r.nmd(e);var n=r(31957),i=t&&!t.nodeType&&t,o=i&&e&&!e.nodeType&&e,s=o&&o.exports===i&&n.process,a=function(){try{var e=o&&o.require&&o.require("util").types;return e||s&&s.binding&&s.binding("util")}catch(e){}}();e.exports=a},2333:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},5569:e=>{e.exports=function(e,t){return function(r){return e(t(r))}}},45357:(e,t,r)=>{var n=r(96874),i=Math.max;e.exports=function(e,t,r){return t=i(void 0===t?e.length-1:t,0),function(){for(var o=arguments,s=-1,a=i(o.length-t,0),c=Array(a);++s<a;)c[s]=o[t+s];s=-1;for(var u=Array(t+1);++s<t;)u[s]=o[s];return u[t]=r(c),n(e,this,u)}}},40292:(e,t,r)=>{var n=r(97786),i=r(14259);e.exports=function(e,t){return t.length<2?e:n(e,i(t,0,-1))}},52060:e=>{e.exports={}},90451:(e,t,r)=>{var n=r(278),i=r(65776),o=Math.min;e.exports=function(e,t){for(var r=e.length,s=o(t.length,r),a=n(e);s--;){var c=t[s];e[s]=i(c,r)?a[c]:void 0}return e}},46460:e=>{var t="__lodash_placeholder__";e.exports=function(e,r){for(var n=-1,i=e.length,o=0,s=[];++n<i;){var a=e[n];a!==r&&a!==t||(e[n]=t,s[o++]=n)}return s}},55639:(e,t,r)=>{var n=r(31957),i="object"==typeof self&&self&&self.Object===Object&&self,o=n||i||Function("return this")();e.exports=o},36390:e=>{e.exports=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}},90619:e=>{e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},72385:e=>{e.exports=function(e){return this.__data__.has(e)}},258:(e,t,r)=>{var n=r(28045),i=r(21275)(n);e.exports=i},21814:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}},30061:(e,t,r)=>{var n=r(56560),i=r(21275)(n);e.exports=i},69255:(e,t,r)=>{var n=r(58775),i=r(83112),o=r(30061),s=r(87241);e.exports=function(e,t,r){var a=t+"";return o(e,i(a,s(n(a),r)))}},21275:e=>{var t=Date.now;e.exports=function(e){var r=0,n=0;return function(){var i=t(),o=16-(i-n);if(n=i,o>0){if(++r>=800)return arguments[0]}else r=0;return e.apply(void 0,arguments)}}},37465:(e,t,r)=>{var n=r(38407);e.exports=function(){this.__data__=new n,this.size=0}},63779:e=>{e.exports=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}},67599:e=>{e.exports=function(e){return this.__data__.get(e)}},44758:e=>{e.exports=function(e){return this.__data__.has(e)}},34309:(e,t,r)=>{var n=r(38407),i=r(57071),o=r(83369);e.exports=function(e,t){var r=this.__data__;if(r instanceof n){var s=r.__data__;if(!i||s.length<199)return s.push([e,t]),this.size=++r.size,this;r=this.__data__=new o(s)}return r.set(e,t),this.size=r.size,this}},42351:e=>{e.exports=function(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}},83140:(e,t,r)=>{var n=r(44286),i=r(62689),o=r(676);e.exports=function(e){return i(e)?o(e):n(e)}},55514:(e,t,r)=>{var n=r(24523),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,s=n((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(i,(function(e,r,n,i){t.push(n?i.replace(o,"$1"):r||e)})),t}));e.exports=s},40327:(e,t,r)=>{var n=r(33448);e.exports=function(e){if("string"==typeof e||n(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t}},80346:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},67990:e=>{var t=/\s/;e.exports=function(e){for(var r=e.length;r--&&t.test(e.charAt(r)););return r}},676:e=>{var t="\\ud800-\\udfff",r="["+t+"]",n="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",i="\\ud83c[\\udffb-\\udfff]",o="[^"+t+"]",s="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]",c="(?:"+n+"|"+i+")"+"?",u="[\\ufe0e\\ufe0f]?",l=u+c+("(?:\\u200d(?:"+[o,s,a].join("|")+")"+u+c+")*"),d="(?:"+[o+n+"?",n,s,a,r].join("|")+")",h=RegExp(i+"(?="+i+")|"+d+l,"g");e.exports=function(e){return e.match(h)||[]}},2757:e=>{var t="\\ud800-\\udfff",r="\\u2700-\\u27bf",n="a-z\\xdf-\\xf6\\xf8-\\xff",i="A-Z\\xc0-\\xd6\\xd8-\\xde",o="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",s="["+o+"]",a="\\d+",c="["+r+"]",u="["+n+"]",l="[^"+t+o+a+r+n+i+"]",d="(?:\\ud83c[\\udde6-\\uddff]){2}",h="[\\ud800-\\udbff][\\udc00-\\udfff]",f="["+i+"]",p="(?:"+u+"|"+l+")",m="(?:"+f+"|"+l+")",g="(?:['’](?:d|ll|m|re|s|t|ve))?",v="(?:['’](?:D|LL|M|RE|S|T|VE))?",y="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",b="[\\ufe0e\\ufe0f]?",E=b+y+("(?:\\u200d(?:"+["[^"+t+"]",d,h].join("|")+")"+b+y+")*"),w="(?:"+[c,d,h].join("|")+")"+E,S=RegExp([f+"?"+u+"+"+g+"(?="+[s,f,"$"].join("|")+")",m+"+"+v+"(?="+[s,f+p,"$"].join("|")+")",f+"?"+p+"+"+g,f+"+"+v,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",a,w].join("|"),"g");e.exports=function(e){return e.match(S)||[]}},87241:(e,t,r)=>{var n=r(77412),i=r(47443),o=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];e.exports=function(e,t){return n(o,(function(r){var n="_."+r[0];t&r[1]&&!i(e,n)&&e.push(n)})),e.sort()}},21913:(e,t,r)=>{var n=r(96425),i=r(7548),o=r(278);e.exports=function(e){if(e instanceof n)return e.clone();var t=new i(e.__wrapped__,e.__chain__);return t.__actions__=o(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}},28583:(e,t,r)=>{var n=r(34865),i=r(98363),o=r(21463),s=r(98612),a=r(25726),c=r(3674),u=Object.prototype.hasOwnProperty,l=o((function(e,t){if(a(t)||s(t))i(t,c(t),e);else for(var r in t)u.call(t,r)&&n(e,r,t[r])}));e.exports=l},63706:(e,t,r)=>{var n=r(98363),i=r(21463),o=r(3674),s=i((function(e,t,r,i){n(t,o(t),e,i)}));e.exports=s},89567:(e,t,r)=>{var n=r(40554);e.exports=function(e,t){var r;if("function"!=typeof t)throw new TypeError("Expected a function");return e=n(e),function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=void 0),r}}},38169:(e,t,r)=>{var n=r(5976),i=r(97727),o=r(20893),s=r(46460),a=n((function(e,t,r){var n=1;if(r.length){var c=s(r,o(a));n|=32}return i(e,n,t,r,c)}));a.placeholder={},e.exports=a},68929:(e,t,r)=>{var n=r(48403),i=r(35393)((function(e,t,r){return t=t.toLowerCase(),e+(r?n(t):t)}));e.exports=i},48403:(e,t,r)=>{var n=r(79833),i=r(11700);e.exports=function(e){return i(n(e).toLowerCase())}},66678:(e,t,r)=>{var n=r(85990);e.exports=function(e){return n(e,4)}},50361:(e,t,r)=>{var n=r(85990);e.exports=function(e){return n(e,5)}},53888:(e,t,r)=>{var n=r(85990);e.exports=function(e,t){return n(e,5,t="function"==typeof t?t:void 0)}},75703:e=>{e.exports=function(e){return function(){return e}}},40087:(e,t,r)=>{var n=r(97727);function i(e,t,r){var o=n(e,8,void 0,void 0,void 0,void 0,void 0,t=r?void 0:t);return o.placeholder=i.placeholder,o}i.placeholder={},e.exports=i},23279:(e,t,r)=>{var n=r(13218),i=r(7771),o=r(14841),s=Math.max,a=Math.min;e.exports=function(e,t,r){var c,u,l,d,h,f,p=0,m=!1,g=!1,v=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var r=c,n=u;return c=u=void 0,p=t,d=e.apply(n,r)}function b(e){var r=e-f;return void 0===f||r>=t||r<0||g&&e-p>=l}function E(){var e=i();if(b(e))return w(e);h=setTimeout(E,function(e){var r=t-(e-f);return g?a(r,l-(e-p)):r}(e))}function w(e){return h=void 0,v&&c?y(e):(c=u=void 0,d)}function S(){var e=i(),r=b(e);if(c=arguments,u=this,f=e,r){if(void 0===h)return function(e){return p=e,h=setTimeout(E,t),m?y(e):d}(f);if(g)return clearTimeout(h),h=setTimeout(E,t),y(f)}return void 0===h&&(h=setTimeout(E,t)),d}return t=o(t)||0,n(r)&&(m=!!r.leading,l=(g="maxWait"in r)?s(o(r.maxWait)||0,t):l,v="trailing"in r?!!r.trailing:v),S.cancel=function(){void 0!==h&&clearTimeout(h),p=0,c=f=u=h=void 0},S.flush=function(){return void 0===h?d:w(i())},S}},53816:(e,t,r)=>{var n=r(69389),i=r(79833),o=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,s=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");e.exports=function(e){return(e=i(e))&&e.replace(o,n).replace(s,"")}},91747:(e,t,r)=>{var n=r(5976),i=r(77813),o=r(16612),s=r(81704),a=Object.prototype,c=a.hasOwnProperty,u=n((function(e,t){e=Object(e);var r=-1,n=t.length,u=n>2?t[2]:void 0;for(u&&o(t[0],t[1],u)&&(n=1);++r<n;)for(var l=t[r],d=s(l),h=-1,f=d.length;++h<f;){var p=d[h],m=e[p];(void 0===m||i(m,a[p])&&!c.call(e,p))&&(e[p]=l[p])}return e}));e.exports=u},66913:(e,t,r)=>{var n=r(96874),i=r(5976),o=r(92052),s=r(30236),a=i((function(e){return e.push(void 0,o),n(s,void 0,e)}));e.exports=a},81629:(e,t,r)=>{var n=r(38845),i=r(5976)((function(e,t){return n(e,1,t)}));e.exports=i},91966:(e,t,r)=>{var n=r(20731),i=r(21078),o=r(5976),s=r(29246),a=o((function(e,t){return s(e)?n(e,i(t,1,s,!0)):[]}));e.exports=a},77813:e=>{e.exports=function(e,t){return e===t||e!=e&&t!=t}},7187:(e,t,r)=>{var n=r(89464),i=r(79833),o=/[&<>"']/g,s=RegExp(o.source);e.exports=function(e){return(e=i(e))&&s.test(e)?e.replace(o,n):e}},19873:(e,t,r)=>{var n=r(87157),i=r(16612);e.exports=function(e,t,r,o){var s=null==e?0:e.length;return s?(r&&"number"!=typeof r&&i(e,t,r)&&(r=0,o=s),n(e,t,r,o)):[]}},63105:(e,t,r)=>{var n=r(34963),i=r(80760),o=r(67206),s=r(1469);e.exports=function(e,t){return(s(e)?n:i)(e,o(t,3))}},13311:(e,t,r)=>{var n=r(67740)(r(30998));e.exports=n},30998:(e,t,r)=>{var n=r(41848),i=r(67206),o=r(40554),s=Math.max;e.exports=function(e,t,r){var a=null==e?0:e.length;if(!a)return-1;var c=null==r?0:o(r);return c<0&&(c=s(a+c,0)),n(e,i(t,3),c)}},85564:(e,t,r)=>{var n=r(21078);e.exports=function(e){return(null==e?0:e.length)?n(e,1):[]}},84486:(e,t,r)=>{var n=r(77412),i=r(89881),o=r(54290),s=r(1469);e.exports=function(e,t){return(s(e)?n:i)(e,o(t))}},2525:(e,t,r)=>{var n=r(47816),i=r(54290);e.exports=function(e,t){return e&&n(e,i(t))}},27361:(e,t,r)=>{var n=r(97786);e.exports=function(e,t,r){var i=null==e?void 0:n(e,t);return void 0===i?r:i}},18721:(e,t,r)=>{var n=r(78565),i=r(222);e.exports=function(e,t){return null!=e&&i(e,t,n)}},79095:(e,t,r)=>{var n=r(13),i=r(222);e.exports=function(e,t){return null!=e&&i(e,t,n)}},6557:e=>{e.exports=function(e){return e}},64721:(e,t,r)=>{var n=r(42118),i=r(98612),o=r(47037),s=r(40554),a=r(52628),c=Math.max;e.exports=function(e,t,r,u){e=i(e)?e:a(e),r=r&&!u?s(r):0;var l=e.length;return r<0&&(r=c(l+r,0)),o(e)?r<=l&&e.indexOf(t,r)>-1:!!l&&n(e,t,r)>-1}},25325:(e,t,r)=>{var n=r(29932),i=r(47556),o=r(5976),s=r(24387),a=o((function(e){var t=n(e,s);return t.length&&t[0]===e[0]?i(t):[]}));e.exports=a},35694:(e,t,r)=>{var n=r(9454),i=r(37005),o=Object.prototype,s=o.hasOwnProperty,a=o.propertyIsEnumerable,c=n(function(){return arguments}())?n:function(e){return i(e)&&s.call(e,"callee")&&!a.call(e,"callee")};e.exports=c},1469:e=>{var t=Array.isArray;e.exports=t},98612:(e,t,r)=>{var n=r(23560),i=r(41780);e.exports=function(e){return null!=e&&i(e.length)&&!n(e)}},29246:(e,t,r)=>{var n=r(98612),i=r(37005);e.exports=function(e){return i(e)&&n(e)}},44144:(e,t,r)=>{e=r.nmd(e);var n=r(55639),i=r(95062),o=t&&!t.nodeType&&t,s=o&&e&&!e.nodeType&&e,a=s&&s.exports===o?n.Buffer:void 0,c=(a?a.isBuffer:void 0)||i;e.exports=c},47960:(e,t,r)=>{var n=r(41761),i=r(7518),o=r(31167),s=o&&o.isDate,a=s?i(s):n;e.exports=a},41609:(e,t,r)=>{var n=r(280),i=r(64160),o=r(35694),s=r(1469),a=r(98612),c=r(44144),u=r(25726),l=r(36719),d=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(a(e)&&(s(e)||"string"==typeof e||"function"==typeof e.splice||c(e)||l(e)||o(e)))return!e.length;var t=i(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(u(e))return!n(e).length;for(var r in e)if(d.call(e,r))return!1;return!0}},18446:(e,t,r)=>{var n=r(90939);e.exports=function(e,t){return n(e,t)}},23560:(e,t,r)=>{var n=r(44239),i=r(13218);e.exports=function(e){if(!i(e))return!1;var t=n(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},41780:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},56688:(e,t,r)=>{var n=r(25588),i=r(7518),o=r(31167),s=o&&o.isMap,a=s?i(s):n;e.exports=a},81763:(e,t,r)=>{var n=r(44239),i=r(37005);e.exports=function(e){return"number"==typeof e||i(e)&&"[object Number]"==n(e)}},13218:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},37005:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},68630:(e,t,r)=>{var n=r(44239),i=r(85924),o=r(37005),s=Function.prototype,a=Object.prototype,c=s.toString,u=a.hasOwnProperty,l=c.call(Object);e.exports=function(e){if(!o(e)||"[object Object]"!=n(e))return!1;var t=i(e);if(null===t)return!0;var r=u.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&c.call(r)==l}},72928:(e,t,r)=>{var n=r(29221),i=r(7518),o=r(31167),s=o&&o.isSet,a=s?i(s):n;e.exports=a},47037:(e,t,r)=>{var n=r(44239),i=r(1469),o=r(37005);e.exports=function(e){return"string"==typeof e||!i(e)&&o(e)&&"[object String]"==n(e)}},33448:(e,t,r)=>{var n=r(44239),i=r(37005);e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==n(e)}},36719:(e,t,r)=>{var n=r(38749),i=r(7518),o=r(31167),s=o&&o.isTypedArray,a=s?i(s):n;e.exports=a},3674:(e,t,r)=>{var n=r(14636),i=r(280),o=r(98612);e.exports=function(e){return o(e)?n(e):i(e)}},81704:(e,t,r)=>{var n=r(14636),i=r(10313),o=r(98612);e.exports=function(e){return o(e)?n(e,!0):i(e)}},10928:e=>{e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},35161:(e,t,r)=>{var n=r(29932),i=r(67206),o=r(69199),s=r(1469);e.exports=function(e,t){return(s(e)?n:o)(e,i(t,3))}},66604:(e,t,r)=>{var n=r(89465),i=r(47816),o=r(67206);e.exports=function(e,t){var r={};return t=o(t,3),i(e,(function(e,i,o){n(r,i,t(e,i,o))})),r}},6162:(e,t,r)=>{var n=r(56029),i=r(53325),o=r(6557);e.exports=function(e){return e&&e.length?n(e,o,i):void 0}},78659:(e,t,r)=>{var n=r(49787),i=r(6557);e.exports=function(e){return n(e,i)}},88306:(e,t,r)=>{var n=r(83369);function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var s=e.apply(this,n);return r.cache=o.set(i,s)||o,s};return r.cache=new(i.Cache||n),r}i.Cache=n,e.exports=i},82492:(e,t,r)=>{var n=r(42980),i=r(21463)((function(e,t,r){n(e,t,r)}));e.exports=i},30236:(e,t,r)=>{var n=r(42980),i=r(21463)((function(e,t,r,i){n(e,t,r,i)}));e.exports=i},50308:e=>{e.exports=function(){}},7771:(e,t,r)=>{var n=r(55639);e.exports=function(){return n.Date.now()}},82723:(e,t,r)=>{var n=r(29932),i=r(85990),o=r(57406),s=r(71811),a=r(98363),c=r(60696),u=r(99021),l=r(46904),d=u((function(e,t){var r={};if(null==e)return r;var u=!1;t=n(t,(function(t){return t=s(t,e),u||(u=t.length>1),t})),a(e,l(e),r),u&&(r=i(r,7,c));for(var d=t.length;d--;)o(r,t[d]);return r}));e.exports=d},51463:(e,t,r)=>{var n=r(89567);e.exports=function(e){return n(2,e)}},53131:(e,t,r)=>{var n=r(5976),i=r(97727),o=r(20893),s=r(46460),a=n((function(e,t){var r=s(t,o(a));return i(e,32,void 0,t,r)}));a.placeholder={},e.exports=a},65544:(e,t,r)=>{var n=r(5976),i=r(97727),o=r(20893),s=r(46460),a=n((function(e,t){var r=s(t,o(a));return i(e,64,void 0,t,r)}));a.placeholder={},e.exports=a},43174:(e,t,r)=>{var n=r(55189)((function(e,t,r){e[r?0:1].push(t)}),(function(){return[[],[]]}));e.exports=n},78718:(e,t,r)=>{var n=r(25970),i=r(99021)((function(e,t){return null==e?{}:n(e,t)}));e.exports=i},39601:(e,t,r)=>{var n=r(40371),i=r(79152),o=r(15403),s=r(40327);e.exports=function(e){return o(e)?n(s(e)):i(e)}},54061:(e,t,r)=>{var n=r(62663),i=r(89881),o=r(67206),s=r(10107),a=r(1469);e.exports=function(e,t,r){var c=a(e)?n:s,u=arguments.length<3;return c(e,o(t,4),r,u,i)}},82729:(e,t,r)=>{var n=r(67206),i=r(15742);e.exports=function(e,t){var r=[];if(!e||!e.length)return r;var o=-1,s=[],a=e.length;for(t=n(t,3);++o<a;){var c=e[o];t(c,o,e)&&(r.push(c),s.push(o))}return i(e,s),r}},58613:(e,t,r)=>{var n=r(71811),i=r(23560),o=r(40327);e.exports=function(e,t,r){var s=-1,a=(t=n(t,e)).length;for(a||(a=1,e=void 0);++s<a;){var c=null==e?void 0:e[o(t[s])];void 0===c&&(s=a,c=r),e=i(c)?c.call(e):c}return e}},36968:(e,t,r)=>{var n=r(10611);e.exports=function(e,t,r){return null==e?e:n(e,t,r)}},59704:(e,t,r)=>{var n=r(82908),i=r(67206),o=r(5076),s=r(1469),a=r(16612);e.exports=function(e,t,r){var c=s(e)?n:o;return r&&a(e,t,r)&&(t=void 0),c(e,i(t,3))}},89734:(e,t,r)=>{var n=r(21078),i=r(82689),o=r(5976),s=r(16612),a=o((function(e,t){if(null==e)return[];var r=t.length;return r>1&&s(e,t[0],t[1])?t=[]:r>2&&s(t[0],t[1],t[2])&&(t=[t[0]]),i(e,n(t,1),[])}));e.exports=a},70479:e=>{e.exports=function(){return[]}},95062:e=>{e.exports=function(){return!1}},18601:(e,t,r)=>{var n=r(14841),i=1/0;e.exports=function(e){return e?(e=n(e))===i||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},40554:(e,t,r)=>{var n=r(18601);e.exports=function(e){var t=n(e),r=t%1;return t==t?r?t-r:t:0}},88958:(e,t,r)=>{var n=r(29750),i=r(40554);e.exports=function(e){return e?n(i(e),0,4294967295):0}},14841:(e,t,r)=>{var n=r(27561),i=r(13218),o=r(33448),s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,c=/^0o[0-7]+$/i,u=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return NaN;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var r=a.test(e);return r||c.test(e)?u(e.slice(2),r?2:8):s.test(e)?NaN:+e}},59881:(e,t,r)=>{var n=r(98363),i=r(81704);e.exports=function(e){return n(e,i(e))}},79833:(e,t,r)=>{var n=r(80531);e.exports=function(e){return null==e?"":n(e)}},93386:(e,t,r)=>{var n=r(21078),i=r(5976),o=r(45652),s=r(29246),a=i((function(e){return o(n(e,1,s,!0))}));e.exports=a},44908:(e,t,r)=>{var n=r(45652);e.exports=function(e){return e&&e.length?n(e):[]}},73955:(e,t,r)=>{var n=r(79833),i=0;e.exports=function(e){var t=++i;return n(e)+t}},98601:(e,t,r)=>{var n=r(57406);e.exports=function(e,t){return null==e||n(e,t)}},11700:(e,t,r)=>{var n=r(98805)("toUpperCase");e.exports=n},52628:(e,t,r)=>{var n=r(47415),i=r(3674);e.exports=function(e){return null==e?[]:n(e,i(e))}},58748:(e,t,r)=>{var n=r(49029),i=r(93157),o=r(79833),s=r(2757);e.exports=function(e,t,r){return e=o(e),void 0===(t=r?void 0:t)?i(e)?s(e):n(e):e.match(t)||[]}},90359:(e,t,r)=>{var n=r(54290),i=r(53131);e.exports=function(e,t){return i(n(t),e)}},8111:(e,t,r)=>{var n=r(96425),i=r(7548),o=r(9435),s=r(1469),a=r(37005),c=r(21913),u=Object.prototype.hasOwnProperty;function l(e){if(a(e)&&!s(e)&&!(e instanceof n)){if(e instanceof i)return e;if(u.call(e,"__wrapped__"))return c(e)}return new i(e)}l.prototype=o.prototype,l.prototype.constructor=l,e.exports=l},39593:(e,t,r)=>{"use strict";const n=r(34411),i=Symbol("max"),o=Symbol("length"),s=Symbol("lengthCalculator"),a=Symbol("allowStale"),c=Symbol("maxAge"),u=Symbol("dispose"),l=Symbol("noDisposeOnSet"),d=Symbol("lruList"),h=Symbol("cache"),f=Symbol("updateAgeOnGet"),p=()=>1;const m=(e,t,r)=>{const n=e[h].get(t);if(n){const t=n.value;if(g(e,t)){if(y(e,n),!e[a])return}else r&&(e[f]&&(n.value.now=Date.now()),e[d].unshiftNode(n));return t.value}},g=(e,t)=>{if(!t||!t.maxAge&&!e[c])return!1;const r=Date.now()-t.now;return t.maxAge?r>t.maxAge:e[c]&&r>e[c]},v=e=>{if(e[o]>e[i])for(let t=e[d].tail;e[o]>e[i]&&null!==t;){const r=t.prev;y(e,t),t=r}},y=(e,t)=>{if(t){const r=t.value;e[u]&&e[u](r.key,r.value),e[o]-=r.length,e[h].delete(r.key),e[d].removeNode(t)}};class b{constructor(e,t,r,n,i){this.key=e,this.value=t,this.length=r,this.now=n,this.maxAge=i||0}}const E=(e,t,r,n)=>{let i=r.value;g(e,i)&&(y(e,r),e[a]||(i=void 0)),i&&t.call(n,i.value,i.key,e)};e.exports=class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[i]=e.max||1/0;const t=e.length||p;if(this[s]="function"!=typeof t?p:t,this[a]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[c]=e.maxAge||0,this[u]=e.dispose,this[l]=e.noDisposeOnSet||!1,this[f]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[i]=e||1/0,v(this)}get max(){return this[i]}set allowStale(e){this[a]=!!e}get allowStale(){return this[a]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[c]=e,v(this)}get maxAge(){return this[c]}set lengthCalculator(e){"function"!=typeof e&&(e=p),e!==this[s]&&(this[s]=e,this[o]=0,this[d].forEach((e=>{e.length=this[s](e.value,e.key),this[o]+=e.length}))),v(this)}get lengthCalculator(){return this[s]}get length(){return this[o]}get itemCount(){return this[d].length}rforEach(e,t){t=t||this;for(let r=this[d].tail;null!==r;){const n=r.prev;E(this,e,r,t),r=n}}forEach(e,t){t=t||this;for(let r=this[d].head;null!==r;){const n=r.next;E(this,e,r,t),r=n}}keys(){return this[d].toArray().map((e=>e.key))}values(){return this[d].toArray().map((e=>e.value))}reset(){this[u]&&this[d]&&this[d].length&&this[d].forEach((e=>this[u](e.key,e.value))),this[h]=new Map,this[d]=new n,this[o]=0}dump(){return this[d].map((e=>!g(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[d]}set(e,t,r){if((r=r||this[c])&&"number"!=typeof r)throw new TypeError("maxAge must be a number");const n=r?Date.now():0,a=this[s](t,e);if(this[h].has(e)){if(a>this[i])return y(this,this[h].get(e)),!1;const s=this[h].get(e).value;return this[u]&&(this[l]||this[u](e,s.value)),s.now=n,s.maxAge=r,s.value=t,this[o]+=a-s.length,s.length=a,this.get(e),v(this),!0}const f=new b(e,t,a,n,r);return f.length>this[i]?(this[u]&&this[u](e,t),!1):(this[o]+=f.length,this[d].unshift(f),this[h].set(e,this[d].head),v(this),!0)}has(e){if(!this[h].has(e))return!1;const t=this[h].get(e).value;return!g(this,t)}get(e){return m(this,e,!0)}peek(e){return m(this,e,!1)}pop(){const e=this[d].tail;return e?(y(this,e),e.value):null}del(e){y(this,this[h].get(e))}load(e){this.reset();const t=Date.now();for(let r=e.length-1;r>=0;r--){const n=e[r],i=n.e||0;if(0===i)this.set(n.k,n.v);else{const e=i-t;e>0&&this.set(n.k,n.v,e)}}}prune(){this[h].forEach(((e,t)=>m(this,t,!1)))}}},29146:e=>{"use strict";function t(){this._types=Object.create(null),this._extensions=Object.create(null);for(let e=0;e<arguments.length;e++)this.define(arguments[e]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}t.prototype.define=function(e,t){for(let r in e){let n=e[r].map((function(e){return e.toLowerCase()}));r=r.toLowerCase();for(let e=0;e<n.length;e++){const i=n[e];if("*"!==i[0]){if(!t&&i in this._types)throw new Error('Attempt to change mapping for "'+i+'" extension from "'+this._types[i]+'" to "'+r+'". Pass `force=true` to allow this, otherwise remove "'+i+'" from the list of extensions for "'+r+'".');this._types[i]=r}}if(t||!this._extensions[r]){const e=n[0];this._extensions[r]="*"!==e[0]?e:e.substr(1)}}},t.prototype.getType=function(e){let t=(e=String(e)).replace(/^.*[/\\]/,"").toLowerCase(),r=t.replace(/^.*\./,"").toLowerCase(),n=t.length<e.length;return(r.length<t.length-1||!n)&&this._types[r]||null},t.prototype.getExtension=function(e){return(e=/^\s*([^;\s]*)/.test(e)&&RegExp.$1)&&this._extensions[e.toLowerCase()]||null},e.exports=t},13893:(e,t,r)=>{"use strict";let n=r(29146);e.exports=new n(r(94415),r(33014))},33014:e=>{e.exports={"application/prs.cww":["cww"],"application/vnd.1000minds.decision-model+xml":["1km"],"application/vnd.3gpp.pic-bw-large":["plb"],"application/vnd.3gpp.pic-bw-small":["psb"],"application/vnd.3gpp.pic-bw-var":["pvb"],"application/vnd.3gpp2.tcap":["tcap"],"application/vnd.3m.post-it-notes":["pwn"],"application/vnd.accpac.simply.aso":["aso"],"application/vnd.accpac.simply.imp":["imp"],"application/vnd.acucobol":["acu"],"application/vnd.acucorp":["atc","acutc"],"application/vnd.adobe.air-application-installer-package+zip":["air"],"application/vnd.adobe.formscentral.fcdt":["fcdt"],"application/vnd.adobe.fxp":["fxp","fxpl"],"application/vnd.adobe.xdp+xml":["xdp"],"application/vnd.adobe.xfdf":["xfdf"],"application/vnd.ahead.space":["ahead"],"application/vnd.airzip.filesecure.azf":["azf"],"application/vnd.airzip.filesecure.azs":["azs"],"application/vnd.amazon.ebook":["azw"],"application/vnd.americandynamics.acc":["acc"],"application/vnd.amiga.ami":["ami"],"application/vnd.android.package-archive":["apk"],"application/vnd.anser-web-certificate-issue-initiation":["cii"],"application/vnd.anser-web-funds-transfer-initiation":["fti"],"application/vnd.antix.game-component":["atx"],"application/vnd.apple.installer+xml":["mpkg"],"application/vnd.apple.keynote":["key"],"application/vnd.apple.mpegurl":["m3u8"],"application/vnd.apple.numbers":["numbers"],"application/vnd.apple.pages":["pages"],"application/vnd.apple.pkpass":["pkpass"],"application/vnd.aristanetworks.swi":["swi"],"application/vnd.astraea-software.iota":["iota"],"application/vnd.audiograph":["aep"],"application/vnd.balsamiq.bmml+xml":["bmml"],"application/vnd.blueice.multipass":["mpm"],"application/vnd.bmi":["bmi"],"application/vnd.businessobjects":["rep"],"application/vnd.chemdraw+xml":["cdxml"],"application/vnd.chipnuts.karaoke-mmd":["mmd"],"application/vnd.cinderella":["cdy"],"application/vnd.citationstyles.style+xml":["csl"],"application/vnd.claymore":["cla"],"application/vnd.cloanto.rp9":["rp9"],"application/vnd.clonk.c4group":["c4g","c4d","c4f","c4p","c4u"],"application/vnd.cluetrust.cartomobile-config":["c11amc"],"application/vnd.cluetrust.cartomobile-config-pkg":["c11amz"],"application/vnd.commonspace":["csp"],"application/vnd.contact.cmsg":["cdbcmsg"],"application/vnd.cosmocaller":["cmc"],"application/vnd.crick.clicker":["clkx"],"application/vnd.crick.clicker.keyboard":["clkk"],"application/vnd.crick.clicker.palette":["clkp"],"application/vnd.crick.clicker.template":["clkt"],"application/vnd.crick.clicker.wordbank":["clkw"],"application/vnd.criticaltools.wbs+xml":["wbs"],"application/vnd.ctc-posml":["pml"],"application/vnd.cups-ppd":["ppd"],"application/vnd.curl.car":["car"],"application/vnd.curl.pcurl":["pcurl"],"application/vnd.dart":["dart"],"application/vnd.data-vision.rdz":["rdz"],"application/vnd.dbf":["dbf"],"application/vnd.dece.data":["uvf","uvvf","uvd","uvvd"],"application/vnd.dece.ttml+xml":["uvt","uvvt"],"application/vnd.dece.unspecified":["uvx","uvvx"],"application/vnd.dece.zip":["uvz","uvvz"],"application/vnd.denovo.fcselayout-link":["fe_launch"],"application/vnd.dna":["dna"],"application/vnd.dolby.mlp":["mlp"],"application/vnd.dpgraph":["dpg"],"application/vnd.dreamfactory":["dfac"],"application/vnd.ds-keypoint":["kpxx"],"application/vnd.dvb.ait":["ait"],"application/vnd.dvb.service":["svc"],"application/vnd.dynageo":["geo"],"application/vnd.ecowin.chart":["mag"],"application/vnd.enliven":["nml"],"application/vnd.epson.esf":["esf"],"application/vnd.epson.msf":["msf"],"application/vnd.epson.quickanime":["qam"],"application/vnd.epson.salt":["slt"],"application/vnd.epson.ssf":["ssf"],"application/vnd.eszigno3+xml":["es3","et3"],"application/vnd.ezpix-album":["ez2"],"application/vnd.ezpix-package":["ez3"],"application/vnd.fdf":["fdf"],"application/vnd.fdsn.mseed":["mseed"],"application/vnd.fdsn.seed":["seed","dataless"],"application/vnd.flographit":["gph"],"application/vnd.fluxtime.clip":["ftc"],"application/vnd.framemaker":["fm","frame","maker","book"],"application/vnd.frogans.fnc":["fnc"],"application/vnd.frogans.ltf":["ltf"],"application/vnd.fsc.weblaunch":["fsc"],"application/vnd.fujitsu.oasys":["oas"],"application/vnd.fujitsu.oasys2":["oa2"],"application/vnd.fujitsu.oasys3":["oa3"],"application/vnd.fujitsu.oasysgp":["fg5"],"application/vnd.fujitsu.oasysprs":["bh2"],"application/vnd.fujixerox.ddd":["ddd"],"application/vnd.fujixerox.docuworks":["xdw"],"application/vnd.fujixerox.docuworks.binder":["xbd"],"application/vnd.fuzzysheet":["fzs"],"application/vnd.genomatix.tuxedo":["txd"],"application/vnd.geogebra.file":["ggb"],"application/vnd.geogebra.tool":["ggt"],"application/vnd.geometry-explorer":["gex","gre"],"application/vnd.geonext":["gxt"],"application/vnd.geoplan":["g2w"],"application/vnd.geospace":["g3w"],"application/vnd.gmx":["gmx"],"application/vnd.google-apps.document":["gdoc"],"application/vnd.google-apps.presentation":["gslides"],"application/vnd.google-apps.spreadsheet":["gsheet"],"application/vnd.google-earth.kml+xml":["kml"],"application/vnd.google-earth.kmz":["kmz"],"application/vnd.grafeq":["gqf","gqs"],"application/vnd.groove-account":["gac"],"application/vnd.groove-help":["ghf"],"application/vnd.groove-identity-message":["gim"],"application/vnd.groove-injector":["grv"],"application/vnd.groove-tool-message":["gtm"],"application/vnd.groove-tool-template":["tpl"],"application/vnd.groove-vcard":["vcg"],"application/vnd.hal+xml":["hal"],"application/vnd.handheld-entertainment+xml":["zmm"],"application/vnd.hbci":["hbci"],"application/vnd.hhe.lesson-player":["les"],"application/vnd.hp-hpgl":["hpgl"],"application/vnd.hp-hpid":["hpid"],"application/vnd.hp-hps":["hps"],"application/vnd.hp-jlyt":["jlt"],"application/vnd.hp-pcl":["pcl"],"application/vnd.hp-pclxl":["pclxl"],"application/vnd.hydrostatix.sof-data":["sfd-hdstx"],"application/vnd.ibm.minipay":["mpy"],"application/vnd.ibm.modcap":["afp","listafp","list3820"],"application/vnd.ibm.rights-management":["irm"],"application/vnd.ibm.secure-container":["sc"],"application/vnd.iccprofile":["icc","icm"],"application/vnd.igloader":["igl"],"application/vnd.immervision-ivp":["ivp"],"application/vnd.immervision-ivu":["ivu"],"application/vnd.insors.igm":["igm"],"application/vnd.intercon.formnet":["xpw","xpx"],"application/vnd.intergeo":["i2g"],"application/vnd.intu.qbo":["qbo"],"application/vnd.intu.qfx":["qfx"],"application/vnd.ipunplugged.rcprofile":["rcprofile"],"application/vnd.irepository.package+xml":["irp"],"application/vnd.is-xpr":["xpr"],"application/vnd.isac.fcs":["fcs"],"application/vnd.jam":["jam"],"application/vnd.jcp.javame.midlet-rms":["rms"],"application/vnd.jisp":["jisp"],"application/vnd.joost.joda-archive":["joda"],"application/vnd.kahootz":["ktz","ktr"],"application/vnd.kde.karbon":["karbon"],"application/vnd.kde.kchart":["chrt"],"application/vnd.kde.kformula":["kfo"],"application/vnd.kde.kivio":["flw"],"application/vnd.kde.kontour":["kon"],"application/vnd.kde.kpresenter":["kpr","kpt"],"application/vnd.kde.kspread":["ksp"],"application/vnd.kde.kword":["kwd","kwt"],"application/vnd.kenameaapp":["htke"],"application/vnd.kidspiration":["kia"],"application/vnd.kinar":["kne","knp"],"application/vnd.koan":["skp","skd","skt","skm"],"application/vnd.kodak-descriptor":["sse"],"application/vnd.las.las+xml":["lasxml"],"application/vnd.llamagraphics.life-balance.desktop":["lbd"],"application/vnd.llamagraphics.life-balance.exchange+xml":["lbe"],"application/vnd.lotus-1-2-3":["123"],"application/vnd.lotus-approach":["apr"],"application/vnd.lotus-freelance":["pre"],"application/vnd.lotus-notes":["nsf"],"application/vnd.lotus-organizer":["org"],"application/vnd.lotus-screencam":["scm"],"application/vnd.lotus-wordpro":["lwp"],"application/vnd.macports.portpkg":["portpkg"],"application/vnd.mapbox-vector-tile":["mvt"],"application/vnd.mcd":["mcd"],"application/vnd.medcalcdata":["mc1"],"application/vnd.mediastation.cdkey":["cdkey"],"application/vnd.mfer":["mwf"],"application/vnd.mfmp":["mfm"],"application/vnd.micrografx.flo":["flo"],"application/vnd.micrografx.igx":["igx"],"application/vnd.mif":["mif"],"application/vnd.mobius.daf":["daf"],"application/vnd.mobius.dis":["dis"],"application/vnd.mobius.mbk":["mbk"],"application/vnd.mobius.mqy":["mqy"],"application/vnd.mobius.msl":["msl"],"application/vnd.mobius.plc":["plc"],"application/vnd.mobius.txf":["txf"],"application/vnd.mophun.application":["mpn"],"application/vnd.mophun.certificate":["mpc"],"application/vnd.mozilla.xul+xml":["xul"],"application/vnd.ms-artgalry":["cil"],"application/vnd.ms-cab-compressed":["cab"],"application/vnd.ms-excel":["xls","xlm","xla","xlc","xlt","xlw"],"application/vnd.ms-excel.addin.macroenabled.12":["xlam"],"application/vnd.ms-excel.sheet.binary.macroenabled.12":["xlsb"],"application/vnd.ms-excel.sheet.macroenabled.12":["xlsm"],"application/vnd.ms-excel.template.macroenabled.12":["xltm"],"application/vnd.ms-fontobject":["eot"],"application/vnd.ms-htmlhelp":["chm"],"application/vnd.ms-ims":["ims"],"application/vnd.ms-lrm":["lrm"],"application/vnd.ms-officetheme":["thmx"],"application/vnd.ms-outlook":["msg"],"application/vnd.ms-pki.seccat":["cat"],"application/vnd.ms-pki.stl":["*stl"],"application/vnd.ms-powerpoint":["ppt","pps","pot"],"application/vnd.ms-powerpoint.addin.macroenabled.12":["ppam"],"application/vnd.ms-powerpoint.presentation.macroenabled.12":["pptm"],"application/vnd.ms-powerpoint.slide.macroenabled.12":["sldm"],"application/vnd.ms-powerpoint.slideshow.macroenabled.12":["ppsm"],"application/vnd.ms-powerpoint.template.macroenabled.12":["potm"],"application/vnd.ms-project":["mpp","mpt"],"application/vnd.ms-word.document.macroenabled.12":["docm"],"application/vnd.ms-word.template.macroenabled.12":["dotm"],"application/vnd.ms-works":["wps","wks","wcm","wdb"],"application/vnd.ms-wpl":["wpl"],"application/vnd.ms-xpsdocument":["xps"],"application/vnd.mseq":["mseq"],"application/vnd.musician":["mus"],"application/vnd.muvee.style":["msty"],"application/vnd.mynfc":["taglet"],"application/vnd.neurolanguage.nlu":["nlu"],"application/vnd.nitf":["ntf","nitf"],"application/vnd.noblenet-directory":["nnd"],"application/vnd.noblenet-sealer":["nns"],"application/vnd.noblenet-web":["nnw"],"application/vnd.nokia.n-gage.ac+xml":["*ac"],"application/vnd.nokia.n-gage.data":["ngdat"],"application/vnd.nokia.n-gage.symbian.install":["n-gage"],"application/vnd.nokia.radio-preset":["rpst"],"application/vnd.nokia.radio-presets":["rpss"],"application/vnd.novadigm.edm":["edm"],"application/vnd.novadigm.edx":["edx"],"application/vnd.novadigm.ext":["ext"],"application/vnd.oasis.opendocument.chart":["odc"],"application/vnd.oasis.opendocument.chart-template":["otc"],"application/vnd.oasis.opendocument.database":["odb"],"application/vnd.oasis.opendocument.formula":["odf"],"application/vnd.oasis.opendocument.formula-template":["odft"],"application/vnd.oasis.opendocument.graphics":["odg"],"application/vnd.oasis.opendocument.graphics-template":["otg"],"application/vnd.oasis.opendocument.image":["odi"],"application/vnd.oasis.opendocument.image-template":["oti"],"application/vnd.oasis.opendocument.presentation":["odp"],"application/vnd.oasis.opendocument.presentation-template":["otp"],"application/vnd.oasis.opendocument.spreadsheet":["ods"],"application/vnd.oasis.opendocument.spreadsheet-template":["ots"],"application/vnd.oasis.opendocument.text":["odt"],"application/vnd.oasis.opendocument.text-master":["odm"],"application/vnd.oasis.opendocument.text-template":["ott"],"application/vnd.oasis.opendocument.text-web":["oth"],"application/vnd.olpc-sugar":["xo"],"application/vnd.oma.dd2+xml":["dd2"],"application/vnd.openblox.game+xml":["obgx"],"application/vnd.openofficeorg.extension":["oxt"],"application/vnd.openstreetmap.data+xml":["osm"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":["pptx"],"application/vnd.openxmlformats-officedocument.presentationml.slide":["sldx"],"application/vnd.openxmlformats-officedocument.presentationml.slideshow":["ppsx"],"application/vnd.openxmlformats-officedocument.presentationml.template":["potx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":["xlsx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.template":["xltx"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":["docx"],"application/vnd.openxmlformats-officedocument.wordprocessingml.template":["dotx"],"application/vnd.osgeo.mapguide.package":["mgp"],"application/vnd.osgi.dp":["dp"],"application/vnd.osgi.subsystem":["esa"],"application/vnd.palm":["pdb","pqa","oprc"],"application/vnd.pawaafile":["paw"],"application/vnd.pg.format":["str"],"application/vnd.pg.osasli":["ei6"],"application/vnd.picsel":["efif"],"application/vnd.pmi.widget":["wg"],"application/vnd.pocketlearn":["plf"],"application/vnd.powerbuilder6":["pbd"],"application/vnd.previewsystems.box":["box"],"application/vnd.proteus.magazine":["mgz"],"application/vnd.publishare-delta-tree":["qps"],"application/vnd.pvi.ptid1":["ptid"],"application/vnd.quark.quarkxpress":["qxd","qxt","qwd","qwt","qxl","qxb"],"application/vnd.rar":["rar"],"application/vnd.realvnc.bed":["bed"],"application/vnd.recordare.musicxml":["mxl"],"application/vnd.recordare.musicxml+xml":["musicxml"],"application/vnd.rig.cryptonote":["cryptonote"],"application/vnd.rim.cod":["cod"],"application/vnd.rn-realmedia":["rm"],"application/vnd.rn-realmedia-vbr":["rmvb"],"application/vnd.route66.link66+xml":["link66"],"application/vnd.sailingtracker.track":["st"],"application/vnd.seemail":["see"],"application/vnd.sema":["sema"],"application/vnd.semd":["semd"],"application/vnd.semf":["semf"],"application/vnd.shana.informed.formdata":["ifm"],"application/vnd.shana.informed.formtemplate":["itp"],"application/vnd.shana.informed.interchange":["iif"],"application/vnd.shana.informed.package":["ipk"],"application/vnd.simtech-mindmapper":["twd","twds"],"application/vnd.smaf":["mmf"],"application/vnd.smart.teacher":["teacher"],"application/vnd.software602.filler.form+xml":["fo"],"application/vnd.solent.sdkm+xml":["sdkm","sdkd"],"application/vnd.spotfire.dxp":["dxp"],"application/vnd.spotfire.sfs":["sfs"],"application/vnd.stardivision.calc":["sdc"],"application/vnd.stardivision.draw":["sda"],"application/vnd.stardivision.impress":["sdd"],"application/vnd.stardivision.math":["smf"],"application/vnd.stardivision.writer":["sdw","vor"],"application/vnd.stardivision.writer-global":["sgl"],"application/vnd.stepmania.package":["smzip"],"application/vnd.stepmania.stepchart":["sm"],"application/vnd.sun.wadl+xml":["wadl"],"application/vnd.sun.xml.calc":["sxc"],"application/vnd.sun.xml.calc.template":["stc"],"application/vnd.sun.xml.draw":["sxd"],"application/vnd.sun.xml.draw.template":["std"],"application/vnd.sun.xml.impress":["sxi"],"application/vnd.sun.xml.impress.template":["sti"],"application/vnd.sun.xml.math":["sxm"],"application/vnd.sun.xml.writer":["sxw"],"application/vnd.sun.xml.writer.global":["sxg"],"application/vnd.sun.xml.writer.template":["stw"],"application/vnd.sus-calendar":["sus","susp"],"application/vnd.svd":["svd"],"application/vnd.symbian.install":["sis","sisx"],"application/vnd.syncml+xml":["xsm"],"application/vnd.syncml.dm+wbxml":["bdm"],"application/vnd.syncml.dm+xml":["xdm"],"application/vnd.syncml.dmddf+xml":["ddf"],"application/vnd.tao.intent-module-archive":["tao"],"application/vnd.tcpdump.pcap":["pcap","cap","dmp"],"application/vnd.tmobile-livetv":["tmo"],"application/vnd.trid.tpt":["tpt"],"application/vnd.triscape.mxs":["mxs"],"application/vnd.trueapp":["tra"],"application/vnd.ufdl":["ufd","ufdl"],"application/vnd.uiq.theme":["utz"],"application/vnd.umajin":["umj"],"application/vnd.unity":["unityweb"],"application/vnd.uoml+xml":["uoml"],"application/vnd.vcx":["vcx"],"application/vnd.visio":["vsd","vst","vss","vsw"],"application/vnd.visionary":["vis"],"application/vnd.vsf":["vsf"],"application/vnd.wap.wbxml":["wbxml"],"application/vnd.wap.wmlc":["wmlc"],"application/vnd.wap.wmlscriptc":["wmlsc"],"application/vnd.webturbo":["wtb"],"application/vnd.wolfram.player":["nbp"],"application/vnd.wordperfect":["wpd"],"application/vnd.wqd":["wqd"],"application/vnd.wt.stf":["stf"],"application/vnd.xara":["xar"],"application/vnd.xfdl":["xfdl"],"application/vnd.yamaha.hv-dic":["hvd"],"application/vnd.yamaha.hv-script":["hvs"],"application/vnd.yamaha.hv-voice":["hvp"],"application/vnd.yamaha.openscoreformat":["osf"],"application/vnd.yamaha.openscoreformat.osfpvg+xml":["osfpvg"],"application/vnd.yamaha.smaf-audio":["saf"],"application/vnd.yamaha.smaf-phrase":["spf"],"application/vnd.yellowriver-custom-menu":["cmp"],"application/vnd.zul":["zir","zirz"],"application/vnd.zzazz.deck+xml":["zaz"],"application/x-7z-compressed":["7z"],"application/x-abiword":["abw"],"application/x-ace-compressed":["ace"],"application/x-apple-diskimage":["*dmg"],"application/x-arj":["arj"],"application/x-authorware-bin":["aab","x32","u32","vox"],"application/x-authorware-map":["aam"],"application/x-authorware-seg":["aas"],"application/x-bcpio":["bcpio"],"application/x-bdoc":["*bdoc"],"application/x-bittorrent":["torrent"],"application/x-blorb":["blb","blorb"],"application/x-bzip":["bz"],"application/x-bzip2":["bz2","boz"],"application/x-cbr":["cbr","cba","cbt","cbz","cb7"],"application/x-cdlink":["vcd"],"application/x-cfs-compressed":["cfs"],"application/x-chat":["chat"],"application/x-chess-pgn":["pgn"],"application/x-chrome-extension":["crx"],"application/x-cocoa":["cco"],"application/x-conference":["nsc"],"application/x-cpio":["cpio"],"application/x-csh":["csh"],"application/x-debian-package":["*deb","udeb"],"application/x-dgc-compressed":["dgc"],"application/x-director":["dir","dcr","dxr","cst","cct","cxt","w3d","fgd","swa"],"application/x-doom":["wad"],"application/x-dtbncx+xml":["ncx"],"application/x-dtbook+xml":["dtb"],"application/x-dtbresource+xml":["res"],"application/x-dvi":["dvi"],"application/x-envoy":["evy"],"application/x-eva":["eva"],"application/x-font-bdf":["bdf"],"application/x-font-ghostscript":["gsf"],"application/x-font-linux-psf":["psf"],"application/x-font-pcf":["pcf"],"application/x-font-snf":["snf"],"application/x-font-type1":["pfa","pfb","pfm","afm"],"application/x-freearc":["arc"],"application/x-futuresplash":["spl"],"application/x-gca-compressed":["gca"],"application/x-glulx":["ulx"],"application/x-gnumeric":["gnumeric"],"application/x-gramps-xml":["gramps"],"application/x-gtar":["gtar"],"application/x-hdf":["hdf"],"application/x-httpd-php":["php"],"application/x-install-instructions":["install"],"application/x-iso9660-image":["*iso"],"application/x-iwork-keynote-sffkey":["*key"],"application/x-iwork-numbers-sffnumbers":["*numbers"],"application/x-iwork-pages-sffpages":["*pages"],"application/x-java-archive-diff":["jardiff"],"application/x-java-jnlp-file":["jnlp"],"application/x-keepass2":["kdbx"],"application/x-latex":["latex"],"application/x-lua-bytecode":["luac"],"application/x-lzh-compressed":["lzh","lha"],"application/x-makeself":["run"],"application/x-mie":["mie"],"application/x-mobipocket-ebook":["prc","mobi"],"application/x-ms-application":["application"],"application/x-ms-shortcut":["lnk"],"application/x-ms-wmd":["wmd"],"application/x-ms-wmz":["wmz"],"application/x-ms-xbap":["xbap"],"application/x-msaccess":["mdb"],"application/x-msbinder":["obd"],"application/x-mscardfile":["crd"],"application/x-msclip":["clp"],"application/x-msdos-program":["*exe"],"application/x-msdownload":["*exe","*dll","com","bat","*msi"],"application/x-msmediaview":["mvb","m13","m14"],"application/x-msmetafile":["*wmf","*wmz","*emf","emz"],"application/x-msmoney":["mny"],"application/x-mspublisher":["pub"],"application/x-msschedule":["scd"],"application/x-msterminal":["trm"],"application/x-mswrite":["wri"],"application/x-netcdf":["nc","cdf"],"application/x-ns-proxy-autoconfig":["pac"],"application/x-nzb":["nzb"],"application/x-perl":["pl","pm"],"application/x-pilot":["*prc","*pdb"],"application/x-pkcs12":["p12","pfx"],"application/x-pkcs7-certificates":["p7b","spc"],"application/x-pkcs7-certreqresp":["p7r"],"application/x-rar-compressed":["*rar"],"application/x-redhat-package-manager":["rpm"],"application/x-research-info-systems":["ris"],"application/x-sea":["sea"],"application/x-sh":["sh"],"application/x-shar":["shar"],"application/x-shockwave-flash":["swf"],"application/x-silverlight-app":["xap"],"application/x-sql":["sql"],"application/x-stuffit":["sit"],"application/x-stuffitx":["sitx"],"application/x-subrip":["srt"],"application/x-sv4cpio":["sv4cpio"],"application/x-sv4crc":["sv4crc"],"application/x-t3vm-image":["t3"],"application/x-tads":["gam"],"application/x-tar":["tar"],"application/x-tcl":["tcl","tk"],"application/x-tex":["tex"],"application/x-tex-tfm":["tfm"],"application/x-texinfo":["texinfo","texi"],"application/x-tgif":["*obj"],"application/x-ustar":["ustar"],"application/x-virtualbox-hdd":["hdd"],"application/x-virtualbox-ova":["ova"],"application/x-virtualbox-ovf":["ovf"],"application/x-virtualbox-vbox":["vbox"],"application/x-virtualbox-vbox-extpack":["vbox-extpack"],"application/x-virtualbox-vdi":["vdi"],"application/x-virtualbox-vhd":["vhd"],"application/x-virtualbox-vmdk":["vmdk"],"application/x-wais-source":["src"],"application/x-web-app-manifest+json":["webapp"],"application/x-x509-ca-cert":["der","crt","pem"],"application/x-xfig":["fig"],"application/x-xliff+xml":["*xlf"],"application/x-xpinstall":["xpi"],"application/x-xz":["xz"],"application/x-zmachine":["z1","z2","z3","z4","z5","z6","z7","z8"],"audio/vnd.dece.audio":["uva","uvva"],"audio/vnd.digital-winds":["eol"],"audio/vnd.dra":["dra"],"audio/vnd.dts":["dts"],"audio/vnd.dts.hd":["dtshd"],"audio/vnd.lucent.voice":["lvp"],"audio/vnd.ms-playready.media.pya":["pya"],"audio/vnd.nuera.ecelp4800":["ecelp4800"],"audio/vnd.nuera.ecelp7470":["ecelp7470"],"audio/vnd.nuera.ecelp9600":["ecelp9600"],"audio/vnd.rip":["rip"],"audio/x-aac":["aac"],"audio/x-aiff":["aif","aiff","aifc"],"audio/x-caf":["caf"],"audio/x-flac":["flac"],"audio/x-m4a":["*m4a"],"audio/x-matroska":["mka"],"audio/x-mpegurl":["m3u"],"audio/x-ms-wax":["wax"],"audio/x-ms-wma":["wma"],"audio/x-pn-realaudio":["ram","ra"],"audio/x-pn-realaudio-plugin":["rmp"],"audio/x-realaudio":["*ra"],"audio/x-wav":["*wav"],"chemical/x-cdx":["cdx"],"chemical/x-cif":["cif"],"chemical/x-cmdf":["cmdf"],"chemical/x-cml":["cml"],"chemical/x-csml":["csml"],"chemical/x-xyz":["xyz"],"image/prs.btif":["btif"],"image/prs.pti":["pti"],"image/vnd.adobe.photoshop":["psd"],"image/vnd.airzip.accelerator.azv":["azv"],"image/vnd.dece.graphic":["uvi","uvvi","uvg","uvvg"],"image/vnd.djvu":["djvu","djv"],"image/vnd.dvb.subtitle":["*sub"],"image/vnd.dwg":["dwg"],"image/vnd.dxf":["dxf"],"image/vnd.fastbidsheet":["fbs"],"image/vnd.fpx":["fpx"],"image/vnd.fst":["fst"],"image/vnd.fujixerox.edmics-mmr":["mmr"],"image/vnd.fujixerox.edmics-rlc":["rlc"],"image/vnd.microsoft.icon":["ico"],"image/vnd.ms-dds":["dds"],"image/vnd.ms-modi":["mdi"],"image/vnd.ms-photo":["wdp"],"image/vnd.net-fpx":["npx"],"image/vnd.pco.b16":["b16"],"image/vnd.tencent.tap":["tap"],"image/vnd.valve.source.texture":["vtf"],"image/vnd.wap.wbmp":["wbmp"],"image/vnd.xiff":["xif"],"image/vnd.zbrush.pcx":["pcx"],"image/x-3ds":["3ds"],"image/x-cmu-raster":["ras"],"image/x-cmx":["cmx"],"image/x-freehand":["fh","fhc","fh4","fh5","fh7"],"image/x-icon":["*ico"],"image/x-jng":["jng"],"image/x-mrsid-image":["sid"],"image/x-ms-bmp":["*bmp"],"image/x-pcx":["*pcx"],"image/x-pict":["pic","pct"],"image/x-portable-anymap":["pnm"],"image/x-portable-bitmap":["pbm"],"image/x-portable-graymap":["pgm"],"image/x-portable-pixmap":["ppm"],"image/x-rgb":["rgb"],"image/x-tga":["tga"],"image/x-xbitmap":["xbm"],"image/x-xpixmap":["xpm"],"image/x-xwindowdump":["xwd"],"message/vnd.wfa.wsc":["wsc"],"model/vnd.collada+xml":["dae"],"model/vnd.dwf":["dwf"],"model/vnd.gdl":["gdl"],"model/vnd.gtw":["gtw"],"model/vnd.mts":["mts"],"model/vnd.opengex":["ogex"],"model/vnd.parasolid.transmit.binary":["x_b"],"model/vnd.parasolid.transmit.text":["x_t"],"model/vnd.sap.vds":["vds"],"model/vnd.usdz+zip":["usdz"],"model/vnd.valve.source.compiled-map":["bsp"],"model/vnd.vtu":["vtu"],"text/prs.lines.tag":["dsc"],"text/vnd.curl":["curl"],"text/vnd.curl.dcurl":["dcurl"],"text/vnd.curl.mcurl":["mcurl"],"text/vnd.curl.scurl":["scurl"],"text/vnd.dvb.subtitle":["sub"],"text/vnd.fly":["fly"],"text/vnd.fmi.flexstor":["flx"],"text/vnd.graphviz":["gv"],"text/vnd.in3d.3dml":["3dml"],"text/vnd.in3d.spot":["spot"],"text/vnd.sun.j2me.app-descriptor":["jad"],"text/vnd.wap.wml":["wml"],"text/vnd.wap.wmlscript":["wmls"],"text/x-asm":["s","asm"],"text/x-c":["c","cc","cxx","cpp","h","hh","dic"],"text/x-component":["htc"],"text/x-fortran":["f","for","f77","f90"],"text/x-handlebars-template":["hbs"],"text/x-java-source":["java"],"text/x-lua":["lua"],"text/x-markdown":["mkd"],"text/x-nfo":["nfo"],"text/x-opml":["opml"],"text/x-org":["*org"],"text/x-pascal":["p","pas"],"text/x-processing":["pde"],"text/x-sass":["sass"],"text/x-scss":["scss"],"text/x-setext":["etx"],"text/x-sfv":["sfv"],"text/x-suse-ymp":["ymp"],"text/x-uuencode":["uu"],"text/x-vcalendar":["vcs"],"text/x-vcard":["vcf"],"video/vnd.dece.hd":["uvh","uvvh"],"video/vnd.dece.mobile":["uvm","uvvm"],"video/vnd.dece.pd":["uvp","uvvp"],"video/vnd.dece.sd":["uvs","uvvs"],"video/vnd.dece.video":["uvv","uvvv"],"video/vnd.dvb.file":["dvb"],"video/vnd.fvt":["fvt"],"video/vnd.mpegurl":["mxu","m4u"],"video/vnd.ms-playready.media.pyv":["pyv"],"video/vnd.uvvu.mp4":["uvu","uvvu"],"video/vnd.vivo":["viv"],"video/x-f4v":["f4v"],"video/x-fli":["fli"],"video/x-flv":["flv"],"video/x-m4v":["m4v"],"video/x-matroska":["mkv","mk3d","mks"],"video/x-mng":["mng"],"video/x-ms-asf":["asf","asx"],"video/x-ms-vob":["vob"],"video/x-ms-wm":["wm"],"video/x-ms-wmv":["wmv"],"video/x-ms-wmx":["wmx"],"video/x-ms-wvx":["wvx"],"video/x-msvideo":["avi"],"video/x-sgi-movie":["movie"],"video/x-smv":["smv"],"x-conference/x-cooltalk":["ice"]}},94415:e=>{e.exports={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["es","ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]}},57824:e=>{var t=1e3,r=60*t,n=60*r,i=24*n,o=7*i,s=365.25*i;function a(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}e.exports=function(e,c){c=c||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!a)return;var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*s;case"weeks":case"week":case"w":return c*o;case"days":case"day":case"d":return c*i;case"hours":case"hour":case"hrs":case"hr":case"h":return c*n;case"minutes":case"minute":case"mins":case"min":case"m":return c*r;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===u&&isFinite(e))return c.long?function(e){var o=Math.abs(e);if(o>=i)return a(e,o,i,"day");if(o>=n)return a(e,o,n,"hour");if(o>=r)return a(e,o,r,"minute");if(o>=t)return a(e,o,t,"second");return e+" ms"}(e):function(e){var o=Math.abs(e);if(o>=i)return Math.round(e/i)+"d";if(o>=n)return Math.round(e/n)+"h";if(o>=r)return Math.round(e/r)+"m";if(o>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},8925:(e,t,r)=>{var n=r(3832);function i(e,t){n.cipher.registerAlgorithm(e,(function(){return new n.aes.Algorithm(e,t)}))}r(85649),r(61967),r(97116),e.exports=n.aes=n.aes||{},n.aes.startEncrypting=function(e,t,r,n){var i=m({key:e,output:r,decrypt:!1,mode:n});return i.start(t),i},n.aes.createEncryptionCipher=function(e,t){return m({key:e,output:null,decrypt:!1,mode:t})},n.aes.startDecrypting=function(e,t,r,n){var i=m({key:e,output:r,decrypt:!0,mode:n});return i.start(t),i},n.aes.createDecryptionCipher=function(e,t){return m({key:e,output:null,decrypt:!0,mode:t})},n.aes.Algorithm=function(e,t){l||h();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(e,t){return p(r._w,e,t,!1)},decrypt:function(e,t){return p(r._w,e,t,!0)}}}),r._init=!1},n.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t,r=e.key;if("string"!=typeof r||16!==r.length&&24!==r.length&&32!==r.length){if(n.util.isArray(r)&&(16===r.length||24===r.length||32===r.length)){t=r,r=n.util.createBuffer();for(var i=0;i<t.length;++i)r.putByte(t[i])}}else r=n.util.createBuffer(r);if(!n.util.isArray(r)){t=r,r=[];var o=t.length();if(16===o||24===o||32===o){o>>>=2;for(i=0;i<o;++i)r.push(t.getInt32())}}if(!n.util.isArray(r)||4!==r.length&&6!==r.length&&8!==r.length)throw new Error("Invalid key parameter.");var s=this.mode.name,a=-1!==["CFB","OFB","CTR","GCM"].indexOf(s);this._w=f(r,e.decrypt&&!a),this._init=!0}},n.aes._expandKey=function(e,t){return l||h(),f(e,t)},n.aes._updateBlock=p,i("AES-ECB",n.cipher.modes.ecb),i("AES-CBC",n.cipher.modes.cbc),i("AES-CFB",n.cipher.modes.cfb),i("AES-OFB",n.cipher.modes.ofb),i("AES-CTR",n.cipher.modes.ctr),i("AES-GCM",n.cipher.modes.gcm);var o,s,a,c,u,l=!1,d=4;function h(){l=!0,a=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;o=new Array(256),s=new Array(256),c=new Array(4),u=new Array(4);for(t=0;t<4;++t)c[t]=new Array(256),u[t]=new Array(256);var r,n,i,d,h,f,p,m=0,g=0;for(t=0;t<256;++t){d=(d=g^g<<1^g<<2^g<<3^g<<4)>>8^255&d^99,o[m]=d,s[d]=m,f=(h=e[d])<<24^d<<16^d<<8^d^h,p=((r=e[m])^(n=e[r])^(i=e[n]))<<24^(m^i)<<16^(m^n^i)<<8^m^r^i;for(var v=0;v<4;++v)c[v][m]=f,u[v][d]=p,f=f<<24|f>>>8,p=p<<24|p>>>8;0===m?m=g=1:(m=r^e[e[e[r^i]]],g^=e[e[g]])}}function f(e,t){for(var r,n=e.slice(0),i=1,s=n.length,c=d*(s+6+1),l=s;l<c;++l)r=n[l-1],l%s==0?(r=o[r>>>16&255]<<24^o[r>>>8&255]<<16^o[255&r]<<8^o[r>>>24]^a[i]<<24,i++):s>6&&l%s==4&&(r=o[r>>>24]<<24^o[r>>>16&255]<<16^o[r>>>8&255]<<8^o[255&r]),n[l]=n[l-s]^r;if(t){for(var h,f=u[0],p=u[1],m=u[2],g=u[3],v=n.slice(0),y=(l=0,(c=n.length)-d);l<c;l+=d,y-=d)if(0===l||l===c-d)v[l]=n[y],v[l+1]=n[y+3],v[l+2]=n[y+2],v[l+3]=n[y+1];else for(var b=0;b<d;++b)h=n[y+b],v[l+(3&-b)]=f[o[h>>>24]]^p[o[h>>>16&255]]^m[o[h>>>8&255]]^g[o[255&h]];n=v}return n}function p(e,t,r,n){var i,a,l,d,h,f,p,m,g,v,y,b,E=e.length/4-1;n?(i=u[0],a=u[1],l=u[2],d=u[3],h=s):(i=c[0],a=c[1],l=c[2],d=c[3],h=o),f=t[0]^e[0],p=t[n?3:1]^e[1],m=t[2]^e[2],g=t[n?1:3]^e[3];for(var w=3,S=1;S<E;++S)v=i[f>>>24]^a[p>>>16&255]^l[m>>>8&255]^d[255&g]^e[++w],y=i[p>>>24]^a[m>>>16&255]^l[g>>>8&255]^d[255&f]^e[++w],b=i[m>>>24]^a[g>>>16&255]^l[f>>>8&255]^d[255&p]^e[++w],g=i[g>>>24]^a[f>>>16&255]^l[p>>>8&255]^d[255&m]^e[++w],f=v,p=y,m=b;r[0]=h[f>>>24]<<24^h[p>>>16&255]<<16^h[m>>>8&255]<<8^h[255&g]^e[++w],r[n?3:1]=h[p>>>24]<<24^h[m>>>16&255]<<16^h[g>>>8&255]<<8^h[255&f]^e[++w],r[2]=h[m>>>24]<<24^h[g>>>16&255]<<16^h[f>>>8&255]<<8^h[255&p]^e[++w],r[n?1:3]=h[g>>>24]<<24^h[f>>>16&255]<<16^h[p>>>8&255]<<8^h[255&m]^e[++w]}function m(e){var t,r="AES-"+((e=e||{}).mode||"CBC").toUpperCase(),i=(t=e.decrypt?n.cipher.createDecipher(r,e.key):n.cipher.createCipher(r,e.key)).start;return t.start=function(e,r){var o=null;r instanceof n.util.ByteBuffer&&(o=r,r={}),(r=r||{}).output=o,r.iv=e,i.call(t,r)},t}},3068:(e,t,r)=>{var n=r(3832);r(97116),r(66270);var i=e.exports=n.asn1=n.asn1||{};function o(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}i.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},i.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},i.create=function(e,t,r,o,s){if(n.util.isArray(o)){for(var a=[],c=0;c<o.length;++c)void 0!==o[c]&&a.push(o[c]);o=a}var u={tagClass:e,type:t,constructed:r,composed:r||n.util.isArray(o),value:o};return s&&"bitStringContents"in s&&(u.bitStringContents=s.bitStringContents,u.original=i.copy(u)),u},i.copy=function(e,t){var r;if(n.util.isArray(e)){r=[];for(var o=0;o<e.length;++o)r.push(i.copy(e[o],t));return r}return"string"==typeof e?e:(r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:i.copy(e.value,t)},t&&!t.excludeBitStringContents&&(r.bitStringContents=e.bitStringContents),r)},i.equals=function(e,t,r){if(n.util.isArray(e)){if(!n.util.isArray(t))return!1;if(e.length!==t.length)return!1;for(var o=0;o<e.length;++o)if(!i.equals(e[o],t[o]))return!1;return!0}if(typeof e!=typeof t)return!1;if("string"==typeof e)return e===t;var s=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&i.equals(e.value,t.value);return r&&r.includeBitStringContents&&(s=s&&e.bitStringContents===t.bitStringContents),s},i.getBerValueLength=function(e){var t=e.getByte();if(128!==t)return 128&t?e.getInt((127&t)<<3):t};function s(e,t,r,n){var a;o(e,t,2);var c=e.getByte();t--;var u=192&c,l=31&c;a=e.length();var d,h,f=function(e,t){var r=e.getByte();if(t--,128!==r){var n;if(128&r){var i=127&r;o(e,t,i),n=e.getInt(i<<3)}else n=r;if(n<0)throw new Error("Negative length: "+n);return n}}(e,t);if(t-=a-e.length(),void 0!==f&&f>t){if(n.strict){var p=new Error("Too few bytes to read ASN.1 value.");throw p.available=e.length(),p.remaining=t,p.requested=f,p}f=t}var m=32==(32&c);if(m)if(d=[],void 0===f)for(;;){if(o(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}a=e.length(),d.push(s(e,t,r+1,n)),t-=a-e.length()}else for(;f>0;)a=e.length(),d.push(s(e,f,r+1,n)),t-=a-e.length(),f-=a-e.length();if(void 0===d&&u===i.Class.UNIVERSAL&&l===i.Type.BITSTRING&&(h=e.bytes(f)),void 0===d&&n.decodeBitStrings&&u===i.Class.UNIVERSAL&&l===i.Type.BITSTRING&&f>1){var g=e.read,v=t,y=0;if(l===i.Type.BITSTRING&&(o(e,t,1),y=e.getByte(),t--),0===y)try{a=e.length();var b=s(e,t,r+1,{strict:!0,decodeBitStrings:!0}),E=a-e.length();t-=E,l==i.Type.BITSTRING&&E++;var w=b.tagClass;E!==f||w!==i.Class.UNIVERSAL&&w!==i.Class.CONTEXT_SPECIFIC||(d=[b])}catch(e){}void 0===d&&(e.read=g,t=v)}if(void 0===d){if(void 0===f){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=t}if(l===i.Type.BMPSTRING)for(d="";f>0;f-=2)o(e,t,2),d+=String.fromCharCode(e.getInt16()),t-=2;else d=e.getBytes(f),t-=f}var S=void 0===h?null:{bitStringContents:h};return i.create(u,l,m,d,S)}i.fromDer=function(e,t){void 0===t&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),"boolean"==typeof t&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),"string"==typeof e&&(e=n.util.createBuffer(e));var r=e.length(),i=s(e,e.length(),0,t);if(t.parseAllBytes&&0!==e.length()){var o=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw o.byteCount=r,o.remaining=e.length(),o}return i},i.toDer=function(e){var t=n.util.createBuffer(),r=e.tagClass|e.type,o=n.util.createBuffer(),s=!1;if("bitStringContents"in e&&(s=!0,e.original&&(s=i.equals(e,e.original))),s)o.putBytes(e.bitStringContents);else if(e.composed){e.constructed?r|=32:o.putByte(0);for(var a=0;a<e.value.length;++a)void 0!==e.value[a]&&o.putBuffer(i.toDer(e.value[a]))}else if(e.type===i.Type.BMPSTRING)for(a=0;a<e.value.length;++a)o.putInt16(e.value.charCodeAt(a));else e.type===i.Type.INTEGER&&e.value.length>1&&(0===e.value.charCodeAt(0)&&0==(128&e.value.charCodeAt(1))||255===e.value.charCodeAt(0)&&128==(128&e.value.charCodeAt(1)))?o.putBytes(e.value.substr(1)):o.putBytes(e.value);if(t.putByte(r),o.length()<=127)t.putByte(127&o.length());else{var c=o.length(),u="";do{u+=String.fromCharCode(255&c),c>>>=8}while(c>0);t.putByte(128|u.length);for(a=u.length-1;a>=0;--a)t.putByte(u.charCodeAt(a))}return t.putBuffer(o),t},i.oidToDer=function(e){var t,r,i,o,s=e.split("."),a=n.util.createBuffer();a.putByte(40*parseInt(s[0],10)+parseInt(s[1],10));for(var c=2;c<s.length;++c){t=!0,r=[],i=parseInt(s[c],10);do{o=127&i,i>>>=7,t||(o|=128),r.push(o),t=!1}while(i>0);for(var u=r.length-1;u>=0;--u)a.putByte(r[u])}return a},i.derToOid=function(e){var t;"string"==typeof e&&(e=n.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var i=0;e.length()>0;)i<<=7,128&(r=e.getByte())?i+=127&r:(t+="."+(i+r),i=0);return t},i.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),o=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),a=0;if(e.length>11){var c=e.charAt(10),u=10;"+"!==c&&"-"!==c&&(a=parseInt(e.substr(10,2),10),u+=2)}if(t.setUTCFullYear(r,n,i),t.setUTCHours(o,s,a,0),u&&("+"===(c=e.charAt(u))||"-"===c)){var l=60*parseInt(e.substr(u+1,2),10)+parseInt(e.substr(u+4,2),10);l*=6e4,"+"===c?t.setTime(+t-l):t.setTime(+t+l)}return t},i.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),o=parseInt(e.substr(8,2),10),s=parseInt(e.substr(10,2),10),a=parseInt(e.substr(12,2),10),c=0,u=0,l=!1;"Z"===e.charAt(e.length-1)&&(l=!0);var d=e.length-5,h=e.charAt(d);"+"!==h&&"-"!==h||(u=60*parseInt(e.substr(d+1,2),10)+parseInt(e.substr(d+4,2),10),u*=6e4,"+"===h&&(u*=-1),l=!0);return"."===e.charAt(14)&&(c=1e3*parseFloat(e.substr(14),10)),l?(t.setUTCFullYear(r,n,i),t.setUTCHours(o,s,a,c),t.setTime(+t+u)):(t.setFullYear(r,n,i),t.setHours(o,s,a,c)),t},i.dateToUtcTime=function(e){if("string"==typeof e)return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z"},i.dateToGeneralizedTime=function(e){if("string"==typeof e)return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z"},i.integerToDer=function(e){var t=n.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r},i.derToInteger=function(e){"string"==typeof e&&(e=n.util.createBuffer(e));var t=8*e.length();if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)},i.validate=function(e,t,r,o){var s=!1;if(e.tagClass!==t.tagClass&&void 0!==t.tagClass||e.type!==t.type&&void 0!==t.type)o&&(e.tagClass!==t.tagClass&&o.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&o.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));else if(e.constructed===t.constructed||void 0===t.constructed){if(s=!0,t.value&&n.util.isArray(t.value))for(var a=0,c=0;s&&c<t.value.length;++c)s=t.value[c].optional||!1,e.value[a]&&((s=i.validate(e.value[a],t.value[c],r,o))?++a:t.value[c].optional&&(s=!0)),!s&&o&&o.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(s&&r)if(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(r[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)if(e.bitStringContents.length<2)r[t.captureBitStringValue]="";else{if(0!==e.bitStringContents.charCodeAt(0))throw new Error("captureBitStringValue only supported for zero unused bits");r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}else o&&o.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');return s};var a=/[^\\u0000-\\u00ff]/;i.prettyPrint=function(e,t,r){var o="";r=r||2,(t=t||0)>0&&(o+="\n");for(var s="",c=0;c<t*r;++c)s+=" ";switch(o+=s+"Tag: ",e.tagClass){case i.Class.UNIVERSAL:o+="Universal:";break;case i.Class.APPLICATION:o+="Application:";break;case i.Class.CONTEXT_SPECIFIC:o+="Context-Specific:";break;case i.Class.PRIVATE:o+="Private:"}if(e.tagClass===i.Class.UNIVERSAL)switch(o+=e.type,e.type){case i.Type.NONE:o+=" (None)";break;case i.Type.BOOLEAN:o+=" (Boolean)";break;case i.Type.INTEGER:o+=" (Integer)";break;case i.Type.BITSTRING:o+=" (Bit string)";break;case i.Type.OCTETSTRING:o+=" (Octet string)";break;case i.Type.NULL:o+=" (Null)";break;case i.Type.OID:o+=" (Object Identifier)";break;case i.Type.ODESC:o+=" (Object Descriptor)";break;case i.Type.EXTERNAL:o+=" (External or Instance of)";break;case i.Type.REAL:o+=" (Real)";break;case i.Type.ENUMERATED:o+=" (Enumerated)";break;case i.Type.EMBEDDED:o+=" (Embedded PDV)";break;case i.Type.UTF8:o+=" (UTF8)";break;case i.Type.ROID:o+=" (Relative Object Identifier)";break;case i.Type.SEQUENCE:o+=" (Sequence)";break;case i.Type.SET:o+=" (Set)";break;case i.Type.PRINTABLESTRING:o+=" (Printable String)";break;case i.Type.IA5String:o+=" (IA5String (ASCII))";break;case i.Type.UTCTIME:o+=" (UTC time)";break;case i.Type.GENERALIZEDTIME:o+=" (Generalized time)";break;case i.Type.BMPSTRING:o+=" (BMP String)"}else o+=e.type;if(o+="\n",o+=s+"Constructed: "+e.constructed+"\n",e.composed){var u=0,l="";for(c=0;c<e.value.length;++c)void 0!==e.value[c]&&(u+=1,l+=i.prettyPrint(e.value[c],t+1,r),c+1<e.value.length&&(l+=","));o+=s+"Sub values: "+u+l}else{if(o+=s+"Value: ",e.type===i.Type.OID){var d=i.derToOid(e.value);o+=d,n.pki&&n.pki.oids&&d in n.pki.oids&&(o+=" ("+n.pki.oids[d]+") ")}if(e.type===i.Type.INTEGER)try{o+=i.derToInteger(e.value)}catch(t){o+="0x"+n.util.bytesToHex(e.value)}else if(e.type===i.Type.BITSTRING){if(e.value.length>1?o+="0x"+n.util.bytesToHex(e.value.slice(1)):o+="(none)",e.value.length>0){var h=e.value.charCodeAt(0);1==h?o+=" (1 unused bit shown)":h>1&&(o+=" ("+h+" unused bits shown)")}}else if(e.type===i.Type.OCTETSTRING)a.test(e.value)||(o+="("+e.value+") "),o+="0x"+n.util.bytesToHex(e.value);else if(e.type===i.Type.UTF8)try{o+=n.util.decodeUtf8(e.value)}catch(t){if("URI malformed"!==t.message)throw t;o+="0x"+n.util.bytesToHex(e.value)+" (malformed UTF8)"}else e.type===i.Type.PRINTABLESTRING||e.type===i.Type.IA5String?o+=e.value:a.test(e.value)?o+="0x"+n.util.bytesToHex(e.value):0===e.value.length?o+="[null]":o+=e.value}return o}},78807:e=>{var t={};e.exports=t;var r={};t.encode=function(e,t,r){if("string"!=typeof t)throw new TypeError('"alphabet" must be a string.');if(void 0!==r&&"number"!=typeof r)throw new TypeError('"maxline" must be a number.');var n="";if(e instanceof Uint8Array){var i=0,o=t.length,s=t.charAt(0),a=[0];for(i=0;i<e.length;++i){for(var c=0,u=e[i];c<a.length;++c)u+=a[c]<<8,a[c]=u%o,u=u/o|0;for(;u>0;)a.push(u%o),u=u/o|0}for(i=0;0===e[i]&&i<e.length-1;++i)n+=s;for(i=a.length-1;i>=0;--i)n+=t[a[i]]}else n=function(e,t){var r=0,n=t.length,i=t.charAt(0),o=[0];for(r=0;r<e.length();++r){for(var s=0,a=e.at(r);s<o.length;++s)a+=o[s]<<8,o[s]=a%n,a=a/n|0;for(;a>0;)o.push(a%n),a=a/n|0}var c="";for(r=0;0===e.at(r)&&r<e.length()-1;++r)c+=i;for(r=o.length-1;r>=0;--r)c+=t[o[r]];return c}(e,t);if(r){var l=new RegExp(".{1,"+r+"}","g");n=n.match(l).join("\r\n")}return n},t.decode=function(e,t){if("string"!=typeof e)throw new TypeError('"input" must be a string.');if("string"!=typeof t)throw new TypeError('"alphabet" must be a string.');var n=r[t];if(!n){n=r[t]=[];for(var i=0;i<t.length;++i)n[t.charCodeAt(i)]=i}e=e.replace(/\s/g,"");var o=t.length,s=t.charAt(0),a=[0];for(i=0;i<e.length;i++){var c=n[e.charCodeAt(i)];if(void 0===c)return;for(var u=0,l=c;u<a.length;++u)l+=a[u]*o,a[u]=255&l,l>>=8;for(;l>0;)a.push(255&l),l>>=8}for(var d=0;e[d]===s&&d<e.length-1;++d)a.push(0);return"undefined"!=typeof Buffer?Buffer.from(a.reverse()):new Uint8Array(a.reverse())}},85649:(e,t,r)=>{var n=r(3832);r(97116),e.exports=n.cipher=n.cipher||{},n.cipher.algorithms=n.cipher.algorithms||{},n.cipher.createCipher=function(e,t){var r=e;if("string"==typeof r&&(r=n.cipher.getAlgorithm(r))&&(r=r()),!r)throw new Error("Unsupported algorithm: "+e);return new n.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})},n.cipher.createDecipher=function(e,t){var r=e;if("string"==typeof r&&(r=n.cipher.getAlgorithm(r))&&(r=r()),!r)throw new Error("Unsupported algorithm: "+e);return new n.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})},n.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),n.cipher.algorithms[e]=t},n.cipher.getAlgorithm=function(e){return(e=e.toUpperCase())in n.cipher.algorithms?n.cipher.algorithms[e]:null};var i=n.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};i.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=n.util.createBuffer(),this.output=e.output||n.util.createBuffer(),this.mode.start(t)},i.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},i.prototype.finish=function(e){!e||"ECB"!==this.mode.name&&"CBC"!==this.mode.name||(this.mode.pad=function(t){return e(this.blockSize,t,!1)},this.mode.unpad=function(t){return e(this.blockSize,t,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t))&&(this._finish=!0,this.update(),!(this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))&&!(this.mode.afterFinish&&!this.mode.afterFinish(this.output,t)))}},61967:(e,t,r)=>{var n=r(3832);r(97116),n.cipher=n.cipher||{};var i=e.exports=n.cipher.modes=n.cipher.modes||{};function o(e,t){if("string"==typeof e&&(e=n.util.createBuffer(e)),n.util.isArray(e)&&e.length>4){var r=e;e=n.util.createBuffer();for(var i=0;i<r.length;++i)e.putByte(r[i])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!n.util.isArray(e)){var o=[],s=t/4;for(i=0;i<s;++i)o.push(e.getInt32());e=o}return e}function s(e){e[e.length-1]=e[e.length-1]+1&4294967295}function a(e){return[e/4294967296|0,4294967295&e]}i.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},i.ecb.prototype.start=function(e){},i.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},i.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},i.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},i.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return!(n>this.blockSize<<2)&&(e.truncate(n),!0)},i.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},i.cbc.prototype.start=function(e){if(null===e.iv){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=o(e.iv,this.blockSize),this._prev=this._iv.slice(0)}},i.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock},i.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)},i.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},i.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return!(n>this.blockSize<<2)&&(e.truncate(n),!0)},i.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},i.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=o(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(o>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(o>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},i.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=o(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===e.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(o>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.ofb.prototype.decrypt=i.ofb.prototype.encrypt,i.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},i.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=o(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.ctr.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]);else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(o>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}s(this._inBlock)},i.ctr.prototype.decrypt=i.ctr.prototype.encrypt,i.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0,this._R=3774873600},i.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t,r=n.util.createBuffer(e.iv);if(this._cipherLength=0,t="additionalData"in e?n.util.createBuffer(e.additionalData):n.util.createBuffer(),this._tagLength="tagLength"in e?e.tagLength:128,this._tag=null,e.decrypt&&(this._tag=n.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var i=r.length();if(12===i)this._j0=[r.getInt32(),r.getInt32(),r.getInt32(),1];else{for(this._j0=[0,0,0,0];r.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(a(8*i)))}this._inBlock=this._j0.slice(0),s(this._inBlock),this._partialBytes=0,t=n.util.createBuffer(t),this._aDataLength=a(8*t.length());var o=t.length()%this.blockSize;for(o&&t.fillWithByte(0,this.blockSize-o),this._s=[0,0,0,0];t.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])},i.gcm.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^=e.getInt32());this._cipherLength+=this.blockSize}else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(o<=0||r){if(r){var a=n%this.blockSize;this._cipherLength+=a,this._partialOutput.truncate(this.blockSize-a)}else this._cipherLength+=this.blockSize;for(i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),s(this._inBlock)},i.gcm.prototype.decrypt=function(e,t,r){var n=e.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),s(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize},i.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=n.util.createBuffer();var i=this._aDataLength.concat(a(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,i);var o=[];this.cipher.encrypt(this._j0,o);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^o[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r},i.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),i=0;i<128;++i){e[i/32|0]&1<<31-i%32&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r},i.gcm.prototype.pow=function(e,t){for(var r=1&e[3],n=3;n>0;--n)t[n]=e[n]>>>1|(1&e[n-1])<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)},i.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=e[r/8|0]>>>4*(7-r%8)&15,i=this._m[r][n];t[0]^=i[0],t[1]^=i[1],t[2]^=i[2],t[3]^=i[3]}return t},i.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)},i.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,i=16*r,o=new Array(i),s=0;s<i;++s){var a=[0,0,0,0],c=(n-1-s%n)*t;a[s/n|0]=1<<t-1<<c,o[s]=this.generateSubHashTable(this.multiply(a,e),t)}return o},i.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,i=new Array(r);i[n]=e.slice(0);for(var o=n>>>1;o>0;)this.pow(i[2*o],i[o]=[]),o>>=1;for(o=2;o<n;){for(var s=1;s<o;++s){var a=i[o],c=i[s];i[o+s]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}o*=2}for(i[0]=[0,0,0,0],o=n+1;o<r;++o){var u=i[o^n];i[o]=[e[0]^u[0],e[1]^u[1],e[2]^u[2],e[3]^u[3]]}return i}},33480:(e,t,r)=>{var n=r(3832);function i(e,t){n.cipher.registerAlgorithm(e,(function(){return new n.des.Algorithm(e,t)}))}r(85649),r(61967),r(97116),e.exports=n.des=n.des||{},n.des.startEncrypting=function(e,t,r,n){var i=p({key:e,output:r,decrypt:!1,mode:n||(null===t?"ECB":"CBC")});return i.start(t),i},n.des.createEncryptionCipher=function(e,t){return p({key:e,output:null,decrypt:!1,mode:t})},n.des.startDecrypting=function(e,t,r,n){var i=p({key:e,output:r,decrypt:!0,mode:n||(null===t?"ECB":"CBC")});return i.start(t),i},n.des.createDecryptionCipher=function(e,t){return p({key:e,output:null,decrypt:!0,mode:t})},n.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(e,t){return f(r._keys,e,t,!1)},decrypt:function(e,t){return f(r._keys,e,t,!0)}}}),r._init=!1},n.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=n.util.createBuffer(e.key);if(0===this.name.indexOf("3DES")&&24!==t.length())throw new Error("Invalid Triple-DES key size: "+8*t.length());this._keys=function(e){for(var t,r=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],n=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],o=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],c=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],u=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],l=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],d=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],f=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],p=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],m=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=e.length()>8?3:1,v=[],y=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],b=0,E=0;E<g;E++){var w=e.getInt32(),S=e.getInt32();w^=(t=252645135&(w>>>4^S))<<4,w^=t=65535&((S^=t)>>>-16^w),w^=(t=858993459&(w>>>2^(S^=t<<-16)))<<2,w^=t=65535&((S^=t)>>>-16^w),w^=(t=1431655765&(w>>>1^(S^=t<<-16)))<<1,w^=t=16711935&((S^=t)>>>8^w),t=(w^=(t=1431655765&(w>>>1^(S^=t<<8)))<<1)<<8|(S^=t)>>>20&240,w=S<<24|S<<8&16711680|S>>>8&65280|S>>>24&240,S=t;for(var _=0;_<y.length;++_){y[_]?(w=w<<2|w>>>26,S=S<<2|S>>>26):(w=w<<1|w>>>27,S=S<<1|S>>>27),S&=-15;var T=r[(w&=-15)>>>28]|n[w>>>24&15]|i[w>>>20&15]|o[w>>>16&15]|s[w>>>12&15]|a[w>>>8&15]|c[w>>>4&15],x=u[S>>>28]|l[S>>>24&15]|d[S>>>20&15]|h[S>>>16&15]|f[S>>>12&15]|p[S>>>8&15]|m[S>>>4&15];t=65535&(x>>>16^T),v[b++]=T^t,v[b++]=x^t<<16}}return v}(t),this._init=!0}},i("DES-ECB",n.cipher.modes.ecb),i("DES-CBC",n.cipher.modes.cbc),i("DES-CFB",n.cipher.modes.cfb),i("DES-OFB",n.cipher.modes.ofb),i("DES-CTR",n.cipher.modes.ctr),i("3DES-ECB",n.cipher.modes.ecb),i("3DES-CBC",n.cipher.modes.cbc),i("3DES-CFB",n.cipher.modes.cfb),i("3DES-OFB",n.cipher.modes.ofb),i("3DES-CTR",n.cipher.modes.ctr);var o=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],s=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],a=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],c=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],u=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],l=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],d=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],h=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function f(e,t,r,n){var i,f,p=32===e.length?3:9;i=3===p?n?[30,-2,-2]:[0,32,2]:n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var m=t[0],g=t[1];m^=(f=252645135&(m>>>4^g))<<4,m^=(f=65535&(m>>>16^(g^=f)))<<16,m^=f=858993459&((g^=f)>>>2^m),m^=f=16711935&((g^=f<<2)>>>8^m),m=(m^=(f=1431655765&(m>>>1^(g^=f<<8)))<<1)<<1|m>>>31,g=(g^=f)<<1|g>>>31;for(var v=0;v<p;v+=3){for(var y=i[v+1],b=i[v+2],E=i[v];E!=y;E+=b){var w=g^e[E],S=(g>>>4|g<<28)^e[E+1];f=m,m=g,g=f^(s[w>>>24&63]|c[w>>>16&63]|l[w>>>8&63]|h[63&w]|o[S>>>24&63]|a[S>>>16&63]|u[S>>>8&63]|d[63&S])}f=m,m=g,g=f}g=g>>>1|g<<31,g^=f=1431655765&((m=m>>>1|m<<31)>>>1^g),g^=(f=16711935&(g>>>8^(m^=f<<1)))<<8,g^=(f=858993459&(g>>>2^(m^=f)))<<2,g^=f=65535&((m^=f)>>>16^g),g^=f=252645135&((m^=f<<16)>>>4^g),m^=f<<4,r[0]=m,r[1]=g}function p(e){var t,r="DES-"+((e=e||{}).mode||"CBC").toUpperCase(),i=(t=e.decrypt?n.cipher.createDecipher(r,e.key):n.cipher.createCipher(r,e.key)).start;return t.start=function(e,r){var o=null;r instanceof n.util.ByteBuffer&&(o=r,r={}),(r=r||{}).output=o,r.iv=e,i.call(t,r)},t}},3832:e=>{e.exports={options:{usePureJavaScript:!1}}},36607:(e,t,r)=>{var n=r(3832);r(28991),r(97116),(e.exports=n.hmac=n.hmac||{}).create=function(){var e=null,t=null,r=null,i=null,o={start:function(o,s){if(null!==o)if("string"==typeof o){if(!((o=o.toLowerCase())in n.md.algorithms))throw new Error('Unknown hash algorithm "'+o+'"');t=n.md.algorithms[o].create()}else t=o;if(null===s)s=e;else{if("string"==typeof s)s=n.util.createBuffer(s);else if(n.util.isArray(s)){var a=s;s=n.util.createBuffer();for(var c=0;c<a.length;++c)s.putByte(a[c])}var u=s.length();u>t.blockLength&&(t.start(),t.update(s.bytes()),s=t.digest()),r=n.util.createBuffer(),i=n.util.createBuffer(),u=s.length();for(c=0;c<u;++c){a=s.at(c);r.putByte(54^a),i.putByte(92^a)}if(u<t.blockLength)for(a=t.blockLength-u,c=0;c<a;++c)r.putByte(54),i.putByte(92);e=s,r=r.bytes(),i=i.bytes()}t.start(),t.update(r)},update:function(e){t.update(e)},getMac:function(){var e=t.digest().bytes();return t.start(),t.update(i),t.update(e),t.digest()}};return o.digest=o.getMac,o}},15764:(e,t,r)=>{var n,i=r(3832);e.exports=i.jsbn=i.jsbn||{};function o(e,t,r){this.data=[],null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function s(){return new o(null)}function a(e,t,r,n,i,o){for(var s=16383&t,a=t>>14;--o>=0;){var c=16383&this.data[e],u=this.data[e++]>>14,l=a*c+u*s;i=((c=s*c+((16383&l)<<14)+r.data[n]+i)>>28)+(l>>14)+a*u,r.data[n++]=268435455&c}return i}i.jsbn.BigInteger=o,"undefined"==typeof navigator?(o.prototype.am=a,n=28):"Microsoft Internet Explorer"==navigator.appName?(o.prototype.am=function(e,t,r,n,i,o){for(var s=32767&t,a=t>>15;--o>=0;){var c=32767&this.data[e],u=this.data[e++]>>15,l=a*c+u*s;i=((c=s*c+((32767&l)<<15)+r.data[n]+(1073741823&i))>>>30)+(l>>>15)+a*u+(i>>>30),r.data[n++]=1073741823&c}return i},n=30):"Netscape"!=navigator.appName?(o.prototype.am=function(e,t,r,n,i,o){for(;--o>=0;){var s=t*this.data[e++]+r.data[n]+i;i=Math.floor(s/67108864),r.data[n++]=67108863&s}return i},n=26):(o.prototype.am=a,n=28),o.prototype.DB=n,o.prototype.DM=(1<<n)-1,o.prototype.DV=1<<n;o.prototype.FV=Math.pow(2,52),o.prototype.F1=52-n,o.prototype.F2=2*n-52;var c,u,l="0123456789abcdefghijklmnopqrstuvwxyz",d=new Array;for(c="0".charCodeAt(0),u=0;u<=9;++u)d[c++]=u;for(c="a".charCodeAt(0),u=10;u<36;++u)d[c++]=u;for(c="A".charCodeAt(0),u=10;u<36;++u)d[c++]=u;function h(e){return l.charAt(e)}function f(e,t){var r=d[e.charCodeAt(t)];return null==r?-1:r}function p(e){var t=s();return t.fromInt(e),t}function m(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function g(e){this.m=e}function v(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function y(e,t){return e&t}function b(e,t){return e|t}function E(e,t){return e^t}function w(e,t){return e&~t}function S(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function _(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function T(){}function x(e){return e}function A(e){this.r2=s(),this.q3=s(),o.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}g.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},g.prototype.revert=function(e){return e},g.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},g.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},g.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},v.prototype.convert=function(e){var t=s();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(o.ZERO)>0&&this.m.subTo(t,t),t},v.prototype.revert=function(e){var t=s();return e.copyTo(t),this.reduce(t),t},v.prototype.reduce=function(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e.data[t],n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},v.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},v.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},o.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s},o.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0},o.prototype.fromString=function(e,t){var r;if(16==t)r=4;else if(8==t)r=3;else if(256==t)r=8;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return void this.fromRadix(e,t);r=2}this.t=0,this.s=0;for(var n=e.length,i=!1,s=0;--n>=0;){var a=8==r?255&e[n]:f(e,n);a<0?"-"==e.charAt(n)&&(i=!0):(i=!1,0==s?this.data[this.t++]=a:s+r>this.DB?(this.data[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this.data[this.t++]=a>>this.DB-s):this.data[this.t-1]|=a<<s,(s+=r)>=this.DB&&(s-=this.DB))}8==r&&0!=(128&e[0])&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&o.ZERO.subTo(this,this)},o.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t},o.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s},o.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s},o.prototype.lShiftTo=function(e,t){var r,n=e%this.DB,i=this.DB-n,o=(1<<i)-1,s=Math.floor(e/this.DB),a=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)t.data[r+s+1]=this.data[r]>>i|a,a=(this.data[r]&o)<<n;for(r=s-1;r>=0;--r)t.data[r]=0;t.data[s]=a,t.t=this.t+s+1,t.s=this.s,t.clamp()},o.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,i=this.DB-n,o=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var s=r+1;s<this.t;++s)t.data[s-r-1]|=(this.data[s]&o)<<i,t.data[s-r]=this.data[s]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&o)<<i),t.t=this.t-r,t.clamp()}},o.prototype.subTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()},o.prototype.multiplyTo=function(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t.data[i]=0;for(i=0;i<n.t;++i)t.data[i+r.t]=r.am(0,n.data[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&o.ZERO.subTo(t,t)},o.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()},o.prototype.divRemTo=function(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t)return null!=t&&t.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=s());var a=s(),c=this.s,u=e.s,l=this.DB-m(n.data[n.t-1]);l>0?(n.lShiftTo(l,a),i.lShiftTo(l,r)):(n.copyTo(a),i.copyTo(r));var d=a.t,h=a.data[d-1];if(0!=h){var f=h*(1<<this.F1)+(d>1?a.data[d-2]>>this.F2:0),p=this.FV/f,g=(1<<this.F1)/f,v=1<<this.F2,y=r.t,b=y-d,E=null==t?s():t;for(a.dlShiftTo(b,E),r.compareTo(E)>=0&&(r.data[r.t++]=1,r.subTo(E,r)),o.ONE.dlShiftTo(d,E),E.subTo(a,a);a.t<d;)a.data[a.t++]=0;for(;--b>=0;){var w=r.data[--y]==h?this.DM:Math.floor(r.data[y]*p+(r.data[y-1]+v)*g);if((r.data[y]+=a.am(0,w,r,b,0,d))<w)for(a.dlShiftTo(b,E),r.subTo(E,r);r.data[y]<--w;)r.subTo(E,r)}null!=t&&(r.drShiftTo(d,t),c!=u&&o.ZERO.subTo(t,t)),r.t=d,r.clamp(),l>0&&r.rShiftTo(l,r),c<0&&o.ZERO.subTo(r,r)}}},o.prototype.invDigit=function(){if(this.t<1)return 0;var e=this.data[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},o.prototype.isEven=function(){return 0==(this.t>0?1&this.data[0]:this.s)},o.prototype.exp=function(e,t){if(e>4294967295||e<1)return o.ONE;var r=s(),n=s(),i=t.convert(this),a=m(e)-1;for(i.copyTo(r);--a>=0;)if(t.sqrTo(r,n),(e&1<<a)>0)t.mulTo(n,i,r);else{var c=r;r=n,n=c}return t.revert(r)},o.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,i=!1,o="",s=this.t,a=this.DB-s*this.DB%t;if(s-- >0)for(a<this.DB&&(r=this.data[s]>>a)>0&&(i=!0,o=h(r));s>=0;)a<t?(r=(this.data[s]&(1<<a)-1)<<t-a,r|=this.data[--s]>>(a+=this.DB-t)):(r=this.data[s]>>(a-=t)&n,a<=0&&(a+=this.DB,--s)),r>0&&(i=!0),i&&(o+=h(r));return i?o:"0"},o.prototype.negate=function(){var e=s();return o.ZERO.subTo(this,e),e},o.prototype.abs=function(){return this.s<0?this.negate():this},o.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this.data[r]-e.data[r]))return t;return 0},o.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+m(this.data[this.t-1]^this.s&this.DM)},o.prototype.mod=function(e){var t=s();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(o.ZERO)>0&&e.subTo(t,t),t},o.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new g(t):new v(t),this.exp(e,r)},o.ZERO=p(0),o.ONE=p(1),T.prototype.convert=x,T.prototype.revert=x,T.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},T.prototype.sqrTo=function(e,t){e.squareTo(t)},A.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=s();return e.copyTo(t),this.reduce(t),t},A.prototype.revert=function(e){return e},A.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},A.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},A.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var I=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],C=(1<<26)/I[I.length-1];o.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},o.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=p(r),i=s(),o=s(),a="";for(this.divRemTo(n,i,o);i.signum()>0;)a=(r+o.intValue()).toString(e).substr(1)+a,i.divRemTo(n,i,o);return o.intValue().toString(e)+a},o.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,s=0,a=0,c=0;c<e.length;++c){var u=f(e,c);u<0?"-"==e.charAt(c)&&0==this.signum()&&(i=!0):(a=t*a+u,++s>=r&&(this.dMultiply(n),this.dAddOffset(a,0),s=0,a=0))}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(a,0)),i&&o.ZERO.subTo(this,this)},o.prototype.fromNumber=function(e,t,r){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(o.ONE.shiftLeft(e-1),b,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(o.ONE.shiftLeft(e-1),this);else{var n=new Array,i=7&e;n.length=1+(e>>3),t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}},o.prototype.bitwiseTo=function(e,t,r){var n,i,o=Math.min(e.t,this.t);for(n=0;n<o;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(i=e.s&this.DM,n=o;n<this.t;++n)r.data[n]=t(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=o;n<e.t;++n)r.data[n]=t(i,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},o.prototype.changeBit=function(e,t){var r=o.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r},o.prototype.addTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()},o.prototype.dMultiply=function(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},o.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}},o.prototype.multiplyLowerTo=function(e,t,r){var n,i=Math.min(this.t+e.t,t);for(r.s=0,r.t=i;i>0;)r.data[--i]=0;for(n=r.t-this.t;i<n;++i)r.data[i+this.t]=this.am(0,e.data[i],r,i,0,this.t);for(n=Math.min(e.t,t);i<n;++i)this.am(0,e.data[i],r,i,0,t-i);r.clamp()},o.prototype.multiplyUpperTo=function(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)},o.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r},o.prototype.millerRabin=function(e){var t=this.subtract(o.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n,i=t.shiftRight(r),s={nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(256*Math.random())}},a=0;a<e;++a){do{n=new o(this.bitLength(),s)}while(n.compareTo(o.ONE)<=0||n.compareTo(t)>=0);var c=n.modPow(i,this);if(0!=c.compareTo(o.ONE)&&0!=c.compareTo(t)){for(var u=1;u++<r&&0!=c.compareTo(t);)if(0==(c=c.modPowInt(2,this)).compareTo(o.ONE))return!1;if(0!=c.compareTo(t))return!1}}return!0},o.prototype.clone=function(){var e=s();return this.copyTo(e),e},o.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]},o.prototype.byteValue=function(){return 0==this.t?this.s:this.data[0]<<24>>24},o.prototype.shortValue=function(){return 0==this.t?this.s:this.data[0]<<16>>16},o.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1},o.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,n=this.DB-e*this.DB%8,i=0;if(e-- >0)for(n<this.DB&&(r=this.data[e]>>n)!=(this.s&this.DM)>>n&&(t[i++]=r|this.s<<this.DB-n);e>=0;)n<8?(r=(this.data[e]&(1<<n)-1)<<8-n,r|=this.data[--e]>>(n+=this.DB-8)):(r=this.data[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),0!=(128&r)&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(i>0||r!=this.s)&&(t[i++]=r);return t},o.prototype.equals=function(e){return 0==this.compareTo(e)},o.prototype.min=function(e){return this.compareTo(e)<0?this:e},o.prototype.max=function(e){return this.compareTo(e)>0?this:e},o.prototype.and=function(e){var t=s();return this.bitwiseTo(e,y,t),t},o.prototype.or=function(e){var t=s();return this.bitwiseTo(e,b,t),t},o.prototype.xor=function(e){var t=s();return this.bitwiseTo(e,E,t),t},o.prototype.andNot=function(e){var t=s();return this.bitwiseTo(e,w,t),t},o.prototype.not=function(){for(var e=s(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e},o.prototype.shiftLeft=function(e){var t=s();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},o.prototype.shiftRight=function(e){var t=s();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},o.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this.data[e])return e*this.DB+S(this.data[e]);return this.s<0?this.t*this.DB:-1},o.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=_(this.data[r]^t);return e},o.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this.data[t]&1<<e%this.DB)},o.prototype.setBit=function(e){return this.changeBit(e,b)},o.prototype.clearBit=function(e){return this.changeBit(e,w)},o.prototype.flipBit=function(e){return this.changeBit(e,E)},o.prototype.add=function(e){var t=s();return this.addTo(e,t),t},o.prototype.subtract=function(e){var t=s();return this.subTo(e,t),t},o.prototype.multiply=function(e){var t=s();return this.multiplyTo(e,t),t},o.prototype.divide=function(e){var t=s();return this.divRemTo(e,t,null),t},o.prototype.remainder=function(e){var t=s();return this.divRemTo(e,null,t),t},o.prototype.divideAndRemainder=function(e){var t=s(),r=s();return this.divRemTo(e,t,r),new Array(t,r)},o.prototype.modPow=function(e,t){var r,n,i=e.bitLength(),o=p(1);if(i<=0)return o;r=i<18?1:i<48?3:i<144?4:i<768?5:6,n=i<8?new g(t):t.isEven()?new A(t):new v(t);var a=new Array,c=3,u=r-1,l=(1<<r)-1;if(a[1]=n.convert(this),r>1){var d=s();for(n.sqrTo(a[1],d);c<=l;)a[c]=s(),n.mulTo(d,a[c-2],a[c]),c+=2}var h,f,y=e.t-1,b=!0,E=s();for(i=m(e.data[y])-1;y>=0;){for(i>=u?h=e.data[y]>>i-u&l:(h=(e.data[y]&(1<<i+1)-1)<<u-i,y>0&&(h|=e.data[y-1]>>this.DB+i-u)),c=r;0==(1&h);)h>>=1,--c;if((i-=c)<0&&(i+=this.DB,--y),b)a[h].copyTo(o),b=!1;else{for(;c>1;)n.sqrTo(o,E),n.sqrTo(E,o),c-=2;c>0?n.sqrTo(o,E):(f=o,o=E,E=f),n.mulTo(E,a[h],o)}for(;y>=0&&0==(e.data[y]&1<<i);)n.sqrTo(o,E),f=o,o=E,E=f,--i<0&&(i=this.DB-1,--y)}return n.revert(o)},o.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return o.ZERO;for(var r=e.clone(),n=this.clone(),i=p(1),s=p(0),a=p(0),c=p(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(i.isEven()&&s.isEven()||(i.addTo(this,i),s.subTo(e,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),t?(a.isEven()&&c.isEven()||(a.addTo(this,a),c.subTo(e,c)),a.rShiftTo(1,a)):c.isEven()||c.subTo(e,c),c.rShiftTo(1,c);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(a,i),s.subTo(c,s)):(n.subTo(r,n),t&&a.subTo(i,a),c.subTo(s,c))}return 0!=n.compareTo(o.ONE)?o.ZERO:c.compareTo(e)>=0?c.subtract(e):c.signum()<0?(c.addTo(e,c),c.signum()<0?c.add(e):c):c},o.prototype.pow=function(e){return this.exp(e,new T)},o.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return t;for(i<o&&(o=i),o>0&&(t.rShiftTo(o,t),r.rShiftTo(o,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r},o.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r.data[0]<=I[I.length-1]){for(t=0;t<I.length;++t)if(r.data[0]==I[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<I.length;){for(var n=I[t],i=t+1;i<I.length&&n<C;)n*=I[i++];for(n=r.modInt(n);t<i;)if(n%I[t++]==0)return!1}return r.millerRabin(e)}},28991:(e,t,r)=>{var n=r(3832);e.exports=n.md=n.md||{},n.md.algorithms=n.md.algorithms||{}},86971:(e,t,r)=>{var n=r(3832);r(83453),e.exports=n.mgf=n.mgf||{},n.mgf.mgf1=n.mgf1},83453:(e,t,r)=>{var n=r(3832);r(97116),n.mgf=n.mgf||{},(e.exports=n.mgf.mgf1=n.mgf1=n.mgf1||{}).create=function(e){return{generate:function(t,r){for(var i=new n.util.ByteBuffer,o=Math.ceil(r/e.digestLength),s=0;s<o;s++){var a=new n.util.ByteBuffer;a.putInt32(s),e.start(),e.update(t+a.getBytes()),i.putBuffer(e.digest())}return i.truncate(i.length()-r),i.getBytes()}}}},66270:(e,t,r)=>{var n=r(3832);n.pki=n.pki||{};var i=e.exports=n.pki.oids=n.oids=n.oids||{};function o(e,t){i[e]=t,i[t]=e}function s(e,t){i[e]=t}o("1.2.840.113549.1.1.1","rsaEncryption"),o("1.2.840.113549.1.1.4","md5WithRSAEncryption"),o("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),o("1.2.840.113549.1.1.7","RSAES-OAEP"),o("1.2.840.113549.1.1.8","mgf1"),o("1.2.840.113549.1.1.9","pSpecified"),o("1.2.840.113549.1.1.10","RSASSA-PSS"),o("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),o("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),o("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),o("1.3.101.112","EdDSA25519"),o("1.2.840.10040.4.3","dsa-with-sha1"),o("1.3.14.3.2.7","desCBC"),o("1.3.14.3.2.26","sha1"),o("1.3.14.3.2.29","sha1WithRSASignature"),o("2.16.840.1.101.3.4.2.1","sha256"),o("2.16.840.1.101.3.4.2.2","sha384"),o("2.16.840.1.101.3.4.2.3","sha512"),o("2.16.840.1.101.3.4.2.4","sha224"),o("2.16.840.1.101.3.4.2.5","sha512-224"),o("2.16.840.1.101.3.4.2.6","sha512-256"),o("1.2.840.113549.2.2","md2"),o("1.2.840.113549.2.5","md5"),o("1.2.840.113549.1.7.1","data"),o("1.2.840.113549.1.7.2","signedData"),o("1.2.840.113549.1.7.3","envelopedData"),o("1.2.840.113549.1.7.4","signedAndEnvelopedData"),o("1.2.840.113549.1.7.5","digestedData"),o("1.2.840.113549.1.7.6","encryptedData"),o("1.2.840.113549.1.9.1","emailAddress"),o("1.2.840.113549.1.9.2","unstructuredName"),o("1.2.840.113549.1.9.3","contentType"),o("1.2.840.113549.1.9.4","messageDigest"),o("1.2.840.113549.1.9.5","signingTime"),o("1.2.840.113549.1.9.6","counterSignature"),o("1.2.840.113549.1.9.7","challengePassword"),o("1.2.840.113549.1.9.8","unstructuredAddress"),o("1.2.840.113549.1.9.14","extensionRequest"),o("1.2.840.113549.1.9.20","friendlyName"),o("1.2.840.113549.1.9.21","localKeyId"),o("1.2.840.113549.1.9.22.1","x509Certificate"),o("1.2.840.113549.1.12.10.1.1","keyBag"),o("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),o("1.2.840.113549.1.12.10.1.3","certBag"),o("1.2.840.113549.1.12.10.1.4","crlBag"),o("1.2.840.113549.1.12.10.1.5","secretBag"),o("1.2.840.113549.1.12.10.1.6","safeContentsBag"),o("1.2.840.113549.1.5.13","pkcs5PBES2"),o("1.2.840.113549.1.5.12","pkcs5PBKDF2"),o("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),o("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),o("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),o("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),o("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),o("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),o("1.2.840.113549.2.7","hmacWithSHA1"),o("1.2.840.113549.2.8","hmacWithSHA224"),o("1.2.840.113549.2.9","hmacWithSHA256"),o("1.2.840.113549.2.10","hmacWithSHA384"),o("1.2.840.113549.2.11","hmacWithSHA512"),o("1.2.840.113549.3.7","des-EDE3-CBC"),o("2.16.840.1.101.3.4.1.2","aes128-CBC"),o("2.16.840.1.101.3.4.1.22","aes192-CBC"),o("2.16.840.1.101.3.4.1.42","aes256-CBC"),o("2.5.4.3","commonName"),o("2.5.4.4","surname"),o("2.5.4.5","serialNumber"),o("2.5.4.6","countryName"),o("2.5.4.7","localityName"),o("2.5.4.8","stateOrProvinceName"),o("2.5.4.9","streetAddress"),o("2.5.4.10","organizationName"),o("2.5.4.11","organizationalUnitName"),o("2.5.4.12","title"),o("2.5.4.13","description"),o("2.5.4.15","businessCategory"),o("2.5.4.17","postalCode"),o("2.5.4.42","givenName"),o("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),o("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),o("2.16.840.1.113730.1.1","nsCertType"),o("2.16.840.1.113730.1.13","nsComment"),s("2.5.29.1","authorityKeyIdentifier"),s("2.5.29.2","keyAttributes"),s("2.5.29.3","certificatePolicies"),s("2.5.29.4","keyUsageRestriction"),s("2.5.29.5","policyMapping"),s("2.5.29.6","subtreesConstraint"),s("2.5.29.7","subjectAltName"),s("2.5.29.8","issuerAltName"),s("2.5.29.9","subjectDirectoryAttributes"),s("2.5.29.10","basicConstraints"),s("2.5.29.11","nameConstraints"),s("2.5.29.12","policyConstraints"),s("2.5.29.13","basicConstraints"),o("2.5.29.14","subjectKeyIdentifier"),o("2.5.29.15","keyUsage"),s("2.5.29.16","privateKeyUsagePeriod"),o("2.5.29.17","subjectAltName"),o("2.5.29.18","issuerAltName"),o("2.5.29.19","basicConstraints"),s("2.5.29.20","cRLNumber"),s("2.5.29.21","cRLReason"),s("2.5.29.22","expirationDate"),s("2.5.29.23","instructionCode"),s("2.5.29.24","invalidityDate"),s("2.5.29.25","cRLDistributionPoints"),s("2.5.29.26","issuingDistributionPoint"),s("2.5.29.27","deltaCRLIndicator"),s("2.5.29.28","issuingDistributionPoint"),s("2.5.29.29","certificateIssuer"),s("2.5.29.30","nameConstraints"),o("2.5.29.31","cRLDistributionPoints"),o("2.5.29.32","certificatePolicies"),s("2.5.29.33","policyMappings"),s("2.5.29.34","policyConstraints"),o("2.5.29.35","authorityKeyIdentifier"),s("2.5.29.36","policyConstraints"),o("2.5.29.37","extKeyUsage"),s("2.5.29.46","freshestCRL"),s("2.5.29.54","inhibitAnyPolicy"),o("1.3.6.1.4.1.11129.2.4.2","timestampList"),o("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),o("1.3.6.1.5.5.7.3.1","serverAuth"),o("1.3.6.1.5.5.7.3.2","clientAuth"),o("1.3.6.1.5.5.7.3.3","codeSigning"),o("1.3.6.1.5.5.7.3.4","emailProtection"),o("1.3.6.1.5.5.7.3.8","timeStamping")},97450:(e,t,r)=>{var n=r(3832);if(r(8925),r(3068),r(33480),r(28991),r(66270),r(98960),r(26953),r(49563),r(69372),r(28095),r(97116),void 0===i)var i=n.jsbn.BigInteger;var o=n.asn1,s=n.pki=n.pki||{};e.exports=s.pbe=n.pbe=n.pbe||{};var a=s.oids,c={name:"EncryptedPrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},u={name:"PBES2Algorithms",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},l={name:"pkcs-12PbeParams",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"iterations"}]};function d(e,t){return e.start().update(t).digest().getBytes()}function h(e){var t;if(e){if(!(t=s.oids[o.derToOid(e)])){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}}else t="hmacWithSHA1";return f(t)}function f(e){var t=n.md;switch(e){case"hmacWithSHA224":t=n.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}s.encryptPrivateKeyInfo=function(e,t,r){(r=r||{}).saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var i,c,u,l=n.random.getBytesSync(r.saltSize),d=r.count,h=o.integerToDer(d);if(0===r.algorithm.indexOf("aes")||"des"===r.algorithm){var p,m,g;switch(r.algorithm){case"aes128":i=16,p=16,m=a["aes128-CBC"],g=n.aes.createEncryptionCipher;break;case"aes192":i=24,p=16,m=a["aes192-CBC"],g=n.aes.createEncryptionCipher;break;case"aes256":i=32,p=16,m=a["aes256-CBC"],g=n.aes.createEncryptionCipher;break;case"des":i=8,p=8,m=a.desCBC,g=n.des.createEncryptionCipher;break;default:throw(S=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=r.algorithm,S}var v="hmacWith"+r.prfAlgorithm.toUpperCase(),y=f(v),b=n.pkcs5.pbkdf2(t,l,d,i,y),E=n.random.getBytesSync(p);(_=g(b)).start(E),_.update(o.toDer(e)),_.finish(),u=_.output.getBytes();var w=function(e,t,r,i){var a=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,e),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,t.getBytes())]);"hmacWithSHA1"!==i&&a.value.push(o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,n.util.hexToBytes(r.toString(16))),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(s.oids[i]).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]));return a}(l,h,i,v);c=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(a.pkcs5PBES2).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(a.pkcs5PBKDF2).getBytes()),w]),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(m).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,E)])])])}else{var S;if("3des"!==r.algorithm)throw(S=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=r.algorithm,S;i=24;var _,T=new n.util.ByteBuffer(l);b=s.pbe.generatePkcs12Key(t,T,1,d,i),E=s.pbe.generatePkcs12Key(t,T,2,d,i);(_=n.des.createEncryptionCipher(b)).start(E),_.update(o.toDer(e)),_.finish(),u=_.output.getBytes(),c=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(a["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,l),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,h.getBytes())])])}return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[c,o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,u)])},s.decryptPrivateKeyInfo=function(e,t){var r=null,i={},a=[];if(!o.validate(e,c,i,a)){var u=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw u.errors=a,u}var l=o.derToOid(i.encryptionOid),d=s.pbe.getCipher(l,i.encryptionParams,t),h=n.util.createBuffer(i.encryptedData);return d.update(h),d.finish()&&(r=o.fromDer(d.output)),r},s.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:o.toDer(e).getBytes()};return n.pem.encode(r,{maxline:t})},s.encryptedPrivateKeyFromPem=function(e){var t=n.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==t.type){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return o.fromDer(t.body)},s.encryptRsaPrivateKey=function(e,t,r){if(!(r=r||{}).legacy){var i=s.wrapRsaPrivateKey(s.privateKeyToAsn1(e));return i=s.encryptPrivateKeyInfo(i,t,r),s.encryptedPrivateKeyToPem(i)}var a,c,u,l;switch(r.algorithm){case"aes128":a="AES-128-CBC",u=16,c=n.random.getBytesSync(16),l=n.aes.createEncryptionCipher;break;case"aes192":a="AES-192-CBC",u=24,c=n.random.getBytesSync(16),l=n.aes.createEncryptionCipher;break;case"aes256":a="AES-256-CBC",u=32,c=n.random.getBytesSync(16),l=n.aes.createEncryptionCipher;break;case"3des":a="DES-EDE3-CBC",u=24,c=n.random.getBytesSync(8),l=n.des.createEncryptionCipher;break;case"des":a="DES-CBC",u=8,c=n.random.getBytesSync(8),l=n.des.createEncryptionCipher;break;default:var d=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw d.algorithm=r.algorithm,d}var h=l(n.pbe.opensslDeriveBytes(t,c.substr(0,8),u));h.start(c),h.update(o.toDer(s.privateKeyToAsn1(e))),h.finish();var f={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:a,parameters:n.util.bytesToHex(c).toUpperCase()},body:h.output.getBytes()};return n.pem.encode(f)},s.decryptRsaPrivateKey=function(e,t){var r=null,i=n.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==i.type&&"PRIVATE KEY"!==i.type&&"RSA PRIVATE KEY"!==i.type)throw(u=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".')).headerType=u,u;if(i.procType&&"ENCRYPTED"===i.procType.type){var a,c;switch(i.dekInfo.algorithm){case"DES-CBC":a=8,c=n.des.createDecryptionCipher;break;case"DES-EDE3-CBC":a=24,c=n.des.createDecryptionCipher;break;case"AES-128-CBC":a=16,c=n.aes.createDecryptionCipher;break;case"AES-192-CBC":a=24,c=n.aes.createDecryptionCipher;break;case"AES-256-CBC":a=32,c=n.aes.createDecryptionCipher;break;case"RC2-40-CBC":a=5,c=function(e){return n.rc2.createDecryptionCipher(e,40)};break;case"RC2-64-CBC":a=8,c=function(e){return n.rc2.createDecryptionCipher(e,64)};break;case"RC2-128-CBC":a=16,c=function(e){return n.rc2.createDecryptionCipher(e,128)};break;default:var u;throw(u=new Error('Could not decrypt private key; unsupported encryption algorithm "'+i.dekInfo.algorithm+'".')).algorithm=i.dekInfo.algorithm,u}var l=n.util.hexToBytes(i.dekInfo.parameters),d=c(n.pbe.opensslDeriveBytes(t,l.substr(0,8),a));if(d.start(l),d.update(n.util.createBuffer(i.body)),!d.finish())return r;r=d.output.getBytes()}else r=i.body;return null!==(r="ENCRYPTED PRIVATE KEY"===i.type?s.decryptPrivateKeyInfo(o.fromDer(r),t):o.fromDer(r))&&(r=s.privateKeyFromAsn1(r)),r},s.pbe.generatePkcs12Key=function(e,t,r,i,o,s){var a,c;if(null==s){if(!("sha1"in n.md))throw new Error('"sha1" hash algorithm unavailable.');s=n.md.sha1.create()}var u=s.digestLength,l=s.blockLength,d=new n.util.ByteBuffer,h=new n.util.ByteBuffer;if(null!=e){for(c=0;c<e.length;c++)h.putInt16(e.charCodeAt(c));h.putInt16(0)}var f=h.length(),p=t.length(),m=new n.util.ByteBuffer;m.fillWithByte(r,l);var g=l*Math.ceil(p/l),v=new n.util.ByteBuffer;for(c=0;c<g;c++)v.putByte(t.at(c%p));var y=l*Math.ceil(f/l),b=new n.util.ByteBuffer;for(c=0;c<y;c++)b.putByte(h.at(c%f));var E=v;E.putBuffer(b);for(var w=Math.ceil(o/u),S=1;S<=w;S++){var _=new n.util.ByteBuffer;_.putBytes(m.bytes()),_.putBytes(E.bytes());for(var T=0;T<i;T++)s.start(),s.update(_.getBytes()),_=s.digest();var x=new n.util.ByteBuffer;for(c=0;c<l;c++)x.putByte(_.at(c%u));var A=Math.ceil(p/l)+Math.ceil(f/l),I=new n.util.ByteBuffer;for(a=0;a<A;a++){var C=new n.util.ByteBuffer(E.getBytes(l)),R=511;for(c=x.length()-1;c>=0;c--)R>>=8,R+=x.at(c)+C.at(c),C.setAt(c,255&R);I.putBuffer(C)}E=I,d.putBuffer(_)}return d.truncate(d.length()-o),d},s.pbe.getCipher=function(e,t,r){switch(e){case s.oids.pkcs5PBES2:return s.pbe.getCipherForPBES2(e,t,r);case s.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case s.oids["pbewithSHAAnd40BitRC2-CBC"]:return s.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}},s.pbe.getCipherForPBES2=function(e,t,r){var i,a={},c=[];if(!o.validate(t,u,a,c))throw(i=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=c,i;if((e=o.derToOid(a.kdfOid))!==s.oids.pkcs5PBKDF2)throw(i=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.")).oid=e,i.supportedOids=["pkcs5PBKDF2"],i;if((e=o.derToOid(a.encOid))!==s.oids["aes128-CBC"]&&e!==s.oids["aes192-CBC"]&&e!==s.oids["aes256-CBC"]&&e!==s.oids["des-EDE3-CBC"]&&e!==s.oids.desCBC)throw(i=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.")).oid=e,i.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],i;var l,d,f=a.kdfSalt,p=n.util.createBuffer(a.kdfIterationCount);switch(p=p.getInt(p.length()<<3),s.oids[e]){case"aes128-CBC":l=16,d=n.aes.createDecryptionCipher;break;case"aes192-CBC":l=24,d=n.aes.createDecryptionCipher;break;case"aes256-CBC":l=32,d=n.aes.createDecryptionCipher;break;case"des-EDE3-CBC":l=24,d=n.des.createDecryptionCipher;break;case"desCBC":l=8,d=n.des.createDecryptionCipher}var m=h(a.prfOid),g=n.pkcs5.pbkdf2(r,f,p,l,m),v=a.encIv,y=d(g);return y.start(v),y},s.pbe.getCipherForPKCS12PBE=function(e,t,r){var i={},a=[];if(!o.validate(t,l,i,a))throw(m=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=a,m;var c,u,d,f=n.util.createBuffer(i.salt),p=n.util.createBuffer(i.iterations);switch(p=p.getInt(p.length()<<3),e){case s.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,u=8,d=n.des.startDecrypting;break;case s.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,u=8,d=function(e,t){var r=n.rc2.createDecryptionCipher(e,40);return r.start(t,null),r};break;default:var m;throw(m=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.")).oid=e,m}var g=h(i.prfOid),v=s.pbe.generatePkcs12Key(r,f,1,p,c,g);return g.start(),d(v,s.pbe.generatePkcs12Key(r,f,2,p,u,g))},s.pbe.opensslDeriveBytes=function(e,t,r,i){if(null==i){if(!("md5"in n.md))throw new Error('"md5" hash algorithm unavailable.');i=n.md.md5.create()}null===t&&(t="");for(var o=[d(i,e+t)],s=16,a=1;s<r;++a,s+=16)o.push(d(i,o[a-1]+e+t));return o.join("").substr(0,r)}},98960:(e,t,r)=>{var n=r(3832);r(36607),r(28991),r(97116);var i,o=n.pkcs5=n.pkcs5||{};n.util.isNodejs&&!n.options.usePureJavaScript&&(i=r(25819)),e.exports=n.pbkdf2=o.pbkdf2=function(e,t,r,o,s,a){if("function"==typeof s&&(a=s,s=null),n.util.isNodejs&&!n.options.usePureJavaScript&&i.pbkdf2&&(null===s||"object"!=typeof s)&&(i.pbkdf2Sync.length>4||!s||"sha1"===s))return"string"!=typeof s&&(s="sha1"),e=Buffer.from(e,"binary"),t=Buffer.from(t,"binary"),a?4===i.pbkdf2Sync.length?i.pbkdf2(e,t,r,o,(function(e,t){if(e)return a(e);a(null,t.toString("binary"))})):i.pbkdf2(e,t,r,o,s,(function(e,t){if(e)return a(e);a(null,t.toString("binary"))})):4===i.pbkdf2Sync.length?i.pbkdf2Sync(e,t,r,o).toString("binary"):i.pbkdf2Sync(e,t,r,o,s).toString("binary");if(null==s&&(s="sha1"),"string"==typeof s){if(!(s in n.md.algorithms))throw new Error("Unknown hash algorithm: "+s);s=n.md[s].create()}var c=s.digestLength;if(o>4294967295*c){var u=new Error("Derived key is too long.");if(a)return a(u);throw u}var l=Math.ceil(o/c),d=o-(l-1)*c,h=n.hmac.create();h.start(s,e);var f,p,m,g="";if(!a){for(var v=1;v<=l;++v){h.start(null,null),h.update(t),h.update(n.util.int32ToBytes(v)),f=m=h.digest().getBytes();for(var y=2;y<=r;++y)h.start(null,null),h.update(m),p=h.digest().getBytes(),f=n.util.xorBytes(f,p,c),m=p;g+=v<l?f:f.substr(0,d)}return g}v=1;function b(){if(v>l)return a(null,g);h.start(null,null),h.update(t),h.update(n.util.int32ToBytes(v)),f=m=h.digest().getBytes(),y=2,E()}function E(){if(y<=r)return h.start(null,null),h.update(m),p=h.digest().getBytes(),f=n.util.xorBytes(f,p,c),m=p,++y,n.util.setImmediate(E);g+=v<l?f:f.substr(0,d),++v,b()}b()}},26953:(e,t,r)=>{var n=r(3832);r(97116);var i=e.exports=n.pem=n.pem||{};function o(e){for(var t=e.name+": ",r=[],n=function(e,t){return" "+t},i=0;i<e.values.length;++i)r.push(e.values[i].replace(/^(\S+\r\n)/,n));t+=r.join(",")+"\r\n";var o=0,s=-1;for(i=0;i<t.length;++i,++o)if(o>65&&-1!==s){var a=t[s];","===a?(++s,t=t.substr(0,s)+"\r\n "+t.substr(s)):t=t.substr(0,s)+"\r\n"+a+t.substr(s+1),o=i-s-1,s=-1,++i}else" "!==t[i]&&"\t"!==t[i]&&","!==t[i]||(s=i);return t}function s(e){return e.replace(/^\s+/,"")}i.encode=function(e,t){t=t||{};var r,i="-----BEGIN "+e.type+"-----\r\n";if(e.procType&&(i+=o(r={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]})),e.contentDomain&&(i+=o(r={name:"Content-Domain",values:[e.contentDomain]})),e.dekInfo&&(r={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&r.values.push(e.dekInfo.parameters),i+=o(r)),e.headers)for(var s=0;s<e.headers.length;++s)i+=o(e.headers[s]);return e.procType&&(i+="\r\n"),i+=n.util.encode64(e.body,t.maxline||64)+"\r\n",i+="-----END "+e.type+"-----\r\n"},i.decode=function(e){for(var t,r=[],i=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,o=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,a=/\r?\n/;t=i.exec(e);){var c=t[1];"NEW CERTIFICATE REQUEST"===c&&(c="CERTIFICATE REQUEST");var u={type:c,procType:null,contentDomain:null,dekInfo:null,headers:[],body:n.util.decode64(t[3])};if(r.push(u),t[2]){for(var l=t[2].split(a),d=0;t&&d<l.length;){for(var h=l[d].replace(/\s+$/,""),f=d+1;f<l.length;++f){var p=l[f];if(!/\s/.test(p[0]))break;h+=p,d=f}if(t=h.match(o)){for(var m={name:t[1],values:[]},g=t[2].split(","),v=0;v<g.length;++v)m.values.push(s(g[v]));if(u.procType)if(u.contentDomain||"Content-Domain"!==m.name)if(u.dekInfo||"DEK-Info"!==m.name)u.headers.push(m);else{if(0===m.values.length)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');u.dekInfo={algorithm:g[0],parameters:g[1]||null}}else u.contentDomain=g[0]||"";else{if("Proc-Type"!==m.name)throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==m.values.length)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');u.procType={version:g[0],type:g[1]}}}++d}if("ENCRYPTED"===u.procType&&!u.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(0===r.length)throw new Error("Invalid PEM formatted message.");return r}},18936:(e,t,r)=>{var n=r(3832);r(97116),r(49563),r(137);var i=e.exports=n.pkcs1=n.pkcs1||{};function o(e,t,r){r||(r=n.md.sha1.create());for(var i="",o=Math.ceil(t/r.digestLength),s=0;s<o;++s){var a=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,255&s);r.start(),r.update(e+a),i+=r.digest().getBytes()}return i.substring(0,t)}i.encode_rsa_oaep=function(e,t,r){var i,s,a,c;"string"==typeof r?(i=r,s=arguments[3]||void 0,a=arguments[4]||void 0):r&&(i=r.label||void 0,s=r.seed||void 0,a=r.md||void 0,r.mgf1&&r.mgf1.md&&(c=r.mgf1.md)),a?a.start():a=n.md.sha1.create(),c||(c=a);var u=Math.ceil(e.n.bitLength()/8),l=u-2*a.digestLength-2;if(t.length>l)throw(g=new Error("RSAES-OAEP input message length is too long.")).length=t.length,g.maxLength=l,g;i||(i=""),a.update(i,"raw");for(var d=a.digest(),h="",f=l-t.length,p=0;p<f;p++)h+="\0";var m=d.getBytes()+h+""+t;if(s){if(s.length!==a.digestLength){var g;throw(g=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.")).seedLength=s.length,g.digestLength=a.digestLength,g}}else s=n.random.getBytes(a.digestLength);var v=o(s,u-a.digestLength-1,c),y=n.util.xorBytes(m,v,m.length),b=o(y,a.digestLength,c);return"\0"+n.util.xorBytes(s,b,s.length)+y},i.decode_rsa_oaep=function(e,t,r){var i,s,a;"string"==typeof r?(i=r,s=arguments[3]||void 0):r&&(i=r.label||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md));var c=Math.ceil(e.n.bitLength()/8);if(t.length!==c)throw(v=new Error("RSAES-OAEP encoded message length is invalid.")).length=t.length,v.expectedLength=c,v;if(void 0===s?s=n.md.sha1.create():s.start(),a||(a=s),c<2*s.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");i||(i=""),s.update(i,"raw");for(var u=s.digest().getBytes(),l=t.charAt(0),d=t.substring(1,s.digestLength+1),h=t.substring(1+s.digestLength),f=o(h,s.digestLength,a),p=o(n.util.xorBytes(d,f,d.length),c-s.digestLength-1,a),m=n.util.xorBytes(h,p,h.length),g=m.substring(0,s.digestLength),v="\0"!==l,y=0;y<s.digestLength;++y)v|=u.charAt(y)!==g.charAt(y);for(var b=1,E=s.digestLength,w=s.digestLength;w<m.length;w++){var S=m.charCodeAt(w);v|=S&(b?65534:0),E+=b&=1&S^1}if(v||1!==m.charCodeAt(E))throw new Error("Invalid RSAES-OAEP padding.");return m.substring(E+1)}},55147:(e,t,r)=>{var n=r(3832);r(3068),r(36607),r(66270),r(95496),r(97450),r(49563),r(28095),r(137),r(97116),r(25414);var i=n.asn1,o=n.pki,s=e.exports=n.pkcs12=n.pkcs12||{},a={name:"ContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:i.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},c={name:"PFX",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},a,{name:"PFX.macData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:i.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},u={name:"SafeBag",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:i.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},l={name:"Attribute",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,capture:"values"}]},d={name:"CertBag",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:i.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:i.Class.UNIVERSAL,type:i.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function h(e,t,r,n){for(var i=[],o=0;o<e.length;o++)for(var s=0;s<e[o].safeBags.length;s++){var a=e[o].safeBags[s];void 0!==n&&a.type!==n||(null!==t?void 0!==a.attributes[t]&&a.attributes[t].indexOf(r)>=0&&i.push(a):i.push(a))}return i}function f(e){if(e.composed||e.constructed){for(var t=n.util.createBuffer(),r=0;r<e.value.length;++r)t.putBytes(e.value[r].value);e.composed=e.constructed=!1,e.value=t.getBytes()}return e}function p(e,t){var r={},s=[];if(!i.validate(e,n.pkcs7.asn1.encryptedDataValidator,r,s))throw(a=new Error("Cannot read EncryptedContentInfo.")).errors=s,a;var a,c=i.derToOid(r.contentType);if(c!==o.oids.data)throw(a=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.")).oid=c,a;c=i.derToOid(r.encAlgorithm);var u=o.pbe.getCipher(c,r.encParameter,t),l=f(r.encryptedContentAsn1),d=n.util.createBuffer(l.value);if(u.update(d),!u.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return u.output.getBytes()}function m(e,t,r){if(!t&&0===e.length)return[];if((e=i.fromDer(e,t)).tagClass!==i.Class.UNIVERSAL||e.type!==i.Type.SEQUENCE||!0!==e.constructed)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var n=[],s=0;s<e.value.length;s++){var a=e.value[s],c={},l=[];if(!i.validate(a,u,c,l))throw(v=new Error("Cannot read SafeBag.")).errors=l,v;var h,f,p={type:i.derToOid(c.bagId),attributes:g(c.bagAttributes)};n.push(p);var m=c.bagValue.value[0];switch(p.type){case o.oids.pkcs8ShroudedKeyBag:if(null===(m=o.decryptPrivateKeyInfo(m,r)))throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case o.oids.keyBag:try{p.key=o.privateKeyFromAsn1(m)}catch(e){p.key=null,p.asn1=m}continue;case o.oids.certBag:h=d,f=function(){if(i.derToOid(c.certId)!==o.oids.x509Certificate){var e=new Error("Unsupported certificate type, only X.509 supported.");throw e.oid=i.derToOid(c.certId),e}var r=i.fromDer(c.cert,t);try{p.cert=o.certificateFromAsn1(r,!0)}catch(e){p.cert=null,p.asn1=r}};break;default:var v;throw(v=new Error("Unsupported PKCS#12 SafeBag type.")).oid=p.type,v}if(void 0!==h&&!i.validate(m,h,c,l))throw(v=new Error("Cannot read PKCS#12 "+h.name)).errors=l,v;f()}return n}function g(e){var t={};if(void 0!==e)for(var r=0;r<e.length;++r){var n={},s=[];if(!i.validate(e[r],l,n,s)){var a=new Error("Cannot read PKCS#12 BagAttribute.");throw a.errors=s,a}var c=i.derToOid(n.oid);if(void 0!==o.oids[c]){t[o.oids[c]]=[];for(var u=0;u<n.values.length;++u)t[o.oids[c]].push(n.values[u].value)}}return t}s.pkcs12FromAsn1=function(e,t,r){"string"==typeof t?(r=t,t=!0):void 0===t&&(t=!0);var u={};if(!i.validate(e,c,u,[]))throw(l=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.")).errors=l,l;var l,d={version:u.version.charCodeAt(0),safeContents:[],getBags:function(e){var t,r={};return"localKeyId"in e?t=e.localKeyId:"localKeyIdHex"in e&&(t=n.util.hexToBytes(e.localKeyIdHex)),void 0===t&&!("friendlyName"in e)&&"bagType"in e&&(r[e.bagType]=h(d.safeContents,null,null,e.bagType)),void 0!==t&&(r.localKeyId=h(d.safeContents,"localKeyId",t,e.bagType)),"friendlyName"in e&&(r.friendlyName=h(d.safeContents,"friendlyName",e.friendlyName,e.bagType)),r},getBagsByFriendlyName:function(e,t){return h(d.safeContents,"friendlyName",e,t)},getBagsByLocalKeyId:function(e,t){return h(d.safeContents,"localKeyId",e,t)}};if(3!==u.version.charCodeAt(0))throw(l=new Error("PKCS#12 PFX of version other than 3 not supported.")).version=u.version.charCodeAt(0),l;if(i.derToOid(u.contentType)!==o.oids.data)throw(l=new Error("Only PKCS#12 PFX in password integrity mode supported.")).oid=i.derToOid(u.contentType),l;var g=u.content.value[0];if(g.tagClass!==i.Class.UNIVERSAL||g.type!==i.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(g=f(g),u.mac){var v=null,y=0,b=i.derToOid(u.macAlgorithm);switch(b){case o.oids.sha1:v=n.md.sha1.create(),y=20;break;case o.oids.sha256:v=n.md.sha256.create(),y=32;break;case o.oids.sha384:v=n.md.sha384.create(),y=48;break;case o.oids.sha512:v=n.md.sha512.create(),y=64;break;case o.oids.md5:v=n.md.md5.create(),y=16}if(null===v)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+b);var E=new n.util.ByteBuffer(u.macSalt),w="macIterations"in u?parseInt(n.util.bytesToHex(u.macIterations),16):1,S=s.generateKey(r,E,3,w,y,v),_=n.hmac.create();if(_.start(v,S),_.update(g.value),_.getMac().getBytes()!==u.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return function(e,t,r,n){if(t=i.fromDer(t,r),t.tagClass!==i.Class.UNIVERSAL||t.type!==i.Type.SEQUENCE||!0!==t.constructed)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var s=0;s<t.value.length;s++){var c=t.value[s],u={},l=[];if(!i.validate(c,a,u,l))throw(v=new Error("Cannot read ContentInfo.")).errors=l,v;var d={encrypted:!1},h=null,g=u.content.value[0];switch(i.derToOid(u.contentType)){case o.oids.data:if(g.tagClass!==i.Class.UNIVERSAL||g.type!==i.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");h=f(g).value;break;case o.oids.encryptedData:h=p(g,n),d.encrypted=!0;break;default:var v;throw(v=new Error("Unsupported PKCS#12 contentType.")).contentType=i.derToOid(u.contentType),v}d.safeBags=m(h,r,n),e.safeContents.push(d)}}(d,g.value,t,r),d},s.toPkcs12Asn1=function(e,t,r,a){(a=a||{}).saltSize=a.saltSize||8,a.count=a.count||2048,a.algorithm=a.algorithm||a.encAlgorithm||"aes128","useMac"in a||(a.useMac=!0),"localKeyId"in a||(a.localKeyId=null),"generateLocalKeyId"in a||(a.generateLocalKeyId=!0);var c,u=a.localKeyId;if(null!==u)u=n.util.hexToBytes(u);else if(a.generateLocalKeyId)if(t){var l=n.util.isArray(t)?t[0]:t;"string"==typeof l&&(l=o.certificateFromPem(l)),(I=n.md.sha1.create()).update(i.toDer(o.certificateToAsn1(l)).getBytes()),u=I.digest().getBytes()}else u=n.random.getBytes(20);var d=[];null!==u&&d.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.localKeyId).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,u)])])),"friendlyName"in a&&d.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.friendlyName).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,i.Type.BMPSTRING,!1,a.friendlyName)])])),d.length>0&&(c=i.create(i.Class.UNIVERSAL,i.Type.SET,!0,d));var h=[],f=[];null!==t&&(f=n.util.isArray(t)?t:[t]);for(var p=[],m=0;m<f.length;++m){"string"==typeof(t=f[m])&&(t=o.certificateFromPem(t));var g=0===m?c:void 0,v=o.certificateToAsn1(t),y=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.certBag).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.x509Certificate).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(v).getBytes())])])]),g]);p.push(y)}if(p.length>0){var b=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,p),E=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.data).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(b).getBytes())])]);h.push(E)}var w=null;if(null!==e){var S=o.wrapRsaPrivateKey(o.privateKeyToAsn1(e));w=null===r?i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.keyBag).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[S]),c]):i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.pkcs8ShroudedKeyBag).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[o.encryptPrivateKeyInfo(S,r,a)]),c]);var _=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[w]),T=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.data).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(_).getBytes())])]);h.push(T)}var x,A=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,h);if(a.useMac){var I=n.md.sha1.create(),C=new n.util.ByteBuffer(n.random.getBytes(a.saltSize)),R=a.count,k=(e=s.generateKey(r,C,3,R,20),n.hmac.create());k.start(I,e),k.update(i.toDer(A).getBytes());var O=k.getMac();x=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.sha1).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,O.getBytes())]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,C.getBytes()),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(R).getBytes())])}return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(3).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids.data).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(A).getBytes())])]),x])},s.generateKey=n.pbe.generatePkcs12Key},79437:(e,t,r)=>{var n=r(3832);r(8925),r(3068),r(33480),r(66270),r(26953),r(95496),r(49563),r(97116),r(25414);var i=n.asn1,o=e.exports=n.pkcs7=n.pkcs7||{};function s(e){var t={},r=[];if(!i.validate(e,o.asn1.recipientInfoValidator,t,r)){var s=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw s.errors=r,s}return{version:t.version.charCodeAt(0),issuer:n.pki.RDNAttributesAsArray(t.issuer),serialNumber:n.util.createBuffer(t.serial).toHex(),encryptedContent:{algorithm:i.derToOid(t.encAlgorithm),parameter:t.encParameter?t.encParameter.value:void 0,content:t.encKey}}}function a(e){for(var t,r=[],o=0;o<e.length;++o)r.push((t=e[o],i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(t.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[n.pki.distinguishedNameToAsn1({attributes:t.issuer}),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,n.util.hexToBytes(t.serialNumber))]),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.encryptedContent.algorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,t.encryptedContent.content)])));return r}function c(e){var t=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[n.pki.distinguishedNameToAsn1({attributes:e.issuer}),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,n.util.hexToBytes(e.serialNumber))]),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.digestAlgorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])]);if(e.authenticatedAttributesAsn1&&t.value.push(e.authenticatedAttributesAsn1),t.value.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.signatureAlgorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])),t.value.push(i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,e.signature)),e.unauthenticatedAttributes.length>0){for(var r=i.create(i.Class.CONTEXT_SPECIFIC,1,!0,[]),o=0;o<e.unauthenticatedAttributes.length;++o){var s=e.unauthenticatedAttributes[o];r.values.push(u(s))}t.value.push(r)}return t}function u(e){var t;if(e.type===n.pki.oids.contentType)t=i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.value).getBytes());else if(e.type===n.pki.oids.messageDigest)t=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,e.value.bytes());else if(e.type===n.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),o=new Date("2050-01-01T00:00:00Z"),s=e.value;if("string"==typeof s){var a=Date.parse(s);s=isNaN(a)?13===s.length?i.utcTimeToDate(s):i.generalizedTimeToDate(s):new Date(a)}t=s>=r&&s<o?i.create(i.Class.UNIVERSAL,i.Type.UTCTIME,!1,i.dateToUtcTime(s)):i.create(i.Class.UNIVERSAL,i.Type.GENERALIZEDTIME,!1,i.dateToGeneralizedTime(s))}return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.type).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[t])])}function l(e,t,r){var o={};if(!i.validate(t,r,o,[])){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s}if(i.derToOid(o.contentType)!==n.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(o.encryptedContent){var a="";if(n.util.isArray(o.encryptedContent))for(var c=0;c<o.encryptedContent.length;++c){if(o.encryptedContent[c].type!==i.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");a+=o.encryptedContent[c].value}else a=o.encryptedContent;e.encryptedContent={algorithm:i.derToOid(o.encAlgorithm),parameter:n.util.createBuffer(o.encParameter.value),content:n.util.createBuffer(a)}}if(o.content){a="";if(n.util.isArray(o.content))for(c=0;c<o.content.length;++c){if(o.content[c].type!==i.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");a+=o.content[c].value}else a=o.content;e.content=n.util.createBuffer(a)}return e.version=o.version.charCodeAt(0),e.rawCapture=o,o}function d(e){if(void 0===e.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===e.content){var t;switch(e.encryptedContent.algorithm){case n.pki.oids["aes128-CBC"]:case n.pki.oids["aes192-CBC"]:case n.pki.oids["aes256-CBC"]:t=n.aes.createDecryptionCipher(e.encryptedContent.key);break;case n.pki.oids.desCBC:case n.pki.oids["des-EDE3-CBC"]:t=n.des.createDecryptionCipher(e.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+e.encryptedContent.algorithm)}if(t.start(e.encryptedContent.parameter),t.update(e.encryptedContent.content),!t.finish())throw new Error("Symmetric decryption failed.");e.content=t.output}}o.messageFromPem=function(e){var t=n.pem.decode(e)[0];if("PKCS7"!==t.type){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var s=i.fromDer(t.body);return o.messageFromAsn1(s)},o.messageToPem=function(e,t){var r={type:"PKCS7",body:i.toDer(e.toAsn1()).getBytes()};return n.pem.encode(r,{maxline:t})},o.messageFromAsn1=function(e){var t={},r=[];if(!i.validate(e,o.asn1.contentInfoValidator,t,r)){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw s.errors=r,s}var a,c=i.derToOid(t.contentType);switch(c){case n.pki.oids.envelopedData:a=o.createEnvelopedData();break;case n.pki.oids.encryptedData:a=o.createEncryptedData();break;case n.pki.oids.signedData:a=o.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+c+" is not (yet) supported.")}return a.fromAsn1(t.content.value[0]),a},o.createSignedData=function(){var e=null;return e={type:n.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(t){if(l(e,t,o.asn1.signedDataValidator),e.certificates=[],e.crls=[],e.digestAlgorithmIdentifiers=[],e.contentInfo=null,e.signerInfos=[],e.rawCapture.certificates)for(var r=e.rawCapture.certificates.value,i=0;i<r.length;++i)e.certificates.push(n.pki.certificateFromAsn1(r[i]))},toAsn1:function(){e.contentInfo||e.sign();for(var t=[],r=0;r<e.certificates.length;++r)t.push(n.pki.certificateToAsn1(e.certificates[r]));var o=[],s=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,e.digestAlgorithmIdentifiers),e.contentInfo])]);return t.length>0&&s.value[0].value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,t)),o.length>0&&s.value[0].value.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,o)),s.value[0].value.push(i.create(i.Class.UNIVERSAL,i.Type.SET,!0,e.signerInfos)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.type).getBytes()),s])},addSigner:function(t){var r=t.issuer,i=t.serialNumber;if(t.certificate){var o=t.certificate;"string"==typeof o&&(o=n.pki.certificateFromPem(o)),r=o.issuer.attributes,i=o.serialNumber}var s=t.key;if(!s)throw new Error("Could not add PKCS#7 signer; no private key specified.");"string"==typeof s&&(s=n.pki.privateKeyFromPem(s));var a=t.digestAlgorithm||n.pki.oids.sha1;switch(a){case n.pki.oids.sha1:case n.pki.oids.sha256:case n.pki.oids.sha384:case n.pki.oids.sha512:case n.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+a)}var c=t.authenticatedAttributes||[];if(c.length>0){for(var u=!1,l=!1,d=0;d<c.length;++d){var h=c[d];if(u||h.type!==n.pki.oids.contentType){if(l||h.type!==n.pki.oids.messageDigest);else if(l=!0,u)break}else if(u=!0,l)break}if(!u||!l)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}e.signers.push({key:s,version:1,issuer:r,serialNumber:i,digestAlgorithm:a,signatureAlgorithm:n.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:c,unauthenticatedAttributes:[]})},sign:function(t){var r;(t=t||{},"object"!=typeof e.content||null===e.contentInfo)&&(e.contentInfo=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(n.pki.oids.data).getBytes())]),"content"in e&&(e.content instanceof n.util.ByteBuffer?r=e.content.bytes():"string"==typeof e.content&&(r=n.util.encodeUtf8(e.content)),t.detached?e.detachedContent=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,r):e.contentInfo.value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,r)]))));0!==e.signers.length&&function(t){var r;r=e.detachedContent?e.detachedContent:(r=e.contentInfo.value[1]).value[0];if(!r)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var o=i.derToOid(e.contentInfo.value[0].value),s=i.toDer(r);for(var a in s.getByte(),i.getBerValueLength(s),s=s.getBytes(),t)t[a].start().update(s);for(var l=new Date,d=0;d<e.signers.length;++d){var h=e.signers[d];if(0===h.authenticatedAttributes.length){if(o!==n.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{h.authenticatedAttributesAsn1=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var f=i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[]),p=0;p<h.authenticatedAttributes.length;++p){var m=h.authenticatedAttributes[p];m.type===n.pki.oids.messageDigest?m.value=t[h.digestAlgorithm].digest():m.type===n.pki.oids.signingTime&&(m.value||(m.value=l)),f.value.push(u(m)),h.authenticatedAttributesAsn1.value.push(u(m))}s=i.toDer(f).getBytes(),h.md.start().update(s)}h.signature=h.key.sign(h.md,"RSASSA-PKCS1-V1_5")}e.signerInfos=function(e){for(var t=[],r=0;r<e.length;++r)t.push(c(e[r]));return t}(e.signers)}(function(){for(var t={},r=0;r<e.signers.length;++r){var o=e.signers[r];(s=o.digestAlgorithm)in t||(t[s]=n.md[n.pki.oids[s]].create()),0===o.authenticatedAttributes.length?o.md=t[s]:o.md=n.md[n.pki.oids[s]].create()}for(var s in e.digestAlgorithmIdentifiers=[],t)e.digestAlgorithmIdentifiers.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(s).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")]));return t}())},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(t){"string"==typeof t&&(t=n.pki.certificateFromPem(t)),e.certificates.push(t)},addCertificateRevokationList:function(e){throw new Error("PKCS#7 CRL support not yet implemented.")}}},o.createEncryptedData=function(){var e=null;return e={type:n.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:n.pki.oids["aes256-CBC"]},fromAsn1:function(t){l(e,t,o.asn1.encryptedDataValidator)},decrypt:function(t){void 0!==t&&(e.encryptedContent.key=t),d(e)}}},o.createEnvelopedData=function(){var e=null;return e={type:n.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:n.pki.oids["aes256-CBC"]},fromAsn1:function(t){var r=l(e,t,o.asn1.envelopedDataValidator);e.recipients=function(e){for(var t=[],r=0;r<e.length;++r)t.push(s(e[r]));return t}(r.recipientInfos.value)},toAsn1:function(){return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.type).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,a(e.recipients)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,(t=e.encryptedContent,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(n.pki.oids.data).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.algorithm).getBytes()),t.parameter?i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,t.parameter.getBytes()):void 0]),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,t.content.getBytes())])]))])])]);var t},findRecipient:function(t){for(var r=t.issuer.attributes,n=0;n<e.recipients.length;++n){var i=e.recipients[n],o=i.issuer;if(i.serialNumber===t.serialNumber&&o.length===r.length){for(var s=!0,a=0;a<r.length;++a)if(o[a].type!==r[a].type||o[a].value!==r[a].value){s=!1;break}if(s)return i}}return null},decrypt:function(t,r){if(void 0===e.encryptedContent.key&&void 0!==t&&void 0!==r)switch(t.encryptedContent.algorithm){case n.pki.oids.rsaEncryption:case n.pki.oids.desCBC:var i=r.decrypt(t.encryptedContent.content);e.encryptedContent.key=n.util.createBuffer(i);break;default:throw new Error("Unsupported asymmetric cipher, OID "+t.encryptedContent.algorithm)}d(e)},addRecipient:function(t){e.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:n.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,r){if(void 0===e.encryptedContent.content){var i,o,s;switch(r=r||e.encryptedContent.algorithm,t=t||e.encryptedContent.key,r){case n.pki.oids["aes128-CBC"]:i=16,o=16,s=n.aes.createEncryptionCipher;break;case n.pki.oids["aes192-CBC"]:i=24,o=16,s=n.aes.createEncryptionCipher;break;case n.pki.oids["aes256-CBC"]:i=32,o=16,s=n.aes.createEncryptionCipher;break;case n.pki.oids["des-EDE3-CBC"]:i=24,o=8,s=n.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(void 0===t)t=n.util.createBuffer(n.random.getBytes(i));else if(t.length()!=i)throw new Error("Symmetric key has wrong length; got "+t.length()+" bytes, expected "+i+".");e.encryptedContent.algorithm=r,e.encryptedContent.key=t,e.encryptedContent.parameter=n.util.createBuffer(n.random.getBytes(o));var a=s(t);if(a.start(e.encryptedContent.parameter.copy()),a.update(e.content),!a.finish())throw new Error("Symmetric encryption failed.");e.encryptedContent.content=a.output}for(var c=0;c<e.recipients.length;++c){var u=e.recipients[c];if(void 0===u.encryptedContent.content){if(u.encryptedContent.algorithm!==n.pki.oids.rsaEncryption)throw new Error("Unsupported asymmetric cipher, OID "+u.encryptedContent.algorithm);u.encryptedContent.content=u.encryptedContent.key.encrypt(e.encryptedContent.key.data)}}}}}},95496:(e,t,r)=>{var n=r(3832);r(3068),r(97116);var i=n.asn1,o=e.exports=n.pkcs7asn1=n.pkcs7asn1||{};n.pkcs7=n.pkcs7||{},n.pkcs7.asn1=o;var s={name:"ContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};o.contentInfoValidator=s;var a={name:"EncryptedContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};o.envelopedDataValidator={name:"EnvelopedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(a)},o.encryptedDataValidator={name:"EncryptedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"}].concat(a)};var c={name:"SignerInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};o.signedDataValidator={name:"SignedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},s,{name:"SignedData.Certificates",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,capture:"signerInfos",optional:!0,value:[c]}]},o.recipientInfoValidator={name:"RecipientInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}},4742:(e,t,r)=>{var n=r(3832);r(3068),r(66270),r(97450),r(26953),r(98960),r(55147),r(96007),r(28095),r(97116),r(25414);var i=n.asn1,o=e.exports=n.pki=n.pki||{};o.pemToDer=function(e){var t=n.pem.decode(e)[0];if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert PEM to DER; PEM is encrypted.");return n.util.createBuffer(t.body)},o.privateKeyFromPem=function(e){var t=n.pem.decode(e)[0];if("PRIVATE KEY"!==t.type&&"RSA PRIVATE KEY"!==t.type){var r=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert private key from PEM; PEM is encrypted.");var s=i.fromDer(t.body);return o.privateKeyFromAsn1(s)},o.privateKeyToPem=function(e,t){var r={type:"RSA PRIVATE KEY",body:i.toDer(o.privateKeyToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},o.privateKeyInfoToPem=function(e,t){var r={type:"PRIVATE KEY",body:i.toDer(e).getBytes()};return n.pem.encode(r,{maxline:t})}},29654:(e,t,r)=>{var n=r(3832);r(97116),r(15764),r(49563),function(){if(n.prime)e.exports=n.prime;else{var t=e.exports=n.prime=n.prime||{},r=n.jsbn.BigInteger,i=[6,4,2,4,2,4,6,2],o=new r(null);o.fromInt(30);var s=function(e,t){return e|t};t.generateProbablePrime=function(e,t,i){"function"==typeof t&&(i=t,t={});var o=(t=t||{}).algorithm||"PRIMEINC";"string"==typeof o&&(o={name:o}),o.options=o.options||{};var s=t.prng||n.random,c={nextBytes:function(e){for(var t=s.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}};if("PRIMEINC"===o.name)return function(e,t,i,o){if("workers"in i)return function(e,t,i,o){if("undefined"==typeof Worker)return a(e,t,i,o);var s=u(e,t),c=i.workers,l=i.workLoad||100,d=30*l/8,h=i.workerScript||"forge/prime.worker.js";if(-1===c)return n.util.estimateCores((function(e,t){e&&(t=2),c=t-1,f()}));function f(){c=Math.max(1,c);for(var n=[],i=0;i<c;++i)n[i]=new Worker(h);for(i=0;i<c;++i)n[i].addEventListener("message",f);var a=!1;function f(i){if(!a){0;var c=i.data;if(c.found){for(var h=0;h<n.length;++h)n[h].terminate();return a=!0,o(null,new r(c.prime,16))}s.bitLength()>e&&(s=u(e,t));var f=s.toString(16);i.target.postMessage({hex:f,workLoad:l}),s.dAddOffset(d,0)}}}f()}(e,t,i,o);return a(e,t,i,o)}(e,c,o.options,i);throw new Error("Invalid prime generation algorithm: "+o.name)}}function a(e,t,r,n){var i=u(e,t),o=function(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}(i.bitLength());"millerRabinTests"in r&&(o=r.millerRabinTests);var s=10;"maxBlockTime"in r&&(s=r.maxBlockTime),c(i,e,t,0,o,s,n)}function c(e,t,r,o,s,a,l){var d=+new Date;do{if(e.bitLength()>t&&(e=u(t,r)),e.isProbablePrime(s))return l(null,e);e.dAddOffset(i[o++%8],0)}while(a<0||+new Date-d<a);n.util.setImmediate((function(){c(e,t,r,o,s,a,l)}))}function u(e,t){var n=new r(e,t),i=e-1;return n.testBit(i)||n.bitwiseTo(r.ONE.shiftLeft(i),s,n),n.dAddOffset(31-n.mod(o).byteValue(),0),n}}()},74933:(e,t,r)=>{var n=r(34155),i=r(3832);r(97116);var o=null;!i.util.isNodejs||i.options.usePureJavaScript||n.versions["node-webkit"]||(o=r(25819)),(e.exports=i.prng=i.prng||{}).create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=e.md,n=new Array(32),s=0;s<32;++s)n[s]=r.create();function a(){if(t.pools[0].messageLength>=32)return c();var e=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(e)),c()}function c(){t.reseeds=4294967295===t.reseeds?0:t.reseeds+1;var e=t.plugin.md.create();e.update(t.keyBytes);for(var r=1,n=0;n<32;++n)t.reseeds%r==0&&(e.update(t.pools[n].digest().getBytes()),t.pools[n].start()),r<<=1;t.keyBytes=e.digest().getBytes(),e.start(),e.update(t.keyBytes);var i=e.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(i),t.generated=0}function u(e){var t=null,r=i.util.globalScope,n=r.crypto||r.msCrypto;n&&n.getRandomValues&&(t=function(e){return n.getRandomValues(e)});var o=i.util.createBuffer();if(t)for(;o.length()<e;){var s=Math.max(1,Math.min(e-o.length(),65536)/4),a=new Uint32Array(Math.floor(s));try{t(a);for(var c=0;c<a.length;++c)o.putInt32(a[c])}catch(e){if(!("undefined"!=typeof QuotaExceededError&&e instanceof QuotaExceededError))throw e}}if(o.length()<e)for(var u,l,d,h=Math.floor(65536*Math.random());o.length()<e;){l=16807*(65535&h),l+=(32767&(u=16807*(h>>16)))<<16,h=4294967295&(l=(2147483647&(l+=u>>15))+(l>>31));for(c=0;c<3;++c)d=h>>>(c<<3),d^=Math.floor(256*Math.random()),o.putByte(255&d)}return o.getBytes(e)}return t.pools=n,t.pool=0,t.generate=function(e,r){if(!r)return t.generateSync(e);var n=t.plugin.cipher,o=t.plugin.increment,s=t.plugin.formatKey,a=t.plugin.formatSeed,u=i.util.createBuffer();t.key=null,function l(d){if(d)return r(d);if(u.length()>=e)return r(null,u.getBytes(e));t.generated>1048575&&(t.key=null);if(null===t.key)return i.util.nextTick((function(){!function(e){if(t.pools[0].messageLength>=32)return c(),e();var r=32-t.pools[0].messageLength<<5;t.seedFile(r,(function(r,n){if(r)return e(r);t.collect(n),c(),e()}))}(l)}));var h=n(t.key,t.seed);t.generated+=h.length,u.putBytes(h),t.key=s(n(t.key,o(t.seed))),t.seed=a(n(t.key,t.seed)),i.util.setImmediate(l)}()},t.generateSync=function(e){var r=t.plugin.cipher,n=t.plugin.increment,o=t.plugin.formatKey,s=t.plugin.formatSeed;t.key=null;for(var c=i.util.createBuffer();c.length()<e;){t.generated>1048575&&(t.key=null),null===t.key&&a();var u=r(t.key,t.seed);t.generated+=u.length,c.putBytes(u),t.key=o(r(t.key,n(t.seed))),t.seed=s(r(t.key,t.seed))}return c.getBytes(e)},o?(t.seedFile=function(e,t){o.randomBytes(e,(function(e,r){if(e)return t(e);t(null,r.toString())}))},t.seedFileSync=function(e){return o.randomBytes(e).toString()}):(t.seedFile=function(e,t){try{t(null,u(e))}catch(e){t(e)}},t.seedFileSync=u),t.collect=function(e){for(var r=e.length,n=0;n<r;++n)t.pools[t.pool].update(e.substr(n,1)),t.pool=31===t.pool?0:t.pool+1},t.collectInt=function(e,r){for(var n="",i=0;i<r;i+=8)n+=String.fromCharCode(e>>i&255);t.collect(n)},t.registerWorker=function(e){if(e===self)t.seedFile=function(e,t){self.addEventListener("message",(function e(r){var n=r.data;n.forge&&n.forge.prng&&(self.removeEventListener("message",e),t(n.forge.prng.err,n.forge.prng.bytes))})),self.postMessage({forge:{prng:{needed:e}}})};else{e.addEventListener("message",(function(r){var n=r.data;n.forge&&n.forge.prng&&t.seedFile(n.forge.prng.needed,(function(t,r){e.postMessage({forge:{prng:{err:t,bytes:r}}})}))}))}},t}},96007:(e,t,r)=>{var n=r(3832);r(49563),r(97116),(e.exports=n.pss=n.pss||{}).create=function(e){3===arguments.length&&(e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var t,r=e.md,i=e.mgf,o=r.digestLength,s=e.salt||null;if("string"==typeof s&&(s=n.util.createBuffer(s)),"saltLength"in e)t=e.saltLength;else{if(null===s)throw new Error("Salt length not specified or specific salt not given.");t=s.length()}if(null!==s&&s.length()!==t)throw new Error("Given salt length does not match length of given salt.");var a=e.prng||n.random,c={encode:function(e,c){var u,l,d=c-1,h=Math.ceil(d/8),f=e.digest().getBytes();if(h<o+t+2)throw new Error("Message is too long to encrypt.");l=null===s?a.getBytesSync(t):s.bytes();var p=new n.util.ByteBuffer;p.fillWithByte(0,8),p.putBytes(f),p.putBytes(l),r.start(),r.update(p.getBytes());var m=r.digest().getBytes(),g=new n.util.ByteBuffer;g.fillWithByte(0,h-t-o-2),g.putByte(1),g.putBytes(l);var v=g.getBytes(),y=h-o-1,b=i.generate(m,y),E="";for(u=0;u<y;u++)E+=String.fromCharCode(v.charCodeAt(u)^b.charCodeAt(u));var w=65280>>8*h-d&255;return(E=String.fromCharCode(E.charCodeAt(0)&~w)+E.substr(1))+m+String.fromCharCode(188)},verify:function(e,s,a){var c,u=a-1,l=Math.ceil(u/8);if(s=s.substr(-l),l<o+t+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(188!==s.charCodeAt(l-1))throw new Error("Encoded message does not end in 0xBC.");var d=l-o-1,h=s.substr(0,d),f=s.substr(d,o),p=65280>>8*l-u&255;if(0!=(h.charCodeAt(0)&p))throw new Error("Bits beyond keysize not zero as expected.");var m=i.generate(f,d),g="";for(c=0;c<d;c++)g+=String.fromCharCode(h.charCodeAt(c)^m.charCodeAt(c));g=String.fromCharCode(g.charCodeAt(0)&~p)+g.substr(1);var v=l-o-t-2;for(c=0;c<v;c++)if(0!==g.charCodeAt(c))throw new Error("Leftmost octets not zero as expected");if(1!==g.charCodeAt(v))throw new Error("Inconsistent PSS signature, 0x01 marker not found");var y=g.substr(-t),b=new n.util.ByteBuffer;return b.fillWithByte(0,8),b.putBytes(e),b.putBytes(y),r.start(),r.update(b.getBytes()),f===r.digest().getBytes()}};return c}},49563:(e,t,r)=>{var n=r(3832);r(8925),r(41668),r(74933),r(97116),n.random&&n.random.getBytes?e.exports=n.random:function(t){var r={},i=new Array(4),o=n.util.createBuffer();function s(){var e=n.prng.create(r);return e.getBytes=function(t,r){return e.generate(t,r)},e.getBytesSync=function(t){return e.generate(t)},e}r.formatKey=function(e){var t=n.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),n.aes._expandKey(e,!1)},r.formatSeed=function(e){var t=n.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),e},r.cipher=function(e,t){return n.aes._updateBlock(e,t,i,!1),o.putInt32(i[0]),o.putInt32(i[1]),o.putInt32(i[2]),o.putInt32(i[3]),o.getBytes()},r.increment=function(e){return++e[3],e},r.md=n.md.sha256;var a=s(),c=null,u=n.util.globalScope,l=u.crypto||u.msCrypto;if(l&&l.getRandomValues&&(c=function(e){return l.getRandomValues(e)}),n.options.usePureJavaScript||!n.util.isNodejs&&!c){if("undefined"==typeof window||window.document,a.collectInt(+new Date,32),"undefined"!=typeof navigator){var d="";for(var h in navigator)try{"string"==typeof navigator[h]&&(d+=navigator[h])}catch(e){}a.collect(d),d=null}t&&(t().mousemove((function(e){a.collectInt(e.clientX,16),a.collectInt(e.clientY,16)})),t().keypress((function(e){a.collectInt(e.charCode,8)})))}if(n.random)for(var h in a)n.random[h]=a[h];else n.random=a;n.random.createInstance=s,e.exports=n.random}("undefined"!=typeof jQuery?jQuery:null)},69372:(e,t,r)=>{var n=r(3832);r(97116);var i=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],o=[1,2,3,5],s=function(e,t){return e<<t&65535|(65535&e)>>16-t},a=function(e,t){return(65535&e)>>t|e<<16-t&65535};e.exports=n.rc2=n.rc2||{},n.rc2.expandKey=function(e,t){"string"==typeof e&&(e=n.util.createBuffer(e)),t=t||128;var r,o=e,s=e.length(),a=t,c=Math.ceil(a/8),u=255>>(7&a);for(r=s;r<128;r++)o.putByte(i[o.at(r-1)+o.at(r-s)&255]);for(o.setAt(128-c,i[o.at(128-c)&u]),r=127-c;r>=0;r--)o.setAt(r,i[o.at(r+1)^o.at(r+c)]);return o};var c=function(e,t,r){var i,c,u,l,d=!1,h=null,f=null,p=null,m=[];for(e=n.rc2.expandKey(e,t),u=0;u<64;u++)m.push(e.getInt16Le());r?(i=function(e){for(u=0;u<4;u++)e[u]+=m[l]+(e[(u+3)%4]&e[(u+2)%4])+(~e[(u+3)%4]&e[(u+1)%4]),e[u]=s(e[u],o[u]),l++},c=function(e){for(u=0;u<4;u++)e[u]+=m[63&e[(u+3)%4]]}):(i=function(e){for(u=3;u>=0;u--)e[u]=a(e[u],o[u]),e[u]-=m[l]+(e[(u+3)%4]&e[(u+2)%4])+(~e[(u+3)%4]&e[(u+1)%4]),l--},c=function(e){for(u=3;u>=0;u--)e[u]-=m[63&e[(u+3)%4]]});var g=function(e){var t=[];for(u=0;u<4;u++){var n=h.getInt16Le();null!==p&&(r?n^=p.getInt16Le():p.putInt16Le(n)),t.push(65535&n)}l=r?0:63;for(var i=0;i<e.length;i++)for(var o=0;o<e[i][0];o++)e[i][1](t);for(u=0;u<4;u++)null!==p&&(r?p.putInt16Le(t[u]):t[u]^=p.getInt16Le()),f.putInt16Le(t[u])},v=null;return v={start:function(e,t){e&&"string"==typeof e&&(e=n.util.createBuffer(e)),d=!1,h=n.util.createBuffer(),f=t||new n.util.createBuffer,p=e,v.output=f},update:function(e){for(d||h.putBuffer(e);h.length()>=8;)g([[5,i],[1,c],[6,i],[1,c],[5,i]])},finish:function(e){var t=!0;if(r)if(e)t=e(8,h,!r);else{var n=8===h.length()?8:8-h.length();h.fillWithByte(n,n)}if(t&&(d=!0,v.update()),!r&&(t=0===h.length()))if(e)t=e(8,f,!r);else{var i=f.length(),o=f.at(i-1);o>i?t=!1:f.truncate(o)}return t}}};n.rc2.startEncrypting=function(e,t,r){var i=n.rc2.createEncryptionCipher(e,128);return i.start(t,r),i},n.rc2.createEncryptionCipher=function(e,t){return c(e,t,!0)},n.rc2.startDecrypting=function(e,t,r){var i=n.rc2.createDecryptionCipher(e,128);return i.start(t,r),i},n.rc2.createDecryptionCipher=function(e,t){return c(e,t,!1)}},28095:(e,t,r)=>{var n=r(3832);if(r(3068),r(15764),r(66270),r(18936),r(29654),r(49563),r(97116),void 0===i)var i=n.jsbn.BigInteger;var o=n.util.isNodejs?r(25819):null,s=n.asn1,a=n.util;n.pki=n.pki||{},e.exports=n.pki.rsa=n.rsa=n.rsa||{};var c=n.pki,u=[6,4,2,4,2,4,6,2],l={name:"PrivateKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},d={name:"RSAPrivateKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},h={name:"RSAPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},f=n.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},p={name:"DigestInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:s.Class.UNIVERSAL,type:s.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},m=function(e){var t;if(!(e.algorithm in c.oids)){var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}t=c.oids[e.algorithm];var n=s.oidToDer(t).getBytes(),i=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]),o=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]);o.value.push(s.create(s.Class.UNIVERSAL,s.Type.OID,!1,n)),o.value.push(s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,""));var a=s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,e.digest().getBytes());return i.value.push(o),i.value.push(a),s.toDer(i).getBytes()},g=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);var o;t.dP||(t.dP=t.d.mod(t.p.subtract(i.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(i.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));do{o=new i(n.util.bytesToHex(n.random.getBytes(t.n.bitLength()/8)),16)}while(o.compareTo(t.n)>=0||!o.gcd(t.n).equals(i.ONE));for(var s=(e=e.multiply(o.modPow(t.e,t.n)).mod(t.n)).mod(t.p).modPow(t.dP,t.p),a=e.mod(t.q).modPow(t.dQ,t.q);s.compareTo(a)<0;)s=s.add(t.p);var c=s.subtract(a).multiply(t.qInv).mod(t.p).multiply(t.q).add(a);return c=c.multiply(o.modInverse(t.n)).mod(t.n)};function v(e,t,r){var i=n.util.createBuffer(),o=Math.ceil(t.n.bitLength()/8);if(e.length>o-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=e.length,s.max=o-11,s}i.putByte(0),i.putByte(r);var a,c=o-3-e.length;if(0===r||1===r){a=0===r?0:255;for(var u=0;u<c;++u)i.putByte(a)}else for(;c>0;){var l=0,d=n.random.getBytes(c);for(u=0;u<c;++u)0===(a=d.charCodeAt(u))?++l:i.putByte(a);c=l}return i.putByte(0),i.putBytes(e),i}function y(e,t,r,i){var o=Math.ceil(t.n.bitLength()/8),s=n.util.createBuffer(e),a=s.getByte(),c=s.getByte();if(0!==a||r&&0!==c&&1!==c||!r&&2!=c||r&&0===c&&void 0===i)throw new Error("Encryption block is invalid.");var u=0;if(0===c){u=o-3-i;for(var l=0;l<u;++l)if(0!==s.getByte())throw new Error("Encryption block is invalid.")}else if(1===c)for(u=0;s.length()>1;){if(255!==s.getByte()){--s.read;break}++u}else if(2===c)for(u=0;s.length()>1;){if(0===s.getByte()){--s.read;break}++u}if(0!==s.getByte()||u!==o-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function b(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=n.util.hexToBytes(t);return r.length>1&&(0===r.charCodeAt(0)&&0==(128&r.charCodeAt(1))||255===r.charCodeAt(0)&&128==(128&r.charCodeAt(1)))?r.substr(1):r}function E(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function w(e){return n.util.isNodejs&&"function"==typeof o[e]}function S(e){return void 0!==a.globalScope&&"object"==typeof a.globalScope.crypto&&"object"==typeof a.globalScope.crypto.subtle&&"function"==typeof a.globalScope.crypto.subtle[e]}function _(e){return void 0!==a.globalScope&&"object"==typeof a.globalScope.msCrypto&&"object"==typeof a.globalScope.msCrypto.subtle&&"function"==typeof a.globalScope.msCrypto.subtle[e]}function T(e){for(var t=n.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),i=0;i<t.length;++i)r[i]=t.charCodeAt(i);return r}c.rsa.encrypt=function(e,t,r){var o,s=r,a=Math.ceil(t.n.bitLength()/8);!1!==r&&!0!==r?(s=2===r,o=v(e,t,r)):(o=n.util.createBuffer()).putBytes(e);for(var c=new i(o.toHex(),16),u=g(c,t,s).toString(16),l=n.util.createBuffer(),d=a-Math.ceil(u.length/2);d>0;)l.putByte(0),--d;return l.putBytes(n.util.hexToBytes(u)),l.getBytes()},c.rsa.decrypt=function(e,t,r,o){var s=Math.ceil(t.n.bitLength()/8);if(e.length!==s){var a=new Error("Encrypted message length is invalid.");throw a.length=e.length,a.expected=s,a}var c=new i(n.util.createBuffer(e).toHex(),16);if(c.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var u=g(c,t,r).toString(16),l=n.util.createBuffer(),d=s-Math.ceil(u.length/2);d>0;)l.putByte(0),--d;return l.putBytes(n.util.hexToBytes(u)),!1!==o?y(l.getBytes(),t,r):l.getBytes()},c.rsa.createKeyPairGenerationState=function(e,t,r){"string"==typeof e&&(e=parseInt(e,10)),e=e||2048;var o,s=(r=r||{}).prng||n.random,a={nextBytes:function(e){for(var t=s.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}},c=r.algorithm||"PRIMEINC";if("PRIMEINC"!==c)throw new Error("Invalid key generation algorithm: "+c);return(o={algorithm:c,state:0,bits:e,rng:a,eInt:t||65537,e:new i(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null}).e.fromInt(o.eInt),o},c.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new i(null);r.fromInt(30);for(var n,o=0,s=function(e,t){return e|t},a=+new Date,l=0;null===e.keys&&(t<=0||l<t);){if(0===e.state){var d=null===e.p?e.pBits:e.qBits,h=d-1;0===e.pqState?(e.num=new i(d,e.rng),e.num.testBit(h)||e.num.bitwiseTo(i.ONE.shiftLeft(h),s,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),o=0,++e.pqState):1===e.pqState?e.num.bitLength()>d?e.pqState=0:e.num.isProbablePrime(E(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(u[o++%8],0):2===e.pqState?e.pqState=0===e.num.subtract(i.ONE).gcd(e.e).compareTo(i.ONE)?3:0:3===e.pqState&&(e.pqState=0,null===e.p?e.p=e.num:e.q=e.num,null!==e.p&&null!==e.q&&++e.state,e.num=null)}else if(1===e.state)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(2===e.state)e.p1=e.p.subtract(i.ONE),e.q1=e.q.subtract(i.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(3===e.state)0===e.phi.gcd(e.e).compareTo(i.ONE)?++e.state:(e.p=null,e.q=null,e.state=0);else if(4===e.state)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(5===e.state){var f=e.e.modInverse(e.phi);e.keys={privateKey:c.rsa.setPrivateKey(e.n,e.e,f,e.p,e.q,f.mod(e.p1),f.mod(e.q1),e.q.modInverse(e.p)),publicKey:c.rsa.setPublicKey(e.n,e.e)}}l+=(n=+new Date)-a,a=n}return null!==e.keys},c.rsa.generateKeyPair=function(e,t,r,u){if(1===arguments.length?"object"==typeof e?(r=e,e=void 0):"function"==typeof e&&(u=e,e=void 0):2===arguments.length?"number"==typeof e?"function"==typeof t?(u=t,t=void 0):"number"!=typeof t&&(r=t,t=void 0):(r=e,u=t,e=void 0,t=void 0):3===arguments.length&&("number"==typeof t?"function"==typeof r&&(u=r,r=void 0):(u=r,r=t,t=void 0)),r=r||{},void 0===e&&(e=r.bits||2048),void 0===t&&(t=r.e||65537),!n.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(65537===t||3===t))if(u){if(w("generateKeyPair"))return o.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},(function(e,t,r){if(e)return u(e);u(null,{privateKey:c.privateKeyFromPem(r),publicKey:c.publicKeyFromPem(t)})}));if(S("generateKey")&&S("exportKey"))return a.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:T(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then((function(e){return a.globalScope.crypto.subtle.exportKey("pkcs8",e.privateKey)})).then(void 0,(function(e){u(e)})).then((function(e){if(e){var t=c.privateKeyFromAsn1(s.fromDer(n.util.createBuffer(e)));u(null,{privateKey:t,publicKey:c.setRsaPublicKey(t.n,t.e)})}}));if(_("generateKey")&&_("exportKey")){var l=a.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:T(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);return l.oncomplete=function(e){var t=e.target.result,r=a.globalScope.msCrypto.subtle.exportKey("pkcs8",t.privateKey);r.oncomplete=function(e){var t=e.target.result,r=c.privateKeyFromAsn1(s.fromDer(n.util.createBuffer(t)));u(null,{privateKey:r,publicKey:c.setRsaPublicKey(r.n,r.e)})},r.onerror=function(e){u(e)}},void(l.onerror=function(e){u(e)})}}else if(w("generateKeyPairSync")){var d=o.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:c.privateKeyFromPem(d.privateKey),publicKey:c.publicKeyFromPem(d.publicKey)}}var h=c.rsa.createKeyPairGenerationState(e,t,r);if(!u)return c.rsa.stepKeyPairGenerationState(h,0),h.keys;!function(e,t,r){"function"==typeof t&&(r=t,t={});t=t||{};var o={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};"prng"in t&&(o.prng=t.prng);function s(){a(e.pBits,(function(t,n){return t?r(t):(e.p=n,null!==e.q?u(t,e.q):void a(e.qBits,u))}))}function a(e,t){n.prime.generateProbablePrime(e,o,t)}function u(t,n){if(t)return r(t);if(e.q=n,e.p.compareTo(e.q)<0){var o=e.p;e.p=e.q,e.q=o}if(0!==e.p.subtract(i.ONE).gcd(e.e).compareTo(i.ONE))return e.p=null,void s();if(0!==e.q.subtract(i.ONE).gcd(e.e).compareTo(i.ONE))return e.q=null,void a(e.qBits,u);if(e.p1=e.p.subtract(i.ONE),e.q1=e.q.subtract(i.ONE),e.phi=e.p1.multiply(e.q1),0!==e.phi.gcd(e.e).compareTo(i.ONE))return e.p=e.q=null,void s();if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits)return e.q=null,void a(e.qBits,u);var l=e.e.modInverse(e.phi);e.keys={privateKey:c.rsa.setPrivateKey(e.n,e.e,l,e.p,e.q,l.mod(e.p1),l.mod(e.q1),e.q.modInverse(e.p)),publicKey:c.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}s()}(h,r,u)},c.setRsaPublicKey=c.rsa.setPublicKey=function(e,t){var r={n:e,e:t,encrypt:function(e,t,i){if("string"==typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===t)t={encode:function(e,t,r){return v(e,t,2).getBytes()}};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={encode:function(e,t){return n.pkcs1.encode_rsa_oaep(t,e,i)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(t))t={encode:function(e){return e}};else if("string"==typeof t)throw new Error('Unsupported encryption scheme: "'+t+'".');var o=t.encode(e,r,!0);return c.rsa.encrypt(o,r,!0)},verify:function(e,t,i,o){"string"==typeof i?i=i.toUpperCase():void 0===i&&(i="RSASSA-PKCS1-V1_5"),void 0===o&&(o={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in o||(o._parseAllDigestBytes=!0),"RSASSA-PKCS1-V1_5"===i?i={verify:function(e,t){t=y(t,r,!0);var i=s.fromDer(t,{parseAllBytes:o._parseAllDigestBytes}),a={},c=[];if(!s.validate(i,p,a,c))throw(u=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.")).errors=c,u;var u,l=s.derToOid(a.algorithmIdentifier);if(l!==n.oids.md2&&l!==n.oids.md5&&l!==n.oids.sha1&&l!==n.oids.sha224&&l!==n.oids.sha256&&l!==n.oids.sha384&&l!==n.oids.sha512&&l!==n.oids["sha512-224"]&&l!==n.oids["sha512-256"])throw(u=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.")).oid=l,u;if((l===n.oids.md2||l===n.oids.md5)&&!("parameters"in a))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return e===a.digest}}:"NONE"!==i&&"NULL"!==i&&null!==i||(i={verify:function(e,t){return e===(t=y(t,r,!0))}});var a=c.rsa.decrypt(t,r,!0,!1);return i.verify(e,a,r.n.bitLength())}};return r},c.setRsaPrivateKey=c.rsa.setPrivateKey=function(e,t,r,i,o,s,a,u){var l={n:e,e:t,d:r,p:i,q:o,dP:s,dQ:a,qInv:u,decrypt:function(e,t,r){"string"==typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5");var i=c.rsa.decrypt(e,l,!1,!1);if("RSAES-PKCS1-V1_5"===t)t={decode:y};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={decode:function(e,t){return n.pkcs1.decode_rsa_oaep(t,e,r)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(t))throw new Error('Unsupported encryption scheme: "'+t+'".');t={decode:function(e){return e}}}return t.decode(i,l,!1)},sign:function(e,t){var r=!1;"string"==typeof t&&(t=t.toUpperCase()),void 0===t||"RSASSA-PKCS1-V1_5"===t?(t={encode:m},r=1):"NONE"!==t&&"NULL"!==t&&null!==t||(t={encode:function(){return e}},r=1);var n=t.encode(e,l.n.bitLength());return c.rsa.encrypt(n,l,r)}};return l},c.wrapRsaPrivateKey=function(e){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(0).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(c.oids.rsaEncryption).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")]),s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,s.toDer(e).getBytes())])},c.privateKeyFromAsn1=function(e){var t,r,o,a,u,h,f,p,m={},g=[];if(s.validate(e,l,m,g)&&(e=s.fromDer(n.util.createBuffer(m.privateKey))),m={},g=[],!s.validate(e,d,m,g)){var v=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw v.errors=g,v}return t=n.util.createBuffer(m.privateKeyModulus).toHex(),r=n.util.createBuffer(m.privateKeyPublicExponent).toHex(),o=n.util.createBuffer(m.privateKeyPrivateExponent).toHex(),a=n.util.createBuffer(m.privateKeyPrime1).toHex(),u=n.util.createBuffer(m.privateKeyPrime2).toHex(),h=n.util.createBuffer(m.privateKeyExponent1).toHex(),f=n.util.createBuffer(m.privateKeyExponent2).toHex(),p=n.util.createBuffer(m.privateKeyCoefficient).toHex(),c.setRsaPrivateKey(new i(t,16),new i(r,16),new i(o,16),new i(a,16),new i(u,16),new i(h,16),new i(f,16),new i(p,16))},c.privateKeyToAsn1=c.privateKeyToRSAPrivateKey=function(e){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(0).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.n)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.e)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.d)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.p)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.q)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.dP)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.dQ)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.qInv))])},c.publicKeyFromAsn1=function(e){var t={},r=[];if(s.validate(e,f,t,r)){var o,a=s.derToOid(t.publicKeyOid);if(a!==c.oids.rsaEncryption)throw(o=new Error("Cannot read public key. Unknown OID.")).oid=a,o;e=t.rsaPublicKey}if(r=[],!s.validate(e,h,t,r))throw(o=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.")).errors=r,o;var u=n.util.createBuffer(t.publicKeyModulus).toHex(),l=n.util.createBuffer(t.publicKeyExponent).toHex();return c.setRsaPublicKey(new i(u,16),new i(l,16))},c.publicKeyToAsn1=c.publicKeyToSubjectPublicKeyInfo=function(e){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(c.oids.rsaEncryption).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")]),s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,!1,[c.publicKeyToRSAPublicKey(e)])])},c.publicKeyToRSAPublicKey=function(e){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.n)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.e))])}},137:(e,t,r)=>{var n=r(3832);r(28991),r(97116);var i=e.exports=n.sha1=n.sha1||{};n.md.sha1=n.md.algorithms.sha1=i,i.create=function(){s||(o=String.fromCharCode(128),o+=n.util.fillString(String.fromCharCode(0),64),s=!0);var e=null,t=n.util.createBuffer(),r=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var r=i.messageLengthSize/4,o=0;o<r;++o)i.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i}};return i.start(),i.update=function(o,s){"utf8"===s&&(o=n.util.encodeUtf8(o));var c=o.length;i.messageLength+=c,c=[c/4294967296>>>0,c>>>0];for(var u=i.fullMessageLength.length-1;u>=0;--u)i.fullMessageLength[u]+=c[1],c[1]=c[0]+(i.fullMessageLength[u]/4294967296>>>0),i.fullMessageLength[u]=i.fullMessageLength[u]>>>0,c[0]=c[1]/4294967296>>>0;return t.putBytes(o),a(e,r,t),(t.read>2048||0===t.length())&&t.compact(),i},i.digest=function(){var s=n.util.createBuffer();s.putBytes(t.bytes());var c,u=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize&i.blockLength-1;s.putBytes(o.substr(0,i.blockLength-u));for(var l=8*i.fullMessageLength[0],d=0;d<i.fullMessageLength.length-1;++d)l+=(c=8*i.fullMessageLength[d+1])/4294967296>>>0,s.putInt32(l>>>0),l=c>>>0;s.putInt32(l);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};a(h,r,s);var f=n.util.createBuffer();return f.putInt32(h.h0),f.putInt32(h.h1),f.putInt32(h.h2),f.putInt32(h.h3),f.putInt32(h.h4),f},i};var o=null,s=!1;function a(e,t,r){for(var n,i,o,s,a,c,u,l=r.length();l>=64;){for(i=e.h0,o=e.h1,s=e.h2,a=e.h3,c=e.h4,u=0;u<16;++u)n=r.getInt32(),t[u]=n,n=(i<<5|i>>>27)+(a^o&(s^a))+c+1518500249+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<20;++u)n=(n=t[u-3]^t[u-8]^t[u-14]^t[u-16])<<1|n>>>31,t[u]=n,n=(i<<5|i>>>27)+(a^o&(s^a))+c+1518500249+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<32;++u)n=(n=t[u-3]^t[u-8]^t[u-14]^t[u-16])<<1|n>>>31,t[u]=n,n=(i<<5|i>>>27)+(o^s^a)+c+1859775393+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<40;++u)n=(n=t[u-6]^t[u-16]^t[u-28]^t[u-32])<<2|n>>>30,t[u]=n,n=(i<<5|i>>>27)+(o^s^a)+c+1859775393+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<60;++u)n=(n=t[u-6]^t[u-16]^t[u-28]^t[u-32])<<2|n>>>30,t[u]=n,n=(i<<5|i>>>27)+(o&s|a&(o^s))+c+2400959708+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<80;++u)n=(n=t[u-6]^t[u-16]^t[u-28]^t[u-32])<<2|n>>>30,t[u]=n,n=(i<<5|i>>>27)+(o^s^a)+c+3395469782+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;e.h0=e.h0+i|0,e.h1=e.h1+o|0,e.h2=e.h2+s|0,e.h3=e.h3+a|0,e.h4=e.h4+c|0,l-=64}}},41668:(e,t,r)=>{var n=r(3832);r(28991),r(97116);var i=e.exports=n.sha256=n.sha256||{};n.md.sha256=n.md.algorithms.sha256=i,i.create=function(){s||(o=String.fromCharCode(128),o+=n.util.fillString(String.fromCharCode(0),64),a=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=!0);var e=null,t=n.util.createBuffer(),r=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var r=i.messageLengthSize/4,o=0;o<r;++o)i.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i}};return i.start(),i.update=function(o,s){"utf8"===s&&(o=n.util.encodeUtf8(o));var a=o.length;i.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var u=i.fullMessageLength.length-1;u>=0;--u)i.fullMessageLength[u]+=a[1],a[1]=a[0]+(i.fullMessageLength[u]/4294967296>>>0),i.fullMessageLength[u]=i.fullMessageLength[u]>>>0,a[0]=a[1]/4294967296>>>0;return t.putBytes(o),c(e,r,t),(t.read>2048||0===t.length())&&t.compact(),i},i.digest=function(){var s=n.util.createBuffer();s.putBytes(t.bytes());var a,u=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize&i.blockLength-1;s.putBytes(o.substr(0,i.blockLength-u));for(var l=8*i.fullMessageLength[0],d=0;d<i.fullMessageLength.length-1;++d)l+=(a=8*i.fullMessageLength[d+1])/4294967296>>>0,s.putInt32(l>>>0),l=a>>>0;s.putInt32(l);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};c(h,r,s);var f=n.util.createBuffer();return f.putInt32(h.h0),f.putInt32(h.h1),f.putInt32(h.h2),f.putInt32(h.h3),f.putInt32(h.h4),f.putInt32(h.h5),f.putInt32(h.h6),f.putInt32(h.h7),f},i};var o=null,s=!1,a=null;function c(e,t,r){for(var n,i,o,s,c,u,l,d,h,f,p,m,g,v=r.length();v>=64;){for(c=0;c<16;++c)t[c]=r.getInt32();for(;c<64;++c)n=((n=t[c-2])>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=((i=t[c-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[c]=n+t[c-7]+i+t[c-16]|0;for(u=e.h0,l=e.h1,d=e.h2,h=e.h3,f=e.h4,p=e.h5,m=e.h6,g=e.h7,c=0;c<64;++c)o=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),s=u&l|d&(u^l),n=g+((f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(m^f&(p^m))+a[c]+t[c],g=m,m=p,p=f,f=h+n>>>0,h=d,d=l,l=u,u=n+(i=o+s)>>>0;e.h0=e.h0+u|0,e.h1=e.h1+l|0,e.h2=e.h2+d|0,e.h3=e.h3+h|0,e.h4=e.h4+f|0,e.h5=e.h5+p|0,e.h6=e.h6+m|0,e.h7=e.h7+g|0,v-=64}}},63219:(e,t,r)=>{var n=r(3832);r(28991),r(97116);var i=e.exports=n.sha512=n.sha512||{};n.md.sha512=n.md.algorithms.sha512=i;var o=n.sha384=n.sha512.sha384=n.sha512.sha384||{};o.create=function(){return i.create("SHA-384")},n.md.sha384=n.md.algorithms.sha384=o,n.sha512.sha256=n.sha512.sha256||{create:function(){return i.create("SHA-512/256")}},n.md["sha512/256"]=n.md.algorithms["sha512/256"]=n.sha512.sha256,n.sha512.sha224=n.sha512.sha224||{create:function(){return i.create("SHA-512/224")}},n.md["sha512/224"]=n.md.algorithms["sha512/224"]=n.sha512.sha224,i.create=function(e){if(a||(s=String.fromCharCode(128),s+=n.util.fillString(String.fromCharCode(0),128),c=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],(u={})["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],u["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],u["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],u["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],a=!0),void 0===e&&(e="SHA-512"),!(e in u))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=u[e],r=null,i=n.util.createBuffer(),o=new Array(80),d=0;d<80;++d)o[d]=new Array(2);var h=64;switch(e){case"SHA-384":h=48;break;case"SHA-512/256":h=32;break;case"SHA-512/224":h=28}var f={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:h,messageLength:0,fullMessageLength:null,messageLengthSize:16,start:function(){f.messageLength=0,f.fullMessageLength=f.messageLength128=[];for(var e=f.messageLengthSize/4,o=0;o<e;++o)f.fullMessageLength.push(0);i=n.util.createBuffer(),r=new Array(t.length);for(o=0;o<t.length;++o)r[o]=t[o].slice(0);return f}};return f.start(),f.update=function(e,t){"utf8"===t&&(e=n.util.encodeUtf8(e));var s=e.length;f.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var a=f.fullMessageLength.length-1;a>=0;--a)f.fullMessageLength[a]+=s[1],s[1]=s[0]+(f.fullMessageLength[a]/4294967296>>>0),f.fullMessageLength[a]=f.fullMessageLength[a]>>>0,s[0]=s[1]/4294967296>>>0;return i.putBytes(e),l(r,o,i),(i.read>2048||0===i.length())&&i.compact(),f},f.digest=function(){var t=n.util.createBuffer();t.putBytes(i.bytes());var a,c=f.fullMessageLength[f.fullMessageLength.length-1]+f.messageLengthSize&f.blockLength-1;t.putBytes(s.substr(0,f.blockLength-c));for(var u=8*f.fullMessageLength[0],d=0;d<f.fullMessageLength.length-1;++d)u+=(a=8*f.fullMessageLength[d+1])/4294967296>>>0,t.putInt32(u>>>0),u=a>>>0;t.putInt32(u);var h=new Array(r.length);for(d=0;d<r.length;++d)h[d]=r[d].slice(0);l(h,o,t);var p,m=n.util.createBuffer();p="SHA-512"===e?h.length:"SHA-384"===e?h.length-2:h.length-4;for(d=0;d<p;++d)m.putInt32(h[d][0]),d===p-1&&"SHA-512/224"===e||m.putInt32(h[d][1]);return m},f};var s=null,a=!1,c=null,u=null;function l(e,t,r){for(var n,i,o,s,a,u,l,d,h,f,p,m,g,v,y,b,E,w,S,_,T,x,A,I,C,R,k,O,N,P,L,D,M,U=r.length();U>=128;){for(k=0;k<16;++k)t[k][0]=r.getInt32()>>>0,t[k][1]=r.getInt32()>>>0;for(;k<80;++k)n=(((O=(P=t[k-2])[0])>>>19|(N=P[1])<<13)^(N>>>29|O<<3)^O>>>6)>>>0,i=((O<<13|N>>>19)^(N<<3|O>>>29)^(O<<26|N>>>6))>>>0,o=(((O=(D=t[k-15])[0])>>>1|(N=D[1])<<31)^(O>>>8|N<<24)^O>>>7)>>>0,s=((O<<31|N>>>1)^(O<<24|N>>>8)^(O<<25|N>>>7))>>>0,L=t[k-7],M=t[k-16],N=i+L[1]+s+M[1],t[k][0]=n+L[0]+o+M[0]+(N/4294967296>>>0)>>>0,t[k][1]=N>>>0;for(p=e[0][0],m=e[0][1],g=e[1][0],v=e[1][1],y=e[2][0],b=e[2][1],E=e[3][0],w=e[3][1],S=e[4][0],_=e[4][1],T=e[5][0],x=e[5][1],A=e[6][0],I=e[6][1],C=e[7][0],R=e[7][1],k=0;k<80;++k)l=((S>>>14|_<<18)^(S>>>18|_<<14)^(_>>>9|S<<23))>>>0,d=(A^S&(T^A))>>>0,a=((p>>>28|m<<4)^(m>>>2|p<<30)^(m>>>7|p<<25))>>>0,u=((p<<4|m>>>28)^(m<<30|p>>>2)^(m<<25|p>>>7))>>>0,h=(p&g|y&(p^g))>>>0,f=(m&v|b&(m^v))>>>0,N=R+(((S<<18|_>>>14)^(S<<14|_>>>18)^(_<<23|S>>>9))>>>0)+((I^_&(x^I))>>>0)+c[k][1]+t[k][1],n=C+l+d+c[k][0]+t[k][0]+(N/4294967296>>>0)>>>0,i=N>>>0,o=a+h+((N=u+f)/4294967296>>>0)>>>0,s=N>>>0,C=A,R=I,A=T,I=x,T=S,x=_,S=E+n+((N=w+i)/4294967296>>>0)>>>0,_=N>>>0,E=y,w=b,y=g,b=v,g=p,v=m,p=n+o+((N=i+s)/4294967296>>>0)>>>0,m=N>>>0;N=e[0][1]+m,e[0][0]=e[0][0]+p+(N/4294967296>>>0)>>>0,e[0][1]=N>>>0,N=e[1][1]+v,e[1][0]=e[1][0]+g+(N/4294967296>>>0)>>>0,e[1][1]=N>>>0,N=e[2][1]+b,e[2][0]=e[2][0]+y+(N/4294967296>>>0)>>>0,e[2][1]=N>>>0,N=e[3][1]+w,e[3][0]=e[3][0]+E+(N/4294967296>>>0)>>>0,e[3][1]=N>>>0,N=e[4][1]+_,e[4][0]=e[4][0]+S+(N/4294967296>>>0)>>>0,e[4][1]=N>>>0,N=e[5][1]+x,e[5][0]=e[5][0]+T+(N/4294967296>>>0)>>>0,e[5][1]=N>>>0,N=e[6][1]+I,e[6][0]=e[6][0]+A+(N/4294967296>>>0)>>>0,e[6][1]=N>>>0,N=e[7][1]+R,e[7][0]=e[7][0]+C+(N/4294967296>>>0)>>>0,e[7][1]=N>>>0,U-=128}}},97116:(e,t,r)=>{var n=r(34155),i=r(3832),o=r(78807),s=e.exports=i.util=i.util||{};function a(e){if(8!==e&&16!==e&&24!==e&&32!==e)throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}function c(e){if(this.data="",this.read=0,"string"==typeof e)this.data=e;else if(s.isArrayBuffer(e)||s.isArrayBufferView(e))if("undefined"!=typeof Buffer&&e instanceof Buffer)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch(e){for(var r=0;r<t.length;++r)this.putByte(t[r])}}else(e instanceof c||"object"==typeof e&&"string"==typeof e.data&&"number"==typeof e.read)&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}!function(){if(void 0!==n&&n.nextTick&&!n.browser)return s.nextTick=n.nextTick,void("function"==typeof setImmediate?s.setImmediate=setImmediate:s.setImmediate=s.nextTick);if("function"==typeof setImmediate)return s.setImmediate=function(){return setImmediate.apply(void 0,arguments)},void(s.nextTick=function(e){return setImmediate(e)});if(s.setImmediate=function(e){setTimeout(e,0)},"undefined"!=typeof window&&"function"==typeof window.postMessage){var e="forge.setImmediate",t=[];s.setImmediate=function(r){t.push(r),1===t.length&&window.postMessage(e,"*")},window.addEventListener("message",(function(r){if(r.source===window&&r.data===e){r.stopPropagation();var n=t.slice();t.length=0,n.forEach((function(e){e()}))}}),!0)}if("undefined"!=typeof MutationObserver){var r=Date.now(),i=!0,o=document.createElement("div");t=[];new MutationObserver((function(){var e=t.slice();t.length=0,e.forEach((function(e){e()}))})).observe(o,{attributes:!0});var a=s.setImmediate;s.setImmediate=function(e){Date.now()-r>15?(r=Date.now(),a(e)):(t.push(e),1===t.length&&o.setAttribute("a",i=!i))}}s.nextTick=s.setImmediate}(),s.isNodejs=void 0!==n&&n.versions&&n.versions.node,s.globalScope=s.isNodejs?r.g:"undefined"==typeof self?window:self,s.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},s.isArrayBuffer=function(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer},s.isArrayBufferView=function(e){return e&&s.isArrayBuffer(e.buffer)&&void 0!==e.byteLength},s.ByteBuffer=c,s.ByteStringBuffer=c;s.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>4096&&(this.data.substr(0,1),this._constructedStringLength=0)},s.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},s.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},s.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))},s.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)1&t&&(r+=e),(t>>>=1)>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this},s.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this},s.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(s.encodeUtf8(e))},s.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},s.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},s.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},s.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255))},s.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))},s.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))},s.ByteStringBuffer.prototype.putInt=function(e,t){a(t);var r="";do{t-=8,r+=String.fromCharCode(e>>t&255)}while(t>0);return this.putBytes(r)},s.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)},s.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())},s.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},s.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e},s.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e},s.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},s.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e},s.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e},s.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e},s.ByteStringBuffer.prototype.getInt=function(e){a(e);var t=0;do{t=(t<<8)+this.data.charCodeAt(this.read++),e-=8}while(e>0);return t},s.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},s.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},s.ByteStringBuffer.prototype.bytes=function(e){return void 0===e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},s.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)},s.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this},s.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},s.ByteStringBuffer.prototype.copy=function(){var e=s.createBuffer(this.data);return e.read=this.read,e},s.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},s.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},s.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this},s.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e},s.ByteStringBuffer.prototype.toString=function(){return s.decodeUtf8(this.bytes())},s.DataBuffer=function(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=s.isArrayBuffer(e),n=s.isArrayBufferView(e);if(r||n)return this.data=r?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength),void(this.write="writeOffset"in t?t.writeOffset:this.data.byteLength);this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!=e&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)},s.DataBuffer.prototype.length=function(){return this.write-this.read},s.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},s.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this},s.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this},s.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this},s.DataBuffer.prototype.putBytes=function(e,t){if(s.isArrayBufferView(e)){var r=(n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)).byteLength-n.byteOffset;return this.accommodate(r),new Uint8Array(this.data.buffer,this.write).set(n),this.write+=r,this}if(s.isArrayBuffer(e)){var n=new Uint8Array(e);return this.accommodate(n.byteLength),new Uint8Array(this.data.buffer).set(n,this.write),this.write+=n.byteLength,this}if(e instanceof s.DataBuffer||"object"==typeof e&&"number"==typeof e.read&&"number"==typeof e.write&&s.isArrayBufferView(e.data)){n=new Uint8Array(e.data.byteLength,e.read,e.length());return this.accommodate(n.byteLength),new Uint8Array(e.data.byteLength,this.write).set(n),this.write+=n.byteLength,this}if(e instanceof s.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary","string"==typeof e){var i;if("hex"===t)return this.accommodate(Math.ceil(e.length/2)),i=new Uint8Array(this.data.buffer,this.write),this.write+=s.binary.hex.decode(e,i,this.write),this;if("base64"===t)return this.accommodate(3*Math.ceil(e.length/4)),i=new Uint8Array(this.data.buffer,this.write),this.write+=s.binary.base64.decode(e,i,this.write),this;if("utf8"===t&&(e=s.encodeUtf8(e),t="binary"),"binary"===t||"raw"===t)return this.accommodate(e.length),i=new Uint8Array(this.data.buffer,this.write),this.write+=s.binary.raw.decode(i),this;if("utf16"===t)return this.accommodate(2*e.length),i=new Uint16Array(this.data.buffer,this.write),this.write+=s.text.utf16.encode(i),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)},s.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this},s.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")},s.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this},s.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this},s.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this},s.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this},s.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this},s.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this},s.DataBuffer.prototype.putInt=function(e,t){a(t),this.accommodate(t/8);do{t-=8,this.data.setInt8(this.write++,e>>t&255)}while(t>0);return this},s.DataBuffer.prototype.putSignedInt=function(e,t){return a(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)},s.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},s.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e},s.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e},s.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e},s.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e},s.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e},s.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e},s.DataBuffer.prototype.getInt=function(e){a(e);var t=0;do{t=(t<<8)+this.data.getInt8(this.read++),e-=8}while(e>0);return t},s.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},s.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},s.DataBuffer.prototype.bytes=function(e){return void 0===e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},s.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)},s.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this},s.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},s.DataBuffer.prototype.copy=function(){return new s.DataBuffer(this)},s.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this},s.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},s.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this},s.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e},s.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if("binary"===(e=e||"utf8")||"raw"===e)return s.binary.raw.encode(t);if("hex"===e)return s.binary.hex.encode(t);if("base64"===e)return s.binary.base64.encode(t);if("utf8"===e)return s.text.utf8.decode(t);if("utf16"===e)return s.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)},s.createBuffer=function(e,t){return t=t||"raw",void 0!==e&&"utf8"===t&&(e=s.encodeUtf8(e)),new s.ByteBuffer(e)},s.fillString=function(e,t){for(var r="";t>0;)1&t&&(r+=e),(t>>>=1)>0&&(e+=e);return r},s.xorBytes=function(e,t,r){for(var n="",i="",o="",s=0,a=0;r>0;--r,++s)i=e.charCodeAt(s)^t.charCodeAt(s),a>=10&&(n+=o,o="",a=0),o+=String.fromCharCode(i),++a;return n+=o},s.hexToBytes=function(e){var t="",r=0;for(!0&e.length&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t},s.bytesToHex=function(e){return s.createBuffer(e).toHex()},s.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)};var u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],d="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";s.encode64=function(e,t){for(var r,n,i,o="",s="",a=0;a<e.length;)r=e.charCodeAt(a++),n=e.charCodeAt(a++),i=e.charCodeAt(a++),o+=u.charAt(r>>2),o+=u.charAt((3&r)<<4|n>>4),isNaN(n)?o+="==":(o+=u.charAt((15&n)<<2|i>>6),o+=isNaN(i)?"=":u.charAt(63&i)),t&&o.length>t&&(s+=o.substr(0,t)+"\r\n",o=o.substr(t));return s+=o},s.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t,r,n,i,o="",s=0;s<e.length;)t=l[e.charCodeAt(s++)-43],r=l[e.charCodeAt(s++)-43],n=l[e.charCodeAt(s++)-43],i=l[e.charCodeAt(s++)-43],o+=String.fromCharCode(t<<2|r>>4),64!==n&&(o+=String.fromCharCode((15&r)<<4|n>>2),64!==i&&(o+=String.fromCharCode((3&n)<<6|i)));return o},s.encodeUtf8=function(e){return unescape(encodeURIComponent(e))},s.decodeUtf8=function(e){return decodeURIComponent(escape(e))},s.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:o.encode,decode:o.decode}},s.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)},s.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length));for(var i=r=r||0,o=0;o<e.length;++o)n[i++]=e.charCodeAt(o);return t?i-r:n},s.binary.hex.encode=s.bytesToHex,s.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2)));var i=0,o=r=r||0;for(1&e.length&&(i=1,n[o++]=parseInt(e[0],16));i<e.length;i+=2)n[o++]=parseInt(e.substr(i,2),16);return t?o-r:n},s.binary.base64.encode=function(e,t){for(var r,n,i,o="",s="",a=0;a<e.byteLength;)r=e[a++],n=e[a++],i=e[a++],o+=u.charAt(r>>2),o+=u.charAt((3&r)<<4|n>>4),isNaN(n)?o+="==":(o+=u.charAt((15&n)<<2|i>>6),o+=isNaN(i)?"=":u.charAt(63&i)),t&&o.length>t&&(s+=o.substr(0,t)+"\r\n",o=o.substr(t));return s+=o},s.binary.base64.decode=function(e,t,r){var n,i,o,s,a=t;a||(a=new Uint8Array(3*Math.ceil(e.length/4))),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var c=0,u=r=r||0;c<e.length;)n=l[e.charCodeAt(c++)-43],i=l[e.charCodeAt(c++)-43],o=l[e.charCodeAt(c++)-43],s=l[e.charCodeAt(c++)-43],a[u++]=n<<2|i>>4,64!==o&&(a[u++]=(15&i)<<4|o>>2,64!==s&&(a[u++]=(3&o)<<6|s));return t?u-r:a.subarray(0,u)},s.binary.base58.encode=function(e,t){return s.binary.baseN.encode(e,d,t)},s.binary.base58.decode=function(e,t){return s.binary.baseN.decode(e,d,t)},s.text={utf8:{},utf16:{}},s.text.utf8.encode=function(e,t,r){e=s.encodeUtf8(e);var n=t;n||(n=new Uint8Array(e.length));for(var i=r=r||0,o=0;o<e.length;++o)n[i++]=e.charCodeAt(o);return t?i-r:n},s.text.utf8.decode=function(e){return s.decodeUtf8(String.fromCharCode.apply(null,e))},s.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(2*e.length));for(var i=new Uint16Array(n.buffer),o=r=r||0,s=r,a=0;a<e.length;++a)i[s++]=e.charCodeAt(a),o+=2;return t?o-r:n},s.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))},s.deflate=function(e,t,r){if(t=s.decode64(e.deflate(s.encode64(t)).rval),r){var n=2;32&t.charCodeAt(1)&&(n=6),t=t.substring(n,t.length-4)}return t},s.inflate=function(e,t,r){var n=e.inflate(s.encode64(t)).rval;return null===n?null:s.decode64(n)};var h=function(e,t,r){if(!e)throw new Error("WebStorage not available.");var n;if(null===r?n=e.removeItem(t):(r=s.encode64(JSON.stringify(r)),n=e.setItem(t,r)),void 0!==n&&!0!==n.rval){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},f=function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(null===r.rval){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return null!==r&&(r=JSON.parse(s.decode64(r))),r},p=function(e,t,r,n){var i=f(e,t);null===i&&(i={}),i[r]=n,h(e,t,i)},m=function(e,t,r){var n=f(e,t);return null!==n&&(n=r in n?n[r]:null),n},g=function(e,t,r){var n=f(e,t);if(null!==n&&r in n){delete n[r];var i=!0;for(var o in n){i=!1;break}i&&(n=null),h(e,t,n)}},v=function(e,t){h(e,t,null)},y=function(e,t,r){var n,i=null;void 0===r&&(r=["web","flash"]);var o=!1,s=null;for(var a in r){n=r[a];try{if("flash"===n||"both"===n){if(null===t[0])throw new Error("Flash local storage not available.");i=e.apply(this,t),o="flash"===n}"web"!==n&&"both"!==n||(t[0]=localStorage,i=e.apply(this,t),o=!0)}catch(e){s=e}if(o)break}if(!o)throw s;return i};s.setItem=function(e,t,r,n,i){y(p,arguments,i)},s.getItem=function(e,t,r,n){return y(m,arguments,n)},s.removeItem=function(e,t,r,n){y(g,arguments,n)},s.clearItems=function(e,t,r){y(v,arguments,r)},s.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},s.format=function(e){for(var t,r,n=/%./g,i=0,o=[],s=0;t=n.exec(e);){(r=e.substring(s,n.lastIndex-2)).length>0&&o.push(r),s=n.lastIndex;var a=t[0][1];switch(a){case"s":case"o":i<arguments.length?o.push(arguments[1+i++]):o.push("<?>");break;case"%":o.push("%");break;default:o.push("<%"+a+"?>")}}return o.push(e.substring(s)),o.join("")},s.formatNumber=function(e,t,r,n){var i=e,o=isNaN(t=Math.abs(t))?2:t,s=void 0===r?",":r,a=void 0===n?".":n,c=i<0?"-":"",u=parseInt(i=Math.abs(+i||0).toFixed(o),10)+"",l=u.length>3?u.length%3:0;return c+(l?u.substr(0,l)+a:"")+u.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+a)+(o?s+Math.abs(i-u).toFixed(o).slice(2):"")},s.formatSize=function(e){return e=e>=1073741824?s.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?s.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?s.formatNumber(e/1024,0)+" KiB":s.formatNumber(e,0)+" bytes"},s.bytesFromIP=function(e){return-1!==e.indexOf(".")?s.bytesFromIPv4(e):-1!==e.indexOf(":")?s.bytesFromIPv6(e):null},s.bytesFromIPv4=function(e){if(4!==(e=e.split(".")).length)return null;for(var t=s.createBuffer(),r=0;r<e.length;++r){var n=parseInt(e[r],10);if(isNaN(n))return null;t.putByte(n)}return t.getBytes()},s.bytesFromIPv6=function(e){for(var t=0,r=2*(8-(e=e.split(":").filter((function(e){return 0===e.length&&++t,!0}))).length+t),n=s.createBuffer(),i=0;i<8;++i)if(e[i]&&0!==e[i].length){var o=s.hexToBytes(e[i]);o.length<2&&n.putByte(0),n.putBytes(o)}else n.fillWithByte(0,r),r=0;return n.getBytes()},s.bytesToIP=function(e){return 4===e.length?s.bytesToIPv4(e):16===e.length?s.bytesToIPv6(e):null},s.bytesToIPv4=function(e){if(4!==e.length)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")},s.bytesToIPv6=function(e){if(16!==e.length)return null;for(var t=[],r=[],n=0,i=0;i<e.length;i+=2){for(var o=s.bytesToHex(e[i]+e[i+1]);"0"===o[0]&&"0"!==o;)o=o.substr(1);if("0"===o){var a=r[r.length-1],c=t.length;a&&c===a.end+1?(a.end=c,a.end-a.start>r[n].end-r[n].start&&(n=r.length-1)):r.push({start:c,end:c})}t.push(o)}if(r.length>0){var u=r[n];u.end-u.start>0&&(t.splice(u.start,u.end-u.start+1,""),0===u.start&&t.unshift(""),7===u.end&&t.push(""))}return t.join(":")},s.estimateCores=function(e,t){if("function"==typeof e&&(t=e,e={}),e=e||{},"cores"in s&&!e.update)return t(null,s.cores);if("undefined"!=typeof navigator&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return s.cores=navigator.hardwareConcurrency,t(null,s.cores);if("undefined"==typeof Worker)return s.cores=1,t(null,s.cores);if("undefined"==typeof Blob)return s.cores=2,t(null,s.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",(function(e){for(var t=Date.now(),r=t+4;Date.now()<r;);self.postMessage({st:t,et:r})}))}.toString(),")()"],{type:"application/javascript"}));!function e(n,i,o){if(0===i){var a=Math.floor(n.reduce((function(e,t){return e+t}),0)/n.length);return s.cores=Math.max(1,a),URL.revokeObjectURL(r),t(null,s.cores)}!function(e,t){for(var n=[],i=[],o=0;o<e;++o){var s=new Worker(r);s.addEventListener("message",(function(r){if(i.push(r.data),i.length===e){for(var o=0;o<e;++o)n[o].terminate();t(null,i)}})),n.push(s)}for(o=0;o<e;++o)n[o].postMessage(o)}(o,(function(t,r){n.push(function(e,t){for(var r=[],n=0;n<e;++n)for(var i=t[n],o=r[n]=[],s=0;s<e;++s)if(n!==s){var a=t[s];(i.st>a.st&&i.st<a.et||a.st>i.st&&a.st<i.et)&&o.push(s)}return r.reduce((function(e,t){return Math.max(e,t.length)}),0)}(o,r)),e(n,i-1,o)}))}([],5,16)}},25414:(e,t,r)=>{var n=r(3832);r(8925),r(3068),r(33480),r(28991),r(86971),r(66270),r(26953),r(96007),r(28095),r(97116);var i=n.asn1,o=e.exports=n.pki=n.pki||{},s=o.oids,a={};a.CN=s.commonName,a.commonName="CN",a.C=s.countryName,a.countryName="C",a.L=s.localityName,a.localityName="L",a.ST=s.stateOrProvinceName,a.stateOrProvinceName="ST",a.O=s.organizationName,a.organizationName="O",a.OU=s.organizationalUnitName,a.organizationalUnitName="OU",a.E=s.emailAddress,a.emailAddress="E";var c=n.pki.rsa.publicKeyValidator,u={name:"Certificate",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:i.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:i.Class.UNIVERSAL,type:i.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:i.Class.UNIVERSAL,type:i.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:i.Class.UNIVERSAL,type:i.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:i.Class.UNIVERSAL,type:i.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},c,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:i.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:i.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:i.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},l={name:"rsapss",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:i.Class.UNIVERSAL,type:i.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:i.Class.UNIVERSAL,type:i.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:i.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:i.Class.UNIVERSAL,type:i.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:i.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:i.Class.UNIVERSAL,type:i.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},d={name:"CertificationRequestInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},c,{name:"CertificationRequestInfo.attributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0}]}]}]},h={name:"CertificationRequest",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[d,{name:"CertificationRequest.signatureAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:i.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};function f(e,t){"string"==typeof t&&(t={shortName:t});for(var r,n=null,i=0;null===n&&i<e.attributes.length;++i)r=e.attributes[i],(t.type&&t.type===r.type||t.name&&t.name===r.name||t.shortName&&t.shortName===r.shortName)&&(n=r);return n}o.RDNAttributesAsArray=function(e,t){for(var r,n,o,c=[],u=0;u<e.value.length;++u){r=e.value[u];for(var l=0;l<r.value.length;++l)o={},n=r.value[l],o.type=i.derToOid(n.value[0].value),o.value=n.value[1].value,o.valueTagClass=n.value[1].type,o.type in s&&(o.name=s[o.type],o.name in a&&(o.shortName=a[o.name])),t&&(t.update(o.type),t.update(o.value)),c.push(o)}return c},o.CRIAttributesAsArray=function(e){for(var t=[],r=0;r<e.length;++r)for(var n=e[r],c=i.derToOid(n.value[0].value),u=n.value[1].value,l=0;l<u.length;++l){var d={};if(d.type=c,d.value=u[l].value,d.valueTagClass=u[l].type,d.type in s&&(d.name=s[d.type],d.name in a&&(d.shortName=a[d.name])),d.type===s.extensionRequest){d.extensions=[];for(var h=0;h<d.value.length;++h)d.extensions.push(o.certificateExtensionFromAsn1(d.value[h]))}t.push(d)}return t};var p=function(e,t,r){var n={};if(e!==s["RSASSA-PSS"])return n;r&&(n={hash:{algorithmOid:s.sha1},mgf:{algorithmOid:s.mgf1,hash:{algorithmOid:s.sha1}},saltLength:20});var o={},a=[];if(!i.validate(t,l,o,a)){var c=new Error("Cannot read RSASSA-PSS parameter block.");throw c.errors=a,c}return void 0!==o.hashOid&&(n.hash=n.hash||{},n.hash.algorithmOid=i.derToOid(o.hashOid)),void 0!==o.maskGenOid&&(n.mgf=n.mgf||{},n.mgf.algorithmOid=i.derToOid(o.maskGenOid),n.mgf.hash=n.mgf.hash||{},n.mgf.hash.algorithmOid=i.derToOid(o.maskGenHashOid)),void 0!==o.saltLength&&(n.saltLength=o.saltLength.charCodeAt(0)),n},m=function(e){switch(s[e.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return n.md.sha1.create();case"md5WithRSAEncryption":return n.md.md5.create();case"sha256WithRSAEncryption":case"RSASSA-PSS":return n.md.sha256.create();case"sha384WithRSAEncryption":return n.md.sha384.create();case"sha512WithRSAEncryption":return n.md.sha512.create();default:var t=new Error("Could not compute "+e.type+" digest. Unknown signature OID.");throw t.signatureOid=e.signatureOid,t}},g=function(e){var t,r=e.certificate;switch(r.signatureOid){case s.sha1WithRSAEncryption:case s.sha1WithRSASignature:break;case s["RSASSA-PSS"]:var i,o,a;if(void 0===(i=s[r.signatureParameters.mgf.hash.algorithmOid])||void 0===n.md[i])throw(a=new Error("Unsupported MGF hash function.")).oid=r.signatureParameters.mgf.hash.algorithmOid,a.name=i,a;if(void 0===(o=s[r.signatureParameters.mgf.algorithmOid])||void 0===n.mgf[o])throw(a=new Error("Unsupported MGF function.")).oid=r.signatureParameters.mgf.algorithmOid,a.name=o,a;if(o=n.mgf[o].create(n.md[i].create()),void 0===(i=s[r.signatureParameters.hash.algorithmOid])||void 0===n.md[i])throw(a=new Error("Unsupported RSASSA-PSS hash function.")).oid=r.signatureParameters.hash.algorithmOid,a.name=i,a;t=n.pss.create(n.md[i].create(),o,r.signatureParameters.saltLength)}return r.publicKey.verify(e.md.digest().getBytes(),e.signature,t)};function v(e){for(var t,r,o=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),s=e.attributes,a=0;a<s.length;++a){var c=(t=s[a]).value,u=i.Type.PRINTABLESTRING;"valueTagClass"in t&&(u=t.valueTagClass)===i.Type.UTF8&&(c=n.util.encodeUtf8(c)),r=i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.type).getBytes()),i.create(i.Class.UNIVERSAL,u,!1,c)])]),o.value.push(r)}return o}function y(e){for(var t,r=0;r<e.length;++r){if(void 0===(t=e[r]).name&&(t.type&&t.type in o.oids?t.name=o.oids[t.type]:t.shortName&&t.shortName in a&&(t.name=o.oids[a[t.shortName]])),void 0===t.type){if(!t.name||!(t.name in o.oids))throw(c=new Error("Attribute type not specified.")).attribute=t,c;t.type=o.oids[t.name]}if(void 0===t.shortName&&t.name&&t.name in a&&(t.shortName=a[t.name]),t.type===s.extensionRequest&&(t.valueConstructed=!0,t.valueTagClass=i.Type.SEQUENCE,!t.value&&t.extensions)){t.value=[];for(var n=0;n<t.extensions.length;++n)t.value.push(o.certificateExtensionToAsn1(b(t.extensions[n])))}var c;if(void 0===t.value)throw(c=new Error("Attribute value not specified.")).attribute=t,c}}function b(e,t){if(t=t||{},void 0===e.name&&e.id&&e.id in o.oids&&(e.name=o.oids[e.id]),void 0===e.id){if(!e.name||!(e.name in o.oids))throw(w=new Error("Extension ID not specified.")).extension=e,w;e.id=o.oids[e.name]}if(void 0!==e.value)return e;if("keyUsage"===e.name){var r=0,a=0,c=0;e.digitalSignature&&(a|=128,r=7),e.nonRepudiation&&(a|=64,r=6),e.keyEncipherment&&(a|=32,r=5),e.dataEncipherment&&(a|=16,r=4),e.keyAgreement&&(a|=8,r=3),e.keyCertSign&&(a|=4,r=2),e.cRLSign&&(a|=2,r=1),e.encipherOnly&&(a|=1,r=0),e.decipherOnly&&(c|=128,r=7);var u=String.fromCharCode(r);0!==c?u+=String.fromCharCode(a)+String.fromCharCode(c):0!==a&&(u+=String.fromCharCode(a)),e.value=i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,u)}else if("basicConstraints"===e.name)e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),e.cA&&e.value.value.push(i.create(i.Class.UNIVERSAL,i.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in e&&e.value.value.push(i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.pathLenConstraint).getBytes()));else if("extKeyUsage"===e.name){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);var l=e.value.value;for(var d in e)!0===e[d]&&(d in s?l.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(s[d]).getBytes())):-1!==d.indexOf(".")&&l.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(d).getBytes())))}else if("nsCertType"===e.name){r=0,a=0;e.client&&(a|=128,r=7),e.server&&(a|=64,r=6),e.email&&(a|=32,r=5),e.objsign&&(a|=16,r=4),e.reserved&&(a|=8,r=3),e.sslCA&&(a|=4,r=2),e.emailCA&&(a|=2,r=1),e.objCA&&(a|=1,r=0);u=String.fromCharCode(r);0!==a&&(u+=String.fromCharCode(a)),e.value=i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,u)}else if("subjectAltName"===e.name||"issuerAltName"===e.name){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);for(var h=0;h<e.altNames.length;++h){u=(y=e.altNames[h]).value;if(7===y.type&&y.ip){if(null===(u=n.util.bytesFromIP(y.ip)))throw(w=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=e,w}else 8===y.type&&(u=y.oid?i.oidToDer(i.oidToDer(y.oid)):i.oidToDer(u));e.value.value.push(i.create(i.Class.CONTEXT_SPECIFIC,y.type,!1,u))}}else if("nsComment"===e.name&&t.cert){if(!/^[\x00-\x7F]*$/.test(e.comment)||e.comment.length<1||e.comment.length>128)throw new Error('Invalid "nsComment" content.');e.value=i.create(i.Class.UNIVERSAL,i.Type.IA5STRING,!1,e.comment)}else if("subjectKeyIdentifier"===e.name&&t.cert){var f=t.cert.generateSubjectKeyIdentifier();e.subjectKeyIdentifier=f.toHex(),e.value=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,f.getBytes())}else if("authorityKeyIdentifier"===e.name&&t.cert){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);l=e.value.value;if(e.keyIdentifier){var p=!0===e.keyIdentifier?t.cert.generateSubjectKeyIdentifier().getBytes():e.keyIdentifier;l.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!1,p))}if(e.authorityCertIssuer){var m=[i.create(i.Class.CONTEXT_SPECIFIC,4,!0,[v(!0===e.authorityCertIssuer?t.cert.issuer:e.authorityCertIssuer)])];l.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,m))}if(e.serialNumber){var g=n.util.hexToBytes(!0===e.serialNumber?t.cert.serialNumber:e.serialNumber);l.push(i.create(i.Class.CONTEXT_SPECIFIC,2,!1,g))}}else if("cRLDistributionPoints"===e.name){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);l=e.value.value;var y,b=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),E=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[]);for(h=0;h<e.altNames.length;++h){u=(y=e.altNames[h]).value;if(7===y.type&&y.ip){if(null===(u=n.util.bytesFromIP(y.ip)))throw(w=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=e,w}else 8===y.type&&(u=y.oid?i.oidToDer(i.oidToDer(y.oid)):i.oidToDer(u));E.value.push(i.create(i.Class.CONTEXT_SPECIFIC,y.type,!1,u))}b.value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[E])),l.push(b)}var w;if(void 0===e.value)throw(w=new Error("Extension value not specified.")).extension=e,w;return e}function E(e,t){if(e===s["RSASSA-PSS"]){var r=[];return void 0!==t.hash.algorithmOid&&r.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.hash.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])])),void 0!==t.mgf.algorithmOid&&r.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.mgf.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.mgf.hash.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])])])),void 0!==t.saltLength&&r.push(i.create(i.Class.CONTEXT_SPECIFIC,2,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(t.saltLength).getBytes())])),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,r)}return i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")}function w(e){var t=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===e.attributes.length)return t;for(var r=e.attributes,o=0;o<r.length;++o){var s=r[o],a=s.value,c=i.Type.UTF8;"valueTagClass"in s&&(c=s.valueTagClass),c===i.Type.UTF8&&(a=n.util.encodeUtf8(a));var u=!1;"valueConstructed"in s&&(u=s.valueConstructed);var l=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(s.type).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,c,u,a)])]);t.value.push(l)}return t}o.certificateFromPem=function(e,t,r){var s=n.pem.decode(e)[0];if("CERTIFICATE"!==s.type&&"X509 CERTIFICATE"!==s.type&&"TRUSTED CERTIFICATE"!==s.type){var a=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw a.headerType=s.type,a}if(s.procType&&"ENCRYPTED"===s.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var c=i.fromDer(s.body,r);return o.certificateFromAsn1(c,t)},o.certificateToPem=function(e,t){var r={type:"CERTIFICATE",body:i.toDer(o.certificateToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},o.publicKeyFromPem=function(e){var t=n.pem.decode(e)[0];if("PUBLIC KEY"!==t.type&&"RSA PUBLIC KEY"!==t.type){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert public key from PEM; PEM is encrypted.");var s=i.fromDer(t.body);return o.publicKeyFromAsn1(s)},o.publicKeyToPem=function(e,t){var r={type:"PUBLIC KEY",body:i.toDer(o.publicKeyToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},o.publicKeyToRSAPublicKeyPem=function(e,t){var r={type:"RSA PUBLIC KEY",body:i.toDer(o.publicKeyToRSAPublicKey(e)).getBytes()};return n.pem.encode(r,{maxline:t})},o.getPublicKeyFingerprint=function(e,t){var r,s=(t=t||{}).md||n.md.sha1.create();switch(t.type||"RSAPublicKey"){case"RSAPublicKey":r=i.toDer(o.publicKeyToRSAPublicKey(e)).getBytes();break;case"SubjectPublicKeyInfo":r=i.toDer(o.publicKeyToAsn1(e)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+t.type+'".')}s.start(),s.update(r);var a=s.digest();if("hex"===t.encoding){var c=a.toHex();return t.delimiter?c.match(/.{2}/g).join(t.delimiter):c}if("binary"===t.encoding)return a.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".');return a},o.certificationRequestFromPem=function(e,t,r){var s=n.pem.decode(e)[0];if("CERTIFICATE REQUEST"!==s.type){var a=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw a.headerType=s.type,a}if(s.procType&&"ENCRYPTED"===s.procType.type)throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var c=i.fromDer(s.body,r);return o.certificationRequestFromAsn1(c,t)},o.certificationRequestToPem=function(e,t){var r={type:"CERTIFICATE REQUEST",body:i.toDer(o.certificationRequestToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},o.createCertificate=function(){var e={version:2,serialNumber:"00",signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.validity={},e.validity.notBefore=new Date,e.validity.notAfter=new Date,e.issuer={},e.issuer.getField=function(t){return f(e.issuer,t)},e.issuer.addField=function(t){y([t]),e.issuer.attributes.push(t)},e.issuer.attributes=[],e.issuer.hash=null,e.subject={},e.subject.getField=function(t){return f(e.subject,t)},e.subject.addField=function(t){y([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.extensions=[],e.publicKey=null,e.md=null,e.setSubject=function(t,r){y(t),e.subject.attributes=t,delete e.subject.uniqueId,r&&(e.subject.uniqueId=r),e.subject.hash=null},e.setIssuer=function(t,r){y(t),e.issuer.attributes=t,delete e.issuer.uniqueId,r&&(e.issuer.uniqueId=r),e.issuer.hash=null},e.setExtensions=function(t){for(var r=0;r<t.length;++r)b(t[r],{cert:e});e.extensions=t},e.getExtension=function(t){"string"==typeof t&&(t={name:t});for(var r,n=null,i=0;null===n&&i<e.extensions.length;++i)r=e.extensions[i],(t.id&&r.id===t.id||t.name&&r.name===t.name)&&(n=r);return n},e.sign=function(t,r){e.md=r||n.md.sha1.create();var a=s[e.md.algorithm+"WithRSAEncryption"];if(!a){var c=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw c.algorithm=e.md.algorithm,c}e.signatureOid=e.siginfo.algorithmOid=a,e.tbsCertificate=o.getTBSCertificate(e);var u=i.toDer(e.tbsCertificate);e.md.update(u.getBytes()),e.signature=t.sign(e.md)},e.verify=function(t){var r=!1;if(!e.issued(t)){var n=t.issuer,s=e.subject,a=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw a.expectedIssuer=s.attributes,a.actualIssuer=n.attributes,a}var c=t.md;if(null===c){c=m({signatureOid:t.signatureOid,type:"certificate"});var u=t.tbsCertificate||o.getTBSCertificate(t),l=i.toDer(u);c.update(l.getBytes())}return null!==c&&(r=g({certificate:e,md:c,signature:t.signature})),r},e.isIssuer=function(t){var r=!1,n=e.issuer,i=t.subject;if(n.hash&&i.hash)r=n.hash===i.hash;else if(n.attributes.length===i.attributes.length){var o,s;r=!0;for(var a=0;r&&a<n.attributes.length;++a)o=n.attributes[a],s=i.attributes[a],o.type===s.type&&o.value===s.value||(r=!1)}return r},e.issued=function(t){return t.isIssuer(e)},e.generateSubjectKeyIdentifier=function(){return o.getPublicKeyFingerprint(e.publicKey,{type:"RSAPublicKey"})},e.verifySubjectKeyIdentifier=function(){for(var t=s.subjectKeyIdentifier,r=0;r<e.extensions.length;++r){var i=e.extensions[r];if(i.id===t){var o=e.generateSubjectKeyIdentifier().getBytes();return n.util.hexToBytes(i.subjectKeyIdentifier)===o}}return!1},e},o.certificateFromAsn1=function(e,t){var r={},s=[];if(!i.validate(e,u,r,s)){var a=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw a.errors=s,a}if(i.derToOid(r.publicKeyOid)!==o.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var c=o.createCertificate();c.version=r.certVersion?r.certVersion.charCodeAt(0):0;var l=n.util.createBuffer(r.certSerialNumber);c.serialNumber=l.toHex(),c.signatureOid=n.asn1.derToOid(r.certSignatureOid),c.signatureParameters=p(c.signatureOid,r.certSignatureParams,!0),c.siginfo.algorithmOid=n.asn1.derToOid(r.certinfoSignatureOid),c.siginfo.parameters=p(c.siginfo.algorithmOid,r.certinfoSignatureParams,!1),c.signature=r.certSignature;var d=[];if(void 0!==r.certValidity1UTCTime&&d.push(i.utcTimeToDate(r.certValidity1UTCTime)),void 0!==r.certValidity2GeneralizedTime&&d.push(i.generalizedTimeToDate(r.certValidity2GeneralizedTime)),void 0!==r.certValidity3UTCTime&&d.push(i.utcTimeToDate(r.certValidity3UTCTime)),void 0!==r.certValidity4GeneralizedTime&&d.push(i.generalizedTimeToDate(r.certValidity4GeneralizedTime)),d.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(d.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(c.validity.notBefore=d[0],c.validity.notAfter=d[1],c.tbsCertificate=r.tbsCertificate,t){c.md=m({signatureOid:c.signatureOid,type:"certificate"});var h=i.toDer(c.tbsCertificate);c.md.update(h.getBytes())}var g=n.md.sha1.create(),v=i.toDer(r.certIssuer);g.update(v.getBytes()),c.issuer.getField=function(e){return f(c.issuer,e)},c.issuer.addField=function(e){y([e]),c.issuer.attributes.push(e)},c.issuer.attributes=o.RDNAttributesAsArray(r.certIssuer),r.certIssuerUniqueId&&(c.issuer.uniqueId=r.certIssuerUniqueId),c.issuer.hash=g.digest().toHex();var b=n.md.sha1.create(),E=i.toDer(r.certSubject);return b.update(E.getBytes()),c.subject.getField=function(e){return f(c.subject,e)},c.subject.addField=function(e){y([e]),c.subject.attributes.push(e)},c.subject.attributes=o.RDNAttributesAsArray(r.certSubject),r.certSubjectUniqueId&&(c.subject.uniqueId=r.certSubjectUniqueId),c.subject.hash=b.digest().toHex(),r.certExtensions?c.extensions=o.certificateExtensionsFromAsn1(r.certExtensions):c.extensions=[],c.publicKey=o.publicKeyFromAsn1(r.subjectPublicKeyInfo),c},o.certificateExtensionsFromAsn1=function(e){for(var t=[],r=0;r<e.value.length;++r)for(var n=e.value[r],i=0;i<n.value.length;++i)t.push(o.certificateExtensionFromAsn1(n.value[i]));return t},o.certificateExtensionFromAsn1=function(e){var t={};if(t.id=i.derToOid(e.value[0].value),t.critical=!1,e.value[1].type===i.Type.BOOLEAN?(t.critical=0!==e.value[1].value.charCodeAt(0),t.value=e.value[2].value):t.value=e.value[1].value,t.id in s)if(t.name=s[t.id],"keyUsage"===t.name){var r=0,o=0;(c=i.fromDer(t.value)).value.length>1&&(r=c.value.charCodeAt(1),o=c.value.length>2?c.value.charCodeAt(2):0),t.digitalSignature=128==(128&r),t.nonRepudiation=64==(64&r),t.keyEncipherment=32==(32&r),t.dataEncipherment=16==(16&r),t.keyAgreement=8==(8&r),t.keyCertSign=4==(4&r),t.cRLSign=2==(2&r),t.encipherOnly=1==(1&r),t.decipherOnly=128==(128&o)}else if("basicConstraints"===t.name){(c=i.fromDer(t.value)).value.length>0&&c.value[0].type===i.Type.BOOLEAN?t.cA=0!==c.value[0].value.charCodeAt(0):t.cA=!1;var a=null;c.value.length>0&&c.value[0].type===i.Type.INTEGER?a=c.value[0].value:c.value.length>1&&(a=c.value[1].value),null!==a&&(t.pathLenConstraint=i.derToInteger(a))}else if("extKeyUsage"===t.name)for(var c=i.fromDer(t.value),u=0;u<c.value.length;++u){var l=i.derToOid(c.value[u].value);l in s?t[s[l]]=!0:t[l]=!0}else if("nsCertType"===t.name){r=0;(c=i.fromDer(t.value)).value.length>1&&(r=c.value.charCodeAt(1)),t.client=128==(128&r),t.server=64==(64&r),t.email=32==(32&r),t.objsign=16==(16&r),t.reserved=8==(8&r),t.sslCA=4==(4&r),t.emailCA=2==(2&r),t.objCA=1==(1&r)}else if("subjectAltName"===t.name||"issuerAltName"===t.name){var d;t.altNames=[];c=i.fromDer(t.value);for(var h=0;h<c.value.length;++h){var f={type:(d=c.value[h]).type,value:d.value};switch(t.altNames.push(f),d.type){case 1:case 2:case 6:break;case 7:f.ip=n.util.bytesToIP(d.value);break;case 8:f.oid=i.derToOid(d.value)}}}else if("subjectKeyIdentifier"===t.name){c=i.fromDer(t.value);t.subjectKeyIdentifier=n.util.bytesToHex(c.value)}return t},o.certificationRequestFromAsn1=function(e,t){var r={},s=[];if(!i.validate(e,h,r,s)){var a=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw a.errors=s,a}if(i.derToOid(r.publicKeyOid)!==o.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var c=o.createCertificationRequest();if(c.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,c.signatureOid=n.asn1.derToOid(r.csrSignatureOid),c.signatureParameters=p(c.signatureOid,r.csrSignatureParams,!0),c.siginfo.algorithmOid=n.asn1.derToOid(r.csrSignatureOid),c.siginfo.parameters=p(c.siginfo.algorithmOid,r.csrSignatureParams,!1),c.signature=r.csrSignature,c.certificationRequestInfo=r.certificationRequestInfo,t){c.md=m({signatureOid:c.signatureOid,type:"certification request"});var u=i.toDer(c.certificationRequestInfo);c.md.update(u.getBytes())}var l=n.md.sha1.create();return c.subject.getField=function(e){return f(c.subject,e)},c.subject.addField=function(e){y([e]),c.subject.attributes.push(e)},c.subject.attributes=o.RDNAttributesAsArray(r.certificationRequestInfoSubject,l),c.subject.hash=l.digest().toHex(),c.publicKey=o.publicKeyFromAsn1(r.subjectPublicKeyInfo),c.getAttribute=function(e){return f(c,e)},c.addAttribute=function(e){y([e]),c.attributes.push(e)},c.attributes=o.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),c},o.createCertificationRequest=function(){var e={version:0,signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.subject={},e.subject.getField=function(t){return f(e.subject,t)},e.subject.addField=function(t){y([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.publicKey=null,e.attributes=[],e.getAttribute=function(t){return f(e,t)},e.addAttribute=function(t){y([t]),e.attributes.push(t)},e.md=null,e.setSubject=function(t){y(t),e.subject.attributes=t,e.subject.hash=null},e.setAttributes=function(t){y(t),e.attributes=t},e.sign=function(t,r){e.md=r||n.md.sha1.create();var a=s[e.md.algorithm+"WithRSAEncryption"];if(!a){var c=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw c.algorithm=e.md.algorithm,c}e.signatureOid=e.siginfo.algorithmOid=a,e.certificationRequestInfo=o.getCertificationRequestInfo(e);var u=i.toDer(e.certificationRequestInfo);e.md.update(u.getBytes()),e.signature=t.sign(e.md)},e.verify=function(){var t=!1,r=e.md;if(null===r){r=m({signatureOid:e.signatureOid,type:"certification request"});var n=e.certificationRequestInfo||o.getCertificationRequestInfo(e),s=i.toDer(n);r.update(s.getBytes())}return null!==r&&(t=g({certificate:e,md:r,signature:e.signature})),t},e};var S=new Date("1950-01-01T00:00:00Z"),_=new Date("2050-01-01T00:00:00Z");function T(e){return e>=S&&e<_?i.create(i.Class.UNIVERSAL,i.Type.UTCTIME,!1,i.dateToUtcTime(e)):i.create(i.Class.UNIVERSAL,i.Type.GENERALIZEDTIME,!1,i.dateToGeneralizedTime(e))}o.getTBSCertificate=function(e){var t=T(e.validity.notBefore),r=T(e.validity.notAfter),s=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes())]),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,n.util.hexToBytes(e.serialNumber)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.siginfo.algorithmOid).getBytes()),E(e.siginfo.algorithmOid,e.siginfo.parameters)]),v(e.issuer),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[t,r]),v(e.subject),o.publicKeyToAsn1(e.publicKey)]);return e.issuer.uniqueId&&s.value.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,[i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.issuer.uniqueId)])),e.subject.uniqueId&&s.value.push(i.create(i.Class.CONTEXT_SPECIFIC,2,!0,[i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.subject.uniqueId)])),e.extensions.length>0&&s.value.push(o.certificateExtensionsToAsn1(e.extensions)),s},o.getCertificationRequestInfo=function(e){return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),v(e.subject),o.publicKeyToAsn1(e.publicKey),w(e)])},o.distinguishedNameToAsn1=function(e){return v(e)},o.certificateToAsn1=function(e){var t=e.tbsCertificate||o.getTBSCertificate(e);return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[t,i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.signatureOid).getBytes()),E(e.signatureOid,e.signatureParameters)]),i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},o.certificateExtensionsToAsn1=function(e){var t=i.create(i.Class.CONTEXT_SPECIFIC,3,!0,[]),r=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);t.value.push(r);for(var n=0;n<e.length;++n)r.value.push(o.certificateExtensionToAsn1(e[n]));return t},o.certificateExtensionToAsn1=function(e){var t=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);t.value.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.id).getBytes())),e.critical&&t.value.push(i.create(i.Class.UNIVERSAL,i.Type.BOOLEAN,!1,String.fromCharCode(255)));var r=e.value;return"string"!=typeof e.value&&(r=i.toDer(r).getBytes()),t.value.push(i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,r)),t},o.certificationRequestToAsn1=function(e){var t=e.certificationRequestInfo||o.getCertificationRequestInfo(e);return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[t,i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.signatureOid).getBytes()),E(e.signatureOid,e.signatureParameters)]),i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},o.createCaStore=function(e){var t={certs:{}};function r(e){return s(e),t.certs[e.hash]||null}function s(e){if(!e.hash){var t=n.md.sha1.create();e.attributes=o.RDNAttributesAsArray(v(e),t),e.hash=t.digest().toHex()}}if(t.getIssuer=function(e){return r(e.issuer)},t.addCertificate=function(e){if("string"==typeof e&&(e=n.pki.certificateFromPem(e)),s(e.subject),!t.hasCertificate(e))if(e.subject.hash in t.certs){var r=t.certs[e.subject.hash];n.util.isArray(r)||(r=[r]),r.push(e),t.certs[e.subject.hash]=r}else t.certs[e.subject.hash]=e},t.hasCertificate=function(e){"string"==typeof e&&(e=n.pki.certificateFromPem(e));var t=r(e.subject);if(!t)return!1;n.util.isArray(t)||(t=[t]);for(var s=i.toDer(o.certificateToAsn1(e)).getBytes(),a=0;a<t.length;++a){if(s===i.toDer(o.certificateToAsn1(t[a])).getBytes())return!0}return!1},t.listAllCertificates=function(){var e=[];for(var r in t.certs)if(t.certs.hasOwnProperty(r)){var i=t.certs[r];if(n.util.isArray(i))for(var o=0;o<i.length;++o)e.push(i[o]);else e.push(i)}return e},t.removeCertificate=function(e){var a;if("string"==typeof e&&(e=n.pki.certificateFromPem(e)),s(e.subject),!t.hasCertificate(e))return null;var c=r(e.subject);if(!n.util.isArray(c))return a=t.certs[e.subject.hash],delete t.certs[e.subject.hash],a;for(var u=i.toDer(o.certificateToAsn1(e)).getBytes(),l=0;l<c.length;++l){u===i.toDer(o.certificateToAsn1(c[l])).getBytes()&&(a=c[l],c.splice(l,1))}return 0===c.length&&delete t.certs[e.subject.hash],a},e)for(var a=0;a<e.length;++a){var c=e[a];t.addCertificate(c)}return t},o.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},o.verifyCertificateChain=function(e,t,r){"function"==typeof r&&(r={verify:r}),r=r||{};var i=(t=t.slice(0)).slice(0),s=r.validityCheckDate;void 0===s&&(s=new Date);var a=!0,c=null,u=0;do{var l=t.shift(),d=null,h=!1;if(s&&(s<l.validity.notBefore||s>l.validity.notAfter)&&(c={message:"Certificate is not valid yet or has expired.",error:o.certificateError.certificate_expired,notBefore:l.validity.notBefore,notAfter:l.validity.notAfter,now:s}),null===c){if(null===(d=t[0]||e.getIssuer(l))&&l.isIssuer(l)&&(h=!0,d=l),d){var f=d;n.util.isArray(f)||(f=[f]);for(var p=!1;!p&&f.length>0;){d=f.shift();try{p=d.verify(l)}catch(e){}}p||(c={message:"Certificate signature is invalid.",error:o.certificateError.bad_certificate})}null!==c||d&&!h||e.hasCertificate(l)||(c={message:"Certificate is not trusted.",error:o.certificateError.unknown_ca})}if(null===c&&d&&!l.isIssuer(d)&&(c={message:"Certificate issuer is invalid.",error:o.certificateError.bad_certificate}),null===c)for(var m={keyUsage:!0,basicConstraints:!0},g=0;null===c&&g<l.extensions.length;++g){var v=l.extensions[g];v.critical&&!(v.name in m)&&(c={message:"Certificate has an unsupported critical extension.",error:o.certificateError.unsupported_certificate})}if(null===c&&(!a||0===t.length&&(!d||h))){var y=l.getExtension("basicConstraints"),b=l.getExtension("keyUsage");if(null!==b&&(b.keyCertSign&&null!==y||(c={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:o.certificateError.bad_certificate})),null!==c||null===y||y.cA||(c={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:o.certificateError.bad_certificate}),null===c&&null!==b&&"pathLenConstraint"in y)u-1>y.pathLenConstraint&&(c={message:"Certificate basicConstraints pathLenConstraint violated.",error:o.certificateError.bad_certificate})}var E=null===c||c.error,w=r.verify?r.verify(E,u,i):E;if(!0!==w)throw!0===E&&(c={message:"The application rejected the certificate.",error:o.certificateError.bad_certificate}),(w||0===w)&&("object"!=typeof w||n.util.isArray(w)?"string"==typeof w&&(c.error=w):(w.message&&(c.message=w.message),w.error&&(c.error=w.error))),c;c=null,a=!1,++u}while(t.length>0);return!0}},11379:(e,t,r)=>{"use strict";var n=r(83748),i=r(61733),o=r(48545),s=r(41194),a=r(64678),c=r(44237);function u(e){if(16!==e.length)throw new Error("invalid iv")}function l(e){return n.setupFallback((function(t,r,i){try{u(i)}catch(e){return Promise.reject(e)}var o=Promise.resolve(r);return o=o.then((function(r){var o="AES-"+e+"-CBC",s=n.nodeCrypto.createCipheriv(o,t,i);return Buffer.concat([s.update(r),s.final()])})),o}),(function(e,t,r){try{u(r)}catch(e){return Promise.reject(e)}var i=Promise.resolve();return i=(i=(i=i.then((function(){return n.subtleCrypto.importKey("raw",e,{name:"AES-CBC"},!0,["encrypt"])}))).then((function(e){var i={name:"AES-CBC",iv:r};return n.subtleCrypto.encrypt(i,e,t)}))).then((function(e){return e=Buffer.from(e)}))}),(function(e,t,r){try{u(r)}catch(e){return Promise.reject(e)}var n=Promise.resolve();return n=n.then((function(){var n=s.cipher.createCipher("AES-CBC",new a(e));return n.start({iv:new a(r)}),n.update(new a(t)),n.finish()?Buffer.from(n.output.bytes(),"binary"):Promise.reject(new Error("encryption failed"))}))}))}function d(e){return n.setupFallback((function(t,r,i){try{u(i)}catch(e){return Promise.reject(e)}var o=Promise.resolve();return o=o.then((function(){var o="AES-"+e+"-CBC",s=n.nodeCrypto.createDecipheriv(o,t,i);return Buffer.concat([s.update(r),s.final()])}))}),(function(e,t,r){try{u(r)}catch(e){return Promise.reject(e)}var i=Promise.resolve();return i=(i=(i=i.then((function(){return n.subtleCrypto.importKey("raw",e,{name:"AES-CBC"},!0,["decrypt"])}))).then((function(e){var i={name:"AES-CBC",iv:r};return n.subtleCrypto.decrypt(i,e,t)}))).then((function(e){return e=Buffer.from(e)}))}),(function(e,t,r){try{u(r)}catch(e){return Promise.reject(e)}var n=Promise.resolve();return n=n.then((function(){var n=s.cipher.createDecipher("AES-CBC",new a(e));return n.start({iv:new a(r)}),n.update(new a(t)),n.finish()?Buffer.from(n.output.bytes(),"binary"):Promise.reject(new Error("encryption failed"))}))}))}function h(e,t){if(t<<1!=e.length<<3)throw new Error("invalid encryption key size")}function f(e){var t=l(e);return function(r,o,s){try{h(r,e)}catch(e){return Promise.reject(e)}var a=r.slice(e/8),c=r.slice(0,e/8),u=s.iv||Buffer.alloc(0),l=s.aad||s.adata||Buffer.alloc(0),d=t(a,o,u);return d=d.then((function(t){var r=Buffer.concat([l,u,t,n.int64ToBuffer(8*l.length)]);return i["HS"+2*e].sign(c,r,{length:e}).then((function(r){var n=r.mac.slice(0,e/8);return{data:t,tag:n}}))}))}}function p(e){var t=d(e);return function(r,o,s){try{h(r,e)}catch(e){return Promise.reject(e)}var a=r.slice(e/8),c=r.slice(0,e/8),u=s.iv||Buffer.alloc(0),l=s.aad||s.adata||Buffer.alloc(0),d=s.tag||s.mac||Buffer.alloc(0),f=Promise.resolve();return f=(f=f.then((function(){var t=Buffer.concat([l,u,o,n.int64ToBuffer(8*l.length)]);return i["HS"+2*e].verify(c,t,d,{length:e}).then((function(){return o}),(function(){throw new Error("mac check failed")}))}))).then((function(){return t(a,o,u)}))}}var m=Buffer.from("Encryption","utf8"),g=Buffer.from("Integrity","utf8"),v=Buffer.from(".","utf8");function y(e,t,r,i){var s=8*e.length,a=s/2,c=Promise.resolve();return c=(c=c.then((function(){return Buffer.concat([n.int32ToBuffer(1),e,n.int32ToBuffer(a),Buffer.from(t,"utf8"),r,i,m])}))).then((function(e){return o["SHA-"+s].digest(e).then((function(e){return e.slice(0,a/8)}))})),c=Promise.resolve(c)}function b(e,t,r,i){var s=8*e.length,a=s,c=Promise.resolve();return c=(c=c.then((function(){return Buffer.concat([n.int32ToBuffer(1),e,n.int32ToBuffer(a),Buffer.from(t,"utf8"),r,i,g])}))).then((function(e){return o["SHA-"+s].digest(e).then((function(e){return e.slice(0,a/8)}))})),c=Promise.resolve(c)}function E(e,t){var r=l(e);return function(o,s,a){var u,l,d=a.epu||n.int32ToBuffer(0),h=a.epv||n.int32ToBuffer(0),f=a.iv||Buffer.alloc(0),p=a.aad||a.adata||Buffer.alloc(0),m=a.kdata||Buffer.alloc(0),g=[y(o,t,d,h),b(o,t,d,h)],E=Promise.all(g).then((function(e){u=e[0],l=e[1]}));return E=(E=(E=E.then((function(){return r(u,s,f)}))).then((function(t){var r=Buffer.concat([p,v,Buffer.from(m),v,Buffer.from(c.base64url.encode(f),"utf8"),v,Buffer.from(c.base64url.encode(t),"utf8")]);return Promise.all([Promise.resolve(t),i["HS"+2*e].sign(l,r,{length:e})])}))).then((function(e){return{data:e[0],tag:e[1].mac}}))}}function w(e,t){var r=d(e);return function(o,s,a){var u,l,d=a.epu||n.int32ToBuffer(0),h=a.epv||n.int32ToBuffer(0),f=a.iv||Buffer.alloc(0),p=a.aad||a.adata||Buffer.alloc(0),m=a.kdata||Buffer.alloc(0),g=a.tag||a.mac||Buffer.alloc(0),E=[y(o,t,d,h),b(o,t,d,h)],w=Promise.all(E).then((function(e){u=e[0],l=e[1]}));return w=(w=w.then((function(){var t=Buffer.concat([p,v,Buffer.from(m),v,Buffer.from(c.base64url.encode(f),"utf8"),v,Buffer.from(c.base64url.encode(s),"utf8")]);try{return i["HS"+2*e].verify(l,t,g,{loose:!1})}catch(e){throw new Error("mac check failed")}}))).then((function(){return r(u,s,f)}))}}var S={};["A128CBC-HS256","A192CBC-HS384","A256CBC-HS512"].forEach((function(e){var t=parseInt(/A(\d+)CBC-HS(\d+)?/g.exec(e)[1]);S[e]={encrypt:f(t),decrypt:p(t)}})),["A128CBC+HS256","A192CBC+HS384","A256CBC+HS512"].forEach((function(e){var t=parseInt(/A(\d+)CBC\+HS(\d+)?/g.exec(e)[1]);S[e]={encrypt:E(t,e),decrypt:w(t,e)}})),e.exports=S},82736:(e,t,r)=>{"use strict";var n=r(83748),i=r(44237),o=r(50414),s=r(49560);function a(e,t){function r(r,n){if(e!==r.length<<3)throw new Error("invalid key size");if(!n&&!t)throw new Error("invalid iv");if(n&&12!==n.length)throw new Error("invalid iv")}function a(e){if(t){var r=i.base64url.encode(e.iv),n=i.base64url.encode(e.tag);e={data:e.data,header:{iv:r,tag:n}}}return e}return n.setupFallback((function(e,t,o){var s=o.iv,c=o.aad||o.adata||Buffer.alloc(0);try{r(e,s)}catch(e){return Promise.reject(e)}s=s||i.randomBytes(12);var u,l="aes-"+8*e.length+"-gcm";try{u=n.nodeCrypto.createCipheriv(l,e,s)}catch(e){throw new Error("unsupported algorithm: "+l)}if("function"!=typeof u.setAAD)throw new Error("unsupported algorithm: "+l);return c.length&&u.setAAD(c),a({data:Buffer.concat([u.update(t),u.final()]),iv:s,tag:u.getAuthTag()})}),(function(e,t,o){var s=o.iv,c=o.aad||o.adata||Buffer.alloc(0);try{r(e,s)}catch(e){return Promise.reject(e)}s=s||i.randomBytes(12);var u={name:"AES-GCM"};return n.subtleCrypto.importKey("raw",e,u,!0,["encrypt"]).then((function(e){return u.iv=s,u.tagLength=128,c.length&&(u.additionalData=c),n.subtleCrypto.encrypt(u,e,t)})).then((function(e){var t=e.byteLength-16,r=e.slice(t);r=Buffer.from(r);var n=e.slice(0,t);return a({data:n=Buffer.from(n),iv:s,tag:r})}))}),(function(e,t,n){var c,u,l=n.iv,d=n.aad||n.adata||Buffer.alloc(0);try{r(e,l)}catch(e){return Promise.reject(e)}return l=l||i.randomBytes(12),c=s.createCipher({key:e,iv:l,additionalData:d}),u=Buffer.alloc(t.length),new Promise((function(e,r){var n=o.CHUNK_SIZE,i=0,s=0;!function o(){var d=Math.min(n,t.length-s);if(i+=c.update(t,s,d,u,i),s+=d,t.length>s)setTimeout(o,0);else if((i+=c.finish(u,i))===t.length){var h=c.tag;e(a({data:u,iv:l,tag:h}))}else r(new Error("encryption failed"))}()}))}))}function c(e){function t(t,r,n){if(e!==t.length<<3)throw new Error("invalid key size");if(12!==r.length)throw new Error("invalid iv");if(16!==n.length)throw new Error("invalid tag length")}return n.setupFallback((function(e,r,i){var o=i.aad||i.adata||Buffer.alloc(0),s=i.iv||Buffer.alloc(0),a=i.tag||i.mac||Buffer.alloc(0);try{t(e,s,a)}catch(e){return Promise.reject(e)}var c,u="aes-"+8*e.length+"-gcm";try{c=n.nodeCrypto.createDecipheriv(u,e,s)}catch(e){throw new Error("unsupported algorithm: "+u)}if("function"!=typeof c.setAAD)throw new Error("unsupported algorithm: "+u);c.setAuthTag(a),o.length&&c.setAAD(o);try{return Buffer.concat([c.update(r),c.final()])}catch(e){throw new Error("decryption failed")}}),(function(e,r,i){var o=i.aad||i.adata||Buffer.alloc(0),s=i.iv||Buffer.alloc(0),a=i.tag||i.mac||Buffer.alloc(0);try{t(e,s,a)}catch(e){return Promise.reject(e)}var c={name:"AES-GCM"};return n.subtleCrypto.importKey("raw",e,c,!0,["decrypt"]).then((function(e){return c.iv=s,c.tagLength=128,o.length&&(c.additionalData=o),r=Buffer.concat([r,a],r.length+a.length),n.subtleCrypto.decrypt(c,e,r)})).then((function(e){return e=Buffer.from(e)}))}),(function(e,r,n){var i,a,c=n.aad||n.adata||Buffer.alloc(0),u=n.iv||Buffer.alloc(0),l=n.tag||n.mac||Buffer.alloc(0);try{t(e,u,l)}catch(e){return Promise.reject(e)}return i=s.createDecipher({key:e,iv:u,additionalData:c,tag:l}),a=Buffer.alloc(r.length),new Promise((function(e,t){var n=o.CHUNK_SIZE,s=0,c=0;!function o(){var u=Math.min(n,r.length-c);if(s+=i.update(r,c,u,a,s),c+=u,r.length>c)setTimeout(o,0);else{try{s+=i.finish(a,s)}catch(e){return void t(new Error("decryption failed"))}s===r.length?e(a):t(new Error("decryption failed"))}}()}))}))}var u={};["A128GCM","A192GCM","A256GCM","A128GCMKW","A192GCMKW","A256GCMKW"].forEach((function(e){var t=/A(\d+)GCM(KW)?/g.exec(e),r=parseInt(t[1]),n="KW"===t[2];u[e]={encrypt:a(r,n),decrypt:c(r)}})),e.exports=u},44179:(e,t,r)=>{"use strict";var n=r(83748),i=r(41194),o=r(64678),s=Buffer.from("a6a6a6a6a6a6a6a6","hex");function a(e,t){for(var r=Math.max(e.length,t.length),n=Buffer.alloc(r),i=0;r>i;i++)n[i]=(e[i]||0)^(t[i]||0);return n}function c(e,t){for(var r=[],n=0;e.length>n;n+=t)r.push(e.slice(n,n+t));return r}function u(e){var t=Math.floor(e/4294967296),r=e%4294967296,n=Buffer.alloc(8);return n[0]=255&t>>>24,n[1]=255&t>>>16,n[2]=255&t>>>8,n[3]=255&t>>>0,n[4]=255&r>>>24,n[5]=255&r>>>16,n[6]=255&r>>>8,n[7]=255&r>>>0,n}function l(e){function t(t,r){if(e!==t.length<<3)throw new Error("invalid key size");if(0<r.length&&0!=r.length%8)throw new Error("invalid data length")}return n.setupFallback((function(r,i){try{t(r,i)}catch(e){return Promise.reject(e)}var o,l,d,h=c(i,8),f=Buffer.alloc(16);o=s;for(var p=0;6>p;p++)for(var m=0;h.length>m;m++){d=h.length*p+m+1,l=Buffer.concat([o,h[m]]),o=a((l=n.nodeCrypto.createCipheriv("AES"+e,r,f).update(l)).slice(0,8),u(d)),h[m]=l.slice(8,16)}h=[o].concat(h);var g=Buffer.concat(h);return Promise.resolve({data:g})}),(function(e,r){try{t(e,r)}catch(e){return Promise.reject(e)}var i={name:"AES-KW"},o=[n.subtleCrypto.importKey("raw",r,{name:"HMAC",hash:"SHA-256"},!0,["sign"]),n.subtleCrypto.importKey("raw",e,i,!0,["wrapKey"])];return o=(o=(o=Promise.all(o)).then((function(e){return n.subtleCrypto.wrapKey("raw",e[0],e[1],i)}))).then((function(e){return{data:e=Buffer.from(e)}}))}),(function(e,r){try{t(e,r)}catch(e){return Promise.reject(e)}var n,l,d,h=i.cipher.createCipher("AES",new o(e)),f=c(r,8);n=s;for(var p=0;6>p;p++)for(var m=0;f.length>m;m++)d=f.length*p+m+1,l=Buffer.concat([n,f[m]]),h.start(),h.update(new o(l)),h.finish(),n=a((l=Buffer.from(h.output.bytes(),"binary")).slice(0,8),u(d)),f[m]=l.slice(8,16);f=[n].concat(f);var g=Buffer.concat(f);return Promise.resolve({data:g})}))}function d(e){function t(t,r){if(e!==t.length<<3)throw new Error("invalid key size");if(0<r.length-8&&0!=r.length%8)throw new Error("invalid data length")}return n.setupFallback((function(r,i){try{t(r,i)}catch(e){return Promise.reject(e)}var o,l,d=c(i,8),h=Buffer.alloc(16);o=d[0],d=d.slice(1);for(var f=5;0<=f;--f)for(var p=d.length-1;0<=p;--p){l=a(o,u(d.length*f+p+1)),l=Buffer.concat([l,d[p],h]),o=(l=n.nodeCrypto.createDecipheriv("AES"+e,r,h).update(l)).slice(0,8),d[p]=l.slice(8,16)}if(o.toString()!==s.toString())return Promise.reject(new Error("decryption failed"));var m=Buffer.concat(d);return Promise.resolve(m)}),(function(e,r){try{t(e,r)}catch(e){return Promise.reject(e)}var i={name:"AES-KW"},o=n.subtleCrypto.importKey("raw",e,i,!0,["unwrapKey"]);return o=o.then((function(e){return n.subtleCrypto.unwrapKey("raw",r,e,i,{name:"HMAC",hash:"SHA-256"},!0,["sign"])})),o=(o=o.then((function(e){return n.subtleCrypto.exportKey("raw",e)}))).then((function(e){return e=Buffer.from(e)}))}),(function(e,r){try{t(e,r)}catch(e){return Promise.reject(e)}var n,l,d=i.cipher.createDecipher("AES",new o(e)),h=c(r,8);n=h[0],h=h.slice(1);for(var f=5;0<=f;--f)for(var p=h.length-1;0<=p;--p)l=a(n,u(h.length*f+p+1)),l=Buffer.concat([l,h[p]]),d.start(),d.update(new o(l)),d.finish(),n=(l=Buffer.from(d.output.bytes(),"binary")).slice(0,8),h[p]=l.slice(8,16);if(n.toString()!==s.toString())return Promise.reject(new Error("decryption failed"));var m=Buffer.concat(h);return Promise.resolve(m)}))}var h={};["A128KW","A192KW","A256KW"].forEach((function(e){var t=parseInt(/A(\d+)KW/g.exec(e)[1]);h[e]={encrypt:l(t),decrypt:d(t)}})),e.exports=h},42319:(e,t,r)=>{"use strict";var n=r(50414),i=r(48545);function o(e){e=e.replace("CONCAT-","");return function(t,r){var o=(r=r||{}).length,s=n.HASHLENGTH[e];if(!o)return Promise.reject(new Error("invalid key length"));if(!r.otherInfo)return Promise.reject(new Error("invalid otherInfo"));var a=r.otherInfo,c=i[e].digest,u=Math.ceil(o/s),l=0,d=[];return function e(){if(u===l++)return Buffer.concat(d).slice(0,o);var r=Buffer.alloc(4+t.length+a.length);return r.writeUInt32BE(l,0),t.copy(r,4),a.copy(r,4+t.length),c(r).then((function(t){return d.push(t),e()}))}()}}var s={};["CONCAT-SHA-1","CONCAT-SHA-256","CONCAT-SHA-384","CONCAT-SHA-512"].forEach((function(e){s[e]={derive:o(e)}})),e.exports=s},50414:e=>{"use strict";e.exports={CHUNK_SIZE:1024,HASHLENGTH:{"SHA-1":160,"SHA-256":256,"SHA-384":384,"SHA-512":512},ENCLENGTH:{"AES-128-CBC":128,"AES-192-CBC":192,"AES-256-CBC":256,"AES-128-KW":128,"AES-192-KW":192,"AES-256-KW":256},KEYLENGTH:{"A128CBC-HS256":256,"A192CBC-HS384":384,"A256CBC-HS512":512,"A128CBC+HS256":256,"A192CBC+HS384":384,"A256CBC+HS512":512,A128GCM:128,A192GCM:192,A256GCM:256,A128KW:128,A192KW:192,A256KW:256,"ECDH-ES+A128KW":128,"ECDH-ES+A192KW":192,"ECDH-ES+A256KW":256},NONCELENGTH:{"A128CBC-HS256":128,"A192CBC-HS384":128,"A256CBC-HS512":128,"A128CBC+HS256":128,"A192CBC+HS384":128,"A256CBC+HS512":128,A128GCM:96,A192GCM:96,A256GCM:96}}},82274:e=>{"use strict";var t={dir:{encrypt:function(e){return Promise.resolve({data:e,once:!0,direct:!0})},decrypt:function(e){return Promise.resolve(e)}}};e.exports=t},71762:(e,t,r)=>{"use strict";var n=r(66678),i=r(91634),o=r(41194),s=r(44237),a={"P-256":256,"P-384":384,"P-521":521};function c(e,t){var r=n(e);return(t?["x","y"]:["d"]).forEach((function(e){r[e]=s.asBuffer(r[e],"base64url")})),r}var u=Buffer.from([4]);var l="1.2.840.10045.2.1";var d="Could not extract parameters from DER signature";function h(e,t,r){for(var n=0;t+n<r&&0===e[t+n];)++n;return e[t+n]>=128&&--n,n}e.exports={convertToForge:function(e,t){var r=t?["x","y"]:["d"];return r=r.map((function(t){return new o.jsbn.BigInteger(e[t].toString("hex"),16)})),r=[e.crv].concat(r),(t?i.asPublicKey:i.asPrivateKey).apply(i,r)},convertToJWK:function(e,t){var r=n(e);return(t?["x","y"]:["x","y","d"]).forEach((function(e){r[e]=s.base64url.encode(r[e])})),delete r.key_ops,delete r.use,delete r.alg,t&&delete r.d,r},convertToObj:c,convertToBuffer:function(e,t){return e=c(e,t),t?Buffer.concat([u,e.x,e.y]):e.d},curveSize:function(e){return a[e||""]||NaN},derToConcat:function(e,t){var r=0;if(48!==e[r++])throw new Error(d);var n=e[r++];if(129===n&&(n=e[r++]),n>e.length-r)throw new Error(d);if(2!==e[r++])throw new Error(d);var i=e[r++];if(i>e.length-r-2)throw new Error(d);if(i>t+1)throw new Error(d);var o=r;if(r+=i,2!==e[r++])throw new Error(d);var s=e[r++];if(s!==e.length-r)throw new Error(d);if(s>t+1)throw new Error(d);var a=r;if((r+=s)!==e.length)throw new Error(d);var c=t-i,u=t-s,l=Buffer.alloc(c+i+u+s);for(r=0;r<c;++r)l[r]=0;var h=Math.max(-c,0);e.copy(l,r,o+h,o+i);for(var f=r=t;r<f+u;++r)l[r]=0;var p=Math.max(-u,0);return e.copy(l,r,a+p,a+s),l},concatToDer:function(e,t){var r=h(e,0,t),n=h(e,t,e.length),i=t-r,o=t-n,s=i+o+4,a=s<128,c=Buffer.alloc((a?2:3)+s),u=0;return c[u++]=48,a?c[u++]=s:(c[u++]=129,c[u++]=255&s),c[u++]=2,c[u++]=i,r<0?(c[u++]=0,u+=e.copy(c,u,0,t)):u+=e.copy(c,u,r,t),c[u++]=2,c[u++]=o,n<0?(c[u++]=0,e.copy(c,u,t)):e.copy(c,u,t+n),c},convertToPEM:function(e,t){var r,n,i,s=e.crv;return s=function(e){switch(e){case"P-256":return"1.2.840.10045.3.1.7";case"P-384":return"1.3.132.0.34";case"P-521":return"1.3.132.0.35";default:return null}}(s),s=o.asn1.oidToDer(s),t?(r="EC PRIVATE KEY",n=Buffer.concat([Buffer.from([0,4]),e.x,e.y]).toString("binary"),e=e.d.toString("binary"),i=o.asn1.create(o.asn1.Class.UNIVERSAL,o.asn1.Type.SEQUENCE,!0,[o.asn1.create(o.asn1.Class.UNIVERSAL,o.asn1.Type.INTEGER,!1,""),o.asn1.create(o.asn1.Class.UNIVERSAL,o.asn1.Type.OCTETSTRING,!1,e),o.asn1.create(o.asn1.Class.CONTEXT_SPECIFIC,0,!0,[o.asn1.create(o.asn1.Class.UNIVERSAL,o.asn1.Type.OID,!1,s.bytes())]),o.asn1.create(o.asn1.Class.CONTEXT_SPECIFIC,1,!0,[o.asn1.create(o.asn1.Class.UNIVERSAL,o.asn1.Type.BITSTRING,!1,n)])])):(r="PUBLIC KEY",e=Buffer.concat([Buffer.from([0,4]),e.x,e.y]).toString("binary"),i=o.asn1.create(o.asn1.Class.UNIVERSAL,o.asn1.Type.SEQUENCE,!0,[o.asn1.create(o.asn1.Class.UNIVERSAL,o.asn1.Type.SEQUENCE,!0,[o.asn1.create(o.asn1.Class.UNIVERSAL,o.asn1.Type.OID,!1,o.asn1.oidToDer(l).bytes()),o.asn1.create(o.asn1.Class.UNIVERSAL,o.asn1.Type.OID,!1,s.bytes())]),o.asn1.create(o.asn1.Class.UNIVERSAL,o.asn1.Type.BITSTRING,!1,e)])),i=o.asn1.toDer(i).bytes(),o.pem.encode({type:r,body:i})},EC_OID:l}},33724:(e,t,r)=>{"use strict";var n=r(85029),i=r(44237),o=r(71762),s=r(85141),a=r(42319),c=r(44179),u=r(83748),l=r(50414),d=r(66678),h=r(82723),f=r(78718);function p(e){switch(e){case"P-256":return"SHA-256";case"P-384":return"SHA-384";case"P-521":return"SHA-512";default:throw new Error("unsupported curve: "+e)}}var m=e.exports={};function g(e,t,r){function n(e){return Buffer.concat([u.int32ToBuffer(e.length),e])}var o=r.algorithm||"",s=l.KEYLENGTH[o],a=i.asBuffer(r.apu||"","base64url"),c=i.asBuffer(r.apv||"","base64url"),d={public:t,length:s/8,hash:"SHA-256",otherInfo:Buffer.concat([n(Buffer.from(o,"utf8")),n(a),n(c),u.int32ToBuffer(s)])};return m["ECDH-CONCAT"].derive(e,d)}["ECDH","ECDH-HKDF","ECDH-CONCAT"].forEach((function(e){var t,r,i=/^ECDH(?:-(\w+))?$/g.exec(e||"")[1],c=m[e]=m[e]||{};switch(i||""){case"CONCAT":c.derive=function(e,t){var r;t=t||{};try{if(!(r=t.hash||p(e.crv)))throw new Error("invalid hash: "+r);r.toUpperCase()}catch(e){return Promise.reject(e)}var n=["public"],i=m.ECDH.derive(e,f(t,n));return i.then((function(e){return a["CONCAT-"+r].derive(e,h(t,n))}))};break;case"HKDF":c.derive=function(e,t){var r;t=t||{};try{if(!(r=t.hash||p(e.crv)))throw new Error("invalid hash: "+r);r.toUpperCase()}catch(e){return Promise.reject(e)}var n=["public"],i=m.ECDH.derive(e,f(t,n));return i.then((function(e){return s["HKDF-"+r].derive(e,h(t,n))}))};break;case"":c.derive=(t={name:"ECDH"},r=function(e,t){var r=e&&o.convertToForge(e,!0);if(!r||!r.isValid())return Promise.reject(new Error("invalid EC public key"));switch(t){case"jwk":r=o.convertToJWK(e,!0);break;case"buffer":r=o.convertToBuffer(e,!0)}return Promise.resolve(r)},u.setupFallback((function(e,t){if("function"!=typeof u.nodeCrypto.createECDH)throw new Error("unsupported algorithm: ECDH");var n,i=(t=t||{}).length||0;switch(e.crv){case"P-256":n="prime256v1";break;case"P-384":n="secp384r1";break;case"P-521":n="secp521r1";break;default:return Promise.reject(new Error("invalid curve: "+n))}var s=o.convertToBuffer(e,!1),a=r(t.public,"buffer");return a=a.then((function(e){var t=u.nodeCrypto.createECDH(n);t.setPrivateKey(s);var r=t.computeSecret(e);if(i){if(r.length<i)return Promise.reject(new Error("key length too large: "+i));r=r.slice(0,i)}return r})),a}),(function(e,i){e=e||{};var s=(i=i||{}).length||0,a=n(d(t),{namedCurve:e.crv});s||(s=e.d.length);var c=o.convertToJWK(e,!1);c=u.subtleCrypto.importKey("jwk",c,a,!1,["deriveBits"]);var l=r(i.public,"jwk");l=l.then((function(e){return u.subtleCrypto.importKey("jwk",e,a,!1,[])}));var h=Promise.all([c,l]);return h=h.then((function(e){var r=e[0],i=e[1],o=n(d(t),{public:i});return u.subtleCrypto.deriveBits(o,r,8*s)})),h.then((function(e){return Buffer.from(e)}))}),(function(e,t){var n=(t=t||{}).length||0,i=o.convertToForge(e,!1),s=r(t.public,"forge");return s.then((function(e){var t=i.computeSecret(e);if(n){if(t.length<n)return Promise.reject(new Error("key length too large: "+n));t=t.slice(0,n)}return t}))})));break;default:c.derive=null}})),["ECDH-ES","ECDH-ES+A128KW","ECDH-ES+A192KW","ECDH-ES+A256KW"].forEach((function(e){var t=/^ECDH-ES(?:\+(.+))?/g.exec(e||"")[1],r=m[e]=m[e]||{};t?(t=c[t])?(r.encrypt=function(e){return function(t,r,n){if(!(n=n||{}).epk||!n.epk.d)return Promise.reject(new Error("missing ephemeral private key"));var i=o.convertToObj(n.epk,!1);if(!t||!t.x||!t.y)return Promise.reject(new Error("missing static public key"));var s=g(i,o.convertToObj(t,!0),{algorithm:n.alg,apu:n.apu,apv:n.apv});return s.then((function(t){return e(t,r)}))}}(t.encrypt),r.decrypt=function(e){return function(t,r,n){if(!(n=n||{}).epk||!n.epk.x||!n.epk.y)return Promise.reject(new Error("missing ephemeral public key"));var i=o.convertToObj(n.epk,!0);if(!t||!t.d)return Promise.reject(new Error("missing static private key"));var s=g(o.convertToObj(t,!1),i,{algorithm:n.alg,apu:n.apu,apv:n.apv});return s.then((function(t){return e(t,r)}))}}(t.decrypt)):r.ecrypt=r.decrypt=null:(r.encrypt=function(e,t,r){if(!(r=r||{}).epk||!r.epk.d)return Promise.reject(new Error("missing ephemeral private key"));var n=o.convertToObj(r.epk,!1);if(!e||!e.x||!e.y)return Promise.reject(new Error("missing static public key"));var i=g(n,o.convertToObj(e,!0),{algorithm:r.enc,apu:r.apu,apv:r.apv});return i.then((function(e){return{data:e,once:!0,direct:!0}}))},r.decrypt=function(e,t,r){if(!(r=r||{}).epk||!r.epk.x||!r.epk.y)return Promise.reject(new Error("missing ephemeral public key"));var n=o.convertToObj(r.epk,!0);if(!e||!e.d)return Promise.reject(new Error("missing static private key"));var i=g(o.convertToObj(e,!1),n,{algorithm:r.enc,apu:r.apu,apv:r.apv});return i.then((function(e){return e}))})}))},64008:(e,t,r)=>{"use strict";var n=r(71762),i=r(83748),o=r(48545);function s(e){switch(e){case"SHA-256":return"P-256";case"SHA-384":return"P-384";case"SHA-512":return"P-521";default:throw new Error("unsupported hash: "+e)}}function a(e){var t,r=s(e),a=e.toLowerCase().replace("-","");return i.nodeCrypto&&i.nodeCrypto.getHashes().indexOf(a)>-1&&(t=function(e,t){if(r!==e.crv)return Promise.reject(new Error("invalid curve"));var o,s;switch(o=(o=Promise.resolve(i.nodeCrypto.createSign(a))).then((function(e){return e.update(t),e})),a.slice(-3)){case"384":s=48;break;case"512":s=66;break;default:s=32}return o=(o=o.then((function(t){return n.derToConcat(t.sign(n.convertToPEM(e,!0)),s)}))).then((function(e){return{data:t,mac:e}}))}),i.setupFallback(t,(function(t,o){if(r!==t.crv)return Promise.reject(new Error("invalid curve"));var s,a=n.convertToJWK(t,!1),c={name:"ECDSA",namedCurve:a.crv,hash:{name:e}};return s=(s=i.subtleCrypto.importKey("jwk",a,c,!0,["sign"])).then((function(e){return i.subtleCrypto.sign(c,e,o)})),s=s.then((function(e){return e=Buffer.from(e),{data:o,mac:e}}))}),(function(t,i){if(r!==t.crv)return Promise.reject(new Error("invalid curve"));var s=n.convertToForge(t,!1);return o[e].digest(i).then((function(e){return e=s.sign(e),e=Buffer.concat([e.r,e.s]),{data:i,mac:e}}))}))}function c(e){var t,r=s(e),a=e.toLowerCase().replace("-","");return i.nodeCrypto&&i.nodeCrypto.getHashes().indexOf(a)>-1&&(t=function(e,t,o){if(r!==e.crv)return Promise.reject(new Error("invalid curve"));var s;switch(a.slice(-3)){case"384":s=48;break;case"512":s=66;break;default:s=32}return Promise.resolve(i.nodeCrypto.createVerify(a)).then((function(r){return r.update(t),r.end(),r.verify(n.convertToPEM(e,!1),n.concatToDer(o,s))})).then((function(e){if(!e)throw new Error("verification failed");return{data:t,mac:o,valid:!0}}))}),i.setupFallback(t,(function(t,o,s){if(r!==t.crv)return Promise.reject(new Error("invalid curve"));var a,c=n.convertToJWK(t,!0),u={name:"ECDSA",namedCurve:c.crv,hash:{name:e}};return a=(a=i.subtleCrypto.importKey("jwk",c,u,!0,["verify"])).then((function(e){return i.subtleCrypto.verify(u,e,s,o)})),a=a.then((function(e){return e?{data:o,mac:s,valid:!0}:Promise.reject(new Error("verification failed"))}))}),(function(t,i,s){if(r!==t.crv)return Promise.reject(new Error("invalid curve"));var a=n.convertToForge(t,!0);return o[e].digest(i).then((function(e){var t=s.length/2,r={r:s.slice(0,t),s:s.slice(t)};return a.verify(e,r)?{data:i,mac:s,valid:!0}:Promise.reject(new Error("verification failed"))}))}))}var u={};["ES256","ES384","ES512"].forEach((function(e){var t=e.replace(/ES(\d+)/g,(function(e,t){return"SHA-"+t}));u[e]={sign:a(t),verify:c(t)}})),e.exports=u},83748:(e,t,r)=>{"use strict";"undefined"==typeof Promise&&r(82702).polyfill(),t.int32ToBuffer=function(e,t){return(t=t||Buffer.alloc(4))[0]=e>>>24&255,t[1]=e>>>16&255,t[2]=e>>>8&255,t[3]=255&e,t};var n=Math.pow(2,32);t.int64ToBuffer=function(e,r){r=r||Buffer.alloc(8);var i=Math.floor(e/n),o=e%n;return i=t.int32ToBuffer(i),o=t.int32ToBuffer(o),r=Buffer.concat([i,o])};var i={};Object.defineProperty(t,"subtleCrypto",{get:function(){return"subtleCrypto"in i?i.subtleCrypto:i.subtleCrypto=function(){if("undefined"!=typeof crypto&&void 0!==crypto.subtle)return crypto.subtle}()},enumerable:!0}),Object.defineProperty(t,"nodeCrypto",{get:function(){return"nodeCrypto"in i?i.nodeCrypto:i.nodeCrypto=function(){var e;try{e=r(3438)}catch(e){return}if(Object.keys(e).length)return e}()},enumerable:!0}),t.setupFallback=function(e,r,n){var i;return i=e&&t.nodeCrypto?function(){var t,r=arguments;try{t=Promise.resolve(e.apply(null,r))}catch(e){t=function(e){return 0===e.message.indexOf("unsupported algorithm:")?(i=n).apply(null,r):Promise.reject(e)}(e)}return t}:r&&t.subtleCrypto?function(){var e,t=arguments;function o(e){return e.code!==DOMException.NOT_SUPPORTED_ERR&&"Only ArrayBuffer and ArrayBufferView objects can be passed as CryptoOperationData"!==e.message&&e instanceof Error?Promise.reject(e):(i=n).apply(null,t)}try{e=(e=r.apply(null,t)).catch(o)}catch(t){e=o(t)}return e}:n,i}},85141:(e,t,r)=>{"use strict";var n=r(50414),i=r(61733);function o(e){var t=e.replace("HKDF-",""),r=e.replace("HKDF-SHA-","HS");return function(e,o){var s=n.HASHLENGTH[t]/8;"string"==typeof r&&(r=i[r].sign);var a=(o=o||{}).salt;a&&0!==a.length||(a=Buffer.alloc(s));var c=o.info||Buffer.alloc(0),u=o.length||s,l=Math.ceil(u/s),d=[],h=0;function f(e,t){return l===h++?Buffer.concat(d).slice(0,u):(t||(t=Buffer.alloc(0)),t=Buffer.concat([t,c,Buffer.from([h])]),t=(t=r(e,t)).then((function(r){return t=r.mac,d.push(t),f(e,t)})))}return r(a,e,{length:8*a.length}).then((function(e){return f(e.mac)}))}}var s={};["HKDF-SHA-1","HKDF-SHA-256","HKDF-SHA-384","HKDF-SHA-512"].forEach((function(e){s[e]={derive:o(e)}})),e.exports=s},61733:(e,t,r)=>{"use strict";var n=r(50414),i=r(41194),o=r(64678),s=r(83748);function a(e){var t=e.replace("HS","SHA").toLowerCase(),r=e.replace("HS","SHA-");function o(e,t){return(e=(e||n.HASHLENGTH[r])/8)>t.length?Promise.reject(new Error("invalid key length")):Promise.resolve(t)}return s.setupFallback((function(e,r,n){var i;return i=(i=o((n=n||{}).length,e)).then((function(){var n=s.nodeCrypto.createHmac(t,e);n.update(r);var i=n.digest();return{data:r,mac:i}})),i}),(function(e,t,n){var i={name:"HMAC",hash:{name:r}};return o((n=n||{}).length,e).then((function(){return s.subtleCrypto.importKey("raw",e,i,!0,["sign"])})).then((function(e){return s.subtleCrypto.sign(i,e,t)})).then((function(e){var r=Buffer.from(e);return{data:t,mac:r}}))}),(function(e,r,n){return o((n=n||{}).length,e).then((function(){var n=i.hmac.create();return n.start(t,e.toString("binary")),n.update(r.toString("binary")),n=Buffer.from(n.digest().bytes(),"binary"),{data:r,mac:n}}))}))}function c(e){var t=e.replace("HS","SHA").toLowerCase(),r=e.replace("HS","SHA-");function a(e,t,i){e=(e||n.HASHLENGTH[r])/8;for(var o=!0,s=0;e>s;s++)o=o&&t[s]===i[s];return o}return s.setupFallback((function(e,r,n,i){i=i||{};var o=s.nodeCrypto.createHmac(t,e);o.update(r);var c=o.digest();if(!a(i.length,n,c))throw new Error("verification failed");return{data:r,mac:c,valid:!0}}),(function(e,t,n,i){var o={name:"HMAC",hash:{name:r}};return((i=i||{}).length?s.subtleCrypto.importKey("raw",e,o,!0,["sign"]).then((function(e){return s.subtleCrypto.sign(o,e,t)})).then((function(e){var t=Buffer.from(e);return a(i.length,n,t)})):s.subtleCrypto.importKey("raw",e,o,!0,["verify"]).then((function(e){return s.subtleCrypto.verify(o,e,n,t)}))).then((function(e){return e?{data:t,mac:n,valid:!0}:Promise.reject(new Error("verifaction failed"))}))}),(function(e,r,n,s){s=s||{};var c=i.hmac.create();return c.start(t,new o(e)),c.update(r.toString("binary")),c=Buffer.from(c.digest().bytes(),"binary"),a(s.length,n,c)?Promise.resolve({data:r,mac:n,valid:!0}):Promise.reject(new Error("verification failed"))}))}var u={};["HS1","HS256","HS384","HS512"].forEach((function(e){u[e]={sign:a(e),verify:c(e)}})),e.exports=u},35382:(e,t,r)=>{"use strict";var n=[r(11379),r(82736),r(44179),r(42319),r(82274),r(33724),r(64008),r(85141),r(61733),r(30152),r(93516),r(24658),r(48545)],i={},o={},s={},a={},c={},u={};n.forEach((function(e){Object.keys(e).forEach((function(t){var r=e[t];"function"==typeof r.encrypt&&(c[t]=r.encrypt),"function"==typeof r.decrypt&&(u[t]=r.decrypt),"function"==typeof r.sign&&(s[t]=r.sign),"function"==typeof r.verify&&(a[t]=r.verify),"function"==typeof r.digest&&(i[t]=r.digest),"function"==typeof r.derive&&(o[t]=r.derive)}))})),t.digest=function(e,t,r){var n=i[e];return n?n(t,r):Promise.reject(new Error("unsupported algorithm: "+e))},t.derive=function(e,t,r){var n=o[e];return n?n(t,r):Promise.reject(new Error("unsupported algorithm: "+e))},t.sign=function(e,t,r,n){var i=s[e];return i?i(t,r,n||{}):Promise.reject(new Error("unsupported algorithm: "+e))},t.verify=function(e,t,r,n,i){var o=a[e];return o?o(t,r,n,i||{}):Promise.reject(new Error("unsupported algorithm: "+e))},t.encrypt=function(e,t,r,n){var i=c[e];return i?i(t,r,n||{}):Promise.reject(new Error("unsupported algorithm: "+e))},t.decrypt=function(e,t,r,n){var i=u[e];return i?i(t,r,n||{}):Promise.reject(new Error("unsupported algorithm: "+e))}},30152:(e,t,r)=>{"use strict";var n=r(41194),i=r(85029),o=r(44237),s=r(83748),a=r(50414),c=r(44179),u=Buffer.from([0]);function l(e,t,r){var n="PBES2-"+e+"+"+t,i=[Buffer.from(n,"utf8"),u,r];return Buffer.concat(i)}function d(e){function t(e){var t=(e=e||{}).length||0,r=o.asBuffer(e.salt||Buffer.alloc(0),"base64u4l"),n=e.iterations||0;if(0>=t)throw new Error("invalid key length");if(0>=n)throw new Error("invalid iteration count");return e.length=t,e.salt=r,e.iterations=n,e}return s.setupFallback((function(r,n){if(6>s.nodeCrypto.pbkdf2.length)throw new Error("unsupported algorithm: PBKDF2-"+e);try{n=t(n)}catch(e){return Promise.reject(e)}var i=n.length,o=n.salt,a=n.iterations,c=e.replace("-","");return new Promise((function(e,t){s.nodeCrypto.pbkdf2(r,o,a,i,c,(function(r,n){r?t(r):e(n)}))}))}),(function(r,n){try{n=t(n)}catch(e){return Promise.reject(e)}var i=n.length,a=n.salt,c=n.iterations,u=Promise.resolve(r);return u=(u=u.then((function(e){return s.subtleCrypto.importKey("raw",e,"PBKDF2",!1,["deriveBits"])}))).then((function(t){var r={name:"PBKDF2",salt:new Uint8Array(a),iterations:c,hash:e};return s.subtleCrypto.deriveBits(r,t,8*i)})),u=u.then((function(e){return o.asBuffer(e)}))}),(function(r,i){try{i=t(i)}catch(e){return Promise.reject(e)}var o=i.length,s=i.salt,a=i.iterations;return new Promise((function(t,i){var c=n.md[e.replace("-","").toLowerCase()].create();n.pkcs5.pbkdf2(r.toString("binary"),s.toString("binary"),a,o,c,(function(e,r){e?i(e):(r=Buffer.from(r,"binary"),t(r))}))}))}))}function h(e,t){var r="PBKDF2-"+e.replace("HS","SHA-"),n=a.KEYLENGTH[t]/8;return function(s,a,u){u=u||{};var d=o.asBuffer(u.p2s||Buffer.alloc(0),"base64url"),h=u.p2c||8192;if(0>=h)throw new Error("invalid iteration count");if(0===d.length)d=o.randomBytes(16);else if(8>d.length)throw new Error("salt too small");var f={p2s:o.base64url.encode(d),p2c:h};d=l(e,t,d),u=i(u,{salt:d,iterations:h,length:n});var m=Promise.resolve(s);return m=m.then((function(e){return p[r].derive(e,u)})),m=(m=m.then((function(e){return c[t].encrypt(e,a)}))).then((function(e){return e.header=i(e.header||{},f),e}))}}function f(e,t){var r="PBKDF2-"+e.replace("HS","SHA-"),n=a.KEYLENGTH[t]/8;return function(s,a,u){u=u||{};var d=o.asBuffer(u.p2s||Buffer.alloc(0),"base64url"),h=u.p2c||0;if(0>=h)return Promise.reject(new Error("invalid iteration count"));if(8>d.length)return Promise.reject(new Error("salt too small"));d=l(e,t,d),u=i(u,{salt:d,iterations:h,length:n});var f=Promise.resolve(s);return f=f.then((function(e){return p[r].derive(e,u)})),f=f.then((function(e){return c[t].decrypt(e,a)}))}}var p={};["PBKDF2-SHA-256","PBKDF2-SHA-384","PBKDF2-SHA-512"].forEach((function(e){var t=e.replace("PBKDF2-","");p[e]={derive:d(t)}})),["PBES2-HS256+A128KW","PBES2-HS384+A192KW","PBES2-HS512+A256KW"].forEach((function(e){var t=/PBES2-(HS\d+)\+(A\d+KW)/g.exec(e),r=t[1],n=t[2];p[e]={encrypt:h(r,n),decrypt:f(r,n)}})),e.exports=p},78501:(e,t,r)=>{"use strict";var n=r(66678),i=r(41194),o=r(44237);function s(e,t){var r=t?["n","e"]:["n","e","d","p","q","dp","dq","qi"];return r=r.map((function(t){return new i.jsbn.BigInteger(e[t].toString("hex"),16)})),(t?i.pki.rsa.setPublicKey:i.pki.rsa.setPrivateKey).apply(i.pki.rsa,r)}e.exports={convertToForge:s,convertToJWK:function(e,t){var r=n(e);return(t?["n","e"]:["n","e","d","p","q","dp","dq","qi"]).forEach((function(e){r[e]=o.base64url.encode(r[e])})),delete r.key_ops,delete r.use,delete r.alg,t&&(delete r.d,delete r.p,delete r.q,delete r.dp,delete r.dq,delete r.qi),r},convertToPem:function(e,t){var r,n=t?"__cachedPublicPem":"__cachedPrivatePem";return e[n]?e[n]:(r=t?i.pki.publicKeyToPem(s(e,t)):i.pki.privateKeyToPem(s(e,t)),Object.defineProperty(e,n,{value:r}),r)}}},93516:(e,t,r)=>{"use strict";var n=r(41194),i=r(83748),o=r(64678),s=r(78501),a={"RSA-OAEP":"RSA_PKCS1_OAEP_PADDING",RSA1_5:"RSA_PKCS1_PADDING"};function c(e){return i.nodeCrypto&&i.nodeCrypto.constants&&-1!==Object.keys(a).indexOf(e)}function u(e){var t={name:e};"RSA-OAEP-256"===e?(t.name="RSA-OAEP",t.hash={name:"SHA-256"}):"RSA-OAEP"===e?t.hash={name:"SHA-1"}:t.name="RSAES-PKCS1-v1_5";var r,u;return r="RSAES-PKCS1-v1_5"!==t.name?function(e,r){return e=s.convertToJWK(e,!0),i.subtleCrypto.importKey("jwk",e,t,!0,["encrypt"]).then((function(e){return i.subtleCrypto.encrypt(t,e,r)})).then((function(e){return{data:Buffer.from(e)}}))}:null,c(e)&&(u=function(t,r){return t=s.convertToPem(t,!0),{data:i.nodeCrypto.publicEncrypt({key:t,padding:i.nodeCrypto.constants[a[e]]},r)}}),i.setupFallback(u,r,(function(e,r){r=new o(r).bytes();var i=s.convertToForge(e,!0),a={};"RSA-OAEP"===t.name&&(a.md=t.hash.name.toLowerCase().replace(/-/g,""),a.md=n.md[a.md].create());var c=i.encrypt(r,t.name.toUpperCase(),a);return c=new o(c).native(),Promise.resolve({data:c})}))}function l(e){var t={name:e};"RSA-OAEP-256"===e?(t.name="RSA-OAEP",t.hash={name:"SHA-256"}):"RSA-OAEP"===e?t.hash={name:"SHA-1"}:t.name="RSAES-PKCS1-v1_5";var r,u;return r="RSAES-PKCS1-v1_5"!==t.name?function(e,r){return e=s.convertToJWK(e,!1),i.subtleCrypto.importKey("jwk",e,t,!0,["decrypt"]).then((function(e){return i.subtleCrypto.decrypt(t,e,r)})).then((function(e){return Buffer.from(e)}))}:null,c(e)?u=function(t,r){return t=s.convertToPem(t,!1),i.nodeCrypto.privateDecrypt({key:t,padding:i.nodeCrypto.constants[a[e]]},r)}:i.nodeCrypto&&"RSA-OAEP"===e&&(u=function(e,t){return e=s.convertToPem(e,!1),i.nodeCrypto.privateDecrypt(e,t)}),i.setupFallback(u,r,(function(e,r){r=new o(r).bytes();var i=s.convertToForge(e,!1),a={};"RSA-OAEP"===t.name&&(a.md=t.hash.name.toLowerCase().replace(/-/g,""),a.md=n.md[a.md].create());var c=i.decrypt(r,t.name.toUpperCase(),a);return c=new o(c).native(),Promise.resolve(c)}))}var d={};["RSA-OAEP","RSA-OAEP-256","RSA1_5"].forEach((function(e){d[e]={encrypt:u(e),decrypt:l(e)}})),e.exports=d},24658:(e,t,r)=>{"use strict";var n=r(41194),i=r(50414),o=r(83748),s=r(78501);function a(){return o.nodeCrypto&&o.nodeCrypto.constants&&o.nodeCrypto.constants.RSA_PSS_SALTLEN_DIGEST}function c(e){var t,r=e.replace("RS","SHA").toLowerCase(),i=e.replace("RS","SHA-"),a={name:"RSASSA-PKCS1-V1_5",hash:{name:i}},c="RSA-"+i.replace("-","");return o.nodeCrypto&&o.nodeCrypto.getHashes().indexOf(c)>-1&&(t=function(e,t){var r=o.nodeCrypto.createSign(c);return r.update(t),{data:t,mac:r.sign(s.convertToPem(e,!1))}}),o.setupFallback(t,(function(e,t){return e=s.convertToJWK(e,!1),o.subtleCrypto.importKey("jwk",e,a,!0,["sign"]).then((function(e){return o.subtleCrypto.sign(a,e,t)})).then((function(e){var r=Buffer.from(e);return{data:t,mac:r}}))}),(function(e,t){var i=n.md[r].create();i.start(),i.update(t);var o=s.convertToForge(e,!1).sign(i,"RSASSA-PKCS1-V1_5");return o=Buffer.from(o,"binary"),Promise.resolve({data:t,mac:o})}))}function u(e){var t,r=e.replace("RS","SHA").toLowerCase(),i={name:"RSASSA-PKCS1-V1_5",hash:{name:e.replace("RS","SHA-")}};return o.nodeCrypto&&o.nodeCrypto.getHashes().indexOf(r)>-1&&(t=function(e,t,n){var i=o.nodeCrypto.createVerify(r);return i.update(t),i.end(),i.verify(s.convertToPem(e,!0),n)?{data:t,mac:n,valid:!0}:Promise.reject(new Error("verification failed"))}),o.setupFallback(t,(function(e,t,r){return e=s.convertToJWK(e,!0),o.subtleCrypto.importKey("jwk",e,i,!0,["verify"]).then((function(e){return o.subtleCrypto.verify(i,e,r,t)})).then((function(e){return e?{data:t,mac:r,valid:!0}:Promise.reject(new Error("verification failed"))}))}),(function(e,t,i){var o=n.md[r].create();o.start(),o.update(t),o=o.digest().bytes();var a=s.convertToForge(e,!0),c=i.toString("binary");return a.verify(o,c,"RSASSA-PKCS1-V1_5")?Promise.resolve({data:t,mac:i,valid:!0}):Promise.reject(new Error("verification failed"))}))}function l(e){var t,r=e.replace("PS","SHA").toLowerCase(),c=e.replace("PS","SHA-"),u={name:"RSA-PSS",hash:{name:c},saltLength:i.HASHLENGTH[c]/8},l="RSA-"+c.replace("-","");return a()&&(t=function(e,t){var r=o.nodeCrypto.createSign(l);return r.update(t),{data:t,mac:r.sign({key:s.convertToPem(e,!1),padding:o.nodeCrypto.constants.RSA_PKCS1_PSS_PADDING,saltLength:o.nodeCrypto.constants.RSA_PSS_SALTLEN_DIGEST})}}),o.setupFallback(t,(function(e,t){return e=s.convertToJWK(e,!1),o.subtleCrypto.importKey("jwk",e,u,!0,["sign"]).then((function(e){return o.subtleCrypto.sign(u,e,t)})).then((function(e){var r=Buffer.from(e);return{data:t,mac:r}}))}),(function(e,t){var o=n.md[r].create();o.start(),o.update(t);var a=n.pss.create({md:n.md[r].create(),mgf:n.mgf.mgf1.create(n.md[r].create()),saltLength:i.HASHLENGTH[c]/8}),u=s.convertToForge(e,!1).sign(o,a);return u=Buffer.from(u,"binary"),Promise.resolve({data:t,mac:u})}))}function d(e){var t,r=e.replace("PS","SHA").toLowerCase(),c=e.replace("PS","SHA-"),u={name:"RSA-PSS",hash:{name:c},saltLength:i.HASHLENGTH[c]/8};return a()&&(t=function(e,t,n){var i=o.nodeCrypto.createVerify(r);return i.update(t),i.end(),i.verify({key:s.convertToPem(e,!0),padding:o.nodeCrypto.constants.RSA_PKCS1_PSS_PADDING,saltLength:o.nodeCrypto.constants.RSA_PSS_SALTLEN_DIGEST},n)?{data:t,mac:n,valid:!0}:Promise.reject(new Error("verification failed"))}),o.setupFallback(t,(function(e,t,r){return e=s.convertToJWK(e,!0),o.subtleCrypto.importKey("jwk",e,u,!0,["verify"]).then((function(e){return o.subtleCrypto.verify(u,e,r,t)})).then((function(e){return e?{data:t,mac:r,valid:!0}:Promise.reject(new Error("verification failed"))}))}),(function(e,t,o){var a=n.md[r].create();a.start(),a.update(t),a=a.digest().bytes();var u=n.pss.create({md:n.md[r].create(),mgf:n.mgf.mgf1.create(n.md[r].create()),saltLength:i.HASHLENGTH[c]/8}),l=s.convertToForge(e,!0),d=o.toString("binary");return l.verify(a,d,u)?Promise.resolve({data:t,mac:o,valid:!0}):Promise.reject(new Error("verification failed"))}))}var h={};["PS256","PS384","PS512"].forEach((function(e){h[e]={sign:l(e),verify:d(e)}})),["RS256","RS384","RS512"].forEach((function(e){h[e]={sign:c(e),verify:u(e)}})),e.exports=h},48545:(e,t,r)=>{"use strict";var n=r(41194),i=r(83748);var o={};["SHA-1","SHA-256","SHA-384","SHA-512"].forEach((function(e){var t,r,s;o[e]={digest:(t=e,r=t.replace("SHA-","SHA").toLowerCase(),s={name:t},i.setupFallback((function(e){var t=i.nodeCrypto.createHash(r);return t.update(e),t.digest()}),(function(e){return i.subtleCrypto.digest(s,e).then((function(e){return e=Buffer.from(e)}))}),(function(e){var t=n.md[r].create();return t.update(e.toString("binary")),t=Buffer.from(t.digest().bytes(),"binary"),Promise.resolve(t)})))}})),e.exports=o},82150:(e,t,r)=>{"use strict";var n=r(43583),i=r(19873),o=r(13891),s=3774873600,a=new n(s>>8);var c=e.exports={E1:s,E1B:225,E1L:a,LOOKUP:function(){for(var e=[],t=0;t<256;++t){for(var r=0,n=7;n>=0;--n)0!=(t&1<<n)&&(r^=s>>>7-n);e.push(r)}return e}(),arrayCopy:function(e,t,r,n,i){if(t<0||n<0||i<0)throw new TypeError("Invalid input.");if(r instanceof Uint8Array){if(n>=r.length||n+i>r.length)throw new TypeError("Invalid input.");(0!==t||i<e.length)&&(e=e instanceof Uint8Array?e.subarray(t,t+i):e.slice(t,t+i)),r.set(e,n)}else for(var o=0;o<i;++o)r[n+o]=e[t+o]},arrayEqual:function(e,t){e=e||[],t=t||[];for(var r=Math.min(e.length,t.length),n=e.length===t.length,i=0;i<r;i++)n=n&&void 0!==e[i]&&void 0!==t[i]&&e[i]===t[i];return n},asBytes:function(e,t){switch(arguments.length){case 1:return t=Buffer.alloc(16),o.intToBigEndian(e,t,0),t;case 2:o.intToBigEndian(e,t,0);break;default:throw new TypeError("Expected 1 or 2 arguments.")}},asInts:function(e,t){switch(arguments.length){case 1:return i(t=[],0,0,4),o.bigEndianToInt(e,0,t),t;case 2:o.bigEndianToInt(e,0,t);break;default:throw new TypeError("Expected 1 or 2 arguments.")}},oneAsInts:function(){for(var e=[],t=0;t<4;++t)e.push(1<<31);return e},shiftRight:function(e,t){var r,n;switch(arguments.length){case 1:return r=e[0],e[0]=r>>>1,n=r<<31,r=e[1],e[1]=r>>>1|n,n=r<<31,r=e[2],e[2]=r>>>1|n,n=r<<31,r=e[3],e[3]=r>>>1|n,r<<31&4294967295;case 2:return r=e[0],t[0]=r>>>1,n=r<<31,r=e[1],t[1]=r>>>1|n,n=r<<31,r=e[2],t[2]=r>>>1|n,n=r<<31,r=e[3],t[3]=r>>>1|n,r<<31&4294967295;default:throw new TypeError("Expected 1 or 2 arguments.")}},shiftRightN:function(e,t,r){var n,i,o;switch(arguments.length){case 2:return i=e[0],n=32-t,e[0]=i>>>t,o=i<<n,i=e[1],e[1]=i>>>t|o,o=i<<n,i=e[2],e[2]=i>>>t|o,o=i<<n,i=e[3],e[3]=i>>>t|o,i<<n;case 3:return i=e[0],n=32-t,r[0]=i>>>t,o=i<<n,i=e[1],r[1]=i>>>t|o,o=i<<n,i=e[2],r[2]=i>>>t|o,o=i<<n,i=e[3],r[3]=i>>>t|o,i<<n;default:throw new TypeError("Expected 2 or 3 arguments.")}},xor:function(e,t,r){switch(arguments.length){case 2:e[0]^=t[0],e[1]^=t[1],e[2]^=t[2],e[3]^=t[3];break;case 3:r[0]=e[0]^t[0],r[1]=e[1]^t[1],r[2]=e[2]^t[2],r[3]=e[3]^t[3];break;default:throw new TypeError("Expected 2 or 3 arguments.")}},multiply:function(e,t){for(var r=e.slice(),n=[],i=0;i<4;++i)for(var o=t[i],s=31;s>=0;--s)0!=(o&1<<s)&&c.xor(n,r),0!==c.shiftRight(r)&&(r[0]^=c.E1);c.arrayCopy(n,0,e,0,4)},multiplyP:function(e,t){switch(arguments.length){case 1:0!==c.shiftRight(e)&&(e[0]^=c.E1);break;case 2:0!==c.shiftRight(e,t)&&(t[0]^=c.E1);break;default:throw new TypeError("Expected 1 or 2 arguments.")}},multiplyP8:function(e,t){var r;switch(arguments.length){case 1:r=c.shiftRightN(e,8),e[0]^=c.LOOKUP[r>>>24];break;case 2:r=c.shiftRightN(e,8,t),t[0]^=c.LOOKUP[r>>>24];break;default:throw new TypeError("Expected 1 or 2 arguments.")}}}},49560:(e,t,r)=>{"use strict";var n=r(43583),i=r(41194),o=r(38140),s=r(82150),a=r(13891),c=r(64678),u=r(47826);function l(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=this.blockSize||16}e.exports={createCipher:function(e){var t=new i.aes.Algorithm("AES-GCM",l);return t.initialize({key:new c(e.key)}),t.mode.start(e),t.mode},createDecipher:function(e){var t=new i.aes.Algorithm("AES-GCM",l);return t.initialize({key:new c(e.key)}),t.mode._decrypt=!0,t.mode.start(e),t.mode}},l.prototype.start=function(e){if(this.tag=null,!("iv"in(e=e||{})))throw new Error("Gcm needs ParametersWithIV or AEADParameters");if(this.nonce=e.iv,null==this.nonce||this.nonce.length<1)throw new Error("IV must be at least 1 byte");this.tagLength=16,"tag"in e&&(this.tag=Buffer.from(e.tag));var t=this._decrypt?this.blockSize+this.tagLength:this.blockSize;this.bufBlock=Buffer.alloc(t);var r=e.multiplier;if(null==r&&(r=new o["8k"]),this.multiplier=r,this.H=this.zeroBlock(),u.encrypt(this.cipher,this.H,0,this.H,0),this.multiplier.init(this.H),this.exp=null,this.J0=this.zeroBlock(),12===this.nonce.length)this.nonce.copy(this.J0,0,0,this.nonce.length),this.J0[this.blockSize-1]=1;else{this.gHASH(this.J0,this.nonce,this.nonce.length);var i=this.zeroBlock();a.longToBigEndian(new n(this.nonce.length).multiply(8),i,8),this.gHASHBlock(this.J0,i)}this.S=this.zeroBlock(),this.SAt=this.zeroBlock(),this.SAtPre=this.zeroBlock(),this.atBlock=this.zeroBlock(),this.atBlockPos=0,this.atLength=n.ZERO,this.atLengthPre=n.ZERO,this.counter=Buffer.from(this.J0),this.bufOff=0,this.totalLength=n.ZERO,"additionalData"in e&&this.processAADBytes(e.additionalData,0,e.additionalData.length)},l.prototype.update=function(e,t,r,n,i){for(var o=0;r>0;){var s=Math.min(r,this.bufBlock.length-this.bufOff);e.copy(this.bufBlock,this.bufOff,t,t+s),r-=s,t+=s,this.bufOff+=s,this.bufOff===this.bufBlock.length&&(this.outputBlock(n,i+o),o+=this.blockSize)}return o},l.prototype.finish=function(e,t){var r=0;this._decrypt&&(r+=this.update(this.tag,0,this.tag.length,e,t)),this.totalLength.isZero()&&this.initCipher();var n=this.bufOff;if(this._decrypt){if(n<this.tagLength)throw new Error("data too short");n-=this.tagLength}n>0&&(this.gCTRPartial(this.bufBlock,0,n,e,t+r),r+=n),this.atLength=this.atLength.add(this.atBlockPos);var i=this.zeroBlock();a.longToBigEndian(this.atLength.multiply(8),i,0),a.longToBigEndian(this.totalLength.multiply(8),i,8),this.gHASHBlock(this.S,i);var o=Buffer.alloc(this.blockSize);if(u.encrypt(this.cipher,this.J0,0,o,0),this.xor(o,this.S),this._decrypt){if(!s.arrayEqual(this.tag,o))throw new Error("mac check in Gcm failed")}else this.tag=Buffer.alloc(this.tagLength),o.copy(this.tag,0,0,this.tagLength);return r},l.prototype.initCipher=function(){this.atLength.greaterThan(n.ZERO)&&(this.SAt.copy(this.SAtPre,0,0,this.blockSize),this.atLengthPre=this.atLength.add(n.ZERO)),this.atBlockPos>0&&(this.gHASHPartial(this.SAtPre,this.atBlock,0,this.atBlockPos),this.atLengthPre=this.atLengthPre.add(this.atBlockPos)),this.atLengthPre.greaterThan(n.ZERO)&&this.SAtPre.copy(this.S,0,0,this.blockSize)},l.prototype.outputBlock=function(e,t){this.totalLength.isZero()&&this.initCipher(),this.gCTRBlock(this.bufBlock,e,t),this._decrypt?(this.bufBlock.copy(this.bufBlock,0,this.blockSize,this.blockSize+this.tagLength),this.bufOff=this.tagLength):this.bufOff=0},l.prototype.processAADBytes=function(e,t,r){for(var n=0;n<r;++n)this.atBlock[this.atBlockPos]=e[t+n],++this.atBlockPos===this.blockSize&&(this.gHASHBlock(this.SAt,this.atBlock),this.atBlockPos=0,this.atLength=this.atLength.add(this.blockSize))},l.prototype.getNextCounterBlock=function(){for(var e=15;e>=12;--e){var t=this.counter[e]+1&255;if(this.counter[e]=t,0!==t)break}var r=Buffer.alloc(this.blockSize);return u.encrypt(this.cipher,this.counter,0,r,0),r},l.prototype.gCTRBlock=function(e,t,r){var n=this.getNextCounterBlock();this.xor(n,e),n.copy(t,r,0,this.blockSize),this.gHASHBlock(this.S,this._decrypt?e:n),this.totalLength=this.totalLength.add(this.blockSize)},l.prototype.gCTRPartial=function(e,t,r,n,i){var o=this.getNextCounterBlock();this.xor(o,e,t,r),o.copy(n,i,0,r),this.gHASHPartial(this.S,this._decrypt?e:o,0,r),this.totalLength=this.totalLength.add(r)},l.prototype.gHASHBlock=function(e,t){this.xor(e,t),this.multiplier.multiplyH(e)},l.prototype.gHASHPartial=function(e,t,r,n){this.xor(e,t,r,n),this.multiplier.multiplyH(e)},l.prototype.xor=function(e,t,r,n){switch(arguments.length){case 2:for(var i=15;i>=0;--i)e[i]^=t[i];break;case 4:for(;n-- >0;)e[n]^=t[r+n];break;default:throw new TypeError("Expected 2 or 4 arguments.")}return e},l.prototype.zeroBlock=function(){return Buffer.alloc(16)}},38140:(e,t,r)=>{"use strict";var n=r(82150),i=r(13891);function o(){this.H=[],this.M=null}o.prototype.init=function(e){var t,r,i;if(null==this.M)for(this.M=[],t=0;t<32;++t)for(this.M[t]=[],r=0;r<16;++r)for(this.M[t][r]=[],i=0;i<4;++i)this.M[t][r][i]=0;else if(n.arrayEqual(this.H,e))return;for(this.H=e.slice(),n.asInts(e,this.M[1][8]),r=4;r>=1;r>>=1)n.multiplyP(this.M[1][r+r],this.M[1][r]);for(n.multiplyP(this.M[1][1],this.M[0][8]),r=4;r>=1;r>>=1)n.multiplyP(this.M[0][r+r],this.M[0][r]);for(t=0;;){for(r=2;r<16;r+=r)for(i=1;i<r;++i)n.xor(this.M[t][r],this.M[t][i],this.M[t][r+i]);if(32==++t)return;if(t>1)for(r=8;r>0;r>>=1)n.multiplyP8(this.M[t-2][r],this.M[t][r])}},o.prototype.multiplyH=function(e){for(var t=[],r=15;r>=0;--r){var n=this.M[r+r][15&e[r]];t[0]^=n[0],t[1]^=n[1],t[2]^=n[2],t[3]^=n[3],n=this.M[r+r+1][(240&e[r])>>>4],t[0]^=n[0],t[1]^=n[1],t[2]^=n[2],t[3]^=n[3]}i.intToBigEndian(t,e,0)},e.exports={"8k":o}},47826:(e,t,r)=>{"use strict";var n=r(13891);e.exports={encrypt:function(e,t,r,i,o){var s=new Array(4),a=new Array(4);n.bigEndianToInt(t,r,s),e.encrypt(s,a),n.intToBigEndian(a,i,o)}}},13891:(e,t,r)=>{"use strict";var n=r(43583),i=e.exports={intToBigEndian:function(e,t,r){if("number"==typeof e)switch(arguments.length){case 1:t=Buffer.alloc(4),i.intToBigEndian(e,t,0);break;case 3:t[r]=255&e>>>24,t[++r]=255&e>>>16,t[++r]=255&e>>>8,t[++r]=255&e;break;default:throw new TypeError("Expected 1 or 3 arguments.")}else switch(arguments.length){case 1:t=Buffer.alloc(4*e.length),i.intToBigEndian(e,t,0);break;case 3:for(var n=0;n<e.length;++n)i.intToBigEndian(e[n],t,r),r+=4;break;default:throw new TypeError("Expected 1 or 3 arguments.")}return t},longToBigEndian:function(e,t,r){if(Array.isArray(e))switch(arguments.length){case 1:t=Buffer.alloc(8*e.length),i.longToBigEndian(e,t,0);break;case 3:for(var n=0;n<e.length;++n)i.longToBigEndian(e[n],t,r),r+=8;break;default:throw new TypeError("Expected 1 or 3 arguments.")}else switch(arguments.length){case 1:t=Buffer.alloc(8),i.longToBigEndian(e,t,0);break;case 3:var o=e.low,s=e.high;i.intToBigEndian(s,t,r),i.intToBigEndian(o,t,r+4);break;default:throw new TypeError("Expected 1 or 3 arguments.")}return t},bigEndianToInt:function(e,t,r){switch(arguments.length){case 2:var n=e[t]<<24;return n|=(255&e[++t])<<16,n|=(255&e[++t])<<8,n|=255&e[++t];case 3:for(var o=0;o<r.length;++o)r[o]=i.bigEndianToInt(e,t),t+=4;break;default:throw new TypeError("Expected 2 or 3 arguments.")}},bigEndianToLong:function(e,t,r){switch(arguments.length){case 2:var o=i.bigEndianToInt(e,t),s=i.bigEndianToInt(e,t+4);return new n(s,o);case 3:for(var a=0;a<r.length;++a)r[a]=i.bigEndianToLong(e,t),t+=8;break;default:throw new TypeError("Expected 2 or 3 arguments.")}}}},26778:(e,t,r)=>{"use strict";var n=r(41194).jsbn.BigInteger,i=r(77118);function o(e,t,r,n){this.curve=e,this.g=t,this.n=r,this.h=n}function s(e){return new n(e,16)}o.prototype.getCurve=function(){return this.curve},o.prototype.getG=function(){return this.g},o.prototype.getN=function(){return this.n},o.prototype.getH=function(){return this.h};var a,c,u,l,d,h,f,p=e.exports={secp256r1:(a=s("FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF"),c=s("FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC"),u=s("5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B"),l=s("FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551"),d=n.ONE,h=new i.ECCurveFp(a,c,u),f=h.decodePointHex("046B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C2964FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5"),new o(h,f,l,d)),secp384r1:function(){var e=s("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF"),t=s("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC"),r=s("B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF"),a=s("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973"),c=n.ONE,u=new i.ECCurveFp(e,t,r),l=u.decodePointHex("04AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB73617DE4A96262C6F5D9E98BF9292DC29F8F41DBD289A147CE9DA3113B5F0B8C00A60B1CE1D7E819D7A431D7C90EA0E5F");return new o(u,l,a,c)}(),secp521r1:function(){var e=s("01FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF"),t=s("01FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC"),r=s("0051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00"),a=s("01FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409"),c=n.ONE,u=new i.ECCurveFp(e,t,r),l=u.decodePointHex("0400C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66011839296A789A3BC0045C8A5FB42C7D1BD998F54449579B446817AFBD17273E662C97EE72995EF42640C550B9013FAD0761353C7086A272C24088BE94769FD16650");return new o(u,l,a,c)}()};p["P-256"]=p.secp256r1,p["P-384"]=p.secp384r1,p["P-521"]=p.secp521r1},91634:(e,t,r)=>{"use strict";var n=r(41194),i=n.jsbn.BigInteger,o=r(77118),s=r(26778);function a(e){return new i(e,16)}function c(e,t){t||(t=Math.ceil(e.bitLength()/8)),t*=2;var r=e.toString(16);for(r=r.substring(Math.max(r.length-t,0));t>r.length;)r="0"+r;return Buffer.from(r,"hex")}function u(e){return"string"==typeof e&&(e=Buffer.from(e,"binary")),a(e.toString("hex"))}function l(e){return Math.ceil(e.getN().bitLength()/8)}function d(e){var t=s[e];if(!t)throw new TypeError("unsupported named curve: "+e);return t}function h(e,t){var r=e.getN().bitLength(),n=8*t.length,i=u(t);return r<n&&(i=i.shiftRight(n-r)),i}function f(e,t,r){var n=d(e),i=n.getCurve(),s=new o.ECPointFp(i,i.fromBigInteger(t),i.fromBigInteger(r));this.curve=e,this.params=n,this.point=s;var a=l(n);this.x=c(t,a),this.y=c(r,a)}function p(e,t){var r=d(e);this.curve=e,this.params=r;var n=l(r);this.d=c(t,n)}f.prototype.isValid=function(){return this.params.curve.contains(this.point)},f.prototype.verify=function(e,t){var r=this.params.getN(),n=this.params.getG(),o=u(t.r),s=u(t.s);if(o.compareTo(i.ONE)<0||o.compareTo(r)>=0)return!1;if(s.compareTo(i.ONE)<0||o.compareTo(r)>=0)return!1;var a=h(this.params,e),c=s.modInverse(r),l=a.multiply(c).mod(r),d=o.multiply(c).mod(r),f=n.multiplyTwo(l,this.point,d).getX().toBigInteger();return(f=f.mod(r)).equals(o)},p.prototype.toPublicKey=function(){var e=u(this.d),t=this.params.getG().multiply(e);return new f(this.curve,t.getX().toBigInteger(),t.getY().toBigInteger())},p.prototype.sign=function(e){var t,r,o,s,a=l(this.params),d=this.params.getN(),f=this.params.getG(),p=h(this.params,e),m=u(this.d);do{do{do{o=u(n.random.getBytes(a))}while(o.equals(i.ZERO)||o.compareTo(d)>=0);t=f.multiply(o).getX().toBigInteger().mod(d)}while(t.equals(i.ZERO));s=m.multiply(t),s=p.add(s),r=o.modInverse(d).multiply(s).mod(d)}while(r.equals(i.ONE));var g=l(this.params);return{r:t=c(t,g),s:r=c(r,g)}},p.prototype.isValid=function(){var e=u(this.d),t=this.params.getN().subtract(i.ONE);return e.compareTo(i.ONE)>=0&&e.compareTo(t)<0},p.prototype.computeSecret=function(e){var t=u(this.d),r=e.point.multiply(t).getX().toBigInteger();return r=c(r,l(this.params))},t.generateKeyPair=function(e){var t=d(e),r=t.getN(),o=n.random.getBytes(l(t));o=u(o);var s=r.subtract(i.ONE),a=new p(e,o.mod(s).add(i.ONE)),c=a.toPublicKey();return{private:a,public:c}},t.asPublicKey=function(e,t,r){return"string"==typeof t?t=a(t):Buffer.isBuffer(t)&&(t=u(t)),"string"==typeof r?r=a(r):Buffer.isBuffer(r)&&(r=u(r)),new f(e,t,r)},t.asPrivateKey=function(e,t){return"string"==typeof t?t=a(t):Buffer.isBuffer(t)&&(t=u(t)),new p(e,t)}},77118:(e,t,r)=>{"use strict";var n=r(41194).jsbn.BigInteger;function i(){return new n(null)}function o(e){this.r2=i(),this.q3=i(),n.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function s(e,t){this.x=t,this.p=e}function a(e,t,r,i){this.curve=e,this.x=t,this.y=r,this.z=i||n.ONE,this.zinv=null}function c(e,t,r){this.p=e,this.a=this.fromBigInteger(t),this.b=this.fromBigInteger(r),this.infinity=new a(this,null,null),this.reducer=new o(this.p)}o.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=i();return e.copyTo(t),this.reduce(t),t},o.prototype.revert=function(e){return e},o.prototype.reduce=function(e){if(e.s<0)throw Error("Barrett reduction on negative input");for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},o.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},o.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},s.prototype.equals=function(e){return e===this||this.p.equals(e.p)&&this.x.equals(e.x)},s.prototype.toBigInteger=function(){return this.x},s.prototype.negate=function(){return new s(this.p,this.x.negate().mod(this.p))},s.prototype.add=function(e){return new s(this.p,this.x.add(e.toBigInteger()).mod(this.p))},s.prototype.subtract=function(e){return new s(this.p,this.x.subtract(e.toBigInteger()).mod(this.p))},s.prototype.multiply=function(e){return new s(this.p,this.x.multiply(e.toBigInteger()).mod(this.p))},s.prototype.square=function(){return new s(this.p,this.x.pow(2).mod(this.p))},s.prototype.divide=function(e){return new s(this.p,this.x.multiply(e.toBigInteger().modInverse(this.p)).mod(this.p))},a.prototype.getX=function(){this.zinv||(this.zinv=this.z.modInverse(this.curve.p));var e=this.x.toBigInteger().multiply(this.zinv);return this.curve.reduce(e),this.curve.fromBigInteger(e)},a.prototype.getY=function(){this.zinv||(this.zinv=this.z.modInverse(this.curve.p));var e=this.y.toBigInteger().multiply(this.zinv);return this.curve.reduce(e),this.curve.fromBigInteger(e)},a.prototype.equals=function(e){return e===this||(this.isInfinity()?e.isInfinity():e.isInfinity()?this.isInfinity():!!e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.p).equals(n.ZERO)&&e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.p).equals(n.ZERO))},a.prototype.isInfinity=function(){return null==this.x&&null==this.y||this.z.equals(n.ZERO)&&!this.y.toBigInteger().equals(n.ZERO)},a.prototype.negate=function(){return new a(this.curve,this.x,this.y.negate(),this.z)},a.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.p),r=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.p);if(n.ZERO.equals(r))return n.ZERO.equals(t)?this.twice():this.curve.getInfinity();var i=new n("3"),o=this.x.toBigInteger(),s=this.y.toBigInteger(),c=r.pow(2),u=c.multiply(r),l=o.multiply(c),d=t.pow(2).multiply(this.z),h=d.subtract(l.shiftLeft(1)).multiply(e.z).subtract(u).multiply(r).mod(this.curve.p),f=l.multiply(i).multiply(t).subtract(s.multiply(u)).subtract(d.multiply(t)).multiply(e.z).add(t.multiply(u)).mod(this.curve.p),p=u.multiply(this.z).multiply(e.z).mod(this.curve.p);return new a(this.curve,this.curve.fromBigInteger(h),this.curve.fromBigInteger(f),p)},a.prototype.twice=function(){if(this.isInfinity())return this;if(0===this.y.toBigInteger().signum())return this.curve.getInfinity();var e=new n("3"),t=this.x.toBigInteger(),r=this.y.toBigInteger(),i=r.multiply(this.z),o=i.multiply(r).mod(this.curve.p),s=this.curve.a.toBigInteger(),c=t.pow(2).multiply(e);n.ZERO.equals(s)||(c=c.add(this.z.pow(2).multiply(s)));var u=(c=c.mod(this.curve.p)).pow(2).subtract(t.shiftLeft(3).multiply(o)).shiftLeft(1).multiply(i).mod(this.curve.p),l=c.multiply(e).multiply(t).subtract(o.shiftLeft(1)).shiftLeft(2).multiply(o).subtract(c.pow(2).multiply(c)).mod(this.curve.p),d=i.pow(2).multiply(i).shiftLeft(3).mod(this.curve.p);return new a(this.curve,this.curve.fromBigInteger(u),this.curve.fromBigInteger(l),d)},a.prototype.multiply=function(e){if(this.isInfinity())return this;if(0===e.signum())return this.curve.getInfinity();var t,r=e,i=r.multiply(new n("3")),o=this.negate(),s=this;for(t=i.bitLength()-2;t>0;--t){s=s.twice();var a=i.testBit(t);a!==r.testBit(t)&&(s=s.add(a?this:o))}return s},a.prototype.multiplyTwo=function(e,t,r){var n;n=e.bitLength()>r.bitLength()?e.bitLength()-1:r.bitLength()-1;for(var i=this.curve.getInfinity(),o=this.add(t);n>=0;)i=i.twice(),e.testBit(n)?i=r.testBit(n)?i.add(o):i.add(this):r.testBit(n)&&(i=i.add(t)),--n;return i},c.prototype.getP=function(){return this.p},c.prototype.getA=function(){return this.a},c.prototype.getB=function(){return this.b},c.prototype.equals=function(e){return e===this||this.p.equals(e.p)&&this.a.equals(e.a)&&this.b.equals(e.b)},c.prototype.contains=function(e){var t=e.getX().toBigInteger(),r=e.getY().toBigInteger(),n=this.a.toBigInteger(),i=this.b.toBigInteger(),o=this.p,s=r.pow(2).mod(o),a=t.pow(3).add(n.multiply(t)).add(i).mod(o);return s.equals(a)},c.prototype.getInfinity=function(){return this.infinity},c.prototype.fromBigInteger=function(e){return new s(this.p,e)},c.prototype.reduce=function(e){this.reducer.reduce(e)},c.prototype.decodePointHex=function(e){switch(parseInt(e.substring(0,2),16)){case 0:return this.infinity;case 2:case 3:default:return null;case 4:case 6:case 7:var t=(e.length-2)/2,r=e.substr(2,t),i=e.substr(t+2,t);return new a(this,this.fromBigInteger(new n(r,16)),this.fromBigInteger(new n(i,16)))}},c.prototype.encodePointHex=function(e){if(e.isInfinity())return"00";var t=e.getX().toBigInteger().toString(16),r=e.getY().toBigInteger().toString(16),n=this.getP().toString(16).length;for(n%2!=0&&n++;t.length<n;)t="0"+t;for(;r.length<n;)r="0"+r;return"04"+t+r},e.exports={ECFieldElementFp:s,ECPointFp:a,ECCurveFp:c}},41194:(e,t,r)=>{"use strict";var n,i,o=r(3832);function s(e){e=e||{},this.name="",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._blocks=this.blockSize/4,this._inBlock=new Array(this._blocks),this._outBlock=new Array(this._blocks)}r(8925),r(3068),r(85649),r(36607),r(83453),r(98960),r(26953),r(18936),r(79437),r(4742),r(29654),r(74933),r(96007),r(49563),r(137),r(41668),r(63219),r(97116),s.prototype.start=function(){},s.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;var n;for(n=0;n<this._blocks;++n)this._inBlock[n]=e.getInt32();for(this.cipher.encrypt(this._inBlock,this._outBlock),n=0;n<this._blocks;++n)t.putInt32(this._outBlock[n])},s.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;var n;for(n=0;n<this._blocks;++n)this._inBlock[n]=e.getInt32();for(this.cipher.decrypt(this._inBlock,this._outBlock),n=0;n<this._blocks;++n)t.putInt32(this._outBlock[n])},i=s,n=function(){return new o.aes.Algorithm("AES",i)},o.cipher.registerAlgorithm("AES",n);const a=o.jsbn.BigInteger.prototype.modInverse;o.jsbn.BigInteger.prototype.modInverse=function(e){return a.apply(this,[e]).mod(e)},e.exports=o},21217:(e,t,r)=>{"use strict";var n=r(34155);"undefined"==typeof Promise&&r(82702).polyfill(),"undefined"==typeof Buffer&&((r.g||window).Buffer=r(48764).Buffer),void 0===n&&((r.g||window).process=r(34155)),n.version||(n.version="");var i=r(32109);e.exports={JWA:r(35382),JWE:r(30701),JWK:r(32543),JWS:i,util:r(44237),parse:r(48650),canYouSee:i.createVerify}},8668:(e,t,r)=>{"use strict";var n=r(9752),i=r(63171),o=r(32543),s=r(85029),a=r(65967),c={algorithms:"*"};function u(e,t){var r,u;if(o.isKey(e))u=(r=e).keystore;else{if(!o.isKeyStore(e))throw new TypeError("Keystore must be provided");u=e}t=s({},c,t),Object.defineProperty(this,"decrypt",{value:function(e,c){var l,d=(c=s({},t,c||{})).handlers||{},h=Object.keys(d),f=new i(c.algorithms);if("string"==typeof e)e={protected:(e=e.split("."))[0],recipients:[{encrypted_key:e[1]}],iv:e[2],ciphertext:e[3],tag:e[4]};else if(!e||"object"!=typeof e)throw new Error("invalid input");"encrypted_key"in e&&(e.recipients=[{encrypted_key:e.encrypted_key}]);var p,m,g,v,y,b=e.recipients||[{}];return l=(l=Promise.resolve(b)).then((function(t){if(e.protected){m=n.decode(e.protected).toString("utf8");var r=(m=JSON.parse(m)).crit;if(r){if(!Array.isArray(r))return Promise.reject(new Error("Invalid 'crit' header"));for(var i=0;r.length>i;i++)if(-1===h.indexOf(r[i]))return Promise.reject(new Error("Critical extension is not supported: "+r[i]))}p=m,m=Object.keys(m)}else p={},m=[];return p=s(e.unprotected||{},p),t=t.map((function(e){var t=Promise.resolve(),r=e.header||{};return r=s(r,p),e.header=r,e.protected=m,f.match(r.alg)||(t=t.then((function(){return Promise.reject(new Error("Algorithm not allowed: "+r.alg))}))),f.match(r.enc)||(t=t.then((function(){return Promise.reject(new Error("Algorithm not allowed: "+r.enc))}))),r.epk&&(t=(t=t.then((function(){return o.asKey(r.epk)}))).then((function(e){r.epk=e.toObject(!1)}))),t.then((function(){return e}))})),Promise.all(t)})),l=l.then((function(e){var t={};return new Promise((function(i,s){var a=function(){var c=e.shift();if(c){var l=Promise.resolve(c);l=l.then((function(e){var t=y=e.encrypted_key||"";return t=n.decode(t),(g=r||u.get({use:"enc",alg:e.header.alg,kid:e.header.kid}))?g.unwrap(e.header.alg,t,e.header):Promise.reject()})),(l=l.then((function(e){v={kty:"oct",k:n.encode(e)},v=o.asKey(v),t.key=g,t.header=c.header,t.protected=c.protected,i(t)}))).catch(a)}else s(new Error("no key found"))};a()}))})),l=(l=(l=(l=(l=(l=l.then((function(t){return t.iv=e.iv,t.tag=e.tag,t.ciphertext=e.ciphertext,t}))).then((function(e){var t=[];return h.forEach((function(r){var n;"function"==typeof(r=d[r])?n=r(e):"object"==typeof r&&"function"==typeof r.prepare&&(n=r.prepare(e)),n&&t.push(Promise.resolve(n))})),Promise.all(t).then((function(){return e}))}))).then((function(e){return Buffer.isBuffer(e.ciphertext)||(e.ciphertext=n.decode(e.ciphertext)),e}))).then((function(t){var r=e.protected;"aad"in e&&null!=e.aad&&(r+="."+e.aad);var n={iv:t.iv,adata:r,tag:t.tag,kdata:y,epu:t.epu,epv:t.epv},i=t.ciphertext;return delete t.iv,delete t.tag,delete t.ciphertext,v.then((function(e){return e.decrypt(t.header.enc,i,n).then((function(e){return t.payload=t.plaintext=e,t}))}))}))).then((function(e){return"DEF"===e.header.zip?new Promise((function(t,r){try{var n=a.inflateRaw(Buffer.from(e.plaintext));e.payload=e.plaintext=Buffer.from(n),t(e)}catch(e){r(e)}})):e}))).then((function(e){var t=[];return h.forEach((function(r){var n;"object"==typeof(r=d[r])&&"function"==typeof r.complete&&(n=r.complete(e)),n&&t.push(Promise.resolve(n))})),Promise.all(t).then((function(){return e}))}))}})}e.exports={decrypter:u,createDecrypt:function(e,t){return new u(e,t)}}},65141:e=>{"use strict";e.exports={zip:!1,format:"general",contentAlg:"A128CBC-HS256",protect:"*"}},58414:(e,t,r)=>{"use strict";var n=r(44237),i=r(59077).generateCEK,o=r(32543),s=r(59077).slice,a=r(65967),c=r(50414),u=r(28583),l=r(66678),d=r(65141);function h(e,t,r){var s=!1,d=e.format||"general",h=!!e.protectAll,f=Buffer.alloc(0);Object.defineProperty(this,"zip",{get:function(){return t.zip||""},enumerable:!0}),Object.defineProperty(this,"compact",{get:function(){return"compact"===d},enumerable:!0}),Object.defineProperty(this,"format",{get:function(){return d},enumerable:!0}),Object.defineProperty(this,"protected",{get:function(){return l(e.protect)},enumerable:!0}),Object.defineProperty(this,"header",{get:function(){return l(t)},enumerable:!0}),Object.defineProperty(this,"update",{value:function(e,t){if(s)throw new Error("already final");return null!=e&&(e=n.asBuffer(e,t),f=f.length?Buffer.concat([f,e],f.length+e.length):e),this}}),Object.defineProperty(this,"final",{value:function(p,m){if(s)return Promise.reject(new Error("already final"));this.update(p,m),s=!0;var g,v=Promise.resolve({}),y=t.enc;v=(v=v.then((function(t){return e.cek&&(g=o.asKey(e.cek)),t}))).then((function(s){var a=Promise.all(r);return a=a.then((function(r){var s=1===r.length;return r=r.map((function(r){return function(r,s){var a={};a=u(a,t),a=u(a,r.header);var c,d,h=r.key,f=a.alg;return 0===(a.alg||"").indexOf("ECDH-ES")?(c=h.keystore.temp(),d=r.epk?Promise.resolve(r.epk).then((function(e){r.header.epk=e.toJSON(!1,["kid"]),a.epk=e.toObject(!0,["kid"])})):c.generate("EC",h.get("crv")).then((function(e){r.header.epk=e.toJSON(!1,["kid"]),a.epk=e.toObject(!0,["kid"])}))):d=Promise.resolve(),d=d.then((function(){var r,n;return"dir"===f&&s?n=(g=Promise.resolve(h)).then((function(e){return y||(a.enc=t.enc=y=e.algorithms(o.MODE_ENCRYPT)[0]),{once:!0,direct:!0}})):(g||(y||(a.enc=t.enc=y=e.contentAlg),g=i(y)),n=(n=g.then((function(e){return r=e.get("k",!0),h}))).then((function(e){return e.wrap(f,r,a)}))),n})),d.then((function(e){if(e.once&&!s)return Promise.reject(new Error("cannot use 'alg':'"+f+"' with multiple recipients"));var t,i={};return e.data&&(t=e.data,t=n.base64url.encode(t)),e.direct&&t?g=o.asKey({kty:"oct",k:t}):t&&(i.encrypted_key=t),r.header&&Object.keys(r.header).length&&(i.header=l(r.header||{})),e.header&&(i.header=u(i.header||{},e.header)),i}))}(r,s)})),Promise.all(r)})),a=a.then((function(e){return s.recipients=e.filter((function(e){return!!e})),s}))}));var b={};switch(v=(v=v.then((function(r){var i,o,s,a;return s=l(t),h&&1===r.recipients.length||"compact"===d?(i={},i=u({},s,r.recipients[0].header),o=Object.keys(i).length,s=void 0,a=0,delete r.recipients[0].header,0===Object.keys(r.recipients[0]).length&&r.recipients.splice(0,1)):(i={},o=0,a=Object.keys(s).length,e.protect.forEach((function(e){e in s&&(i[e]=s[e],o++,delete s[e],a--)})),r.recipients=(r.recipients||[]).map((function(e){var t=(e=e||{}).header;return t&&(Object.keys(t).forEach((function(e){e in i&&delete t[e]})),Object.keys(t).length||delete e.header),e}))),r.recipients&&0!==r.recipients.length||delete r.recipients,s&&a>0&&(b=u(b,s),r.unprotected=s),i&&o>0&&(b=u(b,i),i=JSON.stringify(i),r.protected=n.base64url.encode(i,"utf8")),r}))).then((function(e){var t=f;return b.zip?"DEF"===b.zip?new Promise((function(r,n){try{var i=a.deflateRaw(Buffer.from(t,"binary"));e.plaintext=Buffer.from(i),r(e)}catch(e){n(e)}})):Promise.reject(new Error("unsupported 'zip' mode")):(e.plaintext=t,e)})),v=v.then((function(t){b.adata=t.protected,"aad"in e&&null!=e.aad&&(b.adata+="."+e.aad,b.adata=Buffer.from(b.adata,"utf8"));var r=e.iv||n.randomBytes(c.NONCELENGTH[y]/8);"string"==typeof r&&(r=n.base64url.decode(r)),b.iv=r,"recipients"in t&&1===t.recipients.length&&(b.kdata=t.recipients[0].encrypted_key),"epu"in e&&null!=e.epu&&(b.epu=e.epu),"epv"in e&&null!=e.epv&&(b.epv=e.epv);var i=t.plaintext;return delete t.plaintext,g.then((function(o){var s=o.encrypt(y,i,b);return s=s.then((function(i){return t.iv=n.base64url.encode(r,"binary"),"aad"in e&&null!=e.aad&&(t.aad=e.aad),t.ciphertext=n.base64url.encode(i.data,"binary"),t.tag=n.base64url.encode(i.tag,"binary"),t}))}))})),d){case"compact":v=v.then((function(e){var t=new Array(5);return t[0]=e.protected,e.recipients&&e.recipients[0]&&(t[1]=e.recipients[0].encrypted_key),t[2]=e.iv,t[3]=e.ciphertext,t[4]=e.tag,t=t.join(".")}));break;case"flattened":v=v.then((function(e){var t={},r=e.recipients&&e.recipients[0];return e.protected&&(t.protected=e.protected),e.unprotected&&(t.unprotected=e.unprotected),["header","encrypted_key"].forEach((function(e){r&&e in r&&r[e]&&("object"!=typeof r[e]||Object.keys(r[e]).length)&&(t[e]=r[e])})),e.aad&&(t.aad=e.aad),t.iv=e.iv,t.ciphertext=e.ciphertext,t.tag=e.tag,t}));break;case"general":v=v.then((function(e){var t=e.recipients||[];return(t=(t=t.map((function(e){if(Object.keys(e).length)return e}))).filter((function(e){return!!e}))).length?e.recipients=t:delete e.recipients,e}))}return v}})}e.exports={encrypter:h,createEncrypt:function(e,t){var r=e,i=1,a=t;if(0===arguments.length)throw new Error("at least one recipient must be provided");1===arguments.length||o.isKey(e)||e&&"kty"in e||e&&"key"in e&&(o.isKey(e.key)||"kty"in e.key)?(a=e,i=0,r={}):r=l(e),Array.isArray(a)||(a=s(arguments,i)),r=u(l(d),r);var c=l(r.fields||{});switch(r.zip&&(c.zip="boolean"==typeof r.zip?!!r.zip&&"DEF":r.zip),r.format=(r.compact?"compact":r.format)||"general",r.format){case"compact":if("aad"in e)throw new Error("additional authenticated data cannot be used for compact serialization");case"flattened":if(a.length>1)throw new Error("too many recipients for compact serialization")}var f=!1;if("compact"===r.format||"*"===r.protect)f=!0,r.protect=Object.keys(c).concat("enc");else if("string"==typeof r.protect)r.protect=[r.protect];else if(Array.isArray(r.protect))r.protect=r.protect.concat();else{if(r.protect)throw new Error("protect must be a list of fields");r.protect=[]}if(f&&1<a.length)throw new Error("too many recipients to protect all header parameters");return a=a.map((function(e,t){var r;return r=e&&"kty"in e?(r=o.asKey(e)).then((function(e){return{key:e}})):e?(r=o.asKey(e.key)).then((function(t){return{header:e.header,reference:e.reference,key:t}})):Promise.reject(new Error("missing key for recipient "+t)),e.epk&&(r=r.then((function(t){return o.asKey(e.epk).then((function(e){return t.epk=e,t}))}))),r=r.then((function(e){var r=e.key,n=e.header||{};e.header=n;var i={};if(i=u(i,c),(i=u(i,e.header)).alg||(i.alg=r.algorithms(o.MODE_WRAP)[0],n.alg=i.alg),!i.alg)return Promise.reject(new Error("key not valid for encrypting to recipient "+t));n.alg=i.alg;var s,a=e.reference;if(delete e.reference,void 0===a?a=(a=["kid","jku","x5c","x5t","x5u"].some((function(e){return e in n})))?null:"kid":"boolean"==typeof a&&(a=a?"kid":null),a)if(s=r.toJSON(),"jwk"===a){if("oct"===r.kty)return Promise.reject(new Error("cannot embed key"));n.jwk=s}else a in s&&(n[a]=s[a]);return e=Object.freeze(e)}))})),new h({aad:"aad"in r?n.base64url.encode(r.aad||""):null,contentAlg:r.contentAlg,format:r.format,protect:r.protect,cek:r.cek,iv:r.iv,protectAll:f},c,a)}}},59077:(e,t,r)=>{"use strict";var n=r(50414),i=r(32543);e.exports={slice:function(e,t){return Array.prototype.slice.call(e,t||0)},generateCEK:function(e){var t=i.createKeyStore(),r=n.KEYLENGTH[e];if(r)return t.generate("oct",r);throw new Error("unsupported encryption algorithm")}}},30701:(e,t,r)=>{"use strict";var n={createEncrypt:r(58414).createEncrypt,createDecrypt:r(8668).createDecrypt};e.exports=n},57136:(e,t,r)=>{"use strict";var n=r(85029);const{v4:i}=r(73537);var o=r(28583),s=r(66678),a=r(85564),c=r(25325),u=r(82723),l=r(78718),d=r(44908),h=r(35382),f=r(26395),p=r(49684),m=r(44237);e.exports=function(e,t,r,g){if(!e)throw new Error("kty cannot be null");if(!t)throw new Error("keystore cannot be null");if(!r)throw new Error("props cannot be null");if("string"==typeof r&&(r=JSON.parse(r)),!g)throw new Error("cfg cannot be null");var v,y,b=[],E={},w={};r=s(r),v=o({},r[p.INTERNALS.THUMBPRINT_KEY]||{}),delete r[p.INTERNALS.THUMBPRINT_KEY],Object.keys(v).forEach((function(e){var t=v[e];y||(y=t,Buffer.isBuffer(y)&&(y=m.base64url.encode(y))),Buffer.isBuffer(t)||(t=m.base64url.decode(t),v[e]=t)})),r.kty=e,r.kid=r.kid||y||i();var S,_=Object.keys(p.COMMON_PROPS).map((function(e){return p.COMMON_PROPS[e].name}));w.base=l(r,_),b=b.concat(Object.keys(w.base)),w.public=s(r),E.public=g.publicKey(w.public),E.public&&(b=b.concat(Object.keys(w.public))),w.private=s(r),E.private=g.privateKey(w.private),E.private&&(b=b.concat(Object.keys(w.private))),w.extra=u(r,b),S=E.public&&"length"in E.public?E.public.length:E.private&&"length"in E.private?E.private.length:NaN,Object.defineProperty(this,"keystore",{value:t,enumerable:!0}),Object.defineProperty(this,"length",{value:S,enumerable:!0}),Object.defineProperty(this,"kty",{value:e,enumerable:!0}),Object.defineProperty(this,"kid",{value:w.base.kid,enumerable:!0}),Object.defineProperty(this,"use",{value:w.base.use||"",enumerable:!0}),Object.defineProperty(this,"alg",{value:w.base.alg||"",enumerable:!0}),Object.defineProperty(this,"thumbprint",{value:function(e){if(e=(e||p.INTERNALS.THUMBPRINT_HASH).toUpperCase(),v[e])return Promise.resolve(v[e]);var t=p.thumbprint(g,w,e);return t=t.then((function(t){return t&&(v[e]=t),t}))}}),Object.defineProperty(this,"algorithms",{value:function(t){var r=[];this.use&&"sig"!==this.use||(t&&f.MODE_SIGN!==t||r.push(f.MODE_SIGN),t&&f.MODE_VERIFY!==t||r.push(f.MODE_VERIFY)),this.use&&"enc"!==this.use||(t&&f.MODE_ENCRYPT!==t||r.push(f.MODE_ENCRYPT),t&&f.MODE_DECRYPT!==t||r.push(f.MODE_DECRYPT),t&&f.MODE_WRAP!==t||r.push(f.MODE_WRAP),t&&f.MODE_UNWRAP!==t||r.push(f.MODE_UNWRAP));var n,i=this,o=r.map((function(e){return g.algorithms.call(i,E,e)}));(o=a(o),o=d(o),this.alg)&&(n="oct"===e?[this.alg,"dir"]:[this.alg],o=c(o,n));return o}}),Object.defineProperty(this,"supports",{value:function(e,t){return-1!==this.algorithms(t).indexOf(e)}}),Object.defineProperty(this,"has",{value:function(e,t){var r=!1;return r=(r=(r=(r=r||!(!w.base||!(e in w.base)))||!(!E.public||!(e in E.public)))||!(!w.extra||!(e in w.extra)))||!!(t&&E.private&&e in E.private)}}),Object.defineProperty(this,"get",{value:function(e,t){var r;return w.base&&e in w.base?r=w.base:E.public&&e in E.public?r=E.public:w.extra&&e in w.extra?r=w.extra:t&&E.private&&e in E.private&&(r=E.private),r&&r[e]||null}}),Object.defineProperty(this,"toJSON",{value:function(e,t){Array.isArray(e)&&(t=e,e=!1);var r={};return r=n(r,w.base,w.public,"boolean"==typeof e&&e?w.private:{},w.extra),r=u(r,t||[])}}),Object.defineProperty(this,"toPEM",{value:function(e){if(null===e&&(e=!1),!g.convertToPEM)throw new Error("Unsupported key type for PEM encoding");var t=e?E.private:E.public;if(!t)throw new Error("Invalid key");return g.convertToPEM.call(this,t,e)}}),Object.defineProperty(this,"toObject",{value:function(e,t){Array.isArray(e)&&(t=e,e=!1);var r={};return r=n(r,w.base,E.public,"boolean"==typeof e&&e?E.private:{},w.extra),r=u(r,(t||[]).concat("length"))}}),Object.defineProperty(this,"sign",{value:function(e,t,r){if(-1===this.algorithms("sign").indexOf(e))return Promise.reject(new Error("unsupported algorithm"));var i=g.signKey.call(this,e,E);return i?(r=r?s(r):{},g.signProps&&(r=n(r,g.signProps.call(this,e,r))),h.sign(e,i,t,r)):Promise.reject(new Error("improper key"))}}),Object.defineProperty(this,"verify",{value:function(e,t,r,i){if(-1===this.algorithms("verify").indexOf(e))return Promise.reject(new Error("unsupported algorithm"));var o=g.verifyKey.call(this,e,E);return o?(i=i?s(i):{},g.verifyProps&&(i=n(i,g.verifyProps.call(this,e,i))),h.verify(e,o,t,r,i)):Promise.reject(new Error("improper key"))}}),Object.defineProperty(this,"encrypt",{value:function(e,t,r){if(-1===this.algorithms("encrypt").indexOf(e))return Promise.reject(new Error("unsupported algorithm"));var i=g.encryptKey.call(this,e,E);return i?(r=r?s(r):{},g.encryptProps&&(r=n(r,g.encryptProps.call(this,e,r))),h.encrypt(e,i,t,r)):Promise.reject(new Error("improper key"))}}),Object.defineProperty(this,"decrypt",{value:function(e,t,r){if(-1===this.algorithms("decrypt").indexOf(e))return Promise.reject(new Error("unsupported algorithm"));var i=g.decryptKey.call(this,e,E);return i?(r=r?s(r):{},g.decryptProps&&(r=n(r,g.decryptProps.call(this,e,r))),h.decrypt(e,i,t,r)):Promise.reject(new Error("improper key"))}}),Object.defineProperty(this,"wrap",{value:function(e,t,r){if(-1===this.algorithms("wrap").indexOf(e))return Promise.reject(new Error("unsupported algorithm"));var i=g.wrapKey.call(this,e,E);return i?(r=r?s(r):{},g.wrapProps&&(r=n(r,g.wrapProps.call(this,e,r))),h.encrypt(e,i,t,r)):Promise.reject(new Error("improper key"))}}),Object.defineProperty(this,"unwrap",{value:function(e,t,r){if(-1===this.algorithms("unwrap").indexOf(e))return Promise.reject(new Error("unsupported algorithm"));var i=g.unwrapKey.call(this,e,E);return i?(r=r?s(r):{},g.unwrapProps&&(r=n(r,g.unwrapProps.call(this,e,r))),h.decrypt(e,i,t,r)):Promise.reject(new Error("improper key"))}})}},26395:e=>{"use strict";e.exports={MODE_SIGN:"sign",MODE_VERIFY:"verify",MODE_ENCRYPT:"encrypt",MODE_DECRYPT:"decrypt",MODE_WRAP:"wrap",MODE_UNWRAP:"unwrap"}},15339:(e,t,r)=>{"use strict";var n=r(71762),i=r(41194),o=r(91634),s={BaseKey:r(57136),helpers:r(49684)},a=["ES256","ES384","ES512"],c=["ECDH-ES","ECDH-ES+A128KW","ECDH-ES+A192KW","ECDH-ES+A256KW"],u=n.EC_OID;function l(e){switch(e){case"1.2.840.10045.3.1.7":return"P-256";case"1.3.132.0.34":return"P-384";case"1.3.132.0.35":return"P-521";default:return null}}var d={publicKey:function(e){var t=s.helpers.COMMON_PROPS.concat([{name:"crv",type:"string"},{name:"x",type:"binary"},{name:"y",type:"binary"}]),r=s.helpers.unpackProps(e,t);return r&&r.crv&&r.x&&r.y?r.length=n.curveSize(r.crv):(delete r.crv,delete r.x,delete r.y),r},privateKey:function(e){var t=s.helpers.COMMON_PROPS.concat([{name:"crv",type:"string"},{name:"x",type:"binary"},{name:"y",type:"binary"},{name:"d",type:"binary"}]),r=s.helpers.unpackProps(e,t);return r&&r.crv&&r.x&&r.y&&r.d?r.length=n.curveSize(r.crv):r=void 0,r},thumbprint:function(e){return e.public&&(e=e.public),{crv:e.crv,kty:"EC",x:e.x,y:e.y}},algorithms:function(e,t){var r=e.public&&e.public.length||e.private&&e.private.length||0;switch(521===r&&(r=512),t){case"encrypt":case"decrypt":return[];case"wrap":return e.public&&c||[];case"unwrap":return e.private&&c||[];case"sign":return e.private?a.filter((function(e){return e==="ES"+r})):[];case"verify":return e.public?a.filter((function(e){return e==="ES"+r})):[]}},encryptKey:function(e,t){return t.public},decryptKey:function(e,t){return t.private},wrapKey:function(e,t){return t.public},unwrapKey:function(e,t){return t.private},signKey:function(e,t){return t.private},verifyKey:function(e,t){return t.public}};d.convertToPEM=n.convertToPEM;var h={oid:u,privateKey:{name:"ECPrivateKey",tagClass:i.asn1.Class.UNIVERSAL,type:i.asn1.Type.SEQUENCE,constructed:!0,value:[{name:"ECPrivateKey.version",tagClass:i.asn1.Class.UNIVERSAL,type:i.asn1.Type.INTEGER,constructed:!1},{name:"ECPrivateKey.private",tagClass:i.asn1.Class.UNIVERSAL,type:i.asn1.Type.OCTETSTRING,constructed:!1,capture:"d"},{tagClass:i.asn1.Class.CONTEXT_SPECIFIC,name:"ECPrivateKey.parameters",constructed:!0,value:[{name:"ECPrivateKey.namedCurve",tagClass:i.asn1.Class.UNIVERSAL,type:i.asn1.Type.OID,constructed:!1,capture:"crv"}]},{name:"ECPrivateKey.publicKey",tagClass:i.asn1.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"ECPrivateKey.point",tagClass:i.asn1.Class.UNIVERSAL,type:i.asn1.Type.BITSTRING,constructed:!1,capture:"point"}]}]},embeddedPrivateKey:{name:"ECPrivateKey",tagClass:i.asn1.Class.UNIVERSAL,type:i.asn1.Type.SEQUENCE,constructed:!0,value:[{name:"ECPrivateKey.version",tagClass:i.asn1.Class.UNIVERSAL,type:i.asn1.Type.INTEGER,constructed:!1},{name:"ECPrivateKey.private",tagClass:i.asn1.Class.UNIVERSAL,type:i.asn1.Type.OCTETSTRING,constructed:!1,capture:"d"},{name:"ECPrivateKey.publicKey",tagClass:i.asn1.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"ECPrivateKey.point",tagClass:i.asn1.Class.UNIVERSAL,type:i.asn1.Type.BITSTRING,constructed:!1,capture:"point"}]}]}},f={kty:"EC",validators:h,prepare:function(e){var t=d,r=Promise.resolve(e);return r=(r=r.then((function(e){return s.helpers.thumbprint(t,e)}))).then((function(r){var n={};return n[s.helpers.INTERNALS.THUMBPRINT_HASH]=r,e[s.helpers.INTERNALS.THUMBPRINT_KEY]=n,t}))},generate:function(e){var t=o.generateKeyPair(e),r={crv:e,x:t.public.x,y:t.public.y,d:t.private.d};return Promise.resolve(r)},import:function(e){if(h.oid!==e.keyOid)return null;var t;if(e.keyParams&&i.asn1.Type.OID===e.keyParams.type?t=l(t=i.asn1.derToOid(e.keyParams.value)):e.crv&&(t=l(t=i.asn1.derToOid(e.crv))),!t)return null;if(!e.parsed){var r={};if("private"===e.type){if("string"==typeof e.keyValue?e.keyValue=i.asn1.fromDer(e.keyValue):Array.isArray(e.keyValue)&&(e.keyValue=e.keyValue[0]),!i.asn1.validate(e.keyValue,h.embeddedPrivateKey,r,[]))return null}else r.point=e.keyValue;e=r}var n={kty:"EC",crv:t};if(e.d&&(n.d=Buffer.from(e.d,"binary")),e.point){var o=Buffer.from(e.point,"binary");if(4!==o.readUInt16BE(0))return null;var s=(o=o.slice(2)).length/2;n.x=o.slice(0,s),n.y=o.slice(s)}return n}};e.exports=Object.freeze({config:d,factory:f}),r(4567).registry.register(f)},49684:(e,t,r)=>{"use strict";var n=r(66678),i=r(44237),o=r(41194),s=r(35382),a={name:"PrivateKeyInfo",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.INTEGER,constructed:!1,capture:"keyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.OID,constructed:!1,capture:"keyOid"},{name:"AlgorithmIdentifier.parameters",captureAsn1:"keyParams"}]},{name:"PrivateKeyInfo",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.OCTETSTRING,constructed:!1,capture:"keyValue"}]},c={name:"SubjectPublicKeyInfo",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.SEQUENCE,constructed:!0,value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.OID,constructed:!1,capture:"keyOid"},{name:"AlgorithmIdentifier.parameters",captureAsn1:"keyParams"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.BITSTRING,constructed:!1,capture:"keyValue"}]},u={name:"Certificate",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.SEQUENCE,constructed:!0,captureAsn1:"certificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:o.asn1.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:o.asn1.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},c,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:o.asn1.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.BITSTRING,constructed:!1,capture:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:o.asn1.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.BITSTRING,constructed:!1,capture:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:o.asn1.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:o.asn1.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:o.asn1.Class.UNIVERSAL,type:o.asn1.Type.BITSTRING,constructed:!1,capture:"certSignature"}]},l={THUMBPRINT_KEY:"internal\0thumbprint",THUMBPRINT_HASH:"SHA-256"};e.exports={validators:{privateKey:a,publicKey:c,certificate:u},thumbprint:function(e,t,r){if("function"!=typeof e.thumbprint)return Promise.reject(new Error("thumbprint not supported"));r=(r||l.THUMBPRINT_HASH).toUpperCase();var n=e.thumbprint(t),o=Object.keys(n).sort().map((function(e){var t=n[e];return Buffer.isBuffer(t)&&(t=i.base64url.encode(t)),JSON.stringify(e)+":"+JSON.stringify(t)}));o="{"+o.join(",")+"}";try{return s.digest(r,Buffer.from(o,"utf8"))}catch(e){return Promise.reject(e)}},unpackProps:function(e,t){var r;t.forEach((function(t){if(t.name in e){r=r||{};var o=e[t.name];switch(t.type){case"binary":Buffer.isBuffer(o)?e[t.name]=i.base64url.encode(o):o=i.base64url.decode(o);break;case"string":case"number":case"boolean":default:break;case"array":o=[].concat(o);break;case"object":o=n(o)}r[t.name]=o}}));var o=r||{};return Object.keys(e).forEach((function(t){t in o||delete e[t]})),r},COMMON_PROPS:[{name:"kty",type:"string"},{name:"kid",type:"string"},{name:"use",type:"string"},{name:"alg",type:"string"},{name:"x5c",type:"array"},{name:"x5t",type:"binary"},{name:"x5u",type:"string"},{name:"key_ops",type:"array"}],INTERNALS:l}},32543:(e,t,r)=>{"use strict";var n=r(4567);Object.keys(n.KeyStore).forEach((function(e){t[e]=n.KeyStore[e]}));var i=r(26395);Object.keys(i).forEach((function(e){t[e]=i[e]})),r(29170),r(29746),r(15339)},4567:(e,t,r)=>{"use strict";var n=r(66678),i=r(85029),o=r(41194),s=r(44237),a={BaseKey:r(57136),helpers:r(49684)},c=function(){var e={};Object.defineProperty(this,"register",{value:function(t){if(!t||"string"!=typeof t.kty||!t.kty)throw new Error("invalid Key factory");var r=t.kty;return e[r]=t,this}}),Object.defineProperty(this,"unregister",{value:function(t){if(!t||"string"!=typeof t.kty||!t.kty)throw new Error("invalid Key factory");var r=t.kty;return t===e[r]&&delete e[r],this}}),Object.defineProperty(this,"get",{value:function(t){return e[t||""]||void 0}}),Object.defineProperty(this,"all",{value:function(){return Object.keys(e).map((function(t){return e[t]}))}})},u=new c;function l(e,t){var r,n={},i=[],c=t.form,l=t.body,d=null;switch(t=o.asn1.fromDer(l),c){case"private":e.all().some((function(e){if(r)return!1;if(!e.validators)return!1;var s=e.validators.oid,a=e.validators.privateKey;return!!a&&(n={},i=[],(r=o.asn1.validate(t,a,n,i))&&(n.keyOid=o.asn1.oidToDer(s),n.parsed=!0),r)})),n.type="private";break;case"pkcs8":r=o.asn1.validate(t,a.helpers.validators.privateKey,n,i),n.type="private";break;case"public":case"spki":r=o.asn1.validate(t,a.helpers.validators.publicKey,n,i),n.type="public";break;case"pkix":case"x509":if(r=o.asn1.validate(t,a.helpers.validators.certificate,n,i)){n=function(e){return["certIssuer","certSubject"].forEach((function(t){var r=o.pki.RDNAttributesAsArray(e[t]),n=e[t]={};r.forEach((function(e){n[e.name||e.type]=e.value}))})),e}(n);var h=o.md.sha1.create();h.update(l),d=s.base64url.encode(Buffer.from(h.digest().toHex(),"hex"))}n.type="public"}return r?(n.keyOid&&(n.keyOid=o.asn1.derToOid(n.keyOid)),r=null,u.all().forEach((function(e){r||e&&"function"==typeof e.import&&(r=e.import(n))})),r&&n.certSubject&&n.certSubject.commonName&&(r.kid=n.certSubject.commonName),r&&d&&(r.x5t=d),r):null}var d=function(e,t){var r={};Object.defineProperty(this,"generate",{value:function(t,r,o){var s=e.get(t);if(!s)return Promise.reject(new Error("unsupported key type"));(o=n(o||{})).kty=t;var a=this;return s.generate(r).then((function(e){return e=i(o,e,{kty:t}),a.add(e)}))}}),Object.defineProperty(this,"add",{value:function(t,i,s){var c;if(s=s||{},Buffer.isBuffer(t)||"string"==typeof t)if("json"===(i=(i||"json").toLowerCase()))t=JSON.parse(t.toString("utf8"));else try{if(c="pem"===i?function(e){var t={};if(!o.pem.decode(e).some((function(e){switch(e.type){case"CERTIFICATE":t.form="pkix";break;case"PUBLIC KEY":t.form="spki";break;case"PRIVATE KEY":t.form="pkcs8";break;case"EC PRIVATE KEY":case"RSA PRIVATE KEY":t.form="private";break;default:return!1}return t.body=e.body,!0})))throw new Error("supported PEM type not found");return t}(t):{body:t.toString("binary"),form:i},!(t=l(e,c)))throw new Error("no importer for key");Object.keys(s).forEach((function(e){t[e]=s[e]}))}catch(e){return Promise.reject(e)}else t=d.isKey(t)?t.toJSON(!0):n(t);var u=e.get(t.kty);if(!u)return Promise.reject(new Error("unsupported key type"));var h=this;return u.prepare(t).then((function(e){return new a.BaseKey(t.kty,h,t,e)})).then((function(e){var t=e.kid||"";return(r[t]=r[t]||[]).push(e),e}))}}),Object.defineProperty(this,"remove",{value:function(e){if(e){var t=r[e.kid];if(t){var n=t.indexOf(e);-1!==n&&(t.splice(n,1),t.length||delete r[e.kid])}}}}),Object.defineProperty(this,"all",{value:function(e,n){void 0!==(e=e||{}).kid&&null!==e.kid&&"string"!=typeof e.kid&&(e.kid=String(e.kid));var i=[],o=function(t){return(!e.kty||!t.kty||e.kty===t.kty)&&((!e.use||!t.use||e.use===t.use)&&(!e.alg||("dir"===e.alg||!t.alg||e.alg===t.alg)&&t.supports(e.alg)))};return Object.keys(r).forEach((function(t){if(!e.kid||e.kid===t){var n=r[t].filter(o);n.length&&(i=i.concat(n))}})),!n&&t&&(i=i.concat(t.all(e))),i}}),Object.defineProperty(this,"get",{value:function(e,r,n){"boolean"==typeof e?(n=e,r=e=null):"object"==typeof e&&(n=r,r=e,e=null),r=r||{},e&&(r.kid=e),void 0!==r.kid&&null!==r.kid&&"string"!=typeof r.kid&&(r.kid=String(r.kid));var i=this.all(r,!0);return i.length||!t||n||(i=t.get(r,n)),i[0]||null}}),Object.defineProperty(this,"temp",{value:function(){return new d(e,this)}}),Object.defineProperty(this,"toJSON",{value:function(e){var t=[];return Object.keys(r).forEach((function(n){var i=r[n].map((function(t){return t.toJSON(e)}));t=t.concat(i)})),{keys:t}}})};d.isKeyStore=function(e){return!!e&&("object"==typeof e&&("function"==typeof e.get&&"function"==typeof e.all&&"function"==typeof e.generate&&"function"==typeof e.add&&"function"==typeof e.remove))},d.createKeyStore=function(){return new d(u)},d.asKeyStore=function(e){if(d.isKeyStore(e))return Promise.resolve(e);var t,r=d.createKeyStore();if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e))t=e;else{if(!("keys"in e))return Promise.reject(new Error("invalid keystore"));t=e.keys}t=t.map((function(e){return r.add(e)}));var n=Promise.all(t);return n=n.then((function(){return r}))},d.isKey=function(e){return!!e&&("object"==typeof e&&(!!d.isKeyStore(e.keystore)&&("string"==typeof e.kty&&"number"==typeof e.length&&"function"==typeof e.algorithms&&"function"==typeof e.supports&&"function"==typeof e.encrypt&&"function"==typeof e.decrypt&&"function"==typeof e.wrap&&"function"==typeof e.unwrap&&"function"==typeof e.sign&&"function"==typeof e.verify)))},d.createKey=function(e,t,r){return d.createKeyStore().generate(e,t,r)},d.asKey=function(e,t,r){return d.isKey(e)?Promise.resolve(e):e=d.createKeyStore().add(e,t,r)},e.exports={KeyRegistry:c,KeyStore:d,registry:u}},29170:(e,t,r)=>{"use strict";var n=r(44237),i={BaseKey:r(57136),helpers:r(49684)},o=["HS256","HS384","HS512"],s=["A128GCM","A192GCM","A256GCM","A128CBC-HS256","A192CBC-HS384","A256CBC-HS512","A128CBC+HS256","A192CBC+HS384","A256CBC+HS512"],a=["A128KW","A192KW","A256KW","A128GCMKW","A192GCMKW","A256GCMKW","PBES2-HS256+A128KW","PBES2-HS384+A192KW","PBES2-HS512+A256KW","dir"];function c(e,t){return"iv"in t&&(t.iv=Buffer.isBuffer(t.iv)?t.iv:n.base64url.decode(t.iv||"")),"adata"in t&&(t.adata=Buffer.isBuffer(t.adata)?t.adata:Buffer.from(t.adata||"","utf8")),"mac"in t&&(t.mac=Buffer.isBuffer(t.mac)?t.mac:n.base64url.decode(t.mac||"")),"tag"in t&&(t.tag=Buffer.isBuffer(t.tag)?t.tag:n.base64url.decode(t.tag||"")),t}function u(e,t){return"iv"in t&&(t.iv=Buffer.isBuffer(t.iv)?t.iv:n.base64url.decode(t.iv||"")),"adata"in t&&(t.adata=Buffer.isBuffer(t.adata)?t.adata:Buffer.from(t.adata||"","utf8")),t}var l={publicKey:function(e){var t=i.helpers.COMMON_PROPS.concat([]);return i.helpers.unpackProps(e,t)},privateKey:function(e){var t,r=i.helpers.COMMON_PROPS.concat([{name:"k",type:"binary"}]);return(t=i.helpers.unpackProps(e,r))&&t.k?t.length=8*t.k.length:t=void 0,t},thumbprint:function(e){return e.private&&(e=e.private),{k:e.k||"",kty:"oct"}},algorithms:function(e,t){var r=e.private&&8*e.private.k.length,n=[256,384,512];if(!r)return[];switch(t){case"encrypt":case"decrypt":return s.filter((function(e){return e==="A"+r/2+"CBC-HS"+r||e==="A"+r/2+"CBC+HS"+r||e==="A"+r+"GCM"}));case"sign":case"verify":return o.filter((function(e){var t=!1;return n.forEach((function(n){n>r||(t|=e==="HS"+n)})),t}));case"wrap":case"unwrap":return a.filter((function(e){return e==="A"+r+"KW"||e==="A"+r+"GCMKW"||0===e.indexOf("PBES2-")||"dir"===e}))}return[]},encryptKey:function(e,t){return t.private&&t.private.k},encryptProps:u,decryptKey:function(e,t){return t.private&&t.private.k},decryptProps:c,wrapKey:function(e,t){return t.private&&t.private.k},wrapProps:u,unwrapKey:function(e,t){return t.private&&t.private.k},unwrapProps:c,signKey:function(e,t){return t.private&&t.private.k},verifyKey:function(e,t){return t.private&&t.private.k}},d={kty:"oct",prepare:function(e){var t=l,r=Promise.resolve(e);return r=(r=r.then((function(e){return i.helpers.thumbprint(t,e)}))).then((function(r){var n={};return n[i.helpers.INTERNALS.THUMBPRINT_HASH]=r,e[i.helpers.INTERNALS.THUMBPRINT_KEY]=n,t}))},generate:function(e){var t=n.randomBytes(e/8);return Promise.resolve({k:t})}};e.exports=Object.freeze({config:l,factory:d}),r(4567).registry.register(d)},29746:(e,t,r)=>{"use strict";var n=r(41194),i=r(78501),o=r(83748).nodeCrypto,s={BaseKey:r(57136),helpers:r(49684)},a=["RS256","RS384","RS512","PS256","PS384","PS512"],c=["RSA-OAEP","RSA-OAEP-256","RSA1_5"],u={publicKey:function(e){var t,r=s.helpers.COMMON_PROPS.concat([{name:"n",type:"binary"},{name:"e",type:"binary"}]);return(t=s.helpers.unpackProps(e,r))&&t.n&&t.e?t.length=8*t.n.length:(delete t.e,delete t.n),t},privateKey:function(e){var t,r=s.helpers.COMMON_PROPS.concat([{name:"n",type:"binary"},{name:"e",type:"binary"},{name:"d",type:"binary"},{name:"p",type:"binary"},{name:"q",type:"binary"},{name:"dp",type:"binary"},{name:"dq",type:"binary"},{name:"qi",type:"binary"}]);return(t=s.helpers.unpackProps(e,r))&&t.d&&t.n&&t.e&&t.p&&t.q&&t.dp&&t.dq&&t.qi?t.length=8*t.d.length:t=void 0,t},thumbprint:function(e){return e.public&&(e=e.public),{e:e.e,kty:"RSA",n:e.n}},algorithms:function(e,t){switch(t){case"encrypt":case"decrypt":return[];case"wrap":return e.public&&c.slice()||[];case"unwrap":return e.private&&c.slice()||[];case"sign":return e.private&&a.slice()||[];case"verify":return e.public&&a.slice()||[]}return[]},wrapKey:function(e,t){return t.public},unwrapKey:function(e,t){return t.private},signKey:function(e,t){return t.private},verifyKey:function(e,t){return t.public},convertToPEM:function(e,t){var r=i.convertToForge(e,!t);return t?n.pki.privateKeyToPem(r):n.pki.publicKeyToPem(r)}};var l={oid:"1.2.840.113549.1.1.1",privateKey:{name:"RSAPrivateKey",tagClass:n.asn1.Class.UNIVERSAL,type:n.asn1.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:n.asn1.Class.UNIVERSAL,type:n.asn1.Type.INTEGER,constructed:!1,capture:"version"},{name:"RSAPrivateKey.modulus",tagClass:n.asn1.Class.UNIVERSAL,type:n.asn1.Type.INTEGER,constructed:!1,capture:"n"},{name:"RSAPrivateKey.publicExponent",tagClass:n.asn1.Class.UNIVERSAL,type:n.asn1.Type.INTEGER,constructed:!1,capture:"e"},{name:"RSAPrivateKey.privateExponent",tagClass:n.asn1.Class.UNIVERSAL,type:n.asn1.Type.INTEGER,constructed:!1,capture:"d"},{name:"RSAPrivateKey.prime1",tagClass:n.asn1.Class.UNIVERSAL,type:n.asn1.Type.INTEGER,constructed:!1,capture:"p"},{name:"RSAPrivateKey.prime2",tagClass:n.asn1.Class.UNIVERSAL,type:n.asn1.Type.INTEGER,constructed:!1,capture:"q"},{name:"RSAPrivateKey.exponent1",tagClass:n.asn1.Class.UNIVERSAL,type:n.asn1.Type.INTEGER,constructed:!1,capture:"dp"},{name:"RSAPrivateKey.exponent2",tagClass:n.asn1.Class.UNIVERSAL,type:n.asn1.Type.INTEGER,constructed:!1,capture:"dq"},{name:"RSAPrivateKey.coefficient",tagClass:n.asn1.Class.UNIVERSAL,type:n.asn1.Type.INTEGER,constructed:!1,capture:"qi"}]},publicKey:{name:"RSAPublicKey",tagClass:n.asn1.Class.UNIVERSAL,type:n.asn1.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:n.asn1.Class.UNIVERSAL,type:n.asn1.Type.INTEGER,constructed:!1,capture:"n"},{name:"RSAPublicKey.exponent",tagClass:n.asn1.Class.UNIVERSAL,type:n.asn1.Type.INTEGER,constructed:!1,capture:"e"}]}},d={kty:"RSA",validators:l,prepare:function(e){var t=u,r=Promise.resolve(e);return r=(r=r.then((function(e){return s.helpers.thumbprint(t,e)}))).then((function(r){var n={};return n[s.helpers.INTERNALS.THUMBPRINT_HASH]=r,e[s.helpers.INTERNALS.THUMBPRINT_KEY]=n,t}))},generate:function(e){var t;if(o)t=new Promise((function(t,r){n.pki.rsa.generateKeyPair({bits:e,e:65537},(function(e,n){if(e)return r(e);t(n.privateKey)}))}));else{var r=n.pki.rsa.generateKeyPair({bits:e,e:65537});t=Promise.resolve(r.privateKey)}return t.then((function(e){var t={};return["e","n","d","p","q",{incoming:"dP",outgoing:"dp"},{incoming:"dQ",outgoing:"dq"},{incoming:"qInv",outgoing:"qi"}].forEach((function(r){var n,i,o;"string"==typeof r?n=i=r:(n=r.incoming,i=r.outgoing),n in e&&(t[i]=((o=(o=e[n]).toString(16)).length%2&&(o="0"+o),Buffer.from(o,"hex")))})),t}))},import:function(e){if(l.oid!==e.keyOid)return null;if(!e.parsed){"string"==typeof e.keyValue?e.keyValue=n.asn1.fromDer(e.keyValue):Array.isArray(e.keyValue)&&(e.keyValue=e.keyValue[0]);var t="private"===e.type?l.privateKey:l.publicKey,r={};if(!n.asn1.validate(e.keyValue,t,r,[]))return null;e=r}var i={kty:"RSA"};return["n","e","d","p","q","dp","dq","qi"].forEach((function(t){if(t in e){var r=Buffer.from(e[t],"binary");0===r[0]&&(r=r.slice(1)),i[t]=r}})),i}};e.exports=Object.freeze({config:u,factory:d}),r(4567).registry.register(d)},46589:e=>{"use strict";e.exports={compact:!1,protect:"*"}},97286:e=>{"use strict";e.exports={slice:function(e,t){return Array.prototype.slice.call(e,t||0)}}},32109:(e,t,r)=>{"use strict";var n={createSign:r(54873).createSign,createVerify:r(58747).createVerify};e.exports=n},54873:(e,t,r)=>{"use strict";var n=r(85029),i=r(44237),o=r(32543),s=r(97286).slice,a=r(66678),c=r(44908),u=r(46589),l=function(e,t){var r=!1,n=e.format||"general",o=Buffer.alloc(0);Object.defineProperty(this,"compact",{get:function(){return"compact"===n},enumerable:!0}),Object.defineProperty(this,"format",{get:function(){return n},enumerable:!0}),Object.defineProperty(this,"update",{value:function(e,t){if(r)throw new Error("already final");return null!=e&&(e=i.asBuffer(e,t),o=o.length?Buffer.concat([o,e],o.length+e.length):e),this}}),Object.defineProperty(this,"final",{value:function(e,s){if(r)return Promise.reject(new Error("already final"));var c;switch(this.update(e,s),r=!0,c=(c=Promise.all(t)).then((function(e){return o=i.base64url.encode(o),e=e.map((function(e){var t={},r=0,n=a(e.header),s=Object.keys(n).length;e.protected.forEach((function(e){e in n&&(t[e]=n[e],r++,delete n[e],s--)})),r>0?(t=JSON.stringify(t),t=i.base64url.encode(t)):t="";var c=Buffer.from(t+"."+o,"ascii");return e=(e=e.key.sign(e.header.alg,c,e.header)).then((function(e){var o={};return 0<r&&(o.protected=t),0<s&&(o.header=n),o.signature=i.base64url.encode(e.mac),o}))})),e=[Promise.resolve(o)].concat(e),Promise.all(e)})),c=c.then((function(e){return{payload:e[0],signatures:e.slice(1)}})),n){case"compact":c=c.then((function(e){var t=[e.signatures[0].protected,e.payload,e.signatures[0].signature];return t=t.join(".")}));break;case"flattened":c=c.then((function(e){var t={};t.payload=e.payload;var r=e.signatures[0];return r.protected&&(t.protected=r.protected),r.header&&(t.header=r.header),t.signature=r.signature,t}))}return c}})};e.exports={signer:l,createSign:function(e,t){var r=e,i=1,d=t;if(0===arguments.length)throw new Error("at least one signatory must be provided");1===arguments.length||o.isKey(e)||e&&"kty"in e||e&&"key"in e&&(o.isKey(e.key)||"kty"in e.key)?(d=e,i=0,r={}):r=a(e),Array.isArray(d)||(d=s(arguments,i));var h=(r=n(a(u),r)).fields||{},f=r.format;if(f||(f=r.compact?"compact":"general"),("compact"===f||"flattened"===f)&&1<d.length)throw new Error("too many signatories for compact or flattened JSON serialization");var p="*"===r.protect;return r.compact&&(p=!0),d=d.map((function(e,t){return(e&&"kty"in e?o.asKey(e).then((function(e){return{key:e}})):e?o.asKey(e.key).then((function(t){return{header:e.header,reference:e.reference,protect:e.protect,key:t}})):Promise.reject(new Error("missing key for signatory "+t))).then((function(e){var t=e.key,r=e.header||{};r=n(n({},h),r),e.header=r,r.alg||(r.alg=t.algorithms(o.MODE_SIGN)[0]||"");var i,s=e.reference;if(delete e.reference,void 0===s?s=(s=["kid","jku","x5c","x5t","x5u"].some((function(e){return e in r})))?null:"kid":"boolean"==typeof s&&(s=s?"kid":null),s)if(i=t.toJSON(),"jwk"===s){if("oct"===t.kty)return Promise.reject(new Error("cannot embed key"));r.jwk=i}else s in i&&(r[s]=i[s]);var a=e.protect;if(p||"*"===a)a=Object.keys(r);else if("string"===a)a=[a];else if(Array.isArray(a))a=a.concat();else{if(a)return Promise.reject(new Error("protect must be a list of fields"));a=[]}return a=c(a),e.protected=a,e=Object.freeze(e)}))})),new l({format:f},d)}}},58747:(e,t,r)=>{"use strict";var n=r(66678),i=r(85029),o=r(9752),s=r(63171),a=r(32543),c={algorithms:"*",allowEmbeddedKey:!1},u=function(e,t){var r,u;u=a.isKey(e)?(r=e).keystore:a.isKeyStore(e)?e:a.createKeyStore(),t=i(c,t),Object.defineProperty(this,"defaultKey",{value:r||void 0,enumerable:!0}),Object.defineProperty(this,"keystore",{value:u,enumerable:!0}),Object.defineProperty(this,"verify",{value:function(e,c){var l=(c=i({},t,c||{})).handlers||{},d=Object.keys(l),h=new s(c.algorithms);if("string"==typeof e)e={payload:(e=e.split("."))[1],signatures:[{protected:e[0],signature:e[2]}]};else if(!e||"object"!=typeof e)throw new Error("invalid input");e.signature&&(e.signatures=[{protected:e.protected||void 0,header:e.header||void 0,signature:e.signature}]);var f=e.signatures||[{}];f=f.map((function(e){var t=n(e.header||{}),r=e.protected?JSON.parse(o.decode(e.protected,"utf8")):{};t=i(t,r);var s=o.decode(e.signature);if(!h.match(t.alg))return Promise.reject(new Error("Algorithm not allowed: "+t.alg));var a=r.crit;if(a){if(!Array.isArray(a))return Promise.reject(new Error("Invalid 'crit' header"));for(var c=0;a.length>c;c++)if(-1===d.indexOf(a[c]))return Promise.reject(new Error("Critical extension is not supported: "+a[c]))}return r=Object.keys(r),Promise.resolve({protected:r,aad:e.protected||"",header:t,signature:s})}));var p=Promise.all(f);return p=p.then((function(t){return new Promise((function(n,s){var h=function(){var f=t.shift();if(f){f=i({},f,{payload:e.payload});var p=Promise.resolve(f);p=p.then((function(e){var t;return c.allowEmbeddedKey&&e.header.jwk?t=a.asKey(e.header.jwk):c.allowEmbeddedKey&&e.header.x5c?(t=e.header.x5c[0],t=Buffer.from(t,"base64"),t=a.asKey(t,"pkix")):t=Promise.resolve(r||u.get({use:"sig",alg:e.header.alg,kid:e.header.kid})),t.then((function(t){return t?(e.key=t,e):Promise.reject(new Error("key does not match"))}))})),p=p.then((function(e){var t=[];return d.forEach((function(r){var n;"function"==typeof(r=l[r])?n=r(e):"object"==typeof r&&"function"==typeof r.prepare&&(n=r.prepare(e)),n&&t.push(Promise.resolve(n))})),Promise.all(t).then((function(){return e}))})),p=p.then((function(e){var t=e.aad||"",r=e.payload||"",n=Buffer.alloc(1+t.length+r.length),i=0;return n.write(t,i,"ascii"),i+=t.length,n.write(".",i,"ascii"),i++,Buffer.isBuffer(r)?r.copy(n,i):n.write(r,i,"binary"),e.content=n,e})),p=p.then((function(e){return e.key.verify(e.header.alg,e.content,e.signature)})),(p=(p=p.then((function(e){var t=f.payload;return t=o.decode(t),{protected:f.protected,header:f.header,payload:t,signature:e.mac,key:f.key}}))).then((function(e){var t=[];return d.forEach((function(r){var n;"object"==typeof(r=l[r])&&"function"==typeof r.complete&&(n=r.complete(e)),n&&t.push(Promise.resolve(n))})),Promise.all(t).then((function(){return e}))}))).then(n,h)}else s(new Error("no key found"))};h()}))})),p}})};e.exports={verifier:u,createVerify:function(e,t){return new u(e,t)}}},92393:(e,t,r)=>{"use strict";var n={JWE:r(30701),JWS:r(32109),util:r(44237)};e.exports=function(e){var t,r,i,o=e.split(".");if(3===o.length)t="JWS",r=function(t,r){return n.JWS.createVerify(t).verify(e,r)};else{if(5!==o.length)throw new TypeError("invalid jose serialization");t="JWE",r=function(t,r){return n.JWE.createDecrypt(t).decrypt(e,r)}}return i=n.util.base64url.decode(o[0],"utf8"),i=JSON.parse(i),{type:t,format:"compact",input:e,header:i,perform:r}}},48650:(e,t,r)=>{"use strict";var n=r(92393),i=r(94631),o=e.exports=function(e){if(Buffer.isBuffer(e))return n(e.toString("ascii"));if("string"==typeof e)return n(e);if(e)return i(e);throw new TypeError("invalid input")};o.compact=n,o.json=i},94631:(e,t,r)=>{"use strict";var n=r(85029),i={JWE:r(30701),JWS:r(32109),util:r(44237)};e.exports=function(e){var t,r,o;if("signatures"in e||"signature"in e)t="JWS",r=function(t,r){return i.JWS.createVerify(t).verify(e,r)},o=(o=e.signatures||[{protected:e.protected,header:e.header,signature:e.signature}]).map((function(e){var t,r={};return e.header&&(r=n(r,e.header)),e.protected&&(t=e.protected,t=i.util.base64url.decode(t,"utf8"),t=JSON.parse(t),r=n(r,t)),r}));else if("ciphertext"in e){t="JWE",r=function(t,r){return i.JWE.createDecrypt(t).decrypt(e,r)};var s={};e.protected&&(s.protected=e.protected,s.protected=i.util.base64url.decode(s.protected,"utf8"),s.protected=JSON.parse(s.protected)),e.unprotected&&(s.unprotected=e.unprotected),o=(o=e.recipients||[{}]).map((function(e){var t={};return e.header&&(t=n(t,e.header)),s.unprotected&&(t=n(t,s.unprotected)),s.protected&&(t=n(t,s.protected)),t}))}return{type:t,format:"json",input:e,all:o,perform:r}}},63171:e=>{"use strict";function t(e){return e.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}e.exports=function(e){e?"string"==typeof e&&(e=e.split(" ")):e=[];var r,n=[],i=[],o=[],s=[],a=/^(!)?([^*]*)(\*?)([^*]*)$/;e.forEach((function(e){if(e){a.lastIndex=0;var c=a.exec(e);c&&(r="("+function(e,r,n){var i=[];return i.push("^"),e&&(e=t(e),i.push(e)),r&&i.push(e||n?".*":".+"),n&&(n=t(n),i.push(n)),i.push("$"),i.join("")}(c[2],c[3],c[4])+")",c[1]?(s.push(r),i.push(c[0])):(o.push(r),n.push(c[0])))}})),o=o.length?new RegExp(o.join("|")):null,s=s.length?new RegExp(s.join("|")):null,n.length||(n=["*"]),Object.defineProperty(this,"spec",{value:n.join(" ")+" "+i.join(" "),enumerable:!0}),Object.defineProperty(this,"match",{value:function(e){var t=Boolean(e);return t&&o&&(o.lastIndex=0,t=o.test(e)),t&&s&&(s.lastIndex=0,t=!s.test(e)),t}})}},9752:(e,t,r)=>{"use strict";var n=r(45772),i={encode:function(e,t){return e instanceof ArrayBuffer&&(e=new Uint8Array(e)),Buffer.isBuffer(e)||(e=Buffer.from(e,t)),n.encode(e)},decode:n.toBuffer};e.exports=i},64678:(e,t,r)=>{"use strict";var n=r(41194),i=r(9752);function o(e,t){t=t||{},Buffer.isBuffer(e)?this.data=e:n.util.isArrayBuffer(e)?(e=new Uint8Array(e),this.data=Buffer.from(e)):n.util.isArrayBufferView(e)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),this.data=Buffer.from(e)),this.data&&(this.write=this.data.length,e=void 0),this.growSize=t.growSize||o.DEFAULT_GROW_SIZE,this.write=this.write||0,this.read=this.read||0,e?this.putBytes(e):this.data||this.accommodate(0),t.readOffset="readOffset"in t?t.readOffset:this.read,this.write="writeOffset"in t?t.writeOffset:this.write,this.read=Math.min(t.readOffset,this.write)}o.DEFAULT_GROW_SIZE=16,o.prototype.length=function(){return this.write-this.read},o.prototype.available=function(){return this.data.length-this.write},o.prototype.isEmpty=function(){return this.length()<=0},o.prototype.accommodate=function(e){if(this.data){if(this.available()<e){e=Math.max(e,this.growSize);var t=this.data,r=Buffer.alloc(t.length+e);t.copy(r,0),this.data=r}}else e=Math.max(this.write+e,this.growSize),this.data=Buffer.alloc(e);return this.data.fill(0,this.write),this},o.prototype.clear=function(){return this.read=this.write=0,this.data=Buffer.alloc(0),this},o.prototype.truncate=function(e){return this.write=this.read+Math.max(0,this.length()-e),this.data.fill(0,this.write),this},o.prototype.compact=function(){return this.read>0&&(this.write===this.read?this.read=this.write=0:(this.data.copy(this.data,0,this.read,this.write),this.write=this.write-this.read,this.read=0),this.data.fill(0,this.write)),this},o.prototype.copy=function(){return new o(this,{readOffset:this.read,writeOffset:this.write,growSize:this.growSize})},o.prototype.equals=function(e){if(!o.isBuffer(e))return!1;if(e.length()!==this.length())return!1;for(var t=!0,r=this.read-e.read,n=e.read;e.write>n;n++)t=t&&this.data[n+r]===e.data[n];return t},o.prototype.at=function(e){return this.data[this.read+e]},o.prototype.setAt=function(e,t){return this.data[this.read+e]=t,this},o.prototype.last=function(){return this.data[this.write-1]},o.prototype.bytes=function(e){var t;if(void 0===e?e=this.length():e&&(e=Math.min(e,this.length())),0===e)t="";else{var r=this.read,n=r+e,i=this.data.slice(r,n);t=String.fromCharCode.apply(null,i)}return t},o.prototype.buffer=function(e){var t;if(void 0===e?e=this.length():e&&(e=Math.min(e,this.length())),0===e)t=new ArrayBuffer(0);else{var r=this.read,n=r+e,i=this.data.slice(r,n);(t=new Uint8Array(n-r)).set(i)}return t},o.prototype.native=function(e){var t;if(void 0===e?e=this.length():e&&(e=Math.min(e,this.length())),0===e)t=Buffer.alloc(0);else{var r=this.read,n=r+e;t=this.data.slice(r,n)}return t},o.prototype.toHex=function(){return this.toString("hex")},o.prototype.toString=function(e){if(0===this.length())return"";var t=this.data.slice(this.read,this.write);switch(e=e||"utf8"){case"raw":return t.toString("binary");case"base64url":return i.encode(t);case"utf16":return t.toString("ucs2");default:return t.toString(e)}},o.prototype.fillWithByte=function(e,t){return t||(t=this.available()),this.accommodate(t),this.data.fill(e,this.write,this.write+t),this.write+=t,this},o.prototype.getBuffer=function(e){var t=this.buffer(e);return this.read+=t.byteLength,t},o.prototype.putBuffer=function(e){return this.putBytes(e)},o.prototype.getBytes=function(e){var t=this.bytes(e);return this.read+=t.length,t},o.prototype.putBytes=function(e,t){if("string"==typeof e){switch(t=t||"binary"){case"utf16":t="ucs-2";break;case"raw":t="binary";break;case"base64url":e=i.decode(e)}Buffer.isBuffer(e)||(e=Buffer.from(e,t))}var r,s;if(e instanceof o){var a=e;e=a.data.slice(a.read,a.write),a.read=a.write}else e instanceof n.util.ByteStringBuffer&&(e=e.getBytes());if(Buffer.isBuffer(e))r=e;else if(Array.isArray(e))r=Buffer.from(e);else if(n.util.isArrayBuffer(e))r=new Uint8Array(e),r=Buffer.from(r);else{if(!n.util.isArrayBufferView(e))throw new TypeError("invalid source type");r=e instanceof Uint8Array?e:new Uint8Array(e.buffer,e.byteOffset,e.byteLength),r=Buffer.from(r)}return this.accommodate(r.length),s=this.data,r.copy(s,this.write),this.write+=r.length,this},o.prototype.getNative=function(e){var t=this.native(e);return this.read+=t.length,t},o.prototype.putNative=o.prototype.putBuffer,o.prototype.getByte=function(){var e=this.data[this.read];return this.read=Math.min(this.read+1,this.write),e},o.prototype.putByte=function(e){return this.accommodate(1),this.data[this.write]=255&e,this.write++,this},o.prototype.getInt16=function(){var e=this.data[this.read]<<8^this.data[this.read+1];return this.read=Math.min(this.read+2,this.write),e},o.prototype.putInt16=function(e){return this.accommodate(2),this.data[this.write]=e>>>8&255,this.data[this.write+1]=255&e,this.write+=2,this},o.prototype.getInt24=function(){var e=this.data[this.read]<<16^this.data[this.read+1]<<8^this.data[this.read+2];return this.read=Math.min(this.read+3,this.write),e},o.prototype.putInt24=function(e){return this.accommodate(3),this.data[this.write]=e>>>16&255,this.data[this.write+1]=e>>>8&255,this.data[this.write+2]=255&e,this.write+=3,this},o.prototype.getInt32=function(){var e=this.data[this.read]<<24^this.data[this.read+1]<<16^this.data[this.read+2]<<8^this.data[this.read+3];return this.read=Math.min(this.read+4,this.write),e},o.prototype.putInt32=function(e){return this.accommodate(4),this.data[this.write]=e>>>24&255,this.data[this.write+1]=e>>>16&255,this.data[this.write+2]=e>>>8&255,this.data[this.write+3]=255&e,this.write+=4,this},o.prototype.getInt16Le=function(){var e=this.data[this.read+1]<<8^this.data[this.read];return this.read=Math.min(this.read+2,this.write),e},o.prototype.putInt16Le=function(e){return this.accommodate(2),this.data[this.write+1]=e>>>8&255,this.data[this.write]=255&e,this.write+=2,this},o.prototype.getInt24Le=function(){var e=this.data[this.read+2]<<16^this.data[this.read+1]<<8^this.data[this.read];return this.read=Math.min(this.read+3,this.write),e},o.prototype.putInt24Le=function(e){return this.accommodate(3),this.data[this.write+2]=e>>>16&255,this.data[this.write+1]=e>>>8&255,this.data[this.write]=255&e,this.write+=3,this},o.prototype.getInt32Le=function(){var e=this.data[this.read+3]<<24^this.data[this.read+2]<<16^this.data[this.read+1]<<8^this.data[this.read];return this.read=Math.min(this.read+4,this.write),e},o.prototype.putInt32Le=function(e){return this.accommodate(4),this.data[this.write+3]=e>>>24&255,this.data[this.write+2]=e>>>16&255,this.data[this.write+1]=e>>>8&255,this.data[this.write]=255&e,this.write+=4,this},o.prototype.getInt=function(e){var t=0;do{t=t<<8|this.getByte(),e-=8}while(e>0);return t},o.prototype.putInt=function(e,t){this.accommodate(Math.ceil(t/8));do{t-=8,this.putByte(e>>t&255)}while(t>0);return this},o.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)},o.prototype.putString=function(e){return this.putBytes(e,"utf16")},o.isBuffer=function(e){return e instanceof o},o.asBuffer=function(e){return o.isBuffer(e)?e:e?new o(e):new o},e.exports=o},44237:(e,t,r)=>{"use strict";var n,i=r(41194);n={base64url:r(9752),utf8:r(49451),asBuffer:function(e,t){return Buffer.isBuffer(e)?e:"string"==typeof e?"base64url"===(t=t||"binary")?n.base64url.decode(e):Buffer.from(e,t):(i.util.isArrayBufferView(e)?e=e instanceof Uint8Array?e:new Uint8Array(e.buffer,e.byteOffset,e.byteOffset+e.byteLength):i.util.isArrayBuffer(e)&&(e=new Uint8Array(e)),Buffer.from(e))},randomBytes:function(e){return Buffer.from(i.random.getBytes(e),"binary")}},e.exports=n},85029:(e,t,r)=>{"use strict";var n,i=r(65544),o=r(82492),s=(n=[],"undefined"!=typeof Uint8ClampedArray&&n.push(Uint8ClampedArray),"undefined"!=typeof Uint8Array&&n.push(Uint8Array),"undefined"!=typeof Uint16Array&&n.push(Uint16Array),"undefined"!=typeof Uint32Array&&n.push(Uint32Array),"undefined"!=typeof Float32Array&&n.push(Float32Array),"undefined"!=typeof Float64Array&&n.push(Float64Array),n);e.exports=i(o,(function(e,t){if(Buffer.isBuffer(t))t=Buffer.from(t);else{var r=function(e){for(var t,r=0;!t&&s.length>r;r++)e instanceof s[r]&&(t=s[r]);return t}(t);t=r?new r(t,t.byteOffset,t.byteLength):void 0}return t,t}))},49451:(e,t)=>{"use strict";var r=t;r.encode=function(e){var t=encodeURIComponent(e||"");return t=t.replace(/%([0-9a-fA-F]{2})/g,(function(e,t){return t=parseInt(t,16),String.fromCharCode(t)}))},r.decode=function(e){var t=(e||"").replace(/[\u0080-\u00ff]/g,(function(e){return"%"+(256|e.charCodeAt(0)).toString(16).substring(1)}));return t=decodeURIComponent(t)}},65967:(e,t,r)=>{"use strict";const{Deflate:n,deflate:i,deflateRaw:o,gzip:s}=r(85850),{Inflate:a,inflate:c,inflateRaw:u,ungzip:l}=r(15169),d=r(90165);e.exports.Deflate=n,e.exports.deflate=i,e.exports.deflateRaw=o,e.exports.gzip=s,e.exports.Inflate=a,e.exports.inflate=c,e.exports.inflateRaw=u,e.exports.ungzip=l,e.exports.constants=d},85850:(e,t,r)=>{"use strict";const n=r(14658),i=r(84806),o=r(28493),s=r(57686),a=r(70444),c=Object.prototype.toString,{Z_NO_FLUSH:u,Z_SYNC_FLUSH:l,Z_FULL_FLUSH:d,Z_FINISH:h,Z_OK:f,Z_STREAM_END:p,Z_DEFAULT_COMPRESSION:m,Z_DEFAULT_STRATEGY:g,Z_DEFLATED:v}=r(90165);function y(e){this.options=i.assign({level:m,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:g},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;let r=n.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==f)throw new Error(s[r]);if(t.header&&n.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?o.string2buf(t.dictionary):"[object ArrayBuffer]"===c.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,r=n.deflateSetDictionary(this.strm,e),r!==f)throw new Error(s[r]);this._dict_set=!0}}function b(e,t){const r=new y(t);if(r.push(e,!0),r.err)throw r.msg||s[r.err];return r.result}y.prototype.push=function(e,t){const r=this.strm,i=this.options.chunkSize;let s,a;if(this.ended)return!1;for(a=t===~~t?t:!0===t?h:u,"string"==typeof e?r.input=o.string2buf(e):"[object ArrayBuffer]"===c.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(i),r.next_out=0,r.avail_out=i),(a===l||a===d)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(s=n.deflate(r,a),s===p)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),s=n.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===f;if(0!==r.avail_out){if(a>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}else this.onData(r.output)}return!0},y.prototype.onData=function(e){this.chunks.push(e)},y.prototype.onEnd=function(e){e===f&&(this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.exports.Deflate=y,e.exports.deflate=b,e.exports.deflateRaw=function(e,t){return(t=t||{}).raw=!0,b(e,t)},e.exports.gzip=function(e,t){return(t=t||{}).gzip=!0,b(e,t)},e.exports.constants=r(90165)},15169:(e,t,r)=>{"use strict";const n=r(19846),i=r(84806),o=r(28493),s=r(57686),a=r(70444),c=r(88210),u=Object.prototype.toString,{Z_NO_FLUSH:l,Z_FINISH:d,Z_OK:h,Z_STREAM_END:f,Z_NEED_DICT:p,Z_STREAM_ERROR:m,Z_DATA_ERROR:g,Z_MEM_ERROR:v}=r(90165);function y(e){this.options=i.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;let r=n.inflateInit2(this.strm,t.windowBits);if(r!==h)throw new Error(s[r]);if(this.header=new c,n.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=o.string2buf(t.dictionary):"[object ArrayBuffer]"===u.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=n.inflateSetDictionary(this.strm,t.dictionary),r!==h)))throw new Error(s[r])}function b(e,t){const r=new y(t);if(r.push(e),r.err)throw r.msg||s[r.err];return r.result}y.prototype.push=function(e,t){const r=this.strm,i=this.options.chunkSize,s=this.options.dictionary;let a,c,y;if(this.ended)return!1;for(c=t===~~t?t:!0===t?d:l,"[object ArrayBuffer]"===u.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(0===r.avail_out&&(r.output=new Uint8Array(i),r.next_out=0,r.avail_out=i),a=n.inflate(r,c),a===p&&s&&(a=n.inflateSetDictionary(r,s),a===h?a=n.inflate(r,c):a===g&&(a=p));r.avail_in>0&&a===f&&r.state.wrap>0&&0!==e[r.next_in];)n.inflateReset(r),a=n.inflate(r,c);switch(a){case m:case g:case p:case v:return this.onEnd(a),this.ended=!0,!1}if(y=r.avail_out,r.next_out&&(0===r.avail_out||a===f))if("string"===this.options.to){let e=o.utf8border(r.output,r.next_out),t=r.next_out-e,n=o.buf2string(r.output,e);r.next_out=t,r.avail_out=i-t,t&&r.output.set(r.output.subarray(e,e+t),0),this.onData(n)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(a!==h||0!==y){if(a===f)return a=n.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(0===r.avail_in)break}}return!0},y.prototype.onData=function(e){this.chunks.push(e)},y.prototype.onEnd=function(e){e===h&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.exports.Inflate=y,e.exports.inflate=b,e.exports.inflateRaw=function(e,t){return(t=t||{}).raw=!0,b(e,t)},e.exports.ungzip=b,e.exports.constants=r(90165)},84806:e=>{"use strict";const t=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);e.exports.assign=function(e){const r=Array.prototype.slice.call(arguments,1);for(;r.length;){const n=r.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const r in n)t(n,r)&&(e[r]=n[r])}}return e},e.exports.flattenChunks=e=>{let t=0;for(let r=0,n=e.length;r<n;r++)t+=e[r].length;const r=new Uint8Array(t);for(let t=0,n=0,i=e.length;t<i;t++){let i=e[t];r.set(i,n),n+=i.length}return r}},28493:e=>{"use strict";let t=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){t=!1}const r=new Uint8Array(256);for(let e=0;e<256;e++)r[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;r[254]=r[254]=1,e.exports.string2buf=e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,r,n,i,o,s=e.length,a=0;for(i=0;i<s;i++)r=e.charCodeAt(i),55296==(64512&r)&&i+1<s&&(n=e.charCodeAt(i+1),56320==(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),i++)),a+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(a),o=0,i=0;o<a;i++)r=e.charCodeAt(i),55296==(64512&r)&&i+1<s&&(n=e.charCodeAt(i+1),56320==(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?t[o++]=r:r<2048?(t[o++]=192|r>>>6,t[o++]=128|63&r):r<65536?(t[o++]=224|r>>>12,t[o++]=128|r>>>6&63,t[o++]=128|63&r):(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63,t[o++]=128|r>>>6&63,t[o++]=128|63&r);return t};e.exports.buf2string=(e,n)=>{const i=n||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,n));let o,s;const a=new Array(2*i);for(s=0,o=0;o<i;){let t=e[o++];if(t<128){a[s++]=t;continue}let n=r[t];if(n>4)a[s++]=65533,o+=n-1;else{for(t&=2===n?31:3===n?15:7;n>1&&o<i;)t=t<<6|63&e[o++],n--;n>1?a[s++]=65533:t<65536?a[s++]=t:(t-=65536,a[s++]=55296|t>>10&1023,a[s++]=56320|1023&t)}}return((e,r)=>{if(r<65534&&e.subarray&&t)return String.fromCharCode.apply(null,e.length===r?e:e.subarray(0,r));let n="";for(let t=0;t<r;t++)n+=String.fromCharCode(e[t]);return n})(a,s)},e.exports.utf8border=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+r[e[n]]>t?n:t}},50154:e=>{"use strict";e.exports=(e,t,r,n)=>{let i=65535&e|0,o=e>>>16&65535|0,s=0;for(;0!==r;){s=r>2e3?2e3:r,r-=s;do{i=i+t[n++]|0,o=o+i|0}while(--s);i%=65521,o%=65521}return i|o<<16|0}},90165:e=>{"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},74223:e=>{"use strict";const t=new Uint32Array((()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t})());e.exports=(e,r,n,i)=>{const o=t,s=i+n;e^=-1;for(let t=i;t<s;t++)e=e>>>8^o[255&(e^r[t])];return-1^e}},14658:(e,t,r)=>{"use strict";const{_tr_init:n,_tr_stored_block:i,_tr_flush_block:o,_tr_tally:s,_tr_align:a}=r(45732),c=r(50154),u=r(74223),l=r(57686),{Z_NO_FLUSH:d,Z_PARTIAL_FLUSH:h,Z_FULL_FLUSH:f,Z_FINISH:p,Z_BLOCK:m,Z_OK:g,Z_STREAM_END:v,Z_STREAM_ERROR:y,Z_DATA_ERROR:b,Z_BUF_ERROR:E,Z_DEFAULT_COMPRESSION:w,Z_FILTERED:S,Z_HUFFMAN_ONLY:_,Z_RLE:T,Z_FIXED:x,Z_DEFAULT_STRATEGY:A,Z_UNKNOWN:I,Z_DEFLATED:C}=r(90165),R=258,k=262,O=42,N=113,P=666,L=(e,t)=>(e.msg=l[t],t),D=e=>2*e-(e>4?9:0),M=e=>{let t=e.length;for(;--t>=0;)e[t]=0},U=e=>{let t,r,n,i=e.w_size;t=e.hash_size,n=t;do{r=e.head[--n],e.head[n]=r>=i?r-i:0}while(--t);t=i,n=t;do{r=e.prev[--n],e.prev[n]=r>=i?r-i:0}while(--t)};let B=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask;const F=e=>{const t=e.state;let r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))},j=(e,t)=>{o(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,F(e.strm)},V=(e,t)=>{e.pending_buf[e.pending++]=t},H=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},G=(e,t,r,n)=>{let i=e.avail_in;return i>n&&(i=n),0===i?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),r),1===e.state.wrap?e.adler=c(e.adler,t,i,r):2===e.state.wrap&&(e.adler=u(e.adler,t,i,r)),e.next_in+=i,e.total_in+=i,i)},q=(e,t)=>{let r,n,i=e.max_chain_length,o=e.strstart,s=e.prev_length,a=e.nice_match;const c=e.strstart>e.w_size-k?e.strstart-(e.w_size-k):0,u=e.window,l=e.w_mask,d=e.prev,h=e.strstart+R;let f=u[o+s-1],p=u[o+s];e.prev_length>=e.good_match&&(i>>=2),a>e.lookahead&&(a=e.lookahead);do{if(r=t,u[r+s]===p&&u[r+s-1]===f&&u[r]===u[o]&&u[++r]===u[o+1]){o+=2,r++;do{}while(u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&o<h);if(n=R-(h-o),o=h-R,n>s){if(e.match_start=t,s=n,n>=a)break;f=u[o+s-1],p=u[o+s]}}}while((t=d[t&l])>c&&0!=--i);return s<=e.lookahead?s:e.lookahead},$=e=>{const t=e.w_size;let r,n,i;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-k)&&(e.window.set(e.window.subarray(t,t+t-n),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),U(e),n+=t),0===e.strm.avail_in)break;if(r=G(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=r,e.lookahead+e.insert>=3)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=B(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=B(e,e.ins_h,e.window[i+3-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<k&&0!==e.strm.avail_in)},Z=(e,t)=>{let r,n,o,s=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,a=0,c=e.strm.avail_in;do{if(r=65535,o=e.bi_valid+42>>3,e.strm.avail_out<o)break;if(o=e.strm.avail_out-o,n=e.strstart-e.block_start,r>n+e.strm.avail_in&&(r=n+e.strm.avail_in),r>o&&(r=o),r<s&&(0===r&&t!==p||t===d||r!==n+e.strm.avail_in))break;a=t===p&&r===n+e.strm.avail_in?1:0,i(e,0,0,a),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,F(e.strm),n&&(n>r&&(n=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+n),e.strm.next_out),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n,e.block_start+=n,r-=n),r&&(G(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r)}while(0===a);return c-=e.strm.avail_in,c&&(c>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=c&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-c,e.strm.next_in),e.strstart),e.strstart+=c,e.insert+=c>e.w_size-e.insert?e.w_size-e.insert:c),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),a?4:t!==d&&t!==p&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(o=e.window_size-e.strstart,e.strm.avail_in>o&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,o+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),o>e.strm.avail_in&&(o=e.strm.avail_in),o&&(G(e.strm,e.window,e.strstart,o),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.high_water<e.strstart&&(e.high_water=e.strstart),o=e.bi_valid+42>>3,o=e.pending_buf_size-o>65535?65535:e.pending_buf_size-o,s=o>e.w_size?e.w_size:o,n=e.strstart-e.block_start,(n>=s||(n||t===p)&&t!==d&&0===e.strm.avail_in&&n<=o)&&(r=n>o?o:n,a=t===p&&0===e.strm.avail_in&&r===n?1:0,i(e,e.block_start,r,a),e.block_start+=r,F(e.strm)),a?3:1)},z=(e,t)=>{let r,n;for(;;){if(e.lookahead<k){if($(e),e.lookahead<k&&t===d)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=B(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-k&&(e.match_length=q(e,r)),e.match_length>=3)if(n=s(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=B(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=B(e,e.ins_h,e.window[e.strstart+1]);else n=s(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(j(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===p?(j(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(j(e,!1),0===e.strm.avail_out)?1:2},K=(e,t)=>{let r,n,i;for(;;){if(e.lookahead<k){if($(e),e.lookahead<k&&t===d)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=B(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-k&&(e.match_length=q(e,r),e.match_length<=5&&(e.strategy===S||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,n=s(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=B(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(j(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(n=s(e,0,e.window[e.strstart-1]),n&&j(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=s(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===p?(j(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(j(e,!1),0===e.strm.avail_out)?1:2};function W(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}const J=[new W(0,0,0,0,Z),new W(4,4,8,4,z),new W(4,5,16,8,z),new W(4,6,32,32,z),new W(4,4,16,16,K),new W(8,16,32,32,K),new W(8,16,128,128,K),new W(8,32,128,256,K),new W(32,128,258,1024,K),new W(32,258,258,4096,K)];function Y(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=C,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),M(this.dyn_ltree),M(this.dyn_dtree),M(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),M(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),M(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Q=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==O&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==N&&t.status!==P?1:0},X=e=>{if(Q(e))return L(e,y);e.total_in=e.total_out=0,e.data_type=I;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?O:N,e.adler=2===t.wrap?0:1,t.last_flush=-2,n(t),g},ee=e=>{const t=X(e);var r;return t===g&&((r=e.state).window_size=2*r.w_size,M(r.head),r.max_lazy_match=J[r.level].max_lazy,r.good_match=J[r.level].good_length,r.nice_match=J[r.level].nice_length,r.max_chain_length=J[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=2,r.match_available=0,r.ins_h=0),t},te=(e,t,r,n,i,o)=>{if(!e)return y;let s=1;if(t===w&&(t=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),i<1||i>9||r!==C||n<8||n>15||t<0||t>9||o<0||o>x||8===n&&1!==s)return L(e,y);8===n&&(n=9);const a=new Y;return e.state=a,a.strm=e,a.status=O,a.wrap=s,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=i+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<i+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=t,a.strategy=o,a.method=r,ee(e)};e.exports.deflateInit=(e,t)=>te(e,t,C,15,8,A),e.exports.deflateInit2=te,e.exports.deflateReset=ee,e.exports.deflateResetKeep=X,e.exports.deflateSetHeader=(e,t)=>Q(e)||2!==e.state.wrap?y:(e.state.gzhead=t,g),e.exports.deflate=(e,t)=>{if(Q(e)||t>m||t<0)return e?L(e,y):y;const r=e.state;if(!e.output||0!==e.avail_in&&!e.input||r.status===P&&t!==p)return L(e,0===e.avail_out?E:y);const n=r.last_flush;if(r.last_flush=t,0!==r.pending){if(F(e),0===e.avail_out)return r.last_flush=-1,g}else if(0===e.avail_in&&D(t)<=D(n)&&t!==p)return L(e,E);if(r.status===P&&0!==e.avail_in)return L(e,E);if(r.status===O&&0===r.wrap&&(r.status=N),r.status===O){let t=C+(r.w_bits-8<<4)<<8,n=-1;if(n=r.strategy>=_||r.level<2?0:r.level<6?1:6===r.level?2:3,t|=n<<6,0!==r.strstart&&(t|=32),t+=31-t%31,H(r,t),0!==r.strstart&&(H(r,e.adler>>>16),H(r,65535&e.adler)),e.adler=1,r.status=N,F(e),0!==r.pending)return r.last_flush=-1,g}if(57===r.status)if(e.adler=0,V(r,31),V(r,139),V(r,8),r.gzhead)V(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),V(r,255&r.gzhead.time),V(r,r.gzhead.time>>8&255),V(r,r.gzhead.time>>16&255),V(r,r.gzhead.time>>24&255),V(r,9===r.level?2:r.strategy>=_||r.level<2?4:0),V(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(V(r,255&r.gzhead.extra.length),V(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=u(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69;else if(V(r,0),V(r,0),V(r,0),V(r,0),V(r,0),V(r,9===r.level?2:r.strategy>=_||r.level<2?4:0),V(r,3),r.status=N,F(e),0!==r.pending)return r.last_flush=-1,g;if(69===r.status){if(r.gzhead.extra){let t=r.pending,n=(65535&r.gzhead.extra.length)-r.gzindex;for(;r.pending+n>r.pending_buf_size;){let i=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+i),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>t&&(e.adler=u(e.adler,r.pending_buf,r.pending-t,t)),r.gzindex+=i,F(e),0!==r.pending)return r.last_flush=-1,g;t=0,n-=i}let i=new Uint8Array(r.gzhead.extra);r.pending_buf.set(i.subarray(r.gzindex,r.gzindex+n),r.pending),r.pending+=n,r.gzhead.hcrc&&r.pending>t&&(e.adler=u(e.adler,r.pending_buf,r.pending-t,t)),r.gzindex=0}r.status=73}if(73===r.status){if(r.gzhead.name){let t,n=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(e.adler=u(e.adler,r.pending_buf,r.pending-n,n)),F(e),0!==r.pending)return r.last_flush=-1,g;n=0}t=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,V(r,t)}while(0!==t);r.gzhead.hcrc&&r.pending>n&&(e.adler=u(e.adler,r.pending_buf,r.pending-n,n)),r.gzindex=0}r.status=91}if(91===r.status){if(r.gzhead.comment){let t,n=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(e.adler=u(e.adler,r.pending_buf,r.pending-n,n)),F(e),0!==r.pending)return r.last_flush=-1,g;n=0}t=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,V(r,t)}while(0!==t);r.gzhead.hcrc&&r.pending>n&&(e.adler=u(e.adler,r.pending_buf,r.pending-n,n))}r.status=103}if(103===r.status){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(F(e),0!==r.pending))return r.last_flush=-1,g;V(r,255&e.adler),V(r,e.adler>>8&255),e.adler=0}if(r.status=N,F(e),0!==r.pending)return r.last_flush=-1,g}if(0!==e.avail_in||0!==r.lookahead||t!==d&&r.status!==P){let n=0===r.level?Z(r,t):r.strategy===_?((e,t)=>{let r;for(;;){if(0===e.lookahead&&($(e),0===e.lookahead)){if(t===d)return 1;break}if(e.match_length=0,r=s(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(j(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===p?(j(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(j(e,!1),0===e.strm.avail_out)?1:2})(r,t):r.strategy===T?((e,t)=>{let r,n,i,o;const a=e.window;for(;;){if(e.lookahead<=R){if($(e),e.lookahead<=R&&t===d)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=e.strstart-1,n=a[i],n===a[++i]&&n===a[++i]&&n===a[++i])){o=e.strstart+R;do{}while(n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&i<o);e.match_length=R-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=s(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=s(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(j(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===p?(j(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(j(e,!1),0===e.strm.avail_out)?1:2})(r,t):J[r.level].func(r,t);if(3!==n&&4!==n||(r.status=P),1===n||3===n)return 0===e.avail_out&&(r.last_flush=-1),g;if(2===n&&(t===h?a(r):t!==m&&(i(r,0,0,!1),t===f&&(M(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),F(e),0===e.avail_out))return r.last_flush=-1,g}return t!==p?g:r.wrap<=0?v:(2===r.wrap?(V(r,255&e.adler),V(r,e.adler>>8&255),V(r,e.adler>>16&255),V(r,e.adler>>24&255),V(r,255&e.total_in),V(r,e.total_in>>8&255),V(r,e.total_in>>16&255),V(r,e.total_in>>24&255)):(H(r,e.adler>>>16),H(r,65535&e.adler)),F(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?g:v)},e.exports.deflateEnd=e=>{if(Q(e))return y;const t=e.state.status;return e.state=null,t===N?L(e,b):g},e.exports.deflateSetDictionary=(e,t)=>{let r=t.length;if(Q(e))return y;const n=e.state,i=n.wrap;if(2===i||1===i&&n.status!==O||n.lookahead)return y;if(1===i&&(e.adler=c(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){0===i&&(M(n.head),n.strstart=0,n.block_start=0,n.insert=0);let e=new Uint8Array(n.w_size);e.set(t.subarray(r-n.w_size,r),0),t=e,r=n.w_size}const o=e.avail_in,s=e.next_in,a=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,$(n);n.lookahead>=3;){let e=n.strstart,t=n.lookahead-2;do{n.ins_h=B(n,n.ins_h,n.window[e+3-1]),n.prev[e&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=e,e++}while(--t);n.strstart=e,n.lookahead=2,$(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=s,e.input=a,e.avail_in=o,n.wrap=i,g},e.exports.deflateInfo="pako deflate (from Nodeca project)"},88210:e=>{"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},31159:e=>{"use strict";const t=16209;e.exports=function(e,r){let n,i,o,s,a,c,u,l,d,h,f,p,m,g,v,y,b,E,w,S,_,T,x,A;const I=e.state;n=e.next_in,x=e.input,i=n+(e.avail_in-5),o=e.next_out,A=e.output,s=o-(r-e.avail_out),a=o+(e.avail_out-257),c=I.dmax,u=I.wsize,l=I.whave,d=I.wnext,h=I.window,f=I.hold,p=I.bits,m=I.lencode,g=I.distcode,v=(1<<I.lenbits)-1,y=(1<<I.distbits)-1;e:do{p<15&&(f+=x[n++]<<p,p+=8,f+=x[n++]<<p,p+=8),b=m[f&v];t:for(;;){if(E=b>>>24,f>>>=E,p-=E,E=b>>>16&255,0===E)A[o++]=65535&b;else{if(!(16&E)){if(0==(64&E)){b=m[(65535&b)+(f&(1<<E)-1)];continue t}if(32&E){I.mode=16191;break e}e.msg="invalid literal/length code",I.mode=t;break e}w=65535&b,E&=15,E&&(p<E&&(f+=x[n++]<<p,p+=8),w+=f&(1<<E)-1,f>>>=E,p-=E),p<15&&(f+=x[n++]<<p,p+=8,f+=x[n++]<<p,p+=8),b=g[f&y];r:for(;;){if(E=b>>>24,f>>>=E,p-=E,E=b>>>16&255,!(16&E)){if(0==(64&E)){b=g[(65535&b)+(f&(1<<E)-1)];continue r}e.msg="invalid distance code",I.mode=t;break e}if(S=65535&b,E&=15,p<E&&(f+=x[n++]<<p,p+=8,p<E&&(f+=x[n++]<<p,p+=8)),S+=f&(1<<E)-1,S>c){e.msg="invalid distance too far back",I.mode=t;break e}if(f>>>=E,p-=E,E=o-s,S>E){if(E=S-E,E>l&&I.sane){e.msg="invalid distance too far back",I.mode=t;break e}if(_=0,T=h,0===d){if(_+=u-E,E<w){w-=E;do{A[o++]=h[_++]}while(--E);_=o-S,T=A}}else if(d<E){if(_+=u+d-E,E-=d,E<w){w-=E;do{A[o++]=h[_++]}while(--E);if(_=0,d<w){E=d,w-=E;do{A[o++]=h[_++]}while(--E);_=o-S,T=A}}}else if(_+=d-E,E<w){w-=E;do{A[o++]=h[_++]}while(--E);_=o-S,T=A}for(;w>2;)A[o++]=T[_++],A[o++]=T[_++],A[o++]=T[_++],w-=3;w&&(A[o++]=T[_++],w>1&&(A[o++]=T[_++]))}else{_=o-S;do{A[o++]=A[_++],A[o++]=A[_++],A[o++]=A[_++],w-=3}while(w>2);w&&(A[o++]=A[_++],w>1&&(A[o++]=A[_++]))}break}}break}}while(n<i&&o<a);w=p>>3,n-=w,p-=w<<3,f&=(1<<p)-1,e.next_in=n,e.next_out=o,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=o<a?a-o+257:257-(o-a),I.hold=f,I.bits=p}},19846:(e,t,r)=>{"use strict";const n=r(50154),i=r(74223),o=r(31159),s=r(68524),{Z_FINISH:a,Z_BLOCK:c,Z_TREES:u,Z_OK:l,Z_STREAM_END:d,Z_NEED_DICT:h,Z_STREAM_ERROR:f,Z_DATA_ERROR:p,Z_MEM_ERROR:m,Z_BUF_ERROR:g,Z_DEFLATED:v}=r(90165),y=16180,b=16190,E=16191,w=16192,S=16194,_=16199,T=16200,x=16206,A=16209,I=16210,C=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function R(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const k=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<y||t.mode>16211?1:0},O=e=>{if(k(e))return f;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=y,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,l},N=e=>{if(k(e))return f;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,O(e)},P=(e,t)=>{let r;if(k(e))return f;const n=e.state;return t<0?(r=0,t=-t):(r=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?f:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,N(e))},L=(e,t)=>{if(!e)return f;const r=new R;e.state=r,r.strm=e,r.window=null,r.mode=y;const n=P(e,t);return n!==l&&(e.state=null),n};let D,M,U=!0;const B=e=>{if(U){D=new Int32Array(512),M=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(1,e.lens,0,288,D,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(2,e.lens,0,32,M,0,e.work,{bits:5}),U=!1}e.lencode=D,e.lenbits=9,e.distcode=M,e.distbits=5},F=(e,t,r,n)=>{let i;const o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(t.subarray(r-o.wsize,r),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>n&&(i=n),o.window.set(t.subarray(r-n,r-n+i),o.wnext),(n-=i)?(o.window.set(t.subarray(r-n,r),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0};e.exports.inflateReset=N,e.exports.inflateReset2=P,e.exports.inflateResetKeep=O,e.exports.inflateInit=e=>L(e,15),e.exports.inflateInit2=L,e.exports.inflate=(e,t)=>{let r,R,O,N,P,L,D,M,U,j,V,H,G,q,$,Z,z,K,W,J,Y,Q,X=0;const ee=new Uint8Array(4);let te,re;const ne=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(k(e)||!e.output||!e.input&&0!==e.avail_in)return f;r=e.state,r.mode===E&&(r.mode=w),P=e.next_out,O=e.output,D=e.avail_out,N=e.next_in,R=e.input,L=e.avail_in,M=r.hold,U=r.bits,j=L,V=D,Q=l;e:for(;;)switch(r.mode){case y:if(0===r.wrap){r.mode=w;break}for(;U<16;){if(0===L)break e;L--,M+=R[N++]<<U,U+=8}if(2&r.wrap&&35615===M){0===r.wbits&&(r.wbits=15),r.check=0,ee[0]=255&M,ee[1]=M>>>8&255,r.check=i(r.check,ee,2,0),M=0,U=0,r.mode=16181;break}if(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&M)<<8)+(M>>8))%31){e.msg="incorrect header check",r.mode=A;break}if((15&M)!==v){e.msg="unknown compression method",r.mode=A;break}if(M>>>=4,U-=4,Y=8+(15&M),0===r.wbits&&(r.wbits=Y),Y>15||Y>r.wbits){e.msg="invalid window size",r.mode=A;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=512&M?16189:E,M=0,U=0;break;case 16181:for(;U<16;){if(0===L)break e;L--,M+=R[N++]<<U,U+=8}if(r.flags=M,(255&r.flags)!==v){e.msg="unknown compression method",r.mode=A;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=A;break}r.head&&(r.head.text=M>>8&1),512&r.flags&&4&r.wrap&&(ee[0]=255&M,ee[1]=M>>>8&255,r.check=i(r.check,ee,2,0)),M=0,U=0,r.mode=16182;case 16182:for(;U<32;){if(0===L)break e;L--,M+=R[N++]<<U,U+=8}r.head&&(r.head.time=M),512&r.flags&&4&r.wrap&&(ee[0]=255&M,ee[1]=M>>>8&255,ee[2]=M>>>16&255,ee[3]=M>>>24&255,r.check=i(r.check,ee,4,0)),M=0,U=0,r.mode=16183;case 16183:for(;U<16;){if(0===L)break e;L--,M+=R[N++]<<U,U+=8}r.head&&(r.head.xflags=255&M,r.head.os=M>>8),512&r.flags&&4&r.wrap&&(ee[0]=255&M,ee[1]=M>>>8&255,r.check=i(r.check,ee,2,0)),M=0,U=0,r.mode=16184;case 16184:if(1024&r.flags){for(;U<16;){if(0===L)break e;L--,M+=R[N++]<<U,U+=8}r.length=M,r.head&&(r.head.extra_len=M),512&r.flags&&4&r.wrap&&(ee[0]=255&M,ee[1]=M>>>8&255,r.check=i(r.check,ee,2,0)),M=0,U=0}else r.head&&(r.head.extra=null);r.mode=16185;case 16185:if(1024&r.flags&&(H=r.length,H>L&&(H=L),H&&(r.head&&(Y=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(R.subarray(N,N+H),Y)),512&r.flags&&4&r.wrap&&(r.check=i(r.check,R,H,N)),L-=H,N+=H,r.length-=H),r.length))break e;r.length=0,r.mode=16186;case 16186:if(2048&r.flags){if(0===L)break e;H=0;do{Y=R[N+H++],r.head&&Y&&r.length<65536&&(r.head.name+=String.fromCharCode(Y))}while(Y&&H<L);if(512&r.flags&&4&r.wrap&&(r.check=i(r.check,R,H,N)),L-=H,N+=H,Y)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=16187;case 16187:if(4096&r.flags){if(0===L)break e;H=0;do{Y=R[N+H++],r.head&&Y&&r.length<65536&&(r.head.comment+=String.fromCharCode(Y))}while(Y&&H<L);if(512&r.flags&&4&r.wrap&&(r.check=i(r.check,R,H,N)),L-=H,N+=H,Y)break e}else r.head&&(r.head.comment=null);r.mode=16188;case 16188:if(512&r.flags){for(;U<16;){if(0===L)break e;L--,M+=R[N++]<<U,U+=8}if(4&r.wrap&&M!==(65535&r.check)){e.msg="header crc mismatch",r.mode=A;break}M=0,U=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=E;break;case 16189:for(;U<32;){if(0===L)break e;L--,M+=R[N++]<<U,U+=8}e.adler=r.check=C(M),M=0,U=0,r.mode=b;case b:if(0===r.havedict)return e.next_out=P,e.avail_out=D,e.next_in=N,e.avail_in=L,r.hold=M,r.bits=U,h;e.adler=r.check=1,r.mode=E;case E:if(t===c||t===u)break e;case w:if(r.last){M>>>=7&U,U-=7&U,r.mode=x;break}for(;U<3;){if(0===L)break e;L--,M+=R[N++]<<U,U+=8}switch(r.last=1&M,M>>>=1,U-=1,3&M){case 0:r.mode=16193;break;case 1:if(B(r),r.mode=_,t===u){M>>>=2,U-=2;break e}break;case 2:r.mode=16196;break;case 3:e.msg="invalid block type",r.mode=A}M>>>=2,U-=2;break;case 16193:for(M>>>=7&U,U-=7&U;U<32;){if(0===L)break e;L--,M+=R[N++]<<U,U+=8}if((65535&M)!=(M>>>16^65535)){e.msg="invalid stored block lengths",r.mode=A;break}if(r.length=65535&M,M=0,U=0,r.mode=S,t===u)break e;case S:r.mode=16195;case 16195:if(H=r.length,H){if(H>L&&(H=L),H>D&&(H=D),0===H)break e;O.set(R.subarray(N,N+H),P),L-=H,N+=H,D-=H,P+=H,r.length-=H;break}r.mode=E;break;case 16196:for(;U<14;){if(0===L)break e;L--,M+=R[N++]<<U,U+=8}if(r.nlen=257+(31&M),M>>>=5,U-=5,r.ndist=1+(31&M),M>>>=5,U-=5,r.ncode=4+(15&M),M>>>=4,U-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=A;break}r.have=0,r.mode=16197;case 16197:for(;r.have<r.ncode;){for(;U<3;){if(0===L)break e;L--,M+=R[N++]<<U,U+=8}r.lens[ne[r.have++]]=7&M,M>>>=3,U-=3}for(;r.have<19;)r.lens[ne[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,te={bits:r.lenbits},Q=s(0,r.lens,0,19,r.lencode,0,r.work,te),r.lenbits=te.bits,Q){e.msg="invalid code lengths set",r.mode=A;break}r.have=0,r.mode=16198;case 16198:for(;r.have<r.nlen+r.ndist;){for(;X=r.lencode[M&(1<<r.lenbits)-1],$=X>>>24,Z=X>>>16&255,z=65535&X,!($<=U);){if(0===L)break e;L--,M+=R[N++]<<U,U+=8}if(z<16)M>>>=$,U-=$,r.lens[r.have++]=z;else{if(16===z){for(re=$+2;U<re;){if(0===L)break e;L--,M+=R[N++]<<U,U+=8}if(M>>>=$,U-=$,0===r.have){e.msg="invalid bit length repeat",r.mode=A;break}Y=r.lens[r.have-1],H=3+(3&M),M>>>=2,U-=2}else if(17===z){for(re=$+3;U<re;){if(0===L)break e;L--,M+=R[N++]<<U,U+=8}M>>>=$,U-=$,Y=0,H=3+(7&M),M>>>=3,U-=3}else{for(re=$+7;U<re;){if(0===L)break e;L--,M+=R[N++]<<U,U+=8}M>>>=$,U-=$,Y=0,H=11+(127&M),M>>>=7,U-=7}if(r.have+H>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=A;break}for(;H--;)r.lens[r.have++]=Y}}if(r.mode===A)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=A;break}if(r.lenbits=9,te={bits:r.lenbits},Q=s(1,r.lens,0,r.nlen,r.lencode,0,r.work,te),r.lenbits=te.bits,Q){e.msg="invalid literal/lengths set",r.mode=A;break}if(r.distbits=6,r.distcode=r.distdyn,te={bits:r.distbits},Q=s(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,te),r.distbits=te.bits,Q){e.msg="invalid distances set",r.mode=A;break}if(r.mode=_,t===u)break e;case _:r.mode=T;case T:if(L>=6&&D>=258){e.next_out=P,e.avail_out=D,e.next_in=N,e.avail_in=L,r.hold=M,r.bits=U,o(e,V),P=e.next_out,O=e.output,D=e.avail_out,N=e.next_in,R=e.input,L=e.avail_in,M=r.hold,U=r.bits,r.mode===E&&(r.back=-1);break}for(r.back=0;X=r.lencode[M&(1<<r.lenbits)-1],$=X>>>24,Z=X>>>16&255,z=65535&X,!($<=U);){if(0===L)break e;L--,M+=R[N++]<<U,U+=8}if(Z&&0==(240&Z)){for(K=$,W=Z,J=z;X=r.lencode[J+((M&(1<<K+W)-1)>>K)],$=X>>>24,Z=X>>>16&255,z=65535&X,!(K+$<=U);){if(0===L)break e;L--,M+=R[N++]<<U,U+=8}M>>>=K,U-=K,r.back+=K}if(M>>>=$,U-=$,r.back+=$,r.length=z,0===Z){r.mode=16205;break}if(32&Z){r.back=-1,r.mode=E;break}if(64&Z){e.msg="invalid literal/length code",r.mode=A;break}r.extra=15&Z,r.mode=16201;case 16201:if(r.extra){for(re=r.extra;U<re;){if(0===L)break e;L--,M+=R[N++]<<U,U+=8}r.length+=M&(1<<r.extra)-1,M>>>=r.extra,U-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=16202;case 16202:for(;X=r.distcode[M&(1<<r.distbits)-1],$=X>>>24,Z=X>>>16&255,z=65535&X,!($<=U);){if(0===L)break e;L--,M+=R[N++]<<U,U+=8}if(0==(240&Z)){for(K=$,W=Z,J=z;X=r.distcode[J+((M&(1<<K+W)-1)>>K)],$=X>>>24,Z=X>>>16&255,z=65535&X,!(K+$<=U);){if(0===L)break e;L--,M+=R[N++]<<U,U+=8}M>>>=K,U-=K,r.back+=K}if(M>>>=$,U-=$,r.back+=$,64&Z){e.msg="invalid distance code",r.mode=A;break}r.offset=z,r.extra=15&Z,r.mode=16203;case 16203:if(r.extra){for(re=r.extra;U<re;){if(0===L)break e;L--,M+=R[N++]<<U,U+=8}r.offset+=M&(1<<r.extra)-1,M>>>=r.extra,U-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=A;break}r.mode=16204;case 16204:if(0===D)break e;if(H=V-D,r.offset>H){if(H=r.offset-H,H>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=A;break}H>r.wnext?(H-=r.wnext,G=r.wsize-H):G=r.wnext-H,H>r.length&&(H=r.length),q=r.window}else q=O,G=P-r.offset,H=r.length;H>D&&(H=D),D-=H,r.length-=H;do{O[P++]=q[G++]}while(--H);0===r.length&&(r.mode=T);break;case 16205:if(0===D)break e;O[P++]=r.length,D--,r.mode=T;break;case x:if(r.wrap){for(;U<32;){if(0===L)break e;L--,M|=R[N++]<<U,U+=8}if(V-=D,e.total_out+=V,r.total+=V,4&r.wrap&&V&&(e.adler=r.check=r.flags?i(r.check,O,V,P-V):n(r.check,O,V,P-V)),V=D,4&r.wrap&&(r.flags?M:C(M))!==r.check){e.msg="incorrect data check",r.mode=A;break}M=0,U=0}r.mode=16207;case 16207:if(r.wrap&&r.flags){for(;U<32;){if(0===L)break e;L--,M+=R[N++]<<U,U+=8}if(4&r.wrap&&M!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=A;break}M=0,U=0}r.mode=16208;case 16208:Q=d;break e;case A:Q=p;break e;case I:return m;default:return f}return e.next_out=P,e.avail_out=D,e.next_in=N,e.avail_in=L,r.hold=M,r.bits=U,(r.wsize||V!==e.avail_out&&r.mode<A&&(r.mode<x||t!==a))&&F(e,e.output,e.next_out,V-e.avail_out)?(r.mode=I,m):(j-=e.avail_in,V-=e.avail_out,e.total_in+=j,e.total_out+=V,r.total+=V,4&r.wrap&&V&&(e.adler=r.check=r.flags?i(r.check,O,V,e.next_out-V):n(r.check,O,V,e.next_out-V)),e.data_type=r.bits+(r.last?64:0)+(r.mode===E?128:0)+(r.mode===_||r.mode===S?256:0),(0===j&&0===V||t===a)&&Q===l&&(Q=g),Q)},e.exports.inflateEnd=e=>{if(k(e))return f;let t=e.state;return t.window&&(t.window=null),e.state=null,l},e.exports.inflateGetHeader=(e,t)=>{if(k(e))return f;const r=e.state;return 0==(2&r.wrap)?f:(r.head=t,t.done=!1,l)},e.exports.inflateSetDictionary=(e,t)=>{const r=t.length;let i,o,s;return k(e)?f:(i=e.state,0!==i.wrap&&i.mode!==b?f:i.mode===b&&(o=1,o=n(o,t,r,0),o!==i.check)?p:(s=F(e,t,r,r),s?(i.mode=I,m):(i.havedict=1,l)))},e.exports.inflateInfo="pako inflate (from Nodeca project)"},68524:e=>{"use strict";const t=15,r=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),n=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),i=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),o=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);e.exports=(e,s,a,c,u,l,d,h)=>{const f=h.bits;let p,m,g,v,y,b,E=0,w=0,S=0,_=0,T=0,x=0,A=0,I=0,C=0,R=0,k=null;const O=new Uint16Array(16),N=new Uint16Array(16);let P,L,D,M=null;for(E=0;E<=t;E++)O[E]=0;for(w=0;w<c;w++)O[s[a+w]]++;for(T=f,_=t;_>=1&&0===O[_];_--);if(T>_&&(T=_),0===_)return u[l++]=20971520,u[l++]=20971520,h.bits=1,0;for(S=1;S<_&&0===O[S];S++);for(T<S&&(T=S),I=1,E=1;E<=t;E++)if(I<<=1,I-=O[E],I<0)return-1;if(I>0&&(0===e||1!==_))return-1;for(N[1]=0,E=1;E<t;E++)N[E+1]=N[E]+O[E];for(w=0;w<c;w++)0!==s[a+w]&&(d[N[s[a+w]]++]=w);if(0===e?(k=M=d,b=20):1===e?(k=r,M=n,b=257):(k=i,M=o,b=0),R=0,w=0,E=S,y=l,x=T,A=0,g=-1,C=1<<T,v=C-1,1===e&&C>852||2===e&&C>592)return 1;for(;;){P=E-A,d[w]+1<b?(L=0,D=d[w]):d[w]>=b?(L=M[d[w]-b],D=k[d[w]-b]):(L=96,D=0),p=1<<E-A,m=1<<x,S=m;do{m-=p,u[y+(R>>A)+m]=P<<24|L<<16|D|0}while(0!==m);for(p=1<<E-1;R&p;)p>>=1;if(0!==p?(R&=p-1,R+=p):R=0,w++,0==--O[E]){if(E===_)break;E=s[a+d[w]]}if(E>T&&(R&v)!==g){for(0===A&&(A=T),y+=S,x=E-A,I=1<<x;x+A<_&&(I-=O[x+A],!(I<=0));)x++,I<<=1;if(C+=1<<x,1===e&&C>852||2===e&&C>592)return 1;g=R&v,u[g]=T<<24|x<<16|y-l|0}}return 0!==R&&(u[y+R]=E-A<<24|64<<16|0),h.bits=T,0}},57686:e=>{"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},45732:e=>{"use strict";function t(e){let t=e.length;for(;--t>=0;)e[t]=0}const r=256,n=286,i=30,o=15,s=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),a=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),c=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),u=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),l=new Array(576);t(l);const d=new Array(60);t(d);const h=new Array(512);t(h);const f=new Array(256);t(f);const p=new Array(29);t(p);const m=new Array(i);function g(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}let v,y,b;function E(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}t(m);const w=e=>e<256?h[e]:h[256+(e>>>7)],S=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},_=(e,t,r)=>{e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,S(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},T=(e,t,r)=>{_(e,r[2*t],r[2*t+1])},x=(e,t)=>{let r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1},A=(e,t,r)=>{const n=new Array(16);let i,s,a=0;for(i=1;i<=o;i++)a=a+r[i-1]<<1,n[i]=a;for(s=0;s<=t;s++){let t=e[2*s+1];0!==t&&(e[2*s]=x(n[t]++,t))}},I=e=>{let t;for(t=0;t<n;t++)e.dyn_ltree[2*t]=0;for(t=0;t<i;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},C=e=>{e.bi_valid>8?S(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},R=(e,t,r,n)=>{const i=2*t,o=2*r;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]},k=(e,t,r)=>{const n=e.heap[r];let i=r<<1;for(;i<=e.heap_len&&(i<e.heap_len&&R(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!R(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n},O=(e,t,n)=>{let i,o,c,u,l=0;if(0!==e.sym_next)do{i=255&e.pending_buf[e.sym_buf+l++],i+=(255&e.pending_buf[e.sym_buf+l++])<<8,o=e.pending_buf[e.sym_buf+l++],0===i?T(e,o,t):(c=f[o],T(e,c+r+1,t),u=s[c],0!==u&&(o-=p[c],_(e,o,u)),i--,c=w(i),T(e,c,n),u=a[c],0!==u&&(i-=m[c],_(e,i,u)))}while(l<e.sym_next);T(e,256,t)},N=(e,t)=>{const r=t.dyn_tree,n=t.stat_desc.static_tree,i=t.stat_desc.has_stree,s=t.stat_desc.elems;let a,c,u,l=-1;for(e.heap_len=0,e.heap_max=573,a=0;a<s;a++)0!==r[2*a]?(e.heap[++e.heap_len]=l=a,e.depth[a]=0):r[2*a+1]=0;for(;e.heap_len<2;)u=e.heap[++e.heap_len]=l<2?++l:0,r[2*u]=1,e.depth[u]=0,e.opt_len--,i&&(e.static_len-=n[2*u+1]);for(t.max_code=l,a=e.heap_len>>1;a>=1;a--)k(e,r,a);u=s;do{a=e.heap[1],e.heap[1]=e.heap[e.heap_len--],k(e,r,1),c=e.heap[1],e.heap[--e.heap_max]=a,e.heap[--e.heap_max]=c,r[2*u]=r[2*a]+r[2*c],e.depth[u]=(e.depth[a]>=e.depth[c]?e.depth[a]:e.depth[c])+1,r[2*a+1]=r[2*c+1]=u,e.heap[1]=u++,k(e,r,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const r=t.dyn_tree,n=t.max_code,i=t.stat_desc.static_tree,s=t.stat_desc.has_stree,a=t.stat_desc.extra_bits,c=t.stat_desc.extra_base,u=t.stat_desc.max_length;let l,d,h,f,p,m,g=0;for(f=0;f<=o;f++)e.bl_count[f]=0;for(r[2*e.heap[e.heap_max]+1]=0,l=e.heap_max+1;l<573;l++)d=e.heap[l],f=r[2*r[2*d+1]+1]+1,f>u&&(f=u,g++),r[2*d+1]=f,d>n||(e.bl_count[f]++,p=0,d>=c&&(p=a[d-c]),m=r[2*d],e.opt_len+=m*(f+p),s&&(e.static_len+=m*(i[2*d+1]+p)));if(0!==g){do{for(f=u-1;0===e.bl_count[f];)f--;e.bl_count[f]--,e.bl_count[f+1]+=2,e.bl_count[u]--,g-=2}while(g>0);for(f=u;0!==f;f--)for(d=e.bl_count[f];0!==d;)h=e.heap[--l],h>n||(r[2*h+1]!==f&&(e.opt_len+=(f-r[2*h+1])*r[2*h],r[2*h+1]=f),d--)}})(e,t),A(r,l,e.bl_count)},P=(e,t,r)=>{let n,i,o=-1,s=t[1],a=0,c=7,u=4;for(0===s&&(c=138,u=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=s,s=t[2*(n+1)+1],++a<c&&i===s||(a<u?e.bl_tree[2*i]+=a:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,o=i,0===s?(c=138,u=3):i===s?(c=6,u=3):(c=7,u=4))},L=(e,t,r)=>{let n,i,o=-1,s=t[1],a=0,c=7,u=4;for(0===s&&(c=138,u=3),n=0;n<=r;n++)if(i=s,s=t[2*(n+1)+1],!(++a<c&&i===s)){if(a<u)do{T(e,i,e.bl_tree)}while(0!=--a);else 0!==i?(i!==o&&(T(e,i,e.bl_tree),a--),T(e,16,e.bl_tree),_(e,a-3,2)):a<=10?(T(e,17,e.bl_tree),_(e,a-3,3)):(T(e,18,e.bl_tree),_(e,a-11,7));a=0,o=i,0===s?(c=138,u=3):i===s?(c=6,u=3):(c=7,u=4)}};let D=!1;const M=(e,t,r,n)=>{_(e,0+(n?1:0),3),C(e),S(e,r),S(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r};e.exports._tr_init=e=>{D||((()=>{let e,t,r,u,E;const w=new Array(16);for(r=0,u=0;u<28;u++)for(p[u]=r,e=0;e<1<<s[u];e++)f[r++]=u;for(f[r-1]=u,E=0,u=0;u<16;u++)for(m[u]=E,e=0;e<1<<a[u];e++)h[E++]=u;for(E>>=7;u<i;u++)for(m[u]=E<<7,e=0;e<1<<a[u]-7;e++)h[256+E++]=u;for(t=0;t<=o;t++)w[t]=0;for(e=0;e<=143;)l[2*e+1]=8,e++,w[8]++;for(;e<=255;)l[2*e+1]=9,e++,w[9]++;for(;e<=279;)l[2*e+1]=7,e++,w[7]++;for(;e<=287;)l[2*e+1]=8,e++,w[8]++;for(A(l,287,w),e=0;e<i;e++)d[2*e+1]=5,d[2*e]=x(e,5);v=new g(l,s,257,n,o),y=new g(d,a,0,i,o),b=new g(new Array(0),c,0,19,7)})(),D=!0),e.l_desc=new E(e.dyn_ltree,v),e.d_desc=new E(e.dyn_dtree,y),e.bl_desc=new E(e.bl_tree,b),e.bi_buf=0,e.bi_valid=0,I(e)},e.exports._tr_stored_block=M,e.exports._tr_flush_block=(e,t,n,i)=>{let o,s,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<r;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),N(e,e.l_desc),N(e,e.d_desc),a=(e=>{let t;for(P(e,e.dyn_ltree,e.l_desc.max_code),P(e,e.dyn_dtree,e.d_desc.max_code),N(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*u[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),o=e.opt_len+3+7>>>3,s=e.static_len+3+7>>>3,s<=o&&(o=s)):o=s=n+5,n+4<=o&&-1!==t?M(e,t,n,i):4===e.strategy||s===o?(_(e,2+(i?1:0),3),O(e,l,d)):(_(e,4+(i?1:0),3),((e,t,r,n)=>{let i;for(_(e,t-257,5),_(e,r-1,5),_(e,n-4,4),i=0;i<n;i++)_(e,e.bl_tree[2*u[i]+1],3);L(e,e.dyn_ltree,t-1),L(e,e.dyn_dtree,r-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),O(e,e.dyn_ltree,e.dyn_dtree)),I(e),i&&C(e)},e.exports._tr_tally=(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(f[n]+r+1)]++,e.dyn_dtree[2*w(t)]++),e.sym_next===e.sym_end),e.exports._tr_align=e=>{_(e,2,3),T(e,256,l),(e=>{16===e.bi_valid?(S(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}},70444:e=>{"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},73537:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NIL",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"v1",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"v3",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"v4",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"v5",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"validate",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return c.default}});var n=h(r(49656)),i=h(r(7482)),o=h(r(6333)),s=h(r(7565)),a=h(r(66260)),c=h(r(27050)),u=h(r(76607)),l=h(r(28042)),d=h(r(91271));function h(e){return e&&e.__esModule?e:{default:e}}},83508:(e,t)=>{"use strict";function r(e){return 14+(e+64>>>9<<4)+1}function n(e,t){const r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function i(e,t,r,i,o,s){return n((a=n(n(t,e),n(i,s)))<<(c=o)|a>>>32-c,r);var a,c}function o(e,t,r,n,o,s,a){return i(t&r|~t&n,e,t,o,s,a)}function s(e,t,r,n,o,s,a){return i(t&n|r&~n,e,t,o,s,a)}function a(e,t,r,n,o,s,a){return i(t^r^n,e,t,o,s,a)}function c(e,t,r,n,o,s,a){return i(r^(t|~n),e,t,o,s,a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=function(e){if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let r=0;r<t.length;++r)e[r]=t.charCodeAt(r)}return function(e){const t=[],r=32*e.length,n="0123456789abcdef";for(let i=0;i<r;i+=8){const r=e[i>>5]>>>i%32&255,o=parseInt(n.charAt(r>>>4&15)+n.charAt(15&r),16);t.push(o)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[r(t)-1]=t;let i=1732584193,u=-271733879,l=-1732584194,d=271733878;for(let t=0;t<e.length;t+=16){const r=i,h=u,f=l,p=d;i=o(i,u,l,d,e[t],7,-680876936),d=o(d,i,u,l,e[t+1],12,-389564586),l=o(l,d,i,u,e[t+2],17,606105819),u=o(u,l,d,i,e[t+3],22,-1044525330),i=o(i,u,l,d,e[t+4],7,-176418897),d=o(d,i,u,l,e[t+5],12,1200080426),l=o(l,d,i,u,e[t+6],17,-1473231341),u=o(u,l,d,i,e[t+7],22,-45705983),i=o(i,u,l,d,e[t+8],7,1770035416),d=o(d,i,u,l,e[t+9],12,-1958414417),l=o(l,d,i,u,e[t+10],17,-42063),u=o(u,l,d,i,e[t+11],22,-1990404162),i=o(i,u,l,d,e[t+12],7,1804603682),d=o(d,i,u,l,e[t+13],12,-40341101),l=o(l,d,i,u,e[t+14],17,-1502002290),u=o(u,l,d,i,e[t+15],22,1236535329),i=s(i,u,l,d,e[t+1],5,-165796510),d=s(d,i,u,l,e[t+6],9,-1069501632),l=s(l,d,i,u,e[t+11],14,643717713),u=s(u,l,d,i,e[t],20,-373897302),i=s(i,u,l,d,e[t+5],5,-701558691),d=s(d,i,u,l,e[t+10],9,38016083),l=s(l,d,i,u,e[t+15],14,-660478335),u=s(u,l,d,i,e[t+4],20,-405537848),i=s(i,u,l,d,e[t+9],5,568446438),d=s(d,i,u,l,e[t+14],9,-1019803690),l=s(l,d,i,u,e[t+3],14,-187363961),u=s(u,l,d,i,e[t+8],20,1163531501),i=s(i,u,l,d,e[t+13],5,-1444681467),d=s(d,i,u,l,e[t+2],9,-51403784),l=s(l,d,i,u,e[t+7],14,1735328473),u=s(u,l,d,i,e[t+12],20,-1926607734),i=a(i,u,l,d,e[t+5],4,-378558),d=a(d,i,u,l,e[t+8],11,-2022574463),l=a(l,d,i,u,e[t+11],16,1839030562),u=a(u,l,d,i,e[t+14],23,-35309556),i=a(i,u,l,d,e[t+1],4,-1530992060),d=a(d,i,u,l,e[t+4],11,1272893353),l=a(l,d,i,u,e[t+7],16,-155497632),u=a(u,l,d,i,e[t+10],23,-1094730640),i=a(i,u,l,d,e[t+13],4,681279174),d=a(d,i,u,l,e[t],11,-358537222),l=a(l,d,i,u,e[t+3],16,-722521979),u=a(u,l,d,i,e[t+6],23,76029189),i=a(i,u,l,d,e[t+9],4,-640364487),d=a(d,i,u,l,e[t+12],11,-421815835),l=a(l,d,i,u,e[t+15],16,530742520),u=a(u,l,d,i,e[t+2],23,-995338651),i=c(i,u,l,d,e[t],6,-198630844),d=c(d,i,u,l,e[t+7],10,1126891415),l=c(l,d,i,u,e[t+14],15,-1416354905),u=c(u,l,d,i,e[t+5],21,-57434055),i=c(i,u,l,d,e[t+12],6,1700485571),d=c(d,i,u,l,e[t+3],10,-1894986606),l=c(l,d,i,u,e[t+10],15,-1051523),u=c(u,l,d,i,e[t+1],21,-2054922799),i=c(i,u,l,d,e[t+8],6,1873313359),d=c(d,i,u,l,e[t+15],10,-30611744),l=c(l,d,i,u,e[t+6],15,-1560198380),u=c(u,l,d,i,e[t+13],21,1309151649),i=c(i,u,l,d,e[t+4],6,-145523070),d=c(d,i,u,l,e[t+11],10,-1120210379),l=c(l,d,i,u,e[t+2],15,718787259),u=c(u,l,d,i,e[t+9],21,-343485551),i=n(i,r),u=n(u,h),l=n(l,f),d=n(d,p)}return[i,u,l,d]}(function(e){if(0===e.length)return[];const t=8*e.length,n=new Uint32Array(r(t));for(let r=0;r<t;r+=8)n[r>>5]|=(255&e[r/8])<<r%32;return n}(e),8*e.length))};t.default=u},45682:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};t.default=r},66260:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="00000000-0000-0000-0000-000000000000"},91271:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(76607))&&n.__esModule?n:{default:n};var o=function(e){if(!(0,i.default)(e))throw TypeError("Invalid UUID");let t;const r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r};t.default=o},84097:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},39945:(e,t)=>{"use strict";let r;Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if(!r&&(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!r))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(n)};const n=new Uint8Array(16)},93824:(e,t)=>{"use strict";function r(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:case 3:return t^r^n;case 2:return t&r^t&n^r&n}}function n(e,t){return e<<t|e>>>32-t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(e){const t=[1518500249,1859775393,2400959708,3395469782],i=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const o=e.length/4+2,s=Math.ceil(o/16),a=new Array(s);for(let t=0;t<s;++t){const r=new Uint32Array(16);for(let n=0;n<16;++n)r[n]=e[64*t+4*n]<<24|e[64*t+4*n+1]<<16|e[64*t+4*n+2]<<8|e[64*t+4*n+3];a[t]=r}a[s-1][14]=8*(e.length-1)/Math.pow(2,32),a[s-1][14]=Math.floor(a[s-1][14]),a[s-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<s;++e){const o=new Uint32Array(80);for(let t=0;t<16;++t)o[t]=a[e][t];for(let e=16;e<80;++e)o[e]=n(o[e-3]^o[e-8]^o[e-14]^o[e-16],1);let s=i[0],c=i[1],u=i[2],l=i[3],d=i[4];for(let e=0;e<80;++e){const i=Math.floor(e/20),a=n(s,5)+r(i,c,u,l)+d+t[i]+o[e]>>>0;d=l,l=u,u=n(c,30)>>>0,c=s,s=a}i[0]=i[0]+s>>>0,i[1]=i[1]+c>>>0,i[2]=i[2]+u>>>0,i[3]=i[3]+l>>>0,i[4]=i[4]+d>>>0}return[i[0]>>24&255,i[0]>>16&255,i[0]>>8&255,255&i[0],i[1]>>24&255,i[1]>>16&255,i[1]>>8&255,255&i[1],i[2]>>24&255,i[2]>>16&255,i[2]>>8&255,255&i[2],i[3]>>24&255,i[3]>>16&255,i[3]>>8&255,255&i[3],i[4]>>24&255,i[4]>>16&255,i[4]>>8&255,255&i[4]]};t.default=i},28042:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.unsafeStringify=s;var n,i=(n=r(76607))&&n.__esModule?n:{default:n};const o=[];for(let e=0;e<256;++e)o.push((e+256).toString(16).slice(1));function s(e,t=0){return o[e[t+0]]+o[e[t+1]]+o[e[t+2]]+o[e[t+3]]+"-"+o[e[t+4]]+o[e[t+5]]+"-"+o[e[t+6]]+o[e[t+7]]+"-"+o[e[t+8]]+o[e[t+9]]+"-"+o[e[t+10]]+o[e[t+11]]+o[e[t+12]]+o[e[t+13]]+o[e[t+14]]+o[e[t+15]]}var a=function(e,t=0){const r=s(e,t);if(!(0,i.default)(r))throw TypeError("Stringified UUID is invalid");return r};t.default=a},49656:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(39945))&&n.__esModule?n:{default:n},o=r(28042);let s,a,c=0,u=0;var l=function(e,t,r){let n=t&&r||0;const l=t||new Array(16);let d=(e=e||{}).node||s,h=void 0!==e.clockseq?e.clockseq:a;if(null==d||null==h){const t=e.random||(e.rng||i.default)();null==d&&(d=s=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==h&&(h=a=16383&(t[6]<<8|t[7]))}let f=void 0!==e.msecs?e.msecs:Date.now(),p=void 0!==e.nsecs?e.nsecs:u+1;const m=f-c+(p-u)/1e4;if(m<0&&void 0===e.clockseq&&(h=h+1&16383),(m<0||f>c)&&void 0===e.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=f,u=p,a=h,f+=122192928e5;const g=(1e4*(268435455&f)+p)%4294967296;l[n++]=g>>>24&255,l[n++]=g>>>16&255,l[n++]=g>>>8&255,l[n++]=255&g;const v=f/4294967296*1e4&268435455;l[n++]=v>>>8&255,l[n++]=255&v,l[n++]=v>>>24&15|16,l[n++]=v>>>16&255,l[n++]=h>>>8|128,l[n++]=255&h;for(let e=0;e<6;++e)l[n+e]=d[e];return t||(0,o.unsafeStringify)(l)};t.default=l},7482:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(r(16007)),i=o(r(83508));function o(e){return e&&e.__esModule?e:{default:e}}var s=(0,n.default)("v3",48,i.default);t.default=s},16007:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=void 0,t.default=function(e,t,r){function n(e,n,s,a){var c;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof n&&(n=(0,o.default)(n)),16!==(null===(c=n)||void 0===c?void 0:c.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+e.length);if(u.set(n),u.set(e,n.length),u=r(u),u[6]=15&u[6]|t,u[8]=63&u[8]|128,s){a=a||0;for(let e=0;e<16;++e)s[a+e]=u[e];return s}return(0,i.unsafeStringify)(u)}try{n.name=e}catch(e){}return n.DNS=s,n.URL=a,n};var n,i=r(28042),o=(n=r(91271))&&n.__esModule?n:{default:n};const s="6ba7b810-9dad-11d1-80b4-00c04fd430c8";t.DNS=s;const a="6ba7b811-9dad-11d1-80b4-00c04fd430c8";t.URL=a},6333:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(r(45682)),i=s(r(39945)),o=r(28042);function s(e){return e&&e.__esModule?e:{default:e}}var a=function(e,t,r){if(n.default.randomUUID&&!t&&!e)return n.default.randomUUID();const s=(e=e||{}).random||(e.rng||i.default)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=s[e];return t}return(0,o.unsafeStringify)(s)};t.default=a},7565:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(r(16007)),i=o(r(93824));function o(e){return e&&e.__esModule?e:{default:e}}var s=(0,n.default)("v5",80,i.default);t.default=s},76607:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(84097))&&n.__esModule?n:{default:n};var o=function(e){return"string"==typeof e&&i.default.test(e)};t.default=o},27050:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(76607))&&n.__esModule?n:{default:n};var o=function(e){if(!(0,i.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)};t.default=o},89224:(e,t,r)=>{"use strict";var n=r(21217),i=r(9851),o={KeyObject:r(53029)};function s(){var e=null,t={},r={};Object.defineProperty(this,"ephemeralKey",{get:function(){return e},set:function(t){e=t?o.KeyObject.fromObject(t):null},enumerable:!0}),Object.defineProperty(this,"clientInfo",{get:function(){return t},set:function(e){t=e||{}},enumerable:!0}),Object.defineProperty(this,"serverInfo",{get:function(){return r},set:function(e){r=e||{}},enumerable:!0}),Object.defineProperty(this,"requestId",{value:function(){return i()}})}s.prototype.createECDHKey=function(){var e=this.clientInfo,t=n.JWK.createKeyStore(),r=t.generate("EC","P-256");return r=r.then((function(t){var r=new Date,n={uri:"-internal/"+t.kid,jwk:t.toJSON(!0),userId:e&&e.credential&&e.credential.userId||"",clientId:e&&e.clientId||"",createDate:r,expirationDate:new Date(r.getTime()+36e5)};return new o.KeyObject(n)}))},s.prototype.deriveEphemeralKey=function(e){var t=this.ephemeralKey;return t&&t.jwk&&"EC"===t.jwk.kty?(e=o.KeyObject.fromObject(e),Promise.all([t.asKey(),e.asKey()]).then((function(e){var t=e[0],r={public:e[1].toObject()},i=t.toObject(!0);return n.JWA.derive("ECDH-HKDF",i,r)})).then((function(t){var r=e.uri,i={uri:r,createDate:e.createDate,expirationDate:e.expirationDate,jwk:{kty:"oct",kid:r,alg:"A256GCM",k:n.util.base64url.encode(t)}};return new o.KeyObject(i)}))):Promise.reject(new Error("invalid local ECDH key"))},e.exports=s},39171:(e,t,r)=>{"use strict";e.exports={KeyObject:r(53029),Context:r(89224),Request:r(81689),Response:r(62657)}},53029:(e,t,r)=>{"use strict";var n=r(44564),i=r(21217);function o(e){e=n(e||{}),["createDate","expirationDate","bindDate"].forEach((function(t){t in e&&e[t]&&(e[t]="string"==typeof e[t]?new Date(Date.parse(e[t])):e[t])})),Object.defineProperty(this,"uri",{get:function(){return e.uri||""},enumerable:!0}),Object.defineProperty(this,"jwk",{get:function(){return e.jwk||void 0},enumerable:!0}),Object.defineProperty(this,"userId",{get:function(){return e.userId||""},enumerable:!0}),Object.defineProperty(this,"clientId",{get:function(){return e.clientId||""},enumerable:!0}),Object.defineProperty(this,"createDate",{get:function(){return e.createDate||void 0},enumerable:!0}),Object.defineProperty(this,"expirationDate",{get:function(){return e.expirationDate||void 0},enumerable:!0}),Object.defineProperty(this,"bindDate",{get:function(){return e.bindDate||void 0},enumerable:!0}),Object.defineProperty(this,"resourceUri",{get:function(){return e.resourceUri||""},enumerable:!0})}o.prototype.asKey=function(){return this.jwk?i.JWK.asKey(this.jwk):Promise.reject(new Error("'jwk' not set"))},o.prototype.toJSON=function(){var e=this,t={};return Object.keys(this).forEach((function(r){var i=e[r];"function"!=typeof i&&void 0!==i&&(i instanceof Date&&(i=i.toISOString()),t[r]=n(i))})),t},o.fromObject=function(e){if(!e)throw new TypeError("representation required");return e instanceof o?e:new o(e)},e.exports=o},81689:(e,t,r)=>{"use strict";var n=r(33543),i=r(21217);function o(e){var t="";e=e&&n(e)||{},Object.defineProperty(this,"wrapped",{get:function(){return t},set:function(e){t=String(e||"")},enumerable:!0}),Object.defineProperty(this,"body",{get:function(){return e},set:function(r){r=r&&n(r)||{},"requestId"in e&&(r.requestId=e.requestId),"uri"in e&&(r.uri=e.uri),"method"in e&&(r.method=e.method),t="",e=r},enumerable:!0}),Object.defineProperty(this,"requestId",{get:function(){return e.requestId||""},set:function(t){t?e.requestId=t:delete e.requestId},enumerable:!0}),Object.defineProperty(this,"uri",{get:function(){return e.uri||""},set:function(t){t?e.uri=t:delete e.uri},enumerable:!0}),Object.defineProperty(this,"method",{get:function(){return e.method||""},set:function(t){t?e.method=t:delete e.method},enumerable:!0})}o.prototype.wrap=function(e,t){t=t||{};var r=this;return this.requestId&&!t.requestId||(this.requestId=t.requestId||e.requestId()),this.body.client=e.clientInfo,(t.serverKey?i.JWK.asKey(e.serverInfo.key):e.ephemeralKey.asKey()).then((function(e){var n=e,o={compact:!0,contentAlg:t.contentAlg||"A256GCM"};return i.JWE.createEncrypt(o,n).final(JSON.stringify(r.body),"utf8")})).then((function(e){return r.wrapped=e,e}))},e.exports=o},62657:(e,t,r)=>{"use strict";var n=r(33543),i=r(21217);function o(e){e=e||"";var t={};Object.defineProperty(this,"wrapped",{get:function(){return e},set:function(r){t={},e=String(r||"")},enumerable:!0}),Object.defineProperty(this,"body",{get:function(){return t},set:function(e){t=e&&n(e)||{}},enumerable:!0}),Object.defineProperty(this,"status",{get:function(){return t.status||0},set:function(e){e=parseInt(e),isNaN(e)||(t.status=e)},enumerable:!0}),Object.defineProperty(this,"reason",{get:function(){return t.reason||""},set:function(e){t.reason=String(e||"")},enumerable:!0}),Object.defineProperty(this,"requestId",{get:function(){return t.requestId||""},set:function(e){t.requestId=String(e||"")},enumerable:!0})}o.prototype.unwrap=function(e,t){t=t||{};var r,n=i.JWK.createKeyStore(),o=[];(r=e.ephemeralKey&&e.ephemeralKey.jwk)&&o.push(n.add(r)),(r=e.serverInfo&&e.serverInfo.key)&&o.push(n.add(r));var s=this,a=Promise.all(o);return a=(a=a.then((function(){var e=s.wrapped;switch((e.match(/\./g)||[]).length){case 2:return i.JWS.createVerify(n).verify(e);case 4:return i.JWE.createDecrypt(n).decrypt(e);default:return Promise.reject(new Error("invalid wrapped"))}}))).then((function(e){return e=(e.plaintext||e.payload).toString("utf8"),e=JSON.parse(e),s.body=e,e}))},e.exports=o},44564:(e,t,r)=>{var n=r(59713),i=r(79773);e.exports=function(e,t,r){return"function"==typeof t?n(e,!0,i(t,r,3)):n(e,!0)}},83117:(e,t,r)=>{var n,i=r.g.crypto||r.g.msCrypto;if(i&&i.getRandomValues){var o=new Uint8Array(16);n=function(){return i.getRandomValues(o),o}}if(!n){var s=new Array(16);n=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),s[t]=e>>>((3&t)<<3)&255;return s}}e.exports=n},9851:(e,t,r)=>{for(var n=r(83117),i=[],o={},s=0;s<256;s++)i[s]=(s+256).toString(16).substr(1),o[i[s]]=s;function a(e,t){var r=t||0,n=i;return n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]}var c=n(),u=[1|c[0],c[1],c[2],c[3],c[4],c[5]],l=16383&(c[6]<<8|c[7]),d=0,h=0;function f(e,t,r){var i=t&&r||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||n)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var s=0;s<16;s++)t[i+s]=o[s];return t||a(o)}var p=f;p.v1=function(e,t,r){var n=t&&r||0,i=t||[],o=void 0!==(e=e||{}).clockseq?e.clockseq:l,s=void 0!==e.msecs?e.msecs:(new Date).getTime(),c=void 0!==e.nsecs?e.nsecs:h+1,f=s-d+(c-h)/1e4;if(f<0&&void 0===e.clockseq&&(o=o+1&16383),(f<0||s>d)&&void 0===e.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");d=s,h=c,l=o;var p=(1e4*(268435455&(s+=122192928e5))+c)%4294967296;i[n++]=p>>>24&255,i[n++]=p>>>16&255,i[n++]=p>>>8&255,i[n++]=255&p;var m=s/4294967296*1e4&268435455;i[n++]=m>>>8&255,i[n++]=255&m,i[n++]=m>>>24&15|16,i[n++]=m>>>16&255,i[n++]=o>>>8|128,i[n++]=255&o;for(var g=e.node||u,v=0;v<6;v++)i[n+v]=g[v];return t||a(i)},p.v4=f,p.parse=function(e,t,r){var n=t&&r||0,i=0;for(t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,(function(e){i<16&&(t[n+i++]=o[e])}));i<16;)t[n+i++]=0;return t},p.unparse=a,e.exports=p},77446:(e,t,r)=>{"use strict";var n=r(33543),i=r(21217);function o(e){e.loc=e.loc||void 0,e.tag=e.tag||void 0,Object.defineProperty(this,"enc",{get:function(){return e.enc},enumerable:!0}),Object.defineProperty(this,"key",{get:function(){return e.key},enumerable:!0}),Object.defineProperty(this,"iv",{get:function(){return e.iv},enumerable:!0}),Object.defineProperty(this,"aad",{get:function(){return e.aad},enumerable:!0}),Object.defineProperty(this,"loc",{get:function(){return e.loc},set:function(t){e.loc=t},enumerable:!0}),Object.defineProperty(this,"tag",{get:function(){return e.tag},enumerable:!0}),Object.defineProperty(this,"toJSON",{value:function(){var t=e.key.get("k",!0),r={};return r.enc=e.enc,r.key=i.util.base64url.encode(t),r.iv=i.util.base64url.encode(e.iv),r.aad=e.aad,e.loc&&(r.loc=e.loc),e.tag&&(r.tag=i.util.base64url.encode(e.tag)),r}}),Object.defineProperty(this,"toJWE",{value:function(t){var r=this;return i.JWK.asKey(t).then((function(t){var n={header:{alg:"dir"},key:t,reference:!1},o={compact:!0,contentAlg:e.enc},s=r.toJSON();return s=JSON.stringify(s),i.JWE.createEncrypt(o,n).final(s,"utf8")}))}}),Object.defineProperty(this,"encrypt",{value:function(t){var r={iv:e.iv,adata:new Buffer(e.aad,"utf8")};return t=i.util.asBuffer(t),e.key.encrypt(e.enc,t,r).then((function(t){var r=t.data;return e.tag=t.tag,r}))}}),Object.defineProperty(this,"decrypt",{value:function(t){var r={iv:e.iv,adata:new Buffer(e.aad,"utf8"),mac:e.tag};return t=i.util.asBuffer(t),e.key.decrypt(e.enc,t,r).then((function(e){return e}))}})}var s={create:function(){var e=i.util.randomBytes(12),t=(new Date).toISOString(),r=i.JWK.createKeyStore().generate("oct",256);return r=r.then((function(r){return new o({enc:"A256GCM",key:r,iv:e,aad:t})}))},fromJWE:function(e,t){return i.JWK.asKey(e).then((function(e){return i.JWE.createDecrypt(e).decrypt(t)})).then((function(e){return e=e.plaintext.toString("utf8"),e=JSON.parse(e),s.fromJSON(e)}))},fromJSON:function(e){var t=n(e);return(e.key?i.JWK.asKey({kty:"oct",k:e.key}):Promise.resolve()).then((function(e){return e&&(t.key=e),"iv"in t&&(t.iv=Buffer.isBuffer(t.iv)?t.iv:i.util.base64url.decode(t.iv)),"tag"in t&&(t.tag=Buffer.isBuffer(t.tag)?t.tag:i.util.base64url.decode(t.tag)),new o(t)}))}};e.exports=s},70631:(e,t,r)=>{var n="function"==typeof Map&&Map.prototype,i=Object.getOwnPropertyDescriptor&&n?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,o=n&&i&&"function"==typeof i.get?i.get:null,s=n&&Map.prototype.forEach,a="function"==typeof Set&&Set.prototype,c=Object.getOwnPropertyDescriptor&&a?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,u=a&&c&&"function"==typeof c.get?c.get:null,l=a&&Set.prototype.forEach,d="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,h="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,f="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,p=Boolean.prototype.valueOf,m=Object.prototype.toString,g=Function.prototype.toString,v=String.prototype.match,y=String.prototype.slice,b=String.prototype.replace,E=String.prototype.toUpperCase,w=String.prototype.toLowerCase,S=RegExp.prototype.test,_=Array.prototype.concat,T=Array.prototype.join,x=Array.prototype.slice,A=Math.floor,I="function"==typeof BigInt?BigInt.prototype.valueOf:null,C=Object.getOwnPropertySymbols,R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,k="function"==typeof Symbol&&"object"==typeof Symbol.iterator,O="function"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===k||"symbol")?Symbol.toStringTag:null,N=Object.prototype.propertyIsEnumerable,P=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function L(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||S.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof e){var n=e<0?-A(-e):A(e);if(n!==e){var i=String(n),o=y.call(t,i.length+1);return b.call(i,r,"$&_")+"."+b.call(b.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return b.call(t,r,"$&_")}var D=r(24654),M=D.custom,U=H(M)?M:null;function B(e,t,r){var n="double"===(r.quoteStyle||t)?'"':"'";return n+e+n}function F(e){return b.call(String(e),/"/g,"&quot;")}function j(e){return!("[object Array]"!==$(e)||O&&"object"==typeof e&&O in e)}function V(e){return!("[object RegExp]"!==$(e)||O&&"object"==typeof e&&O in e)}function H(e){if(k)return e&&"object"==typeof e&&e instanceof Symbol;if("symbol"==typeof e)return!0;if(!e||"object"!=typeof e||!R)return!1;try{return R.call(e),!0}catch(e){}return!1}e.exports=function e(t,n,i,a){var c=n||{};if(q(c,"quoteStyle")&&"single"!==c.quoteStyle&&"double"!==c.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(q(c,"maxStringLength")&&("number"==typeof c.maxStringLength?c.maxStringLength<0&&c.maxStringLength!==1/0:null!==c.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var m=!q(c,"customInspect")||c.customInspect;if("boolean"!=typeof m&&"symbol"!==m)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(q(c,"indent")&&null!==c.indent&&"\t"!==c.indent&&!(parseInt(c.indent,10)===c.indent&&c.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(q(c,"numericSeparator")&&"boolean"!=typeof c.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var E=c.numericSeparator;if(void 0===t)return"undefined";if(null===t)return"null";if("boolean"==typeof t)return t?"true":"false";if("string"==typeof t)return z(t,c);if("number"==typeof t){if(0===t)return 1/0/t>0?"0":"-0";var S=String(t);return E?L(t,S):S}if("bigint"==typeof t){var A=String(t)+"n";return E?L(t,A):A}var C=void 0===c.depth?5:c.depth;if(void 0===i&&(i=0),i>=C&&C>0&&"object"==typeof t)return j(t)?"[Array]":"[Object]";var M=function(e,t){var r;if("\t"===e.indent)r="\t";else{if(!("number"==typeof e.indent&&e.indent>0))return null;r=T.call(Array(e.indent+1)," ")}return{base:r,prev:T.call(Array(t+1),r)}}(c,i);if(void 0===a)a=[];else if(Z(a,t)>=0)return"[Circular]";function G(t,r,n){if(r&&(a=x.call(a)).push(r),n){var o={depth:c.depth};return q(c,"quoteStyle")&&(o.quoteStyle=c.quoteStyle),e(t,o,i+1,a)}return e(t,c,i+1,a)}if("function"==typeof t&&!V(t)){var K=function(e){if(e.name)return e.name;var t=v.call(g.call(e),/^function\s*([\w$]+)/);if(t)return t[1];return null}(t),ee=X(t,G);return"[Function"+(K?": "+K:" (anonymous)")+"]"+(ee.length>0?" { "+T.call(ee,", ")+" }":"")}if(H(t)){var te=k?b.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):R.call(t);return"object"!=typeof t||k?te:W(te)}if(function(e){if(!e||"object"!=typeof e)return!1;if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return"string"==typeof e.nodeName&&"function"==typeof e.getAttribute}(t)){for(var re="<"+w.call(String(t.nodeName)),ne=t.attributes||[],ie=0;ie<ne.length;ie++)re+=" "+ne[ie].name+"="+B(F(ne[ie].value),"double",c);return re+=">",t.childNodes&&t.childNodes.length&&(re+="..."),re+="</"+w.call(String(t.nodeName))+">"}if(j(t)){if(0===t.length)return"[]";var oe=X(t,G);return M&&!function(e){for(var t=0;t<e.length;t++)if(Z(e[t],"\n")>=0)return!1;return!0}(oe)?"["+Q(oe,M)+"]":"[ "+T.call(oe,", ")+" ]"}if(function(e){return!("[object Error]"!==$(e)||O&&"object"==typeof e&&O in e)}(t)){var se=X(t,G);return"cause"in Error.prototype||!("cause"in t)||N.call(t,"cause")?0===se.length?"["+String(t)+"]":"{ ["+String(t)+"] "+T.call(se,", ")+" }":"{ ["+String(t)+"] "+T.call(_.call("[cause]: "+G(t.cause),se),", ")+" }"}if("object"==typeof t&&m){if(U&&"function"==typeof t[U]&&D)return D(t,{depth:C-i});if("symbol"!==m&&"function"==typeof t.inspect)return t.inspect()}if(function(e){if(!o||!e||"object"!=typeof e)return!1;try{o.call(e);try{u.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var ae=[];return s&&s.call(t,(function(e,r){ae.push(G(r,t,!0)+" => "+G(e,t))})),Y("Map",o.call(t),ae,M)}if(function(e){if(!u||!e||"object"!=typeof e)return!1;try{u.call(e);try{o.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var ce=[];return l&&l.call(t,(function(e){ce.push(G(e,t))})),Y("Set",u.call(t),ce,M)}if(function(e){if(!d||!e||"object"!=typeof e)return!1;try{d.call(e,d);try{h.call(e,h)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return J("WeakMap");if(function(e){if(!h||!e||"object"!=typeof e)return!1;try{h.call(e,h);try{d.call(e,d)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return J("WeakSet");if(function(e){if(!f||!e||"object"!=typeof e)return!1;try{return f.call(e),!0}catch(e){}return!1}(t))return J("WeakRef");if(function(e){return!("[object Number]"!==$(e)||O&&"object"==typeof e&&O in e)}(t))return W(G(Number(t)));if(function(e){if(!e||"object"!=typeof e||!I)return!1;try{return I.call(e),!0}catch(e){}return!1}(t))return W(G(I.call(t)));if(function(e){return!("[object Boolean]"!==$(e)||O&&"object"==typeof e&&O in e)}(t))return W(p.call(t));if(function(e){return!("[object String]"!==$(e)||O&&"object"==typeof e&&O in e)}(t))return W(G(String(t)));if("undefined"!=typeof window&&t===window)return"{ [object Window] }";if(t===r.g)return"{ [object globalThis] }";if(!function(e){return!("[object Date]"!==$(e)||O&&"object"==typeof e&&O in e)}(t)&&!V(t)){var ue=X(t,G),le=P?P(t)===Object.prototype:t instanceof Object||t.constructor===Object,de=t instanceof Object?"":"null prototype",he=!le&&O&&Object(t)===t&&O in t?y.call($(t),8,-1):de?"Object":"",fe=(le||"function"!=typeof t.constructor?"":t.constructor.name?t.constructor.name+" ":"")+(he||de?"["+T.call(_.call([],he||[],de||[]),": ")+"] ":"");return 0===ue.length?fe+"{}":M?fe+"{"+Q(ue,M)+"}":fe+"{ "+T.call(ue,", ")+" }"}return String(t)};var G=Object.prototype.hasOwnProperty||function(e){return e in this};function q(e,t){return G.call(e,t)}function $(e){return m.call(e)}function Z(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}function z(e,t){if(e.length>t.maxStringLength){var r=e.length-t.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return z(y.call(e,0,t.maxStringLength),t)+n}return B(b.call(b.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,K),"single",t)}function K(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+E.call(t.toString(16))}function W(e){return"Object("+e+")"}function J(e){return e+" { ? }"}function Y(e,t,r,n){return e+" ("+t+") {"+(n?Q(r,n):T.call(r,", "))+"}"}function Q(e,t){if(0===e.length)return"";var r="\n"+t.prev+t.base;return r+T.call(e,","+r)+"\n"+t.prev}function X(e,t){var r=j(e),n=[];if(r){n.length=e.length;for(var i=0;i<e.length;i++)n[i]=q(e,i)?t(e[i],e):""}var o,s="function"==typeof C?C(e):[];if(k){o={};for(var a=0;a<s.length;a++)o["$"+s[a]]=s[a]}for(var c in e)q(e,c)&&(r&&String(Number(c))===c&&c<e.length||k&&o["$"+c]instanceof Symbol||(S.call(/[^\w$]/,c)?n.push(t(c,e)+": "+t(e[c],e)):n.push(c+": "+t(e[c],e))));if("function"==typeof C)for(var u=0;u<s.length;u++)N.call(e,s[u])&&n.push("["+t(s[u])+"]: "+t(e[s[u]],e));return n}},24753:(e,t,r)=>{e.exports=r(24753)},4947:e=>{var t=function(e){return e.replace(/^\s+|\s+$/g,"")};e.exports=function(e){if(!e)return{};for(var r,n={},i=t(e).split("\n"),o=0;o<i.length;o++){var s=i[o],a=s.indexOf(":"),c=t(s.slice(0,a)).toLowerCase(),u=t(s.slice(a+1));void 0===n[c]?n[c]=u:(r=n[c],"[object Array]"===Object.prototype.toString.call(r)?n[c].push(u):n[c]=[n[c],u])}return n}},28985:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Deferred=void 0;t.Deferred=class{constructor(){this.resolve=()=>null,this.reject=()=>null,this.promise=new Promise(((e,t)=>{this.reject=t,this.resolve=e}))}}},37279:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EndOfStreamError=t.defaultMessages=void 0,t.defaultMessages="End-Of-Stream";class r extends Error{constructor(){super(t.defaultMessages)}}t.EndOfStreamError=r},56654:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamReader=t.EndOfStreamError=void 0;const n=r(37279),i=r(28985);var o=r(37279);Object.defineProperty(t,"EndOfStreamError",{enumerable:!0,get:function(){return o.EndOfStreamError}});t.StreamReader=class{constructor(e){if(this.s=e,this.deferred=null,this.endOfStream=!1,this.peekQueue=[],!e.read||!e.once)throw new Error("Expected an instance of stream.Readable");this.s.once("end",(()=>this.reject(new n.EndOfStreamError))),this.s.once("error",(e=>this.reject(e))),this.s.once("close",(()=>this.reject(new Error("Stream closed"))))}async peek(e,t,r){const n=await this.read(e,t,r);return this.peekQueue.push(e.subarray(t,t+n)),n}async read(e,t,r){if(0===r)return 0;if(0===this.peekQueue.length&&this.endOfStream)throw new n.EndOfStreamError;let i=r,o=0;for(;this.peekQueue.length>0&&i>0;){const r=this.peekQueue.pop();if(!r)throw new Error("peekData should be defined");const n=Math.min(r.length,i);e.set(r.subarray(0,n),t+o),o+=n,i-=n,n<r.length&&this.peekQueue.push(r.subarray(n))}for(;i>0&&!this.endOfStream;){const r=Math.min(i,1048576),n=await this.readFromStream(e,t+o,r);if(o+=n,n<r)break;i-=n}return o}async readFromStream(e,t,r){const n=this.s.read(r);if(n)return e.set(n,t),n.length;{const n={buffer:e,offset:t,length:r,deferred:new i.Deferred};return this.deferred=n.deferred,this.s.once("readable",(()=>{this.readDeferred(n)})),n.deferred.promise}}readDeferred(e){const t=this.s.read(e.length);t?(e.buffer.set(t,e.offset),e.deferred.resolve(t.length),this.deferred=null):this.s.once("readable",(()=>{this.readDeferred(e)}))}reject(e){this.endOfStream=!0,this.deferred&&(this.deferred.reject(e),this.deferred=null)}}},55167:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamReader=t.EndOfStreamError=void 0;var n=r(37279);Object.defineProperty(t,"EndOfStreamError",{enumerable:!0,get:function(){return n.EndOfStreamError}});var i=r(56654);Object.defineProperty(t,"StreamReader",{enumerable:!0,get:function(){return i.StreamReader}})},3814:(e,t,r)=>{e.exports=r(91361)},91361:(e,t,r)=>{var n=r(89539),i=e.exports=r(73984);function o(e,t,r,i){r=r||"";var o=new e(n.format.apply(this,[r].concat(i)));throw Error.captureStackTrace(o,t),o}function s(e,t,r){o(i.IllegalArgumentError,e,t,r)}function a(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array"}return t}function c(e){return function(t,r){var n=a(t);if(n==e)return t;s(arguments.callee,r||'Expected "'+e+'" but got "'+n+'".',Array.prototype.slice.call(arguments,2))}}e.exports.checkArgument=function(e,t){e||s(arguments.callee,t,Array.prototype.slice.call(arguments,2))},e.exports.checkState=function(e,t){e||function(e,t,r){o(i.IllegalStateError,e,t,r)}(arguments.callee,t,Array.prototype.slice.call(arguments,2))},e.exports.checkIsDef=function(e,t){if(void 0!==e)return e;s(arguments.callee,t||"Expected value to be defined but was undefined.",Array.prototype.slice.call(arguments,2))},e.exports.checkIsDefAndNotNull=function(e,t){if(null!=e)return e;s(arguments.callee,t||'Expected value to be defined and not null but got "'+a(e)+'".',Array.prototype.slice.call(arguments,2))},e.exports.checkIsString=c("string"),e.exports.checkIsArray=c("array"),e.exports.checkIsNumber=c("number"),e.exports.checkIsBoolean=c("boolean"),e.exports.checkIsFunction=c("function"),e.exports.checkIsObject=c("object")},73984:(e,t,r)=>{var n=r(89539);function i(e){Error.call(this,e),this.message=e}function o(e){Error.call(this,e),this.message=e}n.inherits(i,Error),i.prototype.name="IllegalArgumentError",n.inherits(o,Error),o.prototype.name="IllegalStateError",e.exports.IllegalStateError=o,e.exports.IllegalArgumentError=i},34155:e=>{var t,r,n=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var a,c=[],u=!1,l=-1;function d(){u&&a&&(u=!1,a.length?c=a.concat(c):l=-1,c.length&&h())}function h(){if(!u){var e=s(d);u=!0;for(var t=c.length;t;){for(a=c,c=[];++l<t;)a&&a[l].run();l=-1,t=c.length}a=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new f(e,t)),1!==c.length||u||s(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},72043:(e,t)=>{"use strict";class r{static isArrayBuffer(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)}static toArrayBuffer(e){return this.isArrayBuffer(e)?e:e.byteLength===e.buffer.byteLength||0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:this.toUint8Array(e.buffer).slice(e.byteOffset,e.byteOffset+e.byteLength).buffer}static toUint8Array(e){return this.toView(e,Uint8Array)}static toView(e,t){if(e.constructor===t)return e;if(this.isArrayBuffer(e))return new t(e);if(this.isArrayBufferView(e))return new t(e.buffer,e.byteOffset,e.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}static isArrayBufferView(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}static isEqual(e,t){const n=r.toUint8Array(e),i=r.toUint8Array(t);if(n.length!==i.byteLength)return!1;for(let e=0;e<n.length;e++)if(n[e]!==i[e])return!1;return!0}static concat(...e){let t;t=!Array.isArray(e[0])||e[1]instanceof Function?Array.isArray(e[0])&&e[1]instanceof Function?e[0]:e[e.length-1]instanceof Function?e.slice(0,e.length-1):e:e[0];let r=0;for(const e of t)r+=e.byteLength;const n=new Uint8Array(r);let i=0;for(const e of t){const t=this.toUint8Array(e);n.set(t,i),i+=t.length}return e[e.length-1]instanceof Function?this.toView(n,e[e.length-1]):n.buffer}}const n="string",i=/^[0-9a-f]+$/i,o=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,s=/^[a-zA-Z0-9-_]+$/;class a{static fromString(e){const t=unescape(encodeURIComponent(e)),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r.buffer}static toString(e){const t=r.toUint8Array(e);let n="";for(let e=0;e<t.length;e++)n+=String.fromCharCode(t[e]);return decodeURIComponent(escape(n))}}class c{static toString(e,t=!1){const n=r.toArrayBuffer(e),i=new DataView(n);let o="";for(let e=0;e<n.byteLength;e+=2){const r=i.getUint16(e,t);o+=String.fromCharCode(r)}return o}static fromString(e,t=!1){const r=new ArrayBuffer(2*e.length),n=new DataView(r);for(let r=0;r<e.length;r++)n.setUint16(2*r,e.charCodeAt(r),t);return r}}class u{static isHex(e){return typeof e===n&&i.test(e)}static isBase64(e){return typeof e===n&&o.test(e)}static isBase64Url(e){return typeof e===n&&s.test(e)}static ToString(e,t="utf8"){const n=r.toUint8Array(e);switch(t.toLowerCase()){case"utf8":return this.ToUtf8String(n);case"binary":return this.ToBinary(n);case"hex":return this.ToHex(n);case"base64":return this.ToBase64(n);case"base64url":return this.ToBase64Url(n);case"utf16le":return c.toString(n,!0);case"utf16":case"utf16be":return c.toString(n);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromString(e,t="utf8"){if(!e)return new ArrayBuffer(0);switch(t.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);case"utf16le":return c.fromString(e,!0);case"utf16":case"utf16be":return c.fromString(e);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToBase64(e){const t=r.toUint8Array(e);if("undefined"!=typeof btoa){const e=this.ToString(t,"binary");return btoa(e)}return Buffer.from(t).toString("base64")}static FromBase64(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!u.isBase64(t))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return"undefined"!=typeof atob?this.FromBinary(atob(t)):new Uint8Array(Buffer.from(t,"base64")).buffer}static FromBase64Url(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!u.isBase64Url(t))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(t.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(e,t=u.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.FromBinary(e);case"utf8":return a.fromString(e);case"utf16":case"utf16be":return c.fromString(e);case"utf16le":case"usc2":return c.fromString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToUtf8String(e,t=u.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.ToBinary(e);case"utf8":return a.toString(e);case"utf16":case"utf16be":return c.toString(e);case"utf16le":case"usc2":return c.toString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromBinary(e){const t=e.length,r=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);return r.buffer}static ToBinary(e){const t=r.toUint8Array(e);let n="";for(let e=0;e<t.length;e++)n+=String.fromCharCode(t[e]);return n}static ToHex(e){const t=r.toUint8Array(e);let n="";const i=t.length;for(let e=0;e<i;e++){const r=t[e];r<16&&(n+="0"),n+=r.toString(16)}return n}static FromHex(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!u.isHex(t))throw new TypeError("Argument 'hexString' is not HEX encoded");t.length%2&&(t=`0${t}`);const r=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2){const n=t.slice(e,e+2);r[e/2]=parseInt(n,16)}return r.buffer}static ToUtf16String(e,t=!1){return c.toString(e,t)}static FromUtf16String(e,t=!1){return c.fromString(e,t)}static Base64Padding(e){const t=4-e.length%4;if(t<4)for(let r=0;r<t;r++)e+="=";return e}static formatString(e){return(null==e?void 0:e.replace(/[\n\r\t ]/g,""))||""}}u.DEFAULT_UTF8_ENCODING="utf8",t.vJ=r,t.ep=u},55798:e=>{"use strict";var t=String.prototype.replace,r=/%20/g,n="RFC1738",i="RFC3986";e.exports={default:i,formatters:{RFC1738:function(e){return t.call(e,r,"+")},RFC3986:function(e){return String(e)}},RFC1738:n,RFC3986:i}},80129:(e,t,r)=>{"use strict";var n=r(58261),i=r(55235),o=r(55798);e.exports={formats:o,parse:i,stringify:n}},55235:(e,t,r)=>{"use strict";var n=r(12769),i=Object.prototype.hasOwnProperty,o=Array.isArray,s={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:n.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},a=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},c=function(e,t){return e&&"string"==typeof e&&t.comma&&e.indexOf(",")>-1?e.split(","):e},u=function(e,t,r,n){if(e){var o=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,s=/(\[[^[\]]*])/g,a=r.depth>0&&/(\[[^[\]]*])/.exec(o),u=a?o.slice(0,a.index):o,l=[];if(u){if(!r.plainObjects&&i.call(Object.prototype,u)&&!r.allowPrototypes)return;l.push(u)}for(var d=0;r.depth>0&&null!==(a=s.exec(o))&&d<r.depth;){if(d+=1,!r.plainObjects&&i.call(Object.prototype,a[1].slice(1,-1))&&!r.allowPrototypes)return;l.push(a[1])}return a&&l.push("["+o.slice(a.index)+"]"),function(e,t,r,n){for(var i=n?t:c(t,r),o=e.length-1;o>=0;--o){var s,a=e[o];if("[]"===a&&r.parseArrays)s=[].concat(i);else{s=r.plainObjects?Object.create(null):{};var u="["===a.charAt(0)&&"]"===a.charAt(a.length-1)?a.slice(1,-1):a,l=parseInt(u,10);r.parseArrays||""!==u?!isNaN(l)&&a!==u&&String(l)===u&&l>=0&&r.parseArrays&&l<=r.arrayLimit?(s=[])[l]=i:"__proto__"!==u&&(s[u]=i):s={0:i}}i=s}return i}(l,t,r,n)}};e.exports=function(e,t){var r=function(e){if(!e)return s;if(null!==e.decoder&&void 0!==e.decoder&&"function"!=typeof e.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=void 0===e.charset?s.charset:e.charset;return{allowDots:void 0===e.allowDots?s.allowDots:!!e.allowDots,allowPrototypes:"boolean"==typeof e.allowPrototypes?e.allowPrototypes:s.allowPrototypes,allowSparse:"boolean"==typeof e.allowSparse?e.allowSparse:s.allowSparse,arrayLimit:"number"==typeof e.arrayLimit?e.arrayLimit:s.arrayLimit,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:s.charsetSentinel,comma:"boolean"==typeof e.comma?e.comma:s.comma,decoder:"function"==typeof e.decoder?e.decoder:s.decoder,delimiter:"string"==typeof e.delimiter||n.isRegExp(e.delimiter)?e.delimiter:s.delimiter,depth:"number"==typeof e.depth||!1===e.depth?+e.depth:s.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof e.interpretNumericEntities?e.interpretNumericEntities:s.interpretNumericEntities,parameterLimit:"number"==typeof e.parameterLimit?e.parameterLimit:s.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"==typeof e.plainObjects?e.plainObjects:s.plainObjects,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:s.strictNullHandling}}(t);if(""===e||null==e)return r.plainObjects?Object.create(null):{};for(var l="string"==typeof e?function(e,t){var r,u={__proto__:null},l=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,d=t.parameterLimit===1/0?void 0:t.parameterLimit,h=l.split(t.delimiter,d),f=-1,p=t.charset;if(t.charsetSentinel)for(r=0;r<h.length;++r)0===h[r].indexOf("utf8=")&&("utf8=%E2%9C%93"===h[r]?p="utf-8":"utf8=%26%2310003%3B"===h[r]&&(p="iso-8859-1"),f=r,r=h.length);for(r=0;r<h.length;++r)if(r!==f){var m,g,v=h[r],y=v.indexOf("]="),b=-1===y?v.indexOf("="):y+1;-1===b?(m=t.decoder(v,s.decoder,p,"key"),g=t.strictNullHandling?null:""):(m=t.decoder(v.slice(0,b),s.decoder,p,"key"),g=n.maybeMap(c(v.slice(b+1),t),(function(e){return t.decoder(e,s.decoder,p,"value")}))),g&&t.interpretNumericEntities&&"iso-8859-1"===p&&(g=a(g)),v.indexOf("[]=")>-1&&(g=o(g)?[g]:g),i.call(u,m)?u[m]=n.combine(u[m],g):u[m]=g}return u}(e,r):e,d=r.plainObjects?Object.create(null):{},h=Object.keys(l),f=0;f<h.length;++f){var p=h[f],m=u(p,l[p],r,"string"==typeof e);d=n.merge(d,m,r)}return!0===r.allowSparse?d:n.compact(d)}},58261:(e,t,r)=>{"use strict";var n=r(37478),i=r(12769),o=r(55798),s=Object.prototype.hasOwnProperty,a={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},c=Array.isArray,u=Array.prototype.push,l=function(e,t){u.apply(e,c(t)?t:[t])},d=Date.prototype.toISOString,h=o.default,f={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:i.encode,encodeValuesOnly:!1,format:h,formatter:o.formatters[h],indices:!1,serializeDate:function(e){return d.call(e)},skipNulls:!1,strictNullHandling:!1},p={},m=function e(t,r,o,s,a,u,d,h,m,g,v,y,b,E,w,S){for(var _,T=t,x=S,A=0,I=!1;void 0!==(x=x.get(p))&&!I;){var C=x.get(t);if(A+=1,void 0!==C){if(C===A)throw new RangeError("Cyclic object value");I=!0}void 0===x.get(p)&&(A=0)}if("function"==typeof h?T=h(r,T):T instanceof Date?T=v(T):"comma"===o&&c(T)&&(T=i.maybeMap(T,(function(e){return e instanceof Date?v(e):e}))),null===T){if(a)return d&&!E?d(r,f.encoder,w,"key",y):r;T=""}if("string"==typeof(_=T)||"number"==typeof _||"boolean"==typeof _||"symbol"==typeof _||"bigint"==typeof _||i.isBuffer(T))return d?[b(E?r:d(r,f.encoder,w,"key",y))+"="+b(d(T,f.encoder,w,"value",y))]:[b(r)+"="+b(String(T))];var R,k=[];if(void 0===T)return k;if("comma"===o&&c(T))E&&d&&(T=i.maybeMap(T,d)),R=[{value:T.length>0?T.join(",")||null:void 0}];else if(c(h))R=h;else{var O=Object.keys(T);R=m?O.sort(m):O}for(var N=s&&c(T)&&1===T.length?r+"[]":r,P=0;P<R.length;++P){var L=R[P],D="object"==typeof L&&void 0!==L.value?L.value:T[L];if(!u||null!==D){var M=c(T)?"function"==typeof o?o(N,L):N:N+(g?"."+L:"["+L+"]");S.set(t,A);var U=n();U.set(p,S),l(k,e(D,M,o,s,a,u,"comma"===o&&E&&c(T)?null:d,h,m,g,v,y,b,E,w,U))}}return k};e.exports=function(e,t){var r,i=e,u=function(e){if(!e)return f;if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||f.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=o.default;if(void 0!==e.format){if(!s.call(o.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var n=o.formatters[r],i=f.filter;return("function"==typeof e.filter||c(e.filter))&&(i=e.filter),{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:f.addQueryPrefix,allowDots:void 0===e.allowDots?f.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:f.charsetSentinel,delimiter:void 0===e.delimiter?f.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:f.encode,encoder:"function"==typeof e.encoder?e.encoder:f.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:f.encodeValuesOnly,filter:i,format:r,formatter:n,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:f.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:f.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:f.strictNullHandling}}(t);"function"==typeof u.filter?i=(0,u.filter)("",i):c(u.filter)&&(r=u.filter);var d,h=[];if("object"!=typeof i||null===i)return"";d=t&&t.arrayFormat in a?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices";var p=a[d];if(t&&"commaRoundTrip"in t&&"boolean"!=typeof t.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var g="comma"===p&&t&&t.commaRoundTrip;r||(r=Object.keys(i)),u.sort&&r.sort(u.sort);for(var v=n(),y=0;y<r.length;++y){var b=r[y];u.skipNulls&&null===i[b]||l(h,m(i[b],b,p,g,u.strictNullHandling,u.skipNulls,u.encode?u.encoder:null,u.filter,u.sort,u.allowDots,u.serializeDate,u.format,u.formatter,u.encodeValuesOnly,u.charset,v))}var E=h.join(u.delimiter),w=!0===u.addQueryPrefix?"?":"";return u.charsetSentinel&&("iso-8859-1"===u.charset?w+="utf8=%26%2310003%3B&":w+="utf8=%E2%9C%93&"),E.length>0?w+E:""}},12769:(e,t,r)=>{"use strict";var n=r(55798),i=Object.prototype.hasOwnProperty,o=Array.isArray,s=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),a=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)void 0!==e[n]&&(r[n]=e[n]);return r};e.exports={arrayToObject:a,assign:function(e,t){return Object.keys(t).reduce((function(e,r){return e[r]=t[r],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],n=0;n<t.length;++n)for(var i=t[n],s=i.obj[i.prop],a=Object.keys(s),c=0;c<a.length;++c){var u=a[c],l=s[u];"object"==typeof l&&null!==l&&-1===r.indexOf(l)&&(t.push({obj:s,prop:u}),r.push(l))}return function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(o(r)){for(var n=[],i=0;i<r.length;++i)void 0!==r[i]&&n.push(r[i]);t.obj[t.prop]=n}}}(t),e},decode:function(e,t,r){var n=e.replace(/\+/g," ");if("iso-8859-1"===r)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(e){return n}},encode:function(e,t,r,i,o){if(0===e.length)return e;var a=e;if("symbol"==typeof e?a=Symbol.prototype.toString.call(e):"string"!=typeof e&&(a=String(e)),"iso-8859-1"===r)return escape(a).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var c="",u=0;u<a.length;++u){var l=a.charCodeAt(u);45===l||46===l||95===l||126===l||l>=48&&l<=57||l>=65&&l<=90||l>=97&&l<=122||o===n.RFC1738&&(40===l||41===l)?c+=a.charAt(u):l<128?c+=s[l]:l<2048?c+=s[192|l>>6]+s[128|63&l]:l<55296||l>=57344?c+=s[224|l>>12]+s[128|l>>6&63]+s[128|63&l]:(u+=1,l=65536+((1023&l)<<10|1023&a.charCodeAt(u)),c+=s[240|l>>18]+s[128|l>>12&63]+s[128|l>>6&63]+s[128|63&l])}return c},isBuffer:function(e){return!(!e||"object"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(o(e)){for(var r=[],n=0;n<e.length;n+=1)r.push(t(e[n]));return r}return t(e)},merge:function e(t,r,n){if(!r)return t;if("object"!=typeof r){if(o(t))t.push(r);else{if(!t||"object"!=typeof t)return[t,r];(n&&(n.plainObjects||n.allowPrototypes)||!i.call(Object.prototype,r))&&(t[r]=!0)}return t}if(!t||"object"!=typeof t)return[t].concat(r);var s=t;return o(t)&&!o(r)&&(s=a(t,n)),o(t)&&o(r)?(r.forEach((function(r,o){if(i.call(t,o)){var s=t[o];s&&"object"==typeof s&&r&&"object"==typeof r?t[o]=e(s,r,n):t.push(r)}else t[o]=r})),t):Object.keys(r).reduce((function(t,o){var s=r[o];return i.call(t,o)?t[o]=e(t[o],s,n):t[o]=s,t}),s)}}},29335:e=>{"use strict";function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,n,i,o){n=n||"&",i=i||"=";var s={};if("string"!=typeof e||0===e.length)return s;var a=/\+/g;e=e.split(n);var c=1e3;o&&"number"==typeof o.maxKeys&&(c=o.maxKeys);var u=e.length;c>0&&u>c&&(u=c);for(var l=0;l<u;++l){var d,h,f,p,m=e[l].replace(a,"%20"),g=m.indexOf(i);g>=0?(d=m.substr(0,g),h=m.substr(g+1)):(d=m,h=""),f=decodeURIComponent(d),p=decodeURIComponent(h),t(s,f)?r(s[f])?s[f].push(p):s[f]=[s[f],p]:s[f]=p}return s};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},68795:e=>{"use strict";var t=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,o,s,a){return o=o||"&",s=s||"=",null===e&&(e=void 0),"object"==typeof e?n(i(e),(function(i){var a=encodeURIComponent(t(i))+s;return r(e[i])?n(e[i],(function(e){return a+encodeURIComponent(t(e))})).join(o):a+encodeURIComponent(t(e[i]))})).join(o):a?encodeURIComponent(t(a))+s+encodeURIComponent(t(e)):""};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function n(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var i=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}},87735:(e,t,r)=>{"use strict";t.decode=t.parse=r(29335),t.encode=t.stringify=r(68795)},94281:e=>{"use strict";var t={};function r(e,r,n){n||(n=Error);var i=function(e){var t,n;function i(t,n,i){return e.call(this,function(e,t,n){return"string"==typeof r?r:r(e,t,n)}(t,n,i))||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(n);i.prototype.name=n.name,i.prototype.code=e,t[e]=i}function n(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return String(e)})),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}r("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),r("ERR_INVALID_ARG_TYPE",(function(e,t,r){var i,o,s,a;if("string"==typeof t&&(o="not ",t.substr(!s||s<0?0:+s,o.length)===o)?(i="must not be",t=t.replace(/^not /,"")):i="must be",function(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}(e," argument"))a="The ".concat(e," ").concat(i," ").concat(n(t,"type"));else{var c=function(e,t,r){return"number"!=typeof r&&(r=0),!(r+t.length>e.length)&&-1!==e.indexOf(t,r)}(e,".")?"property":"argument";a='The "'.concat(e,'" ').concat(c," ").concat(i," ").concat(n(t,"type"))}return a+=". Received type ".concat(typeof r)}),TypeError),r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),r("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),r("ERR_STREAM_PREMATURE_CLOSE","Premature close"),r("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),r("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),r("ERR_STREAM_WRITE_AFTER_END","write after end"),r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),r("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.q=t},56753:(e,t,r)=>{"use strict";var n=r(34155),i=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=l;var o=r(79481),s=r(64229);r(35717)(l,o);for(var a=i(s.prototype),c=0;c<a.length;c++){var u=a[c];l.prototype[u]||(l.prototype[u]=s.prototype[u])}function l(e){if(!(this instanceof l))return new l(e);o.call(this,e),s.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",d)))}function d(){this._writableState.ended||n.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})},82725:(e,t,r)=>{"use strict";e.exports=i;var n=r(74605);function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}r(35717)(i,n),i.prototype._transform=function(e,t,r){r(null,e)}},79481:(e,t,r)=>{"use strict";var n,i=r(34155);e.exports=x,x.ReadableState=T;r(17187).EventEmitter;var o=function(e,t){return e.listeners(t).length},s=r(22503),a=r(48764).Buffer,c=(void 0!==r.g?r.g:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var u,l=r(94616);u=l&&l.debuglog?l.debuglog("stream"):function(){};var d,h,f,p=r(57327),m=r(61195),g=r(82457).getHighWaterMark,v=r(94281).q,y=v.ERR_INVALID_ARG_TYPE,b=v.ERR_STREAM_PUSH_AFTER_EOF,E=v.ERR_METHOD_NOT_IMPLEMENTED,w=v.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r(35717)(x,s);var S=m.errorOrDestroy,_=["error","close","destroy","pause","resume"];function T(e,t,i){n=n||r(56753),e=e||{},"boolean"!=typeof i&&(i=t instanceof n),this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=g(this,e,"readableHighWaterMark",i),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(d||(d=r(32553).s),this.decoder=new d(e.encoding),this.encoding=e.encoding)}function x(e){if(n=n||r(56753),!(this instanceof x))return new x(e);var t=this instanceof n;this._readableState=new T(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),s.call(this)}function A(e,t,r,n,i){u("readableAddChunk",t);var o,s=e._readableState;if(null===t)s.reading=!1,function(e,t){if(u("onEofChunk"),t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?k(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,O(e)))}(e,s);else if(i||(o=function(e,t){var r;n=t,a.isBuffer(n)||n instanceof c||"string"==typeof t||void 0===t||e.objectMode||(r=new y("chunk",["string","Buffer","Uint8Array"],t));var n;return r}(s,t)),o)S(e,o);else if(s.objectMode||t&&t.length>0)if("string"==typeof t||s.objectMode||Object.getPrototypeOf(t)===a.prototype||(t=function(e){return a.from(e)}(t)),n)s.endEmitted?S(e,new w):I(e,s,t,!0);else if(s.ended)S(e,new b);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!r?(t=s.decoder.write(t),s.objectMode||0!==t.length?I(e,s,t,!1):N(e,s)):I(e,s,t,!1)}else n||(s.reading=!1,N(e,s));return!s.ended&&(s.length<s.highWaterMark||0===s.length)}function I(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&k(e)),N(e,t)}Object.defineProperty(x.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),x.prototype.destroy=m.destroy,x.prototype._undestroy=m.undestroy,x.prototype._destroy=function(e,t){t(e)},x.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=a.from(e,t),t=""),r=!0),A(this,e,t,!1,r)},x.prototype.unshift=function(e){return A(this,e,null,!0,!1)},x.prototype.isPaused=function(){return!1===this._readableState.flowing},x.prototype.setEncoding=function(e){d||(d=r(32553).s);var t=new d(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,i="";null!==n;)i+=t.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var C=1073741824;function R(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=C?e=C:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function k(e){var t=e._readableState;u("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(u("emitReadable",t.flowing),t.emittedReadable=!0,i.nextTick(O,e))}function O(e){var t=e._readableState;u("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,U(e)}function N(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(P,e,t))}function P(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(u("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function L(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function D(e){u("readable nexttick read 0"),e.read(0)}function M(e,t){u("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),U(e),t.flowing&&!t.reading&&e.read(0)}function U(e){var t=e._readableState;for(u("flow",t.flowing);t.flowing&&null!==e.read(););}function B(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function F(e){var t=e._readableState;u("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,i.nextTick(j,t,e))}function j(e,t){if(u("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function V(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}x.prototype.read=function(e){u("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return u("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?F(this):k(this),null;if(0===(e=R(e,t))&&t.ended)return 0===t.length&&F(this),null;var n,i=t.needReadable;return u("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&u("length less than watermark",i=!0),t.ended||t.reading?u("reading or ended",i=!1):i&&(u("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=R(r,t))),null===(n=e>0?B(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&F(this)),null!==n&&this.emit("data",n),n},x.prototype._read=function(e){S(this,new E("_read()"))},x.prototype.pipe=function(e,t){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e)}n.pipesCount+=1,u("pipe count=%d opts=%j",n.pipesCount,t);var s=(!t||!1!==t.end)&&e!==i.stdout&&e!==i.stderr?c:g;function a(t,i){u("onunpipe"),t===r&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,u("cleanup"),e.removeListener("close",p),e.removeListener("finish",m),e.removeListener("drain",l),e.removeListener("error",f),e.removeListener("unpipe",a),r.removeListener("end",c),r.removeListener("end",g),r.removeListener("data",h),d=!0,!n.awaitDrain||e._writableState&&!e._writableState.needDrain||l())}function c(){u("onend"),e.end()}n.endEmitted?i.nextTick(s):r.once("end",s),e.on("unpipe",a);var l=function(e){return function(){var t=e._readableState;u("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&o(e,"data")&&(t.flowing=!0,U(e))}}(r);e.on("drain",l);var d=!1;function h(t){u("ondata");var i=e.write(t);u("dest.write",i),!1===i&&((1===n.pipesCount&&n.pipes===e||n.pipesCount>1&&-1!==V(n.pipes,e))&&!d&&(u("false write response, pause",n.awaitDrain),n.awaitDrain++),r.pause())}function f(t){u("onerror",t),g(),e.removeListener("error",f),0===o(e,"error")&&S(e,t)}function p(){e.removeListener("finish",m),g()}function m(){u("onfinish"),e.removeListener("close",p),g()}function g(){u("unpipe"),r.unpipe(e)}return r.on("data",h),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",f),e.once("close",p),e.once("finish",m),e.emit("pipe",r),n.flowing||(u("pipe resume"),r.resume()),e},x.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)n[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=V(t.pipes,e);return-1===s||(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},x.prototype.on=function(e,t){var r=s.prototype.on.call(this,e,t),n=this._readableState;return"data"===e?(n.readableListening=this.listenerCount("readable")>0,!1!==n.flowing&&this.resume()):"readable"===e&&(n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,u("on readable",n.length,n.reading),n.length?k(this):n.reading||i.nextTick(D,this))),r},x.prototype.addListener=x.prototype.on,x.prototype.removeListener=function(e,t){var r=s.prototype.removeListener.call(this,e,t);return"readable"===e&&i.nextTick(L,this),r},x.prototype.removeAllListeners=function(e){var t=s.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||i.nextTick(L,this),t},x.prototype.resume=function(){var e=this._readableState;return e.flowing||(u("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(M,e,t))}(this,e)),e.paused=!1,this},x.prototype.pause=function(){return u("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(u("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},x.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(u("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(u("wrapped data"),r.decoder&&(i=r.decoder.write(i)),r.objectMode&&null==i)||(r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<_.length;o++)e.on(_[o],this.emit.bind(this,_[o]));return this._read=function(t){u("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"==typeof Symbol&&(x.prototype[Symbol.asyncIterator]=function(){return void 0===h&&(h=r(45850)),h(this)}),Object.defineProperty(x.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(x.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(x.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),x._fromList=B,Object.defineProperty(x.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(x.from=function(e,t){return void 0===f&&(f=r(15167)),f(x,e,t)})},74605:(e,t,r)=>{"use strict";e.exports=l;var n=r(94281).q,i=n.ERR_METHOD_NOT_IMPLEMENTED,o=n.ERR_MULTIPLE_CALLBACK,s=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=n.ERR_TRANSFORM_WITH_LENGTH_0,c=r(56753);function u(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new o);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function l(e){if(!(this instanceof l))return new l(e);c.call(this,e),this._transformState={afterTransform:u.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",d)}function d(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?h(this,null,null):this._flush((function(t,r){h(e,t,r)}))}function h(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new a;if(e._transformState.transforming)throw new s;return e.push(null)}r(35717)(l,c),l.prototype.push=function(e,t){return this._transformState.needTransform=!1,c.prototype.push.call(this,e,t)},l.prototype._transform=function(e,t,r){r(new i("_transform()"))},l.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},l.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},l.prototype._destroy=function(e,t){c.prototype._destroy.call(this,e,(function(e){t(e)}))}},64229:(e,t,r)=>{"use strict";var n,i=r(34155);function o(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}e.exports=x,x.WritableState=T;var s={deprecate:r(94927)},a=r(22503),c=r(48764).Buffer,u=(void 0!==r.g?r.g:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var l,d=r(61195),h=r(82457).getHighWaterMark,f=r(94281).q,p=f.ERR_INVALID_ARG_TYPE,m=f.ERR_METHOD_NOT_IMPLEMENTED,g=f.ERR_MULTIPLE_CALLBACK,v=f.ERR_STREAM_CANNOT_PIPE,y=f.ERR_STREAM_DESTROYED,b=f.ERR_STREAM_NULL_VALUES,E=f.ERR_STREAM_WRITE_AFTER_END,w=f.ERR_UNKNOWN_ENCODING,S=d.errorOrDestroy;function _(){}function T(e,t,s){n=n||r(56753),e=e||{},"boolean"!=typeof s&&(s=t instanceof n),this.objectMode=!!e.objectMode,s&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=h(this,e,"writableHighWaterMark",s),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===e.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,o=r.writecb;if("function"!=typeof o)throw new g;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,n,o){--t.pendingcb,r?(i.nextTick(o,n),i.nextTick(O,e,t),e._writableState.errorEmitted=!0,S(e,n)):(o(n),e._writableState.errorEmitted=!0,S(e,n),O(e,t))}(e,r,n,t,o);else{var s=R(r)||e.destroyed;s||r.corked||r.bufferProcessing||!r.bufferedRequest||C(e,r),n?i.nextTick(I,e,r,s,o):I(e,r,s,o)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function x(e){var t=this instanceof(n=n||r(56753));if(!t&&!l.call(x,this))return new x(e);this._writableState=new T(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),a.call(this)}function A(e,t,r,n,i,o,s){t.writelen=n,t.writecb=s,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new y("write")):r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function I(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),O(e,t)}function C(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,i=new Array(n),s=t.corkedRequestsFree;s.entry=r;for(var a=0,c=!0;r;)i[a]=r,r.isBuf||(c=!1),r=r.next,a+=1;i.allBuffers=c,A(e,t,!0,t.length,i,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new o(t),t.bufferedRequestCount=0}else{for(;r;){var u=r.chunk,l=r.encoding,d=r.callback;if(A(e,t,!1,t.objectMode?1:u.length,u,l,d),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function R(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function k(e,t){e._final((function(r){t.pendingcb--,r&&S(e,r),t.prefinished=!0,e.emit("prefinish"),O(e,t)}))}function O(e,t){var r=R(t);if(r&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,i.nextTick(k,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var n=e._readableState;(!n||n.autoDestroy&&n.endEmitted)&&e.destroy()}return r}r(35717)(x,a),T.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(T.prototype,"buffer",{get:s.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(l=Function.prototype[Symbol.hasInstance],Object.defineProperty(x,Symbol.hasInstance,{value:function(e){return!!l.call(this,e)||this===x&&(e&&e._writableState instanceof T)}})):l=function(e){return e instanceof this},x.prototype.pipe=function(){S(this,new v)},x.prototype.write=function(e,t,r){var n,o=this._writableState,s=!1,a=!o.objectMode&&(n=e,c.isBuffer(n)||n instanceof u);return a&&!c.isBuffer(e)&&(e=function(e){return c.from(e)}(e)),"function"==typeof t&&(r=t,t=null),a?t="buffer":t||(t=o.defaultEncoding),"function"!=typeof r&&(r=_),o.ending?function(e,t){var r=new E;S(e,r),i.nextTick(t,r)}(this,r):(a||function(e,t,r,n){var o;return null===r?o=new b:"string"==typeof r||t.objectMode||(o=new p("chunk",["string","Buffer"],r)),!o||(S(e,o),i.nextTick(n,o),!1)}(this,o,e,r))&&(o.pendingcb++,s=function(e,t,r,n,i,o){if(!r){var s=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=c.from(t,r));return t}(t,n,i);n!==s&&(r=!0,i="buffer",n=s)}var a=t.objectMode?1:n.length;t.length+=a;var u=t.length<t.highWaterMark;u||(t.needDrain=!0);if(t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:o,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else A(e,t,!1,a,n,i,o);return u}(this,o,a,e,t,r)),s},x.prototype.cork=function(){this._writableState.corked++},x.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||C(this,e))},x.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new w(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(x.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(x.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),x.prototype._write=function(e,t,r){r(new m("_write()"))},x.prototype._writev=null,x.prototype.end=function(e,t,r){var n=this._writableState;return"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||function(e,t,r){t.ending=!0,O(e,t),r&&(t.finished?i.nextTick(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,n,r),this},Object.defineProperty(x.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(x.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),x.prototype.destroy=d.destroy,x.prototype._undestroy=d.undestroy,x.prototype._destroy=function(e,t){t(e)}},45850:(e,t,r)=>{"use strict";var n,i=r(34155);function o(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=r(8610),a=Symbol("lastResolve"),c=Symbol("lastReject"),u=Symbol("error"),l=Symbol("ended"),d=Symbol("lastPromise"),h=Symbol("handlePromise"),f=Symbol("stream");function p(e,t){return{value:e,done:t}}function m(e){var t=e[a];if(null!==t){var r=e[f].read();null!==r&&(e[d]=null,e[a]=null,e[c]=null,t(p(r,!1)))}}function g(e){i.nextTick(m,e)}var v=Object.getPrototypeOf((function(){})),y=Object.setPrototypeOf((o(n={get stream(){return this[f]},next:function(){var e=this,t=this[u];if(null!==t)return Promise.reject(t);if(this[l])return Promise.resolve(p(void 0,!0));if(this[f].destroyed)return new Promise((function(t,r){i.nextTick((function(){e[u]?r(e[u]):t(p(void 0,!0))}))}));var r,n=this[d];if(n)r=new Promise(function(e,t){return function(r,n){e.then((function(){t[l]?r(p(void 0,!0)):t[h](r,n)}),n)}}(n,this));else{var o=this[f].read();if(null!==o)return Promise.resolve(p(o,!1));r=new Promise(this[h])}return this[d]=r,r}},Symbol.asyncIterator,(function(){return this})),o(n,"return",(function(){var e=this;return new Promise((function(t,r){e[f].destroy(null,(function(e){e?r(e):t(p(void 0,!0))}))}))})),n),v);e.exports=function(e){var t,r=Object.create(y,(o(t={},f,{value:e,writable:!0}),o(t,a,{value:null,writable:!0}),o(t,c,{value:null,writable:!0}),o(t,u,{value:null,writable:!0}),o(t,l,{value:e._readableState.endEmitted,writable:!0}),o(t,h,{value:function(e,t){var n=r[f].read();n?(r[d]=null,r[a]=null,r[c]=null,e(p(n,!1))):(r[a]=e,r[c]=t)},writable:!0}),t));return r[d]=null,s(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[c];return null!==t&&(r[d]=null,r[a]=null,r[c]=null,t(e)),void(r[u]=e)}var n=r[a];null!==n&&(r[d]=null,r[a]=null,r[c]=null,n(p(void 0,!0))),r[l]=!0})),e.on("readable",g.bind(null,r)),r}},57327:(e,t,r)=>{"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t,r){return(t=a(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function a(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=r(48764).Buffer,u=r(52361).inspect,l=u&&u.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,r,n;return t=e,(r=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return c.alloc(0);for(var t,r,n,i=c.allocUnsafe(e>>>0),o=this.head,s=0;o;)t=o.data,r=i,n=s,c.prototype.copy.call(t,r,n),s+=o.data.length,o=o.next;return i}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var i=t.data,o=e>i.length?i.length:e;if(o===i.length?n+=i:n+=i.slice(0,e),0==(e-=o)){o===i.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(o));break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=c.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var i=r.data,o=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,o),0==(e-=o)){o===i.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=i.slice(o));break}++n}return this.length-=n,t}},{key:l,value:function(e,t){return u(this,i(i({},t),{},{depth:0,customInspect:!1}))}}])&&s(t.prototype,r),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},61195:(e,t,r)=>{"use strict";var n=r(34155);function i(e,t){s(e,t),o(e)}function o(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function s(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var r=this,a=this._readableState&&this._readableState.destroyed,c=this._writableState&&this._writableState.destroyed;return a||c?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,n.nextTick(s,this,e)):n.nextTick(s,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?r._writableState?r._writableState.errorEmitted?n.nextTick(o,r):(r._writableState.errorEmitted=!0,n.nextTick(i,r,e)):n.nextTick(i,r,e):t?(n.nextTick(o,r),t(e)):n.nextTick(o,r)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}},8610:(e,t,r)=>{"use strict";var n=r(94281).q.ERR_STREAM_PREMATURE_CLOSE;function i(){}e.exports=function e(t,r,o){if("function"==typeof r)return e(t,null,r);r||(r={}),o=function(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}(o||i);var s=r.readable||!1!==r.readable&&t.readable,a=r.writable||!1!==r.writable&&t.writable,c=function(){t.writable||l()},u=t._writableState&&t._writableState.finished,l=function(){a=!1,u=!0,s||o.call(t)},d=t._readableState&&t._readableState.endEmitted,h=function(){s=!1,d=!0,a||o.call(t)},f=function(e){o.call(t,e)},p=function(){var e;return s&&!d?(t._readableState&&t._readableState.ended||(e=new n),o.call(t,e)):a&&!u?(t._writableState&&t._writableState.ended||(e=new n),o.call(t,e)):void 0},m=function(){t.req.on("finish",l)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(t)?a&&!t._writableState&&(t.on("end",c),t.on("close",c)):(t.on("complete",l),t.on("abort",p),t.req?m():t.on("request",m)),t.on("end",h),t.on("finish",l),!1!==r.error&&t.on("error",f),t.on("close",p),function(){t.removeListener("complete",l),t.removeListener("abort",p),t.removeListener("request",m),t.req&&t.req.removeListener("finish",l),t.removeListener("end",c),t.removeListener("close",c),t.removeListener("finish",l),t.removeListener("end",h),t.removeListener("error",f),t.removeListener("close",p)}}},15167:e=>{e.exports=function(){throw new Error("Readable.from is not available in the browser")}},59946:(e,t,r)=>{"use strict";var n;var i=r(94281).q,o=i.ERR_MISSING_ARGS,s=i.ERR_STREAM_DESTROYED;function a(e){if(e)throw e}function c(e){e()}function u(e,t){return e.pipe(t)}e.exports=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var l,d=function(e){return e.length?"function"!=typeof e[e.length-1]?a:e.pop():a}(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new o("streams");var h=t.map((function(e,i){var o=i<t.length-1;return function(e,t,i,o){o=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(o);var a=!1;e.on("close",(function(){a=!0})),void 0===n&&(n=r(8610)),n(e,{readable:t,writable:i},(function(e){if(e)return o(e);a=!0,o()}));var c=!1;return function(t){if(!a&&!c)return c=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void o(t||new s("pipe"))}}(e,o,i>0,(function(e){l||(l=e),e&&h.forEach(c),o||(h.forEach(c),d(l))}))}));return t.reduce(u)}},82457:(e,t,r)=>{"use strict";var n=r(94281).q.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,r,i){var o=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,i,r);if(null!=o){if(!isFinite(o)||Math.floor(o)!==o||o<0)throw new n(i?r:"highWaterMark",o);return Math.floor(o)}return e.objectMode?16:16384}}},22503:(e,t,r)=>{e.exports=r(17187).EventEmitter},89509:(e,t,r)=>{var n=r(48764),i=n.Buffer;function o(e,t){for(var r in e)t[r]=e[r]}function s(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=n:(o(n,t),t.Buffer=s),s.prototype=Object.create(i.prototype),o(i,s),s.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},s.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},57539:e=>{"use strict";const t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((e=>e.trim()))},t.splitSections=function(e){return e.split("\nm=").map(((e,t)=>(t>0?"m="+e:e).trim()+"\r\n"))},t.getDescription=function(e){const r=t.splitSections(e);return r&&r[0]},t.getMediaSections=function(e){const r=t.splitSections(e);return r.shift(),r},t.matchPrefix=function(e,r){return t.splitLines(e).filter((e=>0===e.indexOf(r)))},t.parseCandidate=function(e){let t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");const r={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]};for(let e=8;e<t.length;e+=2)switch(t[e]){case"raddr":r.relatedAddress=t[e+1];break;case"rport":r.relatedPort=parseInt(t[e+1],10);break;case"tcptype":r.tcpType=t[e+1];break;case"ufrag":r.ufrag=t[e+1],r.usernameFragment=t[e+1];break;default:void 0===r[t[e]]&&(r[t[e]]=t[e+1])}return r},t.writeCandidate=function(e){const t=[];t.push(e.foundation);const r=e.component;"rtp"===r?t.push(1):"rtcp"===r?t.push(2):t.push(r),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);const n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substring(14).split(" ")},t.parseRtpMap=function(e){let t=e.substring(9).split(" ");const r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.channels=3===t.length?parseInt(t[2],10):1,r.numChannels=r.channels,r},t.writeRtpMap=function(e){let t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);const r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},t.parseExtmap=function(e){const t=e.substring(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1],attributes:t.slice(2).join(" ")}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+(e.attributes?" "+e.attributes:"")+"\r\n"},t.parseFmtp=function(e){const t={};let r;const n=e.substring(e.indexOf(" ")+1).split(";");for(let e=0;e<n.length;e++)r=n[e].trim().split("="),t[r[0].trim()]=r[1];return t},t.writeFmtp=function(e){let t="",r=e.payloadType;if(void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){const n=[];Object.keys(e.parameters).forEach((t=>{void 0!==e.parameters[t]?n.push(t+"="+e.parameters[t]):n.push(t)})),t+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){const t=e.substring(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){let t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((e=>{t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){const t=e.indexOf(" "),r={ssrc:parseInt(e.substring(7,t),10)},n=e.indexOf(":",t);return n>-1?(r.attribute=e.substring(t+1,n),r.value=e.substring(n+1)):r.attribute=e.substring(t+1),r},t.parseSsrcGroup=function(e){const t=e.substring(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((e=>parseInt(e,10)))}},t.getMid=function(e){const r=t.matchPrefix(e,"a=mid:")[0];if(r)return r.substring(6)},t.parseFingerprint=function(e){const t=e.substring(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,r){return{role:"auto",fingerprints:t.matchPrefix(e+r,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){let r="a=setup:"+t+"\r\n";return e.fingerprints.forEach((e=>{r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),r},t.parseCryptoLine=function(e){const t=e.substring(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;const t=e.substring(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,r){return t.matchPrefix(e+r,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,r){const n=t.matchPrefix(e+r,"a=ice-ufrag:")[0],i=t.matchPrefix(e+r,"a=ice-pwd:")[0];return n&&i?{usernameFragment:n.substring(12),password:i.substring(10)}:null},t.writeIceParameters=function(e){let t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=t.splitLines(e)[0].split(" ");for(let i=3;i<n.length;i++){const o=n[i],s=t.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(s){const n=t.parseRtpMap(s),i=t.matchPrefix(e,"a=fmtp:"+o+" ");switch(n.parameters=i.length?t.parseFmtp(i[0]):{},n.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(t.parseRtcpFb),r.codecs.push(n),n.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(n.name.toUpperCase())}}}t.matchPrefix(e,"a=extmap:").forEach((e=>{r.headerExtensions.push(t.parseExtmap(e))}));const i=t.matchPrefix(e,"a=rtcp-fb:* ").map(t.parseRtcpFb);return r.codecs.forEach((e=>{i.forEach((t=>{e.rtcpFeedback.find((e=>e.type===t.type&&e.parameter===t.parameter))||e.rtcpFeedback.push(t)}))})),r},t.writeRtpDescription=function(e,r){let n="";n+="m="+e+" ",n+=r.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=r.codecs.map((e=>void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType)).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",r.codecs.forEach((e=>{n+=t.writeRtpMap(e),n+=t.writeFmtp(e),n+=t.writeRtcpFb(e)}));let i=0;return r.codecs.forEach((e=>{e.maxptime>i&&(i=e.maxptime)})),i>0&&(n+="a=maxptime:"+i+"\r\n"),r.headerExtensions&&r.headerExtensions.forEach((e=>{n+=t.writeExtmap(e)})),n},t.parseRtpEncodingParameters=function(e){const r=[],n=t.parseRtpParameters(e),i=-1!==n.fecMechanisms.indexOf("RED"),o=-1!==n.fecMechanisms.indexOf("ULPFEC"),s=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute)),a=s.length>0&&s[0].ssrc;let c;const u=t.matchPrefix(e,"a=ssrc-group:FID").map((e=>e.substring(17).split(" ").map((e=>parseInt(e,10)))));u.length>0&&u[0].length>1&&u[0][0]===a&&(c=u[0][1]),n.codecs.forEach((e=>{if("RTX"===e.name.toUpperCase()&&e.parameters.apt){let t={ssrc:a,codecPayloadType:parseInt(e.parameters.apt,10)};a&&c&&(t.rtx={ssrc:c}),r.push(t),i&&(t=JSON.parse(JSON.stringify(t)),t.fec={ssrc:a,mechanism:o?"red+ulpfec":"red"},r.push(t))}})),0===r.length&&a&&r.push({ssrc:a});let l=t.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substring(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substring(5),10)*.95-16e3:void 0,r.forEach((e=>{e.maxBitrate=l}))),r},t.parseRtcpParameters=function(e){const r={},n=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute))[0];n&&(r.cname=n.value,r.ssrc=n.ssrc);const i=t.matchPrefix(e,"a=rtcp-rsize");r.reducedSize=i.length>0,r.compound=0===i.length;const o=t.matchPrefix(e,"a=rtcp-mux");return r.mux=o.length>0,r},t.writeRtcpParameters=function(e){let t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){let r;const n=t.matchPrefix(e,"a=msid:");if(1===n.length)return r=n[0].substring(7).split(" "),{stream:r[0],track:r[1]};const i=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"msid"===e.attribute));return i.length>0?(r=i[0].value.split(" "),{stream:r[0],track:r[1]}):void 0},t.parseSctpDescription=function(e){const r=t.parseMLine(e),n=t.matchPrefix(e,"a=max-message-size:");let i;n.length>0&&(i=parseInt(n[0].substring(19),10)),isNaN(i)&&(i=65536);const o=t.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:r.fmt,maxMessageSize:i};const s=t.matchPrefix(e,"a=sctpmap:");if(s.length>0){const e=s[0].substring(10).split(" ");return{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:i}}},t.writeSctpDescription=function(e,t){let r=[];return r="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&r.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),r.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(e,r,n){let i;const o=void 0!==r?r:2;i=e||t.generateSessionId();return"v=0\r\no="+(n||"thisisadapterortc")+" "+i+" "+o+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,r){const n=t.splitLines(e);for(let e=0;e<n.length;e++)switch(n[e]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[e].substring(2)}return r?t.getDirection(r):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substring(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){const r=t.splitLines(e)[0].substring(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}},t.parseOLine=function(e){const r=t.matchPrefix(e,"o=")[0].substring(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;const r=t.splitLines(e);for(let e=0;e<r.length;e++)if(r[e].length<2||"="!==r[e].charAt(1))return!1;return!0},e.exports=t},22257:(e,t,r)=>{const n=Symbol("SemVer ANY");class i{static get ANY(){return n}constructor(e,t){if(t=o(t),e instanceof i){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),u("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===n?this.value="":this.value=this.operator+this.semver.version,u("comp",this)}parse(e){const t=this.options.loose?s[a.COMPARATORLOOSE]:s[a.COMPARATOR],r=e.match(t);if(!r)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==r[1]?r[1]:"","="===this.operator&&(this.operator=""),r[2]?this.semver=new l(r[2],this.options.loose):this.semver=n}toString(){return this.value}test(e){if(u("Comparator.test",e,this.options.loose),this.semver===n||e===n)return!0;if("string"==typeof e)try{e=new l(e,this.options)}catch(e){return!1}return c(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof i))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new d(e.value,t).test(this.value):""===e.operator?""===e.value||new d(this.value,t).test(e.semver):(!(t=o(t)).includePrerelease||"<0.0.0-0"!==this.value&&"<0.0.0-0"!==e.value)&&(!(!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0")))&&(!(!this.operator.startsWith(">")||!e.operator.startsWith(">"))||(!(!this.operator.startsWith("<")||!e.operator.startsWith("<"))||(!(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))||(!!(c(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))||!!(c(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))))))}}e.exports=i;const o=r(12893),{safeRe:s,t:a}=r(55765),c=r(7539),u=r(74225),l=r(26376),d=r(66902)},66902:(e,t,r)=>{class n{constructor(e,t){if(t=o(t),e instanceof n)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new n(e.raw,t);if(e instanceof s)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!g(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&v(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){const t=((this.options.includePrerelease&&p)|(this.options.loose&&m))+":"+e,r=i.get(t);if(r)return r;const n=this.options.loose,o=n?u[l.HYPHENRANGELOOSE]:u[l.HYPHENRANGE];e=e.replace(o,R(this.options.includePrerelease)),a("hyphen replace",e),e=e.replace(u[l.COMPARATORTRIM],d),a("comparator trim",e),e=e.replace(u[l.TILDETRIM],h),a("tilde trim",e),e=e.replace(u[l.CARETTRIM],f),a("caret trim",e);let c=e.split(" ").map((e=>b(e,this.options))).join(" ").split(/\s+/).map((e=>C(e,this.options)));n&&(c=c.filter((e=>(a("loose invalid filter",e,this.options),!!e.match(u[l.COMPARATORLOOSE]))))),a("range list",c);const v=new Map,y=c.map((e=>new s(e,this.options)));for(const e of y){if(g(e))return[e];v.set(e.value,e)}v.size>1&&v.has("")&&v.delete("");const E=[...v.values()];return i.set(t,E),E}intersects(e,t){if(!(e instanceof n))throw new TypeError("a Range is required");return this.set.some((r=>y(r,t)&&e.set.some((e=>y(e,t)&&r.every((r=>e.every((e=>r.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new c(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(k(this.set[t],e,this.options))return!0;return!1}}e.exports=n;const i=new(r(39593))({max:1e3}),o=r(12893),s=r(22257),a=r(74225),c=r(26376),{safeRe:u,t:l,comparatorTrimReplace:d,tildeTrimReplace:h,caretTrimReplace:f}=r(55765),{FLAG_INCLUDE_PRERELEASE:p,FLAG_LOOSE:m}=r(83295),g=e=>"<0.0.0-0"===e.value,v=e=>""===e.value,y=(e,t)=>{let r=!0;const n=e.slice();let i=n.pop();for(;r&&n.length;)r=n.every((e=>i.intersects(e,t))),i=n.pop();return r},b=(e,t)=>(a("comp",e,t),e=_(e,t),a("caret",e),e=w(e,t),a("tildes",e),e=x(e,t),a("xrange",e),e=I(e,t),a("stars",e),e),E=e=>!e||"x"===e.toLowerCase()||"*"===e,w=(e,t)=>e.trim().split(/\s+/).map((e=>S(e,t))).join(" "),S=(e,t)=>{const r=t.loose?u[l.TILDELOOSE]:u[l.TILDE];return e.replace(r,((t,r,n,i,o)=>{let s;return a("tilde",e,t,r,n,i,o),E(r)?s="":E(n)?s=`>=${r}.0.0 <${+r+1}.0.0-0`:E(i)?s=`>=${r}.${n}.0 <${r}.${+n+1}.0-0`:o?(a("replaceTilde pr",o),s=`>=${r}.${n}.${i}-${o} <${r}.${+n+1}.0-0`):s=`>=${r}.${n}.${i} <${r}.${+n+1}.0-0`,a("tilde return",s),s}))},_=(e,t)=>e.trim().split(/\s+/).map((e=>T(e,t))).join(" "),T=(e,t)=>{a("caret",e,t);const r=t.loose?u[l.CARETLOOSE]:u[l.CARET],n=t.includePrerelease?"-0":"";return e.replace(r,((t,r,i,o,s)=>{let c;return a("caret",e,t,r,i,o,s),E(r)?c="":E(i)?c=`>=${r}.0.0${n} <${+r+1}.0.0-0`:E(o)?c="0"===r?`>=${r}.${i}.0${n} <${r}.${+i+1}.0-0`:`>=${r}.${i}.0${n} <${+r+1}.0.0-0`:s?(a("replaceCaret pr",s),c="0"===r?"0"===i?`>=${r}.${i}.${o}-${s} <${r}.${i}.${+o+1}-0`:`>=${r}.${i}.${o}-${s} <${r}.${+i+1}.0-0`:`>=${r}.${i}.${o}-${s} <${+r+1}.0.0-0`):(a("no pr"),c="0"===r?"0"===i?`>=${r}.${i}.${o}${n} <${r}.${i}.${+o+1}-0`:`>=${r}.${i}.${o}${n} <${r}.${+i+1}.0-0`:`>=${r}.${i}.${o} <${+r+1}.0.0-0`),a("caret return",c),c}))},x=(e,t)=>(a("replaceXRanges",e,t),e.split(/\s+/).map((e=>A(e,t))).join(" ")),A=(e,t)=>{e=e.trim();const r=t.loose?u[l.XRANGELOOSE]:u[l.XRANGE];return e.replace(r,((r,n,i,o,s,c)=>{a("xRange",e,r,n,i,o,s,c);const u=E(i),l=u||E(o),d=l||E(s),h=d;return"="===n&&h&&(n=""),c=t.includePrerelease?"-0":"",u?r=">"===n||"<"===n?"<0.0.0-0":"*":n&&h?(l&&(o=0),s=0,">"===n?(n=">=",l?(i=+i+1,o=0,s=0):(o=+o+1,s=0)):"<="===n&&(n="<",l?i=+i+1:o=+o+1),"<"===n&&(c="-0"),r=`${n+i}.${o}.${s}${c}`):l?r=`>=${i}.0.0${c} <${+i+1}.0.0-0`:d&&(r=`>=${i}.${o}.0${c} <${i}.${+o+1}.0-0`),a("xRange return",r),r}))},I=(e,t)=>(a("replaceStars",e,t),e.trim().replace(u[l.STAR],"")),C=(e,t)=>(a("replaceGTE0",e,t),e.trim().replace(u[t.includePrerelease?l.GTE0PRE:l.GTE0],"")),R=e=>(t,r,n,i,o,s,a,c,u,l,d,h,f)=>`${r=E(n)?"":E(i)?`>=${n}.0.0${e?"-0":""}`:E(o)?`>=${n}.${i}.0${e?"-0":""}`:s?`>=${r}`:`>=${r}${e?"-0":""}`} ${c=E(u)?"":E(l)?`<${+u+1}.0.0-0`:E(d)?`<${u}.${+l+1}.0-0`:h?`<=${u}.${l}.${d}-${h}`:e?`<${u}.${l}.${+d+1}-0`:`<=${c}`}`.trim(),k=(e,t,r)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++)if(a(e[r].semver),e[r].semver!==s.ANY&&e[r].semver.prerelease.length>0){const n=e[r].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0}},26376:(e,t,r)=>{const n=r(74225),{MAX_LENGTH:i,MAX_SAFE_INTEGER:o}=r(83295),{safeRe:s,t:a}=r(55765),c=r(12893),{compareIdentifiers:u}=r(86742);class l{constructor(e,t){if(t=c(t),e instanceof l){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);n("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const r=e.trim().match(t.loose?s[a.LOOSE]:s[a.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<o)return t}return e})):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(n("SemVer.compare",this.version,this.options,e),!(e instanceof l)){if("string"==typeof e&&e===this.version)return 0;e=new l(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof l||(e=new l(e,this.options)),u(this.major,e.major)||u(this.minor,e.minor)||u(this.patch,e.patch)}comparePre(e){if(e instanceof l||(e=new l(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const r=this.prerelease[t],i=e.prerelease[t];if(n("prerelease compare",t,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return-1;if(r!==i)return u(r,i)}while(++t)}compareBuild(e){e instanceof l||(e=new l(e,this.options));let t=0;do{const r=this.build[t],i=e.build[t];if(n("prerelease compare",t,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return-1;if(r!==i)return u(r,i)}while(++t)}inc(e,t,r){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(r)?1:0;if(!t&&!1===r)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let n=this.prerelease.length;for(;--n>=0;)"number"==typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);if(-1===n){if(t===this.prerelease.join(".")&&!1===r)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let n=[t,e];!1===r&&(n=[t]),0===u(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=n):this.prerelease=n}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=l},13507:(e,t,r)=>{const n=r(33959);e.exports=(e,t)=>{const r=n(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null}},7539:(e,t,r)=>{const n=r(58718),i=r(81194),o=r(71312),s=r(25903),a=r(21544),c=r(12056);e.exports=(e,t,r,u)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return n(e,r,u);case"!=":return i(e,r,u);case">":return o(e,r,u);case">=":return s(e,r,u);case"<":return a(e,r,u);case"<=":return c(e,r,u);default:throw new TypeError(`Invalid operator: ${t}`)}}},99038:(e,t,r)=>{const n=r(26376),i=r(33959),{safeRe:o,t:s}=r(55765);e.exports=(e,t)=>{if(e instanceof n)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let r=null;if((t=t||{}).rtl){let t;for(;(t=o[s.COERCERTL].exec(e))&&(!r||r.index+r[0].length!==e.length);)r&&t.index+t[0].length===r.index+r[0].length||(r=t),o[s.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;o[s.COERCERTL].lastIndex=-1}else r=e.match(o[s.COERCE]);return null===r?null:i(`${r[2]}.${r[3]||"0"}.${r[4]||"0"}`,t)}},88880:(e,t,r)=>{const n=r(26376);e.exports=(e,t,r)=>{const i=new n(e,r),o=new n(t,r);return i.compare(o)||i.compareBuild(o)}},27880:(e,t,r)=>{const n=r(46269);e.exports=(e,t)=>n(e,t,!0)},46269:(e,t,r)=>{const n=r(26376);e.exports=(e,t,r)=>new n(e,r).compare(new n(t,r))},62378:(e,t,r)=>{const n=r(33959);e.exports=(e,t)=>{const r=n(e,null,!0),i=n(t,null,!0),o=r.compare(i);if(0===o)return null;const s=o>0,a=s?r:i,c=s?i:r,u=!!a.prerelease.length;if(!!c.prerelease.length&&!u)return c.patch||c.minor?a.patch?"patch":a.minor?"minor":"major":"major";const l=u?"pre":"";return r.major!==i.major?l+"major":r.minor!==i.minor?l+"minor":r.patch!==i.patch?l+"patch":"prerelease"}},58718:(e,t,r)=>{const n=r(46269);e.exports=(e,t,r)=>0===n(e,t,r)},71312:(e,t,r)=>{const n=r(46269);e.exports=(e,t,r)=>n(e,t,r)>0},25903:(e,t,r)=>{const n=r(46269);e.exports=(e,t,r)=>n(e,t,r)>=0},20253:(e,t,r)=>{const n=r(26376);e.exports=(e,t,r,i,o)=>{"string"==typeof r&&(o=i,i=r,r=void 0);try{return new n(e instanceof n?e.version:e,r).inc(t,i,o).version}catch(e){return null}}},21544:(e,t,r)=>{const n=r(46269);e.exports=(e,t,r)=>n(e,t,r)<0},12056:(e,t,r)=>{const n=r(46269);e.exports=(e,t,r)=>n(e,t,r)<=0},38679:(e,t,r)=>{const n=r(26376);e.exports=(e,t)=>new n(e,t).major},87789:(e,t,r)=>{const n=r(26376);e.exports=(e,t)=>new n(e,t).minor},81194:(e,t,r)=>{const n=r(46269);e.exports=(e,t,r)=>0!==n(e,t,r)},33959:(e,t,r)=>{const n=r(26376);e.exports=(e,t,r=!1)=>{if(e instanceof n)return e;try{return new n(e,t)}catch(e){if(!r)return null;throw e}}},52358:(e,t,r)=>{const n=r(26376);e.exports=(e,t)=>new n(e,t).patch},57559:(e,t,r)=>{const n=r(33959);e.exports=(e,t)=>{const r=n(e,t);return r&&r.prerelease.length?r.prerelease:null}},79795:(e,t,r)=>{const n=r(46269);e.exports=(e,t,r)=>n(t,e,r)},63657:(e,t,r)=>{const n=r(88880);e.exports=(e,t)=>e.sort(((e,r)=>n(r,e,t)))},45712:(e,t,r)=>{const n=r(66902);e.exports=(e,t,r)=>{try{t=new n(t,r)}catch(e){return!1}return t.test(e)}},21100:(e,t,r)=>{const n=r(88880);e.exports=(e,t)=>e.sort(((e,r)=>n(e,r,t)))},76397:(e,t,r)=>{const n=r(33959);e.exports=(e,t)=>{const r=n(e,t);return r?r.version:null}},81249:(e,t,r)=>{const n=r(55765),i=r(83295),o=r(26376),s=r(86742),a=r(33959),c=r(76397),u=r(13507),l=r(20253),d=r(62378),h=r(38679),f=r(87789),p=r(52358),m=r(57559),g=r(46269),v=r(79795),y=r(27880),b=r(88880),E=r(21100),w=r(63657),S=r(71312),_=r(21544),T=r(58718),x=r(81194),A=r(25903),I=r(12056),C=r(7539),R=r(99038),k=r(22257),O=r(66902),N=r(45712),P=r(51042),L=r(85775),D=r(71657),M=r(95316),U=r(89042),B=r(6826),F=r(97606),j=r(50032),V=r(82937),H=r(17908),G=r(50799);e.exports={parse:a,valid:c,clean:u,inc:l,diff:d,major:h,minor:f,patch:p,prerelease:m,compare:g,rcompare:v,compareLoose:y,compareBuild:b,sort:E,rsort:w,gt:S,lt:_,eq:T,neq:x,gte:A,lte:I,cmp:C,coerce:R,Comparator:k,Range:O,satisfies:N,toComparators:P,maxSatisfying:L,minSatisfying:D,minVersion:M,validRange:U,outside:B,gtr:F,ltr:j,intersects:V,simplifyRange:H,subset:G,SemVer:o,re:n.re,src:n.src,tokens:n.t,SEMVER_SPEC_VERSION:i.SEMVER_SPEC_VERSION,RELEASE_TYPES:i.RELEASE_TYPES,compareIdentifiers:s.compareIdentifiers,rcompareIdentifiers:s.rcompareIdentifiers}},83295:e=>{const t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},74225:(e,t,r)=>{const n="object"==typeof r(34155)&&{ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.NODE_DEBUG&&/\bsemver\b/i.test({ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=n},86742:e=>{const t=/^[0-9]+$/,r=(e,r)=>{const n=t.test(e),i=t.test(r);return n&&i&&(e=+e,r=+r),e===r?0:n&&!i?-1:i&&!n?1:e<r?-1:1};e.exports={compareIdentifiers:r,rcompareIdentifiers:(e,t)=>r(t,e)}},12893:e=>{const t=Object.freeze({loose:!0}),r=Object.freeze({});e.exports=e=>e?"object"!=typeof e?t:e:r},55765:(e,t,r)=>{const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:o}=r(83295),s=r(74225),a=(t=e.exports={}).re=[],c=t.safeRe=[],u=t.src=[],l=t.t={};let d=0;const h="[a-zA-Z0-9-]",f=[["\\s",1],["\\d",o],[h,i]],p=(e,t,r)=>{const n=(e=>{for(const[t,r]of f)e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`);return e})(t),i=d++;s(e,i,t),l[e]=i,u[i]=t,a[i]=new RegExp(t,r?"g":void 0),c[i]=new RegExp(n,r?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${h}*`),p("MAINVERSION",`(${u[l.NUMERICIDENTIFIER]})\\.(${u[l.NUMERICIDENTIFIER]})\\.(${u[l.NUMERICIDENTIFIER]})`),p("MAINVERSIONLOOSE",`(${u[l.NUMERICIDENTIFIERLOOSE]})\\.(${u[l.NUMERICIDENTIFIERLOOSE]})\\.(${u[l.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASEIDENTIFIER",`(?:${u[l.NUMERICIDENTIFIER]}|${u[l.NONNUMERICIDENTIFIER]})`),p("PRERELEASEIDENTIFIERLOOSE",`(?:${u[l.NUMERICIDENTIFIERLOOSE]}|${u[l.NONNUMERICIDENTIFIER]})`),p("PRERELEASE",`(?:-(${u[l.PRERELEASEIDENTIFIER]}(?:\\.${u[l.PRERELEASEIDENTIFIER]})*))`),p("PRERELEASELOOSE",`(?:-?(${u[l.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[l.PRERELEASEIDENTIFIERLOOSE]})*))`),p("BUILDIDENTIFIER",`${h}+`),p("BUILD",`(?:\\+(${u[l.BUILDIDENTIFIER]}(?:\\.${u[l.BUILDIDENTIFIER]})*))`),p("FULLPLAIN",`v?${u[l.MAINVERSION]}${u[l.PRERELEASE]}?${u[l.BUILD]}?`),p("FULL",`^${u[l.FULLPLAIN]}$`),p("LOOSEPLAIN",`[v=\\s]*${u[l.MAINVERSIONLOOSE]}${u[l.PRERELEASELOOSE]}?${u[l.BUILD]}?`),p("LOOSE",`^${u[l.LOOSEPLAIN]}$`),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE",`${u[l.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),p("XRANGEIDENTIFIER",`${u[l.NUMERICIDENTIFIER]}|x|X|\\*`),p("XRANGEPLAIN",`[v=\\s]*(${u[l.XRANGEIDENTIFIER]})(?:\\.(${u[l.XRANGEIDENTIFIER]})(?:\\.(${u[l.XRANGEIDENTIFIER]})(?:${u[l.PRERELEASE]})?${u[l.BUILD]}?)?)?`),p("XRANGEPLAINLOOSE",`[v=\\s]*(${u[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[l.XRANGEIDENTIFIERLOOSE]})(?:${u[l.PRERELEASELOOSE]})?${u[l.BUILD]}?)?)?`),p("XRANGE",`^${u[l.GTLT]}\\s*${u[l.XRANGEPLAIN]}$`),p("XRANGELOOSE",`^${u[l.GTLT]}\\s*${u[l.XRANGEPLAINLOOSE]}$`),p("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),p("COERCERTL",u[l.COERCE],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM",`(\\s*)${u[l.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",p("TILDE",`^${u[l.LONETILDE]}${u[l.XRANGEPLAIN]}$`),p("TILDELOOSE",`^${u[l.LONETILDE]}${u[l.XRANGEPLAINLOOSE]}$`),p("LONECARET","(?:\\^)"),p("CARETTRIM",`(\\s*)${u[l.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",p("CARET",`^${u[l.LONECARET]}${u[l.XRANGEPLAIN]}$`),p("CARETLOOSE",`^${u[l.LONECARET]}${u[l.XRANGEPLAINLOOSE]}$`),p("COMPARATORLOOSE",`^${u[l.GTLT]}\\s*(${u[l.LOOSEPLAIN]})$|^$`),p("COMPARATOR",`^${u[l.GTLT]}\\s*(${u[l.FULLPLAIN]})$|^$`),p("COMPARATORTRIM",`(\\s*)${u[l.GTLT]}\\s*(${u[l.LOOSEPLAIN]}|${u[l.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE",`^\\s*(${u[l.XRANGEPLAIN]})\\s+-\\s+(${u[l.XRANGEPLAIN]})\\s*$`),p("HYPHENRANGELOOSE",`^\\s*(${u[l.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[l.XRANGEPLAINLOOSE]})\\s*$`),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},97606:(e,t,r)=>{const n=r(6826);e.exports=(e,t,r)=>n(e,t,">",r)},82937:(e,t,r)=>{const n=r(66902);e.exports=(e,t,r)=>(e=new n(e,r),t=new n(t,r),e.intersects(t,r))},50032:(e,t,r)=>{const n=r(6826);e.exports=(e,t,r)=>n(e,t,"<",r)},85775:(e,t,r)=>{const n=r(26376),i=r(66902);e.exports=(e,t,r)=>{let o=null,s=null,a=null;try{a=new i(t,r)}catch(e){return null}return e.forEach((e=>{a.test(e)&&(o&&-1!==s.compare(e)||(o=e,s=new n(o,r)))})),o}},71657:(e,t,r)=>{const n=r(26376),i=r(66902);e.exports=(e,t,r)=>{let o=null,s=null,a=null;try{a=new i(t,r)}catch(e){return null}return e.forEach((e=>{a.test(e)&&(o&&1!==s.compare(e)||(o=e,s=new n(o,r)))})),o}},95316:(e,t,r)=>{const n=r(26376),i=r(66902),o=r(71312);e.exports=(e,t)=>{e=new i(e,t);let r=new n("0.0.0");if(e.test(r))return r;if(r=new n("0.0.0-0"),e.test(r))return r;r=null;for(let t=0;t<e.set.length;++t){const i=e.set[t];let s=null;i.forEach((e=>{const t=new n(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":s&&!o(t,s)||(s=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!s||r&&!o(r,s)||(r=s)}return r&&e.test(r)?r:null}},6826:(e,t,r)=>{const n=r(26376),i=r(22257),{ANY:o}=i,s=r(66902),a=r(45712),c=r(71312),u=r(21544),l=r(12056),d=r(25903);e.exports=(e,t,r,h)=>{let f,p,m,g,v;switch(e=new n(e,h),t=new s(t,h),r){case">":f=c,p=l,m=u,g=">",v=">=";break;case"<":f=u,p=d,m=c,g="<",v="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(a(e,t,h))return!1;for(let r=0;r<t.set.length;++r){const n=t.set[r];let s=null,a=null;if(n.forEach((e=>{e.semver===o&&(e=new i(">=0.0.0")),s=s||e,a=a||e,f(e.semver,s.semver,h)?s=e:m(e.semver,a.semver,h)&&(a=e)})),s.operator===g||s.operator===v)return!1;if((!a.operator||a.operator===g)&&p(e,a.semver))return!1;if(a.operator===v&&m(e,a.semver))return!1}return!0}},17908:(e,t,r)=>{const n=r(45712),i=r(46269);e.exports=(e,t,r)=>{const o=[];let s=null,a=null;const c=e.sort(((e,t)=>i(e,t,r)));for(const e of c){n(e,t,r)?(a=e,s||(s=e)):(a&&o.push([s,a]),a=null,s=null)}s&&o.push([s,null]);const u=[];for(const[e,t]of o)e===t?u.push(e):t||e!==c[0]?t?e===c[0]?u.push(`<=${t}`):u.push(`${e} - ${t}`):u.push(`>=${e}`):u.push("*");const l=u.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return l.length<d.length?l:t}},50799:(e,t,r)=>{const n=r(66902),i=r(22257),{ANY:o}=i,s=r(45712),a=r(46269),c=[new i(">=0.0.0-0")],u=[new i(">=0.0.0")],l=(e,t,r)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===o){if(1===t.length&&t[0].semver===o)return!0;e=r.includePrerelease?c:u}if(1===t.length&&t[0].semver===o){if(r.includePrerelease)return!0;t=u}const n=new Set;let i,l,f,p,m,g,v;for(const t of e)">"===t.operator||">="===t.operator?i=d(i,t,r):"<"===t.operator||"<="===t.operator?l=h(l,t,r):n.add(t.semver);if(n.size>1)return null;if(i&&l){if(f=a(i.semver,l.semver,r),f>0)return null;if(0===f&&(">="!==i.operator||"<="!==l.operator))return null}for(const e of n){if(i&&!s(e,String(i),r))return null;if(l&&!s(e,String(l),r))return null;for(const n of t)if(!s(e,String(n),r))return!1;return!0}let y=!(!l||r.includePrerelease||!l.semver.prerelease.length)&&l.semver,b=!(!i||r.includePrerelease||!i.semver.prerelease.length)&&i.semver;y&&1===y.prerelease.length&&"<"===l.operator&&0===y.prerelease[0]&&(y=!1);for(const e of t){if(v=v||">"===e.operator||">="===e.operator,g=g||"<"===e.operator||"<="===e.operator,i)if(b&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===b.major&&e.semver.minor===b.minor&&e.semver.patch===b.patch&&(b=!1),">"===e.operator||">="===e.operator){if(p=d(i,e,r),p===e&&p!==i)return!1}else if(">="===i.operator&&!s(i.semver,String(e),r))return!1;if(l)if(y&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===y.major&&e.semver.minor===y.minor&&e.semver.patch===y.patch&&(y=!1),"<"===e.operator||"<="===e.operator){if(m=h(l,e,r),m===e&&m!==l)return!1}else if("<="===l.operator&&!s(l.semver,String(e),r))return!1;if(!e.operator&&(l||i)&&0!==f)return!1}return!(i&&g&&!l&&0!==f)&&(!(l&&v&&!i&&0!==f)&&(!b&&!y))},d=(e,t,r)=>{if(!e)return t;const n=a(e.semver,t.semver,r);return n>0?e:n<0||">"===t.operator&&">="===e.operator?t:e},h=(e,t,r)=>{if(!e)return t;const n=a(e.semver,t.semver,r);return n<0?e:n>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,r={})=>{if(e===t)return!0;e=new n(e,r),t=new n(t,r);let i=!1;e:for(const n of e.set){for(const e of t.set){const t=l(n,e,r);if(i=i||null!==t,t)continue e}if(i)return!1}return!0}},51042:(e,t,r)=>{const n=r(66902);e.exports=(e,t)=>new n(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")))},89042:(e,t,r)=>{const n=r(66902);e.exports=(e,t)=>{try{return new n(e,t).range||"*"}catch(e){return null}}},67771:(e,t,r)=>{"use strict";var n=r(40210),i=r(12296),o=r(31044)(),s=r(27296),a=n("%TypeError%"),c=n("%Math.floor%");e.exports=function(e,t){if("function"!=typeof e)throw new a("`fn` is not a function");if("number"!=typeof t||t<0||t>4294967295||c(t)!==t)throw new a("`length` must be a positive 32-bit integer");var r=arguments.length>2&&!!arguments[2],n=!0,u=!0;if("length"in e&&s){var l=s(e,"length");l&&!l.configurable&&(n=!1),l&&!l.writable&&(u=!1)}return(n||u||!r)&&(o?i(e,"length",t,!0,!0):i(e,"length",t)),e}},37478:(e,t,r)=>{"use strict";var n=r(40210),i=r(21924),o=r(70631),s=n("%TypeError%"),a=n("%WeakMap%",!0),c=n("%Map%",!0),u=i("WeakMap.prototype.get",!0),l=i("WeakMap.prototype.set",!0),d=i("WeakMap.prototype.has",!0),h=i("Map.prototype.get",!0),f=i("Map.prototype.set",!0),p=i("Map.prototype.has",!0),m=function(e,t){for(var r,n=e;null!==(r=n.next);n=r)if(r.key===t)return n.next=r.next,r.next=e.next,e.next=r,r};e.exports=function(){var e,t,r,n={assert:function(e){if(!n.has(e))throw new s("Side channel does not contain "+o(e))},get:function(n){if(a&&n&&("object"==typeof n||"function"==typeof n)){if(e)return u(e,n)}else if(c){if(t)return h(t,n)}else if(r)return function(e,t){var r=m(e,t);return r&&r.value}(r,n)},has:function(n){if(a&&n&&("object"==typeof n||"function"==typeof n)){if(e)return d(e,n)}else if(c){if(t)return p(t,n)}else if(r)return function(e,t){return!!m(e,t)}(r,n);return!1},set:function(n,i){a&&n&&("object"==typeof n||"function"==typeof n)?(e||(e=new a),l(e,n,i)):c?(t||(t=new c),f(t,n,i)):(r||(r={key:{},next:null}),function(e,t,r){var n=m(e,t);n?n.value=r:e.next={key:t,next:e.next,value:r}}(r,n,i))}};return n}},42830:(e,t,r)=>{e.exports=i;var n=r(17187).EventEmitter;function i(){n.call(this)}r(35717)(i,n),i.Readable=r(79481),i.Writable=r(64229),i.Duplex=r(56753),i.Transform=r(74605),i.PassThrough=r(82725),i.finished=r(8610),i.pipeline=r(59946),i.Stream=i,i.prototype.pipe=function(e,t){var r=this;function i(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function o(){r.readable&&r.resume&&r.resume()}r.on("data",i),e.on("drain",o),e._isStdio||t&&!1===t.end||(r.on("end",a),r.on("close",c));var s=!1;function a(){s||(s=!0,e.end())}function c(){s||(s=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){if(l(),0===n.listenerCount(this,"error"))throw e}function l(){r.removeListener("data",i),e.removeListener("drain",o),r.removeListener("end",a),r.removeListener("close",c),r.removeListener("error",u),e.removeListener("error",u),r.removeListener("end",l),r.removeListener("close",l),e.removeListener("close",l)}return r.on("error",u),e.on("error",u),r.on("end",l),r.on("close",l),e.on("close",l),e.emit("pipe",r),e}},32553:(e,t,r)=>{"use strict";var n=r(89509).Buffer,i=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(n.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=c,this.end=u,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=l,this.end=d,t=3;break;default:return this.write=h,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function c(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function u(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function l(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function d(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function h(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}t.s=o,o.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},o.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var i=s(t[n]);if(i>=0)return i>0&&(e.lastNeed=i-1),i;if(--n<r||-2===i)return 0;if(i=s(t[n]),i>=0)return i>0&&(e.lastNeed=i-2),i;if(--n<r||-2===i)return 0;if(i=s(t[n]),i>=0)return i>0&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},80842:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractTokenizer=void 0;const n=r(55167);t.AbstractTokenizer=class{constructor(e){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=e||{}}async readToken(e,t=this.position){const r=Buffer.alloc(e.len);if(await this.readBuffer(r,{position:t})<e.len)throw new n.EndOfStreamError;return e.get(r,0)}async peekToken(e,t=this.position){const r=Buffer.alloc(e.len);if(await this.peekBuffer(r,{position:t})<e.len)throw new n.EndOfStreamError;return e.get(r,0)}async readNumber(e){if(await this.readBuffer(this.numBuffer,{length:e.len})<e.len)throw new n.EndOfStreamError;return e.get(this.numBuffer,0)}async peekNumber(e){if(await this.peekBuffer(this.numBuffer,{length:e.len})<e.len)throw new n.EndOfStreamError;return e.get(this.numBuffer,0)}async ignore(e){if(void 0!==this.fileInfo.size){const t=this.fileInfo.size-this.position;if(e>t)return this.position+=t,t}return this.position+=e,e}async close(){}normalizeOptions(e,t){if(t&&void 0!==t.position&&t.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return t?{mayBeLess:!0===t.mayBeLess,offset:t.offset?t.offset:0,length:t.length?t.length:e.length-(t.offset?t.offset:0),position:t.position?t.position:this.position}:{mayBeLess:!1,offset:0,length:e.length,position:this.position}}}},30778:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BufferTokenizer=void 0;const n=r(55167),i=r(80842);class o extends i.AbstractTokenizer{constructor(e,t){super(t),this.uint8Array=e,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:e.length}async readBuffer(e,t){if(t&&t.position){if(t.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=t.position}const r=await this.peekBuffer(e,t);return this.position+=r,r}async peekBuffer(e,t){const r=this.normalizeOptions(e,t),i=Math.min(this.uint8Array.length-r.position,r.length);if(!r.mayBeLess&&i<r.length)throw new n.EndOfStreamError;return e.set(this.uint8Array.subarray(r.position,r.position+i),r.offset),i}async close(){}}t.BufferTokenizer=o},27859:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromFile=t.FileTokenizer=void 0;const n=r(80842),i=r(55167),o=r(77209);class s extends n.AbstractTokenizer{constructor(e,t){super(t),this.fd=e}async readBuffer(e,t){const r=this.normalizeOptions(e,t);this.position=r.position;const n=await o.read(this.fd,e,r.offset,r.length,r.position);if(this.position+=n.bytesRead,n.bytesRead<r.length&&(!t||!t.mayBeLess))throw new i.EndOfStreamError;return n.bytesRead}async peekBuffer(e,t){const r=this.normalizeOptions(e,t),n=await o.read(this.fd,e,r.offset,r.length,r.position);if(!r.mayBeLess&&n.bytesRead<r.length)throw new i.EndOfStreamError;return n.bytesRead}async close(){return o.close(this.fd)}}t.FileTokenizer=s,t.fromFile=async function(e){const t=await o.stat(e);if(!t.isFile)throw new Error(`File not a file: ${e}`);const r=await o.open(e,"r");return new s(r,{path:e,size:t.size})}},77209:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readFile=t.writeFileSync=t.writeFile=t.read=t.open=t.close=t.stat=t.createReadStream=t.pathExists=void 0;const n=r(4059);t.pathExists=n.existsSync,t.createReadStream=n.createReadStream,t.stat=async function(e){return new Promise(((t,r)=>{n.stat(e,((e,n)=>{e?r(e):t(n)}))}))},t.close=async function(e){return new Promise(((t,r)=>{n.close(e,(e=>{e?r(e):t()}))}))},t.open=async function(e,t){return new Promise(((r,i)=>{n.open(e,t,((e,t)=>{e?i(e):r(t)}))}))},t.read=async function(e,t,r,i,o){return new Promise(((s,a)=>{n.read(e,t,r,i,o,((e,t,r)=>{e?a(e):s({bytesRead:t,buffer:r})}))}))},t.writeFile=async function(e,t){return new Promise(((r,i)=>{n.writeFile(e,t,(e=>{e?i(e):r()}))}))},t.writeFileSync=function(e,t){n.writeFileSync(e,t)},t.readFile=async function(e){return new Promise(((t,r)=>{n.readFile(e,((e,n)=>{e?r(e):t(n)}))}))}},20599:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadStreamTokenizer=void 0;const n=r(80842),i=r(55167);class o extends n.AbstractTokenizer{constructor(e,t){super(t),this.streamReader=new i.StreamReader(e)}async getFileInfo(){return this.fileInfo}async readBuffer(e,t){const r=this.normalizeOptions(e,t),n=r.position-this.position;if(n>0)return await this.ignore(n),this.readBuffer(e,t);if(n<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(0===r.length)return 0;const o=await this.streamReader.read(e,r.offset,r.length);if(this.position+=o,(!t||!t.mayBeLess)&&o<r.length)throw new i.EndOfStreamError;return o}async peekBuffer(e,t){const r=this.normalizeOptions(e,t);let n=0;if(r.position){const t=r.position-this.position;if(t>0){const i=new Uint8Array(r.length+t);return n=await this.peekBuffer(i,{mayBeLess:r.mayBeLess}),e.set(i.subarray(t),r.offset),n-t}if(t<0)throw new Error("Cannot peek from a negative offset in a stream")}if(r.length>0){try{n=await this.streamReader.peek(e,r.offset,r.length)}catch(e){if(t&&t.mayBeLess&&e instanceof i.EndOfStreamError)return 0;throw e}if(!r.mayBeLess&&n<r.length)throw new i.EndOfStreamError}return n}async ignore(e){const t=Math.min(256e3,e),r=new Uint8Array(t);let n=0;for(;n<e;){const i=e-n,o=await this.readBuffer(r,{length:Math.min(t,i)});if(o<0)return o;n+=o}return n}}t.ReadStreamTokenizer=o},35849:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromBuffer=t.fromStream=t.EndOfStreamError=void 0;const n=r(20599),i=r(30778);var o=r(55167);Object.defineProperty(t,"EndOfStreamError",{enumerable:!0,get:function(){return o.EndOfStreamError}}),t.fromStream=function(e,t){return t=t||{},new n.ReadStreamTokenizer(e,t)},t.fromBuffer=function(e,t){return new i.BufferTokenizer(e,t)}},26597:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromStream=t.fromBuffer=t.EndOfStreamError=t.fromFile=void 0;const n=r(77209),i=r(35849);var o=r(27859);Object.defineProperty(t,"fromFile",{enumerable:!0,get:function(){return o.fromFile}});var s=r(35849);Object.defineProperty(t,"EndOfStreamError",{enumerable:!0,get:function(){return s.EndOfStreamError}}),Object.defineProperty(t,"fromBuffer",{enumerable:!0,get:function(){return s.fromBuffer}}),t.fromStream=async function(e,t){if(t=t||{},e.path){const r=await n.stat(e.path);t.path=e.path,t.size=r.size}return i.fromStream(e,t)}},83416:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnsiStringType=t.StringType=t.BufferType=t.Uint8ArrayType=t.IgnoreType=t.Float80_LE=t.Float80_BE=t.Float64_LE=t.Float64_BE=t.Float32_LE=t.Float32_BE=t.Float16_LE=t.Float16_BE=t.INT64_BE=t.UINT64_BE=t.INT64_LE=t.UINT64_LE=t.INT32_LE=t.INT32_BE=t.INT24_BE=t.INT24_LE=t.INT16_LE=t.INT16_BE=t.INT8=t.UINT32_BE=t.UINT32_LE=t.UINT24_BE=t.UINT24_LE=t.UINT16_BE=t.UINT16_LE=t.UINT8=void 0;const n=r(80645);function i(e){return new DataView(e.buffer,e.byteOffset)}t.UINT8={len:1,get:(e,t)=>i(e).getUint8(t),put:(e,t,r)=>(i(e).setUint8(t,r),t+1)},t.UINT16_LE={len:2,get:(e,t)=>i(e).getUint16(t,!0),put:(e,t,r)=>(i(e).setUint16(t,r,!0),t+2)},t.UINT16_BE={len:2,get:(e,t)=>i(e).getUint16(t),put:(e,t,r)=>(i(e).setUint16(t,r),t+2)},t.UINT24_LE={len:3,get(e,t){const r=i(e);return r.getUint8(t)+(r.getUint16(t+1,!0)<<8)},put(e,t,r){const n=i(e);return n.setUint8(t,255&r),n.setUint16(t+1,r>>8,!0),t+3}},t.UINT24_BE={len:3,get(e,t){const r=i(e);return(r.getUint16(t)<<8)+r.getUint8(t+2)},put(e,t,r){const n=i(e);return n.setUint16(t,r>>8),n.setUint8(t+2,255&r),t+3}},t.UINT32_LE={len:4,get:(e,t)=>i(e).getUint32(t,!0),put:(e,t,r)=>(i(e).setUint32(t,r,!0),t+4)},t.UINT32_BE={len:4,get:(e,t)=>i(e).getUint32(t),put:(e,t,r)=>(i(e).setUint32(t,r),t+4)},t.INT8={len:1,get:(e,t)=>i(e).getInt8(t),put:(e,t,r)=>(i(e).setInt8(t,r),t+1)},t.INT16_BE={len:2,get:(e,t)=>i(e).getInt16(t),put:(e,t,r)=>(i(e).setInt16(t,r),t+2)},t.INT16_LE={len:2,get:(e,t)=>i(e).getInt16(t,!0),put:(e,t,r)=>(i(e).setInt16(t,r,!0),t+2)},t.INT24_LE={len:3,get(e,r){const n=t.UINT24_LE.get(e,r);return n>8388607?n-16777216:n},put(e,t,r){const n=i(e);return n.setUint8(t,255&r),n.setUint16(t+1,r>>8,!0),t+3}},t.INT24_BE={len:3,get(e,r){const n=t.UINT24_BE.get(e,r);return n>8388607?n-16777216:n},put(e,t,r){const n=i(e);return n.setUint16(t,r>>8),n.setUint8(t+2,255&r),t+3}},t.INT32_BE={len:4,get:(e,t)=>i(e).getInt32(t),put:(e,t,r)=>(i(e).setInt32(t,r),t+4)},t.INT32_LE={len:4,get:(e,t)=>i(e).getInt32(t,!0),put:(e,t,r)=>(i(e).setInt32(t,r,!0),t+4)},t.UINT64_LE={len:8,get:(e,t)=>i(e).getBigUint64(t,!0),put:(e,t,r)=>(i(e).setBigUint64(t,r,!0),t+8)},t.INT64_LE={len:8,get:(e,t)=>i(e).getBigInt64(t,!0),put:(e,t,r)=>(i(e).setBigInt64(t,r,!0),t+8)},t.UINT64_BE={len:8,get:(e,t)=>i(e).getBigUint64(t),put:(e,t,r)=>(i(e).setBigUint64(t,r),t+8)},t.INT64_BE={len:8,get:(e,t)=>i(e).getBigInt64(t),put:(e,t,r)=>(i(e).setBigInt64(t,r),t+8)},t.Float16_BE={len:2,get(e,t){return n.read(e,t,!1,10,this.len)},put(e,t,r){return n.write(e,r,t,!1,10,this.len),t+this.len}},t.Float16_LE={len:2,get(e,t){return n.read(e,t,!0,10,this.len)},put(e,t,r){return n.write(e,r,t,!0,10,this.len),t+this.len}},t.Float32_BE={len:4,get:(e,t)=>i(e).getFloat32(t),put:(e,t,r)=>(i(e).setFloat32(t,r),t+4)},t.Float32_LE={len:4,get:(e,t)=>i(e).getFloat32(t,!0),put:(e,t,r)=>(i(e).setFloat32(t,r,!0),t+4)},t.Float64_BE={len:8,get:(e,t)=>i(e).getFloat64(t),put:(e,t,r)=>(i(e).setFloat64(t,r),t+8)},t.Float64_LE={len:8,get:(e,t)=>i(e).getFloat64(t,!0),put:(e,t,r)=>(i(e).setFloat64(t,r,!0),t+8)},t.Float80_BE={len:10,get(e,t){return n.read(e,t,!1,63,this.len)},put(e,t,r){return n.write(e,r,t,!1,63,this.len),t+this.len}},t.Float80_LE={len:10,get(e,t){return n.read(e,t,!0,63,this.len)},put(e,t,r){return n.write(e,r,t,!0,63,this.len),t+this.len}};t.IgnoreType=class{constructor(e){this.len=e}get(e,t){}};t.Uint8ArrayType=class{constructor(e){this.len=e}get(e,t){return e.subarray(t,t+this.len)}};t.BufferType=class{constructor(e){this.len=e}get(e,t){return Buffer.from(e.subarray(t,t+this.len))}};t.StringType=class{constructor(e,t){this.len=e,this.encoding=t}get(e,t){return Buffer.from(e).toString(this.encoding,t,t+this.len)}};class o{constructor(e){this.len=e}static decode(e,t,r){let n="";for(let i=t;i<r;++i)n+=o.codePointToString(o.singleByteDecoder(e[i]));return n}static inRange(e,t,r){return t<=e&&e<=r}static codePointToString(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}static singleByteDecoder(e){if(o.inRange(e,0,127))return e;const t=o.windows1252[e-128];if(null===t)throw Error("invaliding encoding");return t}get(e,t=0){return o.decode(e,t,t+this.len)}}t.AnsiStringType=o,o.windows1252=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},52511:function(e,t,r){var n;e=r.nmd(e),function(i){t&&t.nodeType,e&&e.nodeType;var o="object"==typeof r.g&&r.g;o.global!==o&&o.window!==o&&o.self;var s,a=2147483647,c=36,u=1,l=26,d=38,h=700,f=72,p=128,m="-",g=/^xn--/,v=/[^\x20-\x7E]/,y=/[\x2E\u3002\uFF0E\uFF61]/g,b={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},E=c-u,w=Math.floor,S=String.fromCharCode;function _(e){throw new RangeError(b[e])}function T(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function x(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+T((e=e.replace(y,".")).split("."),t).join(".")}function A(e){for(var t,r,n=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}function I(e){return T(e,(function(e){var t="";return e>65535&&(t+=S((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=S(e)})).join("")}function C(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function R(e,t,r){var n=0;for(e=r?w(e/h):e>>1,e+=w(e/t);e>E*l>>1;n+=c)e=w(e/E);return w(n+(E+1)*e/(e+d))}function k(e){var t,r,n,i,o,s,d,h,g,v,y,b=[],E=e.length,S=0,T=p,x=f;for((r=e.lastIndexOf(m))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&_("not-basic"),b.push(e.charCodeAt(n));for(i=r>0?r+1:0;i<E;){for(o=S,s=1,d=c;i>=E&&_("invalid-input"),((h=(y=e.charCodeAt(i++))-48<10?y-22:y-65<26?y-65:y-97<26?y-97:c)>=c||h>w((a-S)/s))&&_("overflow"),S+=h*s,!(h<(g=d<=x?u:d>=x+l?l:d-x));d+=c)s>w(a/(v=c-g))&&_("overflow"),s*=v;x=R(S-o,t=b.length+1,0==o),w(S/t)>a-T&&_("overflow"),T+=w(S/t),S%=t,b.splice(S++,0,T)}return I(b)}function O(e){var t,r,n,i,o,s,d,h,g,v,y,b,E,T,x,I=[];for(b=(e=A(e)).length,t=p,r=0,o=f,s=0;s<b;++s)(y=e[s])<128&&I.push(S(y));for(n=i=I.length,i&&I.push(m);n<b;){for(d=a,s=0;s<b;++s)(y=e[s])>=t&&y<d&&(d=y);for(d-t>w((a-r)/(E=n+1))&&_("overflow"),r+=(d-t)*E,t=d,s=0;s<b;++s)if((y=e[s])<t&&++r>a&&_("overflow"),y==t){for(h=r,g=c;!(h<(v=g<=o?u:g>=o+l?l:g-o));g+=c)x=h-v,T=c-v,I.push(S(C(v+x%T,0))),h=w(x/T);I.push(S(C(h,0))),o=R(r,E,n==i),r=0,++n}++r,++t}return I.join("")}s={version:"1.4.1",ucs2:{decode:A,encode:I},decode:k,encode:O,toASCII:function(e){return x(e,(function(e){return v.test(e)?"xn--"+O(e):e}))},toUnicode:function(e){return x(e,(function(e){return g.test(e)?k(e.slice(4).toLowerCase()):e}))}},void 0===(n=function(){return s}.call(t,r,t,e))||(e.exports=n)}()},8575:(e,t,r)=>{"use strict";var n=r(52511);function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var o=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,a=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),u=["'"].concat(c),l=["%","/","?",";","#"].concat(u),d=["/","?","#"],h=/^[+a-z0-9A-Z_-]{0,63}$/,f=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,p={javascript:!0,"javascript:":!0},m={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},v=r(80129);function y(e,t,r){if(e&&"object"==typeof e&&e instanceof i)return e;var n=new i;return n.parse(e,t,r),n}i.prototype.parse=function(e,t,r){if("string"!=typeof e)throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),s=-1!==i&&i<e.indexOf("#")?"?":"#",c=e.split(s);c[0]=c[0].replace(/\\/g,"/");var y=e=c.join(s);if(y=y.trim(),!r&&1===e.split("#").length){var b=a.exec(y);if(b)return this.path=y,this.href=y,this.pathname=b[1],b[2]?(this.search=b[2],this.query=t?v.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var E=o.exec(y);if(E){var w=(E=E[0]).toLowerCase();this.protocol=w,y=y.substr(E.length)}if(r||E||y.match(/^\/\/[^@/]+@[^@/]+/)){var S="//"===y.substr(0,2);!S||E&&m[E]||(y=y.substr(2),this.slashes=!0)}if(!m[E]&&(S||E&&!g[E])){for(var _,T,x=-1,A=0;A<d.length;A++){-1!==(I=y.indexOf(d[A]))&&(-1===x||I<x)&&(x=I)}-1!==(T=-1===x?y.lastIndexOf("@"):y.lastIndexOf("@",x))&&(_=y.slice(0,T),y=y.slice(T+1),this.auth=decodeURIComponent(_)),x=-1;for(A=0;A<l.length;A++){var I;-1!==(I=y.indexOf(l[A]))&&(-1===x||I<x)&&(x=I)}-1===x&&(x=y.length),this.host=y.slice(0,x),y=y.slice(x),this.parseHost(),this.hostname=this.hostname||"";var C="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!C)for(var R=this.hostname.split(/\./),k=(A=0,R.length);A<k;A++){var O=R[A];if(O&&!O.match(h)){for(var N="",P=0,L=O.length;P<L;P++)O.charCodeAt(P)>127?N+="x":N+=O[P];if(!N.match(h)){var D=R.slice(0,A),M=R.slice(A+1),U=O.match(f);U&&(D.push(U[1]),M.unshift(U[2])),M.length&&(y="/"+M.join(".")+y),this.hostname=D.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),C||(this.hostname=n.toASCII(this.hostname));var B=this.port?":"+this.port:"",F=this.hostname||"";this.host=F+B,this.href+=this.host,C&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==y[0]&&(y="/"+y))}if(!p[w])for(A=0,k=u.length;A<k;A++){var j=u[A];if(-1!==y.indexOf(j)){var V=encodeURIComponent(j);V===j&&(V=escape(j)),y=y.split(j).join(V)}}var H=y.indexOf("#");-1!==H&&(this.hash=y.substr(H),y=y.slice(0,H));var G=y.indexOf("?");if(-1!==G?(this.search=y.substr(G),this.query=y.substr(G+1),t&&(this.query=v.parse(this.query)),y=y.slice(0,G)):t&&(this.search="",this.query={}),y&&(this.pathname=y),g[w]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){B=this.pathname||"";var q=this.search||"";this.path=B+q}return this.href=this.format(),this},i.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,o="";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&"object"==typeof this.query&&Object.keys(this.query).length&&(o=v.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var s=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||g[t])&&!1!==i?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i||(i=""),n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),t+i+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(s=s.replace("#","%23"))+n},i.prototype.resolve=function(e){return this.resolveObject(y(e,!1,!0)).format()},i.prototype.resolveObject=function(e){if("string"==typeof e){var t=new i;t.parse(e,!1,!0),e=t}for(var r=new i,n=Object.keys(this),o=0;o<n.length;o++){var s=n[o];r[s]=this[s]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var a=Object.keys(e),c=0;c<a.length;c++){var u=a[c];"protocol"!==u&&(r[u]=e[u])}return g[r.protocol]&&r.hostname&&!r.pathname&&(r.pathname="/",r.path=r.pathname),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!g[e.protocol]){for(var l=Object.keys(e),d=0;d<l.length;d++){var h=l[d];r[h]=e[h]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||m[e.protocol])r.pathname=e.pathname;else{for(var f=(e.pathname||"").split("/");f.length&&!(e.host=f.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),r.pathname=f.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var p=r.pathname||"",v=r.search||"";r.path=p+v}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var y=r.pathname&&"/"===r.pathname.charAt(0),b=e.host||e.pathname&&"/"===e.pathname.charAt(0),E=b||y||r.host&&e.pathname,w=E,S=r.pathname&&r.pathname.split("/")||[],_=(f=e.pathname&&e.pathname.split("/")||[],r.protocol&&!g[r.protocol]);if(_&&(r.hostname="",r.port=null,r.host&&(""===S[0]?S[0]=r.host:S.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===f[0]?f[0]=e.host:f.unshift(e.host)),e.host=null),E=E&&(""===f[0]||""===S[0])),b)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,S=f;else if(f.length)S||(S=[]),S.pop(),S=S.concat(f),r.search=e.search,r.query=e.query;else if(null!=e.search){if(_)r.host=S.shift(),r.hostname=r.host,(C=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=C.shift(),r.hostname=C.shift(),r.host=r.hostname);return r.search=e.search,r.query=e.query,null===r.pathname&&null===r.search||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!S.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var T=S.slice(-1)[0],x=(r.host||e.host||S.length>1)&&("."===T||".."===T)||""===T,A=0,I=S.length;I>=0;I--)"."===(T=S[I])?S.splice(I,1):".."===T?(S.splice(I,1),A++):A&&(S.splice(I,1),A--);if(!E&&!w)for(;A--;A)S.unshift("..");!E||""===S[0]||S[0]&&"/"===S[0].charAt(0)||S.unshift(""),x&&"/"!==S.join("/").substr(-1)&&S.push("");var C,R=""===S[0]||S[0]&&"/"===S[0].charAt(0);_&&(r.hostname=R?"":S.length?S.shift():"",r.host=r.hostname,(C=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=C.shift(),r.hostname=C.shift(),r.host=r.hostname));return(E=E||r.host&&S.length)&&!R&&S.unshift(""),S.length>0?r.pathname=S.join("/"):(r.pathname=null,r.path=null),null===r.pathname&&null===r.search||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},i.prototype.parseHost=function(){var e=this.host,t=s.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)},t.parse=y,t.resolve=function(e,t){return y(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?y(e,!1,!0).resolveObject(t):t},t.format=function(e){return"string"==typeof e&&(e=y(e)),e instanceof i?e.format():i.prototype.format.call(e)},t.Url=i},83031:(e,t,r)=>{e.exports=r(32482)},32482:(e,t)=>{t.version="1.0.0",t.encode=function(e){return e.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")},t.decode=function(e){return e=(e+=Array(5-e.length%4).join("=")).replace(/\-/g,"+").replace(/\_/g,"/"),new Buffer(e,"base64")},t.validate=function(e){return/^[A-Za-z0-9\-_]+$/.test(e)}},94927:(e,t,r)=>{function n(e){try{if(!r.g.localStorage)return!1}catch(e){return!1}var t=r.g.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}e.exports=function(e,t){if(n("noDeprecation"))return e;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}}},20384:e=>{e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},55955:(e,t,r)=>{"use strict";var n=r(82584),i=r(48662),o=r(86430),s=r(85692);function a(e){return e.call.bind(e)}var c="undefined"!=typeof BigInt,u="undefined"!=typeof Symbol,l=a(Object.prototype.toString),d=a(Number.prototype.valueOf),h=a(String.prototype.valueOf),f=a(Boolean.prototype.valueOf);if(c)var p=a(BigInt.prototype.valueOf);if(u)var m=a(Symbol.prototype.valueOf);function g(e,t){if("object"!=typeof e)return!1;try{return t(e),!0}catch(e){return!1}}function v(e){return"[object Map]"===l(e)}function y(e){return"[object Set]"===l(e)}function b(e){return"[object WeakMap]"===l(e)}function E(e){return"[object WeakSet]"===l(e)}function w(e){return"[object ArrayBuffer]"===l(e)}function S(e){return"undefined"!=typeof ArrayBuffer&&(w.working?w(e):e instanceof ArrayBuffer)}function _(e){return"[object DataView]"===l(e)}function T(e){return"undefined"!=typeof DataView&&(_.working?_(e):e instanceof DataView)}t.isArgumentsObject=n,t.isGeneratorFunction=i,t.isTypedArray=s,t.isPromise=function(e){return"undefined"!=typeof Promise&&e instanceof Promise||null!==e&&"object"==typeof e&&"function"==typeof e.then&&"function"==typeof e.catch},t.isArrayBufferView=function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):s(e)||T(e)},t.isUint8Array=function(e){return"Uint8Array"===o(e)},t.isUint8ClampedArray=function(e){return"Uint8ClampedArray"===o(e)},t.isUint16Array=function(e){return"Uint16Array"===o(e)},t.isUint32Array=function(e){return"Uint32Array"===o(e)},t.isInt8Array=function(e){return"Int8Array"===o(e)},t.isInt16Array=function(e){return"Int16Array"===o(e)},t.isInt32Array=function(e){return"Int32Array"===o(e)},t.isFloat32Array=function(e){return"Float32Array"===o(e)},t.isFloat64Array=function(e){return"Float64Array"===o(e)},t.isBigInt64Array=function(e){return"BigInt64Array"===o(e)},t.isBigUint64Array=function(e){return"BigUint64Array"===o(e)},v.working="undefined"!=typeof Map&&v(new Map),t.isMap=function(e){return"undefined"!=typeof Map&&(v.working?v(e):e instanceof Map)},y.working="undefined"!=typeof Set&&y(new Set),t.isSet=function(e){return"undefined"!=typeof Set&&(y.working?y(e):e instanceof Set)},b.working="undefined"!=typeof WeakMap&&b(new WeakMap),t.isWeakMap=function(e){return"undefined"!=typeof WeakMap&&(b.working?b(e):e instanceof WeakMap)},E.working="undefined"!=typeof WeakSet&&E(new WeakSet),t.isWeakSet=function(e){return E(e)},w.working="undefined"!=typeof ArrayBuffer&&w(new ArrayBuffer),t.isArrayBuffer=S,_.working="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView&&_(new DataView(new ArrayBuffer(1),0,1)),t.isDataView=T;var x="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function A(e){return"[object SharedArrayBuffer]"===l(e)}function I(e){return void 0!==x&&(void 0===A.working&&(A.working=A(new x)),A.working?A(e):e instanceof x)}function C(e){return g(e,d)}function R(e){return g(e,h)}function k(e){return g(e,f)}function O(e){return c&&g(e,p)}function N(e){return u&&g(e,m)}t.isSharedArrayBuffer=I,t.isAsyncFunction=function(e){return"[object AsyncFunction]"===l(e)},t.isMapIterator=function(e){return"[object Map Iterator]"===l(e)},t.isSetIterator=function(e){return"[object Set Iterator]"===l(e)},t.isGeneratorObject=function(e){return"[object Generator]"===l(e)},t.isWebAssemblyCompiledModule=function(e){return"[object WebAssembly.Module]"===l(e)},t.isNumberObject=C,t.isStringObject=R,t.isBooleanObject=k,t.isBigIntObject=O,t.isSymbolObject=N,t.isBoxedPrimitive=function(e){return C(e)||R(e)||k(e)||O(e)||N(e)},t.isAnyArrayBuffer=function(e){return"undefined"!=typeof Uint8Array&&(S(e)||I(e))},["isProxy","isExternal","isModuleNamespaceObject"].forEach((function(e){Object.defineProperty(t,e,{enumerable:!1,value:function(){throw new Error(e+" is not supported in userland")}})}))},89539:(e,t,r)=>{var n=r(34155),i=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},o=/%[sdj%]/g;t.format=function(e){if(!b(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(u(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,i=n.length,s=String(e).replace(o,(function(e){if("%%"===e)return"%";if(r>=i)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}})),a=n[r];r<i;a=n[++r])v(a)||!S(a)?s+=" "+a:s+=" "+u(a);return s},t.deprecate=function(e,r){if(void 0!==n&&!0===n.noDeprecation)return e;if(void 0===n)return function(){return t.deprecate(e,r).apply(this,arguments)};var i=!1;return function(){if(!i){if(n.throwDeprecation)throw new Error(r);n.traceDeprecation?console.trace(r):console.error(r),i=!0}return e.apply(this,arguments)}};var s={},a=/^$/;if({ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.NODE_DEBUG){var c={ATLAS_SERVICE_URL:"https://atlas-a.wbx2.com/admin/api/v1",CONVERSATION_SERVICE:"https://conv-a.wbx2.com/conversation/api/v1",ENCRYPTION_SERVICE_URL:"https://encryption-a.wbx2.com",HYDRA_SERVICE_URL:"https://api.ciscospark.com/v1",IDBROKER_BASE_URL:"https://idbroker.webex.com",IDENTITY_BASE_URL:"https://identity.webex.com",U2C_SERVICE_URL:"https://u2c.wbx2.com/u2c/api/v1",WDM_SERVICE_URL:"https://wdm-a.wbx2.com/wdm/api/v1",WHISTLER_API_SERVICE_URL:"https://whistler-prod.allnint.ciscospark.com/api/v1"}.NODE_DEBUG;c=c.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),a=new RegExp("^"+c+"$","i")}function u(e,r){var n={seen:[],stylize:d};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),g(r)?n.showHidden=r:r&&t._extend(n,r),E(n.showHidden)&&(n.showHidden=!1),E(n.depth)&&(n.depth=2),E(n.colors)&&(n.colors=!1),E(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=l),h(n,e,n.depth)}function l(e,t){var r=u.styles[t];return r?"["+u.colors[r][0]+"m"+e+"["+u.colors[r][1]+"m":e}function d(e,t){return e}function h(e,r,n){if(e.customInspect&&r&&x(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var i=r.inspect(n,e);return b(i)||(i=h(e,i,n)),i}var o=function(e,t){if(E(t))return e.stylize("undefined","undefined");if(b(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(y(t))return e.stylize(""+t,"number");if(g(t))return e.stylize(""+t,"boolean");if(v(t))return e.stylize("null","null")}(e,r);if(o)return o;var s=Object.keys(r),a=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(r)),T(r)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return f(r);if(0===s.length){if(x(r)){var c=r.name?": "+r.name:"";return e.stylize("[Function"+c+"]","special")}if(w(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(_(r))return e.stylize(Date.prototype.toString.call(r),"date");if(T(r))return f(r)}var u,l="",d=!1,S=["{","}"];(m(r)&&(d=!0,S=["[","]"]),x(r))&&(l=" [Function"+(r.name?": "+r.name:"")+"]");return w(r)&&(l=" "+RegExp.prototype.toString.call(r)),_(r)&&(l=" "+Date.prototype.toUTCString.call(r)),T(r)&&(l=" "+f(r)),0!==s.length||d&&0!=r.length?n<0?w(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),u=d?function(e,t,r,n,i){for(var o=[],s=0,a=t.length;s<a;++s)R(t,String(s))?o.push(p(e,t,r,n,String(s),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(p(e,t,r,n,i,!0))})),o}(e,r,n,a,s):s.map((function(t){return p(e,r,n,a,t,d)})),e.seen.pop(),function(e,t,r){var n=e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0);if(n>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(u,l,S)):S[0]+l+S[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,r,n,i,o){var s,a,c;if((c=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),R(n,i)||(s="["+i+"]"),a||(e.seen.indexOf(c.value)<0?(a=v(r)?h(e,c.value,null):h(e,c.value,r-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map((function(e){return"  "+e})).join("\n").slice(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),E(s)){if(o&&i.match(/^\d+$/))return a;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.slice(1,-1),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function m(e){return Array.isArray(e)}function g(e){return"boolean"==typeof e}function v(e){return null===e}function y(e){return"number"==typeof e}function b(e){return"string"==typeof e}function E(e){return void 0===e}function w(e){return S(e)&&"[object RegExp]"===A(e)}function S(e){return"object"==typeof e&&null!==e}function _(e){return S(e)&&"[object Date]"===A(e)}function T(e){return S(e)&&("[object Error]"===A(e)||e instanceof Error)}function x(e){return"function"==typeof e}function A(e){return Object.prototype.toString.call(e)}function I(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(e=e.toUpperCase(),!s[e])if(a.test(e)){var r=n.pid;s[e]=function(){var n=t.format.apply(t,arguments);console.error("%s %d: %s",e,r,n)}}else s[e]=function(){};return s[e]},t.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.types=r(55955),t.isArray=m,t.isBoolean=g,t.isNull=v,t.isNullOrUndefined=function(e){return null==e},t.isNumber=y,t.isString=b,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=E,t.isRegExp=w,t.types.isRegExp=w,t.isObject=S,t.isDate=_,t.types.isDate=_,t.isError=T,t.types.isNativeError=T,t.isFunction=x,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=r(20384);var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function R(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){var e,r;console.log("%s - %s",(e=new Date,r=[I(e.getHours()),I(e.getMinutes()),I(e.getSeconds())].join(":"),[e.getDate(),C[e.getMonth()],r].join(" ")),t.format.apply(t,arguments))},t.inherits=r(35717),t._extend=function(e,t){if(!t||!S(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var k="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function O(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(k&&e[k]){var t;if("function"!=typeof(t=e[k]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,k,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise((function(e,n){t=e,r=n})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(e,n){e?r(e):t(n)}));try{e.apply(this,i)}catch(e){r(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),k&&Object.defineProperty(t,k,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,i(e))},t.promisify.custom=k,t.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function t(){for(var t=[],r=0;r<arguments.length;r++)t.push(arguments[r]);var i=t.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var o=this,s=function(){return i.apply(o,arguments)};e.apply(this,t).then((function(e){n.nextTick(s.bind(null,null,e))}),(function(e){n.nextTick(O.bind(null,e,s))}))}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,i(e)),t}},55877:(e,t,r)=>{var n=r(23570),i=r(71171),o=i;o.v1=n,o.v4=i,e.exports=o},45327:e=>{for(var t=[],r=0;r<256;++r)t[r]=(r+256).toString(16).substr(1);e.exports=function(e,r){var n=r||0,i=t;return[i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]]].join("")}},85217:e=>{var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var r=new Uint8Array(16);e.exports=function(){return t(r),r}}else{var n=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n}}},23570:(e,t,r)=>{var n,i,o=r(85217),s=r(45327),a=0,c=0;e.exports=function(e,t,r){var u=t&&r||0,l=t||[],d=(e=e||{}).node||n,h=void 0!==e.clockseq?e.clockseq:i;if(null==d||null==h){var f=o();null==d&&(d=n=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==h&&(h=i=16383&(f[6]<<8|f[7]))}var p=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:c+1,g=p-a+(m-c)/1e4;if(g<0&&void 0===e.clockseq&&(h=h+1&16383),(g<0||p>a)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=p,c=m,i=h;var v=(1e4*(268435455&(p+=122192928e5))+m)%4294967296;l[u++]=v>>>24&255,l[u++]=v>>>16&255,l[u++]=v>>>8&255,l[u++]=255&v;var y=p/4294967296*1e4&268435455;l[u++]=y>>>8&255,l[u++]=255&y,l[u++]=y>>>24&15|16,l[u++]=y>>>16&255,l[u++]=h>>>8|128,l[u++]=255&h;for(var b=0;b<6;++b)l[u+b]=d[b];return t||s(l)}},71171:(e,t,r)=>{var n=r(85217),i=r(45327);e.exports=function(e,t,r){var o=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||n)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[o+a]=s[a];return t||i(s)}},80481:(e,t,r)=>{!function(e){"use strict";e.exports.is_uri=r,e.exports.is_http_uri=n,e.exports.is_https_uri=i,e.exports.is_web_uri=o,e.exports.isUri=r,e.exports.isHttpUri=n,e.exports.isHttpsUri=i,e.exports.isWebUri=o;var t=function(e){return e.match(/(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/)};function r(e){if(e&&!/[^a-z0-9\:\/\?\#\[\]\@\!\$\&\'\(\)\*\+\,\;\=\.\-\_\~\%]/i.test(e)&&!/%[^0-9a-f]/i.test(e)&&!/%[0-9a-f](:?[^0-9a-f]|$)/i.test(e)){var r,n,i,o,s,a="",c="";if(a=(r=t(e))[1],n=r[2],i=r[3],o=r[4],s=r[5],a&&a.length&&i.length>=0){if(n&&n.length){if(0!==i.length&&!/^\//.test(i))return}else if(/^\/\//.test(i))return;if(/^[a-z][a-z0-9\+\-\.]*$/.test(a.toLowerCase()))return c+=a+":",n&&n.length&&(c+="//"+n),c+=i,o&&o.length&&(c+="?"+o),s&&s.length&&(c+="#"+s),c}}}function n(e,n){if(r(e)){var i,o,s,a,c="",u="",l="",d="";if(c=(i=t(e))[1],u=i[2],o=i[3],s=i[4],a=i[5],c){if(n){if("https"!=c.toLowerCase())return}else if("http"!=c.toLowerCase())return;if(u)return/:(\d+)$/.test(u)&&(l=u.match(/:(\d+)$/)[0],u=u.replace(/:\d+$/,"")),d+=c+":",d+="//"+u,l&&(d+=l),d+=o,s&&s.length&&(d+="?"+s),a&&a.length&&(d+="#"+a),d}}}function i(e){return n(e,!0)}function o(e){return n(e)||i(e)}}(e=r.nmd(e))},86430:(e,t,r)=>{"use strict";var n=r(94029),i=r(63083),o=r(55559),s=r(21924),a=r(27296),c=s("Object.prototype.toString"),u=r(96410)(),l="undefined"==typeof globalThis?r.g:globalThis,d=i(),h=s("String.prototype.slice"),f=Object.getPrototypeOf,p=s("Array.prototype.indexOf",!0)||function(e,t){for(var r=0;r<e.length;r+=1)if(e[r]===t)return r;return-1},m={__proto__:null};n(d,u&&a&&f?function(e){var t=new l[e];if(Symbol.toStringTag in t){var r=f(t),n=a(r,Symbol.toStringTag);if(!n){var i=f(r);n=a(i,Symbol.toStringTag)}m["$"+e]=o(n.get)}}:function(e){var t=new l[e],r=t.slice||t.set;r&&(m["$"+e]=o(r))});e.exports=function(e){if(!e||"object"!=typeof e)return!1;if(!u){var t=h(c(e),8,-1);return p(d,t)>-1?t:"Object"===t&&function(e){var t=!1;return n(m,(function(r,n){if(!t)try{r(e),t=h(n,1)}catch(e){}})),t}(e)}return a?function(e){var t=!1;return n(m,(function(r,n){if(!t)try{"$"+r(e)===n&&(t=h(n,1))}catch(e){}})),t}(e):null}},47529:e=>{e.exports=function(){for(var e={},r=0;r<arguments.length;r++){var n=arguments[r];for(var i in n)t.call(n,i)&&(e[i]=n[i])}return e};var t=Object.prototype.hasOwnProperty},49602:e=>{"use strict";e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},34411:(e,t,r)=>{"use strict";function n(e){var t=this;if(t instanceof n||(t=new n),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var r=0,i=arguments.length;r<i;r++)t.push(arguments[r]);return t}function i(e,t,r){var n=t===e.head?new a(r,null,t,e):new a(r,t,t.next,e);return null===n.next&&(e.tail=n),null===n.prev&&(e.head=n),e.length++,n}function o(e,t){e.tail=new a(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function s(e,t){e.head=new a(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function a(e,t,r,n){if(!(this instanceof a))return new a(e,t,r,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}e.exports=n,n.Node=a,n.create=n,n.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,r=e.prev;return t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null,t},n.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},n.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},n.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)o(this,arguments[e]);return this.length},n.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)s(this,arguments[e]);return this.length},n.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},n.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},n.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,n=0;null!==r;n++)e.call(t,r.value,n,this),r=r.next},n.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,n=this.length-1;null!==r;n--)e.call(t,r.value,n,this),r=r.prev},n.prototype.get=function(e){for(var t=0,r=this.head;null!==r&&t<e;t++)r=r.next;if(t===e&&null!==r)return r.value},n.prototype.getReverse=function(e){for(var t=0,r=this.tail;null!==r&&t<e;t++)r=r.prev;if(t===e&&null!==r)return r.value},n.prototype.map=function(e,t){t=t||this;for(var r=new n,i=this.head;null!==i;)r.push(e.call(t,i.value,this)),i=i.next;return r},n.prototype.mapReverse=function(e,t){t=t||this;for(var r=new n,i=this.tail;null!==i;)r.push(e.call(t,i.value,this)),i=i.prev;return r},n.prototype.reduce=function(e,t){var r,n=this.head;if(arguments.length>1)r=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,r=this.head.value}for(var i=0;null!==n;i++)r=e(r,n.value,i),n=n.next;return r},n.prototype.reduceReverse=function(e,t){var r,n=this.tail;if(arguments.length>1)r=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,r=this.tail.value}for(var i=this.length-1;null!==n;i--)r=e(r,n.value,i),n=n.prev;return r},n.prototype.toArray=function(){for(var e=new Array(this.length),t=0,r=this.head;null!==r;t++)e[t]=r.value,r=r.next;return e},n.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,r=this.tail;null!==r;t++)e[t]=r.value,r=r.prev;return e},n.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new n;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,o=this.head;null!==o&&i<e;i++)o=o.next;for(;null!==o&&i<t;i++,o=o.next)r.push(o.value);return r},n.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new n;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,o=this.tail;null!==o&&i>t;i--)o=o.prev;for(;null!==o&&i>e;i--,o=o.prev)r.push(o.value);return r},n.prototype.splice=function(e,t,...r){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,o=this.head;null!==o&&n<e;n++)o=o.next;var s=[];for(n=0;o&&n<t;n++)s.push(o.value),o=this.removeNode(o);null===o&&(o=this.tail),o!==this.head&&o!==this.tail&&(o=o.prev);for(n=0;n<r.length;n++)o=i(this,o,r[n]);return s},n.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;null!==r;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=t,this.tail=e,this};try{r(49602)(n)}catch(e){}},42480:()=>{},66507:()=>{},86035:()=>{},25819:()=>{},3438:()=>{},24654:()=>{},52361:()=>{},94616:()=>{},4059:()=>{},27921:(e,t,r)=>{e.exports=r(50176)},78149:(e,t,r)=>{e.exports=r(70964)},66130:(e,t,r)=>{e.exports=r(76216)},8450:(e,t,r)=>{e.exports=r(23565)},18281:(e,t,r)=>{e.exports=r(94175)},25733:(e,t,r)=>{e.exports=r(86337)},7520:(e,t,r)=>{e.exports=r(68080)},18428:(e,t,r)=>{e.exports=r(68207)},93364:(e,t,r)=>{e.exports=r(99848)},26771:(e,t,r)=>{e.exports=r(82624)},43562:(e,t,r)=>{e.exports=r(88058)},27392:(e,t,r)=>{e.exports=r(36759)},95366:(e,t,r)=>{e.exports=r(44221)},6919:(e,t,r)=>{e.exports=r(22991)},62680:(e,t,r)=>{e.exports=r(72818)},26243:(e,t,r)=>{e.exports=r(15297)},18433:(e,t,r)=>{e.exports=r(42837)},79529:(e,t,r)=>{e.exports=r(16111)},73473:(e,t,r)=>{e.exports=r(89448)},71544:(e,t,r)=>{e.exports=r(58564)},63755:(e,t,r)=>{e.exports=r(98401)},79873:(e,t,r)=>{e.exports=r(53268)},67857:(e,t,r)=>{e.exports=r(76409)},39907:(e,t,r)=>{e.exports=r(46383)},90487:(e,t,r)=>{e.exports=r(98828)},85579:(e,t,r)=>{e.exports=r(71922)},22013:(e,t,r)=>{e.exports=r(72974)},83977:(e,t,r)=>{e.exports=r(69488)},11996:(e,t,r)=>{var n=r(63207).default,i=r(82624),o=r(71922),s=r(25380),a=r(87595),c=r(21900),u=r(89448);function l(){"use strict";e.exports=l=function(){return r},e.exports.__esModule=!0,e.exports.default=e.exports;var t,r={},d=Object.prototype,h=d.hasOwnProperty,f=i||function(e,t,r){e[t]=r.value},p="function"==typeof o?o:{},m=p.iterator||"@@iterator",g=p.asyncIterator||"@@asyncIterator",v=p.toStringTag||"@@toStringTag";function y(e,t,r){return i(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{y({},"")}catch(t){y=function(e,t,r){return e[t]=r}}function b(e,t,r,n){var i=t&&t.prototype instanceof A?t:A,o=s(i.prototype),a=new B(n||[]);return f(o,"_invoke",{value:L(e,r,a)}),o}function E(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}r.wrap=b;var w="suspendedStart",S="suspendedYield",_="executing",T="completed",x={};function A(){}function I(){}function C(){}var R={};y(R,m,(function(){return this}));var k=a&&a(a(F([])));k&&k!==d&&h.call(k,m)&&(R=k);var O=C.prototype=A.prototype=s(R);function N(e){["next","throw","return"].forEach((function(t){y(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function r(i,o,s,a){var c=E(e[i],e,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==n(l)&&h.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,a)}),(function(e){r("throw",e,s,a)})):t.resolve(l).then((function(e){u.value=e,s(u)}),(function(e){return r("throw",e,s,a)}))}a(c.arg)}var i;f(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,i){r(e,n,t,i)}))}return i=i?i.then(o,o):o()}})}function L(e,r,n){var i=w;return function(o,s){if(i===_)throw new Error("Generator is already running");if(i===T){if("throw"===o)throw s;return{value:t,done:!0}}for(n.method=o,n.arg=s;;){var a=n.delegate;if(a){var c=D(a,n);if(c){if(c===x)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===w)throw i=T,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=_;var u=E(e,r,n);if("normal"===u.type){if(i=n.done?T:S,u.arg===x)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=T,n.method="throw",n.arg=u.arg)}}}function D(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),x;var o=E(i,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,x;var s=o.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,x):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,x)}function M(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function U(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function B(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(M,this),this.reset(!0)}function F(e){if(e||""===e){var r=e[m];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(h.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(n(e)+" is not iterable")}return I.prototype=C,f(O,"constructor",{value:C,configurable:!0}),f(C,"constructor",{value:I,configurable:!0}),I.displayName=y(C,v,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===I||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return c?c(e,C):(e.__proto__=C,y(e,v,"GeneratorFunction")),e.prototype=s(O),e},r.awrap=function(e){return{__await:e}},N(P.prototype),y(P.prototype,g,(function(){return this})),r.AsyncIterator=P,r.async=function(e,t,n,i,o){void 0===o&&(o=u);var s=new P(b(e,t,n,i),o);return r.isGeneratorFunction(t)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},N(O),y(O,v,"Generator"),y(O,m,(function(){return this})),y(O,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},r.values=F,B.prototype={constructor:B,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(U),!e)for(var r in this)"t"===r.charAt(0)&&h.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,i){return s.type="throw",s.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=h.call(o,"catchLoc"),c=h.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&h.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,x):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),x},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),U(r),x}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;U(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:F(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),x}},r}e.exports=l,e.exports.__esModule=!0,e.exports.default=e.exports},63207:(e,t,r)=>{var n=r(71922),i=r(72974);function o(t){return e.exports=o="function"==typeof n&&"symbol"==typeof i?function(e){return typeof e}:function(e){return e&&"function"==typeof n&&e.constructor===n&&e!==n.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,o(t)}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports},33453:(e,t,r)=>{var n=r(11996)();e.exports=n;try{regeneratorRuntime=n}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},63083:(e,t,r)=>{"use strict";var n=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],i="undefined"==typeof globalThis?r.g:globalThis;e.exports=function(){for(var e=[],t=0;t<n.length;t++)"function"==typeof i[n[t]]&&(e[e.length]=n[t]);return e}},43583:(e,t)=>{var r,n=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function r(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function n(e){return!0===(e&&e.__isLong__)}function i(e){var t=Math.clz32(e&-e);return e?31-t:t}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=n;var o={},s={};function a(e,t){var r,n,i;return t?(i=0<=(e>>>=0)&&e<256)&&(n=s[e])?n:(r=u(e,0,!0),i&&(s[e]=r),r):(i=-128<=(e|=0)&&e<128)&&(n=o[e])?n:(r=u(e,e<0?-1:0,!1),i&&(o[e]=r),r)}function c(e,t){if(isNaN(e))return t?y:v;if(t){if(e<0)return y;if(e>=p)return _}else{if(e<=-m)return T;if(e+1>=m)return S}return e<0?c(-e,t).neg():u(e%f|0,e/f|0,t)}function u(e,t,n){return new r(e,t,n)}r.fromInt=a,r.fromNumber=c,r.fromBits=u;var l=Math.pow;function d(e,t,r){if(0===e.length)throw Error("empty string");if("number"==typeof t?(r=t,t=!1):t=!!t,"NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t?y:v;if((r=r||10)<2||36<r)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return d(e.substring(1),t,r).neg();for(var i=c(l(r,8)),o=v,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),u=parseInt(e.substring(s,s+a),r);if(a<8){var h=c(l(r,a));o=o.mul(h).add(c(u))}else o=(o=o.mul(i)).add(c(u))}return o.unsigned=t,o}function h(e,t){return"number"==typeof e?c(e,t):"string"==typeof e?d(e,t):u(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}r.fromString=d,r.fromValue=h;var f=4294967296,p=f*f,m=p/2,g=a(1<<24),v=a(0);r.ZERO=v;var y=a(0,!0);r.UZERO=y;var b=a(1);r.ONE=b;var E=a(1,!0);r.UONE=E;var w=a(-1);r.NEG_ONE=w;var S=u(-1,2147483647,!1);r.MAX_VALUE=S;var _=u(-1,-1,!0);r.MAX_UNSIGNED_VALUE=_;var T=u(0,-2147483648,!1);r.MIN_VALUE=T;var x=r.prototype;x.toInt=function(){return this.unsigned?this.low>>>0:this.low},x.toNumber=function(){return this.unsigned?(this.high>>>0)*f+(this.low>>>0):this.high*f+(this.low>>>0)},x.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(T)){var t=c(e),r=this.div(t),n=r.mul(t).sub(this);return r.toString(e)+n.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=c(l(e,6),this.unsigned),o=this,s="";;){var a=o.div(i),u=(o.sub(a.mul(i)).toInt()>>>0).toString(e);if((o=a).isZero())return u+s;for(;u.length<6;)u="0"+u;s=""+u+s}},x.getHighBits=function(){return this.high},x.getHighBitsUnsigned=function(){return this.high>>>0},x.getLowBits=function(){return this.low},x.getLowBitsUnsigned=function(){return this.low>>>0},x.getNumBitsAbs=function(){if(this.isNegative())return this.eq(T)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},x.isZero=function(){return 0===this.high&&0===this.low},x.eqz=x.isZero,x.isNegative=function(){return!this.unsigned&&this.high<0},x.isPositive=function(){return this.unsigned||this.high>=0},x.isOdd=function(){return 1==(1&this.low)},x.isEven=function(){return 0==(1&this.low)},x.equals=function(e){return n(e)||(e=h(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},x.eq=x.equals,x.notEquals=function(e){return!this.eq(e)},x.neq=x.notEquals,x.ne=x.notEquals,x.lessThan=function(e){return this.comp(e)<0},x.lt=x.lessThan,x.lessThanOrEqual=function(e){return this.comp(e)<=0},x.lte=x.lessThanOrEqual,x.le=x.lessThanOrEqual,x.greaterThan=function(e){return this.comp(e)>0},x.gt=x.greaterThan,x.greaterThanOrEqual=function(e){return this.comp(e)>=0},x.gte=x.greaterThanOrEqual,x.ge=x.greaterThanOrEqual,x.compare=function(e){if(n(e)||(e=h(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},x.comp=x.compare,x.negate=function(){return!this.unsigned&&this.eq(T)?T:this.not().add(b)},x.neg=x.negate,x.add=function(e){n(e)||(e=h(e));var t=this.high>>>16,r=65535&this.high,i=this.low>>>16,o=65535&this.low,s=e.high>>>16,a=65535&e.high,c=e.low>>>16,l=0,d=0,f=0,p=0;return f+=(p+=o+(65535&e.low))>>>16,d+=(f+=i+c)>>>16,l+=(d+=r+a)>>>16,l+=t+s,u((f&=65535)<<16|(p&=65535),(l&=65535)<<16|(d&=65535),this.unsigned)},x.subtract=function(e){return n(e)||(e=h(e)),this.add(e.neg())},x.sub=x.subtract,x.multiply=function(e){if(this.isZero())return this;if(n(e)||(e=h(e)),t)return u(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return this.unsigned?y:v;if(this.eq(T))return e.isOdd()?T:v;if(e.eq(T))return this.isOdd()?T:v;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(g)&&e.lt(g))return c(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,i=65535&this.high,o=this.low>>>16,s=65535&this.low,a=e.high>>>16,l=65535&e.high,d=e.low>>>16,f=65535&e.low,p=0,m=0,b=0,E=0;return b+=(E+=s*f)>>>16,m+=(b+=o*f)>>>16,b&=65535,m+=(b+=s*d)>>>16,p+=(m+=i*f)>>>16,m&=65535,p+=(m+=o*d)>>>16,m&=65535,p+=(m+=s*l)>>>16,p+=r*f+i*d+o*l+s*a,u((b&=65535)<<16|(E&=65535),(p&=65535)<<16|(m&=65535),this.unsigned)},x.mul=x.multiply,x.divide=function(e){if(n(e)||(e=h(e)),e.isZero())throw Error("division by zero");var r,i,o;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?u((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?y:v;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return y;if(e.gt(this.shru(1)))return E;o=y}else{if(this.eq(T))return e.eq(b)||e.eq(w)?T:e.eq(T)?b:(r=this.shr(1).div(e).shl(1)).eq(v)?e.isNegative()?b:w:(i=this.sub(e.mul(r)),o=r.add(i.div(e)));if(e.eq(T))return this.unsigned?y:v;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=v}for(i=this;i.gte(e);){r=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(r)/Math.LN2),a=s<=48?1:l(2,s-48),d=c(r),f=d.mul(e);f.isNegative()||f.gt(i);)f=(d=c(r-=a,this.unsigned)).mul(e);d.isZero()&&(d=b),o=o.add(d),i=i.sub(f)}return o},x.div=x.divide,x.modulo=function(e){return n(e)||(e=h(e)),t?u((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},x.mod=x.modulo,x.rem=x.modulo,x.not=function(){return u(~this.low,~this.high,this.unsigned)},x.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},x.clz=x.countLeadingZeros,x.countTrailingZeros=function(){return this.low?i(this.low):i(this.high)+32},x.ctz=x.countTrailingZeros,x.and=function(e){return n(e)||(e=h(e)),u(this.low&e.low,this.high&e.high,this.unsigned)},x.or=function(e){return n(e)||(e=h(e)),u(this.low|e.low,this.high|e.high,this.unsigned)},x.xor=function(e){return n(e)||(e=h(e)),u(this.low^e.low,this.high^e.high,this.unsigned)},x.shiftLeft=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u(0,this.low<<e-32,this.unsigned)},x.shl=x.shiftLeft,x.shiftRight=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},x.shr=x.shiftRight,x.shiftRightUnsigned=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):u(32===e?this.high:this.high>>>e-32,0,this.unsigned)},x.shru=x.shiftRightUnsigned,x.shr_u=x.shiftRightUnsigned,x.rotateLeft=function(e){var t;return n(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?u(this.high,this.low,this.unsigned):e<32?(t=32-e,u(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(t=32-(e-=32),u(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))},x.rotl=x.rotateLeft,x.rotateRight=function(e){var t;return n(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?u(this.high,this.low,this.unsigned):e<32?(t=32-e,u(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(t=32-(e-=32),u(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))},x.rotr=x.rotateRight,x.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},x.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},x.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},x.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},x.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},r.fromBytes=function(e,t,n){return n?r.fromBytesLE(e,t):r.fromBytesBE(e,t)},r.fromBytesLE=function(e,t){return new r(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},r.fromBytesBE=function(e,t){return new r(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};var A=r;return e.default=A,"default"in e?e.default:e}({});void 0===(r=function(){return n}.apply(t,[]))||(e.exports=r)},2313:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(15297),i=r(82624);function o(e,t,r,o,s){var a={};return n(o).forEach((function(e){a[e]=o[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),a),s&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(s):void 0,a.initializer=void 0),void 0===a.initializer&&(i(e,t,a),a=null),a}},80759:(e,t,r)=>{"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r.d(t,{Z:()=>n})},23710:(e,t,r)=>{"use strict";function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}r.d(t,{Z:()=>n})},66250:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(89448);function i(e,t,r,i,o,s,a){try{var c=e[s](a),u=c.value}catch(e){return void r(e)}c.done?t(u):n.resolve(u).then(i,o)}function o(e){return function(){var t=this,r=arguments;return new n((function(n,o){var s=e.apply(t,r);function a(e){i(s,n,o,a,c,"next",e)}function c(e){i(s,n,o,a,c,"throw",e)}a(void 0)}))}}},8167:(e,t,r)=>{"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.d(t,{Z:()=>n})},956:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(98401),i=r(35148);function o(e,t,r){return o=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(e){return!1}}()?n.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&(0,i.Z)(o,r.prototype),o},o.apply(null,arguments)}},31314:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(82624),i=r(44660);function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),n(e,(0,i.Z)(o.key),o)}}function s(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),n(e,"prototype",{writable:!1}),e}},77193:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(82624),i=r(44660);function o(e,t,r){return(t=(0,i.Z)(t))in e?n(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},35002:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(21900),i=r(87595);function o(e){return o=n?i.bind():function(e){return e.__proto__||i(e)},o(e)}},69678:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(25380),i=r(82624),o=r(35148);function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=n(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),i(e,"prototype",{writable:!1}),t&&(0,o.Z)(e,t)}},26305:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(13682),i=r(23710);function o(e,t){if(t&&("object"===(0,n.Z)(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,i.Z)(e)}},35148:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(21900);function i(e,t){return i=n?n.bind():function(e,t){return e.__proto__=t,e},i(e,t)}},14917:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(70964);var i=r(71922),o=r(72974);var s=r(33422);function a(e,t){return function(e){if(n(e))return e}(e)||function(e,t){var r=null==e?null:void 0!==i&&e[o]||e["@@iterator"];if(null!=r){var n,s,a,c,u=[],l=!0,d=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(u.push(n.value),u.length!==t);l=!0);}catch(e){d=!0,s=e}finally{try{if(!l&&null!=r.return&&(c=r.return(),Object(c)!==c))return}finally{if(d)throw s}}return u}}(e,t)||(0,s.Z)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},21882:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var n=r(70964),i=r(80759);var o=r(71922),s=r(72974),a=r(50176);var c=r(33422);function u(e){return function(e){if(n(e))return(0,i.Z)(e)}(e)||function(e){if(void 0!==o&&null!=e[s]||null!=e["@@iterator"])return a(e)}(e)||(0,c.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},44660:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(13682),i=r(90446);function o(e){var t=function(e,t){if("object"!==(0,n.Z)(e)||null===e)return e;var r=e[i];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==(0,n.Z)(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===(0,n.Z)(t)?t:String(t)}},13682:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(71922),i=r(72974);function o(e){return o="function"==typeof n&&"symbol"==typeof i?function(e){return typeof e}:function(e){return e&&"function"==typeof n&&e.constructor===n&&e!==n.prototype?"symbol":typeof e},o(e)}},33422:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(50176),i=r(80759);function o(e,t){if(e){if("string"==typeof e)return(0,i.Z)(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?n(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?(0,i.Z)(e,t):void 0}}},67097:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var n=r(94175),i=r(25380),o=r(35002),s=r(35148);var a=r(956);function c(e){var t="function"==typeof n?new n:void 0;return c=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return(0,a.Z)(e,arguments,(0,o.Z)(this).constructor)}return r.prototype=i(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),(0,s.Z)(r,e)},c(e)}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.loaded=!0,r.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var __webpack_exports__=__webpack_require__(82239);return __webpack_exports__})()));
//# sourceMappingURL=meetings.min.js.map